<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Onion Architecture In ASP.NET Core With CQRS - Detailed - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Onion Architecture In ASP.NET Core With CQRS - Detailed - linksfor.dev(s)"/>
    <meta property="article:author" content="https://facebook.com/iammukeshm"/>
    <meta property="og:description" content="In this article, We will talk about Onion Architecture In ASP.NET Core and it&#x27;s advantages. We will also together build a WebApi that follows a variant of"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.codewithmukesh.com/blog/onion-architecture-in-aspnet-core/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Onion Architecture In ASP.NET Core With CQRS - Detailed</title>
<div class="readable">
        <h1>Onion Architecture In ASP.NET Core With CQRS - Detailed</h1>
            <div>by https://facebook.com/iammukeshm</div>
            <div>Reading time: 24-30 minutes</div>
        <div>Posted here: 23 Jun 2020</div>
        <p><a href="https://www.codewithmukesh.com/blog/onion-architecture-in-aspnet-core/">https://www.codewithmukesh.com/blog/onion-architecture-in-aspnet-core/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="bsf_rt_marker"><div><div><p>In this article, We will talk about Onion Architecture In ASP.NET Core and it‚Äôs advantages. We will also together build a WebApi that follows a variant of Onion Architecture so that we get to see why it is important to implement such an architecture in your upcoming projects. You can find the source code of this implementation on my <a href="https://github.com/iammukeshm/OnionArchitecture" target="_blank" aria-label="GitHub (opens in a new tab)" rel="noreferrer noopener">GitHub</a>.</p><blockquote><p><em><strong>Disclaimer : This is a pretty huge article with around 3500+ words. Do bookmark this page and continue üòÄ </strong></em></p></blockquote><h2><span id="The_Need_to_Follow_an_Architecture"></span>The Need to Follow an Architecture<span></span></h2><p>To maintain structural Sanity in Mid to Larger Solutions, it is always recommended to follow some kind of architecture. You must have seen most of the Open Sourced Projects having multiple layers of Projects within a complex folder structure.</p><h3><span id="Layer_Vs_Tiers"></span>Layer Vs Tiers<span></span></h3><p>When there is just a logical separation in your application, we can term it as layers or N Layers. In cases where there is both a physical and logical separation of concerns, it is often referred to as n-tiered application where n is the number of separations. 3 is the most common value of N. In this article, we will deal with the Layered Architecture.</p><p>This layering can help in the separation of concerns, subdividing the solution into smaller units so that each unit is responsible for a specific task and also to take advantage of abstraction. For mid to larger scaled projects where multiple teams work, layering has very obvious advantages up its sleeves. It lets a specific team or individual work on a particular layer without disturbing the integrity of the others. It makes it much easier to track changes using source control.</p><p>Also, <strong>It just makes your entire solution look clean.</strong></p><p>Before getting into Onion Architecture in ASP.NET Core, let‚Äôs first refresh our knowledge on N Layer Architecture.</p><h2><span id="Brief_Overview_of_NLayer_Architecture"></span>Brief Overview of N-Layer Architecture<span></span></h2><p>Let‚Äôs look at the one of the most popular Architecture in ASP.NET Core Applications. Here is a simple diagramatic representation of a variation of the N-Layer Architecture. Presentation Layer usualy holds the Part that the User can interact with, i.e, WebApi, MVC, Webforms and so on. Business Logic is probably the most important part of this entire setup. It holds all the logics related to the Business Requirement. Now, every application ideally has it‚Äôs own dedicated Database. Inorder to access the Database, we introduce a Data Access Layer. This layer usually holds ORMs for ASP.NET to fetch/write to the database.</p><div><figure><img alt="N-Tier Architecture Diagram" title="N-Tier Architecture Diagram" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/N-Tier-Architecture.png 700w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/N-Tier-Architecture-480x480.png 480w" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/N-Tier-Architecture.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 700px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/N-Tier-Architecture.png" sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 700px, 100vw" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/N-Tier-Architecture.png 700w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/N-Tier-Architecture-480x480.png 480w"></figure></div><h2><span id="Disadvantages_of_NLayer_Architecture"></span>Disadvantages of N-Layer Architecture<span></span></h2><p>To clearly understand the advantages of Onion Architecture in ASP.NET Core Applications, we will need to study the issues with N Layer Architecture. It is one of the commonly used Solution Architecture amongst .NET developers.</p><p>Instead of building a highly decoupled structure, we often end up with several layers that are depending on each other. This is something really bad in building scalable applications and may pose issues with the growth of the codebase. To keep it clear, in the above diagram we can see that the presentation layer depends on the logics layer, which in turn depends on the data access and so on.</p><p>Thus, we would be creating a bunch of unnecessary couplings. Is it really needed? In most of the cases the UI (presentation) layer would be coupled to the Data Access Layers as well. This would defeat the purpose of having a clean architecture, yeah?</p><p>In N Layer Architecture, the Database is usually the Core of the Entire Application, i.e It is the only layer that doesn‚Äôt have to depend on anything else. Any small change in the Business Logics layer or Data access layer may prove dangerous to the integrity of the entire application.</p><h2><span id="Getting_Started_with_Onion_Architecture"></span>Getting Started with Onion Architecture<span></span></h2><p>The Onion architecture, introduced by Jeffrey Palermo, overcomes the issues of the layered architecture with great ease. With Onion Architecture, the game-changer is that the Domain Layer (Entities and Validation Rules that are common to the business case ) is at the Core of the Entire Application. This means higher flexibility and lesser coupling. In this approach, we can see that all the Layers are dependent only on the Core Layers.</p><div><figure><img alt="Onion Architecture In ASP.NET Core Diagram" width="700" height="700" title="Onion Architecture In ASP.NET Core Diagram" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/Onion-Architecture-In-ASP.NET-Core.png 700w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/Onion-Architecture-In-ASP.NET-Core-480x480.png 480w" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/Onion-Architecture-In-ASP.NET-Core.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 700px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/Onion-Architecture-In-ASP.NET-Core.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/Onion-Architecture-In-ASP.NET-Core.png 700w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/Onion-Architecture-In-ASP.NET-Core-480x480.png 480w"></figure></div><p><strong>Here is how I would breakdown the structure of the proposed Solution.</strong></p><p><strong>Domain and Application Layer</strong> will be at the center of the design. We can refer to these layers at the Core Layers. These layers will not depend on any other layers.</p><p>Domain Layer usually contains enterprise logic and entities. Application Layer would have Interfaces and types. The main difference is that The Domain Layer will have the types that are common to the entire enterprise, hence can be shared across other solutions as well. But the Application Layer has Application-specific types and interface. Understand?</p><p>As mentioned earlier, the Core Layers will never depend on any other layer. Therefore what we do is that we create interfaces in the Application Layer and these interfaces get implemented in the external layers. This is also known and DIP or Dependency Inversion Principle.</p><p>For example, If your application want‚Äôs to send a mail, We define an IMailService in the Application Layer and Implement it outside the Core Layers. Using DIP, it is easily possible to switch the implementations. This helps build scalable applications.</p><p><strong>Presentation Layer</strong> is where you would Ideally want to put the Project that the User can Access. This can be a WebApi, Mvc Project, etc.</p><p><strong>Infrastructure Layer</strong> is a bit more tricky. It is where you would want to add your Infrastructure. Infrastructure can be anything. Maybe an Entity Framework Core Layer for Accessing the DB, or a Layer specifically made to generate JWT Tokens for Authentication or even a Hangfire Layer. You will understand more when we start Implementing Onion Architecture in ASP.NET Core WebApi Project.</p><h2><span id="Implementing_Onion_Architecture_in_ASP_NET_Core_WebApi_Project"></span>Implementing Onion Architecture in ASP.NET Core WebApi Project<span></span></h2><p>To keep things simple but demonstrate the architecture to the fullest, we will build an ASP.NET Core Web API that is quite scalable. For this article, Let‚Äôs have a WebApi that has just one entity, Product. We will perform CRUD Operations on it while using the Onion architecture. This will give you quite a clear picture.</p><p>Here is a list of features and tech we will be using for this setup.</p><ul><li>Onion Architecture</li><li>Entity Framework Core</li><li>.NET Core 3.1 Library / .NET Standard 2.1 Library / ASP.NET Core 3.1 WebApi</li><li>Swagger</li><li>CQRS / Mediator Pattern using MediatR Library</li><li>Wrapper Class for Responses</li><li>CRUD Operations</li><li>Inverted Dependencies</li><li>API Versioning</li></ul><h3><span id="Setting_up_the_Solution_Structure"></span>Setting up the Solution Structure<span></span></h3><p>We will start off by creating a Blank Solution on Visual Studio. PS, I use Visual Studio 2019 Comunity which is completely FREE. To install this IDE, check my article <a href="https://www.codewithmukesh.com/blog/install-visual-studio-2019-community/">here</a>.</p><figure><img alt="blank" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank.png 1025w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank-980x597.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank-480x292.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 1" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1025px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank.png 1025w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank-980x597.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/blank-480x292.png 480w"></figure><p>Let‚Äôs give it a proper Name.</p><figure><img alt="newproject" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject.png 1025w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject-980x597.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject-480x292.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 2" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1025px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject.png 1025w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject-980x597.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/newproject-480x292.png 480w"></figure><p>Under the Blank Solution, add 3 new folders.</p><ul><li>Core ‚Äì will contain the Domain and Application layer Projects</li><li>Infrastructure ‚Äì will include any projects related to the Infrastructure of the ASP.NET Core 3.1 Web Api (Authentication, Persistence etc)</li><li>Presentation ‚Äì The Projects that are linked to the UI or API . In our case, this folder will hold the API Project.</li></ul><figure><img alt="blanksolution 1" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blanksolution-1.png 556w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/blanksolution-1-480x223.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 3" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blanksolution-1.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 556px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blanksolution-1.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/blanksolution-1.png 556w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/blanksolution-1-480x223.png 480w"></figure><p>Let‚Äôs start adding the required projects. Firstly, under Core Folder Add a new .NET Standard Library and name it Domain.</p><p>Why .NET Standard? We know that Domain and Application Project does not depend on any other  layers. Also the fact that these projects can be shared with other solutions if needed (Maybe another solution that is not .NET Core, but  .NET Framework 4.7) . Get the point?</p><figure><img alt="domain" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-1024x485.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-980x464.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-480x227.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 4" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-1024x485.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-1024x485.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-1024x485.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-980x464.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domain-480x227.png 480w"></figure><blockquote><p>A wise person once said ‚Äì ‚Äù Delete the Default Class1 Created by Visual Studio. Always Delete them. ‚Äú</p></blockquote><p>After creating the Domain project, right click on properties and change the target framework to .NET Standard 2.1 (which is the latest .NET Standard version at the time of writing this article.)</p><figure><img alt="domainproperties" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-1024x476.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-980x455.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-480x223.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 5" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-1024x476.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-1024x476.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-1024x476.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-980x455.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/domainproperties-480x223.png 480w"></figure><p>Similary, create another .NET Standard Library Project in the Core Folder. Name it Application. Do not forget to change the target version here as well.</p><p>Next, let‚Äôs go to the Infrastructure Folder and add a layer for Database, (EFCore). This is going to be a .NET Core Library Project. We will name it Persistence.</p><figure><img alt="persistence" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-1024x531.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-980x508.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-480x249.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 6" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-1024x531.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-1024x531.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-1024x531.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-980x508.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/persistence-480x249.png 480w"></figure><p>Finally, in the Presentation layer, add a new ASP.NET Core 3.1 WebApi Project and name it WebApi.</p><figure><img alt="api" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/api.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/api-980x679.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/api-480x333.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 7" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/api.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/api.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/api.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/api-980x679.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/api-480x333.png 480w"></figure><p>This is what we will be having right now. You can see the clear seperation of concerns as we have read earlier. Let‚Äôs start build up the architecture now.</p><figure><img alt="finalstrcuture" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/finalstrcuture.png 709w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/finalstrcuture-480x328.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 8" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/finalstrcuture.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 709px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/finalstrcuture.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/finalstrcuture.png 709w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/finalstrcuture-480x328.png 480w"></figure><h3><span id="Adding_Swagger_To_WebApi_Project"></span>Adding Swagger To WebApi Project<span></span></h3><p><strong>Tip #1 ‚Äì Always use Swagger while working with WebApis. It is so much helpful to have it.</strong></p><p>Install the Following packages ot the WebApi Project via Package Manager Console</p><pre data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">Install-Package Swashbuckle.AspNetCore
Install-Package Swashbuckle.AspNetCore.Swagger</pre><p>We will have to register Swager within the application service container. Navigate to ../Startup.cs and add these lines to the ConfigureServices method.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#region Swagger
services.AddSwaggerGen(c =&gt;
{
    c.IncludeXmlComments(string.Format(@"{0}\OnionArchitecture.xml", System.AppDomain.CurrentDomain.BaseDirectory));
    c.SwaggerDoc("v1", new OpenApiInfo
    {
        Version = "v1",
        Title = "OnionArchitecture",
    });

});
#endregion</pre><p>Then, add these lines to the Configure method.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#region Swagger
// Enable middleware to serve generated Swagger as a JSON endpoint.
app.UseSwagger();

// Enable middleware to serve swagger-ui (HTML, JS, CSS, etc.),
// specifying the Swagger JSON endpoint.
app.UseSwaggerUI(c =&gt;
{
    c.SwaggerEndpoint("/swagger/v1/swagger.json", "OnionArchitecture");
});
#endregion</pre><p>Next, we will need to add the XML File (For Swagger Documentaion). To do this, right click the WebApi Project and go to propeties. In the Build Tab enable the XML Documentation file and give an appropriate file name and location. I have added the xml file to the root of the API Project.</p><figure><img alt="xml" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-1024x476.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-980x455.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-480x223.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 9" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-1024x476.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-1024x476.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-1024x476.png 1024w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-980x455.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/xml-480x223.png 480w"></figure><p>Make sure that the WebApi Project is selected as the Startup Project. Now Build / Run the Application and navigate to ../swagger. We have got swagger up and running.</p><figure><img alt="swagger" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/swagger-980x479.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/swagger-480x234.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 10" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/swagger-1024x500.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/swagger-1024x500.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/swagger-980x479.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/swagger-480x234.png 480w"></figure><p>Tip #2 ‚Äì While running the application, you would see that it navigated to ../weatherforecast by default. This is because of launchSettings.json settings. In the WebApi Project, Properties drill down, you can find a launchsettings.json file. This file holds all the configuration required for the app launch. Change the launch URL to swagger. Thus, swagger will open up by default every time you run the application. This helps you save some time.</p><figure><img alt="launch" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/launch.png 679w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/launch-480x354.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 11" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/launch.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 679px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/launch.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/launch.png 679w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/launch-480x354.png 480w"></figure><h3><span id="Adding_The_Entities_to_the_Domain_Project"></span>Adding The Entities to the Domain Project<span></span></h3><p>Now, let‚Äôs work on the Core Layers starting from the Domain Project. So what is the function of the Domain Layer? <strong>It basically has the models/entities, Exception, validation rules, Settings,  and anything that is quite common throughout the solution. </strong></p><p>Let‚Äôs start by adding a BaseEntity class at Common/BaseEntity.cs in the Domain Project. This abstract class will be used as a base class for our entities.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">public abstract class BaseEntity
{
    public int Id { get; set; }
}</pre><p>Now add a Product Class that inherits the Id from the BaseEntity. Create a new class <strong>Entities/Product.cs</strong> in the Domain Project.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">public class Product : BaseEntity
{
    public string Name { get; set; }
    public string Barcode { get; set; }
    public string Description { get; set; }
    public decimal Rate { get; set; }
}</pre><h3><span id="Adding_the_Required_Interfaces_And_Packages_in_Application_Layer"></span>Adding the Required Interfaces And Packages in Application Layer<span></span></h3><p>As mentioned earlier, the Application Layer will contain the Interfaces and Types that are specific for this Application.</p><p>Firstly, Add Reference to the Domain Project.</p><p>Then, install the required packages via Console.</p><pre data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">Install-Package MediatR.Extensions.Microsoft.DependencyInjection
Install-Package Microsoft.EntityFrameworkCore</pre><p>We have a Entity named Product. Now we need to establish this class as a Table using Entity Framework Core. So we will need a ApplicationDBContext. But the catch is that, we won‚Äôt create the actual concrete implementation of the ApplicationDbContext here in the Application Layer. Rather, we will just add a IApplicatoinDbContext Interface so that the EF Logics does not fall under the Application Layer, but goes to the Persistence layer which is outside the core,</p><p>This is how you can invert the dependencies to build scalable applications. Now , the advantage is that, tommorow, you need a different implementation of the ApplicationDbContext, you don‚Äôt need to touch the existing code base, but just add another Infrastructure layer for this purpose and implement the IApplicationDbContext. As simple as that.</p><p>Create a new folder Interfaces in the Application Project. Add a new interface in it, IApplicationDbContext</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">public interface IApplicationDbContext
{
    DbSet&lt;Product&gt; Products { get; set; }
    Task&lt;int&gt; SaveChanges();
}</pre><p>This is another variant that i have noticed in many huge solutions. Let‚Äôs say you have around 100 interfaces and 100 implementations. Do you add all this 100 lines of code to the Startup.cs to register them in the container? That would be insane in the maintainability point of view. To keep things clean, what we can do is, Create a DependencyInjection static Class for every layer of the solution and only add the corresponding . required services to the corresponding Class.</p><p>In this way, we are decentralizing the code lines and keeping our Startup class neat and tidy. Here is an extension method over the IServiceCollection.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">public static class DependencyInjection
{
    public static void AddApplication(this IServiceCollection services)
    {
        services.AddMediatR(Assembly.GetExecutingAssembly());
    }
}</pre><p>Here we will just Add Mediator to the service collection. We will implement Mediator pattern later in this tutorial.</p><p>And all you have to do in the WebApi‚Äôs Startup class in just add one line. This essentially registers all the services associated with the Application Layer into the container. Quite handy, yeah?</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">services.AddApplication();</pre><h3><span id="Implementing_MediatR_for_CRUD_Operations"></span>Implementing MediatR for CRUD Operations<span></span></h3><p>In Application Layer, Create a New Folder called Features. This will have all the logics related to each Feature / Entity. Under this folder, add a new one and name it ProductFeatures. Then add a Commands and Queries folder to it.</p><p>I have already written a detailed article on MediatR and <a aria-label="CQRS pattern in ASP.NET Core 3.1 WebApi (opens in a new tab)" href="https://www.codewithmukesh.com/blog/cqrs-in-aspnet-core-3-1/" target="_blank" rel="noreferrer noopener">CQRS pattern in ASP.NET Core 3.1 WebApi</a> Project. You can follow that article and add the Required Commands and Handlers to the Application Layer.</p><figure><img alt="cqrs" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/cqrs.png 514w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/cqrs-480x236.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 12" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/cqrs.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 514px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/cqrs.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/cqrs.png 514w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/cqrs-480x236.png 480w"></figure><p>I will add the links to the source code of each file. Basically these 5 Classes would cover our CRUD Operations implementation. Make sure that you have gone through my article about CQRS for ASP.NET Core before proceeding.</p><ul><li>CreateCommand ‚Äì <a href="https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Commands/CreateProductCommand.cs" target="_blank" rel="noopener">https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Commands/CreateProductCommand.cs</a></li><li> DeleteCommand ‚Äì <a href="https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Commands/DeleteProductByIdCommand.cs" target="_blank" rel="noopener">https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Commands/DeleteProductByIdCommand.cs</a></li><li>UpdateCommand ‚Äì <a href="https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Commands/UpdateProductCommand.cs" target="_blank" rel="noopener">https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Commands/UpdateProductCommand.cs</a></li><li>GetAllQuery ‚Äì <a href="https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Queries/GetAllProductsQuery.cs" target="_blank" rel="noopener">https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Queries/GetAllProductsQuery.cs</a></li><li>GetByIdQuery ‚Äì <a href="https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Queries/GetProductByIdQuery.cs" target="_blank" rel="noopener">https://github.com/iammukeshm/OnionArchitecture/blob/master/Application/Features/ProductFeatures/Queries/GetProductByIdQuery.cs</a></li></ul><div><div><div><div><div><div><p><span>Stay up to date! Get all the latest &amp; greatest articles / in depth Guides on .NET Core / ASP.NET Core delivered straight to your inbox. Subscribe now!</span></p></div></div></div></div></div></div><h3><span id="Setting_Up_EF_Core_on_the_Persistence_Project"></span>Setting Up EF Core on the Persistence Project<span></span></h3><p>Firstly, add a connection string to the appsettings.json found in the WebApi Project.</p><pre data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">  "ConnectionStrings": {
    "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=onionDb;Trusted_Connection=True;MultipleActiveResultSets=true"
  }</pre><p>With the CRUD logics out of the ways, let‚Äôs setup EFCore in the Persistence Layer and try to generate a database. Install the following packages to the Persistence Project.</p><pre data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">Install-Package Microsoft.EntityFrameworkCore
Install-Package Microsoft.EntityFrameworkCore.SqlServer</pre><p>Remember we created an IApplicationDBContext Interface in the Application Layer? This is where we will be implementing it. Create a new folder named Context and add a new class ApplicationDbContext. This class will implement IApplicationDBContext.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">public class ApplicationDbContext : DbContext, IApplicationDbContext
{
    public ApplicationDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options)
        : base(options)
    {
    }
    public DbSet&lt;Product&gt; Products { get; set; }
    public async Task&lt;int&gt; SaveChanges()
    {
        return await base.SaveChangesAsync();
    }
}</pre><p>We will have to register IApplicationDBContext and bind it to ApplicationDbContext, right? Similar to the Application layer, we will have to create a new class just to register the dependencies and services of this layer to the service container.</p><p>Add a new static class, DependencyInjection</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">public static class DependencyInjection
{
    public static void AddPersistence(this IServiceCollection services, IConfiguration configuration)
    {
        services.AddDbContext&lt;ApplicationDbContext&gt;(options =&gt;
            options.UseSqlServer(
                configuration.GetConnectionString("DefaultConnection"),
                b =&gt; b.MigrationsAssembly(typeof(ApplicationDbContext).Assembly.FullName)));
        services.AddScoped&lt;IApplicationDbContext&gt;(provider =&gt; provider.GetService&lt;ApplicationDbContext&gt;());
    }
}</pre><p>And in the Startup class/ ConfigureServices method of the WebApi Just Add the following line. You can now see the advantage of this kind of approach.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">services.AddPersistence(Configuration);</pre><h3><span id="Generate_the_Migrations_and_the_Database"></span>Generate the Migrations and the Database<span></span></h3><p>As our ApplicationDbContext is configured, let‚Äôs generate the migrations and ultimately create a Database using Ef Core Tools ‚Äì Code First Approach.</p><p>Install the following packages in the WebApi Project.</p><pre data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">Install-Package Microsoft.EntityFrameworkCore.Tools
Install-Package Microsoft.EntityFrameworkCore.Design</pre><p>Now, open up the package manager console and select the Persistence project as the default prject (as mentioned in the sceenshot below.). This is because the actual ApplicationDBContext is implemented in the Persistence layer, remember?</p><p>Then, run the following commands to add migrations and to generate / update the database.</p><pre data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">add-migration Initial
update-database</pre><figure><img alt="pmc" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/pmc.png 802w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/pmc-480x203.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 13" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/pmc.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 802px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/pmc.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/pmc.png 802w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/pmc-480x203.png 480w"></figure><p>You will get a ‚ÄòDone‚Äô message.</p><h3><span id="Adding_API_Versioning"></span>Adding API Versioning<span></span></h3><p>Just to make our solution a bit more clean, let‚Äôs also add API Versioning to the WebAPI.</p><p>I have written a detailed article on <a href="https://www.codewithmukesh.com/blog/api-versioning-in-aspnet-core-3-1/" target="_blank" aria-label="API Versioning in ASP.NET Core 3.1 WebApi (opens in a new tab)" rel="noreferrer noopener">API Versioning in ASP.NET Core 3.1 WebApi</a>. Feel feel to read it to get a complete idea of this concept.</p><p>Install the required package.</p><pre data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">Install-Package Microsoft.AspNetCore.Mvc.Versioning</pre><p>In the Startup/ConfigureServices of the API project, add these lines to register the Versioning.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#region API Versioning
// Add API Versioning to the Project
services.AddApiVersioning(config =&gt;
{
    // Specify the default API Version as 1.0
    config.DefaultApiVersion = new ApiVersion(1, 0);
    // If the client hasn't specified the API version in the request, use the default API version number 
    config.AssumeDefaultVersionWhenUnspecified = true;
    // Advertise the API versions supported for the particular endpoint
    config.ReportApiVersions = true;
});
#endregion</pre><h3><span id="Setting_up_the_Controllers"></span>Setting up the Controllers<span></span></h3><p>This is the final step of setting up Onion Architecture In ASP.NET Core. We will have to wire up a controller to the Application Layer.</p><p>Create a Base Api Controller. This will be an Empty API Controller which will have Api Versioning enabled in the Attribute and also a MediatR object. What is aim of this Base Controller? It is just to reduce the lines of code. Say, we add a new controller. We will not have to re-define the API Versioning route nor the Mediatr object. But we will just add the BaseAPI Controller as the base class. Get it? I will show it in implementation.</p><p>Add new Empty API Controller in the Controllers folder and name it BaseApiController.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">using MediatR;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.DependencyInjection;

namespace WebApi.Controllers
{
    [ApiController]
    [Route("api/v{version:apiVersion}/[controller]")]
    public abstract class BaseApiController : ControllerBase
    {
        private IMediator _mediator;
        protected IMediator Mediator =&gt; _mediator ??= HttpContext.RequestServices.GetService&lt;IMediator&gt;();
    }
}</pre><p>You can see that we are adding the API Versioning data to the route attribute and also creating a IMediator object.</p><p>Next, let‚Äôs create our actual ENtity endpoint. Create a new folder inside the Controllers folder and name it ‚Äòv1‚Äô. This means that this folder will contain all the Version 1 API Controllers. Read more about API Versioning to understand the need for this <a aria-label="here (opens in a new tab)" href="https://www.codewithmukesh.com/blog/api-versioning-in-aspnet-core-3-1/" target="_blank" rel="noreferrer noopener">here</a>.</p><p>Inside the v1 Folder, add a new empty API Controller named ProductController. Since this is a very basic controller that calls the mediator object, I will not go in deep. However, I have previously written a detailed article on CQRS implementation in ASP.NET Core 3.1 API. You could go through that article which covers the same scenario. Read it <a aria-label="here (opens in a new tab)" href="https://www.codewithmukesh.com/blog/cqrs-in-aspnet-core-3-1/" target="_blank" rel="noreferrer noopener">here</a>.</p><pre data-enlighter-language="csharp" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">[ApiVersion("1.0")]
public class ProductController : BaseApiController
{
    /// &lt;summary&gt;
    /// Creates a New Product.
    /// &lt;/summary&gt;
    /// &lt;param name="command"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpPost]
    public async Task&lt;IActionResult&gt; Create(CreateProductCommand command)
    {
        return Ok(await Mediator.Send(command));
    }
    /// &lt;summary&gt;
    /// Gets all Products.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpGet]
    public async Task&lt;IActionResult&gt; GetAll()
    {
        return Ok(await Mediator.Send(new GetAllProductsQuery()));
    }
    /// &lt;summary&gt;
    /// Gets Product Entity by Id.
    /// &lt;/summary&gt;
    /// &lt;param name="id"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpGet("{id}")]
    public async Task&lt;IActionResult&gt; GetById(int id)
    {
        return Ok(await Mediator.Send(new GetProductByIdQuery { Id = id }));
    }
    /// &lt;summary&gt;
    /// Deletes Product Entity based on Id.
    /// &lt;/summary&gt;
    /// &lt;param name="id"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpDelete("{id}")]
    public async Task&lt;IActionResult&gt; Delete(int id)
    {
        return Ok(await Mediator.Send(new DeleteProductByIdCommand { Id = id }));
    }
    /// &lt;summary&gt;
    /// Updates the Product Entity based on Id.   
    /// &lt;/summary&gt;
    /// &lt;param name="id"&gt;&lt;/param&gt;
    /// &lt;param name="command"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    [HttpPut("[action]")]
    public async Task&lt;IActionResult&gt; Update(int id, UpdateProductCommand command)
    {
        if (id != command.Id)
        {
            return BadRequest();
        }
        return Ok(await Mediator.Send(command));
    }
}</pre><p>That‚Äôs quite everything in this simple yet powerful implementation of Onion Architecture in ASP.NET Core. Build the application and let‚Äôs test it.</p><blockquote><p>Since we are already talking about a form of Clean Architecture in ASP.NET Core Applications, it would help if you read about certain tips to write clean and scalable C# Code. This knowledge will drastically improve the way you start building applications in .NET ‚Äì <a aria-label="Read the article here (opens in a new tab)" href="https://www.codewithmukesh.com/blog/write-clean-csharp-code/" target="_blank" rel="noreferrer noopener">Read the article here</a> (20 Tips to write Clean C# Code)</p></blockquote><h3><span id="Testing"></span>Testing<span></span></h3><p>Run the application and open up Swagger. We will do a simple test to ensure that our solution works. I will just create a new product and make a request to query all the existing products as well.</p><figure><img alt="create new product" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/create-new-product-980x489.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/create-new-product-480x240.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 14" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/create-new-product-1024x511.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/create-new-product-1024x511.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/create-new-product-980x489.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/create-new-product-480x240.png 480w"></figure><figure><img alt="get all" data-srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/get-all-980x489.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/get-all-480x240.png 480w" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 15" data-src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/get-all-1024x511.png" data-sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1024px, 100vw" src="https://www.codewithmukesh.com/wp-content/uploads/2020/06/get-all-1024x511.png" srcset="https://www.codewithmukesh.com/wp-content/uploads/2020/06/get-all-980x489.png 980w, https://www.codewithmukesh.com/wp-content/uploads/2020/06/get-all-480x240.png 480w"></figure><p>You can see that we receive the expected data.</p><h2><span id="Advantages_of_Onion_Architecture_in_ASP_NET_Core"></span>Advantages of Onion Architecture in ASP.NET Core<span></span></h2><p>The advantages of this designs is as follows.</p><p><strong>Highly Testable</strong> ‚Äì Since the Core has no dependencies on anything else, writing automated tests are flexible,</p><p><strong>Database Independent </strong>‚Äì Since we have a clean separation of data access, it is quite easy to switch between different database providers.</p><p><strong>Switchable UI Layer (Presentation)</strong> ‚Äì Since we are keeping all the crucial logics away from the presentation layer, it is quite easy to switch to another tech ‚Äì including Blazor.</p><p><strong>Much Cleaner Codebase with well structured Projects for better understanding with teams.</strong></p><h2><span id="Further_Improvements"></span>Further Improvements<span></span></h2><p>Since this is a very standard implementation of Onion Architecture in ASP.NET Core to make it clear for you guys, I have avoided several components like Authentication, Exception Handling, Mediator Pipeline Logging, Error Logging, Background Processing, Response Wrappers to keep the size of the article compact.</p><p>However, I have covered few of these topics in other articles in my blog already. You could go through them to understand the core concepts and to learn how everything works.</p><ul><li><a aria-label="Pagination &amp; Response Wrappers (opens in a new tab)" href="https://www.codewithmukesh.com/blog/pagination-in-aspnet-core-webapi/" target="_blank" rel="noreferrer noopener">Pagination &amp; Response Wrappers</a></li><li><a aria-label="JWT Authentication in API (opens in a new tab)" href="https://www.codewithmukesh.com/blog/aspnet-core-api-with-jwt-authentication/" target="_blank" rel="noreferrer noopener">JWT Authentication in API</a> ‚Äì With Refresh Tokens.</li><li><a aria-label="Error Logging with Serilog (opens in a new tab)" href="https://www.codewithmukesh.com/blog/serilog-in-aspnet-core-3-1/" target="_blank" rel="noreferrer noopener">Error Logging with Serilog</a></li><li><a href="https://www.codewithmukesh.com/blog/hangfire-in-aspnet-core-3-1/" target="_blank" aria-label="Background Job Processing with Hangfire (opens in a new tab)" rel="noreferrer noopener">Background Job Processing with Hangfire</a></li></ul><p>I am planning to build a fully-fledged Clean Architecture Solution Template, which you guys can just download and start using for your new projects in no time. I would like to know your opinion about this. A Standalone WebApi Clean Architecture Solution? MVC Clean Architecture Solution? Let me know in the comments section below.</p><h4><strong>If you found this article helpful,</strong></h4><p><a target="_blank" href="https://www.buymeacoffee.com/codewithmukesh" rel="noopener noreferrer"><img alt="Buy me a coffee" title="Onion Architecture In ASP.NET Core With CQRS - Detailed 16" data-src="https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><span>Buy me a coffee</span></a></p><h2><span id="Summary"></span>Summary<span></span></h2><p><strong>Fun Fact</strong> ‚Äì Microsoft themselves recommend this kind of architecture for complex solutions. Few of the solutions developed and maintained by Microsoft MVPs like <a href="https://github.com/dotnet-architecture/eShopOnWeb" target="_blank" aria-label="eShopOnWeb  (opens in a new tab)" rel="noreferrer noopener">eShopOnWeb </a>and <a href="https://github.com/dotnet-architecture/eShopOnContainers" target="_blank" aria-label="eShopOnContainers  (opens in a new tab)" rel="noreferrer noopener">eShopOnContainers </a>also follow a similar (slightly more complicated variant of this approach).</p><p>I hope that this is quite understandable to all, especially the ones starting about with the entire Solution Architecturing Stuff. Let me know your feedback and the scopes of improvement in this approach. You can find the entire source code on my <a aria-label="Github Repository (opens in a new tab)" href="https://github.com/iammukeshm/OnionArchitecture" target="_blank" rel="noreferrer noopener">Github Repository</a>. Feel free to fork it and make necessary contributions if you feel so üòÄ Happy Coding üôÇ</p></div></div></div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>