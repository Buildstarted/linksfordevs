<!DOCTYPE html>
<html lang="en">
<head>
    <title>
NuGet PackageReference Versions SOLUTION Wide - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="NuGet PackageReference Versions SOLUTION Wide - linksfor.dev(s)"/>
    <meta property="og:description" content="Using the same NuGet Package (PackageReference) across multiple projects? Here are ways to specify them in a single place for your entire solution."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://codeopinion.com/nuget-packagereference-versions-solution-wide/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - NuGet PackageReference Versions SOLUTION Wide</title>
<div class="readable">
        <h1>NuGet PackageReference Versions SOLUTION Wide</h1>
            <div>Reading time: 6-8 minutes</div>
        <div>Posted here: 30 Jul 2020</div>
        <p><a href="https://codeopinion.com/nuget-packagereference-versions-solution-wide/">https://codeopinion.com/nuget-packagereference-versions-solution-wide/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
			
<figure><img src="https://codeopinion.com/wp-content/uploads/2020/07/TwitterCardTemplate-2-1024x536.png" alt="NuGet PackageReference Versions SOLUTION Wide" srcset="https://codeopinion.com/wp-content/uploads/2020/07/TwitterCardTemplate-2-1024x536.png 1024w, https://codeopinion.com/wp-content/uploads/2020/07/TwitterCardTemplate-2-300x157.png 300w, https://codeopinion.com/wp-content/uploads/2020/07/TwitterCardTemplate-2-768x402.png 768w, https://codeopinion.com/wp-content/uploads/2020/07/TwitterCardTemplate-2.png 1200w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>


<p>If you have a solution with many projects, it can be a challenge to make sure each NuGet Package has the version across all of your projects. Each PackageReference across all csproj files must specify the same version of the NuGet Package. Here are a couple of ways for managing NuGet PackageRerence Versions across your entire solution.</p>


<h2>YouTube</h2>


<p>Check out my&nbsp;<a href="https://www.youtube.com/channel/UC3RKA4vunFAfrfxiJhPEplw" target="_blank" rel="noreferrer noopener">YouTube channel</a>&nbsp;where I created a video that accompanies this blog post.</p>


<figure>
<p>
<iframe title="NuGet PackageReference Versions SOLUTION Wide" width="648" height="365" src="https://www.youtube.com/embed/GolKKJmqxoc?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</p>
</figure>


<h2>PackageReference</h2>


<p>First, in order for this to work, you must be using the new SDK style csproj files.  This is where your NuGet packages are referenced via the <strong>&lt;PackageReference&gt;</strong> element.</p>


<p>If you haven’t migrated to the SDK style csproj, check out my <a href="https://codeopinion.com/migrating-to-sdk-csproj/" target="_blank" aria-label="undefined (opens in a new tab)" rel="noreferrer noopener">migration blog post</a>.</p>


<p>Here’s an example of the eShopOnWeb.Infrastructure.csproj</p>


<figure>
<div>
<div><div id="gist104607649">
    <div>
      <div>
        <div>
  <div id="file-csproj-xml">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-csproj-xml-L1" data-line-number="1"></td>
        <td id="file-csproj-xml-LC1">&lt;<span>Project</span> <span>Sdk</span>=<span><span>"</span>Microsoft.NET.Sdk<span>"</span></span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L2" data-line-number="2"></td>
        <td id="file-csproj-xml-LC2">
</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L3" data-line-number="3"></td>
        <td id="file-csproj-xml-LC3">	&lt;<span>PropertyGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L4" data-line-number="4"></td>
        <td id="file-csproj-xml-LC4">		&lt;<span>TargetFramework</span>&gt;netstandard2.1&lt;/<span>TargetFramework</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L5" data-line-number="5"></td>
        <td id="file-csproj-xml-LC5">		&lt;<span>RootNamespace</span>&gt;Microsoft.eShopWeb.Infrastructure&lt;/<span>RootNamespace</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L6" data-line-number="6"></td>
        <td id="file-csproj-xml-LC6">	&lt;/<span>PropertyGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L7" data-line-number="7"></td>
        <td id="file-csproj-xml-LC7">
</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L8" data-line-number="8"></td>
        <td id="file-csproj-xml-LC8">	&lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L9" data-line-number="9"></td>
        <td id="file-csproj-xml-LC9">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.AspNetCore.Identity<span>"</span></span> <span>Version</span>=<span><span>"</span>2.2.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L10" data-line-number="10"></td>
        <td id="file-csproj-xml-LC10">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.AspNetCore.Identity.EntityFrameworkCore<span>"</span></span> <span>Version</span>=<span><span>"</span>3.1.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L11" data-line-number="11"></td>
        <td id="file-csproj-xml-LC11">		</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L12" data-line-number="12"></td>
        <td id="file-csproj-xml-LC12">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.EntityFrameworkCore.SqlServer<span>"</span></span> <span>Version</span>=<span><span>"</span>3.1.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L13" data-line-number="13"></td>
        <td id="file-csproj-xml-LC13">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.EntityFrameworkCore.Tools<span>"</span></span> <span>Version</span>=<span><span>"</span>3.1.0<span>"</span></span> <span>PrivateAssets</span>=<span><span>"</span>All<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L14" data-line-number="14"></td>
        <td id="file-csproj-xml-LC14">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Ardalis.EFCore.Extensions<span>"</span></span> <span>Version</span>=<span><span>"</span>1.1.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L15" data-line-number="15"></td>
        <td id="file-csproj-xml-LC15">	&lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L16" data-line-number="16"></td>
        <td id="file-csproj-xml-LC16">	&lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L17" data-line-number="17"></td>
        <td id="file-csproj-xml-LC17">		&lt;<span>ProjectReference</span> <span>Include</span>=<span><span>"</span>..\ApplicationCore\ApplicationCore.csproj<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L18" data-line-number="18"></td>
        <td id="file-csproj-xml-LC18">	&lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L19" data-line-number="19"></td>
        <td id="file-csproj-xml-LC19">	&lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L20" data-line-number="20"></td>
        <td id="file-csproj-xml-LC20">		&lt;<span>Folder</span> <span>Include</span>=<span><span>"</span>Data\Migrations\<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L21" data-line-number="21"></td>
        <td id="file-csproj-xml-LC21">	&lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L22" data-line-number="22"></td>
        <td id="file-csproj-xml-LC22">&lt;/<span>Project</span>&gt;</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
</div>
</div>
</figure>


<p>In this solution, I also have another project (eShopOnWeb.Web.csproj) that is also referencing the same version of Microsoft.EntityFrameworkCore.SqlServer package.</p>


<p>These PackageReferences must always have the same version matching otherwise you’re going to run into issues.</p>


<h2>Directory.Build.targets</h2>


<p>Instead of making sure each csproj has the same version of a package, you can centralize this by using a file called Directory.Build.targets.</p>


<p>Start off by creating a file called Directory.Build.targets at the same level as your solution file (.sln).  This file will contain the PackageReference along with the version.  Here’s an example.</p>


<figure>
<div>
<div><div id="gist104607707">
    <div>
      <div>
        <div>
  <div id="file-directory-build-targets-xml">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-directory-build-targets-xml-L1" data-line-number="1"></td>
        <td id="file-directory-build-targets-xml-LC1">&lt;<span>Project</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L2" data-line-number="2"></td>
        <td id="file-directory-build-targets-xml-LC2">    &lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L3" data-line-number="3"></td>
        <td id="file-directory-build-targets-xml-LC3">        &lt;<span>PackageReference</span> <span>Update</span>=<span><span>"</span>Microsoft.EntityFrameworkCore.SqlServer<span>"</span></span> <span>Version</span>=<span><span>"</span>3.1.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L4" data-line-number="4"></td>
        <td id="file-directory-build-targets-xml-LC4">    &lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L5" data-line-number="5"></td>
        <td id="file-directory-build-targets-xml-LC5">&lt;/<span>Project</span>&gt;</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
</div>
</div>
</figure>


<p>This looks very similar to a csproj and how PackageReference’s are used.  However there’s one important distinction.  Instead of <strong>Include</strong> attribute, it’s instead <strong>Update</strong>.</p>


<p>Now back to our csproj, we can now remove the version from the PackageReference</p>


<figure>
<div>
<div><div id="gist104607725">
    <div>
      <div>
        <div>
  <div id="file-csproj-xml">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-csproj-xml-L1" data-line-number="1"></td>
        <td id="file-csproj-xml-LC1">&lt;<span>Project</span> <span>Sdk</span>=<span><span>"</span>Microsoft.NET.Sdk<span>"</span></span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L2" data-line-number="2"></td>
        <td id="file-csproj-xml-LC2">
</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L3" data-line-number="3"></td>
        <td id="file-csproj-xml-LC3">	&lt;<span>PropertyGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L4" data-line-number="4"></td>
        <td id="file-csproj-xml-LC4">		&lt;<span>TargetFramework</span>&gt;netstandard2.1&lt;/<span>TargetFramework</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L5" data-line-number="5"></td>
        <td id="file-csproj-xml-LC5">		&lt;<span>RootNamespace</span>&gt;Microsoft.eShopWeb.Infrastructure&lt;/<span>RootNamespace</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L6" data-line-number="6"></td>
        <td id="file-csproj-xml-LC6">	&lt;/<span>PropertyGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L7" data-line-number="7"></td>
        <td id="file-csproj-xml-LC7">
</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L8" data-line-number="8"></td>
        <td id="file-csproj-xml-LC8">	&lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L9" data-line-number="9"></td>
        <td id="file-csproj-xml-LC9">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.AspNetCore.Identity<span>"</span></span> <span>Version</span>=<span><span>"</span>2.2.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L10" data-line-number="10"></td>
        <td id="file-csproj-xml-LC10">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.AspNetCore.Identity.EntityFrameworkCore<span>"</span></span> <span>Version</span>=<span><span>"</span>3.1.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L11" data-line-number="11"></td>
        <td id="file-csproj-xml-LC11">		</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L12" data-line-number="12"></td>
        <td id="file-csproj-xml-LC12">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.EntityFrameworkCore.SqlServer<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L13" data-line-number="13"></td>
        <td id="file-csproj-xml-LC13">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.EntityFrameworkCore.Tools<span>"</span></span> <span>Version</span>=<span><span>"</span>3.1.0<span>"</span></span> <span>PrivateAssets</span>=<span><span>"</span>All<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L14" data-line-number="14"></td>
        <td id="file-csproj-xml-LC14">		&lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Ardalis.EFCore.Extensions<span>"</span></span> <span>Version</span>=<span><span>"</span>1.1.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L15" data-line-number="15"></td>
        <td id="file-csproj-xml-LC15">	&lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L16" data-line-number="16"></td>
        <td id="file-csproj-xml-LC16">	&lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L17" data-line-number="17"></td>
        <td id="file-csproj-xml-LC17">		&lt;<span>ProjectReference</span> <span>Include</span>=<span><span>"</span>..\ApplicationCore\ApplicationCore.csproj<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L18" data-line-number="18"></td>
        <td id="file-csproj-xml-LC18">	&lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L19" data-line-number="19"></td>
        <td id="file-csproj-xml-LC19">	&lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L20" data-line-number="20"></td>
        <td id="file-csproj-xml-LC20">		&lt;<span>Folder</span> <span>Include</span>=<span><span>"</span>Data\Migrations\<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L21" data-line-number="21"></td>
        <td id="file-csproj-xml-LC21">	&lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-csproj-xml-L22" data-line-number="22"></td>
        <td id="file-csproj-xml-LC22">&lt;/<span>Project</span>&gt;</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
</div>
</div>
</figure>


<h2>Solution Wide PackageReferences</h2>


<p>Another cool use for Directory.Build.targets is to have PackageReferences that are included for every project in your solution.  To do this, simply add a PackageReference  just as you normally would in a csproj including the version.</p>


<p>In the example below, I’m adding Microsoft.CodeAnalysis to every project.</p>


<figure>
<div>
<div><div id="gist104607763">
    <div>
      <div>
        <div>
  <div id="file-directory-build-targets-xml">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-directory-build-targets-xml-L1" data-line-number="1"></td>
        <td id="file-directory-build-targets-xml-LC1">&lt;<span>Project</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L2" data-line-number="2"></td>
        <td id="file-directory-build-targets-xml-LC2">    &lt;<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L3" data-line-number="3"></td>
        <td id="file-directory-build-targets-xml-LC3">        &lt;<span>PackageReference</span> <span>Include</span>=<span><span>"</span>Microsoft.CodeAnalysis<span>"</span></span> <span>Version</span>=<span><span>"</span>3.4.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L4" data-line-number="4"></td>
        <td id="file-directory-build-targets-xml-LC4">        &lt;<span>PackageReference</span> <span>Update</span>=<span><span>"</span>Microsoft.EntityFrameworkCore.SqlServer<span>"</span></span> <span>Version</span>=<span><span>"</span>3.1.0<span>"</span></span> /&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L5" data-line-number="5"></td>
        <td id="file-directory-build-targets-xml-LC5">    &lt;/<span>ItemGroup</span>&gt;</td>
      </tr>
      <tr>
        <td id="file-directory-build-targets-xml-L6" data-line-number="6"></td>
        <td id="file-directory-build-targets-xml-LC6">&lt;/<span>Project</span>&gt;</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
</div>
</div>
</figure>


<p>Note that for this package, we’re using the Include attribute.</p>


<h2>Directory.Packages.props</h2>


<p>The second way of this is using the new (as of .NET Core SDK 3.1.300) Directory.Packages.props.</p>


<p><a href="https://twitter.com/stuartblang" target="_blank" aria-label="undefined (opens in a new tab)" rel="noreferrer noopener">Stuart Lang</a> posted about this and how to use it.  Check out his blog post <a aria-label="undefined (opens in a new tab)" href="https://stu.dev/managing-package-versions-centrally/" target="_blank" rel="noreferrer noopener">Managing Package Versions Centrally</a>.</p>


<p>If you’re using another method, let me know in the comments, on Twitter, or on the YouTube video.</p>


<h2>Related Links</h2>


<ul>
<li><a aria-label="undefined (opens in a new tab)" href="https://codeopinion.com/migrating-to-sdk-csproj/" target="_blank" rel="noreferrer noopener">Migrating to SDK csproj</a></li>
</ul>





<!-- Mailchimp for WordPress v4.8 - https://wordpress.org/plugins/mailchimp-for-wp/ --><!-- / Mailchimp for WordPress Plugin -->


<!-- AI CONTENT END 1 -->
					</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>