<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Announcing Entity Framework Core 3.0 Preview 4 | .NET Blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Announcing Entity Framework Core 3.0 Preview 4 | .NET Blog - linksfor.dev(s)"/>
    <meta property="article:author" content="Diego VegaProgram Manager ,&#xA0;.NET Data AccessFollow Diego"/>
    <meta property="og:description" content="Today, we are making the fourth preview of Entity Framework Core 3.0 available on&#xA0;NuGet, alongside .NET Core 3.0 Preview 4 and ASP.NET Core 3.0 Preview 4. We encourage you to install this preview to test the new functionality and assess the impact of the included breaking changes."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/dotnet/announcing-entity-framework-core-3-0-preview-4/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Announcing Entity Framework Core 3.0 Preview 4 | .NET Blog</title>
<div class="readable">
        <h1>Announcing Entity Framework Core 3.0 Preview 4 | .NET Blog</h1>
            <div>by Diego VegaProgram Manager ,&#xA0;.NET Data AccessFollow Diego</div>
            <div>Reading time: 10-12 minutes</div>
        <div>Posted here: 26 Apr 2019</div>
        <p><a href="https://devblogs.microsoft.com/dotnet/announcing-entity-framework-core-3-0-preview-4/">https://devblogs.microsoft.com/dotnet/announcing-entity-framework-core-3-0-preview-4/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured"><div><div><div><div><p><img src="https://secure.gravatar.com/avatar/c16238388fe24348cb8d7c4cf974bb7b?s=58&amp;d=mm&amp;r=g" width="58" height="58" alt="Avatar"></p><p>Diego</p></div></div></div><p>April 18th, 2019</p><p>Today, we are making the fourth preview of Entity Framework Core 3.0 available on&nbsp;<a href="https://www.nuget.org/packages/Microsoft.EntityFrameworkCore/3.0.0-preview4.19216.3" target="_blank">NuGet</a>, alongside <a href="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-preview-4/">.NET Core 3.0 Preview 4</a> and <a href="https://devblogs.microsoft.com/aspnet/asp-net-core-updates-in-net-core-3-0-preview-4">ASP.NET Core 3.0 Preview 4</a>. We encourage you to install this preview to test the new functionality and assess the impact of the included breaking changes.</p><h2 id="whats-new-in-ef-core-30-preview-4">What’s new in EF Core 3.0 Preview 4?<a href="#whats-new-in-ef-core-30-preview-4"></a></h2><p>This preview includes more than 50 bug fixes and functional enhancements. You can query our issue tracker for the full list of issues fixed in&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues?utf8=%E2%9C%93&amp;q=is:issue+milestone:3.0.0-preview4+is:closed+label:closed-fixed+-label:area-docs+-label:area-test+-label:area-adonet-sqlite+sort:reactions-desc" target="_blank">Preview 4</a>, as well as for the issues fixed in&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues?utf8=%E2%9C%93&amp;q=is:issue+milestone:3.0.0-preview3+is:closed+label:closed-fixed+-label:area-docs+-label:area-test+-label:area-adonet-sqlite+sort:reactions-desc" target="_blank">Preview 3</a>, and&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues?utf8=%E2%9C%93&amp;q=is:issue+milestone:3.0.0-preview2+is:closed+label:closed-fixed+-label:area-docs+-label:area-test+-label:area-adonet-sqlite+sort:reactions-desc" target="_blank">Preview 2</a>.</p><p>Some of the most important changes are:</p><h3>LINQ queries are no longer evaluated on the client</h3><p>The new LINQ implementation that we will introduce in an upcoming preview will not support automatic client evaluation except on the last&nbsp;<code>select</code>&nbsp;operator on your query. In preparation for this change, in preview 4 we have switched the&nbsp;<a href="https://docs.microsoft.com/ef/core/querying/client-eval#optional-behavior-throw-an-exception-for-client-evaluation" target="_blank">existing client evaluation behavior</a>&nbsp;to throw by default.</p><p>Although it should still be possible to restore the old behavior by re-configuring client evaluation to only cause a warning, we recommend that you test your application with the new default. If you see client evaluation exceptions, you can try modifying your queries to avoid client evaluation. If that doesn’t work, you can introduce calls to&nbsp;<code>AsEnumerable()</code>&nbsp;or&nbsp;<code>ToList()</code>&nbsp;to explicitly switch the processing of the query to the client in places where this is acceptable. You can use raw SQL queries instead of LINQ if none of these options work for you.</p><p>See&nbsp;<a href="https://docs.microsoft.com/ef/core/what-is-new/ef-core-3.0/breaking-changes#linq-queries-are-no-longer-evaluated-on-the-client" target="_blank">the breaking change details</a>&nbsp;to learn more about why we are making this change.</p><p>If you hit any case in which a LINQ expression isn’t translated to SQL and you get a client evaluation exception instead, but you know exactly what SQL translation you expect to get, we ask you to&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/new" target="_blank">create an issue</a>&nbsp;to help us improve EF Core.</p><h3>The EF Core runtime is no longer part of the&nbsp;ASP.NET&nbsp;Core shared framework</h3><p><em>Note that this change was actually introduced in Preview 1 but was not previously announced in this blog.</em></p><p>The main consequence of this change is that no matter what type of application you are building or what database your application uses, you always obtain EF Core by installing the NuGet package for the EF Core provider of your choice.</p><p>In any operating system supported for .NET Core development, you can install the preview bits by installing a provider for EF Core 3.0 Preview 4. For example, to install the SQLite provider, type this in the command line:</p><pre><code><span>$ dotnet add </span><span>package</span><span> </span><span>Microsoft</span><span>.</span><span>EntityFrameworkCore</span><span>.</span><span>Sqlite</span><span> </span><span>-</span><span>v </span><span>3.0</span><span>.</span><span>0</span><span>-</span><span>preview4</span><span>.</span><span>19216.3</span></code></pre><p>Or from the Package Manager Console in Visual Studio:</p><pre><code><span>PM</span><span>&gt;</span><span> </span><span>Install</span><span>-</span><span>Package</span><span> </span><span>Microsoft</span><span>.</span><span>EntityFrameworkCore</span><span>.</span><span>Sqlite</span><span> </span><span>-</span><span>Version</span><span> </span><span>3.0</span><span>.</span><span>0</span><span>-</span><span>preview4</span><span>.</span><span>19216.3</span></code></pre><p>See the&nbsp;<a href="https://docs.microsoft.com/ef/core/what-is-new/ef-core-3.0/breaking-changes#entity-framework-core-is-no-longer-part-of-the-aspnet-core-shared-framework" target="_blank">breaking change details</a>&nbsp;for more information.</p><h3>The dotnet ef tool is no longer part of the .NET Core SDK</h3><p>This change allows us to ship&nbsp;<code>dotnet ef</code>&nbsp;as a regular .NET CLI tool that can be installed as either a global or local tool.For example, to be able to manage migrations or scaffold a&nbsp;<code>DbContext</code>, install&nbsp;<code>dotnet ef</code>&nbsp;as a global tool typing the following command:</p><pre><code><span>$ dotnet tool install </span><span>--</span><span>global</span><span> dotnet</span><span>-</span><span>ef </span><span>--</span><span>version </span><span>3.0</span><span>.</span><span>0</span><span>-</span><span>preview4</span><span>.</span><span>19216.3</span></code></pre><p>For more information, see&nbsp;<a href="https://docs.microsoft.com/ef/core/what-is-new/ef-core-3.0/breaking-changes#the-ef-core-command-line-tool-dotnet-ef-is-no-longer-part-of-the-net-core-sdk" target="_blank">this breaking change’s details</a>.</p><h3>Dependent entities sharing tables with their principal entities can now be optional</h3><p>This enables for example, owned entities mapped to the same table as the owner to be optional, which is a frequently requested improvement.</p><p>See issue&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/9005" target="_blank">#9005</a>&nbsp;for more details.</p><h3>Key generation improvements for in-memory database</h3><p>We have made several improvements to simplify using in-memory database for unit testing. For example, each generated property now gets incremented independently. Also, when the database is deleted, key generation is reset and starts at 1. Finally, if a property in an entity contains a value larger than the last value returned by the generator, the latter is bumped to start on the next available value.</p><p>For more details, see issue&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/6872" target="_blank">#6872</a>.</p><h3>Separate methods for working with raw SQL queries as plain strings or interpolated strings</h3><p>The existence of method overloads accepting SQL as plain strings or interpolated strings made it very hard to predict which version would be used and how parameters would be processed. To eliminate this source of confusion, we added the new methods&nbsp;<code>FromSqlRaw</code>,&nbsp;<code>FromSqlInterpolated</code>,&nbsp;<code>ExecuteSqlRaw</code>, and&nbsp;<code>ExecuteSqlInterpolated</code>. The existing&nbsp;<code>FromSql</code>&nbsp;and&nbsp;<code>ExecuteSqlCommand</code>&nbsp;methods are now obsolete.</p><p>See issue&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/10996" target="_blank">#10996</a>&nbsp;for more details.</p><h3>Database connection no longer remains open until a TransactionScope is disposed</h3><p>This makes EF Core work better with database providers that are optimized to work with System.Transactions, like SqlClient and Npgsql.</p><p>See&nbsp;<a href="https://docs.microsoft.com/ef/core/what-is-new/ef-core-3.0/breaking-changes#database-connection-is-now-closed-if-not-used-anymore-before-the-transactionscope-has-been-completed" target="_blank">this breaking change’s details</a>&nbsp;for more information.</p><h3>Code Analyzer that detects usage of EF Core internal APIs</h3><p>EF Core exposes some of its internal APIs in public types. For example, all types under nested EF Core namespaces named&nbsp;<code>Internal</code>&nbsp;are considered internal APIs even if they are technically public types. In the past, this made it easy for application developers and provider writers to unintentionally use internal APIs in their code. With this new analyzer, using EF Core internal APIs produces a warning by default. For example:</p><p><i>EF1001: Microsoft.EntityFrameworkCore.Internal.MethodInfoExtensions is an internal API that supports the Entity Framework Core infrastructure and not subject to the same compatibility standards as public APIs. It may be changed or removed without notice in any release.</i></p><p>If the usage is intentional, the warning can be suppressed like any code analysis warning.</p><p>See issue&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/12104" target="_blank">#12104</a>&nbsp;for more details.</p><h3>Improved performance of iterating over tracked entities using .Local</h3><p>We have improved the implementation so that iterating over the contents of <code>.Local</code>&nbsp;is around three times faster. If you are going to iterate multiple times, you should still consider calling <code>ToObservableCollection()</code> first.</p><p>See issue&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/14231" target="_blank">#14231</a>&nbsp;for more details.</p><h3>The concept of query types has been renamed to entities without keys</h3><p><em>Note that this change was included in preview 3 but wasn’t previously announced in this blog.</em></p><p>Query types were introduced in EF Core 2.1 to enable reading data from database tables and views that didn’t contain unique keys. Having query types as a separate concept from entity types has proven to obscure their purpose and what makes them different. It also led us to have to introduce some undesired redundancy and unintended inconsistencies in our APIs. We believe the consolidation of the concepts and eventual removal of the query types API will help reduce the confusion.</p><p>See&nbsp;<a href="https://docs.microsoft.com/ef/core/what-is-new/ef-core-3.0/breaking-changes#query-types-are-consolidated-with-entity-types" target="_blank">the breaking change details</a>&nbsp;for more information.</p><h3>New preview of the Cosmos DB provider for EF Core</h3><p>Although the work is still far from complete, we have been making progress on the provider in successive previews of EF Core 3.0. For example, the new version takes advantage of the&nbsp;<a href="https://www.nuget.org/packages/Microsoft.Azure.Cosmos/" target="_blank">new Cosmos DB SDK</a>, enables customizing the names of properties used in the storage, handles value conversions, uses a deterministic approach for key generation, and allows specifying the Azure region to use.</p><p>For full details, see the&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/12086" target="_blank">Cosmos DB provider task list</a>&nbsp;on our issue tracker.</p><h2 id="whats-next">What’s next?<a href="#whats-next"></a></h2><p>As detailed&nbsp;<a href="https://docs.microsoft.com/ef/core/what-is-new/ef-core-3.0/features" target="_blank">in our list of new features</a>, in 3.0 we plan to deliver an improved LINQ implementation, Cosmos DB support, support for C# 8.0 features like nullable reference types and async collections, reverse engineering of database views, property bag entities, and a new version of EF6 that can run on .NET Core.</p><p>In the first 4 previews, we focused most of our efforts on the improvements that we believed could have the highest impact on existing applications and database providers tying to upgrade from previous versions. Implementing these “breaking changes” and architectural improvements early on gives us more time to gather feedback and react to unanticipated issues. But it also means that many of those important features have had to wait until later previews. At this point, you can expect initial support for most of the 3.0 features to arrive within the next couple of preview cycles.</p><p>In order to make it easier for you to track our progress, from now on, we will be posting <a href="https://github.com/aspnet/EntityFrameworkCore/issues/15403" target="_blank">weekly status updates</a>&nbsp;on GitHub. You can subscribe to notifications to get an email every time we post an update.</p><p>We would also like to take this opportunity to talk about important adjustments we are making moving forward:</p><h3>EF Core 3.0 will target .NET Standard 2.1</h3><p>After investigating several options, we have concluded that making EF Core 3.0 target .NET Standard 2.1 is the best path to take advantage of new features in .NET and C#, like integration with <code>IAsyncEnumerable&lt;T&gt;</code>. This is consistent with similar decisions announced last year for&nbsp;ASP.NET&nbsp;Core 3.0 and C# 8.0, and enables us to move forward without introducing compatibility adapters that could hinder our ability to deliver great new functionality on .NET Core down the road.</p><p>Although Preview 4 still targets .NET Standard 2.0, the RTM version will require 2.1 and therefore will not be compatible with .NET implementations that only support .NET Standard 2.0, like .NET Framework. Customers that need to run EF Core on .NET Framework, should plan to continue using EF Core 2.1 or 2.2.</p><h3>EF 6.3 will target .NET Standard 2.1, in addition to already supported .NET Framework versions</h3><p>We found that the API surface offered by .NET Standard 2.1 is adequate for supporting EF6 without removing any runtime features. In addition to .NET Standard 2.1, the EF 6.3 NuGet package will as usual support .NET Framework 4.0 (without async support) and .NET Framework 4.5 and newer. For the time being, we are only going to test and support EF 6.3 running on .NET Framework and .NET Core 3.0. But targeting .NET Standard 2.1 opens the possibility to have EF 6.3 working on other .NET implementations, as long as they fully implement the standard and don’t have other runtime limitations.</p><h2 id="closing">Closing<a href="#closing"></a></h2><p>The EF team would like to thank everyone for their feedback and their contributions to this preview. Once more, we encourage you to try out the latest bits and submit any new feedback to&nbsp;<a href="https://github.com/aspnet/EntityFrameworkCore/issues/new" target="_blank">our issue tracker</a>.</p></div></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>