<!DOCTYPE html>
<html lang="en">
<head>
    <title>
.NET Fest 2018. Sasha Goldshtein. Profiling and Debugging .NET Core A&#x2026; - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content=".NET Fest 2018. Sasha Goldshtein. Profiling and Debugging .NET Core A&#x2026; - linksfor.dev(s)"/>
    <meta property="article:author" content="NETFest"/>
    <meta property="og:description" content="OK, great, you can now run your favorite ASP.NET app or console application on Linux using .NET Core. What happens next? In fact, what happens straight after d&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.slideshare.net/NETFest/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - .NET Fest 2018. Sasha Goldshtein. Profiling and Debugging .NET Core A&#x2026;</title>
<div class="readable">
        <h1>.NET Fest 2018. Sasha Goldshtein. Profiling and Debugging .NET Core A&#x2026;</h1>
            <div>by NETFest</div>
            <div>Reading time: 11-13 minutes</div>
        <div>Posted here: 15 Apr 2019</div>
        <p><a href="https://www.slideshare.net/NETFest/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux">https://www.slideshare.net/NETFest/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
        
        


      

        <p><span>Successfully reported this slideshow.</span>
  </p>


      
















<div id="slideview-container">
  

  <div>

    <div id="main-panel">


      

      <div itemscope="" itemtype="https://schema.org/MediaObject">


        <div>
          <meta itemprop="inLanguage" content="en">
          <meta itemprop="image" content="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-1-638.jpg?cb=1543225424">
          <meta itemprop="thumbnailUrl" content="https://cdn.slidesharecdn.com/ss_thumbnails/linux-net-profiling-debugging-181126094100-thumbnail.jpg?cb=1543225424">
          <meta itemprop="embedURL" content="https://www.slideshare.net/slideshow/embed_code/key/1k8JGyoDQAi9dI">
          <meta itemprop="playerType" content="HTML5">
          <meta itemprop="interactionCount" content="UserComments:1">
          <meta itemprop="interactionCount" content="UserLikes:1">
          <meta itemprop="interactionCount" content="UserDownloads:0">
          <meta itemprop="interactionCount" content="UserPageVisits:545">
          <meta itemprop="interactionCount" content="UserPlays:545">
          <meta itemprop="interactionCount" content="UserPlusOnes:0" id="meta-google">


          

          <ul id="slideshow-actions">
            <li>
              
            </li>
              <li>
                
              </li>

            <!-- Report/Flag Content -->
            <li>
              <a data-dropdown="report-dropdown" aria-controls="report-dropdown" aria-expanded="false">
                <span>...</span></a>
              <span title="You have reported this as inappropriate">
                <i></i>
                <span aria-label="You have reported this as inappropriate"></span>
              </span>
              
            </li>
          </ul>


          <div itemprop="author" itemscope="" itemtype="https://schema.org/Organization">

            <p><a href="https://www.slideshare.net/NETFest?utm_campaign=profiletracking&amp;utm_medium=sssite&amp;utm_source=ssslideview" title="NETFest" itemprop="url">
                <img alt="NETFest" itemprop="image" src="https://public.slidesharecdn.com/images/user-48x48.png">
              </a>
            </p>

            
          </div>

            

          <p>
            <small>
              Published on <time datetime="Nov 26, 2018" itemprop="datePublished">Nov 26, 2018</time>
            </small>
          </p>

            <div>
              <div data-ga-cat="bigfoot_slideview" data-ga-action="description>more">
                <p id="slideshow-description-paragraph">
                    OK, great, you can now run your favorite ASP.NET app or console application on </p>
                
              </div>
            </div>


            



        </div>


        

            <div>
              
              <ol itemprop="text">
                    <li>
      1.
    Debugging And
Profiling
.NET Core Apps
on Linux
Sasha Goldshtein
@goldshtn
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-2-638.jpg?cb=1543225424" title="The Plan
‚Ä¢ This is a talk on debugging and profiling .NET C..." target="_blank">
        2.
      </a>
    The Plan
‚Ä¢ This is a talk on debugging and profiling .NET Core apps on Linux‚Äî
yes, it‚Äôs pretty crazy that we got that far!
‚Ä¢ You‚Äôll learn:
ÔÅ±To profile CPU activity in .NET Core apps
ÔÅ±To visualize stack traces (e.g. of CPU samples) using flame graphs
ÔÅ±To use Linux tracing tools with .NET Core processes
ÔÅ±To capture .NET Core runtime events using LTTng
ÔÅ±To generate and analyze core dumps of .NET Core apps
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-3-638.jpg?cb=1543225424" title="üéì Disclaimer
‚Ä¢ A lot of this stuff has changed, and is chan..." target="_blank">
        3.
      </a>
    üéì Disclaimer
‚Ä¢ A lot of this stuff has changed, and is changing
‚Ä¢ The tools described here mostly work with .NET Core 2.x, but your
mileage may vary
‚Ä¢ Some of this relies on scripts I hacked together, and will hopefully* be
officially supported in the future
*I‚Äôve been saying this for almost two years now
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-4-638.jpg?cb=1543225424" title="Tools And Operating Systems Supported
Linux Windows macOS
C..." target="_blank">
        4.
      </a>
    Tools And Operating Systems Supported
Linux Windows macOS
CPU sampling perf, BCC ETW Instruments, dtrace
Dynamic tracing perf, SystemTap, BCC ‚õîÔ∏è dtrace
Static tracing LTTng ETW ‚õîÔ∏è
Dump generation core_pattern, gcore Procdump, WER kern.corefile, gcore
Dump analysis lldb Visual Studio, WinDbg lldb
This talk
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-5-638.jpg?cb=1543225424" title="‚ö†Ô∏è Mind The Overhead
‚Ä¢ Any observation can change the state..." target="_blank">
        5.
      </a>
    ‚ö†Ô∏è Mind The Overhead
‚Ä¢ Any observation can change the state of the system, but some
observations are worse than others
‚Ä¢ Diagnostic tools have overhead
‚Ä¢ Check the docs
‚Ä¢ Try on a test system first
‚Ä¢ Measure degradation introduced by the tool
OVERHEAD
This traces various kernel page cache functions and maintains in-kernel counts, which are asynchronously copied
to user-space. While the rate of operations can be very high (&gt;1G/sec) we can have up to 34% overhead, this is still
a relatively efficient way to trace these events, and so the overhead is expected to be small for normal
workloads. Measure in a test environment.
‚Äîman cachestat (from BCC)
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-6-638.jpg?cb=1543225424" title="Sampling vs. Tracing
‚Ä¢ Sampling works by getting a snapshot..." target="_blank">
        6.
      </a>
    Sampling vs. Tracing
‚Ä¢ Sampling works by getting a snapshot or a call stack every N
occurrences of an interesting event
‚Ä¢ For most events, implemented in the PMU using overflow counters and
interrupts
‚Ä¢ Tracing works by getting a message or a call stack at every occurrence
of an interesting event
CPU timepid 121 pid 121 pid 408 pid 188
system timepid 121 pid 408
CPU sample
disk write
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-7-638.jpg?cb=1543225424" title=".NET Core on Linux Tracing Architecture
kernel
user
.NET Co..." target="_blank">
        7.
      </a>
    .NET Core on Linux Tracing Architecture
kernel
user
.NET Core app
CoreCLR
OS libraries
CPU
EventSource events
CLR events (LTTng)
Probes, USDT
Tracepoints (scheduler, block I/O, networking)
‚ÄúSoftware events‚Äù (core migrations, page faults)
PMU events (clock cycles, branches, LLC misses)
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-8-638.jpg?cb=1543225424" title="The Official Story: perfcollect and PerfView
1. Download pe..." target="_blank">
        8.
      </a>
    The Official Story: perfcollect and PerfView
1. Download perfcollect
2. Install prerequisites: ./perfcollect install
3. Run collection: ./perfcollect collect mytrace
4. Copy the mytrace.zip file to a Windows machine üò≥
5. Download PerfView üòÅ
6. Open the trace in PerfView üò±
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-9-638.jpg?cb=1543225424" title="perf
‚Ä¢ perf is a Linux multi-tool for performance investiga..." target="_blank">
        9.
      </a>
    perf
‚Ä¢ perf is a Linux multi-tool for performance investigations
‚Ä¢ Capable of both tracing and sampling
‚Ä¢ Developed in the kernel tree, must match running kernel‚Äôs version
‚Ä¢ Debian-based: apt install linux-tools-common
‚Ä¢ RedHat-based: yum install perf
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-10-638.jpg?cb=1543225424" title="perf_events Architecture
UserKernel
tcp_msgsend
Page fault
..." target="_blank">
        10.
      </a>
    perf_events Architecture
UserKernel
tcp_msgsend
Page fault
LLC miss
sched_switch
perf_events
libc:malloc
mmap buffer
mmap buffer
Real-time
analysis
perf script‚Ä¶perf.data file
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-11-638.jpg?cb=1543225424" title="Five Things That Will Happen To You If You
Don‚Äôt Have Symbo..." target="_blank">
        11.
      </a>
    Five Things That Will Happen To You If You
Don‚Äôt Have Symbolic Debug Information
The stuff we care about
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-12-638.jpg?cb=1543225424" title="Getting Debug Information
Type Debug information source
SyS..." target="_blank">
        12.
      </a>
    Getting Debug Information
Type Debug information source
SyS_write Kernel /proc/kallsyms
__write Native Debuginfo package
System.IO.SyncText‚Ä¶ Managed (AOT) Crossgen or COMPlus_ZapDisable=1
System.Console.WriteLine Managed (AOT) Crossgen or COMPlus_ZapDisable=1
MyApp.Program.Foo Managed (JIT) /tmp/perf-$PID.map
MyApp.Program.Main Managed (JIT) /tmp/perf-$PID.map
ExecuteAssembly Native (CLR) dotnet symbols or source build
CorExeMain Native (CLR) dotnet symbols or source build
__libc_start_main Native Debuginfo package
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-13-638.jpg?cb=1543225424" title="üî• Flame Graphs
‚Ä¢ A visualization method (adjacency graph), ..." target="_blank">
        13.
      </a>
    üî• Flame Graphs
‚Ä¢ A visualization method (adjacency graph), very
useful for stack traces, invented by Brendan
Gregg
‚Ä¢ http://www.brendangregg.com/flamegraphs.html
‚Ä¢ Turns thousands of stack trace pages into a
single interactive graph
‚Ä¢ Example scenarios:
‚Ä¢ Identify CPU hotspots on the system/application
‚Ä¢ Show stacks that perform heavy disk accesses
‚Ä¢ Find threads that block for a long time and the stack
where they do it
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-14-638.jpg?cb=1543225424" title="Reading a Flame Graph
‚Ä¢ Each rectangle is a function
‚Ä¢ Y-ax..." target="_blank">
        14.
      </a>
    Reading a Flame Graph
‚Ä¢ Each rectangle is a function
‚Ä¢ Y-axis: caller-callee
‚Ä¢ X-axis: sorted stacks (not time)
‚Ä¢ Wider frames are more common
‚Ä¢ Supports zoom, find
‚Ä¢ Filter with grep üòé
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-15-638.jpg?cb=1543225424" title="$ COMPlus_PerfMapEnabled=1 ./myapp
# perf record -g -p $(pi..." target="_blank">
        15.
      </a>
    $ COMPlus_PerfMapEnabled=1 ./myapp
# perf record -g -p $(pidof Buggy) -F 97
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-16-638.jpg?cb=1543225424" title="# perf report
 " target="_blank">
        16.
      </a>
    # perf report
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-17-638.jpg?cb=1543225424" title="# perf script | stackcollapse-perf.pl | FlameGraph.pl > fla..." target="_blank">
        17.
      </a>
    # perf script | stackcollapse-perf.pl | FlameGraph.pl &gt; flame.svg
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-18-638.jpg?cb=1543225424" title="The Old Way And The New Way: BPF
kernel
u{,ret}probe:
mallo..." target="_blank">
        18.
      </a>
    The Old Way And The New Way: BPF
kernel
u{,ret}probe:
malloc
perf_events perf.data
user
perf | awk | ‚Ä¶
report
bytes # distribution
0 - 1 ‚Ä¶ |@@@@ |
1 ‚Äì 2 ‚Ä¶ |@ |
2 - 4 ‚Ä¶ |@@@@@@@@ |
kernel
u{,ret}probe:
malloc
BPF program BPF map
user
control program
report
bytes # distribution
0 - 1 ‚Ä¶ |@@@@ |
1 ‚Äì 2 ‚Ä¶ |@ |
2 - 4 ‚Ä¶ |@@@@@@@@ |
user
libc:malloc
user
libc:malloc
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-19-638.jpg?cb=1543225424" title="The BCC BPF Front-End
‚Ä¢ https://github.com/iovisor/bcc
‚Ä¢ BP..." target="_blank">
        19.
      </a>
    The BCC BPF Front-End
‚Ä¢ https://github.com/iovisor/bcc
‚Ä¢ BPF Compiler Collection (BCC) is a
BPF frontend library and a massive
collection of performance tools
‚Ä¢ Contributors from Facebook, PLUMgrid,
Netflix, Sela
‚Ä¢ Helps build BPF-based tools in high-
level languages
‚Ä¢ Python, Lua, C++
‚Ä¢ Up-and-coming competitor: bpftrace
kernel
user
BCC tool BCC tool ‚Ä¶
BCC compiler frontend
Clang + LLVM
BCC loader library
BPF runtime
event
sources
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-20-638.jpg?cb=1543225424" title="Managed runtimes
Syscall interface
Block I/O Ethernet
Sched..." target="_blank">
        20.
      </a>
    Managed runtimes
Syscall interface
Block I/O Ethernet
Scheduler Mem
Device drivers
Filesystem TCP/IP
CPU
Applications
System libraries
profile
llcstat
hardirqs
softirqs
ttysnoop
runqlat
cpudist
offcputime
offwaketime
cpuunclaimed
memleak
oomkill
slabratetoptcptop
tcplife
tcpconnect
tcpaccept
biotop
biolatency
biosnoop
bitesize
filetop
filelife
fileslower
vfscount
vfsstat
cachestat
cachetop
mountsnoop
*fsslower
*fsdist
dcstat
dcsnoop
mdflush
execsnoop
opensnoop
killsnoop
statsnoop
syncsnoop
setuidsnoop
mysqld_qslower
bashreadline
dbslower
dbstat
mysqlsniff
memleak
sslsniff
gethostlatency
deadlock_detector
ustat
ugc
uthreads
ucalls
uflow
argdist
trace
funccount
funclatency
stackcount
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-21-638.jpg?cb=1543225424" title="# syscount -c -p $(pidof Buggy)
# opensnoop -p $(pidof Bugg..." target="_blank">
        21.
      </a>
    # syscount -c -p $(pidof Buggy)
# opensnoop -p $(pidof Buggy)
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-22-638.jpg?cb=1543225424" title="# funccount -p $(pidof Buggy) ‚Ä¶/libcoreclr.so:*GarbageColle..." target="_blank">
        22.
      </a>
    # funccount -p $(pidof Buggy) ‚Ä¶/libcoreclr.so:*GarbageCollect*
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-23-638.jpg?cb=1543225424" title="# stackcount -p $(pidof Buggy) ‚Ä¶/libcoreclr.so:*GarbageColl..." target="_blank">
        23.
      </a>
    # stackcount -p $(pidof Buggy) ‚Ä¶/libcoreclr.so:*GarbageCollect*
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-24-638.jpg?cb=1543225424" title="LTTng Architecture
UserKernel
SyS_write
SyS_read LLTng
kern..." target="_blank">
        24.
      </a>
    LTTng Architecture
UserKernel
SyS_write
SyS_read LLTng
kernel
module
myapp:myprobe
buffer lttng --live
babeltraceCTF file
buffer
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-25-638.jpg?cb=1543225424" title="$ COMPlus_EnableEventLog=1 ./myapp
# lttng create my-trace
..." target="_blank">
        25.
      </a>
    $ COMPlus_EnableEventLog=1 ./myapp
# lttng create my-trace
# lttng enable-event --userspace --tracepoint DotNetRuntime:*
# lttng start
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-26-638.jpg?cb=1543225424" title="Plotting data from GCStats events,
original work by Aleksei..." target="_blank">
        26.
      </a>
    Plotting data from GCStats events,
original work by Aleksei Vereshchagin
at DotNext Saint Petersburg
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-27-638.jpg?cb=1543225424" title="üöÆ Core Dumps
‚Ä¢ A core dump is a memory snapshot of a runnin..." target="_blank">
        27.
      </a>
    üöÆ Core Dumps
‚Ä¢ A core dump is a memory snapshot of a running process
‚Ä¢ Can be generated on crash or on demand
dump file
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-28-638.jpg?cb=1543225424" title="Generating Core Dumps
‚Ä¢ /proc/sys/kernel/core_pattern confi..." target="_blank">
        28.
      </a>
    Generating Core Dumps
‚Ä¢ /proc/sys/kernel/core_pattern configures the core file name or
application to process the crash
‚Ä¢ ulimit -c controls maximum core file size (often 0 by default)
‚Ä¢ gcore (part of gdb) can create a core dump on demand
‚Ä¢ CoreCLR ships with a createdump utility
‚Ä¢ There‚Äôs also Procdump for Linux üôÄüò±
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-29-638.jpg?cb=1543225424" title="Analyzing .NET Core Dumps
$ lldb /usr/bin/dotnet -c core.17..." target="_blank">
        29.
      </a>
    Analyzing .NET Core Dumps
$ lldb /usr/bin/dotnet -c core.1788
(lldb) bt
The stuff we care about
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-30-638.jpg?cb=1543225424" title="libsosplugin.so
(lldb) plugin load ‚Ä¶/libsosplugin.so
(lldb)..." target="_blank">
        30.
      </a>
    libsosplugin.so
(lldb) plugin load ‚Ä¶/libsosplugin.so
(lldb) setclrpath ‚Ä¶
DumpObj
DumpArray
DumpHeap
GCRoot
PrintException
Threads
ClrStack
EEHeap
DumpDomain
DumpAssembly
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-31-638.jpg?cb=1543225424" title="Checklist: Preparing Your Environment
ÔÅ±export COMPlus_PerfM..." target="_blank">
        31.
      </a>
    Checklist: Preparing Your Environment
ÔÅ±export COMPlus_PerfMapEnabled=1
ÔÅ±AOT perf map with crossgen, or COMPlus_ZapDisable=1
ÔÅ±Debuginfo package for libcoreclr, libc
ÔÅ±Install perf/BCC tools
ÔÅ±export COMPlus_EnableEventLog=1
ÔÅ±ulimit -c unlimited (or managed by system)
ÔÅ±Install lldb-3.x
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-32-638.jpg?cb=1543225424" title="Summary
‚Ä¢ We have learned:
ÔÉºTo profile CPU activity in .NET..." target="_blank">
        32.
      </a>
    Summary
‚Ä¢ We have learned:
ÔÉºTo profile CPU activity in .NET Core apps
ÔÉºTo visualize stack traces (e.g. of CPU samples) using flame graphs
ÔÉºTo use Linux tracing tools with .NET Core processes
ÔÉºTo capture .NET Core runtime events using LTTng
ÔÉºTo generate and analyze core dumps of .NET Core apps
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-33-638.jpg?cb=1543225424" title="References
‚Ä¢ perf and flame graphs
‚Ä¢ https://perf.wiki.kern..." target="_blank">
        33.
      </a>
    References
‚Ä¢ perf and flame graphs
‚Ä¢ https://perf.wiki.kernel.org/index.php/Main_Page
‚Ä¢ http://www.brendangregg.com/perf.html
‚Ä¢ https://github.com/brendangregg/perf-tools
‚Ä¢ .NET Core diagnostics docs
‚Ä¢ https://github.com/dotnet/coreclr/blob/master/Do
cumentation/project-docs/linux-performance-
tracing.md
‚Ä¢ https://github.com/dotnet/coreclr/blob/master/Do
cumentation/building/debugging-instructions.md
‚Ä¢ My blog posts
‚Ä¢ http://blogs.microsoft.co.il/sasha/2017/02/26/anal
yzing-a-net-core-core-dump-on-linux/
‚Ä¢ http://blogs.microsoft.co.il/sasha/2017/02/27/profi
ling-a-net-core-application-on-linux/
‚Ä¢ http://blogs.microsoft.co.il/sasha/2017/03/30/traci
ng-runtime-events-in-net-core-on-linux/
‚Ä¢ BCC tutorials
‚Ä¢ https://github.com/iovisor/bcc/blob/master/docs/t
utorial.md
‚Ä¢ https://github.com/iovisor/bcc/blob/master/docs/t
utorial_bcc_python_developer.md
‚Ä¢ https://github.com/iovisor/bcc/blob/master/docs/r
eference_guide.md
 
  </li>
  <li>
      <a href="https://image.slidesharecdn.com/linux-net-profiling-debugging-181126094100/95/net-fest-2018-sasha-goldshtein-profiling-and-debugging-net-core-apps-on-linux-34-638.jpg?cb=1543225424" title="Thank You!
@goldshtn
 " target="_blank">
        34.
      </a>
    Thank You!
@goldshtn
 
  </li>

              </ol>
            </div>
      </div>
    </div>

    
  </div>
</div>










      

      

        
    </div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>