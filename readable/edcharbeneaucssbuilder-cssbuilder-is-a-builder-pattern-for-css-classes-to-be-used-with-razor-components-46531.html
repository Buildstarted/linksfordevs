<!DOCTYPE html>
<html lang="en">
<head>
    <title>
EdCharbeneau/CssBuilder - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="EdCharbeneau/CssBuilder - linksfor.dev(s)"/>
    <meta property="og:description" content="CssBuilder is a Builder pattern for CSS classes to be used with Razor Components. - EdCharbeneau/CssBuilder"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/EdCharbeneau/CssBuilder"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - EdCharbeneau/CssBuilder</title>
<div class="readable">
        <h1>EdCharbeneau/CssBuilder</h1>
            <div>Reading time: 6-7 minutes</div>
        <div>Posted here: 05 Jan 2020</div>
        <p><a href="https://github.com/EdCharbeneau/CssBuilder">https://github.com/EdCharbeneau/CssBuilder</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="readme">
    
        

      <div>
        <article itemprop="text">
<p><strong><a href="https://github.com/EdCharbeneau/CssBuilder/wiki/Getting-started#getting-setup">Read the full API docs in the Wiki section</a></strong></p>
<p>When building complex components for ASP.NET Razor Components there are often CSS classes generated by multiple factors.
Styles can often be added by system &amp; component state, public parameters, and static base CSS classes.
Combining many CSS classes together doesn't scale well, and when components get large it can be tough to reason about.
The CSS builder pattern fixes this problem by offering a easy to repeat, easy to read pattern to use across components in a project.
A clean code approach to conditional CSS in Razor Components.</p>
<h2>The problem</h2>
<p>Given the component below, the Tab's CSS class is set by multiple sources.
The component has paramater <code>UserCss</code> which can be set at externally.
A base CSS class <code>bl-nav-link</code> which does not change.
Two state based CSS classes <code>bl-active</code> and <code>bl-disabled</code> which are dependent on if the Tab is active or disabled.
Rendering for the CSS class is spread across multiple concerns and is hard to maintain.</p>
<p><strong>Component</strong></p>
<div><pre>&lt;<span>Tab</span> <span>UserCss</span>=<span><span>"</span>my-class<span>"</span></span> <span>Disabled</span>=<span>true</span> &gt;...&lt;/<span>Tab</span>&gt;</pre></div>
<p><strong>Component Source Markup</strong></p>
<div><pre>&lt;<span>li</span> <span>class</span>=<span><span>"</span>bl-nav-item<span>"</span></span>&gt;
    &lt;<span>a</span> <span>onclick</span>=<span>@Activate</span> <span>class</span>=<span><span>"</span>bl-nav-link @ActiveCssClass @DisabledCssClass<span>"</span></span> <span>role</span>=<span><span>"</span>button<span>"</span></span>&gt;
        @Title
    &lt;/<span>a</span>&gt;
&lt;/<span>li</span>&gt;</pre></div>
<p><strong>Component Source Logic</strong></p>
<div><pre>[<span>Parameter</span>] <span>string</span> <span>UserCss</span> <span>=</span> <span>String</span>.<span>Empty</span>;
<span>protected</span> <span>string</span> <span>ActiveCssClass</span> =&gt; <span>IsActive</span> ? "<span>bl</span>-<span>active</span>" : <span>String</span>.<span>Empty</span>;
<span>protected</span> <span>string</span> <span>DisabledCssClass</span> =&gt; <span>Disabled</span> ? "<span>bl</span>-<span>disabled</span>" : <span>String</span>.<span>Empty</span>;</pre></div>
<h2>The Solution</h2>
<p>Using the CSS Builder pattern we can clean up the code and move everything to a single concern.
Refactoring the component, we move all of the CSS code to the components logic.
In the <code>OnParameterSet</code> lifecycle method, we condense all of the CSS responsibilities into a single variable <code>ClassToRender</code> (this name variable is optional).
Next, using the <code>CssBuilder</code> we define what classes should be added to the builder and when they should be rendered.
The pattern is as follows <code>AddClass</code> the CSS class and the condition when it should appear <code>AddClass(value, when: bool)</code>.
If the value is static, we can discard the <code>when</code> parameter.
Finally, Build is called. All CSS classes are then combined into a single string, properly spaced and trimmed.</p>
<p>The refactored code becomes:</p>
<p><strong>Component Source Markup (refactor)</strong></p>
<div><pre>&lt;<span>li</span> <span>class</span>=<span><span>"</span>bl-nav-item<span>"</span></span>&gt;
    &lt;<span>a</span> <span>onclick</span>=<span>@Activate</span> <span>class</span>=<span><span>"</span>@ClassToRender<span>"</span></span> <span>role</span>=<span><span>"</span>button<span>"</span></span>&gt;
        @Title
    &lt;/<span>a</span>&gt;
&lt;/<span>li</span>&gt;</pre></div>
<p><strong>Component Source Logic (refactor)</strong></p>
<div><pre><span>protected</span> <span>override</span> <span>void</span> <span>OnParametersSet</span>()
{
    <span>ClassToRender</span> <span>=</span> <span>new</span> <span>CssBuilder</span>(<span>UserCss</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-nav-link<span>"</span></span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-active<span>"</span></span>, <span>when</span>: <span>IsActive</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-disabled<span>"</span></span>, <span>when</span>: <span>Disabled</span>)
                        .<span>Build</span>();
}</pre></div>
<h2>Dynamic values</h2>
<p>If you encounter a dynamic value where some string is added to a CSS class name, we can easily handle this as well.
Consider the CSS namespace <code>bl-</code> must be prefixed to a value <code>SomeValue</code> supplied by the component state or user input.
This is easily handled with string interpolation <code>${var}</code>.</p>
<div><pre><span>protected</span> <span>override</span> <span>void</span> <span>OnParametersSet</span>()
{
    <span>ClassToRender</span> <span>=</span> <span>new</span> <span>CssBuilder</span>(<span>UserCss</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-nav-link<span>"</span></span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-active<span>"</span></span>, <span>when</span>: <span>IsActive</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-disabled<span>"</span></span>, <span>when</span>: <span>Disabled</span>)
			.<span>AddClass</span>(<span><span>"</span>bl-${SomeValue}<span>"</span></span>, <span>when</span>: <span>IsConditionMet</span>)
                        .<span>Build</span>();
}</pre></div>
<h2>Attribute Splatting</h2>
<p>If you encounter dynamic values due to <a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/components?view=aspnetcore-3.1#attribute-splatting-and-arbitrary-parameters" rel="nofollow">attribute splatting</a>, we can easily handle this as well.
Consider the senario where we need to merge a splatted CSS attribute while preserving default values.</p>
<div><pre><span><span>&lt;!--</span> API <span>--&gt;</span></span>
&lt;<span>MyComponent</span> <span>class</span>=<span><span>"</span>custom-value<span>"</span></span>&gt;
<span><span>&lt;!--</span> Output <span>--&gt;</span></span>
&lt;<span>div</span> <span>class</span>=<span><span>"</span>my-base custom-value<span>"</span></span>&gt;</pre></div>
<div><pre><span>&lt;</span><span>div</span> <span>@attributes</span><span>=</span><span><span>"</span>AdditionalAttributes<span>"</span></span> <span>class</span><span>=</span><span><span>"</span>@CssClass<span>"</span></span><span>&gt;</span>

<span>@code</span> {

    [<span>Parameter</span>(<span>CaptureUnmatchedValues</span> <span>=</span> <span>true</span>)]
    <span>public</span> <span>IReadOnlyDictionary</span><span>&lt;</span><span>string</span>, <span>object</span><span>&gt;</span> <span>AdditionalAttributes</span> { <span>get</span>; <span>set</span>; } <span>=</span> <span>new</span> <span>Dictionary</span>&lt;<span>string</span>, <span>Object</span>&gt;();

    <span>CssBuilder</span> <span>CssClass</span> <span>=&gt;</span> <span>new</span> <span>CssBuilder</span>(<span><span>"</span>my-base<span>"</span></span>).<span>AddClassFromAttributes</span>(<span>attributes</span>);
}</pre></div>
<h2>Func When</h2>
<p>Func is also accepted as an arguement for the <code>when</code> parameter. This allows either inline functions or named functions to be called directly.</p>
<div><pre><span>protected</span> <span>override</span> <span>void</span> <span>OnParametersSet</span>()
{
    <span>ClassToRender</span> <span>=</span> <span>new</span> <span>CssBuilder</span>(<span>UserCss</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-nav-link<span>"</span></span>)
			.<span>AddClass</span>(<span><span>"</span>bl-foo<span>"</span></span>, <span>when</span>: ()<span>=&gt;</span> 
			   <span>!</span><span>string</span>.<span>IsNullOrEmpty</span>(<span>Foo</span>) <span>||</span>
                           <span>!</span><span>Disabled</span> <span>||</span>
                           <span>IsActive</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-active<span>"</span></span>, <span>when</span>: <span>IsActive</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-disabled<span>"</span></span>, <span>when</span>: <span>Disabled</span>)
                        .<span>Build</span>();
}</pre></div>
<p>Named function, example.</p>
<div><pre><span>bool</span> <span>HasMeaningfulName</span>() <span>=&gt;</span> <span>!</span><span>string</span>.<span>IsNullOrEmpty</span>(<span>Foo</span>) <span>||</span> <span>!</span><span>Disabled</span> <span>||</span> <span>IsActive</span>);

<span>protected</span> <span>override</span> <span>void</span> <span>OnParametersSet</span>()
{
    <span>ClassToRender</span> <span>=</span> <span>new</span> <span>CssBuilder</span>(<span>UserCss</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-nav-link<span>"</span></span>)
			.<span>AddClass</span>(<span><span>"</span>bl-foo<span>"</span></span>, <span>when</span>: <span>HasMeaningfulName</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-active<span>"</span></span>, <span>when</span>: <span>IsActive</span>)
                        .<span>AddClass</span>(<span><span>"</span>bl-disabled<span>"</span></span>, <span>when</span>: <span>Disabled</span>)
                        .<span>Build</span>();
}</pre></div>
<h2>Removing Unused Attributes</h2>
<p>When using dynamic attributes may result in empty attribute. When Blazor renders an attribute that has an empty string value, it will result in an empty attribute tag.
However, if the value is null the attribute will be excluded. When an empty attribute is expected, the extension method NullIfEmpty can be used to clean up the resulting markup.
Note: This method is only necessary when no default value is supplied. Ex: new CssBuilder() or CssBuilder().Empty(). Forgetting to call NullIfEmpty should not have any impact on the UI.</p>
<div><pre><span><span>&lt;!--</span> Output with Empty String <span>--&gt;</span></span>
&lt;<span>div</span> <span>class</span>=<span><span>"</span><span>"</span></span>&gt;

<span><span>&lt;!--</span> Output with null <span>--&gt;</span></span>
&lt;<span>div</span>&gt;</pre></div>
<div><pre><span>&lt;</span><span>div</span> <span>class</span><span>=</span><span><span>"</span>@CssClass<span>"</span></span><span>&gt;</span>

<span>@code</span> {

    <span><span>//</span>string CssClass =&gt; new CssBuilder().AddClassFromAttributes(attributes).Build();</span>
    <span>string</span> <span>CssClass</span> <span>=&gt;</span> <span>new</span> <span>CssBuilder</span>().<span>AddClassFromAttributes</span>(<span>attributes</span>).<span>NullIfEmpty</span>();
}</pre></div>
</article>
      </div>
  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>