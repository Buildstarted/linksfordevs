<!DOCTYPE html>
<html lang="en">
<head>
    <title>
ASP Classic Journeys: no-store - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="ASP Classic Journeys: no-store - linksfor.dev(s)"/>
    <meta property="article:author" content="Mauricio Rojas"/>
    <meta property="og:description" content="VBUC is a great tool to modernize your ASP Classic Websites. Sometimes when you migrate from ASP Classic we find little subtle details that require attention. One of this subtle details this Cache No-Store setting. Some recommendations on what to do. "/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.mobilize.net/blog/asp-classic-journeys-no-store?hss_channel=tw-4083531"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - ASP Classic Journeys: no-store</title>
<div class="readable">
        <h1>ASP Classic Journeys: no-store</h1>
            <div>by Mauricio Rojas</div>
            <div>Reading time: 1-2 minutes</div>
        <div>Posted here: 27 Mar 2020</div>
        <p><a href="https://www.mobilize.net/blog/asp-classic-journeys-no-store?hss_channel=tw-4083531">https://www.mobilize.net/blog/asp-classic-journeys-no-store?hss_channel=tw-4083531</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
<div>
<div data-widget-type="blog_content" data-x="0" data-w="12">
<div>
    <div>
                
            <p><span id="hs_cos_wrapper_post_body" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>While doing a migration from ASP Classic to ASP.NET we encountered some usages of the "no-store" CacheControl.</p>
<!--more-->
<p>In ASP Classic the accepted values for <a href="https://docs.microsoft.com/en-us/previous-versions/iis/6.0-sdk/ms524721(v%3Dvs.90)" rel=" noopener">CacheControl are</a>:</p>


<p>The .NET implementation only allows some values. Let's see the code for the .NET implementation:</p>
<p><img src="https://www.mobilize.net/hs-fs/hubfs/CacheControl.png?width=705&amp;name=CacheControl.png" alt="CacheControl" width="705" srcset="https://www.mobilize.net/hs-fs/hubfs/CacheControl.png?width=353&amp;name=CacheControl.png 353w, https://www.mobilize.net/hs-fs/hubfs/CacheControl.png?width=705&amp;name=CacheControl.png 705w, https://www.mobilize.net/hs-fs/hubfs/CacheControl.png?width=1058&amp;name=CacheControl.png 1058w, https://www.mobilize.net/hs-fs/hubfs/CacheControl.png?width=1410&amp;name=CacheControl.png 1410w, https://www.mobilize.net/hs-fs/hubfs/CacheControl.png?width=1763&amp;name=CacheControl.png 1763w, https://www.mobilize.net/hs-fs/hubfs/CacheControl.png?width=2115&amp;name=CacheControl.png 2115w" sizes="(max-width: 705px) 100vw, 705px"></p>
<p>So that means that there is no direct equivalent of "no-store"</p>
<p>The closest equivalent can be achieved with code like:</p>
<div>
<pre><span>Response</span><span>.</span><span>Cache</span><span>.</span><span>SetCacheability</span><span>(</span><span>HttpCacheability</span><span>.</span><span>NoCache</span><span>);</span><span><br></span><span>Response</span><span>.</span><span>Cache</span><span>.</span><span>AppendCacheExtension</span><span>(</span><span>"no-store, must-revalidate"</span><span>);</span><span><br></span><span>Response</span><span>.</span><span>AppendHeader</span><span>(</span><span>"Pragma"</span><span>,</span> <span>"no-cache"</span><span>);</span><span><br></span><span>Response</span><span>.</span><span>AppendHeader</span><span>(</span><span>"Expires"</span><span>,</span> <span>"0"</span><span>);</span></pre>
</div>
<p>The first line sets&nbsp;<code>Cache-control</code>&nbsp;to&nbsp;<code>no-cache</code>, and the second line adds the other attributes&nbsp;<code>no-store, must-revalidate</code>.</p>
</span>
        </p>
        
             <p id="hubspot-topic_data"> Topics:
                
                    <a href="https://www.mobilize.net/blog/topic/visual-basic-upgrade-companion">Visual Basic Upgrade Companion</a>,
                
                    <a href="https://www.mobilize.net/blog/topic/asp-net-mvc">ASP.NET/MVC</a>,
                
                    <a href="https://www.mobilize.net/blog/topic/asp">ASP</a>,
                
                    <a href="https://www.mobilize.net/blog/topic/migration">migration</a>,
                
                    <a href="https://www.mobilize.net/blog/topic/upgrade">upgrade</a>
                
             </p>
        

    </div>
</div></div>

</div><!--end row-->
</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>