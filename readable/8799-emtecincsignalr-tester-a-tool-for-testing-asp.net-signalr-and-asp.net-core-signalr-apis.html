<!DOCTYPE html>
<html lang="en">
<head>
    <title>
emtecinc/signalr-tester: A tool for testing Asp.Net SignalR and Asp.Net core SignalR Api&#x27;s -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>emtecinc/signalr-tester: A tool for testing Asp.Net SignalR and Asp.Net core SignalR Api's</h1><div><div id="" class="markdown-body entry-content p-5"><h1><a id="user-content-signalr-tester" class="anchor" aria-hidden="true" href="#signalr-tester"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>signalr-tester</h1><p><a href="https://github.com/emtecinc/signalr-tester/blob/master/LICENSE"><img src="https://camo.githubusercontent.com/e1248d2c1fd8ae738c584991d91cb744502e777a/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f656d746563696e632f7369676e616c722d7465737465722e737667" alt="License" data-canonical-src="https://img.shields.io/github/license/emtecinc/signalr-tester.svg"></a></p><h3><a id="user-content-a-command-line-tool-to-stressload-test-your-signalr-hubs-developed-in-aspnet-signalr-and-aspnet-core-and-see-how-yourapplication-responds-under-a-high-level-of-connection-density-this-tools-allows-you-to-write-your-test-scenarios-using-c-to-handle-complex-scenarios" class="anchor" aria-hidden="true" href="#a-command-line-tool-to-stressload-test-your-signalr-hubs-developed-in-aspnet-signalr-and-aspnet-core-and-see-how-yourapplication-responds-under-a-high-level-of-connection-density-this-tools-allows-you-to-write-your-test-scenarios-using-c-to-handle-complex-scenarios"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A command line tool to stress/load test your SignalR Hubs developed in <strong>Asp.Net SignalR</strong> and <strong>Asp.Net Core</strong> and see how your&nbsp;&nbsp;application responds under a high level of connection density. This tools allows you to write your test scenarios using C# to handle complex scenarios.&nbsp;</h3><h3><a id="user-content-summary" class="anchor" aria-hidden="true" href="#summary"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Summary</h3><h1></h1><p>This tool is a console based application for testing <strong>SignalR Hub</strong>, and supports hub created using <strong>Asp.Net SignalR</strong> and <strong>Asp.Net Core SignalR</strong>. You can create your own test setup as DLL, drop it in to a secific directory of the tool, and you are done!! Tool will do the rest for you.</p><p>Currently it supports following features:</p><ol><li>Creating a connection with Hub.</li><li>Ability to choose transport mechanism i.e. Websockets, SSE, Long Polling or Auto.</li><li>Ability to hook up a startup method which will be called immediately after a successful connection is established with the Hub.</li><li>Ability to hook up other methods which can be called at a later stage, once the connection is established. It can be used to stress out the connection.</li><li>Ability to write any dotnet code for complex test setup scenarios.</li></ol><p><strong>PreRequisite</strong> -</p><ol><li><strong>.Net Framework 4.6.1</strong></li><li><strong><a href="https://dotnet.microsoft.com/download" rel="nofollow">.Net Core 2.2</a></strong></li></ol><h3><a id="user-content-what-options-do-you-have" class="anchor" aria-hidden="true" href="#what-options-do-you-have"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What options do you have?</h3><h1></h1><p>When it comes to testing <strong><code>SignalR Hub</code></strong>, unfortunately there aren't much tools available around.</p><p>Following are some of the tools available, which you can use:</p><ol><li><p><a href="https://docs.microsoft.com/en-us/aspnet/signalr/overview/performance/signalr-connection-density-testing-with-crank" rel="nofollow">Crank</a></p><p>This tool is from microsoft and comes as part of <a href="https://github.com/signalr/signalr">SignalR code base</a>. You can use this tool to find out the number of simultaneous TCP connections that can be established on a server, which is also known as Connection Density.</p></li><li><p><a href="http://www.wcfstorm.com/wcf/tresiproduct.aspx" rel="nofollow">Tresi (Commercial)</a></p><p>This is a commercial product which allows you to test wcf and SignalR services.</p></li></ol><h3><a id="user-content-what-is-so-different-in-this-tool-" class="anchor" aria-hidden="true" href="#what-is-so-different-in-this-tool-"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is so different in this <a href="https://github.com/emtecinc/signalr-tester">tool</a> !!</h3><h1></h1><p>As a matter of fact, none of the tools above actually gives you a provision to setup your test case using <code>C#</code> as the authoring language and does not cater for some of the complex setup needs, which you might come across. Also, none of them have support for both Asp.Net SignalR and Asp.Net Core SignalR.</p><p>Let's go through few examples to understand better, what you can do in a <code>test setup</code>.</p><p><strong>Example 1 (Simple Setup)</strong>:</p><p>Let's say you have a Hub as shown below. You want to execute the <code>LogOn</code> function, once a connection with Hub is established.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span><span class="pl-k">class</span><span class="pl-en">ChatHub</span> : <span class="pl-en">Hub</span>
    {
        <span class="pl-k">private</span><span class="pl-k">readonly</span><span class="pl-k">object</span><span class="pl-smi">_lockAtom</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-k">object</span>();

        <span class="pl-k">public</span><span class="pl-k">void</span><span class="pl-en">LogOn</span>(<span class="pl-k">string</span><span class="pl-smi">name</span>)
        {
            <span class="pl-smi">Clients</span>.<span class="pl-smi">All</span>.<span class="pl-en">onlogOn</span>(<span class="pl-smi">name</span>);
        }

        <span class="pl-k">public</span><span class="pl-k">void</span><span class="pl-en">Send</span>(<span class="pl-k">string</span><span class="pl-smi">name</span>, <span class="pl-k">string</span><span class="pl-smi">message</span>)
        {
            <span class="pl-smi">Clients</span>.<span class="pl-smi">All</span>.<span class="pl-en">broadcastMessage</span>(<span class="pl-smi">name</span>, <span class="pl-smi">message</span>);
        }

        <span class="pl-k">public</span><span class="pl-k">override</span><span class="pl-en">Task</span><span class="pl-en">OnConnected</span>()
        {
            <span class="pl-k">lock</span> (<span class="pl-smi">_lockAtom</span>)
                <span class="pl-smi">PerformanceCounter</span>.<span class="pl-smi">WebsocketCount</span><span class="pl-k">++</span>;

            <span class="pl-k">return</span><span class="pl-k">base</span>.<span class="pl-en">OnConnected</span>();
        }

        <span class="pl-k">public</span><span class="pl-k">override</span><span class="pl-en">Task</span><span class="pl-en">OnDisconnected</span>(<span class="pl-k">bool</span><span class="pl-smi">stopCalled</span>)
        {
            <span class="pl-k">lock</span> (<span class="pl-smi">_lockAtom</span>)
            {
                <span class="pl-k">if</span> (<span class="pl-smi">PerformanceCounter</span>.<span class="pl-smi">WebsocketCount</span><span class="pl-k">&gt;</span><span class="pl-c1">0</span>)
                    <span class="pl-smi">PerformanceCounter</span>.<span class="pl-smi">WebsocketCount</span><span class="pl-k">--</span>;
            }

            <span class="pl-k">return</span><span class="pl-k">base</span>.<span class="pl-en">OnDisconnected</span>(<span class="pl-smi">stopCalled</span>);
        }
    }
</pre></div><h1></h1><p><strong>Example 2 (Complex Setup)</strong>:</p><p>Let's say you have a Hub as shown below. You want to execute the <code>LogOn</code> function, once a connection with Hub is established.</p><p>However, in this test setup, you also want to achieve following things:</p><ol><li><p>A random guid should be passed as parameter to LogOn function, and the same guid should be stored in a list for future use.</p></li><li><p>When, the Send function is called, a random guid should be picked up from the above list, and the same should be passed as first parameter to Send, and second parameter being again a random message.</p></li></ol><div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span><span class="pl-k">class</span><span class="pl-en">ChatHub</span> : <span class="pl-en">Hub</span>
    {
        <span class="pl-k">private</span><span class="pl-k">readonly</span><span class="pl-k">object</span><span class="pl-smi">_lockAtom</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-k">object</span>();

        <span class="pl-k">public</span><span class="pl-k">void</span><span class="pl-en">LogOn</span>(<span class="pl-k">string</span><span class="pl-smi">name</span>)
        {
            <span class="pl-smi">Clients</span>.<span class="pl-smi">All</span>.<span class="pl-en">onlogOn</span>(<span class="pl-smi">name</span>);
        }

        <span class="pl-k">public</span><span class="pl-k">void</span><span class="pl-en">Send</span>(<span class="pl-k">string</span><span class="pl-smi">name</span>, <span class="pl-k">string</span><span class="pl-smi">message</span>)
        {
            <span class="pl-smi">Clients</span>.<span class="pl-smi">All</span>.<span class="pl-en">broadcastMessage</span>(<span class="pl-smi">name</span>, <span class="pl-smi">message</span>);
        }

        <span class="pl-k">public</span><span class="pl-k">override</span><span class="pl-en">Task</span><span class="pl-en">OnConnected</span>()
        {
            <span class="pl-k">lock</span> (<span class="pl-smi">_lockAtom</span>)
                <span class="pl-smi">PerformanceCounter</span>.<span class="pl-smi">WebsocketCount</span><span class="pl-k">++</span>;

            <span class="pl-k">return</span><span class="pl-k">base</span>.<span class="pl-en">OnConnected</span>();
        }

        <span class="pl-k">public</span><span class="pl-k">override</span><span class="pl-en">Task</span><span class="pl-en">OnDisconnected</span>(<span class="pl-k">bool</span><span class="pl-smi">stopCalled</span>)
        {
            <span class="pl-k">lock</span> (<span class="pl-smi">_lockAtom</span>)
            {
                <span class="pl-k">if</span> (<span class="pl-smi">PerformanceCounter</span>.<span class="pl-smi">WebsocketCount</span><span class="pl-k">&gt;</span><span class="pl-c1">0</span>)
                    <span class="pl-smi">PerformanceCounter</span>.<span class="pl-smi">WebsocketCount</span><span class="pl-k">--</span>;
            }

            <span class="pl-k">return</span><span class="pl-k">base</span>.<span class="pl-en">OnDisconnected</span>(<span class="pl-smi">stopCalled</span>);
        }
    }
</pre></div><p><strong>Well, if you have such setup needs then you have come to the right place !!</strong></p><p>Please follow along the article below to know how to use the tool.</p><h3><a id="user-content-how-to-use-the-tool" class="anchor" aria-hidden="true" href="#how-to-use-the-tool"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to use the Tool</h3><h1></h1><p><strong>Step 1</strong>: Download the Tool and install</p><p>Download the latest MSI from <a href="https://github.com/emtecinc/signalr-tester/releases">Releases</a>.   Just run it and install. It will place a shortcut on the desktop and start menu.</p><p><strong>Step 2</strong>: Create an Agent.</p><p>You need to have <code>C#</code> programming knowledge to create an Agent. Read <a href="https://github.com/emtecinc/signalr-tester#how-to-build-an-agent">How to build an agent</a> section below for the same.</p><p><strong>Step 3</strong>: Copy the agent</p><p>Once you create an agent and you are ready with the <code>dll</code>, copy the same to <code>Agents</code> folder in the installation directory of the tool.</p><p><strong>Step 4</strong>: Run the tool</p><p>Run the <code>SignalR Tester</code> tool from start menu or Desktop. The tool will guide you through a wizard, just following along and you will be able to test your Hub.</p><p><strong>NOTE</strong> - <strong>A <code>Default Agent</code> comes pre-installed out of box, which can only ramp up connections to Hub.</strong></p><h3><a id="user-content-tool-screenshots" class="anchor" aria-hidden="true" href="#tool-screenshots"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tool Screenshots</h3><h1></h1><p>Options Page</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/page1.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/page1.jpg" alt="Options Page"></a></p><p>Step 1 Page</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/page2.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/page2.jpg" alt="Options Page"></a></p><p>Step 2 Page</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/page3.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/page3.jpg" alt="Options Page"></a></p><p>Step 3 Page</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/page4.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/page4.jpg" alt="Options Page"></a></p><p>Step 4 Page</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/page5.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/page5.jpg" alt="Options Page"></a></p><p>Connections Ramp Up</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/ramp-up.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/ramp-up.jpg" alt="Options Page"></a></p><h3><a id="user-content-how-to-build-an-agent" class="anchor" aria-hidden="true" href="#how-to-build-an-agent"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to build an agent</h3><h1></h1><p><strong>Step 1</strong>: Create a C# Class Library (.Net Framework) project</p><p>Create a class library using the standard <code>C# Class Library (.Net Framework)</code> project template. You can choose any name for the project.</p><p><strong>Step 2</strong>: Add reference to the core library</p><p>Add a reference to <code>SignalR.Tester.Core.dll</code> in this project. You will find this dll in the installation directory of the tool.</p><p><strong>Step 3</strong>: Create a class</p><p>Create a class. You can name it anything, but it should fulfill the below requirements.</p><ul><li><p>It should inherit from <code>AgentBase</code> which is an abstract class.</p><p>AgentBase is available in <code>SignalR.Tester.Core.Agents</code> namespace of <code>SignalR.Tester.Core.dll</code> dll. It provides the core functionality of an agent.</p></li><li><p>Class should be decorated with below attributes.</p><p><code>PartCreationPolicy</code>,<code>Export</code> &amp; <code>ExportMetadata</code> attributes are available in <code>System.ComponentModel.Composition</code> namespace of <code>System.ComponentModel.Composition.dll</code> dll.</p><p>Choose an appropriate <code>AgentName</code> &amp; <code>AgentDescription</code>. Whatever <code>AgentName</code> you choose, the same will be available in the second page of the wizard, when you run the tool.</p></li></ul><div class="highlight highlight-source-cs"><pre>  [<span class="pl-en">PartCreationPolicy</span>(<span class="pl-smi">CreationPolicy</span>.<span class="pl-smi">NonShared</span>)]
  [<span class="pl-en">Export</span>(<span class="pl-k">typeof</span>(<span class="pl-en">IAgent</span>))]
  [<span class="pl-en">ExportMetadata</span>(<span class="pl-s"><span class="pl-pds">"</span>AgentName<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>SignalR Chat Hub Agent<span class="pl-pds">"</span></span>)]
  [<span class="pl-en">ExportMetadata</span>(<span class="pl-s"><span class="pl-pds">"</span>AgentDescription<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Agent for testing microsoft sample ChatHub<span class="pl-pds">"</span></span>)]</pre></div><ul><li><p>Mark the constructor with <code>ImportingConstructor</code></p></li><li><p>Override the functions <code>MethodToInvokeOnAgentStarted</code> and <code>PreRegisterMethods</code></p><p><code>MethodToInvokeOnAgentStarted</code> is used to register the methods which you want to <strong>invoke immediately</strong> after the connection with SignalR server is established. If you don't want to execute any function then just return null.</p><p><code>PreRegisterMethods</code> is used to register the methods which you want to invoke at a <strong>later stage</strong>, after the connection with SignalR server is established. This, will be usually used when you want to stress out the connection, by calling a function regularly at certain interval. If you don't want to register any method then just return null.</p></li></ul><p><strong>Step 4</strong>: Build the library</p><p><strong>Step 5</strong>: <strong>Copy the output dll (dll which matches with the assembly name of the class library) to <code>Agents</code> directory in the installation directory of the tool, which will be mostly <code>C:\Program Files (x86)\Emtecinc\SignalR.Tester\Agents</code>. Also, if there are any 3rd party nuget packages used, then those dll's should also be copied.</strong></p><h3><a id="user-content-agent-examples" class="anchor" aria-hidden="true" href="#agent-examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Agent Examples</h3><h1></h1><p>A full-blown agent for Example 2, explained above will look like below.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">using</span><span class="pl-en">SignalR</span>.<span class="pl-en">Tester</span>.<span class="pl-en">Core</span>;
<span class="pl-k">using</span><span class="pl-en">SignalR</span>.<span class="pl-en">Tester</span>.<span class="pl-en">Core</span>.<span class="pl-en">Agents</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>.<span class="pl-en">Collections</span>.<span class="pl-en">Generic</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>.<span class="pl-en">ComponentModel</span>.<span class="pl-en">Composition</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>.<span class="pl-en">Text</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>.<span class="pl-en">Threading</span>.<span class="pl-en">Tasks</span>;

<span class="pl-k">namespace</span><span class="pl-en">your</span>.<span class="pl-en">namespace</span>
{
    [<span class="pl-en">PartCreationPolicy</span>(<span class="pl-smi">CreationPolicy</span>.<span class="pl-smi">NonShared</span>)]
    [<span class="pl-en">Export</span>(<span class="pl-k">typeof</span>(<span class="pl-en">IAgent</span>))]
    [<span class="pl-en">ExportMetadata</span>(<span class="pl-s"><span class="pl-pds">"</span>AgentName<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>SignalR Chat Hub Agent<span class="pl-pds">"</span></span>)]
    [<span class="pl-en">ExportMetadata</span>(<span class="pl-s"><span class="pl-pds">"</span>AgentDescription<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Agent for testing microsoft sample ChatHub<span class="pl-pds">"</span></span>)]

    <span class="pl-k">public</span><span class="pl-k">class</span><span class="pl-en">ChatHubAgent</span> : <span class="pl-en">AgentBase</span>
    {
        <span class="pl-en">List</span>&lt;<span class="pl-k">string</span>&gt; <span class="pl-smi">RandomUsers</span>;

        [<span class="pl-en">ImportingConstructor</span>]
        <span class="pl-k">public</span><span class="pl-en">ChatHubAgent</span>(<span class="pl-en">Recomposable</span>&lt;<span class="pl-en">ConnectionArgument</span>&gt; <span class="pl-smi">arguments</span>) : <span class="pl-k">base</span>(<span class="pl-smi">arguments</span>)
        {
            <span class="pl-smi">RandomUsers</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">List</span>&lt;<span class="pl-k">string</span>&gt;();
        }

        <span class="pl-k">protected</span><span class="pl-k">override</span><span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt; <span class="pl-en">MethodToInvokeOnAgentStarted</span>()
        {
            <span class="pl-k">return</span><span class="pl-k">new</span><span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt;(<span class="pl-s"><span class="pl-pds">"</span>LogOn<span class="pl-pds">"</span></span>, <span class="pl-smi">LogOn</span>);
        }

        <span class="pl-k">protected</span><span class="pl-k">override</span><span class="pl-en">List</span>&lt;<span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt;&gt; <span class="pl-en">PreRegisterMethods</span>()
        {
            <span class="pl-en">List</span>&lt;<span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt;&gt; <span class="pl-smi">methods</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">List</span>&lt;<span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt;&gt;
            {
                <span class="pl-k">new</span><span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt;(<span class="pl-s"><span class="pl-pds">"</span>Send<span class="pl-pds">"</span></span>, <span class="pl-smi">Send</span>)
            };

            <span class="pl-k">return</span><span class="pl-smi">methods</span>;
        }

        <span class="pl-k">private</span><span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt; <span class="pl-en">LogOn</span>(<span class="pl-k">string</span><span class="pl-smi">data</span>)
        {
            <span class="pl-c"><span class="pl-c">//</span>Create a new guid, and store it in a list</span><span class="pl-k">var</span><span class="pl-smi">randomUser</span><span class="pl-k">=</span><span class="pl-smi">Guid</span>.<span class="pl-en">NewGuid</span>().<span class="pl-en">ToString</span>();
            <span class="pl-smi">RandomUsers</span>.<span class="pl-en">Add</span>(<span class="pl-smi">randomUser</span>);
            <span class="pl-k">return</span><span class="pl-smi">Task</span>.<span class="pl-en">FromResult</span>(<span class="pl-k">new</span><span class="pl-k">object</span>[] { <span class="pl-smi">randomUser</span> });
        }

        <span class="pl-k">private</span><span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt; <span class="pl-en">Send</span>(<span class="pl-k">string</span><span class="pl-smi">data</span>)
        {
            <span class="pl-c"><span class="pl-c">//</span>pick up a random user from list</span><span class="pl-en">Random</span><span class="pl-smi">rnd</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">Random</span>();
            <span class="pl-k">var</span><span class="pl-smi">randomPosition</span><span class="pl-k">=</span><span class="pl-smi">rnd</span>.<span class="pl-en">Next</span>(<span class="pl-c1">0</span>, <span class="pl-smi">RandomUsers</span>.<span class="pl-smi">Count</span><span class="pl-k">-</span><span class="pl-c1">1</span>);
            <span class="pl-k">var</span><span class="pl-smi">randomUser</span><span class="pl-k">=</span><span class="pl-smi">RandomUsers</span>[<span class="pl-smi">randomPosition</span>];
            <span class="pl-k">return</span><span class="pl-smi">Task</span>.<span class="pl-en">FromResult</span>(<span class="pl-k">new</span><span class="pl-k">object</span>[] { <span class="pl-smi">randomUser</span>, <span class="pl-en">RandomString</span>(<span class="pl-c1">10</span>, <span class="pl-c1">true</span>) });
        }

        <span class="pl-k">private</span><span class="pl-k">string</span><span class="pl-en">RandomString</span>(<span class="pl-k">int</span><span class="pl-smi">size</span>, <span class="pl-k">bool</span><span class="pl-smi">lowerCase</span>)
        {
            <span class="pl-k">var</span><span class="pl-smi">builder</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">StringBuilder</span>();
            <span class="pl-k">var</span><span class="pl-smi">random</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">Random</span>();
            <span class="pl-k">char</span><span class="pl-smi">ch</span>;
            <span class="pl-k">for</span> (<span class="pl-k">int</span><span class="pl-smi">i</span><span class="pl-k">=</span><span class="pl-c1">0</span>; <span class="pl-smi">i</span><span class="pl-k">&lt;</span><span class="pl-smi">size</span>; <span class="pl-smi">i</span><span class="pl-k">++</span>)
            {
                <span class="pl-smi">ch</span><span class="pl-k">=</span><span class="pl-smi">Convert</span>.<span class="pl-en">ToChar</span>(<span class="pl-smi">Convert</span>.<span class="pl-en">ToInt32</span>(<span class="pl-smi">Math</span>.<span class="pl-en">Floor</span>(<span class="pl-c1">26</span><span class="pl-k">*</span><span class="pl-smi">random</span>.<span class="pl-en">NextDouble</span>() <span class="pl-k">+</span><span class="pl-c1">65</span>)));
                <span class="pl-smi">builder</span>.<span class="pl-en">Append</span>(<span class="pl-smi">ch</span>);
            }
            <span class="pl-k">if</span> (<span class="pl-smi">lowerCase</span>)
                <span class="pl-k">return</span><span class="pl-smi">builder</span>.<span class="pl-en">ToString</span>().<span class="pl-en">ToLower</span>();
            <span class="pl-k">return</span><span class="pl-smi">builder</span>.<span class="pl-en">ToString</span>();
        }
    }
}</pre></div><p>A <strong>barebones agent</strong>, with which you can just ramp up connections. It won't be able able to execute any method after connection is established, nor you will be able to execute a method at later stage, since you are returning null from <code>MethodToInvokeOnAgentStarted</code> &amp; <code>PreRegisterMethods</code> respectively.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">using</span><span class="pl-en">SignalR</span>.<span class="pl-en">Tester</span>.<span class="pl-en">Core</span>;
<span class="pl-k">using</span><span class="pl-en">SignalR</span>.<span class="pl-en">Tester</span>.<span class="pl-en">Core</span>.<span class="pl-en">Agents</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>.<span class="pl-en">Collections</span>.<span class="pl-en">Generic</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>.<span class="pl-en">ComponentModel</span>.<span class="pl-en">Composition</span>;
<span class="pl-k">using</span><span class="pl-en">System</span>.<span class="pl-en">Threading</span>.<span class="pl-en">Tasks</span>;

<span class="pl-k">namespace</span><span class="pl-en">Test</span>.<span class="pl-en">Agent</span>
{
    [<span class="pl-en">PartCreationPolicy</span>(<span class="pl-smi">CreationPolicy</span>.<span class="pl-smi">NonShared</span>)]
    [<span class="pl-en">Export</span>(<span class="pl-k">typeof</span>(<span class="pl-en">IAgent</span>))]
    [<span class="pl-en">ExportMetadata</span>(<span class="pl-s"><span class="pl-pds">"</span>AgentName<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Test Agent<span class="pl-pds">"</span></span>)]
    [<span class="pl-en">ExportMetadata</span>(<span class="pl-s"><span class="pl-pds">"</span>AgentDescription<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Test Agent<span class="pl-pds">"</span></span>)]
    <span class="pl-k">public</span><span class="pl-k">class</span><span class="pl-en">TestAgent</span> : <span class="pl-en">AgentBase</span>
    {
        [<span class="pl-en">ImportingConstructor</span>]
        <span class="pl-k">public</span><span class="pl-en">TestAgent</span>(<span class="pl-en">Recomposable</span>&lt;<span class="pl-en">ConnectionArgument</span>&gt; <span class="pl-smi">arguments</span>) : <span class="pl-k">base</span>(<span class="pl-smi">arguments</span>)
        {
        }

        <span class="pl-k">protected</span><span class="pl-k">override</span><span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt; <span class="pl-en">MethodToInvokeOnAgentStarted</span>()
        {
            <span class="pl-k">return</span><span class="pl-c1">null</span>;
        }

        <span class="pl-k">protected</span><span class="pl-k">override</span><span class="pl-en">List</span>&lt;<span class="pl-en">Tuple</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Func</span>&lt;<span class="pl-k">string</span>, <span class="pl-en">Task</span>&lt;<span class="pl-k">object</span>[]&gt;&gt;&gt;&gt; <span class="pl-en">PreRegisterMethods</span>()
        {
            <span class="pl-k">return</span><span class="pl-c1">null</span>;
        }
    }
}</pre></div><p>You can do whatever you want in the agent ex. DB calls, Api integration, File access etc. Possibility is endless.</p><p>You can create as many classes you want in a class library project for testing out different scenarios, or you can create separate library projects for each of the different scenarios. It is up to you, how you want to structure it.</p><h3><a id="user-content-developer" class="anchor" aria-hidden="true" href="#developer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Developer</h3><h1></h1><p>From developer perspective below are the core projects:</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/core-projects.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/core-projects.jpg" alt="Core Projects"></a></p><p><strong>SignalR.Tester.App</strong> is the <strong>Startup</strong> project</p><h1></h1><p>Sample Agents and Hubs are included in below folders:</p><p><a target="_blank" rel="noopener noreferrer" href="/emtecinc/signalr-tester/blob/master/docs/demo-projects.jpg"><img src="/emtecinc/signalr-tester/raw/master/docs/demo-projects.jpg" alt="Core Projects"></a></p><p>Please do send us a PR if you have any ideas and you want to contribute further in extending the tool.</p><p><strong>Happy Testing !!</strong></p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>