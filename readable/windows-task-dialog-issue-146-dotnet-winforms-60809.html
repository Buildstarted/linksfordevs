<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Windows Task Dialog &#xB7; Issue #146 &#xB7; dotnet/winforms - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Windows Task Dialog &#xB7; Issue #146 &#xB7; dotnet/winforms - linksfor.dev(s)"/>
    <meta property="article:author" content="merriemcgaw"/>
    <meta property="og:description" content="Hi, On Windows Vista and higher, the Task Dialog is available that provides many more features than a Message Box. While you can show a Message Box in WinForms and WPF, there is no &amp;quot;official&amp;q..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/winforms/issues/146"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Windows Task Dialog &#xB7; Issue #146 &#xB7; dotnet/winforms</title>
<div class="readable">
        <h1>Windows Task Dialog &#xB7; Issue #146 &#xB7; dotnet/winforms</h1>
            <div>by merriemcgaw</div>
            <div>Reading time: 40-50 minutes</div>
        <div>Posted here: 18 Apr 2020</div>
        <p><a href="https://github.com/dotnet/winforms/issues/146">https://github.com/dotnet/winforms/issues/146</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div disabled="" sortable="">
<div>
          <p>Hi,</p>
<p>On Windows Vista and higher, the <a href="https://docs.microsoft.com/en-us/windows/desktop/Controls/task-dialogs-overview" rel="nofollow">Task Dialog</a> is available that provides many more features than a Message Box. While you can show a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.messagebox?view=netframework-4.7.2" rel="nofollow">Message Box</a> in WinForms and WPF, there is no "official" implementation of the Task Dialog yet in .NET WinForms/WPF.</p>
<p>There was an implementation in the Windows API Code Pack 1.1, but it is no longer available/updated, it did not implement all features (like navigation or modifying common/standard buttons), and I believe it had some memory management issues (like not calling <code>Marshal.DestroyStructure()</code> after calling <code>Marshal.StructureToPtr()</code> in order to free allocated strings for custom/radio buttons) and a few other issues.</p>
<p>I recently added a <a href="https://github.com/kpreisser/TaskDialog">Task Dialog implementation for .NET</a> (wrapper around the Windows API) in order to have all the features that are available in the native API (including navigation). For example, you can update the Task Dialog's contents while it is opened, and can also programatically close it.</p>
<p>We currently use the Task Dialog in a (commercial) WPF application to show a marquee progress bar while an operation (like database backup) is running, and then navigate it to one showing a green header to indicate the operation is finished.</p>
<p>Visual Studio is also using a Task Dialog:<br>
<a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/49468906-69018680-f806-11e8-9964-68db26da5cae.png"><img src="https://user-images.githubusercontent.com/13289184/49468906-69018680-f806-11e8-9964-68db26da5cae.png" alt="taskdialog-vs"></a></p>
<p>Also, the <strong>Windows Design Guidelines (Desktop Apps)</strong> for <a href="https://docs.microsoft.com/en-us/windows/desktop/uxguide/messages" rel="nofollow">Messages</a> and <a href="https://docs.microsoft.com/en-us/windows/desktop/uxguide/win-dialog-box" rel="nofollow">Dialog Boxes</a> show features of the task dialog.</p>
<p>Do you think a Task Dialog could also be added directly to WinForms/WPF?</p>
<p>Thanks!</p>
<p><strong>Edit:</strong></p>
<hr>
<h2>Rationale and Usage</h2>
<p>The Windows Task Dialog (which is available since Windows Vista) has a lot of configuration options comparing to a regular Message Box, can show additional controls like a progress bar, and supports event handling. However, it has not yet been integrated officially into WinForms/WPF, so if you wanted to use it, you had to implement the native APIs yourself, or use a 3rd party library.</p>
<p>Implementing the Task Dialog directly in WinForms allows users to directly use the Task Dialog in any new WinForms/WPF .NET Core application, just like a MessageBox. You can then either use the simple static <code>Show()</code> method (similar to a MessageBox), or you can create an instance of the <code>TaskDialog</code>, configure its <code>TaskDialogPage</code> and then show it.</p>
<p>Features of the proposed Task Dialog:</p>
<ul>
<li>Supports all of the native Task Dialog elements (like custom buttons/command links, progress bar, radio buttons, checkbox, expanded area, footer)</li>
<li>Some dialog elements can be updated while the dialog is displayed, and the dialog can be closed from code</li>
<li>Additionally to standard icons, supports security icons that show a green, yellow, red, gray or blue bar</li>
<li>Can <a href="https://docs.microsoft.com/en-us/windows/desktop/uxguide/win-dialog-box#multi-page-dialog-boxes" rel="nofollow">navigate to a new page</a> (by reconstructing the dialog from current properties) by setting the <code>Page</code> property while the dialog is displayed</li>
<li>Can be shown modal or non-modal (when showing modal, can be centered to the parent)</li>
<li>Exposes its window handle (<code>hWnd</code>) through the <code>Handle</code> property so that the dialog window can be further manipulated (or used as owner for another window)</li>
</ul>
<p>See <a href="https://github.com/kpreisser/TaskDialogDemo"><strong>Task Dialog Demo App</strong></a> for working examples.</p>
<p>TODO: Update these examples.</p>
<h3>Show a simple Task Dialog</h3>
<div><pre>    <span>TaskDialogResult</span> <span>result</span> <span>=</span> <span>TaskDialog</span>.<span>ShowDialog</span>(
        <span>text</span>: <span><span>"</span>Hello World!<span>"</span></span>,
        <span>mainInstruction</span>: <span><span>"</span>Hello Task Dialog!   üëç<span>"</span></span>,
        <span>caption</span>: <span><span>"</span>Dialog Title<span>"</span></span>,
        <span>buttons</span>: <span>TaskDialogButtons</span>.<span>Yes</span> <span>|</span> <span>TaskDialogButtons</span>.<span>Cancel</span>,
        <span>icon</span>: <span>TaskDialogIcon</span>.<span>ShieldSuccessGreenBar</span>);</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/51439315-9c19af80-1cb8-11e9-9c50-ef19baf76a57.png"><img src="https://user-images.githubusercontent.com/13289184/51439315-9c19af80-1cb8-11e9-9c50-ef19baf76a57.png" alt="simpletaskdialog"></a></p>
<h3>Dialog similar to the Visual Studio dialog</h3>
<div><pre>    <span>TaskDialogCustomButton</span> <span>buttonRestart</span>;

    <span>var</span> <span>page</span> <span>=</span> <span>new</span> <span>TaskDialogPage</span>()
    {
        <span>Icon</span> <span>=</span> <span>TaskDialogIcon</span>.<span>Shield</span>,
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>This task requires the application to have elevated permissions.<span>"</span></span>,
        <span><span>//</span> TODO - Hyperlinks be possible in a future version</span>
        <span>Text</span> <span>=</span> <span><span>"</span>&lt;A HREF=<span>"</span>myLink<span>"</span>&gt;Why is using the Administrator or other account necessary?&lt;/A&gt;<span>"</span></span>,

        <span><span>//</span> Show custom buttons as command links.</span>
        <span>CustomButtonStyle</span> <span>=</span> <span>TaskDialogCustomButtonStyle</span>.<span>CommandLinks</span>,
        <span><span>//</span> TODO - will be possible in a future version</span>
        <span><span>//</span>EnableHyperlinks = true,</span>

        <span><span>//</span> Show a expander.</span>
        <span>Expander</span> <span>=</span> <span>new</span> <span>TaskDialogExpander</span>()
        {
            <span>Text</span> <span>=</span> <span><span>"</span>Some expanded Text<span>"</span></span>,
            <span>CollapsedButtonText</span> <span>=</span> <span><span>"</span>View error information<span>"</span></span>,
            <span>ExpandedButtonText</span> <span>=</span> <span><span>"</span>Hide error information<span>"</span></span>,
            <span>Position</span> <span>=</span> <span>TaskDialogExpanderPosition</span>.<span>AfterFooter</span>
        },

        <span>StandardButtons</span> <span>=</span> <span>TaskDialogButtons</span>.<span>Cancel</span>,

        <span>CustomButtons</span> <span>=</span>
        {
            (<span>buttonRestart</span> <span>=</span> <span>new</span> <span>TaskDialogCustomButton</span>()
            {
                <span>Text</span> <span>=</span> <span><span>"</span>&amp;Restart under different credentials<span>"</span></span>,
                <span>DescriptionText</span> <span>=</span> <span><span>"</span>This text will be shown in the second line.<span>"</span></span>,
                <span>ElevationRequired</span> <span>=</span> <span>true</span>
            }),
            <span>new</span> <span>TaskDialogCustomButton</span>()
            {
                <span>Text</span> <span>=</span> <span><span>"</span>&amp;Cancel the Task and return<span>"</span></span>,
                <span>DefaultButton</span> <span>=</span> <span>true</span>
            }
        }
    };

    <span><span>//</span> Show the dialog and check the result.</span>
    <span>var</span> <span>dialog</span> <span>=</span> <span>new</span> <span>TaskDialog</span>(<span>page</span>);
    <span>TaskDialogButton</span> <span>result</span> <span>=</span> <span>dialog</span>.<span>ShowDialog</span>();

    <span>if</span> (<span>result</span> <span>==</span> <span>buttonRestart</span>)
    {
        <span>Console</span>.<span>WriteLine</span>(<span><span>"</span>Restarting...<span>"</span></span>);
    }</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/49761596-d9f1e400-fcc7-11e8-805c-25af7d4246d2.png"><img src="https://user-images.githubusercontent.com/13289184/49761596-d9f1e400-fcc7-11e8-805c-25af7d4246d2.png" alt="taskdialogvs"></a></p>
<h3>Show a multi-page dialog that shows current progress, then navigates to a result</h3>
<p>See also: <a href="https://docs.microsoft.com/en-us/windows/desktop/uxguide/win-dialog-box#multi-page-dialog-boxes" rel="nofollow">Multi-page dialog boxes</a></p>
<div><pre>    <span>var</span> <span>dialog</span> <span>=</span> <span>new</span> <span>TaskDialog</span>();

    <span>var</span> <span>initialPage</span> <span>=</span> <span>new</span> <span>TaskDialogPage</span>()
    {
        <span>Caption</span> <span>=</span> <span><span>"</span>My Application<span>"</span></span>,
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>Clean up database?<span>"</span></span>,
        <span>Text</span> <span>=</span> <span><span>"</span>Do you really want to do a clean-up?<span>
</span>This action is irreversible!<span>"</span></span>,
        <span>Icon</span> <span>=</span> <span>TaskDialogIcon</span>.<span>ShieldWarningYellowBar</span>,
        <span>AllowCancel</span> <span>=</span> <span>true</span>,

        <span>CheckBox</span> <span>=</span> <span>new</span> <span>TaskDialogCheckBox</span>()
        {
            <span>Text</span> <span>=</span> <span><span>"</span>I know what I'm doing<span>"</span></span>
        },

        <span>StandardButtons</span> <span>=</span>
        {
            <span>new</span> <span>TaskDialogStandardButton</span>(<span>TaskDialogResult</span>.<span>No</span>)
            {
                <span>DefaultButton</span> <span>=</span> <span>true</span>
            },
            <span>new</span> <span>TaskDialogStandardButton</span>(<span>TaskDialogResult</span>.<span>Yes</span>)
            {
                <span><span>//</span> Disable the "Yes" button and only enable it when the</span>
                <span><span>//</span> checkbox is checked.</span>
                <span>Enabled</span> <span>=</span> <span>false</span>,
                <span><span>//</span> Do not close the dialog when this button is clicked.</span>
                <span>AllowCloseDialog</span> <span>=</span> <span>false</span>
            }
        }
    };

    <span>var</span> <span>inProgressPage</span> <span>=</span> <span>new</span> <span>TaskDialogPage</span>()
    {
        <span>Caption</span> <span>=</span> <span><span>"</span>My Application<span>"</span></span>,
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>Operation in progress...<span>"</span></span>,
        <span>Text</span> <span>=</span> <span><span>"</span>Please wait while the operation is in progress.<span>"</span></span>,
        <span>Icon</span> <span>=</span> <span>TaskDialogIcon</span>.<span>Information</span>,

        <span>ProgressBar</span> <span>=</span> <span>new</span> <span>TaskDialogProgressBar</span>()
        {
            <span>State</span> <span>=</span> <span>TaskDialogProgressBarState</span>.<span>Marquee</span>
        },

        <span>Expander</span> <span>=</span> <span>new</span> <span>TaskDialogExpander</span>()
        {
            <span>Text</span> <span>=</span> <span><span>"</span>Initializing...<span>"</span></span>,
            <span>Position</span> <span>=</span> <span>TaskDialogExpanderPosition</span>.<span>AfterFooter</span>
        },

        <span>StandardButtons</span> <span>=</span>
        {
            <span><span>//</span> For the "In Progress" page, don't allow the dialog to close, by adding</span>
            <span><span>//</span> a disabled button (if no button was specified, the task dialog would</span>
            <span><span>//</span> get an (enabled) 'OK' button).</span>
            <span>new</span> <span>TaskDialogStandardButton</span>(<span>TaskDialogResult</span>.<span>Close</span>)
            {
                <span>Enabled</span> <span>=</span> <span>false</span>
            }
        }
    };

    <span>var</span> <span>finishedPage</span> <span>=</span> <span>new</span> <span>TaskDialogPage</span>()
    {
        <span>Caption</span> <span>=</span> <span><span>"</span>My Application<span>"</span></span>,
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>Success!<span>"</span></span>,
        <span>Text</span> <span>=</span> <span><span>"</span>The operation finished.<span>"</span></span>,
        <span>Icon</span> <span>=</span> <span>TaskDialogIcon</span>.<span>ShieldSuccessGreenBar</span>,
        <span>CustomButtonStyle</span> <span>=</span> <span>TaskDialogCustomButtonStyle</span>.<span>CommandLinks</span>,
        <span>StandardButtons</span> <span>=</span> <span>TaskDialogButtons</span>.<span>Close</span>
    };


    <span><span>//</span> Enable the "Yes" button only when the checkbox is checked.</span>
    <span>TaskDialogCheckBox</span> <span>checkBox</span> <span>=</span> <span>initialPage</span>.<span>CheckBox</span>;
    <span>TaskDialogStandardButton</span> <span>initialButtonYes</span> <span>=</span> <span>initialPage</span>.<span>StandardButtons</span>
        [<span>TaskDialogResult</span>.<span>Yes</span>];

    <span>checkBox</span>.<span>CheckedChanged</span> <span>+=</span> (<span>sender</span>, <span>e</span>) <span>=&gt;</span>
    {
        <span>initialButtonYes</span>.<span>Enabled</span> <span>=</span> <span>checkBox</span>.<span>Checked</span>;
    };

    <span><span>//</span> When the user clicks "Yes", don't close the dialog but navigate to</span>
    <span><span>//</span> the second page.</span>
    <span>initialButtonYes</span>.<span>Click</span> <span>+=</span> (<span>sender</span>, <span>e</span>) <span>=&gt;</span>
    {
        <span><span>//</span> Navigate to the "In Progress" page that displays the</span>
        <span><span>//</span> current progress of the background work.</span>
        <span>dialog</span>.<span>Page</span> <span>=</span> <span>inProgressPage</span>;

        <span><span>//</span> NOTE: When you implement a "In Progress" page that represents</span>
        <span><span>//</span> background work that is done e.g. by a separate thread/task,</span>
        <span><span>//</span> which eventually calls Control.Invoke()/BeginInvoke() when</span>
        <span><span>//</span> its work is finished in order to navigate or update the dialog,</span>
        <span><span>//</span> then DO NOT start that work here already (directly after</span>
        <span><span>//</span> setting the Page property). Instead, start the work in the</span>
        <span><span>//</span> TaskDialogPage.Created event of the new page.</span>
        <span><span>//</span></span>
        <span><span>//</span> This is because if you started it here, then when that other</span>
        <span><span>//</span> thread/task finishes and calls BeginInvoke() to call a method in</span>
        <span><span>//</span> the GUI thread to update or navigate the dialog, there is a chance</span>
        <span><span>//</span> that the callback might be called before the dialog completed</span>
        <span><span>//</span> navigation (*) (as indicated by the Created event of the</span>
        <span><span>//</span> new page), and the dialog might not be updatable in that case.</span>
        <span><span>//</span> (The dialog can be closed or navigated again, but you cannot</span>
        <span><span>//</span> change e.g. text properties of the page).</span>
        <span><span>//</span></span>
        <span><span>//</span> If that's not possible for some reason, you need to ensure</span>
        <span><span>//</span> that you delay the call to update the dialog until the Created</span>
        <span><span>//</span> event of the next page has occured.</span>
        <span><span>//</span> </span>
        <span><span>//</span> </span>
        <span><span>//</span> (*) Background info: Although the WinForms implementation of</span>
        <span><span>//</span> Control.Invoke()/BeginInvoke() posts a new message in the</span>
        <span><span>//</span> control's owning thread's message queue every time it is</span>
        <span><span>//</span> called (so that the callback can be called later by the</span>
        <span><span>//</span> message loop), when processing the posted message in the</span>
        <span><span>//</span> control's window procedure, it calls ALL stored callbacks</span>
        <span><span>//</span> instead of only the next one.</span>
        <span><span>//</span> </span>
        <span><span>//</span> This means that even if you start the work after setting</span>
        <span><span>//</span> the Page property (which means BeginInvoke() can only be</span>
        <span><span>//</span> called AFTER starting navigation), the callback specified</span>
        <span><span>//</span> by BeginInvoke might still be called BEFORE the task dialog</span>
        <span><span>//</span> can process its posted navigation message.</span>
    };


    <span><span>//</span> Simulate work by using a WinForms timer where we are updating the</span>
    <span><span>//</span> progress bar and the expander with the current status.</span>
    <span>System</span>.<span>Windows</span>.<span>Forms</span>.<span>Timer</span>? <span>timer</span> <span>=</span> <span>null</span>;
    <span>inProgressPage</span>.<span>Created</span> <span>+=</span> (<span>s</span>, <span>e</span>) <span>=&gt;</span>
    {
        <span><span>//</span> The page is now being displayed, so create the timer.</span>
        <span>timer</span> <span>=</span> <span>new</span> <span>System</span>.<span>Windows</span>.<span>Forms</span>.<span>Timer</span>()
        {
            <span>Interval</span> <span>=</span> <span>200</span>,
            <span>Enabled</span> <span>=</span> <span>true</span>
        };

        <span>int</span> <span>currentTimerValue</span> <span>=</span> <span>0</span>;
        <span>timer</span>.<span>Tick</span> <span>+=</span> (<span>s2</span>, <span>e2</span>) <span>=&gt;</span>
        {
            <span>currentTimerValue</span><span>++</span>;

            <span>var</span> <span>progressBar</span> <span>=</span> <span>inProgressPage</span>.<span>ProgressBar</span>;
            <span>if</span> (<span>currentTimerValue</span> <span>&gt;=</span> <span>15</span> <span>&amp;&amp;</span> <span>currentTimerValue</span> <span>&lt;=</span> <span>40</span>)
            {
                <span>if</span> (<span>currentTimerValue</span> <span>==</span> <span>15</span>)
                {
                    <span><span>//</span> Switch the progress bar to a regular one.</span>
                    <span>progressBar</span>.<span>State</span> <span>=</span> <span>TaskDialogProgressBarState</span>.<span>Normal</span>;
                }

                <span>progressBar</span>.<span>Value</span> <span>=</span> (<span>currentTimerValue</span> <span>-</span> <span>15</span>) <span>*</span> <span>4</span>;
                <span>inProgressPage</span>.<span>Expander</span>.<span>Text</span> <span>=</span> <span><span>$"</span>Progress: {<span>progressBar</span>.<span>Value</span>} %<span>"</span></span>;
            }
            <span>else</span> <span>if</span> (<span>currentTimerValue</span> <span>==</span> <span>41</span>)
            {
                <span><span>//</span> Work is finished, so navigate to the third page.</span>
                <span>dialog</span>.<span>Page</span> <span>=</span> <span>finishedPage</span>;
            }
        };
    };
    <span>inProgressPage</span>.<span>Destroyed</span> <span>+=</span> (<span>s</span>, <span>e</span>) <span>=&gt;</span>
    {
        <span><span>//</span> The page is being destroyed, so dispose of the timer.</span>
        <span>timer</span><span>!</span>.<span>Dispose</span>();
        <span>timer</span> <span>=</span> <span>null</span>;
    };


    <span>TaskDialogCustomButton</span> <span>showResultsButton</span> <span>=</span> <span>finishedPage</span>.<span>CustomButtons</span>.<span>Add</span>(
        <span><span>"</span>Show &amp;Results<span>"</span></span>);


    <span><span>//</span> Show the dialog.</span>
    <span>dialog</span>.<span>Page</span> <span>=</span> <span>initialPage</span>;
    <span>TaskDialogButton</span> <span>result</span> <span>=</span> <span>dialog</span>.<span>ShowDialog</span>();
    <span>if</span> (<span>result</span> <span>==</span> <span>showResultsButton</span>)
    {
        <span>Console</span>.<span>WriteLine</span>(<span><span>"</span>Showing Results!<span>"</span></span>);
    }</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/49962566-d489d900-ff15-11e8-9764-95db937df4e8.gif"><img src="https://user-images.githubusercontent.com/13289184/49962566-d489d900-ff15-11e8-9764-95db937df4e8.gif" alt="wizarddialog"></a></p>
<h3>Other examples from existing applications</h3>
<h4>"Save document" dialog from Notepad/Paint/WordPad</h4>
<div><pre>    <span>var</span> <span>page</span> <span>=</span> <span>new</span> <span>TaskDialogPage</span>()
    {
        <span>Caption</span> <span>=</span> <span><span>"</span>My Application<span>"</span></span>,
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>Do you want to save changes to Untitled?<span>"</span></span>,
    };

    <span>TaskDialogStandardButton</span> <span>btnCancel</span> <span>=</span> <span>page</span>.<span>StandardButtons</span>.<span>Add</span>(<span>TaskDialogResult</span>.<span>Cancel</span>);
    <span>TaskDialogCustomButton</span> <span>btnSave</span> <span>=</span> <span>page</span>.<span>CustomButtons</span>.<span>Add</span>(<span><span>"</span>&amp;Save<span>"</span></span>);
    <span>TaskDialogCustomButton</span> <span>btnDontSave</span> <span>=</span> <span>page</span>.<span>CustomButtons</span>.<span>Add</span>(<span><span>"</span>Do&amp;n't save<span>"</span></span>);

    <span><span>//</span> Show a modal dialog, then check the result.</span>
    <span>var</span> <span>dialog</span> <span>=</span> <span>new</span> <span>TaskDialog</span>(<span>page</span>);
    <span>TaskDialogButton</span> <span>result</span> <span>=</span> <span>dialog</span>.<span>ShowDialog</span>(<span>parentWindow</span>);

    <span>if</span> (<span>result</span> <span>==</span> <span>btnSave</span>)
        <span>Console</span>.<span>WriteLine</span>(<span><span>"</span>Saving<span>"</span></span>);
    <span>else</span> <span>if</span> (result == btnDontSave)
        Console.WriteLine("<span>Not</span> <span>saving</span>");
    <span>else</span>
        <span>Console</span>.<span>WriteLine</span>(<span><span>"</span>Canceling<span>"</span></span>);</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/50541209-f8e5e680-0ba0-11e9-8fe5-b73a975c9934.png"><img src="https://user-images.githubusercontent.com/13289184/50541209-f8e5e680-0ba0-11e9-8fe5-b73a975c9934.png" alt="taskdialog-savedocument"></a></p>
<h4>Windows 7 Minesweeper Difficulty Selection</h4>
<div><pre>    <span>var</span> <span>page</span> <span>=</span> <span>new</span> <span>TaskDialogPage</span>()
    {
        <span>Caption</span> <span>=</span> <span><span>"</span>Select Difficulty<span>"</span></span>,
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>What level of difficulty do you want to play?<span>"</span></span>,
        <span>CustomButtonStyle</span> <span>=</span> <span>TaskDialogCustomButtonStyle</span>.<span>CommandLinks</span>,
        <span>AllowCancel</span> <span>=</span> <span>true</span>,

        <span>Footer</span> <span>=</span> <span>new</span> <span>TaskDialogFooter</span>()
        {
            <span>Text</span> <span>=</span> <span><span>"</span>Note: You can change the difficulty level later <span>"</span></span> <span>+</span>
                <span><span>"</span>by clicking Options on the Game menu.<span>"</span></span>,
        },

        <span>CustomButtons</span> <span>=</span>
        {
            <span>new</span> <span>TaskDialogCustomButton</span>(<span><span>"</span>&amp;Beginner<span>"</span></span>, <span><span>"</span>10 mines, 9 x 9 tile grid<span>"</span></span>)
            {
                <span>Tag</span> <span>=</span> <span>10</span>
            },
            <span>new</span> <span>TaskDialogCustomButton</span>(<span><span>"</span>&amp;Intermediate<span>"</span></span>, <span><span>"</span>40 mines, 16 x 16 tile grid<span>"</span></span>)
            {
                <span>Tag</span> <span>=</span> <span>40</span>
            },
            <span>new</span> <span>TaskDialogCustomButton</span>(<span><span>"</span>&amp;Advanced<span>"</span></span>, <span><span>"</span>99 mines, 16 x 30 tile grid<span>"</span></span>)
            {
                <span>Tag</span> <span>=</span> <span>99</span>
            }
        }
    };

    <span>var</span> <span>dialog</span> <span>=</span> <span>new</span> <span>TaskDialog</span>(<span>page</span>);
    <span>TaskDialogButton</span> <span>result</span> <span>=</span> <span>dialog</span>.<span>ShowDialog</span>(<span>parentWindow</span>);

    <span>if</span> (<span>result</span>.<span>Tag</span> <span>is</span> <span>int</span> <span>resultingMines</span>)
        <span>Console</span>.<span>WriteLine</span>(<span><span>$"</span>Playing with {<span>resultingMines</span>} mines...<span>"</span></span>);
    <span>else</span>
        <span>Console</span>.<span>WriteLine</span>(<span><span>"</span>User canceled.<span>"</span></span>);</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/50541403-7b70a500-0ba5-11e9-8bf2-2ae3dd17ab0c.png"><img src="https://user-images.githubusercontent.com/13289184/50541403-7b70a500-0ba5-11e9-8bf2-2ae3dd17ab0c.png" alt="taskdialog-minesweeperdifficulty"></a></p>
<h4>Windows Security dialog when trying to access network files</h4>
<div><pre>    <span>var</span> <span>page</span> <span>=</span> <span>new</span> <span>TaskDialogPage</span>()
    {
        <span>Caption</span> <span>=</span> <span><span>"</span>My App Security<span>"</span></span>,
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>Opening these files might be harmful to your computer<span>"</span></span>,
        <span>Text</span> <span>=</span> <span><span>"</span>Your Internet security settings blocked one or more files from <span>"</span></span> <span>+</span> 
            <span><span>"</span>being opened. Do you want to open these files anyway?<span>"</span></span>,
        <span>Icon</span> <span>=</span> <span>TaskDialogIcon</span>.<span>ShieldWarningYellowBar</span>,
        <span><span>//</span> TODO - will be possible in a future version</span>
        <span><span>//</span>EnableHyperlinks = true,</span>

        <span>Expander</span> <span>=</span> <span>new</span> <span>TaskDialogExpander</span>(<span><span>"</span>My-File-Sample.exe<span>"</span></span>),

        <span>Footer</span> <span>=</span> <span>new</span> <span>TaskDialogFooter</span>()
        {
            <span><span>//</span> TODO - Hyperlinks will be possible in a future version</span>
            <span>Text</span> <span>=</span> <span><span>"</span>&lt;a href=<span>"</span>link1<span>"</span>&gt;How do I decide whether to open these files?&lt;/a&gt;<span>"</span></span>,
        },

        <span>StandardButtons</span> <span>=</span>
        {
            <span>new</span> <span>TaskDialogStandardButton</span>(<span>TaskDialogResult</span>.<span>OK</span>),
            <span>new</span> <span>TaskDialogStandardButton</span>(<span>TaskDialogResult</span>.<span>Cancel</span>)
            {
                <span>DefaultButton</span> <span>=</span> <span>true</span>,
            }
        },
    };

    <span>var</span> <span>dialog</span> <span>=</span> <span>new</span> <span>TaskDialog</span>(<span>page</span>);
    <span>TaskDialogButton</span> <span>result</span> <span>=</span> <span>dialog</span>.<span>ShowDialog</span>(<span>parentWindow</span>);
    <span>if</span> (<span>result</span> <span>is</span> <span>TaskDialogStandardButton</span> <span>standardButton</span> <span>&amp;&amp;</span>
        <span>standardButton</span>.<span>Result</span> <span>==</span> <span>TaskDialogResult</span>.<span>OK</span>)
    {
        <span>Console</span>.<span>WriteLine</span>(<span><span>"</span>OK selected<span>"</span></span>);
    }</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/50541633-166b7e00-0baa-11e9-8016-80746f0c48fd.png"><img src="https://user-images.githubusercontent.com/13289184/50541633-166b7e00-0baa-11e9-8016-80746f0c48fd.png" alt="taskdialog-windowssecurity"></a></p>
<h3>Other code samples</h3>
<h4>Auto-closing Dialog (closes after 5 seconds)</h4>
<div><pre>    <span>const</span> <span>string</span> <span>textFormat</span> <span>=</span> <span><span>"</span>Dialog will close in {0} seconds...<span>"</span></span>;
    <span>int</span> <span>remainingSeconds</span> <span>=</span> <span>5</span>;

    <span>var</span> <span>dialog</span> <span>=</span> <span>new</span> <span>TaskDialog</span>(<span>new</span> <span>TaskDialogPage</span>()
    {
        <span>MainInstruction</span> <span>=</span> <span><span>"</span>Auto-Closing Dialog<span>"</span></span>,
        <span>Text</span> <span>=</span> <span>string</span>.<span>Format</span>(<span>textFormat</span>, <span>remainingSeconds</span>)
    });

    <span><span>//</span> Create a WinForms timer that raises the Tick event every second.</span>
    <span>using</span> (<span>var</span> <span>timer</span> <span>=</span> <span>new</span> <span>System</span>.<span>Windows</span>.<span>Forms</span>.<span>Timer</span>()
    {
        <span>Enabled</span> <span>=</span> <span>true</span>,
        <span>Interval</span> <span>=</span> 1000
    })
    {
        <span>timer</span>.<span>Tick</span> +<span>=</span> (<span>s</span>, <span>e</span>) <span>=</span>&gt;
        {
            <span>remainingSeconds</span>--;
            <span>if</span> (<span>remainingSeconds</span> <span>&gt;</span> <span>0</span>)
            {
                <span><span>//</span> Update the remaining time.</span>
                <span>dialog</span>.<span>Page</span>.<span>Text</span> <span>=</span> <span>string</span>.<span>Format</span>(<span>textFormat</span>, <span>remainingSeconds</span>);
            }
            <span>else</span>
            {
                <span><span>//</span> Stop the timer and close the dialog - this will return</span>
                <span><span>//</span> a "Cancel" result.</span>
                <span>timer</span>.<span>Enabled</span> <span>=</span> <span>false</span>;
                <span>dialog</span>.<span>Close</span>(); 
            }
        };

        <span>TaskDialogButton</span> <span>result</span> <span>=</span> <span>dialog</span>.<span>ShowDialog</span>();
        <span>Console</span>.<span>WriteLine</span>(<span><span>"</span>Is OK: <span>"</span></span> <span>+</span>
            ((<span>result</span> <span>as</span> <span>TaskDialogStandardButton</span>)<span>?</span>.<span>Result</span> <span>==</span> <span>TaskDialogResult</span>.<span>OK</span>));
    }</pre></div>
<h2>Proposed API</h2>
<p>Note: The API uses nullable reference types.<br>
Note: There are some additional TODOs to consider for the public API - see section <strong>Possible API TODOs</strong>.<br>
Note: You can find additional XML documentation comments by viewing the <a href="https://github.com/dotnet/winforms/pull/1133/files">source code files</a> in the PR.</p>
<p><strong>TODO:</strong> Which namespace to use for the types? In the PR I used <code>System.Windows.Forms</code> for now.</p>
<div><pre><span>public</span> <span>class</span> <span>TaskDialog</span> : <span>IWin32Window</span>
{
    <span><span>//</span> Returns the window handle while the dialog is shown, otherwise returns IntPtr.Zero.</span>
    <span>public</span> <span>IntPtr</span> <span>Handle</span> { <span>get</span>; }

    <span><span>//</span> Note: The ShowDialog() methods do not return until the</span>
    <span><span>//</span> dialog is closed (similar to MessageBox.Show()), regardless of whether the</span>
    <span><span>//</span> dialog is shown modal or non-modal.</span>

    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>ShowDialog</span>(<span>TaskDialogPage</span> <span>page</span>, <span>TaskDialogStartupLocation</span> <span>startupLocation</span> <span>=</span> <span>TaskDialogStartupLocation</span>.<span>CenterOwner</span>);
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>ShowDialog</span>(<span>IWin32Window</span> <span>owner</span>, <span>TaskDialogPage</span> <span>page</span>, <span>TaskDialogStartupLocation</span> <span>startupLocation</span> <span>=</span> <span>TaskDialogStartupLocation</span>.<span>CenterOwner</span>);
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>ShowDialog</span>(<span>IntPtr</span> <span>hwndOwner</span>, <span>TaskDialogPage</span> <span>page</span>, <span>TaskDialogStartupLocation</span> <span>startupLocation</span> <span>=</span> <span>TaskDialogStartupLocation</span>.<span>CenterOwner</span>);

    <span><span>//</span> Close() will simulate a click on the "Cancel" button (but you don't</span>
    <span><span>//</span> have to add a "Cancel" button for this).</span>
    <span>public</span> <span>void</span> <span>Close</span>();
}</pre></div>
<div><pre><span>public</span> <span>class</span> <span>TaskDialogPage</span>
{
    <span>public</span> <span>TaskDialogPage</span>();

    <span>public</span> <span>TaskDialog</span>? <span>BoundDialog</span> { <span>get</span>; }

    <span><span>//</span> Properties "Caption", "MainInstruction", "Text", "Icon" can be set</span>
    <span><span>//</span> set while the dialog is shown, to update the dialog.</span>
    <span>public</span> <span>string</span>? <span>Caption</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>string</span>? <span>Heading</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>string</span>? <span>Text</span> { <span>get</span>; <span>set</span>; }

    <span><span>//</span> Icon can either be a standard icon or a icon handle.</span>
    <span><span>//</span> (In the future, we could allow to show a resource icon.)</span>
    <span><span>//</span> Note that while the dialog is shown, you cannot switch between a </span>
    <span><span>//</span> handle icon type and a non-handle icon type.</span>
    <span><span>//</span> The same applies to the footer icon.</span>
    <span>public</span> <span>TaskDialogIcon</span>? <span>Icon</span> { <span>get</span>; <span>set</span>; }    
    
    <span>public</span> <span>bool</span> <span>AllowCancel</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>bool</span> <span>AllowMinimize</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>bool</span> <span>RightToLeftLayout</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>bool</span> <span>SizeToContent</span> { <span>get</span>; <span>set</span>; }

    <span>public</span> <span>TaskDialogButtonCollection</span> <span>Buttons</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>TaskDialogRadioButtonCollection</span> <span>RadioButtons</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>TaskDialogButton</span>? <span>DefaultButton</span> { <span>get</span>; <span>set</span>; }

    <span><span>//</span> Note: When creating a TaskDialogPage instance, these four properties</span>
    <span><span>//</span> contain default/empty control instances (for better Designer support) that</span>
    <span><span>//</span> do not show up in the dialog unless you modify their properties</span>
    <span><span>//</span> (because their initial "Text" is null and initial ProgressBarState is "None" -</span>
    <span><span>//</span> however when you create a new ProgressBar instance, its default State</span>
    <span><span>//</span> is "Normal"), but you can also set them to null.</span>
    <span>public</span> <span>TaskDialogVerificationCheckBox</span>? <span>Verification</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>TaskDialogExpander</span>? <span>Expander</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>TaskDialogFootnote</span>? <span>Footnote</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>TaskDialogProgressBar</span>? <span>ProgressBar</span> { <span>get</span>; <span>set</span>; }

    <span><span>//</span> See section "Event Cycle" for a diagram illustrating the events.</span>

    <span><span>//</span> Raised after this TaskDialogPage is bound to a TaskDialog (and therefore</span>
    <span><span>//</span> the controls have been created): after the dialog was created (directly after event</span>
    <span><span>//</span> TaskDialog.Opened/TDN_CREATED) or navigated (in the TDN_NAVIGATED handler).</span>
    <span>public</span> <span>event</span> <span>EventHandler</span>? <span>Created</span>;
    <span><span>//</span> Raised when this TaskDialogPage is about to be unbound from a TaskDialog</span>
    <span><span>//</span> (and therefore the controls are about to be destroyed): when the dialog is</span>
    <span><span>//</span> about to be destroyed (directly before event TaskDialog.Closed) or about</span>
    <span><span>//</span> to navigate.</span>
    <span>public</span> <span>event</span> <span>EventHandler</span>? <span>Destroyed</span>;

    <span><span>//</span> Raised when the user presses F1 or clicks the "Help" standard button</span>
    <span>public</span> <span>event</span> <span>EventHandler</span>? <span>HelpRequest</span>;

    <span>protected</span> <span>internal</span> <span>void</span> <span>OnCreated</span>(<span>EventArgs</span> <span>e</span>);
    <span>protected</span> <span>internal</span> <span>void</span> <span>OnDestroyed</span>(<span>EventArgs</span> <span>e</span>);
    <span>protected</span> <span>internal</span> <span>void</span> <span>OnHelpRequest</span>(<span>EventArgs</span> <span>e</span>);
}</pre></div>
<div><pre><span>public</span> <span>class</span> <span>TaskDialogIcon</span> : <span>IDisposable</span>
{
    <span><span>//</span> "Standard" icons</span>
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>None</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>Information</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>Warning</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>Error</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>Shield</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>ShieldBlueBar</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>ShieldGrayBar</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>ShieldWarningYellowBar</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>ShieldErrorRedBar</span>;
    <span>public</span> <span>static</span> <span>readonly</span> <span>TaskDialogIcon</span> <span>ShieldSuccessGreenBar</span>;

    <span>public</span> <span>TaskDialogIcon</span>(<span>Bitmap</span> <span>image</span>);
    <span>public</span> <span>TaskDialogIcon</span>(<span>Icon</span> <span>icon</span>);
    <span>public</span> <span>TaskDialogIcon</span>(<span>IntPtr</span> <span>iconHandle</span>);

    <span><span>//</span> Note: This will throw (InvalidOperationException) if this is an</span>
    <span><span>//</span> instance representing a standard icon.</span>
    <span>public</span> <span>IntPtr</span> <span>IconHandle</span> { <span>get</span>; }
}</pre></div>
<div><pre><span>public</span> <span>abstract</span> <span>class</span> <span>TaskDialogControl</span>
{
    <span>public</span> <span>TaskDialogPage</span>? <span>BoundPage</span> { <span>get</span>; }
    <span>public</span> <span>object</span>? <span>Tag</span> { <span>get</span>; <span>set</span>; }
}</pre></div>
<div><pre><span>public</span> <span>class</span> <span>TaskDialogButton</span> : <span>TaskDialogControl</span>
{
    <span>public</span> <span>TaskDialogButton</span>();
    <span>public</span> <span>TaskDialogButton</span>(<span>string</span>? <span>text</span>, <span>bool</span> <span>enabled</span> <span>=</span> <span>true</span>, <span>bool</span> <span>allowCloseDialog</span> <span>=</span> <span>true</span>);

    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>OK</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Cancel</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Abort</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Retry</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Ignore</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Yes</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>No</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Close</span> { <span>get</span>; }
    <span><span>//</span> Note: Clicking the "Help" button will not close the dialog, but will</span>
    <span><span>//</span> raise the TaskDialogPage.Help event.</span>
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Help</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>TryAgain</span> { <span>get</span>; }
    <span>public</span> <span>static</span> <span>TaskDialogButton</span> <span>Continue</span> { <span>get</span>; }
    
    <span><span>//</span> Properties "Enabled" and "ShowShieldIcon" can be set while</span>
    <span><span>//</span> the dialog is shown.</span>
    <span>public</span> <span>string</span>? <span>Text</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>bool</span> <span>AllowCloseDialog</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>bool</span> <span>Enabled</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>bool</span> <span>ShowShieldIcon</span> { <span>get</span>; <span>set</span>; }
    <span><span>//</span> Setting "Visible" to false means the button will not be shown in the task dialog</span>
    <span><span>//</span> (the property cannot be set while the dialog is shown). This allows you</span>
    <span><span>//</span> to intercept button click events, e.g. "Cancel" when "AllowCancel" is true</span>
    <span><span>//</span> and the user presses ESC, without having to actually show a "Cancel" button.</span>
    <span>public</span> <span>bool</span> <span>Visible</span> { <span>get</span>; <span>set</span>; }

    <span><span>//</span> Raised when this button is clicked while the dialog is shown (either because the</span>
    <span><span>//</span> user clicked it, or by calling PerformClick() or TaskDialog.Close()).</span>
    <span>public</span> <span>event</span> <span>EventHandler</span>? <span>Click</span>;

    <span>public</span> <span>override</span> <span>bool</span> <span>Equals</span>(<span>object</span>? <span>obj</span>);
    <span>public</span> <span>override</span> <span>int</span> <span>GetHashCode</span>();
    <span>public</span> <span>void</span> <span>PerformClick</span>();
    <span>public</span> <span>override</span> <span>string</span> <span>ToString</span>();

    <span>public</span> <span>static</span> <span>bool</span> <span>operator</span> <span>==</span>(<span>TaskDialogButton</span>? <span>b1</span>, <span>TaskDialogButton</span>? <span>b2</span>);
    <span>public</span> <span>static</span> <span>bool</span> <span>operator</span> <span>!=</span>(<span>TaskDialogButton</span>? <span>b1</span>, <span>TaskDialogButton</span>? <span>b2</span>);
}</pre></div>
<div><pre><span>public</span> <span>sealed</span> <span>class</span> <span>TaskDialogCommandLinkButton</span> : <span>TaskDialogButton</span>
{
    <span>public</span> <span>TaskDialogCommandLinkButton</span>();
    <span>public</span> <span>TaskDialogCommandLinkButton</span>(<span>string</span>? <span>text</span>, <span>string</span>? <span>descriptionText</span> <span>=</span> <span>null</span>, <span>bool</span> <span>enabled</span> <span>=</span> <span>true</span>, <span>bool</span> <span>allowCloseDialog</span> <span>=</span> <span>true</span>);

    <span>public</span> <span>string</span>? <span>DescriptionText</span> { <span>get</span>; <span>set</span>; }
}</pre></div>
<div><pre><span>public</span> <span>sealed</span> <span>class</span> <span>TaskDialogRadioButton</span> : <span>TaskDialogControl</span>
{
    <span>public</span> <span>TaskDialogRadioButton</span>();
    <span>public</span> <span>TaskDialogRadioButton</span>(<span>string</span>? <span>text</span>);

    <span>public</span> <span>string</span>? <span>Text</span> { <span>get</span>; <span>set</span>; }
    <span><span>//</span> Properties "Enabled" and "Checked" can be set while the dialog is shown</span>
    <span><span>//</span> (but "Checked" can then only be set to "true").</span>
    <span>public</span> <span>bool</span> <span>Checked</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>bool</span> <span>Enabled</span> { <span>get</span>; <span>set</span>; }

    <span><span>//</span> Raised when the "Checked" property changes while the dialog is shown (because</span>
    <span><span>//</span> the user clicked one of the radio buttons, or due to setting the "Checked"</span>
    <span><span>//</span> property of one of the radio buttons to "true").</span>
    <span>public</span> <span>event</span> <span>EventHandler</span>? <span>CheckedChanged</span>;

    <span>public</span> <span>override</span> <span>string</span> <span>ToString</span>();
}</pre></div>
<div><pre><span>public</span> <span>sealed</span> <span>class</span> <span>TaskDialogVerificationCheckBox</span> : <span>TaskDialogControl</span>
{
    <span>public</span> <span>TaskDialogVerificationCheckBox</span>();
    <span>public</span> <span>TaskDialogVerificationCheckBox</span>(<span>string</span>? <span>text</span>, <span>bool</span> <span>isChecked</span> <span>=</span> <span>false</span>);

    <span>public</span> <span>string</span>? <span>Text</span> { <span>get</span>; <span>set</span>; }
    <span><span>//</span> "Checked" can be set while the dialog is shown.</span>
    <span>public</span> <span>bool</span> <span>Checked</span> { <span>get</span>; <span>set</span>; }

    <span><span>//</span> Raised when the "Checked" property changes while the dialog is shown (because</span>
    <span><span>//</span> the user clicked it or due to setting the "Checked" property).</span>
    <span>public</span> <span>event</span> <span>EventHandler</span>? <span>CheckedChanged</span>;

    <span>public</span> <span>override</span> <span>string</span> <span>ToString</span>();

    <span>public</span> <span>static</span> <span>implicit</span> <span>operator</span> <span>TaskDialogVerificationCheckBox</span>(<span>string</span> <span>verificationText</span>);
}</pre></div>
<div><pre><span>public</span> <span>sealed</span> <span>class</span> <span>TaskDialogExpander</span> : <span>TaskDialogControl</span>
{
    <span>public</span> <span>TaskDialogExpander</span>();
    <span>public</span> <span>TaskDialogExpander</span>(<span>string</span>? <span>text</span>);

     <span><span>//</span> "Text" can be set while the dialog is shown.</span>
    <span>public</span> <span>string</span>? <span>Text</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>string</span>? <span>ExpandedButtonText</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>string</span>? <span>CollapsedButtonText</span> { <span>get</span>; <span>set</span>; }
    <span><span>//</span> Note: "Expanded" can NOT be set while the dialog is shown.</span>
    <span>public</span> <span>bool</span> <span>Expanded</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>TaskDialogExpanderPosition</span> <span>Position</span> { <span>get</span>; <span>set</span>; }

    <span><span>//</span> Raised when the "Expanded" property changes while the dialog is shown (because</span>
    <span><span>//</span> the user clicked the expando button).</span>
    <span>public</span> <span>event</span> <span>EventHandler</span>? <span>ExpandedChanged</span>;

    <span>public</span> <span>override</span> <span>string</span> <span>ToString</span>();
}</pre></div>
<div><pre><span>public</span> <span>sealed</span> <span>class</span> <span>TaskDialogFootnote</span> : <span>TaskDialogControl</span>
{
    <span>public</span> <span>TaskDialogFootnote</span>();
    <span>public</span> <span>TaskDialogFootnote</span>(<span>string</span>? <span>text</span>);

    <span><span>//</span> Properties "Text",  "Icon" can be set while</span>
    <span><span>//</span> the dialog is shown (see comments for TaskDialogPage.Icon).</span>
    <span>public</span> <span>string</span>? <span>Text</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>TaskDialogIcon</span>? <span>Icon</span> { <span>get</span>; <span>set</span>; }

    <span>public</span> <span>override</span> <span>string</span> <span>ToString</span>();

    <span>public</span> <span>static</span> <span>implicit</span> <span>operator</span> <span>TaskDialogFootnote</span>(<span>string</span> <span>footnoteText</span>);
}</pre></div>
<div><pre><span>public</span> <span>sealed</span> <span>class</span> <span>TaskDialogProgressBar</span> : <span>TaskDialogControl</span>
{
    <span>public</span> <span>TaskDialogProgressBar</span>();
    <span>public</span> <span>TaskDialogProgressBar</span>(<span>TaskDialogProgressBarState</span> <span>state</span>);

    <span><span>//</span> Properties "State", "Minimum", "Maximum", "Value", "MarqueeSpeed" can</span>
    <span><span>//</span> be set while the dialog is shown.</span>
    <span>public</span> <span>TaskDialogProgressBarState</span> <span>State</span> { <span>get</span>; <span>set</span>; } <span><span>//</span> "Style"?</span>
    <span>public</span> <span>int</span> <span>Minimum</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>int</span> <span>Maximum</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>int</span> <span>Value</span> { <span>get</span>; <span>set</span>; }
    <span>public</span> <span>int</span> <span>MarqueeSpeed</span> { <span>get</span>; <span>set</span>; }
}</pre></div>
<div><pre><span><span>//</span> Note: The button order in this collection is not necessarily the same as the actual</span>
<span><span>//</span> order of buttons displayed in the dialog. See:</span>
<span><span>//</span> https://github.com/kpreisser/winforms/issues/5#issuecomment-584318609</span>
<span>public</span> <span>class</span> <span>TaskDialogButtonCollection</span> : <span>Collection</span>&lt;<span>TaskDialogButton</span>&gt;
{
    <span>public</span> <span>TaskDialogButtonCollection</span>();

    <span>public</span> <span>TaskDialogButton</span> <span>Add</span>(<span>string</span>? <span>text</span>, <span>bool</span> <span>enabled</span> <span>=</span> <span>true</span>, <span>bool</span> <span>allowCloseDialog</span> <span>=</span> <span>true</span>);
    <span>protected</span> <span>override</span> <span>void</span> <span>ClearItems</span>();
    <span>protected</span> <span>override</span> <span>void</span> <span>InsertItem</span>(<span>int</span> <span>index</span>, <span>TaskDialogButton</span> <span>item</span>);
    <span>protected</span> <span>override</span> <span>void</span> <span>RemoveItem</span>(<span>int</span> <span>index</span>);
    <span>protected</span> <span>override</span> <span>void</span> <span>SetItem</span>(<span>int</span> <span>index</span>, <span>TaskDialogButton</span> <span>item</span>);
}</pre></div>
<div><pre><span>public</span> <span>class</span> <span>TaskDialogRadioButtonCollection</span> : <span>System</span>.<span>Collections</span>.<span>ObjectModel</span>.<span>Collection</span>&lt;<span>TaskDialogRadioButton</span>&gt;
{
    <span>public</span> <span>TaskDialogRadioButtonCollection</span>();

    <span>public</span> <span>TaskDialogRadioButton</span> <span>Add</span>(<span>string</span>? <span>text</span>);

    <span>protected</span> <span>override</span> <span>void</span> <span>ClearItems</span>();
    <span>protected</span> <span>override</span> <span>void</span> <span>InsertItem</span>(<span>int</span> <span>index</span>, <span>TaskDialogRadioButton</span> <span>item</span>);
    <span>protected</span> <span>override</span> <span>void</span> <span>RemoveItem</span>(<span>int</span> <span>index</span>);
    <span>protected</span> <span>override</span> <span>void</span> <span>SetItem</span>(<span>int</span> <span>index</span>, <span>TaskDialogRadioButton</span> <span>item</span>);
}</pre></div>
<div><pre><span>public</span> <span>enum</span> <span>TaskDialogStartupLocation</span>
{
    <span>CenterScreen</span> <span>=</span> <span>0</span>,
    <span>CenterOwner</span> <span>=</span> <span>1</span>
}</pre></div>
<div><pre><span><span>//</span> Rename to "TaskDialogProgressBarStyle"?</span>
<span>public</span> <span>enum</span> <span>TaskDialogProgressBarState</span>
{
    <span>Normal</span> <span>=</span> <span>0</span>,
    <span>Paused</span> <span>=</span> <span>1</span>,
    <span>Error</span> <span>=</span> <span>2</span>,
    <span>Marquee</span> <span>=</span> <span>3</span>,
    <span>MarqueePaused</span> <span>=</span> <span>4</span>,
    <span><span>//</span> "None" is used for the default ProgressBar instance in the TaskDialogPage so</span>
    <span><span>//</span> that you need to set the State to a different value (or create a new ProgressBar</span>
    <span><span>//</span> instance) to actually show a progress bar in the dialog.</span>
    <span>None</span> <span>=</span> <span>5</span>
}</pre></div>
<div><pre><span>public</span> <span>enum</span> <span>TaskDialogExpanderPosition</span>
{
    <span>AfterText</span> <span>=</span> <span>0</span>,
    <span>AfterFootnote</span> <span>=</span> <span>1</span>
}</pre></div>
<h3>Event Cycle</h3>
<p>The events in the proposed API currently have the folowing cycle at runtime (the diagram illustrates navigating the dialog in the <code>TaskDialogButton.Click</code> event):</p>
<pre><code>Caller                                          Events

TaskDialog.ShowDialog();
       ‚Üì
    (Calls TaskDialogIndirect())
       ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&gt;
                    ‚Üì      (Window handle available now)
                Callback(TDN_CREATED) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&gt; TaskDialogPage[1].Created
                    ‚Üì      (Window becomes visible)
                    ‚Üì
                  (...)
                    ‚Üì
                Callback(TDN_BUTTON_CLICKED) ‚îÄ‚îÄ&gt; TaskDialogButton.Click
                                                   ‚Üì
                      TaskDialogPage.Navigate() &lt;‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                              ‚Üì
                              ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&gt; TaskDialogPage[1].Destroyed
                              ‚Üì
                    &lt;‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                    ‚Üì
                Callback(TDN_NAVIGATED) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&gt; TaskDialogPage[2].Created
                    ‚Üì
                  (...)
                    ‚Üì
                Callback(TDN_BUTTON_CLICKED) ‚îÄ‚îÄ&gt; TaskDialogButton.Click
                    ‚Üì      (Window closes; Dialog no longer navigable as it set a result button)
                    ‚Üì
                Callback(TDN_DESTROYED) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ&gt; TaskDialogPage[2].Destroyed
                    ‚Üì      (Window handle no longer available)
       &lt;‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       (TaskDialogIndirect() returns)
       ‚Üì
(TaskDialog.ShowDialog() returns)
</code></pre>
<h3>Implementation</h3>
<p>The proposed API is implemented with PR <a data-error-text="Failed to load title" data-id="456669838" data-permission-text="Title is private" data-url="https://github.com/dotnet/winforms/issues/1133" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/winforms/pull/1133/hovercard" href="https://github.com/dotnet/winforms/pull/1133">#1133</a>.</p>
<h3>API Updates</h3>
<ul>
<li><del>Removed property <code>TaskDialogContents.DoNotSetForeground</code> as it doesn't seem to have an effect</del></li>
<li>Removed base classes <code>TaskDialogControlCollection</code> and <code>TaskDialogButtonCollection</code></li>
<li><code>TaskDialogCustomButtonCollection</code> and <code>TaskDialogRadioButtonCollection</code> inherit from <code>Collection</code> instead of <code>KeyedCollection</code></li>
<li>Added an implicit cast operator from <code>TaskDialogButtons</code> to <code>TaskDialogCommonButtonCollection</code></li>
<li>Removed property <code>ResultVerificationFlagChanged</code> from <code>TaskDialog</code></li>
<li>Renamed property <code>ExpandedByDefault</code> to <code>Expanded</code> (<code>TaskDialogExpander</code>) (so its value will be updated when the user clicks the expando button)</li>
<li>Removed non-predefined icons (that were used from <code>imageres.dll</code>)</li>
<li>Class <code>TaskDialog</code> extends <code>System.ComponentsModel.Component</code> (and is disposable)</li>
<li>Added <code>Tag</code> property to <code>TaskDialogControl</code></li>
<li>Class <code>TaskDialogCommonButton</code> now has a default constructor (like other control classes)</li>
<li>Renamed properties/events (e.g. <code>MainInstruction</code> -&gt; <code>Instruction</code>, <code>Content</code> -&gt; <code>Text</code>, <code>ButtonClicked</code> -&gt; <code>Click</code>)</li>
<li>Properties and events of <code>TaskDialogRadioButton</code> and <code>TaskDialogVerificationCheckbox</code> has been aligned with WinForms concepts (property <code>Checked</code>, event <code>CheckedChanged</code>).</li>
<li>Renamed class <code>TaskDialogVerificationCheckbox</code> to <code>TaskDialogCheckBox</code> (along with properties)</li>
<li>Created struct <code>TaskDialogProgressBarRange</code> to be used for the <code>TaskDialogProgressBar.Range</code> property instead of <code>(int min, int max)</code> for better designer support</li>
<li>Restored property <code>TaskDialogContents.DoNotSetForeground</code> as it is actually working.</li>
<li>Removed <code>TaskDialogBooleanStatusEventArgs</code>.</li>
<li>Remaned <code>TaskDialogProgressBarState</code> enum value <code>MarqueeDisabled</code> to <code>MarqueePaused</code></li>
<li>Made class <code>TaskDialogControl</code> <code>abstract</code></li>
<li>Renamend enum value <code>TaskDialogIcon.Stop</code> to <code>Error</code></li>
<li>Removed the <code>TaskDialogProgressBar.Range</code> property (along with the <code>TaskDialogProgressBarRange</code> struct) and instead added properties <code>Minimum</code> and <code>Maximum</code> directly on the <code>TaskDialogProgressBar</code> and also renamed property <code>Position</code> to <code>Value</code>, to simplify the API and align with the WinForms ProgressBar</li>
<li>Removed the WPF types</li>
<li>Extracted the footer-specific properties on <code>TaskDialogContents</code> (<code>FooterText</code>, <code>FooterIcon</code>, <code>FooterIconHandle</code>) into their own <code>TaskDialogFooter</code> class. The reasoning for this is that a separate dialog area is added for the footer when it is used (as shown in the below image), similar to the expander (and it reduces the number of properties in <code>TaskDialogContents</code>).<br>Also, when you intially don't create a footer when showing the task dialog, you cannot later add one by updating the <code>FooterText</code> property, similar to the <code>Text</code> property of the <code>Expander</code> (which is different from the other text properties like <code>TaskDialogContents.Text</code> and <code>Instruction</code> that can be added later).<br>A separate <code>TaskDialogFooter</code> class that inherits from <code>TaskDialogControl</code> can thus share the behavior with <code>taskDialogExpander</code> to throw an <code>InvalidOperationException</code> when trying to update its <code>Text</code> property but the control wasn't created because it was initially <code>null</code> (or <code>string.Empty</code>).<br><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/53682175-58708780-3cf3-11e9-9e4c-0eb33812635c.png"><img src="https://user-images.githubusercontent.com/13289184/53682175-58708780-3cf3-11e9-9e4c-0eb33812635c.png" alt="taskdialog-footer"></a></li>
<li>Renamed events <code>TaskDialog.Closing</code> to <code>Closed</code> and <code>TaskDialogContents.Destroying</code> to <code>Destroyed</code>, and added a new <code>TaskDialog.Closing</code> event that is called directly after a <code>TaskDialogButton.Click</code> event if the button would close the dialog, and it allows to cancel the close (similar to <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.form.formclosing" rel="nofollow"><code>Form.FormClosing</code></a> event in WinForms) - see <a href="https://github.com/dotnet/winforms/issues/146#issuecomment-469413883" data-hovercard-type="issue" data-hovercard-url="/dotnet/winforms/issues/146/hovercard">this comment (Option B)</a>.</li>
<li>Renamed property <code>TaskDialogExpander.ExpandoButtonClicked</code> to <code>ExpandedChanged</code></li>
<li>Renamed class <code>TaskDialogContents</code> to <code>TaskDialogPage</code> and property <code>TaskDialog.CurrentContents</code> to <code>TaskDialog.Page</code>. This is because the documentation also talks about "navigating to a new page" - for example see <a href="https://docs.microsoft.com/en-us/windows/desktop/uxguide/win-dialog-box#multi-page-dialog-boxes" rel="nofollow">Multi-page dialog boxes</a>.</li>
<li>Removed the <code>TimerTick</code> event on <code>TaskDialogPage</code>:<br>
This event represents the <a href="https://docs.microsoft.com/en-us/windows/desktop/Controls/tdn-timer" rel="nofollow"><code>TDN_TIMER</code></a> notification that is called every 200 ms if the <code>TDF_CALLBACK_TIMER</code>  flag was set in the task dialog config. The previous implementation specified the flag if the event handler has been set (like the implementation in the Windows API Code Pack did), but this means you could not add an event handler to the <code>TimerTick</code> event after the dialog is displayed/navigated. Also, the interval of <code>200</code> is fixed (and a user might get the impression that the dialog can only be updated every 200 ms, which is not the case).<br>
Instead, the user can use one of the already existing UI timer implementations like <code>System.Windows.Forms.Timer</code>. Both the Task Dialog timer and the WinForms Timer use a Windows timer (<code>WM_TIMER</code> messages), so using the WinForms timer should have the same behavior as the TaskDialog timer but with more flexibility.</li>
<li>Moved property <code>StartupLocation</code> from <code>TaskDialogPage</code> to <code>TaskDialog</code> because it only has an effect when showing the dialog (but not when navigating it) and therefore isn't related to the page (which represents the contents of the dialog).</li>
<li><del>Added events <code>TaskDialog.Activated</code> and <code>TaskDialog.Deactivated</code>.</del> Edit: Removed these again because of an unresolved issue when closing the dialog.</li>
<li>Added event <code>TaskDialog.Shown</code> (similar to <code>Form.Shown)</code>.</li>
<li>Renamed class <code>TaskDialogCommonButton</code> to <code>TaskDialogStandardButton</code> (along with collections and property names).</li>
<li>Moved property <code>TaskDialogPage.DoNotSetForeground</code> to <code>TaskDialog</code> because it only has an effect when showing the dialog, but not when navigating it.</li>
<li>Unified mutually exclusive properties <code>Icon</code>+<code>IconHandle</code> on <code>TaskDialogPage</code> and <code>TaskDialogFooter</code> into a single <code>Icon</code> property use subclasses to differentiate between icon types  (see <a data-error-text="Failed to load title" data-id="387449844" data-permission-text="Title is private" data-url="https://github.com/dotnet/winforms/issues/146" data-hovercard-type="issue" data-hovercard-url="/dotnet/winforms/issues/146/hovercard?comment_id=467032370&amp;comment_type=issue_comment" href="https://github.com/dotnet/winforms/issues/146#issuecomment-467032370">#146 (comment)</a>).<br>
This should avoid confusion about having two mutually exclusive properties (and it allows to initially not showing an icon but then updating it to one using a handle (without using navigation)).<br>
Additionally, it will allow us in the future to add an additional icon type that represents integer/string resource icons (e.g. from <code>imageres.dll</code> or the application's executable), which could also be shown using a colored bar (which is not possible when using a handle).</li>
<li>Renamed property <code>TaskDialogPage.CommandLinkMode</code> to <code>CustomButtonStyle</code> (along with the enum).</li>
<li><code>TaskDialog</code> no longer inherits from <code>System.ComponentModel.Component</code> which was used for trying to implement designer support, but that would require additional work. It be revisited for a future version.</li>
<li>Renamed event <code>TaskDialogPage.Help</code> to <code>HelpRequest</code> (and method <code>OnHelp</code> to <code>OnHelpRequest</code>) as discussed in <a data-error-text="Failed to load title" data-id="456669838" data-permission-text="Title is private" data-url="https://github.com/dotnet/winforms/issues/1133" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/winforms/pull/1133/hovercard" href="https://github.com/dotnet/winforms/pull/1133">#1133</a>.</li>
<li>Renamed property <code>TaskDialog.DoNotSetForeground</code> to <code>TaskDialog.SetToForeground</code> (the default value is still false), as per the feedback in <a data-error-text="Failed to load title" data-id="456669838" data-permission-text="Title is private" data-url="https://github.com/dotnet/winforms/issues/1133" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/winforms/pull/1133/hovercard" href="https://github.com/dotnet/winforms/pull/1133">#1133</a>.</li>
<li>Enabled nullable reference types.</li>
<li>Made events nullable (see <a data-error-text="Failed to load title" data-id="469374073" data-permission-text="Title is private" data-url="https://github.com/dotnet/coreclr/issues/25752" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/coreclr/pull/25752/hovercard" href="https://github.com/dotnet/coreclr/pull/25752">dotnet/coreclr#25752</a>).</li>
</ul>
<p><strong><a href="https://github.com/dotnet/apireviews/tree/master/2019/System.Windows.Forms">API Review Feedback</a>:</strong></p>
<ul>
<li>Renamed method group <code>TaskDialog.Show</code> to <code>ShowDialog</code>.</li>
<li>Renamed property <code>TaskDialogPage.Instruction</code> to <code>MainInstruction</code> (same with parameter names for the static <code>TaskDialog.Show</code> methods).</li>
<li>Renamed property <code>TaskDialogPage.Title</code> to <code>Caption</code> (same with parameter names for the static <code>TaskDialog.Show</code> methods).</li>
<li>Removed class <code>TaskDialogButtonClickedEventArgs</code> and instead added boolean property <code>TaskDialogButton.ShouldCloseDialog</code> that allows to specify whether clicking the button should close the task dialog.</li>
<li>Removed types <code>TaskDialogStandardIcon</code> and <code>TaskDialogIconHandle</code>, and instead added static fields on <code>TaskDialogIcon</code> for the standard icons, and added a constructor taking an icon or icon handle.</li>
</ul>
<p><strong>End of API Review Feedback</strong></p>
<ul>
<li>Added an <code>int</code> indexer to <code>TaskDialogStandardButtonCollection</code> to avoid an overload resolution in the C# compiler for expressions like <code>page.StandardButtons[0]</code>. See <a data-error-text="Failed to load title" data-id="456669838" data-permission-text="Title is private" data-url="https://github.com/dotnet/winforms/issues/1133" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/winforms/pull/1133/hovercard?comment_id=557483834&amp;comment_type=issue_comment" href="https://github.com/dotnet/winforms/pull/1133#issuecomment-557483834">#1133 (comment)</a></li>
<li>Changes from <a data-error-text="Failed to load title" data-id="535497878" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/1" data-hovercard-type="pull_request" data-hovercard-url="/kpreisser/winforms/pull/1/hovercard" href="https://github.com/kpreisser/winforms/pull/1">kpreisser#1</a>:
<ul>
<li>Added implicit cast operator from <code>string</code> to <code>TaskDialogFooter</code>.</li>
</ul>
</li>
<li>Replaced property <code>TaskDialogExpander.ExpandFooterArea</code> with <code>Position</code> (using enum type <code>TaskDialogExpanderPosition</code>).</li>
<li>Added properties <code>TaskDialogPage.BoundDialog</code> and <code>TaskDialogControl.BoundPage</code>, so that it is possible e.g. to access the current <code>TaskDialog</code> instance in a button click handler. <a href="https://github.com/RussKie/TaskDialogStudy-exercises/commit/8b6d297df99458e6a28030013d86b2e3873ac0a5#r36112407">See discussion here</a>.</li>
<li>Renamed icons <code>SecurityShield</code>, <code>SecurityShieldBlueBar</code>, <code>SecurityShieldGrayBar</code>, <code>SecurityWarningYellowBar</code>, <code>SecurityErrorRedBar</code>, <code>SecuritySuccessGreenBar</code> to <code>Shield</code>, <code>ShieldBlueBar</code>, <code>ShieldGrayBar</code>, <code>ShieldWarningYellowBar</code>, <code>ShieldErrorRedBar</code>, <code>ShieldSuccessGreenBar</code>; as the term "security" would imply that such icons will/must be used for security purposes.</li>
<li>Changes from <a data-error-text="Failed to load title" data-id="535498577" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/3" data-hovercard-type="pull_request" data-hovercard-url="/kpreisser/winforms/pull/3/hovercard" href="https://github.com/kpreisser/winforms/pull/3">kpreisser#3</a>:
<ul>
<li>Renamed <code>TaskDialogPage.CanBeMinimized</code> to <code>AllowMinimize</code>.</li>
<li>Renamed <code>TaskDialogButton.ShouldCloseDialog</code> to <code>AllowCloseDialog</code>.</li>
<li>Add optional parameters to the <code>TaskDialogStandardButton</code> and <code>TaskDialogCustomButton</code> constructors and to the <code>TaskDialogStandardButtonCollection.Add</code> and <code>TaskDialogCustomButtonCollection.Add</code> methods.</li>
</ul>
</li>
<li>Simplified type of event <code>TaskDialogButton.Click</code> from <code>EventHandler&lt;EventArgs&gt;</code> to <code>EventHandler</code>.</li>
<li>Removed hyperlink functionality for now - see <a data-error-text="Failed to load title" data-id="560788792" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/4" data-hovercard-type="issue" data-hovercard-url="/kpreisser/winforms/issues/4/hovercard" href="https://github.com/kpreisser/winforms/issues/4">kpreisser#4</a>.</li>
<li>Refactored Button API - see <a data-error-text="Failed to load title" data-id="578093493" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/12" data-hovercard-type="pull_request" data-hovercard-url="/kpreisser/winforms/pull/12/hovercard" href="https://github.com/kpreisser/winforms/pull/12">kpreisser#12</a></li>
<li>Streamlined single/multipage API - see <a data-error-text="Failed to load title" data-id="582714361" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/14" data-hovercard-type="pull_request" data-hovercard-url="/kpreisser/winforms/pull/14/hovercard" href="https://github.com/kpreisser/winforms/pull/14">kpreisser#14</a></li>
<li>Move instance property <code>StartupLocation</code> to a parameter of <code>ShowDialog()</code> - see <a data-error-text="Failed to load title" data-id="586611656" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/16" data-hovercard-type="pull_request" data-hovercard-url="/kpreisser/winforms/pull/16/hovercard" href="https://github.com/kpreisser/winforms/pull/16">kpreisser#16</a></li>
<li>Allow to create <code>TaskDialogIcon</code> from a <code>Bitmap</code> - see <a data-error-text="Failed to load title" data-id="586598304" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/15" data-hovercard-type="pull_request" data-hovercard-url="/kpreisser/winforms/pull/15/hovercard" href="https://github.com/kpreisser/winforms/pull/15">kpreisser#15</a></li>
<li>Renamed property <code>TaskDialogPage.MainInstruction</code> to <code>Heading</code> - see <a data-error-text="Failed to load title" data-id="560810197" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/6" data-hovercard-type="issue" data-hovercard-url="/kpreisser/winforms/issues/6/hovercard" href="https://github.com/kpreisser/winforms/issues/6">kpreisser#6</a></li>
<li>Renamed class <code>TaskDialogFooter</code> (and corresponding properties) to <code>TaskDialogFootnote</code> - see <a data-error-text="Failed to load title" data-id="562370824" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/8" data-hovercard-type="issue" data-hovercard-url="/kpreisser/winforms/issues/8/hovercard" href="https://github.com/kpreisser/winforms/issues/8">kpreisser#8</a></li>
<li>Renamed <code>TaskDialogStartupLocation.CenterParent</code> to <code>CenterOwner</code></li>
<li>Removed method <code>TaskDialogCheckBox.Focus()</code></li>
<li>Renamed property <code>TaskDialogButton.ElevationRequired</code> to <code>ShowShieldIcon</code></li>
<li>Renamed class <code>TaskDialogCheckBox</code> (and corresponding properties) to `TaskDialogVerificationCheckBox¬¥ - see <a data-error-text="Failed to load title" data-id="596981352" data-permission-text="Title is private" data-url="https://github.com/kpreisser/winforms/issues/18" data-hovercard-type="pull_request" data-hovercard-url="/kpreisser/winforms/pull/18/hovercard" href="https://github.com/kpreisser/winforms/pull/18">kpreisser#18</a></li>
<li>Removed property <code>TaskDialogPage.Width</code></li>
</ul>
<h3>Possible API TODOs</h3>
<ul>
<li>Maybe rename <code>TaskDialogProgressBarState</code> to <code>TaskDialogProgressBarStyle</code></li>
<li>Probably add property <code>Tag</code> on <code>TaskDialog</code> (which is already present on <code>TaskDialogControl</code>)</li>
<li>Check how method <code>ShowDialog()</code> should behave. Currently, it either shows the dialog modal (when specifying an owner) or non-modal, but in both cases the method does <strong>not return</strong> until the dialog has closed (similar to <code>Form.ShowDialog()</code>), which is the behavior of the native <a href="https://docs.microsoft.com/en-us/windows/desktop/api/commctrl/nf-commctrl-taskdialogindirect" rel="nofollow"><code>TaskDialogIndirect</code></a> function. <br>This is the same as with <code>MessageBox.Show()</code>; however, the <code>MessageBox</code> automatically uses the current foreground window as owner when you don't specify the owner. For the Task Dialog however, it definitely should be possible to show it non-modal.<br>Note that this means you can show multiple non-modal dialogs at once, but each open dialog will add a <code>TaskDialog.Show()</code> entry in the call stack.</li>
</ul>
<h3>API Usage Notes</h3>
<ul>
<li>Because some parts of the Task Dialog can be updated while it is shown (while others cannot), properties that cannot be updated while the dialog is shown will throw an <code>InvalidOperationException</code> (this was also the behavior of the task dialog implementation in the Windows API Code Pack). <br>For example, radio buttons cannot be unselected while the dialog is shown (but they can be selected). This means that assigning <code>false</code> to the <code>TaskDialogRadioButton.Checked</code> property (while the radio button is shown in a task dialog) will throw.</li>
<li>Although the <code>TaskDialogStandardButtonCollection</code> has an ordererd list of <code>TaskDialogStandardButton</code>, that order does not reflect the order in which the task dialog actually displays the buttons (since they are specified by flags in the <code>TASKDIALOGCONFIG</code> structure). However, the order of the <code>TaskDialogCustomButtonCollection</code> (as well as <code>TaskDialogRadioButtonCollection</code>) is reflected by the task dialog.</li>
<li>Instance method <code>TaskDialog.Show()</code> can return a <code>TaskDialogStandardButton</code> which was not added to the dialog in the following cases (which results from the native task dialog implementation):
<ul>
<li>No button has been added to the dialog, in which case it automatically gets an <strong>OK</strong> button, and so a button with <code>TaskDialogResult.OK</code> is returned when the user clicks it.</li>
<li>No Cancel button has been added to the dialog, but the dialog is programmatically closed by calling the <code>Close()</code> method, or <code>TaskDialogPage.AllowCancel</code> has been set and the dialog is closed by the user by pressing ESC or Alt+F4 or clicking the X button in the title bar. In these cases a button with <code>TaskDialogResult.Cancel</code> will be returned.<br>
This can also happen when a non-modal task dialog is shown but the main window of the app is closed, in which case the task dialog is also closed and returns a <code>Cancel</code> result.</li>
</ul>
</li>
<li>It is possible to use a color bar with a different icon (one of the predefined icons or an icon resource from <code>imageres.dll</code>), by initially specifying one of the <code>Security...Bar</code> icons, and when the dialog is shown, update it to a different icon:<br>
<a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/13289184/52176607-4adbe680-27b5-11e9-87ee-e944f34ed181.png"><img src="https://user-images.githubusercontent.com/13289184/52176607-4adbe680-27b5-11e9-87ee-e944f34ed181.png" alt="taskdialog-colorbar-customicon"></a><br>
However, it isn't possible to use a color bar with a icon handle, because after showing the dialog you can only update the icon member that was initially used to show a dialog, and specifying a color bar requires to use the non-handle icon member.<br>
This means currently you can only use one of the standard icons with a color bar, but in a later version we could add support for showing icons from integer/string resources of DLLs/EXEs (e.g. from <code>imageres.dll</code>) (by specifying the <code>hInstance</code> field of the native <code>TASKDIALOGCONFIG</code> struct), which would then allow you to show a custom icon with a colored bar.</li>
</ul>
      </div>
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>