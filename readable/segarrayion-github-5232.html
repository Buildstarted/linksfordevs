<!DOCTYPE html>
<html lang="en">
<head>
    <title>
segarray.ion - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="segarray.ion - linksfor.dev(s)"/>
    <meta property="article:author" content="pervognsen"/>
    <meta property="og:description" content="GitHub Gist: instantly share code, notes, and snippets."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://gist.github.com/pervognsen/c9d18e8012ce497e7a92d3f86c112337"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - segarray.ion</title>
<div class="readable">
        <h1>segarray.ion</h1>
            <div>by pervognsen</div>
            <div>Reading time: 2 minutes</div>
        <div>Posted here: 28 Feb 2019</div>
        <p><a href="https://gist.github.com/pervognsen/c9d18e8012ce497e7a92d3f86c112337">https://gist.github.com/pervognsen/c9d18e8012ce497e7a92d3f86c112337</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-commit-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/Code">
    <main id="gist-pjax-container" data-pjax-container="">
      


  


<div>
  <div>
    
  




<div>
  

  <div data-multiple="">

    <div>

  <div>
    <div>
      <details>
        <summary data-ga-click="Repository, clone Embed, location:repo overview" aria-haspopup="menu" role="button">
          <span data-menu-button="">Embed</span>
        </summary>
        <details-menu data-menu-input="gist-share-url" aria-label="Clone options" role="menu">
          <p><span>What would you like to do?</span>
          </p>
          
          
        </details-menu>
      </details>
    </div>

    
  </div>
</div>


    


    
  </div>
</div>


  </div>
</div>

<div>
  <div>
    
  <div>
    

        <div>
  <div id="file-segarray-ion">
      
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-segarray-ion-L1" data-line-number="1"></td>
        <td id="file-segarray-ion-LC1">typedef T = int;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L2" data-line-number="2"></td>
        <td id="file-segarray-ion-LC2">var segs: T**;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L3" data-line-number="3"></td>
        <td id="file-segarray-ion-LC3">var seg: T*;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L4" data-line-number="4"></td>
        <td id="file-segarray-ion-LC4">var segcap = 1;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L5" data-line-number="5"></td>
        <td id="file-segarray-ion-LC5">var segidx = 1;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L6" data-line-number="6"></td>
        <td id="file-segarray-ion-LC6">
</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L7" data-line-number="7"></td>
        <td id="file-segarray-ion-LC7">func grow() {</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L8" data-line-number="8"></td>
        <td id="file-segarray-ion-LC8">    seg = 0;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L9" data-line-number="9"></td>
        <td id="file-segarray-ion-LC9">    asetcap(seg, segcap);</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L10" data-line-number="10"></td>
        <td id="file-segarray-ion-LC10">    apush(segs, seg);</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L11" data-line-number="11"></td>
        <td id="file-segarray-ion-LC11">    segcap *= 2;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L12" data-line-number="12"></td>
        <td id="file-segarray-ion-LC12">}</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L13" data-line-number="13"></td>
        <td id="file-segarray-ion-LC13">
</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L14" data-line-number="14"></td>
        <td id="file-segarray-ion-LC14">func add(x: T): usize {</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L15" data-line-number="15"></td>
        <td id="file-segarray-ion-LC15">    if (alen(seg) == acap(seg)) {</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L16" data-line-number="16"></td>
        <td id="file-segarray-ion-LC16">        grow();</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L17" data-line-number="17"></td>
        <td id="file-segarray-ion-LC17">    }</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L18" data-line-number="18"></td>
        <td id="file-segarray-ion-LC18">    apush(seg, x);</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L19" data-line-number="19"></td>
        <td id="file-segarray-ion-LC19">    return segidx++;</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L20" data-line-number="20"></td>
        <td id="file-segarray-ion-LC20">}</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L21" data-line-number="21"></td>
        <td id="file-segarray-ion-LC21">
</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L22" data-line-number="22"></td>
        <td id="file-segarray-ion-LC22">func get(i: usize): T* {</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L23" data-line-number="23"></td>
        <td id="file-segarray-ion-LC23">    e := log2(i);</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L24" data-line-number="24"></td>
        <td id="file-segarray-ion-LC24">    b := pow2(e);</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L25" data-line-number="25"></td>
        <td id="file-segarray-ion-LC25">    return &amp;segs[e][i-b];</td>
      </tr>
      <tr>
        <td id="file-segarray-ion-L26" data-line-number="26"></td>
        <td id="file-segarray-ion-LC26">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>


    
</div>
  </div>
</div><!-- /.container -->

    </main>
  </div>

  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
</body>
</html>