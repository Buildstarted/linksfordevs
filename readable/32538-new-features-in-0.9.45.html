<!DOCTYPE html>
<html lang="en">
<head>
    <title>
New features in 0.9.45 -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <style type="text/css">
        html {
            font-family: sans-serif;
            line-height: 1.15;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            height: 100%;
        }

        *, ::after, ::before {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #60656a;
            text-align: left;
            background-color: #323b44;
        }

        h1 {
            font-size: 6rem;
            font-weight: 300;
            line-height: 1.2;
            margin-top: 0;
            margin-bottom: 0.5rem;
            margin-bottom: 0.5rem
        }

        a {
            color: #007bff;
            color: #ccc;
            text-decoration: none;
            background-color: transparent;
            word-break: break-all;
        }

        .unseen a {
            font-weight: bold;
        }

        h3 {
            margin-top: 0;
            padding-top: 0;
            font-weight: normal;
        }

        .grid {
            -ms-flex-direction: column;
            flex-direction: column;
            width: 1024px;
            margin: 0 auto;
            flex: 1 0 auto;
        }

        .row {
            -ms-flex-direction: row;
            flex-direction: row;
            width: 100%;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            display: -ms-flexbox;
            display: flex;
        }

        .col {
            margin: 0 10px 0 10px;
            box-sizing: border-box;
            vertical-align: top;
        }

        .col-3-of-4, .col-6-of-8, .col-9-of-12 {
            width: calc(75% - 20px);
        }

        .col-1-of-4, .col-2-of-8, .col-3-of-12 {
            width: calc(25% - 20px);
        }

        @media (max-width:1023px) {
            /* big landscape tablets, laptops, and desktops */
            body {
                overflow-x: hidden;
            }

            main {
                width: 99%;
            }

            h1 {
                font-size: 50px;
            }
        }

        .text-right {
            text-align: right;
        }

        footer {
            left: 0;
            width: 100%;
            margin-top: 2em;
            padding: 50px 0;
            text-align: center;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        .readable {
            color: #949ba2;
        }

        svg:not(:root).svg-inline--fa {
            color: #60656a;
            overflow: visible;
        }

        .svg-inline--fa.fa-w-12 {
            width: 0.75em;
        }

        svg:not(:root) {
            overflow: hidden;
        }

        .svg-inline--fa {
            display: inline-block;
            font-size: inherit;
            height: 1em;
            overflow: visible;
            vertical-align: -0.125em;
        }

        img {
            max-width: 100%;
        }

        .text-center {
            text-align: center;
        }

        .readable h1 {
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>New features in 0.9.45</h1>
    <article id="post-18234" class="post-18234 post type-post status-publish format-standard hentry category-information category-news tag-net tag-callables tag-compiler tag-il tag-include tag-performance tag-php tag-reflection tag-release tag-require tag-xinclude"> <div class="entry-content"> <p>Leading up to the release of the first stable version of our PHP compiler, we are now implementing the first various compiler optimizations. Read more about them in this blog and why you should update or try PeachPie 0.9.45!</p> <span id="more-18234"></span> <p>As usually, this release fixes some issues, adds new standard PHP features that were required to run certain frameworks and also introduces the first optimizations the compiler can perform to maximize the performance of the compiled PHP apps.</p> <h2>Compile-Time Enhancements</h2> <p>There are some nice examples of what the compiler can do, and what the consequences of that can be. Mostly the compiler now evaluates more conditions and therefore resolves more unreachable code; not only does it make the resulting assembly smaller, but since the unreachable code may contain alternative declarations of functions and classes, the compiler now ignores those declarations, getting rid of potential ambiguities and avoiding a dynamic resolution in run-time. </p> <p>Below is a list of some of the optimization we&#x2019;ve tried so far. This is only a small fraction of possible performance improvements to make, but our internal benchmarks show that these have already sped up e.g. the loading of a WordPress page by about 8%!</p> <ul><li>string concatenation is resolved in compile time if possible</li></ul> <div class="wp-block-image"><figure class="aligncenter"><a href="https://try.peachpie.io/#v2:DYLgDgFmA+A8D8kwFgBQaCmBjCB7ABAEQASGwwBAZgE64C2R+AdPgArGsD6AogBoAqAJQCCnAGrdBAZQCSAeQByzIgEJCAbiA==="><img src="https://www.peachpie.io/wp-content/uploads/2019/08/image-2.png" alt class="wp-image-18247" srcset="https://www.peachpie.io/wp-content/uploads/2019/08/image-2.png 688w, https://www.peachpie.io/wp-content/uploads/2019/08/image-2-300x183.jpg 300w" sizes="(max-width: 688px) 100vw, 688px"></a><figcaption>Constant evaluation and string concatenation.</figcaption></figure></div> <ul><li>more complex conditions are evaluated</li><li><code>ini_get()</code> evaluated in compile time in some cases. Usually if we know the option is not supported and ini_get() would always return FALSE</li><li><code>basename(__FILE__)</code> and <code>dirname(__FILE__)</code> get evaluated</li></ul> <div class="wp-block-image"><figure class="aligncenter"><a href="https://try.peachpie.io/#v2:DYLgDgFmA+A8D8kwFgBQaCmBjCB7ABAEYCGAzhgHbEC2GAFAPoMBiAkgDICiTAlANxA="><img src="https://www.peachpie.io/wp-content/uploads/2019/08/image-3.png" alt class="wp-image-18248" srcset="https://www.peachpie.io/wp-content/uploads/2019/08/image-3.png 796w, https://www.peachpie.io/wp-content/uploads/2019/08/image-3-300x161.jpg 300w, https://www.peachpie.io/wp-content/uploads/2019/08/image-3-768x412.jpg 768w" sizes="(max-width: 796px) 100vw, 796px"></a><figcaption>Evaluation of a well-known patterns.</figcaption></figure></div> <ul><li><code>include </code>and <code>require </code>can be evaluated as well; since PeachPie compiles script files into .NET static methods, they can be called directly instead of looking into a hash table and resolving the file path in run time</li></ul> <div class="wp-block-image"><figure class="aligncenter"><a href="https://try.peachpie.io/#v2:DYLgDgFmA+A8D8kwFgBQaCWA7AxsArgCYCmA+gPa7EAEppAIgJIBKd1AdNQEQD02JAD3ZIuAbiA="><img src="https://www.peachpie.io/wp-content/uploads/2019/08/image.png" alt class="wp-image-18245" srcset="https://www.peachpie.io/wp-content/uploads/2019/08/image.png 427w, https://www.peachpie.io/wp-content/uploads/2019/08/image-300x185.jpg 300w" sizes="(max-width: 427px) 100vw, 427px"></a><figcaption>&#x201C;include&#x201D; results in a direct call to the compiled global code.</figcaption></figure></div> <ul><li><code>callables</code> can be evaluated in compile time; this is more complex and maybe it deserves its own blog post. When a constant value is about to be converted to a callable &#x2013; e.g. <code>array_map(&apos;cube&apos;,&#xA0;$a);</code> &#x2013; and since every PHP function is compiled into a .NET method, we can resolve the function name &#x2013; &#x2018;cube&#x2019; &#x2013; and use the CLR delegate directly. The delegate is pre-allocated and results in zero overhead instead of resolving the function in run-time</li></ul> <div class="wp-block-image"><figure class="aligncenter"><a href="https://try.peachpie.io/#v2:DYLgDgFmA+A8D8kwFgBQaBmBXAdgYwBcBLAexwAIMSSAKASnIG9yBfNNPAQ2GAH0sAzgFMATr2z4aAIiokpdANxA"><img src="https://www.peachpie.io/wp-content/uploads/2019/08/image-4.png" alt class="wp-image-18249" srcset="https://www.peachpie.io/wp-content/uploads/2019/08/image-4.png 834w, https://www.peachpie.io/wp-content/uploads/2019/08/image-4-300x154.jpg 300w, https://www.peachpie.io/wp-content/uploads/2019/08/image-4-768x393.jpg 768w" sizes="(max-width: 834px) 100vw, 834px"></a><figcaption>When string is used as &#x201C;callable&#x201D;, it might be resolved in compile-time and cached delegate is used directly.</figcaption></figure></div> <p>Most of these optimizations only take effect when compiling the PHP app in release mode (on the command line: <code>dotnet build -c release</code>). We will continue to implement these types of optimizations to release a version 1.0 that&#x2019;s as performant as possible given the resources we have.</p> <h2>Added Features</h2> <p>More so than just fixing issues, we&#x2019;re constantly working on allowing real-world legacy PHP applications to run on .NET and .NET Core. While migrating code such as Laravel, Symfony, PHPUnit, WordPress and related plugins, and when compiling our clients&#x2019; really old PHP apps, we have implemented the following:</p> <ul><li>XInclude functionality (XML extension) (thanks <a href="https://github.com/TomatorCZ">TomatorCZ</a>)</li><li>PHP 7.4 syntax (not all features implemented yet, however)</li><li><code>mb_str_split()</code>, <code>??=</code> operator (PHP 7.4)</li><li><code>array_merge()</code> accepts zero arguments (PHP 7.4)</li><li><code>ReflectionClass::getProperties()</code></li><li><code>ReflectionProperty.setValue()</code> overload with 1 parameter </li><li><code>SORT_NATURAL</code>, <code>SORT_FLAG_CASE </code></li><li><code>dirname()</code> with <code>level </code>parameter</li></ul> <h2>Fixed Issues</h2> <p>As always, we continually fix issues our community submits on GitHub or that we run into when working on our clients&#x2019; projects. Here is a short list of some of the more prominent issues we encountered and fixed:</p> <ul><li>the compiler crashed due to an unsecured critical section in logging!</li><li>the compiler crashed on a nullref exception in case of a syntax error</li><li><code>var_export()</code> did not escape outputted strings</li><li>the compiler treated all primitive types as nullable</li><li><code>get_parent_class()</code> returned invalid values when used without arg</li></ul> <h2>Conclusion</h2> <p>As always, we welcome any feedback, contributions, issues, questions and we continue to implement features as needed by both our clients and our community. If you&#x2019;re a .NET performance connoisseur, please do consider submitting PRs with any low-level optimizations you can think of! </p> <p>Follow our progress on the <a href="https://github.com/peachpiecompiler/peachpie">GitHub repo</a>, <a href="https://twitter.com/pchpcompiler">Twitter </a>or <a href="https://facebook.com/pchpcompiler">Facebook</a>.</p>
<div class="ssba ssba-wrap"><div>Share this article:<a class="ssba_facebook_share" href="http://www.facebook.com/sharer.php?u=https://www.peachpie.io/2019/08/peachpie-0945.html"><img src="https://www.peachpie.io/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/facebook.png" class="ssba ssba-img" alt="Share on Facebook"></a><a class="ssba_vk_share ssba_share_link" href="http://vkontakte.ru/share.php?url=https://www.peachpie.io/2019/08/peachpie-0945.html"><img src="https://www.peachpie.io/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/vk.png" class="ssba ssba-img" alt="Share on VK"></a><a class="ssba_pinterest_share" href="javascript:void((function()%7Bvar%20e=document.createElement(&apos;script&apos;);e.setAttribute(&apos;type&apos;,&apos;text/javascript&apos;);e.setAttribute(&apos;charset&apos;,&apos;UTF-8&apos;);e.setAttribute(&apos;src&apos;,&apos;//assets.pinterest.com/js/pinmarklet.js?r=&apos;+Math.random()*99999999);document.body.appendChild(e)%7D)());"><img src="https://www.peachpie.io/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/pinterest.png" class="ssba ssba-img" alt="Pin on Pinterest"></a><a class="ssba_google_share" href="https://plus.google.com/share?url=https://www.peachpie.io/2019/08/peachpie-0945.html"><img src="https://www.peachpie.io/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/google.png" class="ssba ssba-img" alt="Share on Google+"></a><a class="ssba_twitter_share" href="http://twitter.com/share?url=https://www.peachpie.io/2019/08/peachpie-0945.html&amp;text=New+features+in+0.9.45+"><img src="https://www.peachpie.io/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/twitter.png" class="ssba ssba-img" alt="Tweet about this on Twitter"></a><a class="ssba_linkedin_share ssba_share_link" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.peachpie.io/2019/08/peachpie-0945.html"><img src="https://www.peachpie.io/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/linkedin.png" class="ssba ssba-img" alt="Share on LinkedIn"></a><a class="ssba_reddit_share" href="http://reddit.com/submit?url=https://www.peachpie.io/2019/08/peachpie-0945.html&amp;title=New features in 0.9.45"><img src="https://www.peachpie.io/wp-content/plugins/simple-share-buttons-adder/buttons/somacro/reddit.png" class="ssba ssba-img" alt="Share on Reddit"></a></div></div><div class="blog-subtext">Posted on August 7, 2019, in category <a href="https://www.peachpie.io/category/information">Information</a>, <a href="https://www.peachpie.io/category/news">News</a>, tags: <a href="https://www.peachpie.io/tag/net">.NET</a>, <a href="https://www.peachpie.io/tag/callables">callables</a>, <a href="https://www.peachpie.io/tag/compiler">compiler</a>, <a href="https://www.peachpie.io/tag/il">IL</a>, <a href="https://www.peachpie.io/tag/include">include</a>, <a href="https://www.peachpie.io/tag/performance">performance</a>, <a href="https://www.peachpie.io/tag/php">PHP</a>, <a href="https://www.peachpie.io/tag/reflection">reflection</a>, <a href="https://www.peachpie.io/tag/release">release</a>, <a href="https://www.peachpie.io/tag/require">require</a>, <a href="https://www.peachpie.io/tag/xinclude">xinclude</a></div>	</div> </article>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
</body>
</html>