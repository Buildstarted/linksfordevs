<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Custom internal calls in .NET Core hosting &#xB7; Issue #11941 &#xB7; dotnet/runtime - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Custom internal calls in .NET Core hosting &#xB7; Issue #11941 &#xB7; dotnet/runtime - linksfor.dev(s)"/>
    <meta property="article:author" content="NextTurn"/>
    <meta property="og:description" content="P/Invoke is not so efficient as internal calls when working with frequent native code calls, for instance, game scripting runtime. Internal calls in CoreCLR are hard coded in ecalllist.h and limite..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/coreclr/issues/22320"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Custom internal calls in .NET Core hosting &#xB7; Issue #11941 &#xB7; dotnet/runtime</title>
<div class="readable">
        <h1>Custom internal calls in .NET Core hosting &#xB7; Issue #11941 &#xB7; dotnet/runtime</h1>
        <p>
by NextTurn <br/>Reading time: 7-9 minutes        </p>
        <p><a href="https://github.com/dotnet/coreclr/issues/22320">https://github.com/dotnet/coreclr/issues/22320</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-channel="marked-as-read:issue:557933113">

              
<div data-gid="MDU6SXNzdWU1NTc5MzMxMTM=" data-url="/_render_node/MDU6SXNzdWU1NTc5MzMxMTM=/issues/body" data-channel="issue:557933113">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="40" width="40" alt="@NextTurn" src="https://avatars0.githubusercontent.com/u/45985406?s=88&amp;v=4"></a>

</p>


  
<div id="issue-557933113">
  <div data-body-version="9c83896cf9d5c97d9cc67f449b68d5f9" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>P/Invoke is not so efficient as internal calls when working with frequent native code calls, for instance, game scripting runtime.</p>
<p>Internal calls in CoreCLR are hard coded in <code>ecalllist.h</code> and limited to <code>mscorlib.dll</code> scope. While Mono provides a <code>mono_add_internal_call</code> API which became the first choice of Unity and CRYENGINE.</p>
<p>Will you provide an API to register custom internal calls?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>

</div>


              

  


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTIzMDE0Ng==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTIzMDE0Ng==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ1OTIzMDE0Ng==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/benaadams/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/benaadams"><img height="40" width="40" alt="@benaadams" src="https://avatars0.githubusercontent.com/u/1142958?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-459230146">
    <div>
      

  

<details data-body-version="0423e4d1b3995fa0756b6ee8f121a7a8">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTI2NzQyNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTI2NzQyNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ1OTI2NzQyNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="40" width="40" alt="@NextTurn" src="https://avatars0.githubusercontent.com/u/45985406?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-459267427">
    <div>
      

  

<details data-body-version="304b358eabab24689473a5d84e71bb31">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTM5MzMwNQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTM5MzMwNQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ1OTM5MzMwNQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/benaadams/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/benaadams"><img height="40" width="40" alt="@benaadams" src="https://avatars0.githubusercontent.com/u/1142958?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-459393305">
    <div>
      

  

<details data-body-version="bb0be68b88022d6324fefc49e35e3d16">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTM5NjM5NQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTM5NjM5NQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ1OTM5NjM5NQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/mattwarren/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/mattwarren"><img height="40" width="40" alt="@mattwarren" src="https://avatars2.githubusercontent.com/u/157298?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-459396395">
    <div>
      

  

<details data-body-version="0b10028fc1b9913218df8bd649b04649">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTM5OTg0MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ1OTM5OTg0MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ1OTM5OTg0MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/bencyoung/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bencyoung"><img height="40" width="40" alt="@bencyoung" src="https://avatars0.githubusercontent.com/u/12084524?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-459399840">
    <div>
      

  

<details data-body-version="32b11a9f1c866c0e25efb7e36c2c15c9">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="32b11a9f1c866c0e25efb7e36c2c15c9" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>We currently use P/Invoke to call into things like MKL and the overhead does show up in backtraces. We only pass unsafe pointers to unmanaged <del>code</del> objects so if there was a faster way to invoke native code that:</p>
<ol>
<li>Didn't need marshalling</li>
<li>Never called back into .NET</li>
<li>Didn't manipulate any .NET objects</li>
</ol>
<p>then we'd be extremely happy!</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2MTUyNzI5OQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2MTUyNzI5OQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2MTUyNzI5OQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/jkotas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/jkotas"><img height="40" width="40" alt="@jkotas" src="https://avatars3.githubusercontent.com/u/6668460?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-461527299">
    <div>
      

  

<details data-body-version="d1412d77675e33c79e7c6de0663f3390">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="d1412d77675e33c79e7c6de0663f3390" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>I think the proper way to address this is to add attribute to annotate PInvoke methods that always take less than microsecond and that do not do other problematic actions like taking locks that can deadlock with GC. The runtime would recognize this attribute and skip the full PInvoke transition for these.</p>
<p>More details in <a data-error-text="Failed to load issue title" data-id="406129156" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/coreclr/issues/22383" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/coreclr/pull/22383/hovercard?comment_id=461429171&amp;comment_type=issue_comment" href="https://github.com/dotnet/coreclr/pull/22383#issuecomment-461429171">dotnet/coreclr#22383 (comment)</a></p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjczNjA0OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjczNjA0OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2NjczNjA0OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="40" width="40" alt="@NextTurn" src="https://avatars0.githubusercontent.com/u/45985406?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466736048">
    <div>
      

  

<details data-body-version="f5b45fba020991bf63e469b8347c4f84">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="f5b45fba020991bf63e469b8347c4f84" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Thanks for your information <a data-hovercard-type="user" data-hovercard-url="/users/benaadams/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/benaadams">@benaadams</a>. I did a simple <a href="https://github.com/NextTurn/interop-benchmark">test</a> and <code>calli</code> instruction turned out to be the best solution for now.</p>
<p>Interestingly, <code>Math.Sqrt(Double)</code> runs as fast as <code>Convert.ToDouble(Double)</code>.</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://raw.githubusercontent.com/NextTurn/interop-benchmark/master/results/result.svg?sanitize=true"><img src="https://raw.githubusercontent.com/NextTurn/interop-benchmark/master/results/result.svg?sanitize=true" alt="Line Chart"></a></p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjczODU5Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjczODU5Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2NjczODU5Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/mjsabby/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/mjsabby"><img height="40" width="40" alt="@mjsabby" src="https://avatars3.githubusercontent.com/u/1930559?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466738593">
    <div>
      

  

<details data-body-version="0a66b6fc836f8305455d83acc903ac0c">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="0a66b6fc836f8305455d83acc903ac0c" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Not that I recommend this for your code, if you're satisfied with the performance ... but you can use <code>calli</code> with the managed calling convention to get better performance at the expense of delaying garbage collection. I did not see that in your benchmark you posted above.</p>
<p>On x64 the managed calling convention is the native x64 calling convention, and on Windows x86 I believe it is <code>__fastcall</code>.</p>
<p>You can read more about this in <code>15.5.6.3 Fast calls to unmanaged code</code> in <a href="http://download.microsoft.com/download/7/3/3/733ad403-90b2-4064-a81e-01035a7fe13c/ms%20partition%20ii.pdf" rel="nofollow">Partition II: Metadata Definition and Semantics (With Added Microsoft Specific Implementation Notes)</a></p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njc1NjY4NQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njc1NjY4NQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2Njc1NjY4NQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="40" width="40" alt="@NextTurn" src="https://avatars0.githubusercontent.com/u/45985406?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466756685">
    <div>
      

  

<details data-body-version="86d8fb010f98fe33a1e0258189c963ea">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="86d8fb010f98fe33a1e0258189c963ea" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>I think the proper way to address this is to add attribute to annotate PInvoke methods ...</p>
</blockquote>
<p>I honestly don't know why delegates retrieved by <code>Marshal.GetDelegateForFunctionPointer</code> will be a lot slower.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njc3OTI0MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njc3OTI0MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2Njc3OTI0MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/jkotas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/jkotas"><img height="40" width="40" alt="@jkotas" src="https://avatars3.githubusercontent.com/u/6668460?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466779240">
    <div>
      

  

<details data-body-version="c9a2cea74f0ab79e2366d4788df92532">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="c9a2cea74f0ab79e2366d4788df92532" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p><code>calli</code> instruction turned out to be the best solution for now.</p>
</blockquote>
<p>The difference between <code>calli</code> and <code>PInvoke</code> is noise. I would recommend choosing the one out of these two that gives you the most maintainable code. The performance gains you get by being able to maintain and refactor your code easily will be much higher than what you get from calli vs. PInvoke.</p>
<blockquote>
<p><code>Marshal.GetDelegateForFunctionPointer</code> will be a lot slower.</p>
</blockquote>
<p>The delegate has an extra indirection in it. This indirection costs extra instructions.</p>
<blockquote>
<p><code>15.5.6.3</code> Fast calls to unmanaged code</p>
</blockquote>
<p>If you consider doing something like this, make sure that the unmanaged code that you are calling meets all constrains listed in the doc.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njc5MjYyNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njc5MjYyNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2Njc5MjYyNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="40" width="40" alt="@NextTurn" src="https://avatars0.githubusercontent.com/u/45985406?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466792627">
    <div>
      

  

<details data-body-version="ecfdb38d291abcb5faff283a5442e301">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="ecfdb38d291abcb5faff283a5442e301" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>What I actually need is to call function pointers provided by unmanaged code at runtime, which can not be retrieved by <code>NativeLibrary.Load</code> and <code>NativeLibrary.GetExport</code>. So P/Invoke doesn't work in this scenario, <code>Marshal.GetDelegateForFunctionPointer</code> seems to be slow and cumbersome, and <code>calli</code> is unsafe... I wonder whether there would be a better workaround.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjgxNTYzNQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjgxNTYzNQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2NjgxNTYzNQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/mjsabby/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/mjsabby"><img height="40" width="40" alt="@mjsabby" src="https://avatars3.githubusercontent.com/u/1930559?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466815635">
    <div>
      

  

<details data-body-version="bc3af27efb59a257001ac0fce406a03a">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="bc3af27efb59a257001ac0fce406a03a" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Why canâ€™t you use calli with the unmanaged calling convention? That will solve your problem without having to worry about the constraints and GC delaying of using a managed calling convention.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjgyNzU0Mg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2NjgyNzU0Mg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2NjgyNzU0Mg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="40" width="40" alt="@NextTurn" src="https://avatars0.githubusercontent.com/u/45985406?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466827542">
    <div>
      

  

<details data-body-version="53a6c739c4a5f305ab72ddf3f9b28db3">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="53a6c739c4a5f305ab72ddf3f9b28db3" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>Not that I recommend this for your code</p>
</blockquote>
<p>You said you don't recommend this?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njg1MzcyNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ2Njg1MzcyNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ2Njg1MzcyNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/mjsabby/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/mjsabby"><img height="40" width="40" alt="@mjsabby" src="https://avatars3.githubusercontent.com/u/1930559?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-466853727">
    <div>
      

  

<details data-body-version="03326fdc1bc6361561cfe9426a582162">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="03326fdc1bc6361561cfe9426a582162" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><code>calli</code> with the managed calling convention, described in <code>15.5.6.3 Fast calls to unmanaged code</code> is the one that I do not recommend without understanding the constraints.</p>
<p><code>calli</code> with an unmanaged calling convention, like <code>cdecl</code>, <code>stdcall</code>, etc still erect a PInvoke frame and are as safe as .... well calling into any unmanaged code is, so that would work for the scenario you describe.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjI3NjE0MTM1OA==">
  
        <div data-team-hovercards-enabled="" id="event-2276141358">
  
  <div>

    

        <p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="20" width="20" alt="@NextTurn" src="https://avatars1.githubusercontent.com/u/45985406?s=60&amp;v=4"></a>
  <a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn">NextTurn</a>
  


      
changed the title
<del>Custom internal calls in custom .NET Core host</del>

<ins>Custom internal calls in .NET Core hosting</ins></p><a href="#event-2276141358"><relative-time datetime="2019-04-15T10:26:30Z" title="Apr 15, 2019, 3:26 AM PDT">on Apr 15, 2019</relative-time></a>

  </div>
</div>




</div>

  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ4MzUxNzQ4Nw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDQ4MzUxNzQ4Nw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDQ4MzUxNzQ4Nw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NextTurn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NextTurn"><img height="40" width="40" alt="@NextTurn" src="https://avatars0.githubusercontent.com/u/45985406?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-483517487">
    <div>
      

  

<details data-body-version="b944a538520d0dd48f2b379450c27441">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  







<!-- Rendered timeline since 2020-01-30 22:04:14 -->



            </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>