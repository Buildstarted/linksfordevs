<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Integration Testing ASP.NET Core Applications: Best Practices - Code with Steve - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Integration Testing ASP.NET Core Applications: Best Practices - Code with Steve - linksfor.dev(s)"/>
    <meta property="article:author" content="Steve Gordon"/>
    <meta property="og:description" content="I describe the content which is included in my latest training course &quot;Integration Testing ASP.NET Core Applications: Best Practices&quot;."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.stevejgordon.co.uk/integration-testing-asp-net-core-applications-best-practices"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Integration Testing ASP.NET Core Applications: Best Practices - Code with Steve</title>
<div class="readable">
        <h1>Integration Testing ASP.NET Core Applications: Best Practices - Code with Steve</h1>
            <div>by Steve Gordon</div>
            <div>Reading time: 7-9 minutes</div>
        <div>Posted here: 11 Aug 2020</div>
        <p><a href="https://www.stevejgordon.co.uk/integration-testing-asp-net-core-applications-best-practices">https://www.stevejgordon.co.uk/integration-testing-asp-net-core-applications-best-practices</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="pryc-wp-acctp-original-content">
<p>I’m excited to announce the release of my fourth course at Pluralsight – “<a href="https://pluralsight.pxf.io/m7rX1" target="_blank" rel="noopener noreferrer">Integration Testing ASP.NET Core Applications: Best Practices</a>“. This latest course focuses on using the <a href="https://docs.microsoft.com/en-us/aspnet/core/test/integration-tests?view=aspnetcore-3.1" target="_blank" rel="noopener noreferrer">ASP.NET Core integration testing framework</a>.</p>
<p>Many developers will be familiar with the concepts of unit testing their applications. ASP.NET Core supports more in-depth end-to-end integration testing, with the help of a library which can be used in combination with xUnit test projects. The library provides a fixture which will run your application under test using an in-memory test server. This allows you to make requests to your application and to verify the responses and any expected side-effects.</p>
<p>Compared to unit tests, this allows much more of the application code to be tested together, which can rapidly validate the end-to-end behaviour of your service. These are also sometimes referred to as functional tests, since the definition of integration testing may be applied to more comprehensive multi-service testing as well. It’s entirely possible to test your applications in concert with their dependencies, such as databases or other APIs they expect to call.</p>
<p>In the course, I show how boundaries can be defined using fakes to test your application without external dependencies, which allows your tests to be run locally during development. Of course, you can avoid such fakes to test with some real dependencies as well. This form of in-memory testing can then easily be expanded to broader testing of multiple services as part of CI/CD workflows.</p>
<p>Producing these courses is a <a href="https://twitter.com/stevejgordon/status/1281568343787479041" target="_blank" rel="noopener noreferrer">lot of work</a>, but that effort is rewarded when people view the course and hopefully leave with new skills to apply in their work. If you have a subscription to Pluralsight already, I hope you’ll add this course to your bookmarks for future viewing. If you don’t yet have a subscription, you can sign up for access to this content and so many other fantastic courses.</p>



<div><figure><img src="https://www.stevejgordon.co.uk/wp-content/uploads/2020/08/Integration-Testing-ASP.NET-Core-Applications-Best-Practices-Screenshot-1024x576.png" alt="" srcset="https://www.stevejgordon.co.uk/wp-content/uploads/2020/08/Integration-Testing-ASP.NET-Core-Applications-Best-Practices-Screenshot-1024x576.png 1024w, https://www.stevejgordon.co.uk/wp-content/uploads/2020/08/Integration-Testing-ASP.NET-Core-Applications-Best-Practices-Screenshot-300x169.png 300w, https://www.stevejgordon.co.uk/wp-content/uploads/2020/08/Integration-Testing-ASP.NET-Core-Applications-Best-Practices-Screenshot-768x432.png 768w, https://www.stevejgordon.co.uk/wp-content/uploads/2020/08/Integration-Testing-ASP.NET-Core-Applications-Best-Practices-Screenshot-1536x864.png 1536w, https://www.stevejgordon.co.uk/wp-content/uploads/2020/08/Integration-Testing-ASP.NET-Core-Applications-Best-Practices-Screenshot-2048x1152.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure></div>



<h2>Module Summaries</h2>
<h3>Introducing ASP.NET Core Integration Tests</h3>
<p>In this first module, I introduce the concept of integration tests. I then demonstrate how the ASP.NET Core testing library can be added to a project to begin the process of writing and running integration tests. These tests cause an ASP.NET Core Web API to be run in-memory, with requests being sent and the responses validated to confirm the expected behaviour.</p>
<p>We’ll cover:</p>
<ul>
<li>Introducing Integration Tests</li>
<li>ASP.NET Core Integration Tests</li>
<li>Creating an Integration Test Project</li>
<li>Writing an Integration Test</li>
<li>Running Integration Tests</li>
<li>What Is the WebApplicationFactory?</li>
</ul>
<h3>Writing Integration Tests for ASP.NET Core Web APIs: Part 1</h3>
<p>In this module, I expand on the basics and begin writing integration tests for an ASP.NET Core Web API project. I demonstrate how endpoints can be called using HTTP requests from the test methods. I focus on some of the challenges of asserting on the correctness of JSON response content. I describe how the test client can be configured for different testing scenarios. This module concludes with examples of simplifying response assertions and how to validate for expected response headers.</p>
<p>We’ll cover:</p>
<ul>
<li>Testing Endpoints for GET Requests</li>
<li>Improving Assertions for JSON Content</li>
<li>Creating and Configuring the Test Client</li>
<li>Simplifying Response Assertions</li>
<li>Testing Response Headers</li>
</ul>
<h3>Applying Test Driven Development (TDD) with Integration Tests</h3>
<p>In this module, I continue writing tests for an ASP.NET Core Web API but switch to a Test Driven Development paradigm. I define tests to describe new requirements for the API, implementing the feature to ensure those tests pass. I spend some time talking about the potential advantages to TDD before applying it in practical demos. I also talk about how we can avoid the need for external dependencies by using the test client to replace some services registered with the test host.</p>
<p>We’ll cover:</p>
<ul>
<li>Test Driven Development</li>
<li>Applying Test Driven Development</li>
<li>Defining Test Boundaries and Faking Dependencies</li>
<li>Replacing Services in the Test Client</li>
</ul>
<h3>Writing Integration Tests for ASP.NET Core Web APIs: Part 2</h3>
<p>In this module, I continue testing the Web API project. First, I show how a custom WebApplicationFactory can be used to apply a common test configuration to the test host. I discuss how to validate POST requests which include confirming that required input validation is applied and model binding works as expected. I introduce xUnit theory tests which can be used to test multiple inputs through the same test code. I dive into validating that requests trigger the expected side-effects, such as storing data to a database and focus on how to test middleware components and exceptions.</p>
<p>We’ll cover:</p>
<ul>
<li>Creating a Custom WebApplicationFactory</li>
<li>Testing Model Binding and Input Validation for POST Requests</li>
<li>Testing Multiple Conditions Using xUnit Theories</li>
<li>Testing Responses for POST Requests</li>
<li>Testing Success Responses</li>
<li>Testing Side-Effects</li>
<li>Testing Middleware</li>
<li>Testing Exceptions</li>
</ul>
<h3>Writing Integration Tests for ASP.NET Core UI Apps</h3>
<p>In this module, we move onto testing UI based applications, written using MVC or RazorPages approaches. I’ll compare some of the challenges and differences we must consider versus testing API projects. I introduce AngleSharp, an HTML parsing library we can use to help us validate the HTML content of requests. I conclude with a demonstration of testing dynamic page content which is controlled by the application configuration.</p>
<p>We’ll cover:</p>
<ul>
<li>Comparing APIs and UI Applications</li>
<li>Touring the Integration Test Project</li>
<li>Testing HTML Content with AngleSharp</li>
<li>Testing Dynamic Page Content</li>
</ul>
<h3>Testing Advanced Requirements in ASP.NET Core UI Apps</h3>
<p>In this final module, I cover more advanced testing of UI applications. I focus on some of the challenges around integration testing authentication and authorization in ASP.NET Core. I introduce the Entity Framework in-memory provider so that we can test code which stores data to a SQL database through Entity Framework Core. I spend some time refactoring some of the existing tests to make them easier to maintain and to re-use code between tests. I also show how to support testing of form POSTs where antiforgery tokens need to be dealt with.</p>
<p>We’ll cover:</p>
<ul>
<li>Configuring Redirects to Test Authentication</li>
<li>Testing Authorization Requirements</li>
<li>Configuring Entity Framework for In-memory Testing</li>
<li>Testing Pages and Controllers Which Require Entity Framework</li>
<li>Seeding and Resetting the Database within Tests</li>
<li>Refactoring Test Code for Reusability</li>
<li>Avoiding Brittle Tests</li>
<li>Testing POST Requests by Handling Antiforgery Tokens</li>
</ul>
<p>I hope that you find the content in this course useful and practical. Do let me know how you get on with the course. As I’ve applied in-memory integration tests to my projects, I’ve found that I need to write less individual unit tests and can be more confident that changes do not break my API contracts for consumers. When combined with other forms of testing, this helps to build robust software and avoid regressions in existing behaviour.</p>
<p>If you haven’t already, you can check out my previous courses:</p>
<ul>
<li><a href="https://pluralsight.pxf.io/4KQD9">Dependency Injection in ASP.NET Core</a></li>
<li><a href="https://pluralsight.pxf.io/Ny152">Using Configuration and Options in .NET Core and ASP.NET Core Apps</a></li>
<li><a href="https://pluralsight.pxf.io/vdn6j">Building ASP.NET Core Hosted Services and .NET Core Worker Services</a></li>
</ul>
<p>Of course, you can also <a href="https://pluralsight.pxf.io/5Lvyb" target="_blank" rel="noopener noreferrer">follow me directly on Pluralsight</a> to get notified when I release new content.</p>
<!-- PRyC WP: Add custom content to bottom of post/page: Standard Content START --></div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>