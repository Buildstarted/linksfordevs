<!DOCTYPE html>
<html lang="en">
<head>
    <title>
libreoffice/core - main, development code repository - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="libreoffice/core - main, development code repository - linksfor.dev(s)"/>
    <meta property="og:description" content="its of limited utility wrt the vcl layout work and optimal size widgets,&#xA;and its confuses people looking for hidpi settings&#xA;&#xA;Change-Id: I37d21b480446f9fe2845b3a2d9fd59cdeddf1a93"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://cgit.freedesktop.org/libreoffice/core/commit/?id=ec950f8ebb2745ccff2275dcc09d2034cd73dfeb"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - libreoffice/core - main, development code repository</title>
<div class="readable">
        <h1>libreoffice/core - main, development code repository</h1>
            <div>Reading time: 25-31 minutes</div>
        <div>Posted here: 25 Jan 2020</div>
        <p><a href="https://cgit.freedesktop.org/libreoffice/core/commit/?id=ec950f8ebb2745ccff2275dcc09d2034cd73dfeb">https://cgit.freedesktop.org/libreoffice/core/commit/?id=ec950f8ebb2745ccff2275dcc09d2034cd73dfeb</a></p>
        <hr/>
<div id="readability-page-1" class="page"><p>its of limited utility wrt the vcl layout work and optimal size widgets,
and its confuses people looking for hidpi settings

Change-Id: I37d21b480446f9fe2845b3a2d9fd59cdeddf1a93
</p><div summary="diff"><tbody><tr><td><p>@@ -619,7 +619,6 @@ OfaViewTabPage::OfaViewTabPage(vcl::Window* pParent, const SfxItemSet&amp; rSet)</p><p>     , mpDrawinglayerOpt(new SvtOptionsDrawinglayer)</p><p>     , mpOpenGLConfig(new svt::OpenGLCfg)</p><p> {</p><p>-    get(m_pWindowSizeMF, "windowsize");</p><p>     get(m_pIconSizeLB, "iconsize");</p><p>     get(m_pSidebarIconSizeLB, "sidebariconsize");</p><p>     get(m_pIconStyleLB, "iconstyle");</p><p>@@ -701,7 +700,6 @@ void OfaViewTabPage::dispose()</p><p>     pCanvasSettings = nullptr;</p><p>     delete pAppearanceCfg;</p><p>     pAppearanceCfg = nullptr;</p><p>-    m_pWindowSizeMF.clear();</p><p>     m_pIconSizeLB.clear();</p><p>     m_pSidebarIconSizeLB.clear();</p><p>     m_pIconStyleLB.clear();</p><p>@@ -795,17 +793,6 @@ bool OfaViewTabPage::FillItemSet( SfxItemSet* )</p><p>     bool bAppearanceChanged = false;</p><p>-</p><p>-    // Screen Scaling</p><p>-    sal_uInt16 nOldScale = pAppearanceCfg-&gt;GetScaleFactor();</p><p>-    sal_uInt16 nNewScale = (sal_uInt16)m_pWindowSizeMF-&gt;GetValue();</p><p>-</p><p>-    if ( nNewScale != nOldScale )</p><p>-    {</p><p>-        pAppearanceCfg-&gt;SetScaleFactor(nNewScale);</p><p>-        bAppearanceChanged = true;</p><p>-    }</p><p>-</p><p>     // Mouse Snap Mode</p><p>     SnapType eOldSnap = pAppearanceCfg-&gt;GetSnapMode();</p><p>     SnapType eNewSnap = (SnapType)m_pMousePosLB-&gt;GetSelectEntryPos();</p><p>@@ -941,8 +928,6 @@ void OfaViewTabPage::Reset( const SfxItemSet* )</p><p>     m_pIconStyleLB-&gt;SelectEntryPos( nStyleLB_InitialSelection );</p><p>     m_pIconStyleLB-&gt;SaveValue();</p><p>-    // Screen Scaling</p><p>-    m_pWindowSizeMF-&gt;SetValue ( pAppearanceCfg-&gt;GetScaleFactor() );</p><p>     // Mouse Snap</p><p>     m_pMousePosLB-&gt;SelectEntryPos((sal_Int32)pAppearanceCfg-&gt;GetSnapMode());</p><p>     m_pMousePosLB-&gt;SaveValue();</p><p>@@ -79,7 +79,6 @@ class SvtTabAppearanceCfg;</p><p> class OfaViewTabPage : public SfxTabPage</p><p> {</p><p> private:</p><p>-    VclPtr&lt;MetricField&gt;    m_pWindowSizeMF;</p><p>     VclPtr&lt;ListBox&gt;        m_pIconSizeLB;</p><p>     VclPtr&lt;ListBox&gt;        m_pSidebarIconSizeLB;</p><p>     VclPtr&lt;ListBox&gt;        m_pIconStyleLB;</p><p>@@ -1,5 +1,5 @@</p><p> &lt;?xml version="1.0" encoding="UTF-8"?&gt;</p><p>-&lt;!-- Generated with glade 3.19.0 --&gt;</p><p>+&lt;!-- Generated with glade 3.20.0 --&gt;</p><p> &lt;interface&gt;</p><p>   &lt;requires lib="gtk+" version="3.0"/&gt;</p><p>   &lt;object class="GtkAdjustment" id="adjustment1"&gt;</p><p>@@ -306,33 +306,6 @@</p><p>                         &lt;property name="row_spacing"&gt;6&lt;/property&gt;</p><p>                         &lt;property name="column_spacing"&gt;12&lt;/property&gt;</p><p>                         &lt;child&gt;</p><p>-                          &lt;object class="GtkLabel" id="label7"&gt;</p><p>-                            &lt;property name="visible"&gt;True&lt;/property&gt;</p><p>-                            &lt;property name="can_focus"&gt;False&lt;/property&gt;</p><p>-                            &lt;property name="halign"&gt;end&lt;/property&gt;</p><p>-                            &lt;property name="label" translatable="yes"&gt;Sc_aling:&lt;/property&gt;</p><p>-                            &lt;property name="use_underline"&gt;True&lt;/property&gt;</p><p>-                            &lt;property name="mnemonic_widget"&gt;windowsize:0%&lt;/property&gt;</p><p>-                          &lt;/object&gt;</p><p>-                          &lt;packing&gt;</p><p>-                            &lt;property name="left_attach"&gt;0&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;0&lt;/property&gt;</p><p>-                          &lt;/packing&gt;</p><p>-                        &lt;/child&gt;</p><p>-                        &lt;child&gt;</p><p>-                          &lt;object class="GtkSpinButton" id="windowsize:0%"&gt;</p><p>-                            &lt;property name="visible"&gt;True&lt;/property&gt;</p><p>-                            &lt;property name="can_focus"&gt;True&lt;/property&gt;</p><p>-                            &lt;property name="halign"&gt;start&lt;/property&gt;</p><p>-                            &lt;property name="invisible_char"&gt;â€¢&lt;/property&gt;</p><p>-                            &lt;property name="adjustment"&gt;adjustment1&lt;/property&gt;</p><p>-                          &lt;/object&gt;</p><p>-                          &lt;packing&gt;</p><p>-                            &lt;property name="left_attach"&gt;1&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;0&lt;/property&gt;</p><p>-                          &lt;/packing&gt;</p><p>-                        &lt;/child&gt;</p><p>-                        &lt;child&gt;</p><p>                           &lt;object class="GtkLabel" id="label8"&gt;</p><p>                             &lt;property name="visible"&gt;True&lt;/property&gt;</p><p>                             &lt;property name="can_focus"&gt;False&lt;/property&gt;</p><p>@@ -343,7 +316,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;0&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;1&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;0&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                         &lt;child&gt;</p><p>@@ -367,7 +340,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;1&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;3&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;2&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                         &lt;child&gt;</p><p>@@ -382,7 +355,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;1&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;1&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;0&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                         &lt;child&gt;</p><p>@@ -396,7 +369,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;0&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;3&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;2&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                         &lt;child&gt;</p><p>@@ -411,7 +384,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;0&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;4&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;3&lt;/property&gt;</p><p>                             &lt;property name="width"&gt;2&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>@@ -426,7 +399,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;0&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;5&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;4&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                         &lt;child&gt;</p><p>@@ -439,7 +412,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;1&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;5&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;4&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                         &lt;child&gt;</p><p>@@ -453,7 +426,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;0&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;2&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;1&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                         &lt;child&gt;</p><p>@@ -468,7 +441,7 @@</p><p>                           &lt;/object&gt;</p><p>                           &lt;packing&gt;</p><p>                             &lt;property name="left_attach"&gt;1&lt;/property&gt;</p><p>-                            &lt;property name="top_attach"&gt;2&lt;/property&gt;</p><p>+                            &lt;property name="top_attach"&gt;1&lt;/property&gt;</p><p>                           &lt;/packing&gt;</p><p>                         &lt;/child&gt;</p><p>                       &lt;/object&gt;</p><p>@@ -41,7 +41,6 @@ enum class DragMode {</p><p> class SVT_DLLPUBLIC SvtTabAppearanceCfg : public utl::ConfigItem</p><p> {</p><p>     DragMode        nDragMode           ;</p><p>-    short           nScaleFactor        ;</p><p>     SnapType        nSnapMode           ;</p><p>     MouseMiddleButtonAction nMiddleMouse;</p><p> #if defined( UNX )</p><p>@@ -66,9 +65,6 @@ public:</p><p>     DragMode  GetDragMode  () const { return nDragMode; }</p><p>-    sal_uInt16      GetScaleFactor () const { return nScaleFactor; }</p><p>-    void        SetScaleFactor ( sal_uInt16 nSet );</p><p>-</p><p>     SnapType    GetSnapMode () const { return nSnapMode; }</p><p>     void        SetSnapMode ( SnapType nSet );</p><p>@@ -501,12 +501,6 @@ public:</p><p>     void                            SetCursorBlinkTime( sal_uInt64 nBlinkTime );</p><p>     sal_uInt64                      GetCursorBlinkTime() const;</p><p>-    void                            SetScreenZoom( sal_uInt16 nPercent );</p><p>-    sal_uInt16                      GetScreenZoom() const;</p><p>-</p><p>-    void                            SetScreenFontZoom( sal_uInt16 nPercent );</p><p>-    sal_uInt16                      GetScreenFontZoom() const;</p><p>-</p><p>     void                            SetDragFullOptions( DragFullOptions nOptions );</p><p>     DragFullOptions                 GetDragFullOptions() const;</p><p>@@ -2621,29 +2621,6 @@</p><p>       &lt;info&gt;</p><p>         &lt;desc&gt;Contains window and dialog settings.&lt;/desc&gt;</p><p>       &lt;/info&gt;</p><p>-      &lt;prop oor:name="FontScaling" oor:type="xs:short" oor:nillable="false"&gt;</p><p>-        &lt;!--OldPath: General/View --&gt;</p><p>-        &lt;!--OldLocation: soffice.cfg--&gt;</p><p>-        &lt;!--UIHints: Tools  Options - General  View  [Section] Display--&gt;</p><p>-        &lt;info&gt;</p><p>-          &lt;desc&gt;Specifies the scaling only of the screen representation</p><p>-          [UNIT=%].&lt;/desc&gt;</p><p>-          &lt;label&gt;Scaling&lt;/label&gt;</p><p>-        &lt;/info&gt;</p><p>-        &lt;constraints&gt;</p><p>-          &lt;minInclusive oor:value="50"&gt;</p><p>-            &lt;info&gt;</p><p>-              &lt;desc&gt;Specifies the minimum range of the scaling.&lt;/desc&gt;</p><p>-            &lt;/info&gt;</p><p>-          &lt;/minInclusive&gt;</p><p>-          &lt;maxInclusive oor:value="200"&gt;</p><p>-            &lt;info&gt;</p><p>-              &lt;desc&gt;Specifies the maximum range of the scaling.&lt;/desc&gt;</p><p>-            &lt;/info&gt;</p><p>-          &lt;/maxInclusive&gt;</p><p>-        &lt;/constraints&gt;</p><p>-        &lt;value&gt;100&lt;/value&gt;</p><p>-      &lt;/prop&gt;</p><p>       &lt;group oor:name="NewDocumentHandling"&gt;</p><p>         &lt;info&gt;</p><p>           &lt;desc&gt;Contains settings to change new document window behavior.&lt;/desc&gt;</p><p>@@ -500,6 +500,8 @@ class ScGlobal</p><p>     static ScFieldEditEngine*   pFieldEditEngine;</p><p>+    static void                 InitPPT();</p><p>+</p><p> public:</p><p>     static SvtSysLocale*        pSysLocale;</p><p>     // for faster access a pointer to the single instance provided by SvtSysLocale</p><p>@@ -556,8 +558,6 @@ public:</p><p>     static void             InitAddIns();</p><p>     static void             Clear();                    // at the end of the program</p><p>-    static void             UpdatePPT(OutputDevice* pDev);</p><p>-</p><p>     static void             InitTextHeight(SfxItemPool* pPool);</p><p>     static SvxBrushItem*    GetEmptyBrushItem() { return pEmptyBrushItem; }</p><p>     static SvxBrushItem*    GetButtonBrushItem();</p><p>@@ -130,8 +130,6 @@ sal_uInt16          ScGlobal::nStdRowHeight         = 256;</p><p> long            ScGlobal::nLastRowHeightExtra   = 0;</p><p> long            ScGlobal::nLastColWidthExtra    = STD_EXTRA_WIDTH;</p><p>-static sal_uInt16 nPPTZoom = 0; // ScreenZoom used to determine nScreenPPTX/Y</p><p>-</p><p> SfxViewShell* pScActiveViewShell = nullptr; //FIXME: Make this a member</p><p> sal_uInt16 nScClickMouseModifier = 0;    //FIXME: This too</p><p> sal_uInt16 nScFillModeMouseModifier = 0; //FIXME: And this</p><p>@@ -521,7 +519,7 @@ void ScGlobal::Init()</p><p>     pEmbeddedBrushItem = new SvxBrushItem( Color( COL_LIGHTCYAN ), ATTR_BACKGROUND );</p><p>     pProtectedBrushItem = new SvxBrushItem( Color( COL_LIGHTGRAY ), ATTR_BACKGROUND );</p><p>-    UpdatePPT(nullptr);</p><p>+    InitPPT();</p><p>     //ScCompiler::InitSymbolsNative();</p><p>     // ScParameterClassification _after_ Compiler, needs function resources if</p><p>     // arguments are to be merged in, which in turn need strings of function</p><p>@@ -536,23 +534,12 @@ void ScGlobal::Init()</p><p>     //  ScDocumentPool::InitVersionMaps() has been called earlier already</p><p> }</p><p>-void ScGlobal::UpdatePPT( OutputDevice* pDev )</p><p>+void ScGlobal::InitPPT()</p><p> {</p><p>-    sal_uInt16 nCurrentZoom = Application::GetSettings().GetStyleSettings().GetScreenZoom();</p><p>-    if ( nCurrentZoom != nPPTZoom )</p><p>-    {</p><p>-        // Screen PPT values must be updated when ScreenZoom has changed.</p><p>-        // If called from Window::DataChanged, the window is passed as pDev,</p><p>-        // to make sure LogicToPixel uses a device which already uses the new zoom.</p><p>-        // For the initial settings, NULL is passed and GetDefaultDevice used.</p><p>-</p><p>-        if ( !pDev )</p><p>-            pDev = Application::GetDefaultDevice();</p><p>-        Point aPix1000 = pDev-&gt;LogicToPixel( Point(100000,100000), MAP_TWIP );</p><p>-        nScreenPPTX = aPix1000.X() / 100000.0;</p><p>-        nScreenPPTY = aPix1000.Y() / 100000.0;</p><p>-        nPPTZoom = nCurrentZoom;</p><p>-    }</p><p>+    OutputDevice* pDev = Application::GetDefaultDevice();</p><p>+    Point aPix1000 = pDev-&gt;LogicToPixel( Point(100000,100000), MAP_TWIP );</p><p>+    nScreenPPTX = aPix1000.X() / 100000.0;</p><p>+    nScreenPPTY = aPix1000.Y() / 100000.0;</p><p> }</p><p> const OUString&amp; ScGlobal::GetClipDocName()</p><p>@@ -1905,8 +1905,6 @@ void ScGridWindow::DataChanged( const DataChangedEvent&amp; rDCEvt )</p><p>             {</p><p>                 ScTabView* pView = pViewData-&gt;GetView();</p><p>-                //  update scale in case the UI ScreenZoom has changed</p><p>-                ScGlobal::UpdatePPT(this);</p><p>                 pView-&gt;RecalcPPT();</p><p>                 //  RepeatResize in case scroll bar sizes have changed</p><p>@@ -749,20 +749,6 @@ void Window::DataChanged( const DataChangedEvent&amp; rDCEvt )</p><p>         if ( (rDCEvt.GetType() == DataChangedEventType::SETTINGS) &amp;&amp;</p><p>              (rDCEvt.GetFlags() &amp; AllSettingsFlags::STYLE) )</p><p>         {</p><p>-            // When the screen zoom factor has changed then reset the zoom</p><p>-            // factor of the frame to always display the whole page.</p><p>-            const AllSettings* pOldSettings = rDCEvt.GetOldSettings ();</p><p>-            const AllSettings&amp; rNewSettings = GetSettings ();</p><p>-            if (pOldSettings &amp;&amp; mpViewShell)</p><p>-            {</p><p>-                if (pOldSettings-&gt;GetStyleSettings().GetScreenZoom()</p><p>-                    != rNewSettings.GetStyleSettings().GetScreenZoom())</p><p>-                {</p><p>-                    mpViewShell-&gt;GetViewFrame()-&gt;GetDispatcher()-&gt;</p><p>-                        Execute(SID_SIZE_PAGE, SfxCallMode::ASYNCHRON | SfxCallMode::RECORD);</p><p>-                }</p><p>-            }</p><p>-</p><p>             /* Rearrange or initiate Resize for scroll bars since the size of</p><p>                the scroll bars my have changed. Within this, inside the resize-</p><p>                handler, the size of the scroll bars will be asked from the</p><p>@@ -28,7 +28,6 @@</p><p> #define DEFAULT_DRAGMODE    DragMode::SystemDep</p><p> #define DEFAULT_SNAPMODE    SnapType::ToButton</p><p>-#define DEFAULT_SCALEFACTOR 100</p><p> #if defined UNX</p><p> #define DEFAULT_AAMINHEIGHT 8</p><p> #endif</p><p>@@ -40,7 +39,6 @@ bool SvtTabAppearanceCfg::bInitialized = false;</p><p> SvtTabAppearanceCfg::SvtTabAppearanceCfg()</p><p>     :ConfigItem(OUString("Office.Common/View"))</p><p>     ,nDragMode          ( DEFAULT_DRAGMODE )</p><p>-    ,nScaleFactor       ( DEFAULT_SCALEFACTOR )</p><p>     ,nSnapMode          ( DEFAULT_SNAPMODE )</p><p>     ,nMiddleMouse       ( MouseMiddleButtonAction::AutoScroll )</p><p> #if defined( UNX )</p><p>@@ -64,26 +62,25 @@ SvtTabAppearanceCfg::SvtTabAppearanceCfg()</p><p>             {</p><p>                 switch(nProp)</p><p>                 {</p><p>-                    case  0: *pValues &gt;&gt;= nScaleFactor; break; //"FontScaling",</p><p>-                    case  1:    //"Window/Drag"</p><p>+                    case  0:    //"Window/Drag"</p><p>                     {</p><p>                         short nTmp;</p><p>                         if (*pValues &gt;&gt;= nTmp)</p><p>                             nDragMode = (DragMode)nTmp;</p><p>                         break;</p><p>                     }</p><p>-                    case  2: bMenuMouseFollow = *o3tl::doAccess&lt;bool&gt;(*pValues); break; //"Menu/FollowMouse",</p><p>-                    case  3:</p><p>+                    case  1: bMenuMouseFollow = *o3tl::doAccess&lt;bool&gt;(*pValues); break; //"Menu/FollowMouse",</p><p>+                    case  2:</p><p>                     {</p><p>                         short nTmp;</p><p>                         if (*pValues &gt;&gt;= nTmp)</p><p>                             nSnapMode = (SnapType)nTmp; //"Dialog/MousePositioning",</p><p>                         break;</p><p>                     }</p><p>-                    case  4: { short nTmp = 0; *pValues &gt;&gt;= nTmp; nMiddleMouse = static_cast&lt;MouseMiddleButtonAction&gt;(nTmp); break; } //"Dialog/MiddleMouseButton",</p><p>+                    case  3: { short nTmp = 0; *pValues &gt;&gt;= nTmp; nMiddleMouse = static_cast&lt;MouseMiddleButtonAction&gt;(nTmp); break; } //"Dialog/MiddleMouseButton",</p><p> #if defined( UNX )</p><p>-                    case  5: bFontAntialiasing = *o3tl::doAccess&lt;bool&gt;(*pValues); break;    // "FontAntialising/Enabled",</p><p>-                    case  6: *pValues &gt;&gt;= nAAMinPixelHeight; break;                         // "FontAntialising/MinPixelHeight",</p><p>+                    case  4: bFontAntialiasing = *o3tl::doAccess&lt;bool&gt;(*pValues); break;    // "FontAntialising/Enabled",</p><p>+                    case  5: *pValues &gt;&gt;= nAAMinPixelHeight; break;                         // "FontAntialising/MinPixelHeight",</p><p> #endif</p><p>                 }</p><p>             }</p><p>@@ -102,14 +99,13 @@ const Sequence&lt;OUString&gt;&amp; SvtTabAppearanceCfg::GetPropertyNames()</p><p>     {</p><p>         static const sal_Char* aPropNames[] =</p><p>         {</p><p>-             "FontScaling"                       //  0</p><p>-            ,"Window/Drag"                       //  1</p><p>-            ,"Menu/FollowMouse"                  //  2</p><p>-            ,"Dialog/MousePositioning"           //  3</p><p>-            ,"Dialog/MiddleMouseButton"          //  4</p><p>+             "Window/Drag"                       //  0</p><p>+            ,"Menu/FollowMouse"                  //  1</p><p>+            ,"Dialog/MousePositioning"           //  2</p><p>+            ,"Dialog/MiddleMouseButton"          //  3</p><p> #if defined( UNX )</p><p>-            ,"FontAntiAliasing/Enabled"         //  5</p><p>-            ,"FontAntiAliasing/MinPixelHeight"  //  6</p><p>+            ,"FontAntiAliasing/Enabled"          //  4</p><p>+            ,"FontAntiAliasing/MinPixelHeight"   //  5</p><p> #endif</p><p>         };</p><p>         const int nCount = SAL_N_ELEMENTS( aPropNames );</p><p>@@ -133,14 +129,13 @@ void  SvtTabAppearanceCfg::ImplCommit()</p><p>     {</p><p>         switch(nProp)</p><p>         {</p><p>-            case  0: pValues[nProp] &lt;&lt;= nScaleFactor; break;            // "FontScaling",</p><p>-            case  1: pValues[nProp] &lt;&lt;= (short)nDragMode; break;        //"Window/Drag",</p><p>-            case  2: pValues[nProp] &lt;&lt;= bMenuMouseFollow; break;        //"Menu/FollowMouse",</p><p>-            case  3: pValues[nProp] &lt;&lt;= (short)nSnapMode; break;        //"Dialog/MousePositioning",</p><p>-            case  4: pValues[nProp] &lt;&lt;= static_cast&lt;short&gt;(nMiddleMouse); break;               //"Dialog/MiddleMouseButton",</p><p>+            case  0: pValues[nProp] &lt;&lt;= (short)nDragMode; break;        // "Window/Drag",</p><p>+            case  1: pValues[nProp] &lt;&lt;= bMenuMouseFollow; break;        // "Menu/FollowMouse",</p><p>+            case  2: pValues[nProp] &lt;&lt;= (short)nSnapMode; break;        // "Dialog/MousePositioning",</p><p>+            case  3: pValues[nProp] &lt;&lt;= static_cast&lt;short&gt;(nMiddleMouse); break; // "Dialog/MiddleMouseButton",</p><p> #if defined( UNX )</p><p>-            case  5: pValues[nProp] &lt;&lt;= bFontAntialiasing; break; // "FontAntialising/Enabled",</p><p>-            case  6: pValues[nProp] &lt;&lt;= nAAMinPixelHeight; break;               // "FontAntialising/MinPixelHeight",</p><p>+            case  4: pValues[nProp] &lt;&lt;= bFontAntialiasing; break;       // "FontAntialising/Enabled",</p><p>+            case  5: pValues[nProp] &lt;&lt;= nAAMinPixelHeight; break;       // "FontAntialising/MinPixelHeight",</p><p> #endif</p><p>         }</p><p>     }</p><p>@@ -151,12 +146,6 @@ void SvtTabAppearanceCfg::Notify( const css::uno::Sequence&lt; OUString &gt;&amp; )</p><p> {</p><p> }</p><p>-void SvtTabAppearanceCfg::SetScaleFactor ( sal_uInt16 nSet )</p><p>-{</p><p>-    nScaleFactor = nSet;</p><p>-    SetModified();</p><p>-}</p><p>-</p><p> void SvtTabAppearanceCfg::SetSnapMode ( SnapType nSet )</p><p> {</p><p>     nSnapMode = nSet;</p><p>@@ -183,11 +172,6 @@ void SvtTabAppearanceCfg::SetApplicationDefaults ( Application* pApp )</p><p>     // and set it here</p><p>     hAppStyle.SetUseSystemUIFonts( bUseSystemUIFonts );</p><p>-    // Screen and ScreenFont Scaling</p><p>-</p><p>-    hAppStyle.SetScreenZoom( nScaleFactor );</p><p>-    hAppStyle.SetScreenFontZoom( nScaleFactor );</p><p>-</p><p> #if defined( UNX )</p><p>     // font anti aliasing</p><p>     hAppStyle.SetAntialiasingMinPixelHeight( nAAMinPixelHeight );</p><p>@@ -171,8 +171,6 @@ struct ImplStyleData</p><p>     ToolbarIconSize                 mnToolbarIconSize;</p><p>     bool                            mnUseFlatMenus;</p><p>     StyleSettingsOptions            mnOptions;</p><p>-    sal_uInt16                      mnScreenZoom;</p><p>-    sal_uInt16                      mnScreenFontZoom;</p><p>     bool                            mbHighContrast;</p><p>     bool                            mbUseSystemUIFonts;</p><p>     bool                            mbAutoMnemonic;</p><p>@@ -539,8 +537,6 @@ ImplStyleData::ImplStyleData() :</p><p>     mnAntialiasedMin            = 0;</p><p>     mnCursorSize                = 2;</p><p>     mnCursorBlinkTime           = STYLE_CURSOR_NOBLINKTIME;</p><p>-    mnScreenZoom                = 100;</p><p>-    mnScreenFontZoom            = 100;</p><p>     mnDragFullOptions           = DragFullOptions::All;</p><p>     mnSelectionOptions          = SelectionOptions::NONE;</p><p>     mnDisplayOptions            = DisplayOptions::NONE;</p><p>@@ -648,8 +644,6 @@ ImplStyleData::ImplStyleData( const ImplStyleData&amp; rData ) :</p><p>     mnAntialiasedMin            = rData.mnAntialiasedMin;</p><p>     mnCursorSize                = rData.mnCursorSize;</p><p>     mnCursorBlinkTime           = rData.mnCursorBlinkTime;</p><p>-    mnScreenZoom                = rData.mnScreenZoom;</p><p>-    mnScreenFontZoom            = rData.mnScreenFontZoom;</p><p>     mnDragFullOptions           = rData.mnDragFullOptions;</p><p>     mnSelectionOptions          = rData.mnSelectionOptions;</p><p>     mnDisplayOptions            = rData.mnDisplayOptions;</p><p>@@ -1834,32 +1828,6 @@ StyleSettings::GetCursorBlinkTime() const</p><p> }</p><p> void</p><p>-StyleSettings::SetScreenZoom( sal_uInt16 nPercent )</p><p>-{</p><p>-    CopyData();</p><p>-    mxData-&gt;mnScreenZoom = nPercent;</p><p>-}</p><p>-</p><p>-sal_uInt16</p><p>-StyleSettings::GetScreenZoom() const</p><p>-{</p><p>-    return mxData-&gt;mnScreenZoom;</p><p>-}</p><p>-</p><p>-void</p><p>-StyleSettings::SetScreenFontZoom( sal_uInt16 nPercent )</p><p>-{</p><p>-    CopyData();</p><p>-    mxData-&gt;mnScreenFontZoom = nPercent;</p><p>-}</p><p>-</p><p>-sal_uInt16</p><p>-StyleSettings::GetScreenFontZoom() const</p><p>-{</p><p>-    return mxData-&gt;mnScreenFontZoom;</p><p>-}</p><p>-</p><p>-void</p><p> StyleSettings::SetDragFullOptions( DragFullOptions nOptions )</p><p> {</p><p>     CopyData();</p><p>@@ -2312,8 +2280,6 @@ bool StyleSettings::operator ==( const StyleSettings&amp; rSet ) const</p><p>          (mxData-&gt;mnSplitSize               == rSet.mxData-&gt;mnSplitSize)                &amp;&amp;</p><p>          (mxData-&gt;mnSpinSize                == rSet.mxData-&gt;mnSpinSize)                 &amp;&amp;</p><p>          (mxData-&gt;mnAntialiasedMin          == rSet.mxData-&gt;mnAntialiasedMin)           &amp;&amp;</p><p>-         (mxData-&gt;mnScreenZoom              == rSet.mxData-&gt;mnScreenZoom)               &amp;&amp;</p><p>-         (mxData-&gt;mnScreenFontZoom          == rSet.mxData-&gt;mnScreenFontZoom)           &amp;&amp;</p><p>          (mxData-&gt;mbHighContrast            == rSet.mxData-&gt;mbHighContrast)             &amp;&amp;</p><p>          (mxData-&gt;mbUseSystemUIFonts        == rSet.mxData-&gt;mbUseSystemUIFonts)         &amp;&amp;</p><p>          (mxData-&gt;mnUseFlatBorders          == rSet.mxData-&gt;mnUseFlatBorders)           &amp;&amp;</p><p>@@ -1138,14 +1138,13 @@ void Window::ImplInit( vcl::Window* pParent, WinBits nStyle, SystemParentData* p</p><p>     // setup the scale factor for Hi-DPI displays</p><p>     mnDPIScaleFactor = CountDPIScaleFactor(mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY);</p><p>+    mnDPIX = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p>+    mnDPIY = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p><p>     if (!utl::ConfigManager::IsAvoidConfig())</p><p>     {</p><p>         const StyleSettings&amp; rStyleSettings = mxSettings-&gt;GetStyleSettings();</p><p>-        sal_uInt16 nScreenZoom = rStyleSettings.GetScreenZoom();</p><p>-        mnDPIX          = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX*nScreenZoom)/100;</p><p>-        mnDPIY          = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY*nScreenZoom)/100;</p><p>-        maFont          = rStyleSettings.GetAppFont();</p><p>+        maFont = rStyleSettings.GetAppFont();</p><p>         if ( nStyle &amp; WB_3DLOOK )</p><p>         {</p><p>@@ -1160,8 +1159,6 @@ void Window::ImplInit( vcl::Window* pParent, WinBits nStyle, SystemParentData* p</p><p>     }</p><p>     else</p><p>     {</p><p>-        mnDPIX          = 96;</p><p>-        mnDPIY          = 96;</p><p>         maFont = GetDefaultFont( DefaultFontType::FIXED, LANGUAGE_ENGLISH_US, GetDefaultFontFlags::NONE );</p><p>     }</p><p>@@ -1326,13 +1323,12 @@ void Window::ImplInitResolutionSettings()</p><p>     // recalculate AppFont-resolution and DPI-resolution</p><p>     if (mpWindowImpl-&gt;mbFrame)</p><p>     {</p><p>-        const StyleSettings&amp; rStyleSettings = mxSettings-&gt;GetStyleSettings();</p><p>-        sal_uInt16 nScreenZoom = rStyleSettings.GetScreenZoom();</p><p>-        mnDPIX = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX*nScreenZoom)/100;</p><p>-        mnDPIY = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY*nScreenZoom)/100;</p><p>+        mnDPIX = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p>+        mnDPIY = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p><p>         // setup the scale factor for Hi-DPI displays</p><p>         mnDPIScaleFactor = CountDPIScaleFactor(mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY);</p><p>+        const StyleSettings&amp; rStyleSettings = mxSettings-&gt;GetStyleSettings();</p><p>         SetPointFont(*this, rStyleSettings.GetAppFont());</p><p>     }</p><p>     else if ( mpWindowImpl-&gt;mpParent )</p><p>@@ -1355,25 +1351,16 @@ void Window::ImplInitResolutionSettings()</p><p> void Window::ImplPointToLogic(vcl::RenderContext&amp; rRenderContext, vcl::Font&amp; rFont) const</p><p> {</p><p>     Size aSize = rFont.GetFontSize();</p><p>-    sal_uInt16 nScreenFontZoom;</p><p>-    if (!utl::ConfigManager::IsAvoidConfig())</p><p>-        nScreenFontZoom = rRenderContext.GetSettings().GetStyleSettings().GetScreenFontZoom();</p><p>-    else</p><p>-        nScreenFontZoom = 100;</p><p>     if (aSize.Width())</p><p>     {</p><p>         aSize.Width() *= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p>         aSize.Width() += 72 / 2;</p><p>         aSize.Width() /= 72;</p><p>-        aSize.Width() *= nScreenFontZoom;</p><p>-        aSize.Width() /= 100;</p><p>     }</p><p>     aSize.Height() *= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p><p>     aSize.Height() += 72/2;</p><p>     aSize.Height() /= 72;</p><p>-    aSize.Height() *= nScreenFontZoom;</p><p>-    aSize.Height() /= 100;</p><p>     if (rRenderContext.IsMapModeEnabled())</p><p>         aSize = rRenderContext.PixelToLogic(aSize);</p><p>@@ -1384,25 +1371,16 @@ void Window::ImplPointToLogic(vcl::RenderContext&amp; rRenderContext, vcl::Font&amp; rFo</p><p> void Window::ImplLogicToPoint(vcl::RenderContext&amp; rRenderContext, vcl::Font&amp; rFont) const</p><p> {</p><p>     Size aSize = rFont.GetFontSize();</p><p>-    sal_uInt16 nScreenFontZoom;</p><p>-    if (!utl::ConfigManager::IsAvoidConfig())</p><p>-        nScreenFontZoom = rRenderContext.GetSettings().GetStyleSettings().GetScreenFontZoom();</p><p>-    else</p><p>-        nScreenFontZoom = 100;</p><p>     if (rRenderContext.IsMapModeEnabled())</p><p>         aSize = rRenderContext.LogicToPixel(aSize);</p><p>     if (aSize.Width())</p><p>     {</p><p>-        aSize.Width() *= 100;</p><p>-        aSize.Width() /= nScreenFontZoom;</p><p>         aSize.Width() *= 72;</p><p>         aSize.Width() += mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX / 2;</p><p>         aSize.Width() /= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p>     }</p><p>-    aSize.Height() *= 100;</p><p>-    aSize.Height() /= nScreenFontZoom;</p><p>     aSize.Height() *= 72;</p><p>     aSize.Height() += mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY / 2;</p><p>     aSize.Height() /= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p></td></tr></tbody></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>