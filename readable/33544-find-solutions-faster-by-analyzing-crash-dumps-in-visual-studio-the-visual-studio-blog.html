<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Find solutions faster by analyzing crash dumps in Visual Studio | The Visual Studio Blog -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <style type="text/css">
        html {
            font-family: sans-serif;
            line-height: 1.15;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            height: 100%;
        }

        *, ::after, ::before {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #60656a;
            text-align: left;
            background-color: #323b44;
        }

        h1 {
            font-size: 6rem;
            font-weight: 300;
            line-height: 1.2;
            margin-top: 0;
            margin-bottom: 0.5rem;
            margin-bottom: 0.5rem
        }

        a {
            color: #007bff;
            color: #ccc;
            text-decoration: none;
            background-color: transparent;
            word-break: break-all;
        }

        .unseen a {
            font-weight: bold;
        }

        h3 {
            margin-top: 0;
            padding-top: 0;
            font-weight: normal;
        }

        .grid {
            -ms-flex-direction: column;
            flex-direction: column;
            width: 1024px;
            margin: 0 auto;
            flex: 1 0 auto;
        }

        .row {
            -ms-flex-direction: row;
            flex-direction: row;
            width: 100%;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            display: -ms-flexbox;
            display: flex;
        }

        .col {
            margin: 0 10px 0 10px;
            box-sizing: border-box;
            vertical-align: top;
        }

        .col-3-of-4, .col-6-of-8, .col-9-of-12 {
            width: calc(75% - 20px);
        }

        .col-1-of-4, .col-2-of-8, .col-3-of-12 {
            width: calc(25% - 20px);
        }

        @media (max-width:1023px) {
            /* big landscape tablets, laptops, and desktops */
            body {
                overflow-x: hidden;
            }

            main {
                width: 99%;
            }

            h1 {
                font-size: 50px;
            }
        }

        .text-right {
            text-align: right;
        }

        footer {
            left: 0;
            width: 100%;
            margin-top: 2em;
            padding: 50px 0;
            text-align: center;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        .readable {
            color: #949ba2;
        }

        svg:not(:root).svg-inline--fa {
            color: #60656a;
            overflow: visible;
        }

        .svg-inline--fa.fa-w-12 {
            width: 0.75em;
        }

        svg:not(:root) {
            overflow: hidden;
        }

        .svg-inline--fa {
            display: inline-block;
            font-size: inherit;
            height: 1em;
            overflow: visible;
            vertical-align: -0.125em;
        }

        img {
            max-width: 100%;
        }

        .text-center {
            text-align: center;
        }

        .readable h1 {
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Find solutions faster by analyzing crash dumps in Visual Studio | The Visual Studio Blog</h1>
    <div class="entry-content col-12 sharepostcontent"><div class="row justify-content-center"><div class="col-md-4"><div><img src="https://secure.gravatar.com/avatar/766cdea6f76ff27b727f66a0b096e761?s=58&amp;d=mm&amp;r=g" width="58" alt="Avatar" class="avatar avatar-58 wp-user-avatar wp-user-avatar-58 photo avatar-default"><p>Mark</p></div></div></div><p><span>When unexpected crashes occur in your managed application you are often left with little evidence of the issue; capturing and analyzing memory dumps may be your last best option. Thankfully Visual Studio is a great tool for analyzing your apps memory dumps! In this post we show you how easy it is to get important insights from a crash dump, and the steps to resolve the issue using Visual Studio.</span></p><h3>What is a crash?</h3><p>There are several different things that might be causing your managed application to crash, the most common are typically unhandled exceptions. These occurs where an exception is raised (First Chance Exception), but your code does not handle it (typically using a try-catch code construct). The exception goes up the stack and becomes, what we refer to as, a <strong>S<em>econd Chance Exception</em></strong> and crashes your app&#x2019;s process.</p><p><strong>Out of Memory Exceptions</strong>, <strong>Stack Overflow Exceptions</strong> and <strong>Execution Engine Exceptions</strong> also cause crashes. <strong>Stack Overflow Exceptions</strong> and <strong>Out of Memory Exceptions</strong> can occur when your app has insufficient memory space for any function to handle the exception, which again causes the process to crash.</p><h3>Capturing a memory dump</h3><p>Memory dumps are a great diagnostic tool because they are a complete snapshot of what a process is doing at the time the dump is captured. There are several tools available for capturing memory dumps including <a href="https://visualstudio.microsoft.com/downloads/">Visual Studio</a>, <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump">ProcDump</a>, <a href="https://www.microsoft.com/en-us/download/details.aspx?id=49924">DebugDiag</a> and <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools">WinDbg</a>. The relative strength of each tool depends on your environment and the scenario you are investigating (e.g. high CPU, memory leaks, first/second chance exceptions, etc.).</p><p>In the following example, I use the versatile <a href="https://www.poppastring.com/blog/taking-a-hang-dump-or-crash-dump-with-procdump"><strong>ProcDump</strong> command-line utility from Sysinternals</a> to capture a <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/user-mode-dump-files#full">full user-mode dump</a> (-ma) when an unhandled exception (-e) occurs (1145 is the process id of my application).</p><div id="crayon-5d5afcece4aa5580916800" class="crayon-syntax crayon-theme-dark-terminal crayon-font-monaco crayon-os-pc print-yes notranslate"><div class="crayon-main"><table class="crayon-table"><tr class="crayon-row"><td class="crayon-nums "></td><td class="crayon-code"></td></tr></table></div></div><p>Once the crash occurs ProcDump immediately writes the memory dump to disk (*.dmp).</p><p>Debugging crashes is made easier with the Visual Studio memory tools, so let me show you how I debug a Stack Overflow Exception in my application, and how the tools navigate me directly to the line of code that caused the problem.</p><h3>Analyzing a crash dump with Visual Studio</h3><p>I can open my memory dump directly in Visual Studio and will be presented with the <strong>Dump Summary</strong> page.</p><p><a href="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-summary-page.png"> <img class="alignnone size-full wp-image-226165" src="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-summary-page.png" alt="Visual Studio - Dump Summary Page" width="1085" srcset="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-summary-page.png 1085w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-summary-page-300x227.png 300w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-summary-page-768x582.png 768w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-summary-page-1024x776.png 1024w" sizes="(max-width: 1085px) 100vw, 1085px"> </a></p><p>The Dump Summary page highlights several pieces of important information from the dump file including the <strong>OS Version</strong> and <strong>CLR Version</strong>. I can also search through a list of the modules that were loaded into memory at the time I captured the memory dump.</p><p>In this example the <strong>Exception Code</strong> and <strong>Exception Information</strong> state that the problem is <em>&#x201C;The thread used up its stack&#x201D;</em>. Simply put, we have a stack overflow exception. Knowing the problem is one half of the equation, but I also want to know the root cause of the issue, and this is where I think Visual Studio shines.</p><p>On the right side of the Dump Summary page, I can choose from several <strong>Actions</strong>, but as this is a managed application, I will select the <strong>Debug with Managed Only</strong> option and Visual Studio immediately drops me onto the thread and code line that caused the stack overflow exception!</p><p><a href="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-line-of-code.png"> <img class="alignnone size-full wp-image-226163" src="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-line-of-code.png" alt="Visual Studio - Crash Dump Exception" width="1800" srcset="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-line-of-code.png 1800w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-line-of-code-300x192.png 300w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-line-of-code-768x492.png 768w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-line-of-code-1024x656.png 1024w" sizes="(max-width: 1800px) 100vw, 1800px"> </a></p><p>I now have a more complete view of the problem, it&#x2019;s as if I had managed to set a break point at the exact moment of the stack overflow. This also presents me with the opportunity to review my Call Stack (which confirms the issue), review other threads, and even verify the state of any Local variables at that point in time.</p><p>In this instance Visual Studio is pointing me to a clear error on my definition of the get property. Instead of returning the private variable <em>m_MyText</em> I have mistakenly returned the public property <em>MyText</em>. This circular reference is the cause of the stack overflow exception.</p><p>Finding the root cause of the problem may not always be this clear, so you could also collaborate with a colleague directly from the exception by using <a href="https://docs.microsoft.com/en-us/visualstudio/liveshare/">Visual Studio Live Share</a>. This gives you the ability to co-debug in real time without teammates needing to set up their environment.</p><p><a href="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-start-live-share-300x126.png"> <img class="alignnone wp-image-226164 size-medium" src="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-start-live-share-300x126.png" alt="Visual Studio - Start Live Share Session from an Exception" width="300" srcset="https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-start-live-share-300x126.png 300w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-start-live-share-768x323.png 768w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2019/08/visual-studio-dump-start-live-share.png 867w" sizes="(max-width: 300px) 100vw, 300px"> </a></p><h3>Conclusion</h3><p>Over the years Visual Studio has developed first class support for handling and debugging memory dumps. It allows you to consider the impact your code is having during the exact moment of a catastrophic failure. Having the ability to investigate a problem with the same tools used for developing code can help save time determining and providing a solution.</p><p>Please let us know what you&#x2019;d like to see next by <a href="https://developercommunity.visualstudio.com/spaces/8/index.html">suggesting feature requests or reporting issues via Developer Community</a>.</p></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
</body>
</html>