<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Dark mode now available! -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Dark mode now available!</h1><div><div class="post-content"><blockquote><p>ðŸŽµ I am a man who walks alone<br>And when I'm walking a dark road<br>At night or strolling through the park</p><p>When the light begins to change<br>I sometimes feel a little strange<br>A little anxious, when it's dark. ðŸŽµ<br></p></blockquote><p>Dark mode seems to be getting more and more popular these days, especially among developers. I'm not generally a fan (no, I'm not afraid) and I generally use light mode everywhere. The one exception is at night in low light - at those times the blinding white of some websites can be very uncomfortable. </p><p>It was one of these situations, in the dark, looking something up on my blog that I decided I finally had to do something about the searing light.</p><h2 id="enabling-dark-mode" class="heading-with-anchor">Enabling dark mode<a href="#enabling-dark-mode"><img aria-hidden="true" src="/assets/img/icons-link.svg"></a></h2><p>If you want to try out dark mode on this blog, click the <strong>â˜¾ Dark</strong> link in the header bar:</p><p><img src="/content/images/p/dark_mode_0.jpg" alt="Dark link in header bar"></p><p>If you're on mobile, you won't see the words, just the <strong>â˜¾</strong> icon:</p><p><img src="/content/images/p/dark_mode_4.jpg" alt="Dark link in header bar on mobile"></p><p>Clicking this will invert the colours for the site, switching to (what I hope is) a pleasant dark mode:</p><p><img src="/content/images/p/dark_mode_1.png" alt="Comparison Light mode and dark mode"></p><p>It's not perfect, but it does the job I think!</p><p>If you decide it's not for you, you can click <strong>â˜€ Light</strong> to switch back to light mode.</p><h2 id="how-i-enabled-dark-mode-for-my-blog" class="heading-with-anchor">How I enabled dark mode for my blog<a href="#how-i-enabled-dark-mode-for-my-blog"><img aria-hidden="true" src="/assets/img/icons-link.svg"></a></h2><p>The actual mechanism for achieving dark mode is pretty simple. Clicking the <strong>â˜¾ Dark</strong> or <strong>â˜€ Light</strong> button does two things:</p><ul><li>It adds a <code>data-theme</code> attribute to the <code>documentElement</code> for the page</li><li>It stores the selected theme (<code>light</code> or <code>dark</code>) in <code>localStorage</code> with the <code>theme</code> key</li></ul><p>When the blog loads again, it checks <code>localStorage.getItem("theme")</code> to see if you've previously set the theme. If you have, then it adds the <code>data-theme</code> attribute immediately, so your selected theme persists across page loads.</p><p>That's all that's required on the JavaScript side. As you would probably expect, most of the effort was around updating the CSS to work with the new theme. Luckily, my blog doesn't use that many different colours, and it uses <a href="https://sass-lang.com/">Sass</a> to make updating the CSS more manageable.</p><p>One possible way to create a dark mode is to use CSS variables on the client (<a href="https://caniuse.com/#feat=css-variables">which I didn't realise, but are actually very well supported</a>). You can calculate the required colours in the browser by doing a blanket inversion of the site's light-mode colours. I decided against that early on, as initial tests just didn't look that nice. </p><blockquote><p>I maybe should have persisted down that route, they worked well for <a href="https://twitter.com/mwichary">Marcin Wichary</a> in his post <a href="https://medium.com/@mwichary/dark-theme-in-a-day-3518dde2955a">Dark mode in a day</a>.</p></blockquote><p>Instead, I decided to base the colour theme on VS Code's dark mode colours. I went digging around on GitHub for the <a href="https://github.com/Microsoft/vscode/tree/1f6e00a45212dc89fdfcecbcc70b2183dee50f86/extensions/theme-defaults/themes">theme files</a> and liberally pinched hex codes. Generally, the process involved finding everywhere in my <em>.sass</em> files that set a colour, and then creating a more-specific version of the rule, underneath the <code>[data-theme='dark']</code> selector. For example:</p><pre class="language-css"><code class="language-css"><span class="token selector">[data-theme='dark']</span><span class="token punctuation">{</span><span class="token selector">.post .post-card</span><span class="token punctuation">{</span><span class="token property">background</span><span class="token punctuation">:</span> $dark-post-background-color<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">.card .card-content,
    .card .card-footer</span><span class="token punctuation">{</span><span class="token property">background</span><span class="token punctuation">:</span> $dark-post-background-color<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">h1, h2, h3, h4, h5, h6</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span> $gray-lighter<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">body</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span> $gray-light<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span> $gray-darker<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>After a lot of iterating and adding a dark-mode <a href="https://prismjs.com/">prism.js theme</a> for code-highlighting, I had my very own dark mode!</p><h2 id="missing-features" class="heading-with-anchor">Missing features<a href="#missing-features"><img aria-hidden="true" src="/assets/img/icons-link.svg"></a></h2><p>There's a few things that don't work brilliantly. Most notable are any images in the posts. Your eyes are happily adjusted to the dark, when BAM! whiteness overload:</p><p><img src="/content/images/p/dark_mode_2.png" alt="A very white image"></p><p>I'm in two minds about whether to try and do anything about those. Technically speaking, it would be possible to invert the images in the post with a single CSS rule:</p><pre class="language-css"><code class="language-css"><span class="token selector">[data-theme='dark'] .post-content p img</span><span class="token punctuation">{</span><span class="token property">filter</span><span class="token punctuation">:</span><span class="token function">invert</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>This has <a href="https://caniuse.com/#feat=css-filters">pretty good support</a>, but I don't know that it's something that should be applied everywhere. A lot of the images are screenshots, so they wouldn't actually represent what you would see any more. Also, it makes some images look pretty weird and hard to readâ€¦</p><p><img src="/content/images/p/dark_mode_3.jpg" alt="Comparison Light mode and dark mode"></p><p>I'm wondering if <em>another</em> button that lets you toggle colour inversion on images is worth it? Is it a big deal? Is it good enough the way it is?</p><p>If you feel strongly one way or the other, let me know in the comments, and I'll look into it. Otherwise, enjoy!</p><h2 id="resources" class="heading-with-anchor">Resources<a href="#resources"><img aria-hidden="true" src="/assets/img/icons-link.svg"></a></h2><p>I have to give another shout out <a href="https://medium.com/@mwichary/dark-theme-in-a-day-3518dde2955a">to this great article on Medium - Dark theme in a day</a> by <a href="https://twitter.com/mwichary">Marcin Wichary</a>. In his post he describes how he created a dark theme for a mobile app in a day, using CSS variables. It's a great post, and served as the model for my approach to tackle the problem. He even inverts the images, and gives some techniques to make inverted line diagrams look better, which I may use if I decide to go that route! Either way, a really good read.</p><p>The approach I've taken is also <em>heavily</em> inspired by the light / dark toggle in <a href="https://docs.microsoft.com/en-us/dotnet/standard/frameworks">the Microsoft docs</a> menu bar:</p><p><img src="/content/images/p/dark_mode_6.png" alt="Dark mode on docs.microsoft.com"></p><p>I notice they don't try and invert images either. Probably more hassle than it's worth, especially at their scale.</p><p>Finally, I'll mention that it's also possible to detect when a user is running MacOS Mojave in dark-mode, and to <em>automatically</em> switch to a dark colour scheme. <a href="https://twitter.com/praeclarum">Frank Krueger</a> added this feature to <a href="https://fuget.org">fuget.org</a><a href="https://twitter.com/praeclarum/status/1059991579098660869">recently</a>. This uses a media-query to detect whether the user is using dark-mode:</p><pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@media</span><span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span> dark<span class="token punctuation">)</span></span><span class="token punctuation">{</span><span class="token selector">body, .dropdown-menu, ul.dropdown-menu&gt;li&gt;a</span><span class="token punctuation">{</span><span class="token property">background-color</span><span class="token punctuation">:</span> #181818<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span> #ddd<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>This seems really nice, it's just a shame you can't detect Windows 10 dark mode in this wayâ€¦ I think if you're going to take this route to dark-mode, then using the media query is great for setting the <em>default</em> experience. But it's probably best to provide a manual override to let users to switch between light and dark as whenever they want to. </p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>