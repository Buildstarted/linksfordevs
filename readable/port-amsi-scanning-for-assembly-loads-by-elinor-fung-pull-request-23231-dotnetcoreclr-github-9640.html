<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Port AMSI scanning for assembly loads by elinor-fung &#xB7; Pull Request #23231 &#xB7; dotnet/coreclr - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Port AMSI scanning for assembly loads by elinor-fung &#xB7; Pull Request #23231 &#xB7; dotnet/coreclr - linksfor.dev(s)"/>
    <meta property="og:description" content="Pass all assemblies loaded from byte arrays to AmsiScanBuffer on Windows.&#xA;Port from .NET Framework 4.8&#xA;Fixes #21370"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/coreclr/pull/23231/files"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Port AMSI scanning for assembly loads by elinor-fung &#xB7; Pull Request #23231 &#xB7; dotnet/coreclr</title>
<div class="readable">
        <h1>Port AMSI scanning for assembly loads by elinor-fung &#xB7; Pull Request #23231 &#xB7; dotnet/coreclr</h1>
            <div>Reading time: 6-7 minutes</div>
        <div>Posted here: 19 Mar 2019</div>
        <p><a href="https://github.com/dotnet/coreclr/pull/23231/files">https://github.com/dotnet/coreclr/pull/23231/files</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:260875153,&quot;repository_id&quot;:30092893,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://github.com/dotnet/coreclr/pull/23231/files&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="d48c94d267f6141458e6fb65a5f959f8cdeddf6bb1f1b01f46b89313eee65e06">
        <div>
          <table data-tab-size="4" data-diff-anchor="diff-1bedfd692dc28379c1b150f81dd68de5">

                
      <tbody><tr data-position="0">
    <td colspan="2">
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Up" aria-label="Expand Up" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=&amp;last_right=&amp;left=221&amp;left_hunk_size=11&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=221&amp;right_hunk_size=11" data-left-range="1-220" data-right-range="1-220">
            
          </a>
    </td>
    <td>@@ -221,11 +221,11 @@ if (WIN32)</td>
  </tr>

    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L221" data-line-number="221"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R221" data-line-number="221"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(CMAKE_EXE_LINKER_FLAGS <span>"<span>${CMAKE_EXE_LINKER_FLAGS}</span> /DEBUG /PDBCOMPRESS"</span>)</span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L222" data-line-number="222"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R222" data-line-number="222"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(CMAKE_EXE_LINKER_FLAGS <span>"<span>${CMAKE_EXE_LINKER_FLAGS}</span> /STACK:1572864"</span>)</span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L223" data-line-number="223"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R223" data-line-number="223"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L224" data-line-number="224"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span><span>#</span> Temporarily disable incremental link due to incremental linking CFG bug crashing crossgen.<span> </span></span></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R224" data-line-number="224"></td>

  <td>
    <span data-code-marker="+">  <span><span>#</span> Temporarily disable incremental link due to incremental linking CFG bug crashing crossgen.</span></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L225" data-line-number="225"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R225" data-line-number="225"></td>

  <td>
    <span data-code-marker=" ">  <span><span>#</span> See https://github.com/dotnet/coreclr/issues/12592</span></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L226" data-line-number="226"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R226" data-line-number="226"></td>

  <td>
    <span data-code-marker=" ">  <span><span>#</span> This has been fixed in VS 2017 Update 5 but we're keeping this around until everyone is off</span></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L227" data-line-number="227"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R227" data-line-number="227"></td>

  <td>
    <span data-code-marker=" ">  <span><span>#</span> the versions that have the bug. The bug manifests itself as a bad crash.</span></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L228" data-line-number="228"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span>set</span>(NO_INCREMENTAL_LINKER_FLAGS <span>"/INCREMENTAL:NO"</span>)<span>  </span></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R228" data-line-number="228"></td>

  <td>
    <span data-code-marker="+">  <span>set</span>(NO_INCREMENTAL_LINKER_FLAGS <span>"/INCREMENTAL:NO"</span>)</span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L229" data-line-number="229"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R229" data-line-number="229"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L230" data-line-number="230"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R230" data-line-number="230"></td>

  <td>
    <span data-code-marker=" ">  <span><span>#</span> Debug build specific flags</span></span></td>
</tr>



    <tr data-hunk="d578469954f61d2800d080e71affc0b4">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L231" data-line-number="231"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R231" data-line-number="231"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(CMAKE_SHARED_LINKER_FLAGS_DEBUG <span>"/NOVCFEATURE <span>${NO_INCREMENTAL_LINKER_FLAGS}</span>"</span>)</span></td>
</tr>



      <tr data-position="14">
    <td colspan="2">
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Down" aria-label="Expand Down" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=231&amp;last_right=231&amp;left=396&amp;left_hunk_size=6&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=396&amp;right_hunk_size=8" data-left-range="232-312" data-right-range="232-312">
            
          </a>
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Up" aria-label="Expand Up" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=231&amp;last_right=231&amp;left=396&amp;left_hunk_size=6&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=396&amp;right_hunk_size=8" data-left-range="313-395" data-right-range="313-395">
            
          </a>
    </td>
    <td>@@ -396,6 +396,8 @@ if (CLR_CMAKE_PLATFORM_UNIX)</td>
  </tr>

    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L396" data-line-number="396"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R396" data-line-number="396"></td>

  <td>
    <span data-code-marker=" "><span>endif</span>(CLR_CMAKE_PLATFORM_UNIX)</span></td>
</tr>



    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L397" data-line-number="397"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R397" data-line-number="397"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L398" data-line-number="398"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R398" data-line-number="398"></td>

  <td>
    <span data-code-marker=" "><span>if</span> (<span>WIN32</span>)</span></td>
</tr>



    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R399" data-line-number="399"></td>

  <td>
    <span data-code-marker="+">  <span>add_definitions</span>(-DPLATFORM_WINDOWS=1)</span></td>
</tr>



    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R400" data-line-number="400"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L399" data-line-number="399"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R401" data-line-number="401"></td>

  <td>
    <span data-code-marker=" ">  <span><span>#</span> Define the CRT lib references that link into Desktop imports</span></span></td>
</tr>



    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L400" data-line-number="400"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R402" data-line-number="402"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(STATIC_MT_CRT_LIB  <span>"libcmt$&lt;$&lt;OR:$&lt;CONFIG:Debug&gt;,$&lt;CONFIG:Checked&gt;&gt;:d&gt;.lib"</span>)</span></td>
</tr>



    <tr data-hunk="7e565cfce252d51ae2667722dc2cd504">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L401" data-line-number="401"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R403" data-line-number="403"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(STATIC_MT_VCRT_LIB  <span>"libvcruntime$&lt;$&lt;OR:$&lt;CONFIG:Debug&gt;,$&lt;CONFIG:Checked&gt;&gt;:d&gt;.lib"</span>)</span></td>
</tr>



      <tr data-position="23">
    <td colspan="2">
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Down" aria-label="Expand Down" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=401&amp;last_right=403&amp;left=469&amp;left_hunk_size=7&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=471&amp;right_hunk_size=7" data-left-range="402-434" data-right-range="404-436">
            
          </a>
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Up" aria-label="Expand Up" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=401&amp;last_right=403&amp;left=469&amp;left_hunk_size=7&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=471&amp;right_hunk_size=7" data-left-range="435-468" data-right-range="437-470">
            
          </a>
    </td>
    <td>@@ -469,7 +471,7 @@ if (CLR_CMAKE_PLATFORM_UNIX)</td>
  </tr>

    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L469" data-line-number="469"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R471" data-line-number="471"></td>

  <td>
    <span data-code-marker=" ">    <span><span>#</span> and so the compiler thinks that there is a mistake.</span></span></td>
</tr>



    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L470" data-line-number="470"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R472" data-line-number="472"></td>

  <td>
    <span data-code-marker=" ">    <span>add_compile_options</span>(-Wno-constant-logical-operand)</span></td>
</tr>



    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L471" data-line-number="471"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R473" data-line-number="473"></td>

  <td>
    <span data-code-marker=" ">    <span><span>#</span> We use pshpack1/2/4/8.h and poppack.h headers to set and restore packing. However</span></span></td>
</tr>



    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L472" data-line-number="472"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span><span>#</span> clang 6.0 complains when the packing change lifetime is not contained within<span> </span></span></span></td>
</tr>



    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R474" data-line-number="474"></td>

  <td>
    <span data-code-marker="+">    <span><span>#</span> clang 6.0 complains when the packing change lifetime is not contained within</span></span></td>
</tr>



    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L473" data-line-number="473"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R475" data-line-number="475"></td>

  <td>
    <span data-code-marker=" ">    <span><span>#</span> a header file.</span></span></td>
</tr>



    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L474" data-line-number="474"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R476" data-line-number="476"></td>

  <td>
    <span data-code-marker=" ">    <span>add_compile_options</span>(-Wno-pragma-pack)</span></td>
</tr>



    <tr data-hunk="4d6cb2009a21d1f81c6216b5d5b396fa">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L475" data-line-number="475"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R477" data-line-number="477"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="32">
    <td colspan="2">
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Down" aria-label="Expand Down" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=475&amp;last_right=477&amp;left=559&amp;left_hunk_size=22&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=561&amp;right_hunk_size=22" data-left-range="476-516" data-right-range="478-518">
            
          </a>
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Up" aria-label="Expand Up" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=475&amp;last_right=477&amp;left=559&amp;left_hunk_size=22&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=561&amp;right_hunk_size=22" data-left-range="517-558" data-right-range="519-560">
            
          </a>
    </td>
    <td>@@ -559,22 +561,22 @@ if (WIN32)</td>
  </tr>

    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L559" data-line-number="559"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R561" data-line-number="561"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(CMAKE_CXX_FLAGS <span>"<span>${CMAKE_CXX_FLAGS}</span> /guard:cf"</span>)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L560" data-line-number="560"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R562" data-line-number="562"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(CMAKE_C_FLAGS <span>"<span>${CMAKE_CXX_FLAGS}</span> /guard:cf"</span>)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L561" data-line-number="561"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R563" data-line-number="563"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L562" data-line-number="562"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span><span>#</span> Statically linked CRT (libcmt[d].lib, libvcruntime[d].lib and libucrt[d].lib) by default. This is done to avoid<span>  </span></span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L563" data-line-number="563"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span><span>#</span> linking in VCRUNTIME140.DLL for a simplified xcopy experience by reducing the dependency on VC REDIST.<span>  </span></span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L564" data-line-number="564"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span><span>#</span><span>  </span></span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L565" data-line-number="565"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span><span>#</span> For Release builds, we shall dynamically link into uCRT [ucrtbase.dll] (which is pushed down as a Windows Update on downlevel OS) but<span>  </span></span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L566" data-line-number="566"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span><span>#</span> wont do the same for debug/checked builds since ucrtbased.dll is not redistributable and Debug/Checked builds are not<span>  </span></span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L567" data-line-number="567"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span><span>#</span> production-time scenarios.<span>  </span></span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L568" data-line-number="568"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span>add_compile_options</span>($&lt;$&lt;<span>OR</span>:$&lt;<span>CONFIG</span>:Release&gt;,$&lt;<span>CONFIG</span>:Relwithdebinfo&gt;&gt;:/MT&gt;)<span>  </span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L569" data-line-number="569"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span>add_compile_options</span>($&lt;$&lt;<span>OR</span>:$&lt;<span>CONFIG</span>:Debug&gt;,$&lt;<span>CONFIG</span>:Checked&gt;&gt;:/MTd&gt;)<span>  </span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R564" data-line-number="564"></td>

  <td>
    <span data-code-marker="+">  <span><span>#</span> Statically linked CRT (libcmt[d].lib, libvcruntime[d].lib and libucrt[d].lib) by default. This is done to avoid</span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R565" data-line-number="565"></td>

  <td>
    <span data-code-marker="+">  <span><span>#</span> linking in VCRUNTIME140.DLL for a simplified xcopy experience by reducing the dependency on VC REDIST.</span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R566" data-line-number="566"></td>

  <td>
    <span data-code-marker="+">  <span><span>#</span></span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R567" data-line-number="567"></td>

  <td>
    <span data-code-marker="+">  <span><span>#</span> For Release builds, we shall dynamically link into uCRT [ucrtbase.dll] (which is pushed down as a Windows Update on downlevel OS) but</span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R568" data-line-number="568"></td>

  <td>
    <span data-code-marker="+">  <span><span>#</span> wont do the same for debug/checked builds since ucrtbased.dll is not redistributable and Debug/Checked builds are not</span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R569" data-line-number="569"></td>

  <td>
    <span data-code-marker="+">  <span><span>#</span> production-time scenarios.</span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R570" data-line-number="570"></td>

  <td>
    <span data-code-marker="+">  <span>add_compile_options</span>($&lt;$&lt;<span>OR</span>:$&lt;<span>CONFIG</span>:Release&gt;,$&lt;<span>CONFIG</span>:Relwithdebinfo&gt;&gt;:/MT&gt;)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R571" data-line-number="571"></td>

  <td>
    <span data-code-marker="+">  <span>add_compile_options</span>($&lt;$&lt;<span>OR</span>:$&lt;<span>CONFIG</span>:Debug&gt;,$&lt;<span>CONFIG</span>:Checked&gt;&gt;:/MTd&gt;)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L570" data-line-number="570"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R572" data-line-number="572"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L571" data-line-number="571"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R573" data-line-number="573"></td>

  <td>
    <span data-code-marker=" ">  <span>set</span>(CMAKE_ASM_MASM_FLAGS <span>"<span>${CMAKE_ASM_MASM_FLAGS}</span> /ZH:SHA_256"</span>)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L572" data-line-number="572"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>  </span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R574" data-line-number="574"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L573" data-line-number="573"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R575" data-line-number="575"></td>

  <td>
    <span data-code-marker=" ">  <span>if</span> (CLR_CMAKE_TARGET_ARCH_ARM <span>OR</span> CLR_CMAKE_TARGET_ARCH_ARM64)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L574" data-line-number="574"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R576" data-line-number="576"></td>

  <td>
    <span data-code-marker=" ">    <span><span>#</span> Contracts work too slow on ARM/ARM64 DEBUG/CHECKED.</span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L575" data-line-number="575"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R577" data-line-number="577"></td>

  <td>
    <span data-code-marker=" ">    <span>add_definitions</span>(-DDISABLE_CONTRACTS)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L576" data-line-number="576"></td>

    <td></td>

  <td>
    <span data-code-marker="-">  <span>endif</span> (CLR_CMAKE_TARGET_ARCH_ARM <span>OR</span> CLR_CMAKE_TARGET_ARCH_ARM64)<span>    </span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L577" data-line-number="577"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>  </span></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R578" data-line-number="578"></td>

  <td>
    <span data-code-marker="+">  <span>endif</span> (CLR_CMAKE_TARGET_ARCH_ARM <span>OR</span> CLR_CMAKE_TARGET_ARCH_ARM64)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R579" data-line-number="579"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L578" data-line-number="578"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R580" data-line-number="580"></td>

  <td>
    <span data-code-marker=" "><span>endif</span> (<span>WIN32</span>)</span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L579" data-line-number="579"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R581" data-line-number="581"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="f8900692cb1a6f3c40b322c2dfa43742">
    <td id="diff-1bedfd692dc28379c1b150f81dd68de5L580" data-line-number="580"></td>

    <td id="diff-1bedfd692dc28379c1b150f81dd68de5R582" data-line-number="582"></td>

  <td>
    <span data-code-marker=" "><span>if</span>(CLR_CMAKE_ENABLE_CODE_COVERAGE)</span></td>
</tr>



  <tr data-position="">
    <td colspan="2">
          <a href="#diff-1bedfd692dc28379c1b150f81dd68de5" title="Expand Down" aria-label="Expand Down" data-url="/dotnet/coreclr/blob_excerpt/39c2e7e410bd12ede33c15d6b8c7586fa5358614?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=580&amp;last_right=582&amp;left=600&amp;left_hunk_size=&amp;mode=100644&amp;path=configurecompiler.cmake&amp;right=600&amp;right_hunk_size=" data-left-range="581-599" data-right-range="583-599">
            
          </a>
    </td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>