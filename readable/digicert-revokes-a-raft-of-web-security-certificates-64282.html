<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Digicert revokes a raft of web security certificates - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Digicert revokes a raft of web security certificates - linksfor.dev(s)"/>
    <meta property="article:author" content="by&#xA;&#x9;&#x9;&#x9;Paul Ducklin"/>
    <meta property="og:description" content="The good news is that this was a bureaucratic necessity rather than an actual cybersecurity attack."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://nakedsecurity.sophos.com/2020/07/13/digicert-revokes-a-raft-of-web-security-certificates/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Digicert revokes a raft of web security certificates</title>
<div class="readable">
        <h1>Digicert revokes a raft of web security certificates</h1>
            <div>by by&#xA;&#x9;&#x9;&#x9;Paul Ducklin</div>
            <div>Reading time: 9-12 minutes</div>
        <div>Posted here: 14 Jul 2020</div>
        <p><a href="https://nakedsecurity.sophos.com/2020/07/13/digicert-revokes-a-raft-of-web-security-certificates/">https://nakedsecurity.sophos.com/2020/07/13/digicert-revokes-a-raft-of-web-security-certificates/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="page">
	<p><a href="#content">Skip to content</a></p>

	
	

	
	<section>
	 <!-- .container -->
	</section> <!-- .panel -->

	
	 <!-- #content -->


	<section>
	<div>
	<div>

		<main id="main" role="main">

	
		
<article id="post-517979">

	 <!-- .entry-header -->

    

			<p><img width="780" height="408" src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-logo-1200.png?w=780&amp;h=408&amp;crop=1" alt="" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-logo-1200.png 1200w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-logo-1200.png?resize=300,157 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-logo-1200.png?resize=768,401 768w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-logo-1200.png?resize=1024,535 1024w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-logo-1200.png?resize=780,408 780w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-logo-1200.png?resize=100,52 100w" sizes="(max-width: 780px) 100vw, 780px">					</p> <!-- .entry-featured-image -->
		
		<nav role="navigation">
		<h2>Post navigation</h2>

		
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	<div>
		
		<p>Here’s a bureaucratic nightmare that unfolded over the weekend</p>
<p>Digicert is one of the Big Five commercial CAs, short for <em>certificate authorities</em> – companies that sign and vouch for the digital certificates that put the the S in HTTPS and the padlock in your browser’s address bar.</p>
<p>As we’ve mentioned before, web certificates and HTTPS (secure HTTP) aren’t just about protecting you from surveillance by encrypting the data that flows between your browser and the websites you visit.</p>
<p>They’re refered to as <i>certificates</i> rather than just <i>encryption keys</i> because they provide some sort of assurance that the people running the site you’re reading have some sort of authority – for various interpretations of the word “authority” – to do so. </p>
<p>Note that the certificate doesn’t vouch for the safety or the accuracy of the content on the site, so cybercriminals who set up their own sites can acquire certificates for those sites. But the web certificate system does make it harder for crooks to set up imposter sites using existing website names.</p>
<p>The simplest form of web certificate is called <i>self-signed</i>, and anyone can create a self-signed certificate in seconds that claims to represent any web property they like.</p>
<p>Here, we’ve used OpenSSL, via a simple series of Lua script commands, to produce a public/private keypair, put the public key into a web certificate, make the certificate valid for 7200 seconds (two hours), and set the certificate to be authoritative.</p>
<p>In the last line, we self-signed it with the private key we generated up front:</p>
<p><img src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-keygen.png" width="640" height="800" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-keygen.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-keygen.png?resize=240,300 240w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-keygen.png?resize=56,70 56w" sizes="(max-width: 640px) 100vw, 640px"></p>
<p>We ended up with a private key that we can use to set up HTTPS connections, plus a certificate to send to the other end to vouch for our website, tied cryptographically to our own private key:</p>
<p><img src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-key-640.png" width="640" height="673" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-key-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-key-640.png?resize=285,300 285w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-key-640.png?resize=67,70 67w" sizes="(max-width: 640px) 100vw, 640px"></p>
<p>As you can imagine, no browser accepts self-signed certificates directly from websites by default – by replacing the text string <code>example.test</code> in the code above, we can generate a self-signed certificate in any name we want, valid for as long as we like, so self-signed certificates provide no authentication at all.</p>
<p>Using the code above, running in a loop on a single core of a five-year-old laptop, we generated more than 800 256-bit elliptic curve private keys and web certificates per second. 3072-bit RSA keys, which provide similar security levels to 256-bit elliptic curve keys, are much slower to create, limiting us to about three certificates per second per CPU core.</p>

<h2>Certificates in real life</h2>
<p>In real life, you can’t rely on self-signed certificates, because there’s no one to vouch for them except the self-signer, who could be anyone.</p>
<p>To acquire a certificate to use on your own website, you create your own certificate, as we did above, but then get someone else to sign it rather than just vouching for it yourself.</p>
<p>That means getting a certificate authority to vouch for you in some way, typically using:</p>
<ul>
<li><strong>Domain validation.</strong> The CA asks you to “prove” that you actually control the website or the server named in the certificate. Typically, this involves you placing some random text string into a DNS record associated with the site, or onto a webpage that is part of the site – and that’s all. Domain validation (DV) is based on the idea is that if crooks already have your web hosting password in order to cheat their way past the certificate validation test, then they already have enough to take over your web brand anyway.
</li><li><strong>Extended validation.</strong> The CA performs some background checks, for example by email and over the phone, to confirm not only that you have access to the website for which you want the certificate, but also that you represent the organisation concerned and therefore probably have the legal authority to access to the website. Extended validation (EV) certificates cost more (in particular, there aren’t yet any CAs who will provide them for free), take longer to get, and show your company name when visitors to your website use their browser’s <code>View Certificate</code> option.
</li></ul>
<p>For reason of scale, CAs don’t generally sign website certificates directly, but sign them using an intermediate certificate that is signed by a root certificate that does belong directly to the CA itself.</p>
<p>Website certificates are generally known as <i>leaf certificates</i>, because they’re at the very end of a chain of signatures, and the chain of trust goes like this:</p>
<ol>
<li><strong>The leaf certificate</strong> is vouched for by an <em>intermediate certificate</em> that belongs to the CA or to an authorised business partner.
</li><li><strong>The intermediate certificate</strong> is vouched for by a <em>root certificate</em>, directly owned by the CA.
</li><li><strong>The root certificate</strong> is <em>self-signed</em>, but your browser trusts it because it’s part of a small, trusted list of approved root certificates built into your browser or held by your operating system.
</li></ol>
<p>This three-level system reduces the number of root certificates that browsers need to keep track of (Firefox’s own database currently [2020-07-13T12:00Z] contains just 138 root certificates.)</p>
<p>It also means that if a CA devolves signing powers to numerous different offices or to business partners around the world, it doesn’t need to share its master signing key (the aptly named <em>private key</em>) with any of them.</p>
<p>Also, if one of those offices or partners makes a blunder or goes rogue, the CA can revoke just one intermediate certificate instead of being forced to invalidate its own root certificate, which would typically cause a much bigger disruption than the “divide and conquer” approach of the leaf-intermediate-root three-level system.</p>
<h2>The Digicert revocation</h2>
<p>Unfortunately, Digicert was faced over the weekend with the task of revoking a whole raft of certificates – ironically because of a bureaucratic blunder that went unnoticed until now, rather than because of any sort of active attack.</p>
<p>Digicert describes <a href="https://knowledge.digicert.com/alerts/DigiCert-ICA-Replacement" rel="nofollow">the problem</a> as follows:</p>
<blockquote><p>DigiCert has identified an issue where some of our intermediate CAs (ICAs) were not listed as part of our most recent WebTrust EV audit.</p></blockquote>
<p>To explain: as part of a regular community auditing process, CAs are supposed to submit a list of subsidiaries and business partners that are authorised to sign extended validation certificates as intermediaries on the CA’s behalf.</p>
<p>In other words, if any company X has an EV certifcate that is vouched for by intermediate company Y that is in turn vouched for by a trusted root CA certificate from company Z, then Z has to make sure company Y is listed whenever it submits its extended validation audit documents – in the understandable interests of transparency .</p>
<p>Because Digicert just realised that it hadn’t been reliably submitting its “company Y” list, it was faced with two choices, mandated by the WebTrust EV audit specifications.</p>
<p>Either…</p>
<ul>
<li><strong>Revoke all intermediate certificates on the “company Y” list</strong>, thus implicitly revoking all certificates signed by those companies, including domain validation certificates that didn’t need revoking at all.
</li></ul>
<p>Or…</p>
<ul>
<li><strong>Explicitly revoke all extended validation certificates issued by anyone on the “company Y” list</strong>, thus avoiding the collateral damage of revoking an enormous number of DV certificates at the same time.
</li></ul>
<p>Digicert opted for the latter approach to minimise disruption to browser users, though apparently it meant <a href="https://www.theregister.com/2020/07/10/digicert_pulls_certs/" rel="nofollow">revoking 50,000</a> individual EV certificates instead of just six intermediate certificates.</p>
<h2>What to do?</h2>
<p>If you run a website and your certificate has been revoked, you’ll probably realise when you or any of your customers try to visit it, because you will see a security warning.</p>
<p>But you may as well check the validation chain on your certificate anyway, and one easy visual way to do this is with the Firefox browser.</p>
<p>Visit your own site and click the padlock icon:</p>
<p><img src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ev-640.png" width="640" height="370" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ev-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ev-640.png?resize=300,173 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ev-640.png?resize=100,58 100w" sizes="(max-width: 640px) 100vw, 640px"></p>
<p>If you see a line that says <i>Certificate issued to</i>, followed by the name of your company or the company that does your web hosting, then you have an extended validation certificate. (DV certificates aren’t issued to any specific company, so this line will not appear.)</p>
<p>If you have an EV certificate, click the <code>Right arrow</code> icon, then <code>More Information</code>, then <code>View Certificate</code>, which shows you, from left to right, the validation chain of your certificate:</p>
<p><img src="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ica-640.png" width="640" height="470" srcset="https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ica-640.png 640w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ica-640.png?resize=300,220 300w, https://nakedsecurity.sophos.com/wp-content/uploads/sites/2/2020/07/dc-ica-640.png?resize=95,70 95w" sizes="(max-width: 640px) 100vw, 640px"></p>
<p>The middle entry at the top is the name of the issuer of the intermediate certificate, and if it is one of these six then you are affected:</p>
<pre>DigiCert Global CA G2  
GeoTrust TLS RSA CA G1  
Thawte TLS RSA CA G1  
Secure Site CA  
NCC Group Secure Server CA G2  
TERENA SSL High Assurance CA 3
</pre>
<p>(Above you can see that the <code>www.sophos.com</code> site doesn’t have a root CA of Digicert, and was therefore unaffected.)</p>
<p>All EV certificates signed by the above intermediate CAs have now been revoked, but any regular domain validation certificates will remain valid until they expire naturally.</p>
<p>Those above six CA names will not be used to sign any more certificates at all, so if you have a revoked EV certificate that needs reissuing, it will come from one of these new intermediates instead:</p>
<pre>DigiCert EV RSA CA G2
GeoTrust EV RSA CA G2
Thawte EV RSA CA G2
</pre>
<p>If your Digicert EV certificate is already signed by one of these three then it’s already been renewed and you are done.</p>
<p>How to renew and replace revoked ceritificates is described in Digicert’s <a href="https://knowledge.digicert.com/alerts/DigiCert-ICA-Replacement" rel="nofollow">ICA Replacement </a>knowledgebase article.</p>
<p>By the way, if you’re a website visitor and you see a certificate revocation warning over the next few days, please don’t ignore and bypass the warning just because you’ve heard about a mass revocation and assume “that’ll be the reason” – just steer clear of the site until the owner reissues and replaces the certificate.</p>
<hr>
			</div> <!-- .entry-content -->
	
</article><!-- #post-## -->

		

			<nav role="navigation">
		<h2>Post navigation</h2>

		
		<!-- .nav-links -->
	</nav><!-- .navigation -->
	
	
	</main><!-- #main -->

	</div> <!-- .panel-container -->
	</div> <!-- .container -->
	</section> <!-- .panel -->

	
	
	 <!-- .panel -->

	

	<section>
	 <!-- .container -->
	</section> <!-- .panel -->

	
	
	<!-- #colophon -->
</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>