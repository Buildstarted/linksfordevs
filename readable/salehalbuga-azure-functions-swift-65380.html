<!DOCTYPE html>
<html lang="en">
<head>
    <title>
SalehAlbuga/azure-functions-swift - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="SalehAlbuga/azure-functions-swift - linksfor.dev(s)"/>
    <meta property="article:author" content="SalehAlbuga"/>
    <meta property="og:description" content="Azure Functions in Swift! Purely in Swift! Contribute to SalehAlbuga/azure-functions-swift development by creating an account on GitHub."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/SalehAlbuga/azure-functions-swift"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - SalehAlbuga/azure-functions-swift</title>
<div class="readable">
        <h1>SalehAlbuga/azure-functions-swift</h1>
            <div>by SalehAlbuga</div>
            <div>Reading time: 11-13 minutes</div>
        <div>Posted here: 08 Aug 2020</div>
        <p><a href="https://github.com/SalehAlbuga/azure-functions-swift">https://github.com/SalehAlbuga/azure-functions-swift</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="readme">
    
      <div>
        <article itemprop="text">
<p><a href="https://swiftfunc.developerhub.io/" rel="nofollow"><img src="https://camo.githubusercontent.com/e9137d11b392bb82f2e7499105c4d0c7f7daa663/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f73616c6568616c627567612f617a7572652d66756e6374696f6e732d73776966743f696e636c7564655f70726572656c6561736573266c6162656c3d76657273696f6e" alt="ver" data-canonical-src="https://img.shields.io/github/v/release/salehalbuga/azure-functions-swift?include_prereleases&amp;label=version"></a>
<a href="https://github.com/SalehAlbuga/azure-functions-swift-tools"><img src="https://camo.githubusercontent.com/9177ae9009446ec340f9f65e88e181d804f3aea4/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f73616c6568616c627567612f617a7572652d66756e6374696f6e732d73776966742d746f6f6c733f696e636c7564655f70726572656c6561736573266c6162656c3d434c492b76657273696f6e" alt="cliver" data-canonical-src="https://img.shields.io/github/v/release/salehalbuga/azure-functions-swift-tools?include_prereleases&amp;label=CLI+version"></a>
<a href="https://github.com/apple/swift-package-manager"><img src="https://camo.githubusercontent.com/ad744674ba25cccb6e683eb78b7c485e1b63b2d2/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f53776966742532305061636b6167652532304d616e616765722d636f6d70617469626c652d627269676874677265656e2e737667" alt="Swift Package Manager compatible" data-canonical-src="https://img.shields.io/badge/Swift%20Package%20Manager-compatible-brightgreen.svg"></a>
<a href="https://docs.swiftfunc.dev/" rel="nofollow"><img src="https://camo.githubusercontent.com/d11c8caa2efd476fc69c23c606ec3b0d5ca1c5f0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f726561645f7468652d646f63732d3231393666332e737667" alt="docs-status" data-canonical-src="https://img.shields.io/badge/read_the-docs-2196f3.svg"></a>
<a href="https://swift.org/" rel="nofollow"><img src="https://camo.githubusercontent.com/43837d654ad07349591672fb55a29bdef4b60fc2/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f73776966742d352e322d627269676874677265656e2e737667" alt="Swift version" data-canonical-src="https://img.shields.io/badge/swift-5.2-brightgreen.svg"></a>
<a href="https://opensource.org/licenses/MIT" rel="nofollow"><img src="https://camo.githubusercontent.com/3ccf4c50a1576b0dd30b286717451fa56b783512/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d79656c6c6f772e737667" alt="License: MIT" data-canonical-src="https://img.shields.io/badge/License-MIT-yellow.svg"></a></p>
<p><a href="http://discord.gg/6rDzSuM" rel="nofollow"><img src="https://camo.githubusercontent.com/5116414ba59a73c5bfb229958c09d634a6ca0a1f/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f3731333437373333393436333431383031363f6c6162656c3d4a6f696e253230417a75726525323046756e6374696f6e7325323043686174" alt="Chat" data-canonical-src="https://img.shields.io/discord/713477339463418016?label=Join%20Azure%20Functions%20Chat"></a></p>
<p>Write <a href="https://azure.microsoft.com/en-us/services/functions/" rel="nofollow">Azure Functions</a>
in <a href="https://swift.org/" rel="nofollow">Swift</a>.</p>
<h4>This framework supports the new Azure Functions <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-custom-handlers" rel="nofollow">Custom Handlers</a> (starting from 0.6.0) in addition to the traditional custom worker.</h4>
<blockquote>
<p><em>Disclaimer: This is a community open source project, not an official Azure project</em></p>
</blockquote>
<h4>Documentation <a href="https://docs.swiftfunc.dev/" rel="nofollow">home page</a></h4>
<p>Deploy a sample project to Azure!</p>
<p>Classic worker sample:</p>
<p><a href="http://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fgist.githubusercontent.com%2FSalehAlbuga%2Fb0d9eeaae04cc07faf95f11b01143e40%2Fraw%2Ff70a0896960d5d6d04ce3bcd5de06a3fed2d8c0b%2Fswiftfunc-classic-sample-arm.json" rel="nofollow"><img src="https://camo.githubusercontent.com/f880eed90750db7d23052ffb665803526cb46a59/68747470733a2f2f616b612e6d732f6465706c6f79746f617a757265627574746f6e" alt="Deploy to Azure" data-canonical-src="https://aka.ms/deploytoazurebutton"></a></p>
<p>Custom Handler sample:</p>
<p><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fgist.githubusercontent.com%2FSalehAlbuga%2Fc937140075effe782996f12961b3f46d%2Fraw%2Fd94eb814fbb2250908e242aafea650576d620833%2Fswiftfunc-sample-arm.json" rel="nofollow"><img src="https://camo.githubusercontent.com/f880eed90750db7d23052ffb665803526cb46a59/68747470733a2f2f616b612e6d732f6465706c6f79746f617a757265627574746f6e" alt="Deploy to Azure" data-canonical-src="https://aka.ms/deploytoazurebutton"></a></p>
<h2>Examples</h2>
<p>A Timer Function (Custom Handler):</p>
<div><pre><span>import</span> <span>Foundation</span>
<span>import</span> <span>AzureFunctions</span>
<span>import</span> <span>Vapor</span>

<span>class</span> <span>TimerFunction</span>: <span>Function </span>{
    
    <span>required</span> <span>init</span>() {
        <span>super</span>.<span>init</span>()
        <span>self</span>.<span>name</span> <span>=</span> <span><span>"</span>TimerFunction<span>"</span></span>
        <span>self</span>.<span>functionJsonBindings</span> <span>=</span>
            [
                [
                <span><span>"</span>type<span>"</span></span> <span>:</span> <span><span>"</span>timerTrigger<span>"</span></span>,
                <span><span>"</span>name<span>"</span></span> <span>:</span> <span><span>"</span>myTimer<span>"</span></span>,
                <span><span>"</span>direction<span>"</span></span> <span>:</span> <span><span>"</span>in<span>"</span></span>,
                <span><span>"</span>schedule<span>"</span></span> <span>:</span> <span><span>"</span>*/5 * * * * *<span>"</span></span>
                ]
            ]
        <span><span>//</span>or</span>
<span></span>        <span><span>//</span>self.trigger = TimerTrigger(name: "myTimer", schedule: "*/5 * * * * *")</span>
<span></span>
        app.<span>post</span>([<span>PathComponent</span>(<span>stringLiteral</span>: name)], <span>use</span>: <span>run</span>(<span>req:</span>))
    }

    <span>func</span> <span>run</span>(<span><span>req</span></span>: Request) <span>-&gt;</span> InvocationResponse {
        <span>var</span> res <span>=</span> <span>InvocationResponse</span>()
        res.<span>appendLog</span>(<span><span>"</span>Its is time!<span>"</span></span>)
        <span>return</span> res
    }
}</pre></div>
<p>An HTTP Function (Classic Worker):</p>
<div><pre><span>import</span> <span>Foundation</span>
<span>import</span> <span>AzureFunctions</span>

<span>class</span> <span>HttpFunction</span>: <span>Function </span>{
    
    <span>required</span> <span>init</span>() {
        <span>super</span>.<span>init</span>()
        <span>self</span>.<span>name</span> <span>=</span> <span><span>"</span>HttpFunction<span>"</span></span>
        <span>self</span>.<span>trigger</span> <span>=</span> <span>HttpRequest</span>(<span>name</span>: <span><span>"</span>req<span>"</span></span>)
    }
    
    <span>override</span> <span>func</span> <span>exec</span>(<span><span>request</span></span>: HttpRequest, <span><span>context</span></span>: <span>inout</span> Context, <span><span>callback</span></span>: <span>@escaping</span> callback) <span>throws</span> {
      
        <span>let</span> res <span>=</span> <span>HttpResponse</span>()
        <span>var</span> name<span>:</span> <span>String</span><span>?</span>
        
        <span>if</span> <span>let</span> data <span>=</span> request.<span>body</span>, <span>let</span> bodyObj<span>:</span> [<span>String</span><span>:</span> <span>Any</span>] <span>=</span> <span>try</span><span>?</span> JSONSerialization.<span>jsonObject</span>(<span>with</span>: data, <span>options</span>: []) <span>as?</span> [<span>String</span><span>:</span> <span>Any</span>] {
            name <span>=</span> bodyObj[<span><span>"</span>name<span>"</span></span>] <span>as?</span> <span>String</span>
        } <span>else</span> {
            name <span>=</span> request.<span>query</span>[<span><span>"</span>name<span>"</span></span>]
        }
        res.<span>body</span>  <span>=</span> <span><span>"</span>Hello <span>(</span><span>name <span>??</span> <span><span>"</span>buddy<span>"</span></span></span><span><span>)</span></span>!<span>"</span></span>.<span>data</span>(<span>using</span>: .<span>utf8</span>)
        
        <span>return</span> <span>callback</span>(res);
    } 
}</pre></div>
<h2>Getting Started</h2>
<h3>Installation and Requirements</h3>
<h4><strong>Swift 5.2 or later or Xcode 11 or later on macOS</strong></h4>
<p>Swift installation: <a href="https://swift.org/getting-started/#installing-swift" rel="nofollow">https://swift.org/getting-started/#installing-swift</a></p>
<h4><strong>Azure Functions Core Tools</strong></h4>
<p>Install the latest <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local#install-the-azure-functions-core-tools" rel="nofollow">Azure Functions Core Tools</a>.</p>
<h4><strong>Swift Functions Tools</strong></h4>
<p>Just like Core Tools, Swift Functions Tools make Swift functions development easier and much more convenient.</p>
<p>On <strong>macOS</strong>, you can install it from <a href="https://brew.sh/" rel="nofollow">Homebrew</a> <g-emoji alias="beer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f37a.png">üç∫</g-emoji></p>
<div><pre>brew install salehalbuga/formulae/swift-func</pre></div>
<p>on <strong>Linux</strong>,</p>
<p>Clone the repo the tools repo</p>
<div><pre>git clone https://github.com/SalehAlbuga/azure-functions-swift-tools</pre></div>
<p>Install</p>

<p>It installs a CLI tool called <code>swiftfunc</code> that can be used to create projects, functions and run them locally.</p>
<h3>Creating a new Project/Azure Functions app</h3>
<p>Run the init command to create a new Azure Functions application:</p>
<div><pre>swiftfunc init myApp [-hw]</pre></div>
<p>It will create a new app in a new folder, and a folder named <code>functions</code> inside the Sources target where Functions should be (<em>/myApp/Sources/myApp/functions</em>).
The project created is a Swift package project with the Azure Functions framework dependency.</p>
<p>Pass <code>-hw</code> or <code>--http-worker</code> option to create the project with the  <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-custom-handlers" rel="nofollow">Custom Handler</a> template.</p>
<h3>Creating a simple HTTP function</h3>
<p>Inside the new directory of your project, run the following to create a new HTTP Function named <code>hello</code>:</p>
<div><pre>swiftfunc new http -n hello [-hw]</pre></div>
<p>The new function file will be created in the following path <code>Sources/myApp/functions/hello.swift</code>.</p>
<p>Similar to the <code>init</code> command, pass <code>-hw</code> or <code>--http-worker</code> option to create the new function with the Custom Handler template.</p>
<h3>Running the new Functions App</h3>
<p>Run <code>swiftfunc run</code> in the project directory to run your Swift Functions project locally. It will compile the code and start the host for you <em>(as if you were running <code>func host start</code>)</em>. The host output should show you the URL of <code>hello</code> function created above. Click on it to run the function and see output!</p>
<h2><strong>Deploying to Azure <g-emoji alias="cloud" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2601.png">‚òÅÔ∏è</g-emoji></strong></h2>
<p>Curently Swift Functions Tools do not provide a command to deploy to Azure. To deploy the Function App to Azure, you need to build the provided docker image, push to a registry and set it in the Container Settings of the Function App.</p>
<p>Build the image</p>
<div><pre>docker build -t <span>&lt;</span>imageTag<span>&gt;</span> <span>.</span></pre></div>
<p>If you're using DockerHub then the tag would be <code>username/imageName:version</code>.
If you're using ACR (<a href="https://docs.microsoft.com/en-us/azure/container-registry/" rel="nofollow">Azure Container Registry</a>) or any other private registry the tag would be <code>registryURL/imageName:version</code></p>
<p>Then push it</p>

<p>In <a href="https://portal.azure.com/" rel="nofollow">Azure portal</a>, create a new Function App with <strong>Docker Container</strong> as the Publish option. Under Hosting options make sure Linux is selected as OS.</p>
<p>Once the app is created or in any existing Container Function App, under <strong>Platform Features</strong>, select <strong>Container settings</strong> and set the registry and select image you pushed.</p>
<p>You can use the buttons below to deploy prebuilt sample project to your Azure subscription</p>
<p><a href="http://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fgist.githubusercontent.com%2FSalehAlbuga%2Fb0d9eeaae04cc07faf95f11b01143e40%2Fraw%2Ff70a0896960d5d6d04ce3bcd5de06a3fed2d8c0b%2Fswiftfunc-classic-sample-arm.json" rel="nofollow"><img src="https://camo.githubusercontent.com/f880eed90750db7d23052ffb665803526cb46a59/68747470733a2f2f616b612e6d732f6465706c6f79746f617a757265627574746f6e" alt="Deploy to Azure" data-canonical-src="https://aka.ms/deploytoazurebutton"></a></p>
<p>Custom Handler sample:</p>
<p><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fgist.githubusercontent.com%2FSalehAlbuga%2Fc937140075effe782996f12961b3f46d%2Fraw%2Fd94eb814fbb2250908e242aafea650576d620833%2Fswiftfunc-sample-arm.json" rel="nofollow"><img src="https://camo.githubusercontent.com/f880eed90750db7d23052ffb665803526cb46a59/68747470733a2f2f616b612e6d732f6465706c6f79746f617a757265627574746f6e" alt="Deploy to Azure" data-canonical-src="https://aka.ms/deploytoazurebutton"></a></p>
<h2><strong>Bindings</strong></h2>
<p>Azure Functions offer a variety of <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings" rel="nofollow">Bindings and Triggers</a></p>
<p>The trigger, input bindings and output bindings of a Function are set in its initializer. Azure Functions in Swift must inherit the <strong>Function</strong> class from the framework.</p>
<h3>Custom Handler (HTTP Worker)</h3>
<p>When using the Custom Handler mode you can use all Azure Functions bindings and triggers by setting the <code>functionJsonBindings</code> property to the JSON config of the bindings/triggers in Azure Functions <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings#supported-bindings" rel="nofollow">docs</a>. You can also use the framework supported Trigger/Binding types listed below.</p>
<h3>Traditional Worker (Classic)</h3>
<p>Currently the following are supported by this mode. More bindings will be implemented and many improvements will be made in the future.</p>
<table>
<thead>
<tr>
<th>Swift Type</th>
<th>Azure Functions Binding</th>
<th>Direction</th>
</tr>
</thead>
<tbody>
<tr>
<td>HttpRequest</td>
<td>HTTP Trigger</td>
<td>in</td>
</tr>
<tr>
<td>HttpResponse</td>
<td>Output HTTP Response</td>
<td>out</td>
</tr>
<tr>
<td>TimerTrigger</td>
<td>Timer Trigger</td>
<td>in</td>
</tr>
<tr>
<td>Message datatype <strong>String</strong> (binding defined by Table in constructor)</td>
<td>Input and Ouput Table</td>
<td>in, out</td>
</tr>
<tr>
<td>Message datatype <strong>String</strong> (binding defined by Queue in constructor)</td>
<td>Output Queue Message</td>
<td>out</td>
</tr>
<tr>
<td>Message datatype <strong>String</strong> (binding defined by Queue in constructor)</td>
<td>Queue Trigger</td>
<td>in</td>
</tr>
<tr>
<td>Blob (the blob data prob is either String or Data)</td>
<td>Input Blob</td>
<td>in</td>
</tr>
<tr>
<td>String or Data</td>
<td>Output Blob</td>
<td>out</td>
</tr>
<tr>
<td>Blob</td>
<td>Blob Trigger</td>
<td>in</td>
</tr>
<tr>
<td>ServiceBusMessage</td>
<td>Service Bus Output Message</td>
<td>out</td>
</tr>
<tr>
<td>ServiceBusMessage</td>
<td>Service Bus Trigger</td>
<td>in</td>
</tr>
</tbody>
</table>
<h3>Custom Handler (HTTP Worker)</h3>
<div><pre><span>import</span> <span>AzureFunctions</span>
<span>import</span> <span>Vapor</span>

<span>class</span> <span>QueueFunction</span>: <span>Function </span>{

    <span>required</span> <span>init</span>() {
        <span>super</span>.<span>init</span>()
        <span>self</span>.<span>name</span> <span>=</span> <span><span>"</span>QueueFunction<span>"</span></span>
        <span>self</span>.<span>functionJsonBindings</span> <span>=</span> [
                [
                    <span><span>"</span>connection<span>"</span></span> <span>:</span> <span><span>"</span>AzureWebJobsStorage<span>"</span></span>,
                    <span><span>"</span>type<span>"</span></span> <span>:</span> <span><span>"</span>queueTrigger<span>"</span></span>,
                    <span><span>"</span>name<span>"</span></span> <span>:</span> <span><span>"</span>myQueueTrigger<span>"</span></span>,
                    <span><span>"</span>queueName<span>"</span></span> <span>:</span> <span><span>"</span>myqueue<span>"</span></span>,
                    <span><span>"</span>direction<span>"</span></span> <span>:</span> <span><span>"</span>in<span>"</span></span>
                ]
            ]
        <span><span>//</span> or</span>
<span></span>        <span><span>//</span>self.trigger = Queue(name: "myQueueTrigger", queueName: "myqueue", connection: "AzureWebJobsStorage")</span>
<span></span>        
        app.<span>post</span>([<span>PathComponent</span>(<span>stringLiteral</span>: name)], <span>use</span>: <span>run</span>(<span>req:</span>))
    }
    
    <span>func</span> <span>run</span>(<span><span>req</span></span>: Request) <span>-&gt;</span> InvocationResponse {
        <span>...</span></pre></div>
<h3>Traditional Worker (Classic)</h3>
<div><pre><span>import</span> <span>AzureFunctions</span>

<span>class</span> <span>HttpFunction</span>: <span>Function </span>{
    
    <span>required</span> <span>init</span>() {
        <span>super</span>.<span>init</span>()
        <span>self</span>.<span>name</span> <span>=</span> <span><span>"</span>HttpFunction<span>"</span></span>
        <span>self</span>.<span>trigger</span> <span>=</span> <span>HttpRequest</span>(<span>name</span>: <span><span>"</span>req<span>"</span></span>)
        <span>self</span>.<span>inputBindings</span> <span>=</span> [<span>Blob</span>(<span>name</span>: <span><span>"</span>fileInput<span>"</span></span>, <span>path</span>: <span><span>"</span>container/myBlob.json<span>"</span></span>, <span>connection</span>: <span><span>"</span>AzureWebJobsStorage<span>"</span></span>)]
        <span>self</span>.<span>outputBindings</span> <span>=</span> [<span>Queue</span>(<span>name</span>: <span><span>"</span>queueOutput<span>"</span></span>, <span>queueName</span>: <span><span>"</span>myQueue<span>"</span></span>, <span>connection</span>: <span><span>"</span>AzureWebJobsStorage<span>"</span></span>)]
    }
    
    <span>override</span> <span>func</span> <span>exec</span>(<span><span>request</span></span>: HttpRequest, <span><span>context</span></span>: <span>inout</span> Context, <span><span>callback</span></span>: <span>@escaping</span> callback) <span>throws</span> {
   <span>...</span></pre></div>
<h2>Writing Swift Functions</h2>
<h3>Traditional Worker (Classic)</h3>
<p>Based on your Function's trigger type the worker will call the appropriate <code>exec</code> overload. For instance, if the Function is timer-triggered, then the worker will call</p>
<div><pre><span>exec</span>(<span>timer:context:callback:</span>)</pre></div>
<p>If it was an HTTP-triggered one:</p>
<div><pre><span>exec</span>(<span>request:context:callback:</span>)</pre></div>
<p>You can see the list of available overloads in Xcode.</p>
<p>Input and Output bindings are available in the context as Dictionaries, where you can access/set the values using the binding names specified in the constructor.
For example:</p>
<div><pre><span>let</span> tableVal <span>=</span> context.<span>inputBindings</span>[<span><span>"</span>myTableInput<span>"</span></span>]</pre></div>
<div><pre>context.<span>outputBindings</span>[<span><span>"</span>myQueueOutput<span>"</span></span>] <span>=</span> <span><span>"</span>new item!<span>"</span></span></pre></div>
<h3>Custom Handler (HTTP Worker)</h3>
<p>The framework uses Vapor 4.0 HTTP server. The <code>Function</code> class has the <code>app</code> property, thats the Vapor app instance you can use to register your functions's HTTP route.</p>
<div><pre><span>class</span> <span>myFunction</span>: <span>Function </span>{
    
    <span>required</span> <span>init</span>() {
        <span>super</span>.<span>init</span>()
        <span>self</span>.<span>name</span> <span>=</span> <span><span>"</span>myFunction<span>"</span></span>
        <span>self</span>.<span>functionJsonBindings</span> <span>=</span> [
            [
                <span><span>"</span>connection<span>"</span></span> <span>:</span> <span><span>"</span>AzureWebJobsStorage<span>"</span></span>,
                <span><span>"</span>type<span>"</span></span> <span>:</span> <span><span>"</span>queueTrigger<span>"</span></span>,
                <span><span>"</span>name<span>"</span></span> <span>:</span> <span><span>"</span>myQueueTrigger<span>"</span></span>,
                <span><span>"</span>queueName<span>"</span></span> <span>:</span> <span><span>"</span>myqueue<span>"</span></span>,
                <span><span>"</span>direction<span>"</span></span> <span>:</span> <span><span>"</span>in<span>"</span></span>
            ]
        ]
        
        app.<span>post</span>([<span>PathComponent</span>(<span>stringLiteral</span>: name)], <span>use</span>: <span>run</span>(<span>req:</span>))
    }
    
    <span>func</span> <span>run</span>(<span><span>req</span></span>: Request) <span>-&gt;</span> InvocationResponse {
        <span>var</span> res <span>=</span> <span>InvocationResponse</span>()
        <span>if</span> <span>let</span> payload <span>=</span> <span>try</span><span>?</span> req.<span>content</span>.<span>decode</span>(InvocationRequest.<span>self</span>) {
            res.<span>appendLog</span>(<span><span>"</span>Got <span></span>(payload.Data?[<span>"</span></span>myQueueTrigger<span><span>"</span>] ?? <span>"</span><span>"</span>)<span>"</span></span>)
        }
        <span>return</span> res
    }
}</pre></div>
<p>The framework also provides the function invocation Request and Response models needed for Azure Function host, which conform to Content protocol from Vapor, along with helper methods.</p>
<p><strong>Invocation Request:</strong></p>
<div><pre><span><span>///</span> Trigger/Bindings data (values).</span>
<span></span><span>var</span> data<span>:</span> [<span>String</span><span>:</span>AnyCodable]<span>?</span>
<span><span>///</span> Trigger/Bindings metadata.</span>
<span></span><span>var</span> metadata<span>:</span> [<span>String</span><span>:</span>AnyCodable]<span>?</span></pre></div>
<p><strong>Invocation Request:</strong></p>
<div><pre><span><span>///</span> Output bindings values dictionary</span>
<span></span><span>var</span> outputs<span>:</span> [<span>String</span><span>:</span>AnyCodable]<span>?</span>
<span><span>///</span> Functions logs array. These will be logged when the Function is executed</span>
<span></span><span>var</span> logs<span>:</span> [<span>String</span>] <span>=</span> []
<span><span>///</span> The $return binding value</span>
<span></span><span>var</span> returnValue<span>:</span> AnyCodable<span>?</span></pre></div>
<h4>Framework Updates</h4>
<p>As the framework is being actively updated, update the framework and the tools if you're having any issues or want to have the latest features and improvements.</p>
<p>To update the framework:</p>

<p>To update the tools:</p>
<div><pre>brew upgrade salehalbuga/formulae/swift-func</pre></div>
<h3>Storage Connections</h3>
<p>In the generated <code>main.swift</code> you can define your debug <code>AzureWebJobsStorage</code> and optionally any other connections/environment vars.</p>
<div><pre><span><span>//</span></span>
<span><span>//</span>  main.swift</span>
<span><span>//</span>  </span>
<span><span>//</span></span>
<span><span>//</span>  Auto Generated by SwiftFunctionsSDK</span>
<span><span>//</span></span>
<span><span>//</span>  Only set env vars or register/remove Functions. Do Not modify/add other code</span>
<span><span>//</span></span>
<span></span>
<span>import</span> <span>AzureFunctions</span>

<span>let</span> registry <span>=</span> <span>FunctionRegistry</span>()

registry.<span>AzureWebJobsStorage</span> <span>=</span> <span><span>"</span>yourConnection<span>"</span></span> <span><span>//</span>Remove before deploying. Do not commit or push any Storage Account keys</span>
<span></span>registry.<span>EnvironmentVariables</span> <span>=</span> [<span><span>"</span>queueStorageConnection<span>"</span></span><span>:</span> <span><span>"</span>otherConnection<span>"</span></span>]

registry.<span>register</span>(hello.<span>self</span>)
<span>...</span></pre></div>
<p>Be sure not to commit any debugging Storage Account keys to a repo</p>
<h3>Logging</h3>
<p><strong>Traditional Worker (Classic)</strong></p>
<p>You can log using the log method in <code>context</code> object</p>

<p><strong>Custom Handler (HTTP Worker)</strong></p>
<p>Logs are returned in the InvocationResponse obj. You can append logs:</p>

<h3>Code Execution Note</h3>
<p><strong>Traditional Worker (Classic)</strong></p>
<p>When your Function is done executing the logic you should call the provided callback passing the <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-return-value?tabs=csharp" rel="nofollow"><code>$return</code></a> output binding value or with <code>true</code> if none.</p>

</article>
      </div>
  </div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>