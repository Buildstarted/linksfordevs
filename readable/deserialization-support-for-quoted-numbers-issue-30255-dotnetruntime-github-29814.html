<!DOCTYPE html>
<html lang="en">
<head>
    <title>
System.Text.Json: (De)serialization support for quoted numbers  &#xB7; Issue #30255 &#xB7; dotnet/runtime - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="System.Text.Json: (De)serialization support for quoted numbers  &#xB7; Issue #30255 &#xB7; dotnet/runtime - linksfor.dev(s)"/>
    <meta property="article:author" content="ArgoZhang"/>
    <meta property="og:description" content="Apologies if this issue exists already...I hunted and couldn&amp;#39;t find one. I&amp;#39;ve been trying to switch a lot of usages over to System.Text.Json from Newtonsoft and Jil, but a recurring theme i..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/corefx/issues/39473"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - System.Text.Json: (De)serialization support for quoted numbers  &#xB7; Issue #30255 &#xB7; dotnet/runtime</title>
<div class="readable">
        <h1>System.Text.Json: (De)serialization support for quoted numbers  &#xB7; Issue #30255 &#xB7; dotnet/runtime</h1>
            <div>by ArgoZhang</div>
            <div>Reading time: 22-27 minutes</div>
        <div>Posted here: 15 Jul 2019</div>
        <p><a href="https://github.com/dotnet/corefx/issues/39473">https://github.com/dotnet/corefx/issues/39473</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-channel="marked-as-read:issue:558470513">

              
<div data-gid="MDU6SXNzdWU1NTg0NzA1MTM=" data-url="/_render_node/MDU6SXNzdWU1NTg0NzA1MTM=/issues/body" data-channel="issue:558470513">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NickCraver/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NickCraver"><img height="40" width="40" alt="@NickCraver" src="https://avatars0.githubusercontent.com/u/454813?s=88&amp;v=4"></a>

</p>


  
<div id="issue-558470513">
  <div data-body-version="b8bf5897148a7851aaafb234115d48dd" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Apologies if this issue exists already...I hunted and couldn't find one.</p>
<p>I've been trying to switch a lot of usages over to <code>System.Text.Json</code> from Newtonsoft and Jil, but a recurring theme is handling external APIs and their not-quite-right returns of JSON.</p>
<p>Unfortunately, an example I'm seeing over and over is:</p>

<p>They're numbers, but as strings. <code>int</code>, <code>double</code>, <code>decimal</code>, whatever. It happens <em>all the time</em>. And since it's someone's API, it's unlikely we'll get the world to fix this.</p>
<p>Note: this is something Newtonsoft handles <em>by default</em>, which is why I don't think most people realize it's an issue.</p>
<p>Is there any chance we can let <code>System.Text.Json</code> handle number types being quoted when deserializing? Something a user opts-into via <code>JsonSerializerOptions</code>?</p>
<p>Small repro example:</p>
<div><pre><span>void</span> <span>Main</span>()
{
	<span>JsonSerializer</span>.<span>Parse</span>&lt;<span>Foo</span>&gt;(<span><span>@"</span>{<span>""</span>Bar<span>""</span>:<span>""</span>1234<span>""</span>}<span>"</span></span>);
}
<span>public</span> <span>class</span> <span>Foo</span>
{
	<span>public</span> <span>int</span> <span>Bar</span> { <span>get</span>; <span>set</span>; }
}</pre></div>
<p>cc <a data-hovercard-type="user" data-hovercard-url="/users/ahsonkhan/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ahsonkhan">@ahsonkhan</a> <a data-hovercard-type="user" data-hovercard-url="/users/steveharter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/steveharter">@steveharter</a></p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>

</div>


              

  


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTI0ODU3OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTI0ODU3OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTI0ODU3OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NickCraver/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NickCraver"><img height="40" width="40" alt="@NickCraver" src="https://avatars0.githubusercontent.com/u/454813?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511248578">
    <div>
      

  

<details data-body-version="9e55b381ea71d8ef9648a3e8c35025a5">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="9e55b381ea71d8ef9648a3e8c35025a5" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>From Twitter: a lot of people correctly point out that numbers are intentionally quoted in APIs <em>so they're not assumed to be floats</em> and lose precision. It's an excellent point, and even more reason to support deserializing them I think.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTI4MDYzOA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTI4MDYzOA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTI4MDYzOA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/bartonjs/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bartonjs"><img height="40" width="40" alt="@bartonjs" src="https://avatars1.githubusercontent.com/u/10642668?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511280638">
    <div>
      

  

<details data-body-version="496a1c26d8a2885dd89cc9e50900112c">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="496a1c26d8a2885dd89cc9e50900112c" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>numbers are intentionally quoted in APIs so they're not assumed to be floats and lose precision</p>
</blockquote>
<p>To me that says that the user should still deserialize them as strings and only turn them into numbers when they're ready to accept the loss of precision.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTM3ODM3Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTM3ODM3Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTM3ODM3Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/manigandham/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/manigandham"><img height="40" width="40" alt="@manigandham" src="https://avatars2.githubusercontent.com/u/457226?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511378373">
    <div>
      

  

<details data-body-version="1bd8c16adc05642fb3348e5f8387cdbf">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="1bd8c16adc05642fb3348e5f8387cdbf" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/bartonjs/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bartonjs">@bartonjs</a></p>
<p>That's the intention. The data types for the class properties are what we want the final result to be.</p>
<p>If we have to use string-based properties first and then parse ourselves then there's not much utility for this serialization library in terms of mapping to types at all, especially for APIs.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTQwODczMA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTQwODczMA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTQwODczMA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/steveharter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/steveharter"><img height="40" width="40" alt="@steveharter" src="https://avatars3.githubusercontent.com/u/6986755?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511408730">
    <div>
      

  

<details data-body-version="db63a96fc84d34b677c729e4a48fa598">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="db63a96fc84d34b677c729e4a48fa598" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>With support for a custom double and\or decimal converter you can do this yourself. Perhaps there will be future support for a set of "Json.NET-compat" converters at some point but that is not available now.</p>
<p>Below is an skeleton of such a custom converter. Also see <a href="https://github.com/dotnet/corefx/issues/38713">https://github.com/dotnet/corefx/issues/38713</a> which has a custom <code>object</code> converter that converts to <code>bool</code> if token type is True\False.</p>
<div><pre><span>public</span> <span>class</span> <span>DoubleConverterWithStringSupport</span> : <span>JsonConverter</span>&lt;<span>double</span>&gt;
{
    <span>public</span> <span>override</span> <span>double</span> <span>Read</span>(<span>ref</span> <span>Utf8JsonReader</span> <span>reader</span>, <span>Type</span> <span>type</span>, <span>JsonSerializerOptions</span> <span>options</span>)
    {
        <span>if</span> (<span>reader</span>.<span>TokenType</span> <span>==</span> <span>JsonTokenType</span>.<span>String</span>)
        {
            <span>return</span> ...;
        }

        <span><span>//</span> Default behavior; will throw if TokenType != Number</span>
        <span>return</span> <span>reader</span>.<span>GetDouble</span>();
    }

    <span>public</span> <span>override</span> <span>void</span> <span>Write</span>(<span>Utf8JsonWriter</span> <span>writer</span>, <span>double</span> <span>value</span>, <span>JsonSerializerOptions</span> <span>options</span>)
    {
        <span><span>//</span> Write as number or string? Could also use [JsonConverter] to specify a different converter for certain properties.</span>
    }
}</pre></div>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTQwOTUzOA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTQwOTUzOA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTQwOTUzOA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/steveharter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/steveharter"><img height="40" width="40" alt="@steveharter" src="https://avatars3.githubusercontent.com/u/6986755?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511409538">
    <div>
      

  

<details data-body-version="decb94494e4437ad5e3c0e579af6f434">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTUwOTk0Ng==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTUwOTk0Ng==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTUwOTk0Ng==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NickCraver/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NickCraver"><img height="40" width="40" alt="@NickCraver" src="https://avatars0.githubusercontent.com/u/454813?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511509946">
    <div>
      

  

<details data-body-version="6d4554e4dff75d0c2b4d369a4722b926">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="6d4554e4dff75d0c2b4d369a4722b926" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>I'm trying to unwrap all that (thanks for the workaround!) - is that saying we'd never consider adding it to the base serializer and it'd only ever live as an extension point? I'm finding the lack of this to be a very common pain point, so I'm wondering what the bar is for inclusion if so.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTUxMzMyOA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTUxMzMyOA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTUxMzMyOA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/bartonjs/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bartonjs"><img height="40" width="40" alt="@bartonjs" src="https://avatars1.githubusercontent.com/u/10642668?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511513328">
    <div>
      

  

<details data-body-version="b159acecfb7bdbb9581bab9481ef6610">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="b159acecfb7bdbb9581bab9481ef6610" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/NickCraver/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NickCraver">@NickCraver</a> I think it's just "there's a whole lot of policy here, and we would need to completely spec it out, and we're trying to be feature complete 30 days ago... so this isn't required for v1 (.NET Core 3.0)"</p>
<ul>
<li>Is there an option to say if deserializing should be strict vs coercive? (Personally, I hate coercive APIs, so I would always want it in "this data better conform to schema" mode)</li>
<li>If numbers are deserialized through either JSON Number or JSON String, how are they written?
<ul>
<li>Do we need per property toggles other than the converters?</li>
</ul>
</li>
<li>Is only invariant format supported? Or also CurrentCulture? Or CurrentUICulture?</li>
<li>How should the deserialization handle it if the property is typed as <code>int</code> but the value is the string "3.0"? Is that 3, or an exception?  (Currently (IIRC) if it's a JSON number that says 3.0 and the field is int it throws)</li>
<li>Should it ignore trailing spaces if they ended up in the string?  Leading spaces?</li>
<li>Should it support the percentage format? The currency format?</li>
</ul>
<p>It's a simple-sounding request, but there are a lot of details and many of them are hard to change once the feature first ships.  So the .NET Core 3.0 answer is "deserialization doesn't coerce numbers out of JSON strings; but the converters feature lets you effectively opt-in on a property-by-property basis".</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTUxNDc3Mg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMTUxNDc3Mg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMTUxNDc3Mg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/NickCraver/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/NickCraver"><img height="40" width="40" alt="@NickCraver" src="https://avatars0.githubusercontent.com/u/454813?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-511514772">
    <div>
      

  

<details data-body-version="729370cf31cd3703e4b5dbaa523c4258">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="729370cf31cd3703e4b5dbaa523c4258" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Totally understand, I was mostly curious about where the bar is and if moving to this was a good from a future standpoint (or we shouldn't try to move certain code sections to it). That list helps a lot - I agree this can't be just tossed in.</p>
<p>Thanks for the quick reply!</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxNTQ3MDY4MQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxNTQ3MDY4MQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxNTQ3MDY4MQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/manigandham/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/manigandham"><img height="40" width="40" alt="@manigandham" src="https://avatars2.githubusercontent.com/u/457226?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-515470681">
    <div>
      

  

<details data-body-version="cee1300af1cb06bfcfdf83e4f93e20b9">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="cee1300af1cb06bfcfdf83e4f93e20b9" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>The converter option mentioned by <a data-hovercard-type="user" data-hovercard-url="/users/steveharter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/steveharter">@steveharter</a> works great now in the .NET Core 3.0 preview-7 release. Confirmed server-side and in Blazor.</p>
<div><pre><span>public</span> <span>class</span> <span>LongToStringConverter</span> : <span>JsonConverter</span>&lt;<span>long</span>&gt;
{
    <span>public</span> <span>override</span> <span>long</span> <span>Read</span>(<span>ref</span> <span>Utf8JsonReader</span> <span>reader</span>, <span>Type</span> <span>type</span>, <span>JsonSerializerOptions</span> <span>options</span>)
    {
        <span>if</span> (<span>reader</span>.<span>TokenType</span> <span>==</span> <span>JsonTokenType</span>.<span>String</span>)
        {
            <span>ReadOnlySpan</span>&lt;<span>byte</span>&gt; <span>span</span> <span>=</span> <span>reader</span>.<span>HasValueSequence</span> <span>?</span> <span>reader</span>.<span>ValueSequence</span>.<span>ToArray</span>() <span>:</span> <span>reader</span>.<span>ValueSpan</span>;
            <span>if</span> (<span>Utf8Parser</span>.<span>TryParse</span>(<span>span</span>, <span>out</span> <span>long</span> <span>number</span>, <span>out</span> <span>int</span> <span>bytesConsumed</span>) <span>&amp;&amp;</span> <span>span</span>.<span>Length</span> <span>==</span> <span>bytesConsumed</span>)
                <span>return</span> <span>number</span>;

            <span>if</span> (<span>Int64</span>.<span>TryParse</span>(<span>reader</span>.<span>GetString</span>(), <span>out</span> <span>number</span>))
                <span>return</span> <span>number</span>;
        }

        <span>return</span> <span>reader</span>.<span>GetInt64</span>();
    }

    <span>public</span> <span>override</span> <span>void</span> <span>Write</span>(<span>Utf8JsonWriter</span> <span>writer</span>, <span>long</span> <span>value</span>, <span>JsonSerializerOptions</span> <span>options</span>)
    {
        <span>writer</span>.<span>WriteStringValue</span>(<span>value</span>.<span>ToString</span>());
    }
}</pre></div>
<div><pre><span>services</span>.<span>AddControllersWithViews</span>()
   .<span>AddJsonOptions</span>(<span>options</span> <span>=&gt;</span>
   {
        <span>options</span>.<span>JsonSerializerOptions</span>.<span>Converters</span>.<span>Add</span>(<span>new</span> <span>LongToStringSupport</span>());
   });</pre></div>
<p>This was developed in the other thread: <a href="https://github.com/dotnet/corefx/issues/36563#issuecomment-519788518">https://github.com/dotnet/corefx/issues/36563#issuecomment-519788518</a></p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxNTQ4OTk5MQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxNTQ4OTk5MQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxNTQ4OTk5MQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/manigandham/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/manigandham"><img height="40" width="40" alt="@manigandham" src="https://avatars2.githubusercontent.com/u/457226?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-515489991">
    <div>
      

  

<details data-body-version="46c4f1251113c548f0b9c8bab66e9700">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="46c4f1251113c548f0b9c8bab66e9700" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/AlexPaskhin/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/AlexPaskhin">@AlexPaskhin</a></p>
<p>It's not every type... this case is about Javascript/JSON not supporting large numeric types so it needs a string conversion, and <a href="https://github.com/dotnet/corefx/issues/39473#issuecomment-511513328">the reasoning</a> by the team on why this isn't built-in makes sense. The converter code is right there so you copy/paste if you need it, but I guess they can add some default converters for <code>long</code> and <code>double</code> in the package.</p>
<p>What other problems are you having? You don't have to use System.Text.Json if you need more flexibility, <a href="https://docs.microsoft.com/en-us/aspnet/core/migration/22-to-30?view=aspnetcore-3.0&amp;tabs=visual-studio#jsonnet-support" rel="nofollow">Json.NET is still available and easily enabled</a>.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNTU4MDU4MQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNTU4MDU4MQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyNTU4MDU4MQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/oleg-varlamov/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/oleg-varlamov"><img height="40" width="40" alt="@oleg-varlamov" src="https://avatars2.githubusercontent.com/u/18065206?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-525580581">
    <div>
      

  

<details data-body-version="8debd619a0c280b1b757281ed323deeb">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="8debd619a0c280b1b757281ed323deeb" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>We have a similar situation: we decided to move our project to .net core 3.0. and use the built-in System.Text.Json. We had to rewrite a small part of the functionality, but in general, the build was successful.<br>
However, in runtime we began to receive json parsing errors(not only from other services, but also from our own). We had to do a commit revert and return to Newtonsoft.Json.<br>
Of course, it is clear that it is necessary to correctly transfer all numeric values, without quotes. But our partners are unlikely to want to redo the already approved integration format.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNTc0NDU3MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNTc0NDU3MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyNTc0NDU3MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/stephentoub/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/stephentoub"><img height="40" width="40" alt="@stephentoub" src="https://avatars2.githubusercontent.com/u/2642209?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-525744570">
    <div>
      

  

<details data-body-version="5950ae0b597cfbfe82a7efdc34b58a18">
    <summary>
      <div>
        <h3>
              This comment was marked as off-topic.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="5950ae0b597cfbfe82a7efdc34b58a18" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>MS Project Manager has wasted million dollars to develop a technical debt. As a share holder I will send complain about him to the MS board. It should help him to listen.</p>
</blockquote>
<p>You are welcome to send your feedback to whomever you please, of course.  I'll look forward to hearing their response to you.</p>
<p>Please also keep in mind that trying to threaten folks here is against our code of conduct.  Folks here are actively listening to feedback and engaging and trying to make a better library for everyone, but conduct such as yours will only serve for them to start ignoring you.</p>
<p>Thank you.</p>
<p>cc: <a data-hovercard-type="user" data-hovercard-url="/users/terrajobst/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/terrajobst">@terrajobst</a></p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNTk0Mzk0Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNTk0Mzk0Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyNTk0Mzk0Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/terrajobst/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/terrajobst"><img height="40" width="40" alt="@terrajobst" src="https://avatars0.githubusercontent.com/u/5169960?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-525943943">
    <div>
      

  

<details data-body-version="1f097a0030a540a4aa82f33745591ec9">
    <summary>
      <div>
        <h3>
              This comment was marked as off-topic.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="1f097a0030a540a4aa82f33745591ec9" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/AlexPaskhin/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/AlexPaskhin">@AlexPaskhin</a></p>
<p>Designs are often trade-off decisions, which means making the product better for someone might make it worse for someone else. Implying that this means we don't care or are not good at our job is missing the point.</p>
<p>We appreciate passion and dissenting views, especially when they help us finding bugs and holes in the design. However, we don't appreciate non-constructive feedback, such as your last responses. Implying we don't do our job or directly threatening us isn't acceptable behavior and against our Code of Conduct. Please keep this in mind when engaging with us or we're forced to block you because it's distracting us from delivering quality by engaging in constructive discourse with our community, which is indeed our job.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNjA4MDQ3NQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNjA4MDQ3NQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyNjA4MDQ3NQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/AlexPaskhin/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/AlexPaskhin"><img height="40" width="40" alt="@AlexPaskhin" src="https://avatars0.githubusercontent.com/u/32801314?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-526080475">
    <div>
      

  

<details data-body-version="5b1d6bd699e5c0485cacb6d422044fb4">
    <summary>
      <div>
        <h3>
              This comment was marked as off-topic.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="5b1d6bd699e5c0485cacb6d422044fb4" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/terrajobst/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/terrajobst">@terrajobst</a><br>
I’ve removed all comments in these thread as it is useless, you like/happy with things that already done.<br>
I wish you luck with design trade-off. I wish that your version of “JSON (JavaScript Object Notation) is a lightweight data-interchange format. It is easy for humans to read and write. It is easy for machines to parse and generate.”<br>
I wish that System.Text.JSON would have a wide success with other teams, with your JSON/CSON (CSharp Object Notation) design trade off.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNjI0NTYwNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyNjI0NTYwNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyNjI0NTYwNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/steveharter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/steveharter"><img height="40" width="40" alt="@steveharter" src="https://avatars3.githubusercontent.com/u/6986755?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-526245607">
    <div>
      

  

<details data-body-version="3a994ae3f87d4b6ef90e0082943a5abd">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="3a994ae3f87d4b6ef90e0082943a5abd" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>For 5.0 we can consider an option to support "looser" deserialization modes depending on how common these scenarios are, and whether we can agree on common semantics.</p>
<p>However I believe all such modes can be supported today by using custom converters and by extending <code>JsonConverterAttribute</code> so that specific properties can be targeted (instead of all properties). For some cases it may be that there is no common consensus for the semantics so leaving it as-is and requiring the use of custom converters and custom attributes is the best solution. Perhaps doc and examples for common scenarios works too, or the community creates extensions for common scenarios.</p>
<p>A 5.0 feature could be to add a <code>options.DeserializeQuotedNumbers == true</code>. Then we need to determine if serializing as numbers is always desired, otherwise we'd need another option like <code>SerializeNumbersAsQuoted</code> (perhaps a flags enum would be easier to extend instead of separate option properties). There are subtleties here like do we account for culture settings? We'd also need a new attribute so that specific properties can be targeted instead of all through the global option.</p>
<p>Similarly, there has been feedback on what primitive types to deserialize when the property is a <code>System.Object</code>. Today that is <code>JsonElement</code>.  The requests have been to deserialize <a href="https://github.com/dotnet/corefx/issues/38713">true\false</a> as <code>System.Bool</code>, <a href="https://github.com/dotnet/corefx/issues/38713">numbers</a> as <code>System.Double</code> and strings as <code>System.String</code> instead of <code>JsonElement</code>.</p>
<p>Adding additional option(s) for this is also possible, however there are subtleties: precision can be lost (e.g. <code>System.Double</code> has less precision than <code>System.Decimal</code> -- what is the intent?) and when the JSON values belong to an object being deserialized into <code>System.Object</code>, the deserializer would still need to deserialize the object and all of its properties as <code>JsonElement</code> since it doesn't know what type to create and deserialize into (without getting into polymorphic deserialization, which is a separate feature).</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDE1OlJlZmVyZW5jZWRFdmVudDI2ODkxNTc2ODA=">
  
        <div>
  <div id="ref-commit-9a577d5">
    
  <p><a data-hovercard-type="user" data-hovercard-url="/users/ArgoZhang/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ArgoZhang">ArgoZhang</a> 

      referenced
      this issue
        in ArgoZhang/BootstrapAdmin

    </p><a href="#ref-commit-9a577d5">
      <relative-time datetime="2019-10-05T07:57:28Z" title="Oct 5, 2019, 12:57 AM PDT">on Oct 5, 2019</relative-time>
    </a>
    <div>
      

<div data-channel="repo:150215696:commit:9a577d5eb36eb1d0a7ab1013d1d8ffeea6bf8f74" data-url="/ArgoZhang/BootstrapAdmin/commit/9a577d5eb36eb1d0a7ab1013d1d8ffeea6bf8f74/_render_node/commit/condensed">
  <div>
      
<div>
  <p><a data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/ArgoZhang/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ArgoZhang">
          <img height="20" width="20" alt="@ArgoZhang" src="https://avatars3.githubusercontent.com/u/22001478?s=60&amp;v=4">
</a>  </p>
</div>


    

    <div>
      
    <details>
        <summary title="Commit signature">
          Unverified
        </summary>
        <div>
          <div>
            <div>
              
              <p>
                The committer email address is not verified.
              </p>
            </div>
            
          </div>
        </div>
    </details>

    </div>

    

    
  </div>
    
</div>


    </div>
  </div>
</div>



</div>

  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTIyMzUyOA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTIyMzUyOA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU1MTIyMzUyOA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/ericstj/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ericstj"><img height="40" width="40" alt="@ericstj" src="https://avatars2.githubusercontent.com/u/8918108?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-551223528">
    <div>
      

  

<details data-body-version="e62e8a837f1687c8756c71a45c5dc397">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="e62e8a837f1687c8756c71a45c5dc397" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>From <a data-hovercard-type="user" data-hovercard-url="/users/dansiegel/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dansiegel">@dansiegel</a> in dotnet/corefx#42396</p>
<blockquote>
<p>There should either be a built in JsonConverter that can handle this, a Serialization option to allow handling this, or it should just be smart enough to try to convert from string to any given numeric type.</p>
</blockquote>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTk3MTkwMg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTk3MTkwMg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU1MTk3MTkwMg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/Going-Gone/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/Going-Gone"><img height="40" width="40" alt="@Going-Gone" src="https://avatars3.githubusercontent.com/u/28640954?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-551971902">
    <div>
      

  

<details data-body-version="b89f211b8ea7095d599fb97fa2b498a2">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="b89f211b8ea7095d599fb97fa2b498a2" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Maybe i'm mistaken, but we shouldn't have to have a custom converter.<br>
Is it possible to mimic what the JsonConvert class does? This would eliminate the burden of migrating to this api, and would be a big QOL improvement. It also would make more sense for people to migrate then.</p>
<p>Int32<br>
Int64<br>
DateTime formats</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTk4Nzc1NA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTk4Nzc1NA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU1MTk4Nzc1NA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/dansiegel/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dansiegel"><img height="40" width="40" alt="@dansiegel" src="https://avatars1.githubusercontent.com/u/3860573?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-551987754">
    <div>
      

  

<details data-body-version="b5a28510f35673df6aa0881160aded5d">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="b5a28510f35673df6aa0881160aded5d" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>I would hate to think I would have to decorate all of my properties to handle this. Really the built in converter should be smart enough to try to parse the string to the given numeric type.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTk5MDI1Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MTk5MDI1Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU1MTk5MDI1Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/bartonjs/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bartonjs"><img height="40" width="40" alt="@bartonjs" src="https://avatars1.githubusercontent.com/u/10642668?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-551990253">
    <div>
      

  

<details data-body-version="18f69801917634f86389d12f54d56626">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="18f69801917634f86389d12f54d56626" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>Really the built in converter should be smart enough to try to parse the string to the given numeric type.</p>
</blockquote>
<p>So long as it's an option.  I definitely don't want it coercing values in my payloads.  If I said I want a number, thou shalt not send me a string.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MjExMzk5MQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1MjExMzk5MQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU1MjExMzk5MQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/AlexPaskhin/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/AlexPaskhin"><img height="40" width="40" alt="@AlexPaskhin" src="https://avatars0.githubusercontent.com/u/32801314?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-552113991">
    <div>
      

  

<details data-body-version="86c165dfb9f46bd2cc42a08f83b3fd5a">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="86c165dfb9f46bd2cc42a08f83b3fd5a" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Just don’t forget that JSON (JavaScript Object Notation) is a lightweight data-interchange format.  So, JavaScript doesn’t have types. So, If you are going  to communicate with “JavaScript” services, Angular, React, TypeScript, Java  (currently ~99%) you have to use Newtonsoft json. Unfortunately System.Text.Json doesn’t like   “JavaScript” typeless word , cannot find proper type mapping, … and throws exceptions. Unfortunately, it was not developed the “JavaScript” version of System.Text.Json,  therefor you can use it (System.Text.Json) in communication only (System.Text.Json)  &lt;-&gt; (System.Text.Json) only.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1OTU5MjY4OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU1OTU5MjY4OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU1OTU5MjY4OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/leftmostlane/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/leftmostlane"><img height="40" width="40" alt="@leftmostlane" src="https://avatars0.githubusercontent.com/u/27023771?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-559592688">
    <div>
      

  

<details data-body-version="d42c0e7d34b52665338967103ba5eeb0">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="d42c0e7d34b52665338967103ba5eeb0" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Please add this option<br>
<strong>options.DeserializeQuotedNumbers == true</strong><br>
and allow it to deserialize to <strong>decimal</strong> type.<br>
"mynum":"0.82" -&gt; decimal type.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMDU3Nw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMDU3Nw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU2NDgwMDU3Nw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/layomia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/layomia"><img height="40" width="40" alt="@layomia" src="https://avatars2.githubusercontent.com/u/9868994?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-564800577">
    <div>
      

  

<details data-body-version="066c0638b56229b9d23798cfcbd375f4">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="066c0638b56229b9d23798cfcbd375f4" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>From <a data-hovercard-type="user" data-hovercard-url="/users/IgorMenshikov/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/IgorMenshikov">@IgorMenshikov</a> in <a data-error-text="Failed to load issue title" data-id="535616784" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/runtime/issues/725" data-hovercard-type="issue" data-hovercard-url="/dotnet/runtime/issues/725/hovercard" href="https://github.com/dotnet/runtime/issues/725">#725</a></p>
<blockquote>
<p>I am migrating to .NET Core 3.1 and have a class with null-able values (decimal, DateTime) and want deserialize JSON to it. I received JSON from a client with property values as strings. Here is the sample code:</p>
<pre><code>public class Range
{
    public decimal? Start { get; set; }
    public decimal? End { get; set; }
}

static void Main(string[] args)
{
    var json = "{\"Start\":\"1\",\"End\":\"2\"}";
    var jsonNumber = "{\"Start\": 1,\"End\": 2}";

    var j1 = Newtonsoft.Json.JsonConvert.DeserializeObject&lt;Range&gt;(json); // works fine
    j1.ToString();

    var jn = System.Text.Json.JsonSerializer.Deserialize&lt;Range&gt;(jsonNumber); // works fine
    jn.ToString();

    var js = System.Text.Json.JsonSerializer.Deserialize&lt;Range&gt;(json); // exception
    js.ToString();
}
</code></pre>
<p>This code throws an error:</p>
<p>'The JSON value could not be converted to System.Nullable`1[System.Decimal].</p>
<p>I have tried to use a workarounf at:<br>
<a href="https://github.com/dotnet/corefx/issues/41070#issuecomment-555395612">dotnet/corefx#41070 (comment)</a></p>
<p>but it does not help. Can something be some with that? Any workaround? Newtonsoft can handle that without problems.</p>
</blockquote>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMDg5MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMDg5MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU2NDgwMDg5MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/layomia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/layomia"><img height="40" width="40" alt="@layomia" src="https://avatars2.githubusercontent.com/u/9868994?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-564800890">
    <div>
      

  

<details data-body-version="00335e17197c20a719898ce0067e593d">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMzI2OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMzI2OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU2NDgwMzI2OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/layomia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/layomia"><img height="40" width="40" alt="@layomia" src="https://avatars2.githubusercontent.com/u/9868994?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-564803268">
    <div>
      

  

<details data-body-version="f9f78a5f05d93876a7a90e4c3a8c3705">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="f9f78a5f05d93876a7a90e4c3a8c3705" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Per <a href="https://github.com/dotnet/corefx/issues/41442">https://github.com/dotnet/corefx/issues/41442</a>, this issue should consider the deserialization of <code>"Infinity"</code>, <code>"-Infinity"</code> and <code>"NaN"</code> into <code>double</code> types (<code>double.PositiveInfinity</code>, <code>double.NegativeInfinity</code>, <code>double.NaN</code>), and vice-versa.</p>
<p>From <a data-hovercard-type="user" data-hovercard-url="/users/pranavkm/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/pranavkm">@pranavkm</a> in <a href="https://github.com/dotnet/corefx/issues/41442">https://github.com/dotnet/corefx/issues/41442</a>:</p>
<blockquote>
<p><em>From <a data-hovercard-type="user" data-hovercard-url="/users/valeriob/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/valeriob">@valeriob</a> on Monday, September 30, 2019 12:49:01 PM</em></p>
<p>Hi,<br>
we are upgrading some applications to aspnetcore 3.0, we have been bitten by something unexpected : System.Text.Json refuse to serialize double.NaN values.<br>
This cause really nasty bugs because something that works suddenly does not because some result of some calculation is different, or some data changes in some way.<br>
I see that the recommendation (<a href="https://docs.microsoft.com/en-us/aspnet/core/migration/22-to-30?view=aspnetcore-3.0&amp;tabs=visual-studio#jsonnet-support" rel="nofollow">https://docs.microsoft.com/en-us/aspnet/core/migration/22-to-30?view=aspnetcore-3.0&amp;tabs=visual-studio#jsonnet-support</a>) is to use Json.Net.</p>
<p>But how can ppl use this library if such a simple and common use case is not covered ?<br>
I do not know any application that can live without this feature, i understand the fact that there is a specification, but it may very well be unpractical.<br>
<a href="https://thefactotum.xyz/post/the-devil-is-in-the-json-details/" rel="nofollow">https://thefactotum.xyz/post/the-devil-is-in-the-json-details/</a><br>
Python, Go, Javascript,Rust, Ruby handle it without making much fuss <g-emoji alias="smile" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png">😄</g-emoji></p>
<p>Thanks<br>
Valerio</p>
<p><em>Copied from original issue: <a href="https://github.com/aspnet/AspNetCore/issues/14571" data-hovercard-type="issue" data-hovercard-url="/dotnet/aspnetcore/issues/14571/hovercard">aspnet/AspNetCore#14571</a></em></p>
</blockquote>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMzgwNg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwMzgwNg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU2NDgwMzgwNg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/layomia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/layomia"><img height="40" width="40" alt="@layomia" src="https://avatars2.githubusercontent.com/u/9868994?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-564803806">
    <div>
      

  

<details data-body-version="2645097f425d3abe3b1127916d04b32b">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="2645097f425d3abe3b1127916d04b32b" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Renaming this issue to explicitly mark that serialization of quoted numbers is being considered here as well, per <a data-hovercard-type="user" data-hovercard-url="/users/steveharter/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/steveharter">@steveharter</a>'s comment above:</p>
<blockquote>
<p>A 5.0 feature could be to add a options.DeserializeQuotedNumbers == true. Then we need to determine if serializing as numbers is always desired, otherwise we'd need another option like SerializeNumbersAsQuoted (perhaps a flags enum would be easier to extend instead of separate option properties). There are subtleties here like do we account for culture settings? We'd also need a new attribute so that specific properties can be targeted instead of all through the global option.</p>
</blockquote>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDE3OlJlbmFtZWRUaXRsZUV2ZW50Mjg3NjI5NDkzMw==">
  
        <div data-team-hovercards-enabled="" id="event-2876294933">
  
  <div>

    

        <p><a data-hovercard-type="user" data-hovercard-url="/users/layomia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/layomia"><img height="20" width="20" alt="@layomia" src="https://avatars3.githubusercontent.com/u/9868994?s=60&amp;v=4"></a>
  <a data-hovercard-type="user" data-hovercard-url="/users/layomia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/layomia">layomia</a>
  


      
changed the title
<del>System.Text.Json: Deserialization support for quoted numbers </del>

<ins>System.Text.Json: (De)serialization support for quoted numbers </ins></p><a href="#event-2876294933"><relative-time datetime="2019-12-12T01:09:00Z" title="Dec 11, 2019, 5:09 PM PST">on Dec 11, 2019</relative-time></a>

  </div>
</div>




</div>

  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwNTk4MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2NDgwNTk4MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU2NDgwNTk4MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/layomia/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/layomia"><img height="40" width="40" alt="@layomia" src="https://avatars2.githubusercontent.com/u/9868994?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-564805980">
    <div>
      

  

<details data-body-version="228a96ef08caf015f8091d7dbed717fd">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2ODkzNTMxNg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU2ODkzNTMxNg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU2ODkzNTMxNg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/danchaseCTS/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/danchaseCTS"><img height="40" width="40" alt="@danchaseCTS" src="https://avatars2.githubusercontent.com/u/43733923?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-568935316">
    <div>
      

  

<details data-body-version="59f61440b017ee019631f21425934dd8">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="59f61440b017ee019631f21425934dd8" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Isn't JSON a spec? I see a lot of requests that are app specific, that would be solved simply by having the app specify the value properly.</p>
<p>For example, Angular wants to put something like:<br>
Amount: "15.50"<br>
unless you make the input type="number", in which it will now put:<br>
Amount: 15.50</p>
<p>As soon as you start converting things you will experience feature bloat and bugs like no other, actually creating pain instead of helping future roadmaps for any apps that use the library. JSON isn't meant to be a text processor.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  




    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDU3NzUwNjQyOQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDU3NzUwNjQyOQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDU3NzUwNjQyOQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/casz/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/casz"><img height="40" width="40" alt="@casz" src="https://avatars3.githubusercontent.com/u/1661688?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-577506429">
    <div>
      

  

<details data-body-version="155de1611d2bcf6527c572107d776472">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="155de1611d2bcf6527c572107d776472" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>I would say it is kind of unexpected that a object like <a href="https://github.com/GitTools/GitVersion/blob/4b5d7153b576c639d428b4f6c58fa10bae1acd6b/src/GitVersionCore/OutputVariables/VersionVariables.cs">VersionVariables.cs</a> needs a <code>JsonConverter&lt;string&gt;</code> to convert numbers into <code>string</code></p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  





<!-- Rendered timeline since 2020-01-31 19:23:19 -->



            </div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>