<!DOCTYPE html>
<html lang="en">
<head>
    <title>
ASP.NET Blog | Setting HTTP header attributes to enable Azure authentication/authorization using HTTPRepl -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>ASP.NET Blog | Setting HTTP header attributes to enable Azure authentication/authorization using HTTPRepl</h1><div><div class="entry-content col-12 sharepostcontent"><div class="row justify-content-center"><div class="col-md-4"><div><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/02/Angelos-Petropoulos-150x150.jpeg" width="58" height="58" alt="Angelos Petropoulos" class="avatar avatar-58 wp-user-avatar wp-user-avatar-58 alignnone photo"><p>Angelos</p></div></div></div><p>September 23rd, 2019</p><h5>Posted on behalf of Ahmed Metwally</h5><p>
  The HTTP Read-Eval-Print Loop (REPL) is a lightweight, cross-platform command-line tool that’s supported everywhere .NET Core is supported. It’s used for making HTTP requests to test ASP.NET Core web APIs and view their results. You can use the HTTPRepl to navigate and interrogate any API in the same manner that you would navigate a set of folders on a file system. If the service that you are testing has a <em>swagger.json</em> file, specifying that file to HTTPRepl will enable auto-completion.
</p><p>
  To install the HTTP REPL, run the following command:
</p><pre><code>&gt;dotnet tool install -g Microsoft.dotnet-httprepl
</code></pre><p><br>For more information on how to use HTTPRepl, read Angelos’ post on the ASP.NET blog. As we continue to improve the tool, we look to add new commands to facilitate the use of HTTPRepl with different types of secure API services. As of this release, HTTPRepl supports authentication and authorization schemes achievable through header manipulation, like basic, bearer token, and digest authentication. For example, to use a bearer token to authenticate to a service, use the command “set header”. Set the “Authorization” header to the bearer token value using the following command:
</p><pre><code>&gt;set header Authorization “bearer &lt;token_value&gt;”
</code></pre><p><br>And replace <em>&lt;token_value&gt;</em> with your authorization bearer token for the service. Don’t forget to use the quotation marks to wrap the word <em>bearer</em> along with the <em>&lt;token_value&gt;</em> in the same literal string. Otherwise, the tool will treat them as two different values and will fail to set the header properly. To ensure that the header in the HTTP request is being formatted as expected, enable echoing using the “echo on” command.
</p><p>
  Using the “set header” command, you can leverage HTTPRepl to test and navigate any secure REST API service including your Azure-hosted API services or the Azure Management API. To access a secure service hosted on Azure, you need a bearer token. Get a bearer token for your Azure subscription, <a href="https://docs.microsoft.com/cli/azure/authenticate-azure-cli?view=azure-cli-latest">using the Azure CLI to get an access token for the required Azure subscription</a>:
</p><pre><code>&gt;az login
</code></pre><p><br>Copy your subscription ID from the <a href="https://portal.azure.com">Azure portal</a> and paste it in the “az account set” command:
</p><pre><code>&gt;az account set --subscription "&lt;subscription ID&gt;" 

&gt;az account get-access-token 

{ 
  "accessToken": "&lt;access_token_will_be_displayed_here&gt;", 
  "expiresOn": "&lt;expiry date/time will be displayed here&gt;", 
  "subscription": "&lt;subscription ID&gt;", 
  "tenant": "&lt;tenant ID&gt;", 
  "tokenType": "Bearer" 
} 
</code></pre><p><br>Copy the text that appears in place of <strong>&lt;access_token_will_be_displayed_here&gt;.</strong> This is your access token. Finally, run HTTPRepl:
</p><pre><code>&gt;httprepl
(disconnected)~ connect https://management.azure.com
Using a base address of https://management.azure.com/
Unable to find a swagger definition
https://management.azure.com/~ set header Authorization "bearer &lt;em&gt;&amp;lt;paste_token_here&amp;gt;&lt;/em&gt;"
https://management.azure.com/~ cd subscriptions
https://management.azure.com/subscriptions/~ cd &lt;subscription_ID&gt;
</code></pre><p><br>For example, to search for a <a href="https://docs.microsoft.com/rest/api/appservice/WebApps/List">list of your Azure app services</a>, issue the “get” command for the list of sites through the Microsoft web provider:
</p><pre><code>  https://management.azure.com/subscriptions/&lt;subscription_ID&gt;/~ get providers/Microsoft.Web/sites?api-version=2016-08-01
  HTTP/1.1 200 OK
  Cache-Control: no-cache
  Content-Length: 35948
  Content-Type: application/json; charset=utf-8
  Date: Thu, 19 Sep 2019 23:04:03 GMT
  Expires: -1
  Pragma: no-cache
  Strict-Transport-Security: max-age=31536000; includeSubDomains
  X-Content-Type-Options: nosniff
  x-ms-correlation-request-id: &lt;em&gt;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&lt;/em&gt;
  x-ms-original-request-ids: &lt;em&gt;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&lt;/em&gt;
  x-ms-ratelimit-remaining-subscription-reads: 11999
  x-ms-request-id: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
  x-ms-routing-request-id: WESTUS:xxxxxxxxxxxxxxxx:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx
  {
    "value": [
&lt;list of azure resources&gt;
    ]
  }
  https://management.azure.com/subscriptions/&lt;subscription_ID&gt;/~
</code></pre><p>
  You can use the full list of Azure REST APIs to browse and manage services in your Azure subscriptions. For more details on how HTTPRepl works, please check the ASPNET blog. To use HTTPRepl, download and install the global tool from the .NET Core CLI.
</p><p>
  It’s not HTTPie, it’s not Curl, but it’s also not PostMan. It’s something that you run and stays running and its aware of its current context. We find this experience valuable, but ultimately what matters the most is what you think. Please let us know your opinion by leaving comments below or on <a href="https://github.com/aspnet/HttpRepl">GitHub</a>.
</p><hr><p>
  Ahmed Metwally, Sr. Program Manager, .NET dev tools <a href="https://twitter.com/AhmedMsft">@ahmedMsft</a>Ahmed is a Program Manager on the .NET tooling team focused on improving web development for .NET developers.</p><div class="authorinfoarea"><div><p>Product Manager,&nbsp;on the .NET team</p><p><strong>Follow Angelos</strong>&nbsp;&nbsp;&nbsp;<a class="no-underline stayinformed" aria-label="Angelos Petropoulos GitHub profile" target="_blank" href="https://github.com/angelosp"><i class="fa fa-github"></i></a><a class="no-underline stayinformed hvr-pop" aria-label="Angelos Petropoulos RSS Feed" target="_blank" href="https://devblogs.microsoft.com/aspnet/author/angelos-petropoulosoutlook-com/feed/"></a></p></div></div></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>