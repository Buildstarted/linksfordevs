<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Continuous Speech Recognition in .NET Core WPF applications - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Continuous Speech Recognition in .NET Core WPF applications - linksfor.dev(s)"/>
    <meta property="og:description" content="In the last article we talked about how to integrate Speech Recognition in .NET Core WPF applications with the Cognitive Services Speech SDK. In that occasion, we shown how to use the RecognizeOnce&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://marcominerva.wordpress.com/2020/08/06/continuous-speech-recognition-in-net-core-wpf-applications/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Continuous Speech Recognition in .NET Core WPF applications</title>
<div class="readable">
        <h1>Continuous Speech Recognition in .NET Core WPF applications</h1>
            <div>Reading time: 3-4 minutes</div>
        <div>Posted here: 12 Aug 2020</div>
        <p><a href="https://marcominerva.wordpress.com/2020/08/06/continuous-speech-recognition-in-net-core-wpf-applications/">https://marcominerva.wordpress.com/2020/08/06/continuous-speech-recognition-in-net-core-wpf-applications/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><p><a title="Go to homepage" href="https://marcominerva.wordpress.com/">Home</a>
		 &gt; <a href="https://marcominerva.wordpress.com/category/net/" rel="category tag">.NET</a>, <a href="https://marcominerva.wordpress.com/category/net-core/" rel="category tag">.NET Core</a>, <a href="https://marcominerva.wordpress.com/category/c/" rel="category tag">C#</a>, <a href="https://marcominerva.wordpress.com/category/wpf/" rel="category tag">WPF</a>		 &gt; Continuous Speech Recognition in .NET Core WPF&nbsp;applications	</p><div id="post-2680">
		<h2>Continuous Speech Recognition in .NET Core WPF&nbsp;applications</h2>
		
		<div>
			<p data-adtags-visited="true">In the last article we talked about how to <a href="https://marcominerva.wordpress.com/2020/07/31/integrating-cognitive-service-speech-recognition-in-net-core-wpf-applications/" rel="noopener" target="_blank">integrate Speech Recognition in .NET Core WPF applications with the Cognitive Services Speech SDK</a>. In that occasion, we shown how to use the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer.recognizeonceasync" rel="noopener" target="_blank">RecognizeOnceAsync</a> method to recognize a single utterance. But the Speech SDK supports also continuous recognition, so today weâ€™ll see how to leverage this feature.</p>
<p data-adtags-visited="true">Basically, instead of <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer.recognizeonceasync" rel="noopener" target="_blank">RecognizeOnceAsync</a>, we need to use <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer.startcontinuousrecognitionasync" rel="noopener" target="_blank">StartContinuousRecognitionAsync</a> method and subscribe to the appropriate events.</p>
<p data-adtags-visited="true">Starting from the previous sample, as usual we have to define some constants and a reference to a <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer" rel="noopener" target="_blank">SpeechRecognizer</a> object:</p>
<div><div id="highlighter_278540"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p></td><td><div><p><code>private</code> <code>const</code> <code>string</code> <code>SpeechSubscriptionKey = </code><code>""</code><code>;</code></p><p><code>private</code> <code>const</code> <code>string</code> <code>SpeechRegion = </code><code>""</code><code>;</code></p><p><code>private</code> <code>const</code> <code>string</code> <code>Culture = </code><code>""</code><code>;</code></p><p><code>private</code> <code>readonly</code> <code>SpeechRecognizer speechRecognizer;</code></p><p><code>private</code> <code>bool</code> <code>isRecognizing;</code></p></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Then, in the constructor of the Window we can initialize the recognizer:</p>
<div><div id="highlighter_614764"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p></td><td><div><p><code>public</code> <code>MainWindow()</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>InitializeComponent();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var</code> <code>config = SpeechConfig.FromSubscription</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(SpeechSubscriptionKey, SpeechRegion);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>speechRecognizer = </code><code>new</code> <code>SpeechRecognizer(config, Culture);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>speechRecognizer.Recognized += SpeechRecognizer_Recognized;</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">At line 9 we register to the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer.recognized" rel="noopener" target="_blank">RecognizedEvent</a> evebt, that is raised every time a final recognition result is received:</p>
<div><div id="highlighter_76624"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p></td><td><div><p><code>private</code> <code>async</code> <code>void</code> <code>SpeechRecognizer_Recognized(</code><code>object</code> <code>sender, </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>SpeechRecognitionEventArgs e)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(e.Result.Reason == ResultReason.RecognizedSpeech)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>await</code> <code>Dispatcher.InvokeAsync(() =&gt;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>RecognitionTextBox.Text += $</code><code>"{e.Result.Text} "</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">If the recognition succeeds (line 4), we use the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.threading.dispatcher.invokeasync" rel="noopener" target="_blank">Dispatcher</a> (line 6, because recognition is performed in a background task) to add the recognized text to the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.controls.textbox" rel="noopener" target="_blank">TextBox</a>.</p>
<p data-adtags-visited="true">Now we only need to start and stop recognition when the user press the corresponding button:</p>
<div><div id="highlighter_497859"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p></td><td><div><p><code>private</code> <code>async</code> <code>void</code> <code>RecognitionButton_Click(</code><code>object</code> <code>sender, RoutedEventArgs e)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(!isRecognizing)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var</code> <code>isMicAvailable = </code><code>await</code> <code>CheckEnableMicrophoneAsync();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(!isMicAvailable)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>return</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>await</code> <code>speechRecognizer.StartContinuousRecognitionAsync();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>RecognitionTextBox.Text = </code><code>string</code><code>.Empty;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>isRecognizing = </code><code>true</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>RecognitionButton.Content = </code><code>"Stop Recognition"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>else</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>await</code> <code>speechRecognizer.StopContinuousRecognitionAsync();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>isRecognizing = </code><code>false</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>RecognitionButton.Content = </code><code>"Start Recognition"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">The <strong>CheckEnableMicrophoneAsync</strong> method is the same you can find in the <a href="https://marcominerva.wordpress.com/2020/07/31/integrating-cognitive-service-speech-recognition-in-net-core-wpf-applications/" rel="noopener" target="_blank">previous article</a>. After we call the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer.startcontinuousrecognitionasync" rel="noopener" target="_blank">StartContinuousRecognitionAsync</a> method at lines 11, the SDK begins to raise the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer.recognized" rel="noopener" target="_blank">RecognizedEvent</a> event for each recognized utterance. To stop this behavior, we need to invoke the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.cognitiveservices.speech.speechrecognizer.stopcontinuousrecognitionasync" rel="noopener" target="_blank">StopContinuousRecognitionAsync</a> (lines 19).</p>
<p data-adtags-visited="true">So, here it is our application running:</p>
<div data-shortcode="caption" id="attachment_2696"><p><a href="https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png"><img loading="lazy" aria-describedby="caption-attachment-2696" data-attachment-id="2696" data-permalink="https://marcominerva.wordpress.com/2020/08/06/continuous-speech-recognition-in-net-core-wpf-applications/wpfcontinuousrecognitionapprunning/" data-orig-file="https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png" data-orig-size="625,287" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="The WPF Continuous Recognition App" data-image-description="<p>The WPF Continuous Recognition App</p>
" data-medium-file="https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png?w=300" data-large-file="https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png?w=595" src="https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png?w=595&amp;h=273" alt="The WPF Continuous Recognition App" width="595" height="273" srcset="https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png?w=595&amp;h=273 595w, https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png?w=150&amp;h=69 150w, https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png?w=300&amp;h=138 300w, https://marcominerva.files.wordpress.com/2020/08/wpfcontinuousrecognitionapprunning.png 625w" sizes="(max-width: 595px) 100vw, 595px"></a></p><p id="caption-attachment-2696">The WPF Continuous Recognition App</p></div>
<p data-adtags-visited="true">You can download the sample app using the link below:</p>
<p data-adtags-visited="true"><a href="https://1drv.ms/u/s!Aj5GOysOGfFKmP8a8lTe4HEYq2KN3w?e=mv1czW" target="_blank" rel="noopener"><img title="Continuous Speech Recognition in .NET Core WPF applications" src="https://marcominerva.files.wordpress.com/2013/03/zip.png?w=68&amp;h=68" alt="Continuous Speech Recognition in .NET Core WPF applications" width="68" height="68"></a></p>
			
			
									
		</div>
		
		
	</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>