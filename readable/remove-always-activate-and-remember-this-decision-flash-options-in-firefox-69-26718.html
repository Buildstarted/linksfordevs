<!DOCTYPE html>
<html lang="en">
<head>
    <title>linksfor.dev(s)</title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">🎉</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <div class="readable">
        <h1>1519434 - Remove &quot;Always Activate&quot; and &quot;Remember this decision&quot; Flash options in Firefox 69</h1>
        <p>
by :Gijs (he/him) <br/>Reading time: 11-14 minutes        </p>
        <p><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1519434">https://bugzilla.mozilla.org/show_bug.cgi?id=1519434</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="bugzilla-body" tabindex="-1">
<div id="main-inner">










<section>
  
</section>


<section id="module-categories">
    
  
</section>


<section id="module-tracking">
    
  
</section>



<section id="module-people">
    
  
</section>


<section id="module-references">
    
  
</section>


<section id="module-details">
    
  
</section>
















<section id="module-attachments">
    
  <div id="module-attachments-content"><table role="table" id="attachments">
    <tbody><tr>
      <td>
        <div>
            <p><a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070657">Bug 1519434 - remove plugin click to play pref as running without it won't make sense anymore, r?aswan</a>
        </p></div>
        <div>
            <p><a href="#c9"><span title="2019-06-07 11:16 PDT" data-time="1559931398">1 year ago</span></a>
          
        </p></div>
        <p>47 bytes,
          text/x-phabricator-request        </p>
      </td>
      <td>
      </td>
      <td>
        <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070657&amp;action=edit">Details</a>  |
  <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070657">Review</a>
    </td></tr>
    <tr>
      <td>
        <div>
            <p><a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070658">Bug 1519434 - only allow perma-enabling non-flash plugins, r?jmathies!,aswan!</a>
        </p></div>
        <div>
            <p><a href="#c10"><span title="2019-06-07 11:17 PDT" data-time="1559931422">1 year ago</span></a>
          <span><div><p><a href="https://bugzilla.mozilla.org/user_profile?user_id=159069"> <span>:Gijs (he/him)</span></a>
</p></div></span>
        </p></div>
        <p>47 bytes,
          text/x-phabricator-request        </p>
      </td>
      <td>
      </td>
      <td>
        <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070658&amp;action=edit">Details</a>  |
  <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070658">Review</a>
    </td></tr>
    <tr>
      <td>
        <div>
            <p><a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070660">Bug 1519434 - make nsPluginTag and the addon manager agree about what is and isn't flash, r?jmathies!,aswan!</a>
        </p></div>
        <div>
            <p><a href="#c11"><span title="2019-06-07 11:17 PDT" data-time="1559931445">1 year ago</span></a>
          <span><div><p><a href="https://bugzilla.mozilla.org/user_profile?user_id=159069"> <span>:Gijs (he/him)</span></a>
</p></div></span>
        </p></div>
        <p>47 bytes,
          text/x-phabricator-request        </p>
      </td>
      <td>
      </td>
      <td>
        <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070660&amp;action=edit">Details</a>  |
  <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070660">Review</a>
    </td></tr>
    <tr>
      <td>
        <div>
            <p><a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070661">Bug 1519434 - remove 'always activate' and 'remember this decision' UI options, r?aswan</a>
        </p></div>
        <div>
            <p><a href="#c12"><span title="2019-06-07 11:17 PDT" data-time="1559931469">1 year ago</span></a>
          <span><div><p><a href="https://bugzilla.mozilla.org/user_profile?user_id=159069"> <span>:Gijs (he/him)</span></a>
</p></div></span>
        </p></div>
        <p>47 bytes,
          text/x-phabricator-request        </p>
      </td>
      <td>
      </td>
      <td>
        <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070661&amp;action=edit">Details</a>  |
  <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070661">Review</a>
    </td></tr>
    <tr>
      <td>
        <div>
            <p><a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070662">Bug 1519434 - make Flash 'always allow' enterprise policy mean 'ask', r?mkaply</a>
        </p></div>
        <div>
            <p><a href="#c13"><span title="2019-06-07 11:18 PDT" data-time="1559931493">1 year ago</span></a>
          <span><div><p><a href="https://bugzilla.mozilla.org/user_profile?user_id=159069"> <span>:Gijs (he/him)</span></a>
</p></div></span>
        </p></div>
        <p>47 bytes,
          text/x-phabricator-request        </p>
      </td>
      <td>
      </td>
      <td>
        <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070662&amp;action=edit">Details</a>  |
  <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070662">Review</a>
    </td></tr>
    <tr>
      <td>
        <div>
            <p><a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070663">Bug 1519434 - remove extant permanent flash permissions, r?johannh</a>
        </p></div>
        <div>
            <p><a href="#c14"><span title="2019-06-07 11:18 PDT" data-time="1559931516">1 year ago</span></a>
          <span><div><p><a href="https://bugzilla.mozilla.org/user_profile?user_id=159069"> <span>:Gijs (he/him)</span></a>
</p></div></span>
        </p></div>
        <p>47 bytes,
          text/x-phabricator-request        </p>
      </td>
      <td>
      </td>
      <td>
        <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070663&amp;action=edit">Details</a>  |
  <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070663">Review</a>
    </td></tr>
    <tr>
      <td>
        <div>
            <p><a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070664">Bug 1519434 - remove permissions popup and page info code catering to flash permissions, r?johannh</a>
        </p></div>
        <div>
            <p><a href="#c15"><span title="2019-06-07 11:19 PDT" data-time="1559931544">1 year ago</span></a>
          <span><div><p><a href="https://bugzilla.mozilla.org/user_profile?user_id=159069"> <span>:Gijs (he/him)</span></a>
</p></div></span>
        </p></div>
        <p>47 bytes,
          text/x-phabricator-request        </p>
      </td>
      <td>
      </td>
      <td>
        <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070664&amp;action=edit">Details</a>  |
  <a href="https://bugzilla.mozilla.org/attachment.cgi?id=9070664">Review</a>
    </td></tr>
</tbody></table>


  </div>
</section>







<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;74.0b3&quot;,&quot;FIREFOX_ESR&quot;:&quot;68.5.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;75.0a1&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2019-12-02&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2019-12-03&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2019-11-25&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;74.0b3&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;74.0b3&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;73.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2020-01-06&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2020-01-07&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2020-01-02&quot;}">



<div id="c0"><p>Per our Flash (plugin) deprecation roadmap, we'll disable Flash by default in Nightly 69 and let that roll out.</p></div><div id="a344295_279663"><div><p>Summary: Disable Flash support by default in Firefox 69 → [meta] Disable Flash support by default in Firefox 69</p><p>Whiteboard: meta</p></div></div><div id="c1"><div id="ct-1" data-comment-id="13974213" data-ismarkdown="true"><p>In Firefox 69, we will remove Firefox's:</p>
<ul>
<li>"Always Activate" Flash option in about:addons
<ul>
<li>If Flash's click-to-activate setting was previously "Always Activate" or "Ask to Activate", it should now be "Ask to Activate".</li>
<li>If Flash's click-to-activate setting was previously "Never Activate", it should still be "Never Activate". However, if this is difficult to implement, we can reset everyone's Flash click-to-activate setting to "Ask to Activate".</li>
</ul>
</li>
<li>"Remember this decision" from the Flash click-to-activate door hanger. We want prompt users every time a site wants to activate Flash in each browser session.
<ul>
<li><del>But we want Firefox 69+ to remember sites that the user had checked "Remember this decision" in earlier Firefox versions. (Firefox only remembers the door hanger decision for 90 days, so these remembered site permissions will all phase out over 90 days.)</del></li>
</ul>
</li>
</ul>
</div><div><p>Summary: [meta] Disable Flash support by default in Firefox 69 → Remove "Always Activate" and "Remember my decision" Flash options in Firefox 69</p><p>Whiteboard: <span>meta</span></p></div></div><div id="a4847122_430528"><div><p>Summary: Remove "Always Activate" and "Remember my decision" Flash options in Firefox 69 → Remove "Always Activate" and "Remember this decision" Flash options in Firefox 69</p></div></div><div id="a6386222_575867"><div><p>Component: General → Plug-ins</p><p>Product: Firefox → Core</p></div></div><div id="c2"><p>Priority P1 and 69=affected because we plan to fix this bug in Firefox 69.</p></div><div id="c3"><p>Somehow I volunteered to do this, so taking...</p><div><p>Assignee: nobody → gijskruitbosch+bugs</p><p>Status: NEW → ASSIGNED</p></div></div><div id="c4"><div id="ct-4" data-comment-id="14159617" data-ismarkdown="true"><p>Is there a broader plan for what we want here? Some questions that spring to mind (which perhaps are answered in such a doc somewhere):</p>
<ol start="0">
<li>I'm assuming we want to actually make this completely impossible, not just remove the UI and keep support for the internal "always run this plugin" state?</li>
<li>do we need a pref to turn off this restriction if we uncover too many issues?</li>
<li>we still have a flash_only pref that allows other plugins to be used - in this bug, do we just want to remove support for "always run" for all plugins?</li>
<li>can we remove support for the flash_only pref except when running automated tests (to reduce the testing/complexity matrix), or is that not possible at the moment?</li>
<li>do existing users get this change applied, and/or do we need to notify them in any way beyond relnotes?</li>
</ol>
</div><div><p>Flags: needinfo?(jmathies)</p><p>Flags: needinfo?(cpeterson)</p></div></div><div id="c5"><div id="ct-5" data-comment-id="14159821" data-ismarkdown="true"><p>(In reply to :Gijs (he/him) from <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1519434#c4" title="RESOLVED FIXED - Remove &quot;Always Activate&quot; and &quot;Remember this decision&quot; Flash options in Firefox 69">comment #4</a>)</p>
<blockquote>
<p>Is there a broader plan for what we want here? Some questions that spring to mind (which perhaps are answered in such a doc somewhere):</p>
</blockquote>
<p>No, but I'll create a doc that consolidates all these answers:</p>
<p><a href="https://docs.google.com/document/d/1U5uHskPkJIUkASwLI6uVdFl2s0MM6dfPzCAoT0Bftms/edit" rel="nofollow">https://docs.google.com/document/d/1U5uHskPkJIUkASwLI6uVdFl2s0MM6dfPzCAoT0Bftms/edit</a></p>
<blockquote>
<ol start="0">
<li>I'm assuming we want to actually make this completely impossible, not just remove the UI and keep support for the internal "always run this plugin" state?</li>
</ol>
</blockquote>
<p>Good question! I hadn't thought of that.</p>
<p>We had planned to just remove the UI to prevent setting new always-allow site permissions and then let users' existing always-allow site permissions quietly expire after 90 days. But we should probably remove Gecko's always-run Flash code (somewhere in dom/plugins/base) now so Firefox Nightly users can actually experience the always-ask Flash UX now. If there are Flash issues, we want to find them during Nightly testing, not 90 days from now. :) We'll also need to remove any Flash code in the Site Permissions UI.</p>
<p>However, we do <em>not</em> want to remove always-run support for the dummy NPAPI test plugin (used for our automated NPAPI tests), Widevine, or OpenH264! Widevine and OpenH264 are GMPs (Gecko Media Plugins), not NPAPI plugins, so they might use a different code path. Just something to watch for.</p>
<blockquote>
<ol>
<li>do we need a pref to turn off this restriction if we uncover too many issues?</li>
</ol>
</blockquote>
<p>I don't think we need a pref. Chrome has shipped a similar always-ask UX since September 2018, so there should not be any Flash sites that cause problems in Firefox but not Chrome:</p>
<p><a href="https://sites.google.com/a/chromium.org/dev/flash-roadmap#TOC-Non-Persisted-HTML5-by-Default-Target:-Chrome-69---September-2018-" rel="nofollow">https://sites.google.com/a/chromium.org/dev/flash-roadmap#TOC-Non-Persisted-HTML5-by-Default-Target:-Chrome-69---September-2018-</a></p>
<blockquote>
<ol start="2">
<li>we still have a flash_only pref that allows other plugins to be used - in this bug, do we just want to remove support for "always run" for all plugins?</li>
<li>can we remove support for the flash_only pref except when running automated tests (to reduce the testing/complexity matrix), or is that not possible at the moment?</li>
</ol>
</blockquote>
<p>Flash and the dummy NPAPI test plugin are the only NPAPI plugins we support. Widevine and OpenH264 are also "plugins" but we do not want to remove their always-allow support.</p>
<p>The flash_only pref should only be used for our automated NPAPI tests, so we can disable or remove the pref in non-test code paths, as long as disabling it doesn't affect Widevine or OpenH264.</p>
<blockquote>
<ol start="4">
<li>do existing users get this change applied, and/or do we need to notify them in any way beyond relnotes?</li>
</ol>
</blockquote>
<p>All users should get this change. We don't need to notify users.</p>
</div><div><p>Flags: <span>needinfo?(jmathies)</span></p><p>Flags: <span>needinfo?(cpeterson)</span></p></div></div><div id="c7"><div id="ct-7" data-comment-id="14162552" data-ismarkdown="true"><p>Johann, can you help me understand how this code:</p>
<p><a href="https://searchfox.org/mozilla-central/rev/153172de0c5bfca31ef861bd8fc0995f44cada6a/browser/modules/SitePermissions.jsm#940-943" rel="nofollow">https://searchfox.org/mozilla-central/rev/153172de0c5bfca31ef861bd8fc0995f44cada6a/browser/modules/SitePermissions.jsm#940-943</a></p>
<p>fits into the permissions page in the page info dialog, and whether I need to change something there? It looks to me like right now, allowing flash without ticking the 'remember' checkbox shows up as "allow", and this permission is simply gone (because it's a per-session permission) after a restart -- but some other permissions in the page info dialog have an "allow for session" option; does something need to change as part of this bug or not (or only to make it slightly more correct, but kind of orthogonal to this bug) ?</p>
<p>(TL;DR for this bug: we want to remove the ability to permanently/persistently allow flash to play, including all the UI to that effect.)</p>
</div><div><p>Flags: needinfo?(jhofmann)</p></div></div><div id="c8"><div id="ct-8" data-comment-id="14166683" data-ismarkdown="true"><p>Yeah, so, the plugin permissions in the doorhanger are set here: <a href="https://searchfox.org/mozilla-central/rev/153172de0c5bfca31ef861bd8fc0995f44cada6a/browser/base/content/browser-plugins.js#143" rel="nofollow">https://searchfox.org/mozilla-central/rev/153172de0c5bfca31ef861bd8fc0995f44cada6a/browser/base/content/browser-plugins.js#143</a></p>
<p>What that code does is if you simply click "allow" it will set a session scoped permission to allow Flash.</p>
<p>This works independently of SitePermissions.jsm, but after the permission is updated the SitePermissions stuff is needed to display the correct permission state in the identity popup and page info.</p>
<p>As you noted, PageInfo lists all states for each permission as they are specified in SitePermissions.jsm. Then it tries to select one of them and that part is a little wrong for at least plugins. We fetch state and scope <a href="https://searchfox.org/mozilla-central/rev/153172de0c5bfca31ef861bd8fc0995f44cada6a/browser/base/content/pageinfo/permissions.js#64" rel="nofollow">here</a>, but then continue to only consider state when selecting an item. So we select "Allow" when there really should be an "Allow for Session" item.</p>
<blockquote>
<p>but some other permissions in the page info dialog have an "allow for session" option</p>
</blockquote>
<p>Only cookies has that and it's an entirely independent permission state, not denoted by its permission scope. It's very confusing.</p>
<blockquote>
<p>(TL;DR for this bug: we want to remove the ability to permanently/persistently allow flash to play, including all the UI to that effect.)</p>
</blockquote>
<p>Then I would suggest just dropping that option from the doorhanger (see link above) and renaming "Allow" into "Allow for session" for plugins in Page Info (the identity popup should already correctly display "Temporarily Allowed").</p>
<p>Do you want to keep supporting previous permanent ALLOW entries for plugin permissions in the permission manager? Then we might need a bit of hackery to have Allow as an unselectable? option there, too.</p>
<p>I hope that helps!</p>
</div><div><p>Flags: <span>needinfo?(jhofmann)</span></p></div></div><div id="c17"><p>Release Note Request (optional, but appreciated)<br>
[Why is this notable]: flash can't be set to always activate anymore<br>
[Affects Firefox for Android]: I don't think so, but there's also no fennec 69 so kind of moot<br>
[Suggested wording]:<br>
[Links (documentation, blog post, etc)]:</p></div><div id="c18"><div id="ct-18" data-comment-id="14177189" data-ismarkdown="true"><blockquote>
<p>[Affects Firefox for Android]: I don't think so, but there's also no fennec 69 so kind of moot</p>
</blockquote>
<p>That's correct. We dropped Android support for Flash a couple years ago (2017 <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1381916" title="VERIFIED FIXED - Remove support for plugins (flash)">bug 1381916</a>).</p>
<blockquote>
<p>[Suggested wording]:</p>
</blockquote>
<p><code>Always ask for user permission before activating Flash on a website.</code></p>
<p>[Links (documentation, blog post, etc)]:</p>
<p>Mozilla's Plugin Roadmap:<br>
<a href="https://developer.mozilla.org/en-US/docs/Plugins/Roadmap" rel="nofollow">https://developer.mozilla.org/en-US/docs/Plugins/Roadmap</a></p>
</div></div><div id="c20"><div><p>Flags: needinfo?(gijskruitbosch+bugs)</p></div></div><div id="c21"><p>It turns out that (a) we have mochitest-plain plugin tests, and (b) they rely on setting <code>plugin.enabledState</code> to 'enabled', from the content process, to enable plugins. Which broke because for click-to-play flash, it's no longer possible to do that. What they should be doing is giving themselves permission, but that's easier said than done...</p></div><div id="c22"><div><p>Flags: <span>needinfo?(gijskruitbosch+bugs)</span></p></div></div><div id="c24"><div><p>Status: ASSIGNED → RESOLVED</p><p>Closed: <span title="2019-06-13 14:55 PDT" data-time="1560462942">1 year ago</span></p><p>Resolution: --- → FIXED</p><p>Target Milestone: --- → mozilla69</p></div></div><div id="c26"><p>Added to the Fx69 Beta release notes.</p></div><div id="c28"><div id="ct-28" data-comment-id="14334494" data-ismarkdown="true"><p>(In reply to Kohei Yoshino [:kohei] (Bugzilla UX) (FxSiteCompat) from <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1519434#c25" title="RESOLVED FIXED - Remove &quot;Always Activate&quot; and &quot;Remember this decision&quot; Flash options in Firefox 69">comment #25</a>)</p>
<blockquote>
<p>Posted site compatibility note: <a href="https://www.fxsitecompat.dev/en-CA/docs/2019/flash-player-can-no-longer-always-be-activated/" rel="nofollow">https://www.fxsitecompat.dev/en-CA/docs/2019/flash-player-can-no-longer-always-be-activated/</a></p>
</blockquote>
<p>The page has the options reversed.  It says, <em>Firefox 69 has removed the “Always Activate” option from the page notification dialog and the “Remember this decision” option from the Add-on Manager.</em><br>
Actually, the “Always Activate” option was removed from the Add-ons Manager and  the “Remember this decision” option<br>
was removed from the page notification dialog (described in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1519434#c1" title="RESOLVED FIXED - Remove &quot;Always Activate&quot; and &quot;Remember this decision&quot; Flash options in Firefox 69">comment 1</a> as the click-to-activate door hanger).</p>
</div></div>



</div> 
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>