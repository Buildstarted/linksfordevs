<!DOCTYPE html>
<html lang="en">
<head>
    <title>
BlazorHelp Website &gt; Blog - Embedding Power BI in Blazor - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="BlazorHelp Website &gt; Blog - Embedding Power BI in Blazor - linksfor.dev(s)"/>
    <meta property="article:author" content="Written by:&#xA;   Michael Washington"/>
    <meta property="og:description" content="Microsoft Visual Studio Blazor"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="http://blazorhelpwebsite.com/Blog/tabid/61/EntryId/4373/Embedding-Power-BI-in-Blazor.aspx"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - BlazorHelp Website &gt; Blog - Embedding Power BI in Blazor</title>
<div class="readable">
        <h1>BlazorHelp Website &gt; Blog - Embedding Power BI in Blazor</h1>
            <div>by Written by:&#xA;   Michael Washington</div>
            <div>Reading time: 8-10 minutes</div>
        <div>Posted here: 22 Jan 2020</div>
        <p><a href="http://blazorhelpwebsite.com/Blog/tabid/61/EntryId/4373/Embedding-Power-BI-in-Blazor.aspx">http://blazorhelpwebsite.com/Blog/tabid/61/EntryId/4373/Embedding-Power-BI-in-Blazor.aspx</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
 <!-- Begin Blog Entry Title -->
 
 <!-- End Blog Entry Title -->
 <!-- Begin Blog Sub Head -->
 <acronym title="1/21/2020 10:13 PM"><span>
  <span id="dnn_ctr382_MainView_ViewEntry_lblEntryMonth">Jan</span>
 </span><span>
  <span id="dnn_ctr382_MainView_ViewEntry_lblEntryDay">21</span>
 </span></acronym>
 <p>
  
  <br>
  <span id="dnn_ctr382_MainView_ViewEntry_lblDateTime">1/21/2020 10:13 PM</span>&nbsp;
  <a id="dnn_ctr382_MainView_ViewEntry_lnkRss" href="http://blazorhelpwebsite.com/Blog/tabid/61/rssid/1/Default.aspx" target="_blank"><img id="dnn_ctr382_MainView_ViewEntry_lnkRssIcon" src="http://blazorhelpwebsite.com/desktopmodules/Blog/Images/feed-icon-12x12.gif" alt="RssIcon"></a>
 </p>
 <!-- End Blog Sub Head -->
 
 <!-- Begin Blog Entry -->
 
  <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_9fad08af-734e-47e5-bd74-9347439df713.png" width="642" height="388"></p><p>You can easily embed <strong>Power BI</strong> reports into a <strong>Server Side Blazor</strong> Application. This method allows you to display a <strong>Power BI</strong> report without requiring the user to have a <strong>Power BI</strong> account.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_a8a5ca8e-ab4d-4068-8d12-257940ec85b2.png" width="567" height="170"></p>  <p>We start the code from the article: <a href="https://gunnarpeipman.com/aspnet-core-power-bi-embedded/">Embedded Power BI reports with ASP.NET Core</a> by <a href="https://gunnarpeipman.com/gpeipman/">Gunnar Peipman</a>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_0eb62a8f-0a8d-48f0-9d65-74d399c37fcc.png" width="284" height="146"></p>  <p>His project demonstrates how to embed a <strong>Power BI</strong> report into a <strong>.Net Core</strong> application. </p>  <p>This example builds on that and shows you how to embed the report in a <strong>Server Side Blazor</strong> application.</p>      <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_6ba5851e-7b4d-47ba-bc0a-2224dc6ca2e3.png" width="292" height="481"></p>  <p>The first step is to create a <strong>Server Side Blazor</strong> project and select <strong>Manage NuGet Packages</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_18aae26b-5a53-437c-82ad-a015ef528028.png" width="505" height="216"></p>  <p>Install the <strong>Microsoft.PowerBI.Api</strong> package.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_dd0ba295-c74e-4b1b-8001-7cb8241e95cd.png" width="274" height="409"></p>  <p>The next step is to add the <strong>powerbi.min.js</strong> file to the <strong>wwwroot/js</strong> directory.</p>  <p>You can get that file from here: <a href="https://github.com/microsoft/PowerBI-JavaScript/releases">https://github.com/microsoft/PowerBI-JavaScript/releases</a></p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_2c42758b-e8d1-4a34-836d-e07e45bcada2.png" width="269" height="433"></p>  <p>Next open the <strong>_Host.cshtml</strong> file.</p>    <p>Add the following code to reference the <strong>powerbi.min.js</strong> file:</p>    <pre><pre>    <span>&lt;</span><span>script</span> <span>src</span>=<span>"js/powerbi.min.js"</span><span>&gt;</span><span>&lt;/</span><span>script</span><span>&gt;</span></pre></pre>



<p>Add the following code to display the <strong>Power BI Report</strong> using the code in the <strong>powerbi.min.js</strong> file:</p>



<pre><pre>   <span>&lt;</span><span>script</span><span>&gt;</span>
</pre><pre>        window.ShowMyPowerBI = {
</pre><pre>            showReport: function (reportContainer, accessToken, embedUrl, embedReportId) {
</pre><pre></pre><pre>                // Get models. models contains enums that can be used.
</pre><pre>                var models = window['powerbi-client'].models;
</pre><pre></pre><pre>                var config = {
</pre><pre>                    type: 'report',
</pre><pre>                    tokenType: models.TokenType.Embed,
</pre><pre>                    accessToken: accessToken,
</pre><pre>                    embedUrl: embedUrl,
</pre><pre>                    id: embedReportId,
</pre><pre>                    permissions: models.Permissions.All,
</pre><pre>                    settings: {
</pre><pre>                        filterPaneEnabled: true,
</pre><pre>                        navContentPaneEnabled: true
</pre><pre>                    }
</pre><pre>                };
</pre><pre></pre><pre>                // Embed the report and display it within the div container.
</pre><pre>                powerbi.embed(reportContainer, config);
</pre><pre>            }
</pre><pre>        };
</pre><pre>    <span>&lt;/</span><span>script</span><span>&gt;</span></pre></pre>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_6744d49f-ce46-4211-8e2d-26e663181095.png" width="260" height="340"></p>

<p>Next open the <strong>appsettings.json</strong> file and add the following configurations, replacing the <strong>{{ YOUR SETTING }}</strong> parts with your own settings. See <a href="https://gunnarpeipman.com/aspnet-core-power-bi-embedded/">Embedded Power BI reports with ASP.NET Core</a> by <a href="https://gunnarpeipman.com/gpeipman/">Gunnar Peipman</a> for an explanation of the settings and how to get them: </p>



<pre><pre>  "<span>PowerBI</span>": {
</pre><pre>    "<span>ApplicationId</span>": "{{ YOUR SETTING }}",
</pre><pre>    "<span>ApplicationSecret</span>": "{{ <span>YOUR</span> SETTING }}",
</pre><pre>    "<span>ReportId</span>": "{{ <span>YOUR</span> SETTING }}",
</pre><pre>    "<span>WorkspaceId</span>": "{{ <span>YOUR</span> SETTING }}",
</pre><pre>    "<span>AuthorityUrl</span>": "{{ <span>YOUR</span> SETTING }}",
</pre><pre>    "<span>ResourceUrl</span>": "<span>https</span>://<span>analysis</span>.<span>windows</span>.<span>net</span>/<span>powerbi</span>/<span>api</span>",
</pre><pre>    "<span>ApiUrl</span>": "<span>https</span>://<span>api</span>.<span>powerbi</span>.<span>com</span>/",
</pre><pre>    "<span>EmbedUrlBase</span>": "<span>https</span>://<span>app</span>.<span>powerbi</span>.<span>com</span>/",
</pre><pre>    "<span>UserName</span>": "{{ <span>YOUR</span> SETTING }}",
</pre><pre>    "<span>Password</span>": "{{ <span>YOUR</span> SETTING }}"
</pre><pre>  }</pre></pre>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_33a1998d-371b-4f01-a574-a2ae57b036f6.png" width="254" height="394"></p>

<p>So that our <strong>C#</strong> code can communicate with the <strong>JavaScript</strong>, create a <strong>interop.cs</strong> file using the following code:</p>



<pre><pre><span>using</span> Microsoft.AspNetCore.Components;
</pre><pre><span>using</span> Microsoft.JSInterop;
</pre><pre><span>using</span> System.Threading.Tasks;
</pre><pre></pre><pre><span>namespace</span> BlazorPowerBI
</pre><pre>{
</pre><pre>    <span>public</span> <span>static</span> <span>class</span> Interop
</pre><pre>    {
</pre><pre>        <span>internal</span> <span>static</span> ValueTask&lt;<span>object</span>&gt; CreateReport(
</pre><pre>            IJSRuntime jsRuntime,
</pre><pre>            ElementReference reportContainer,
</pre><pre>            <span>string</span> accessToken,
</pre><pre>            <span>string</span> embedUrl,
</pre><pre>            <span>string</span> embedReportId)
</pre><pre>        {
</pre><pre>            <span>return</span> jsRuntime.InvokeAsync&lt;<span>object</span>&gt;(
</pre><pre>                "<span>ShowMyPowerBI.showReport</span>",
</pre><pre>                reportContainer, accessToken, embedUrl,
</pre><pre>                embedReportId);
</pre><pre>        }   
</pre><pre>    }
</pre><pre>}</pre></pre>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_499e2d5d-5296-4967-95d9-a781653fa752.png" width="254" height="447"></p>

<p>Finally, create a <strong>PowerBI.razor</strong> page using the following code:</p>



<pre><pre>@page "<span>/PowerBI</span>"
</pre><pre>@<span>using</span> System.Net.Http
</pre><pre>@<span>using</span> System.Threading.Tasks
</pre><pre>@<span>using</span> Microsoft.AspNetCore.Mvc
</pre><pre>@<span>using</span> Microsoft.PowerBI.Api.V2
</pre><pre>@<span>using</span> Microsoft.PowerBI.Api.V2.Models
</pre><pre>@<span>using</span> Microsoft.Rest
</pre><pre>@<span>using</span> Newtonsoft.Json.Linq
</pre><pre>@<span>using</span> Microsoft.Extensions.Configuration
</pre><pre>@<span>using</span> Microsoft.JSInterop
</pre><pre>@inject IJSRuntime JSRuntime
</pre><pre>@inject IConfiguration _configuration</pre></pre>

<pre><pre><span>&lt;</span><span>div</span> @<span>ref</span>=<span>"@PowerBIElement"</span> 
</pre><pre>     <span>style</span>=<span>"height: 600px;width: 100%;max-width: 2000px;"</span> <span>/&gt;</span></pre></pre>

<pre><pre><span>@code</span> {
</pre><pre>    <span>private</span> ElementReference PowerBIElement;
</pre><pre></pre><pre>    <span>protected</span> <span>override</span> async Task
</pre><pre>        OnAfterRenderAsync(<span>bool</span> firstRender)
</pre><pre>    {
</pre><pre>        <span>if</span> (firstRender)
</pre><pre>        {
</pre><pre>            var accessToken = await GetPowerBIAccessToken();
</pre><pre>            var tokenCredentials = <span>new</span> TokenCredentials(accessToken, "<span>Bearer</span>");
</pre><pre></pre><pre>            <span>using</span> (var client = <span>new</span> PowerBIClient(
</pre><pre>                <span>new</span> Uri(_configuration["<span>PowerBI:ApiUrl</span>"]), tokenCredentials))
</pre><pre>            {
</pre><pre>                var workspaceId = _configuration["<span>PowerBI:WorkspaceId</span>"];
</pre><pre>                var reportId = _configuration["<span>PowerBI:ReportId</span>"];
</pre><pre>                var report = 
</pre><pre>                    await client.Reports.GetReportInGroupAsync(
</pre><pre>                        workspaceId, reportId);
</pre><pre></pre><pre>                var generateTokenRequestParameters = 
</pre><pre>                    <span>new</span> GenerateTokenRequest(accessLevel: "<span>view</span>");
</pre><pre></pre><pre>                var tokenResponse = await client.Reports.GenerateTokenAsync(
</pre><pre>                    workspaceId, reportId, generateTokenRequestParameters);
</pre><pre></pre><pre>                await Interop.CreateReport(
</pre><pre>                    JSRuntime,
</pre><pre>                    PowerBIElement,
</pre><pre>                    tokenResponse.Token,
</pre><pre>                    report.EmbedUrl,
</pre><pre>                    report.Id);
</pre><pre>            }
</pre><pre>        }
</pre><pre>    }
</pre><pre></pre><pre>    <span>private</span> async Task&lt;<span>string</span>&gt; GetPowerBIAccessToken()
</pre><pre>    {
</pre><pre>        <span>using</span> (var client = <span>new</span> HttpClient())
</pre><pre>        {
</pre><pre>            var form = <span>new</span> Dictionary&lt;<span>string</span>, <span>string</span>&gt;();
</pre><pre>            form["<span>grant_type</span>"] = "<span>password</span>";
</pre><pre>            form["<span>resource</span>"] = _configuration["<span>PowerBI:ResourceUrl</span>"];
</pre><pre>            form["<span>username</span>"] = _configuration["<span>PowerBI:UserName</span>"];
</pre><pre>            form["<span>password</span>"] = _configuration["<span>PowerBI:Password</span>"];
</pre><pre>            form["<span>client_id</span>"] = _configuration["<span>PowerBI:ApplicationId</span>"];
</pre><pre>            form["<span>client_secret</span>"] = _configuration["<span>PowerBI:ApplicationSecret</span>"];
</pre><pre>            form["<span>scope</span>"] = "<span>openid</span>";
</pre><pre></pre><pre>            client.DefaultRequestHeaders.TryAddWithoutValidation(
</pre><pre>                "<span>Content-Type</span>", "<span>application/x-www-form-urlencoded</span>");
</pre><pre></pre><pre>            <span>using</span> (var formContent = <span>new</span> FormUrlEncodedContent(form))
</pre><pre></pre><pre>            <span>using</span> (var response = 
</pre><pre>                await client.PostAsync(_configuration["<span>PowerBI:AuthorityUrl</span>"], 
</pre><pre>                formContent))
</pre><pre>            {
</pre><pre>                var body = await response.Content.ReadAsStringAsync();
</pre><pre>                var jsonBody = JObject.Parse(body);
</pre><pre></pre><pre>                var errorToken = jsonBody.SelectToken("<span>error</span>");
</pre><pre>                <span>if</span> (errorToken != <span>null</span>)
</pre><pre>                {
</pre><pre>                    <span>throw</span> <span>new</span> Exception(errorToken.Value&lt;<span>string</span>&gt;());
</pre><pre>                }
</pre><pre></pre><pre>                <span>return</span> jsonBody.SelectToken("<span>access_token</span>").Value&lt;<span>string</span>&gt;();
</pre><pre>            }
</pre><pre>        }
</pre><pre>    }
</pre><pre>}</pre></pre>





<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4373/Windows-Live-Writer-Embedding-Power-BI-in-Blazor_12482-image_5643f545-2a0a-4c4c-be33-be505cc9eafd.png" width="479" height="899"></p>

<p>The <a href="https://gunnarpeipman.com/gpeipman/">Gunnar Peipman</a> version uses <strong>JQuery</strong> to connect the <strong>Power BI JavaScript</strong> to the <strong>HTML DIV</strong> to display the report.</p>

<p>This version literally <em>passes an instance</em> of the <strong>HTML DIV</strong> to the <strong>JavaScript</strong> to display the report.</p>

<p>This allows us to display the report without using <strong>JQuery</strong>.</p>





<p><a href="https://gunnarpeipman.com/aspnet-core-power-bi-embedded/">Embedded Power BI reports with ASP.NET Core</a></p>







<p><a href="https://gunnarpeipman.com/">Gunnar Peipman â€“ Programming Blog</a></p>

<p><a href="https://github.com/gpeipman/AspNetCorePowerBI">gpeipman/AspNetCorePowerBI (GitHub)</a></p>





<p>The project is available at <a href="http://blazorhelpwebsite.com/Downloads.aspx">http://BlazorHelpWebsite.com/Downloads.aspx</a></p>

<p>You must have <strong>Visual Studio 2019 Version 16.3 </strong>(or higher) installed to run the code.</p>
 
 <!-- End Blog Entry -->
 <!-- Blog Entry Footer Section -->
 
 
 
 <!-- Comments Section -->
 
 
 <div id="dnn_ctr382_MainView_ViewEntry_pnlAddComment">
		
  <table>
   <tbody><tr>
    <td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblAuthor">Your name:</span>
    </td>
    <td id="dnn_ctr382_MainView_ViewEntry_tdAuthor" colspan="1">
     
    </td>
		
    <td id="dnn_ctr382_MainView_ViewEntry_tdGravatarPreview" rowspan="2">
     <p><img id="dnn_ctr382_MainView_ViewEntry_imgGravatarPreview" src="http://www.gravatar.com/avatar/108eeb4a0bc2c8c85cad9dde10e1319e?s=48&amp;r=G&amp;d=http%3a%2f%2fwww.gravatar.com%2favatar%2fb6267c6fe44b457964aed2218e3ef8fe%3fsize%3d48" alt="Gravatar Preview">
     </p>
    </td>
		
   </tr>
   <tr id="dnn_ctr382_MainView_ViewEntry_trGravatarEmail">
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblEmail">Your email:</span>
    </td>
			<td>
     
    </td>
		</tr>
		
   <tr id="dnn_ctr382_MainView_ViewEntry_trUseGravatar">
			<td>
    </td>
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblEmailExplanation">(Optional) Email used only to show <a href="http://www.gravatar.com/" target="_new">Gravatar</a>.</span>
    </td>
			<td>
    </td>
		</tr>
		
   <tr id="dnn_ctr382_MainView_ViewEntry_trCommentWebsite">
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblWebsite">Your website:</span>
    </td>
			<td colspan="2">
     
    </td>
		</tr>
		
   <tr id="dnn_ctr382_MainView_ViewEntry_trCommentTitle">
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblCommentTitle">Title:</span>
    </td>
			<td colspan="2">
     
    </td>
		</tr>
		
   <tr>
    <td colspan="3">
     <span id="dnn_ctr382_MainView_ViewEntry_lblComment">Comment:</span>
    </td>
   </tr>
   <tr>
    <td colspan="3">
     
    </td>
   </tr>
   <tr id="dnn_ctr382_MainView_ViewEntry_rowCaptcha">
			<td colspan="3">
     <span id="dnn_ctr382_MainView_ViewEntry_lblCaptcha">Security Code</span>
     <div>
				<p><img src="http://blazorhelpwebsite.com/DesktopModules/Blog/ImageChallenge.captcha.aspx?captcha=CAF11249EA93D52ADB20E8E168A40511500A35B415FA3996B3B0671925E9AB8C1D6AF81063EF6227A2A2B79AB5660F752770D1F05D49CD056AB8D2DA765BA6A292B110ABD8F7CC3A441481352E9B062B8FA121855BA0A7E30026447883A6CD5EE41EEE76410CB72B39F0B0563EFA42769DB750F6063374703BCDA86C&amp;alias=blazorhelpwebsite.com" alt="CAPTCHA image"></p><p>
					Enter the code shown above in the box below
				</p></div>
    </td>
		</tr>
		
   <tr>
    <td colspan="3">
     Add Comment&nbsp;&nbsp;
     Cancel&nbsp;
     
    </td>
   </tr>
  </tbody></table>
  
 
	</div>
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>