<!DOCTYPE html>
<html lang="en">
<head>
    <title>
p410n3 blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="p410n3 blog - linksfor.dev(s)"/>
    <meta property="og:description" content="Technical blog made by p410n3 aka palone. Covering mostly programming and infosec topics. Thoughts are my own."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://palone.blog/#post-the-story-of-my-first-incident-response-106"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - p410n3 blog</title>
<div class="readable">
        <h1>p410n3 blog</h1>
            <div>Reading time: 14-18 minutes</div>
        <div>Posted here: 24 Jul 2020</div>
        <p><a href="https://palone.blog/#post-the-story-of-my-first-incident-response-106">https://palone.blog/#post-the-story-of-my-first-incident-response-106</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="main">
        
        <div id="posts">
                    <div>
                        <h2>
                            <a href="#post-the-story-of-my-first-incident-response-106">The Story of my first “Incident Response”</a>
                        </h2>
                        <p><span>
                            <p>Today, I felt like sharing one of my favourite experiences that I had in my still short career as a Web Developer. It’s a Story in which I am tasked with investigating a server issue, which quickly lead to me detecting a hacked system. […]</p>

                        </span>
                        <a href="#post-the-story-of-my-first-incident-response-106">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-your-android-might-be-the-most-secure-device-you-own-4">Modern Android is pretty secure</a>
                        </h2>
                        <p><span>
                            <p>When most people would describe the Android Platform, things like customizability, device diversity and pricing are usually named. Security on the other hand, most likely will not come to people’s mind. At least in my experience that is. Most people just don’t perceive Android as being especially secure. The biggest reason could be the more […]</p>

                        </span>
                        <a href="#post-your-android-might-be-the-most-secure-device-you-own-4">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-slipping-past-chinas-firewall-in-a-trojan-horse-72">Slipping past China’s Firewall in a Trojan Horse</a>
                        </h2>
                        <p><span>
                            <p>Sometime in 1260–1180 BC some smart Greek dudes used a “Trojan Horse” to smuggle their soldiers inside of the city of Troy. In 2019 some smart Chinese dudes use a software called “Trojan” to smuggle their TCP/IP Packets outside of the country. And I think that’s just as exciting. Continuing to research about Firewalls and […]</p>

                        </span>
                        <a href="#post-slipping-past-chinas-firewall-in-a-trojan-horse-72">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-bypassing-firewalls-but-how-69">Bypassing Firewalls – But How?</a>
                        </h2>
                        <p><span>
                            <p>In my last post I have elaborated multiple reasons as to&nbsp;why&nbsp;someone would want to bypass a Firewall. Now that this is established, here comes the part where we get to the “how”. If you don’t care about the technology behind any of this, jump to the&nbsp;conclusion. However, if you are interested in the theory&nbsp;behind Firewall […]</p>

                        </span>
                        <a href="#post-bypassing-firewalls-but-how-69">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-bypassing-firewalls-but-why-65">Bypassing Firewalls – But why?</a>
                        </h2>
                        <p><span>
                            <p>Oh boy here goes. This is the first post of many, in which I will touch the topic of bypassing Firewalls. This being the Introduction of this series, I will focus on setting the topic up, providing explanations and all that stuff. Some of the resources I will provide are screenshots from chats I took […]</p>

                        </span>
                        <a href="#post-bypassing-firewalls-but-why-65">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-trust-is-good-cryptography-is-better-63">Trust is good, cryptography is better</a>
                        </h2>
                        <p><span>
                            <p>Recently,&nbsp;I have seen a lot of people in the InfoSec- and Online Privacy Community having lenghty discussions about which companies we can trust these days. At the very least,&nbsp;since Snowden&nbsp;has&nbsp;leaked various documents,&nbsp; many companies have been labeled as either “trustworthy” or “not trustworthy”. These companies and services are rated by their past actions, and the […]</p>

                        </span>
                        <a href="#post-trust-is-good-cryptography-is-better-63">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-google-dorks-sometimes-it-really-is-that-easy-60">Google Dorks – Sometimes it really is that easy</a>
                        </h2>
                        <p><span>
                            <p>One day, I was watching some DefCon talks at YouTube, as I often do. One of the videos was titled “Google Hacking for Penetration Testers“. This title sounded very interesting, but also didn’t tell me much about what to actually see in there. So naturally, I watched it. It was amazing. All I could think […]</p>

                        </span>
                        <a href="#post-google-dorks-sometimes-it-really-is-that-easy-60">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-my-personal-security-setup-58">My Personal Security Setup</a>
                        </h2>
                        <p><span>
                            <p>Over the last year or so, I have seriously stepped up my security game. These days, fraudsters have an exceptionally easy job of getting your data. With all these data breaches reaching from small websites that have bad encryption (if any) to online stores. This data can be used as a whole to create so […]</p>

                        </span>
                        <a href="#post-my-personal-security-setup-58">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-hacking-websites-with-javascript-part-2-44">Hacking Websites with JavaScript – Part 2</a>
                        </h2>
                        <p><span>
                            <p>This is Part 2 of my Series about unconventional usage of JavaScript. Please read&nbsp;part 1&nbsp;first if you haven’t already, as I will write this second part less noob friendly. This time I will take a look at a JavaScript powered game, which features a Online Leaderboard to show off your 1337 Hacker Skills to the […]</p>

                        </span>
                        <a href="#post-hacking-websites-with-javascript-part-2-44">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-hacking-websites-with-javascript-part-1-25">Hacking Websites with JavaScript – Part 1</a>
                        </h2>
                        <p><span>
                            <p>This post is part of a multi-part Series where I write about fun things you can do with just some JS and a modern day browser. Part 1 is about getting Free Premium Features on&nbsp;textmechanic.com. What do I need? A browser. I will be using chrome Basic understanding of programming as well as the HTTP […]</p>

                        </span>
                        <a href="#post-hacking-websites-with-javascript-part-1-25">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-brutal-web-design-resource-collection-22">Brutal Web Design – Resource Collection</a>
                        </h2>
                        <p><span>
                            <p>Over the last 2 years, I found various interesting articles regarding brutalism in web design. Even though they do not necessarily considered themselves talking about that topic. If you don’t know what Brutal web design is, then let me quote one of the said articles to sum it up quickly: Originated in post-World War II […]</p>

                        </span>
                        <a href="#post-brutal-web-design-resource-collection-22">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-unlicense-cuz-i-cant-be-bothered-20">UNLICENSE – cuz I can’t be bothered</a>
                        </h2>
                        <p><span>
                            <p>If you take a close look at my&nbsp;GitHub Profile&nbsp;you will notice that I primarily license my projects with the UNLICENSE. It’s contains the following statement: This is free and unencumbered software released into the public domain. Anyone is free to copy, modify, publish, use, compile, sell, or distribute this software, either in source code form […]</p>

                        </span>
                        <a href="#post-unlicense-cuz-i-cant-be-bothered-20">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-readmes-are-important-18">ReadMes are Important!</a>
                        </h2>
                        <p><span>
                            <p>This article is primarily written about the platform&nbsp;GitHub. If you are unfamiliar with this platform, it might contain terms that will just confuse you. I recommend reading&nbsp;THIS&nbsp;first. One of the nicest things to experience as a developer is when the things you made actually get used by people. That they find it actually useful (and […]</p>

                        </span>
                        <a href="#post-readmes-are-important-18">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-why-having-your-own-server-is-totally-awesome-16">Why having your own Server is totally awesome</a>
                        </h2>
                        <p><span>
                            <p>Around 2015-2016 I was getting more and more involved in webdevelopment. Before that my coding revolved mostly about some Batch scripting or Automation scripts with AHK. Nothing fancy and barely over 100 lines each. Having made my first&nbsp;somewhat&nbsp;good looking website at that time, I wanted to made it available to the public eye. At first […]</p>

                        </span>
                        <a href="#post-why-having-your-own-server-is-totally-awesome-16">Read More</a>
                    </p></div>
                
                    <div>
                        <h2>
                            <a href="#post-the-misuse-of-the-word-hacker-10">The misuse of the word Hacker</a>
                        </h2>
                        <p><span>
                            <p>Ask the media, then ask an older programmer from the 80’s. Maybe ask your best friend and now, ask yourself:&nbsp;Who or what is a “hacker”?&nbsp;This one particular word is being misused by the general public for years now, drawing the picture of that lonely criminal, sitting in an all dark room watching the matrix intro […]</p>

                        </span>
                        <a href="#post-the-misuse-of-the-word-hacker-10">Read More</a>
                    </p></div>
                </div>
    </div><div id="modal">
        <div id="content">
                <p><a href="#">×</a></p>
                
<p>Today, I felt like sharing one of my favourite experiences that I had in my still short career as a Web Developer. It’s a Story in which I am tasked with investigating a server issue, which quickly lead to me detecting a hacked system.</p>



<h2>Prologue </h2>



<p>The Summer rolled around and schools closed for the summer break. So this was the time of the year where people went on their hard earned vacations. Both of my co-developers, but also a lot of Customers, would be unavailable for some time. I finally had some time to work on that ticket that was sitting patiently in my backlog for about a week. This ticket was created by our internal IT department that provided us with our virtual web servers, database servers and the load balancer. </p>



<p>One day, their monitoring detected that one of the older database servers would freak out every other weekend. The <a href="https://dev.mysql.com/doc/refman/5.7/en/mysqlbinlog.html">MySQLbinlogs</a> would grow rapidly to be several hundred gigabyte in size, eventually filling up all the space and crashing the server. Since it was actually my department’s job to care for those servers, the task was given to me. MySQLbinlogs were temporarily disabled before I would start my investigation on the issue. </p>



<h2>The Investigation</h2>



<p>I already had an vague idea about what might have caused these problems. Since the actual databases were not increasing in size at all, and the behaviour was <em>only </em>present on the weekend, I suspected one of our bigger customers was behind all of that. Said customer was a fairly big retailer of sports gear, and their eCommerce platform was connected to their inventory management system. Updating large amounts of stock on the weekends would explain the spike. </p>



<p>To prove my Theory, I wrote a simple bash one-liner that would count each occurrence of any database name in the logs. The second highest count of database transactions were indeed from the sports gear retailer I suspected. Each weekend, a couple thousand database events were logged for that database. However, the database with the <em>most </em>logged events had<em> several millions events</em> recorded in a matter of minutes. </p>



<p>So this one was definitely the culprit. The weird part was that this was only a small landing page for a specific product, which was discontinued many years ago. The database for this site had nothing in it except one single table containing about a dozen image paths. This made no sense at all. </p>



<p>At this point, it made ‘click’. I navigated to the site in question and listed all .php files using <a href="https://linux.die.net/man/1/find">find</a>. The names Dude.php, lndex.php (with an L) and fuck.php appeared on my screen. Those were webshells. This site was hacked. </p>



<p>It turned out, that one of the Webshells had a feature that tried to dump the database of a WordPress installation. If it didn’t succeed, it would just…try again indefinitely for whatever reason. But this was not a WordPress installation. So once <em>someone </em>started that script, it would run and run and while doing so, fill up the logs very rapidly. </p>



<h2>Securing the area </h2>



<p>After finding out about the Hack, I immediately informed our project manager and after sitting down with the IT department we started to plan pur next steps. Basically the plan was to analyse the whole scale of the attack, finding the root cause of it and finally securing the affected systems. </p>



<p>Additionally, the whole process had to be documented and the customer was immediately notified and to be updated regularly. As of that moment, there was NO indication of user data being affected. Thankfully, our systems are compartmentalized, and the affected hosting only included three fairly old landing pages and no important infrastructure. </p>



<p>To find other potentially compromised sites, we would build some scripts that would scan all of our hostings for signs of compromise. Webshells are essentially made to have someone run commands through them. Just like a Shell, hence the name. So these scripts typically included commands like <code>system</code>, <code>exec </code>and similar. Some webshells are obfuscated and included commands like <code>str_rot13</code>, <code>base64_decode </code>and almost always <code>eval</code>. <a href="https://www.ioncube.com/">IonCube</a> protected scripts were also identifiable. </p>



<p>Running scripts on every single file that would check for the above mentioned criteria, and then manually inspecting the result to filter out false positives left us happy. Only the system we initially discovered to be hacked seemed to be affected. The (more experienced) IT Team also re-did a full system scan a couple days later with some more sophisticated scanning software. This did not find anything either. </p>



<p>We also searched all available MySQLbinlogs for events that mirrored those we found for the hacked system. None of them were executed against a different database. </p>



<p>Everything came up clean. </p>



<p>The root cause of the hack was also quickly discovered. This particular hosting was not originally developed or hosted by us. The customer moved away from another agency to partner up with us, and the already existing sites were migrated over to our systems <em>years </em>ago. The sites were put into version control as soon as they were migrated over to our systems. And this proved that the malicious files were already present on day one. Because the <em>very first commit</em> already included them!</p>



<p>It was however not clear to us, why the webshells were never touched for years, and why someone would try to run a database extraction script multiple times, while the script was failing each time.</p>



<h2>Cleaning up </h2>



<p>This part was pretty easy. The affected sites were not of any importance anymore, and so it was no issue for us to use <a href="https://www.httrack.com/">HTTrack</a> to make a static version of this once dynamic website and disable PHP for the hosting. </p>



<p>It was thanks to the great work of our IT Department and our just as great Senior Developer that this hack has caused so little damage! They are the ones that properly compartmentalized the hostings, locked down the <a href="https://docs.jelastic.com/php-security-settings/">php.ini</a>, ran proper monitoring and much more. If the hostings would have been improperly secured and unmonitored, this could have been a lot worse than it turned out to be. </p>



<p>Thats about it. </p>



<p>Thanks for reading</p>

            </div>
    </div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>