<!DOCTYPE html>
<html lang="en">
<head>
    <title>
torgo - GoDoc -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>torgo - GoDoc</h1><div><div class="container"><p><code>import "github.com/wybiral/torgo"</code></p><p>
Package torgo provides a Golang controller interface for Tor.</p><ul class="list-unstyled"><li><a href="#NewClient">func NewClient(addr string) (*http.Client, error)</a></li><li><a href="#ServiceIDFromEd25519">func ServiceIDFromEd25519(pub ed25519.PublicKey) (string, error)</a></li><li><a href="#ServiceIDFromRSA">func ServiceIDFromRSA(pub *rsa.PublicKey) (string, error)</a></li><li><a href="#Controller">type Controller</a></li><li><a href="#Onion">type Onion</a></li></ul><h4 id="pkg-examples">Examples <a class="permalink" href="#pkg-examples">¶</a></h4><p><a href="https://github.com/wybiral/torgo/blob/master/client.go">client.go</a><a href="https://github.com/wybiral/torgo/blob/master/controller.go">controller.go</a><a href="https://github.com/wybiral/torgo/blob/master/ed25519.go">ed25519.go</a><a href="https://github.com/wybiral/torgo/blob/master/onion.go">onion.go</a><a href="https://github.com/wybiral/torgo/blob/master/rsa.go">rsa.go</a><a href="https://github.com/wybiral/torgo/blob/master/torgo.go">torgo.go</a></p><p>
NewClient return new HTTP client that uses a Tor SOCKS proxy.
`addr` is the host:port address of SOCKS proxy (usually "127.0.0.1:9050")
</p><div class="panel-group"><div class="panel panel-default" id="example-NewClient--Httpget"><div id="ex-NewClient--Httpget" class="panel-collapse collapse"><div class="panel-body"><p>
Create a new Tor SOCKS HTTP client and request current IP from httpbin.org.
</p><p>Code:
          </p><pre><span class="com">// Create client from SOCKS proxy address</span>
client, err := torgo.NewClient("127.0.0.1:9050")
if err != nil {
    log.Fatal(err)
}
<span class="com">// Perform HTTP GET request</span>
resp, err := client.Get("http://httpbin.org/ip")
if err != nil {
    log.Fatal(err)
}
<span class="com">// Copy response to Stdout</span>
io.Copy(os.Stdout, resp.Body)
</pre></div></div></div></div><p>
ServiceIDFromEd25519 calculates a Tor service ID from an ed25519.PublicKey.
</p><div class="panel-group"><div class="panel panel-default" id="example-ServiceIDFromEd25519"><div id="ex-ServiceIDFromEd25519" class="panel-collapse collapse"><div class="panel-body"><p>
Calculate Tor service ID from ed25519.PublicKey.
</p><p>Code:
          </p><pre><span class="com">// Calculate service ID</span>
serviceID, err := torgo.ServiceIDFromEd25519(publicKeyEd25519)
if err != nil {
    log.Fatal(err)
}
fmt.Println(serviceID)
</pre></div></div></div></div><p>
ServiceIDFromRSA calculates a Tor service ID from an *rsa.PublicKey.
</p><div class="panel-group"><div class="panel panel-default" id="example-ServiceIDFromRSA"><div id="ex-ServiceIDFromRSA" class="panel-collapse collapse"><div class="panel-body"><p>
Calculate Tor service ID from *rsa.PublicKey.
</p><p>Code:
          </p><pre><span class="com">// Calculate service ID</span>
serviceID, err := torgo.ServiceIDFromRSA(publicKeyRSA)
if err != nil {
    log.Fatal(err)
}
fmt.Println(serviceID)
</pre></div></div></div></div><div class="decl" data-kind="d"><a title="View Source" href="https://github.com/wybiral/torgo/blob/master/controller.go#L15">❖</a><pre>type Controller struct {
    <span class="com">// Array of available authentication methods.</span><span id="Controller.AuthMethods">AuthMethods</span> []<a href="/builtin#string">string</a><span class="com">// Cookie file path (empty if not available).</span><span id="Controller.CookieFile">CookieFile</span><a href="/builtin#string">string</a><span class="com">// Text is a textproto.Conn to the control port.</span><span id="Controller.Text">Text</span> *<a href="/net/textproto">textproto</a>.<a href="/net/textproto#Conn">Conn</a>
}</pre></div><p>
A Controller instance is a control port connection that provides methods for
communicating with Tor.
</p><p>
NewController returns a new Controller instance connecting to the control
port at addr.
</p><div class="panel-group"><div class="panel panel-default" id="example-NewController"><div id="ex-NewController" class="panel-collapse collapse"><div class="panel-body"><p>
Return a new Controller interface.
</p><p>Code:
          </p><pre><span class="com">// Address of control port</span>
addr := "127.0.0.1:9051"
controller, err := torgo.NewController(addr)
if err != nil {
    log.Fatal(err)
}
fmt.Println(controller)
</pre></div></div></div></div><p>
AddOnion adds Onion hidden service. If no private key is supplied one will
be generated and the PrivateKeyType and PrivateKey properties will be set
with the newly generated one.
The hidden service will use port mapping contained in Ports map supplied.
ServiceID will be assigned based on the private key and will be the address
of this hidden service (without the ".onion" ending).
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-AddOnion"><div id="ex-Controller-AddOnion" class="panel-collapse collapse"><div class="panel-body"><p>
Add onion and generate private key.
</p><p>Code:
          </p><pre><span class="com">// Define onion that maps virtual port 80 to local port 8080</span>
onion := &amp;torgo.Onion{Ports: map[int]string{
    80: "127.0.0.1:8080",
}}
<span class="com">// Add onion to controller</span>
err := controller.AddOnion(onion)
if err != nil {
    log.Fatal(err)
}
<span class="com">// Print onion ID (address without ".onion" ending)</span>
fmt.Println(onion.ServiceID)
</pre></div></div></div><div class="panel panel-default" id="example-Controller-AddOnion-Ed25519"><div id="ex-Controller-AddOnion-Ed25519" class="panel-collapse collapse"><div class="panel-body"><p>
Add onion and generate private key (using ED25519-V3 key if supported).
</p><p>Code:
          </p><pre><span class="com">// Define onion that maps virtual port 80 to local port 8080</span>
onion := &amp;torgo.Onion{
    Ports: map[int]string{
        80: "127.0.0.1:8080",
    },
    PrivateKeyType: "NEW",
    PrivateKey:     "ED25519-V3",
}
<span class="com">// Add onion to controller</span>
err := controller.AddOnion(onion)
if err != nil {
    log.Fatal(err)
}
<span class="com">// Print onion ID (address without ".onion" ending)</span>
fmt.Println(onion.ServiceID)
</pre></div></div></div></div><p>
AuthenticateCookie authenticate to controller with cookie from current
CookieFile path.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-AuthenticateCookie"><div id="ex-Controller-AuthenticateCookie" class="panel-collapse collapse"><div class="panel-body"><p>
Authenticate with cookie file.
</p><p>Code:
          </p><pre>err := controller.AuthenticateCookie()
if err != nil {
    log.Fatal(err)
}
</pre></div></div></div></div><p>
AuthenticateNone authenticate to controller without password or cookie.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-AuthenticateNone"><div id="ex-Controller-AuthenticateNone" class="panel-collapse collapse"><div class="panel-body"><p>
Authenticate without password or cookie file.
</p><p>Code:
          </p><pre>err := controller.AuthenticateNone()
if err != nil {
    log.Fatal(err)
}
</pre></div></div></div></div><p>
AuthenticatePassword authenticate to controller with password.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-AuthenticatePassword"><div id="ex-Controller-AuthenticatePassword" class="panel-collapse collapse"><div class="panel-body"><p>
Authenticate with password.
</p><p>Code:
          </p><pre>err := controller.AuthenticatePassword("pa55w0rd")
if err != nil {
    log.Fatal(err)
}
</pre></div></div></div></div><p>
DeleteOnion deletes an onion by its serviceID (stop hidden service created
by this controller).
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-DeleteOnion"><div id="ex-Controller-DeleteOnion" class="panel-collapse collapse"><div class="panel-body"><p>
Delete an onion by its ServiceID
</p><p>Code:
          </p><pre>err := controller.DeleteOnion(onion.ServiceID)
if err != nil {
    log.Fatal(err)
}
</pre></div></div></div></div><p>
GetAddress returns the current external IP address.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-GetAddress"><div id="ex-Controller-GetAddress" class="panel-collapse collapse"><div class="panel-body"><p>
Print external IP address.
</p><p>Code:
          </p><pre>address, err := controller.GetAddress()
if err != nil {
    log.Fatal(err)
}
fmt.Println(address)
</pre></div></div></div></div><p>
GetBytesRead returns total bytes downloaded.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-GetBytesRead"><div id="ex-Controller-GetBytesRead" class="panel-collapse collapse"><div class="panel-body"><p>
Print total bytes read (downloaded).
</p><p>Code:
          </p><pre>n, err := controller.GetBytesRead()
if err != nil {
    log.Fatal(err)
}
fmt.Println(n)
</pre></div></div></div></div><p>
GetBytesWritten returns total bytes uploaded.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-GetBytesWritten"><div id="ex-Controller-GetBytesWritten" class="panel-collapse collapse"><div class="panel-body"><p>
Print total bytes written (uploaded).
</p><p>Code:
          </p><pre>n, err := controller.GetBytesWritten()
if err != nil {
    log.Fatal(err)
}
fmt.Println(n)
</pre></div></div></div></div><p>
GetConfigFile return path to Tor config file.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-GetConfigFile"><div id="ex-Controller-GetConfigFile" class="panel-collapse collapse"><div class="panel-body"><p>
Print path to Tor configuration file.
</p><p>Code:
          </p><pre>config, err := controller.GetConfigFile()
if err != nil {
    log.Fatal(err)
}
fmt.Println(config)
</pre></div></div></div></div><p>
GetTorPid returns PID for current Tor process.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-GetTorPid"><div id="ex-Controller-GetTorPid" class="panel-collapse collapse"><div class="panel-body"><p>
Print PID of Tor process.
</p><p>Code:
          </p><pre>pid, err := controller.GetTorPid()
if err != nil {
    log.Fatal(err)
}
fmt.Println(pid)
</pre></div></div></div></div><p>
GetVersion returns version of Tor server.
</p><div class="panel-group"><div class="panel panel-default" id="example-Controller-GetVersion"><div id="ex-Controller-GetVersion" class="panel-collapse collapse"><div class="panel-body"><p>
Return version of Tor server.
</p><p>Code:
          </p><pre>version, err := controller.GetVersion()
if err != nil {
    log.Fatal(err)
}
fmt.Println(version)
</pre></div></div></div></div><p>
Signal sends a signal to the server. Tor documentations defines the
following signals :
</p><pre>* RELOAD
* SHUTDOWN
* DUMP
* DEBUG
* HALT
* CLEARDNSCACHE
* NEWNYM
* HEARTBEAT
* DORMANT
* ACTIVE
</pre><div class="panel-group"><div class="panel panel-default" id="example-Controller-Signal-Newnym"><div id="ex-Controller-Signal-Newnym" class="panel-collapse collapse"><div class="panel-body"><p>
Send NEWSYM signal to switch to new clean circuits.
</p><p>Code:
          </p><pre>err := controller.Signal("NEWNYM")
if err != nil {
    log.Fatal(err)
}
</pre></div></div></div><div class="panel panel-default" id="example-Controller-Signal-Reload"><div id="ex-Controller-Signal-Reload" class="panel-collapse collapse"><div class="panel-body"><p>
Send signal to reload configuration.
</p><p>Code:
          </p><pre>err := controller.Signal("RELOAD")
if err != nil {
    log.Fatal(err)
}
</pre></div></div></div></div><div class="decl" data-kind="d"><a title="View Source" href="https://github.com/wybiral/torgo/blob/master/onion.go#L4">❖</a><pre>type Onion struct {
    <span class="com">// Ports maps virtual ports for the hidden service to local addresses.</span><span id="Onion.Ports">Ports</span> map[<a href="/builtin#int">int</a>]<a href="/builtin#string">string</a><span class="com">// ServiceID is the unique hidden service address (without ".onion" ending).</span><span id="Onion.ServiceID">ServiceID</span><a href="/builtin#string">string</a><span class="com">// Base64 encoded private key for the hidden service.</span><span id="Onion.PrivateKey">PrivateKey</span><a href="/builtin#string">string</a><span class="com">// Type of private key (RSA1024 or ED25519-V3).</span><span id="Onion.PrivateKeyType">PrivateKeyType</span><a href="/builtin#string">string</a>
}</pre></div><p>
Onion represents a hidden service.
</p><p>
OnionFromEd25519 returns an Onion instance from an ED25519 private key which
can be used to start a hidden service with controller.AddOnion.
</p><div class="panel-group"><div class="panel panel-default" id="example-OnionFromEd25519"><div id="ex-OnionFromEd25519" class="panel-collapse collapse"><div class="panel-body"><p>
Create an Onion and start hidden service from an ed25519.PrivateKey.
</p><p>Code:
          </p><pre><span class="com">// Create Onion from private key (does not start hidden service)</span>
onion, err := torgo.OnionFromEd25519(privateKeyEd25519)
if err != nil {
    log.Fatal(err)
}
<span class="com">// Set port mapping from hidden service 80 to localhost:8080</span>
onion.Ports[80] = "localhost:8080"
<span class="com">// Print service ID for Onion</span>
fmt.Println(onion.ServiceID)
<span class="com">// Start hidden service</span>
controller.AddOnion(onion)
</pre></div></div></div></div><p>
OnionFromRSA returns an Onion instance from a 1024 bit RSA private key which
can be used to start a hidden service with controller.AddOnion.
</p><div class="panel-group"><div class="panel panel-default" id="example-OnionFromRSA"><div id="ex-OnionFromRSA" class="panel-collapse collapse"><div class="panel-body"><p>
Create an Onion and start hidden service from an rsa.PrivateKey.
</p><p>Code:
          </p><pre><span class="com">// Create Onion from private key (does not start hidden service)</span>
onion, err := torgo.OnionFromRSA(privateKeyRSA)
if err != nil {
    log.Fatal(err)
}
<span class="com">// Set port mapping from hidden service 80 to localhost:8080</span>
onion.Ports[80] = "localhost:8080"
<span class="com">// Print service ID for Onion</span>
fmt.Println(onion.ServiceID)
<span class="com">// Start hidden service</span>
controller.AddOnion(onion)
</pre></div></div></div></div></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>