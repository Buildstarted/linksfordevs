<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Introducing C# Markup for Xamarin.Forms | Xamarin Blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Introducing C# Markup for Xamarin.Forms | Xamarin Blog - linksfor.dev(s)"/>
    <meta property="article:author" content="Vincent HoogendoornFollow"/>
    <meta property="og:description" content="C# Markup for Xamarin.Forms enables developers to seemlessly create user interfaces in C# code with built in markup extensions."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/xamarin/c-sharp-markup-for-xamarin-forms/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Introducing C# Markup for Xamarin.Forms | Xamarin Blog</title>
<div class="readable">
        <h1>Introducing C# Markup for Xamarin.Forms | Xamarin Blog</h1>
            <div>by Vincent HoogendoornFollow</div>
            <div>Reading time: 12-15 minutes</div>
        <div>Posted here: 16 Jul 2020</div>
        <p><a href="https://devblogs.microsoft.com/xamarin/c-sharp-markup-for-xamarin-forms/">https://devblogs.microsoft.com/xamarin/c-sharp-markup-for-xamarin-forms/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured"><div><div><div><div><p><img src="https://secure.gravatar.com/avatar/4d955fc07a721d711d5dec8cf345a3c5?s=58&amp;d=mm&amp;r=g" width="58" height="58" alt="Avatar"></p><p>Vincent</p></div></div></div><p>July 15th, 2020</p><p><em>This is a guest blog by <a href="https://twitter.com/vincenth_net" target="_blank">Vincent Hoogendoorn</a>. Vincent is a hands-on .NET architect, Xamarin veteran, <a href="https://github.com/VincentH-Net/CSharpForMarkup" target="_blank">CSharpForMarkup</a> author, <a href="https://github.com/xamarin/Xamarin.Forms/pull/8342" target="_blank">contributor of the C# Markup feature</a> in Xamarin.Forms and co-founder of the <a href="https://www.meetup.com/nl-NL/Dutch-Mobile-NET-Developers-Group/" target="_blank">Dutch Mobile .NET Developers meetup</a>. Vincent works as Architect &amp; Lead Mobile at <a href="https://anywhere365.io/" target="_blank">Anywhere365</a>.</em></p><h2>C# Markup</h2><p>Xamarin.Forms 4.6 introduced <strong>C# Markup</strong>, a set of fluent helpers and classes that aim to make UI development in C# a <em>joy</em>.</p><p>C# Markup helps developers write concise <em>declarative</em> UI markup and cleanly separate it from UI logic, all in C#. Developers get to enjoy C#’s first-class IDE support when writing markup. A single language for markup and logic reduces friction, markup scattering and cognitive load; there is less or no need for language bridging mechanisms like separate converters, styles, resource dictionaries, behaviours, triggers and markup extensions.</p><h2>Example</h2><p>Let’s introduce the main features of C# Markup by building this Twitter search page:</p><p><a href="https://devblogs.microsoft.com/xamarin/wp-content/uploads/sites/44/2020/07/final.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/xamarin/wp-content/uploads/sites/44/2020/07/final.png" alt="Twitter Search Example" width="374" height="669" srcset="https://devblogs.microsoft.com/xamarin/wp-content/uploads/sites/44/2020/07/final.png 374w, https://devblogs.microsoft.com/xamarin/wp-content/uploads/sites/44/2020/07/final-168x300.png 168w" sizes="(max-width: 374px) 100vw, 374px"> </a></p><p>The full source of this example can be found <a href="https://github.com/VincentH-Net/CSharpForMarkup/tree/formsexample/CSharpMarkupIntro" target="_blank">here</a>.</p><h2>Build Top-Down with Hot Reload</h2><p>C# Markup makes it easy to write markup using a top-down approach – so it reads like a story, filling in details while you progress. This short video shows the process from start to finish in 2.5 minutes (using <a href="https://github.com/sthewissen/Xamarin.Forms.DebugRainbows" target="_blank">DebugRainbows</a> and <a href="https://www.livesharp.net/" target="_blank">LiveSharp</a>):</p><p><iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/9YwWRvKqTpM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p><p>Note that this video is unedited and realtime; it was recorded in one go by replaying git commits from the command line.</p><h2>Write the Page – Like a Story</h2><p>At the highest level the page contains a header, search results and a footer. So, if we structure the markup top-down – to make it read like a story – the initial markup could be:</p><p><strong>SearchPage.cs</strong></p><pre><code><span><span>using</span></span><span><span> </span></span><span><span>Xamarin</span></span><span><span>.</span></span><span><span>Forms</span></span><span><span>.</span></span><span><span>Markup</span></span><span><span>;</span></span><span><span>

</span></span><span><span>public</span></span><span><span> </span></span><span><span>partial</span></span><span><span> </span></span><span><span>class</span></span><span><span> </span></span><span><span>SearchPage</span></span><span><span>
</span></span><span><span>{</span></span><span><span>
    </span></span><span><span>void</span></span><span><span> </span></span><span><span>Build</span></span><span><span>()</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>Content</span></span><span><span> </span></span><span><span>=</span></span><span><span> 
        </span></span><span><span>new</span></span><span><span> </span></span><span><span>StackLayout</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Children</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>{</span></span><span><span>
            </span></span><span><span>Header</span></span><span><span>,</span></span><span><span>
            </span></span><span><span>SearchResults</span></span><span><span>,</span></span><span><span>
            </span></span><span><span>Footer</span></span><span><span>
        </span></span><span><span>}};</span></span><span><span>

    </span></span><span><span>StackLayout</span></span><span><span> </span></span><span><span>Header</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>StackLayout</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>};</span></span><span><span>

    </span></span><span><span>CollectionView</span></span><span><span> </span></span><span><span>SearchResults</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>CollectionView</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>};</span></span><span><span>

    </span></span><span><span>Label</span></span><span><span> </span></span><span><span>Footer</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>Label</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>};</span></span><span><span>
</span></span><span><span>}</span></span></code></pre><p>The <code><span>void</span><span> </span><span>Build</span><span>()</span><span> </span><span>=&gt;</span><span> </span><span>Content</span><span> </span><span>=</span></code> pattern is a convention that lets you use <a href="https://www.livesharp.net/" target="_blank">LiveSharp</a> for stateful hot reload of C# Markup. If you don’t plan on using LiveSharp, omit the <code><span>Build</span><span>()</span></code> method and put the <code><span>Content</span></code> assignment in the page constructor.</p><p>For now C# Markup is an experimental feature. So we need to <a href="https://docs.microsoft.com/xamarin/xamarin-forms/internals/experimental-flags#enable-flags-in-your-app-class" target="_blank">set a flag</a> to enable the feature:</p><p><strong>App.cs</strong></p><pre><code><span><span>Device</span></span><span><span>.</span></span><span><span>SetFlags</span></span><span><span>(</span></span><span><span>new</span></span><span><span> </span></span><span><span>string</span></span><span><span>[]{</span></span><span><span> </span></span><span><span>"Markup_Experimental"</span></span><span><span> </span></span><span><span>});</span></span></code></pre><p>Next, let’s build out the page components. It is easy as 1-2-3 (and 4 for adding animation):</p><h2>1 Build the Header – Layout, Binding and Styles</h2><p>Now let’s create the header. We will use helpers for layout, binding and style:</p><pre><code><span><span>StackLayout</span></span><span><span> </span></span><span><span>Header</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>StackLayout</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Children</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>{</span></span><span><span>
    </span></span><span><span>new</span></span><span><span> </span></span><span><span>Button</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Text</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>"ᐸ"</span></span><span><span> </span></span><span><span>}</span></span><span><span> </span></span><span><span>.</span></span><span><span>Style</span></span><span><span> </span></span><span><span>(</span></span><span><span>HeaderButton</span></span><span><span>)</span></span><span><span>
                </span></span><span><span>.</span></span><span><span>Width</span></span><span><span> </span></span><span><span>(</span></span><span><span>50</span></span><span><span>)</span></span><span><span>
                </span></span><span><span>.</span></span><span><span>Bind</span></span><span><span> </span></span><span><span>(</span></span><span><span>nameof</span></span><span><span>(</span></span><span><span>vm</span></span><span><span>.</span></span><span><span>BackCommand</span></span><span><span>)),</span></span><span><span>

    </span></span><span><span>new</span></span><span><span> </span></span><span><span>Entry</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Placeholder</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>"Search"</span></span><span><span> </span></span><span><span>}</span></span><span><span>
               </span></span><span><span>.</span></span><span><span>FillExpandHorizontal</span></span><span><span> </span></span><span><span>()</span></span><span><span>
               </span></span><span><span>.</span></span><span><span>Bind</span></span><span><span> </span></span><span><span>(</span></span><span><span>nameof</span></span><span><span>(</span></span><span><span>vm</span></span><span><span>.</span></span><span><span>SearchText</span></span><span><span>))</span></span><span><span>
</span></span><span><span>}};</span></span></code></pre><h3>Bind</h3><p>The <code><span>Bind</span></code> helper knows the <a href="https://github.com/xamarin/Xamarin.Forms/blob/master/Xamarin.Forms.Core/Markup/DefaultBindableProperties.cs" target="_blank">default bindable property for most built-in view types</a>; <code><span>Bind</span></code>‘s target property parameter is optional (you can <a href="https://docs.microsoft.com/xamarin/xamarin-forms/user-interface/csharp-markup#data-binding" target="_blank">register a default bindable property</a> for your own / 3rd party view type).</p><h3>Style</h3><p>The <code><span>Style</span></code> helper refers to an instance of a <code><span>Style</span><span>&lt;</span><span>BindableObject</span><span>&gt;</span></code> helper class, e.g.:</p><p><strong>Styles.cs</strong></p><pre><code><span><span>public</span></span><span><span> </span></span><span><span>static</span></span><span><span> </span></span><span><span>class</span></span><span><span> </span></span><span><span>Styles</span></span><span><span>
</span></span><span><span>{</span></span><span><span>
    </span></span><span><span>static</span></span><span><span> </span></span><span><span>Style</span></span><span><span>&lt;</span></span><span><span>Button</span></span><span><span>&gt;</span></span><span><span> headerButton</span></span><span><span>;</span></span><span><span>

    </span></span><span><span>public</span></span><span><span> </span></span><span><span>static</span></span><span><span> </span></span><span><span>Style</span></span><span><span>&lt;</span></span><span><span>Button</span></span><span><span>&gt;</span></span><span><span> </span></span><span><span>HeaderButton</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> headerButton </span></span><span><span>??=</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>Style</span></span><span><span>&lt;</span></span><span><span>Button</span></span><span><span>&gt;(</span></span><span><span>
        </span></span><span><span>(</span></span><span><span>Button</span></span><span><span>.</span></span><span><span>TextColorProperty</span></span><span><span>,</span></span><span><span> </span></span><span><span>Color</span></span><span><span>.</span></span><span><span>CornflowerBlue</span></span><span><span>),</span></span><span><span>
        </span></span><span><span>(</span></span><span><span>Button</span></span><span><span>.</span></span><span><span>FontSizeProperty</span></span><span><span> </span></span><span><span>,</span></span><span><span> </span></span><span><span>24</span></span><span><span>)</span></span><span><span>
    </span></span><span><span>)</span></span><span><span>   </span></span><span><span>.</span></span><span><span>BasedOn</span></span><span><span> </span></span><span><span>(</span></span><span><span>Implicit</span></span><span><span>.</span></span><span><span>Buttons</span></span><span><span>);</span></span><span><span>
</span></span><span><span>}</span></span></code></pre><h2>2 Build the Search Result – Enums for Grid Rows and Columns</h2><p>A <code><span>Grid</span></code> would be a good choice for the layout of the tweets in the search results. We will use helpers and enums instead of numbers for the rows and columns:</p><pre><code><span><span>enum</span></span><span><span> </span></span><span><span>TweetRow</span></span><span><span>    </span></span><span><span>{</span></span><span><span> </span></span><span><span>Separator</span></span><span><span>,</span></span><span><span> </span></span><span><span>Title</span></span><span><span>,</span></span><span><span> </span></span><span><span>Body</span></span><span><span>,</span></span><span><span> </span></span><span><span>Actions</span></span><span><span> </span></span><span><span>}</span></span><span><span>
</span></span><span><span>enum</span></span><span><span> </span></span><span><span>TweetColumn</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>AuthorImage</span></span><span><span>,</span></span><span><span> </span></span><span><span>Content</span></span><span><span> </span></span><span><span>}</span></span><span><span>

</span></span><span><span>CollectionView</span></span><span><span> </span></span><span><span>SearchResults</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>CollectionView</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>ItemTemplate</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>DataTemplate</span></span><span><span>(()</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> 
    </span></span><span><span>new</span></span><span><span> </span></span><span><span>Grid</span></span><span><span> </span></span><span><span>{</span></span><span><span>
        </span></span><span><span>RowDefinitions</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Rows</span></span><span><span>.</span></span><span><span>Define</span></span><span><span> </span></span><span><span>(</span></span><span><span>
            </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Separator</span></span><span><span>,</span></span><span><span> </span></span><span><span>2</span></span><span><span>   </span></span><span><span>),</span></span><span><span>
            </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Title</span></span><span><span>    </span></span><span><span>,</span></span><span><span> </span></span><span><span>Auto</span></span><span><span>),</span></span><span><span>
            </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Body</span></span><span><span>     </span></span><span><span>,</span></span><span><span> </span></span><span><span>Auto</span></span><span><span>),</span></span><span><span>
            </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Actions</span></span><span><span>  </span></span><span><span>,</span></span><span><span> </span></span><span><span>32</span></span><span><span>  </span></span><span><span>)</span></span><span><span>
        </span></span><span><span>),</span></span><span><span>

        </span></span><span><span>ColumnDefinitions</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Columns</span></span><span><span>.</span></span><span><span>Define</span></span><span><span> </span></span><span><span>(</span></span><span><span>
            </span></span><span><span>(</span></span><span><span>TweetColumn</span></span><span><span>.</span></span><span><span>AuthorImage</span></span><span><span>,</span></span><span><span> </span></span><span><span>70</span></span><span><span>  </span></span><span><span>),</span></span><span><span>
            </span></span><span><span>(</span></span><span><span>TweetColumn</span></span><span><span>.</span></span><span><span>Content</span></span><span><span>    </span></span><span><span>,</span></span><span><span> </span></span><span><span>Star</span></span><span><span>)</span></span><span><span>
        </span></span><span><span>),</span></span><span><span>

        </span></span><span><span>Children</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>{</span></span><span><span>
            </span></span><span><span>new</span></span><span><span> </span></span><span><span>BoxView</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>BackgroundColor</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Color</span></span><span><span>.</span></span><span><span>Gray</span></span><span><span> </span></span><span><span>}</span></span><span><span>
                         </span></span><span><span>.</span></span><span><span>Row</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Separator</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>ColumnSpan</span></span><span><span> </span></span><span><span>(</span></span><span><span>All</span></span><span><span>&lt;</span></span><span><span>TweetColumn</span></span><span><span>&gt;())</span></span><span><span> </span></span><span><span>.</span></span><span><span>Top</span></span><span><span>()</span></span><span><span> </span></span><span><span>.</span></span><span><span>Height</span></span><span><span> </span></span><span><span>(</span></span><span><span>0.5</span></span><span><span>),</span></span><span><span>

            </span></span><span><span>RoundImage</span></span><span><span> </span></span><span><span>(</span></span><span><span> </span></span><span><span>53</span></span><span><span>,</span></span><span><span> nameof</span></span><span><span>(</span></span><span><span>Tweet</span></span><span><span>.</span></span><span><span>AuthorImage</span></span><span><span>)</span></span><span><span> </span></span><span><span>)</span></span><span><span>
                        </span></span><span><span>.</span></span><span><span>Row</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Title</span></span><span><span>,</span></span><span><span> </span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Actions</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>Column</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetColumn</span></span><span><span>.</span></span><span><span>AuthorImage</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>CenterHorizontal</span></span><span><span> </span></span><span><span>()</span></span><span><span> </span></span><span><span>.</span></span><span><span>Top</span></span><span><span> </span></span><span><span>()</span></span><span><span> </span></span><span><span>.</span></span><span><span>Margins</span></span><span><span> </span></span><span><span>(</span></span><span><span>left</span></span><span><span>:</span></span><span><span> </span></span><span><span>10</span></span><span><span>,</span></span><span><span> top</span></span><span><span>:</span></span><span><span> </span></span><span><span>4</span></span><span><span>),</span></span><span><span>

            </span></span><span><span>new</span></span><span><span> </span></span><span><span>Label</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>LineBreakMode</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>LineBreakMode</span></span><span><span>.</span></span><span><span>MiddleTruncation</span></span><span><span> </span></span><span><span>}</span></span><span><span> </span></span><span><span>.</span></span><span><span>FontSize</span></span><span><span> </span></span><span><span>(</span></span><span><span>16</span></span><span><span>)</span></span><span><span>
                       </span></span><span><span>.</span></span><span><span>Row</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Title</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>Column</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetColumn</span></span><span><span>.</span></span><span><span>Content</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>Margins</span></span><span><span> </span></span><span><span>(</span></span><span><span>right</span></span><span><span>:</span></span><span><span> </span></span><span><span>10</span></span><span><span>)</span></span><span><span>
                       </span></span><span><span>.</span></span><span><span>Bind</span></span><span><span> </span></span><span><span>(</span></span><span><span>nameof</span></span><span><span>(</span></span><span><span>Tweet</span></span><span><span>.</span></span><span><span>Header</span></span><span><span>)),</span></span><span><span>

            </span></span><span><span>new</span></span><span><span> </span></span><span><span>Label</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>}</span></span><span><span> </span></span><span><span>.</span></span><span><span>FontSize</span></span><span><span> </span></span><span><span>(</span></span><span><span>15</span></span><span><span>)</span></span><span><span>
                       </span></span><span><span>.</span></span><span><span>Row</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Body</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>Column</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetColumn</span></span><span><span>.</span></span><span><span>Content</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>Margins</span></span><span><span> </span></span><span><span>(</span></span><span><span>right</span></span><span><span>:</span></span><span><span> </span></span><span><span>10</span></span><span><span>)</span></span><span><span>
                       </span></span><span><span>.</span></span><span><span>Bind</span></span><span><span> </span></span><span><span>(</span></span><span><span>Label</span></span><span><span>.</span></span><span><span>FormattedTextProperty</span></span><span><span>,</span></span><span><span> nameof</span></span><span><span>(</span></span><span><span>Tweet</span></span><span><span>.</span></span><span><span>Body</span></span><span><span>),</span></span><span><span> 
                              convert</span></span><span><span>:</span></span><span><span> </span></span><span><span>(</span></span><span><span>List</span></span><span><span>&lt;</span></span><span><span>TextFragment</span></span><span><span>&gt;</span></span><span><span> fragments</span></span><span><span>)</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>Format</span></span><span><span>(</span></span><span><span>fragments</span></span><span><span>)),</span></span><span><span>

            </span></span><span><span>LikeButton</span></span><span><span> </span></span><span><span>(</span></span><span><span> nameof</span></span><span><span>(</span></span><span><span>Tweet</span></span><span><span>.</span></span><span><span>IsLikedByMe</span></span><span><span>)</span></span><span><span> </span></span><span><span>)</span></span><span><span>
                        </span></span><span><span>.</span></span><span><span>Row</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetRow</span></span><span><span>.</span></span><span><span>Actions</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>Column</span></span><span><span> </span></span><span><span>(</span></span><span><span>TweetColumn</span></span><span><span>.</span></span><span><span>Content</span></span><span><span>)</span></span><span><span> </span></span><span><span>.</span></span><span><span>Left</span></span><span><span> </span></span><span><span>()</span></span><span><span> </span></span><span><span>.</span></span><span><span>Top</span></span><span><span> </span></span><span><span>()</span></span><span><span> </span></span><span><span>.</span></span><span><span>Size</span></span><span><span> </span></span><span><span>(</span></span><span><span>24</span></span><span><span>)</span></span><span><span>
                        </span></span><span><span>.</span></span><span><span>BindCommand</span></span><span><span> </span></span><span><span>(</span></span><span><span>nameof</span></span><span><span>(</span></span><span><span>vm</span></span><span><span>.</span></span><span><span>LikeCommand</span></span><span><span>),</span></span><span><span> source</span></span><span><span>:</span></span><span><span> vm</span></span><span><span>)</span></span><span><span>
        </span></span><span><span>}</span></span><span><span>
    </span></span><span><span>})}.</span></span><span><span>Background</span></span><span><span> </span></span><span><span>(</span></span><span><span>Color</span></span><span><span>.</span></span><span><span>FromHex</span></span><span><span>(</span></span><span><span>"171F2A"</span></span><span><span>))</span></span><span><span> 
       </span></span><span><span>.</span></span><span><span>Bind</span></span><span><span> </span></span><span><span>(</span></span><span><span>nameof</span></span><span><span>(</span></span><span><span>vm</span></span><span><span>.</span></span><span><span>SearchResults</span></span><span><span>));</span></span></code></pre><h3>Bind Converters and Commands</h3><p>Note that in the above example hw the <code><span>Bind</span></code> method enables you to specify inline converters:</p><pre><code><span><span>new</span></span><span><span> </span></span><span><span>Label</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>}</span></span><span><span>
           </span></span><span><span>.</span></span><span><span>Bind</span></span><span><span> </span></span><span><span>(</span></span><span><span>Label</span></span><span><span>.</span></span><span><span>FormattedTextProperty</span></span><span><span>,</span></span><span><span> nameof</span></span><span><span>(</span></span><span><span>Tweet</span></span><span><span>.</span></span><span><span>Body</span></span><span><span>),</span></span><span><span> 
                  convert</span></span><span><span>:</span></span><span><span> </span></span><span><span>(</span></span><span><span>List</span></span><span><span>&lt;</span></span><span><span>TextFragment</span></span><span><span>&gt;</span></span><span><span> fragments</span></span><span><span>)</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>Format</span></span><span><span>(</span></span><span><span>fragments</span></span><span><span>))</span></span></code></pre><p>Also note that the <code><span>BindCommand</span></code> helper binds both the <code><span>Command</span></code> and <code><span>CommandParameter</span></code> properties. Here we use it to pass the list item (tweet) that contains a button with the <code><span>LikeCommand</span></code> parameter:</p><pre><code><span><span>new</span></span><span><span> </span></span><span><span>Button</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Text</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>"Like"</span></span><span><span> </span></span><span><span>}</span></span><span><span>
            </span></span><span><span>.</span></span><span><span>BindCommand</span></span><span><span> </span></span><span><span>(</span></span><span><span>nameof</span></span><span><span>(</span></span><span><span>vm</span></span><span><span>.</span></span><span><span>LikeCommand</span></span><span><span>),</span></span><span><span> source</span></span><span><span>:</span></span><span><span> vm</span></span><span><span>)</span></span></code></pre><p><strong>SearchViewModel.cs</strong></p><pre><code><span><span>public</span></span><span><span> </span></span><span><span>ICommand</span></span><span><span> </span></span><span><span>LikeCommand</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> likeCommand </span></span><span><span>??=</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>RelayCommand</span></span><span><span>&lt;</span></span><span><span>Tweet</span></span><span><span>&gt;(</span></span><span><span>Like</span></span><span><span>);</span></span><span><span>

</span></span><span><span>void</span></span><span><span> </span></span><span><span>Like</span></span><span><span>(</span></span><span><span>Tweet</span></span><span><span> tweet</span></span><span><span>)</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>...</span></span><span><span> </span></span><span><span>}</span></span></code></pre><h3>Create Views with Functions</h3><p>In above example, note how <strong>easy</strong> it is to mix standard views with local functions that create views (<code><span>RoundImage</span><span>()</span></code>, <code><span>Format</span><span>()</span></code> and <code><span>LikeButton</span><span>()</span></code>). These functions can be implemented right below the markup that uses them, to make the page read like a story:</p><pre><code><span><span>ImageButton</span></span><span><span> </span></span><span><span>LikeButton</span></span><span><span>(</span></span><span><span>string</span></span><span><span> isLikedPath</span></span><span><span>)</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>ImageButton</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Source</span></span><span><span> </span></span><span><span>=</span></span><span><span> 
    </span></span><span><span>new</span></span><span><span> </span></span><span><span>FontImageSource</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Color</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Color</span></span><span><span>.</span></span><span><span>White</span></span><span><span> </span></span><span><span>}</span></span><span><span>
                         </span></span><span><span>.</span></span><span><span>Bind</span></span><span><span> </span></span><span><span>(</span></span><span><span>FontImageSource</span></span><span><span>.</span></span><span><span>GlyphProperty</span></span><span><span>,</span></span><span><span> isLikedPath</span></span><span><span>,</span></span><span><span> 
                                convert</span></span><span><span>:</span></span><span><span> </span></span><span><span>(</span></span><span><span>bool</span></span><span><span> like</span></span><span><span>)</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> like </span></span><span><span>?</span></span><span><span> </span></span><span><span>"❤"</span></span><span><span> </span></span><span><span>:</span></span><span><span> </span></span><span><span>"♡"</span></span><span><span>)</span></span><span><span>
</span></span><span><span>};</span></span><span><span>

</span></span><span><span>FormattedString</span></span><span><span> </span></span><span><span>Format</span></span><span><span>(</span></span><span><span>List</span></span><span><span>&lt;</span></span><span><span>TextFragment</span></span><span><span>&gt;</span></span><span><span> fragments</span></span><span><span>)</span></span><span><span>
</span></span><span><span>{</span></span><span><span>
    </span></span><span><span>var</span></span><span><span> s </span></span><span><span>=</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>FormattedString</span></span><span><span>();</span></span><span><span>
    fragments</span></span><span><span>?.</span></span><span><span>ForEach</span></span><span><span>(</span></span><span><span>fragment </span></span><span><span>=&gt;</span></span><span><span> s</span></span><span><span>.</span></span><span><span>Spans</span></span><span><span>.</span></span><span><span>Add</span></span><span><span>(</span></span><span><span>
        </span></span><span><span>new</span></span><span><span> </span></span><span><span>Span</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Text</span></span><span><span> </span></span><span><span>=</span></span><span><span> fragment</span></span><span><span>.</span></span><span><span>Text</span></span><span><span>,</span></span><span><span> </span></span><span><span>...</span></span><span><span> </span></span><span><span>}</span></span><span><span>
    </span></span><span><span>));</span></span><span><span>
    </span></span><span><span>return</span></span><span><span> s</span></span><span><span>;</span></span><span><span>
</span></span><span><span>}</span></span></code></pre><p>The <code><span>LikeButton</span><span>()</span></code> is <em>declarative</em> (markup containing logic – an inline convertor), while <code><span>Format</span><span>()</span></code> is <em>imperative</em> (logic containing markup – more <a href="https://dotnet.microsoft.com/apps/aspnet/web-apps/blazor" target="_blank">Blazor</a> style). Although C# Markup aims to improve declarative markup, there are plenty of cases where it is fine to mix in imperative (procedural) functions to build markup.</p><h2>3 Build the Footer – Make a Gesture</h2><p>The footer contains a tappable hyperlink. Here we create it using the <code><span>BindTapGesture</span></code> gesture helper:</p><pre><code><span><span>new</span></span><span><span> </span></span><span><span>Label</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>}</span></span><span><span>
           </span></span><span><span>.</span></span><span><span>FormattedText</span></span><span><span> </span></span><span><span>(</span></span><span><span>
               </span></span><span><span>new</span></span><span><span> </span></span><span><span>Span</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Text</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>"See "</span></span><span><span> </span></span><span><span>},</span></span><span><span>
               </span></span><span><span>new</span></span><span><span> </span></span><span><span>Span</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Text</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>"C# Markup"</span></span><span><span>,</span></span><span><span> </span></span><span><span>Style</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Link</span></span><span><span> </span></span><span><span>}</span></span><span><span>
                         </span></span><span><span>.</span></span><span><span>BindTapGesture</span></span><span><span> </span></span><span><span>(</span></span><span><span>nameof</span></span><span><span>(</span></span><span><span>vm</span></span><span><span>.</span></span><span><span>OpenHelpCommand</span></span><span><span>)),</span></span><span><span>
               </span></span><span><span>new</span></span><span><span> </span></span><span><span>Span</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Text</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>" for more information"</span></span><span><span> </span></span><span><span>}</span></span><span><span>
            </span></span><span><span>)</span></span></code></pre><p>C# Markup contains helpers to conveniently add any type of gesture to any type of view, and to connect them to commands or events.</p><h2>4 Animate the Header – Logic and Markup</h2><p>We will need some UI logic for animation, but we don’t want to mix that logic with the markup. We can separate the logic from the markup by adding a <code><span>.</span><span>logic</span><span>.</span><span>cs</span></code> partial class file:</p><p><strong>SearchPage.logic.cs</strong></p><pre><code><span><span>using</span></span><span><span> </span></span><span><span>Xamarin</span></span><span><span>.</span></span><span><span>Forms</span></span><span><span>;</span></span><span><span>

</span></span><span><span>public</span></span><span><span> </span></span><span><span>partial</span></span><span><span> </span></span><span><span>class</span></span><span><span> </span></span><span><span>SearchPage</span></span><span><span> </span></span><span><span>:</span></span><span><span> </span></span><span><span>ContentPage</span></span><span><span>
</span></span><span><span>{</span></span><span><span>
    </span></span><span><span>readonly</span></span><span><span> </span></span><span><span>SearchViewModel</span></span><span><span> vm</span></span><span><span>;</span></span><span><span>

    </span></span><span><span>public</span></span><span><span> </span></span><span><span>SearchPage</span></span><span><span>(</span></span><span><span>SearchViewModel</span></span><span><span> vm</span></span><span><span>)</span></span><span><span>
    </span></span><span><span>{</span></span><span><span>
        </span></span><span><span>BindingContext</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>this</span></span><span><span>.</span></span><span><span>vm </span></span><span><span>=</span></span><span><span> vm</span></span><span><span>;</span></span><span><span>
        </span></span><span><span>Build</span></span><span><span>();</span></span><span><span>
    </span></span><span><span>}</span></span><span><span>
</span></span><span><span>}</span></span></code></pre><p>Notice that the <code><span>logic</span><span>.</span><span>cs</span></code> file does not use the <code><span>Markup</span></code> namespace; this helps to maintain a clean separation of markup and logic. If a page does not need logic, you can omit the <code><span>.</span><span>logic</span><span>.</span><span>cs</span></code> file and put the page constructor and the base class in the markup file.</p><p>C# Markup offers the <code><span>Assign</span></code> and <code><span>Invoke</span></code> helpers to connect markup to UI logic. Here we use them to animate the header when the entry gets focus:</p><p><strong>SearchPage.cs</strong></p><pre><code><span><span>new</span></span><span><span> </span></span><span><span>StackLayout</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Children</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>{</span></span><span><span>
    </span></span><span><span>Header</span></span><span><span> </span></span><span><span>.</span></span><span><span>Assign</span></span><span><span> </span></span><span><span>(</span></span><span><span>out</span></span><span><span> header</span></span><span><span>),</span></span><span><span>
</span></span><span><span>...</span></span><span><span>

</span></span><span><span>new</span></span><span><span> </span></span><span><span>Entry</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Placeholder</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>"Search"</span></span><span><span> </span></span><span><span>}</span></span><span><span>
           </span></span><span><span>.</span></span><span><span>Invoke</span></span><span><span> </span></span><span><span>(</span></span><span><span>entry </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>{</span></span><span><span>
                entry</span></span><span><span>.</span></span><span><span>Focused</span></span><span><span>   </span></span><span><span>+=</span></span><span><span> </span></span><span><span>Search_FocusChanged</span></span><span><span>;</span></span><span><span> 
                entry</span></span><span><span>.</span></span><span><span>Unfocused</span></span><span><span> </span></span><span><span>+=</span></span><span><span> </span></span><span><span>Search_FocusChanged</span></span><span><span>;</span></span><span><span> 
            </span></span><span><span>})</span></span></code></pre><p><strong>SearchPage.logic.cs</strong></p><pre><code><span><span>View</span></span><span><span> header</span></span><span><span>;</span></span><span><span>

</span></span><span><span>void</span></span><span><span> </span></span><span><span>Search_FocusChanged</span></span><span><span>(</span></span><span><span>object</span></span><span><span> sender</span></span><span><span>,</span></span><span><span> </span></span><span><span>FocusEventArgs</span></span><span><span> e</span></span><span><span>)</span></span><span><span>
</span></span><span><span>{</span></span><span><span>
    </span></span><span><span>ViewExtensions</span></span><span><span>.</span></span><span><span>CancelAnimations</span></span><span><span>(</span></span><span><span>header</span></span><span><span>);</span></span><span><span>
    header</span></span><span><span>.</span></span><span><span>TranslateTo</span></span><span><span>(</span></span><span><span>e</span></span><span><span>.</span></span><span><span>IsFocused</span></span><span><span> </span></span><span><span>?</span></span><span><span> </span></span><span><span>-</span></span><span><span>56</span></span><span><span> </span></span><span><span>:</span></span><span><span> </span></span><span><span>0</span></span><span><span>,</span></span><span><span> </span></span><span><span>0</span></span><span><span>,</span></span><span><span> </span></span><span><span>250</span></span><span><span>,</span></span><span><span> </span></span><span><span>Easing</span></span><span><span>.</span></span><span><span>CubicOut</span></span><span><span>);</span></span><span><span>
</span></span><span><span>}</span></span></code></pre><h2>Done! Any Next Level Tips?</h2><p>We have built the example page. Our story is done!</p><p>This is a good moment to introduce some next level tips for working with C# Markup:</p><h3>Code Snippets</h3><p>When writing C# Markup pages for Xamarin.Forms, some code patterns are often repeated with minor variations. These <a href="https://vincenth.net/blog/2020/06/04/csharp-markup-snippets" target="_blank">C# Markup snippets</a> create some of these patterns for you, and let you specify variations with optional parameters. These snippets can save you a lot of typing.</p><h3>Format Markup</h3><p>You may have noticed that in the above examples the markup does not follow standard C# formatting conventions, while the logic does. Standard C# formatting conventions are historically geared towards logic – which is perfectly <em>logical</em> 😉 when you use a different language for declarative markup, like XAML.</p><p>Declarative markup is by its nature deeply nested; standard logic-like formatting of markup leads to excessive indenting and many lines with only a single bracket on them. On the other hand, markup languages like XAML use a single line end + indent increase between a parent and a child – for good reason. The markup formatting used here aims to achieve similar readability (a C# Markup auto-format tool would really help though – working on that).</p><h3>The Layout Line</h3><p>The layout helpers (e.g. <code><span>Width</span></code> and <code><span>FillExpandHorizontal</span></code>) set properties that determine the <em>location</em> of the view content in the page. There are many layout helpers; by convention they are specified on a single line, ordered spatially outside-in. This is called the <strong>layout line</strong>. It helps to quickly scan markup to build a mental picture of the layout and to zoom in on the location of a view’s content. The layout line is described in detail in the <a href="https://docs.microsoft.com/xamarin/xamarin-forms/user-interface/csharp-markup#layout-line-convention" target="_blank">C# Markup documentation</a>.</p><p>The order of helpers does not matter at runtime; each helper sets different properties. You can order the helpers any way you like; the layout line is just a convention to improve source readability.</p><h3>Bring Your Own Helpers</h3><p>It only takes a single line to add your own helper to C# Markup. For example, this helper lets you use Steven Thewissen’s excellent <a href="https://github.com/sthewissen/Xamarin.Forms.DebugRainbows" target="_blank">DebugRainbows</a> in C# Markup:</p><pre><code><span><span>public</span></span><span><span> </span></span><span><span>static</span></span><span><span> </span></span><span><span>TBindable</span></span><span><span> </span></span><span><span>Rainbow</span></span><span><span>&lt;</span></span><span><span>TBindable</span></span><span><span>&gt;(</span></span><span><span>this</span></span><span><span> </span></span><span><span>TBindable</span></span><span><span> bindable</span></span><span><span>)</span></span><span><span> </span></span><span><span>where</span></span><span><span> </span></span><span><span>TBindable</span></span><span><span> </span></span><span><span>:</span></span><span><span> </span></span><span><span>BindableObject</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>DebugRainbow</span></span><span><span>.</span></span><span><span>SetShowColors</span></span><span><span>(</span></span><span><span>bindable</span></span><span><span>,</span></span><span><span> </span></span><span><span>true</span></span><span><span>);</span></span><span><span> </span></span><span><span>return</span></span><span><span> bindable</span></span><span><span>;</span></span><span><span> </span></span><span><span>}</span></span></code></pre><p>So you can use it like this:</p><pre><code><span><span>new</span></span><span><span> </span></span><span><span>StackLayout</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>Children</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>{</span></span><span><span>
    </span></span><span><span>Header</span></span><span><span> </span></span><span><span>.</span></span><span><span>Rainbow</span></span><span><span> </span></span><span><span>(),</span></span><span><span>
    </span></span><span><span>SearchResults</span></span><span><span>,</span></span><span><span>
    </span></span><span><span>Footer</span></span><span><span>
</span></span><span><span>}};</span></span></code></pre><h2>Closing Remarks</h2><p>C# Markup makes Xamarin.Forms a more attractive alternative for developers who like the single language, declarative approach of modern UI frameworks like Flutter or SwiftUI. For new Xamarin.Forms developers without XAML knowledge, C# Markup shortens the learning curve.</p><p>Last but not least, C# Markup does not force you to choose. Apps with a XAML UI can mix-in C# Markup just fine, e.g. to implement parts of the UI that are too complex / dynamic for XAML.</p><p><a href="https://github.com/VincentH-Net/CSharpForMarkup" target="_blank">CSharpForMarkup</a> has been around for quite some time; e.g. developers that have been using it <a href="https://github.com/xamarin/Xamarin.Forms/pull/8342#issuecomment-581046347" target="_blank">report</a>:</p><blockquote><p>Less obvious advantages become apparent after working this way for a longer time … many times easier to break down larger more complicated views into smaller more manageable pieces … much less use for Styles</p></blockquote><p>C# Markup offers <em>a lot</em> for Xamarin.Forms developers. Try it out, see if <em>you</em> like it!</p><blockquote><p>Note that C# Markup is also part of <a href="https://github.com/dotnet/maui" target="_blank">.NET MAUI</a>, which supports both MVVM and MVU.</p><p>This <a href="https://github.com/dotnet/maui/issues/119" target="_blank">C# Markup for MVU and MVVM</a> MAUI Spec aims to let developers switch and mix MVVM and MVU patterns with minimal markup changes, combining – and improving on – the best of <a href="https://github.com/Clancey/Comet" target="_blank">Comet</a> markup and Forms C# Markup.</p></blockquote><p>Be sure to check out the <a href="https://docs.microsoft.com/xamarin/xamarin-forms/user-interface/csharp-markup" target="_blank">C# Markup documentation</a> for a full overview and more guidance. More is coming in the way of helpers and tooling. If you have questions or ideas, please submit them as comments on the <a href="https://github.com/xamarin/Xamarin.Forms/pull/8342" target="_blank">C# Markup PR</a>. Thanks!</p></div></div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>