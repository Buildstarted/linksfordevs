<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Wacom drawing tablets track the name of every application that you open -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Wacom drawing tablets track the name of every application that you open</h1>
    <section class="post blogpost"> <blockquote> <p>Disclaimer: I haven&#x2019;t asked Wacom for comment about this story because I&#x2019;m not a journalist and I don&#x2019;t know how to do that. I don&#x2019;t believe I&#x2019;ve got anything important wrong, however.</p>
</blockquote> <p>I have a Wacom drawing tablet. I use it to draw cover illustrations for my blog posts, such as this one:</p> <p><img src="/images/wacom-cover.png"></p> <p>Last week I set up my tablet on my new laptop. As part of installing its drivers I was asked to accept Wacom&#x2019;s privacy policy.</p> <p>Being a mostly-normal person I never usually read privacy policies. Instead I vigorously hammer the &#x201C;yes&#x201D; button in an effort to reach the game, machine, or medical advice on the other side of the agreement as fast as possible. But Wacom&#x2019;s request made me pause. Why does a device that is essentially a mouse need a privacy policy? I wondered. Sensing skullduggery, I decided to make an exception to my anti-privacy-policy-policy and give this one a read.</p> <p>In Wacom&#x2019;s defense (that&#x2019;s the only time you&#x2019;re going to see that phrase today), the document was short and clear, although as we&#x2019;ll see it wasn&#x2019;t entirely open about its more dubious intentions (<a href="https://gist.github.com/robert/9690e0f0cf4f72a9f51e36952c2776e2">here&#x2019;s the full text</a>). In addition, despite its attempts to look like the kind of compulsory agreement that must be accepted in order to unlock the product behind it, as far as I can tell anyone with the presence of mind to decline it could do so with no adverse consequences.</p> <p>With that attempt at even-handedness out the way, let&#x2019;s get kicking.</p> <p>In section 3.1 of their privacy policy, Wacom wondered if it would be OK if they sent a few bits and bobs of data from my computer to Google Analytics, &#x201C;[including] aggregate usage data, technical session information and information about [my] hardware device.&#x201D; The half of my heart that cares about privacy sank. The other half of my heart, the half that enjoys snooping on snoopers and figuring out what they&#x2019;re up to, leapt. It was a disjointed feeling, probably similar to how it feels to get mugged by your favorite TV magician.</p> <p><img src="/images/wacom-policy.png"></p> <p>Wacom didn&#x2019;t say exactly what data they were going to send themselves. I resolved to find out.</p> <h2 id="chapter-2-snooping-on-the-snoopers">Chapter 2: Snooping on the snoopers</h2> <p>I began my investigation with a strong presumption of chicanery. I was unable to imagine the project kickoff meeting in which Wacom decided to bundle Google Analytics with their device, which - remember - is essentially a mouse, but managed to restrain themselves from also grabbing some deliciously intrusive information while they were at it. I Googled &#x201C;wacom google analytics&#x201D;. There were a couple of Tweets and Reddit posts made by people who had also read Wacom&#x2019;s privacy policy and been unhappy about its contents, but no one had yet tried to find out exactly what data Wacom were grabbing. No one had investigated Wacom&#x2019;s understanding of the phrase &#x201C;aggregate usage data&#x201D; or whether it was anywhere near that of a reasonable person.</p> <p>I told my son to clear my schedule. He bashed two wooden blocks together in understanding, encouragement, and sheer admiration.</p> <p>In order to see what type of data Wacom was exfiltrating from my computer, I needed to snoop on the traffic that their driver was sending to Google Analytics. The most common way to do this is to set up a <em>proxy server</em> on your computer (I usually use <a href="https://portswigger.net/burp">Burp Suite</a>). You tell your target program to send its traffic through your proxy. Your proxy logs the data it receives, and finally re-sends it on to its intended destination. When the destination sends back a response, the same process runs in reverse.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------------------------+
|My computer                    |
|                               |
|   +------+        +------+    |    +---------+
|   |Wacom +-------&gt;+Burp  +--------&gt;+Google   |
|   |Driver+&lt;-------+Suite +&lt;--------+Analytics|
|   +------+        +-+----+    |    +---------+
|                     | Log requests and responses
|                     v         |
|             /track?data=...   |
|                               |
+---------------------+---------+
</code></pre></div></div> <p>Some applications, like web browsers, co-operate very well with proxies. They allow users to explicitly specify a proxy for them to to send their traffic through. However, other applications (including the Wacom tablet drivers) provide no such conveniences. Instead, they require some special treatment.</p> <h2 id="chapter-3-wireshark">Chapter 3: Wireshark</h2> <p>I started with a simple approach that was unlikely to work but was worth a try. I opened <a href="https://www.wireshark.org/">Wireshark</a>, a program that watches your computer&#x2019;s network traffic. I wanted to use Wireshark to view the raw bytes that the Wacom driver was sending to Google Analytics. If Wacom was sending my data over unencrypted HTTP then I&#x2019;d immediately be able to see all of its gory details, no extra work required. On the other hand, if Wacom was using <a href="https://robertheaton.com/2014/03/27/how-does-https-actually-work/">encrypted TLS/HTTPS</a> then I would be foiled. The traffic would appear as garbled nonsense that I would be unable to decrypt, since I wouldn&#x2019;t know the keys used to encrypt it. I closed any noisy, network-connecting programs to reduce the chatter on the line, pressed Wireshark&#x2019;s record button, and held onto my hat.</p> <p>Unfortunately, no unencrypted HTTP traffic appeared; only encrypted, garbled TLS. But there was good news amidst this setback. Wireshark also picks up DNS requests, which are used to look up the IP address that corresponds to a domain. I saw that my computer was making DNS requests to look up the IP address of <code class="language-plaintext highlighter-rouge">www.google-analytics.com</code>. The DNS response was coming back as <code class="language-plaintext highlighter-rouge">172.217.7.14</code>, and lots of TLS-encrypted traffic was then heading out to that IP address. This meant that <em>something</em> was indeed talking to Google Analytics.</p> <p><img src="/images/wacom-dns.png"></p> <p>I switched tactics and fired up Burp Suite proxy.</p> <h2 id="chapter-4-burp-suite">Chapter 4: Burp Suite</h2> <p>I now had two problems. First, I needed to persuade Wacom to send its Google Analytics traffic through Burp Suite. Second, I needed to make sure that Wacom would then complete a <em>TLS handshake</em> with Burp. To solve the first problem, I configured my laptop&#x2019;s global HTTP and HTTPS proxies to point to Burp Suite. This meant that every program that respected these global settings would send its traffic through my proxy.</p> <p><img src="/images/wacom-proxy-settings.png"></p> <p>Happily, it turned out that Wacom did respect my global proxy settings - my proxy quickly started logging &#x201C;client failed TLS handshake&#x201D; messages.</p> <p>This brought me to my second problem. Since Wacom was talking to Google Analytics over TLS, it required the server to present a valid TLS certificate for <code class="language-plaintext highlighter-rouge">www.google-analytics.com</code>. As far as Wacom is concerned, my proxy was now the server that it is talking to, not Google Analytics itself. This meant that I needed my proxy to present a certificate that Wacom would trust.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  (Burp must present a valid cert for www.google-analytics.com)
                      |
+---------------------|---------+
|My computer          |         |
|                     v         |
|   +------+        +------+    |    +---------+
|   |Wacom +-------&gt;+Burp  +--------&gt;+Google   |
|   |Driver+&lt;-------+Suite +&lt;--------+Analytics|
|   +------+        +-+----+    |    +---------+
|                     | Log requests and responses
|                     v         |
|             /track?data=...   |
|                               |
+---------------------+---------+
</code></pre></div></div> <p>The most difficult part of presenting such a certificate is that it needs to be <em>cryptographically signed</em> by a <em>certificate authority</em> that the program trusts. Burp Suite can generate and sign certificates for any domain, no problem, but since by default no computer or program trusts Burp Suite as a certificate authority, the certificates it signs are rejected (I&#x2019;ve written much more about TLS and HTTPS <a href="https://robertheaton.com/2014/03/27/how-does-https-actually-work/">here</a> and <a href="https://robertheaton.com/2018/11/28/https-in-the-real-world/">here</a>).</p> <p>Once again, the process of persuading a web browser to trust Burp&#x2019;s root certificate is well-documented, but for a thick application like Wacom I&#x2019;d need to do something slightly different. I therefore used OSX&#x2019;s Keychain to temporarily add Burp&#x2019;s certificate to my computer&#x2019;s list of root certificates.</p> <p><img src="/images/wacom-cert.png"></p> <p>I assumed that Wacom would load its list of root certificates from my computer, and that by adding Burp to this list, Wacom would start to trust Burp and would complete a TLS handshake with my proxy.</p> <p>I sat and waited. I watched Wireshark and Burp at the same time. If Wacom failed to connect to Burp, I&#x2019;d see this failure in Wireshark. I was quite excited.</p> <p>Nothing happened.</p> <p>I wondered if the data dumping was triggered by a timer, or by some particular activity, or by both. I tried drawing something using my Wacom tablet. Still nothing. I plugged and unplugged it. Nothing. Then I went into the Wacom Driver Settings and restarted the driver.</p> <p><img src="/images/wacom-restart.png"></p> <p>Everything happened.</p> <p>When I restarted the Wacom driver, rather than lose all the data it had accumulated, the driver fired off everything it had collected to Google Analytics. This data materialized in my Burp Suite. I took a look. My heart experienced the same half-down-half-up schism as it had half an hour ago.</p> <p>Some of the events that Wacom were recording were arguably within their purview, such as &#x201C;driver started&#x201D; and &#x201C;driver shutdown&#x201D;. I still don&#x2019;t want them to take this information because there&#x2019;s nothing in it for me, but their attempt to do so feels broadly justifiable. What requires more explanation is why Wacom think it&#x2019;s acceptable to record every time I open a new application, including the time, a string that presumably uniquely identifies me, and the application&#x2019;s name.</p> <p><img src="/images/wacom-evidence-4.png"></p> <h2 id="chapter-5-analysis">Chapter 5: Analysis</h2> <p>I suspect that Wacom doesn&#x2019;t really think that it&#x2019;s acceptable to record the name of every application I open on my personal laptop. I suspect that this is why their privacy policy doesn&#x2019;t really admit that this is what that they do. I imagine that if pressed they would argue that the name of every application I open on my personal laptop falls into one of their broad buckets like &#x201C;aggregate data&#x201D; or &#x201C;technical session information&#x201D;, although it&#x2019;s not immediately obvious to me which bucket.</p> <p>It&#x2019;s well-known that no one reads privacy policies and that they&#x2019;re often a fig leaf of consent at best. But since Wacom&#x2019;s privacy policy makes no mention of their intention to record the name of every application I open on my personal laptop, I&#x2019;d argue that it doesn&#x2019;t even give them the technical-fig-leaf-right to do so. In fact, I&#x2019;d argue that even if someone had read and understood Wacom&#x2019;s privacy policy, and had knowingly consented to a reasonable interpretation of the words inside it, that person would still not have agreed to allow Wacom to log and track the name of every application that they opened on their personal laptop.</p> <p>Of course, I&#x2019;m not a lawyer, and I assume that whoever wrote this privacy policy is.</p> <p>Wacom&#x2019;s privacy policy does say that they only want this data for product development purposes, and on this point I do actually believe them. This might be naive, since who knows what goes on behind the scenes when large troves of data are involved. Either way, while I do understand that product developers like to have usage data in order to monitor and improve their offerings, this doesn&#x2019;t give them the right to take it.</p> <p>I care about this for two reasons.</p> <p>The first is a principled fuck you. I don&#x2019;t care whether anything materially bad will or won&#x2019;t happen as a consequence of Wacom taking this data from me. I simply resent the fact that they&#x2019;re doing it.</p> <p>The second is that we can also come up with scenarios that involve real harms. Maybe the very existence of a program is secret or sensitive information. What if a Wacom employee suddenly starts seeing entries spring up for &#x201C;Half Life 3 Test Build&#x201D;? Obviously I don&#x2019;t care about the secrecy of Valve&#x2019;s new games, but I assume that Valve does.</p> <p>We can get more subtle. I personally use Google Analytics to track visitors to my website. I do feel bad about this, but I&#x2019;ve got to get my self-esteem from somewhere. Google Analytics has a &#x201C;User Explorer&#x201D; tool, in which you can zoom in on the activity of a specific user. Suppose that someone at Wacom &#x201C;fingerprints&#x201D; a target person that they knew in real life by seeing that this person uses a very particular combination of applications. The Wacom employee then uses this fingerprint to find the person in the &#x201C;User Explorer&#x201D; tool. Finally the Wacom employee sees that their target also uses &#x201C;LivingWith: Cancer Support&#x201D;.</p> <p>Remember, this information is coming from a device that is essentially a mouse.</p> <p>This example is admittedly a little contrived, but it&#x2019;s also an illustration that, even though this data doesn&#x2019;t come with a name and social security number attached, it is neither benign nor inert.</p> <h2 id="chapter-6-conclusion">Chapter 6: Conclusion</h2> <p>In some ways it feels unfair to single out Wacom. This isn&#x2019;t the dataset that&#x2019;s going to complete the embrace of full, totalitarian surveillance capitalism. Nonetheless, it&#x2019;s still deeply obnoxious. A device that is essentially a mouse has no legitimate reasons to make HTTP requests of any sort. Maybe Wacom could hide in the sweet safety of murky territory if they released some sort of mobile app integration or a weekly personal usage report that required this data, but until then I&#x2019;m happy to classify them as an obligingly clear case of nefariousness.</p> <p>Nonetheless, I&#x2019;m not about to incinerate my Wacom tablet and buy a different one. These things are expensive, and privacy is hard to put a price on. If you too have a Wacom tablet (presumably this tracking is enabled for all of their models), open up the &#x201C;Wacom Desktop Center&#x201D; and click around until you find a way to disable the &#x201C;Wacom Experience Program&#x201D;. Then the next time you&#x2019;re buying a tablet, remember that Wacom tries to track every app you open, and consider giving another brand a go.</p> <h2 id="epilogue">Epilogue</h2> <p>I finished the first draft of this article three weeks ago. I set up Burp Suite proxy again so that I could grab some final screenshots of the data that Wacom was purloining. I restarted the Wacom driver, as per usual. But nothing happened. Wacom weren&#x2019;t illegitimately siphoning off my personal usage data any more.</p> <p>The bastards.</p> <p>I contemplated pretending I hadn&#x2019;t seen this and publishing my post anyway. Then I contemplated publishing it with an additional coda explaining this latest development. However, the title &#x201C;Wacom drawing tablets used to track the name of every application that you open but now seem to have stopped for some reason&#x201D; didn&#x2019;t feel very snappy. I decided to do some more investigating.</p> <p>I had previously noticed that, before sending data to Google Analytics, the Wacom driver sent a <code class="language-plaintext highlighter-rouge">HEAD</code> request to the URL <code class="language-plaintext highlighter-rouge">http://link.wacom.com/analytics/analytics.xml</code>. I hadn&#x2019;t been able to work out why, and until now I hadn&#x2019;t thought much of it. However, now Wacom was responding to this request with a 404 &#x201C;Not Found&#x201D; status code instead of 200 &#x201C;OK&#x201D;. I realized that the request must be some kind of pre-flight check that allowed Wacom to turn off analytics collection remotely without requiring users to install a driver update. Now that the request was failing, Wacom were not sending themselves my data.</p> <p>I dug around in the driver&#x2019;s logfile and found the following snippet that confirmed my suspicions:</p> <p><img src="/images/wacom-log.png"></p> <p>I wondered if Wacom had gotten wise to what I was up to and panic-disabled their tracking. This seemed unlikely, although the timing was rather coincidental. I decided that Wacom had probably simply made a boneheaded mistake and accidentally broken their own command-and-control center. I impatiently waited for them to realize their goof and bring their data exfiltration operation back online. I contemplated emailing Wacom to alert them to their problem, but couldn&#x2019;t come up with a sufficiently innocuous way of doing so.</p> <p>I decided to wait until the end of the month before doing anything, in case the data was used for generating monthly reports. I hoped that on January 31st Wacom would notice that their graphs were broken and bring their system back online.</p> <p>On February 3rd I checked in and was elated at what I saw:</p> <p><img src="/images/wacom-hi-rick.png"></p> <p>I had no idea who Rick was, but I was glad he was back. Wacom were illegitimately siphoning off my personal data again, and I couldn&#x2019;t be happier. I grabbed some better screenshots, fixed some grammar, and hit publish. The rest is history.</p> <div> <a href="https://twitter.com/robjheaton"> Follow me on Twitter </a> or <a href="/newsletter"> Subscribe via email </a> </div> <h3>More on Online Tracking</h3> <br> <section> </section> </section>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>