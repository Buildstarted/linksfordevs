<!DOCTYPE html>
<html lang="en">
<head>
    <title>
KNOB Attack -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>KNOB Attack</h1><div><div id="about" class="about"><h2 class="section-title">About the KNOB Attack</h2><p>TL;DR: The specification of Bluetooth includes an encryption key negotiation protocol that allows to negotiate encryption keys with 1 Byte of entropy without protecting the integrity of the negotiation process. A remote attacker can manipulate the entropy negotiation to let any standard compliant Bluetooth device negotiate encryption keys with 1 byte of entropy and then brute force the low entropy keys in real time.</p><p itemprop="description">
	      Bluetooth is a wireless communication protocol commonly used
	      between low power devices to transfer data, e.g., between
	      a wireless headset and a phone, or between two laptops.
	      Bluetooth communications might
	      contain private and/or sensitive data, and the Bluetooth
	      standard provides security features to protect against
	      someone who wants to eavesdrop and/or manipulate your information.
        We found and exploited a severe vulnerability in the Bluetooth specification that
	      allows an attacker to break the security
	      mechanisms of Bluetooth for any standard-compliant device. As a
	      result, an attacker is able to the listen, or change
	      the content of, nearby Bluetooth communication, even between
	      devices that have previously been successfully paired.

		  </p><p>We call our attack the <b>Key Negotiation of
	      Bluetooth</b> (KNOB) Attack. Because this attack affects
	      basically all devices that "speak Bluetooth", we decided
	      to coordinate public disclosure with industry to try to
	      make sure that workarounds could be put in place. In
	      November 2018 we shared details of the attack with the
	      Bluetooth Special Interest Group (Bluetooth
	      SIG)—the standards organisation that oversees the
	      development of Bluetooth standards—as well as the
	      CERT Coordination Center and the International
	      Consortium for Advancement of Cybersecurity on the
	      Internet (ICASI)—an industry led coordination body
	      founded by Intel, Microsoft, Cisco, Juniper and
	      IBM.</p><p>Video recording of the KNOB attack presentation at USENIX Security 2019 by Daniele Antonioli:</p><p>For more information on affected systems
		see <a href="https://www.kb.cert.org/vuls/id/918987/">
		CVE-2019-9506 </a>. The technical details of the attack are
  available in our <a href="https://www.usenix.org/conference/usenixsecurity19/presentation/antonioli">research paper</a> and our <a href="https://francozappa.github.io/publication/knob/slides.pdf">slides</a>. Our <a href="https://github.com/francozappa/knob">repository</a> contains the code that we developed to implement and test the KNOB attack, including our <a href="https://github.com/francozappa/knob/tree/master/poc-internalblue">PoC</a> and the <a href="https://github.com/francozappa/knob/tree/master/e0">code for E0</a>.</p></div><div id="vulnerable" class="cfp"><h2 class="section-title">Are my Devices Vulnerable?</h2><p itemprop="description">
	      The KNOB attack is possible due to flaws in the
	      Bluetooth specification. As such, any standard-compliant
	      Bluetooth device can be expected to be vulnerable. We
	      conducted KNOB attacks on more than 17 unique Bluetooth
	      chips (by attacking 24 different devices). At the time
	      of writing, we were able to test chips from Broadcom,
	      Qualcomm, Apple, Intel, and Chicony manufacturers. <b>All
	      devices that we tested were vulnerable to the KNOB
	      attack</b>.</p><p>After we disclosed our attack to industry in late 2018,
	      some vendors might have implemented workarounds for the
	      vulnerability on their devices. So the short answer is: if
	      your device was not updated after late 2018, it is likely
	      vulnerable. Devices updated afterwards might be fixed.
	    </p><p><b>References (not exhaustive)</b>:
          [Bluetooth SIG:
            <a href="https://www.bluetooth.org/docman/handlers/DownloadDoc.ashx?doc_id=470741">Erratum 11838</a><a href="https://www.bluetooth.com/security/statement-key-negotiation-of-bluetooth/">note</a>]
          [<a href="https://nvd.nist.gov/vuln/detail/CVE-2019-9506">NVD NIST</a>]
          [<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9506">CVE</a>]
          [<a href="https://www.kb.cert.org/vuls/id/918987/">CERT</a>]
          [<a href="https://software.intel.com/security-software-guidance/insights/more-information-exploiting-low-entropy-encryption-key-negotiation-bluetooth-bredr">Intel</a>]
          [<a href="https://community.cypress.com/thread/48761?start=0&amp;tstart=0">Cypress (login required)</a>]
          [<a href="https://android.googlesource.com/platform/frameworks/base/+/6110c95184c6ca0265ebc39235ca81da21c0483d">Android</a>]
          [<a href="https://www.marvell.com/documents/hp4hzgvjmpm46b7wnlbe/">Marvell</a>]
          [<a href="https://www.huawei.com/en/psirt/security-advisories/huawei-sa-20190828-01-knob-en">Huawei</a>]
          [<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-9506">Microsoft</a>]
          [Apple:
            <a href="https://support.apple.com/en-in/HT210348">macOS</a><a href="https://support.apple.com/en-gb/HT210346">iOS</a><a href="https://support.apple.com/en-us/HT210353">watchOS</a>]
            <a href="">tvOS</a>]
          [Linux:
            <a href="https://security-tracker.debian.org/tracker/CVE-2019-9506">debian</a><a href="https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-9506">Red Hat</a><a href="https://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-9506.html">Ubuntu</a>]
          [Github:
            <a href="https://github.com/search?q=%22CVE-2019-9506%22&amp;type=Code">CVE code</a><a href="https://github.com/search?q=%22CVE-2019-9506%22&amp;type=Issues">CVE issues</a>]
          [<a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190813-bluetooth">CISCO</a>]
          [<a href="https://support.blackberry.com/kb/articleDetail?articleNumber=000057251">BlackBerry</a>]
      </p></div><div id="team" class="about"><h2 class="section-title">Team</h2><p>The KNOB attack was
	    identified, investigated, and demonstrated by an
	      international team of researchers.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>