<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Introduction to quantum computing with Q# &#x2013; Part 4, multi-qubit gates - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Introduction to quantum computing with Q# &#x2013; Part 4, multi-qubit gates - linksfor.dev(s)"/>
    <meta property="og:description" content="In the previous post of this series, we discussed single qubit gates. In this next instalment, we are going to explore gates that act on multiple qubits at once, thus completing the exploration of quantum circuit building. We are also going to slowly, but diligently uncover the underlying theoretical scheme towards one of the most bizarre concepts in quantum mechanics &#x2013; entanglement, which is something that will be dedicating the next part to."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.strathweb.com/2020/06/introduction-to-quantum-computing-with-q-part-4-multi-qubit-gates/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Introduction to quantum computing with Q# &#x2013; Part 4, multi-qubit gates</title>
<div class="readable">
        <h1>Introduction to quantum computing with Q# &#x2013; Part 4, multi-qubit gates</h1>
            <div>Reading time: 24-30 minutes</div>
        <div>Posted here: 24 Jun 2020</div>
        <p><a href="https://www.strathweb.com/2020/06/introduction-to-quantum-computing-with-q-part-4-multi-qubit-gates/">https://www.strathweb.com/2020/06/introduction-to-quantum-computing-with-q-part-4-multi-qubit-gates/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
														<p>In the <a href="https://www.strathweb.com/2020/05/introduction-to-quantum-computing-with-q-part-3-single-qubit-gates/">previous post</a> of this series, we discussed single qubit gates. In this next instalment, we are going to explore gates that act on multiple qubits at once, thus completing the exploration of quantum circuit building. We are also going to slowly, but diligently uncover the underlying theoretical scheme towards one of the most bizarre concepts in quantum mechanics – entanglement, which is something that will be dedicating the next part to.</p>

<h3 id="toc_1">Mathematics and philosophy of multi qubit registers</h3>
<p>Once the quantum computational system grows from a single to multiple qubits, we arrive at a concept of a compound quantum system. <a href="https://www.springer.com/gp/book/9783540921271">Greg Jaeger</a>, in his excellent study of entanglement, reminds us of a mathematical framework in which such systems are embedded:</p>
<blockquote>
<p>The Hilbert space of a compound quantum system is the tensor product of the Hilbert spaces of the subsystems. The pure-state space for a system of <span></span><span id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span> two-level systems is the Hilbert space <span></span><span id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>H</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>C</mi></mrow><mn>2</mn></msup><mo>&amp;#x2297;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>C</mi></mrow><mn>2</mn></msup><mo>&amp;#x2297;</mo><mo>&amp;#x2026;</mo><mo>&amp;#x2297;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>C</mi></mrow><mn>2</mn></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow><mi mathvariant="script">H</mi></mrow><mrow><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mrow><mi mathvariant="double-struck">C</mi></mrow><mn>2</mn></msup><mo>⊗</mo><msup><mrow><mi mathvariant="double-struck">C</mi></mrow><mn>2</mn></msup><mo>⊗</mo><mo>…</mo><mo>⊗</mo><msup><mrow><mi mathvariant="double-struck">C</mi></mrow><mn>2</mn></msup></math></span></span>.</p>
</blockquote>
<p>As such, from the quantum information theory point of view, when dealing with multiple qubits, the overall state of the system is described not by a sum, but by a <a href="https://en.wikipedia.org/wiki/Tensor_product">tensor product</a> of all the individual qubit constituents (or, to be more formal, subsystems), represented below by <span></span><span id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C8;</mi><mi>n</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ψ</mi><mi>n</mi></msub></math></span></span>.  </p>
<p><span></span><span><span id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mi>&amp;#x03C8;</mi><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2026;</mo><mo>&amp;#x2297;</mo><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mi>n</mi></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mi>ψ</mi><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow><mo>…</mo><mo>⊗</mo><mrow><mo>|</mo><msub><mi>ψ</mi><mi>n</mi></msub><mo>⟩</mo></mrow></math></span></span></span></p>
<p>As it was determined in the earlier parts of this series, quantum gates are represented by <span></span><span id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mi>n</mi></msup><mo>&amp;#x2217;</mo><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>n</mi></msup><mo>∗</mo><msup><mn>2</mn><mi>n</mi></msup></math></span></span> sized unitary matrices, where <span></span><span id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span> stands for the number of qubits the gate acts on. This definition naturally implies that while single qubit matrices are <span></span><span id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span>x<span></span><span id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span> in size, two-qubit gates are going to be <span></span><span id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>4</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span>x<span></span><span id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>4</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span> matrices, representing a 4-dimensional abstract complex vector spaces, or more specifically, after Jaeger, Hilbert spaces. The tensor product qualification is an important one, because that is what gives rise to the <span></span><span id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span> dimensions. For example, for single qubits, the computational basis consists of two basic unit vectors</p>
<p>
<span></span><span><span id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span>
</p>
<p>Applying the tensor product between them, we get four dimensional standard basis vectors for two qubit systems</p>
<p>
<span></span><span><span id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span>
</p>
<p>We could extrapolate this calculations onto larger qubit registers using the exact same mathematics. At the time of writing, the largest available quantum computer was constructed by Google and consists of 53 qubits. Describing a complete state of such a system requires <span></span><span id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>53</mn></mrow></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow><mn>53</mn></mrow></msup></math></span></span> dimensional Hilbert space, and <span></span><span id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>53</mn></mrow></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow><mn>53</mn></mrow></msup></math></span></span> is a really large number – <span></span><span id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>9</mn><mo>,</mo><mn>007</mn><mo>,</mo><mn>199</mn><mo>,</mo><mn>254</mn><mo>,</mo><mn>740</mn><mo>,</mo><mn>992</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>9</mn><mo>,</mo><mn>007</mn><mo>,</mo><mn>199</mn><mo>,</mo><mn>254</mn><mo>,</mo><mn>740</mn><mo>,</mo><mn>992</mn></math></span></span>. And that’s not even the end – in quantum mechanics in general, in case of continuous variables, the mathematical structure is actually infinite-dimensional.</p>
<p>Of course such rigorous mathematical formalism – contrary to classical physics – makes it impossible to directly infer any structure of reality from the quantum mechanical equations, something that Einstein had lots of trouble with. Arkady Plotnitsky summarizes this situation in <a href="https://www.springer.com/gp/book/9783319320663">The Principles of Quantum Theory, From Planck’s Quanta to the Higgs Boson</a>:</p>
<blockquote>
<p>His [Heisenberg’s] new theory offers the possibility of predicting, in general probabilistically, the outcomes of quantum experiments, at the cost of abandoning the physical description or representation, however idealized, of the ultimate objects and processes considered. This cost was unacceptable to some, event to most, beginning with Einstein (…). The nature of the mathematics used, that of the infinite-dimensional Hilbert spaces over complex numbers, already makes it difficult to establish realist representations of physical processes.</p>
</blockquote>
<p>A similar sentiment, along the lines of completely detaching this strange, complicated mathematical form of expression from the underlying reality, by the way something that falls in line with the “spirit of Copenhagen” (which we briefly mentioned in the earlier part of this series), has been also expressed by David Mermin in his contribution to <a href="https://www.springer.com/de/book/9783642208799">Elegance and Enigma</a>:</p>
<blockquote>
<p>Quantum states, in other words, are bookkeeping tools that enable one to calculate, from a knowledge of the initial preparation and the fields acting on the system, the probability of the outcomes of the measurements on that system. (…) The Copenhagen view fits quantum computation so well that I am persuaded that quantum states are, even in the broader physical contexts, calculational tools, invented and used by physicists to enable them to predict correlations among their perceptions.</p>
</blockquote>
<p>Leaving the philosophical debates about the nature of reality aside for now, let’s consider the following two qubit system, where the two qubits are in states <span></span><span id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow></math></span></span> and the probability amplitudes are <span></span><span id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B1;</mi><mn>1</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mn>1</mn></msub></math></span></span>, <span></span><span id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B2;</mi><mn>1</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>1</mn></msub></math></span></span> and <span></span><span id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B1;</mi><mn>2</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mn>2</mn></msub></math></span></span>, <span></span><span id="MathJax-Element-24-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B2;</mi><mn>2</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>2</mn></msub></math></span></span> respectively. As thoroughly analyzed in the earlier parts of this series, each qubit can written as a linear combination of two basis states.</p>
<p><span></span><span><span id="MathJax-Element-25-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><msub><mi>&amp;#x03B1;</mi><mn>1</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mo>+</mo><msub><mi>&amp;#x03B2;</mi><mn>1</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>1</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-26-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><msub><mi>&amp;#x03B1;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mo>+</mo><msub><mi>&amp;#x03B2;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span></span></p>
<p>The state of this two qubit system is then expressed by the tensor product of <span></span><span id="MathJax-Element-27-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow></math></span></span>:</p>
<p><span></span><span><span id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><msub><mi>&amp;#x03B1;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B1;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mo>+</mo><msub><mi>&amp;#x03B1;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B2;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow><mspace linebreak=&quot;newline&quot; /><mo>+</mo><msub><mi>&amp;#x03B2;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B1;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mo>+</mo><msub><mi>&amp;#x03B2;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B2;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>α</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>β</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow><mspace linebreak="newline"></mspace><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>α</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>β</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span></span> </p>
<p>Additionally, in the Dirac braket notation, it is customary to merge the neighbouring kets into a single ket, to make the entire equation more succinct and readable:</p>
<p><span></span><span><span id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><msub><mi>&amp;#x03B1;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B1;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow><mo>+</mo><msub><mi>&amp;#x03B1;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B2;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow><mspace linebreak=&quot;newline&quot; /><mo>+</mo><msub><mi>&amp;#x03B2;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B1;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow><mo>+</mo><msub><mi>&amp;#x03B2;</mi><mn>1</mn></msub><msub><mi>&amp;#x03B2;</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>α</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>β</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow><mspace linebreak="newline"></mspace><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>α</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>β</mi><mn>2</mn></msub><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow></math></span></span></span> </p>
<p>The above equation is also important because we will return to it when we look at entanglement. When working with multi-qubit registers, we can always combine single-qubit unitary transformations to produce a multi-qubit transformation (gate). This is done by expressing those transformations as tensor products of single qubit transformations. Following this rule, <span></span><span id="MathJax-Element-31-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi><mo>&amp;#x2297;</mo><mi>Z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi><mo>⊗</mo><mi>Z</mi></math></span></span> is the same as <span></span><span id="MathJax-Element-32-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi><mo>&amp;#x2297;</mo><mi>I</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi><mo>⊗</mo><mi>I</mi></math></span></span> followed by <span></span><span id="MathJax-Element-33-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mo>&amp;#x2297;</mo><mi>Z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>⊗</mo><mi>Z</mi></math></span></span>, where <span></span><span id="MathJax-Element-34-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span> is the identity gate.</p>
<p>The opposite, however, is not always possible – not every multi-qubit transformation can be decomposed into a set of single qubit ones. The reason behind this is, again, the embodiment of the weirdness of quantum phenomena – some of the subsystems (qubits) may be entangled, and thus their states are not possible to be expressed individually anymore. However, as mentioned, for now we are going to attempt to steer away from the depths of entanglement though, as we are going to dedicate the entire next post to it.</p>
<h3 id="toc_2">The CNOT Gate</h3>
<p><a href="https://www.strathweb.com/wp-content/uploads/2020/06/cnot.png"><img src="https://www.strathweb.com/wp-content/uploads/2020/06/cnot.png" alt="" srcset="https://www.strathweb.com/wp-content/uploads/2020/06/cnot.png 472w, https://www.strathweb.com/wp-content/uploads/2020/06/cnot-300x119.png 300w" sizes="(max-width: 472px) 100vw, 472px"></a></p>
<p>By far the most fundamental, commonly used, and the most powerful two-qubit gate is the CNOT gate. CNOT stands for a “controlled NOT”, which means it acts like the single qubit NOT (<span></span><span id="MathJax-Element-35-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span>) gate but in a conditional way, where the condition spans onto the second qubit. The gate is also often referred to as “controlled bitflip”. CNOT treats the first qubit as a so-called “control qubit” and the second one as a “target qubit”. Upon application of CNOT, the value of the control qubit doesn’t change, while target qubit may change conditionally – depending on the value of the control qubit. A partial counterpart to the logic behind CNOT in classical computing is the XOR operation, or the so called exclusive OR, because the change in the target qubit value upon measurement would correspond to the XOR logic.</p>
<p>For two classic bit inputs XOR logic returns <span></span><span id="MathJax-Element-36-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span> when the two inputs are both <span></span><span id="MathJax-Element-37-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span> or both <span></span><span id="MathJax-Element-38-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span>, and <span></span><span id="MathJax-Element-39-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span> when the two input values differ – one is a <span></span><span id="MathJax-Element-40-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span> and the other a <span></span><span id="MathJax-Element-41-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span>. Similarly, if we leave aside the quantum mechanical concept of a superposition and the complexities arising from that, and only imagine that the qubit can only be in one of the two basis states <span></span><span id="MathJax-Element-42-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-43-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span> (thus behaving like a classical bit), we can summarize the effect of CNOT gate accordingly – when the control qubit is <span></span><span id="MathJax-Element-44-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow></math></span></span>, then the target qubit doesn’t change its value. However, when the control qubit is <span></span><span id="MathJax-Element-45-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span>, the value of the target swapped is swapped – from <span></span><span id="MathJax-Element-46-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow></math></span></span> to <span></span><span id="MathJax-Element-47-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span> and vice versa.</p>
<p><span></span><span><span id="MathJax-Element-48-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-49-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-50-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-51-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow></math></span></span></span></p>
<p>CNOT is mathematically expressed using the following matrix:</p>
<p><span></span><span><span id="MathJax-Element-52-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span>
</p>
<p>The CNOT gate is unitary and is its own inverse and thus can be applied twice in a row to reverse its result. In other words, given an initial quantum state <span></span><span id="MathJax-Element-53-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mi>&amp;#x03C8;</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mi>ψ</mi><mo>⟩</mo></mrow></math></span></span>, the following relation holds:</p>
<p><span></span><span><span id="MathJax-Element-54-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mo stretchy=&quot;false&quot;>(</mo><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mrow><mo>|</mo><mi>&amp;#x03C8;</mi><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>|</mo><mi>&amp;#x03C8;</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mo stretchy="false">(</mo><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mrow><mo>|</mo><mi>ψ</mi><mo>⟩</mo></mrow><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>|</mo><mi>ψ</mi><mo>⟩</mo></mrow></math></span></span></span></p>
<p>There is an easy way to prove this. Let’s consider that we start in an initial quantum system state <span></span><span id="MathJax-Element-55-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03C6;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>φ</mi><mn>2</mn></msub><mo>⟩</mo></mrow></math></span></span>, where the control qubit is in the state <span></span><span id="MathJax-Element-56-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>φ</mi><mn>1</mn></msub></math></span></span> and the target qubit is in the state <span></span><span id="MathJax-Element-57-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C6;</mi><mn>2</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>φ</mi><mn>2</mn></msub></math></span></span>. Applying CNOT gate once will transform the system state to <span></span><span id="MathJax-Element-58-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>&amp;#x2295;</mo><msub><mi>&amp;#x03C6;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>φ</mi><mn>2</mn></msub><mo>⟩</mo></mrow></math></span></span>. Applying CNOT again will further transform that to <span></span><span id="MathJax-Element-59-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>&amp;#x2295;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>&amp;#x2295;</mo><msub><mi>&amp;#x03C6;</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>⊕</mo><mo stretchy="false">(</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>φ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>⟩</mo></mrow></math></span></span>. Since the XOR logic is commutative and associative, we can actually replace <span></span><span id="MathJax-Element-60-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>&amp;#x2295;</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>φ</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>φ</mi><mn>1</mn></msub></math></span></span> with <span></span><span id="MathJax-Element-61-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span> (recall that XOR returns <span></span><span id="MathJax-Element-62-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span> when both inputs are the same), which leads to <span></span><span id="MathJax-Element-63-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>,</mo><mn>0</mn><mo>&amp;#x2295;</mo><msub><mi>&amp;#x03C6;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>,</mo><mn>0</mn><mo>⊕</mo><msub><mi>φ</mi><mn>2</mn></msub><mo>⟩</mo></mrow></math></span></span> and that is really equivalent to the initial state <span></span><span id="MathJax-Element-64-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C6;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03C6;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>φ</mi><mn>2</mn></msub><mo>⟩</mo></mrow></math></span></span>.</p>
<p>At this point, it’s going to be beneficial to abandon purely theoretical deliberations and look at some Q# code. A word of qualification is in order though. In the three earlier posts of this series, we used a particular construct for our Q# programs – more specifically, a hybrid C# + Q# model, where C# provided a shell driver applications, and Q# contained quantum logic invoked from that application. Since then, the QDK, in one of the recent updates, shipped a new feature – standalone Q# command line applications. This feature allows us to use pure Q# programs, making the entire journey through quantum coding much more straight forward, as it eliminates the extra baggage of having to deal with an extra separate programming language. I <a href="https://qsharp.community/blog/qsharp-entrypoint/">blogged</a> about this feature in detail on the Q# community blog recently, so I will skip the introduction to it here – I recommend however that you have a short look there. </p>
<p>A full example of a simmple Q# program that uses CNOT (from the <span></span><span id="MathJax-Element-65-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mo>.</mo><mi>Q</mi><mi>u</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>m</mi><mo>.</mo><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>c</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mo>.</mo><mi>Q</mi><mi>u</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>m</mi><mo>.</mo><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>c</mi></math></span></span> namespace) against two qubits, and then measures the qubits to verify the results is shown below:</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b763254136474" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p></div>
				</td>
						<td><div><p><span>@</span><span>EntryPoint</span><span>(</span><span>)</span></p><p><span>operation </span><span>Start</span><span>(</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"CNOT"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSample</span><span>(</span><span>false</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |00&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSample</span><span>(</span><span>false</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |01&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSample</span><span>(</span><span>true</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |10&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSample</span><span>(</span><span>true</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |11&gt;&nbsp;&nbsp; </span></p><p><span>}</span></p><p><span>operation </span><span>ControlledNotSample</span><span>(</span><span>controlInitialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>,</span><span> </span><span>targetInitialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using</span><span> </span><span>(</span><span>(</span><span>control</span><span>,</span><span> </span><span>target</span><span>)</span><span> </span><span>=</span><span> </span><span>(</span><span>Qubit</span><span>(</span><span>)</span><span>,</span><span> </span><span>Qubit</span><span>(</span><span>)</span><span>)</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>control</span><span>,</span><span> </span><span>controlInitialState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>target</span><span>,</span><span> </span><span>targetInitialState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>CNOT</span><span>(</span><span>control</span><span>,</span><span> </span><span>target</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultControl</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>control</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultTarget</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>target</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"|"</span><span> </span><span>+</span><span> </span><span>(</span><span>controlInitialState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>targetInitialState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;==&gt;|"</span><span> </span><span>+</span><span> </span><span>(</span><span>resultControl</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>resultTarget</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p><p><span>operation </span><span>PrepareQubitState</span><span>(</span><span>qubit</span><span> </span><span>:</span><span> </span><span>Qubit</span><span>,</span><span> </span><span>initialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>is</span><span> </span><span>Adj</span></p><p><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>if</span><span> </span><span>(</span><span>initialState</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>X</span><span>(</span><span>qubit</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0108 seconds] -->
</div>
<p>In this sample, as mentioned, we only deal with qubits in the two orthogonal basis states <span></span><span id="MathJax-Element-66-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow></math></span></span> to <span></span><span id="MathJax-Element-67-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span>. We always borrow (“allocate”, in the C# language) two qubits, and use them to apply the CNOT gate. The sample runs 4 times – for four different starting states <span></span><span id="MathJax-Element-68-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow></math></span></span>, <span></span><span id="MathJax-Element-69-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow></math></span></span>, <span></span><span id="MathJax-Element-70-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-71-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow></math></span></span>. The <span></span><span id="MathJax-Element-72-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></math></span></span> function prints the output to the console, and we keep track of the state transformations. What we should see is the following:</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b775550204578" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					
				</td>
						<td><div><p><span>CNOT</span></p><p><span>|</span><span>00</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>00</span><span>&gt;</span></p><p><span>|</span><span>01</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>01</span><span>&gt;</span></p><p><span>|</span><span>10</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>11</span><span>&gt;</span></p><p><span>|</span><span>11</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>10</span><span>&gt;</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>
<p>This is of course as expected – the states <span></span><span id="MathJax-Element-73-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-74-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow></math></span></span> are left intact, while the states <span></span><span id="MathJax-Element-75-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-76-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow></math></span></span> result in the change in the target qubit value, along the lines of the classical XOR logic.</p>
<p>At this point it also worth mentioning that the notion of a “control qubit” and a “target qubit” is only an approximation of the real behavior of CNOT in quantum computing, and while helpful for high-level understanding, it should not be taken too literally. As it was discussed in part 1 of this series, measurements in quantum computing are basis dependent. Situation is the same with the effects of the CNOT gate. So far we were only discussing its behavior in the standard computational basis (<span></span><span id="MathJax-Element-77-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow><mo>,</mo><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow><mo>,</mo><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span>), however, we could use the gate in a different basis, say, Hadamard basis (<span></span><span id="MathJax-Element-78-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mo>+</mo><mo>&amp;#x27E9;</mo></mrow><mo>,</mo><mrow><mo>|</mo><mo>&amp;#x2212;</mo><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mo>+</mo><mo>⟩</mo></mrow><mo>,</mo><mrow><mo>|</mo><mo>−</mo><mo>⟩</mo></mrow></math></span></span>). In Hadamard basis, the notions of control and target qubits would appear to be effectively flipped, as it is the second qubit that remains unchanged, and the first one changes – conditionally – its state. The state transformations (without going into the mathematical proof) look the following:</p>
<p><span></span><span><span id="MathJax-Element-79-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mo>+</mo><mo>+</mo><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mo>+</mo><mo>+</mo><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mo>+</mo><mo>+</mo><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mo>+</mo><mo>+</mo><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-80-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mo>+</mo><mo>&amp;#x2212;</mo><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mo>&amp;#x2013;</mo><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mo>+</mo><mo>−</mo><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mo>–</mo><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-81-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mo>&amp;#x2212;</mo><mo>+</mo><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mo>&amp;#x2212;</mo><mo>+</mo><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mo>−</mo><mo>+</mo><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mo>−</mo><mo>+</mo><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-82-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mo>&amp;#x2013;</mo><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mo>+</mo><mo>&amp;#x2212;</mo><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mo>–</mo><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mo>+</mo><mo>−</mo><mo>⟩</mo></mrow></math></span></span></span></p>
<h3 id="toc_3">Gate universality</h3>
<p>In classical computation theory, we often speak of the so-called “universal gates” (e.g. OR, AND and NOT) – a set of gates that can be arranged to represent any logical algorithm, without involving any other gates. Such arrangement would likely not be optimal from the performance standpoint, but it would be functionally complete. In fact, a single classical gate, the <a href="https://en.wikipedia.org/wiki/NAND_gate">NAND</a> gate, on its own is already a universal gate – as any boolean logic function can be represented by a combination of NAND gates. In quantum computing, the concept of gate universality is a little more challenging. <a href="https://www.cambridge.org/gb/academic/subjects/physics/quantum-physics-quantum-information-and-quantum-computation/quantum-computation-and-quantum-information-10th-anniversary-edition?format=HB&amp;isbn=9781107002173">Nielsen and Chuang</a> define quantum universality as follows:</p>
<blockquote>
<p>A set of gates is said to be universal for quantum computation if any unitary operation may be approximated to arbitrary accuracy by a quantum circuit involving only those gates.</p>
</blockquote>
<p>Such definition contains an important qualification – “approximated to arbitrary accuracy”. Quantum computing, due to its inherently different nature compared to classical boolean algebra, does not allow for a perfect set of universal gates. The main reason behind it, is that any unitary transformation can become a gate acting on a qubit. This is explained in a very logical and intuitive way by <a href="https://mitpress.mit.edu/books/quantum-computing-everyone">Chris Bernhardt</a>:</p>
<blockquote>
<p>As we have seen there are infinitely many possible gates that can act on just one qubit. If we take a finite number of gates and connect them in a finite number of ways, we will end up with a finite number of circuits. So, it is just not possible to have a finite number of gates that generates and infinite number of circuits.</p>
</blockquote>
<p>Despite this sobering assessment, Nielsen and Chuang do identify a set of universal quantum gates – universal according to their quantum definition, not according to the classical universality definition. Those gates are <span></span><span id="MathJax-Element-83-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span> gate, phase gate, <span></span><span id="MathJax-Element-84-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>8</mn></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>π</mi><mrow><mo>/</mo></mrow><mn>8</mn></mrow></math></span></span> gate and the <span></span><span id="MathJax-Element-85-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi></math></span></span> gate; the rationale behind that is that in principle unitary transformations can be decomposed into a series of two qubit rotations. This emphasizes yet again the critical importance of the CNOT gate in the quantum algorithm building. We will soon see how one multi qubit gate can actually be replaced by aa series of CNOTs.</p>
<h3 id="toc_4">CNOT generalization</h3>
<p>An intuitive way of thinking about CNOT is that it is made up of the <span></span><span id="MathJax-Element-86-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span> (top left corner) and the <span></span><span id="MathJax-Element-87-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span> matrices (bottom right corner). Such observation is very helpful, as it allows to naturally generalize the behavior of CNOT into a common class of “controlled” qubit transformations, where a given transformation is applied conditionally, when the first control qubit is <span></span><span id="MathJax-Element-88-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span>. If we follow this generalization path, it is possible to define any generic single qubit transformation <span></span><span id="MathJax-Element-89-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>U</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span> such that:</p>
<p><span></span><span><span id="MathJax-Element-90-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>22</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>U</mi><mrow><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow><mn>12</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>U</mi><mrow><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow><mn>22</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span>
</p>
<p>We can then use the observation we already made about the composition of the CNOT gate, and combine the <span></span><span id="MathJax-Element-91-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span> gate and <span></span><span id="MathJax-Element-92-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>U</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span>, thus creating a hypothetical controlled <span></span><span id="MathJax-Element-93-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>U</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span> two-qubit gate (“<span></span><span id="MathJax-Element-94-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>U</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>U</mi></math></span></span>”), which is shown below.</p>
<p><span></span><span><span id="MathJax-Element-95-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>C</mi><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>22</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mi>U</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>U</mi><mrow><mn>11</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow><mn>12</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>U</mi><mrow><mn>21</mn></mrow></msub></mtd><mtd><msub><mi>U</mi><mrow><mn>22</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span>
</p>
<p>We can now classify the effects of this <span></span><span id="MathJax-Element-96-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>U</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>U</mi></math></span></span> gate in the following way:</p>
<p><span></span><span><span id="MathJax-Element-97-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-98-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-99-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mi>U</mi><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow><mo>⊗</mo><mi>U</mi><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-100-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mi>U</mi><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow><mo>⊗</mo><mi>U</mi><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span></span></p>
<p>Such generalizations are common in the quantum computing literature – for example Bob Sutor in his recent book <a href="https://www.amazon.de/Dancing-Qubits-quantum-computing-change/dp/1838827366">Dancing with Qubits</a> provides exhaustive information about constructing <span></span><span id="MathJax-Element-101-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>Y</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>Y</mi></math></span></span>, <span></span><span id="MathJax-Element-102-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>Z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>Z</mi></math></span></span> or even <span></span><span id="MathJax-Element-103-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><msubsup><mi>R</mi><mi>&amp;#x03D5;</mi><mi>Z</mi></msubsup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><msubsup><mi>R</mi><mi>ϕ</mi><mi>Z</mi></msubsup></math></span></span> gates. Q# does not intrinsically implement those gates, however it does provide a general purpose mechanism of creating general controlled unitary transformations via the <span></span><span id="MathJax-Element-104-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>d</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>d</mi></math></span></span> functor. A simple example of achieving CNOT functionality via <span></span><span id="MathJax-Element-105-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>d</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>d</mi></math></span></span> functor and a single qubit <span></span><span id="MathJax-Element-106-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span> gate in Q# is shown below:</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b783539616533" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p></div>
				</td>
						<td><div><p><span>@</span><span>EntryPoint</span><span>(</span><span>)</span></p><p><span>operation </span><span>Start</span><span>(</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"CNOT via functor"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSampleFunctor</span><span>(</span><span>false</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |00&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSampleFunctor</span><span>(</span><span>false</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |01&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSampleFunctor</span><span>(</span><span>true</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |10&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ControlledNotSampleFunctor</span><span>(</span><span>true</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |11&gt;&nbsp;&nbsp;</span></p><p><span>}</span></p><p><span>operation </span><span>ControlledNotSampleFunctor</span><span>(</span><span>controlInitialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>,</span><span> </span><span>targetInitialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using</span><span> </span><span>(</span><span>(</span><span>control</span><span>,</span><span> </span><span>target</span><span>)</span><span> </span><span>=</span><span> </span><span>(</span><span>Qubit</span><span>(</span><span>)</span><span>,</span><span> </span><span>Qubit</span><span>(</span><span>)</span><span>)</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>control</span><span>,</span><span> </span><span>controlInitialState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>target</span><span>,</span><span> </span><span>targetInitialState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Controlled</span><span> </span><span>X</span><span>(</span><span>[</span><span>control</span><span>]</span><span>,</span><span> </span><span>target</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultControl</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>control</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultTarget</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>target</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"|"</span><span> </span><span>+</span><span> </span><span>(</span><span>controlInitialState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>targetInitialState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;==&gt;|"</span><span> </span><span>+</span><span> </span><span>(</span><span>resultControl</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>resultTarget</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p><p><span>operation </span><span>PrepareQubitState</span><span>(</span><span>qubit</span><span> </span><span>:</span><span> </span><span>Qubit</span><span>,</span><span> </span><span>initialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>is</span><span> </span><span>Adj</span></p><p><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>if</span><span> </span><span>(</span><span>initialState</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>X</span><span>(</span><span>qubit</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0107 seconds] -->
</div>
<p>The output of this code is identical to the earlier one when we used the built-in <span></span><span id="MathJax-Element-107-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi></math></span></span> gate.</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b78f937089807" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					
				</td>
						<td><div><p><span>CNOT </span><span>via </span><span>functor</span></p><p><span>|</span><span>00</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>00</span><span>&gt;</span></p><p><span>|</span><span>01</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>01</span><span>&gt;</span></p><p><span>|</span><span>10</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>11</span><span>&gt;</span></p><p><span>|</span><span>11</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>10</span><span>&gt;</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>
<h3 id="toc_5">SWAP gate</h3>
<p>Another useful two-qubit gate is the SWAP gate. As the name suggests, it can be used to swap the states of two qubits. This is a feature that can be very useful in quantum algorithms, especially in the absence of copying (we have not touched on that subject yet, but we will return to that later in this series). SWAP gate is described by the following matrix:</p>
<p><span></span><span><span id="MathJax-Element-108-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>S</mi><mi>W</mi><mi>A</mi><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mi>W</mi><mi>A</mi><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span>
</p>
<p>SWAP state transformations are summarized below:</p>
<p><span></span><span><span id="MathJax-Element-109-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>00</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>00</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-110-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-111-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>10</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>01</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>10</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>01</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-112-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>11</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>11</mn><mo>⟩</mo></mrow></math></span></span></span></p>
<p>Just like the CNOT gate, SWAP function in Q# can be found in the <span></span><span id="MathJax-Element-113-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mo>.</mo><mi>Q</mi><mi>u</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>m</mi><mo>.</mo><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>c</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mo>.</mo><mi>Q</mi><mi>u</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>m</mi><mo>.</mo><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>c</mi></math></span></span> namespace, and not surprisingly, takes two qubits as arguments. An example of using the SWAP gate in Q# is shown in the snippet below.</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b799897568466" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p></div>
				</td>
						<td><div><p><span>@</span><span>EntryPoint</span><span>(</span><span>)</span></p><p><span>operation </span><span>Start</span><span>(</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"SWAP"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSample</span><span>(</span><span>false</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |00&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSample</span><span>(</span><span>false</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |01&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSample</span><span>(</span><span>true</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |10&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSample</span><span>(</span><span>true</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |11&gt;&nbsp;&nbsp;</span></p><p><span>}</span></p><p><span>operation </span><span>SwapSample</span><span>(</span><span>firstState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>,</span><span> </span><span>secondState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using</span><span> </span><span>(</span><span>(</span><span>first</span><span>,</span><span> </span><span>second</span><span>)</span><span> </span><span>=</span><span> </span><span>(</span><span>Qubit</span><span>(</span><span>)</span><span>,</span><span> </span><span>Qubit</span><span>(</span><span>)</span><span>)</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>first</span><span>,</span><span> </span><span>firstState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>second</span><span>,</span><span> </span><span>secondState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SWAP</span><span>(</span><span>first</span><span>,</span><span> </span><span>second</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultFirst</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>first</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultSecond</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>second</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"|"</span><span> </span><span>+</span><span> </span><span>(</span><span>firstState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>secondState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;==&gt;|"</span><span> </span><span>+</span><span> </span><span>(</span><span>resultFirst</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>resultSecond</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p><p><span>operation </span><span>PrepareQubitState</span><span>(</span><span>qubit</span><span> </span><span>:</span><span> </span><span>Qubit</span><span>,</span><span> </span><span>initialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>is</span><span> </span><span>Adj</span></p><p><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>if</span><span> </span><span>(</span><span>initialState</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>X</span><span>(</span><span>qubit</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0109 seconds] -->
</div>
<p>The code is actually identical to our earlier CNOT sample – with the only exception being that we (no pun intended) swapped CNOT with SWAP. The output is inline with our expectations:</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b7a5156996716" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					
				</td>
						<td><div><p><span>SWAP</span></p><p><span>|</span><span>00</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>00</span><span>&gt;</span></p><p><span>|</span><span>01</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>10</span><span>&gt;</span></p><p><span>|</span><span>10</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>01</span><span>&gt;</span></p><p><span>|</span><span>11</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>11</span><span>&gt;</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>
<p>Fittingly enough to the earlier discussion about the CNOT universality, the SWAP gate can be accurately reconstructed using a series of three CNOT transformations, applied in the order shown on the circuit below.</p>
<p><a href="https://www.strathweb.com/wp-content/uploads/2020/06/swap.png"><img src="https://www.strathweb.com/wp-content/uploads/2020/06/swap.png" alt="" srcset="https://www.strathweb.com/wp-content/uploads/2020/06/swap.png 668w, https://www.strathweb.com/wp-content/uploads/2020/06/swap-300x85.png 300w" sizes="(max-width: 668px) 100vw, 668px"></a></p>
<p>While such composition may not appear very intuitive at first, it is actually very easy to prove mathematically. I generally encourage everyone to try these proofs as often as possible, to develop sort of an intuition for the state transformations connected to the most common gate types. In this case, we can start the proof by imagining the initial state <span></span><span id="MathJax-Element-114-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow></math></span></span> of the compound two-qubit system as follows:</p>
<p><span></span><span><span id="MathJax-Element-115-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>a</mi><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><mi>b</mi><mo>⟩</mo></mrow></math></span></span></span></p>
<p>In <span></span><span id="MathJax-Element-116-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow></math></span></span>, <span></span><span id="MathJax-Element-117-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mi>a</mi><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-118-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mi>b</mi><mo>⟩</mo></mrow></math></span></span> are in computational basis, so either <span></span><span id="MathJax-Element-119-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow></math></span></span> or <span></span><span id="MathJax-Element-120-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span>. After applying the first CNOT we end up with <span></span><span id="MathJax-Element-121-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow></math></span></span>:</p>
<p><span></span><span><span id="MathJax-Element-122-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>2</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x2295;</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>2</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>a</mi><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><mi>a</mi><mo>⊕</mo><mi>b</mi><mo>⟩</mo></mrow></math></span></span></span></p>
<p>Following with the second CNOT, this time with reversal of control qubit, we end up with <span></span><span id="MathJax-Element-123-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>3</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>3</mn></msub><mo>⟩</mo></mrow></math></span></span>. Notice that the reversal causes the state that was already described by XOR to stay intact.</p>
<p><span></span><span><span id="MathJax-Element-124-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>3</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x2295;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2295;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x2295;</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>3</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>a</mi><mo>⊕</mo><mo stretchy="false">(</mo><mi>a</mi><mo>⊕</mo><mi>b</mi><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><mi>a</mi><mo>⊕</mo><mi>b</mi><mo>⟩</mo></mrow></math></span></span></span></p>
<p>Due to associativity of XOR, <span></span><span id="MathJax-Element-125-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>3</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>3</mn></msub><mo>⟩</mo></mrow></math></span></span> can then be reduced to:</p>
<p><span></span><span><span id="MathJax-Element-126-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>3</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x2295;</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>3</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>b</mi><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><mi>a</mi><mo>⊕</mo><mi>b</mi><mo>⟩</mo></mrow></math></span></span></span></p>
<p>Finally, applying the final CNOT (reversing the control qubit again) leads us to state <span></span><span id="MathJax-Element-127-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>4</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>4</mn></msub><mo>⟩</mo></mrow></math></span></span>:</p>
<p><span></span><span><span id="MathJax-Element-128-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>4</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2295;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>4</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>b</mi><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><mo stretchy="false">(</mo><mi>a</mi><mo>⊕</mo><mi>b</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>b</mi><mo>⟩</mo></mrow></math></span></span></span></p>
<p>And just like before, this can be reduced to:</p>
<p><span></span><span><span id="MathJax-Element-129-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>4</mn></msub><mo>&amp;#x27E9;</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>b</mi><mo>&amp;#x27E9;</mo></mrow><mo>&amp;#x2297;</mo><mrow><mo>|</mo><mi>a</mi><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>4</mn></msub><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>|</mo><mi>b</mi><mo>⟩</mo></mrow><mo>⊗</mo><mrow><mo>|</mo><mi>a</mi><mo>⟩</mo></mrow></math></span></span></span></p>
<p>If we compare <span></span><span id="MathJax-Element-130-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>1</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>1</mn></msub><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-131-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><msub><mi>&amp;#x03C8;</mi><mn>4</mn></msub><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><msub><mi>ψ</mi><mn>4</mn></msub><mo>⟩</mo></mrow></math></span></span>, we can obviously easily see that the qubit states have been swapped. Of course we do not need to only rely on algebraic proof – with Q# at our disposal, it is fairly easy to verify that this particular sequence of CNOTs is equivalent to a SWAP. This is shown in the snippet below.</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b7b0817615721" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p></div>
				</td>
						<td><div><p><span>@</span><span>EntryPoint</span><span>(</span><span>)</span></p><p><span>operation </span><span>Start</span><span>(</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"SWAP with CNOTs"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>false</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |00&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>false</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |01&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>true</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |10&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>true</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |11&gt;&nbsp;&nbsp;</span></p><p><span>}</span></p><p><span>operation </span><span>SwapSampleWithCnots</span><span>(</span><span>firstState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>,</span><span> </span><span>secondState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using</span><span> </span><span>(</span><span>(</span><span>first</span><span>,</span><span> </span><span>second</span><span>)</span><span> </span><span>=</span><span> </span><span>(</span><span>Qubit</span><span>(</span><span>)</span><span>,</span><span> </span><span>Qubit</span><span>(</span><span>)</span><span>)</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>first</span><span>,</span><span> </span><span>firstState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>second</span><span>,</span><span> </span><span>secondState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>CNOT</span><span>(</span><span>first</span><span>,</span><span> </span><span>second</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>CNOT</span><span>(</span><span>second</span><span>,</span><span> </span><span>first</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>CNOT</span><span>(</span><span>first</span><span>,</span><span> </span><span>second</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultFirst</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>first</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultSecond</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>second</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"|"</span><span> </span><span>+</span><span> </span><span>(</span><span>firstState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>secondState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;==&gt;|"</span><span> </span><span>+</span><span> </span><span>(</span><span>resultFirst</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>resultSecond</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p><p><span>operation </span><span>PrepareQubitState</span><span>(</span><span>qubit</span><span> </span><span>:</span><span> </span><span>Qubit</span><span>,</span><span> </span><span>initialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>is</span><span> </span><span>Adj</span></p><p><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>if</span><span> </span><span>(</span><span>initialState</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>X</span><span>(</span><span>qubit</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0110 seconds] -->
</div>
<p>It prints identical result to using the built-in SWAP gate:</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b7bb612739931" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					
				</td>
						<td><div><p><span>SWAP </span><span>with </span><span>CNOTs</span></p><p><span>|</span><span>00</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>00</span><span>&gt;</span></p><p><span>|</span><span>01</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>10</span><span>&gt;</span></p><p><span>|</span><span>10</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>01</span><span>&gt;</span></p><p><span>|</span><span>11</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>11</span><span>&gt;</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>
<h3 id="toc_6">Toffoli gate</h3>
<p><a href="https://www.strathweb.com/wp-content/uploads/2020/06/ccnot.png"><img src="https://www.strathweb.com/wp-content/uploads/2020/06/ccnot.png" alt="" srcset="https://www.strathweb.com/wp-content/uploads/2020/06/ccnot.png 472w, https://www.strathweb.com/wp-content/uploads/2020/06/ccnot-300x184.png 300w" sizes="(max-width: 472px) 100vw, 472px"></a></p>
<p>Toffoli gate, also known as CCNOT gate, is a three qubit gate that is an extrapolation of the CNOT gate logic onto three qubits. Logically, it follows similar XOR rules – with the first two qubits are both treated as control qubits, while the third plays the role of the target qubit. The first experimental realization of the gate in a trapped ion quantum computer was done in 2008 by a group at <a href="https://arxiv.org/abs/0804.0082">University of Innsbruck</a>.</p>
<p>Since the CCNOT gate operates on three qubits, the matrix used to express it is <span></span><span id="MathJax-Element-132-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>8</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>8</mn></math></span></span>x<span></span><span id="MathJax-Element-133-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>8</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>8</mn></math></span></span> (<span></span><span id="MathJax-Element-134-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mn>3</mn></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mn>3</mn></msup></math></span></span>) in size:</p>
<p><span></span><span><span id="MathJax-Element-135-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mi>N</mi><mi>O</mi><mi>T</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></span>
</p>
<p>Similarly to how we did when looking at the CNOT gate, if we set aside the superposition states and only focus on the two computational basis states <span></span><span id="MathJax-Element-136-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>0</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>0</mn><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-137-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>1</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>1</mn><mo>⟩</mo></mrow></math></span></span>, the effects of the gate can be summarized in the following way:</p>
<p><span></span><span><span id="MathJax-Element-138-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>000</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>000</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>000</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>000</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-139-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>001</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>001</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>001</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>001</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-140-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>010</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>010</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>010</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>010</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-141-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>011</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>011</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>011</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>011</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-142-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>100</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>100</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>100</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>100</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-143-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>101</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>101</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>101</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>101</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-144-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>110</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>111</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>110</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>111</mn><mo>⟩</mo></mrow></math></span></span></span><br>
<span></span><span><span id="MathJax-Element-145-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow><mo>|</mo><mn>111</mn><mo>&amp;#x27E9;</mo></mrow><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mrow><mo>|</mo><mn>110</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mn>111</mn><mo>⟩</mo></mrow><mo stretchy="false">→</mo><mrow><mo>|</mo><mn>110</mn><mo>⟩</mo></mrow></math></span></span></span></p>
<p>In other words, the gate swaps the states <span></span><span id="MathJax-Element-146-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>110</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>110</mn><mo>⟩</mo></mrow></math></span></span> and <span></span><span id="MathJax-Element-147-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow><mo>|</mo><mn>111</mn><mo>&amp;#x27E9;</mo></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mn>111</mn><mo>⟩</mo></mrow></math></span></span> with each other and leaves all other states unchanged. In Q#, just like the CNOT, SWAP and other basic gates, CCNOT is part of the <span></span><span id="MathJax-Element-148-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mo>.</mo><mi>Q</mi><mi>u</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>m</mi><mo>.</mo><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>c</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mo>.</mo><mi>Q</mi><mi>u</mi><mi>a</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>m</mi><mo>.</mo><mi>I</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>c</mi></math></span></span> namespace and it actually happens to be the only built-in three-qubit gate in the language. However, other similar gates can always be manually constructed using the aforementioned <span></span><span id="MathJax-Element-149-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>d</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>d</mi></math></span></span> functor.</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b7c6104645853" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p></div>
				</td>
						<td><div><p><span>@</span><span>EntryPoint</span><span>(</span><span>)</span></p><p><span>operation </span><span>Start</span><span>(</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"SWAP with CNOTs"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>false</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |00&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>false</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |01&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>true</span><span>,</span><span> </span><span>false</span><span>)</span><span>;</span><span> </span><span>// |10&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SwapSampleWithCnots</span><span>(</span><span>true</span><span>,</span><span> </span><span>true</span><span>)</span><span>;</span><span> </span><span>// |11&gt;&nbsp;&nbsp;</span></p><p><span>}</span></p><p><span>operation </span><span>ToffoliSample</span><span>(</span><span>control1InitialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>,</span><span> </span><span>control2InitialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>,</span><span> </span><span>targetInitialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using</span><span> </span><span>(</span><span>(</span><span>control1</span><span>,</span><span> </span><span>control2</span><span>,</span><span> </span><span>target</span><span>)</span><span> </span><span>=</span><span> </span><span>(</span><span>Qubit</span><span>(</span><span>)</span><span>,</span><span> </span><span>Qubit</span><span>(</span><span>)</span><span>,</span><span> </span><span>Qubit</span><span>(</span><span>)</span><span>)</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>control1</span><span>,</span><span> </span><span>control1InitialState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>control2</span><span>,</span><span> </span><span>control2InitialState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PrepareQubitState</span><span>(</span><span>target</span><span>,</span><span> </span><span>targetInitialState</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>CCNOT</span><span>(</span><span>control1</span><span>,</span><span> </span><span>control2</span><span>,</span><span> </span><span>target</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultControl1</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>control1</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultControl2</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>control2</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>let </span><span>resultTarget</span><span> </span><span>=</span><span> </span><span>MResetZ</span><span>(</span><span>target</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Message</span><span>(</span><span>"|"</span><span> </span><span>+</span><span> </span><span>(</span><span>control1InitialState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>control2InitialState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>targetInitialState</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;==&gt;|"</span><span> </span><span>+</span><span> </span><span>(</span><span>resultControl1</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>resultControl2</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span> </span><span>(</span><span>resultTarget</span><span> </span><span>==</span><span> </span><span>One</span><span> </span><span>?</span><span> </span><span>"1"</span><span> </span><span>|</span><span> </span><span>"0"</span><span>)</span><span> </span><span>+</span><span>"&gt;"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p><p><span>operation </span><span>PrepareQubitState</span><span>(</span><span>qubit</span><span> </span><span>:</span><span> </span><span>Qubit</span><span>,</span><span> </span><span>initialState</span><span> </span><span>:</span><span> </span><span>Bool</span><span>)</span><span> </span><span>:</span><span> </span><span>Unit</span><span> </span><span>is</span><span> </span><span>Adj</span></p><p><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>if</span><span> </span><span>(</span><span>initialState</span><span>)</span><span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>X</span><span>(</span><span>qubit</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0180 seconds] -->
</div>
<p>The output, of course, aligns perfectly with what we expected.</p>
<div><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ef396994b7d1323521435" data-settings=" minimize scroll-mouseover wrap">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="show">
					
				</td>
						<td><div><p><span>Toffoli</span></p><p><span>|</span><span>000</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>000</span><span>&gt;</span></p><p><span>|</span><span>001</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>001</span><span>&gt;</span></p><p><span>|</span><span>010</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>010</span><span>&gt;</span></p><p><span>|</span><span>100</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>100</span><span>&gt;</span></p><p><span>|</span><span>011</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>011</span><span>&gt;</span></p><p><span>|</span><span>101</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>101</span><span>&gt;</span></p><p><span>|</span><span>110</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>111</span><span>&gt;</span></p><p><span>|</span><span>111</span><span>&gt;=</span><span>=</span><span>&gt;</span><span>|</span><span>110</span><span>&gt;</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
</div>
<h3 id="toc_7">Summary and entanglement</h3>
<p>In this post we look at the mathematics behind multi-qubit gates, explored the CNOT, CCNOT and SWAP gates and identified a whole class of generic controlled gates. CNOT is definitely a very interesting gate from the algebraic perspective, and, as one of the universal quantum gates, is fundamentally important to the quantum information theory and quantum computing. However, since we explicitly qualified in the beginning of this post that we will ignore the superposition state of the control qubit, the CNOT behavior that we have seen so far is logical, deterministic and fully classical. Such context is useful to introduce the gate, but it also obfuscates the real reason why the gate is at the heart of quantum computing – and that’s the capability of the CNOT gate to entangle two qubits together. The next post in this series will be dedicated to entanglement, as we continue to dive deeper into the CNOT gate and the world of quantum computing.</p>


						</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>