<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Data Leakage from Encrypted Databases - Schneier on Security - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Data Leakage from Encrypted Databases - Schneier on Security - linksfor.dev(s)"/>
    <meta property="og:description" content="Blog&#xA0;&gt;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Data Leakage from Encrypted Databases - Schneier on Security</title>
<div class="readable">
        <h1>Data Leakage from Encrypted Databases - Schneier on Security</h1>
            <div>Reading time: 9-12 minutes</div>
        <div>Posted here: 01 Mar 2019</div>
        <p><a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html">https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="wrapper"><div id="main">
	<header></header>
	<nav></nav>





	
	<div id="content"><p id="breadcrumbs">


<a href="https://www.schneier.com/blog/">Blog</a>&nbsp;&gt;




</p>



    
    
    <article></article>




    
    



<h3 id="comments">Comments</h3>


<article><div id="c6789615">


<p><span>Jon</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789615">March  1, 2019  8:37 AM</a>
</p>
<p>Fascinating article.</p>

<p>Had a thought, though, about implementing 'fuzzy' database records as a counterattack.</p>

<p>Imagine:<br>
a) The database contains some small percentage (5%?) of records that are 'fuzzy' records - they will occasionally (not always!) return from unrelated queries.<br>
b) Query specifics are encrypted (e.g. range), and identical plaintext queries are NOT encrypted into the same ciphertext!<br>
c) The client, when decrypting the returned records, can easily recognize a 'fuzzy' record and discard it.</p>

<p>Eventually an attacker could by probability determine which records are 'fuzzy' and ignore them, but the hope here is that by adding a small amount of 'fuzzy' records it makes the number of samples required very much larger for the same error rate.</p>

<p>And, of course, there's overhead.</p>

<p>Anyhow, I'm very sure I don't know how to do the math on this idea.  Have fun.</p>

<p>J.</p>
</div></article>



<article><div id="c6789617">


<p><span>Phaete</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789617">March  1, 2019  8:48 AM</a>
</p>
<p>Good stuff.</p>

<p>It's refreshing to say that he has a good writing style.<br>
Good explanations, some humour to keep awake and politically neutral on a topic like this.<br>
I couldn't find much wrong with the article, just good stuff.</p>
</div></article>



<article><div id="c6789621">


<p><span><a title="https://www.impossiblystupid.com" href="https://www.impossiblystupid.com/" rel="nofollow">Impossibly Stupid</a></span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789621">March  1, 2019 11:43 AM</a>
</p>
<p>It's a well-written article, but it probably isn't anything new to most people here.  It basically boils down to the fact that you can do signal analysis on the available metadata.  The more easily you can correlate the query with the response, the more easily you can nullify the value of the encryption.  Keeping "live" data secure is inherently a hard problem.<br>
</p>
</div></article>



<article><div id="c6789627">


<p><span>AJWM</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789627">March  1, 2019 12:57 PM</a>
</p>
<p>@Jon</p>

<p>Not quite the same idea, but I advocate lying, er, making creative entries on forms whenever possible (and when not screwing up the reason you're filling in the data in the first place).  For instance, websites (hello, Facebook) don't need to know my real birthday. At best they need to know that I'm over 13 or 18.  Fuzz the data yourself.</p>

<p>Obviously, not applicable where prohibited by law. Don't lie on your tax returns, folks.</p>
</div></article>



<article><div id="c6789634">


<p><span>RealFakeNews</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789634">March  1, 2019  3:23 PM</a>
</p>
<p>As always, does a site REALLY need that info? If not, but they make it mandatory to supply it, then make something up.</p>

<p>Facebook keeps asking for my mobile number, but I'll never give it. If it ever becomes mandatory, I'll buy a burner-phone (cash, of course).</p>

<p>As for protecting a live database - that's easy. Given most sites require a unique log-in, use that to know which records to decrypt.</p>

<p>The real problem is companies want full access to all records all the time for data-mining and as we all know, that is the polar-opposite to what real security offers.</p>

<p>Until we're honest about why companies "need" access to this data, then we will always be chasing ghosts.</p>

<p>If it is so important that companies have access to everything, why is it so hard to double-store the data? Once for the user, and once for the company?</p>

<p>I'm reminded of all the discussions of securing communications while allowing the Government access:</p>

<p>Encrypt the data twice: once using the key of the intended recipient and send, then a second time using the Government key and send.</p>
</div></article>



<article><div id="c6789637">


<p><span>"data base" guy</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789637">March  1, 2019  4:25 PM</a>
</p>
<p>For those who didn't read the summary article:  this pertains to databases that don't touch the decryption keys (the keys are only ever client side):</p>

<p>Of course it depends on how big the data set is as to how well this would work... but databases and their search indexes can be segregated into different parts based on access restrictions and decryption keys... download just the parts you need... query them locally, and multiple results from different sources aggregated back together for display to the user (just the top one(s) from each set using a common relevance ordering, not looking up the entire result set)... without a ton of trouble...</p>

<p>This obviously wouldn't work for something as large as searching google indexing the whole web, but since that's all public data, it doesn't need to per se... you only need it for truly private/secret data, which under normal circumstances where each user owns their own data is a far smaller set of data... (the logs of who searched what would be candidates, for example... so if that data was kept client-side-readable/searchable-only then their algorithm for pulling relevant ads based on those previous searches would also need to be client-side)</p>

<p>The issue is when a large company with lots of data (like, say, facebook) considers itself to be the owner of all data it stores, and not each of its users owners of their own data... (this is how US law effectively treats it anyway with its "third party" doctrine)... then a facebook admin (or whoever at facebook) needs to download everything to do any query, and that's not really practical.</p>

<p>Also companies don't like this idea of segregation of private data because they like to operate under the principle of "collect it all... just in case it proves useful someday and turns into a cash cow..." so this necessitates a lot of people and processes having full access to everything...</p>

<p>I guess my point is the main problem isn't in the technology possible with data storage, it's in the human philosophy behind how the data storage is done and what its ultimate purpose is... (i.e. to serve the company, not the customer or user)</p>
</div></article>



<article><div id="c6789650">


<p><span>Sancho_P</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789650">March  2, 2019 12:06 PM</a>
</p>
<p>Very interesting, I think I could understand most of it, thank you.</p>

<p>The presumption here is that an attacker can read query and the <i><b>corresponding</b></i> reply for some time, albeit both encrypted, and has some knowledge of the context.<br>
If the attacker could replay or generate their own query - game over, no doubt.<br>
 Btw. I wonder why e.g. “Salaries” in the query wasn’t encrypted (like the range was)?</p>

<p>I’m not sure if the eavesdropper must be inside the db server to attack, I think a certain client connection (or two …) would be enough.</p>

<p>However, isn’t that much more complicated as to (repeatedly, continuously) watch a client’s TLS connection to a well known public server / service? The server’s reply for many pages / queries is known in plain (and can be challenged endlessly from all over the world).<br>
For a dedicated attacker, how long would it take to read my connection in plain, to e.g. @schneier.com, just by exploring the metadata? (not that it would make much sense here)</p>

<p>Or is this scenario very different from the db-leakage?<br>
</p>
</div></article>



<article><div id="c6789652">


<p><span>Sancho_P</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789652">March  2, 2019 12:10 PM</a>
</p>
<p>@"data base" guy</p>

<p>I assume each client has it’s particular key which is translated at the server to a centralized db key?</p>

<p>The download + search has limits also with time critical queries, e.g. the “US Terrorist Watch List” and their 1400+ clients, plus there would be 1400+ vulnerable systems to leak all db knowledge.</p>

<p>However, I agree, the main problem is human “philosophy” (or the lack of), call it business.</p>
</div></article>



<article><div id="c6789695">


<p><span>Me</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789695">March  4, 2019  1:38 PM</a>
</p>
<p>@"data base" guy</p>

<p>"Of course it depends on how big the data set is as to how well this would work"</p>

<p>Sadly, no, no it would not.  They show that (given certain information and assumptions) the speed with which the data is exposed is proportional only to the degree of tolerance an attacker is willing to have for inaccuracies, or data omitted (specifically not knowing the data at the extremes of the range).</p>

<p>Either way, however, they were able to get good accuracy after only a few hundred queries were observed.  Note also that this was not about a specific implementation that was leaky, but the attack was based only on theoretical properties of a perfect encrypted database (one that allows ranged queries).</p>

<p>Overall, this confirmed my initial thought when I heard about these things that they sound interesting, but I doubt they can be made practical.</p>
</div></article>



<article><div id="c6789725">


<p><span>Jon</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789725">March  5, 2019  2:53 AM</a>
</p>
<p>@ Me</p>

<p>That was sort of what I was getting at in my post - taking one of their assumptions out and shooting it.</p>

<p>One of their assumptions was (I think) that:<br>
"The same query always returns the same results".</p>

<p>Therefore, if the database returns different results, it must then be a different query.  But that's not true, if you have 'fuzzy' database entries.  By breaking the assumption, I hope to break the proof.</p>

<p>---</p>

<p>Another idea I had, to break that assumption, was a 'sticky' database.  Every query will return, encrypted, some records that don't actually match the query - they sort of 'stuck' to the trawl the database engine was doing.</p>

<p>When returned to the client, which has the original query in plaintext as well as the results in plaintext, the 'sticky' returns can be easily scraped off.</p>

<p>For even better security, you'd want also a 'slippery' database, where some records that do match the query do not get returned, but that might be awfully hard to sell to the customer.</p>

<p>It's a bit like breaking cryptography.  Instead of attacking the math, attack the implementation.  Instead of attacking the proof, attack its assumptions...</p>

<p>J.</p>

<p>PS - @ AJWM:  Agreed.  Poisoning databases is heap good fun.  Canary traps are fun too - A trivial, unique, mis-spelling in one field and when it gets back you know exactly where it came from...</p>
</div></article>



<article><div id="c6789762">


<p><span>Gweihir</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789762">March  5, 2019  5:58 PM</a>
</p>
<p>Ah, yes. the perennial quest for things that may well be impossible. Nice article, boils essentially down to "if you can observe people using databases, you can deduce what is in it". Not much of a surprise, really.</p>
</div></article>



<article><div id="c6789824">


<p><span>KeithB</span> • <a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.html#c6789824">March  7, 2019  4:08 PM</a>
</p>
<p>AJWM:<br>
Obviously, not applicable where prohibited by law. Don't lie on your tax returns, folks.</p>

<p>Or your SF-86. 8^)</p>
</div></article>




<p><a href="https://www.schneier.com/blog/archives/2019/03/data_leakage_fr.xml"><img alt="Atom Feed" src="https://www.schneier.com/images/rss-16px.png">Subscribe to comments on this entry</a></p>

  








    
    


    
<p id="powered">
     
    Sidebar photo of Bruce Schneier by Joe MacInnis.
	
    

    
    
	
	</p></div><!--#content-->





</div><!--#main-->
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>