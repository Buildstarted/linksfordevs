<!DOCTYPE html>
<html lang="en">
<head>
    <title>
The Evolution of Windows Search | Windows Search Platform - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="The Evolution of Windows Search | Windows Search Platform - linksfor.dev(s)"/>
    <meta property="article:author" content="Brendan FlynnSenior Software Engineer,&#xA0;Windows Search PlatformFollow Brendan"/>
    <meta property="og:description" content="Welcome to our new blog focusing on all things related to the Windows Search Platform, also known over the years as Windows Desktop Search, the Indexing Service, WSearch, and the Content Indexer. This is the first post in what will be a 4-part series covering the technology&#x2019;s background and history including the evolution of the indexing service over time,"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/windows-search-platform/the-evolution-of-windows-search/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - The Evolution of Windows Search | Windows Search Platform</title>
<div class="readable">
        <h1>The Evolution of Windows Search | Windows Search Platform</h1>
            <div>by Brendan FlynnSenior Software Engineer,&#xA0;Windows Search PlatformFollow Brendan</div>
            <div>Reading time: 12-16 minutes</div>
        <div>Posted here: 12 Mar 2020</div>
        <p><a href="https://devblogs.microsoft.com/windows-search-platform/the-evolution-of-windows-search/">https://devblogs.microsoft.com/windows-search-platform/the-evolution-of-windows-search/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured"><div><div><div><div><p><img src="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/me-150x150.jpg" width="58" height="58" alt="Brendan Flynn"></p><p>Brendan</p></div></div></div><p>March 12th, 2020</p><p>Welcome to our new blog focusing on all things related to the Windows Search Platform, also known over the years as Windows Desktop Search, the Indexing Service, WSearch, and the Content Indexer. This is the first post in what will be a 4-part series covering the technology‚Äôs background and history including the evolution of the indexing service over time, the settings and configuration when you first install Windows, and the basics on what the Indexing Service does, what it provides, and how to make the most of your index.</p><p>List of posts in the series</p><ol><li>The Evolution of Windows Search&nbsp; üëà&nbsp; <span><strong>You Are here</strong></span></li><li>Windows Search Configuration and Settings</li><li>What‚Äôs in my index?</li><li>How to make the most of search on Windows</li></ol><p>Whether you‚Äôre a Windows expert, hardcore developer, you‚Äôre writing your first app, or you just bought your first PC, we hope that you find these posts informative and engaging. We believe with the deep history of the search platform, where we‚Äôre at today, and where we‚Äôre taking the technology that there will be something in this blog for everyone.</p><hr><h2>29 years ago‚Ä¶.</h2><p>Back in the early 90‚Äôs, Microsoft was working on a technology called project <a href="https://en.wikipedia.org/wiki/Cairo_(operating_system)" target="_blank">Cairo</a> (1991). Believe me, at this point in my life I had no idea that I‚Äôd eventually be working at Microsoft, or better yet working on a part of Windows that was carried forward from ideas formed and written prior to Windows ‚Äô95. Inside of Cairo was a piece of technology called the Object File System, later known as <a href="https://en.wikipedia.org/wiki/WinFS" target="_blank">WinFS</a>. The idea behind it was to make sense out of all the bytes of data in the filesystem in a human readable and searchable way, organized as a collection of objects with properties all part of a strongly typed schema.</p><p>Back then applications didn‚Äôt understand all the file types that were being created. There was .pdf, .html, .gif, .jpeg and many, many others. Everyone wrote to files in their own format that was easy to understand by their application and no one else. This worked fine at the time ‚Äì your Adobe application opened your PDFs, internet browsers opened your html files, and photo applications opened your .gif and .jpg files. When the indexing service came along it was designed to understand these different file types and make the data inside of them searchable across the system and all applications for quick, and efficient access.</p><p>Over the course of these 29 years the service has evolved into what is the backend for a lot of Windows experiences, as well as a handful of developer APIs and their applications.</p><h2>Windows NT 4.0 (1996)</h2><p>The indexing service (Index Server 2.0) was introduced as part of an option-pack for Internet Information Services (IIS) in Windows NT 4.0 to perform content indexing of web server pages. This enabled users to search for text on web pages that were being hosted on an IIS server. The default location for these pages was C:\Inetpub, and that was one of the first folders the indexing service looked for content.</p><p><strong>Filters</strong></p><p>The concept of Filters was also introduced for the first time, allowing for the extraction of text-based content from different file types to be written into the indexing service. These filters were a way for an application to register themselves with a given file extension that the indexing service would invoke to grab the content to be put in the index when processing that file. This ‚Äú<em>processing‚Äù</em> over the years is commonly referred to as indexing.</p><p>Have you ever cracked open a .PDF file in notepad? Do you have any idea what the below data means? What if I told you there was a way to find a PDF on your system with some specific text in it without having to browse your entire OneDrive collection?</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-22.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-22.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-22.png 1427w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-22-300x118.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-22-1024x403.png 1024w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-22-768x302.png 768w" sizes="(max-width: 1427px) 100vw, 1427px"> </a></p><p>Blindly opening a file like the above is not a very useful way to process this data for the purpose of searching, nor does it make much sense to me. This is what the indexing service would see to extract data from without the appropriate filter. Filters became a way for a specific file format to communicate the data in that file that is valued as searchable. With an <a href="https://docs.microsoft.com/en-us/windows/win32/api/filter/nn-filter-ifilter" target="_blank">IFilter</a> for .pdf files, sentences of text, properties, and metadata within the file are returned and stored in the indexing service ‚Äì the meaningful, searchable data the user cares about.</p><p>How did applications read the index? From the beginning there was an <a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms709836%28v%3dvs.85%29" target="_blank">OLEDB indexing service provider</a> that provided read-only access to the contents in the index. Using this provider applications could take advantage of the indexing service‚Äôs own version of <a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/indexsrv/indexing-service-query-language" target="_blank">Structured Query Lanugage (SQL)</a> which was a strongly typed way to write code to read the data. All of these APIs are still available today for developers and applications to use.</p><h2>Windows 2000 (2000)</h2><p>The indexing service shipped for the first time as part of the operating system with Windows 2000, however it was a Windows Component and Service that you needed to enable.</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-23.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-23.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-23.png 1183w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-23-300x216.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-23-1024x738.png 1024w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-23-768x554.png 768w" sizes="(max-width: 1183px) 100vw, 1183px"> </a></p><p>Once enabled you could configure the service to index web pages that were hosted in IIS just like in Windows NT 4.0, or local folders on the machine which had various entry points to find data such as the Management Console or File Explorer.</p><blockquote><p>Example of creating a file with content and searching for it in Windows 2000 SP4.</p></blockquote><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-24.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-24.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-24.png 961w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-24-300x235.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-24-768x602.png 768w" sizes="(max-width: 961px) 100vw, 961px"> </a></p><blockquote><p>In Windows 2000 the Indexing service indexed file content. Users could then search the Indexer, and eventually find the file via the Query Form in the Management Console.</p></blockquote><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-25.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-25.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-25.png 1207w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-25-300x224.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-25-1024x764.png 1024w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-25-768x573.png 768w" sizes="(max-width: 1207px) 100vw, 1207px"> </a></p><p>Aside from the fact that you could search items, the service also exposed various statistics to the user to understand what is happening under the covers. These statistics are the columns you see in the Computer Management UI below. Docs to Index, Deferred for Indexing, and Word Lists were just a few that existed back then. Many more continue to be added and still worked on today.</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-26.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-26.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-26.png 1191w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-26-300x225.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-26-1024x770.png 1024w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-26-768x577.png 768w" sizes="(max-width: 1191px) 100vw, 1191px"> </a></p><p>The first version of the <a href="https://docs.microsoft.com/en-us/windows/win32/fileio/change-journals" target="_blank">USN journal</a> was also released in Windows 2000 as part of NTFS 3.0. The USN Journal is a component of the file system which gave applications the ability to read all changes on any volume in the system (assuming journals were supported on that volume) and react to those changes accordingly. Processing these journal changes in order to understand when files are modified to keep the index as up to date as possible is the primary way the indexing service gets notified of file/folder changes even in Windows 10.</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/api/filter/nn-filter-ifilter" target="_blank">IFilters</a> were also really starting to pick up with more third parties developing them to support content for unique file types to use within their applications. Popular filters at the time were the .pdf filter, as well as .gif, .jpg, .xml, .html just to name a few.</p><h2>Windows XP (2001)</h2><p>When Windows XP came around, the Indexing Service again shipped as part of Windows and was also enabled by default. Like all previous versions, it ran as ‚Äúcisvc.exe‚Äù which stood for content indexing service.</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-27.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-27.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-27.png 1191w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-27-300x227.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-27-1024x774.png 1024w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-27-768x580.png 768w" sizes="(max-width: 1191px) 100vw, 1191px"> </a></p><blockquote><p>Above shows content indexing in action on Windows XP. ‚Äúeven better content‚Äù is a sentence in the text file Brendan_Windows_XP.txt.</p></blockquote><p><strong>Catalogs</strong><br> From Windows 2000 through Windows XP, the indexing service separated the data it indexed into partitions, or catalogs.</p><p>Catalogs were a way to keep the contents of the index across different folders and paths contained and separate from one another. At first Windows 2000 and Windows XP by default supported the System catalog which stored local content and the Web Catalog which was only created and maintained if IIS was enabled on the machine. The catalogs were stored in different physical locations on the disk as well, so when IIS was uninstalled the removal of the Inetpub directory would in turn remove the appropriate web catalog and its data.</p><p><strong>Extensibility<br> </strong> This release was a major one from an extensibility perspective for developers. Many new APIs were created that allowed developers to interact with the catalogs and configure options on it. Some of the more used and recognized ones are ‚Äì <a href="https://docs.microsoft.com/en-us/windows/win32/api/searchapi/nn-searchapi-isearchcatalogmanager" target="_blank">ISearchCatalogManager</a>/<a href="https://docs.microsoft.com/en-us/windows/win32/api/searchapi/nn-searchapi-isearchcrawlscopemanager" target="_blank">ISearchCrawlScopeManager</a>.</p><p>Not only could your application use the APIs to configure the index, you could contribute your own data types to it as well. Originally the indexing service only knew how to process the content of <strong>files</strong> in the index as it could open every file in the same manner (NtCreateFile). Opening <strong>emails</strong> for indexing, or later on other Office or third-party data types was something that needed to be extensible and available to developers. There needed to be a way an application could tie into the system and provide its own data, whatever that might be. Developers at this time understood this gap and because of it, search protocols were born.</p><p>Applications could now create new search <a href="https://docs.microsoft.com/en-us/windows/win32/search/-search-3x-wds-extidx-prot-implementing" target="_blank">protocols</a>, or different streams of content to be indexed that weren‚Äôt necessary files. Protocols were an extremely important concept because that‚Äôs what made the indexing of Outlook, Visio, SharePoint, and other data types eventually possible. It all stemmed from the Windows XP release and are actively still around today. Only Outlook knows how to process the emails it has in its‚Äô local .pst/.ost files on the machine. Creating an interface to allow them to provide the necessary data to be indexed was crucial to onboarding many different types of data down the road.</p><h2>Windows Vista (2007)</h2><p>In Vista, the indexing service evolved into what is now called SearchIndexer.exe and runs as an NT system service (WSearch). There was a new control panel to configure a few options that became available directly to the user and this started to pave the way for a lot of what you still see today in Windows 10.</p><p>Starting with Vista the indexing service would index all files/folders in libraries under your user profile directory as the service was running by default when Windows started. Out of the box, this meant you could find documents you saved to these locations very quickly and efficiently. The extensibility at this point kept improving, while continuing to support the same set of APIs to query the index‚Äôs content created in Windows NT 4.0 so that applications continued to work as they always had.</p><h2>Windows 7 (2009)</h2><p>Most of the indexing features of Windows Vista went straight into Windows 7. By default, the indexing service indexed all files and folders under your user profile, but it did <strong>not</strong> index contents of <em>all</em> the files on your machine. This was something had to be turned on by the user. There was a new dialog in the Control Panel named <em>Change search options for files and folders </em>that you could use to fine tune how search worked on your machine. This directly impacted the behavior of the indexing service and how it handled your files.</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-28.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-28.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-28.png 831w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-28-300x252.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-28-768x646.png 768w" sizes="(max-width: 831px) 100vw, 831px"> </a></p><p>Once you turned on ‚ÄúAlways search file names and contents‚Äù in the folder options search tab you had to wait a little bit for the service to re-index the content of all the files currently stored by the indexing service. Afterwards you could start searching for content in the start menu and file explorer search bar to find any of your important documents by just typing in a few words contained inside your files.</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-29.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-29.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-29.png 1008w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-29-300x225.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-29-768x575.png 768w" sizes="(max-width: 1008px) 100vw, 1008px"> </a></p><blockquote><p>The service in Windows 7 also kept track of where certain words were in the files so that Windows‚Äô components such as file explorer above could highlight those occurrences on screen.</p></blockquote><h2>Windows 8/8.1 (2012)</h2><p>Unlike Windows 7, in Windows 8 the indexing of the content of your files in your user profile was turned <strong>on</strong> by default. Searching was very easy in Windows 8 as you could just start typing and it would automatically enter in your criteria and search across settings files and apps all at the same time.</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-31.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-31.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-31.png 923w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-31-300x155.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-31-768x396.png 768w" sizes="(max-width: 923px) 100vw, 923px"> </a></p><h2>Windows 10 (2015)</h2><p>Windows 10 contains the latest version of the Search Indexer, with added support to run on many different types of devices.</p><p>A new settings page was introduced in the Settings application from the store to highlight different options of the search indexer that weren‚Äôt exposed before. We‚Äôre going to do a much more detailed settings and configuration walkthrough in the next post, but I will discuss a few briefly here.</p><p><a href="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-32.png" data-featherlight="image"> <img src="http://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-32.png" srcset="https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-32.png 1202w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-32-300x193.png 300w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-32-1024x659.png 1024w, https://devblogs.microsoft.com/windows-search-platform/wp-content/uploads/sites/54/2020/03/word-image-32-768x495.png 768w" sizes="(max-width: 1202px) 100vw, 1202px"> </a></p><p><strong>Excluded Folders</strong><br> You can now exclude certain folders from the index if you think those folders aren‚Äôt valuable to be indexed. This is useful for large folders in your user profile directory that would otherwise be indexed for content. Excluding files/folders that don‚Äôt contain useful content helps the performance of your system overall, and allows the index to use less space on your disk.</p><p><strong>Enhanced Search</strong><br> On top of that, there is a new <em>Find my Files</em> ‚ÄúEnhanced‚Äù mode which will crawl all other drives and folders outside of your user profile directory (besides a few system areas) for metadata only. This means you can find all of those files by file name or other basic properties, but you cannot search for them using words within the contents of the files. This makes it much faster and easier to find files by name than by searching via the filesystem alone.</p><p>Looking back, although Cairo and WinFS were never actually released, the ‚Äòcontent indexing‚Äô pieces of these technologies as they were named still live on today and have been used across many different technologies at Microsoft. While the code has been improved by many teams over the course of time, and across many different versions of Windows, it still shares a common set of interfaces for developers to use to this day.</p><p>Thanks for tuning in, next up a much more detailed look into ‚Äì Windows Search Configuration and Settings.</p></div></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>