<!DOCTYPE html>
<html lang="en">
<head>
    <title>
OpenPGP Message Format - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="OpenPGP Message Format - linksfor.dev(s)"/>
    <meta property="article:author" content="Daniel Kahn Gillmor"/>
    <meta property="og:description" content="{ Work in progress to update the OpenPGP specification from RFC4880 } &#xA;       This document specifies the message formats used in OpenPGP.  OpenPGP&#xA;provides encryption with public-key or symmetric cryptographic&#xA;algorithms, digital signatures, compression and key management. &#xA;       This document is maintained in order to publish all necessary&#xA;information needed to develop interoperable applications based on the&#xA;OpenPGP format.  It is not a step-by-step cookbook for writing an&#xA;application.  It describes only the format and methods needed to read,&#xA;check, generate, and write conforming packets crossing any network.&#xA;It does not deal with storage and implementation questions.  It does,&#xA;however, discuss implementation issues necessary to avoid security&#xA;flaws."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.ietf.org/id/draft-ietf-openpgp-rfc4880bis-09.html"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - OpenPGP Message Format</title>
<div class="readable">
        <h1>OpenPGP Message Format</h1>
            <div>by Daniel Kahn Gillmor</div>
            <div>Reading time: 211-268 minutes</div>
        <div>Posted here: 01 May 2020</div>
        <p><a href="https://www.ietf.org/id/draft-ietf-openpgp-rfc4880bis-09.html">https://www.ietf.org/id/draft-ietf-openpgp-rfc4880bis-09.html</a></p>
        <hr/>
<div id="readability-page-1" class="page">

<table>
<thead><tr>
<td>Internet-Draft</td>
<td>OpenPGP Message Format</td>
<td>March 2020</td>
</tr></thead>
<tfoot><tr>
<td>Koch, et al.</td>
<td>Expires 10 September 2020</td>
<td>[Page]</td>
</tr></tfoot>
</table>



<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">{ Work in progress to update the OpenPGP specification from RFC4880 }<a href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document specifies the message formats used in OpenPGP.  OpenPGP
provides encryption with public-key or symmetric cryptographic
algorithms, digital signatures, compression and key management.<a href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">This document is maintained in order to publish all necessary
information needed to develop interoperable applications based on the
OpenPGP format.  It is not a step-by-step cookbook for writing an
application.  It describes only the format and methods needed to read,
check, generate, and write conforming packets crossing any network.
It does not deal with storage and implementation questions.  It does,
however, discuss implementation issues necessary to avoid security
flaws.<a href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 10 September 2020.<a href="#section-boilerplate.1-4">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>

<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1">1. </a><a href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">{ This is work in progress to update OpenPGP.  Editorial notes are
  enclosed in curly braces. }<a href="#section-1-1">¶</a></p>
<p id="section-1-2">This document provides information on the message-exchange packet
formats used by OpenPGP to provide encryption, decryption, signing,
and key management functions.  It is a revision of RFC 4880, "OpenPGP
Message Format", which is a revision of RFC 2440, which itself
replaces RFC 1991, "PGP Message Exchange Formats" <span>[<a href="#RFC1991">RFC1991</a>]</span>
        <span>[<a href="#RFC2440">RFC2440</a>]</span> <span>[<a href="#RFC4880">RFC4880</a>]</span>.<a href="#section-1-2">¶</a></p>
<p id="section-1-3">This document obsoletes: RFC 4880 (OpenPGP), RFC 5581 (Camellia
cipher) and RFC 6637 (ECC for OpenPGP).<a href="#section-1-3">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terms">
<a href="#section-1.1">1.1. </a><a href="#name-terms">Terms</a>
        </h3>
<ul>
<li id="section-1.1-1.1">OpenPGP - This is a term for security software that uses PGP 5
as a basis, formalized in this document.<a href="#section-1.1-1.1">¶</a>
</li>
<li id="section-1.1-1.2">PGP - Pretty Good Privacy.  PGP is a family of software systems
developed by Philip R. Zimmermann from which OpenPGP is based.<a href="#section-1.1-1.2">¶</a>
</li>
<li id="section-1.1-1.3">PGP 2 - This version of PGP has many variants; where necessary a
more detailed version number is used here.  PGP 2 uses only RSA,
MD5, and IDEA for its cryptographic transforms.  An informational
RFC, RFC 1991, was written describing this version of PGP.<a href="#section-1.1-1.3">¶</a>
</li>
<li id="section-1.1-1.4">PGP 5 - This version of PGP is formerly known as "PGP 3" in the
community.  It has new formats and corrects a number of problems
in the PGP 2 design.  It is referred to here as PGP 5 because that
software was the first release of the "PGP 3" code base.<a href="#section-1.1-1.4">¶</a>
</li>
<li id="section-1.1-1.5">GnuPG - GNU Privacy Guard, also called GPG.  GnuPG is an OpenPGP
implementation that avoids all encumbered algorithms.
Consequently, early versions of GnuPG did not include RSA public
keys.<a href="#section-1.1-1.5">¶</a>
</li>
</ul>
<p id="section-1.1-2">"PGP", "Pretty Good", and "Pretty Good Privacy" are trademarks of PGP
Corporation and are used with permission.  The term "OpenPGP" refers to
the protocol described in this and related documents.<a href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <span>[<a href="#RFC2119">RFC2119</a>]</span>.<a href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">The key words "PRIVATE USE", "EXPERT REVIEW", "SPECIFICATION
REQUIRED", "RFC REQUIRED", and "IETF REVIEW" that appear in this
document when used to describe namespace allocation are to be
interpreted as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-1.1-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="general-functions">
<section id="section-2">
      <h2 id="name-general-functions">
<a href="#section-2">2. </a><a href="#name-general-functions">General functions</a>
      </h2>
<p id="section-2-1">OpenPGP provides data integrity services for messages and data files
by using these core technologies:<a href="#section-2-1">¶</a></p>
<ul>
<li id="section-2-2.1">digital signatures<a href="#section-2-2.1">¶</a>
</li>
<li id="section-2-2.2">encryption<a href="#section-2-2.2">¶</a>
</li>
<li id="section-2-2.3">compression<a href="#section-2-2.3">¶</a>
</li>
<li id="section-2-2.4">Radix-64 conversion<a href="#section-2-2.4">¶</a>
</li>
</ul>
<p id="section-2-3">In addition, OpenPGP provides key management and certificate services,
but many of these are beyond the scope of this document.<a href="#section-2-3">¶</a></p>
<div id="confidentiality-via-encryption">
<section id="section-2.1">
        <h3 id="name-confidentiality-via-encrypt">
<a href="#section-2.1">2.1. </a><a href="#name-confidentiality-via-encrypt">Confidentiality via Encryption</a>
        </h3>
<p id="section-2.1-1">OpenPGP combines symmetric-key encryption and public-key encryption to
provide confidentiality.  When made confidential, first the object is
encrypted using a symmetric encryption algorithm.  Each symmetric key
is used only once, for a single object. A new "session key" is
generated as a random number for each object (sometimes referred to as
a session).  Since it is used only once, the session key is bound to
the message and transmitted with it.  To protect the key, it is
encrypted with the receiver's public key.  The sequence is as follows:<a href="#section-2.1-1">¶</a></p>
<ol start="1" type="1" id="section-2.1-2">
          <li id="section-2.1-2.1">The sender creates a message.<a href="#section-2.1-2.1">¶</a>
</li>
<li id="section-2.1-2.2">The sending OpenPGP generates a random number to be used as a
session key for this message only.<a href="#section-2.1-2.2">¶</a>
</li>
<li id="section-2.1-2.3">The session key is encrypted using each recipient's public key.
These "encrypted session keys" start the message.<a href="#section-2.1-2.3">¶</a>
</li>
<li id="section-2.1-2.4">The sending OpenPGP encrypts the message using the session key,
which forms the remainder of the message.  Note that the message is
also usually compressed.<a href="#section-2.1-2.4">¶</a>
</li>
<li id="section-2.1-2.5">The receiving OpenPGP decrypts the session key using the recipient's
private key.<a href="#section-2.1-2.5">¶</a>
</li>
<li id="section-2.1-2.6">The receiving OpenPGP decrypts the message using the session key.  If
the message was compressed, it will be decompressed.<a href="#section-2.1-2.6">¶</a>
</li>
</ol>
<p id="section-2.1-3">With symmetric-key encryption, an object may be encrypted with a
symmetric key derived from a passphrase (or other shared secret), or a
two-stage mechanism similar to the public-key method described above
in which a session key is itself encrypted with a symmetric algorithm
keyed from a shared secret.<a href="#section-2.1-3">¶</a></p>
<p id="section-2.1-4">Both digital signature and confidentiality services may be applied to
the same message.  First, a signature is generated for the message and
attached to the message.  Then the message plus signature is encrypted
using a symmetric session key.  Finally, the session key is encrypted
using public-key encryption and prefixed to the encrypted block.<a href="#section-2.1-4">¶</a></p>
</section>
</div>
<div id="authentication-via-digital-signature">
<section id="section-2.2">
        <h3 id="name-authentication-via-digital-">
<a href="#section-2.2">2.2. </a><a href="#name-authentication-via-digital-">Authentication via Digital Signature</a>
        </h3>
<p id="section-2.2-1">The digital signature uses a hash code or message digest algorithm,
and a public-key signature algorithm.  The sequence is as follows:<a href="#section-2.2-1">¶</a></p>
<ol start="1" type="1" id="section-2.2-2">
          <li id="section-2.2-2.1">The sender creates a message.<a href="#section-2.2-2.1">¶</a>
</li>
<li id="section-2.2-2.2">The sending software generates a hash code of the message.<a href="#section-2.2-2.2">¶</a>
</li>
<li id="section-2.2-2.3">The sending software generates a signature from the hash code using
the sender's private key.<a href="#section-2.2-2.3">¶</a>
</li>
<li id="section-2.2-2.4">The binary signature is attached to the message.<a href="#section-2.2-2.4">¶</a>
</li>
<li id="section-2.2-2.5">The receiving software keeps a copy of the message signature.<a href="#section-2.2-2.5">¶</a>
</li>
<li id="section-2.2-2.6">The receiving software generates a new hash code for the received
message and verifies it using the message's signature.  If the
verification is successful, the message is accepted as authentic.<a href="#section-2.2-2.6">¶</a>
</li>
</ol>
</section>
</div>
<div id="compression">
<section id="section-2.3">
        <h3 id="name-compression">
<a href="#section-2.3">2.3. </a><a href="#name-compression">Compression</a>
        </h3>
<p id="section-2.3-1">OpenPGP implementations SHOULD compress the message after applying the
signature but before encryption.<a href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">If an implementation does not implement compression, its authors
should be aware that most OpenPGP messages in the world are
compressed.  Thus, it may even be wise for a space-constrained
implementation to implement decompression, but not compression.<a href="#section-2.3-2">¶</a></p>
<p id="section-2.3-3">Furthermore, compression has the added side effect that some types of
attacks can be thwarted by the fact that slightly altered, compressed
data rarely uncompresses without severe errors.  This is hardly
rigorous, but it is operationally useful.  These attacks can be
rigorously prevented by implementing and using Modification Detection
Codes as described in sections following.<a href="#section-2.3-3">¶</a></p>
</section>
</div>
<div id="conversion-to-radix-64">
<section id="section-2.4">
        <h3 id="name-conversion-to-radix-64">
<a href="#section-2.4">2.4. </a><a href="#name-conversion-to-radix-64">Conversion to Radix-64</a>
        </h3>
<p id="section-2.4-1">OpenPGP's underlying native representation for encrypted messages,
signature certificates, and keys is a stream of arbitrary octets.  Some
systems only permit the use of blocks consisting of seven-bit,
printable text.  For transporting OpenPGP's native raw binary octets
through channels that are not safe to raw binary data, a printable
encoding of these binary octets is needed.  OpenPGP provides the
service of converting the raw 8-bit binary octet stream to a stream of
printable ASCII characters, called Radix-64 encoding or ASCII Armor.<a href="#section-2.4-1">¶</a></p>
<p id="section-2.4-2">Implementations SHOULD provide Radix-64 conversions.<a href="#section-2.4-2">¶</a></p>
</section>
</div>
<div id="signature-only-applications">
<section id="section-2.5">
        <h3 id="name-signature-only-applications">
<a href="#section-2.5">2.5. </a><a href="#name-signature-only-applications">Signature-Only Applications</a>
        </h3>
<p id="section-2.5-1">OpenPGP is designed for applications that use both encryption and
signatures, but there are a number of problems that are solved by a
signature-only implementation.  Although this specification requires
both encryption and signatures, it is reasonable for there to be
subset implementations that are non-conformant only in that they omit
encryption.<a href="#section-2.5-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="data-element-formats">
<section id="section-3">
      <h2 id="name-data-element-formats">
<a href="#section-3">3. </a><a href="#name-data-element-formats">Data Element Formats</a>
      </h2>
<p id="section-3-1">This section describes the data elements used by OpenPGP.<a href="#section-3-1">¶</a></p>
<div id="scalar-numbers">
<section id="section-3.1">
        <h3 id="name-scalar-numbers">
<a href="#section-3.1">3.1. </a><a href="#name-scalar-numbers">Scalar Numbers</a>
        </h3>
<p id="section-3.1-1">Scalar numbers are unsigned and are always stored in big-endian
format.  Using n[k] to refer to the kth octet being interpreted, the
value of a two-octet scalar is ((n[0] &lt;&lt;&nbsp;8) + n[1]).  The value of a
four-octet scalar is ((n[0] &lt;&lt;&nbsp;24) + (n[1] &lt;&lt;&nbsp;16) + (n[2] &lt;&lt;&nbsp;8) + n[3]).<a href="#section-3.1-1">¶</a></p>
</section>
</div>
<div id="multiprecision-integers">
<section id="section-3.2">
        <h3 id="name-multiprecision-integers">
<a href="#section-3.2">3.2. </a><a href="#name-multiprecision-integers">Multiprecision Integers</a>
        </h3>
<p id="section-3.2-1">Multiprecision integers (also called MPIs) are unsigned integers used
to hold large integers such as the ones used in cryptographic
calculations.<a href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">An MPI consists of two pieces: a two-octet scalar that is the length
of the MPI in bits followed by a string of octets that contain the
actual integer.<a href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">These octets form a big-endian number; a big-endian number can be made
into an MPI by prefixing it with the appropriate length.<a href="#section-3.2-3">¶</a></p>
<p id="section-3.2-4">Examples:<a href="#section-3.2-4">¶</a></p>
<p id="section-3.2-5">(all numbers are in hexadecimal)<a href="#section-3.2-5">¶</a></p>
<p id="section-3.2-6">The string of octets [00 01 01] forms an MPI with the value 1.  The
string [00 09 01 FF] forms an MPI with the value of 511.<a href="#section-3.2-6">¶</a></p>
<p id="section-3.2-7">Additional rules:<a href="#section-3.2-7">¶</a></p>
<p id="section-3.2-8">The size of an MPI is ((MPI.length + 7) / 8) + 2 octets.<a href="#section-3.2-8">¶</a></p>
<p id="section-3.2-9">The length field of an MPI describes the length starting from its most
significant non-zero bit.  Thus, the MPI [00 02 01] is not formed
correctly.  It should be [00 01 01].<a href="#section-3.2-9">¶</a></p>
<p id="section-3.2-10">Unused bits of an MPI MUST be zero.<a href="#section-3.2-10">¶</a></p>
<p id="section-3.2-11">Also note that when an MPI is encrypted, the length refers to the
plaintext MPI.  It may be ill-formed in its ciphertext.<a href="#section-3.2-11">¶</a></p>
</section>
</div>
<div id="key-ids">
<section id="section-3.3">
        <h3 id="name-key-ids">
<a href="#section-3.3">3.3. </a><a href="#name-key-ids">Key IDs</a>
        </h3>
<p id="section-3.3-1">A Key ID is an eight-octet scalar that identifies a
key.  Implementations SHOULD NOT assume that Key IDs are unique.  The
section "Enhanced Key Formats" below describes how Key IDs are formed.<a href="#section-3.3-1">¶</a></p>
</section>
</div>
<div id="text">
<section id="section-3.4">
        <h3 id="name-text">
<a href="#section-3.4">3.4. </a><a href="#name-text">Text</a>
        </h3>
<p id="section-3.4-1">Unless otherwise specified, the character set for text is the UTF-8
<span>[<a href="#RFC3629">RFC3629</a>]</span> encoding of Unicode <span>[<a href="#ISO10646">ISO10646</a>]</span>.<a href="#section-3.4-1">¶</a></p>
</section>
</div>
<div id="time-fields">
<section id="section-3.5">
        <h3 id="name-time-fields">
<a href="#section-3.5">3.5. </a><a href="#name-time-fields">Time Fields</a>
        </h3>
<p id="section-3.5-1">A time field is an unsigned four-octet number containing the number of
seconds elapsed since midnight, 1 January 1970 UTC.<a href="#section-3.5-1">¶</a></p>
</section>
</div>
<div id="keyrings">
<section id="section-3.6">
        <h3 id="name-keyrings">
<a href="#section-3.6">3.6. </a><a href="#name-keyrings">Keyrings</a>
        </h3>
<p id="section-3.6-1">A keyring is a collection of one or more keys in a file or database.
Traditionally, a keyring is simply a sequential list of keys, but may
be any suitable database.  It is beyond the scope of this standard to
discuss the details of keyrings or other databases.<a href="#section-3.6-1">¶</a></p>
</section>
</div>
<div id="string-to-key-s2k-specifiers">
<section id="section-3.7">
        <h3 id="name-string-to-key-s2k-specifier">
<a href="#section-3.7">3.7. </a><a href="#name-string-to-key-s2k-specifier">String-to-Key (S2K) Specifiers</a>
        </h3>
<p id="section-3.7-1">String-to-key (S2K) specifiers are used to convert passphrase strings
into symmetric-key encryption/decryption keys.  They are used in two
places, currently: to encrypt the secret part of private keys in the
private keyring, and to convert passphrases to encryption keys for
symmetrically encrypted messages.<a href="#section-3.7-1">¶</a></p>
<div id="string-to-key-s2k-specifier-types">
<section id="section-3.7.1">
          <h4 id="name-string-to-key-s2k-specifier-">
<a href="#section-3.7.1">3.7.1. </a><a href="#name-string-to-key-s2k-specifier-">String-to-Key (S2K) Specifier Types</a>
          </h4>
<p id="section-3.7.1-1">There are three types of S2K specifiers currently supported, and some
reserved values:<a href="#section-3.7.1-1">¶</a></p>
<table id="table-1">
            <caption><a href="#table-1">Table 1</a></caption>
<thead>
              <tr>
                <th rowspan="1" colspan="1">ID</th>
                <th rowspan="1" colspan="1">S2K Type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">Simple S2K</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">Salted S2K</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">Reserved value</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">Iterated and Salted S2K</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">100 to 110</td>
                <td rowspan="1" colspan="1">Private/Experimental S2K</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.7.1-3">These are described in the following Sections.<a href="#section-3.7.1-3">¶</a></p>
<div id="simple-s2k">
<section id="section-3.7.1.1">
            <h5 id="name-simple-s2k">
<a href="#section-3.7.1.1">3.7.1.1. </a><a href="#name-simple-s2k">Simple S2K</a>
            </h5>
<p id="section-3.7.1.1-1">This directly hashes the string to produce the key data.  See below for
how this hashing is done.<a href="#section-3.7.1.1-1">¶</a></p>
<div id="section-3.7.1.1-2">
<pre>   Octet 0:        0x00
   Octet 1:        hash algorithm
</pre><p><a href="#section-3.7.1.1-2">¶</a>
</p></div>
<p id="section-3.7.1.1-3">Simple S2K hashes the passphrase to produce the session key.  The
manner in which this is done depends on the size of the session key
(which will depend on the cipher used) and the size of the hash
algorithm's output.  If the hash size is greater than the session key
size, the high-order (leftmost) octets of the hash are used as the
key.<a href="#section-3.7.1.1-3">¶</a></p>
<p id="section-3.7.1.1-4">If the hash size is less than the key size, multiple instances of the
hash context are created -- enough to produce the required key data.
These instances are preloaded with 0, 1, 2, ... octets of zeros (that
is to say, the first instance has no preloading, the second gets
preloaded with 1 octet of zero, the third is preloaded with two octets
of zeros, and so forth).<a href="#section-3.7.1.1-4">¶</a></p>
<p id="section-3.7.1.1-5">As the data is hashed, it is given independently to each hash context.
Since the contexts have been initialized differently, they will each
produce different hash output.  Once the passphrase is hashed, the
output data from the multiple hashes is concatenated, first hash
leftmost, to produce the key data, with any excess octets on the right
discarded.<a href="#section-3.7.1.1-5">¶</a></p>
</section>
</div>
<div id="salted-s2k">
<section id="section-3.7.1.2">
            <h5 id="name-salted-s2k">
<a href="#section-3.7.1.2">3.7.1.2. </a><a href="#name-salted-s2k">Salted S2K</a>
            </h5>
<p id="section-3.7.1.2-1">This includes a "salt" value in the S2K specifier -- some arbitrary
data -- that gets hashed along with the passphrase string, to help
prevent dictionary attacks.<a href="#section-3.7.1.2-1">¶</a></p>
<div id="section-3.7.1.2-2">
<pre>   Octet 0:        0x01
   Octet 1:        hash algorithm
   Octets 2-9:     8-octet salt value
</pre><p><a href="#section-3.7.1.2-2">¶</a>
</p></div>
<p id="section-3.7.1.2-3">Salted S2K is exactly like Simple S2K, except that the input to the
hash function(s) consists of the 8 octets of salt from the S2K
specifier, followed by the passphrase.<a href="#section-3.7.1.2-3">¶</a></p>
</section>
</div>
<div id="iterated-and-salted-s2k">
<section id="section-3.7.1.3">
            <h5 id="name-iterated-and-salted-s2k">
<a href="#section-3.7.1.3">3.7.1.3. </a><a href="#name-iterated-and-salted-s2k">Iterated and Salted S2K</a>
            </h5>
<p id="section-3.7.1.3-1">This includes both a salt and an octet count.  The salt is combined
with the passphrase and the resulting value is hashed repeatedly.  This
further increases the amount of work an attacker must do to try
dictionary attacks.<a href="#section-3.7.1.3-1">¶</a></p>
<div id="section-3.7.1.3-2">
<pre>   Octet  0:        0x03
   Octet  1:        hash algorithm
   Octets 2-9:      8-octet salt value
   Octet  10:       count, a one-octet, coded value
</pre><p><a href="#section-3.7.1.3-2">¶</a>
</p></div>
<p id="section-3.7.1.3-3">The count is coded into a one-octet number using the following
formula:<a href="#section-3.7.1.3-3">¶</a></p>
<div id="section-3.7.1.3-4">
<pre>   #define EXPBIAS 6
       count = ((Int32)16 + (c &amp; 15)) &lt;&lt; ((c &gt;&gt; 4) + EXPBIAS);
</pre><p><a href="#section-3.7.1.3-4">¶</a>
</p></div>
<p id="section-3.7.1.3-5">The above formula is in C, where "Int32" is a type for a 32-bit
integer, and the variable "c" is the coded count, Octet 10.<a href="#section-3.7.1.3-5">¶</a></p>
<p id="section-3.7.1.3-6">Iterated-Salted S2K hashes the passphrase and salt data multiple
times.  The total number of octets to be hashed is specified in the
encoded count in the S2K specifier.  Note that the resulting count
value is an octet count of how many octets will be hashed, not an
iteration count.<a href="#section-3.7.1.3-6">¶</a></p>
<p id="section-3.7.1.3-7">Initially, one or more hash contexts are set up as with the other S2K
algorithms, depending on how many octets of key data are needed.  Then
the salt, followed by the passphrase data, is repeatedly hashed until
the number of octets specified by the octet count has been hashed.  The
one exception is that if the octet count is less than the size of the
salt plus passphrase, the full salt plus passphrase will be hashed
even though that is greater than the octet count.  After the hashing is
done, the data is unloaded from the hash context(s) as with the other
S2K algorithms.<a href="#section-3.7.1.3-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="string-to-key-usage">
<section id="section-3.7.2">
          <h4 id="name-string-to-key-usage">
<a href="#section-3.7.2">3.7.2. </a><a href="#name-string-to-key-usage">String-to-Key Usage</a>
          </h4>
<p id="section-3.7.2-1">Implementations SHOULD use salted or iterated-and-salted S2K
specifiers, as simple S2K specifiers are more vulnerable to dictionary
attacks.<a href="#section-3.7.2-1">¶</a></p>
<div id="secret-key-encryption">
<section id="section-3.7.2.1">
            <h5 id="name-secret-key-encryption">
<a href="#section-3.7.2.1">3.7.2.1. </a><a href="#name-secret-key-encryption">Secret-Key Encryption</a>
            </h5>
<p id="section-3.7.2.1-1">An S2K specifier can be stored in the secret keyring to specify how to
convert the passphrase to a key that unlocks the secret data.  Older
versions of PGP just stored a cipher algorithm octet preceding the
secret data or a zero to indicate that the secret data was
unencrypted.  The MD5 hash function was always used to convert the
passphrase to a key for the specified cipher algorithm.<a href="#section-3.7.2.1-1">¶</a></p>
<p id="section-3.7.2.1-2">For compatibility, when an S2K specifier is used, the special value
253, 254, or 255 is stored in the position where the hash algorithm octet
would have been in the old data structure.  This is then followed
immediately by a one-octet algorithm identifier, and then by the S2K
specifier as encoded above.<a href="#section-3.7.2.1-2">¶</a></p>
<p id="section-3.7.2.1-3">Therefore, preceding the secret data there will be one of these
possibilities:<a href="#section-3.7.2.1-3">¶</a></p>
<div id="section-3.7.2.1-4">
<pre>   0:                 secret data is unencrypted (no passphrase)
   255, 254, or 253:  followed by algorithm octet and S2K specifier
   Cipher alg:        use Simple S2K algorithm using MD5 hash
</pre><p><a href="#section-3.7.2.1-4">¶</a>
</p></div>
<p id="section-3.7.2.1-5">This last possibility, the cipher algorithm number with an implicit
use of MD5 and IDEA, is provided for backward compatibility; it MAY be
understood, but SHOULD NOT be generated, and is deprecated.<a href="#section-3.7.2.1-5">¶</a></p>
<p id="section-3.7.2.1-6">These are followed by an Initial Vector of the same length as the
block size of the cipher for the decryption of the secret values, if
they are encrypted, and then the secret-key values themselves.<a href="#section-3.7.2.1-6">¶</a></p>
</section>
</div>
<div id="symmetric-key-message-encryption">
<section id="section-3.7.2.2">
            <h5 id="name-symmetric-key-message-encry">
<a href="#section-3.7.2.2">3.7.2.2. </a><a href="#name-symmetric-key-message-encry">Symmetric-Key Message Encryption</a>
            </h5>
<p id="section-3.7.2.2-1">OpenPGP can create a Symmetric-key Encrypted Session Key (ESK) packet
at the front of a message.  This is used to allow S2K specifiers to be
used for the passphrase conversion or to create messages with a mix of
symmetric-key ESKs and public-key ESKs.  This allows a message to be
decrypted either with a passphrase or a public-key pair.<a href="#section-3.7.2.2-1">¶</a></p>
<p id="section-3.7.2.2-2">PGP 2 always used IDEA with Simple string-to-key conversion when
encrypting a message with a symmetric algorithm.  This is deprecated,
but MAY be used for backward-compatibility.<a href="#section-3.7.2.2-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="packet-syntax">
<section id="section-4">
      <h2 id="name-packet-syntax">
<a href="#section-4">4. </a><a href="#name-packet-syntax">Packet Syntax</a>
      </h2>
<p id="section-4-1">This section describes the packets used by OpenPGP.<a href="#section-4-1">¶</a></p>
<div id="overview">
<section id="section-4.1">
        <h3 id="name-overview">
<a href="#section-4.1">4.1. </a><a href="#name-overview">Overview</a>
        </h3>
<p id="section-4.1-1">An OpenPGP message is constructed from a number of records that are
traditionally called packets. A packet is a chunk of data that has a
tag specifying its meaning.  An OpenPGP message, keyring, certificate,
and so forth consists of a number of packets.  Some of those packets
may contain other OpenPGP packets (for example, a compressed data
packet, when uncompressed, contains OpenPGP packets).<a href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">Each packet consists of a packet header, followed by the packet body.
The packet header is of variable length.<a href="#section-4.1-2">¶</a></p>
</section>
</div>


</section>
</div>
<div id="packet-types">
<section id="section-5">
      <h2 id="name-packet-types">
<a href="#section-5">5. </a><a href="#name-packet-types">Packet Types</a>
      </h2>
<div id="public-key-encrypted-session-key-packets-tag-1">
<section id="section-5.1">
        <h3 id="name-public-key-encrypted-sessio">
<a href="#section-5.1">5.1. </a><a href="#name-public-key-encrypted-sessio">Public-Key Encrypted Session Key Packets (Tag 1)</a>
        </h3>
<p id="section-5.1-1">A Public-Key Encrypted Session Key packet holds the session key used
to encrypt a message.  Zero or more Public-Key Encrypted Session Key
packets and/or Symmetric-Key Encrypted Session Key packets may precede
a Symmetrically Encrypted Data Packet, which holds an encrypted
message.  The message is encrypted with the session key, and the
session key is itself encrypted and stored in the Encrypted Session
Key packet(s).  The Symmetrically Encrypted Data Packet is preceded by
one Public-Key Encrypted Session Key packet for each OpenPGP key to
which the message is encrypted.  The recipient of the message finds a
session key that is encrypted to their public key, decrypts the
session key, and then uses the session key to decrypt the message.<a href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">The body of this packet consists of:<a href="#section-5.1-2">¶</a></p>
<ul>
<li id="section-5.1-3.1">A one-octet number giving the version number of the packet
type.  The currently defined value for packet version is 3.<a href="#section-5.1-3.1">¶</a>
</li>
<li id="section-5.1-3.2">An eight-octet number that gives the Key ID of the public key to
which the session key is encrypted.  If the session key is encrypted
to a subkey, then the Key ID of this subkey is used here instead of
the Key ID of the primary key.<a href="#section-5.1-3.2">¶</a>
</li>
<li id="section-5.1-3.3">A one-octet number giving the public-key algorithm used.<a href="#section-5.1-3.3">¶</a>
</li>
<li id="section-5.1-3.4">
            <p id="section-5.1-3.4.1">A string of octets that is the encrypted session key.  This string
takes up the remainder of the packet, and its contents are dependent
on the public-key algorithm used.<a href="#section-5.1-3.4.1">¶</a></p>
<p id="section-5.1-3.4.2">
Algorithm Specific Fields for RSA encryption:<a href="#section-5.1-3.4.2">¶</a></p>
<ul>
<li id="section-5.1-3.4.3.1">Multiprecision integer (MPI) of RSA encrypted value m**e mod n.<a href="#section-5.1-3.4.3.1">¶</a>
</li>
</ul>
<p id="section-5.1-3.4.4">
Algorithm Specific Fields for Elgamal encryption:<a href="#section-5.1-3.4.4">¶</a></p>
<ul>
<li id="section-5.1-3.4.5.1">MPI of Elgamal (Diffie-Hellman) value g**k mod p.<a href="#section-5.1-3.4.5.1">¶</a>
</li>
<li id="section-5.1-3.4.5.2">MPI of Elgamal (Diffie-Hellman) value m * y**k mod p.<a href="#section-5.1-3.4.5.2">¶</a>
</li>
</ul>
<p id="section-5.1-3.4.6">
Algorithm-Specific Fields for ECDH encryption:<a href="#section-5.1-3.4.6">¶</a></p>
<ul>
<li id="section-5.1-3.4.7.1">MPI of an EC point representing an ephemeral public key.<a href="#section-5.1-3.4.7.1">¶</a>
</li>
<li id="section-5.1-3.4.7.2">a one-octet size, followed by a symmetric key encoded using the
method described in <a href="#ec-dh-algorithm-ecdh">Section 13.5</a>.<a href="#section-5.1-3.4.7.2">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.1-4">The value "m" in the above formulas is derived from the session key as
follows.  First, the session key is prefixed with a one-octet algorithm
identifier that specifies the symmetric encryption algorithm used to
encrypt the following Symmetrically Encrypted Data Packet.  Then a
two-octet checksum is appended, which is equal to the sum of the
preceding session key octets, not including the algorithm identifier,
modulo 65536.  This value is then encoded as described in PKCS#1 block
encoding EME-PKCS1-v1_5 in Section 7.2.1 of <span>[<a href="#RFC3447">RFC3447</a>]</span> to form the "m"
value used in the formulas above.  See <a href="#pkcs1-encoding-in-openpgp">Section 14.1</a>
of this document for notes on OpenPGP's use of PKCS#1.<a href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">Note that when an implementation forms several PKESKs with one session
key, forming a message that can be decrypted by several keys, the
implementation MUST make a new PKCS#1 encoding for each key.<a href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">An implementation MAY accept or use a Key ID of zero as a "wild card"
or "speculative" Key ID.  In this case, the receiving implementation
would try all available private keys, checking for a valid decrypted
session key.  This format helps reduce traffic analysis of messages.<a href="#section-5.1-6">¶</a></p>
</section>
</div>
<div id="signature-packet-tag-2">
<section id="section-5.2">
        <h3 id="name-signature-packet-tag-2">
<a href="#section-5.2">5.2. </a><a href="#name-signature-packet-tag-2">Signature Packet (Tag 2)</a>
        </h3>
<p id="section-5.2-1">A Signature packet describes a binding between some public key and
some data.  The most common signatures are a signature of a file or a
block of text, and a signature that is a certification of a User ID.<a href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">Three versions of Signature packets are defined.  Version 3 provides
basic signature information, while versions 4 and 5 provide an expandable
format with subpackets that can specify more information about the
signature.  PGP 2.6.x only accepts version 3 signatures.<a href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">Implementations MUST generate version 5 signatures when using a
version 5 key.  Implementations SHOULD generate V4 signatures with
version 4 keys.  Implementations MUST NOT create version 3 signatures;
they MAY accept version 3 signatures.<a href="#section-5.2-3">¶</a></p>
<div id="signature-types">
<section id="section-5.2.1">
          <h4 id="name-signature-types">
<a href="#section-5.2.1">5.2.1. </a><a href="#name-signature-types">Signature Types</a>
          </h4>
<p id="section-5.2.1-1">There are a number of possible meanings for a signature, which are
indicated in a signature type octet in any given signature.  Please
note that the vagueness of these meanings is not a flaw, but a feature
of the system.  Because OpenPGP places final authority for validity
upon the receiver of a signature, it may be that one signer's casual
act might be more rigorous than some other authority's positive
act.  See <a href="#computing-signatures">Section 5.2.4</a>, "Computing Signatures", for detailed
information on how to compute and verify signatures of each type.<a href="#section-5.2.1-1">¶</a></p>
<p id="section-5.2.1-2">These meanings are as follows:<a href="#section-5.2.1-2">¶</a></p>
<dl id="section-5.2.1-3">
            <dt id="section-5.2.1-3.1">0x00</dt>
<dd id="section-5.2.1-3.2">
  Signature of a binary document.  This means the signer owns it,
created it, or certifies that it has not been modified.<a href="#section-5.2.1-3.2">¶</a>
</dd>
<dt id="section-5.2.1-3.3">0x01</dt>
<dd id="section-5.2.1-3.4">
  Signature of a canonical text document.  This means the
signer owns it, created it, or certifies that it has not
been modified.  The signature is calculated over the text
data with its line endings converted to &lt;CR&gt;&lt;LF&gt;.<a href="#section-5.2.1-3.4">¶</a>
</dd>
<dt id="section-5.2.1-3.5">0x02</dt>
<dd id="section-5.2.1-3.6">
  Standalone signature.  This signature is a signature of only
its own subpacket contents.  It is calculated identically to
a signature over a zero-length binary document.  Note that it
doesn't make sense to have a V3 standalone signature.<a href="#section-5.2.1-3.6">¶</a>
</dd>
<dt id="section-5.2.1-3.7">0x10</dt>
<dd id="section-5.2.1-3.8">
  Generic certification of a User ID and Public-Key
packet.  The issuer of this certification does not make any
particular assertion as to how well the certifier has
checked that the owner of the key is in fact the person
described by the User ID.<a href="#section-5.2.1-3.8">¶</a>
</dd>
<dt id="section-5.2.1-3.9">0x11</dt>
<dd id="section-5.2.1-3.10">
  Persona certification of a User ID and Public-Key
packet.  The issuer of this certification has not done any
verification of the claim that the owner of this key is the
User ID specified.<a href="#section-5.2.1-3.10">¶</a>
</dd>
<dt id="section-5.2.1-3.11">0x12</dt>
<dd id="section-5.2.1-3.12">
  Casual certification of a User ID and Public-Key packet.  The
issuer of this certification has done some casual
verification of the claim of identity.<a href="#section-5.2.1-3.12">¶</a>
</dd>
<dt id="section-5.2.1-3.13">0x13</dt>
<dd id="section-5.2.1-3.14">
  Positive certification of a User ID and Public-Key packet.  The
issuer of this certification has done substantial verification
of the claim of identity.

Most OpenPGP implementations make their "key signatures" as 0x10
certifications.  Some implementations can issue 0x11-0x13
certifications, but few differentiate between the types.<a href="#section-5.2.1-3.14">¶</a>
</dd>
<dt id="section-5.2.1-3.15">0x16</dt>
<dd id="section-5.2.1-3.16">
  Attestion Key Signature.  This signature is issued by the primary
key over itself and its user ID (or user attribute).  It MUST
contain an "Attested Certifications" subpacket and a "Signature
Creation Time" subpacket.  This type of key signature does not
replace or override any standard certification (0x10-0x13).

Only the most recent Attestation Key Signature is valid for any
given &lt;key,userid&gt; pair.  If more than one Certification
Attestation Key Signature is present with the same Signature
Creation Time, the set of attestations should be treated as the
union of all "Attested Certifications" subpackets from all such
signatures with the same timestamp.<a href="#section-5.2.1-3.16">¶</a>
</dd>
<dt id="section-5.2.1-3.17">0x18</dt>
<dd id="section-5.2.1-3.18">
  Subkey Binding Signature. This signature is a statement by
the top-level signing key that indicates that it owns the
subkey.  This signature is calculated directly on the primary
key and subkey, and not on any User ID or other packets. A
signature that binds a signing subkey MUST have an Embedded
Signature subpacket in this binding signature that contains
a 0x19 signature made by the signing subkey on the primary
key and subkey.<a href="#section-5.2.1-3.18">¶</a>
</dd>
<dt id="section-5.2.1-3.19">0x19</dt>
<dd id="section-5.2.1-3.20">
  Primary Key Binding Signature. This signature is a statement
by a signing subkey, indicating that it is owned by the
primary key and subkey.  This signature is calculated the
same way as a 0x18 signature: directly on the primary key
and subkey, and not on any User ID or other packets.<a href="#section-5.2.1-3.20">¶</a>
</dd>
<dt id="section-5.2.1-3.21">0x1F</dt>
<dd id="section-5.2.1-3.22">
  Signature directly on a key. This signature is calculated
directly on a key.  It binds the information in the Signature
subpackets to the key, and is appropriate to be used for
subpackets that provide information about the key, such as
the Revocation Key subpacket.  It is also appropriate for
statements that non-self certifiers want to make about the
key itself, rather than the binding between a key and a
name.<a href="#section-5.2.1-3.22">¶</a>
</dd>
<dt id="section-5.2.1-3.23">0x20</dt>
<dd id="section-5.2.1-3.24">
  Key revocation signature. The signature is calculated
directly on the key being revoked. A revoked key is not to
be used.  Only revocation signatures by the key being
revoked, or by an authorized revocation key, should be
considered valid revocation signatures.<a href="#section-5.2.1-3.24">¶</a>
</dd>
<dt id="section-5.2.1-3.25">0x28</dt>
<dd id="section-5.2.1-3.26">
  Subkey revocation signature. The signature is calculated
directly on the subkey being revoked. A revoked subkey is
not to be used.  Only revocation signatures by the top-level
signature key that is bound to this subkey, or by an
authorized revocation key, should be considered valid
revocation signatures.<a href="#section-5.2.1-3.26">¶</a>
</dd>
<dt id="section-5.2.1-3.27">0x30</dt>
<dd id="section-5.2.1-3.28">
  Certification revocation signature. This signature revokes an
earlier User ID certification signature (signature class
0x10 through 0x13) or direct-key signature (0x1F).  It should
be issued by the same key that issued the revoked signature
or an authorized revocation key.  The signature is computed
over the same data as the certificate that it revokes, and
should have a later creation date than that certificate.<a href="#section-5.2.1-3.28">¶</a>
</dd>
<dt id="section-5.2.1-3.29">0x40</dt>
<dd id="section-5.2.1-3.30">
  Timestamp signature.  This signature is only meaningful for
the timestamp contained in it.<a href="#section-5.2.1-3.30">¶</a>
</dd>
<dt id="section-5.2.1-3.31">0x50</dt>
<dd id="section-5.2.1-3.32">
  Third-Party Confirmation signature.  This signature is a
signature over some other OpenPGP Signature packet(s).  It is
analogous to a notary seal on the signed data. A third-party
signature SHOULD include Signature Target subpacket(s) to
give easy identification.  Note that we really do mean
SHOULD.  There are plausible uses for this (such as a blind
party that only sees the signature, not the key or source
document) that cannot include a target subpacket.<a href="#section-5.2.1-3.32">¶</a>
</dd>
</dl>
</section>
</div>
<div id="version-3-signature-packet-format">
<section id="section-5.2.2">
          <h4 id="name-version-3-signature-packet-">
<a href="#section-5.2.2">5.2.2. </a><a href="#name-version-3-signature-packet-">Version 3 Signature Packet Format</a>
          </h4>
<p id="section-5.2.2-1">The body of a version 3 Signature Packet contains:<a href="#section-5.2.2-1">¶</a></p>
<ul>
<li id="section-5.2.2-2.1">One-octet version number (3).<a href="#section-5.2.2-2.1">¶</a>
</li>
<li id="section-5.2.2-2.2">One-octet length of following hashed material.  MUST be 5.<a href="#section-5.2.2-2.2">¶</a>
</li>
<li id="section-5.2.2-2.3">One-octet signature type.<a href="#section-5.2.2-2.3">¶</a>
</li>
<li id="section-5.2.2-2.4">Four-octet creation time.<a href="#section-5.2.2-2.4">¶</a>
</li>
<li id="section-5.2.2-2.5">Eight-octet Key ID of signer.<a href="#section-5.2.2-2.5">¶</a>
</li>
<li id="section-5.2.2-2.6">One-octet public-key algorithm.<a href="#section-5.2.2-2.6">¶</a>
</li>
<li id="section-5.2.2-2.7">One-octet hash algorithm.<a href="#section-5.2.2-2.7">¶</a>
</li>
<li id="section-5.2.2-2.8">Two-octet field holding left 16 bits of signed hash value.<a href="#section-5.2.2-2.8">¶</a>
</li>
<li id="section-5.2.2-2.9">
              <p id="section-5.2.2-2.9.1">One or more multiprecision integers comprising the signature.
This portion is algorithm specific, as described below.<a href="#section-5.2.2-2.9.1">¶</a></p>
<p id="section-5.2.2-2.9.2">
The concatenation of the data to be signed, the signature type, and
creation time from the Signature packet (5 additional octets) is
hashed.  The resulting hash value is used in the signature
algorithm.  The high 16 bits (first two octets) of the hash are
included in the Signature packet to provide a quick test to reject
some invalid signatures.<a href="#section-5.2.2-2.9.2">¶</a></p>
<p id="section-5.2.2-2.9.3">
Algorithm-Specific Fields for RSA signatures:<a href="#section-5.2.2-2.9.3">¶</a></p>
<ul>
<li id="section-5.2.2-2.9.4.1">Multiprecision integer (MPI) of RSA signature value m**d mod n.<a href="#section-5.2.2-2.9.4.1">¶</a>
</li>
</ul>
<p id="section-5.2.2-2.9.5">
Algorithm-Specific Fields for DSA and ECDSA signatures:<a href="#section-5.2.2-2.9.5">¶</a></p>
<ul>
<li id="section-5.2.2-2.9.6.1">MPI of DSA or ECDSA value r.<a href="#section-5.2.2-2.9.6.1">¶</a>
</li>
<li id="section-5.2.2-2.9.6.2">MPI of DSA or ECDSA value s.<a href="#section-5.2.2-2.9.6.2">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.2.2-3">The signature calculation is based on a hash of the signed data, as
described above.  The details of the calculation are different for DSA
signatures than for RSA signatures.<a href="#section-5.2.2-3">¶</a></p>
<p id="section-5.2.2-4">With RSA signatures, the hash value is encoded using PKCS#1 encoding
type EMSA-PKCS1-v1_5 as described in Section 9.2 of RFC 3447.  This
requires inserting the hash value as an octet string into an ASN.1
structure.  The object identifier for the type of hash being used is
included in the structure.  The hexadecimal representations for the
currently defined hash algorithms are as follows:<a href="#section-5.2.2-4">¶</a></p>
<div id="section-5.2.2-5">
<pre> - MD5:        0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x02, 0x05

 - RIPEMD-160: 0x2B, 0x24, 0x03, 0x02, 0x01

 - SHA-1:      0x2B, 0x0E, 0x03, 0x02, 0x1A

 - SHA2-224:   0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x04

 - SHA2-256:   0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x01

 - SHA2-384:   0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x02

 - SHA2-512:   0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x03
</pre><p><a href="#section-5.2.2-5">¶</a>
</p></div>
<p id="section-5.2.2-6">The ASN.1 Object Identifiers (OIDs) are as follows:<a href="#section-5.2.2-6">¶</a></p>
<div id="section-5.2.2-7">
<pre> - MD5:        1.2.840.113549.2.5

 - RIPEMD-160: 1.3.36.3.2.1

 - SHA-1:      1.3.14.3.2.26

 - SHA2-224:   2.16.840.1.101.3.4.2.4

 - SHA2-256:   2.16.840.1.101.3.4.2.1

 - SHA2-384:   2.16.840.1.101.3.4.2.2

 - SHA2-512:   2.16.840.1.101.3.4.2.3
</pre><p><a href="#section-5.2.2-7">¶</a>
</p></div>
<p id="section-5.2.2-8">The full hash prefixes for these are as follows:<a href="#section-5.2.2-8">¶</a></p>
<div id="section-5.2.2-9">
<pre> - MD5:        0x30, 0x20, 0x30, 0x0C, 0x06, 0x08, 0x2A, 0x86,
               0x48, 0x86, 0xF7, 0x0D, 0x02, 0x05, 0x05, 0x00,
               0x04, 0x10

 - RIPEMD-160: 0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x24,
               0x03, 0x02, 0x01, 0x05, 0x00, 0x04, 0x14

 - SHA-1:      0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2b, 0x0E,
               0x03, 0x02, 0x1A, 0x05, 0x00, 0x04, 0x14

 - SHA2-224:   0x30, 0x2D, 0x30, 0x0d, 0x06, 0x09, 0x60, 0x86,
               0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x04, 0x05,
               0x00, 0x04, 0x1C

 - SHA2-256:   0x30, 0x31, 0x30, 0x0d, 0x06, 0x09, 0x60, 0x86,
               0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x01, 0x05,
               0x00, 0x04, 0x20

 - SHA2-384:   0x30, 0x41, 0x30, 0x0d, 0x06, 0x09, 0x60, 0x86,
               0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x02, 0x05,
               0x00, 0x04, 0x30

 - SHA2-512:   0x30, 0x51, 0x30, 0x0d, 0x06, 0x09, 0x60, 0x86,
               0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x03, 0x05,
               0x00, 0x04, 0x40
</pre><p><a href="#section-5.2.2-9">¶</a>
</p></div>
<p id="section-5.2.2-10">DSA signatures MUST use hashes that are equal in size to the number of
bits of q, the group generated by the DSA key's generator value.<a href="#section-5.2.2-10">¶</a></p>
<p id="section-5.2.2-11">If the output size of the chosen hash is larger than the number of
bits of q, the hash result is truncated to fit by taking the number of
leftmost bits equal to the number of bits of q.  This (possibly
truncated) hash function result is treated as a number and used
directly in the DSA signature algorithm.<a href="#section-5.2.2-11">¶</a></p>
</section>
</div>
<div id="version-4-and-5-signature-packet-formats">
<section id="section-5.2.3">
          <h4 id="name-version-4-and-5-signature-p">
<a href="#section-5.2.3">5.2.3. </a><a href="#name-version-4-and-5-signature-p">Version 4 and 5 Signature Packet Formats</a>
          </h4>
<p id="section-5.2.3-1">The body of a V4 or V5 Signature packet contains:<a href="#section-5.2.3-1">¶</a></p>
<ul>
<li id="section-5.2.3-2.1">One-octet version number.  This is 4 for V4 signatures and
5 for V5 signatures.<a href="#section-5.2.3-2.1">¶</a>
</li>
<li id="section-5.2.3-2.2">One-octet signature type.<a href="#section-5.2.3-2.2">¶</a>
</li>
<li id="section-5.2.3-2.3">One-octet public-key algorithm.<a href="#section-5.2.3-2.3">¶</a>
</li>
<li id="section-5.2.3-2.4">One-octet hash algorithm.<a href="#section-5.2.3-2.4">¶</a>
</li>
<li id="section-5.2.3-2.5">Two-octet scalar octet count for following hashed subpacket
data.  Note that this is the length in octets of all of the
hashed subpackets; a pointer incremented by this number will
skip over the hashed subpackets.<a href="#section-5.2.3-2.5">¶</a>
</li>
<li id="section-5.2.3-2.6">Hashed subpacket data set (zero or more subpackets).<a href="#section-5.2.3-2.6">¶</a>
</li>
<li id="section-5.2.3-2.7">Two-octet scalar octet count for the following unhashed
subpacket data.  Note that this is the length in octets of all
of the unhashed subpackets; a pointer incremented by this
number will skip over the unhashed subpackets.<a href="#section-5.2.3-2.7">¶</a>
</li>
<li id="section-5.2.3-2.8">Unhashed subpacket data set (zero or more subpackets).<a href="#section-5.2.3-2.8">¶</a>
</li>
<li id="section-5.2.3-2.9">Two-octet field holding the left 16 bits of the signed hash
value.<a href="#section-5.2.3-2.9">¶</a>
</li>
<li id="section-5.2.3-2.10">
              <p id="section-5.2.3-2.10.1">One or more multiprecision integers comprising the signature.
This portion is algorithm specific:<a href="#section-5.2.3-2.10.1">¶</a></p>
<p id="section-5.2.3-2.10.2">
Algorithm-Specific Fields for RSA signatures:<a href="#section-5.2.3-2.10.2">¶</a></p>
<ul>
<li id="section-5.2.3-2.10.3.1">Multiprecision integer (MPI) of RSA signature value m**d mod n.<a href="#section-5.2.3-2.10.3.1">¶</a>
</li>
</ul>
<p id="section-5.2.3-2.10.4">
Algorithm-Specific Fields for DSA or ECDSA signatures:<a href="#section-5.2.3-2.10.4">¶</a></p>
<ul>
<li id="section-5.2.3-2.10.5.1">MPI of DSA or ECDSA value r.<a href="#section-5.2.3-2.10.5.1">¶</a>
</li>
<li id="section-5.2.3-2.10.5.2">MPI of DSA or ECDSA value s.<a href="#section-5.2.3-2.10.5.2">¶</a>
</li>
</ul>
<p id="section-5.2.3-2.10.6">
Algorithm-Specific Fields for EdDSA signatures:<a href="#section-5.2.3-2.10.6">¶</a></p>
<ul>
<li id="section-5.2.3-2.10.7.1">MPI of EdDSA compressed value r.<a href="#section-5.2.3-2.10.7.1">¶</a>
</li>
<li id="section-5.2.3-2.10.7.2">MPI of EdDSA compressed value s.<a href="#section-5.2.3-2.10.7.2">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.2.3-3">The compressed version of R and S for use with EdDSA is described in
<span>[<a href="#RFC8032">RFC8032</a>]</span>.  A version 3 signature MUST NOT be created
and MUST NOT be used with EdDSA.<a href="#section-5.2.3-3">¶</a></p>
<p id="section-5.2.3-4">The concatenation of the data being signed and the signature data from
the version number through the hashed subpacket data (inclusive) is
hashed.  The resulting hash value is what is signed.  The left 16 bits
of the hash are included in the Signature packet to provide a quick
test to reject some invalid signatures.<a href="#section-5.2.3-4">¶</a></p>
<p id="section-5.2.3-5">There are two fields consisting of Signature subpackets.  The first
field is hashed with the rest of the signature data, while the second
is unhashed.  The second set of subpackets is not cryptographically
protected by the signature and should include only advisory
information.<a href="#section-5.2.3-5">¶</a></p>
<p id="section-5.2.3-6">The difference between a V4 and V5 signature is that the latter
includes additional meta data.<a href="#section-5.2.3-6">¶</a></p>
<p id="section-5.2.3-7">The algorithms for converting the hash function result to a signature
are described in a section below.<a href="#section-5.2.3-7">¶</a></p>
<div id="signature-subpacket-specification">
<section id="section-5.2.3.1">
            <h5 id="name-signature-subpacket-specifi">
<a href="#section-5.2.3.1">5.2.3.1. </a><a href="#name-signature-subpacket-specifi">Signature Subpacket Specification</a>
            </h5>
<p id="section-5.2.3.1-1">A subpacket data set consists of zero or more Signature subpackets.  In
Signature packets, the subpacket data set is preceded by a two- octet
scalar count of the length in octets of all the subpackets. A pointer
incremented by this number will skip over the subpacket data set.<a href="#section-5.2.3.1-1">¶</a></p>
<p id="section-5.2.3.1-2">Each subpacket consists of a subpacket header and a body.  The header
consists of:<a href="#section-5.2.3.1-2">¶</a></p>
<ul>
<li id="section-5.2.3.1-3.1">the subpacket length (1, 2, or 5 octets),<a href="#section-5.2.3.1-3.1">¶</a>
</li>
<li id="section-5.2.3.1-3.2">the subpacket type (1 octet),<a href="#section-5.2.3.1-3.2">¶</a>
</li>
</ul>
<p id="section-5.2.3.1-4">and is followed by the subpacket-specific data.<a href="#section-5.2.3.1-4">¶</a></p>
<p id="section-5.2.3.1-5">The length includes the type octet but not this length.  Its format is
similar to the "new" format packet header lengths, but cannot have
Partial Body Lengths.  That is:<a href="#section-5.2.3.1-5">¶</a></p>
<div id="section-5.2.3.1-6">
<pre>   if the 1st octet &lt;  192, then
       lengthOfLength = 1
       subpacketLen = 1st_octet

   if the 1st octet &gt;= 192 and &lt; 255, then
       lengthOfLength = 2
       subpacketLen = ((1st_octet - 192) &lt;&lt; 8) + (2nd_octet) + 192

   if the 1st octet = 255, then
       lengthOfLength = 5
       subpacket length = [four-octet scalar starting at 2nd_octet]
</pre><p><a href="#section-5.2.3.1-6">¶</a>
</p></div>
<p id="section-5.2.3.1-7">The value of the subpacket type octet may be:<a href="#section-5.2.3.1-7">¶</a></p>
<table id="table-3">
              <caption><a href="#table-3">Table 3</a></caption>
<thead>
                <tr>
                  <th rowspan="1" colspan="1">Type</th>
                  <th rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">Signature Creation Time</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">Signature Expiration Time</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">4</td>
                  <td rowspan="1" colspan="1">Exportable Certification</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">5</td>
                  <td rowspan="1" colspan="1">Trust Signature</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">6</td>
                  <td rowspan="1" colspan="1">Regular Expression</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">7</td>
                  <td rowspan="1" colspan="1">Revocable</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">8</td>
                  <td rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">9</td>
                  <td rowspan="1" colspan="1">Key Expiration Time</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">10</td>
                  <td rowspan="1" colspan="1">Placeholder for backward compatibility</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">11</td>
                  <td rowspan="1" colspan="1">Preferred Symmetric Algorithms</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">12</td>
                  <td rowspan="1" colspan="1">Revocation Key</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">13 to 15</td>
                  <td rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">16</td>
                  <td rowspan="1" colspan="1">Issuer</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">17 to 19</td>
                  <td rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">20</td>
                  <td rowspan="1" colspan="1">Notation Data</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">21</td>
                  <td rowspan="1" colspan="1">Preferred Hash Algorithms</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">22</td>
                  <td rowspan="1" colspan="1">Preferred Compression Algorithms</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">23</td>
                  <td rowspan="1" colspan="1">Key Server Preferences</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">24</td>
                  <td rowspan="1" colspan="1">Preferred Key Server</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">25</td>
                  <td rowspan="1" colspan="1">Primary User ID</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">26</td>
                  <td rowspan="1" colspan="1">Policy URI</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">27</td>
                  <td rowspan="1" colspan="1">Key Flags</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">28</td>
                  <td rowspan="1" colspan="1">Signer's User ID</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">29</td>
                  <td rowspan="1" colspan="1">Reason for Revocation</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">30</td>
                  <td rowspan="1" colspan="1">Features</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">31</td>
                  <td rowspan="1" colspan="1">Signature Target</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">32</td>
                  <td rowspan="1" colspan="1">Embedded Signature</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">33</td>
                  <td rowspan="1" colspan="1">Issuer Fingerprint</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">34</td>
                  <td rowspan="1" colspan="1">Preferred AEAD Algorithms</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">35</td>
                  <td rowspan="1" colspan="1">Intended Recipient Fingerprint</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">37</td>
                  <td rowspan="1" colspan="1">Attested Certifications</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">100 to 110</td>
                  <td rowspan="1" colspan="1">Private or experimental</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.1-9">An implementation SHOULD ignore any subpacket of a type that it does
not recognize.<a href="#section-5.2.3.1-9">¶</a></p>
<p id="section-5.2.3.1-10">Bit 7 of the subpacket type is the "critical" bit.  If set, it denotes
that the subpacket is one that is critical for the evaluator of the
signature to recognize.  If a subpacket is encountered that is marked
critical but is unknown to the evaluating software, the evaluator
SHOULD consider the signature to be in error.<a href="#section-5.2.3.1-10">¶</a></p>
<p id="section-5.2.3.1-11">An evaluator may "recognize" a subpacket, but not implement it.  The
purpose of the critical bit is to allow the signer to tell an
evaluator that it would prefer a new, unknown feature to generate an
error than be ignored.<a href="#section-5.2.3.1-11">¶</a></p>
<p id="section-5.2.3.1-12">Implementations SHOULD implement the four preferred algorithm
subpackets (11, 21, 22, and 34), as well as the "Reason for Revocation"
subpacket.  Note, however, that if an implementation chooses not to
implement some of the preferences, it is required to behave in a
polite manner to respect the wishes of those users who do implement
these preferences.<a href="#section-5.2.3.1-12">¶</a></p>
</section>
</div>
<div id="signature-subpacket-types">
<section id="section-5.2.3.2">
            <h5 id="name-signature-subpacket-types">
<a href="#section-5.2.3.2">5.2.3.2. </a><a href="#name-signature-subpacket-types">Signature Subpacket Types</a>
            </h5>
<p id="section-5.2.3.2-1">A number of subpackets are currently defined.  Some subpackets apply to
the signature itself and some are attributes of the key.  Subpackets
that are found on a self-signature are placed on a certification made
by the key itself.  Note that a key may have more than one User ID, and
thus may have more than one self-signature, and differing subpackets.<a href="#section-5.2.3.2-1">¶</a></p>
<p id="section-5.2.3.2-2">A subpacket may be found either in the hashed or unhashed subpacket
sections of a signature.  If a subpacket is not hashed, then the
information in it cannot be considered definitive because it is not
part of the signature proper.<a href="#section-5.2.3.2-2">¶</a></p>
</section>
</div>
<div id="notes-on-self-signatures">
<section id="section-5.2.3.3">
            <h5 id="name-notes-on-self-signatures">
<a href="#section-5.2.3.3">5.2.3.3. </a><a href="#name-notes-on-self-signatures">Notes on Self-Signatures</a>
            </h5>
<p id="section-5.2.3.3-1">A self-signature is a binding signature made by the key to which the
signature refers.  There are three types of self-signatures, the
certification signatures (types 0x10-0x13), the direct-key signature
(type 0x1F), and the subkey binding signature (type 0x18).  For
certification self-signatures, each User ID may have a self-
signature, and thus different subpackets in those self-signatures.  For
subkey binding signatures, each subkey in fact has a self-signature.
Subpackets that appear in a certification self-signature apply to the
user name, and subpackets that appear in the subkey self-signature
apply to the subkey.  Lastly, subpackets on the direct-key signature
apply to the entire key.<a href="#section-5.2.3.3-1">¶</a></p>
<p id="section-5.2.3.3-2">Implementing software should interpret a self-signature's preference
subpackets as narrowly as possible.  For example, suppose a key has two
user names, Alice and Bob.  Suppose that Alice prefers the symmetric
algorithm AES-256, and Bob prefers Camellia-256 or AES-128.  If the software
locates this key via Alice's name, then the preferred algorithm is
AES-256; if software locates the key via Bob's name, then the preferred
algorithm is Camellia-256.  If the key is located by Key ID, the algorithm of
the primary User ID of the key provides the preferred symmetric
algorithm.<a href="#section-5.2.3.3-2">¶</a></p>
<p id="section-5.2.3.3-3">Revoking a self-signature or allowing it to expire has a semantic
meaning that varies with the signature type.  Revoking the self-
signature on a User ID effectively retires that user name.  The
self-signature is a statement, "My name X is tied to my signing key K"
and is corroborated by other users' certifications.  If another user
revokes their certification, they are effectively saying that they no
longer believe that name and that key are tied together.  Similarly, if
the users themselves revoke their self-signature, then the users no
longer go by that name, no longer have that email address,
etc.  Revoking a binding signature effectively retires that
subkey.  Revoking a direct-key signature cancels that signature.  Please
see the "Reason for Revocation" subpacket (<a href="#reason-for-revocation">Section 5.2.3.24</a>)
for more relevant detail.<a href="#section-5.2.3.3-3">¶</a></p>
<p id="section-5.2.3.3-4">Since a self-signature contains important information about the key's
use, an implementation SHOULD allow the user to rewrite the
self-signature, and important information in it, such as preferences
and key expiration.<a href="#section-5.2.3.3-4">¶</a></p>
<p id="section-5.2.3.3-5">It is good practice to verify that a self-signature imported into an
implementation doesn't advertise features that the implementation
doesn't support, rewriting the signature as appropriate.<a href="#section-5.2.3.3-5">¶</a></p>
<p id="section-5.2.3.3-6">An implementation that encounters multiple self-signatures on the same
object may resolve the ambiguity in any way it sees fit, but it is
RECOMMENDED that priority be given to the most recent self-signature.<a href="#section-5.2.3.3-6">¶</a></p>
</section>
</div>

<div id="issuer">
<section id="section-5.2.3.5">
            <h5 id="name-issuer">
<a href="#section-5.2.3.5">5.2.3.5. </a><a href="#name-issuer">Issuer</a>
            </h5>
<p id="section-5.2.3.5-1">(8-octet Key ID)<a href="#section-5.2.3.5-1">¶</a></p>
<p id="section-5.2.3.5-2">The OpenPGP Key ID of the key issuing the signature.  If the version
of that key is greater than 4, this subpacket MUST NOT be included in
the signature.<a href="#section-5.2.3.5-2">¶</a></p>
</section>
</div>
<div id="key-expiration-time">
<section id="section-5.2.3.6">
            <h5 id="name-key-expiration-time">
<a href="#section-5.2.3.6">5.2.3.6. </a><a href="#name-key-expiration-time">Key Expiration Time</a>
            </h5>
<p id="section-5.2.3.6-1">(4-octet time field)<a href="#section-5.2.3.6-1">¶</a></p>
<p id="section-5.2.3.6-2">The validity period of the key.  This is the number of seconds after
the key creation time that the key expires.  If this is not present or
has a value of zero, the key never expires.  This is found only on a
self-signature.<a href="#section-5.2.3.6-2">¶</a></p>
</section>
</div>
<div id="preferred-symmetric-algorithms">
<section id="section-5.2.3.7">
            <h5 id="name-preferred-symmetric-algorit">
<a href="#section-5.2.3.7">5.2.3.7. </a><a href="#name-preferred-symmetric-algorit">Preferred Symmetric Algorithms</a>
            </h5>
<p id="section-5.2.3.7-1">(array of one-octet values)<a href="#section-5.2.3.7-1">¶</a></p>
<p id="section-5.2.3.7-2">Symmetric algorithm numbers that indicate which algorithms the key
holder prefers to use.  The subpacket body is an ordered list of octets
with the most preferred listed first.  It is assumed that only
algorithms listed are supported by the recipient's software.  Algorithm
numbers are in <a href="#constants">Section 9</a>.  This is only found on a self-signature.<a href="#section-5.2.3.7-2">¶</a></p>
</section>
</div>
<div id="preferred-aead-algorithms">
<section id="section-5.2.3.8">
            <h5 id="name-preferred-aead-algorithms">
<a href="#section-5.2.3.8">5.2.3.8. </a><a href="#name-preferred-aead-algorithms">Preferred AEAD Algorithms</a>
            </h5>
<p id="section-5.2.3.8-1">(array of one-octet values)<a href="#section-5.2.3.8-1">¶</a></p>
<p id="section-5.2.3.8-2">AEAD algorithm numbers that indicate which AEAD algorithms the key
holder prefers to use.  The subpacket body is an ordered list of
octets with the most preferred listed first.  It is assumed that only
algorithms listed are supported by the recipient's software.
Algorithm numbers are in <a href="#aead-algorithms">Section 9.6</a>.  This is only
found on a self-signature.  Note that support for the AEAD Encrypted
Data packet in the general is indicated by a Feature Flag.<a href="#section-5.2.3.8-2">¶</a></p>
</section>
</div>
<div id="preferred-hash-algorithms">
<section id="section-5.2.3.9">
            <h5 id="name-preferred-hash-algorithms">
<a href="#section-5.2.3.9">5.2.3.9. </a><a href="#name-preferred-hash-algorithms">Preferred Hash Algorithms</a>
            </h5>
<p id="section-5.2.3.9-1">(array of one-octet values)<a href="#section-5.2.3.9-1">¶</a></p>
<p id="section-5.2.3.9-2">Message digest algorithm numbers that indicate which algorithms the
key holder prefers to receive.  Like the preferred symmetric
algorithms, the list is ordered.  Algorithm numbers are in
<a href="#hash-algorithms">Section 9.5</a>.  This is only found on a self-signature.<a href="#section-5.2.3.9-2">¶</a></p>
</section>
</div>
<div id="preferred-compression-algorithms">
<section id="section-5.2.3.10">
            <h5 id="name-preferred-compression-algor">
<a href="#section-5.2.3.10">5.2.3.10. </a><a href="#name-preferred-compression-algor">Preferred Compression Algorithms</a>
            </h5>
<p id="section-5.2.3.10-1">(array of one-octet values)<a href="#section-5.2.3.10-1">¶</a></p>
<p id="section-5.2.3.10-2">Compression algorithm numbers that indicate which algorithms the key
holder prefers to use.  Like the preferred symmetric algorithms, the
list is ordered.  Algorithm numbers are in
<a href="#compression-algorithms">Section 9.4</a>.  If this subpacket is not included, ZIP
is preferred.  A zero denotes that uncompressed data is preferred; the
key holder's software might have no compression software in that
implementation.  This is only found on a self-signature.<a href="#section-5.2.3.10-2">¶</a></p>
</section>
</div>
<div id="signature-expiration-time">
<section id="section-5.2.3.11">
            <h5 id="name-signature-expiration-time">
<a href="#section-5.2.3.11">5.2.3.11. </a><a href="#name-signature-expiration-time">Signature Expiration Time</a>
            </h5>
<p id="section-5.2.3.11-1">(4-octet time field)<a href="#section-5.2.3.11-1">¶</a></p>
<p id="section-5.2.3.11-2">The validity period of the signature.  This is the number of seconds
after the signature creation time that the signature expires.  If this
is not present or has a value of zero, it never expires.<a href="#section-5.2.3.11-2">¶</a></p>
</section>
</div>
<div id="exportable-certification">
<section id="section-5.2.3.12">
            <h5 id="name-exportable-certification">
<a href="#section-5.2.3.12">5.2.3.12. </a><a href="#name-exportable-certification">Exportable Certification</a>
            </h5>
<p id="section-5.2.3.12-1">(1 octet of exportability, 0 for not, 1 for exportable)<a href="#section-5.2.3.12-1">¶</a></p>
<p id="section-5.2.3.12-2">This subpacket denotes whether a certification signature is
"exportable", to be used by other users than the signature's
issuer.  The packet body contains a Boolean flag indicating whether the
signature is exportable.  If this packet is not present, the
certification is exportable; it is equivalent to a flag containing a
1.<a href="#section-5.2.3.12-2">¶</a></p>
<p id="section-5.2.3.12-3">Non-exportable, or "local", certifications are signatures made by a
user to mark a key as valid within that user's implementation only.<a href="#section-5.2.3.12-3">¶</a></p>
<p id="section-5.2.3.12-4">Thus, when an implementation prepares a user's copy of a key for
transport to another user (this is the process of "exporting" the
key), any local certification signatures are deleted from the key.<a href="#section-5.2.3.12-4">¶</a></p>
<p id="section-5.2.3.12-5">The receiver of a transported key "imports" it, and likewise trims any
local certifications.  In normal operation, there won't be any,
assuming the import is performed on an exported key.  However, there
are instances where this can reasonably happen.  For example, if an
implementation allows keys to be imported from a key database in
addition to an exported key, then this situation can arise.<a href="#section-5.2.3.12-5">¶</a></p>
<p id="section-5.2.3.12-6">Some implementations do not represent the interest of a single user
(for example, a key server).  Such implementations always trim local
certifications from any key they handle.<a href="#section-5.2.3.12-6">¶</a></p>
</section>
</div>
<div id="revocable">
<section id="section-5.2.3.13">
            <h5 id="name-revocable">
<a href="#section-5.2.3.13">5.2.3.13. </a><a href="#name-revocable">Revocable</a>
            </h5>
<p id="section-5.2.3.13-1">(1 octet of revocability, 0 for not, 1 for revocable)<a href="#section-5.2.3.13-1">¶</a></p>
<p id="section-5.2.3.13-2">Signature's revocability status.  The packet body contains a Boolean
flag indicating whether the signature is revocable.  Signatures that
are not revocable have any later revocation signatures ignored.  They
represent a commitment by the signer that he cannot revoke his
signature for the life of his key.  If this packet is not present, the
signature is revocable.<a href="#section-5.2.3.13-2">¶</a></p>
</section>
</div>
<div id="trust-signature">
<section id="section-5.2.3.14">
            <h5 id="name-trust-signature">
<a href="#section-5.2.3.14">5.2.3.14. </a><a href="#name-trust-signature">Trust Signature</a>
            </h5>
<p id="section-5.2.3.14-1">(1 octet "level" (depth), 1 octet of trust amount)<a href="#section-5.2.3.14-1">¶</a></p>
<p id="section-5.2.3.14-2">Signer asserts that the key is not only valid but also trustworthy at
the specified level.  Level 0 has the same meaning as an ordinary
validity signature.  Level 1 means that the signed key is asserted to
be a valid trusted introducer, with the 2nd octet of the body
specifying the degree of trust.  Level 2 means that the signed key is
asserted to be trusted to issue level 1 trust signatures, i.e., that
it is a "meta introducer".  Generally, a level n trust signature
asserts that a key is trusted to issue level n-1 trust signatures.  The
trust amount is in a range from 0-255, interpreted such that values
less than 120 indicate partial trust and values of 120 or greater
indicate complete trust.  Implementations SHOULD emit values of 60 for
partial trust and 120 for complete trust.<a href="#section-5.2.3.14-2">¶</a></p>
</section>
</div>
<div id="regular-expression">
<section id="section-5.2.3.15">
            <h5 id="name-regular-expression">
<a href="#section-5.2.3.15">5.2.3.15. </a><a href="#name-regular-expression">Regular Expression</a>
            </h5>
<p id="section-5.2.3.15-1">(null-terminated regular expression)<a href="#section-5.2.3.15-1">¶</a></p>
<p id="section-5.2.3.15-2">Used in conjunction with trust Signature packets (of level &gt; 0) to
limit the scope of trust that is extended.  Only signatures by the
target key on User IDs that match the regular expression in the body
of this packet have trust extended by the trust Signature
subpacket.  The regular expression uses the same syntax as the Henry
Spencer's "almost public domain" regular expression <span>[<a href="#REGEX">REGEX</a>]</span> package. A
description of the syntax is found in <a href="#regular-expressions">Section 8</a> below.<a href="#section-5.2.3.15-2">¶</a></p>
</section>
</div>
<div id="revocation-key">
<section id="section-5.2.3.16">
            <h5 id="name-revocation-key">
<a href="#section-5.2.3.16">5.2.3.16. </a><a href="#name-revocation-key">Revocation Key</a>
            </h5>
<p id="section-5.2.3.16-1">(1 octet of class, 1 octet of public-key algorithm ID, 20 or 32 octets
of fingerprint)<a href="#section-5.2.3.16-1">¶</a></p>
<p id="section-5.2.3.16-2">V4 keys use the full 20 octet fingerprint; V5 keys use the
full 32 octet fingerprint<a href="#section-5.2.3.16-2">¶</a></p>
<p id="section-5.2.3.16-3">Authorizes the specified key to issue revocation signatures for this
key.  Class octet must have bit 0x80 set.  If the bit 0x40 is set,
then this means that the revocation information is sensitive.  Other
bits are for future expansion to other kinds of authorizations.  This
is only found on a direct-key self-signature (type 0x1f).  The use on
other types of self-signatures is unspecified.<a href="#section-5.2.3.16-3">¶</a></p>
<p id="section-5.2.3.16-4">If the "sensitive" flag is set, the keyholder feels this subpacket
contains private trust information that describes a real-world
sensitive relationship.  If this flag is set, implementations SHOULD
NOT export this signature to other users except in cases where the
data needs to be available: when the signature is being sent to the
designated revoker, or when it is accompanied by a revocation
signature from that revoker.  Note that it may be appropriate to
isolate this subpacket within a separate signature so that it is not
combined with other subpackets that need to be exported.<a href="#section-5.2.3.16-4">¶</a></p>
</section>
</div>
<div id="notation-data">
<section id="section-5.2.3.17">
            <h5 id="name-notation-data">
<a href="#section-5.2.3.17">5.2.3.17. </a><a href="#name-notation-data">Notation Data</a>
            </h5>
<div id="section-5.2.3.17-1">
<pre>   (4 octets of flags, 2 octets of name length (M),
                       2 octets of value length (N),
                       M octets of name data,
                       N octets of value data)
</pre><p><a href="#section-5.2.3.17-1">¶</a>
</p></div>
<p id="section-5.2.3.17-2">This subpacket describes a "notation" on the signature that the issuer
wishes to make.  The notation has a name and a value, each of which are
strings of octets.  There may be more than one notation in a signature.
Notations can be used for any extension the issuer of the signature
cares to make.  The "flags" field holds four octets of flags.<a href="#section-5.2.3.17-2">¶</a></p>
<p id="section-5.2.3.17-3">All undefined flags MUST be zero.  Defined flags are as follows:<a href="#section-5.2.3.17-3">¶</a></p>
<div id="section-5.2.3.17-4">
<pre>   First octet: 0x80 = human-readable.  This note value is text.
   Other octets: none.
</pre><p><a href="#section-5.2.3.17-4">¶</a>
</p></div>
<p id="section-5.2.3.17-5">Notation names are arbitrary strings encoded in UTF-8.  They reside in
two namespaces: The IETF namespace and the user namespace.<a href="#section-5.2.3.17-5">¶</a></p>
<p id="section-5.2.3.17-6">The IETF namespace is registered with IANA.  These names MUST NOT
contain the "@" character (0x40).  This is a tag for the user
namespace.<a href="#section-5.2.3.17-6">¶</a></p>
<p id="section-5.2.3.17-7">Names in the user namespace consist of a UTF-8 string tag followed by
"@" followed by a DNS domain name.  Note that the tag MUST NOT contain
an "@" character.  For example, the "sample" tag used by Example
Corporation could be "sample@example.com".<a href="#section-5.2.3.17-7">¶</a></p>
<p id="section-5.2.3.17-8">Names in a user space are owned and controlled by the owners of that
domain.  Obviously, it's bad form to create a new name in a DNS space
that you don't own.<a href="#section-5.2.3.17-8">¶</a></p>
<p id="section-5.2.3.17-9">Since the user namespace is in the form of an email address,
implementers MAY wish to arrange for that address to reach a person
who can be consulted about the use of the named tag.  Note that due to
UTF-8 encoding, not all valid user space name tags are valid email
addresses.<a href="#section-5.2.3.17-9">¶</a></p>
<p id="section-5.2.3.17-10">If there is a critical notation, the criticality applies to that
specific notation and not to notations in general.<a href="#section-5.2.3.17-10">¶</a></p>
<p id="section-5.2.3.17-11">The following subsections define a set of standard notations.<a href="#section-5.2.3.17-11">¶</a></p>
<div id="the-charset-notation">
<section id="section-5.2.3.17.1">
              <h6 id="name-the-charset-notation">
<a href="#section-5.2.3.17.1">5.2.3.17.1. </a><a href="#name-the-charset-notation">The 'charset' Notation</a>
              </h6>
<p id="section-5.2.3.17.1-1">The "charset" notation is a description of the character set used to
encode the signed plaintext.  The default value is "UTF-8".  If used,
the value MUST be encoded as human readable and MUST be present in the
hashed subpacket section of the signature.  This notation is useful
for cleartext signatures in cases where it is not possible to encode
the text in UTF-8.  By having the used character set a part of the
signed data, attacks exploiting different representation of code
points will be mitigated.<a href="#section-5.2.3.17.1-1">¶</a></p>
</section>
</div>
<div id="the-manu-notation">
<section id="section-5.2.3.17.2">
              <h6 id="name-the-manu-notation">
<a href="#section-5.2.3.17.2">5.2.3.17.2. </a><a href="#name-the-manu-notation">The 'manu' Notation</a>
              </h6>
<p id="section-5.2.3.17.2-1">The "manu" notation is a string that declares the device
manufacturer's name.  The certifier key is asserting this string
(which may or may not be related to the User ID of the certifier's
key).<a href="#section-5.2.3.17.2-1">¶</a></p>
</section>
</div>



<div id="the-pvers-notation">
<section id="section-5.2.3.17.6">
              <h6 id="name-the-pvers-notation">
<a href="#section-5.2.3.17.6">5.2.3.17.6. </a><a href="#name-the-pvers-notation">The 'pvers' Notation</a>
              </h6>
<p id="section-5.2.3.17.6-1">This notation defines the product version number (which could be a
release number, year, or some other identifier to differentiate
different versions of the same make/model).  It is a free form string.<a href="#section-5.2.3.17.6-1">¶</a></p>
</section>
</div>
<div id="the-lot-notation">
<section id="section-5.2.3.17.7">
              <h6 id="name-the-lot-notation">
<a href="#section-5.2.3.17.7">5.2.3.17.7. </a><a href="#name-the-lot-notation">The 'lot' Notation</a>
              </h6>
<p id="section-5.2.3.17.7-1">This notation defines the product lot number (which is an indicator of
the batch of product).  It is a free form string.<a href="#section-5.2.3.17.7-1">¶</a></p>
</section>
</div>
<div id="the-qty-notation">
<section id="section-5.2.3.17.8">
              <h6 id="name-the-qty-notation">
<a href="#section-5.2.3.17.8">5.2.3.17.8. </a><a href="#name-the-qty-notation">The 'qty' Notation</a>
              </h6>
<p id="section-5.2.3.17.8-1">This notation defines the quantity of items in this package.  It is a
decimal integer representation with no punctuation, e.g. "10", "1000",
"10000", etc.<a href="#section-5.2.3.17.8-1">¶</a></p>
</section>
</div>
<div id="the-loc-and-dest-notations">
<section id="section-5.2.3.17.9">
              <h6 id="name-the-loc-and-dest-notations">
<a href="#section-5.2.3.17.9">5.2.3.17.9. </a><a href="#name-the-loc-and-dest-notations">The 'loc' and 'dest' Notations</a>
              </h6>
<p id="section-5.2.3.17.9-1">The "loc" and 'dest' notations declare a GeoLocation as defined by RFC
5870 <span>[<a href="#RFC5870">RFC5870</a>]</span> but without the leading "geo:" header.  For example,
if you had a GeoLocation URI of "geo:13.4125,103.8667" you would
encode that in these notations as "13.4125,103.8667".<a href="#section-5.2.3.17.9-1">¶</a></p>
<p id="section-5.2.3.17.9-2">The 'loc' notation is meant to encode the geo location where the
signature was made.  The 'dest' notation is meant to encode the geo
location where the device is "destined" (i.e., a "destination" for the
device).<a href="#section-5.2.3.17.9-2">¶</a></p>
</section>
</div>
<div id="the-hash-notation">
<section id="section-5.2.3.17.10">
              <h6 id="name-the-hash-notation">
<a href="#section-5.2.3.17.10">5.2.3.17.10. </a><a href="#name-the-hash-notation">The 'hash' Notation</a>
              </h6>
<p id="section-5.2.3.17.10-1">A 'hash' notation is a means to include external data in the contents
of a signature without including the data itself.  This is done by
hashing the external data separately and then including the data's
name and hash in the signature via this notation.  This is useful, for
example, to have an external "manifest," "image," or other data that
might not be vital to the signature itself but still needs to be
protected and authenticated without requiring a second signature.<a href="#section-5.2.3.17.10-1">¶</a></p>
<p id="section-5.2.3.17.10-2">The 'hash' notation has the following structure:
* A single byte specifying the length of the name of the hashed data
* A UTF-8 string of the name of the hashed data
* A single byte specifying the hash algorithm (see section 9.4)
* The binary hash output of the hashed data using the specified
  algorithm.  (The length of this data is implicit based on the
  algorithm specified).<a href="#section-5.2.3.17.10-2">¶</a></p>
<p id="section-5.2.3.17.10-3">Due to its nature a 'hash' notation is not human readable and MUST NOT
be marked as such when used.<a href="#section-5.2.3.17.10-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-server-preferences">
<section id="section-5.2.3.18">
            <h5 id="name-key-server-preferences">
<a href="#section-5.2.3.18">5.2.3.18. </a><a href="#name-key-server-preferences">Key Server Preferences</a>
            </h5>
<p id="section-5.2.3.18-1">(N octets of flags)<a href="#section-5.2.3.18-1">¶</a></p>
<p id="section-5.2.3.18-2">This is a list of one-bit flags that indicate preferences that the key
holder has about how the key is handled on a key server.  All undefined
flags MUST be zero.<a href="#section-5.2.3.18-2">¶</a></p>
<p id="section-5.2.3.18-3">First octet: 0x80 = No-modify<a href="#section-5.2.3.18-3">¶</a></p>
<div id="section-5.2.3.18-4">
<pre>The key holder requests that this key only be modified or updated
by the key holder or an administrator of the key server.

If No-modify is set on the most recent self-sig over a user ID,
then a keyserver should only redistribute those third-party
certifications over that user ID that have been attested to in the
most recent Attestation Key Signature packet (see "Attested
Certifications" below).
</pre><p><a href="#section-5.2.3.18-4">¶</a>
</p></div>
<p id="section-5.2.3.18-5">This is found only on a self-signature.<a href="#section-5.2.3.18-5">¶</a></p>
</section>
</div>
<div id="preferred-key-server">
<section id="section-5.2.3.19">
            <h5 id="name-preferred-key-server">
<a href="#section-5.2.3.19">5.2.3.19. </a><a href="#name-preferred-key-server">Preferred Key Server</a>
            </h5>
<p id="section-5.2.3.19-1">(String)<a href="#section-5.2.3.19-1">¶</a></p>
<p id="section-5.2.3.19-2">This is a URI of a key server that the key holder prefers be used for
updates.  Note that keys with multiple User IDs can have a preferred
key server for each User ID.  Note also that since this is a URI, the
key server can actually be a copy of the key retrieved by ftp, http,
finger, etc.<a href="#section-5.2.3.19-2">¶</a></p>
</section>
</div>
<div id="primary-user-id">
<section id="section-5.2.3.20">
            <h5 id="name-primary-user-id">
<a href="#section-5.2.3.20">5.2.3.20. </a><a href="#name-primary-user-id">Primary User ID</a>
            </h5>
<p id="section-5.2.3.20-1">(1 octet, Boolean)<a href="#section-5.2.3.20-1">¶</a></p>
<p id="section-5.2.3.20-2">This is a flag in a User ID's self-signature that states whether this
User ID is the main User ID for this key.  It is reasonable for an
implementation to resolve ambiguities in preferences, etc. by
referring to the primary User ID.  If this flag is absent, its value is
zero.  If more than one User ID in a key is marked as primary, the
implementation may resolve the ambiguity in any way it sees fit, but
it is RECOMMENDED that priority be given to the User ID with the most
recent self-signature.<a href="#section-5.2.3.20-2">¶</a></p>
<p id="section-5.2.3.20-3">When appearing on a self-signature on a User ID packet, this subpacket
applies only to User ID packets.  When appearing on a self-signature on
a User Attribute packet, this subpacket applies only to User Attribute
packets.  That is to say, there are two different and independent
"primaries" -- one for User IDs, and one for User Attributes.<a href="#section-5.2.3.20-3">¶</a></p>
</section>
</div>
<div id="policy-uri">
<section id="section-5.2.3.21">
            <h5 id="name-policy-uri">
<a href="#section-5.2.3.21">5.2.3.21. </a><a href="#name-policy-uri">Policy URI</a>
            </h5>
<p id="section-5.2.3.21-1">(String)<a href="#section-5.2.3.21-1">¶</a></p>
<p id="section-5.2.3.21-2">This subpacket contains a URI of a document that describes the policy
under which the signature was issued.<a href="#section-5.2.3.21-2">¶</a></p>
</section>
</div>
<div id="key-flags">
<section id="section-5.2.3.22">
            <h5 id="name-key-flags">
<a href="#section-5.2.3.22">5.2.3.22. </a><a href="#name-key-flags">Key Flags</a>
            </h5>
<p id="section-5.2.3.22-1">(N octets of flags)<a href="#section-5.2.3.22-1">¶</a></p>
<p id="section-5.2.3.22-2">This subpacket contains a list of binary flags that hold information
about a key.  It is a string of octets, and an implementation MUST NOT
assume a fixed size.  This is so it can grow over time.  If a list is
shorter than an implementation expects, the unstated flags are
considered to be zero.  The defined flags are as follows:<a href="#section-5.2.3.22-2">¶</a></p>
<p id="section-5.2.3.22-3">First octet:<a href="#section-5.2.3.22-3">¶</a></p>
<div id="section-5.2.3.22-4">
<pre>0x01 - This key may be used to certify other keys.

0x02 - This key may be used to sign data.

0x04 - This key may be used to encrypt communications.

0x08 - This key may be used to encrypt storage.

0x10 - The private component of this key may have been split by a
       secret-sharing mechanism.

0x20 - This key may be used for authentication.

0x80 - The private component of this key may be in the possession
       of more than one person.
</pre><p><a href="#section-5.2.3.22-4">¶</a>
</p></div>
<p id="section-5.2.3.22-5">Second octet:<a href="#section-5.2.3.22-5">¶</a></p>
<div id="section-5.2.3.22-6">
<pre>0x04 - This key may be used as an additional decryption subkey (ADSK).

0x08 - This key may be used for timestamping.
</pre><p><a href="#section-5.2.3.22-6">¶</a>
</p></div>
<p id="section-5.2.3.22-7">Usage notes:<a href="#section-5.2.3.22-7">¶</a></p>
<p id="section-5.2.3.22-8">The flags in this packet may appear in self-signatures or in
certification signatures.  They mean different things depending on who
is making the statement -- for example, a certification signature that
has the "sign data" flag is stating that the certification is for that
use.  On the other hand, the "communications encryption" flag in a
self-signature is stating a preference that a given key be used for
communications.  Note however, that it is a thorny issue to determine
what is "communications" and what is "storage".  This decision is left
wholly up to the implementation; the authors of this document do not
claim any special wisdom on the issue and realize that accepted
opinion may change.<a href="#section-5.2.3.22-8">¶</a></p>
<p id="section-5.2.3.22-9">The "split key" (0x10) and "group key" (0x80) flags are placed on a
self-signature only; they are meaningless on a certification
signature.  They SHOULD be placed only on a direct-key signature (type
0x1F) or a subkey signature (type 0x18), one that refers to the key
the flag applies to.<a href="#section-5.2.3.22-9">¶</a></p>
<p id="section-5.2.3.22-10">The ADSK flag helps to figure out an encryption subkey.<a href="#section-5.2.3.22-10">¶</a></p>
</section>
</div>
<div id="signers-user-id">
<section id="section-5.2.3.23">
            <h5 id="name-signers-user-id">
<a href="#section-5.2.3.23">5.2.3.23. </a><a href="#name-signers-user-id">Signer's User ID</a>
            </h5>
<p id="section-5.2.3.23-1">(String)<a href="#section-5.2.3.23-1">¶</a></p>
<p id="section-5.2.3.23-2">This subpacket allows a keyholder to state which User ID is
responsible for the signing.  Many keyholders use a single key for
different purposes, such as business communications as well as
personal communications.  This subpacket allows such a keyholder to
state which of their roles is making a signature.<a href="#section-5.2.3.23-2">¶</a></p>
<p id="section-5.2.3.23-3">This subpacket is not appropriate to use to refer to a User Attribute
packet.<a href="#section-5.2.3.23-3">¶</a></p>
</section>
</div>
<div id="reason-for-revocation">
<section id="section-5.2.3.24">
            <h5 id="name-reason-for-revocation">
<a href="#section-5.2.3.24">5.2.3.24. </a><a href="#name-reason-for-revocation">Reason for Revocation</a>
            </h5>
<p id="section-5.2.3.24-1">(1 octet of revocation code, N octets of reason string)<a href="#section-5.2.3.24-1">¶</a></p>
<p id="section-5.2.3.24-2">This subpacket is used only in key revocation and certification
revocation signatures.  It describes the reason why the key or
certificate was revoked.<a href="#section-5.2.3.24-2">¶</a></p>
<p id="section-5.2.3.24-3">The first octet contains a machine-readable code that denotes the
reason for the revocation:<a href="#section-5.2.3.24-3">¶</a></p>
<table id="table-4">
              <caption><a href="#table-4">Table 4</a></caption>
<thead>
                <tr>
                  <th rowspan="1" colspan="1">Code</th>
                  <th rowspan="1" colspan="1">Reason</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">0</td>
                  <td rowspan="1" colspan="1">No reason specified (key revocations or cert revocations)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">Key is superseded (key revocations)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">Key material has been compromised (key revocations)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">Key is retired and no longer used (key revocations)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">32</td>
                  <td rowspan="1" colspan="1">User ID information is no longer valid (cert revocations)</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">100-110</td>
                  <td rowspan="1" colspan="1">Private Use</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.24-5">Following the revocation code is a string of octets that gives
information about the Reason for Revocation in human-readable form
(UTF-8).  The string may be null, that is, of zero length.  The length
of the subpacket is the length of the reason string plus one.  An
implementation SHOULD implement this subpacket, include it in all
revocation signatures, and interpret revocations appropriately.  There
are important semantic differences between the reasons, and there are
thus important reasons for revoking signatures.<a href="#section-5.2.3.24-5">¶</a></p>
<p id="section-5.2.3.24-6">If a key has been revoked because of a compromise, all signatures
created by that key are suspect.  However, if it was merely superseded
or retired, old signatures are still valid.  If the revoked signature
is the self-signature for certifying a User ID, a revocation denotes
that that user name is no longer in use.  Such a revocation SHOULD
include a 0x20 code.<a href="#section-5.2.3.24-6">¶</a></p>
<p id="section-5.2.3.24-7">Note that any signature may be revoked, including a certification on
some other person's key.  There are many good reasons for revoking a
certification signature, such as the case where the keyholder leaves
the employ of a business with an email address. A revoked
certification is no longer a part of validity calculations.<a href="#section-5.2.3.24-7">¶</a></p>
</section>
</div>
<div id="features">
<section id="section-5.2.3.25">
            <h5 id="name-features">
<a href="#section-5.2.3.25">5.2.3.25. </a><a href="#name-features">Features</a>
            </h5>
<p id="section-5.2.3.25-1">(N octets of flags)<a href="#section-5.2.3.25-1">¶</a></p>
<p id="section-5.2.3.25-2">The Features subpacket denotes which advanced OpenPGP features a
user's implementation supports.  This is so that as features are added
to OpenPGP that cannot be backwards-compatible, a user can state that
they can use that feature.  The flags are single bits that indicate
that a given feature is supported.<a href="#section-5.2.3.25-2">¶</a></p>
<p id="section-5.2.3.25-3">This subpacket is similar to a preferences subpacket, and only appears
in a self-signature.<a href="#section-5.2.3.25-3">¶</a></p>
<p id="section-5.2.3.25-4">An implementation SHOULD NOT use a feature listed when sending to a
user who does not state that they can use it.<a href="#section-5.2.3.25-4">¶</a></p>
<p id="section-5.2.3.25-5">Defined features are as follows:<a href="#section-5.2.3.25-5">¶</a></p>
<p id="section-5.2.3.25-6">First octet:<a href="#section-5.2.3.25-6">¶</a></p>
<div id="section-5.2.3.25-7">
<pre>0x01 - Modification Detection (packets 18 and 19)

0x02 - AEAD Encrypted Data Packet (packet 20) and version 5
       Symmetric-Key Encrypted Session Key Packets (packet 3)

0x04 - Version 5 Public-Key Packet format and corresponding new
       fingerprint format
</pre><p><a href="#section-5.2.3.25-7">¶</a>
</p></div>
<p id="section-5.2.3.25-8">If an implementation implements any of the defined features, it SHOULD
implement the Features subpacket, too.<a href="#section-5.2.3.25-8">¶</a></p>
<p id="section-5.2.3.25-9">An implementation may freely infer features from other suitable
implementation-dependent mechanisms.<a href="#section-5.2.3.25-9">¶</a></p>
</section>
</div>
<div id="signature-target">
<section id="section-5.2.3.26">
            <h5 id="name-signature-target">
<a href="#section-5.2.3.26">5.2.3.26. </a><a href="#name-signature-target">Signature Target</a>
            </h5>
<p id="section-5.2.3.26-1">(1 octet public-key algorithm, 1 octet hash algorithm, N octets hash)<a href="#section-5.2.3.26-1">¶</a></p>
<p id="section-5.2.3.26-2">This subpacket identifies a specific target signature to which a
signature refers.  For revocation signatures, this subpacket provides
explicit designation of which signature is being revoked.  For a
third-party or timestamp signature, this designates what signature is
signed.  All arguments are an identifier of that target signature.<a href="#section-5.2.3.26-2">¶</a></p>
<p id="section-5.2.3.26-3">The N octets of hash data MUST be the size of the hash of the
signature.  For example, a target signature with a SHA-1 hash MUST
have 20 octets of hash data.<a href="#section-5.2.3.26-3">¶</a></p>
</section>
</div>
<div id="embedded-signature">
<section id="section-5.2.3.27">
            <h5 id="name-embedded-signature">
<a href="#section-5.2.3.27">5.2.3.27. </a><a href="#name-embedded-signature">Embedded Signature</a>
            </h5>
<p id="section-5.2.3.27-1">(1 signature packet body)<a href="#section-5.2.3.27-1">¶</a></p>
<p id="section-5.2.3.27-2">This subpacket contains a complete Signature packet body as specified
in <a href="#signature-packet-tag-2">Section 5.2</a> above.  It is useful when one signature
needs to refer to, or be incorporated in, another signature.<a href="#section-5.2.3.27-2">¶</a></p>
</section>
</div>
<div id="issuer-fingerprint">
<section id="section-5.2.3.28">
            <h5 id="name-issuer-fingerprint">
<a href="#section-5.2.3.28">5.2.3.28. </a><a href="#name-issuer-fingerprint">Issuer Fingerprint</a>
            </h5>
<p id="section-5.2.3.28-1">(1 octet key version number, N octets of fingerprint)<a href="#section-5.2.3.28-1">¶</a></p>
<p id="section-5.2.3.28-2">The OpenPGP Key fingerprint of the key issuing the signature.  This
subpacket SHOULD be included in all signatures.  If the version of the
issuing key is 4 and an Issuer subpacket is also included in the
signature, the key ID of the Issuer subpacket MUST match the low
64 bits of the fingerprint.<a href="#section-5.2.3.28-2">¶</a></p>
<p id="section-5.2.3.28-3">Note that the length N of the fingerprint for a version 4 key is 20
octets; for a version 5 key N is 32.<a href="#section-5.2.3.28-3">¶</a></p>
</section>
</div>
<div id="intended-recipient-fingerprint">
<section id="section-5.2.3.29">
            <h5 id="name-intended-recipient-fingerpr">
<a href="#section-5.2.3.29">5.2.3.29. </a><a href="#name-intended-recipient-fingerpr">Intended Recipient Fingerprint</a>
            </h5>
<p id="section-5.2.3.29-1">(1 octet key version number, N octets of fingerprint)<a href="#section-5.2.3.29-1">¶</a></p>
<p id="section-5.2.3.29-2">The OpenPGP Key fingerprint of the intended recipient primary key.  If
one or more subpackets of this type are included in a signature, it
SHOULD be considered valid only in an encrypted context, where the key
it was encrypted to is one of the indicated primary keys, or one of
their subkeys.  This can be used to prevent forwarding a signature
outside of its intended, encrypted context.<a href="#section-5.2.3.29-2">¶</a></p>
<p id="section-5.2.3.29-3">Note that the length N of the fingerprint for a version 4 key is 20
octets; for a version 5 key N is 32.<a href="#section-5.2.3.29-3">¶</a></p>
</section>
</div>
<div id="attested-certifications">
<section id="section-5.2.3.30">
            <h5 id="name-attested-certifications">
<a href="#section-5.2.3.30">5.2.3.30. </a><a href="#name-attested-certifications">Attested Certifications</a>
            </h5>
<p id="section-5.2.3.30-1">(N octets of certification digests)<a href="#section-5.2.3.30-1">¶</a></p>
<p id="section-5.2.3.30-2">This subpacket MUST only appear as a hashed subpacket of an
Attestation Key Signature.  It has no meaning in any other signature
type.  It is used by the primary key to attest to a set of third-party
certifications over the associated User ID or User Attribute.  This
enables the holder of an OpenPGP primary key to mark specific
third-party certifications as re-distributable with the rest of the
Transferable Public Key (see the "No-modify" flag in "Key Server
Preferences", above).  Implementations MUST include exactly one
Attested Certification subpacket in any generated Attestation Key
Signature.<a href="#section-5.2.3.30-2">¶</a></p>
<p id="section-5.2.3.30-3">The contents of the subpacket consists of a series of digests using
the same hash algorithm used by the signature itself.  Each digest is
made over one third-party signature (any Certification, i.e.,
signature type 0x10-0x13) that covers the same Primary Key and User ID
(or User Attribute).  For example, an Attestation Key Signature made
by key X over user ID U using hash algorithm SHA256 might contain an
Attested Certifications subpacket of 192 octets (6*32 octets) covering
six third-party certification Signatures over &lt;X,U&gt;.  They SHOULD be
ordered by binary hash value from low to high (e.g., a hash with
hexadecimal value 037a... precedes a hash with value 0392..., etc).
The length of this subpacket MUST be an integer multiple of the length
of the hash algorithm used for the enclosing Attestation Key
Signature.<a href="#section-5.2.3.30-3">¶</a></p>
<p id="section-5.2.3.30-4">The listed digests MUST be calculated over the third-party
certification's Signature packet as described in the "Computing
Signatures" section, but without a trailer: the hash data starts with
the octet 0x88, followed by the four-octet length of the Signature,
and then the body of the Signature packet. (Note that this is an
old-style packet header for a Signature packet with the
length-of-length field set to zero.)  The unhashed subpacket data of
the Signature packet being hashed is not included in the hash, and the
unhashed subpacket data length value is set to zero.<a href="#section-5.2.3.30-4">¶</a></p>
<p id="section-5.2.3.30-5">If an implementation encounters more than one such subpacket in an
Attestation Key Signature, it MUST treat it as a single Attested
Certifications subpacket containing the union of all hashes.<a href="#section-5.2.3.30-5">¶</a></p>
<p id="section-5.2.3.30-6">The Attested Certifications subpacket in the most recent Attestation
Key Signature over a given user ID supersedes all Attested
Certifications subpackets from any previous Attestation Key Signature.
However, note that if more than one Attestation Key Signatures has the
same (most recent) Signature Creation Time subpacket, implementations
MUST consider the union of the attestations of all Attestation Key
Signatures (this allows the keyholder to attest to more third-party
certifications than could fit in a single Attestation Key Signature).<a href="#section-5.2.3.30-6">¶</a></p>
<p id="section-5.2.3.30-7">If a keyholder Alice has already attested to third-party
certifications from Bob and Carol and she wants to add an attestation
to a certification from David, she should issue a new Attestation Key
Signature (with a more recent Signature Creation timestamp) that
contains an Attested Certifications subpacket covering all three
third-party certifications.<a href="#section-5.2.3.30-7">¶</a></p>
<p id="section-5.2.3.30-8">If she later decides that she does not want Carol's certification to
be redistributed with her certificate, she can issue a new Attestation
Key Signature (again, with a more recent Signature Creation timestamp)
that contains an Attested Certifications subpacket covering only the
certifications from Bob and David.<a href="#section-5.2.3.30-8">¶</a></p>
<p id="section-5.2.3.30-9">Note that Certification Revocation Signatures are not relevant for
Attestation Key Signatures.  To rescind all attestations, the primary
key holder needs only to publish a more recent Attestation Key
Signature with an empty Attested Certifications subpacket.<a href="#section-5.2.3.30-9">¶</a></p>
</section>
</div>
</section>
</div>
<div id="computing-signatures">
<section id="section-5.2.4">
          <h4 id="name-computing-signatures">
<a href="#section-5.2.4">5.2.4. </a><a href="#name-computing-signatures">Computing Signatures</a>
          </h4>
<p id="section-5.2.4-1">All signatures are formed by producing a hash over the signature data,
and then using the resulting hash in the signature algorithm.<a href="#section-5.2.4-1">¶</a></p>
<p id="section-5.2.4-2">For binary document signatures (type 0x00), the document data is
hashed directly.  For text document signatures (type 0x01), the
document is canonicalized by converting line endings to &lt;CR&gt;&lt;LF&gt;, and
the resulting data is hashed.<a href="#section-5.2.4-2">¶</a></p>
<p id="section-5.2.4-3">When a V4 signature is made over a key, the hash data starts with the
octet 0x99, followed by a two-octet length of the key, and then body
of the key packet; when a V5 signature is made over a key, the hash
data starts with the octet 0x9a, followed by a four-octet length of
the key, and then body of the key packet.  A subkey binding signature
(type 0x18) or primary key binding signature (type 0x19) then hashes
the subkey using the same format as the main key (also using 0x99 or
0x9a as the first octet).  Primary key revocation signatures (type
0x20) hash only the key being revoked.  Subkey revocation signature
(type 0x28) hash first the primary key and then the subkey being
revoked.<a href="#section-5.2.4-3">¶</a></p>
<p id="section-5.2.4-4">A certification signature (type 0x10 through 0x13) hashes the User ID
being bound to the key into the hash context after the above data. A
V3 certification hashes the contents of the User ID or attribute
packet packet, without any header. A V4 or V5 certification hashes the
constant 0xB4 for User ID certifications or the constant 0xD1 for User
Attribute certifications, followed by a four-octet number giving the
length of the User ID or User Attribute data, and then the User ID or
User Attribute data.<a href="#section-5.2.4-4">¶</a></p>
<p id="section-5.2.4-5">An Attestation Key Signature (0x16) hashes the same data boy that a
standard certification signature does: primary key, followed by User
ID or User Attribute.<a href="#section-5.2.4-5">¶</a></p>
<p id="section-5.2.4-6">When a signature is made over a Signature packet (type 0x50,
"Third-Party Confirmation signature"), the hash data starts with the
octet 0x88, followed by the four-octet length of the signature, and
then the body of the Signature packet. (Note that this is an old-style
packet header for a Signature packet with the length-of-length field
set to zero.) The unhashed subpacket data of the Signature packet
being hashed is not included in the hash, and the unhashed subpacket
data length value is set to zero.<a href="#section-5.2.4-6">¶</a></p>
<p id="section-5.2.4-7">Once the data body is hashed, then a trailer is hashed.  This trailer
depends on the version of the signature.<a href="#section-5.2.4-7">¶</a></p>
<ul>
<li id="section-5.2.4-8.1">A V3 signature hashes five octets of the packet body, starting from
the signature type field.  This data is the signature type,
followed by the four-octet signature time.<a href="#section-5.2.4-8.1">¶</a>
</li>
<li id="section-5.2.4-8.2">
              <p id="section-5.2.4-8.2.1">A V4 signature hashes the packet body starting from its first
field, the version number, through the end of the hashed subpacket
data and a final extra trailer.  Thus, the hashed fields are:<a href="#section-5.2.4-8.2.1">¶</a></p>
<ul>
<li id="section-5.2.4-8.2.2.1">the signature version (0x04),<a href="#section-5.2.4-8.2.2.1">¶</a>
</li>
<li id="section-5.2.4-8.2.2.2">the signature type,<a href="#section-5.2.4-8.2.2.2">¶</a>
</li>
<li id="section-5.2.4-8.2.2.3">the public-key algorithm,<a href="#section-5.2.4-8.2.2.3">¶</a>
</li>
<li id="section-5.2.4-8.2.2.4">the hash algorithm,<a href="#section-5.2.4-8.2.2.4">¶</a>
</li>
<li id="section-5.2.4-8.2.2.5">the hashed subpacket length,<a href="#section-5.2.4-8.2.2.5">¶</a>
</li>
<li id="section-5.2.4-8.2.2.6">the hashed subpacket body,<a href="#section-5.2.4-8.2.2.6">¶</a>
</li>
<li id="section-5.2.4-8.2.2.7">the two octets 0x04 and 0xFF,<a href="#section-5.2.4-8.2.2.7">¶</a>
</li>
<li id="section-5.2.4-8.2.2.8">
                  <p id="section-5.2.4-8.2.2.8.1">a four-octet big-endian number that is the length
of the hashed data from the Signature packet
stopping right before the 0x04, 0xff octets.<a href="#section-5.2.4-8.2.2.8.1">¶</a></p>
<p id="section-5.2.4-8.2.2.8.2">
The four-octet big-endian number is considered to be an unsigned
integer modulo 2^32.<a href="#section-5.2.4-8.2.2.8.2">¶</a></p>
</li>
</ul>
</li>
<li id="section-5.2.4-8.3">
              <p id="section-5.2.4-8.3.1">A V5 signature hashes the packet body starting from its first
field, the version number, through the end of the hashed subpacket
data and a final extra trailer.  Thus, the hashed fields are:<a href="#section-5.2.4-8.3.1">¶</a></p>
<ul>
<li id="section-5.2.4-8.3.2.1">the signature version (0x05),<a href="#section-5.2.4-8.3.2.1">¶</a>
</li>
<li id="section-5.2.4-8.3.2.2">the signature type,<a href="#section-5.2.4-8.3.2.2">¶</a>
</li>
<li id="section-5.2.4-8.3.2.3">the public-key algorithm,<a href="#section-5.2.4-8.3.2.3">¶</a>
</li>
<li id="section-5.2.4-8.3.2.4">the hash algorithm,<a href="#section-5.2.4-8.3.2.4">¶</a>
</li>
<li id="section-5.2.4-8.3.2.5">the hashed subpacket length,<a href="#section-5.2.4-8.3.2.5">¶</a>
</li>
<li id="section-5.2.4-8.3.2.6">the hashed subpacket body,<a href="#section-5.2.4-8.3.2.6">¶</a>
</li>
<li id="section-5.2.4-8.3.2.7">
                  <p id="section-5.2.4-8.3.2.7.1">Only for document signatures (type 0x00 or 0x01) the following
three data items are hashed here:<a href="#section-5.2.4-8.3.2.7.1">¶</a></p>
<ul>
<li id="section-5.2.4-8.3.2.7.2.1">the one-octet content format,<a href="#section-5.2.4-8.3.2.7.2.1">¶</a>
</li>
<li id="section-5.2.4-8.3.2.7.2.2">the file name as a string (one octet length, followed by
the file name),<a href="#section-5.2.4-8.3.2.7.2.2">¶</a>
</li>
<li id="section-5.2.4-8.3.2.7.2.3">a four-octet number that indicates a date,<a href="#section-5.2.4-8.3.2.7.2.3">¶</a>
</li>
</ul>
</li>
<li id="section-5.2.4-8.3.2.8">the two octets 0x05 and 0xFF,<a href="#section-5.2.4-8.3.2.8">¶</a>
</li>
<li id="section-5.2.4-8.3.2.9">
                  <p id="section-5.2.4-8.3.2.9.1">a eight-octet big-endian number that is the length
of the hashed data from the Signature packet
stopping right before the 0x05, 0xff octets.<a href="#section-5.2.4-8.3.2.9.1">¶</a></p>
<p id="section-5.2.4-8.3.2.9.2">
The three data items hashed for document signatures need to
mirror the values of the Literal Data packet.  For detached
and cleartext signatures 6 zero bytes are hashed instead.<a href="#section-5.2.4-8.3.2.9.2">¶</a></p>
</li>
</ul>
</li>
</ul>
<p id="section-5.2.4-9">After all this has been hashed in a single hash context, the resulting
hash field is used in the signature algorithm and placed at the end of
the Signature packet.<a href="#section-5.2.4-9">¶</a></p>
<div id="subpacket-hints">
<section id="section-5.2.4.1">
            <h5 id="name-subpacket-hints">
<a href="#section-5.2.4.1">5.2.4.1. </a><a href="#name-subpacket-hints">Subpacket Hints</a>
            </h5>
<p id="section-5.2.4.1-1">It is certainly possible for a signature to contain conflicting
information in subpackets.  For example, a signature may contain
multiple copies of a preference or multiple expiration times.  In most
cases, an implementation SHOULD use the last subpacket in the
signature, but MAY use any conflict resolution scheme that makes more
sense.  Please note that we are intentionally leaving conflict
resolution to the implementer; most conflicts are simply syntax
errors, and the wishy-washy language here allows a receiver to be
generous in what they accept, while putting pressure on a creator to
be stingy in what they generate.<a href="#section-5.2.4.1-1">¶</a></p>
<p id="section-5.2.4.1-2">Some apparent conflicts may actually make sense -- for example,
suppose a keyholder has a V3 key and a V4 key that share the same RSA
key material.  Either of these keys can verify a signature created by
the other, and it may be reasonable for a signature to contain an
issuer subpacket for each key, as a way of explicitly tying those keys
to the signature.<a href="#section-5.2.4.1-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="symmetric-key-encrypted-session-key-packets-tag-3">
<section id="section-5.3">
        <h3 id="name-symmetric-key-encrypted-ses">
<a href="#section-5.3">5.3. </a><a href="#name-symmetric-key-encrypted-ses">Symmetric-Key Encrypted Session Key Packets (Tag 3)</a>
        </h3>
<p id="section-5.3-1">The Symmetric-Key Encrypted Session Key packet holds the symmetric-key
encryption of a session key used to encrypt a message.  Zero or more
Public-Key Encrypted Session Key packets and/or Symmetric-Key
Encrypted Session Key packets may precede a Symmetrically Encrypted
Data packet that holds an encrypted message.  The message is encrypted
with a session key, and the session key is itself encrypted and stored
in the Encrypted Session Key packet or the Symmetric-Key Encrypted
Session Key packet.<a href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">If the Symmetrically Encrypted Data packet is preceded by one or more
Symmetric-Key Encrypted Session Key packets, each specifies a
passphrase that may be used to decrypt the message.  This allows a
message to be encrypted to a number of public keys, and also to one or
more passphrases.  This packet type is new and is not generated by
PGP 2 or PGP version 5.0.<a href="#section-5.3-2">¶</a></p>
<p id="section-5.3-3">A version 4 Symmetric-Key Encrypted Session Key packet consists of:<a href="#section-5.3-3">¶</a></p>
<ul>
<li id="section-5.3-4.1">A one-octet version number with value 4.<a href="#section-5.3-4.1">¶</a>
</li>
<li id="section-5.3-4.2">A one-octet number describing the symmetric algorithm used.<a href="#section-5.3-4.2">¶</a>
</li>
<li id="section-5.3-4.3">A string-to-key (S2K) specifier, length as defined above.<a href="#section-5.3-4.3">¶</a>
</li>
<li id="section-5.3-4.4">Optionally, the encrypted session key itself, which is
decrypted with the string-to-key object.<a href="#section-5.3-4.4">¶</a>
</li>
</ul>
<p id="section-5.3-5">If the encrypted session key is not present (which can be detected on
the basis of packet length and S2K specifier size), then the S2K
algorithm applied to the passphrase produces the session key for
decrypting the message, using the symmetric cipher algorithm from the
Symmetric-Key Encrypted Session Key packet.<a href="#section-5.3-5">¶</a></p>
<p id="section-5.3-6">If the encrypted session key is present, the result of applying the
S2K algorithm to the passphrase is used to decrypt just that encrypted
session key field, using CFB mode with an IV of all zeros.  The
decryption result consists of a one-octet algorithm identifier that
specifies the symmetric-key encryption algorithm used to encrypt the
following Symmetrically Encrypted Data packet, followed by the session
key octets themselves.<a href="#section-5.3-6">¶</a></p>
<p id="section-5.3-7">Note: because an all-zero IV is used for this decryption, the S2K
specifier MUST use a salt value, either a Salted S2K or an
Iterated-Salted S2K.  The salt value will ensure that the decryption
key is not repeated even if the passphrase is reused.<a href="#section-5.3-7">¶</a></p>
<p id="section-5.3-8">A version 5 Symmetric-Key Encrypted Session Key packet consists of:<a href="#section-5.3-8">¶</a></p>
<ul>
<li id="section-5.3-9.1">A one-octet version number with value 5.<a href="#section-5.3-9.1">¶</a>
</li>
<li id="section-5.3-9.2">A one-octet cipher algorithm.<a href="#section-5.3-9.2">¶</a>
</li>
<li id="section-5.3-9.3">A one-octet AEAD algorithm.<a href="#section-5.3-9.3">¶</a>
</li>
<li id="section-5.3-9.4">A string-to-key (S2K) specifier, length as defined above.<a href="#section-5.3-9.4">¶</a>
</li>
<li id="section-5.3-9.5">A starting initialization vector of size specified by the AEAD
algorithm.<a href="#section-5.3-9.5">¶</a>
</li>
<li id="section-5.3-9.6">The encrypted session key itself, which is decrypted with the
string-to-key object using the given cipher and AEAD mode.<a href="#section-5.3-9.6">¶</a>
</li>
<li id="section-5.3-9.7">An authentication tag for the AEAD mode.<a href="#section-5.3-9.7">¶</a>
</li>
</ul>
<p id="section-5.3-10">The encrypted session key is encrypted using one of the AEAD
algorithms specified for the AEAD Encrypted Packet.  Note that no
chunks are used and that there is only one authentication tag.  The
Packet Tag in new format encoding (bits 7 and 6 set, bits 5-0 carry
the packet tag), the packet version number, the cipher algorithm
octet, and the AEAD algorithm octet are given as additional data.  For
example, the additional data used with EAX and AES-128 consists of the
octets 0xC3, 0x05, 0x07, and 0x01.<a href="#section-5.3-10">¶</a></p>
</section>
</div>
<div id="one-pass-signature-packets-tag-4">
<section id="section-5.4">
        <h3 id="name-one-pass-signature-packets-">
<a href="#section-5.4">5.4. </a><a href="#name-one-pass-signature-packets-">One-Pass Signature Packets (Tag 4)</a>
        </h3>
<p id="section-5.4-1">The One-Pass Signature packet precedes the signed data and contains
enough information to allow the receiver to begin calculating any
hashes needed to verify the signature.  It allows the Signature packet
to be placed at the end of the message, so that the signer can compute
the entire signed message in one pass.<a href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">A One-Pass Signature does not interoperate with PGP 2.6.x or earlier.<a href="#section-5.4-2">¶</a></p>
<p id="section-5.4-3">The body of this packet consists of:<a href="#section-5.4-3">¶</a></p>
<ul>
<li id="section-5.4-4.1">A one-octet version number.  The current version is 3.<a href="#section-5.4-4.1">¶</a>
</li>
<li id="section-5.4-4.2">A one-octet signature type.  Signature types are described in
<a href="#signature-types">Section 5.2.1</a>.<a href="#section-5.4-4.2">¶</a>
</li>
<li id="section-5.4-4.3">A one-octet number describing the hash algorithm used.<a href="#section-5.4-4.3">¶</a>
</li>
<li id="section-5.4-4.4">A one-octet number describing the public-key algorithm used.<a href="#section-5.4-4.4">¶</a>
</li>
<li id="section-5.4-4.5">An eight-octet number holding the Key ID of the signing key.<a href="#section-5.4-4.5">¶</a>
</li>
<li id="section-5.4-4.6">A one-octet number holding a flag showing whether the signature
is nested.  A zero value indicates that the next packet is
another One-Pass Signature packet that describes another
signature to be applied to the same message data.<a href="#section-5.4-4.6">¶</a>
</li>
</ul>
<p id="section-5.4-5">Note that if a message contains more than one one-pass signature, then
the Signature packets bracket the message; that is, the first
Signature packet after the message corresponds to the last one-pass
packet and the final Signature packet corresponds to the first
one-pass packet.<a href="#section-5.4-5">¶</a></p>
</section>
</div>
<div id="key-material-packet">
<section id="section-5.5">
        <h3 id="name-key-material-packet">
<a href="#section-5.5">5.5. </a><a href="#name-key-material-packet">Key Material Packet</a>
        </h3>
<p id="section-5.5-1">A key material packet contains all the information about a public or
private key.  There are four variants of this packet type, and two
major versions.  Consequently, this section is complex.<a href="#section-5.5-1">¶</a></p>
<div id="key-packet-variants">
<section id="section-5.5.1">
          <h4 id="name-key-packet-variants">
<a href="#section-5.5.1">5.5.1. </a><a href="#name-key-packet-variants">Key Packet Variants</a>
          </h4>

<div id="public-subkey-packet-tag-14">
<section id="section-5.5.1.2">
            <h5 id="name-public-subkey-packet-tag-14">
<a href="#section-5.5.1.2">5.5.1.2. </a><a href="#name-public-subkey-packet-tag-14">Public-Subkey Packet (Tag 14)</a>
            </h5>
<p id="section-5.5.1.2-1">A Public-Subkey packet (tag 14) has exactly the same format as a
Public-Key packet, but denotes a subkey.  One or more subkeys may be
associated with a top-level key.  By convention, the top-level key
provides signature services, and the subkeys provide encryption
services.<a href="#section-5.5.1.2-1">¶</a></p>
<p id="section-5.5.1.2-2">Note: in PGP version 2.6, tag 14 was intended to indicate a comment packet.
This tag was selected for reuse because no previous version of PGP
ever emitted comment packets but they did properly ignore
them.  Public-Subkey packets are ignored by PGP version 2.6 and do not cause
it to fail, providing a limited degree of backward compatibility.<a href="#section-5.5.1.2-2">¶</a></p>
</section>
</div>
<div id="secret-key-packet-tag-5">
<section id="section-5.5.1.3">
            <h5 id="name-secret-key-packet-tag-5">
<a href="#section-5.5.1.3">5.5.1.3. </a><a href="#name-secret-key-packet-tag-5">Secret-Key Packet (Tag 5)</a>
            </h5>
<p id="section-5.5.1.3-1">A Secret-Key packet contains all the information that is found in a
Public-Key packet, including the public-key material, but also
includes the secret-key material after all the public-key fields.<a href="#section-5.5.1.3-1">¶</a></p>
</section>
</div>

</section>
</div>
<div id="public-key-packet-formats">
<section id="section-5.5.2">
          <h4 id="name-public-key-packet-formats">
<a href="#section-5.5.2">5.5.2. </a><a href="#name-public-key-packet-formats">Public-Key Packet Formats</a>
          </h4>
<p id="section-5.5.2-1">There are three versions of key-material packets.  Version 3 packets were
first generated by PGP version 2.6.  Version 4 keys first appeared in PGP 5
and are the preferred key version for OpenPGP.<a href="#section-5.5.2-1">¶</a></p>
<p id="section-5.5.2-2">OpenPGP implementations MUST create keys with version 4 format. V3
keys are deprecated; an implementation MUST NOT generate a V3 key, but
MAY accept it.<a href="#section-5.5.2-2">¶</a></p>
<p id="section-5.5.2-3">A version 3 public key or public-subkey packet contains:<a href="#section-5.5.2-3">¶</a></p>
<ul>
<li id="section-5.5.2-4.1">A one-octet version number (3).<a href="#section-5.5.2-4.1">¶</a>
</li>
<li id="section-5.5.2-4.2">A four-octet number denoting the time that the key was created.<a href="#section-5.5.2-4.2">¶</a>
</li>
<li id="section-5.5.2-4.3">A two-octet number denoting the time in days that this key is
valid.  If this number is zero, then it does not expire.<a href="#section-5.5.2-4.3">¶</a>
</li>
<li id="section-5.5.2-4.4">A one-octet number denoting the public-key algorithm of this
key.<a href="#section-5.5.2-4.4">¶</a>
</li>
<li id="section-5.5.2-4.5">
              <p id="section-5.5.2-4.5.1">A series of multiprecision integers comprising the key
material:<a href="#section-5.5.2-4.5.1">¶</a></p>
<ul>
<li id="section-5.5.2-4.5.2.1">a multiprecision integer (MPI) of RSA public modulus n;<a href="#section-5.5.2-4.5.2.1">¶</a>
</li>
<li id="section-5.5.2-4.5.2.2">an MPI of RSA public encryption exponent e.<a href="#section-5.5.2-4.5.2.2">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.5.2-5">V3 keys are deprecated.  They contain three weaknesses.  First, it is
relatively easy to construct a V3 key that has the same Key ID as any
other key because the Key ID is simply the low 64 bits of the public
modulus.  Secondly, because the fingerprint of a V3 key hashes the key
material, but not its length, there is an increased opportunity for
fingerprint collisions.  Third, there are weaknesses in the MD5 hash
algorithm that make developers prefer other algorithms.  See below for
a fuller discussion of Key IDs and fingerprints.<a href="#section-5.5.2-5">¶</a></p>
<p id="section-5.5.2-6">V2 keys are identical to the deprecated V3 keys except for the version
number.  An implementation MUST NOT generate them and MAY accept or
reject them as it sees fit.<a href="#section-5.5.2-6">¶</a></p>
<p id="section-5.5.2-7">The version 4 format is similar to the version 3 format except for the
absence of a validity period.  This has been moved to the Signature
packet.  In addition, fingerprints of version 4 keys are calculated
differently from version 3 keys, as described in the section "Enhanced
Key Formats".<a href="#section-5.5.2-7">¶</a></p>
<p id="section-5.5.2-8">A version 4 packet contains:<a href="#section-5.5.2-8">¶</a></p>
<ul>
<li id="section-5.5.2-9.1">A one-octet version number (4).<a href="#section-5.5.2-9.1">¶</a>
</li>
<li id="section-5.5.2-9.2">A four-octet number denoting the time that the key was created.<a href="#section-5.5.2-9.2">¶</a>
</li>
<li id="section-5.5.2-9.3">A one-octet number denoting the public-key algorithm of this
key.<a href="#section-5.5.2-9.3">¶</a>
</li>
<li id="section-5.5.2-9.4">A series of values comprising the key material.  This is
algorithm-specific and described in <a href="#algorithm-specific-parts-of-keys">Section 5.6</a>.<a href="#section-5.5.2-9.4">¶</a>
</li>
</ul>
<p id="section-5.5.2-10">The version 5 format is similar to the version 4 format except for the
addition of a count for the key material.  This count helps parsing
secret key packets (which are an extension of the public key packet
format) in the case of an unknown algoritm.  In addition, fingerprints
of version 5 keys are calculated differently from version 4 keys, as
described in the section "Enhanced Key Formats".<a href="#section-5.5.2-10">¶</a></p>
<p id="section-5.5.2-11">A version 5 packet contains:<a href="#section-5.5.2-11">¶</a></p>
<ul>
<li id="section-5.5.2-12.1">A one-octet version number (5).<a href="#section-5.5.2-12.1">¶</a>
</li>
<li id="section-5.5.2-12.2">A four-octet number denoting the time that the key was created.<a href="#section-5.5.2-12.2">¶</a>
</li>
<li id="section-5.5.2-12.3">A one-octet number denoting the public-key algorithm of this
key.<a href="#section-5.5.2-12.3">¶</a>
</li>
<li id="section-5.5.2-12.4">A four-octet scalar octet count for the following public key material.<a href="#section-5.5.2-12.4">¶</a>
</li>
<li id="section-5.5.2-12.5">A series of values comprising the public key material.  This is
algorithm-specific and described in <a href="#algorithm-specific-parts-of-keys">Section 5.6</a>.<a href="#section-5.5.2-12.5">¶</a>
</li>
</ul>
</section>
</div>
<div id="secret-key-packet-formats">
<section id="section-5.5.3">
          <h4 id="name-secret-key-packet-formats">
<a href="#section-5.5.3">5.5.3. </a><a href="#name-secret-key-packet-formats">Secret-Key Packet Formats</a>
          </h4>
<p id="section-5.5.3-1">The Secret-Key and Secret-Subkey packets contain all the data of the
Public-Key and Public-Subkey packets, with additional algorithm-
specific secret-key data appended, usually in encrypted form.<a href="#section-5.5.3-1">¶</a></p>
<p id="section-5.5.3-2">The packet contains:<a href="#section-5.5.3-2">¶</a></p>
<ul>
<li id="section-5.5.3-3.1">A Public-Key or Public-Subkey packet, as described above.<a href="#section-5.5.3-3.1">¶</a>
</li>
<li id="section-5.5.3-3.2">One octet indicating string-to-key usage conventions.  Zero
indicates that the secret-key data is not encrypted.  255 or
254 indicates that a string-to-key specifier is being given.
Any other value is a symmetric-key encryption algorithm
identifier.  A version 5 packet MUST NOT use the value 255.<a href="#section-5.5.3-3.2">¶</a>
</li>
<li id="section-5.5.3-3.3">Only for a version 5 packet, a one-octet scalar octet count of the
next 4 optional fields.<a href="#section-5.5.3-3.3">¶</a>
</li>
<li id="section-5.5.3-3.4">[Optional] If string-to-key usage octet was 255, 254, or 253, a
one-octet symmetric encryption algorithm.<a href="#section-5.5.3-3.4">¶</a>
</li>
<li id="section-5.5.3-3.5">[Optional] If string-to-key usage octet was 253, a one-octet AEAD
algorithm.<a href="#section-5.5.3-3.5">¶</a>
</li>
<li id="section-5.5.3-3.6">[Optional] If string-to-key usage octet was 255, 254, or 253, a
string-to-key specifier.  The length of the string-to-key
specifier is implied by its type, as described above.<a href="#section-5.5.3-3.6">¶</a>
</li>
<li id="section-5.5.3-3.7">[Optional] If secret data is encrypted (string-to-key usage octet
not zero), an Initial Vector (IV) of the same length as the
cipher's block size.  If string-to-key usage octet was 253 the IV
is used as the nonce for the AEAD algorithm.  If the AEAD
algorithm requires a shorter nonce, the high-order bits of the IV
are used and the remaining bits MUST be zero.<a href="#section-5.5.3-3.7">¶</a>
</li>
<li id="section-5.5.3-3.8">Only for a version 5 packet, a four-octet scalar octet count for
the following secret key material.  This includes the encrypted
SHA-1 hash or AEAD tag if the string-to-key usage octet is 254 or
253.<a href="#section-5.5.3-3.8">¶</a>
</li>
<li id="section-5.5.3-3.9">Plain or encrypted series of values comprising the secret key
material.  This is algorithm-specific and described in section
<a href="#algorithm-specific-parts-of-keys">Section 5.6</a>.  Note that if the
string-to-key usage octet is 254, a 20-octet SHA-1 hash of the
plaintext of the algorithm-specific portion is appended to
plaintext and encrypted with it.  If the string-to-key usage octet
is 253, then an AEAD authentication tag is part of that data.<a href="#section-5.5.3-3.9">¶</a>
</li>
<li id="section-5.5.3-3.10">If the string-to-key usage octet is zero or 255, then a
two-octet checksum of the plaintext of the algorithm-specific
portion (sum of all octets, mod 65536).<a href="#section-5.5.3-3.10">¶</a>
</li>
</ul>
<p id="section-5.5.3-4">Note that the version 5 packet format adds two count values
to help parsing packets with unknown S2K or public key algorithms.<a href="#section-5.5.3-4">¶</a></p>
<p id="section-5.5.3-5">Secret MPI values can be encrypted using a passphrase.  If a string-
to-key specifier is given, that describes the algorithm for converting
the passphrase to a key, else a simple MD5 hash of the passphrase is
used.  Implementations MUST use a string-to-key specifier; the simple
hash is for backward compatibility and is deprecated, though
implementations MAY continue to use existing private keys in the old
format.  The cipher for encrypting the MPIs is specified in the
Secret-Key packet.<a href="#section-5.5.3-5">¶</a></p>
<p id="section-5.5.3-6">Encryption/decryption of the secret data is done in CFB mode using the
key created from the passphrase and the Initial Vector from the
packet.  A different mode is used with V3 keys (which are only RSA)
than with other key formats.  With V3 keys, the MPI bit count prefix
(i.e., the first two octets) is not encrypted.  Only the MPI non-
prefix data is encrypted.  Furthermore, the CFB state is resynchronized
at the beginning of each new MPI value, so that the CFB block boundary
is aligned with the start of the MPI data.<a href="#section-5.5.3-6">¶</a></p>
<p id="section-5.5.3-7">With V4 and V5 keys, a simpler method is used.  All secret MPI values
are encrypted, including the MPI bitcount prefix.<a href="#section-5.5.3-7">¶</a></p>
<p id="section-5.5.3-8">If the string-to-key usage octet is 253, the encrypted MPI values are
encrypted as one combined plaintext using one of the AEAD algorithms
specified for the AEAD Encrypted Packet.  Note that no chunks are used
and that there is only one authentication tag.  The Packet Tag in new
format encoding (bits 7 and 6 set, bits 5-0 carry the packet tag), the
packet version number, the cipher algorithm octet, and the AEAD
algorithm octet are given as additional data.  For example, the
additional data used with EAX and AES-128 in a Secret-Key Packet of
version 4 consists of the octets 0xC5, 0x04, 0x07, and 0x01; in a
Secret-Subkey Packet the first octet would be 0xC7.<a href="#section-5.5.3-8">¶</a></p>
<p id="section-5.5.3-9">The two-octet checksum that follows the algorithm-specific portion is
the algebraic sum, mod 65536, of the plaintext of all the algorithm-
specific octets (including MPI prefix and data).  With V3 keys, the
checksum is stored in the clear.  With V4 keys, the checksum is
encrypted like the algorithm-specific data.  This value is used to
check that the passphrase was correct.  However, this checksum is
deprecated; an implementation SHOULD NOT use it, but should rather use
the SHA-1 hash denoted with a usage octet of 254.  The reason for this
is that there are some attacks that involve undetectably modifying the
secret key.  If the string-to-key usage octet is 253 no checksum or
SHA-1 hash is used but the authentication tag of the AEAD algorithm
follows.<a href="#section-5.5.3-9">¶</a></p>
</section>
</div>
</section>
</div>
<div id="algorithm-specific-parts-of-keys">
<section id="section-5.6">
        <h3 id="name-algorithm-specific-parts-of">
<a href="#section-5.6">5.6. </a><a href="#name-algorithm-specific-parts-of">Algorithm-specific Parts of Keys</a>
        </h3>
<p id="section-5.6-1">The public and secret key format specifies algorithm-specific parts
of a key.  The following sections describe them in detail.<a href="#section-5.6-1">¶</a></p>
<div id="algorithm-specific-part-for-rsa-keys">
<section id="section-5.6.1">
          <h4 id="name-algorithm-specific-part-for">
<a href="#section-5.6.1">5.6.1. </a><a href="#name-algorithm-specific-part-for">Algorithm-Specific Part for RSA Keys</a>
          </h4>
<p id="section-5.6.1-1">The public key is this series of multiprecision integers:<a href="#section-5.6.1-1">¶</a></p>
<ul>
<li id="section-5.6.1-2.1">MPI of RSA public modulus n;<a href="#section-5.6.1-2.1">¶</a>
</li>
<li id="section-5.6.1-2.2">MPI of RSA public encryption exponent e.<a href="#section-5.6.1-2.2">¶</a>
</li>
</ul>
<p id="section-5.6.1-3">The secret key is this series of multiprecision integers:<a href="#section-5.6.1-3">¶</a></p>
<ul>
<li id="section-5.6.1-4.1">MPI of RSA secret exponent d;<a href="#section-5.6.1-4.1">¶</a>
</li>
<li id="section-5.6.1-4.2">MPI of RSA secret prime value p;<a href="#section-5.6.1-4.2">¶</a>
</li>
<li id="section-5.6.1-4.3">MPI of RSA secret prime value q (p &lt; q);<a href="#section-5.6.1-4.3">¶</a>
</li>
<li id="section-5.6.1-4.4">MPI of u, the multiplicative inverse of p, mod q.<a href="#section-5.6.1-4.4">¶</a>
</li>
</ul>
</section>
</div>
<div id="algorithm-specific-part-for-dsa-keys">
<section id="section-5.6.2">
          <h4 id="name-algorithm-specific-part-for-">
<a href="#section-5.6.2">5.6.2. </a><a href="#name-algorithm-specific-part-for-">Algorithm-Specific Part for DSA Keys</a>
          </h4>
<p id="section-5.6.2-1">The public key is this series of multiprecision integers:<a href="#section-5.6.2-1">¶</a></p>
<ul>
<li id="section-5.6.2-2.1">MPI of DSA prime p;<a href="#section-5.6.2-2.1">¶</a>
</li>
<li id="section-5.6.2-2.2">MPI of DSA group order q (q is a prime divisor of p-1);<a href="#section-5.6.2-2.2">¶</a>
</li>
<li id="section-5.6.2-2.3">MPI of DSA group generator g;<a href="#section-5.6.2-2.3">¶</a>
</li>
<li id="section-5.6.2-2.4">MPI of DSA public-key value y (= g**x mod p where x is secret).<a href="#section-5.6.2-2.4">¶</a>
</li>
</ul>
<p id="section-5.6.2-3">The secret key is this single multiprecision integer:<a href="#section-5.6.2-3">¶</a></p>
<ul>
<li id="section-5.6.2-4.1">MPI of DSA secret exponent x.<a href="#section-5.6.2-4.1">¶</a>
</li>
</ul>
</section>
</div>
<div id="algorithm-specific-part-for-elgamal-keys">
<section id="section-5.6.3">
          <h4 id="name-algorithm-specific-part-for-e">
<a href="#section-5.6.3">5.6.3. </a><a href="#name-algorithm-specific-part-for-e">Algorithm-Specific Part for Elgamal Keys</a>
          </h4>
<p id="section-5.6.3-1">The public key is this series of multiprecision integers:<a href="#section-5.6.3-1">¶</a></p>
<ul>
<li id="section-5.6.3-2.1">MPI of Elgamal prime p;<a href="#section-5.6.3-2.1">¶</a>
</li>
<li id="section-5.6.3-2.2">MPI of Elgamal group generator g;<a href="#section-5.6.3-2.2">¶</a>
</li>
<li id="section-5.6.3-2.3">MPI of Elgamal public key value y (= g**x mod p where x is secret).<a href="#section-5.6.3-2.3">¶</a>
</li>
</ul>
<p id="section-5.6.3-3">The secret key is this single multiprecision integer:<a href="#section-5.6.3-3">¶</a></p>
<ul>
<li id="section-5.6.3-4.1">MPI of Elgamal secret exponent x.<a href="#section-5.6.3-4.1">¶</a>
</li>
</ul>
</section>
</div>
<div id="algorithm-specific-part-for-ecdsa-keys">
<section id="section-5.6.4">
          <h4 id="name-algorithm-specific-part-for-ec">
<a href="#section-5.6.4">5.6.4. </a><a href="#name-algorithm-specific-part-for-ec">Algorithm-Specific Part for ECDSA Keys</a>
          </h4>
<p id="section-5.6.4-1">The public key is this series of values:<a href="#section-5.6.4-1">¶</a></p>
<ul>
<li id="section-5.6.4-2.1">
              <p id="section-5.6.4-2.1.1">a variable-length field containing a curve OID, formatted
as follows:<a href="#section-5.6.4-2.1.1">¶</a></p>
<ul>
<li id="section-5.6.4-2.1.2.1">a one-octet size of the following field; values 0 and
0xFF are reserved for future extensions,<a href="#section-5.6.4-2.1.2.1">¶</a>
</li>
<li id="section-5.6.4-2.1.2.2">the octets representing a curve OID, defined in
<a href="#ecc-curve-oid">Section 9.2</a>;<a href="#section-5.6.4-2.1.2.2">¶</a>
</li>
</ul>
</li>
<li id="section-5.6.4-2.2">a MPI of an EC point representing a public key.<a href="#section-5.6.4-2.2">¶</a>
</li>
</ul>
<p id="section-5.6.4-3">The secret key is this single multiprecision integer:<a href="#section-5.6.4-3">¶</a></p>
<ul>
<li id="section-5.6.4-4.1">MPI of an integer representing the secret key, which is a
scalar of the public EC point.<a href="#section-5.6.4-4.1">¶</a>
</li>
</ul>
</section>
</div>
<div id="algorithm-specific-part-for-eddsa-keys">
<section id="section-5.6.5">
          <h4 id="name-algorithm-specific-part-for-ed">
<a href="#section-5.6.5">5.6.5. </a><a href="#name-algorithm-specific-part-for-ed">Algorithm-Specific Part for EdDSA Keys</a>
          </h4>
<p id="section-5.6.5-1">The public key is this series of values:<a href="#section-5.6.5-1">¶</a></p>
<ul>
<li id="section-5.6.5-2.1">
              <p id="section-5.6.5-2.1.1">a variable-length field containing a curve OID, formatted
as follows:<a href="#section-5.6.5-2.1.1">¶</a></p>
<ul>
<li id="section-5.6.5-2.1.2.1">a one-octet size of the following field; values 0 and
0xFF are reserved for future extensions,<a href="#section-5.6.5-2.1.2.1">¶</a>
</li>
<li id="section-5.6.5-2.1.2.2">the octets representing a curve OID, defined in
<a href="#ecc-curve-oid">Section 9.2</a>;<a href="#section-5.6.5-2.1.2.2">¶</a>
</li>
</ul>
</li>
<li id="section-5.6.5-2.2">a MPI of an EC point representing a public key Q as described
under EdDSA Point Format below.<a href="#section-5.6.5-2.2">¶</a>
</li>
</ul>
<p id="section-5.6.5-3">The secret key is this single multiprecision integer:<a href="#section-5.6.5-3">¶</a></p>
<ul>
<li id="section-5.6.5-4.1">MPI of an integer representing the secret key, which is a
scalar of the public EC point.<a href="#section-5.6.5-4.1">¶</a>
</li>
</ul>
</section>
</div>
<div id="algorithm-specific-part-for-ecdh-keys">
<section id="section-5.6.6">
          <h4 id="name-algorithm-specific-part-for-ecd">
<a href="#section-5.6.6">5.6.6. </a><a href="#name-algorithm-specific-part-for-ecd">Algorithm-Specific Part for ECDH Keys</a>
          </h4>
<p id="section-5.6.6-1">The public key is this series of values:<a href="#section-5.6.6-1">¶</a></p>
<ul>
<li id="section-5.6.6-2.1">
              <p id="section-5.6.6-2.1.1">a variable-length field containing a curve OID, formatted
as follows:<a href="#section-5.6.6-2.1.1">¶</a></p>
<ul>
<li id="section-5.6.6-2.1.2.1">a one-octet size of the following field; values 0 and
0xFF are reserved for future extensions,<a href="#section-5.6.6-2.1.2.1">¶</a>
</li>
<li id="section-5.6.6-2.1.2.2">the octets representing a curve OID, defined in
<a href="#ecc-curve-oid">Section 9.2</a>;<a href="#section-5.6.6-2.1.2.2">¶</a>
</li>
</ul>
</li>
<li id="section-5.6.6-2.2">a MPI of an EC point representing a public key;<a href="#section-5.6.6-2.2">¶</a>
</li>
<li id="section-5.6.6-2.3">
              <p id="section-5.6.6-2.3.1">a variable-length field containing KDF parameters,
formatted as follows:<a href="#section-5.6.6-2.3.1">¶</a></p>
<ul>
<li id="section-5.6.6-2.3.2.1">a one-octet size of the following fields; values 0
and 0xff are reserved for future extensions;<a href="#section-5.6.6-2.3.2.1">¶</a>
</li>
<li id="section-5.6.6-2.3.2.2">a one-octet value 1, reserved for future extensions;<a href="#section-5.6.6-2.3.2.2">¶</a>
</li>
<li id="section-5.6.6-2.3.2.3">a one-octet hash function ID used with a KDF;<a href="#section-5.6.6-2.3.2.3">¶</a>
</li>
<li id="section-5.6.6-2.3.2.4">a one-octet algorithm ID for the symmetric algorithm
used to wrap the symmetric key used for the message
encryption; see <a href="#ec-dh-algorithm-ecdh">Section 13.5</a> for details.<a href="#section-5.6.6-2.3.2.4">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.6.6-3">Observe that an ECDH public key is composed of the same sequence of
fields that define an ECDSA key, plus the KDF parameters field.<a href="#section-5.6.6-3">¶</a></p>
<p id="section-5.6.6-4">The secret key is this single multiprecision integer:<a href="#section-5.6.6-4">¶</a></p>
<ul>
<li id="section-5.6.6-5.1">MPI of an integer representing the secret key, which is a
scalar of the public EC point.<a href="#section-5.6.6-5.1">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="compressed-data-packet-tag-8">
<section id="section-5.7">
        <h3 id="name-compressed-data-packet-tag-">
<a href="#section-5.7">5.7. </a><a href="#name-compressed-data-packet-tag-">Compressed Data Packet (Tag 8)</a>
        </h3>
<p id="section-5.7-1">The Compressed Data packet contains compressed data.  Typically, this
packet is found as the contents of an encrypted packet, or following a
Signature or One-Pass Signature packet, and contains a literal data
packet.<a href="#section-5.7-1">¶</a></p>
<p id="section-5.7-2">The body of this packet consists of:<a href="#section-5.7-2">¶</a></p>
<ul>
<li id="section-5.7-3.1">One octet that gives the algorithm used to compress the packet.<a href="#section-5.7-3.1">¶</a>
</li>
<li id="section-5.7-3.2">Compressed data, which makes up the remainder of the packet.<a href="#section-5.7-3.2">¶</a>
</li>
</ul>
<p id="section-5.7-4">A Compressed Data Packet's body contains an block that compresses some
set of packets.  See section "Packet Composition" for details on how
messages are formed.<a href="#section-5.7-4">¶</a></p>
<p id="section-5.7-5">ZIP-compressed packets are compressed with raw RFC 1951 <span>[<a href="#RFC1951">RFC1951</a>]</span>
DEFLATE blocks.  Note that PGP V2.6 uses 13 bits of compression.  If an
implementation uses more bits of compression, PGP V2.6 cannot
decompress it.<a href="#section-5.7-5">¶</a></p>
<p id="section-5.7-6">ZLIB-compressed packets are compressed with RFC 1950 <span>[<a href="#RFC1950">RFC1950</a>]</span>
ZLIB-style blocks.<a href="#section-5.7-6">¶</a></p>
<p id="section-5.7-7">BZip2-compressed packets are compressed using the BZip2 <span>[<a href="#BZ2">BZ2</a>]</span>
algorithm.<a href="#section-5.7-7">¶</a></p>
</section>
</div>
<div id="symmetrically-encrypted-data-packet-tag-9">
<section id="section-5.8">
        <h3 id="name-symmetrically-encrypted-dat">
<a href="#section-5.8">5.8. </a><a href="#name-symmetrically-encrypted-dat">Symmetrically Encrypted Data Packet (Tag 9)</a>
        </h3>
<p id="section-5.8-1">The Symmetrically Encrypted Data packet contains data encrypted with a
symmetric-key algorithm.  When it has been decrypted, it contains other
packets (usually a literal data packet or compressed data packet, but
in theory other Symmetrically Encrypted Data packets or sequences of
packets that form whole OpenPGP messages).<a href="#section-5.8-1">¶</a></p>
<p id="section-5.8-2">This packet is obsolete.  An implementation MUST NOT create this
packet.  An implementation MAY process such a packet but it MUST
return a clear diagnostic that a non-integrity protected packet has
been processed.  The implementation SHOULD also return an error in
this case and stop processing.<a href="#section-5.8-2">¶</a></p>
<p id="section-5.8-3">The body of this packet consists of:<a href="#section-5.8-3">¶</a></p>
<ul>
<li id="section-5.8-4.1">Encrypted data, the output of the selected symmetric-key cipher
operating in OpenPGP's variant of Cipher Feedback (CFB) mode.<a href="#section-5.8-4.1">¶</a>
</li>
</ul>
<p id="section-5.8-5">The symmetric cipher used may be specified in a Public-Key or
Symmetric-Key Encrypted Session Key packet that precedes the
Symmetrically Encrypted Data packet.  In that case, the cipher
algorithm octet is prefixed to the session key before it is
encrypted.  If no packets of these types precede the encrypted data,
the IDEA algorithm is used with the session key calculated as the MD5
hash of the passphrase, though this use is deprecated.<a href="#section-5.8-5">¶</a></p>
<p id="section-5.8-6">The data is encrypted in CFB mode, with a CFB shift size equal to the
cipher's block size.  The Initial Vector (IV) is specified as all
zeros.  Instead of using an IV, OpenPGP prefixes a string of length
equal to the block size of the cipher plus two to the data before it
is encrypted.  The first block-size octets (for example, 8 octets for
a 64-bit block length) are random, and the following two octets are
copies of the last two octets of the IV.  For example, in an 8-octet
block, octet 9 is a repeat of octet 7, and octet 10 is a repeat of
octet 8.  In a cipher of length 16, octet 17 is a repeat of octet 15
and octet 18 is a repeat of octet 16.  As a pedantic clarification, in
both these examples, we consider the first octet to be numbered 1.<a href="#section-5.8-6">¶</a></p>
<p id="section-5.8-7">After encrypting the first block-size-plus-two octets, the CFB state
is resynchronized.  The last block-size octets of ciphertext are passed
through the cipher and the block boundary is reset.<a href="#section-5.8-7">¶</a></p>
<p id="section-5.8-8">The repetition of 16 bits in the random data prefixed to the message
allows the receiver to immediately check whether the session key is
incorrect.  See the "Security Considerations" section for hints on the
proper use of this "quick check".<a href="#section-5.8-8">¶</a></p>
</section>
</div>
<div id="marker-packet-obsolete-literal-packet-tag-10">
<section id="section-5.9">
        <h3 id="name-marker-packet-obsolete-lite">
<a href="#section-5.9">5.9. </a><a href="#name-marker-packet-obsolete-lite">Marker Packet (Obsolete Literal Packet) (Tag 10)</a>
        </h3>
<p id="section-5.9-1">An experimental version of PGP used this packet as the Literal packet,
but no released version of PGP generated Literal packets with this
tag.  With PGP 5, this packet has been reassigned and is reserved
for use as the Marker packet.<a href="#section-5.9-1">¶</a></p>
<p id="section-5.9-2">The body of this packet consists of:<a href="#section-5.9-2">¶</a></p>
<ul>
<li id="section-5.9-3.1">The three octets 0x50, 0x47, 0x50 (which spell "PGP" in UTF-8).<a href="#section-5.9-3.1">¶</a>
</li>
</ul>
<p id="section-5.9-4">Such a packet MUST be ignored when received.  It may be placed at the
beginning of a message that uses features not available in PGP
version 2.6 in order to cause that version to report that newer software is
necessary to process the message.<a href="#section-5.9-4">¶</a></p>
</section>
</div>
<div id="literal-data-packet-tag-11">
<section id="section-5.10">
        <h3 id="name-literal-data-packet-tag-11">
<a href="#section-5.10">5.10. </a><a href="#name-literal-data-packet-tag-11">Literal Data Packet (Tag 11)</a>
        </h3>
<p id="section-5.10-1">A Literal Data packet contains the body of a message; data that is not
to be further interpreted.<a href="#section-5.10-1">¶</a></p>
<p id="section-5.10-2">The body of this packet consists of:<a href="#section-5.10-2">¶</a></p>
<ul>
<li id="section-5.10-3.1">
            <p id="section-5.10-3.1.1">A one-octet field that describes how the data is formatted.<a href="#section-5.10-3.1.1">¶</a></p>
<p id="section-5.10-3.1.2">
If it is a 'b' (0x62), then the Literal packet contains binary
data.  If it is a 't' (0x74), then it contains text data, and thus
may need line ends converted to local form, or other text-mode
changes.  The tag 'u' (0x75) means the same as 't', but also
indicates that implementation believes that the literal data
contains UTF-8 text.  If it is a 'm' (0x6d), then it contains a
MIME message body part <span>[<a href="#RFC2045">RFC2045</a>]</span>.<a href="#section-5.10-3.1.2">¶</a></p>
<p id="section-5.10-3.1.3">
Early versions of PGP also defined a value of 'l' as a 'local'
mode for machine-local conversions.  RFC 1991 <span>[<a href="#RFC1991">RFC1991</a>]</span>
incorrectly stated this local mode flag as '1' (ASCII numeral
one).  Both of these local modes are deprecated.<a href="#section-5.10-3.1.3">¶</a></p>
</li>
<li id="section-5.10-3.2">
            <p id="section-5.10-3.2.1">File name as a string (one-octet length, followed by a file name).
This may be a zero-length string.  Commonly, if the source of the
encrypted data is a file, this will be the name of the encrypted
file.  An implementation MAY consider the file name in the Literal
packet to be a more authoritative name than the actual file name.<a href="#section-5.10-3.2.1">¶</a></p>
<p id="section-5.10-3.2.2">
If the special name "_CONSOLE" is used, the message is considered
to be "for your eyes only".  This advises that the message data is
unusually sensitive, and the receiving program should process it
more carefully, perhaps avoiding storing the received data to
disk, for example.<a href="#section-5.10-3.2.2">¶</a></p>
</li>
<li id="section-5.10-3.3">A four-octet number that indicates a date associated with the
literal data.  Commonly, the date might be the modification
date of a file, or the time the packet was created, or a zero
that indicates no specific time.<a href="#section-5.10-3.3">¶</a>
</li>
<li id="section-5.10-3.4">
            <p id="section-5.10-3.4.1">The remainder of the packet is literal data.<a href="#section-5.10-3.4.1">¶</a></p>
<p id="section-5.10-3.4.2">
Text data is stored with &lt;CR&gt;&lt;LF&gt; text endings (i.e.,
network-normal line endings).  These should be converted to
native line endings by the receiving software.<a href="#section-5.10-3.4.2">¶</a></p>
</li>
</ul>
<p id="section-5.10-4">Note that V3 and V4 signatures do not include the formatting octet,
the file name, and the date field of the literal packet in a signature
hash and thus are not protected against tampering in a signed
document.  In contrast V5 signatures include them.<a href="#section-5.10-4">¶</a></p>
</section>
</div>
<div id="trust-packet-tag-12">
<section id="section-5.11">
        <h3 id="name-trust-packet-tag-12">
<a href="#section-5.11">5.11. </a><a href="#name-trust-packet-tag-12">Trust Packet (Tag 12)</a>
        </h3>
<p id="section-5.11-1">The Trust packet is used only within keyrings and is not normally
exported.  Trust packets contain data that record the user's
specifications of which key holders are trustworthy introducers, along
with other information that implementing software uses for trust
information.  The format of Trust packets is defined by a given
implementation.<a href="#section-5.11-1">¶</a></p>
<p id="section-5.11-2">Trust packets SHOULD NOT be emitted to output streams that are
transferred to other users, and they SHOULD be ignored on any input
other than local keyring files.<a href="#section-5.11-2">¶</a></p>
</section>
</div>
<div id="user-id-packet-tag-13">
<section id="section-5.12">
        <h3 id="name-user-id-packet-tag-13">
<a href="#section-5.12">5.12. </a><a href="#name-user-id-packet-tag-13">User ID Packet (Tag 13)</a>
        </h3>
<p id="section-5.12-1">A User ID packet consists of UTF-8 text that is intended to represent
the name and email address of the key holder.  By convention, it
includes an RFC 2822 <span>[<a href="#RFC2822">RFC2822</a>]</span> mail name-addr, but there are no
restrictions on its content.  The packet length in the header specifies
the length of the User ID.<a href="#section-5.12-1">¶</a></p>
</section>
</div>
<div id="user-attribute-packet-tag-17">
<section id="section-5.13">
        <h3 id="name-user-attribute-packet-tag-1">
<a href="#section-5.13">5.13. </a><a href="#name-user-attribute-packet-tag-1">User Attribute Packet (Tag 17)</a>
        </h3>
<p id="section-5.13-1">The User Attribute packet is a variation of the User ID packet.  It is
capable of storing more types of data than the User ID packet, which
is limited to text.  Like the User ID packet, a User Attribute packet
may be certified by the key owner ("self-signed") or any other key
owner who cares to certify it.  Except as noted, a User Attribute
packet may be used anywhere that a User ID packet may be used.<a href="#section-5.13-1">¶</a></p>
<p id="section-5.13-2">While User Attribute packets are not a required part of the OpenPGP
standard, implementations SHOULD provide at least enough compatibility
to properly handle a certification signature on the User Attribute
packet. A simple way to do this is by treating the User Attribute
packet as a User ID packet with opaque contents, but an implementation
may use any method desired.<a href="#section-5.13-2">¶</a></p>
<p id="section-5.13-3">The User Attribute packet is made up of one or more attribute
subpackets.  Each subpacket consists of a subpacket header and a body.
The header consists of:<a href="#section-5.13-3">¶</a></p>
<ul>
<li id="section-5.13-4.1">the subpacket length (1, 2, or 5 octets)<a href="#section-5.13-4.1">¶</a>
</li>
<li id="section-5.13-4.2">the subpacket type (1 octet)<a href="#section-5.13-4.2">¶</a>
</li>
</ul>
<p id="section-5.13-5">and is followed by the subpacket specific data.<a href="#section-5.13-5">¶</a></p>
<p id="section-5.13-6">The following table lists the currently known subpackets:<a href="#section-5.13-6">¶</a></p>
<table id="table-5">
          <caption><a href="#table-5">Table 5</a></caption>
<thead>
            <tr>
              <th rowspan="1" colspan="1">Type</th>
              <th rowspan="1" colspan="1">Attribute Subpacket</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">Image Attribute Subpacket</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">[TBD1]</td>
              <td rowspan="1" colspan="1">User ID Attribute Subpacket</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100-110</td>
              <td rowspan="1" colspan="1">Private/Experimental Use</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.13-8">An implementation SHOULD ignore any subpacket of a type that it
does not recognize.<a href="#section-5.13-8">¶</a></p>
<div id="the-image-attribute-subpacket">
<section id="section-5.13.1">
          <h4 id="name-the-image-attribute-subpack">
<a href="#section-5.13.1">5.13.1. </a><a href="#name-the-image-attribute-subpack">The Image Attribute Subpacket</a>
          </h4>
<p id="section-5.13.1-1">The Image Attribute subpacket is used to encode an image, presumably
(but not required to be) that of the key owner.<a href="#section-5.13.1-1">¶</a></p>
<p id="section-5.13.1-2">The Image Attribute subpacket begins with an image header.  The first
two octets of the image header contain the length of the image
header.  Note that unlike other multi-octet numerical values in this
document, due to a historical accident this value is encoded as a
little-endian number.  The image header length is followed by a single
octet for the image header version.  The only currently defined version
of the image header is 1, which is a 16-octet image header.  The first
three octets of a version 1 image header are thus 0x10, 0x00, 0x01.<a href="#section-5.13.1-2">¶</a></p>
<p id="section-5.13.1-3">The fourth octet of a version 1 image header designates the encoding
format of the image.  The only currently defined encoding format is the
value 1 to indicate JPEG.  Image format types 100 through 110 are
reserved for private or experimental use.  The rest of the version 1
image header is made up of 12 reserved octets, all of which MUST be
set to 0.<a href="#section-5.13.1-3">¶</a></p>
<p id="section-5.13.1-4">The rest of the image subpacket contains the image itself.  As the only
currently defined image type is JPEG, the image is encoded in the JPEG
File Interchange Format (JFIF), a standard file format for JPEG images
<span>[<a href="#JFIF">JFIF</a>]</span>.<a href="#section-5.13.1-4">¶</a></p>
<p id="section-5.13.1-5">An implementation MAY try to determine the type of an image by
examination of the image data if it is unable to handle a particular
version of the image header or if a specified encoding format value is
not recognized.<a href="#section-5.13.1-5">¶</a></p>
</section>
</div>
<div id="user-id-attribute-subpacket">
<section id="section-5.13.2">
          <h4 id="name-user-id-attribute-subpacket">
<a href="#section-5.13.2">5.13.2. </a><a href="#name-user-id-attribute-subpacket">User ID Attribute Subpacket</a>
          </h4>
<p id="section-5.13.2-1">A User ID Attribute subpacket has type [IANA -- assignment TBD1].<a href="#section-5.13.2-1">¶</a></p>
<p id="section-5.13.2-2">A User ID Attribute subpacket, just like a User ID packet, consists of
UTF-8 text that is intended to represent the name and email address of
the key holder.  By convention, it includes an RFC 2822 <span>[<a href="#RFC2822">RFC2822</a>]</span>
mail name-addr, but there are no restrictions on its content.  For
devices using OpenPGP for device certificates, it may just be the
device identifier.  The packet length in the header specifies the
length of the User ID.<a href="#section-5.13.2-2">¶</a></p>
<p id="section-5.13.2-3">Because User Attribute subpackets can be used anywhere a User ID
packet can be used, implementations MAY choose to trust a signed User
Attribute subpacket that includes a User ID Attribute subpacket.<a href="#section-5.13.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sym-encrypted-integrity-protected-data-packet-tag-18">
<section id="section-5.14">
        <h3 id="name-sym-encrypted-integrity-pro">
<a href="#section-5.14">5.14. </a><a href="#name-sym-encrypted-integrity-pro">Sym. Encrypted Integrity Protected Data Packet (Tag 18)</a>
        </h3>
<p id="section-5.14-1">The Symmetrically Encrypted Integrity Protected Data packet is a
variant of the Symmetrically Encrypted Data packet.  It is a new
feature created for OpenPGP that addresses the problem of detecting a
modification to encrypted data.  It is used in combination with a
Modification Detection Code packet.<a href="#section-5.14-1">¶</a></p>
<p id="section-5.14-2">There is a corresponding feature in the features Signature subpacket
that denotes that an implementation can properly use this packet type.
An implementation MUST support decrypting these packets and SHOULD
prefer generating them to the older Symmetrically Encrypted Data
packet when possible.  Since this data packet protects against
modification attacks, this standard encourages its
proliferation.  While blanket adoption of this data packet would create
interoperability problems, rapid adoption is nevertheless
important.  An implementation SHOULD specifically denote support for
this packet, but it MAY infer it from other mechanisms.<a href="#section-5.14-2">¶</a></p>
<p id="section-5.14-3">For example, an implementation might infer from the use of a cipher
such as Advanced Encryption Standard (AES) or Twofish that a user
supports this feature.  It might place in the unhashed portion of
another user's key signature a Features subpacket.  It might also
present a user with an opportunity to regenerate their own self-
signature with a Features subpacket.<a href="#section-5.14-3">¶</a></p>
<p id="section-5.14-4">This packet contains data encrypted with a symmetric-key algorithm and
protected against modification by the SHA-1 hash algorithm.  When it
has been decrypted, it will typically contain other packets (often a
Literal Data packet or Compressed Data packet).  The last decrypted
packet in this packet's payload MUST be a Modification Detection Code
packet.<a href="#section-5.14-4">¶</a></p>
<p id="section-5.14-5">The body of this packet consists of:<a href="#section-5.14-5">¶</a></p>
<ul>
<li id="section-5.14-6.1">A one-octet version number.  The only defined value is 1.  There
won't be any future versions of this packet because the MDC system
has been superseded by the AEAD Encrypted Data packet.<a href="#section-5.14-6.1">¶</a>
</li>
<li id="section-5.14-6.2">Encrypted data, the output of the selected symmetric-key cipher
operating in Cipher Feedback mode with shift amount equal to
the block size of the cipher (CFB-n where n is the block size).<a href="#section-5.14-6.2">¶</a>
</li>
</ul>
<p id="section-5.14-7">The symmetric cipher used MUST be specified in a Public-Key or
Symmetric-Key Encrypted Session Key packet that precedes the
Symmetrically Encrypted Data packet.  In either case, the cipher
algorithm octet is prefixed to the session key before it is encrypted.<a href="#section-5.14-7">¶</a></p>
<p id="section-5.14-8">The data is encrypted in CFB mode, with a CFB shift size equal to the
cipher's block size.  The Initial Vector (IV) is specified as all
zeros.  Instead of using an IV, OpenPGP prefixes an octet string to
the data before it is encrypted.  The length of the octet string equals
the block size of the cipher in octets, plus two.  The first octets in
the group, of length equal to the block size of the cipher, are
random; the last two octets are each copies of their 2nd preceding
octet.  For example, with a cipher whose block size is 128 bits or 16
octets, the prefix data will contain 16 random octets, then two more
octets, which are copies of the 15th and 16th octets,
respectively.  Unlike the Symmetrically Encrypted Data Packet, no
special CFB resynchronization is done after encrypting this prefix
data.  See "OpenPGP CFB Mode" below for more details.<a href="#section-5.14-8">¶</a></p>
<p id="section-5.14-9">The repetition of 16 bits in the random data prefixed to the message
allows the receiver to immediately check whether the session key is
incorrect.<a href="#section-5.14-9">¶</a></p>
<p id="section-5.14-10">The plaintext of the data to be encrypted is passed through the SHA-1
hash function, and the result of the hash is appended to the plaintext
in a Modification Detection Code packet.  The input to the hash
function includes the prefix data described above; it includes all of
the plaintext, and then also includes two octets of values 0xD3,
0x14.  These represent the encoding of a Modification Detection Code
packet tag and length field of 20 octets.<a href="#section-5.14-10">¶</a></p>
<p id="section-5.14-11">The resulting hash value is stored in a Modification Detection Code
(MDC) packet, which MUST use the two octet encoding just given to
represent its tag and length field.  The body of the MDC packet is the
20-octet output of the SHA-1 hash.<a href="#section-5.14-11">¶</a></p>
<p id="section-5.14-12">The Modification Detection Code packet is appended to the plaintext
and encrypted along with the plaintext using the same CFB context.<a href="#section-5.14-12">¶</a></p>
<p id="section-5.14-13">During decryption, the plaintext data should be hashed with SHA-1,
including the prefix data as well as the packet tag and length field
of the Modification Detection Code packet.  The body of the MDC packet,
upon decryption, is compared with the result of the SHA-1 hash.<a href="#section-5.14-13">¶</a></p>
<p id="section-5.14-14">Any failure of the MDC indicates that the message has been modified
and MUST be treated as a security problem.  Failures include a
difference in the hash values, but also the absence of an MDC packet,
or an MDC packet in any position other than the end of the
plaintext.  Any failure SHOULD be reported to the user.<a href="#section-5.14-14">¶</a></p>
<div id="section-5.14-15">
<pre>  NON-NORMATIVE EXPLANATION

  The MDC system, as packets 18 and 19 are called, were created to
  provide an integrity mechanism that is less strong than a
  signature, yet stronger than bare CFB encryption.

  It is a limitation of CFB encryption that damage to the
  ciphertext will corrupt the affected cipher blocks and the block
  following.  Additionally, if data is removed from the end of a
  CFB-encrypted block, that removal is undetectable.  (Note also
  that CBC mode has a similar limitation, but data removed from
  the front of the block is undetectable.)

  The obvious way to protect or authenticate an encrypted block is
  to digitally sign it.  However, many people do not wish to
  habitually sign data, for a large number of reasons beyond the
  scope of this document.  Suffice it to say that many people
  consider properties such as deniability to be as valuable as
  integrity.

  OpenPGP addresses this desire to have more security than raw
  encryption and yet preserve deniability with the MDC system.  An
  MDC is intentionally not a MAC.  Its name was not selected by
  accident.  It is analogous to a checksum.

  Despite the fact that it is a relatively modest system, it has
  proved itself in the real world.  It is an effective defense to
  several attacks that have surfaced since it has been created.
  It has met its modest goals admirably.

  Consequently, because it is a modest security system, it has
  modest requirements on the hash function(s) it employs.  It does
  not rely on a hash function being collision-free, it relies on a
  hash function being one-way.  If a forger, Frank, wishes to send
  Alice a (digitally) unsigned message that says, "I've always
  secretly loved you, signed Bob", it is far easier for him to
  construct a new message than it is to modify anything
  intercepted from Bob.  (Note also that if Bob wishes to
  communicate secretly with Alice, but without authentication or
  identification and with a threat model that includes forgers, he
  has a problem that transcends mere cryptography.)

  Note also that unlike nearly every other OpenPGP subsystem,
  there are no parameters in the MDC system.  It hard-defines
  SHA-1 as its hash function.  This is not an accident.  It is an
  intentional choice to avoid downgrade and cross-grade attacks
  while making a simple, fast system.  (A downgrade attack would
  be an attack that replaced SHA2-256 with SHA-1, for example.  A
  cross-grade attack would replace SHA-1 with another 160-bit
  hash, such as RIPE-MD/160, for example.)

  However, no update will be needed because the MDC will be
  replaced by the AEAD encryption described in this document.
</pre><p><a href="#section-5.14-15">¶</a>
</p></div>
</section>
</div>
<div id="modification-detection-code-packet-tag-19">
<section id="section-5.15">
        <h3 id="name-modification-detection-code">
<a href="#section-5.15">5.15. </a><a href="#name-modification-detection-code">Modification Detection Code Packet (Tag 19)</a>
        </h3>
<p id="section-5.15-1">The Modification Detection Code packet contains a SHA-1 hash of
plaintext data, which is used to detect message modification.  It is
only used with a Symmetrically Encrypted Integrity Protected Data
packet.  The Modification Detection Code packet MUST be the last packet
in the plaintext data that is encrypted in the Symmetrically Encrypted
Integrity Protected Data packet, and MUST appear in no other place.<a href="#section-5.15-1">¶</a></p>
<p id="section-5.15-2">A Modification Detection Code packet MUST have a length of 20 octets.<a href="#section-5.15-2">¶</a></p>
<p id="section-5.15-3">The body of this packet consists of:<a href="#section-5.15-3">¶</a></p>
<ul>
<li id="section-5.15-4.1">A 20-octet SHA-1 hash of the preceding plaintext data of the
Symmetrically Encrypted Integrity Protected Data packet,
including prefix data, the tag octet, and length octet of the
Modification Detection Code packet.<a href="#section-5.15-4.1">¶</a>
</li>
</ul>
<p id="section-5.15-5">Note that the Modification Detection Code packet MUST always use a new
format encoding of the packet tag, and a one-octet encoding of the
packet length.  The reason for this is that the hashing rules for
modification detection include a one-octet tag and one-octet length in
the data hash.  While this is a bit restrictive, it reduces complexity.<a href="#section-5.15-5">¶</a></p>
</section>
</div>
<div id="aead-encrypted-data-packet-tag-20">
<section id="section-5.16">
        <h3 id="name-aead-encrypted-data-packet-">
<a href="#section-5.16">5.16. </a><a href="#name-aead-encrypted-data-packet-">AEAD Encrypted Data Packet (Tag 20)</a>
        </h3>
<p id="section-5.16-1">This packet contains data encrypted with an authenticated encryption and
additional data (AEAD) construction.  When it has been decrypted, it
will typically contain other packets (often a Literal Data packet or
Compressed Data packet).<a href="#section-5.16-1">¶</a></p>
<p id="section-5.16-2">The body of this packet consists of:<a href="#section-5.16-2">¶</a></p>
<ul>
<li id="section-5.16-3.1">A one-octet version number.  The only currently defined value
is 1.<a href="#section-5.16-3.1">¶</a>
</li>
<li id="section-5.16-3.2">A one-octet cipher algorithm.<a href="#section-5.16-3.2">¶</a>
</li>
<li id="section-5.16-3.3">A one-octet AEAD algorithm.<a href="#section-5.16-3.3">¶</a>
</li>
<li id="section-5.16-3.4">A one-octet chunk size.<a href="#section-5.16-3.4">¶</a>
</li>
<li id="section-5.16-3.5">A starting initialization vector of size specified by the AEAD
algorithm.<a href="#section-5.16-3.5">¶</a>
</li>
<li id="section-5.16-3.6">Encrypted data, the output of the selected symmetric-key cipher
operating in the given AEAD mode.<a href="#section-5.16-3.6">¶</a>
</li>
<li id="section-5.16-3.7">A final, summary authentication tag for the AEAD mode.<a href="#section-5.16-3.7">¶</a>
</li>
</ul>
<p id="section-5.16-4">An AEAD encrypted data packet consists of one or more chunks of data.
The plaintext of each chunk is of a size specified using the chunk size
octet using the method specified below.<a href="#section-5.16-4">¶</a></p>
<p id="section-5.16-5">The encrypted data consists of the encryption of each chunk of
plaintext, followed immediately by the relevant authentication tag.  If
the last chunk of plaintext is smaller than the chunk size, the
ciphertext for that data may be shorter; it is nevertheless followed by
a full authentication tag.<a href="#section-5.16-5">¶</a></p>
<p id="section-5.16-6">For each chunk, the AEAD construction is given the Packet Tag in new
format encoding (bits 7 and 6 set, bits 5-0 carry the packet tag),
version number, cipher algorithm octet, AEAD algorithm octet, chunk
size octet, and an eight-octet, big-endian chunk index as additional
data.  The index of the first chunk is zero.  For example, the
additional data of the first chunk using EAX and AES-128 with a chunk
size of 64 kiByte consists of the octets 0xD4, 0x01, 0x07, 0x01, 0x10,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, and 0x00.<a href="#section-5.16-6">¶</a></p>
<p id="section-5.16-7">After the final chunk, the AEAD algorithm is used to produce a final
authentication tag encrypting the empty string.  This AEAD instance is
given the additional data specified above, plus an eight-octet,
big-endian value specifying the total number of plaintext octets
encrypted.  This allows detection of a truncated ciphertext.  Please
note that the big-endian number representing the chunk index in the
additional data is increased accordingly, although it's not really a
chunk.<a href="#section-5.16-7">¶</a></p>
<p id="section-5.16-8">The chunk size octet specifies the size of chunks using the following
formula (in C), where c is the chunk size octet:<a href="#section-5.16-8">¶</a></p>
<div id="section-5.16-9">
<pre>    chunk_size = ((uint64_t)1 &lt;&lt; (c + 6))
</pre><p><a href="#section-5.16-9">¶</a>
</p></div>
<p id="section-5.16-10">An implementation MUST support chunk size octets with values from 0 to
56.  Chunk size octets with other values are reserved for future
extensions.  Implementations SHOULD NOT create data with a chunk size
octet value larger than 21 (128 MiB chunks) to facilitate buffering of
not yet authenticated plaintext.<a href="#section-5.16-10">¶</a></p>
<p id="section-5.16-11">A new random initialization vector MUST be used for each message.
Failure to do so for each message will lead to a catastrophic failure
depending on the used AEAD mode.<a href="#section-5.16-11">¶</a></p>
<div id="eax-mode">
<section id="section-5.16.1">
          <h4 id="name-eax-mode">
<a href="#section-5.16.1">5.16.1. </a><a href="#name-eax-mode">EAX Mode</a>
          </h4>
<p id="section-5.16.1-1">The EAX algorithm can only use block ciphers with 16-octet
blocks.  The starting initialization vector and authentication tag are
both 16 octets long.<a href="#section-5.16.1-1">¶</a></p>
<p id="section-5.16.1-2">The starting initialization vector for this mode MUST be unique and
unpredictable.<a href="#section-5.16.1-2">¶</a></p>
<p id="section-5.16.1-3">The nonce for EAX mode is computed by treating the starting
initialization vector as a 16-octet, big-endian value and
exclusive-oring the low eight octets of it with the chunk index.<a href="#section-5.16.1-3">¶</a></p>
<p id="section-5.16.1-4">The security of EAX requires that the nonce is never reused, hence the
requirement that the starting initialization vector be unique.<a href="#section-5.16.1-4">¶</a></p>
</section>
</div>
<div id="ocb-mode">
<section id="section-5.16.2">
          <h4 id="name-ocb-mode">
<a href="#section-5.16.2">5.16.2. </a><a href="#name-ocb-mode">OCB Mode</a>
          </h4>
<p id="section-5.16.2-1">The OCB Authenticated-Encryption Algorithm used in this document is
defined in <span>[<a href="#RFC7253">RFC7253</a>]</span>.<a href="#section-5.16.2-1">¶</a></p>
<p id="section-5.16.2-2">OCB usage requires specification of the following parameters:<a href="#section-5.16.2-2">¶</a></p>
<ul>
<li id="section-5.16.2-3.1">a blockcipher that operate on 128-bit (16-octet) blocks<a href="#section-5.16.2-3.1">¶</a>
</li>
<li id="section-5.16.2-3.2">an authentication tag length of 16 octets<a href="#section-5.16.2-3.2">¶</a>
</li>
<li id="section-5.16.2-3.3">a nonce of 15 octets long (which is the longest nonce allowed
specified by <span>[<a href="#RFC7253">RFC7253</a>]</span>)<a href="#section-5.16.2-3.3">¶</a>
</li>
<li id="section-5.16.2-3.4">an initialization vector of at least 15 octets long<a href="#section-5.16.2-3.4">¶</a>
</li>
</ul>
<p id="section-5.16.2-4">In the case that the initialization vector is longer than 15 octets
(such as in <a href="#secret-key-packet-tag-5">Section 5.5.1.3</a>, only the 15
leftmost octets are used in calculations; the remaining octets MUST be
considered as zero.<a href="#section-5.16.2-4">¶</a></p>
<p id="section-5.16.2-5">The nonce for OCB mode is computed by the exclusive-oring of the
initialization vector as a 15-octet, big endian value, against the
chunk index.<a href="#section-5.16.2-5">¶</a></p>
<p id="section-5.16.2-6">Security of OCB mode depends on the non-repeated nature of nonces used
for the same key on distinct plaintext <span>[<a href="#RFC7253">RFC7253</a>]</span>. Therefore the
initialization vector per message MUST be distinct, and OCB mode
SHOULD only be used in environments when there is certainty to
fulfilling this requirement.<a href="#section-5.16.2-6">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="radix-64-conversions">
<section id="section-6">
      <h2 id="name-radix-64-conversions">
<a href="#section-6">6. </a><a href="#name-radix-64-conversions">Radix-64 Conversions</a>
      </h2>
<p id="section-6-1">As stated in the introduction, OpenPGP's underlying native
representation for objects is a stream of arbitrary octets, and some
systems desire these objects to be immune to damage caused by
character set translation, data conversions, etc.<a href="#section-6-1">¶</a></p>
<p id="section-6-2">In principle, any printable encoding scheme that met the requirements
of the unsafe channel would suffice, since it would not change the
underlying binary bit streams of the native OpenPGP data
structures.  The OpenPGP standard specifies one such printable encoding
scheme to ensure interoperability.<a href="#section-6-2">¶</a></p>
<p id="section-6-3">OpenPGP's Radix-64 encoding is composed of two parts: a base64
encoding of the binary data and a checksum.  The base64 encoding is
identical to the MIME base64 content-transfer-encoding <span>[<a href="#RFC2045">RFC2045</a>]</span>.<a href="#section-6-3">¶</a></p>
<p id="section-6-4">The checksum is a 24-bit Cyclic Redundancy Check (CRC) converted to
four characters of radix-64 encoding by the same MIME base64
transformation, preceded by an equal sign (=).  The CRC is computed by
using the generator 0x864CFB and an initialization of 0xB704CE.  The
accumulation is done on the data before it is converted to radix-64,
rather than on the converted data. A sample implementation of this
algorithm is in the next section.<a href="#section-6-4">¶</a></p>
<p id="section-6-5">The checksum with its leading equal sign MAY appear on the first line
after the base64 encoded data.<a href="#section-6-5">¶</a></p>
<p id="section-6-6">Rationale for CRC-24: The size of 24 bits fits evenly into printable
base64.  The nonzero initialization can detect more errors than a zero
initialization.<a href="#section-6-6">¶</a></p>
<div id="an-implementation-of-the-crc-24-in-c">
<section id="section-6.1">
        <h3 id="name-an-implementation-of-the-cr">
<a href="#section-6.1">6.1. </a><a href="#name-an-implementation-of-the-cr">An Implementation of the CRC-24 in "C"</a>
        </h3>
<div id="section-6.1-1">
<pre>&lt;CODE BEGINS&gt;
  #define CRC24_INIT 0xB704CEL
  #define CRC24_POLY 0x864CFBL

  typedef long crc24;
  crc24 crc_octets(unsigned char *octets, size_t len)
  {
      crc24 crc = CRC24_INIT;
      int i;
      while (len--) {
          crc ^= (*octets++) &lt;&lt; 16;
          for (i = 0; i &lt; 8; i++) {
              crc &lt;&lt;= 1;
              if (crc &amp; 0x1000000)
                  crc ^= CRC24_POLY;
          }
      }
      return crc &amp; 0xFFFFFFL;
  }

&lt;CODE ENDS&gt;</pre><p><a href="#section-6.1-1">¶</a>
</p></div>
</section>
</div>
<div id="forming-ascii-armor">
<section id="section-6.2">
        <h3 id="name-forming-ascii-armor">
<a href="#section-6.2">6.2. </a><a href="#name-forming-ascii-armor">Forming ASCII Armor</a>
        </h3>
<p id="section-6.2-1">When OpenPGP encodes data into ASCII Armor, it puts specific headers
around the Radix-64 encoded data, so OpenPGP can reconstruct the data
later.  An OpenPGP implementation MAY use ASCII armor to protect raw
binary data.  OpenPGP informs the user what kind of data is encoded in
the ASCII armor through the use of the headers.<a href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">Concatenating the following data creates ASCII Armor:<a href="#section-6.2-2">¶</a></p>
<ul>
<li id="section-6.2-3.1">An Armor Header Line, appropriate for the type of data<a href="#section-6.2-3.1">¶</a>
</li>
<li id="section-6.2-3.2">Armor Headers<a href="#section-6.2-3.2">¶</a>
</li>
<li id="section-6.2-3.3">A blank line<a href="#section-6.2-3.3">¶</a>
</li>
<li id="section-6.2-3.4">The ASCII-Armored data<a href="#section-6.2-3.4">¶</a>
</li>
<li id="section-6.2-3.5">An Armor Checksum<a href="#section-6.2-3.5">¶</a>
</li>
<li id="section-6.2-3.6">The Armor Tail, which depends on the Armor Header Line<a href="#section-6.2-3.6">¶</a>
</li>
</ul>
<p id="section-6.2-4">An Armor Header Line consists of the appropriate header line text
surrounded by five (5) dashes ('-', 0x2D) on either side of the header
line text.  The header line text is chosen based upon the type of data
that is being encoded in Armor, and how it is being encoded.  Header
line texts include the following strings:<a href="#section-6.2-4">¶</a></p>
<dl id="section-6.2-5">
          <dt id="section-6.2-5.1">BEGIN PGP MESSAGE</dt>
<dd id="section-6.2-5.2">
  Used for signed, encrypted, or compressed files.<a href="#section-6.2-5.2">¶</a>
</dd>
<dt id="section-6.2-5.3">BEGIN PGP PUBLIC KEY BLOCK</dt>
<dd id="section-6.2-5.4">
  Used for armoring public keys.<a href="#section-6.2-5.4">¶</a>
</dd>
<dt id="section-6.2-5.5">BEGIN PGP PRIVATE KEY BLOCK</dt>
<dd id="section-6.2-5.6">
  Used for armoring private keys.<a href="#section-6.2-5.6">¶</a>
</dd>
<dt id="section-6.2-5.7">BEGIN PGP MESSAGE, PART X/Y</dt>
<dd id="section-6.2-5.8">
  Used for multi-part messages, where the armor is split amongst Y
parts, and this is the Xth part out of Y.<a href="#section-6.2-5.8">¶</a>
</dd>
<dt id="section-6.2-5.9">BEGIN PGP MESSAGE, PART X</dt>
<dd id="section-6.2-5.10">
  Used for multi-part messages, where this is the Xth part of an
unspecified number of parts.  Requires the MESSAGE-ID Armor Header
to be used.<a href="#section-6.2-5.10">¶</a>
</dd>
<dt id="section-6.2-5.11">BEGIN PGP SIGNATURE</dt>
<dd id="section-6.2-5.12">
  Used for detached signatures, OpenPGP/MIME signatures, and
cleartext signatures.  Note that PGP 2 uses BEGIN PGP MESSAGE for
detached signatures.<a href="#section-6.2-5.12">¶</a>
</dd>
</dl>
<p id="section-6.2-6">Note that all these Armor Header Lines are to consist of a complete
line.  That is to say, there is always a line ending preceding the
starting five dashes, and following the ending five dashes.  The header
lines, therefore, MUST start at the beginning of a line, and MUST NOT
have text other than whitespace -- space (0x20), tab (0x09) or carriage
return (0x0d) -- following them on the same line.  These
line endings are considered a part of the Armor Header Line for the
purposes of determining the content they delimit.  This is particularly
important when computing a cleartext signature (see below).<a href="#section-6.2-6">¶</a></p>
<p id="section-6.2-7">The Armor Headers are pairs of strings that can give the user or the
receiving OpenPGP implementation some information about how to decode
or use the message.  The Armor Headers are a part of the armor, not a
part of the message, and hence are not protected by any signatures
applied to the message.<a href="#section-6.2-7">¶</a></p>
<p id="section-6.2-8">The format of an Armor Header is that of a key-value pair. A colon
(':' 0x38) and a single space (0x20) separate the key and
value.  OpenPGP should consider improperly formatted Armor Headers to
be corruption of the ASCII Armor.  Unknown keys should be reported to
the user, but OpenPGP should continue to process the message.<a href="#section-6.2-8">¶</a></p>
<p id="section-6.2-9">Note that some transport methods are sensitive to line length.  While
there is a limit of 76 characters for the Radix-64 data
(<a href="#encoding-binary-in-radix-64">Section 6.3</a>), there is no limit to the length of
Armor Headers.  Care should be taken that the Armor Headers are short
enough to survive transport.  One way to do this is to repeat an Armor
Header Key multiple times with different values for each so that no
one line is overly long.<a href="#section-6.2-9">¶</a></p>
<p id="section-6.2-10">Currently defined Armor Header Keys are as follows:<a href="#section-6.2-10">¶</a></p>
<ul>
<li id="section-6.2-11.1">"Version", which states the OpenPGP implementation and version
used to encode the message.<a href="#section-6.2-11.1">¶</a>
</li>
<li id="section-6.2-11.2">"Comment", a user-defined comment.  OpenPGP defines all text to
be in UTF-8.  A comment may be any UTF-8 string.  However, the
whole point of armoring is to provide seven-bit-clean data.
Consequently, if a comment has characters that are outside the
US-ASCII range of UTF, they may very well not survive
transport.<a href="#section-6.2-11.2">¶</a>
</li>
<li id="section-6.2-11.3">"Hash", a comma-separated list of hash algorithms used in this
message.  This is used only in cleartext signed messages.<a href="#section-6.2-11.3">¶</a>
</li>
<li id="section-6.2-11.4">
            <p id="section-6.2-11.4.1">"MessageID", a 32-character string of printable characters.
The string must be the same for all parts of a multi-part
message that uses the "PART X" Armor Header.  MessageID strings
should be unique enough that the recipient of the mail can
associate all the parts of a message with each other.  A good
checksum or cryptographic hash function is sufficient.<a href="#section-6.2-11.4.1">¶</a></p>
<p id="section-6.2-11.4.2">
The MessageID SHOULD NOT appear unless it is in a multi-part
message.  If it appears at all, it MUST be computed from the
finished (encrypted, signed, etc.) message in a deterministic
fashion, rather than contain a purely random value.  This is to
allow the legitimate recipient to determine that the MessageID
cannot serve as a covert means of leaking cryptographic key
information.<a href="#section-6.2-11.4.2">¶</a></p>
</li>
<li id="section-6.2-11.5">"Charset", a description of the character set that the
plaintext is in.  Please note that OpenPGP defines text to be
in UTF-8.  An implementation will get best results by
translating into and out of UTF-8.  However, there are many
instances where this is easier said than done.  Also, there are
communities of users who have no need for UTF-8 because they
are all happy with a character set like ISO Latin-5 or a
Japanese character set.  In such instances, an implementation
MAY override the UTF-8 default by using this header key.  An
implementation MAY implement this key and any translations it
cares to; an implementation MAY ignore it and assume all text
is UTF-8.<a href="#section-6.2-11.5">¶</a>
</li>
</ul>
<p id="section-6.2-12">The blank line can either be zero-length or contain only whitespace,
that is spaces (0x20), tabs (0x09) or carriage returns (0x0d).<a href="#section-6.2-12">¶</a></p>
<p id="section-6.2-13">The Armor Tail Line is composed in the same manner as the Armor Header
Line, except the string "BEGIN" is replaced by the string "END".<a href="#section-6.2-13">¶</a></p>
</section>
</div>
<div id="encoding-binary-in-radix-64">
<section id="section-6.3">
        <h3 id="name-encoding-binary-in-radix-64">
<a href="#section-6.3">6.3. </a><a href="#name-encoding-binary-in-radix-64">Encoding Binary in Radix-64</a>
        </h3>
<p id="section-6.3-1">The encoding process represents 24-bit groups of input bits as output
strings of 4 encoded characters.  Proceeding from left to right, a
24-bit input group is formed by concatenating three 8-bit input
groups.  These 24 bits are then treated as four concatenated 6-bit
groups, each of which is translated into a single digit in the
Radix-64 alphabet.  When encoding a bit stream with the Radix-64
encoding, the bit stream must be presumed to be ordered with the most
significant bit first.  That is, the first bit in the stream will be
the high-order bit in the first 8-bit octet, and the eighth bit will
be the low-order bit in the first 8-bit octet, and so on.<a href="#section-6.3-1">¶</a></p>
<div id="section-6.3-2">
<pre>     +--first octet--+-second octet--+--third octet--+
     |7 6 5 4 3 2 1 0|7 6 5 4 3 2 1 0|7 6 5 4 3 2 1 0|
     +-----------+---+-------+-------+---+-----------+
     |5 4 3 2 1 0|5 4 3 2 1 0|5 4 3 2 1 0|5 4 3 2 1 0|
     +--1.index--+--2.index--+--3.index--+--4.index--+
</pre><p><a href="#section-6.3-2">¶</a>
</p></div>
<p id="section-6.3-3">Each 6-bit group is used as an index into an array of 64 printable
characters from the table below.  The character referenced by the index
is placed in the output string.<a href="#section-6.3-3">¶</a></p>
<div id="section-6.3-4">
<pre> Value Encoding  Value Encoding  Value Encoding  Value Encoding
     0 A            17 R            34 i            51 z
     1 B            18 S            35 j            52 0
     2 C            19 T            36 k            53 1
     3 D            20 U            37 l            54 2
     4 E            21 V            38 m            55 3
     5 F            22 W            39 n            56 4
     6 G            23 X            40 o            57 5
     7 H            24 Y            41 p            58 6
     8 I            25 Z            42 q            59 7
     9 J            26 a            43 r            60 8
    10 K            27 b            44 s            61 9
    11 L            28 c            45 t            62 +
    12 M            29 d            46 u            63 /
    13 N            30 e            47 v
    14 O            31 f            48 w         (pad) =
    15 P            32 g            49 x
    16 Q            33 h            50 y
</pre><p><a href="#section-6.3-4">¶</a>
</p></div>
<p id="section-6.3-5">The encoded output stream must be represented in lines of no more than
76 characters each.<a href="#section-6.3-5">¶</a></p>
<p id="section-6.3-6">Special processing is performed if fewer than 24 bits are available at
the end of the data being encoded.  There are three possibilities:<a href="#section-6.3-6">¶</a></p>
<div id="section-6.3-7">
<pre>1.  The last data group has 24 bits (3 octets).  No special
    processing is needed.

2.  The last data group has 16 bits (2 octets).  The first two
    6-bit groups are processed as above.  The third (incomplete)
    data group has two zero-value bits added to it, and is
    processed as above. A pad character (=) is added to the
    output.

3.  The last data group has 8 bits (1 octet).  The first 6-bit
    group is processed as above.  The second (incomplete) data
    group has four zero-value bits added to it, and is processed
    as above.  Two pad characters (=) are added to the output.
</pre><p><a href="#section-6.3-7">¶</a>
</p></div>
</section>
</div>
<div id="decoding-radix-64">
<section id="section-6.4">
        <h3 id="name-decoding-radix-64">
<a href="#section-6.4">6.4. </a><a href="#name-decoding-radix-64">Decoding Radix-64</a>
        </h3>
<p id="section-6.4-1">In Radix-64 data, characters other than those in the table, line
breaks, and other white space probably indicate a transmission error,
about which a warning message or even a message rejection might be
appropriate under some circumstances.  Decoding software must ignore
all white space.<a href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">Because it is used only for padding at the end of the data, the
occurrence of any "=" characters may be taken as evidence that the end
of the data has been reached (without truncation in transit).  No such
assurance is possible, however, when the number of octets transmitted
was a multiple of three and no "=" characters are present.<a href="#section-6.4-2">¶</a></p>
</section>
</div>
<div id="examples-of-radix-64">
<section id="section-6.5">
        <h3 id="name-examples-of-radix-64">
<a href="#section-6.5">6.5. </a><a href="#name-examples-of-radix-64">Examples of Radix-64</a>
        </h3>
<div id="section-6.5-1">
<pre>Input data:  0x14FB9C03D97E
Hex:     1   4    F   B    9   C     | 0   3    D   9    7   E
8-bit:   00010100 11111011 10011100  | 00000011 11011001 01111110
6-bit:   000101 001111 101110 011100 | 000000 111101 100101 111110
Decimal: 5      15     46     28       0      61     37     62
Output:  F      P      u      c        A      9      l      +
Input data:  0x14FB9C03D9
Hex:     1   4    F   B    9   C     | 0   3    D   9
8-bit:   00010100 11111011 10011100  | 00000011 11011001
                                                pad with 00
6-bit:   000101 001111 101110 011100 | 000000 111101 100100
Decimal: 5      15     46     28       0      61     36
                                                   pad with =
Output:  F      P      u      c        A      9      k      =
Input data:  0x14FB9C03
Hex:     1   4    F   B    9   C     | 0   3
8-bit:   00010100 11111011 10011100  | 00000011
                                       pad with 0000
6-bit:   000101 001111 101110 011100 | 000000 110000
Decimal: 5      15     46     28       0      48
                                            pad with =      =
Output:  F      P      u      c        A      w      =      =
</pre><p><a href="#section-6.5-1">¶</a>
</p></div>
</section>
</div>
<div id="example-of-an-ascii-armored-message">
<section id="section-6.6">
        <h3 id="name-example-of-an-ascii-armored">
<a href="#section-6.6">6.6. </a><a href="#name-example-of-an-ascii-armored">Example of an ASCII Armored Message</a>
        </h3>
<div id="section-6.6-1">
<pre>-----BEGIN PGP MESSAGE-----
Version: OpenPrivacy 0.99

yDgBO22WxBHv7O8X7O/jygAEzol56iUKiXmV+XmpCtmpqQUKiQrFqclFqUDBovzS
vBSFjNSiVHsuAA==
=njUN
-----END PGP MESSAGE-----
</pre><p><a href="#section-6.6-1">¶</a>
</p></div>
<p id="section-6.6-2">Note that this example has extra indenting; an actual armored message
would have no leading whitespace.<a href="#section-6.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cleartext-signature-framework">
<section id="section-7">
      <h2 id="name-cleartext-signature-framewo">
<a href="#section-7">7. </a><a href="#name-cleartext-signature-framewo">Cleartext Signature Framework</a>
      </h2>
<p id="section-7-1">It is desirable to be able to sign a textual octet stream without
ASCII armoring the stream itself, so the signed text is still readable
without special software.  In order to bind a signature to such a
cleartext, this framework is used, which follows the same basic format
and restrictions as the ASCII armoring described above in "Forming
ASCII Armor" (<a href="#forming-ascii-armor">Section 6.2</a>). (Note that this framework is
not intended to be reversible.  RFC 3156 <span>[<a href="#RFC3156">RFC3156</a>]</span> defines another
way to sign cleartext messages for environments that support MIME.)<a href="#section-7-1">¶</a></p>
<p id="section-7-2">The cleartext signed message consists of:<a href="#section-7-2">¶</a></p>
<ul>
<li id="section-7-3.1">The cleartext header <code>-----BEGIN PGP SIGNED MESSAGE-----</code> on a
single line,<a href="#section-7-3.1">¶</a>
</li>
<li id="section-7-3.2">One or more "Hash" Armor Headers,<a href="#section-7-3.2">¶</a>
</li>
<li id="section-7-3.3">Exactly one blank line not included into the message digest,<a href="#section-7-3.3">¶</a>
</li>
<li id="section-7-3.4">The dash-escaped cleartext that is included into the message
digest,<a href="#section-7-3.4">¶</a>
</li>
<li id="section-7-3.5">The ASCII armored signature(s) including the
<code>-----BEGIN PGP SIGNATURE-----</code> Armor Header and Armor Tail Lines.<a href="#section-7-3.5">¶</a>
</li>
</ul>
<p id="section-7-4">If the "Hash" Armor Header is given, the specified message digest
algorithm(s) are used for the signature.  If there are no such headers,
MD5 is used.  If MD5 is the only hash used, then an implementation MAY
omit this header for improved V2.x compatibility.  If more than one
message digest is used in the signature, the "Hash" armor header
contains a comma-delimited list of used message digests.<a href="#section-7-4">¶</a></p>
<p id="section-7-5">Current message digest names are described below with the algorithm
IDs.<a href="#section-7-5">¶</a></p>
<p id="section-7-6">An implementation SHOULD add a line break after the cleartext, but MAY
omit it if the cleartext ends with a line break.  This is for visual
clarity.<a href="#section-7-6">¶</a></p>
<div id="dash-escaped-text">
<section id="section-7.1">
        <h3 id="name-dash-escaped-text">
<a href="#section-7.1">7.1. </a><a href="#name-dash-escaped-text">Dash-Escaped Text</a>
        </h3>
<p id="section-7.1-1">The cleartext content of the message must also be dash-escaped.<a href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">Dash-escaped cleartext is the ordinary cleartext where every line
starting with a dash '-' (0x2D) is prefixed by the sequence dash '-'
(0x2D) and space ' ' (0x20).  This prevents the parser from recognizing
armor headers of the cleartext itself.  An implementation MAY
dash-escape any line, SHOULD dash-escape lines commencing "From"
followed by a space, and MUST dash-escape any line commencing in a
dash.  The message digest is computed using the cleartext itself, not
the dash-escaped form.<a href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">As with binary signatures on text documents, a cleartext signature is
calculated on the text using canonical &lt;CR&gt;&lt;LF&gt; line
endings.  The line ending (i.e., the &lt;CR&gt;&lt;LF&gt;) before the
<code>-----BEGIN PGP SIGNATURE-----</code> line that terminates the signed text
is not considered part of the signed text.<a href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">When reversing dash-escaping, an implementation MUST strip the string
"- " if it occurs at the beginning of a line, and SHOULD warn on "-"
and any character other than a space at the beginning of a line.<a href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">Also, any trailing whitespace -- spaces (0x20), tabs (0x09) or
carriage returns (0x0d) -- at the end of any line is removed when
the cleartext signature is generated and verified.<a href="#section-7.1-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="regular-expressions">
<section id="section-8">
      <h2 id="name-regular-expressions">
<a href="#section-8">8. </a><a href="#name-regular-expressions">Regular Expressions</a>
      </h2>
<p id="section-8-1">A regular expression is zero or more branches, separated by '|'.  It
matches anything that matches one of the branches.<a href="#section-8-1">¶</a></p>
<p id="section-8-2">A branch is zero or more pieces, concatenated.  It matches a match for
the first, followed by a match for the second, etc.<a href="#section-8-2">¶</a></p>
<p id="section-8-3">A piece is an atom possibly followed by '<em>', '+', or '?'.  An atom
followed by '</em>' matches a sequence of 0 or more matches of the
atom.  An atom followed by '+' matches a sequence of 1 or more matches
of the atom.  An atom followed by '?' matches a match of the atom, or
the null string.<a href="#section-8-3">¶</a></p>
<p id="section-8-4">An atom is a regular expression in parentheses (matching a match for
the regular expression), a range (see below), '.' (matching any single
character), '^' (matching the null string at the beginning of the
input string), '$' (matching the null string at the end of the input
string), a '' followed by a single character (matching that
character), or a single character with no other significance (matching
that character).<a href="#section-8-4">¶</a></p>
<p id="section-8-5">A range is a sequence of characters enclosed in <code>[]</code>.  It normally
matches any single character from the sequence.  If the sequence begins
with '^', it matches any single character not from the rest of the
sequence.  If two characters in the sequence are separated by '-', this
is shorthand for the full list of ASCII characters between them (e.g.,
<code>[0-9]</code> matches any decimal digit).  To include a literal ']' in the
sequence, make it the first character (following a possible '^').  To
include a literal '-', make it the first or last character.<a href="#section-8-5">¶</a></p>
</section>
</div>
<div id="constants">
<section id="section-9">
      <h2 id="name-constants">
<a href="#section-9">9. </a><a href="#name-constants">Constants</a>
      </h2>
<p id="section-9-1">This section describes the constants used in OpenPGP.<a href="#section-9-1">¶</a></p>
<p id="section-9-2">Note that these tables are not exhaustive lists; an implementation MAY
implement an algorithm not on these lists, so long as the algorithm
numbers are chosen from the private or experimental algorithm range.<a href="#section-9-2">¶</a></p>
<p id="section-9-3">See the section "Notes on Algorithms" below for more discussion of the
algorithms.<a href="#section-9-3">¶</a></p>
<div id="public-key-algorithms">
<section id="section-9.1">
        <h3 id="name-public-key-algorithms">
<a href="#section-9.1">9.1. </a><a href="#name-public-key-algorithms">Public-Key Algorithms</a>
        </h3>
<table id="table-6">
          <caption><a href="#table-6">Table 6</a></caption>
<thead>
            <tr>
              <th rowspan="1" colspan="1">ID</th>
              <th rowspan="1" colspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">RSA (Encrypt or Sign) <span>[<a href="#HAC">HAC</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">RSA Encrypt-Only <span>[<a href="#HAC">HAC</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">RSA Sign-Only <span>[<a href="#HAC">HAC</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">Elgamal (Encrypt-Only) <span>[<a href="#ELGAMAL">ELGAMAL</a>]</span> <span>[<a href="#HAC">HAC</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">DSA (Digital Signature Algorithm) <span>[<a href="#FIPS186">FIPS186</a>]</span> <span>[<a href="#HAC">HAC</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">18</td>
              <td rowspan="1" colspan="1">ECDH public key algorithm</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">ECDSA public key algorithm <span>[<a href="#FIPS186">FIPS186</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">Reserved (formerly Elgamal Encrypt or Sign)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">21</td>
              <td rowspan="1" colspan="1">Reserved for Diffie-Hellman (X9.42, as defined for IETF-S/MIME)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">22</td>
              <td rowspan="1" colspan="1">EdDSA  <span>[<a href="#RFC8032">RFC8032</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">23</td>
              <td rowspan="1" colspan="1">Reserved for AEDH</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">24</td>
              <td rowspan="1" colspan="1">Reserved for AEDSA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100-110</td>
              <td rowspan="1" colspan="1">Private/Experimental algorithm</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.1-2">Implementations MUST implement RSA (1) and ECDSA (19) for signatures,
and RSA (1) and ECDH (18) for encryption.  Implementations SHOULD
implement EdDSA (22) keys.<a href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">RSA Encrypt-Only (2) and RSA Sign-Only (3) are deprecated and SHOULD
NOT be generated, but may be interpreted.  See <a href="#rsa">Section 14.5</a>.  See
<a href="#reserved-algorithm-numbers">Section 14.9</a> for notes on Elgamal Encrypt or Sign
(20), and X9.42 (21).  Implementations MAY implement any other
algorithm.<a href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">Note that implementations conforming to previous versions of this
standard (RFC-4880) have DSA (17) and Elgamal (16) as its only
MUST-implement algorithm.<a href="#section-9.1-4">¶</a></p>
<p id="section-9.1-5">A compatible specification of ECDSA is given in <span>[<a href="#RFC6090">RFC6090</a>]</span> as "KT-I
Signatures" and in <span>[<a href="#SEC1">SEC1</a>]</span>; ECDH is defined in <a href="#ec-dh-algorithm-ecdh">Section 13.5</a>
this document.<a href="#section-9.1-5">¶</a></p>
</section>
</div>
<div id="ecc-curve-oid">
<section id="section-9.2">
        <h3 id="name-ecc-curve-oid">
<a href="#section-9.2">9.2. </a><a href="#name-ecc-curve-oid">ECC Curve OID</a>
        </h3>
<p id="section-9.2-1">The parameter curve OID is an array of octets that define a named
curve.  The table below specifies the exact sequence of bytes for each
named curve referenced in this document:<a href="#section-9.2-1">¶</a></p>
<table id="table-7">
          <caption><a href="#table-7">Table 7</a></caption>
<thead>
            <tr>
              <th rowspan="1" colspan="1">ASN.1 Object Identifier</th>
              <th rowspan="1" colspan="1">OID len</th>
              <th rowspan="1" colspan="1">Curve OID bytes in hexadecimal representation</th>
              <th rowspan="1" colspan="1">Curve name</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1.2.840.10045.3.1.7</td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">2A 86 48 CE 3D 03 01 07</td>
              <td rowspan="1" colspan="1">NIST P-256</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1.3.132.0.34</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">2B 81 04 00 22</td>
              <td rowspan="1" colspan="1">NIST P-384</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1.3.132.0.35</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">2B 81 04 00 23</td>
              <td rowspan="1" colspan="1">NIST P-521</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1.3.36.3.3.2.8.1.1.7</td>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">2B 24 03 03 02 08 01 01 07</td>
              <td rowspan="1" colspan="1">brainpoolP256r1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1.3.36.3.3.2.8.1.1.13</td>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">2B 24 03 03 02 08 01 01 0D</td>
              <td rowspan="1" colspan="1">brainpoolP512r1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1.3.6.1.4.1.11591.15.1</td>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">2B 06 01 04 01 DA 47 0F 01</td>
              <td rowspan="1" colspan="1">Ed25519</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1.3.6.1.4.1.3029.1.5.1</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">2B 06 01 04 01 97 55 01 05 01</td>
              <td rowspan="1" colspan="1">Curve25519</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.2-3">The sequence of octets in the third column is the result of applying
the Distinguished Encoding Rules (DER) to the ASN.1 Object Identifier
with subsequent truncation.  The truncation removes the two fields of
encoded Object Identifier.  The first omitted field is one octet
representing the Object Identifier tag, and the second omitted field
is the length of the Object Identifier body.  For example, the
complete ASN.1 DER encoding for the NIST P-256 curve OID is "06 08 2A
86 48 CE 3D 03 01 07", from which the first entry in the table above
is constructed by omitting the first two octets.  Only the truncated
sequence of octets is the valid representation of a curve OID.<a href="#section-9.2-3">¶</a></p>
</section>
</div>
<div id="symmetric-key-algorithms">
<section id="section-9.3">
        <h3 id="name-symmetric-key-algorithms">
<a href="#section-9.3">9.3. </a><a href="#name-symmetric-key-algorithms">Symmetric-Key Algorithms</a>
        </h3>
<table id="table-8">
          <caption><a href="#table-8">Table 8</a></caption>
<thead>
            <tr>
              <th rowspan="1" colspan="1">ID</th>
              <th rowspan="1" colspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">Plaintext or unencrypted data</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">IDEA <span>[<a href="#IDEA">IDEA</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">TripleDES (DES-EDE, <span>[<a href="#SCHNEIER">SCHNEIER</a>]</span> <span>[<a href="#HAC">HAC</a>]</span> - 168 bit key derived from 192)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">CAST5 (128 bit key, as per <span>[<a href="#RFC2144">RFC2144</a>]</span>)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">Blowfish (128 bit key, 16 rounds) <span>[<a href="#BLOWFISH">BLOWFISH</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">AES with 128-bit key <span>[<a href="#AES">AES</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">AES with 192-bit key</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">AES with 256-bit key</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">Twofish with 256-bit key <span>[<a href="#TWOFISH">TWOFISH</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">Camellia with 128-bit key <span>[<a href="#RFC3713">RFC3713</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">Camellia with 192-bit key</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">Camellia with 256-bit key</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100-110</td>
              <td rowspan="1" colspan="1">Private/Experimental algorithm</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.3-2">Implementations MUST implement AES-128.  Implementations SHOULD
implement AES-256.  Implementations that interoperate with RFC-4880
implementations need to support TripleDES and CAST5.  Implementations
that interoperate with PGP 2.6 or earlier need to support IDEA, as
that is the only symmetric cipher those versions use.  Implementations
MAY implement any other algorithm.<a href="#section-9.3-2">¶</a></p>
</section>
</div>
<div id="compression-algorithms">
<section id="section-9.4">
        <h3 id="name-compression-algorithms">
<a href="#section-9.4">9.4. </a><a href="#name-compression-algorithms">Compression Algorithms</a>
        </h3>
<table id="table-9">
          <caption><a href="#table-9">Table 9</a></caption>
<thead>
            <tr>
              <th rowspan="1" colspan="1">ID</th>
              <th rowspan="1" colspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">Uncompressed</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">ZIP <span>[<a href="#RFC1951">RFC1951</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">ZLIB <span>[<a href="#RFC1950">RFC1950</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">BZip2 <span>[<a href="#BZ2">BZ2</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100-110</td>
              <td rowspan="1" colspan="1">Private/Experimental algorithm</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.4-2">Implementations MUST implement uncompressed data.  Implementations
SHOULD implement ZLIB.  For interoperability reasons implementations
SHOULD be able to decompress using ZIP.  Implementations MAY implement
any other algorithm.<a href="#section-9.4-2">¶</a></p>
</section>
</div>
<div id="hash-algorithms">
<section id="section-9.5">
        <h3 id="name-hash-algorithms">
<a href="#section-9.5">9.5. </a><a href="#name-hash-algorithms">Hash Algorithms</a>
        </h3>
<table id="table-10">
          <caption><a href="#table-10">Table 10</a></caption>
<thead>
            <tr>
              <th rowspan="1" colspan="1">ID</th>
              <th rowspan="1" colspan="1">Algorithm</th>
              <th rowspan="1" colspan="1">Text Name</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">MD5 <span>[<a href="#HAC">HAC</a>]</span>
</td>
              <td rowspan="1" colspan="1">"MD5"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">SHA-1 <span>[<a href="#FIPS180">FIPS180</a>]</span>
</td>
              <td rowspan="1" colspan="1">"SHA1"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">RIPE-MD/160 <span>[<a href="#HAC">HAC</a>]</span>
</td>
              <td rowspan="1" colspan="1">"RIPEMD160"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">Reserved</td>
              <td rowspan="1" colspan="1">&nbsp;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">Reserved</td>
              <td rowspan="1" colspan="1">&nbsp;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">Reserved</td>
              <td rowspan="1" colspan="1">&nbsp;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">Reserved</td>
              <td rowspan="1" colspan="1">&nbsp;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">SHA2-256 <span>[<a href="#FIPS180">FIPS180</a>]</span>
</td>
              <td rowspan="1" colspan="1">"SHA256"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">SHA2-384 <span>[<a href="#FIPS180">FIPS180</a>]</span>
</td>
              <td rowspan="1" colspan="1">"SHA384"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">SHA2-512 <span>[<a href="#FIPS180">FIPS180</a>]</span>
</td>
              <td rowspan="1" colspan="1">"SHA512"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">SHA2-224 <span>[<a href="#FIPS180">FIPS180</a>]</span>
</td>
              <td rowspan="1" colspan="1">"SHA224"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">SHA3-256 <span>[<a href="#FIPS202">FIPS202</a>]</span>
</td>
              <td rowspan="1" colspan="1">"SHA3-256"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">Reserved</td>
              <td rowspan="1" colspan="1">&nbsp;</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">SHA3-512 <span>[<a href="#FIPS202">FIPS202</a>]</span>
</td>
              <td rowspan="1" colspan="1">"SHA3-512"</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100-110</td>
              <td rowspan="1" colspan="1">Private/Experimental algorithm</td>
              <td rowspan="1" colspan="1">&nbsp;</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.5-2">Implementations MUST implement SHA2-256.  Implementations MAY implement
other algorithms.  Implementations SHOULD NOT create messages which
require the use of SHA-1 with the exception of computing version 4 key
fingerprints and for purposes of the MDC packet.  Implementations
SHOULD NOT use MD5 or RIPE-MD/160.<a href="#section-9.5-2">¶</a></p>
</section>
</div>
<div id="aead-algorithms">
<section id="section-9.6">
        <h3 id="name-aead-algorithms">
<a href="#section-9.6">9.6. </a><a href="#name-aead-algorithms">AEAD Algorithms</a>
        </h3>
<table id="table-11">
          <caption><a href="#table-11">Table 11</a></caption>
<thead>
            <tr>
              <th rowspan="1" colspan="1">ID</th>
              <th rowspan="1" colspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">EAX <span>[<a href="#EAX">EAX</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">OCB <span>[<a href="#RFC7253">RFC7253</a>]</span>
</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100-110</td>
              <td rowspan="1" colspan="1">Private/Experimental algorithm</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.6-2">Implementations MUST implement EAX.  Implementations MAY implement
OCB and other algorithms.<a href="#section-9.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10">10. </a><a href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-10-1">OpenPGP is highly parameterized, and consequently there are a number
of considerations for allocating parameters for extensions.  This
section describes how IANA should look at extensions to the protocol
as described in this document.<a href="#section-10-1">¶</a></p>
<p id="section-10-2">{ FIXME: Also add forward references, like
  "The list of S2K specifier types is maintained by IANA as described in
   Section 10." }<a href="#section-10-2">¶</a></p>
<div id="new-string-to-key-specifier-types">
<section id="section-10.1">
        <h3 id="name-new-string-to-key-specifier">
<a href="#section-10.1">10.1. </a><a href="#name-new-string-to-key-specifier">New String-to-Key Specifier Types</a>
        </h3>
<p id="section-10.1-1">OpenPGP S2K specifiers contain a mechanism for new algorithms to turn
a string into a key.  This specification creates a registry of S2K
specifier types.  The registry includes the S2K type, the name of the
S2K, and a reference to the defining specification.  The initial
values for this registry can be found in
<a href="#string-to-key-s2k-specifier-types">Section 3.7.1</a>.  Adding a new S2K specifier
MUST be done through the SPECIFICATION REQUIRED method, as described
in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.1-1">¶</a></p>
</section>
</div>
<div id="new-packets">
<section id="section-10.2">
        <h3 id="name-new-packets">
<a href="#section-10.2">10.2. </a><a href="#name-new-packets">New Packets</a>
        </h3>
<p id="section-10.2-1">Major new features of OpenPGP are defined through new packet types.
This specification creates a registry of packet types.  The registry
includes the packet type, the name of the packet, and a reference to
the defining specification.  The initial values for this registry can
be found in <a href="#packet-tags">Section 4.3</a>.  Adding a new packet type MUST be done
through the RFC REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2-1">¶</a></p>
<div id="user-attribute-types">
<section id="section-10.2.1">
          <h4 id="name-user-attribute-types">
<a href="#section-10.2.1">10.2.1. </a><a href="#name-user-attribute-types">User Attribute Types</a>
          </h4>
<p id="section-10.2.1-1">The User Attribute packet permits an extensible mechanism for other
types of certificate identification.  This specification creates a
registry of User Attribute types.  The registry includes the User
Attribute type, the name of the User Attribute, and a reference to the
defining specification.  The initial values for this registry can be
found in <a href="#user-attribute-packet-tag-17">Section 5.13</a>.  Adding a new User
Attribute type MUST be done through the SPECIFICATION REQUIRED method,
as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.1-1">¶</a></p>
<p id="section-10.2.1-2">This document requests that IANA register the User ID Attribute Type
found in <a href="#user-id-attribute-subpacket">Section 5.13.2</a>:<a href="#section-10.2.1-2">¶</a></p>
<table id="table-12">
            <caption><a href="#table-12">Table 12</a></caption>
<thead>
              <tr>
                <th rowspan="1" colspan="1">Value</th>
                <th rowspan="1" colspan="1">Attribute</th>
                <th rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">TBD1</td>
                <td rowspan="1" colspan="1">User ID</td>
                <td rowspan="1" colspan="1">This Document <a href="#user-id-attribute-subpacket">Section 5.13.2</a>
</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="image-format-subpacket-types">
<section id="section-10.2.2">
          <h4 id="name-image-format-subpacket-type">
<a href="#section-10.2.2">10.2.2. </a><a href="#name-image-format-subpacket-type">Image Format Subpacket Types</a>
          </h4>
<p id="section-10.2.2-1">Within User Attribute packets, there is an extensible mechanism for
other types of image-based user attributes.  This specification
creates a registry of Image Attribute subpacket types.  The registry
includes the Image Attribute subpacket type, the name of the Image
Attribute subpacket, and a reference to the defining specification.
The initial values for this registry can be found in
<a href="#the-image-attribute-subpacket">Section 5.13.1</a>.  Adding a new Image Attribute
subpacket type MUST be done through the SPECIFICATION REQUIRED method,
as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.2-1">¶</a></p>
</section>
</div>
<div id="new-signature-subpackets">
<section id="section-10.2.3">
          <h4 id="name-new-signature-subpackets">
<a href="#section-10.2.3">10.2.3. </a><a href="#name-new-signature-subpackets">New Signature Subpackets</a>
          </h4>
<p id="section-10.2.3-1">OpenPGP signatures contain a mechanism for signed (or unsigned) data
to be added to them for a variety of purposes in the Signature
subpackets as discussed in <a href="#signature-subpacket-specification">Section 5.2.3.1</a>.
This specification creates a registry of Signature subpacket types.
The registry includes the Signature subpacket type, the name of the
subpacket, and a reference to the defining specification.  The initial
values for this registry can be found in
<a href="#signature-subpacket-specification">Section 5.2.3.1</a>.  Adding a new Signature
subpacket MUST be done through the SPECIFICATION REQUIRED method, as
described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.3-1">¶</a></p>
<div id="signature-notation-data-subpackets">
<section id="section-10.2.3.1">
            <h5 id="name-signature-notation-data-sub">
<a href="#section-10.2.3.1">10.2.3.1. </a><a href="#name-signature-notation-data-sub">Signature Notation Data Subpackets</a>
            </h5>
<p id="section-10.2.3.1-1">OpenPGP signatures further contain a mechanism for extensions in
signatures.  These are the Notation Data subpackets, which contain a
key/value pair.  Notations contain a user space that is completely
unmanaged and an IETF space.<a href="#section-10.2.3.1-1">¶</a></p>
<p id="section-10.2.3.1-2">This specification creates a registry of Signature Notation Data
types.  The registry includes the Signature Notation Data type, the
name of the Signature Notation Data, its allowed values, and a
reference to the defining specification.  The initial values for this
registry can be found in <a href="#notation-data">Section 5.2.3.17</a>.  Adding a new Signature
Notation Data subpacket MUST be done through the SPECIFICATION REQUIRED
method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.3.1-2">¶</a></p>
<p id="section-10.2.3.1-3">This document requests IANA register the following Signature
Notation Data types:<a href="#section-10.2.3.1-3">¶</a></p>
<table id="table-13">
              <caption><a href="#table-13">Table 13</a></caption>
<thead>
                <tr>
                  <th rowspan="1" colspan="1">Allowed Values</th>
                  <th rowspan="1" colspan="1">Name</th>
                  <th rowspan="1" colspan="1">Type</th>
                  <th rowspan="1" colspan="1">Reference</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">A String</td>
                  <td rowspan="1" colspan="1">charset</td>
                  <td rowspan="1" colspan="1">Character Set</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-charset-notation">Section 5.2.3.17.1</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Any String</td>
                  <td rowspan="1" colspan="1">manu</td>
                  <td rowspan="1" colspan="1">Manufacturer Name</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-manu-notation">Section 5.2.3.17.2</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Any String</td>
                  <td rowspan="1" colspan="1">make</td>
                  <td rowspan="1" colspan="1">Product Make</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-make-notation">Section 5.2.3.17.3</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Any String</td>
                  <td rowspan="1" colspan="1">model</td>
                  <td rowspan="1" colspan="1">Product Model</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-model-notation">Section 5.2.3.17.4</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Any String</td>
                  <td rowspan="1" colspan="1">prodid</td>
                  <td rowspan="1" colspan="1">Product ID</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-prodid-notation">Section 5.2.3.17.5</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Any String</td>
                  <td rowspan="1" colspan="1">pvers</td>
                  <td rowspan="1" colspan="1">Product Version</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-pvers-notation">Section 5.2.3.17.6</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Any String</td>
                  <td rowspan="1" colspan="1">lot</td>
                  <td rowspan="1" colspan="1">Product Lot Number</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-lot-notation">Section 5.2.3.17.7</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Decimal Integer String</td>
                  <td rowspan="1" colspan="1">qty</td>
                  <td rowspan="1" colspan="1">Package Quantity</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-qty-notation">Section 5.2.3.17.8</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">A geo: URI without the "geo:"</td>
                  <td rowspan="1" colspan="1">loc</td>
                  <td rowspan="1" colspan="1">Current Geolocation Latitude/Longitude</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-loc-and-dest-notations">Section 5.2.3.17.9</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">A geo: URI without the "geo:"</td>
                  <td rowspan="1" colspan="1">dest</td>
                  <td rowspan="1" colspan="1">Destination Geolocation Latitude/Longitude</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-loc-and-dest-notations">Section 5.2.3.17.9</a>
</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Hash Notation data</td>
                  <td rowspan="1" colspan="1">hash</td>
                  <td rowspan="1" colspan="1">The Hash of external data</td>
                  <td rowspan="1" colspan="1">This Doc <a href="#the-hash-notation">Section 5.2.3.17.10</a>
</td>
                </tr>
              </tbody>
            </table>
</section>
</div>
<div id="signature-notation-data-subpacket-notation-flags">
<section id="section-10.2.3.2">
            <h5 id="name-signature-notation-data-subp">
<a href="#section-10.2.3.2">10.2.3.2. </a><a href="#name-signature-notation-data-subp">Signature Notation Data Subpacket Notation Flags</a>
            </h5>
<p id="section-10.2.3.2-1">This specification creates a new registry of Signature Notation Data
Subpacket Notation Flags.  The registry includes the columns "Flag",
"Description", "Security Recommended", "Interoperability Recommended",
and "Reference".  The initial values for this registry can be found in
<a href="#notation-data">Section 5.2.3.17</a>.  Adding a new item MUST be done through the
SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.3.2-1">¶</a></p>
</section>
</div>
<div id="key-server-preference-extensions">
<section id="section-10.2.3.3">
            <h5 id="name-key-server-preference-exten">
<a href="#section-10.2.3.3">10.2.3.3. </a><a href="#name-key-server-preference-exten">Key Server Preference Extensions</a>
            </h5>
<p id="section-10.2.3.3-1">OpenPGP signatures contain a mechanism for preferences to be specified
about key servers.  This specification creates a registry of key server
preferences.  The registry includes the key server preference, the name
of the preference, and a reference to the defining specification.  The
initial values for this registry can be found in <a href="#key-server-preferences">Section 5.2.3.18</a>.
Adding a new key server preference MUST be done through the
SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.3.3-1">¶</a></p>
</section>
</div>
<div id="key-flags-extensions">
<section id="section-10.2.3.4">
            <h5 id="name-key-flags-extensions">
<a href="#section-10.2.3.4">10.2.3.4. </a><a href="#name-key-flags-extensions">Key Flags Extensions</a>
            </h5>
<p id="section-10.2.3.4-1">OpenPGP signatures contain a mechanism for flags to be specified about
key usage.  This specification creates a registry of key usage
flags.  The registry includes the key flags value, the name of the
flag, and a reference to the defining specification.  The initial
values for this registry can be found in <a href="#key-flags">Section 5.2.3.22</a>.  Adding a
new key usage flag MUST be done through the SPECIFICATION REQUIRED
method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.3.4-1">¶</a></p>
</section>
</div>
<div id="reason-for-revocation-extensions">
<section id="section-10.2.3.5">
            <h5 id="name-reason-for-revocation-exten">
<a href="#section-10.2.3.5">10.2.3.5. </a><a href="#name-reason-for-revocation-exten">Reason for Revocation Extensions</a>
            </h5>
<p id="section-10.2.3.5-1">OpenPGP signatures contain a mechanism for flags to be specified about
why a key was revoked.  This specification creates a registry of
"Reason for Revocation" flags.  The registry includes the "Reason for
Revocation" flags value, the name of the flag, and a reference to the
defining specification.  The initial values for this registry can be
found in <a href="#reason-for-revocation">Section 5.2.3.24</a>.  Adding a new feature flag MUST be done
through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.3.5-1">¶</a></p>
</section>
</div>
<div id="implementation-features">
<section id="section-10.2.3.6">
            <h5 id="name-implementation-features">
<a href="#section-10.2.3.6">10.2.3.6. </a><a href="#name-implementation-features">Implementation Features</a>
            </h5>
<p id="section-10.2.3.6-1">OpenPGP signatures contain a mechanism for flags to be specified
stating which optional features an implementation supports.  This
specification creates a registry of feature-implementation flags.  The
registry includes the feature-implementation flags value, the name of
the flag, and a reference to the defining specification.  The initial
values for this registry can be found in <a href="#features">Section 5.2.3.25</a>.  Adding a
new feature-implementation flag MUST be done through the SPECIFICATION
REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.3.6-1">¶</a></p>
<p id="section-10.2.3.6-2">Also see <a href="#meta-considerations-for-expansion">Section 14.12</a> for more information
about when feature flags are needed.<a href="#section-10.2.3.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="new-packet-versions">
<section id="section-10.2.4">
          <h4 id="name-new-packet-versions">
<a href="#section-10.2.4">10.2.4. </a><a href="#name-new-packet-versions">New Packet Versions</a>
          </h4>
<p id="section-10.2.4-1">The core OpenPGP packets all have version numbers, and can be revised
by introducing a new version of an existing packet.  This
specification creates a registry of packet types.  The registry
includes the packet type, the number of the version, and a reference
to the defining specification.  The initial values for this registry
can be found in <a href="#packet-types">Section 5</a>.  Adding a new packet version MUST
be done through the RFC REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.2.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="new-algorithms">
<section id="section-10.3">
        <h3 id="name-new-algorithms">
<a href="#section-10.3">10.3. </a><a href="#name-new-algorithms">New Algorithms</a>
        </h3>
<p id="section-10.3-1"><a href="#constants">Section 9</a> lists the core algorithms that OpenPGP uses.  Adding in a new
algorithm is usually simple.  For example, adding in a new symmetric
cipher usually would not need anything more than allocating a constant
for that cipher.  If that cipher had other than a 64-bit or 128-bit
block size, there might need to be additional documentation describing
how OpenPGP-CFB mode would be adjusted.  Similarly, when DSA was
expanded from a maximum of 1024-bit public keys to 3072-bit public
keys, the revision of FIPS 186 contained enough information itself to
allow implementation.  Changes to this document were made mainly for
emphasis.<a href="#section-10.3-1">¶</a></p>
<div id="public-key-algorithms-1">
<section id="section-10.3.1">
          <h4 id="name-public-key-algorithms-2">
<a href="#section-10.3.1">10.3.1. </a><a href="#name-public-key-algorithms-2">Public-Key Algorithms</a>
          </h4>
<p id="section-10.3.1-1">OpenPGP specifies a number of public-key algorithms.  This
specification creates a registry of public-key algorithm
identifiers.  The registry includes the algorithm name, its key sizes
and parameters, and a reference to the defining specification.  The
initial values for this registry can be found in <a href="#public-key-algorithms">Section 9.1</a>.
Adding a new public-key algorithm MUST be done through the
SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.3.1-1">¶</a></p>
<p id="section-10.3.1-2">This document requests IANA register the following new public-key algorithm:<a href="#section-10.3.1-2">¶</a></p>
<table id="table-14">
            <caption><a href="#table-14">Table 14</a></caption>
<thead>
              <tr>
                <th rowspan="1" colspan="1">ID</th>
                <th rowspan="1" colspan="1">Algorithm</th>
                <th rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">22</td>
                <td rowspan="1" colspan="1">EdDSA public key algorithm</td>
                <td rowspan="1" colspan="1">This doc, <a href="#eddsa">Section 14.8</a>
</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">23</td>
                <td rowspan="1" colspan="1">Reserved for AEDH</td>
                <td rowspan="1" colspan="1">This doc</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">24</td>
                <td rowspan="1" colspan="1">Reserved for AEDSA</td>
                <td rowspan="1" colspan="1">This doc</td>
              </tr>
            </tbody>
          </table>
<p id="section-10.3.1-4">[Notes to RFC-Editor: Please remove the table above on publication.
    It is desirable not to reuse old or reserved algorithms because
    some existing tools might print a wrong description.  A higher
    number is also an indication for a newer algorithm.  As of now
    22 is the next free number.]<a href="#section-10.3.1-4">¶</a></p>
</section>
</div>
<div id="symmetric-key-algorithms-1">
<section id="section-10.3.2">
          <h4 id="name-symmetric-key-algorithms-2">
<a href="#section-10.3.2">10.3.2. </a><a href="#name-symmetric-key-algorithms-2">Symmetric-Key Algorithms</a>
          </h4>
<p id="section-10.3.2-1">OpenPGP specifies a number of symmetric-key algorithms.  This
specification creates a registry of symmetric-key algorithm
identifiers.  The registry includes the algorithm name, its key sizes
and block size, and a reference to the defining specification.  The
initial values for this registry can be found in <a href="#symmetric-key-algorithms">Section 9.3</a>.
Adding a new symmetric-key algorithm MUST be done through the
SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.3.2-1">¶</a></p>
</section>
</div>
<div id="hash-algorithms-1">
<section id="section-10.3.3">
          <h4 id="name-hash-algorithms-2">
<a href="#section-10.3.3">10.3.3. </a><a href="#name-hash-algorithms-2">Hash Algorithms</a>
          </h4>
<p id="section-10.3.3-1">OpenPGP specifies a number of hash algorithms.  This specification
creates a registry of hash algorithm identifiers.  The registry
includes the algorithm name, a text representation of that name, its
block size, an OID hash prefix, and a reference to the defining
specification.  The initial values for this registry can be found in
<a href="#hash-algorithms">Section 9.5</a> for the algorithm identifiers and text names, and
<a href="#ecc-curve-oid">Section 9.2</a> for the OIDs and expanded signature prefixes.  Adding a
new hash algorithm MUST be done through the SPECIFICATION REQUIRED
method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.3.3-1">¶</a></p>
<p id="section-10.3.3-2">This document requests IANA register the following hash algorithms:<a href="#section-10.3.3-2">¶</a></p>
<table id="table-15">
            <caption><a href="#table-15">Table 15</a></caption>
<thead>
              <tr>
                <th rowspan="1" colspan="1">ID</th>
                <th rowspan="1" colspan="1">Algorithm</th>
                <th rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">12</td>
                <td rowspan="1" colspan="1">SHA3-256</td>
                <td rowspan="1" colspan="1">This doc</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">13</td>
                <td rowspan="1" colspan="1">Reserved</td>
                <td rowspan="1" colspan="1">&nbsp;</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">14</td>
                <td rowspan="1" colspan="1">SHA3-512</td>
                <td rowspan="1" colspan="1">This doc</td>
              </tr>
            </tbody>
          </table>
<p id="section-10.3.3-4">[Notes to RFC-Editor: Please remove the table above on publication.
    It is desirable not to reuse old or reserved algorithms because
    some existing tools might print a wrong description.  The ID 13
    has been reserved so that the SHA3 algorithm IDs align nicely with
    their SHA2 counterparts.]<a href="#section-10.3.3-4">¶</a></p>
</section>
</div>
<div id="compression-algorithms-1">
<section id="section-10.3.4">
          <h4 id="name-compression-algorithms-2">
<a href="#section-10.3.4">10.3.4. </a><a href="#name-compression-algorithms-2">Compression Algorithms</a>
          </h4>
<p id="section-10.3.4-1">OpenPGP specifies a number of compression algorithms.  This
specification creates a registry of compression algorithm
identifiers.  The registry includes the algorithm name and a reference
to the defining specification.  The initial values for this registry
can be found in <a href="#compression-algorithms">Section 9.4</a>.
 Adding a new compression key algorithm MUST be done through the
SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-10.3.4-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="packet-composition">
<section id="section-11">
      <h2 id="name-packet-composition">
<a href="#section-11">11. </a><a href="#name-packet-composition">Packet Composition</a>
      </h2>
<p id="section-11-1">OpenPGP packets are assembled into sequences in order to create
messages and to transfer keys.  Not all possible packet sequences are
meaningful and correct.  This section describes the rules for how
packets should be placed into sequences.<a href="#section-11-1">¶</a></p>
<div id="transferable-public-keys">
<section id="section-11.1">
        <h3 id="name-transferable-public-keys">
<a href="#section-11.1">11.1. </a><a href="#name-transferable-public-keys">Transferable Public Keys</a>
        </h3>
<p id="section-11.1-1">OpenPGP users may transfer public keys.  The essential elements of a
transferable public key are as follows:<a href="#section-11.1-1">¶</a></p>
<ul>
<li id="section-11.1-2.1">One Public-Key packet<a href="#section-11.1-2.1">¶</a>
</li>
<li id="section-11.1-2.2">Zero or more revocation signatures<a href="#section-11.1-2.2">¶</a>
</li>
<li id="section-11.1-2.3">Zero or more User ID packets<a href="#section-11.1-2.3">¶</a>
</li>
<li id="section-11.1-2.4">After each User ID packet, zero or more Signature packets
(certifications and attestation key signatures)<a href="#section-11.1-2.4">¶</a>
</li>
<li id="section-11.1-2.5">Zero or more User Attribute packets<a href="#section-11.1-2.5">¶</a>
</li>
<li id="section-11.1-2.6">After each User Attribute packet, zero or more Signature packets
(certifications and attestation key signatures)<a href="#section-11.1-2.6">¶</a>
</li>
<li id="section-11.1-2.7">Zero or more Subkey packets<a href="#section-11.1-2.7">¶</a>
</li>
<li id="section-11.1-2.8">After each Subkey packet, one Signature packet, plus optionally a
revocation<a href="#section-11.1-2.8">¶</a>
</li>
</ul>
<p id="section-11.1-3">The Public-Key packet occurs first.  Each of the following User ID
packets provides the identity of the owner of this public key.  If
there are multiple User ID packets, this corresponds to multiple means
of identifying the same unique individual user; for example, a user
may have more than one email address, and construct a User ID for each
one.<a href="#section-11.1-3">¶</a></p>
<p id="section-11.1-4">Immediately following each User ID packet, there are zero or more
Signature packets.  Each Signature packet is calculated on the
immediately preceding User ID packet and the initial Public-Key
packet.  The signature serves to certify the corresponding public key
and User ID.  In effect, the signer is testifying to his or her belief
that this public key belongs to the user identified by this User ID.
Intermixed with these certifications may be Attestation Key Signature
packets issued by the primary key over the same User ID and Public Key
packet. The most recent of these is used to attest to third-party
certifications over the associated User ID.<a href="#section-11.1-4">¶</a></p>
<p id="section-11.1-5">Within the same section as the User ID packets, there are zero or more
User Attribute packets.  Like the User ID packets, a User Attribute
packet is followed by zero or more Signature packets calculated on the
immediately preceding User Attribute packet and the initial Public-Key
packet.<a href="#section-11.1-5">¶</a></p>
<p id="section-11.1-6">User Attribute packets and User ID packets may be freely intermixed in
this section, so long as the signatures that follow them are
maintained on the proper User Attribute or User ID packet.<a href="#section-11.1-6">¶</a></p>
<p id="section-11.1-7">After the User ID packet or Attribute packet, there may be zero or
more Subkey packets.  In general, subkeys are provided in cases where
the top-level public key is a signature-only key.  However, any V4 or
V5 key may have subkeys, and the subkeys may be encryption-only keys,
signature-only keys, or general-purpose keys. V3 keys MUST NOT have
subkeys.<a href="#section-11.1-7">¶</a></p>
<p id="section-11.1-8">Each Subkey packet MUST be followed by one Signature packet, which
should be a subkey binding signature issued by the top-level key.  For
subkeys that can issue signatures, the subkey binding signature MUST
contain an Embedded Signature subpacket with a primary key binding
signature (0x19) issued by the subkey on the top-level key.<a href="#section-11.1-8">¶</a></p>
<p id="section-11.1-9">Subkey and Key packets may each be followed by a revocation Signature
packet to indicate that the key is revoked.  Revocation signatures are
only accepted if they are issued by the key itself, or by a key that
is authorized to issue revocations via a Revocation Key subpacket in a
self-signature by the top-level key.<a href="#section-11.1-9">¶</a></p>
<p id="section-11.1-10">Transferable public-key packet sequences may be concatenated to allow
transferring multiple public keys in one operation.<a href="#section-11.1-10">¶</a></p>
</section>
</div>
<div id="transferable-secret-keys">
<section id="section-11.2">
        <h3 id="name-transferable-secret-keys">
<a href="#section-11.2">11.2. </a><a href="#name-transferable-secret-keys">Transferable Secret Keys</a>
        </h3>
<p id="section-11.2-1">OpenPGP users may transfer secret keys.  The format of a transferable
secret key is the same as a transferable public key except that
secret-key and secret-subkey packets are used instead of the public
key and public-subkey packets.  Implementations SHOULD include self-
signatures on any user IDs and subkeys, as this allows for a complete
public key to be automatically extracted from the transferable secret
key.  Implementations MAY choose to omit the self-signatures,
especially if a transferable public key accompanies the transferable
secret key.<a href="#section-11.2-1">¶</a></p>
</section>
</div>
<div id="openpgp-messages">
<section id="section-11.3">
        <h3 id="name-openpgp-messages">
<a href="#section-11.3">11.3. </a><a href="#name-openpgp-messages">OpenPGP Messages</a>
        </h3>
<p id="section-11.3-1">An OpenPGP message is a packet or sequence of packets that corresponds
to the following grammatical rules (comma represents sequential
composition, and vertical bar separates alternatives):<a href="#section-11.3-1">¶</a></p>
<div id="section-11.3-2">
<pre>OpenPGP Message :- Encrypted Message | Signed Message |
                   Compressed Message | Literal Message.

Compressed Message :- Compressed Data Packet.

Literal Message :- Literal Data Packet.

ESK :- Public-Key Encrypted Session Key Packet |
       Symmetric-Key Encrypted Session Key Packet.

ESK Sequence :- ESK | ESK Sequence, ESK.

Encrypted Data :- Symmetrically Encrypted Data Packet |
    Symmetrically Encrypted Integrity Protected Data Packet

Encrypted Message :- Encrypted Data | ESK Sequence, Encrypted Data.

One-Pass Signed Message :- One-Pass Signature Packet,
            OpenPGP Message, Corresponding Signature Packet.

Signed Message :- Signature Packet, OpenPGP Message |
                  One-Pass Signed Message.
</pre><p><a href="#section-11.3-2">¶</a>
</p></div>
<p id="section-11.3-3">In addition, decrypting a Symmetrically Encrypted Data packet or a
Symmetrically Encrypted Integrity Protected Data packet as well as
decompressing a Compressed Data packet must yield a valid OpenPGP
Message.<a href="#section-11.3-3">¶</a></p>
</section>
</div>
<div id="detached-signatures">
<section id="section-11.4">
        <h3 id="name-detached-signatures">
<a href="#section-11.4">11.4. </a><a href="#name-detached-signatures">Detached Signatures</a>
        </h3>
<p id="section-11.4-1">Some OpenPGP applications use so-called "detached signatures".  For
example, a program bundle may contain a file, and with it a second
file that is a detached signature of the first file.  These detached
signatures are simply a Signature packet stored separately from the
data for which they are a signature.<a href="#section-11.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="enhanced-key-formats">
<section id="section-12">
      <h2 id="name-enhanced-key-formats">
<a href="#section-12">12. </a><a href="#name-enhanced-key-formats">Enhanced Key Formats</a>
      </h2>
<div id="key-structures">
<section id="section-12.1">
        <h3 id="name-key-structures">
<a href="#section-12.1">12.1. </a><a href="#name-key-structures">Key Structures</a>
        </h3>
<p id="section-12.1-1">The format of an OpenPGP V3 key is as follows.  Entries in square
brackets are optional and ellipses indicate repetition.<a href="#section-12.1-1">¶</a></p>
<div id="section-12.1-2">
<pre>RSA Public Key
   [Revocation Self Signature]
    User ID [Signature ...]
   [User ID [Signature ...] ...]
</pre><p><a href="#section-12.1-2">¶</a>
</p></div>
<p id="section-12.1-3">Each signature certifies the RSA public key and the preceding User ID.
The RSA public key can have many User IDs and each User ID can have
many signatures. V3 keys are deprecated.  Implementations MUST NOT
generate new V3 keys, but MAY continue to use existing ones.<a href="#section-12.1-3">¶</a></p>
<p id="section-12.1-4">The format of an OpenPGP V4 key that uses multiple public keys is
similar except that the other keys are added to the end as "subkeys"
of the primary key.<a href="#section-12.1-4">¶</a></p>
<div id="section-12.1-5">
<pre>Primary-Key
   [Revocation Self Signature]
   [Direct Key Signature...]
   [User ID [Signature ...] ...]
   [User Attribute [Signature ...] ...]
   [[Subkey [Binding-Signature-Revocation]
           Primary-Key-Binding-Signature] ...]
</pre><p><a href="#section-12.1-5">¶</a>
</p></div>
<p id="section-12.1-6">A subkey always has a single signature after it that is issued using
the primary key to tie the two keys together.  This binding signature
may be in either V3 or V4 format, but SHOULD be V4.  Subkeys that can
issue signatures MUST have a V4 binding signature due to the REQUIRED
embedded primary key binding signature.<a href="#section-12.1-6">¶</a></p>
<p id="section-12.1-7">In the above diagram, if the binding signature of a subkey has been
revoked, the revoked key may be removed, leaving only one key.<a href="#section-12.1-7">¶</a></p>
<p id="section-12.1-8">In a V4 key, the primary key SHOULD be a key capable of
certification.  There are cases, such as device certificates, where
the primary key may not be capable of certification. A primary key
capable of making signatures SHOULD be accompanied by either a
certification signature (on a User ID or User Attribute) or a
signature directly on the key.<a href="#section-12.1-8">¶</a></p>
<p id="section-12.1-9">Implementations SHOULD accept encryption-only primary keys without a
signature.  It also SHOULD allow importing any key accompanied either by
a certification signature or a signature on itself.  It MAY accept
signature-capable primary keys without an accompanying signature.<a href="#section-12.1-9">¶</a></p>
<p id="section-12.1-10">The subkeys may be keys of any other type.  There may be
other constructions of V4 keys, too.  For example, there may be a
single-key RSA key in V4 format, a DSA primary key with an RSA
encryption key, or RSA primary key with an Elgamal subkey, etc.<a href="#section-12.1-10">¶</a></p>
<p id="section-12.1-11">It is also possible to have a signature-only subkey.  This permits a
primary key that collects certifications (key signatures), but is used
only for certifying subkeys that are used for encryption and
signatures.<a href="#section-12.1-11">¶</a></p>
</section>
</div>
<div id="key-ids-and-fingerprints">
<section id="section-12.2">
        <h3 id="name-key-ids-and-fingerprints">
<a href="#section-12.2">12.2. </a><a href="#name-key-ids-and-fingerprints">Key IDs and Fingerprints</a>
        </h3>
<p id="section-12.2-1">For a V3 key, the eight-octet Key ID consists of the low 64 bits of
the public modulus of the RSA key.<a href="#section-12.2-1">¶</a></p>
<p id="section-12.2-2">The fingerprint of a V3 key is formed by hashing the body (but not the
two-octet length) of the MPIs that form the key material (public
modulus n, followed by exponent e) with MD5.  Note that both V3 keys
and MD5 are deprecated.<a href="#section-12.2-2">¶</a></p>
<p id="section-12.2-3">A V4 fingerprint is the 160-bit SHA-1 hash of the octet 0x99, followed
by the two-octet packet length, followed by the entire Public-Key
packet starting with the version field.  The Key ID is the low-order 64
bits of the fingerprint.  Here are the fields of the hash material,
with the example of a DSA key:<a href="#section-12.2-3">¶</a></p>
<div id="section-12.2-4">
<pre>a.1) 0x99 (1 octet)

a.2) two-octet scalar octet count of (b)-(e)

b) version number = 4 (1 octet);

c) timestamp of key creation (4 octets);

d) algorithm (1 octet): 17 = DSA (example);

e) Algorithm-specific fields.

Algorithm-Specific Fields for DSA keys (example):

e.1) MPI of DSA prime p;

e.2) MPI of DSA group order q (q is a prime divisor of p-1);

e.3) MPI of DSA group generator g;

e.4) MPI of DSA public-key value y (= g**x mod p where x is secret).
</pre><p><a href="#section-12.2-4">¶</a>
</p></div>
<p id="section-12.2-5">A V5 fingerprint is the 256-bit SHA2-256 hash of the octet 0x9A, followed
by the four-octet packet length, followed by the entire Public-Key
packet starting with the version field.  The Key ID is the high-order 64
bits of the fingerprint.  Here are the fields of the hash material,
with the example of a DSA key:<a href="#section-12.2-5">¶</a></p>
<div id="section-12.2-6">
<pre>a.1) 0x9A (1 octet)

a.2) four-octet scalar octet count of (b)-(f)

b) version number = 5 (1 octet);

c) timestamp of key creation (4 octets);

d) algorithm (1 octet): 17 = DSA (example);

e) four-octet scalar octet count for the following key material;

f) algorithm-specific fields.

Algorithm-Specific Fields for DSA keys (example):

f.1) MPI of DSA prime p;

f.2) MPI of DSA group order q (q is a prime divisor of p-1);

f.3) MPI of DSA group generator g;

f.4) MPI of DSA public-key value y (= g**x mod p where x is secret).
</pre><p><a href="#section-12.2-6">¶</a>
</p></div>
<p id="section-12.2-7">Note that it is possible for there to be collisions of Key IDs -- two
different keys with the same Key ID.  Note that there is a much
smaller, but still non-zero, probability that two different keys have
the same fingerprint.<a href="#section-12.2-7">¶</a></p>
<p id="section-12.2-8">Also note that if V3, V4, and V5 format keys share the same RSA key
material, they will have different Key IDs as well as different
fingerprints.<a href="#section-12.2-8">¶</a></p>
<p id="section-12.2-9">Finally, the Key ID and fingerprint of a subkey are calculated in the
same way as for a primary key, including the 0x99 (V3 and V4 key) or
0x9A (V5 key) as the first octet (even though this is not a valid
packet ID for a public subkey).<a href="#section-12.2-9">¶</a></p>
</section>
</div>
</section>
</div>
<div id="elliptic-curve-cryptography">
<section id="section-13">
      <h2 id="name-elliptic-curve-cryptography">
<a href="#section-13">13. </a><a href="#name-elliptic-curve-cryptography">Elliptic Curve Cryptography</a>
      </h2>
<p id="section-13-1">This section descripes algorithms and parameters used with Elliptic
Curve Cryptography (ECC) keys.  A thorough introduction to ECC can be
found in <span>[<a href="#KOBLITZ">KOBLITZ</a>]</span>.<a href="#section-13-1">¶</a></p>
<div id="supported-ecc-curves">
<section id="section-13.1">
        <h3 id="name-supported-ecc-curves">
<a href="#section-13.1">13.1. </a><a href="#name-supported-ecc-curves">Supported ECC Curves</a>
        </h3>
<p id="section-13.1-1">This document references five named prime field curves, defined in
<span>[<a href="#FIPS186">FIPS186</a>]</span> as "Curve P-256", "Curve P-384", and "Curve P-521"; and
defined in <span>[<a href="#RFC5639">RFC5639</a>]</span> as "brainpoolP256r1", and "brainpoolP512r1".
Further curve "Curve25519", defined in <span>[<a href="#RFC7748">RFC7748</a>]</span> is referenced
for use with Ed25519 (EdDSA signing) and X25519 (encryption).<a href="#section-13.1-1">¶</a></p>
<p id="section-13.1-2">The named curves are referenced as a sequence of bytes in this
document, called throughout, curve OID.  <a href="#ecc-curve-oid">Section 9.2</a> describes
in detail how this sequence of bytes is formed.<a href="#section-13.1-2">¶</a></p>
</section>
</div>
<div id="ecdsa-and-ecdh-conversion-primitives">
<section id="section-13.2">
        <h3 id="name-ecdsa-and-ecdh-conversion-p">
<a href="#section-13.2">13.2. </a><a href="#name-ecdsa-and-ecdh-conversion-p">ECDSA and ECDH Conversion Primitives</a>
        </h3>
<p id="section-13.2-1">This document defines the uncompressed point format for ECDSA and ECDH
and a custom compression format for certain curves. The point is
encoded in the Multiprecision Integer (MPI) format.<a href="#section-13.2-1">¶</a></p>
<p id="section-13.2-2">For an uncompressed point the content of the MPI is:<a href="#section-13.2-2">¶</a></p>

<p id="section-13.2-4">where x and y are coordinates of the point P = (x, y), each encoded in
the big-endian format and zero-padded to the adjusted underlying field
size.  The adjusted underlying field size is the underlying field size
that is rounded up to the nearest 8-bit boundary.  This encoding is
compatible with the definition given in <span>[<a href="#SEC1">SEC1</a>]</span>.<a href="#section-13.2-4">¶</a></p>
<p id="section-13.2-5">For a custom compressed point the content of the MPI is:<a href="#section-13.2-5">¶</a></p>

<p id="section-13.2-7">where x is the x coordinate of the point P encoded to the rules
defined for the specified curve.  This format is used for ECDH keys
based on curves expressed in Montgomery form.<a href="#section-13.2-7">¶</a></p>
<p id="section-13.2-8">Therefore, the exact size of the MPI payload is 515 bits for "Curve
P-256", 771 for "Curve P-384", 1059 for "Curve P-521", and 263 for
Curve25519.<a href="#section-13.2-8">¶</a></p>
<p id="section-13.2-9">Even though the zero point, also called the point at infinity, may
occur as a result of arithmetic operations on points of an elliptic
curve, it SHALL NOT appear in data structures defined in this
document.<a href="#section-13.2-9">¶</a></p>
<p id="section-13.2-10">If other conversion methods are defined in the future, a compliant
application MUST NOT use a new format when in doubt that any recipient
can support it.  Consider, for example, that while both the public key
and the per-recipient ECDH data structure, respectively defined in
<a href="#algorithm-specific-part-for-ecdh-keys">Section 5.6.6</a> and
<a href="#public-key-encrypted-session-key-packets-tag-1">Section 5.1</a>, contain an
encoded point field, the format changes to the field in
<a href="#public-key-encrypted-session-key-packets-tag-1">Section 5.1</a> only affect a
given recipient of a given message.<a href="#section-13.2-10">¶</a></p>
</section>
</div>
<div id="eddsa-point-format">
<section id="section-13.3">
        <h3 id="name-eddsa-point-format">
<a href="#section-13.3">13.3. </a><a href="#name-eddsa-point-format">EdDSA Point Format</a>
        </h3>
<p id="section-13.3-1">The EdDSA algorithm defines a specific point compression format.  To
indicate the use of this compression format and to make sure that the
key can be represented in the Multiprecision Integer (MPI) format the
octet string specifying the point is prefixed with the octet 0x40.
This encoding is an extension of the encoding given in <span>[<a href="#SEC1">SEC1</a>]</span> which
uses 0x04 to indicate an uncompressed point.<a href="#section-13.3-1">¶</a></p>
<p id="section-13.3-2">For example, the length of a public key for the curve Ed25519 is 263
bit: 7 bit to represent the 0x40 prefix octet and 32 octets for the
native value of the public key.<a href="#section-13.3-2">¶</a></p>
</section>
</div>
<div id="key-derivation-function">
<section id="section-13.4">
        <h3 id="name-key-derivation-function">
<a href="#section-13.4">13.4. </a><a href="#name-key-derivation-function">Key Derivation Function</a>
        </h3>
<p id="section-13.4-1">A key derivation function (KDF) is necessary to implement the EC
encryption.  The Concatenation Key Derivation Function (Approved
Alternative 1) <span>[<a href="#SP800-56A">SP800-56A</a>]</span> with the KDF hash function that is
SHA2-256 <span>[<a href="#FIPS180">FIPS180</a>]</span> or stronger is REQUIRED.  See
<a href="#compatibility-profiles">Section 16</a> for the details regarding the choice of
the hash function.<a href="#section-13.4-1">¶</a></p>
<p id="section-13.4-2">For convenience, the synopsis of the encoding method is given below
with significant simplifications attributable to the restricted choice
of hash functions in this document.  However, <span>[<a href="#SP800-56A">SP800-56A</a>]</span> is the
normative source of the definition.<a href="#section-13.4-2">¶</a></p>
<div id="section-13.4-3">
<pre>//   Implements KDF( X, oBits, Param );
//   Input: point X = (x,y)
//   oBits - the desired size of output
//   hBits - the size of output of hash function Hash
//   Param - octets representing the parameters
//   Assumes that oBits &lt;= hBits
// Convert the point X to the octet string:
//   ZB' = 04 || x || y
// and extract the x portion from ZB'
ZB = x;
MB = Hash ( 00 || 00 || 00 || 01 || ZB || Param );
return oBits leftmost bits of MB.
</pre><p><a href="#section-13.4-3">¶</a>
</p></div>
<p id="section-13.4-4">Note that ZB in the KDF description above is the compact
representation of X, defined in Section 4.2 of <span>[<a href="#RFC6090">RFC6090</a>]</span>.<a href="#section-13.4-4">¶</a></p>
</section>
</div>
<div id="ec-dh-algorithm-ecdh">
<section id="section-13.5">
        <h3 id="name-ec-dh-algorithm-ecdh">
<a href="#section-13.5">13.5. </a><a href="#name-ec-dh-algorithm-ecdh">EC DH Algorithm (ECDH)</a>
        </h3>
<p id="section-13.5-1">The method is a combination of an ECC Diffie-Hellman method to
establish a shared secret, a key derivation method to process the
shared secret into a derived key, and a key wrapping method that uses
the derived key to protect a session key used to encrypt a message.<a href="#section-13.5-1">¶</a></p>
<p id="section-13.5-2">The One-Pass Diffie-Hellman method C(1, 1, ECC CDH) <span>[<a href="#SP800-56A">SP800-56A</a>]</span>
MUST be implemented with the following restrictions: the ECC CDH
primitive employed by this method is modified to always assume the
cofactor as 1, the KDF specified in <a href="#key-derivation-function">Section 13.4</a> is
used, and the KDF parameters specified below are used.<a href="#section-13.5-2">¶</a></p>
<p id="section-13.5-3">The KDF parameters are encoded as a concatenation of the following 5
variable-length and fixed-length fields, compatible with the
definition of the OtherInfo bitstring <span>[<a href="#SP800-56A">SP800-56A</a>]</span>:<a href="#section-13.5-3">¶</a></p>
<ul>
<li id="section-13.5-4.1">
            <p id="section-13.5-4.1.1">a variable-length field containing a curve OID, formatted as
follows:<a href="#section-13.5-4.1.1">¶</a></p>
<ul>
<li id="section-13.5-4.1.2.1">a one-octet size of the following field<a href="#section-13.5-4.1.2.1">¶</a>
</li>
<li id="section-13.5-4.1.2.2">the octets representing a curve OID, defined in <a href="#ecc-curve-oid">Section 9.2</a><a href="#section-13.5-4.1.2.2">¶</a>
</li>
</ul>
</li>
<li id="section-13.5-4.2">a one-octet public key algorithm ID defined in <a href="#public-key-algorithms">Section 9.1</a><a href="#section-13.5-4.2">¶</a>
</li>
<li id="section-13.5-4.3">
            <p id="section-13.5-4.3.1">a variable-length field containing KDF parameters, identical to
the corresponding field in the ECDH public key, formatted as
follows:<a href="#section-13.5-4.3.1">¶</a></p>
<ul>
<li id="section-13.5-4.3.2.1">a one-octet size of the following fields; values 0 and 0xff
are reserved for future extensions<a href="#section-13.5-4.3.2.1">¶</a>
</li>
<li id="section-13.5-4.3.2.2">a one-octet value 01, reserved for future extensions<a href="#section-13.5-4.3.2.2">¶</a>
</li>
<li id="section-13.5-4.3.2.3">a one-octet hash function ID used with the KDF<a href="#section-13.5-4.3.2.3">¶</a>
</li>
<li id="section-13.5-4.3.2.4">a one-octet algorithm ID for the symmetric algorithm used to
wrap the symmetric key for message encryption; see
<a href="#ec-dh-algorithm-ecdh">Section 13.5</a> for details<a href="#section-13.5-4.3.2.4">¶</a>
</li>
</ul>
</li>
<li id="section-13.5-4.4">20 octets representing the UTF-8 encoding of the string
"Anonymous Sender    ", which is the octet sequence
41 6E 6F 6E 79 6D 6F 75 73 20 53 65 6E 64 65 72 20 20 20 20<a href="#section-13.5-4.4">¶</a>
</li>
<li id="section-13.5-4.5">20 octets representing a recipient encryption subkey or a master
key fingerprint, identifying the key material that is needed for
the decryption.  For version 5 keys the 20 leftmost octets of the
fingerprint are used.<a href="#section-13.5-4.5">¶</a>
</li>
</ul>
<p id="section-13.5-5">The size of the KDF parameters sequence, defined above, is either 54
for the NIST curve P-256, 51 for the curves P-384 and P-521, or
56 for Curve25519.<a href="#section-13.5-5">¶</a></p>
<p id="section-13.5-6">The key wrapping method is described in <span>[<a href="#RFC3394">RFC3394</a>]</span>.  KDF produces a
symmetric key that is used as a key-encryption key (KEK) as specified
in <span>[<a href="#RFC3394">RFC3394</a>]</span>.  Refer to <a href="#security-considerations">Section 15</a> for the
details regarding the choice of the KEK algorithm, which SHOULD be one
of three AES algorithms.  Key wrapping and unwrapping is performed
with the default initial value of <span>[<a href="#RFC3394">RFC3394</a>]</span>.<a href="#section-13.5-6">¶</a></p>
<p id="section-13.5-7">The input to the key wrapping method is the value "m" derived from the
session key, as described in
<a href="#public-key-encrypted-session-key-packets-tag-1">Section 5.1</a>, "Public-Key
Encrypted Session Key Packets (Tag 1)", except that the PKCS #1.5
padding step is omitted.  The result is padded using the method
described in <span>[<a href="#PKCS5">PKCS5</a>]</span> to the 8-byte granularity.  For example, the
following AES-256 session key, in which 32 octets are denoted from k0
to k31, is composed to form the following 40 octet sequence:<a href="#section-13.5-7">¶</a></p>
<div id="section-13.5-8">
<pre>09 k0 k1 ... k31 c0 c1 05 05 05 05 05
</pre><p><a href="#section-13.5-8">¶</a>
</p></div>
<p id="section-13.5-9">The octets c0 and c1 above denote the checksum.  This encoding allows
the sender to obfuscate the size of the symmetric encryption key used
to encrypt the data.  For example, assuming that an AES algorithm is
used for the session key, the sender MAY use 21, 13, and 5 bytes of
padding for AES-128, AES-192, and AES-256, respectively, to provide
the same number of octets, 40 total, as an input to the key wrapping
method.<a href="#section-13.5-9">¶</a></p>
<p id="section-13.5-10">The output of the method consists of two fields.  The first field is
the MPI containing the ephemeral key used to establish the shared
secret.  The second field is composed of the following two fields:<a href="#section-13.5-10">¶</a></p>
<ul>
<li id="section-13.5-11.1">a one-octet encoding the size in octets of the result of the key
wrapping method; the value 255 is reserved for future extensions;<a href="#section-13.5-11.1">¶</a>
</li>
<li id="section-13.5-11.2">up to 254 octets representing the result of the key wrapping
method, applied to the 8-byte padded session key, as described
above.<a href="#section-13.5-11.2">¶</a>
</li>
</ul>
<p id="section-13.5-12">Note that for session key sizes 128, 192, and 256 bits, the size of
the result of the key wrapping method is, respectively, 32, 40, and 48
octets, unless the size obfuscation is used.<a href="#section-13.5-12">¶</a></p>
<p id="section-13.5-13">For convenience, the synopsis of the encoding method is given below;
however, this section, <span>[<a href="#SP800-56A">SP800-56A</a>]</span>, and <span>[<a href="#RFC3394">RFC3394</a>]</span> are the
normative sources of the definition.<a href="#section-13.5-13">¶</a></p>
<div id="section-13.5-14">
<pre>Obtain the authenticated recipient public key R
Generate an ephemeral key pair {v, V=vG}
Compute the shared point S = vR;
m = symm_alg_ID || session key || checksum || pkcs5_padding;
curve_OID_len = (byte)len(curve_OID);
Param = curve_OID_len || curve_OID || public_key_alg_ID || 03
|| 01 || KDF_hash_ID || KEK_alg_ID for AESKeyWrap || "Anonymous
Sender    " || recipient_fingerprint;
Z_len = the key size for the KEK_alg_ID used with AESKeyWrap
Compute Z = KDF( S, Z_len, Param );
Compute C = AESKeyWrap( Z, m ) as per [RFC3394]
VB = convert point V to the octet string
Output (MPI(VB) || len(C) || C).
</pre><p><a href="#section-13.5-14">¶</a>
</p></div>
<p id="section-13.5-15">The decryption is the inverse of the method given.  Note that the
recipient obtains the shared secret by calculating<a href="#section-13.5-15">¶</a></p>
<div id="section-13.5-16">
<pre>S = rV = rvG, where (r,R) is the recipient's key pair.
</pre><p><a href="#section-13.5-16">¶</a>
</p></div>
<p id="section-13.5-17">Consistent with <a href="#aead-encrypted-data-packet-tag-20">Section 5.16</a>, "AEAD
Encrypted Data Packet (Tag 20)" and
<a href="#sym-encrypted-integrity-protected-data-packet-tag-18">Section 5.14</a>,
"Sym. Encrypted Integrity Protected Data Packet (Tag 18)", AEAD
encryption or a Modification Detection Code (MDC) MUST be used anytime
the symmetric key is protected by ECDH.<a href="#section-13.5-17">¶</a></p>
</section>
</div>
</section>
</div>
<div id="notes-on-algorithms">
<section id="section-14">
      <h2 id="name-notes-on-algorithms">
<a href="#section-14">14. </a><a href="#name-notes-on-algorithms">Notes on Algorithms</a>
      </h2>
<div id="pkcs1-encoding-in-openpgp">
<section id="section-14.1">
        <h3 id="name-pkcs1-encoding-in-openpgp">
<a href="#section-14.1">14.1. </a><a href="#name-pkcs1-encoding-in-openpgp">PKCS#1 Encoding in OpenPGP</a>
        </h3>
<p id="section-14.1-1">This standard makes use of the PKCS#1 functions EME-PKCS1-v1_5 and
EMSA-PKCS1-v1_5.  However, the calling conventions of these functions
has changed in the past.  To avoid potential confusion and
interoperability problems, we are including local copies in this
document, adapted from those in PKCS#1 v2.1 <span>[<a href="#RFC3447">RFC3447</a>]</span>.  RFC 3447
should be treated as the ultimate authority on PKCS#1 for OpenPGP.
Nonetheless, we believe that there is value in having a self-
contained document that avoids problems in the future with needed
changes in the conventions.<a href="#section-14.1-1">¶</a></p>
<div id="eme-pkcs1-v15-encode">
<section id="section-14.1.1">
          <h4 id="name-eme-pkcs1-v1_5-encode">
<a href="#section-14.1.1">14.1.1. </a><a href="#name-eme-pkcs1-v1_5-encode">EME-PKCS1-v1_5-ENCODE</a>
          </h4>
<div id="section-14.1.1-1">
<pre>Input:

k = the length in octets of the key modulus.

M = message to be encoded, an octet string of length mLen,
    where mLen &lt;= k - 11.

Output:

EM = encoded message, an octet string of length k.

Error: "message too long".

 1. Length checking: If mLen &gt; k - 11, output "message too long"
    and stop.

 2. Generate an octet string PS of length k - mLen - 3 consisting
    of pseudo-randomly generated nonzero octets.  The length of PS
    will be at least eight octets.

 3. Concatenate PS, the message M, and other padding to form an
    encoded message EM of length k octets as

    EM = 0x00 || 0x02 || PS || 0x00 || M.

 4. Output EM.
</pre><p><a href="#section-14.1.1-1">¶</a>
</p></div>
</section>
</div>
<div id="eme-pkcs1-v15-decode">
<section id="section-14.1.2">
          <h4 id="name-eme-pkcs1-v1_5-decode">
<a href="#section-14.1.2">14.1.2. </a><a href="#name-eme-pkcs1-v1_5-decode">EME-PKCS1-v1_5-DECODE</a>
          </h4>
<div id="section-14.1.2-1">
<pre>Input:

EM = encoded message, an octet string

Output:

M = message, an octet string,

Error: "decryption error",
</pre><p><a href="#section-14.1.2-1">¶</a>
</p></div>
<p id="section-14.1.2-2">To decode an EME-PKCS1_v1_5 message, separate the encoded message EM
into an octet string PS consisting of nonzero octets and a message M
as follows<a href="#section-14.1.2-2">¶</a></p>
<div id="section-14.1.2-3">
<pre> EM = 0x00 || 0x02 || PS || 0x00 || M.
</pre><p><a href="#section-14.1.2-3">¶</a>
</p></div>
<p id="section-14.1.2-4">If the first octet of EM does not have hexadecimal value 0x00, if the
second octet of EM does not have hexadecimal value 0x02, if there is
no octet with hexadecimal value 0x00 to separate PS from M, or if the
length of PS is less than 8 octets, output "decryption error" and
stop.  See also the security note in <a href="#security-considerations">Section 15</a>
regarding differences in reporting between a decryption error and a
padding error.<a href="#section-14.1.2-4">¶</a></p>
</section>
</div>
<div id="emsa-pkcs1-v15">
<section id="section-14.1.3">
          <h4 id="name-emsa-pkcs1-v1_5">
<a href="#section-14.1.3">14.1.3. </a><a href="#name-emsa-pkcs1-v1_5">EMSA-PKCS1-v1_5</a>
          </h4>
<p id="section-14.1.3-1">This encoding method is deterministic and only has an encoding
operation.<a href="#section-14.1.3-1">¶</a></p>
<div id="section-14.1.3-2">
<pre>Option:

Hash - a hash function in which hLen denotes the length in octets
       of the hash function output.

Input:

M = message to be encoded.

emLen = intended length in octets of the encoded message, at least
     tLen + 11, where tLen is the octet length of the DER encoding
     T of a certain value computed during the encoding operation.

Output:

EM = encoded message, an octet string of length emLen.

Errors: "message too long";
        "intended encoded message length too short".
</pre><p><a href="#section-14.1.3-2">¶</a>
</p></div>
<p id="section-14.1.3-3">Steps:<a href="#section-14.1.3-3">¶</a></p>
<div id="section-14.1.3-4">
<pre> 1. Apply the hash function to the message M to produce a hash
    value H:

    H = Hash(M).

    If the hash function outputs "message too long," output
    "message too long" and stop.

 2. Using the list in Section {FIXREF} 5.2.2, "Version 2 Signature Packet
    Format", produce an ASN.1 DER value for the hash function
    used.  Let T be the full hash prefix from the list, and let
    tLen be the length in octets of T.

 3. If emLen &lt; tLen + 11, output "intended encoded message length
    too short" and stop.

 4. Generate an octet string PS consisting of emLen - tLen - 3
    octets with hexadecimal value 0xFF.  The length of PS will be
    at least 8 octets.

 5. Concatenate PS, the hash prefix T, and other padding to form
    the encoded message EM as

        EM = 0x00 || 0x01 || PS || 0x00 || T.

 6. Output EM.
</pre><p><a href="#section-14.1.3-4">¶</a>
</p></div>
</section>
</div>
</section>
</div>
<div id="symmetric-algorithm-preferences">
<section id="section-14.2">
        <h3 id="name-symmetric-algorithm-prefere">
<a href="#section-14.2">14.2. </a><a href="#name-symmetric-algorithm-prefere">Symmetric Algorithm Preferences</a>
        </h3>
<p id="section-14.2-1">The symmetric algorithm preference is an ordered list of algorithms
that the keyholder accepts.  Since it is found on a self-signature, it
is possible that a keyholder may have multiple, different
preferences.  For example, Alice may have AES-128 only specified for
"alice@work.com" but Camellia-256, Twofish, and AES-128 specified for
"alice@home.org".  Note that it is also possible for preferences to be
in a subkey's binding signature.<a href="#section-14.2-1">¶</a></p>
<p id="section-14.2-2">Since AES-128 is the MUST-implement algorithm, if it is not explicitly
in the list, it is tacitly at the end.  However, it is good form to
place it there explicitly.  Note also that if an implementation does
not implement the preference, then it is implicitly an AES-128-only
implementation.  Note further that implementations conforming to
previous versions of this standard (RFC-4880) have TripleDES as its
only MUST-implement algorithm.<a href="#section-14.2-2">¶</a></p>
<p id="section-14.2-3">An implementation MUST NOT use a symmetric algorithm that is not in
the recipient's preference list.  When encrypting to more than one
recipient, the implementation finds a suitable algorithm by taking the
intersection of the preferences of the recipients.  Note that the
MUST-implement algorithm, AES-128, ensures that the intersection is
not null.  The implementation may use any mechanism to pick an
algorithm in the intersection.<a href="#section-14.2-3">¶</a></p>
<p id="section-14.2-4">If an implementation can decrypt a message that a keyholder doesn't
have in their preferences, the implementation SHOULD decrypt the
message anyway, but MUST warn the keyholder that the protocol has been
violated.  For example, suppose that Alice, above, has software that
implements all algorithms in this specification.  Nonetheless, she
prefers subsets for work or home.  If she is sent a message encrypted
with IDEA, which is not in her preferences, the software warns her
that someone sent her an IDEA-encrypted message, but it would ideally
decrypt it anyway.<a href="#section-14.2-4">¶</a></p>
</section>
</div>
<div id="other-algorithm-preferences">
<section id="section-14.3">
        <h3 id="name-other-algorithm-preferences">
<a href="#section-14.3">14.3. </a><a href="#name-other-algorithm-preferences">Other Algorithm Preferences</a>
        </h3>
<p id="section-14.3-1">Other algorithm preferences work similarly to the symmetric algorithm
preference, in that they specify which algorithms the keyholder
accepts.  There are two interesting cases that other comments need to
be made about, though, the compression preferences and the hash
preferences.<a href="#section-14.3-1">¶</a></p>
<div id="compression-preferences">
<section id="section-14.3.1">
          <h4 id="name-compression-preferences">
<a href="#section-14.3.1">14.3.1. </a><a href="#name-compression-preferences">Compression Preferences</a>
          </h4>
<p id="section-14.3.1-1">Compression has been an integral part of PGP since its first days.
OpenPGP and all previous versions of PGP have offered compression.  In
this specification, the default is for messages to be compressed,
although an implementation is not required to do so.  Consequently, the
compression preference gives a way for a keyholder to request that
messages not be compressed, presumably because they are using a
minimal implementation that does not include
compression.  Additionally, this gives a keyholder a way to state that
it can support alternate algorithms.<a href="#section-14.3.1-1">¶</a></p>
<p id="section-14.3.1-2">Like the algorithm preferences, an implementation MUST NOT use an
algorithm that is not in the preference vector.  If the preferences are
not present, then they are assumed to be [ZIP(1), Uncompressed(0)].<a href="#section-14.3.1-2">¶</a></p>
<p id="section-14.3.1-3">Additionally, an implementation MUST implement this preference to the
degree of recognizing when to send an uncompressed message. A robust
implementation would satisfy this requirement by looking at the
recipient's preference and acting accordingly. A minimal
implementation can satisfy this requirement by never generating a
compressed message, since all implementations can handle messages that
have not been compressed.<a href="#section-14.3.1-3">¶</a></p>
</section>
</div>
<div id="hash-algorithm-preferences">
<section id="section-14.3.2">
          <h4 id="name-hash-algorithm-preferences">
<a href="#section-14.3.2">14.3.2. </a><a href="#name-hash-algorithm-preferences">Hash Algorithm Preferences</a>
          </h4>
<p id="section-14.3.2-1">Typically, the choice of a hash algorithm is something the signer
does, rather than the verifier, because a signer rarely knows who is
going to be verifying the signature.  This preference, though, allows a
protocol based upon digital signatures ease in negotiation.<a href="#section-14.3.2-1">¶</a></p>
<p id="section-14.3.2-2">Thus, if Alice is authenticating herself to Bob with a signature, it
makes sense for her to use a hash algorithm that Bob's software uses.
This preference allows Bob to state in his key which algorithms Alice
may use.<a href="#section-14.3.2-2">¶</a></p>
<p id="section-14.3.2-3">Since SHA2-256 is the MUST-implement hash algorithm, if it is not
explicitly in the list, it is tacitly at the end.  However, it is good
form to place it there explicitly.<a href="#section-14.3.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="plaintext">
<section id="section-14.4">
        <h3 id="name-plaintext">
<a href="#section-14.4">14.4. </a><a href="#name-plaintext">Plaintext</a>
        </h3>
<p id="section-14.4-1">Algorithm 0, "plaintext", may only be used to denote secret keys that
are stored in the clear.  Implementations MUST NOT use plaintext in
Symmetrically Encrypted Data packets; they must use Literal Data
packets to encode unencrypted or literal data.<a href="#section-14.4-1">¶</a></p>
</section>
</div>
<div id="rsa">
<section id="section-14.5">
        <h3 id="name-rsa">
<a href="#section-14.5">14.5. </a><a href="#name-rsa">RSA</a>
        </h3>
<p id="section-14.5-1">There are algorithm types for RSA Sign-Only, and RSA Encrypt-Only
keys.  These types are deprecated.  The "key flags" subpacket in a
signature is a much better way to express the same idea, and
generalizes it to all algorithms.  An implementation SHOULD NOT create
such a key, but MAY interpret it.<a href="#section-14.5-1">¶</a></p>
<p id="section-14.5-2">An implementation SHOULD NOT implement RSA keys of size less than 1024
bits.<a href="#section-14.5-2">¶</a></p>
</section>
</div>
<div id="dsa">
<section id="section-14.6">
        <h3 id="name-dsa">
<a href="#section-14.6">14.6. </a><a href="#name-dsa">DSA</a>
        </h3>
<p id="section-14.6-1">An implementation SHOULD NOT implement DSA keys of size less than 1024
bits.  It MUST NOT implement a DSA key with a q size of less than 160
bits.  DSA keys MUST also be a multiple of 64 bits, and the q size MUST
be a multiple of 8 bits.  The Digital Signature Standard (DSS)
<span>[<a href="#FIPS186">FIPS186</a>]</span> specifies that DSA be used in one of the following ways:<a href="#section-14.6-1">¶</a></p>
<ul>
<li id="section-14.6-2.1">1024-bit key, 160-bit q, SHA-1, SHA2-224, SHA2-256, SHA2-384, or
SHA2-512 hash<a href="#section-14.6-2.1">¶</a>
</li>
<li id="section-14.6-2.2">2048-bit key, 224-bit q, SHA2-224, SHA2-256, SHA2-384, or SHA2-512
hash<a href="#section-14.6-2.2">¶</a>
</li>
<li id="section-14.6-2.3">2048-bit key, 256-bit q, SHA2-256, SHA2-384, or SHA2-512 hash<a href="#section-14.6-2.3">¶</a>
</li>
<li id="section-14.6-2.4">3072-bit key, 256-bit q, SHA2-256, SHA2-384, or SHA2-512 hash<a href="#section-14.6-2.4">¶</a>
</li>
</ul>
<p id="section-14.6-3">The above key and q size pairs were chosen to best balance the
strength of the key with the strength of the hash.  Implementations
SHOULD use one of the above key and q size pairs when generating DSA
keys.  If DSS compliance is desired, one of the specified SHA hashes
must be used as well. <span>[<a href="#FIPS186">FIPS186</a>]</span> is the ultimate authority on DSS, and
should be consulted for all questions of DSS compliance.<a href="#section-14.6-3">¶</a></p>
<p id="section-14.6-4">Note that earlier versions of this standard only allowed a 160-bit q
with no truncation allowed, so earlier implementations may not be able
to handle signatures with a different q size or a truncated hash.<a href="#section-14.6-4">¶</a></p>
</section>
</div>
<div id="elgamal">
<section id="section-14.7">
        <h3 id="name-elgamal">
<a href="#section-14.7">14.7. </a><a href="#name-elgamal">Elgamal</a>
        </h3>
<p id="section-14.7-1">An implementation SHOULD NOT implement Elgamal keys of size less than
1024 bits.<a href="#section-14.7-1">¶</a></p>
</section>
</div>
<div id="eddsa">
<section id="section-14.8">
        <h3 id="name-eddsa">
<a href="#section-14.8">14.8. </a><a href="#name-eddsa">EdDSA</a>
        </h3>
<p id="section-14.8-1">Although the EdDSA algorithm allows arbitrary data as input, its use
with OpenPGP requires that a digest of the message is used as input
(pre-hashed).  See section <a href="#computing-signatures">Section 5.2.4</a>, "Computing
Signatures" for details.  Truncation of the resulting digest is never
applied; the resulting digest value is used verbatim as input to the
EdDSA algorithm.<a href="#section-14.8-1">¶</a></p>
</section>
</div>
<div id="reserved-algorithm-numbers">
<section id="section-14.9">
        <h3 id="name-reserved-algorithm-numbers">
<a href="#section-14.9">14.9. </a><a href="#name-reserved-algorithm-numbers">Reserved Algorithm Numbers</a>
        </h3>
<p id="section-14.9-1">A number of algorithm IDs have been reserved for algorithms that would
be useful to use in an OpenPGP implementation, yet there are issues
that prevent an implementer from actually implementing the
algorithm.  These are marked in <a href="#public-key-algorithms">Section 9.1</a>,
"Public-Key Algorithms", as "reserved for".<a href="#section-14.9-1">¶</a></p>
<p id="section-14.9-2">The reserved public-key algorithm X9.42 (21) does not have the
necessary parameters, parameter order, or semantics defined.  The same
is currently true for reserved public-key algorithms AEDH (23) and
AEDSA (24).<a href="#section-14.9-2">¶</a></p>
<p id="section-14.9-3">Previous versions of OpenPGP permitted Elgamal <span>[<a href="#ELGAMAL">ELGAMAL</a>]</span> signatures
with a public-key identifier of 20.  These are no longer permitted.  An
implementation MUST NOT generate such keys.  An implementation MUST NOT
generate Elgamal signatures.  See <span>[<a href="#BLEICHENBACHER">BLEICHENBACHER</a>]</span>.<a href="#section-14.9-3">¶</a></p>
</section>
</div>
<div id="openpgp-cfb-mode">
<section id="section-14.10">
        <h3 id="name-openpgp-cfb-mode">
<a href="#section-14.10">14.10. </a><a href="#name-openpgp-cfb-mode">OpenPGP CFB Mode</a>
        </h3>
<p id="section-14.10-1">OpenPGP does symmetric encryption using a variant of Cipher Feedback
mode (CFB mode).  This section describes the procedure it uses in
detail.  This mode is what is used for Symmetrically Encrypted Data
Packets; the mechanism used for encrypting secret-key material is
similar, and is described in the sections above.<a href="#section-14.10-1">¶</a></p>
<p id="section-14.10-2">In the description below, the value BS is the block size in octets of
the cipher.  Most ciphers have a block size of 8 octets.  The AES and
Twofish have a block size of 16 octets.  Also note that the description
below assumes that the IV and CFB arrays start with an index of 1
(unlike the C language, which assumes arrays start with a zero index).<a href="#section-14.10-2">¶</a></p>
<p id="section-14.10-3">OpenPGP CFB mode uses an initialization vector (IV) of all zeros, and
prefixes the plaintext with BS+2 octets of random data, such that
octets BS+1 and BS+2 match octets BS-1 and BS.  It does a CFB
resynchronization after encrypting those BS+2 octets.<a href="#section-14.10-3">¶</a></p>
<p id="section-14.10-4">Thus, for an algorithm that has a block size of 8 octets (64 bits),
the IV is 10 octets long and octets 7 and 8 of the IV are the same as
octets 9 and 10.  For an algorithm with a block size of 16 octets (128
bits), the IV is 18 octets long, and octets 17 and 18 replicate octets
15 and
16.  Those extra two octets are an easy check for a correct key.<a href="#section-14.10-4">¶</a></p>
<p id="section-14.10-5">Step by step, here is the procedure:<a href="#section-14.10-5">¶</a></p>
<ol start="1" type="1" id="section-14.10-6">
          <li id="section-14.10-6.1">The feedback register (FR) is set to the IV, which is all zeros.<a href="#section-14.10-6.1">¶</a>
</li>
<li id="section-14.10-6.2">FR is encrypted to produce FRE (FR Encrypted).  This is the
encryption of an all-zero value.<a href="#section-14.10-6.2">¶</a>
</li>
<li id="section-14.10-6.3">FRE is xored with the first BS octets of random data prefixed to
the plaintext to produce C[1] through C[BS], the first BS octets
of ciphertext.<a href="#section-14.10-6.3">¶</a>
</li>
<li id="section-14.10-6.4">FR is loaded with C[1] through C[BS].<a href="#section-14.10-6.4">¶</a>
</li>
<li id="section-14.10-6.5">FR is encrypted to produce FRE, the encryption of the first BS
octets of ciphertext.<a href="#section-14.10-6.5">¶</a>
</li>
<li id="section-14.10-6.6">The left two octets of FRE get xored with the next two octets of
data that were prefixed to the plaintext.  This produces C[BS+1]
and C[BS+2], the next two octets of ciphertext.<a href="#section-14.10-6.6">¶</a>
</li>
<li id="section-14.10-6.7">(The resynchronization step) FR is loaded with C[3] through
C[BS+2].<a href="#section-14.10-6.7">¶</a>
</li>
<li id="section-14.10-6.8">FRE is xored with the first BS octets of the given plaintext, now
that we have finished encrypting the BS+2 octets of prefixed data.
This produces C[BS+3] through C[BS+(BS+2)], the next BS octets of
ciphertext.<a href="#section-14.10-6.8">¶</a>
</li>
<li id="section-14.10-6.9">FR is encrypted to produce FRE.<a href="#section-14.10-6.9">¶</a>
</li>
<li id="section-14.10-6.10">FR is loaded with C[BS+3] to C[BS + (BS+2)] (which is C11-C18 for
an 8-octet block).<a href="#section-14.10-6.10">¶</a>
</li>
<li id="section-14.10-6.11">FR is encrypted to produce FRE.<a href="#section-14.10-6.11">¶</a>
</li>
<li id="section-14.10-6.12">FRE is xored with the next BS octets of plaintext, to produce the
next BS octets of ciphertext.  These are loaded into FR, and the
process is repeated until the plaintext is used up.<a href="#section-14.10-6.12">¶</a>
</li>
</ol>
</section>
</div>
<div id="private-or-experimental-parameters">
<section id="section-14.11">
        <h3 id="name-private-or-experimental-par">
<a href="#section-14.11">14.11. </a><a href="#name-private-or-experimental-par">Private or Experimental Parameters</a>
        </h3>
<p id="section-14.11-1">S2K specifiers, Signature subpacket types, user attribute types, image
format types, and algorithms described in <a href="#constants">Section 9</a> all reserve the
range 100 to 110 for private and experimental use.  Packet types
reserve the range 60 to 63 for private and experimental use.  These are
intentionally managed with the PRIVATE USE method, as described in
<span>[<a href="#RFC8126">RFC8126</a>]</span>.<a href="#section-14.11-1">¶</a></p>
<p id="section-14.11-2">However, implementations need to be careful with these and promote
them to full IANA-managed parameters when they grow beyond the
original, limited system.<a href="#section-14.11-2">¶</a></p>
</section>
</div>

</section>
</div>
<div id="security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15">15. </a><a href="#name-security-considerations">Security Considerations</a>
      </h2>
<ul>
<li id="section-15-1.1">As with any technology involving cryptography, you should check the
current literature to determine if any algorithms used here have
been found to be vulnerable to attack.<a href="#section-15-1.1">¶</a>
</li>
<li id="section-15-1.2">This specification uses Public-Key Cryptography technologies.  It is
assumed that the private key portion of a public-private key pair is
controlled and secured by the proper party or parties.<a href="#section-15-1.2">¶</a>
</li>
<li id="section-15-1.3">Certain operations in this specification involve the use of random
numbers.  An appropriate entropy source should be used to generate
these numbers (see <span>[<a href="#RFC4086">RFC4086</a>]</span>).<a href="#section-15-1.3">¶</a>
</li>
<li id="section-15-1.4">The MD5 hash algorithm has been found to have weaknesses, with
collisions found in a number of cases.  MD5 is deprecated for use in
OpenPGP.  Implementations MUST NOT generate new signatures using MD5
as a hash function.  They MAY continue to consider old signatures
that used MD5 as valid.<a href="#section-15-1.4">¶</a>
</li>
<li id="section-15-1.5">SHA2-224 and SHA2-384 require the same work as SHA2-256 and SHA2-512,
respectively.  In general, there are few reasons to use them outside
of DSS compatibility.  You need a situation where one needs more
security than smaller hashes, but does not want to have the full
256-bit or 512-bit data length.<a href="#section-15-1.5">¶</a>
</li>
<li id="section-15-1.6">Many security protocol designers think that it is a bad idea to use
a single key for both privacy (encryption) and integrity
(signatures).  In fact, this was one of the motivating forces behind
the V4 key format with separate signature and encryption keys.  If
you as an implementer promote dual-use keys, you should at least be
aware of this controversy.<a href="#section-15-1.6">¶</a>
</li>
<li id="section-15-1.7">The DSA algorithm will work with any hash, but is sensitive to the
quality of the hash algorithm.  Verifiers should be aware that even
if the signer used a strong hash, an attacker could have modified
the signature to use a weak one.  Only signatures using acceptably
strong hash algorithms should be accepted as valid.<a href="#section-15-1.7">¶</a>
</li>
<li id="section-15-1.8">As OpenPGP combines many different asymmetric, symmetric, and hash
algorithms, each with different measures of strength, care should be
taken that the weakest element of an OpenPGP message is still
sufficiently strong for the purpose at hand.  While consensus about
the strength of a given algorithm may evolve, NIST Special
Publication 800-57 <span>[<a href="#SP800-57">SP800-57</a>]</span> recommends the following list of
equivalent strengths:<a href="#section-15-1.8">¶</a>
</li>
</ul>
<table id="table-16">
        <caption><a href="#table-16">Table 16</a></caption>
<thead>
          <tr>
            <th rowspan="1" colspan="1">Asymmetric key size</th>
            <th rowspan="1" colspan="1">Hash size</th>
            <th rowspan="1" colspan="1">Symmetric key size</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">1024</td>
            <td rowspan="1" colspan="1">160</td>
            <td rowspan="1" colspan="1">80</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2048</td>
            <td rowspan="1" colspan="1">224</td>
            <td rowspan="1" colspan="1">112</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">3072</td>
            <td rowspan="1" colspan="1">256</td>
            <td rowspan="1" colspan="1">128</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">7680</td>
            <td rowspan="1" colspan="1">384</td>
            <td rowspan="1" colspan="1">192</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">15360</td>
            <td rowspan="1" colspan="1">512</td>
            <td rowspan="1" colspan="1">256</td>
          </tr>
        </tbody>
      </table>
<ul>
<li id="section-15-3.1">
          <p id="section-15-3.1.1">There is a somewhat-related potential security problem in
signatures.  If an attacker can find a message that hashes to the
same hash with a different algorithm, a bogus signature structure
can be constructed that evaluates correctly.<a href="#section-15-3.1.1">¶</a></p>
<p id="section-15-3.1.2">
For example, suppose Alice DSA signs message M using hash
algorithm H.  Suppose that Mallet finds a message M' that has the
same hash value as M with H'.  Mallet can then construct a
signature block that verifies as Alice's signature of M' with H'.
However, this would also constitute a weakness in either H or H'
or both.  Should this ever occur, a revision will have to be made
to this document to revise the allowed hash algorithms.<a href="#section-15-3.1.2">¶</a></p>
</li>
<li id="section-15-3.2">If you are building an authentication system, the recipient may
specify a preferred signing algorithm.  However, the signer would be
foolish to use a weak algorithm simply because the recipient
requests it.<a href="#section-15-3.2">¶</a>
</li>
<li id="section-15-3.3">Some of the encryption algorithms mentioned in this document have
been analyzed less than others.  For example, although CAST5 is
presently considered strong, it has been analyzed less than
TripleDES.  Other algorithms may have other controversies surrounding
them.<a href="#section-15-3.3">¶</a>
</li>
<li id="section-15-3.4">
          <p id="section-15-3.4.1">In late summer 2002, Jallad, Katz, and Schneier published an
interesting attack on the OpenPGP protocol and some of its
implementations <span>[<a href="#JKS02">JKS02</a>]</span>.  In this attack, the attacker modifies a
message and sends it to a user who then returns the erroneously
decrypted message to the attacker.  The attacker is thus using the
user as a random oracle, and can often decrypt the message.<a href="#section-15-3.4.1">¶</a></p>
<p id="section-15-3.4.2">
Compressing data can ameliorate this attack.  The incorrectly
decrypted data nearly always decompresses in ways that defeat the
attack.  However, this is not a rigorous fix, and leaves open some
small vulnerabilities.  For example, if an implementation does not
compress a message before encryption (perhaps because it knows it
was already compressed), then that message is vulnerable.  Because of
this happenstance -- that modification attacks can be thwarted by
decompression errors -- an implementation SHOULD treat a
decompression error as a security problem, not merely a data
problem.<a href="#section-15-3.4.2">¶</a></p>
<p id="section-15-3.4.3">
This attack can be defeated by the use of modification detection,
provided that the implementation does not let the user naively
return the data to the attacker.  The modification detection is
prefereabble implemented by using the AEAD Encrypted Data Packet
and only if the recipients don't supports this by use of the
Symmmetric Encrypted and Integrity Protected Data Packet.  An
implementation MUST treat an authentication or MDC failure as a
security problem, not merely a data problem.<a href="#section-15-3.4.3">¶</a></p>
<p id="section-15-3.4.4">
In either case, the implementation SHOULD NOT allow the user
access to the erroneous data, and MUST warn the user as to
potential security problems should that data be returned to the
sender.<a href="#section-15-3.4.4">¶</a></p>
<p id="section-15-3.4.5">
While this attack is somewhat obscure, requiring a special set of
circumstances to create it, it is nonetheless quite serious as it
permits someone to trick a user to decrypt a message.  Consequently,
it is important that:<a href="#section-15-3.4.5">¶</a></p>
<ol start="1" type="1" id="section-15-3.4.6">
            <li id="section-15-3.4.6.1">Implementers treat authentication errors, MDC errors,
decompression failures or no use of MDC or AEAD as security
problems.<a href="#section-15-3.4.6.1">¶</a>
</li>
<li id="section-15-3.4.6.2">Implementers implement AEAD with all due speed and encourage
its spread.<a href="#section-15-3.4.6.2">¶</a>
</li>
<li id="section-15-3.4.6.3">Users migrate to implementations that support AEAD
encryption with all due speed.<a href="#section-15-3.4.6.3">¶</a>
</li>
</ol>
</li>
<li id="section-15-3.5">PKCS#1 has been found to be vulnerable to attacks in which a system
that reports errors in padding differently from errors in decryption
becomes a random oracle that can leak the private key in mere
millions of queries.  Implementations must be aware of this attack
and prevent it from happening.  The simplest solution is to report a
single error code for all variants of decryption errors so as not to
leak information to an attacker.<a href="#section-15-3.5">¶</a>
</li>
<li id="section-15-3.6">Some technologies mentioned here may be subject to government
control in some countries.<a href="#section-15-3.6">¶</a>
</li>
<li id="section-15-3.7">
          <p id="section-15-3.7.1">In winter 2005, Serge Mister and Robert Zuccherato from Entrust
released a paper describing a way that the "quick check" in OpenPGP
CFB mode can be used with a random oracle to decrypt two octets of
every cipher block <span>[<a href="#MZ05">MZ05</a>]</span>.  They recommend as prevention not using
the quick check at all.<a href="#section-15-3.7.1">¶</a></p>
<p id="section-15-3.7.2">
Many implementers have taken this advice to heart for any data that
is symmetrically encrypted and for which the session key is
public-key encrypted.  In this case, the quick check is not needed as
the public-key encryption of the session key should guarantee that
it is the right session key.  In other cases, the implementation
should use the quick check with care.<a href="#section-15-3.7.2">¶</a></p>
<p id="section-15-3.7.3">
On the one hand, there is a danger to using it if there is a random
oracle that can leak information to an attacker.  In plainer
language, there is a danger to using the quick check if timing
information about the check can be exposed to an attacker,
particularly via an automated service that allows rapidly repeated
queries.<a href="#section-15-3.7.3">¶</a></p>
<p id="section-15-3.7.4">
On the other hand, it is inconvenient to the user to be informed
that they typed in the wrong passphrase only after a petabyte of
data is decrypted.  There are many cases in cryptographic engineering
where the implementer must use care and wisdom, and this is one.<a href="#section-15-3.7.4">¶</a></p>
</li>
<li id="section-15-3.8">Refer to <span>[<a href="#FIPS186">FIPS186</a>]</span>, B.4.1, for the method to generate a
uniformly distributed ECC private key.<a href="#section-15-3.8">¶</a>
</li>
<li id="section-15-3.9">
          <p id="section-15-3.9.1">The curves proposed in this document correspond to the symmetric
key sizes 128 bits, 192 bits, and 256 bits, as described in the
table below.  This allows a compliant application to offer
balanced public key security, which is compatible with the
symmetric key strength for each AES algorithm defined here.<a href="#section-15-3.9.1">¶</a></p>
<p id="section-15-3.9.2">
The following table defines the hash and the symmetric encryption
algorithm that SHOULD be used with a given curve for ECDSA or ECDH.
A stronger hash algorithm or a symmetric key algorithm MAY be used
for a given ECC curve.  However, note that the increase in the
strength of the hash algorithm or the symmetric key algorithm may
not increase the overall security offered by the given ECC key.<a href="#section-15-3.9.2">¶</a></p>
</li>
</ul>
<table id="table-17">
        <caption><a href="#table-17">Table 17</a></caption>
<thead>
          <tr>
            <th rowspan="1" colspan="1">Curve name</th>
            <th rowspan="1" colspan="1">ECC</th>
            <th rowspan="1" colspan="1">RSA strength</th>
            <th rowspan="1" colspan="1">Hash size strength, informative</th>
            <th rowspan="1" colspan="1">Symmetric key size</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">NIST P-256</td>
            <td rowspan="1" colspan="1">256</td>
            <td rowspan="1" colspan="1">3072</td>
            <td rowspan="1" colspan="1">256</td>
            <td rowspan="1" colspan="1">128</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NIST P-384</td>
            <td rowspan="1" colspan="1">384</td>
            <td rowspan="1" colspan="1">7680</td>
            <td rowspan="1" colspan="1">384</td>
            <td rowspan="1" colspan="1">192</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NIST P-521</td>
            <td rowspan="1" colspan="1">521</td>
            <td rowspan="1" colspan="1">15360</td>
            <td rowspan="1" colspan="1">512</td>
            <td rowspan="1" colspan="1">256</td>
          </tr>
        </tbody>
      </table>
<ul>
<li id="section-15-5.1">
          <p id="section-15-5.1.1">Requirement levels indicated elsewhere in this document lead to the
following combinations of algorithms in the OpenPGP profile: MUST
implement NIST curve P-256 / SHA2-256 / AES-128, SHOULD implement
NIST curve P-521 / SHA2-512 / AES-256, MAY implement NIST curve
P-384 / SHA2-384 / AES-256, among other allowed combinations.<a href="#section-15-5.1.1">¶</a></p>
<p id="section-15-5.1.2">
Consistent with the table above, the following table defines the KDF
hash algorithm and the AES KEK encryption algorithm that SHOULD be
used with a given curve for ECDH.  A stronger KDF hash algorithm or
AES KEK algorithm MAY be used for a given ECC curve.<a href="#section-15-5.1.2">¶</a></p>
</li>
</ul>
<table id="table-18">
        <caption><a href="#table-18">Table 18</a></caption>
<thead>
          <tr>
            <th rowspan="1" colspan="1">Curve name</th>
            <th rowspan="1" colspan="1">Recommended KDF hash algorithm</th>
            <th rowspan="1" colspan="1">Recommended KEK encryption algorithm</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">NIST P-256</td>
            <td rowspan="1" colspan="1">SHA2-256</td>
            <td rowspan="1" colspan="1">AES-128</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NIST P-384</td>
            <td rowspan="1" colspan="1">SHA2-384</td>
            <td rowspan="1" colspan="1">AES-192</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NIST P-521</td>
            <td rowspan="1" colspan="1">SHA2-512</td>
            <td rowspan="1" colspan="1">AES-256</td>
          </tr>
        </tbody>
      </table>
<ul>
<li id="section-15-7.1">
          <p id="section-15-7.1.1">This document explicitly discourages the use of algorithms other
than AES as a KEK algorithm because backward compatibility of the
ECDH format is not a concern.  The KEK algorithm is only used within
the scope of a Public-Key Encrypted Session Key Packet, which
represents an ECDH key recipient of a message.  Compare this with
the algorithm used for the session key of the message, which MAY be
different from a KEK algorithm.<a href="#section-15-7.1.1">¶</a></p>
<p id="section-15-7.1.2">
Compliant applications SHOULD implement, advertise through key
preferences, and use the strongest algorithms specified in this
document.<a href="#section-15-7.1.2">¶</a></p>
<p id="section-15-7.1.3">
Note that the symmetric algorithm preference list may make it
impossible to use the balanced strength of symmetric key algorithms
for a corresponding public key.  For example, the presence of the
symmetric key algorithm IDs and their order in the key preference
list affects the algorithm choices available to the encoding side,
which in turn may make the adherence to the table above infeasible.
Therefore, compliance with this specification is a concern
throughout the life of the key, starting immediately after the key
generation when the key preferences are first added to a key.  It is
generally advisable to position a symmetric algorithm ID of strength
matching the public key at the head of the key preference list.<a href="#section-15-7.1.3">¶</a></p>
<p id="section-15-7.1.4">
Encryption to multiple recipients often results in an unordered
intersection subset.  For example, if the first recipient's set is
{A, B} and the second's is {B, A}, the intersection is an unordered
set of two algorithms, A and B.  In this case, a compliant
application SHOULD choose the stronger encryption algorithm.<a href="#section-15-7.1.4">¶</a></p>
<p id="section-15-7.1.5">
Resource constraints, such as limited computational power, is a
likely reason why an application might prefer to use the weakest
algorithm.  On the other side of the spectrum are applications that
can implement every algorithm defined in this document.  Most
applications are expected to fall into either of two categories.  A
compliant application in the second, or strongest, category SHOULD
prefer AES-256 to AES-192.<a href="#section-15-7.1.5">¶</a></p>
<p id="section-15-7.1.6">
SHA-1 MUST NOT be used with the ECDSA or the KDF in the ECDH method.<a href="#section-15-7.1.6">¶</a></p>
<p id="section-15-7.1.7">
MDC MUST be used when a symmetric encryption key is protected by
ECDH.  None of the ECC methods described in this document are
allowed with deprecated V3 keys.  A compliant application MUST only
use iterated and salted S2K to protect private keys, as defined in
<a href="#iterated-and-salted-s2k">Section 3.7.1.3</a>, "Iterated and Salted S2K".<a href="#section-15-7.1.7">¶</a></p>
<p id="section-15-7.1.8">
Side channel attacks are a concern when a compliant application's
use of the OpenPGP format can be modeled by a decryption or signing
oracle model, for example, when an application is a network service
performing decryption to unauthenticated remote users.  ECC scalar
multiplication operations used in ECDSA and ECDH are vulnerable to
side channel attacks.  Countermeasures can often be taken at the
higher protocol level, such as limiting the number of allowed
failures or time-blinding of the operations associated with each
network interface.  Mitigations at the scalar multiplication level
seek to eliminate any measurable distinction between the ECC point
addition and doubling operations.<a href="#section-15-7.1.8">¶</a></p>
</li>
<li id="section-15-7.2">Although technically possible, the EdDSA algorithm MUST NOT be
used with a digest algorithms weaker than SHA2-256.<a href="#section-15-7.2">¶</a>
</li>
</ul>
<p id="section-15-8">OpenPGP was designed with security in mind, with many smart,
intelligent people spending a lot of time thinking about the
ramifications of their decisions.  Removing the requirement for
self-certifying User ID (and User Attribute) packets on a key means
that someone could surreptitiously add an unwanted ID to a key and
sign it.  If enough "trusted" people sign that surreptitious identity
then other people might believe it.  The attack could wind up sending
encrypted mail destined for alice to some other target, bob, because
someone added "alice" to bob's key without bob's consent.<a href="#section-15-8">¶</a></p>
<p id="section-15-9">In the case of device certificates the device itself does not have any
consent.  It is given an identity by the device manufacturer and the
manufacturer can insert that ID on the device certificate, signing it
with the manufacturer's key.  If another people wants to label the
device by another name, they can do so.  There is no harm in multiple
IDs, because the verification is all done based on who has signed
those IDs.<a href="#section-15-9">¶</a></p>
<p id="section-15-10">When a key can self-sign, it is still suggested to self-certify IDs,
even if it no longer required by this modification to OpenPGP.  This
at least signals to recipients of keys that yes, the owner of this key
asserts that this identity belongs to herself.  Note, however, that
mallet could still assert that he is 'alice' and could even
self-certify that.  So the attack is not truly different.  Moreover,
in the case of device certificates, it's more the manufacturer than
the device that wants to assert an identity (even if the device could
self-certify).<a href="#section-15-10">¶</a></p>
<p id="section-15-11">There is no signaling whether a key is using this looser-requirement
key format.  An attacker could therefore just remove the
self-signature off a published key.  However one would hope that wide
publication would result in another copy still having that signature
and it being returned quickly.  However, the lack of signaling also
means that a user with an application following RFC 4880 directly
would see a key following this specification as "broken" and may not
accept it.<a href="#section-15-11">¶</a></p>
<p id="section-15-12">On a different note, including the "geo" notation could leak
information about where a signer is located.  However it is just an
assertion (albeit a signed assertion) so there is no verifiable truth
to the location information released.  Similarly, all the rest of the
signature notations are pure assertions, so they should be taken with
the trustworthiness of the signer.<a href="#section-15-12">¶</a></p>
<p id="section-15-13">Combining the User ID with the User Attribute means that an ID and
image would not be separable.  For a person this is probably not good,
but for a device it's unlikely the image will change so it makes sense
to combine the ID and image into a single signed packet with a single
signature.<a href="#section-15-13">¶</a></p>
</section>
</div>
<div id="compatibility-profiles">
<section id="section-16">
      <h2 id="name-compatibility-profiles">
<a href="#section-16">16. </a><a href="#name-compatibility-profiles">Compatibility Profiles</a>
      </h2>
<div id="openpgp-ecc-profile">
<section id="section-16.1">
        <h3 id="name-openpgp-ecc-profile">
<a href="#section-16.1">16.1. </a><a href="#name-openpgp-ecc-profile">OpenPGP ECC Profile</a>
        </h3>
<p id="section-16.1-1">A compliant application MUST implement NIST curve P-256, SHOULD
implement NIST curve P-521, SHOULD implemend Ed25519, SHOULD implement
Curve25519, MAY implement NIST curve P-384, MAY implement
brainpoolP256r1, and MAY implement brainpoolP512r1,
as defined in <a href="#ecc-curve-oid">Section 9.2</a>.  A compliant application MUST
implement SHA2-256 and SHOULD implement SHA2-384 and SHA2-512.  A
compliant application MUST implement AES-128 and SHOULD implement
AES-256.<a href="#section-16.1-1">¶</a></p>
<p id="section-16.1-2">A compliant application SHOULD follow <a href="#security-considerations">Section 15</a>
regarding the choice of the following algorithms for each curve:<a href="#section-16.1-2">¶</a></p>
<ul>
<li id="section-16.1-3.1">the KDF hash algorithm,<a href="#section-16.1-3.1">¶</a>
</li>
<li id="section-16.1-3.2">the KEK algorithm,<a href="#section-16.1-3.2">¶</a>
</li>
<li id="section-16.1-3.3">the message digest algorithm and the hash algorithm used in the
key certifications,<a href="#section-16.1-3.3">¶</a>
</li>
<li id="section-16.1-3.4">the symmetric algorithm used for message encryption.<a href="#section-16.1-3.4">¶</a>
</li>
</ul>
<p id="section-16.1-4">It is recommended that the chosen symmetric algorithm for message
encryption be no less secure than the KEK algorithm.<a href="#section-16.1-4">¶</a></p>
</section>
</div>
<div id="suite-b-profile">
<section id="section-16.2">
        <h3 id="name-suite-b-profile">
<a href="#section-16.2">16.2. </a><a href="#name-suite-b-profile">Suite-B Profile</a>
        </h3>
<p id="section-16.2-1">A subset of algorithms allowed by this document can be used to achieve
<span>[<a href="#SuiteB">SuiteB</a>]</span> compatibility.  The references to <span>[<a href="#SuiteB">SuiteB</a>]</span> in this
document are informative.  This document is primarily concerned with
format specification, leaving additional security restrictions
unspecified, such as matching the assigned security level of
information to authorized recipients or interoperability concerns
arising from fewer allowed algorithms in <span>[<a href="#SuiteB">SuiteB</a>]</span> than allowed by
this document.<a href="#section-16.2-1">¶</a></p>
<div id="security-strength-at-192-bits">
<section id="section-16.2.1">
          <h4 id="name-security-strength-at-192-bi">
<a href="#section-16.2.1">16.2.1. </a><a href="#name-security-strength-at-192-bi">Security Strength at 192 Bits</a>
          </h4>
<p id="section-16.2.1-1">To achieve the security strength of 192 bits, <span>[<a href="#SuiteB">SuiteB</a>]</span> requires
NIST curve P-384, AES-256, and SHA2-384.  The symmetric algorithm
restriction means that the algorithm of KEK used for key wrapping in
<a href="#ec-dh-algorithm-ecdh">Section 13.5</a> and an OpenPGP session key used for message
encryption must be AES-256.  The hash algorithm restriction means that
the hash algorithms of KDF and the OpenPGP message digest calculation
must be SHA2-384.<a href="#section-16.2.1-1">¶</a></p>
</section>
</div>

</section>
</div>
</section>
</div>
<div id="implementation-nits">
<section id="section-17">
      <h2 id="name-implementation-nits">
<a href="#section-17">17. </a><a href="#name-implementation-nits">Implementation Nits</a>
      </h2>
<p id="section-17-1">This section is a collection of comments to help an implementer,
particularly with an eye to backward compatibility.  Previous
implementations of PGP are not OpenPGP compliant.  Often the
differences are small, but small differences are frequently more
vexing than large differences.  Thus, this is a non-comprehensive list
of potential problems and gotchas for a developer who is trying to be
backward-compatible.<a href="#section-17-1">¶</a></p>
<ul>
<li id="section-17-2.1">The IDEA algorithm is patented, and yet it is required for PGP 2
interoperability.  It is also the de-facto preferred algorithm for
a V3 key with a V3 self-signature (or no self- signature).<a href="#section-17-2.1">¶</a>
</li>
<li id="section-17-2.2">When exporting a private key, PGP 2 generates the header
"BEGIN PGP SECRET KEY BLOCK" instead of "BEGIN PGP PRIVATE KEY
BLOCK".  All previous versions ignore the implied data type,
and look directly at the packet data type.<a href="#section-17-2.2">¶</a>
</li>
<li id="section-17-2.3">PGP versions 2.0 through 2.5 generated V2 Public-Key packets.  These are
identical to the deprecated V3 keys except for the version
number.  An implementation MUST NOT generate them and may
accept or reject them as it sees fit.  Some older PGP versions
generated V2 PKESK packets (Tag 1) as well.  An implementation
may accept or reject V2 PKESK packets as it sees fit, and MUST
NOT generate them.<a href="#section-17-2.3">¶</a>
</li>
<li id="section-17-2.4">PGP version 2.6 will not accept key-material packets with versions
greater than 3.<a href="#section-17-2.4">¶</a>
</li>
<li id="section-17-2.5">There are many ways possible for two keys to have the same key
material, but different fingerprints (and thus Key IDs).
Perhaps the most interesting is an RSA key that has been
"upgraded" to V4 format, but since a V4 fingerprint is
constructed by hashing the key creation time along with other
things, two V4 keys created at different times, yet with the
same key material will have different fingerprints.<a href="#section-17-2.5">¶</a>
</li>
<li id="section-17-2.6">If an implementation is using zlib to interoperate with
PGP 2, then the "windowBits" parameter should be set to -13.<a href="#section-17-2.6">¶</a>
</li>
<li id="section-17-2.7">The 0x19 back signatures were not required for signing subkeys
until relatively recently.  Consequently, there may be keys in
the wild that do not have these back signatures.  Implementing
software may handle these keys as it sees fit.<a href="#section-17-2.7">¶</a>
</li>
<li id="section-17-2.8">OpenPGP does not put limits on the size of public keys.
However, larger keys are not necessarily better keys.  Larger
keys take more computation time to use, and this can quickly
become impractical.  Different OpenPGP implementations may also
use different upper bounds for public key sizes, and so care
should be taken when choosing sizes to maintain
interoperability.  As of 2007 most implementations have an
upper bound of 4096 bits.<a href="#section-17-2.8">¶</a>
</li>
<li id="section-17-2.9">ASCII armor is an optional feature of OpenPGP.  The OpenPGP
working group strives for a minimal set of
mandatory-to-implement features, and since there could be
useful implementations that only use binary object formats,
this is not a "MUST" feature for an implementation.  For
example, an implementation that is using OpenPGP as a mechanism
for file signatures may find ASCII armor unnecessary.  OpenPGP
permits an implementation to declare what features it does and
does not support, but ASCII armor is not one of these.  Since
most implementations allow binary and armored objects to be
used indiscriminately, an implementation that does not
implement ASCII armor may find itself with compatibility issues
with general-purpose implementations.  Moreover,
implementations of OpenPGP-MIME <span>[<a href="#RFC3156">RFC3156</a>]</span> already have a
requirement for ASCII armor so those implementations will
necessarily have support.<a href="#section-17-2.9">¶</a>
</li>
<li id="section-17-2.10">The OCB mode is patented and a debate is still underway on whether
it can be included in RFC4880bis or needs to be moved to a
separate document.  For the sole purpose of experimenting with the
Preferred AEAD Algorithms signature subpacket it is has been
included in this I-D.<a href="#section-17-2.10">¶</a>
</li>
</ul>
</section>
</div>
<section id="section-18">
      <h2 id="name-references">
<a href="#section-18">18. </a><a href="#name-references">References</a>
      </h2>
<section id="section-18.1">
        <h3 id="name-normative-references">
<a href="#section-18.1">18.1. </a><a href="#name-normative-references">Normative References</a>
        </h3>
<dl>
<dt id="AES">[AES]</dt>
<dd>
<span>NIST</span>, <span>"FIPS PUB 197, Advanced Encryption Standard (AES)"</span>, <time datetime="2001-11">November 2001</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.%7Bps,pdf%7D">http://csrc.nist.gov/publications/fips/fips197/fips-197.{ps,pdf}</a>&gt;</span>. </dd>
<dt id="BLOWFISH">[BLOWFISH]</dt>
<dd>
<span>Schneier, B.</span>, <span>"Description of a New Variable-Length Key, 64-Bit Block Cipher (Blowfish)"</span>, <span>Fast Software Encryption, Cambridge Security Workshop Proceedings Springer-Verlag, 1994, pp191-204</span>, <time datetime="1993-12">December 1993</time>, <span>&lt;<a href="http://www.counterpane.com/bfsverlag.html">http://www.counterpane.com/bfsverlag.html</a>&gt;</span>. </dd>
<dt id="BZ2">[BZ2]</dt>
<dd>
<span>Seward, J.</span>, <span>"The Bzip2 and libbzip2 home page"</span>, <time datetime="2010">2010</time>, <span>&lt;<a href="http://www.bzip.org/">http://www.bzip.org/</a>&gt;</span>. </dd>
<dt id="EAX">[EAX]</dt>
<dd>
<span>Bellare, M.</span><span>, Rogaway, P.</span><span>, and D. Wagner</span>, <span>"A Conventional Authenticated-Encryption Mode"</span>, <time datetime="2003-04">April 2003</time>. </dd>
<dt id="ELGAMAL">[ELGAMAL]</dt>
<dd>
<span>Elgamal, T.</span>, <span>"A Public-Key Cryptosystem and a Signature Scheme Based on Discrete Logarithms"</span>, <span>IEEE Transactions on Information Theory v. IT-31, n. 4, 1985, pp. 469-472</span>, <time datetime="1985">1985</time>. </dd>
<dt id="FIPS180">[FIPS180]</dt>
<dd>
<span>National Institute of Standards and Technology, U.S. Department of Commerce</span>, <span>"Secure Hash Standard (SHS), FIPS 180-4"</span>, <time datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://dx.doi.org/10.6028/NIST.FIPS.180-4">http://dx.doi.org/10.6028/NIST.FIPS.180-4</a>&gt;</span>. </dd>
<dt id="FIPS186">[FIPS186]</dt>
<dd>
<span>National Institute of Standards and Technology, U.S. Department of Commerce</span>, <span>"Digital Signature Standard (DSS), FIPS 186-4"</span>, <time datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://dx.doi.org/10.6028/NIST.FIPS.186-4">http://dx.doi.org/10.6028/NIST.FIPS.186-4</a>&gt;</span>. </dd>
<dt id="FIPS202">[FIPS202]</dt>
<dd>
<span>National Institute of Standards and Technology, U.S. Department of Commerce</span>, <span>"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions, FIPS 202"</span>, <time datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://dx.doi.org/10.6028/NIST.FIPS.202">http://dx.doi.org/10.6028/NIST.FIPS.202</a>&gt;</span>. </dd>
<dt id="HAC">[HAC]</dt>
<dd>
<span>Menezes, A.J.</span><span>, Oorschot, P.v.</span><span>, and S. Vanstone</span>, <span>"Handbook of Applied Cryptography"</span>, <time datetime="1996">1996</time>. </dd>
<dt id="IDEA">[IDEA]</dt>
<dd>
<span>Lai, X.</span>, <span>"On the design and security of block ciphers"</span>, <span>ETH Series in Information Processing, J.L. Massey (editor) Vol. 1, Hartung-Gorre Verlag Konstanz, Technische Hochschule (Zurich)</span>, <time datetime="1992">1992</time>. </dd>
<dt id="ISO10646">[ISO10646]</dt>
<dd>
<span>International Organization for Standardization</span>, <span>"Information Technology - Universal Multiple-octet coded Character Set (UCS) - Part 1: Architecture and Basic Multilingual Plane"</span>, <span>ISO Standard 10646-1</span>, <time datetime="1993-05">May 1993</time>. </dd>
<dt id="JFIF">[JFIF]</dt>
<dd>
<span>CA, E.H.M.</span>, <span>"JPEG File Interchange Format (Version 1.02)."</span>, <time datetime="1996-09">September 1996</time>. </dd>
<dt id="PKCS5">[PKCS5]</dt>
<dd>
<span>RSA Laboratories</span>, <span>"PKCS #5 v2.0: Password-Based Cryptography Standard"</span>, <time datetime="1999-03-25">25 March 1999</time>. </dd>
<dt id="RFC1950">[RFC1950]</dt>
<dd>
<span>Deutsch, P.</span><span> and J-L. Gailly</span>, <span>"ZLIB Compressed Data Format Specification version 3.3"</span>, <span>RFC 1950</span>, <span>DOI 10.17487/RFC1950</span>, <time datetime="1996-05">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1950">https://www.rfc-editor.org/info/rfc1950</a>&gt;</span>. </dd>
<dt id="RFC1951">[RFC1951]</dt>
<dd>
<span>Deutsch, P.</span>, <span>"DEFLATE Compressed Data Format Specification version 1.3"</span>, <span>RFC 1951</span>, <span>DOI 10.17487/RFC1951</span>, <time datetime="1996-05">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1951">https://www.rfc-editor.org/info/rfc1951</a>&gt;</span>. </dd>
<dt id="RFC2045">[RFC2045]</dt>
<dd>
<span>Freed, N.</span><span> and N. Borenstein</span>, <span>"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span>RFC 2045</span>, <span>DOI 10.17487/RFC2045</span>, <time datetime="1996-11">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span>Bradner, S.</span>, <span>"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span>BCP 14</span>, <span>RFC 2119</span>, <span>DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC2144">[RFC2144]</dt>
<dd>
<span>Adams, C.</span>, <span>"The CAST-128 Encryption Algorithm"</span>, <span>RFC 2144</span>, <span>DOI 10.17487/RFC2144</span>, <time datetime="1997-05">May 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2144">https://www.rfc-editor.org/info/rfc2144</a>&gt;</span>. </dd>
<dt id="RFC2822">[RFC2822]</dt>
<dd>
<span>Resnick, P., Ed.</span>, <span>"Internet Message Format"</span>, <span>RFC 2822</span>, <span>DOI 10.17487/RFC2822</span>, <time datetime="2001-04">April 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2822">https://www.rfc-editor.org/info/rfc2822</a>&gt;</span>. </dd>
<dt id="RFC3156">[RFC3156]</dt>
<dd>
<span>Elkins, M.</span><span>, Del Torto, D.</span><span>, Levien, R.</span><span>, and T. Roessler</span>, <span>"MIME Security with OpenPGP"</span>, <span>RFC 3156</span>, <span>DOI 10.17487/RFC3156</span>, <time datetime="2001-08">August 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3156">https://www.rfc-editor.org/info/rfc3156</a>&gt;</span>. </dd>
<dt id="RFC3394">[RFC3394]</dt>
<dd>
<span>Schaad, J.</span><span> and R. Housley</span>, <span>"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span>RFC 3394</span>, <span>DOI 10.17487/RFC3394</span>, <time datetime="2002-09">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dt id="RFC3447">[RFC3447]</dt>
<dd>
<span>Jonsson, J.</span><span> and B. Kaliski</span>, <span>"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1"</span>, <span>RFC 3447</span>, <span>DOI 10.17487/RFC3447</span>, <time datetime="2003-02">February 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3447">https://www.rfc-editor.org/info/rfc3447</a>&gt;</span>. </dd>
<dt id="RFC3629">[RFC3629]</dt>
<dd>
<span>Yergeau, F.</span>, <span>"UTF-8, a transformation format of ISO 10646"</span>, <span>STD 63</span>, <span>RFC 3629</span>, <span>DOI 10.17487/RFC3629</span>, <time datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dt id="RFC3713">[RFC3713]</dt>
<dd>
<span>Matsui, M.</span><span>, Nakajima, J.</span><span>, and S. Moriai</span>, <span>"A Description of the Camellia Encryption Algorithm"</span>, <span>RFC 3713</span>, <span>DOI 10.17487/RFC3713</span>, <time datetime="2004-04">April 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3713">https://www.rfc-editor.org/info/rfc3713</a>&gt;</span>. </dd>
<dt id="RFC4086">[RFC4086]</dt>
<dd>
<span>Eastlake 3rd, D.</span><span>, Schiller, J.</span><span>, and S. Crocker</span>, <span>"Randomness Requirements for Security"</span>, <span>BCP 106</span>, <span>RFC 4086</span>, <span>DOI 10.17487/RFC4086</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dt id="RFC5639">[RFC5639]</dt>
<dd>
<span>Lochter, M.</span><span> and J. Merkle</span>, <span>"Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve Generation"</span>, <span>RFC 5639</span>, <span>DOI 10.17487/RFC5639</span>, <time datetime="2010-03">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5639">https://www.rfc-editor.org/info/rfc5639</a>&gt;</span>. </dd>
<dt id="RFC5870">[RFC5870]</dt>
<dd>
<span>Mayrhofer, A.</span><span> and C. Spanring</span>, <span>"A Uniform Resource Identifier for Geographic Locations ('geo' URI)"</span>, <span>RFC 5870</span>, <span>DOI 10.17487/RFC5870</span>, <time datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5870">https://www.rfc-editor.org/info/rfc5870</a>&gt;</span>. </dd>
<dt id="RFC7253">[RFC7253]</dt>
<dd>
<span>Krovetz, T.</span><span> and P. Rogaway</span>, <span>"The OCB Authenticated-Encryption Algorithm"</span>, <span>RFC 7253</span>, <span>DOI 10.17487/RFC7253</span>, <time datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7253">https://www.rfc-editor.org/info/rfc7253</a>&gt;</span>. </dd>
<dt id="RFC7748">[RFC7748]</dt>
<dd>
<span>Langley, A.</span><span>, Hamburg, M.</span><span>, and S. Turner</span>, <span>"Elliptic Curves for Security"</span>, <span>RFC 7748</span>, <span>DOI 10.17487/RFC7748</span>, <time datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dt id="RFC8032">[RFC8032]</dt>
<dd>
<span>Josefsson, S.</span><span> and I. Liusvaara</span>, <span>"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span>RFC 8032</span>, <span>DOI 10.17487/RFC8032</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dt id="RFC8126">[RFC8126]</dt>
<dd>
<span>Cotton, M.</span><span>, Leiba, B.</span><span>, and T. Narten</span>, <span>"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span>BCP 26</span>, <span>RFC 8126</span>, <span>DOI 10.17487/RFC8126</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dt id="SCHNEIER">[SCHNEIER]</dt>
<dd>
<span>Schneier, B.</span>, <span>"Applied Cryptography Second Edition: protocols, algorithms, and source code in C"</span>, <time datetime="1996">1996</time>. </dd>
<dt id="SP800-56A">[SP800-56A]</dt>
<dd>
<span>Barker, E.</span><span>, Johnson, D.</span><span>, and M. Smid</span>, <span>"Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span>NIST Special Publication 800-56A Revision 1</span>, <time datetime="2007-03">March 2007</time>. </dd>
<dt id="SuiteB">[SuiteB]</dt>
<dd>
<span>National Security Agency</span>, <span>"NSA Suite B Cryptography"</span>, <time datetime="2010-03-11">11 March 2010</time>, <span>&lt;<a href="https://www.nsa.gov/ia/programs/suiteb_cryptography/">http://www.nsa.gov/ia/programs/suiteb_cryptography/</a>&gt;</span>. </dd>
<dt id="TWOFISH">[TWOFISH]</dt>
<dd>
<span>Schneier, B.</span><span>, Kelsey, J.</span><span>, Whiting, D.</span><span>, Wagner, D.</span><span>, Hall, C.</span><span>, and N. Ferguson</span>, <span>"The Twofish Encryption Algorithm"</span>, <time datetime="1999">1999</time>. </dd>
</dl>
</section>
<section id="section-18.2">
        <h3 id="name-informative-references">
<a href="#section-18.2">18.2. </a><a href="#name-informative-references">Informative References</a>
        </h3>
<dl>
<dt id="BLEICHENBACHER">[BLEICHENBACHER]</dt>
<dd>
<span>Bleichenbacher, D.</span>, <span>"Generating ElGamal Signatures Without Knowing the Secret Key"</span>, <span>Lecture Notes in Computer Science Volume 1070, pp. 10-18</span>, <time datetime="1996">1996</time>. </dd>
<dt id="JKS02">[JKS02]</dt>
<dd>
<span>Jallad, K.</span><span>, Katz, J.</span><span>, and B. Schneier</span>, <span>"Implementation of Chosen-Ciphertext Attacks against PGP and GnuPG"</span>, <time datetime="2002">2002</time>, <span>&lt;<a href="http://www.counterpane.com/pgp-attack.html">http://www.counterpane.com/pgp-attack.html</a>&gt;</span>. </dd>
<dt id="KOBLITZ">[KOBLITZ]</dt>
<dd>
<span>Koblitz, N.</span>, <span>"A course in number theory and cryptography, Chapter VI. Elliptic Curves"</span>, <span>ISBN 0-387-96576-9</span>, <time datetime="1997">1997</time>. </dd>
<dt id="MZ05">[MZ05]</dt>
<dd>
<span>Mister, S.</span><span> and R. Zuccherato</span>, <span>"An Attack on CFB Mode Encryption As Used By OpenPGP"</span>, <span>IACR ePrint Archive Report 2005/033</span>, <time datetime="2005-02-08">8 February 2005</time>, <span>&lt;<a href="https://eprint.iacr.org/2005/033">http://eprint.iacr.org/2005/033</a>&gt;</span>. </dd>
<dt id="REGEX">[REGEX]</dt>
<dd>
<span>Friedl, J.</span>, <span>"Mastering Regular Expressions"</span>, <span>ISBN 0-596-00289-0</span>, <time datetime="2002-08">August 2002</time>. </dd>
<dt id="RFC1423">[RFC1423]</dt>
<dd>
<span>Balenson, D.</span>, <span>"Privacy Enhancement for Internet Electronic Mail: Part III: Algorithms, Modes, and Identifiers"</span>, <span>RFC 1423</span>, <span>DOI 10.17487/RFC1423</span>, <time datetime="1993-02">February 1993</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1423">https://www.rfc-editor.org/info/rfc1423</a>&gt;</span>. </dd>
<dt id="RFC1991">[RFC1991]</dt>
<dd>
<span>Atkins, D.</span><span>, Stallings, W.</span><span>, and P. Zimmermann</span>, <span>"PGP Message Exchange Formats"</span>, <span>RFC 1991</span>, <span>DOI 10.17487/RFC1991</span>, <time datetime="1996-08">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1991">https://www.rfc-editor.org/info/rfc1991</a>&gt;</span>. </dd>
<dt id="RFC2440">[RFC2440]</dt>
<dd>
<span>Callas, J.</span><span>, Donnerhacke, L.</span><span>, Finney, H.</span><span>, and R. Thayer</span>, <span>"OpenPGP Message Format"</span>, <span>RFC 2440</span>, <span>DOI 10.17487/RFC2440</span>, <time datetime="1998-11">November 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2440">https://www.rfc-editor.org/info/rfc2440</a>&gt;</span>. </dd>
<dt id="RFC4880">[RFC4880]</dt>
<dd>
<span>Callas, J.</span><span>, Donnerhacke, L.</span><span>, Finney, H.</span><span>, Shaw, D.</span><span>, and R. Thayer</span>, <span>"OpenPGP Message Format"</span>, <span>RFC 4880</span>, <span>DOI 10.17487/RFC4880</span>, <time datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4880">https://www.rfc-editor.org/info/rfc4880</a>&gt;</span>. </dd>
<dt id="RFC6090">[RFC6090]</dt>
<dd>
<span>McGrew, D.</span><span>, Igoe, K.</span><span>, and M. Salter</span>, <span>"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span>RFC 6090</span>, <span>DOI 10.17487/RFC6090</span>, <time datetime="2011-02">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dt id="SEC1">[SEC1]</dt>
<dd>
<span>Standards for Efficient Cryptography Group</span>, <span>"SEC 1: Elliptic Curve Cryptography"</span>, <time datetime="2000-09">September 2000</time>. </dd>
<dt id="SP800-57">[SP800-57]</dt>
<dd>
<span>NIST</span>, <span>"Recommendation on Key Management"</span>, <span>NIST Special Publication 800-57</span>, <time datetime="2007-03">March 2007</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-57/SP800-57-Part%7B1,2%7D.pdf">http://csrc.nist.gov/publications/nistpubs/800-57/SP800-57-Part{1,2}.pdf</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="section-appendix.a">
      <h2 id="name-test-vectors">
<a href="#section-appendix.a">Appendix A. </a><a href="#name-test-vectors">Test vectors</a>
      </h2>
<p id="section-appendix.a-1">To help implementing this specification a non-normative example for
the EdDSA algorithm is given.<a href="#section-appendix.a-1">¶</a></p>
<div id="sample-eddsa-key">
<section id="section-a.1">
        <h2 id="name-sample-eddsa-key">
<a href="#section-a.1">A.1. </a><a href="#name-sample-eddsa-key">Sample EdDSA key</a>
        </h2>
<p id="section-a.1-1">The secret key used for this example is:<a href="#section-a.1-1">¶</a></p>
<p id="section-a.1-2">D: 1a8b1ff05ded48e18bf50166c664ab023ea70003d78d9e41f5758a91d850f8d2<a href="#section-a.1-2">¶</a></p>
<p id="section-a.1-3">Note that this is the raw secret key used as input to the EdDSA
signing operation.  The key was created on 2014-08-19 14:28:27 and
thus the fingerprint of the OpenPGP key is:<a href="#section-a.1-3">¶</a></p>
<div id="section-a.1-4">
<pre>   C959 BDBA FA32 A2F8 9A15  3B67 8CFD E121 9796 5A9A
</pre><p><a href="#section-a.1-4">¶</a>
</p></div>
<p id="section-a.1-5">The algorithm specific input parameters without the MPI length headers
are:<a href="#section-a.1-5">¶</a></p>
<p id="section-a.1-6">oid: 2b06010401da470f01<a href="#section-a.1-6">¶</a></p>
<p id="section-a.1-7">q:   403f098994bdd916ed4053197934e4a87c80733a1280d62f8010992e43ee3b2406<a href="#section-a.1-7">¶</a></p>
<p id="section-a.1-8">The entire public key packet is thus:<a href="#section-a.1-8">¶</a></p>
<div id="section-a.1-9">
<pre>   98 33 04 53 f3 5f 0b 16  09 2b 06 01 04 01 da 47
   0f 01 01 07 40 3f 09 89  94 bd d9 16 ed 40 53 19
   79 34 e4 a8 7c 80 73 3a  12 80 d6 2f 80 10 99 2e
   43 ee 3b 24 06
</pre><p><a href="#section-a.1-9">¶</a>
</p></div>
</section>
</div>
<div id="sample-eddsa-signature">
<section id="section-a.2">
        <h2 id="name-sample-eddsa-signature">
<a href="#section-a.2">A.2. </a><a href="#name-sample-eddsa-signature">Sample EdDSA signature</a>
        </h2>
<p id="section-a.2-1">The signature is created using the sample key over the input data
"OpenPGP" on 2015-09-16 12:24:53 and thus the input to the hash
function is:<a href="#section-a.2-1">¶</a></p>
<p id="section-a.2-2">m: 4f70656e504750040016080006050255f95f9504ff0000000c<a href="#section-a.2-2">¶</a></p>
<p id="section-a.2-3">Using the SHA2-256 hash algorithm yields the digest:<a href="#section-a.2-3">¶</a></p>
<p id="section-a.2-4">d: f6220a3f757814f4c2176ffbb68b00249cd4ccdc059c4b34ad871f30b1740280<a href="#section-a.2-4">¶</a></p>
<p id="section-a.2-5">Which is fed into the EdDSA signature function and yields this signature:<a href="#section-a.2-5">¶</a></p>
<p id="section-a.2-6">r: 56f90cca98e2102637bd983fdb16c131dfd27ed82bf4dde5606e0d756aed3366<a href="#section-a.2-6">¶</a></p>
<p id="section-a.2-7">s: d09c4fa11527f038e0f57f2201d82f2ea2c9033265fa6ceb489e854bae61b404<a href="#section-a.2-7">¶</a></p>
<p id="section-a.2-8">The entire signature packet is thus:<a href="#section-a.2-8">¶</a></p>
<div id="section-a.2-9">
<pre>   88 5e 04 00 16 08 00 06  05 02 55 f9 5f 95 00 0a
   09 10 8c fd e1 21 97 96  5a 9a f6 22 01 00 56 f9
   0c ca 98 e2 10 26 37 bd  98 3f db 16 c1 31 df d2
   7e d8 2b f4 dd e5 60 6e  0d 75 6a ed 33 66 01 00
   d0 9c 4f a1 15 27 f0 38  e0 f5 7f 22 01 d8 2f 2e
   a2 c9 03 32 65 fa 6c eb  48 9e 85 4b ae 61 b4 04
</pre><p><a href="#section-a.2-9">¶</a>
</p></div>
</section>
</div>
<div id="sample-aead-eax-encryption-and-decryption">
<section id="section-a.3">
        <h2 id="name-sample-aead-eax-encryption-">
<a href="#section-a.3">A.3. </a><a href="#name-sample-aead-eax-encryption-">Sample AEAD-EAX encryption and decryption</a>
        </h2>
<p id="section-a.3-1">Encryption is performed with the string 'Hello, world!' and password
'password', using AES-128 with AEAD-EAX encryption.<a href="#section-a.3-1">¶</a></p>

<div id="sample-symmetric-key-encrypted-session-key-packet-v5">
<section id="section-a.3.2">
          <h3 id="name-sample-symmetric-key-encryp">
<a href="#section-a.3.2">A.3.2. </a><a href="#name-sample-symmetric-key-encryp">Sample symmetric-key encrypted session key packet (v5)</a>
          </h3>
<p id="section-a.3.2-1">Packet header:<a href="#section-a.3.2-1">¶</a></p>

<p id="section-a.3.2-3">Version, algorithms, S2K fields:<a href="#section-a.3.2-3">¶</a></p>
<div id="section-a.3.2-4">
<pre>  05 07 01 03 08 cd 5a 9f 70 fb e0 bc 65 90
</pre><p><a href="#section-a.3.2-4">¶</a>
</p></div>
<p id="section-a.3.2-5">AEAD IV:<a href="#section-a.3.2-5">¶</a></p>
<div id="section-a.3.2-6">
<pre>  bc 66 9e 34 e5 00 dc ae dc 5b 32 aa 2d ab 02 35
</pre><p><a href="#section-a.3.2-6">¶</a>
</p></div>
<p id="section-a.3.2-7">AEAD encrypted CEK:<a href="#section-a.3.2-7">¶</a></p>
<div id="section-a.3.2-8">
<pre>  9d ee 19 d0 7c 34 46 c4 31 2a 34 ae 19 67 a2 fb
</pre><p><a href="#section-a.3.2-8">¶</a>
</p></div>
<p id="section-a.3.2-9">Authentication tag:<a href="#section-a.3.2-9">¶</a></p>
<div id="section-a.3.2-10">
<pre>  7e 92 8e a5 b4 fa 80 12 bd 45 6d 17 38 c6 3c 36
</pre><p><a href="#section-a.3.2-10">¶</a>
</p></div>
</section>
</div>
<div id="starting-aead-eax-decryption-of-cek">
<section id="section-a.3.3">
          <h3 id="name-starting-aead-eax-decryptio">
<a href="#section-a.3.3">A.3.3. </a><a href="#name-starting-aead-eax-decryptio">Starting AEAD-EAX decryption of CEK</a>
          </h3>
<p id="section-a.3.3-1">The derived key is:<a href="#section-a.3.3-1">¶</a></p>
<div id="section-a.3.3-2">
<pre>  b2 55 69 b9 54 32 45 66 45 27 c4 97 6e 7a 5d 6e
</pre><p><a href="#section-a.3.3-2">¶</a>
</p></div>
<p id="section-a.3.3-3">Authenticated Data:<a href="#section-a.3.3-3">¶</a></p>

<p id="section-a.3.3-5">Nonce:<a href="#section-a.3.3-5">¶</a></p>
<div id="section-a.3.3-6">
<pre>  bc 66 9e 34 e5 00 dc ae dc 5b 32 aa 2d ab 02 35
</pre><p><a href="#section-a.3.3-6">¶</a>
</p></div>
<p id="section-a.3.3-7">Decrypted CEK:<a href="#section-a.3.3-7">¶</a></p>
<div id="section-a.3.3-8">
<pre>  86 f1 ef b8 69 52 32 9f 24 ac d3 bf d0 e5 34 6d
</pre><p><a href="#section-a.3.3-8">¶</a>
</p></div>
</section>
</div>
<div id="sample-aead-encrypted-data-packet">
<section id="section-a.3.4">
          <h3 id="name-sample-aead-encrypted-data-">
<a href="#section-a.3.4">A.3.4. </a><a href="#name-sample-aead-encrypted-data-">Sample AEAD encrypted data packet</a>
          </h3>
<p id="section-a.3.4-1">Packet header:<a href="#section-a.3.4-1">¶</a></p>

<p id="section-a.3.4-3">Version, AES-128, EAX, Chunk bits (14):<a href="#section-a.3.4-3">¶</a></p>

<p id="section-a.3.4-5">IV:<a href="#section-a.3.4-5">¶</a></p>
<div id="section-a.3.4-6">
<pre>  b7 32 37 9f 73 c4 92 8d e2 5f ac fe 65 17 ec 10
</pre><p><a href="#section-a.3.4-6">¶</a>
</p></div>
<p id="section-a.3.4-7">AEAD-EAX Encrypted data chunk #0:<a href="#section-a.3.4-7">¶</a></p>
<div id="section-a.3.4-8">
<pre>  5d c1 1a 81 dc 0c b8 a2 f6 f3 d9 00 16 38 4a 56
  fc 82 1a e1 1a e8
</pre><p><a href="#section-a.3.4-8">¶</a>
</p></div>
<p id="section-a.3.4-9">Chunk #0 authentication tag:<a href="#section-a.3.4-9">¶</a></p>
<div id="section-a.3.4-10">
<pre>  db cb 49 86 26 55 de a8 8d 06 a8 14 86 80 1b 0f
</pre><p><a href="#section-a.3.4-10">¶</a>
</p></div>
<p id="section-a.3.4-11">Final (zero-size chunk #1) authentication tag:<a href="#section-a.3.4-11">¶</a></p>
<div id="section-a.3.4-12">
<pre>  f3 87 bd 2e ab 01 3d e1 25 95 86 90 6e ab 24 76
</pre><p><a href="#section-a.3.4-12">¶</a>
</p></div>
</section>
</div>
<div id="decryption-of-data">
<section id="section-a.3.5">
          <h3 id="name-decryption-of-data">
<a href="#section-a.3.5">A.3.5. </a><a href="#name-decryption-of-data">Decryption of data</a>
          </h3>
<p id="section-a.3.5-1">Starting AEAD-EAX decryption of data, using the CEK.<a href="#section-a.3.5-1">¶</a></p>
<p id="section-a.3.5-2">Chunk #0:<a href="#section-a.3.5-2">¶</a></p>
<p id="section-a.3.5-3">Authenticated data:<a href="#section-a.3.5-3">¶</a></p>
<div id="section-a.3.5-4">
<pre>  d4 01 07 01 0e 00 00 00 00 00 00 00 00
</pre><p><a href="#section-a.3.5-4">¶</a>
</p></div>
<p id="section-a.3.5-5">Nonce:<a href="#section-a.3.5-5">¶</a></p>
<div id="section-a.3.5-6">
<pre>  b7 32 37 9f 73 c4 92 8d e2 5f ac fe 65 17 ec 10
</pre><p><a href="#section-a.3.5-6">¶</a>
</p></div>
<p id="section-a.3.5-7">Decrypted chunk #0.<a href="#section-a.3.5-7">¶</a></p>
<p id="section-a.3.5-8">Literal data packet with the string contents 'Hello, world!
'.<a href="#section-a.3.5-8">¶</a></p>
<div id="section-a.3.5-9">
<pre>  cb 14 62 00 00 00 00 00  48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21 0a
</pre><p><a href="#section-a.3.5-9">¶</a>
</p></div>
<p id="section-a.3.5-10">Authenticating final tag:<a href="#section-a.3.5-10">¶</a></p>
<p id="section-a.3.5-11">Authenticated data:<a href="#section-a.3.5-11">¶</a></p>
<div id="section-a.3.5-12">
<pre>  d4 01 07 01 0e 00 00 00  00 00 00 00 01 00 00 00
  00 00 00 00 16
</pre><p><a href="#section-a.3.5-12">¶</a>
</p></div>
<p id="section-a.3.5-13">Nonce:<a href="#section-a.3.5-13">¶</a></p>
<div id="section-a.3.5-14">
<pre>  b7 32 37 9f 73 c4 92 8d e2 5f ac fe 65 17 ec 11
</pre><p><a href="#section-a.3.5-14">¶</a>
</p></div>
</section>
</div>
<div id="complete-aead-eax-encrypted-packet-sequence">
<section id="section-a.3.6">
          <h3 id="name-complete-aead-eax-encrypted">
<a href="#section-a.3.6">A.3.6. </a><a href="#name-complete-aead-eax-encrypted">Complete AEAD-EAX encrypted packet sequence</a>
          </h3>
<p id="section-a.3.6-1">Symmetric-key encrypted session key packet (v5):<a href="#section-a.3.6-1">¶</a></p>
<div id="section-a.3.6-2">
<pre>   c3 3e 05 07 01 03 08 cd  5a 9f 70 fb e0 bc 65 90
   bc 66 9e 34 e5 00 dc ae  dc 5b 32 aa 2d ab 02 35
   9d ee 19 d0 7c 34 46 c4  31 2a 34 ae 19 67 a2 fb
   7e 92 8e a5 b4 fa 80 12  bd 45 6d 17 38 c6 3c 36
</pre><p><a href="#section-a.3.6-2">¶</a>
</p></div>
<p id="section-a.3.6-3">AEAD encrypted data packet:<a href="#section-a.3.6-3">¶</a></p>
<div id="section-a.3.6-4">
<pre>   d4 4a 01 07 01 0e b7 32  37 9f 73 c4 92 8d e2 5f
   ac fe 65 17 ec 10 5d c1  1a 81 dc 0c b8 a2 f6 f3
   d9 00 16 38 4a 56 fc 82  1a e1 1a e8 db cb 49 86
   26 55 de a8 8d 06 a8 14  86 80 1b 0f f3 87 bd 2e
   ab 01 3d e1 25 95 86 90  6e ab 24 76
</pre><p><a href="#section-a.3.6-4">¶</a>
</p></div>
</section>
</div>
</section>
</div>
<div id="sample-aead-ocb-encryption-and-decryption">
<section id="section-a.4">
        <h2 id="name-sample-aead-ocb-encryption-">
<a href="#section-a.4">A.4. </a><a href="#name-sample-aead-ocb-encryption-">Sample AEAD-OCB encryption and decryption</a>
        </h2>
<p id="section-a.4-1">Encryption is performed with the string 'Hello, world!' and password
'password', using AES-128 with AEAD-OCB encryption.<a href="#section-a.4-1">¶</a></p>

<div id="sample-symmetric-key-encrypted-session-key-packet-v5-1">
<section id="section-a.4.2">
          <h3 id="name-sample-symmetric-key-encrypt">
<a href="#section-a.4.2">A.4.2. </a><a href="#name-sample-symmetric-key-encrypt">Sample symmetric-key encrypted session key packet (v5)</a>
          </h3>
<p id="section-a.4.2-1">Packet header:<a href="#section-a.4.2-1">¶</a></p>

<p id="section-a.4.2-3">Version, algorithms, S2K fields:<a href="#section-a.4.2-3">¶</a></p>
<div id="section-a.4.2-4">
<pre>  05 07 02 03 08 9f 0b 7d a3 e5 ea 64 77 90
</pre><p><a href="#section-a.4.2-4">¶</a>
</p></div>
<p id="section-a.4.2-5">AEAD IV:<a href="#section-a.4.2-5">¶</a></p>
<div id="section-a.4.2-6">
<pre>  99 e3 26 e5 40 0a 90 93 6c ef b4 e8 eb a0 8c
</pre><p><a href="#section-a.4.2-6">¶</a>
</p></div>
<p id="section-a.4.2-7">AEAD encrypted CEK:<a href="#section-a.4.2-7">¶</a></p>
<div id="section-a.4.2-8">
<pre>  67 73 71 6d 1f 27 14 54 0a  38 fc ac 52 99 49 da
</pre><p><a href="#section-a.4.2-8">¶</a>
</p></div>
<p id="section-a.4.2-9">Authentication tag:<a href="#section-a.4.2-9">¶</a></p>
<div id="section-a.4.2-10">
<pre>  c5 29 d3 de 31 e1 5b 4a eb  72 9e 33 00 33 db ed
</pre><p><a href="#section-a.4.2-10">¶</a>
</p></div>
</section>
</div>
<div id="starting-aead-ocb-decryption-of-cek">
<section id="section-a.4.3">
          <h3 id="name-starting-aead-ocb-decryptio">
<a href="#section-a.4.3">A.4.3. </a><a href="#name-starting-aead-ocb-decryptio">Starting AEAD-OCB decryption of CEK</a>
          </h3>
<p id="section-a.4.3-1">The derived key is:<a href="#section-a.4.3-1">¶</a></p>
<div id="section-a.4.3-2">
<pre>  eb 9d a7 8a 9d 5d f8 0e c7 02 05 96 39 9b 65 08
</pre><p><a href="#section-a.4.3-2">¶</a>
</p></div>
<p id="section-a.4.3-3">Authenticated Data:<a href="#section-a.4.3-3">¶</a></p>

<p id="section-a.4.3-5">Nonce:<a href="#section-a.4.3-5">¶</a></p>
<div id="section-a.4.3-6">
<pre>  99 e3 26 e5 40 0a 90 93 6c ef b4 e8 eb a0 8c
</pre><p><a href="#section-a.4.3-6">¶</a>
</p></div>
<p id="section-a.4.3-7">Decrypted CEK:<a href="#section-a.4.3-7">¶</a></p>
<div id="section-a.4.3-8">
<pre>  d1 f0 1b a3 0e 13 0a a7 d2 58 2c 16 e0 50 ae 44
</pre><p><a href="#section-a.4.3-8">¶</a>
</p></div>
</section>
</div>
<div id="sample-aead-encrypted-data-packet-1">
<section id="section-a.4.4">
          <h3 id="name-sample-aead-encrypted-data-p">
<a href="#section-a.4.4">A.4.4. </a><a href="#name-sample-aead-encrypted-data-p">Sample AEAD encrypted data packet</a>
          </h3>
<p id="section-a.4.4-1">Packet header:<a href="#section-a.4.4-1">¶</a></p>

<p id="section-a.4.4-3">Version, AES-128, OCB, Chunk bits (14):<a href="#section-a.4.4-3">¶</a></p>

<p id="section-a.4.4-5">IV:<a href="#section-a.4.4-5">¶</a></p>
<div id="section-a.4.4-6">
<pre>  5e d2 bc 1e 47 0a be 8f 1d 64 4c 7a 6c 8a 56
</pre><p><a href="#section-a.4.4-6">¶</a>
</p></div>
<p id="section-a.4.4-7">AEAD-OCB Encrypted data chunk #0:<a href="#section-a.4.4-7">¶</a></p>
<div id="section-a.4.4-8">
<pre>  7b 0f 77 01 19 66 11 a1  54 ba 9c 25 74 cd 05 62
  84 a8 ef 68 03 5c
</pre><p><a href="#section-a.4.4-8">¶</a>
</p></div>
<p id="section-a.4.4-9">Chunk #0 authentication tag:<a href="#section-a.4.4-9">¶</a></p>
<div id="section-a.4.4-10">
<pre>  62 3d 93 cc 70 8a 43 21 1b b6 ea f2 b2 7f 7c 18
</pre><p><a href="#section-a.4.4-10">¶</a>
</p></div>
<p id="section-a.4.4-11">Final (zero-size chunk #1) authentication tag:<a href="#section-a.4.4-11">¶</a></p>
<div id="section-a.4.4-12">
<pre>  d5 71 bc d8 3b 20 ad d3 a0 8b 73 af 15 b9 a0 98
</pre><p><a href="#section-a.4.4-12">¶</a>
</p></div>
</section>
</div>
<div id="decryption-of-data-1">
<section id="section-a.4.5">
          <h3 id="name-decryption-of-data-2">
<a href="#section-a.4.5">A.4.5. </a><a href="#name-decryption-of-data-2">Decryption of data</a>
          </h3>
<p id="section-a.4.5-1">Starting AEAD-OCB decryption of data, using the CEK.<a href="#section-a.4.5-1">¶</a></p>
<p id="section-a.4.5-2">Chunk #0:<a href="#section-a.4.5-2">¶</a></p>
<p id="section-a.4.5-3">Authenticated data:<a href="#section-a.4.5-3">¶</a></p>
<div id="section-a.4.5-4">
<pre>  r4 01 07 02 0e 00 00 00 00 00 00 00 00
</pre><p><a href="#section-a.4.5-4">¶</a>
</p></div>
<p id="section-a.4.5-5">Nonce:<a href="#section-a.4.5-5">¶</a></p>
<div id="section-a.4.5-6">
<pre>  5e d2 bc 1e 47 0a be 8f 1d 64 4c 7a 6c 8a 56
</pre><p><a href="#section-a.4.5-6">¶</a>
</p></div>
<p id="section-a.4.5-7">Decrypted chunk #0.<a href="#section-a.4.5-7">¶</a></p>
<p id="section-a.4.5-8">Literal data packet with the string contents 'Hello, world!
'.<a href="#section-a.4.5-8">¶</a></p>
<div id="section-a.4.5-9">
<pre>  cb 14 62 00 00 00 00 00  48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21 0a
</pre><p><a href="#section-a.4.5-9">¶</a>
</p></div>
<p id="section-a.4.5-10">Authenticating final tag:<a href="#section-a.4.5-10">¶</a></p>
<p id="section-a.4.5-11">Authenticated data:<a href="#section-a.4.5-11">¶</a></p>
<div id="section-a.4.5-12">
<pre>  d4 01 07 02 0e 00 00 00 00 00 00 00 01 00 00 00
  00 00 00 00 16
</pre><p><a href="#section-a.4.5-12">¶</a>
</p></div>
<p id="section-a.4.5-13">Nonce:<a href="#section-a.4.5-13">¶</a></p>
<div id="section-a.4.5-14">
<pre>  5e d2 bc 1e 47 0a be 8f 1d 64 4c 7a 6c 8a 57
</pre><p><a href="#section-a.4.5-14">¶</a>
</p></div>
</section>
</div>
<div id="complete-aead-ocb-encrypted-packet-sequence">
<section id="section-a.4.6">
          <h3 id="name-complete-aead-ocb-encrypted">
<a href="#section-a.4.6">A.4.6. </a><a href="#name-complete-aead-ocb-encrypted">Complete AEAD-OCB encrypted packet sequence</a>
          </h3>
<p id="section-a.4.6-1">Symmetric-key encrypted session key packet (v5):<a href="#section-a.4.6-1">¶</a></p>
<div id="section-a.4.6-2">
<pre>  c3 3d 05 07 02 03 08 9f  0b 7d a3 e5 ea 64 77 90
  99 e3 26 e5 40 0a 90 93  6c ef b4 e8 eb a0 8c 67
  73 71 6d 1f 27 14 54 0a  38 fc ac 52 99 49 da c5
  29 d3 de 31 e1 5b 4a eb  72 9e 33 00 33 db ed
</pre><p><a href="#section-a.4.6-2">¶</a>
</p></div>
<p id="section-a.4.6-3">AEAD encrypted data packet:<a href="#section-a.4.6-3">¶</a></p>
<div id="section-a.4.6-4">
<pre>  d4 49 01 07 02 0e 5e d2  bc 1e 47 0a be 8f 1d 64
  4c 7a 6c 8a 56 7b 0f 77  01 19 66 11 a1 54 ba 9c
  25 74 cd 05 62 84 a8 ef  68 03 5c 62 3d 93 cc 70
  8a 43 21 1b b6 ea f2 b2  7f 7c 18 d5 71 bc d8 3b
  20 ad d3 a0 8b 73 af 15  b9 a0 98
</pre><p><a href="#section-a.4.6-4">¶</a>
</p></div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ecc-point-compression-flag-bytes">
<section id="section-appendix.b">
      <h2 id="name-ecc-point-compression-flag-">
<a href="#section-appendix.b">Appendix B. </a><a href="#name-ecc-point-compression-flag-">ECC Point compression flag bytes</a>
      </h2>
<p id="section-appendix.b-1">This specification introduces the new flag byte 0x40 to indicate the
point compression format.  The value has been chosen so that the high
bit is not cleared and thus to avoid accidental sign extension.  Two
other values might also be interesting for other ECC specifications:<a href="#section-appendix.b-1">¶</a></p>
<div id="section-appendix.b-2">
<pre>  Flag  Description
  ----  -----------
  0x04  Standard flag for uncompressed format
  0x40  Native point format of the curve follows
  0x41  Only X coordinate follows.
  0x42  Only Y coordinate follows.
</pre><p><a href="#section-appendix.b-2">¶</a>
</p></div>
</section>
</div>
<div id="changes-since-rfc-4880">
<section id="section-appendix.c">
      <h2 id="name-changes-since-rfc-4880">
<a href="#section-appendix.c">Appendix C. </a><a href="#name-changes-since-rfc-4880">Changes since RFC-4880</a>
      </h2>
<ul>
<li id="section-appendix.c-1.1">Applied errata 2270, 2271, 2242, 3298.<a href="#section-appendix.c-1.1">¶</a>
</li>
<li id="section-appendix.c-1.2">Added Camellia cipher from RFC 5581.<a href="#section-appendix.c-1.2">¶</a>
</li>
<li id="section-appendix.c-1.3">Incorporated RFC 6637 (ECC for OpenPGP)<a href="#section-appendix.c-1.3">¶</a>
</li>
<li id="section-appendix.c-1.4">Added draft-atkins-openpgp-device-certificates<a href="#section-appendix.c-1.4">¶</a>
</li>
<li id="section-appendix.c-1.5">Added draft-koch-eddsa-for-openpgp-04<a href="#section-appendix.c-1.5">¶</a>
</li>
<li id="section-appendix.c-1.6">Added Issuer Fingerprint signature subpacket.<a href="#section-appendix.c-1.6">¶</a>
</li>
<li id="section-appendix.c-1.7">Added a v5 key and fingerprint format.<a href="#section-appendix.c-1.7">¶</a>
</li>
<li id="section-appendix.c-1.8">Added OIDs for brainpool curves and Curve25519.<a href="#section-appendix.c-1.8">¶</a>
</li>
<li id="section-appendix.c-1.9">Marked SHA2-256 as MUST implement.<a href="#section-appendix.c-1.9">¶</a>
</li>
<li id="section-appendix.c-1.10">Marked Curve25519 and Ed25519 as SHOULD implement.<a href="#section-appendix.c-1.10">¶</a>
</li>
<li id="section-appendix.c-1.11">Marked SHA-1 as SHOULD NOT be used to create messages.<a href="#section-appendix.c-1.11">¶</a>
</li>
<li id="section-appendix.c-1.12">Marked MD5 as SHOULD NOT implement.<a href="#section-appendix.c-1.12">¶</a>
</li>
<li id="section-appendix.c-1.13">Changed v5 key fingerprint format to full 32 octets.<a href="#section-appendix.c-1.13">¶</a>
</li>
<li id="section-appendix.c-1.14">Added Literal Data Packet format octet 'm'.<a href="#section-appendix.c-1.14">¶</a>
</li>
<li id="section-appendix.c-1.15">Added Feature Flag for v5 key support.<a href="#section-appendix.c-1.15">¶</a>
</li>
<li id="section-appendix.c-1.16">Added AEAD Encrypted Data Packet.<a href="#section-appendix.c-1.16">¶</a>
</li>
<li id="section-appendix.c-1.17">Removed notes on extending the MDC packet.<a href="#section-appendix.c-1.17">¶</a>
</li>
<li id="section-appendix.c-1.18">Added v5 Symmetric-Key Encrypted Session Key packet.<a href="#section-appendix.c-1.18">¶</a>
</li>
<li id="section-appendix.c-1.19">Added AEAD encryption of secret keys.<a href="#section-appendix.c-1.19">¶</a>
</li>
<li id="section-appendix.c-1.20">Added test vectors for AEAD.<a href="#section-appendix.c-1.20">¶</a>
</li>
<li id="section-appendix.c-1.21">Added the Additional Encryption Subkey key flag.<a href="#section-appendix.c-1.21">¶</a>
</li>
<li id="section-appendix.c-1.22">Deprecated the Symmetrically Encrypted Data Packet.<a href="#section-appendix.c-1.22">¶</a>
</li>
<li id="section-appendix.c-1.23">Suggest limitation of the AEAD chunksize to 128 MiB.<a href="#section-appendix.c-1.23">¶</a>
</li>
<li id="section-appendix.c-1.24">Specified the V5 signature format.<a href="#section-appendix.c-1.24">¶</a>
</li>
<li id="section-appendix.c-1.25">Deprectated the creation of V3 signatures.<a href="#section-appendix.c-1.25">¶</a>
</li>
<li id="section-appendix.c-1.26">Adapted terms from RFC 8126.<a href="#section-appendix.c-1.26">¶</a>
</li>
<li id="section-appendix.c-1.27">Removed editorial marks and updated cross-references.<a href="#section-appendix.c-1.27">¶</a>
</li>
<li id="section-appendix.c-1.28">Added the timestamping usage key flag.<a href="#section-appendix.c-1.28">¶</a>
</li>
<li id="section-appendix.c-1.29">Added Intended Recipient signature subpacket.<a href="#section-appendix.c-1.29">¶</a>
</li>
<li id="section-appendix.c-1.30">Added Attested Certifications signature subpacket and signature class.<a href="#section-appendix.c-1.30">¶</a>
</li>
</ul>
</section>
</div>

<div id="authors-addresses">
<section id="section-appendix.e">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address>
        <p><span>Werner Koch</span></p>
<p><span>GnuPG e.V.</span></p>
<p><span>Rochusstr. 44</span></p>
<p><span>40479</span> <span>Duesseldorf</span>
</p>
<p><span>Germany</span></p>


</address>
<address>
        <p><span>brian m. carlson</span></p>

</address>
<address>
        <p><span>Ronald Henry Tse</span></p>
<p><span>Ribose</span></p>
<p><span>Suite 1111, 1 Pedder Street</span></p>
<p><span>Central, Hong Kong</span></p>
<p><span>Hong Kong</span></p>


</address>
<address>
        <p><span>Derek Atkins</span></p>

</address>
<address>
        <p><span>Daniel Kahn Gillmor</span></p>

</address>
</section>
</div>



</div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>