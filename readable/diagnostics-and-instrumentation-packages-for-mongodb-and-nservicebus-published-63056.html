<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Diagnostics and Instrumentation Packages for MongoDB and NServiceBus Published - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Diagnostics and Instrumentation Packages for MongoDB and NServiceBus Published - linksfor.dev(s)"/>
    <meta property="article:author" content="Jimmy Bogard"/>
    <meta property="og:description" content="As part of the end-to-end diagnostics and tracing blog series, I had an end goal of eventually publishing out NuGet packages for diagnostics (Activity and DiagnosticSource). I&#x27;m happy to announce that I&#x27;ve released 4 packages to NuGet: NServiceBus.Extensions.DiagnosticsNServiceBus.Extensions.Diagnostics.OpenTelemetryMongoDB.Driver.Core.Extensions.DiagnosticSourcesMongoDB.Driver.Core.Extensions."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://jimmybogard.com/diagnostics-and-instrumentation-for-mongodb-and-nservicebus/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Diagnostics and Instrumentation Packages for MongoDB and NServiceBus Published</title>
<div class="readable">
        <h1>Diagnostics and Instrumentation Packages for MongoDB and NServiceBus Published</h1>
            <div>by Jimmy Bogard</div>
            <div>Reading time: 3-4 minutes</div>
        <div>Posted here: 18 Jun 2020</div>
        <p><a href="https://jimmybogard.com/diagnostics-and-instrumentation-for-mongodb-and-nservicebus/">https://jimmybogard.com/diagnostics-and-instrumentation-for-mongodb-and-nservicebus/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="site-main">
    <div>

        <article>

            <header>

                <section>
                    <a href="https://jimmybogard.com/tag/distributed-systems/">Distributed Systems</a>
                </section>

                


                <div>

                    <section>

                        <ul>
                            <li>

                                <div>
                                    <p><img src="https://www.gravatar.com/avatar/cc359c5ccf90d7a24b5976316797b5ec?s=250&amp;d=mm&amp;r=x" alt="Jimmy Bogard"></p><div>
                                        <h2>Jimmy Bogard</h2>
                                        <p>Read <a href="https://jimmybogard.com/author/jimmy/">more posts</a> by this author.</p>
                                    </div>
                                </div>

                                <a href="https://jimmybogard.com/author/jimmy/">
                                    <img src="https://www.gravatar.com/avatar/cc359c5ccf90d7a24b5976316797b5ec?s=250&amp;d=mm&amp;r=x" alt="Jimmy Bogard">
                                </a>

                            </li>
                        </ul>

                        <section>
                            <h4><a href="https://jimmybogard.com/author/jimmy/">Jimmy Bogard</a></h4>
                            <p><time datetime="2020-06-17">17 Jun 2020</time>
                                <span><span>â€¢</span> 1 min read</span>
                            </p>
                        </section>

                    </section>


                </div>
            </header>


            <section>
                <div>
                    <p>As part of the <a href="https://jimmybogard.com/building-end-to-end-diagnostics-and-tracing-a-primer/">end-to-end diagnostics and tracing blog series</a>, I had an end goal of eventually publishing out NuGet packages for diagnostics (Activity and DiagnosticSource). I'm happy to announce that I've released 4 packages to NuGet:</p><ul><li><a href="https://www.nuget.org/packages/NServiceBus.Extensions.Diagnostics/">NServiceBus.Extensions.Diagnostics</a></li><li><a href="https://www.nuget.org/packages/NServiceBus.Extensions.Diagnostics.OpenTelemetry/">NServiceBus.Extensions.Diagnostics.OpenTelemetry</a></li><li><a href="https://www.nuget.org/packages/MongoDB.Driver.Core.Extensions.DiagnosticSources/">MongoDB.Driver.Core.Extensions.DiagnosticSources</a></li><li><a href="https://www.nuget.org/packages/MongoDB.Driver.Core.Extensions.OpenTelemetry/">MongoDB.Driver.Core.Extensions.OpenTelemetry</a></li></ul><p>These packages add:</p><ul><li><a href="https://github.com/dotnet/runtime/blob/master/src/libraries/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md">Activity</a> and <a href="https://github.com/dotnet/runtime/blob/master/src/libraries/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md">DiagnosticsSource</a> support</li><li><a href="https://opentelemetry.io/">OpenTelemetry</a> adapters</li><li><a href="https://www.w3.org/TR/trace-context/">W3C Trace Context</a> and <a href="https://w3c.github.io/correlation-context/">Correlation Context</a> support for NServiceBus</li></ul><p>With the diagnostics packages, you can write your own <code>DiagnosticListener</code>s to subscribe to diagnostics Activity events. The OpenTelemetry packages listen to these Activity events and adapt them to OpenTelemetry spans. The various existing exporters can output these spans to Zipkin, Jaeger, Application Insights, and many other observability tools.</p><p>I've updated the ReadMe's for each repo to include instructions for how to use:</p><ul><li><a href="https://github.com/jbogard/MongoDB.Driver.Core.Extensions.DiagnosticSources">Mongo.Driver.Core.Extensions.DiagnosticSources</a></li><li><a href="https://github.com/jbogard/NServiceBus.Extensions.Diagnostics">NServiceBus.Extensions.Diagnostics</a></li></ul><p>With these packages, you can easily configure OpenTelemetry to include MongoDB and NServiceBus support:</p><pre><code>services<span>.</span><span>AddOpenTelemetry</span><span>(</span>builder <span>=&gt;</span> 
    builder
        <span>.</span><span>UseZipkin</span><span>(</span>o <span>=&gt;</span>
        <span>{</span>
            o<span>.</span>Endpoint <span>=</span> <span>new</span> <span>Uri</span><span>(</span><span>"<a href="http://localhost:9411/api/v2/spans" rel="nofollow"><span>http</span><span>://</span><span>localhost</span><span>:</span><span>9411</span><span>/</span><span>api</span><span>/</span><span>v2</span><span>/</span><span>spans</span></a>"</span><span>)</span><span>;</span>
            o<span>.</span>ServiceName <span>=</span> EndpointName<span>;</span>
        <span>}</span><span>)</span>
        <span>.</span><span>AddNServiceBusAdapter</span><span>(</span>opt <span>=&gt;</span> opt<span>.</span>CaptureMessageBody <span>=</span> <span>true</span><span>)</span>
        <span>.</span><span>AddMongoDBAdapter</span><span>(</span>opt <span>=&gt;</span> opt<span>.</span>CaptureCommandText <span>=</span> <span>true</span><span>)</span>
        <span>.</span><span>AddRequestAdapter</span><span>(</span><span>)</span>
        <span>.</span><span>AddDependencyAdapter</span><span>(</span>configureSqlAdapterOptions<span>:</span> opt <span>=&gt;</span> opt<span>.</span>CaptureTextCommandContent <span>=</span> <span>true</span><span>)</span><span>;</span>
<span>)</span><span>;</span></code></pre><p>Enjoy!</p>
                </div>
            </section>


            <section>
                
                
            </section>

        </article>

    </div>
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>