<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Merged PR 174112: Fix Loop in System.Uri &#xB7; dotnet/corefx@6da61ff - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Merged PR 174112: Fix Loop in System.Uri &#xB7; dotnet/corefx@6da61ff - linksfor.dev(s)"/>
    <meta property="article:author" content="rmkerr"/>
    <meta property="og:description" content="Fix Loop in System.Uri"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/corefx/commit/6da61ff4d24c7875087cb6afe93140ba0e3a6532"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Merged PR 174112: Fix Loop in System.Uri &#xB7; dotnet/corefx@6da61ff</title>
<div class="readable">
        <h1>Merged PR 174112: Fix Loop in System.Uri &#xB7; dotnet/corefx@6da61ff</h1>
            <div>by rmkerr</div>
            <div>Reading time: 8-10 minutes</div>
        <div>Posted here: 18 May 2019</div>
        <p><a href="https://github.com/dotnet/corefx/commit/6da61ff4d24c7875087cb6afe93140ba0e3a6532">https://github.com/dotnet/corefx/commit/6da61ff4d24c7875087cb6afe93140ba0e3a6532</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://github.com/dotnet/corefx/commit/6da61ff4d24c7875087cb6afe93140ba0e3a6532&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="21a4d76ee93a4291ceab3b5987272086b3d1f5d3dd5a45f077b1241cd1a1dc08">
        <div>
          <table data-tab-size="4" data-diff-anchor="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5">

                
      <tbody><tr data-position="0">
    <td colspan="2">
          <a href="#diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5" title="Expand Up" aria-label="Expand Up" data-url="/dotnet/corefx/blob_excerpt/061b31bee0f14d917b48720437817622244640e7?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=&amp;last_right=&amp;left=598&amp;left_hunk_size=5&amp;mode=100644&amp;path=src%2FSystem.Private.Uri%2Ftests%2FFunctionalTests%2FIriTest.cs&amp;right=598&amp;right_hunk_size=90" data-left-range="1-597" data-right-range="1-597">
            
          </a>
    </td>
    <td>@@ -598,5 +598,90 @@ public void Iri_AllForbiddenDecompositions_NonIdnPropertiesOk(string scheme, str</td>
  </tr>

    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5L598" data-line-number="598"></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R598" data-line-number="598"></td>

  <td>
    <span data-code-marker=" ">            <span>Assert</span>.<span>Equal</span>(<span>host</span>, <span>uri</span>.<span>Authority</span>);</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5L599" data-line-number="599"></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R599" data-line-number="599"></td>

  <td>
    <span data-code-marker=" ">            <span>Assert</span>.<span>Equal</span>(<span>scheme</span> <span>+</span> <span><span>"</span>://<span>"</span></span> <span>+</span> <span>host</span> <span>+</span> <span><span>"</span>/<span>"</span></span>, <span>uri</span>.<span>AbsoluteUri</span>);</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5L600" data-line-number="600"></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R600" data-line-number="600"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R601" data-line-number="601"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R602" data-line-number="602"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> The behavior here is slightly complicated in order to preserve compat in as many</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R603" data-line-number="603"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> cases as possible. There are two limits imposed on the length of URI strings.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R604" data-line-number="604"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> The first, 65519, is specified in the documentation and is one of the first checks</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R605" data-line-number="605"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> enforced on a URI. This limit is not enforced after expansion.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R606" data-line-number="606"></td>

  <td>
    <span data-code-marker="+">        <span>static</span> <span>int</span> <span>InitialLengthLimit</span> <span>=</span> <span>65519</span>;</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R607" data-line-number="607"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R608" data-line-number="608"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> The second, 65535 (ushort.MaxValue) is only reachable via expansion as a result of</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R609" data-line-number="609"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> percent encoding. Exceeding this value used to result in a hang, but now results in</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R610" data-line-number="610"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> an exception.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R611" data-line-number="611"></td>

  <td>
    <span data-code-marker="+">        <span>static</span> <span>int</span> <span>ExpandedLengthLimit</span> <span>=</span> <span>65535</span>;</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R612" data-line-number="612"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R613" data-line-number="613"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> In order to maximize compat, we have to allow a gap between the two maximum</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R614" data-line-number="614"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> values. A URI that starts below 65519 but expands to be in the range [65519,65535)</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R615" data-line-number="615"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> would have worked before this change, and so should continue to work despite</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R616" data-line-number="616"></td>

  <td>
    <span data-code-marker="+">        <span><span>//</span> exceeding limit (1).</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R617" data-line-number="617"></td>

  <td>
    <span data-code-marker="+">        <span>public</span> <span>static</span> <span>IEnumerable</span>&lt;<span>Object</span>[]&gt; <span>Iri_ExpandingContents_TooLong</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R618" data-line-number="618"></td>

  <td>
    <span data-code-marker="+">        {</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R619" data-line-number="619"></td>

  <td>
    <span data-code-marker="+">            <span>get</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R620" data-line-number="620"></td>

  <td>
    <span data-code-marker="+">            {</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R621" data-line-number="621"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> Validate a URI with an initial length less than InitialLengthLimit, and an expanded</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R622" data-line-number="622"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> length that is greater than ExpandedLengthLimit.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R623" data-line-number="623"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> The total of len + const parts (15) + expanded unicode (2 * 9) after expansion should be</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R624" data-line-number="624"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> just larger than ExpandedLengthLimit.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R625" data-line-number="625"></td>

  <td>
    <span data-code-marker="+">                <span>int</span> <span>len</span> <span>=</span> <span>ExpandedLengthLimit</span> <span>-</span> <span>15</span> <span>-</span> (<span>2</span> <span>*</span> <span>9</span>) <span>+</span> <span>1</span>;</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R626" data-line-number="626"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) <span>+</span> <span><span>"</span>@8.8.8.8<span>"</span></span> }; <span><span>//</span> Userinfo</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R627" data-line-number="627"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8?<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) }; <span><span>//</span> Query</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R628" data-line-number="628"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8#<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) }; <span><span>//</span> Fragment</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R629" data-line-number="629"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8/<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) }; <span><span>//</span> Path</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R630" data-line-number="630"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R631" data-line-number="631"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> Generate a string whose total length is just less than InitialLengthLimit</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R632" data-line-number="632"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> but whose content expands to be dramatically larger than ExpandedLengthLimit.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R633" data-line-number="633"></td>

  <td>
    <span data-code-marker="+">                <span>len</span> <span>=</span> <span>InitialLengthLimit</span> <span>-</span> <span>15</span>;</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R634" data-line-number="634"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) <span>+</span> <span><span>"</span>@8.8.8.8<span>"</span></span> }; <span><span>//</span> Userinfo</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R635" data-line-number="635"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8?<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Fragment</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R636" data-line-number="636"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8#<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Query</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R637" data-line-number="637"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8/<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Path</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R638" data-line-number="638"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R639" data-line-number="639"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> Test the minimum length URI that will cause an expansion beyond ExpandedLengthLimit.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R640" data-line-number="640"></td>

  <td>
    <span data-code-marker="+">                <span>len</span> <span>=</span> (<span>ExpandedLengthLimit</span> <span>-</span> <span>15</span>) <span>/</span> <span>9</span> <span>+</span> <span>1</span>;</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R641" data-line-number="641"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) <span>+</span> <span><span>"</span>@8.8.8.8<span>"</span></span> }; <span><span>//</span> Userinfo</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R642" data-line-number="642"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8?<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Fragment</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R643" data-line-number="643"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8#<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Query</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R644" data-line-number="644"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8/<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Path</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R645" data-line-number="645"></td>

  <td>
    <span data-code-marker="+">            }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R646" data-line-number="646"></td>

  <td>
    <span data-code-marker="+">        }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R647" data-line-number="647"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R648" data-line-number="648"></td>

  <td>
    <span data-code-marker="+">        [<span>Theory</span>]</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R649" data-line-number="649"></td>

  <td>
    <span data-code-marker="+">        [<span>MemberData</span>(<span>nameof</span>(<span>Iri_ExpandingContents_TooLong</span>))]</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R650" data-line-number="650"></td>

  <td>
    <span data-code-marker="+">        <span>public</span> <span>static</span> <span>void</span> <span>Iri_ExpandingContents_ThrowsIfTooLong</span>(<span>string</span> <span>input</span>)</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R651" data-line-number="651"></td>

  <td>
    <span data-code-marker="+">        {</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R652" data-line-number="652"></td>

  <td>
    <span data-code-marker="+">            <span>Assert</span>.<span>Throws</span>&lt;<span>System</span>.<span>UriFormatException</span>&gt;(() <span>=&gt;</span> { <span>Uri</span> <span>itemUri</span> <span>=</span> <span>new</span> <span>Uri</span>(<span>input</span>); });</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R653" data-line-number="653"></td>

  <td>
    <span data-code-marker="+">            <span>Assert</span>.<span>False</span>(<span>Uri</span>.<span>TryCreate</span>(<span>input</span>, <span>UriKind</span>.<span>Absolute</span>, <span>out</span> <span>Uri</span> <span>itemUri2</span>));</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R654" data-line-number="654"></td>

  <td>
    <span data-code-marker="+">        }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R655" data-line-number="655"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R656" data-line-number="656"></td>

  <td>
    <span data-code-marker="+">        <span>public</span> <span>static</span> <span>IEnumerable</span>&lt;<span>Object</span>[]&gt; <span>Iri_ExpandingContents_AllowedSize</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R657" data-line-number="657"></td>

  <td>
    <span data-code-marker="+">        {</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R658" data-line-number="658"></td>

  <td>
    <span data-code-marker="+">            <span>get</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R659" data-line-number="659"></td>

  <td>
    <span data-code-marker="+">            {</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R660" data-line-number="660"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> Validate a URI with an initial length less than InitialLengthLimit, and an expanded</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R661" data-line-number="661"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> length that is greater than InitialLengthLimit but less than ExpandedLengthLimit.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R662" data-line-number="662"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> The total of len + const parts (15) + expanded unicode (2 * 9) after expansion should be</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R663" data-line-number="663"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> exactly the ExpandedLengthLimit.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R664" data-line-number="664"></td>

  <td>
    <span data-code-marker="+">                <span>int</span> <span>len</span> <span>=</span> <span>ExpandedLengthLimit</span> <span>-</span> <span>15</span> <span>-</span> (<span>2</span> <span>*</span> <span>9</span>);</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R665" data-line-number="665"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) <span>+</span> <span><span>"</span>@8.8.8.8<span>"</span></span> }; <span><span>//</span> Userinfo</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R666" data-line-number="666"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8?<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) }; <span><span>//</span> Query</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R667" data-line-number="667"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8#<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) }; <span><span>//</span> Fragment</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R668" data-line-number="668"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8/<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'a'</span>, <span>len</span>) <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>2</span>) }; <span><span>//</span> Path</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R669" data-line-number="669"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R670" data-line-number="670"></td>

  <td>
    <span data-code-marker="+">                <span><span>//</span> Validate the same behavior, but maximize the amount of expansion.</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R671" data-line-number="671"></td>

  <td>
    <span data-code-marker="+">                <span>len</span> <span>=</span> (<span>ExpandedLengthLimit</span> <span>-</span> <span>15</span>) <span>/</span> <span>9</span>;</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R672" data-line-number="672"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) <span>+</span> <span><span>"</span>@8.8.8.8<span>"</span></span> }; <span><span>//</span> Userinfo</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R673" data-line-number="673"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8?<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Fragment</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R674" data-line-number="674"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8#<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Query</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R675" data-line-number="675"></td>

  <td>
    <span data-code-marker="+">                <span>yield</span> <span>return</span> <span>new</span> <span>object</span>[] { <span><span>@"</span>test://8.8.8.8/<span>"</span></span> <span>+</span> <span>new</span> <span>string</span>(<span>'<span>\u</span>D800'</span>, <span>len</span>) }; <span><span>//</span> Path</span></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R676" data-line-number="676"></td>

  <td>
    <span data-code-marker="+">            }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R677" data-line-number="677"></td>

  <td>
    <span data-code-marker="+">        }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R678" data-line-number="678"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R679" data-line-number="679"></td>

  <td>
    <span data-code-marker="+">        [<span>Theory</span>]</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R680" data-line-number="680"></td>

  <td>
    <span data-code-marker="+">        [<span>MemberData</span>(<span>nameof</span>(<span>Iri_ExpandingContents_AllowedSize</span>))]</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R681" data-line-number="681"></td>

  <td>
    <span data-code-marker="+">        <span>public</span> <span>static</span> <span>void</span> <span>Iri_ExpandingContents_DoesNotThrowIfSizeAllowed</span>(<span>string</span> <span>input</span>)</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R682" data-line-number="682"></td>

  <td>
    <span data-code-marker="+">        {</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R683" data-line-number="683"></td>

  <td>
    <span data-code-marker="+">            <span>Uri</span> <span>itemUri</span> <span>=</span> <span>new</span> <span>Uri</span>(<span>input</span>);</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R684" data-line-number="684"></td>

  <td>
    <span data-code-marker="+">            <span>Assert</span>.<span>True</span>(<span>Uri</span>.<span>TryCreate</span>(<span>input</span>, <span>UriKind</span>.<span>Absolute</span>, <span>out</span> <span>Uri</span> <span>itemUri2</span>));</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R685" data-line-number="685"></td>

  <td>
    <span data-code-marker="+">        }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5L601" data-line-number="601"></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R686" data-line-number="686"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="a8b3178a71f3a3f9e30305bb46e1ed97">
    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5L602" data-line-number="602"></td>

    <td id="diff-0ee3ae0e5a3856e09c44dc0b7ea5bbd5R687" data-line-number="687"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>





          </tbody></table>
        </div>

  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>