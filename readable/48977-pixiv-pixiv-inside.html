<!DOCTYPE html>
<html lang="en">
<head>
    <title>
pixiv&#x306B;&#x8106;&#x5F31;&#x306A;&#x30D1;&#x30B9;&#x30EF;&#x30FC;&#x30C9;&#x3067;&#x767B;&#x9332;&#x3067;&#x304D;&#x306A;&#x3044;&#x3088;&#x3046;&#x306B;&#x3057;&#x307E;&#x3057;&#x305F; - pixiv inside -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>pixivに脆弱なパスワードで登録できないようにしました - pixiv inside</h1><div><div class="entry-content"><p></p><figure class="figure-image figure-image-fotolife" title="図1: 脆弱なパスワードを入力した場合のエラー画面"><span itemscope="itemscope" itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/p/pxvpxv/20200120/20200120162946.png" alt="f:id:pxvpxv:20200120162946p:plain" title="f:id:pxvpxv:20200120162946p:plain" class="hatena-fotolife" itemprop="image"></span><figcaption>図1: 脆弱なパスワードを入力した場合のエラー画面</figcaption></figure><p></p><p>こんにちは、pixiv開発支援チームのmipsparcです。</p><p>パスワード、もしかして使いまわしていますか?
複数のサービスで同じパスワードを利用していると、「パスワードリスト型攻撃」によって不正アクセスの被害を受けてしまうかもしれません。
パスワードリスト型攻撃の被害にあわないためには、ブラウザやパスワード管理ツールで自動生成された安全なパスワードを利用するのが好ましいです。</p><p>しかし、実際には多くの人が「使いまわしたパスワード」や「簡単なパスワード」(以下、脆弱なパスワード)を利用していますし、啓蒙活動にも限界があります。
pixivではサイバー攻撃への対策を複数とっていますが、根本的な対策のひとつとして、脆弱なパスワードを新しく設定できないようにしました。</p><h3>脆弱なパスワードの判定方法</h3><p>脆弱なパスワードの利用はどのように防ぐことができるでしょうか？</p><p>好ましくない方法としては、「英数字、大文字小文字記号すべてを含む」といった制限を設ける方法があります。しかし、これではパスワードの使い回しの防止にはなりません。また、仕方なくパスワードの末尾に「1」などをつけてこの制限を回避してしまうユーザーもいるでしょう。
ほかの一般的な方法としては、辞書に載っている単語やキー配置などから推測できる単語のリストを作成して制限することがあると思います。こちらは簡単なパスワードを防止するのには有効な方法ですが、パスワードの使い回しの防止にはなりませんし、リストを網羅的に作成するのは困難でしょう。</p><p>今回は先進的な取り組みとして、過去に他のサービスで漏洩済みとして公開されている、ハッシュ化<a href="#f-cd2b1c1b" name="fn-cd2b1c1b" title="ハッシュ化: 逆関数の計算が困難な関数「ハッシュ関数」によりもとのパスワードへの復元が困難な状態にすること。">*1</a>された漏洩パスワードのリストを使用しました。この方法は、実際にユーザーに使われている「生きた」パスワードのリストなので、網羅性がある点で優れています。また、1人が複数サービスで使いまわしているパスワードなども掲載されているため、使い回しの防止にもなります。</p><p>ハッシュ化された漏洩パスワードのリストは「Have I Been Pwned」(以下HIBP)というサービスによりセキュリティの向上のために非営利で提供されています。</p><p><cite class="hatena-citation"><a href="https://haveibeenpwned.com/Passwords">haveibeenpwned.com</a></cite></p><p>漏洩パスワードを保有することについての違法性については、不正アクセス禁止法(不正アクセス行為の禁止等に関する法律)第6条に「何人も、不正アクセス行為の用に供する目的で、不正に取得されたアクセス制御機能に係る他人の識別符号を保管してはならない。」とあり、安全確保目的でパスワードを保持することに問題はないと解釈できます。</p><p>HIBPから提供されているハッシュ化された漏洩パスワードのリストには、パスワードのSHA-1ハッシュ値と、そのパスワードが過去に漏洩した回数が含まれています。回数が多いほどより一般的で単純なパスワードだという指標になります。以下にその例を示します。</p><pre class="code" data-lang="" data-unlink="data-unlink">C7A4D890AC7326FA165E590249D32C46498F49B1 : 23547453回
7F3CCBD108E84037A2FD769956CC3CC47AEA4314 : 7799814回
1B3B77A3500CDE106787A7F45147FF00577F25E1 : 3912816回
B5AA164E9C9BF3F3602852B0C68F33B1E76EF88D : 3730471回
D3F4B20FD71CEB832BC06D4E96941A70F1D9E0D3 : 3120735回
C722F22B29D728A82FF29512438E39420836C7D0 : 2938594回</pre><p>ハッシュ値を漏洩した回数とともにデータベースに格納することで、漏洩回数が多いパスワードから段階的に使用できなくすることができます。なお、執筆時最新のバージョン5では5億5千万件程度のハッシュ値が含まれており、情報量が大きいので取り扱いには注意が必要です。pixivでは運用との兼ね合いから、一定の漏洩回数以上のパスワードのみをデータベースに格納しています。</p><h3>先行事例</h3><p>PythonのソフトウェアリポジトリサービスのPyPIでは、すでにHIBPを利用して漏洩したパスワードを使用しているユーザーに告知するセキュリティ対策を行っています。</p><p>また、Google パスワード マネージャーにも、保存されたパスワードが不正利用されていないかを確認する機能があり、同様に漏洩したパスワードを活用しています。</p><h3>この取り組みの根拠</h3><p>NIST(アメリカ国立標準技術研究所)は、文書SP 800-63B「Digital Identity Guidelines: Authentication and Lifecycle Management」内の「5.1.1.2 Memorized Secret Verifiers」(いわゆるパスワードに相当する)について、以下の見解を示しています。(原文から翻訳・要約)</p><blockquote><ul><li>過去の漏洩事案により入手したパスワード</li><li>辞書にある単語</li><li>繰り返したり順番になっている文字列(<code>aaaaaa</code>や<code>1234abcd</code>など)</li><li>サービス名やユーザー名など、推測可能な単語</li></ul><p>などに入力されたパスワードが合致した場合は拒絶して、その理由を伝えるものとする。</p></blockquote><p>漏洩パスワードを設定できなくする本施策はこの見解に沿うものです。なお、「辞書にある単語」や「繰り返したり順番になっている単語」もその多くが漏洩パスワードに含まれているため、別途追加することはしていません。</p><h3>今後の展望</h3><p>新規設定だけでなく、すでにご利用いただいている方についても脆弱なパスワードを順次変更いただく取り組みを進めていきたいと考えています。
さらに、FIDOや多要素認証といったパスワードに頼らない認証方法によるセキュリティ強化についても対応していく計画です。</p><h3>参考リンク</h3><div class="profile-cards-list"><div class="profile-card-container"><a href="http://f.hatena.ne.jp/pxv/20191219014125"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/p/pxv/20191219/20191219014125.png" alt="20191219014125"></a><p class="profile-author-name">mipsparc</p><p class="profile-author-description">
pixiv開発支援チームで主にpixivのPHPコードを改善したり、お問い合わせシステムを作っています。最近、鉄道車両における制御ネットワークの同人誌を出しました。
</p></div></div></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>