<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Payment Request API - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Payment Request API - linksfor.dev(s)"/>
    <meta property="article:author" content="Marcos C&#xE1;ceres&#xA;            (Mozilla)"/>
    <meta property="og:description" content="This specification standardizes an API to allow merchants (i.e. web&#xA;        sites selling physical or digital goods) to utilize one or more payment&#xA;        methods with minimal integration. User agents (e.g., browsers)&#xA;        facilitate the payment flow between merchant and user."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.w3.org/TR/payment-request/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Payment Request API</title>
<div class="readable">
        <h1>Payment Request API</h1>
            <div>by Marcos C&#xE1;ceres&#xA;            (Mozilla)</div>
            <div>Reading time: 159-202 minutes</div>
        <div>Posted here: 02 Mar 2020</div>
        <p><a href="https://www.w3.org/TR/payment-request/">https://www.w3.org/TR/payment-request/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><p id="toc-nav"><a id="toc-jump" href="#toc"> <span>Jump to Table of Contents</span></a><a id="toc-toggle" href="#toc"> <span>Collapse Sidebar</span></a></p>
    
    <section id="abstract"><h2>Abstract</h2>
      <p>
        This specification standardizes an API to allow merchants (i.e. web
        sites selling physical or digital goods) to utilize one or more payment
        methods with minimal integration. User agents (e.g., browsers)
        facilitate the payment flow between merchant and user.
      </p>
    </section>
    <section id="sotd"><h2>Status of This Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at https://www.w3.org/TR/.</em></p>
      <p>
        The working group maintains <a href="https://github.com/w3c/payment-request/issues?utf8=%E2%9C%93&amp;q=is%3Aopen%20is%3Aissue%20-label%3A%22Priority%3A%20Postponed%22%20">
        a list of all bug reports that the group has not yet addressed</a>.
        Pull requests with proposed specification text for outstanding issues
        are strongly encouraged.
      </p>
      <p>
        The working group will demonstrate implementation experience by
        producing an <a href="https://w3c.github.io/test-results/payment-request/all.html">implementation
        report</a>. The report will show two or more independent
        implementations passing each mandatory test in the <a href="https://w3c-test.org/payment-request/">test suite</a> (i.e., each test
        corresponds to a <em title="MUST">MUST</em> requirement of the specification).
      </p>
      <p>
        There has been no change in dependencies on other workings groups
        during the development of this specification.
      </p>
      <p>
      This document was published by the <a href="https://www.w3.org/Payments/WG/">Web Payments Working Group</a> as a
      Candidate Recommendation.
      This document is intended to become a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.
    </p><p>
      <a href="https://github.com/w3c/payment-request/issues/">GitHub Issues</a> are preferred for
            discussion of this specification.
          
      
    </p><p>
                              
                  <abbr title="World Wide Web Consortium">W3C</abbr> publishes a Candidate Recommendation to indicate that the document is believed to be
                  stable and to encourage implementation by the developer community. This Candidate
                  Recommendation is expected to advance to Proposed Recommendation no earlier than
                  01 June 2020.
                
                              
                              
                            </p><p>
      Please see the Working Group's
      <a href="https://w3c.github.io/test-results/payment-request/all.html">implementation report</a>.
    </p><p>
      Publication as a Candidate Recommendation does not imply endorsement by the
      <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may be updated, replaced or
      obsoleted by other documents at any time. It is inappropriate to cite this
      document as other than work in progress.
    </p><p>
      
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
       
      
                  <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                  <a rel="disclosure" href="https://www.w3.org/2004/01/pp-impl/83744/status">public list of any patent disclosures</a>
            made in connection with the deliverables of
            the group; that page also includes
            instructions for disclosing a patent. An individual who has actual
            knowledge of a patent which the individual believes contains
            <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
            must disclose the information in accordance with
            <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
      
    </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2019/Process-20190301/">1 March 2019 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p><section>
        <h3 id="changes-since-last-publication">
          Changes since last publication
        <a aria-label="ยง" href="#changes-since-last-publication"></a></h3>
        <p>
          Substantive changes to the Payment Request API since the 9 July 2018
          version are as follows. The complete list of changes, including all
          editorial changes, is viewable in the <a href="https://github.com/w3c/payment-request/commits/gh-pages">commit
          history</a>.
        </p>
        <ul>
          <li>Added support for notification when the user selects a payment
          handler, but before confirming payment. This allows merchant to
          update totals, validate acceptance, etc.
          </li>
          <li>Added support to notify site of billing address selection. This
          allows a merchant to update a total (e.g., for VAT in Europe). To
          enhance privacy, only some billing address data is returned to the
          merchant as long as the user has not confirmed payment.
          </li>
          <li>Added support for <a data-lt="PaymentResponse.retry()" href="#dom-paymentresponse-retry" data-link-type="idl"><code>retry()</code></a> and fine-grain error reporting
          to the user.
          </li>
          <li>Added support for merchant validation by the payment handler.
          </li>
          <li data-link-for="PaymentRequest">Clearer definition of
          <a href="#dom-paymentrequest-canmakepayment" data-link-type="idl"><code>canMakePayment()</code></a> and worked to align implementations.
          <a href="#dom-paymentrequest-canmakepayment" data-link-type="idl"><code>canMakePayment()</code></a> does not reveal whether payment handler is
          primed to pay.
          </li>
          <li>Removed <code>languageCode</code> and <code>regionCode</code>
          from <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>.
          </li>
          <li>Removed <code>currencySystem</code>.
          </li>
          <li>"<a href="#dfn-payment-request-is-showing" data-link-type="dfn">Payment request is showing</a>" boolean now attached to
          top-level browsing context. Previously, only a single payment UI was
          allowed to be shown at a time across the whole browser. This now
          allows multiple browser tabs to show a payment UI at the same time
          (for those payment handlers able to support it).
          </li>
          <li>Integrated with <cite><a href="https://www.w3.org/TR/feature-policy-1/">Feature Policy</a></cite>.
          </li>
          <li>Defined handling of multiple applicable modifiers.
          </li>
        </ul>
      </section>
    </section><nav id="toc"><h2 id="table-of-contents">Table of Contents</h2><ol><li><a href="#introduction"><bdi>1. </bdi>
        Introduction
      </a><ol><li><a href="#goals"><bdi>1.1 </bdi>
          Goals and scope
        </a></li></ol></li><li><a href="#examples-of-usage"><bdi>2. </bdi>
        Examples of usage
      </a><ol><li><a href="#declaring-multiple-ways-of-paying"><bdi>2.1 </bdi>
          Declaring multiple ways of paying
        </a></li><li><a href="#describing-what-is-being-paid-for"><bdi>2.2 </bdi>
          Describing what is being paid for
        </a></li><li><a href="#adding-shipping-options"><bdi>2.3 </bdi>
          Adding shipping options
        </a></li><li><a href="#conditional-modifications-to-payment-request"><bdi>2.4 </bdi>
          Conditional modifications to payment request
        </a></li><li><a href="#requesting-specific-information-from-the-end-user"><bdi>2.5 </bdi>
          Requesting specific information from the end user
        </a></li><li><a href="#constructing-a-paymentrequest"><bdi>2.6 </bdi>
          Constructing a <code>PaymentRequest</code>
        </a></li><li><a href="#handling-events-and-updating-the-payment-request"><bdi>2.7 </bdi>
          Handling events and updating the payment request
        </a></li><li><a href="#fine-grained-error-reporting"><bdi>2.8 </bdi>
          Fine-grained error reporting
        </a></li><li><a href="#posting-payment-response-back-to-a-server"><bdi>2.9 </bdi>
          POSTing payment response back to a server
        </a></li></ol></li><li><a href="#paymentrequest-interface"><bdi>3. </bdi>
        <span data-dfn-type="interface" data-export="" data-idl="interface" data-title="PaymentRequest" data-dfn-for=""><code>PaymentRequest</code></span> interface
      </a><ol><li><a href="#constructor"><bdi>3.1 </bdi>
          Constructor
        </a></li><li><a href="#id-attribute"><bdi>3.2 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="id" data-dfn-for="PaymentRequest" data-type="DOMString" data-lt="PaymentRequest.id|id"><code>id</code></span> attribute
        </a></li><li><a href="#show-method"><bdi>3.3 </bdi>
          <span data-dfn-type="method" data-export="" data-idl="operation" data-title="show()" data-dfn-for="PaymentRequest" data-type="Promise" data-lt="PaymentRequest.show()|PaymentRequest.show|show()|show"><code>show()</code></span> method
        </a></li><li><a href="#abort-method"><bdi>3.4 </bdi>
          <span data-dfn-type="method" data-export="" data-idl="operation" data-title="abort()" data-dfn-for="PaymentRequest" data-type="Promise" data-lt="PaymentRequest.abort()|PaymentRequest.abort|abort()|abort"><code>abort()</code></span> method
        </a></li><li><a href="#canmakepayment-method"><bdi>3.5 </bdi>
          <span data-dfn-type="method" data-export="" data-idl="operation" data-title="canMakePayment()" data-dfn-for="PaymentRequest" data-type="Promise" data-lt="PaymentRequest.canMakePayment()|PaymentRequest.canMakePayment|canMakePayment()|canMakePayment"><code>canMakePayment()</code></span> method
        </a></li><li><a href="#shippingaddress-attribute"><bdi>3.6 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="shippingAddress" data-dfn-for="PaymentRequest" data-type="PaymentAddress" data-lt="PaymentRequest.shippingAddress|shippingAddress"><code>shippingAddress</code></span> attribute
        </a></li><li><a href="#shippingtype-attribute"><bdi>3.7 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="shippingType" data-dfn-for="PaymentRequest" data-type="PaymentShippingType" data-lt="PaymentRequest.shippingType|shippingType"><code>shippingType</code></span> attribute
        </a></li><li><a href="#onmerchantvalidation-attribute"><bdi>3.8 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="onmerchantvalidation" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onmerchantvalidation|onmerchantvalidation"><code>onmerchantvalidation</code></span> attribute
        </a></li><li><a href="#onshippingaddresschange-attribute"><bdi>3.9 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="onshippingaddresschange" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onshippingaddresschange|onshippingaddresschange"><code>onshippingaddresschange</code></span> attribute
        </a></li><li><a href="#shippingoption-attribute"><bdi>3.10 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="shippingOption" data-dfn-for="PaymentRequest" data-type="DOMString" data-lt="PaymentRequest.shippingOption|shippingOption"><code>shippingOption</code></span> attribute
        </a></li><li><a href="#onshippingoptionchange-attribute"><bdi>3.11 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="onshippingoptionchange" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onshippingoptionchange|onshippingoptionchange"><code>onshippingoptionchange</code></span> attribute
        </a></li><li><a href="#onpaymentmethodchange-attribute"><bdi>3.12 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="onpaymentmethodchange" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onpaymentmethodchange|onpaymentmethodchange"><code>onpaymentmethodchange</code></span> attribute
        </a></li><li><a href="#internal-slots"><bdi>3.13 </bdi>
          Internal Slots
        </a></li></ol></li><li><a href="#paymentmethoddata-dictionary"><bdi>4. </bdi>
        <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentMethodData" data-dfn-for=""><code>PaymentMethodData</code></span> dictionary
      </a></li><li><a href="#paymentcurrencyamount-dictionary"><bdi>5. </bdi>
        <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentCurrencyAmount" data-dfn-for=""><code>PaymentCurrencyAmount</code></span> dictionary
      </a><ol><li><a href="#validity-checkers"><bdi>5.1 </bdi>
          Validity checkers
        </a></li></ol></li><li><a href="#payment-details-dictionaries"><bdi>6. </bdi>
        Payment details dictionaries
      </a><ol><li><a href="#paymentdetailsbase-dictionary"><bdi>6.1 </bdi>
          <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentDetailsBase" data-dfn-for=""><code>PaymentDetailsBase</code></span> dictionary
        </a></li><li><a href="#paymentdetailsinit-dictionary"><bdi>6.2 </bdi>
          <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentDetailsInit" data-dfn-for=""><code>PaymentDetailsInit</code></span> dictionary
        </a></li><li><a href="#paymentdetailsupdate-dictionary"><bdi>6.3 </bdi>
          <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentDetailsUpdate" data-dfn-for=""><code>PaymentDetailsUpdate</code></span> dictionary
        </a></li></ol></li><li><a href="#paymentdetailsmodifier-dictionary"><bdi>7. </bdi>
        <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentDetailsModifier" data-dfn-for=""><code>PaymentDetailsModifier</code></span> dictionary
      </a></li><li><a href="#paymentshippingtype-enum"><bdi>8. </bdi>
        <span data-dfn-type="enum" data-export="" data-idl="enum" data-title="PaymentShippingType" data-dfn-for=""><code>PaymentShippingType</code></span> enum
      </a></li><li><a href="#paymentoptions-dictionary"><bdi>9. </bdi>
        <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentOptions" data-dfn-for=""><code>PaymentOptions</code></span> dictionary
      </a></li><li><a href="#paymentitem-dictionary"><bdi>10. </bdi>
        <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentItem" data-dfn-for=""><code>PaymentItem</code></span> dictionary
      </a></li><li><a href="#physical-addresses"><bdi>11. </bdi>
        Physical addresses
      </a><ol><li><a href="#paymentaddress-interface"><bdi>11.1 </bdi>
          <span data-dfn-type="interface" data-export="" data-idl="interface" data-title="PaymentAddress" data-dfn-for=""><code>PaymentAddress</code></span> interface
        </a><ol><li><a href="#internal-constructor"><bdi>11.1.1 </bdi>
            Internal constructor
          </a></li><li><a href="#tojson-method"><bdi>11.1.2 </bdi>
            <span data-dfn-type="method" data-export="" data-idl="operation" data-title="toJSON()" data-dfn-for="PaymentAddress" data-type="object" data-lt="PaymentAddress.toJSON()|PaymentAddress.toJSON|toJSON()|toJSON"><code>toJSON()</code></span> method
          </a></li><li><a href="#country-attribute"><bdi>11.1.3 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="country" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.country|country"><code>country</code></span> attribute
          </a></li><li><a href="#addressline-attribute"><bdi>11.1.4 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="addressLine" data-dfn-for="PaymentAddress" data-type="FrozenArray" data-lt="PaymentAddress.addressLine|addressLine"><code>addressLine</code></span> attribute
          </a></li><li><a href="#region-attribute"><bdi>11.1.5 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="region" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.region|region"><code>region</code></span> attribute
          </a></li><li><a href="#city-attribute"><bdi>11.1.6 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="city" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.city|city"><code>city</code></span> attribute
          </a></li><li><a href="#dependentlocality-attribute"><bdi>11.1.7 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="dependentLocality" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.dependentLocality|dependentLocality"><code>dependentLocality</code></span> attribute
          </a></li><li><a href="#postalcode-attribute"><bdi>11.1.8 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="postalCode" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.postalCode|postalCode"><code>postalCode</code></span> attribute
          </a></li><li><a href="#sortingcode-attribute"><bdi>11.1.9 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="sortingCode" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.sortingCode|sortingCode"><code>sortingCode</code></span> attribute
          </a></li><li><a href="#organization-attribute"><bdi>11.1.10 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="organization" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.organization|organization"><code>organization</code></span> attribute
          </a></li><li><a href="#recipient-attribute"><bdi>11.1.11 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="recipient" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.recipient|recipient"><code>recipient</code></span> attribute
          </a></li><li><a href="#phone-attribute"><bdi>11.1.12 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="phone" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.phone|phone"><code>phone</code></span> attribute
          </a></li><li><a href="#internal-slots-0"><bdi>11.1.13 </bdi>
            <span data-lt="PaymentAddress slots" data-lt-nodefault="" data-dfn-type="dfn">Internal
            slots</span>
          </a></li></ol></li><li><a href="#addressinit-dictionary"><bdi>11.2 </bdi>
          <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="AddressInit" data-dfn-for=""><code>AddressInit</code></span> dictionary
        </a></li><li><a href="#addresserrors-dictionary"><bdi>11.3 </bdi>
          <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="AddressErrors" data-dfn-for=""><code>AddressErrors</code></span> dictionary
        </a></li><li><a href="#creating-a-paymentaddress-from-user-provided-input"><bdi>11.4 </bdi>
          Creating a <code>PaymentAddress</code> from user-provided input
        </a></li></ol></li><li><a href="#paymentshippingoption-dictionary"><bdi>12. </bdi>
        <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentShippingOption" data-dfn-for=""><code>PaymentShippingOption</code></span> dictionary
      </a></li><li><a href="#paymentcomplete-enum"><bdi>13. </bdi>
        <span data-dfn-type="enum" data-export="" data-idl="enum" data-title="PaymentComplete" data-dfn-for=""><code>PaymentComplete</code></span> enum
      </a></li><li><a href="#paymentresponse-interface"><bdi>14. </bdi>
        <span data-dfn-type="interface" data-export="" data-idl="interface" data-title="PaymentResponse" data-dfn-for=""><code>PaymentResponse</code></span> interface
      </a><ol><li><a href="#retry-method"><bdi>14.1 </bdi>
          <span data-dfn-type="method" data-export="" data-idl="operation" data-title="retry()" data-dfn-for="PaymentResponse" data-type="Promise" data-lt="PaymentResponse.retry()|PaymentResponse.retry|retry()|retry"><code>retry()</code></span> method
        </a><ol><li><a href="#paymentvalidationerrors-dictionary"><bdi>14.1.1 </bdi>
            <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentValidationErrors" data-dfn-for=""><code>PaymentValidationErrors</code></span> dictionary
          </a></li><li><a href="#payererrors-dictionary"><bdi>14.1.2 </bdi>
            <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PayerErrors" data-dfn-for=""><code>PayerErrors</code></span> dictionary
          </a></li></ol></li><li><a href="#tojson-method-0"><bdi>14.2 </bdi>
          <span data-dfn-type="method" data-export="" data-idl="operation" data-title="toJSON()" data-dfn-for="PaymentResponse" data-type="object" data-lt="PaymentResponse.toJSON()|PaymentResponse.toJSON|toJSON()|toJSON"><code>toJSON()</code></span> method
        </a></li><li><a href="#methodname-attribute"><bdi>14.3 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="methodName" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.methodName|methodName"><code>methodName</code></span> attribute
        </a></li><li><a href="#details-attribute"><bdi>14.4 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="details" data-dfn-for="PaymentResponse" data-type="object" data-lt="PaymentResponse.details|details"><code>details</code></span> attribute
        </a></li><li><a href="#shippingaddress-attribute-0"><bdi>14.5 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="shippingAddress" data-dfn-for="PaymentResponse" data-type="PaymentAddress" data-lt="PaymentResponse.shippingAddress|shippingAddress"><code>shippingAddress</code></span> attribute
        </a></li><li><a href="#shippingoption-attribute-0"><bdi>14.6 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="shippingOption" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.shippingOption|shippingOption"><code>shippingOption</code></span> attribute
        </a></li><li><a href="#payername-attribute"><bdi>14.7 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="payerName" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.payerName|payerName"><code>payerName</code></span> attribute
        </a></li><li><a href="#payeremail-attribute"><bdi>14.8 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="payerEmail" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.payerEmail|payerEmail"><code>payerEmail</code></span> attribute
        </a></li><li><a href="#payerphone-attribute"><bdi>14.9 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="payerPhone" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.payerPhone|payerPhone"><code>payerPhone</code></span> attribute
        </a></li><li><a href="#requestid-attribute"><bdi>14.10 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="requestId" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.requestId|requestId"><code>requestId</code></span> attribute
        </a></li><li><a href="#complete-method"><bdi>14.11 </bdi>
          <span data-lt="complete(result)|complete()|PaymentResponse.complete()|PaymentResponse.complete|complete" data-dfn-type="method" data-export="" data-idl="operation" data-title="complete()" data-dfn-for="PaymentResponse" data-type="Promise"><code>complete()</code></span> method
        </a></li><li><a href="#onpayerdetailchange-attribute"><bdi>14.12 </bdi>
          <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="onpayerdetailchange" data-dfn-for="PaymentResponse" data-type="EventHandler" data-lt="PaymentResponse.onpayerdetailchange|onpayerdetailchange"><code>onpayerdetailchange</code></span> attribute
        </a></li><li><a href="#internal-slots-1"><bdi>14.13 </bdi>
          Internal Slots
        </a></li></ol></li><li><a href="#paymentrequest-and-iframe-elements"><bdi>15. </bdi>
        <code>PaymentRequest</code> and <code>iframe</code> elements
      </a></li><li><a href="#feature-policy"><bdi>16. </bdi>
        Feature Policy integration
      </a></li><li><a href="#events"><bdi>17. </bdi>
        Events
      </a><ol><li><a href="#summary"><bdi>17.1 </bdi>
          Summary
        </a></li><li><a href="#merchantvalidationevent-interface"><bdi>17.2 </bdi>
          <span data-dfn-type="interface" data-export="" data-idl="interface" data-title="MerchantValidationEvent" data-dfn-for=""><code>MerchantValidationEvent</code></span> interface
        </a><ol><li><a href="#methodname-attribute-0"><bdi>17.2.1 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="methodName" data-dfn-for="MerchantValidationEvent" data-type="DOMString" data-lt="MerchantValidationEvent.methodName|methodName"><code>methodName</code></span> attribute
          </a></li><li><a href="#merchantvalidationevent-constructor"><bdi>17.2.2 </bdi>
            <span data-lt="MerchantValidationEvent.MerchantValidationEvent()|MerchantValidationEvent constructor" data-dfn-type="dfn"><code>MerchantValidationEvent</code>
            constructor</span>
          </a></li><li><a href="#validationurl-attribute"><bdi>17.2.3 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="validationURL" data-dfn-for="MerchantValidationEvent" data-type="USVString" data-lt="MerchantValidationEvent.validationURL|validationURL"><code>validationURL</code></span> attribute
          </a></li><li><a href="#complete-method-0"><bdi>17.2.4 </bdi>
            <span data-dfn-type="method" data-export="" data-idl="operation" data-title="complete()" data-dfn-for="MerchantValidationEvent" data-type="void" data-lt="MerchantValidationEvent.complete()|MerchantValidationEvent.complete|complete()|complete"><code>complete()</code></span> method
          </a></li><li><a href="#internal-slots-2"><bdi>17.2.5 </bdi>
            Internal Slots
          </a></li><li><a href="#merchantvalidationeventinit-dictionary"><bdi>17.2.6 </bdi>
            <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="MerchantValidationEventInit" data-dfn-for=""><code>MerchantValidationEventInit</code></span> dictionary
          </a></li></ol></li><li><a href="#paymentmethodchangeevent-interface"><bdi>17.3 </bdi>
          <span data-dfn-type="interface" data-export="" data-idl="interface" data-title="PaymentMethodChangeEvent" data-dfn-for=""><code>PaymentMethodChangeEvent</code></span> interface
        </a><ol><li><a href="#methoddetails-attribute"><bdi>17.3.1 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="methodDetails" data-dfn-for="PaymentMethodChangeEvent" data-type="object" data-lt="PaymentMethodChangeEvent.methodDetails|methodDetails"><code>methodDetails</code></span> attribute
          </a></li><li><a href="#methodname-attribute-1"><bdi>17.3.2 </bdi>
            <span data-dfn-type="attribute" data-export="" data-idl="attribute" data-title="methodName" data-dfn-for="PaymentMethodChangeEvent" data-type="DOMString" data-lt="PaymentMethodChangeEvent.methodName|methodName"><code>methodName</code></span> attribute
          </a></li><li><a href="#paymentmethodchangeeventinit-dictionary"><bdi>17.3.3 </bdi>
            <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentMethodChangeEventInit" data-dfn-for=""><code>PaymentMethodChangeEventInit</code></span> dictionary
          </a></li></ol></li><li><a href="#paymentrequestupdateevent-interface"><bdi>17.4 </bdi>
          <span data-dfn-type="interface" data-export="" data-idl="interface" data-title="PaymentRequestUpdateEvent" data-dfn-for=""><code>PaymentRequestUpdateEvent</code></span> interface
        </a><ol><li><a href="#constructor-0"><bdi>17.4.1 </bdi>
            <span data-lt="PaymentRequestUpdateEvent.PaymentRequestUpdateEvent()|Constructor|PaymentRequestUpdateEvent.constructor()|PaymentRequestUpdateEvent.constructor|constructor()|constructor" data-dfn-type="constructor" data-export="" data-idl="constructor" data-title="Constructor" data-dfn-for="PaymentRequestUpdateEvent"><code>Constructor</code></span>
          </a></li><li><a href="#updatewith-method"><bdi>17.4.2 </bdi>
            <span data-lt="updateWith(detailsPromise)|updateWith()|PaymentRequestUpdateEvent.updateWith()|PaymentRequestUpdateEvent.updateWith|updateWith" data-dfn-type="method" data-export="" data-idl="operation" data-title="updateWith()" data-dfn-for="PaymentRequestUpdateEvent" data-type="void"><code>updateWith()</code></span> method
          </a></li><li><a href="#internal-slots-3"><bdi>17.4.3 </bdi>
            Internal Slots
          </a></li><li><a href="#paymentrequestupdateeventinit-dictionary"><bdi>17.4.4 </bdi>
            <span data-dfn-type="dictionary" data-export="" data-idl="dictionary" data-title="PaymentRequestUpdateEventInit" data-dfn-for=""><code>PaymentRequestUpdateEventInit</code></span> dictionary
          </a></li></ol></li></ol></li><li><a href="#algorithms"><bdi>18. </bdi>
        Algorithms
      </a><ol><li><a href="#merchant-validation"><bdi>18.1 </bdi>
          Merchant validation
        </a></li><li><a href="#shipping-address-changed-algorithm"><bdi>18.2 </bdi>
          Shipping address changed algorithm
        </a></li><li><a href="#shipping-option-changed-algorithm"><bdi>18.3 </bdi>
          Shipping option changed algorithm
        </a></li><li><a href="#payment-method-changed-algorithm"><bdi>18.4 </bdi>
          Payment method changed algorithm
        </a></li><li><a href="#paymentrequest-updated-algorithm"><bdi>18.5 </bdi>
          PaymentRequest updated algorithm
        </a></li><li><a href="#payer-detail-changed-algorithm"><bdi>18.6 </bdi>
          Payer detail changed algorithm
        </a></li><li><a href="#user-accepts-the-payment-request-algorithm"><bdi>18.7 </bdi>
          User accepts the payment request algorithm
        </a></li><li><a href="#user-aborts-the-payment-request-algorithm"><bdi>18.8 </bdi>
          User aborts the payment request algorithm
        </a></li><li><a href="#update-a-paymentrequest-s-details-algorithm"><bdi>18.9 </bdi>
          Update a <code>PaymentRequest</code>'s details algorithm
        </a><ol><li><a href="#abort-the-update"><bdi>18.9.1 </bdi>
            Abort the update
          </a></li></ol></li><li><a href="#validate-merchant-s-details-algorithm"><bdi>18.10 </bdi>
          Validate merchant's details algorithm
        </a></li></ol></li><li><a href="#privacy"><bdi>19. </bdi>
        Privacy and Security Considerations
      </a><ol><li><a href="#user-protections-with-show-method"><bdi>19.1 </bdi>
          User protections with <code>show()</code> method
        </a></li><li><a href="#secure-contexts"><bdi>19.2 </bdi>
          Secure contexts
        </a></li><li><a href="#cross-origin-payment-requests"><bdi>19.3 </bdi>
          Cross-origin payment requests
        </a></li><li><a href="#encryption-of-data-fields"><bdi>19.4 </bdi>
          Encryption of data fields
        </a></li><li><a href="#how-user-agents-match-payment-handlers"><bdi>19.5 </bdi>
          How user agents match payment handlers
        </a></li><li><a href="#data-usage-0"><bdi>19.6 </bdi>
          Data usage
        </a></li><li><a href="#exposing-user-information"><bdi>19.7 </bdi>
          Exposing user information
        </a></li><li><a href="#merchant-validation-0"><bdi>19.8 </bdi>
          Merchant Validation
        </a></li><li><a href="#canmakepayment-protections-0"><bdi>19.9 </bdi>
          <code>canMakePayment()</code> protections
        </a></li></ol></li><li><a href="#accessibility-considerations"><bdi>20. </bdi>
        Accessibility Considerations
      </a></li><li><a href="#dependencies"><bdi>21. </bdi>
        Dependencies
      </a></li><li><a href="#conformance"><bdi>22. </bdi>Conformance</a></li><li><a href="#idl-index"><bdi>A. </bdi>IDL Index</a></li><li><a href="#acknowledgements"><bdi>B. </bdi>
        Acknowledgements
      </a></li><li><a href="#changelog"><bdi>C. </bdi>Changelog</a></li><li><a href="#references"><bdi>D. </bdi>References</a><ol><li><a href="#normative-references"><bdi>D.1 </bdi>Normative references</a></li><li><a href="#informative-references"><bdi>D.2 </bdi>Informative references</a></li></ol></li></ol></nav>
    <section id="introduction">
      <h2 id="x1-introduction"><bdi>1. </bdi>
        Introduction
      <a aria-label="ยง" href="#introduction"></a></h2><p><em>This section is non-normative.</em></p>
      <p>
        This specification describes an API that allows <a href="#dfn-user-agent" data-link-type="dfn">user agents</a>
        (e.g., browsers) to act as an intermediary between three parties in a
        transaction:
      </p>
      <ul>
        <li>The payee: the merchant that runs an online store, or other party
        that requests to be paid.
        </li>
        <li>The payer: the party that makes a purchase at that online store,
        and who authenticates and authorizes payment as required.
        </li>
        <li>The <dfn data-dfn-type="dfn" data-plurals="payment methods" id="dfn-payment-method">payment method</dfn>: the means that the payer uses to pay
        the payee (e.g., a basic card payment). The <dfn data-dfn-type="dfn" id="dfn-payment-method-provider">payment method
        provider</dfn> establishes the ecosystem to support that payment
        method.
        </li>
      </ul>
      <p>
        The details of how to fulfill a payment request for a given <a href="#dfn-payment-method" data-link-type="dfn">payment
        method</a> is an implementation detail of a <dfn data-dfn-type="dfn" data-plurals="payment handlers" id="dfn-payment-handler">payment handler</dfn>.
        Concretely, each payment handler defines:
      </p>
      <dl>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-steps-to-check-if-a-payment-can-be-made">Steps to check if a payment can be made</dfn>:
        </dt>
        <dd>
          How a payment handler determines whether it, or the user, can
          potentially "make a payment" is also an implementation detail of a
          payment handler. For an example, see the <a href="https://www.w3.org/TR/payment-method-basic-card/#steps-to-check-if-a-payment-can-be-made">can
          make payment</a> algorithm of [<cite><a href="#bib-payment-method-basic-card" title="Basic Card Payment" data-link-type="biblio">payment-method-basic-card</a></cite>].
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-steps-to-respond-to-a-payment-request">Steps to respond to a payment request</dfn>:
        </dt>
        <dd>
          Steps that return an object or <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-dictionary">dictionary</a> that a merchant uses
          to process or validate the transaction. The structure of this object
          is specific to each <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>. For an example of such an
          object, see the <code><a href="https://www.w3.org/TR/payment-method-basic-card/#dom-basiccardresponse">BasicCardResponse</a></code>
          dictionary of [<cite><a href="#bib-payment-method-basic-card" title="Basic Card Payment" data-link-type="biblio">payment-method-basic-card</a></cite>].
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-steps-for-when-a-user-changes-payment-method">Steps for when a user changes payment method</dfn> (optional)
        </dt>
        <dd>
          <p>
            Steps that describe how to handle the user changing payment method
            or monetary instrument (e.g., from a debit card to a credit card)
            that results in a <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-dictionary">dictionary</a> or <a href="https://heycam.github.io/webidl/#idl-object">object</a> or null.
          </p>
        </dd>
      </dl>
      <p>
        This API also enables web sites to take advantage of more secure
        payment schemes (e.g., tokenization and system-level authentication)
        that are not possible with standard JavaScript libraries. This has the
        potential to reduce liability for the merchant and helps protect
        sensitive user information.
      </p>
      <section id="goals">
        <h3 id="x1-1-goals-and-scope"><bdi>1.1 </bdi>
          Goals and scope
        <a aria-label="ยง" href="#goals"></a></h3>
        <ul>
          <li>Allow the user agent to act as intermediary between a merchant,
          user, and <a href="#dfn-payment-method-provider" data-link-type="dfn">payment method provider</a>.
          </li>
          <li>Enable user agents to streamline the user's payment experience by
          taking into account user preferences, merchant information, security
          considerations, and other factors.
          </li>
          <li>Standardize (to the extent that it makes sense) the communication
          flow between a merchant, user agent, and <a href="#dfn-payment-method-provider" data-link-type="dfn">payment method
          provider</a>.
          </li>
          <li>Enable a <a href="#dfn-payment-method-provider" data-link-type="dfn">payment method provider</a> to bring more secure
          payment transactions to the web.
          </li>
        </ul>
        <p>
          The following are out of scope for this specification:
        </p>
        <ul>
          <li>Create a new <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>.
          </li>
          <li>Integrate directly with payment processors.
          </li>
        </ul>
      </section>
    </section>
    <section id="examples-of-usage">
      <h2 id="x2-examples-of-usage"><bdi>2. </bdi>
        Examples of usage
      <a aria-label="ยง" href="#examples-of-usage"></a></h2><p><em>This section is non-normative.</em></p>
      <p>
        In order to use the API, the developer needs to provide and keep track
        of a number of key pieces of information. These bits of information are
        passed to the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> constructor as arguments, and
        subsequently used to update the payment request being displayed to the
        user. Namely, these bits of information are:
      </p>
      <ul>
        <li>The <var>methodData</var>: A sequence of <a href="#dom-paymentmethoddata" data-link-type="idl"><code>PaymentMethodData</code></a>s that
        represents the <a href="#dfn-payment-method" data-link-type="dfn">payment methods</a> that the site supports (e.g., "we
        support card-based payments, but only Visa and MasterCard credit
        cards.").
        </li>
        <li>The <var>details</var>: The details of the transaction, as a
        <a href="#dom-paymentdetailsinit" data-link-type="idl"><code>PaymentDetailsInit</code></a> dictionary. This includes total cost, and
        optionally a list of goods or services being purchased, for physical
        goods, and shipping options. Additionally, it can optionally include
        "modifiers" to how payments are made. For example, "if you pay with a
        card belonging to network X, it incurs a US$3.00 processing fee".
        </li>
        <li>The <var>options</var>: Optionally, a list of things as
        <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> that the site needs to deliver the good or
        service (e.g., for physical goods, the merchant will typically need a
        physical address to ship to. For digital goods, an email will usually
        suffice).
        </li>
      </ul>
      <p data-link-for="PaymentRequest">
        Once a <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> is constructed, it's presented to the end
        user via the <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method. The <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> returns a promise
        that, once the user confirms request for payment, results in a
        <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>.
      </p>
      <section id="declaring-multiple-ways-of-paying">
        <h3 id="x2-1-declaring-multiple-ways-of-paying"><bdi>2.1 </bdi>
          Declaring multiple ways of paying
        <a aria-label="ยง" href="#declaring-multiple-ways-of-paying"></a></h3>
        <p>
          When constructing a new <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>, a merchant uses the
          first argument (<var>methodData</var>) to list the different ways a user can
          pay for things (e.g., credit cards, Apple Pay, Google Pay, etc.).
          More specifically, the <var>methodData</var> sequence contains
          <a href="#dom-paymentmethoddata" data-link-type="idl"><code>PaymentMethodData</code></a> dictionaries containing the <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment
          method identifiers</a> for the <a href="#dfn-payment-method" data-link-type="dfn">payment methods</a> that the
          merchant accepts and any associated <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> specific
          data (e.g., which credit card networks are supported).
        </p>
        <div id="example-1-the-methoddata-argument">
           <pre aria-busy="false"><code><span>const</span> methodData = [
  {
    <span>supportedMethods</span>: <span>"basic-card"</span>,
    <span>data</span>: {
      <span>supportedNetworks</span>: [<span>"visa"</span>, <span>"mastercard"</span>],
    },
  },
  {
    <span>supportedMethods</span>: <span>"https://example.com/bobpay"</span>,
    <span>data</span>: {
      <span>merchantIdentifier</span>: <span>"XXXX"</span>,
      <span>bobPaySpecificField</span>: <span>true</span>,
    },
  },
];</code></pre>
        </div>
      </section>
      <section id="describing-what-is-being-paid-for">
        <h3 id="x2-2-describing-what-is-being-paid-for"><bdi>2.2 </bdi>
          Describing what is being paid for
        <a aria-label="ยง" href="#describing-what-is-being-paid-for"></a></h3>
        <p>
          When constructing a new <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>, a merchant uses the
          second argument of the constructor (<var>details</var>) to provide the details
          of the transaction that the user is being asked to complete. This
          includes the total of the order and, optionally, some line items that
          can provide a detailed breakdown of what is being paid for.
        </p>
        <div id="example-2-the-details-argument">
           <pre aria-busy="false"><code><span>const</span> details = {
  <span>id</span>: <span>"super-store-order-123-12312"</span>,
  <span>displayItems</span>: [
    {
      <span>label</span>: <span>"Sub-total"</span>,
      <span>amount</span>: { <span>currency</span>: <span>"USD"</span>, <span>value</span>: <span>"55.00"</span> },
    },
    {
      <span>label</span>: <span>"Sales Tax"</span>,
      <span>amount</span>: { <span>currency</span>: <span>"USD"</span>, <span>value</span>: <span>"5.00"</span> },
      <span>type</span>: <span>"tax"</span>
    },
  ],
  <span>total</span>: {
    <span>label</span>: <span>"Total due"</span>,
    
    
    
    amount: { <span>currency</span>: <span>"USD"</span>, <span>value</span>: <span>"65.00"</span> },
  },
};</code></pre>
        </div>
      </section>
      <section id="adding-shipping-options">
        <h3 id="x2-3-adding-shipping-options"><bdi>2.3 </bdi>
          Adding shipping options
        <a aria-label="ยง" href="#adding-shipping-options"></a></h3>
        <p>
          Here we see an example of how to add two shipping options to the
          <var>details</var>.
        </p>
        <div id="example-3-adding-shipping-options">
           <pre aria-busy="false"><code><span>const</span> shippingOptions = [
  {
    <span>id</span>: <span>"standard"</span>,
    <span>label</span>: <span>"๐ Ground Shipping (2 days)"</span>,
    <span>amount</span>: { <span>currency</span>: <span>"USD"</span>, <span>value</span>: <span>"5.00"</span> },
    <span>selected</span>: <span>true</span>,
  },
  {
    <span>id</span>: <span>"drone"</span>,
    <span>label</span>: <span>"๐ Drone Express (2 hours)"</span>,
    <span>amount</span>: { <span>currency</span>: <span>"USD"</span>, <span>value</span>: <span>"25.00"</span> }
  },
];
<span>Object</span>.assign(details, { shippingOptions });</code></pre>
        </div>
      </section>
      <section id="conditional-modifications-to-payment-request">
        <h3 id="x2-4-conditional-modifications-to-payment-request"><bdi>2.4 </bdi>
          Conditional modifications to payment request
        <a aria-label="ยง" href="#conditional-modifications-to-payment-request"></a></h3>
        <p>
          Here we see how to add a processing fee for using a card on a
          particular network. Notice that it requires recalculating the total.
        </p>
        <div id="example-4-modifying-payment-request-based-on-card-type">
          <div>
      <a href="#example-4-modifying-payment-request-based-on-card-type">Example<bdi> 4</bdi></a><p><span>: Modifying payment request based on card type</span>
    </p></div> <pre aria-busy="false"><code>
<span>const</span> cardFee = {
  <span>label</span>: <span>"Card processing fee"</span>,
  <span>amount</span>: { <span>currency</span>: <span>"USD"</span>, <span>value</span>: <span>"3.00"</span> },
};



<span>const</span> modifiers = [
  {
    <span>additionalDisplayItems</span>: [cardFee],
    <span>supportedMethods</span>: <span>"basic-card"</span>,
    <span>total</span>: {
      <span>label</span>: <span>"Total due"</span>,
      <span>amount</span>: { <span>currency</span>: <span>"USD"</span>, <span>value</span>: <span>"68.00"</span> },
    },
    <span>data</span>: {
      <span>supportedNetworks</span>: networks,
    },
  },
];
<span>Object</span>.assign(details, { modifiers });</code></pre>
        </div>
      </section>
      <section id="requesting-specific-information-from-the-end-user">
        <h3 id="x2-5-requesting-specific-information-from-the-end-user"><bdi>2.5 </bdi>
          Requesting specific information from the end user
        <a aria-label="ยง" href="#requesting-specific-information-from-the-end-user"></a></h3>
        <p>
          Some financial transactions require a user to provide specific
          information in order for a merchant to fulfill a purchase (e.g., the
          user's shipping address, in case a physical good needs to be
          shipped). To request this information, a merchant can pass a third
          optional argument (<var>options</var>) to the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>
          constructor indicating what information they require. When the
          payment request is shown, the user agent will request this
          information from the end user and return it to the merchant when the
          user accepts the payment request.
        </p>
        <div id="example-5-the-options-argument">
           <pre aria-busy="false"><code><span>const</span> options = {
  <span>requestPayerEmail</span>: <span>false</span>,
  <span>requestPayerName</span>: <span>true</span>,
  <span>requestPayerPhone</span>: <span>false</span>,
  <span>requestShipping</span>: <span>true</span>,
}</code></pre>
        </div>
      </section>
      <section id="constructing-a-paymentrequest">
        <h3 id="x2-6-constructing-a-paymentrequest"><bdi>2.6 </bdi>
          Constructing a <code>PaymentRequest</code>
        <a aria-label="ยง" href="#constructing-a-paymentrequest"></a></h3>
        <p>
          Having gathered all the prerequisite bits of information, we can now
          construct a <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> and request that the browser
          present it to the user:
        </p>
        <div id="example-6-constructing-a-paymentrequest">
           <pre aria-busy="false"><code><span>async</span> <span><span>function</span> <span>doPaymentRequest</span>(<span></span>) </span>{
  <span>try</span> {
    <span>const</span> request = <span>new</span> PaymentRequest(methodData, details, options);
    
    request.onshippingaddresschange = <span><span>ev</span> =&gt;</span> ev.updateWith(details);
    request.onshippingoptionchange = <span><span>ev</span> =&gt;</span> ev.updateWith(details);
    <span>const</span> response = <span>await</span> request.show();
    <span>await</span> validateResponse(response);
  } <span>catch</span> (err) {
    
    <span>console</span>.error(err);
  }
}
<span>async</span> <span><span>function</span> <span>validateResponse</span>(<span>response</span>) </span>{
  <span>try</span> {
    <span>const</span> errors = <span>await</span> checkAllValuesAreGood(response);
    <span>if</span> (errors.length) {
      <span>await</span> request.retry(errors);
      <span>return</span> validateResponse(response);
    }
    <span>await</span> response.complete(<span>"success"</span>);
  } <span>catch</span> (err) {
    
    <span>await</span> response.complete(<span>"fail"</span>);
  }
}
doPaymentRequest();</code></pre>
        </div>
      </section>
      <section id="handling-events-and-updating-the-payment-request">
        <h3 id="x2-7-handling-events-and-updating-the-payment-request"><bdi>2.7 </bdi>
          Handling events and updating the payment request
        <a aria-label="ยง" href="#handling-events-and-updating-the-payment-request"></a></h3>
        <p>
          Prior to the user accepting to make payment, the site is given an
          opportunity to update the payment request in response to user input.
          This can include, for example, providing additional shipping options
          (or modifying their cost), removing items that cannot ship to a
          particular address, etc.
        </p>
        <div id="example-7-registering-event-handlers">
           <pre aria-busy="false"><code><span>const</span> request = <span>new</span> PaymentRequest(methodData, details, options);

request.onshippingaddresschange = <span><span>ev</span> =&gt;</span> {
  ev.updateWith(checkShipping(request));
};

request.onshippingoptionchange = <span><span>ev</span> =&gt;</span> {
  
  <span>const</span> { shippingOption } = request;
  <span>const</span> newTotal = {
    <span>currency</span>: <span>"USD"</span>,
    <span>label</span>: <span>"Total due"</span>,
    <span>value</span>: calculateNewTotal(shippingOption),
  };
  ev.updateWith({ <span>total</span>: newTotal });
};
<span>async</span> <span><span>function</span> <span>checkShipping</span>(<span>request</span>) </span>{
  <span>try</span> {
    <span>const</span> json = request.shippingAddress.toJSON();

    <span>await</span> ensureCanShipTo(json);
    <span>const</span> { shippingOptions, total } = <span>await</span> calculateShipping(json);

    <span>return</span> { shippingOptions, total };
  } <span>catch</span> (err) {
    <span>return</span> { <span>error</span>: <span>`Sorry! we can't ship to your address.`</span> };
  }
}</code></pre>
        </div>
      </section>
      <section id="fine-grained-error-reporting">
        <h3 id="x2-8-fine-grained-error-reporting"><bdi>2.8 </bdi>
          Fine-grained error reporting
        <a aria-label="ยง" href="#fine-grained-error-reporting"></a></h3>
        <p>
          A developer can use the <a data-link-for="PaymentDetailsUpdate" href="#dom-paymentdetailsupdate-shippingaddresserrors" data-link-type="idl"><code>shippingAddressErrors</code></a> member of the
          <a href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a> dictionary to indicate that there are
          validation errors with specific attributes of a
          <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>. The <a data-link-for="PaymentDetailsUpdate" href="#dom-paymentdetailsupdate-shippingaddresserrors" data-link-type="idl"><code>shippingAddressErrors</code></a> member is a
          <a href="#dom-addresserrors" data-link-type="idl"><code>AddressErrors</code></a> dictionary, whose members specifically demarcate
          the fields of a <a href="#dfn-physical-address" data-link-type="dfn">physical address</a> that are erroneous while also
          providing helpful error messages to be displayed to the end user.
        </p>
        <div id="example-8">
           <pre aria-busy="false"><code>request.onshippingaddresschange = <span><span>ev</span> =&gt;</span> {
  ev.updateWith(validateAddress(request.shippingAddress));
};
<span><span>function</span> <span>validateAddress</span>(<span>shippingAddress</span>) </span>{
  <span>const</span> error = <span>"Can't ship to this address."</span>;
  <span>const</span> shippingAddressErrors = {
    <span>city</span>: <span>"FarmVille is not a real place."</span>,
    <span>postalCode</span>: <span>"Unknown postal code for your country."</span>,
  };
  
  
  <span>const</span> shippingOptions = [];
  <span>return</span> { error, shippingAddressErrors, shippingOptions };
}</code></pre>
        </div>
      </section>
      <section data-link-for="PaymentResponse" id="posting-payment-response-back-to-a-server">
        <h3 id="x2-9-posting-payment-response-back-to-a-server"><bdi>2.9 </bdi>
          POSTing payment response back to a server
        <a aria-label="ยง" href="#posting-payment-response-back-to-a-server"></a></h3>
        <p>
          It's expected that data in a <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a> will be POSTed
          back to a server for processing. To make this as easy as possible,
          <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a> provides a <a href="#dom-paymentresponse-tojson" data-link-type="idl"><code>toJSON()</code></a> method that
          serializes the object directly into JSON. This makes it trivial to
          POST the resulting JSON back to a server using the <cite><a href="https://fetch.spec.whatwg.org/">Fetch Standard</a></cite>:
        </p>
        <div id="example-9-posting-with-fetch">
           <pre aria-busy="false"><code><span>async</span> <span><span>function</span> <span>doPaymentRequest</span>(<span></span>) </span>{
  <span>const</span> payRequest = <span>new</span> PaymentRequest(methodData, details, options);
  <span>const</span> payResponse = <span>await</span> payRequest.show();
  <span>let</span> result = <span>""</span>;
  <span>try</span> {
    <span>const</span> httpResponse = <span>await</span> fetch(<span>"/process-payment"</span>, {
      <span>method</span>: <span>"POST"</span>,
      <span>headers</span>: { <span>"Content-Type"</span>: <span>"application/json"</span> },
      <span>body</span>: payResponse.toJSON(),
    });
    result = httpResponse.ok ? <span>"success"</span> : <span>"fail"</span>;
  } <span>catch</span> (err) {
    <span>console</span>.error(err);
    result = <span>"fail"</span>;
  }
  <span>await</span> payResponse.complete(result);
}
doPaymentRequest();</code></pre>
        </div>
      </section>
    </section>
    <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="paymentrequest-interface">
      <h2 id="x3-paymentrequest-interface"><bdi>3. </bdi>
        <dfn data-dfn-type="interface" data-export="" id="dom-paymentrequest" data-idl="interface" data-title="PaymentRequest" data-dfn-for=""><code>PaymentRequest</code></dfn> interface
      <a aria-label="ยง" href="#paymentrequest-interface"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentrequest" data-title="PaymentRequest">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentrequest"><code>PaymentRequest</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" id="idl-def-paymentrequest-constructor-methoddata-details-options" data-title="constructor" data-dfn-for="PaymentRequest">
  <dfn data-export="" data-dfn-type="constructor" id="dom-paymentrequest-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="PaymentRequest" data-lt="PaymentRequest.constructor()|PaymentRequest.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span>
    <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentmethoddata" data-link-type="idl"><code>PaymentMethodData</code></a>&gt;</span> <span>methodData</span>,<span>
    <a data-xref-type="_IDL_" href="#dom-paymentdetailsinit" data-link-type="idl"><code>PaymentDetailsInit</code></a></span> <span>details</span>,
    optional<span> <a data-xref-type="_IDL_" href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a></span> <span>options</span> = {}
  );</span><span data-idl="" id="idl-def-paymentrequest-show-detailspromise" data-title="show" data-dfn-for="PaymentRequest">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>&gt;</span> <a data-link-for="PaymentRequest" data-link-type="method" href="#dom-paymentrequest-show"><code>show</code></a>(optional<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a>&gt;</span> <span>detailsPromise</span>);</span><span data-idl="" id="idl-def-paymentrequest-abort" data-title="abort" data-dfn-for="PaymentRequest">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a data-link-for="PaymentRequest" data-link-type="method" href="#dom-paymentrequest-abort"><code>abort</code></a>();</span><span data-idl="" id="idl-def-paymentrequest-canmakepayment" data-title="canMakePayment" data-dfn-for="PaymentRequest">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a>&gt;</span> <a data-link-for="PaymentRequest" data-link-type="method" href="#dom-paymentrequest-canmakepayment"><code>canMakePayment</code></a>();</span><span data-idl="" id="idl-def-paymentrequest-id" data-title="id" data-dfn-for="PaymentRequest">

  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-id"><code>id</code></a>;</span><span data-idl="" id="idl-def-paymentrequest-shippingaddress" data-title="shippingAddress" data-dfn-for="PaymentRequest">
  readonly attribute<span> <a data-xref-type="_IDL_" href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>?</span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-shippingaddress"><code>shippingAddress</code></a>;</span><span data-idl="" id="idl-def-paymentrequest-shippingoption" data-title="shippingOption" data-dfn-for="PaymentRequest">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-shippingoption"><code>shippingOption</code></a>;</span><span data-idl="" id="idl-def-paymentrequest-shippingtype" data-title="shippingType" data-dfn-for="PaymentRequest">
  readonly attribute<span> <a data-xref-type="_IDL_" href="#dom-paymentshippingtype" data-link-type="idl"><code>PaymentShippingType</code></a>?</span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-shippingtype"><code>shippingType</code></a>;</span><span data-idl="" id="idl-def-paymentrequest-onmerchantvalidation" data-title="onmerchantvalidation" data-dfn-for="PaymentRequest">

  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onmerchantvalidation"><code>onmerchantvalidation</code></a>;</span><span data-idl="" id="idl-def-paymentrequest-onshippingaddresschange" data-title="onshippingaddresschange" data-dfn-for="PaymentRequest">
  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onshippingaddresschange"><code>onshippingaddresschange</code></a>;</span><span data-idl="" id="idl-def-paymentrequest-onshippingoptionchange" data-title="onshippingoptionchange" data-dfn-for="PaymentRequest">
  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onshippingoptionchange"><code>onshippingoptionchange</code></a>;</span><span data-idl="" id="idl-def-paymentrequest-onpaymentmethodchange" data-title="onpaymentmethodchange" data-dfn-for="PaymentRequest">
  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onpaymentmethodchange"><code>onpaymentmethodchange</code></a>;</span>
};</span></pre>
      <div role="note" id="issue-container-generatedID"><p><span>Note</span></p><div>
        <p>
          A developer creates a <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> to make a payment
          request. This is typically associated with the user initiating a
          payment process (e.g., by activating a "Buy," "Purchase," or
          "Checkout" button on a web site, selecting a "Power Up" in an
          interactive game, or paying at a kiosk in a parking structure). The
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> allows developers to exchange information with
          the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> while the user is providing input (up to the
          point of user approval or denial of the payment request).
        </p>
        <p data-link-for="PaymentRequest">
          The <a href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a>, <a href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a>, and
          <a href="#dom-paymentrequest-shippingtype" data-link-type="idl"><code>shippingType</code></a> attributes are populated during processing if the
          <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a>
          member is set.
        </p>
      </div></div>
      <p>
        A <var>request</var>'s <dfn data-dfn-type="dfn" id="dfn-payment-relevant-browsing-context">payment-relevant browsing context</dfn> is that
        <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>'s browsing
        context's <a data-cite-path="browsers.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>. Every <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant
        browsing context</a> has a <dfn data-dfn-type="dfn" id="dfn-payment-request-is-showing">payment request is showing</dfn>
        boolean, which prevents showing more than one payment UI at a time.
      </p>
      <p>
        The <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean simply prevents more than
        one payment UI being shown in a single browser tab. However, a
        <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> can restrict the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> to showing
        only one payment UI across all browser windows and tabs. Other payment
        handlers might allow showing a payment UI across disparate browser
        tabs.
      </p>
      <section id="constructor">
        <h3 id="x3-1-constructor"><bdi>3.1 </bdi>
          Constructor
        <a aria-label="ยง" href="#constructor"></a></h3>
        <p>
          The <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> is constructed using the supplied sequence
          of <a href="#dom-paymentmethoddata" data-link-type="idl"><code>PaymentMethodData</code></a> <var>methodData</var> including any <a href="#dfn-payment-method" data-link-type="dfn">payment
          method</a> specific <a data-lt="PaymentMethodData.data" href="#dom-paymentmethoddata-data" data-link-type="idl"><code>data</code></a>, the
          <a href="#dom-paymentdetailsinit" data-link-type="idl"><code>PaymentDetailsInit</code></a> <var>details</var>, and the <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a>
          <var>options</var>.
        </p>
        <p data-tests="payment-request-constructor.https.html, payment-request-insecure.http.html">
          The <code><dfn data-lt="PaymentRequest.PaymentRequest()|PaymentRequest(methodData, details, options)" data-dfn-type="dfn" id="dfn-paymentrequest-paymentrequest">PaymentRequest(<var>methodData</var>,
          <var>details</var>, <var>options</var>)</dfn></code> constructor <em title="MUST">MUST</em> act as follows:
        </p>
        <ol data-link-for="PaymentDetailsBase">
          <li>If the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object">current settings object</a>'s <a data-link-for="environment settings object" data-xref-for="environment settings object" data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-document">responsible document</a> is not <a data-cite-path="iframe-embed-object.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use">allowed to use</a> the
          "<a data-lt="payment-feature" href="#dfn-payment-feature" data-link-type="dfn"><code>payment</code></a>" feature, then
          <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>Establish the request's id:
            <ol>
              <li data-tests="payment-request-id-attribute.https.html">If
              <var>details</var>.<a data-lt="PaymentDetailsInit.id" href="#dom-paymentdetailsinit-id" data-link-type="idl"><code>id</code></a> is missing,
              add an <a data-lt="PaymentDetailsInit.id" href="#dom-paymentdetailsinit-id" data-link-type="idl"><code>id</code></a> member to
              <var>details</var> and set its value to a <abbr title="Universally Unique Identifier">UUID</abbr> [<cite><a href="#bib-rfc4122" title="A Universally Unique IDentifier (UUID) URN Namespace" data-link-type="biblio">RFC4122</a></cite>].
              </li>
            </ol>
          </li>
          <li>Let <var>serializedMethodData</var> be an empty list.
          </li>
          <li>Process payment methods:
            <ol data-link-for="PaymentMethodData">
              <li>If the length of the <var>methodData</var> sequence is zero, then
              <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>, optionally informing the
              developer that at least one <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> is required.
              </li>
              <li>For each <var>paymentMethod</var> of <var>methodData</var>:
                <ol>
                  <li data-tests="payment-request-ctor-pmi-handling.https.html">Run the steps
                  to <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-validate-a-payment-method-identifier">validate a payment method identifier</a> with
                  <var>paymentMethod</var>.<a data-lt="PaymentMethodData.supportedMethods" href="#dom-paymentmethoddata-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a>. If
                  it returns false, then throw a "<a data-xref-type="exception" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror"><code>RangeError</code></a>" exception.
                  Optionally, inform the developer that the payment method
                  identifier is invalid.
                  </li>
                  <li>If the <a data-lt="PaymentMethodData.data" href="#dom-paymentmethoddata-data" data-link-type="idl"><code>data</code></a>
                  member of <var>paymentMethod</var> is missing, let <var>serializedData</var> be
                  null. Otherwise, let <var>serializedData</var> be the result of
                  <a href="#dfn-json-serialized" data-link-type="dfn">JSON-serializing</a> <var>paymentMethod</var>.<a data-lt="PaymentMethodData.data" href="#dom-paymentmethoddata-data" data-link-type="idl"><code>data</code></a> into a string. Rethrow any
                  exceptions.
                  </li>
                  <li>If <var>serializedData</var> is not null, and if required by the
                  specification that defines the
                  <var>paymentMethod</var>.<a href="#dom-paymentmethoddata-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a>:
                    <ol>
                      <li>Let <var>object</var> be the result of <a href="https://tc39.es/ecma262/#sec-json.parse">JSON-parsing</a>
                      <var>serializedData</var>.
                      </li>
                      <li>
                        <p>
                          <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">Convert</a>
                          <var>object</var> to an IDL value of the type specified by the
                          specification that defines the
                          <var>paymentMethod</var>.<a href="#dom-paymentmethoddata-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a> (e.g., a
                          <a href="https://www.w3.org/TR/payment-method-basic-card/#dom-basiccardrequest">BasicCardRequest</a>
                          in the case of [<cite><a href="#bib-payment-method-basic-card" title="Basic Card Payment" data-link-type="biblio">payment-method-basic-card</a></cite>]).
                          Rethrow any exceptions.
                        </p>
                        <div role="note" id="issue-container-generatedID-0"><p><span>Note</span></p><p>
                          This step assures that any IDL type conversion errors
                          are caught as early as possible.
                        </p></div>
                      </li>
                    </ol>
                  </li>
                  <li>Add the tuple (<var>paymentMethod</var>.<a data-lt="PaymentMethodData.supportedMethods" href="#dom-paymentmethoddata-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a>,
                  <var>serializedData</var>) to <var>serializedMethodData</var>.
                  </li>
                </ol>
              </li>
            </ol>
          </li>
          <li data-link-for="PaymentDetailsInit">Process the total:
            <ol>
              <li data-tests="payment-request-ctor-currency-code-checks.https.html">
                <a href="#dfn-check-and-canonicalize-total-amount" data-link-type="dfn">Check and canonicalize total amount</a>
                <var>details</var>.<a href="#dom-paymentdetailsinit-total" data-link-type="idl"><code>total</code></a>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>. Rethrow any exceptions.
              </li>
            </ol>
          </li>
          <li>If the <a href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a> member of <var>details</var> is present, then
          for each <var>item</var> in <var>details</var>.<a href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a>:
            <ol>
              <li data-tests="payment-request-ctor-currency-code-checks.https.html">
                <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">Check and canonicalize amount</a> <var>item</var>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>. Rethrow any exceptions.
              </li>
            </ol>
          </li>
          <li>Let <var>selectedShippingOption</var> be null.
          </li>
          <li>If the <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> member of
          <var>options</var> is present and set to true, process shipping options:
            <ol>
              <li>Let <var>options</var> be an empty
              <code><a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a></code>&lt;<a href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a>&gt;.
              </li>
              <li>If the <a href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a> member of <var>details</var> is present,
              then:
                <ol data-link-for="PaymentShippingOption">
                  <li>Let <var>seenIDs</var> be an empty set.
                  </li>
                  <li>For each <var>option</var> in <var>details</var>.<a data-link-for="PaymentDetailsBase" href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a>:
                    <ol>
                      <li data-tests="payment-request-ctor-currency-code-checks.https.html">
                        <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">Check and canonicalize amount</a> <var>item</var>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>. Rethrow any
                        exceptions.
                      </li>
                      <li>If <var>seenIDs</var> contains <var>option</var>.<a href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a>, then throw
                      a <a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>. Optionally, inform the developer that
                      shipping option IDs must be unique.
                      </li>
                      <li>Otherwise, append <var>option</var>.<a href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a> to <var>seenIDs</var>.
                      </li>
                      <li>If <var>option</var>.<a href="#dom-paymentshippingoption-selected" data-link-type="idl"><code>selected</code></a> is true, then set
                      <var>selectedShippingOption</var> to <var>option</var>.<a href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a>.
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>Set <var>details</var>.<a data-lt="PaymentDetailsBase.shippingOptions" href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a> to
              <var>options</var>.
              </li>
            </ol>
          </li>
          <li>Let <var>serializedModifierData</var> be an empty list.
          </li>
          <li data-link-for="PaymentDetailsBase">Process payment details
          modifiers:
            <ol>
              <li>Let <var>modifiers</var> be an empty
              <code><a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a></code>&lt;<a href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a>&gt;.
              </li>
              <li>If the <a href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a> member of <var>details</var> is present, then:
                <ol>
                  <li>Set <var>modifiers</var> to <var>details</var>.<a href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a>.
                  </li>
                  <li>For each <var>modifier</var> of <var>modifiers</var>:
                    <ol>
                      <li>If the <a data-lt="PaymentDetailsModifier.total" href="#dom-paymentdetailsmodifier-total" data-link-type="idl"><code>total</code></a> member of
                      <var>modifier</var> is present, then:
                        <ol>
                          <li data-tests="payment-request-ctor-currency-code-checks.https.html">
                            <a href="#dfn-check-and-canonicalize-total-amount" data-link-type="dfn">Check and canonicalize total amount</a>
                            <var>modifier</var>.<a data-lt="PaymentDetailsModifier.total" href="#dom-paymentdetailsmodifier-total" data-link-type="idl"><code>total</code></a>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>.
                            Rethrow any exceptions.
                          </li>
                        </ol>
                      </li>
                      <li>If the <a data-lt="PaymentDetailsModifier.additionalDisplayItems" href="#dom-paymentdetailsmodifier-additionaldisplayitems" data-link-type="idl"><code>additionalDisplayItems</code></a>
                      member of <var>modifier</var> is present, then for each <var>item</var> of
                      <var>modifier</var>.<a data-lt="PaymentDetailsModifier.additionalDisplayItems" href="#dom-paymentdetailsmodifier-additionaldisplayitems" data-link-type="idl"><code>additionalDisplayItems</code></a>:
                        <ol>
                          <li data-tests="payment-request-ctor-currency-code-checks.https.html">
                            <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">Check and canonicalize amount</a>
                            <var>item</var>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>.
                            Rethrow any exceptions.
                          </li>
                        </ol>
                      </li>
                      <li>If the <a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>data</code></a> member of
                      <var>modifier</var> is missing, let <var>serializedData</var> be null.
                      Otherwise, let <var>serializedData</var> be the result of
                      <a href="#dfn-json-serialized" data-link-type="dfn">JSON-serializing</a> <var>modifier</var>.<a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>data</code></a> into a string.
                      Rethrow any exceptions.
                      </li>
                      <li>Add the tuple (<var>modifier</var>.<a data-lt="PaymentDetailsModifier.supportedMethods" href="#dom-paymentdetailsmodifier-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a>,
                      <var>serializedData</var>) to <var>serializedModifierData</var>.
                      </li>
                      <li>Remove the <a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>
                        data</code></a> member of <var>modifier</var>, if it is present.
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>Set <var>details</var>.<a data-lt="PaymentDetailsBase.modifiers" href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a> to <var>modifiers</var>.
              </li>
            </ol>
          </li>
          <li>Let <var>request</var> be a new <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a> to <var>options</var>.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-created" data-link-type="dfn">created</a>".
          </li>
          <li>Set <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> to false.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-details" data-link-type="dfn">[[details]]</a> to <var>details</var>.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-serializedmodifierdata" data-link-type="dfn">[[serializedModifierData]]</a> to
          <var>serializedModifierData</var>.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-serializedmethoddata" data-link-type="dfn">[[serializedMethodData]]</a> to
          <var>serializedMethodData</var>.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a> to null.
          </li>
          <li>Set the value of <var>request</var>'s <a data-lt="PaymentRequest.shippingOption" href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a> attribute to
          <var>selectedShippingOption</var>.
          </li>
          <li>Set the value of the <a data-lt="PaymentRequest.shippingAddress" href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>
            shippingAddress</code></a> attribute on <var>request</var> to null.
          </li>
          <li>If <var>options</var>.<a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> is set to true,
          then set the value of the <a data-lt="PaymentRequest.shippingType" href="#dom-paymentrequest-shippingtype" data-link-type="idl"><code>shippingType</code></a> attribute on <var>request</var>
          to <var>options</var>.<a data-lt="PaymentOptions.shippingType" href="#dom-paymentoptions-shippingtype" data-link-type="idl"><code>shippingType</code></a>. Otherwise, set it to
          null.
          </li>
          <li>Return <var>request</var>.
          </li>
        </ol>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="id-attribute">
        <h3 id="x3-2-id-attribute"><bdi>3.2 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-id" data-idl="attribute" data-title="id" data-dfn-for="PaymentRequest" data-type="DOMString" data-lt="PaymentRequest.id|id"><code>id</code></dfn> attribute
        <a aria-label="ยง" href="#id-attribute"></a></h3>
        <p data-tests="payment-request-id-attribute.https.html">
          When getting, the <a href="#dom-paymentrequest-id" data-link-type="idl"><code>id</code></a> attribute returns this
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a data-lt="PaymentDetailsInit.id" href="#dom-paymentdetailsinit-id" data-link-type="idl"><code>id</code></a>.
        </p>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="show-method">
        <h3 id="x3-3-show-method"><bdi>3.3 </bdi>
          <dfn data-dfn-type="method" data-export="" id="dom-paymentrequest-show" data-idl="operation" data-title="show()" data-dfn-for="PaymentRequest" data-type="Promise" data-lt="PaymentRequest.show()|PaymentRequest.show|show()|show"><code>show()</code></dfn> method
        <a aria-label="ยง" href="#show-method"></a></h3>
        <div role="note" id="issue-container-generatedID-1"><p><span>Note</span></p><div>
          <p>
            The <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method is called when a developer wants to begin
            user interaction for the payment request. The <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method
            returns a <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> that will be resolved when the <a href="#dfn-user-accepts-the-payment-request" data-link-type="dfn">user
            accepts the payment request</a>. Some kind of user interface will
            be presented to the user to facilitate the payment request after
            the <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method returns.
          </p>
          <p>
            Each payment handler controls what happens when multiple browsing
            context simultaneously call the <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method. For instance,
            some payment handlers will allow multiple payment UIs to be shown
            in different browser tabs/windows. Other payment handlers might
            only allow a single payment UI to be shown for the entire user
            agent.
          </p>
        </div></div>
        <p data-tests="payment-request-show-method.https.html">
          The <code>show(optional <var>detailsPromise</var>)</code> method <em title="MUST">MUST</em> act as
          follows:
        </p>
        <ol>
          <li data-tests="payment-request-show-method.https.html, show-method-postmessage-manual.https.html">
          If the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a> of <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#this">this</a> does not have
          <a data-cite-path="interaction.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation">transient activation</a>, return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected with</a> with a
          "<a data-xref-type="exception" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>Let <var>request</var> be the <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>.
          </li>
          <li>Let <var>document</var> be <var>request</var>'s <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global object</a>'s <a data-cite-path="window-object.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window">
            associated <code>Document</code></a>.
          </li>
          <li data-tests="rejects_if_not_active.https.html">If <var>document</var> is
          not <a data-link-for="Document" data-xref-for="Document" data-cite-path="browsers.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active">fully active</a>, then return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected
          with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>
            <p>
              Optionally, if the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> wishes to disallow the call
              to <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> to protect the user, then return a promise
              rejected with a "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#securityerror"><code>SecurityError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>. For
              example, the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> may limit the rate at which a page
              can call <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a>, as described in section <a href="#privacy">ยง&nbsp;<bdi>19. </bdi>
        Privacy and Security Considerations
      </a>.
            </p>
          </li>
          <li>If <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is not "<a href="#dfn-created" data-link-type="dfn">created</a>" then
          return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>"
          <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>If the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a>'s <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a>
          boolean is true, then:
            <ol>
              <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
              </li>
              <li>Return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>"
              <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
              </li>
            </ol>
          </li>
          <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>".
          </li>
          <li>Let <var>acceptPromise</var> be <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise">a new promise</a>.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a> to <var>acceptPromise</var>.
          </li>
          <li>
            <p>
              Optionally:
            </p>
            <ol>
              <li>Reject <var>acceptPromise</var> with an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>"
              <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
              </li>
              <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
              </li>
              <li>Return <var>acceptPromise</var>.
              </li>
            </ol>
            <div role="note" id="issue-container-generatedID-2"><p><span>Note</span></p><p>
              This allows the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> to act as if the user had
              immediately <a data-lt="user aborts the payment request" href="#dfn-user-aborts-the-payment-request" data-link-type="dfn">aborted
              the payment request</a>, at its discretion. For example, in
              "private browsing" modes or similar, user agents might take
              advantage of this step.
            </p></div>
          </li>
          <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
          <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to true.
          </li>
          <li>Return <var>acceptPromise</var> and perform the remaining steps <a data-cite-path="infrastructure.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in
          parallel</a>.
          </li>
          <li>Let <var>handlers</var> be an empty <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a>.
          </li>
          <li>For each <var>paymentMethod</var> tuple in
          <var>request</var>.<a href="#dfn-serializedmethoddata" data-link-type="dfn">[[serializedMethodData]]</a>:
            <ol>
              <li>Let <var>identifier</var> be the first element in the <var>paymentMethod</var>
              tuple.
              </li>
              <li>Let <var>data</var> be the result of <a href="https://tc39.es/ecma262/#sec-json.parse">JSON-parsing</a> the second element
              in the <var>paymentMethod</var> tuple.
              </li>
              <li data-cite="WebIDL infra">If required by the specification
              that defines the <var>identifier</var>, then <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">convert</a> <var>data</var> to an IDL value of
              the type specified there. Otherwise, <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">convert</a> to <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object"><code>object</code></a>.
              </li>
              <li>If conversion results in an <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-exception">exception</a> <var>error</var>:
                <ol>
                  <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
                  </li>
                  <li>Reject <var>acceptPromise</var> with <var>error</var>.
                  </li>
                  <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing
                  context</a>'s <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to
                  false.
                  </li>
                  <li>Terminate this algorithm.
                  </li>
                </ol>
              </li>
              <li>Let <var>registeredHandlers</var> be a <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a> of registered
              payment handlers for the payment method <var>identifier</var>.
              </li>
              <li>For each <var>handler</var> in <var>registeredHandlers</var>:
                <ol>
                  <li>Let <var>canMakePayment</var> be the result of running <var>handler</var>'s
                  <a href="#dfn-steps-to-check-if-a-payment-can-be-made" data-link-type="dfn">steps to check if a payment can be made</a> with <var>data</var>.
                  </li>
                  <li>If <var>canMakePayment</var> is true, then append <var>handler</var> to
                  <var>handlers</var>.
                  </li>
                </ol>
              </li>
            </ol>
          </li>
          <li>If <var>handlers</var> is empty, then:
            <ol>
              <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
              </li>
              <li>Reject <var>acceptPromise</var> with "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#notsupportederror"><code>NotSupportedError</code></a>"
              <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
              </li>
              <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
              <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
              </li>
              <li>Terminate this algorithm.
              </li>
            </ol>
          </li>
          <li>Present a user interface that will allow the user to interact
          with the <var>handlers</var>. The user agent <em title="SHOULD">SHOULD</em> prioritize the preference
          of the user when presenting payment methods. It is <em title="RECOMMENDED">RECOMMENDED</em> that
          the language of the user interface match the <a href="https://html.spec.whatwg.org/multipage/#language">language</a> of <a href="https://html.spec.whatwg.org/multipage/dom.html#the-body-element-2">the body element</a>.
          </li>
          <li data-tests="show-method-optional-promise-rejects-manual.https.html, show-method-optional-promise-resolves-manual.https.html">
          If <var>detailsPromise</var> was passed, then:
            <ol>
              <li>Run the <a href="#dfn-update-a-paymentrequest-s-details-algorithm" data-link-type="dfn">update a <code>PaymentRequest</code>'s details
              algorithm</a> with <var>detailsPromise</var>, <var>request</var>, and null.
              </li>
              <li>Wait for the <var>detailsPromise</var> to settle.
                
              </li>
            </ol>
          </li>
          <li>Let <var>handler</var> be the <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> selected by the
          end-user.
          </li>
          <li>Let <var>modifiers</var> be an empty list.
          </li>
          <li>For each <var>tuple</var> in <a href="#dfn-serializedmodifierdata" data-link-type="dfn">[[serializedModifierData]]</a>:
            <ol>
              <li>If the first element of <var>tuple</var> (a <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">PMI</a>) matches the
              <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a> of <var>handler</var>, then append the
              second element of <var>tuple</var> (the serialized method data) to
              <var>modifiers</var>.
              </li>
            </ol>
          </li>
          <li>
            <p>
              Pass the <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">converted</a>
              second element in the <var>paymentMethod</var> tuple and <var>modifiers</var>.
              Optionally, the user agent <em title="SHOULD">SHOULD</em> send the appropriate data from
              <var>request</var> to the user-selected <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> in order to
              guide the user through the payment process. This includes the
              various attributes and other internal slots of <var>request</var> (some
              <em title="MAY">MAY</em> be excluded for privacy reasons where appropriate).
            </p>
            <p>
              Handling of multiple applicable modifiers in the
              <a href="#dfn-serializedmodifierdata" data-link-type="dfn">[[serializedModifierData]]</a> internal slot is <a href="#dfn-payment-handler" data-link-type="dfn">payment
              handler</a> specific and beyond the scope of this specification.
              Nevertheless, it is <em title="RECOMMENDED">RECOMMENDED</em> that <a href="#dfn-payment-handler" data-link-type="dfn">payment handlers</a> use
              a "last one wins" approach with items in the
              <a href="#dfn-serializedmodifierdata" data-link-type="dfn">[[serializedModifierData]]</a> list: that is to say, an item
              at the end of the list always takes precedence over any item at
              the beginning of the list (see example below).
            </p>
            
            <p>
              The <var>acceptPromise</var> will later be resolved or rejected by either
              the <a href="#dfn-user-accepts-the-payment-request" data-link-type="dfn">user accepts the payment request algorithm</a> or the
              <a href="#dfn-user-aborts-the-payment-request" data-link-type="dfn">user aborts the payment request algorithm</a>, which are
              triggered through interaction with the user interface.
            </p>
            <p data-tests="rejects_if_not_active.https.html">
              If <var>document</var> stops being <a data-link-for="Document" data-xref-for="Document" data-cite-path="browsers.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active">fully active</a> while the
              user interface is being shown, or no longer is by the time this
              step is reached, then:
            </p>
            <ol>
              <li>Close down the user interface.
              </li>
              <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
              <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="abort-method">
        <h3 id="x3-4-abort-method"><bdi>3.4 </bdi>
          <dfn data-dfn-type="method" data-export="" id="dom-paymentrequest-abort" data-idl="operation" data-title="abort()" data-dfn-for="PaymentRequest" data-type="Promise" data-lt="PaymentRequest.abort()|PaymentRequest.abort|abort()|abort"><code>abort()</code></dfn> method
        <a aria-label="ยง" href="#abort-method"></a></h3>
        <div role="note" id="issue-container-generatedID-4"><p><span>Note</span></p><div>
          <p>
            The <a href="#dom-paymentrequest-abort" data-link-type="idl"><code>abort()</code></a> method is called if a developer wishes to tell
            the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> to abort the payment <var>request</var> and to tear
            down any user interface that might be shown. The <a href="#dom-paymentrequest-abort" data-link-type="idl"><code>abort()</code></a> can
            only be called after the <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method has been called (see
            <a href="#dfn-state-0" data-link-type="dfn">states</a>) and before this instance's <a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a>
            has been resolved. For example, developers might choose to do this
            if the goods they are selling are only available for a limited
            amount of time. If the user does not accept the payment request
            within the allowed time period, then the request will be aborted.
          </p>
          <p>
            A <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> might not always be able to abort a request.
            For example, if the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> has delegated responsibility
            for the request to another app. In this situation, <a href="#dom-paymentrequest-abort" data-link-type="idl"><code>abort()</code></a>
            will reject the returned <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a>.
          </p>
          <p>
            See also the algorithm when the <a href="#dfn-user-aborts-the-payment-request" data-link-type="dfn">user aborts the payment
            request</a>.
          </p>
        </div></div>
        <p data-tests="payment-request-abort-method.https.html">
          The <a href="#dom-paymentrequest-abort" data-link-type="idl"><code>abort()</code></a> method <em title="MUST">MUST</em> act as follows:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>.
          </li>
          <li>If <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a> is not null, and
          <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> is not null,
          return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>"
          <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>If the value of <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is not
          "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>" then return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected with</a> an
          "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>Let <var>promise</var> be <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise">a new promise</a>.
          </li>
          <li>Return <var>promise</var> and perform the remaining steps <a data-cite-path="infrastructure.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in
          parallel</a>.
          </li>
          <li>Try to abort the current user interaction with the <a href="#dfn-payment-handler" data-link-type="dfn">payment
          handler</a> and close down any remaining user interface.
          </li>
          <li>
            <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
            perform the following steps:
            <ol>
              <li>If it is not possible to abort the current user interaction,
              then reject <var>promise</var> with "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>"
              <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a> and abort these steps.
              </li>
              <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
              </li>
              <li>Reject the promise <var>request</var>.<a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a> with
              an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
              </li>
              <li>Resolve <var>promise</var> with undefined.
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="canmakepayment-method">
        <h3 id="x3-5-canmakepayment-method"><bdi>3.5 </bdi>
          <dfn data-dfn-type="method" data-export="" id="dom-paymentrequest-canmakepayment" data-idl="operation" data-title="canMakePayment()" data-dfn-for="PaymentRequest" data-type="Promise" data-lt="PaymentRequest.canMakePayment()|PaymentRequest.canMakePayment|canMakePayment()|canMakePayment"><code>canMakePayment()</code></dfn> method
        <a aria-label="ยง" href="#canmakepayment-method"></a></h3>
        
        <p data-tests="payment-request-canmakepayment-method.https.html">
          The <a href="#dom-paymentrequest-canmakepayment" data-link-type="idl"><code>canMakePayment()</code></a> method <em title="MUST">MUST</em> act as follows:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object on which the
          method was called.
          </li>
          <li>If <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is not "<a href="#dfn-created" data-link-type="dfn">created</a>", then
          return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>"
          <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li data-tests="payment-request/payment-request-canmakepayment-method-protection.https.html">
          Optionally, at the <a data-cite-path="browsers.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>'s discretion,
          return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected with</a> a "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#notallowederror"><code>NotAllowedError</code></a>"
          <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>. As described in section <a href="#canmakepayment-protections">ยง&nbsp;<bdi>19.9 </bdi>
          <code>canMakePayment()</code> protections
        </a>, the user agent may limit the rate
          at which a page can call <a href="#dom-paymentrequest-canmakepayment" data-link-type="idl"><code>canMakePayment()</code></a>.
          </li>
          <li>Let <var>hasHandlerPromise</var> be <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise">a new promise</a>.
          </li>
          <li>Return <var>hasHandlerPromise</var>, and perform the remaining steps <a data-cite-path="infrastructure.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in
          parallel</a>.
          </li>
          <li>For each <var>paymentMethod</var> tuple in
          <var>request</var>.<a href="#dfn-serializedmethoddata" data-link-type="dfn">[[serializedMethodData]]</a>:
            <ol>
              <li>Let <var>identifier</var> be the first element in the <var>paymentMethod</var>
              tuple.
              </li>
              <li>If the user agent has a <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> that supports
              handling payment requests for <var>identifier</var>, resolve
              <var>hasHandlerPromise</var> with true and terminate this algorithm.
              </li>
            </ol>
          </li>
          <li>Resolve <var>hasHandlerPromise</var> with false.
          </li>
        </ol>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="shippingaddress-attribute">
        <h3 id="x3-6-shippingaddress-attribute"><bdi>3.6 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-shippingaddress" data-idl="attribute" data-title="shippingAddress" data-dfn-for="PaymentRequest" data-type="PaymentAddress" data-lt="PaymentRequest.shippingAddress|shippingAddress"><code>shippingAddress</code></dfn> attribute
        <a aria-label="ยง" href="#shippingaddress-attribute"></a></h3>
        <p data-tests="shipping-address-changed-manual.https.html">
          A <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a> attribute is
          populated when the user provides a shipping address. It is null by
          default. When a user provides a shipping address, the <a href="#dfn-shipping-address-changed-algorithm" data-link-type="dfn">shipping
          address changed algorithm</a> runs.
        </p>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="shippingtype-attribute">
        <h3 id="x3-7-shippingtype-attribute"><bdi>3.7 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-shippingtype" data-idl="attribute" data-title="shippingType" data-dfn-for="PaymentRequest" data-type="PaymentShippingType" data-lt="PaymentRequest.shippingType|shippingType"><code>shippingType</code></dfn> attribute
        <a aria-label="ยง" href="#shippingtype-attribute"></a></h3>
        <p data-tests="payment-request-shippingType-attribute.https.html">
          A <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dom-paymentrequest-shippingtype" data-link-type="idl"><code>shippingType</code></a> attribute is the type
          of shipping used to fulfill the transaction. Its value is either a
          <a href="#dom-paymentshippingtype" data-link-type="idl"><code>PaymentShippingType</code></a> enum value, or null if none is provided by
          the developer during <a data-lt="PaymentRequest.PaymentRequest()" href="#dfn-paymentrequest-paymentrequest" data-link-type="dfn"><code>construction</code></a> (see
          <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a>'s <a data-lt="PaymentOptions.shippingType" href="#dom-paymentoptions-shippingtype" data-link-type="idl"><code>shippingType</code></a> member).
        </p>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="onmerchantvalidation-attribute">
        <h3 id="x3-8-onmerchantvalidation-attribute"><bdi>3.8 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-onmerchantvalidation" data-idl="attribute" data-title="onmerchantvalidation" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onmerchantvalidation|onmerchantvalidation"><code>onmerchantvalidation</code></dfn> attribute
        <a aria-label="ยง" href="#onmerchantvalidation-attribute"></a></h3>
        <p data-tests="onmerchantvalidation-attribute.https.html">
          A <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dom-paymentrequest-onmerchantvalidation" data-link-type="idl"><code>onmerchantvalidation</code></a> attribute is an
          <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a> for a <a data-xref-type="_IDL_" href="#dom-merchantvalidationevent" data-link-type="idl"><code><code>MerchantValidationEvent</code></code></a> named
          "<a href="#dfn-merchantvalidation" data-link-type="dfn"><code>merchantvalidation</code></a>".
        </p>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="onshippingaddresschange-attribute">
        <h3 id="x3-9-onshippingaddresschange-attribute"><bdi>3.9 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-onshippingaddresschange" data-idl="attribute" data-title="onshippingaddresschange" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onshippingaddresschange|onshippingaddresschange"><code>onshippingaddresschange</code></dfn> attribute
        <a aria-label="ยง" href="#onshippingaddresschange-attribute"></a></h3>
        <p data-tests="shipping-address-changed-manual.https.html, payment-request-onshippingaddresschange-attribute.https.html, algorithms-manual.https.html#shipping-address-changed-algo">
          A <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dom-paymentrequest-onshippingaddresschange" data-link-type="idl"><code>onshippingaddresschange</code></a> attribute is
          an <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a> for a <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a> named
          <a href="#dfn-shippingaddresschange" data-link-type="dfn"><code>shippingaddresschange</code></a>.
        </p>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="shippingoption-attribute">
        <h3 id="x3-10-shippingoption-attribute"><bdi>3.10 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-shippingoption" data-idl="attribute" data-title="shippingOption" data-dfn-for="PaymentRequest" data-type="DOMString" data-lt="PaymentRequest.shippingOption|shippingOption"><code>shippingOption</code></dfn> attribute
        <a aria-label="ยง" href="#shippingoption-attribute"></a></h3>
        <p data-tests="payment-request-shippingOption-attribute.https.html, change-shipping-option-manual.https.html">
          A <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a> attribute is
          populated when the user chooses a shipping option. It is null by
          default. When a user chooses a shipping option, the <a href="#dfn-shipping-option-changed-algorithm" data-link-type="dfn">shipping
          option changed algorithm</a> runs.
        </p>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="onshippingoptionchange-attribute">
        <h3 id="x3-11-onshippingoptionchange-attribute"><bdi>3.11 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-onshippingoptionchange" data-idl="attribute" data-title="onshippingoptionchange" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onshippingoptionchange|onshippingoptionchange"><code>onshippingoptionchange</code></dfn> attribute
        <a aria-label="ยง" href="#onshippingoptionchange-attribute"></a></h3>
        <p data-tests="payment-request-onshippingoptionchange-attribute.https.html">
          A <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dom-paymentrequest-onshippingoptionchange" data-link-type="idl"><code>onshippingoptionchange</code></a> attribute is
          an <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a> for a <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a> named
          <a href="#dfn-shippingoptionchange" data-link-type="dfn"><code>shippingoptionchange</code></a>.
        </p>
      </section>
      <section data-dfn-for="PaymentRequest" data-link-for="PaymentRequest" id="onpaymentmethodchange-attribute">
        <h3 id="x3-12-onpaymentmethodchange-attribute"><bdi>3.12 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentrequest-onpaymentmethodchange" data-idl="attribute" data-title="onpaymentmethodchange" data-dfn-for="PaymentRequest" data-type="EventHandler" data-lt="PaymentRequest.onpaymentmethodchange|onpaymentmethodchange"><code>onpaymentmethodchange</code></dfn> attribute
        <a aria-label="ยง" href="#onpaymentmethodchange-attribute"></a></h3>
        <p data-tests="onpaymentmenthodchange-attribute.https.html">
          A <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dom-paymentrequest-onpaymentmethodchange" data-link-type="idl"><code>onpaymentmethodchange</code></a> attribute is
          an <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><code>EventHandler</code></a> for a <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeevent" data-link-type="idl"><code><code>PaymentMethodChangeEvent</code></code></a> named
          "<a href="#dfn-paymentmethodchange" data-link-type="dfn"><code>paymentmethodchange</code></a>".
        </p>
      </section>
      <section id="internal-slots">
        <h3 id="x3-13-internal-slots"><bdi>3.13 </bdi>
          Internal Slots
        <a aria-label="ยง" href="#internal-slots"></a></h3>
        <p>
          Instances of <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> are created with the internal
          slots in the following table:
        </p>
        <table>
          <tbody><tr>
            <th>
              Internal Slot
            </th>
            <th>
              Description (<em>non-normative</em>)
            </th>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-serializedmethoddata">[[serializedMethodData]]</dfn>
            </td>
            <td>
              The <code>methodData</code> supplied to the constructor, but
              represented as tuples containing supported methods and a string
              or null for data (instead of the original object form).
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-serializedmodifierdata">[[serializedModifierData]]</dfn>
            </td>
            <td>
              A list containing the serialized string form of each <a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>data</code></a> member for each
              corresponding item in the sequence
              <a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a data-lt="PaymentDetailsBase" href="#dom-paymentdetailsbase" data-link-type="idl">modifier</a>,
              or null if no such member was present.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-details">[[details]]</dfn>
            </td>
            <td>
              The current <a href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a> for the payment request
              initially supplied to the constructor and then updated with calls
              to <a data-lt="PaymentRequestUpdateEvent.updateWith" href="#dom-paymentrequestupdateevent-updatewith" data-link-type="idl"><code>updateWith()</code></a>. Note
              that all <a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>data</code></a>
              members of <a href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a> instances contained in
              the <a data-lt="PaymentDetailsBase.modifiers" href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a>
              member will be removed, as they are instead stored in serialized
              form in the <a href="#dfn-serializedmodifierdata" data-link-type="dfn">[[serializedModifierData]]</a> internal slot.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-options">[[options]]</dfn>
            </td>
            <td>
              The <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> supplied to the constructor.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-state">[[state]]</dfn>
            </td>
            <td>
              <p>
                The current <dfn data-dfn-type="dfn" data-plurals="states" id="dfn-state-0">state</dfn> of the payment request, which
                transitions from:
              </p>
              <dl>
                <dt>
                  "<dfn data-dfn-type="dfn" id="dfn-created">created</dfn>"
                </dt>
                <dd>
                  The payment request is constructed and has not been presented
                  to the user.
                </dd>
                <dt>
                  "<dfn data-dfn-type="dfn" id="dfn-interactive">interactive</dfn>"
                </dt>
                <dd>
                  The payment request is being presented to the user.
                </dd>
                <dt>
                  "<dfn data-dfn-type="dfn" id="dfn-closed">closed</dfn>"
                </dt>
                <dd>
                  The payment request completed.
                </dd>
              </dl>
              <p>
                The <a href="#dfn-state-0" data-link-type="dfn">state</a> transitions are illustrated in the figure
                below:
              </p>
              <figure id="fig-the-constructor-sets-the-initial-state-to-created-the-show-method-changes-the-state-to-interactive-from-there-the-abort-method-or-any-other-error-can-send-the-state-to-closed-similarly-the-user-accepts-the-payment-request-algorithm-and-user-aborts-the-payment-request-algorithm-will-change-the-state-to-closed">
                <img alt="" src="https://www.w3.org/TR/payment-request/images/state-transitions.svg" width="518" height="125">
                <figcaption data-link-for="PaymentRequest">Figure <bdi>1</bdi> <span>
                  The constructor sets the initial <a href="#dfn-state-0" data-link-type="dfn">state</a> to
                  "<a href="#dfn-created" data-link-type="dfn">created</a>". The <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method changes the
                  <a href="#dfn-state-0" data-link-type="dfn">state</a> to "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>". From there, the
                  <a href="#dom-paymentrequest-abort" data-link-type="idl"><code>abort()</code></a> method or any other error can send the
                  <a href="#dfn-state-0" data-link-type="dfn">state</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>"; similarly, the <a href="#dfn-user-accepts-the-payment-request" data-link-type="dfn">user
                  accepts the payment request algorithm</a> and <a href="#dfn-user-aborts-the-payment-request" data-link-type="dfn">user aborts
                  the payment request algorithm</a> will change the
                  <a href="#dfn-state-0" data-link-type="dfn">state</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
                </span></figcaption>
              </figure>
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-updating">[[updating]]</dfn>
            </td>
            <td>
              True if there is a pending <a data-lt="PaymentRequestUpdateEvent.updateWith" href="#dom-paymentrequestupdateevent-updatewith" data-link-type="idl"><code>updateWith()</code></a> call to
              update the payment request and false otherwise.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-acceptpromise">[[acceptPromise]]</dfn>
            </td>
            <td>
              The pending <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> created during <a data-lt="PaymentRequest.show" href="#dom-paymentrequest-show" data-link-type="idl"><code>show</code></a> that will be resolved if the user
              accepts the payment request.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-response">[[response]]</dfn>
            </td>
            <td>
              Null, or the <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a> instantiated by this
              <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>.
            </td>
          </tr>
        </tbody></table>
      </section>
    </section>
    <section data-dfn-for="PaymentMethodData" data-link-for="PaymentMethodData" id="paymentmethoddata-dictionary">
      <h2 id="x4-paymentmethoddata-dictionary"><bdi>4. </bdi>
        <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentmethoddata" data-idl="dictionary" data-title="PaymentMethodData" data-dfn-for=""><code>PaymentMethodData</code></dfn> dictionary
      <a aria-label="ยง" href="#paymentmethoddata-dictionary"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentmethoddata" data-title="PaymentMethodData">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentmethoddata"><code>PaymentMethodData</code></a> {<span data-idl="" id="idl-def-paymentmethoddata-supportedmethods" data-title="supportedMethods" data-dfn-for="PaymentMethodData">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentMethodData" data-link-type="dict-member" href="#dom-paymentmethoddata-supportedmethods"><code>supportedMethods</code></a>;</span><span data-idl="" id="idl-def-paymentmethoddata-data" data-title="data" data-dfn-for="PaymentMethodData"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentMethodData" data-link-type="dict-member" href="#dom-paymentmethoddata-data"><code>data</code></a>;</span>
};</span></pre>
      <p>
        A <a href="#dom-paymentmethoddata" data-link-type="idl"><code>PaymentMethodData</code></a> dictionary is used to indicate a set of
        supported <a href="#dfn-payment-method" data-link-type="dfn">payment methods</a> and any associated <a href="#dfn-payment-method" data-link-type="dfn">payment
        method</a> specific data for those methods.
      </p>
      <dl>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentmethoddata-supportedmethods" data-idl="field" data-title="supportedMethods" data-dfn-for="PaymentMethodData" data-type="DOMString"><code>supportedMethods</code></dfn> member
        </dt>
        <dd>
          A <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a> for a <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> that
          the merchant web site accepts.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentmethoddata-data" data-idl="field" data-title="data" data-dfn-for="PaymentMethodData" data-type="object"><code>data</code></dfn> member
        </dt>
        <dd>
          An object that provides optional information that might be needed by
          the supported payment methods. If supplied, it will be
          <a href="#dfn-json-serialized" data-link-type="dfn">JSON-serialized</a>.
        </dd>
      </dl>
      <div role="note" id="issue-container-generatedID-6"><p><span>Note</span></p><p>
        The value of <code>supportedMethods</code> was changed from array to
        string, but the name was left as a plural to maintain compatibility
        with existing content on the Web.
      </p></div>
    </section>
    <section data-dfn-for="PaymentCurrencyAmount" data-link-for="PaymentCurrencyAmount" id="paymentcurrencyamount-dictionary">
      <h2 id="x5-paymentcurrencyamount-dictionary"><bdi>5. </bdi>
        <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentcurrencyamount" data-idl="dictionary" data-title="PaymentCurrencyAmount" data-dfn-for=""><code>PaymentCurrencyAmount</code></dfn> dictionary
      <a aria-label="ยง" href="#paymentcurrencyamount-dictionary"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentcurrencyamount" data-title="PaymentCurrencyAmount">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentcurrencyamount"><code>PaymentCurrencyAmount</code></a> {<span data-idl="" id="idl-def-paymentcurrencyamount-currency" data-title="currency" data-dfn-for="PaymentCurrencyAmount">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentCurrencyAmount" data-link-type="dict-member" href="#dom-paymentcurrencyamount-currency"><code>currency</code></a>;</span><span data-idl="" id="idl-def-paymentcurrencyamount-value" data-title="value" data-dfn-for="PaymentCurrencyAmount">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentCurrencyAmount" data-link-type="dict-member" href="#dom-paymentcurrencyamount-value"><code>value</code></a>;</span>
};</span></pre>
      <p>
        A <a href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a> dictionary is used to supply monetary
        amounts.
      </p>
      <dl>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentcurrencyamount-currency" data-idl="field" data-title="currency" data-dfn-for="PaymentCurrencyAmount" data-type="DOMString"><code>currency</code></dfn> member
        </dt>
        <dd>
          <p>
            An [<cite><a href="#bib-iso4217" title="Currency codes - ISO 4217" data-link-type="biblio">ISO4217</a></cite>] <a href="https://tc39.github.io/ecma402/#sec-iswellformedcurrencycode">well-formed</a> 3-letter
            alphabetic code (i.e., the numeric codes are not supported). Their
            canonical form is upper case. However, the set of combinations of
            currency code for which localized currency symbols are available is
            implementation dependent. Where a localized currency symbol is not
            available, a user agent <em title="SHOULD">SHOULD</em> use U+00A4 (ยค) for formatting. User
            agents <em title="MAY">MAY</em> format the display of the <a href="#dom-paymentcurrencyamount-currency" data-link-type="idl"><code>currency</code></a> member to
            adhere to OS conventions (e.g., for localization purposes).
          </p>
          <div role="note" id="issue-container-generatedID-7"><p><span>Note</span><span>: Digital currencies and ISO 4217 currency codes</span></p><div>
            <p>
              User agents implementing this specification enforce [<cite><a href="#bib-iso4217" title="Currency codes - ISO 4217" data-link-type="biblio">ISO4217</a></cite>]'s
              3-letter codes format via ECMAScriptโs <a href="https://tc39.github.io/ecma402/#sec-iswellformedcurrencycode">isWellFormedCurrencyCode</a>
              abstract operation, which is invoked as part of the <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">check and
              canonicalize amount</a> algorithm. When a code does not adhere to
              the [<cite><a href="#bib-iso4217" title="Currency codes - ISO 4217" data-link-type="biblio">ISO4217</a></cite>] defined format, a "<a data-xref-type="exception" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror"><code>RangeError</code></a>" is thrown.
            </p>
            <p>
              Current implementations will therefore allow the use of
              well-formed currency codes that are not part of the official
              [<cite><a href="#bib-iso4217" title="Currency codes - ISO 4217" data-link-type="biblio">ISO4217</a></cite>] list (e.g., XBT, XRP, etc.). If the provided code is
              a currency that the browser knows how to display, then an
              implementation will generally display the appropriate currency
              symbol in the user interface (e.g., "USD" is shown as "$", "GBP"
              is "ยฃ", and the non-standard "XBT" could be shown as "ษ"). When a
              code cannot be matched, the specification recommends browsers
              show a scarab "ยค".
            </p>
            <p>
              Efforts are underway at ISO to account for digital currencies,
              which may result in an update to the [<cite><a href="#bib-iso4217" title="Currency codes - ISO 4217" data-link-type="biblio">ISO4217</a></cite>] registry or an
              entirely new registry. The community expects this will resolve
              ambiguities that have crept in through the use of non-standard
              3-letter codes; for example, does "BTC" refer to Bitcoin or to a
              future Bhutan currency? At the time of publication, it remains
              unclear what form this evolution will take, or even the time
              frame in which the work will be completed. The <abbr title="World Wide Web Consortium">W3C</abbr> Web Payments
              Working Group is liaising with ISO so that, in the future,
              revisions to this specification remain compatible with relevant
              ISO registries.
            </p>
          </div></div>
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentcurrencyamount-value" data-idl="field" data-title="value" data-dfn-for="PaymentCurrencyAmount" data-type="DOMString"><code>value</code></dfn> member
        </dt>
        <dd>
          A <a href="#dfn-valid-decimal-monetary-value" data-link-type="dfn">valid decimal monetary value</a> containing a monetary amount.
        </dd>
      </dl>
      <div id="example-11-how-to-represent-us-55-00">
           <pre aria-busy="false"><code>{
  <span>"currency"</span>: <span>"USD"</span>,
  <span>"value"</span>: <span>"55.00"</span>
}</code></pre>
        </div>
      <section id="validity-checkers">
        <h3 id="x5-1-validity-checkers"><bdi>5.1 </bdi>
          Validity checkers
        <a aria-label="ยง" href="#validity-checkers"></a></h3>
        <p>
          A <dfn data-dfn-type="dfn" id="dfn-javascript-string">JavaScript string</dfn> is a <dfn data-dfn-type="dfn" id="dfn-valid-decimal-monetary-value">valid decimal monetary
          value</dfn> if it consists of the following <a data-lt="code point" data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#code-point">code points</a> in the given order:
        </p>
        <ol>
          <li>Optionally, a single U+002D (-), to indicate that the amount is
          negative.
          </li>
          <li>One or more <a data-lt="code point" data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#code-point">code points</a> in the range
          U+0030 (0) to U+0039 (9).
          </li>
          <li>Optionally, a single U+002E (.) followed by one or more
          <a data-lt="code point" data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#code-point">code points</a> in the range U+0030 (0) to
          U+0039 (9).
          </li>
        </ol>
        <div role="note" id="issue-container-generatedID-8"><p><span>Note</span></p><div><p>
          The following regular expression is an implementation of the above
          definition.
          </p><pre aria-busy="false"><code>^-?[0-9]+(.[0-9]+)?$</code></pre>
        </div></div>
        <p>
          To <dfn data-dfn-type="dfn" id="dfn-check-and-canonicalize-amount">check and canonicalize amount</dfn> given a
          <a href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a> <var>amount</var>, run the following steps:
        </p>
        <ol data-link-for="PaymentCurrencyAmount">
          <li>If the result of <a href="https://tc39.github.io/ecma402/#sec-iswellformedcurrencycode">IsWellFormedCurrencyCode</a>(<var>amount</var>.<a href="#dom-paymentcurrencyamount-currency" data-link-type="idl"><code>currency</code></a>)
          is false, then throw a "<a data-xref-type="exception" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror"><code>RangeError</code></a>" exception, optionally
          informing the developer that the currency is invalid.
          </li>
          <li>If <var>amount</var>.<a href="#dom-paymentcurrencyamount-value" data-link-type="idl"><code>value</code></a> is not a <a href="#dfn-valid-decimal-monetary-value" data-link-type="dfn">valid decimal monetary
          value</a>, throw a <a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>, optionally informing the developer
          that the currency is invalid.
          </li>
          <li>Set <var>amount</var>.<a href="#dom-paymentcurrencyamount-currency" data-link-type="idl"><code>currency</code></a> to the result of <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#ascii-uppercase">ASCII
          uppercase</a> <var>amount</var>.<a href="#dom-paymentcurrencyamount-currency" data-link-type="idl"><code>currency</code></a>.
          </li>
        </ol>
        <p>
          To <dfn data-dfn-type="dfn" id="dfn-check-and-canonicalize-total-amount">check and canonicalize total amount</dfn> given a
          <a href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a> <var>amount</var>, run the following steps:
        </p>
        <ol data-link-for="PaymentCurrencyAmount">
          <li>
            <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">Check and canonicalize amount</a> <var>amount</var>. Rethrow any
            exceptions.
          </li>
          <li>If the first <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#code-point">code point</a> of <var>amount</var>.<a href="#dom-paymentcurrencyamount-value" data-link-type="idl"><code>value</code></a> is U+002D
          (-), then throw a <a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a> optionally informing the developer
          that a total's value can't be a negative number.
          </li>
        </ol>
        <div role="note" id="issue-container-generatedID-9"><p><span>Note</span><span>: No alteration of values</span></p></div>
      </section>
    </section>
    <section id="payment-details-dictionaries">
      <h2 id="x6-payment-details-dictionaries"><bdi>6. </bdi>
        Payment details dictionaries
      <a aria-label="ยง" href="#payment-details-dictionaries"></a></h2>
      <section data-dfn-for="PaymentDetailsBase" data-link-for="PaymentDetailsBase" id="paymentdetailsbase-dictionary">
        <h3 id="x6-1-paymentdetailsbase-dictionary"><bdi>6.1 </bdi>
          <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentdetailsbase" data-idl="dictionary" data-title="PaymentDetailsBase" data-dfn-for=""><code>PaymentDetailsBase</code></dfn> dictionary
        <a aria-label="ยง" href="#paymentdetailsbase-dictionary"></a></h3>
        <pre><span data-idl="" id="idl-def-paymentdetailsbase" data-title="PaymentDetailsBase">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsbase"><code>PaymentDetailsBase</code></a> {<span data-idl="" id="idl-def-paymentdetailsbase-displayitems" data-title="displayItems" data-dfn-for="PaymentDetailsBase"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a>&gt;</span> <a data-link-for="PaymentDetailsBase" data-link-type="dict-member" href="#dom-paymentdetailsbase-displayitems"><code>displayItems</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsbase-shippingoptions" data-title="shippingOptions" data-dfn-for="PaymentDetailsBase"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a>&gt;</span> <a data-link-for="PaymentDetailsBase" data-link-type="dict-member" href="#dom-paymentdetailsbase-shippingoptions"><code>shippingOptions</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsbase-modifiers" data-title="modifiers" data-dfn-for="PaymentDetailsBase"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a>&gt;</span> <a data-link-for="PaymentDetailsBase" data-link-type="dict-member" href="#dom-paymentdetailsbase-modifiers"><code>modifiers</code></a>;</span>
};</span></pre>
        <dl>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsbase-displayitems" data-idl="field" data-title="displayItems" data-dfn-for="PaymentDetailsBase" data-type="sequence"><code>displayItems</code></dfn> member
          </dt>
          <dd>
            A sequence of <a href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a> dictionaries contains line items
            for the payment request that the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="MAY">MAY</em> display.
            
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsbase-shippingoptions" data-idl="field" data-title="shippingOptions" data-dfn-for="PaymentDetailsBase" data-type="sequence"><code>shippingOptions</code></dfn> member
          </dt>
          <dd>
            <p>
              A sequence containing the different shipping options for the user
              to choose from.
            </p>
            <p data-tests="change-shipping-option-select-last-manual.https.html">
              If an item in the sequence has the <a data-lt="PaymentShippingOption.selected" href="#dom-paymentshippingoption-selected" data-link-type="idl"><code>selected</code></a> member set to true,
              then this is the shipping option that will be used by default and
              <a data-lt="PaymentRequest.shippingOption" href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a>
              will be set to the <a data-lt="PaymentShippingOption.id" href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a>
              of this option without running the <a href="#dfn-shipping-option-changed-algorithm" data-link-type="dfn">shipping option changed
              algorithm</a>. If more than one item in the sequence has
              <a data-lt="PaymentShippingOption.selected" href="#dom-paymentshippingoption-selected" data-link-type="idl"><code>selected</code></a> set to
              true, then the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> selects the last one in the
              sequence.
            </p>
            <p>
              The <a href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a> member is only used if the
              <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> was constructed with <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a>
              and <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> set to true.
            </p>
            
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-plurals="modifier" data-export="" id="dom-paymentdetailsbase-modifiers" data-idl="field" data-title="modifiers" data-dfn-for="PaymentDetailsBase" data-type="sequence"><code>modifiers</code></dfn> member
          </dt>
          <dd>
            A sequence of <a href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a> dictionaries that
            contains modifiers for particular payment method identifiers. For
            example, it allows you to adjust the total amount based on payment
            method.
          </dd>
        </dl>
      </section>
      <section data-dfn-for="PaymentDetailsInit" data-link-for="PaymentDetailsInit" id="paymentdetailsinit-dictionary">
        <h3 id="x6-2-paymentdetailsinit-dictionary"><bdi>6.2 </bdi>
          <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentdetailsinit" data-idl="dictionary" data-title="PaymentDetailsInit" data-dfn-for=""><code>PaymentDetailsInit</code></dfn> dictionary
        <a aria-label="ยง" href="#paymentdetailsinit-dictionary"></a></h3>
        <pre><span data-idl="" id="idl-def-paymentdetailsinit" data-title="PaymentDetailsInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsinit"><code>PaymentDetailsInit</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a></span> {<span data-idl="" id="idl-def-paymentdetailsinit-id" data-title="id" data-dfn-for="PaymentDetailsInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentDetailsInit" data-link-type="dict-member" href="#dom-paymentdetailsinit-id"><code>id</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsinit-total" data-title="total" data-dfn-for="PaymentDetailsInit">
  required<span> <a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a></span> <a data-link-for="PaymentDetailsInit" data-link-type="dict-member" href="#dom-paymentdetailsinit-total"><code>total</code></a>;</span>
};</span></pre>
        
        <p>
          In addition to the members inherited from the
          <a href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a> dictionary, the following members are part
          of the <a href="#dom-paymentdetailsinit" data-link-type="idl"><code>PaymentDetailsInit</code></a> dictionary:
        </p>
        <dl>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsinit-id" data-idl="field" data-title="id" data-dfn-for="PaymentDetailsInit" data-type="DOMString"><code>id</code></dfn> member
          </dt>
          <dd>
            A free-form identifier for this payment request.
            
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsinit-total" data-idl="field" data-title="total" data-dfn-for="PaymentDetailsInit" data-type="PaymentItem"><code>total</code></dfn> member
          </dt>
          <dd>
            A <a href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a> containing a non-negative total amount for the
            payment request.
            
          </dd>
        </dl>
      </section>
      <section data-dfn-for="PaymentDetailsUpdate" data-link-for="PaymentDetailsUpdate" id="paymentdetailsupdate-dictionary">
        <h3 id="x6-3-paymentdetailsupdate-dictionary"><bdi>6.3 </bdi>
          <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentdetailsupdate" data-idl="dictionary" data-title="PaymentDetailsUpdate" data-dfn-for=""><code>PaymentDetailsUpdate</code></dfn> dictionary
        <a aria-label="ยง" href="#paymentdetailsupdate-dictionary"></a></h3>
        <pre><span data-idl="" id="idl-def-paymentdetailsupdate" data-title="PaymentDetailsUpdate">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsupdate"><code>PaymentDetailsUpdate</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a></span> {<span data-idl="" id="idl-def-paymentdetailsupdate-error" data-title="error" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-error"><code>error</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsupdate-total" data-title="total" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-total"><code>total</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsupdate-shippingaddresserrors" data-title="shippingAddressErrors" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" href="#dom-addresserrors" data-link-type="idl"><code>AddressErrors</code></a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-shippingaddresserrors"><code>shippingAddressErrors</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsupdate-payererrors" data-title="payerErrors" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" href="#dom-paymentdetailsupdate-payererrors" data-link-type="idl">PayerErrors</a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-payererrors"><code>payerErrors</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsupdate-paymentmethoderrors" data-title="paymentMethodErrors" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-paymentmethoderrors"><code>paymentMethodErrors</code></a>;</span>
};</span></pre>
        <p>
          The <a href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a> dictionary is used to update the
          payment request using <a data-lt="PaymentRequestUpdateEvent.updateWith" href="#dom-paymentrequestupdateevent-updatewith" data-link-type="idl"><code>updateWith()</code></a>.
        </p>
        <p>
          In addition to the members inherited from the
          <a href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a> dictionary, the following members are part
          of the <a href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a> dictionary:
        </p>
        <dl>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsupdate-error" data-idl="field" data-title="error" data-dfn-for="PaymentDetailsUpdate" data-type="DOMString"><code>error</code></dfn> member
          </dt>
          <dd>
            A human-readable string that explains why goods cannot be shipped
            to the chosen shipping address, or any other reason why no shipping
            options are available. When the payment request is updated using
            <a data-lt="PaymentRequestUpdateEvent.updateWith" href="#dom-paymentrequestupdateevent-updatewith" data-link-type="idl"><code>updateWith()</code></a>,
            the <a href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a> can contain a message in the
            <a href="#dom-paymentdetailsupdate-error" data-link-type="idl"><code>error</code></a> member that will be displayed to the user if the
            <a href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a> indicates that there are no valid
            <a data-lt="PaymentDetailsBase.shippingOptions" href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a>
            (and the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> was constructed with the <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> option set to
            true).
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsupdate-total" data-idl="field" data-title="total" data-dfn-for="PaymentDetailsUpdate" data-type="PaymentItem"><code>total</code></dfn> member
          </dt>
          <dd>
            A <a href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a> containing a non-negative <a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>.
            
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsupdate-shippingaddresserrors" data-idl="field" data-title="shippingAddressErrors" data-dfn-for="PaymentDetailsUpdate" data-type="AddressErrors"><code>shippingAddressErrors</code></dfn> member
          </dt>
          <dd>
            Represents validation errors with the shipping address that is
            associated with the <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#potential-event-target">potential event target</a>.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsupdate-payererrors" data-idl="field" data-title="payerErrors" data-dfn-for="PaymentDetailsUpdate" data-type="PayerErrors"><code>payerErrors</code></dfn> member
          </dt>
          <dd>
            Validation errors related to the <a href="#dfn-payer-details" data-link-type="dfn">payer details</a>.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsupdate-paymentmethoderrors" data-idl="field" data-title="paymentMethodErrors" data-dfn-for="PaymentDetailsUpdate" data-type="object"><code>paymentMethodErrors</code></dfn> member
          </dt>
          <dd>
            <p>
              <a href="#dfn-payment-method" data-link-type="dfn">Payment method</a> specific errors. See, for example,
              [<cite><a href="#bib-payment-method-basic-card" title="Basic Card Payment" data-link-type="biblio">payment-method-basic-card</a></cite>]'s <a href="https://www.w3.org/TR/payment-method-basic-card/#basiccarderrors-dictionary"><code>BasicCardErrors</code></a>.
            </p>
          </dd>
        </dl>
      </section>
    </section>
    <section data-dfn-for="PaymentDetailsModifier" data-link-for="PaymentDetailsModifier" id="paymentdetailsmodifier-dictionary">
      <h2 id="x7-paymentdetailsmodifier-dictionary"><bdi>7. </bdi>
        <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentdetailsmodifier" data-idl="dictionary" data-title="PaymentDetailsModifier" data-dfn-for=""><code>PaymentDetailsModifier</code></dfn> dictionary
      <a aria-label="ยง" href="#paymentdetailsmodifier-dictionary"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentdetailsmodifier" data-title="PaymentDetailsModifier">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsmodifier"><code>PaymentDetailsModifier</code></a> {<span data-idl="" id="idl-def-paymentdetailsmodifier-supportedmethods" data-title="supportedMethods" data-dfn-for="PaymentDetailsModifier">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-supportedmethods"><code>supportedMethods</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsmodifier-total" data-title="total" data-dfn-for="PaymentDetailsModifier"><span>
  <a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a></span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-total"><code>total</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsmodifier-additionaldisplayitems" data-title="additionalDisplayItems" data-dfn-for="PaymentDetailsModifier"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a>&gt;</span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-additionaldisplayitems"><code>additionalDisplayItems</code></a>;</span><span data-idl="" id="idl-def-paymentdetailsmodifier-data" data-title="data" data-dfn-for="PaymentDetailsModifier"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-data"><code>data</code></a>;</span>
};</span></pre>
      <p>
        The <a href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a> dictionary provides details that
        modify the <a href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a> based on a <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method
        identifier</a>. It contains the following members:
      </p>
      <dl>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsmodifier-supportedmethods" data-idl="field" data-title="supportedMethods" data-dfn-for="PaymentDetailsModifier" data-type="DOMString"><code>supportedMethods</code></dfn> member
        </dt>
        <dd>
          A <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a>. The members of the
          <a href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a> only apply if the user selects this
          <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsmodifier-total" data-idl="field" data-title="total" data-dfn-for="PaymentDetailsModifier" data-type="PaymentItem"><code>total</code></dfn> member
        </dt>
        <dd>
          A <a href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a> value that overrides the <a data-lt="PaymentDetailsInit.total" href="#dom-paymentdetailsinit-total" data-link-type="idl"><code>total</code></a> member in the
          <a href="#dom-paymentdetailsinit" data-link-type="idl"><code>PaymentDetailsInit</code></a> dictionary for the <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method
          identifiers</a> of the <a href="#dom-paymentdetailsmodifier-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a> member.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsmodifier-additionaldisplayitems" data-idl="field" data-title="additionalDisplayItems" data-dfn-for="PaymentDetailsModifier" data-type="sequence"><code>additionalDisplayItems</code></dfn> member
        </dt>
        <dd>
          A sequence of <a href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a> dictionaries provides additional
          display items that are appended to the <a data-lt="PaymentDetailsBase.displayItems" href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a> member in the
          <a href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a> dictionary for the <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method
          identifiers</a> in the <a href="#dom-paymentdetailsmodifier-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a> member. This member is
          commonly used to add a discount or surcharge line item indicating the
          reason for the different <a href="#dom-paymentdetailsmodifier-total" data-link-type="idl"><code>total</code></a> amount for the selected
          <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> that the user agent <em title="MAY">MAY</em> display.
          
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentdetailsmodifier-data" data-idl="field" data-title="data" data-dfn-for="PaymentDetailsModifier" data-type="object"><code>data</code></dfn> member
        </dt>
        <dd>
          An object that provides optional information that might be needed by
          the supported payment methods. If supplied, it will be
          <a href="#dfn-json-serialized" data-link-type="dfn">JSON-serialized</a>.
        </dd>
      </dl>
    </section>
    <section data-dfn-for="PaymentShippingType" id="paymentshippingtype-enum">
      <h2 id="x8-paymentshippingtype-enum"><bdi>8. </bdi>
        <dfn data-dfn-type="enum" data-export="" id="dom-paymentshippingtype" data-idl="enum" data-title="PaymentShippingType" data-dfn-for=""><code>PaymentShippingType</code></dfn> enum
      <a aria-label="ยง" href="#paymentshippingtype-enum"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentshippingtype" data-title="PaymentShippingType">enum <a data-link-for="" data-link-type="enum" href="#dom-paymentshippingtype"><code>PaymentShippingType</code></a> {
  <span>"<a data-link-for="PaymentShippingType" data-link-type="enum-value" href="#dom-paymentshippingtype-shipping"><code>shipping</code></a>"</span>,
  <span>"<a data-link-for="PaymentShippingType" data-link-type="enum-value" href="#dom-paymentshippingtype-delivery"><code>delivery</code></a>"</span>,
  <span>"<a data-link-for="PaymentShippingType" data-link-type="enum-value" href="#dom-paymentshippingtype-pickup"><code>pickup</code></a>"</span>
};</span></pre>
      <dl>
        <dt>
          "<dfn data-dfn-type="enum-value" data-export="" id="dom-paymentshippingtype-shipping" data-idl="enum-value" data-title="shipping" data-dfn-for="PaymentShippingType"><code>shipping</code></dfn>"
        </dt>
        <dd>
          This is the default and refers to the address being collected as the
          destination for shipping.
        </dd>
        <dt>
          "<dfn data-dfn-type="enum-value" data-export="" id="dom-paymentshippingtype-delivery" data-idl="enum-value" data-title="delivery" data-dfn-for="PaymentShippingType"><code>delivery</code></dfn>"
        </dt>
        <dd>
          This refers to the address being collected as the destination for
          delivery. This is commonly faster than shipping. For example, it
          might be used for food delivery.
        </dd>
        <dt>
          "<dfn data-dfn-type="enum-value" data-export="" id="dom-paymentshippingtype-pickup" data-idl="enum-value" data-title="pickup" data-dfn-for="PaymentShippingType"><code>pickup</code></dfn>"
        </dt>
        <dd>
          This refers to the address being collected as part of a service
          pickup. For example, this could be the address for laundry pickup.
        </dd>
      </dl>
    </section>
    <section data-dfn-for="PaymentOptions" data-link-for="PaymentOptions" id="paymentoptions-dictionary">
      <h2 id="x9-paymentoptions-dictionary"><bdi>9. </bdi>
        <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentoptions" data-idl="dictionary" data-title="PaymentOptions" data-dfn-for=""><code>PaymentOptions</code></dfn> dictionary
      <a aria-label="ยง" href="#paymentoptions-dictionary"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentoptions" data-title="PaymentOptions">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentoptions"><code>PaymentOptions</code></a> {<span data-idl="" id="idl-def-paymentoptions-requestpayername" data-title="requestPayerName" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestpayername"><code>requestPayerName</code></a> = false;</span><span data-idl="" id="idl-def-paymentoptions-requestbillingaddress" data-title="requestBillingAddress" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestbillingaddress"><code>requestBillingAddress</code></a> = false;</span><span data-idl="" id="idl-def-paymentoptions-requestpayeremail" data-title="requestPayerEmail" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestpayeremail"><code>requestPayerEmail</code></a> = false;</span><span data-idl="" id="idl-def-paymentoptions-requestpayerphone" data-title="requestPayerPhone" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestpayerphone"><code>requestPayerPhone</code></a> = false;</span><span data-idl="" id="idl-def-paymentoptions-requestshipping" data-title="requestShipping" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestshipping"><code>requestShipping</code></a> = false;</span><span data-idl="" id="idl-def-paymentoptions-shippingtype" data-title="shippingType" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" href="#dom-paymentshippingtype" data-link-type="idl"><code>PaymentShippingType</code></a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-shippingtype"><code>shippingType</code></a> = "shipping";</span>
};</span></pre>
      <div role="note" id="issue-container-generatedID-17"><p><span>Note</span></p><p>
        The <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> dictionary is passed to the
        <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> constructor and provides information about the
        options desired for the payment request.
      </p></div>
      <dl>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentoptions-requestbillingaddress" data-idl="field" data-title="requestBillingAddress" data-dfn-for="PaymentOptions" data-type="boolean"><code>requestBillingAddress</code></dfn> member
        </dt>
        <dd data-link-for="PaymentMethodChangeEvent">
          A boolean that indicates whether the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="SHOULD">SHOULD</em> collect
          and return the billing address associated with a <a href="#dfn-payment-method" data-link-type="dfn">payment
          method</a> (e.g., the billing address associated with a credit card).
          Typically, the user agent will return the billing address as part of
          the <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeevent" data-link-type="idl"><code><code>PaymentMethodChangeEvent</code></code></a>'s <a href="#dom-paymentmethodchangeevent-methoddetails" data-link-type="idl"><code>methodDetails</code></a>. A merchant
          can use this information to, for example, calculate tax in certain
          jurisdictions and update the displayed total. See below for privacy
          considerations regarding <a href="#user-info">exposing user
          information</a>.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentoptions-requestpayername" data-idl="field" data-title="requestPayerName" data-dfn-for="PaymentOptions" data-type="boolean"><code>requestPayerName</code></dfn> member
        </dt>
        <dd>
          A boolean that indicates whether the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="SHOULD">SHOULD</em> collect
          and return the payer's name as part of the payment request. For
          example, this would be set to true to allow a merchant to make a
          booking in the payer's name.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentoptions-requestpayeremail" data-idl="field" data-title="requestPayerEmail" data-dfn-for="PaymentOptions" data-type="boolean"><code>requestPayerEmail</code></dfn> member
        </dt>
        <dd>
          A boolean that indicates whether the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="SHOULD">SHOULD</em> collect
          and return the payer's email address as part of the payment request.
          For example, this would be set to true to allow a merchant to email a
          receipt.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentoptions-requestpayerphone" data-idl="field" data-title="requestPayerPhone" data-dfn-for="PaymentOptions" data-type="boolean"><code>requestPayerPhone</code></dfn> member
        </dt>
        <dd>
          A boolean that indicates whether the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="SHOULD">SHOULD</em> collect
          and return the payer's phone number as part of the payment request.
          For example, this would be set to true to allow a merchant to phone a
          customer with a billing enquiry.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentoptions-requestshipping" data-idl="field" data-title="requestShipping" data-dfn-for="PaymentOptions" data-type="boolean"><code>requestShipping</code></dfn> member
        </dt>
        <dd>
          A boolean that indicates whether the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="SHOULD">SHOULD</em> collect
          and return a shipping address as part of the payment request. For
          example, this would be set to true when physical goods need to be
          shipped by the merchant to the user. This would be set to false for
          the purchase of digital goods.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentoptions-shippingtype" data-idl="field" data-title="shippingType" data-dfn-for="PaymentOptions" data-type="PaymentShippingType"><code>shippingType</code></dfn> member
        </dt>
        <dd>
          A <a href="#dom-paymentshippingtype" data-link-type="idl"><code>PaymentShippingType</code></a> enum value. Some transactions require an
          address for delivery but the term "shipping" isn't appropriate. For
          example, "pizza delivery" not "pizza shipping" and "laundry pickup"
          not "laundry shipping". If <a href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> is set to true,
          then the <a href="#dom-paymentoptions-shippingtype" data-link-type="idl"><code>shippingType</code></a> member can influence the way the <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> presents the user interface for gathering the shipping
          address.
          <p>
            The <a href="#dom-paymentoptions-shippingtype" data-link-type="idl"><code>shippingType</code></a> member only affects the user interface for
            the payment request.
          </p>
        </dd>
      </dl>
    </section>
    <section data-dfn-for="PaymentItem" data-link-for="PaymentItem" id="paymentitem-dictionary">
      <h2 id="x10-paymentitem-dictionary"><bdi>10. </bdi>
        <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentitem" data-idl="dictionary" data-title="PaymentItem" data-dfn-for=""><code>PaymentItem</code></dfn> dictionary
      <a aria-label="ยง" href="#paymentitem-dictionary"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentitem" data-title="PaymentItem">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentitem"><code>PaymentItem</code></a> {<span data-idl="" id="idl-def-paymentitem-label" data-title="label" data-dfn-for="PaymentItem">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentItem" data-link-type="dict-member" href="#dom-paymentitem-label"><code>label</code></a>;</span><span data-idl="" id="idl-def-paymentitem-amount" data-title="amount" data-dfn-for="PaymentItem">
  required<span> <a data-xref-type="_IDL_" href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a></span> <a data-link-for="PaymentItem" data-link-type="dict-member" href="#dom-paymentitem-amount"><code>amount</code></a>;</span><span data-idl="" id="idl-def-paymentitem-pending" data-title="pending" data-dfn-for="PaymentItem"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentItem" data-link-type="dict-member" href="#dom-paymentitem-pending"><code>pending</code></a> = false;</span>
};</span></pre>
      <p>
        A sequence of one or more <a href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a> dictionaries is included
        in the <a href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a> dictionary to indicate what the
        payment request is for and the value asked for.
      </p>
      <dl>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentitem-label" data-idl="field" data-title="label" data-dfn-for="PaymentItem" data-type="DOMString"><code>label</code></dfn> member
        </dt>
        <dd>
          A human-readable description of the item. The <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> may
          display this to the user.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentitem-amount" data-idl="field" data-title="amount" data-dfn-for="PaymentItem" data-type="PaymentCurrencyAmount"><code>amount</code></dfn> member
        </dt>
        <dd>
          A <a href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a> containing the monetary amount for the
          item.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentitem-pending" data-idl="field" data-title="pending" data-dfn-for="PaymentItem" data-type="boolean"><code>pending</code></dfn> member
        </dt>
        <dd>
          A boolean. When set to true it means that the <a href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a> member is
          not final. This is commonly used to show items such as shipping or
          tax amounts that depend upon selection of shipping address or
          shipping option. <a href="#dfn-user-agent" data-link-type="dfn">User agents</a> <em title="MAY">MAY</em> indicate pending fields in
          the user interface for the payment request.
        </dd>
      </dl>
    </section>
    <section id="physical-addresses">
      <h2 id="x11-physical-addresses"><bdi>11. </bdi>
        Physical addresses
      <a aria-label="ยง" href="#physical-addresses"></a></h2>
      <p>
        A <dfn data-dfn-type="dfn" data-plurals="physical addresses" id="dfn-physical-address">physical address</dfn> is composed of the following parts.
      </p>
      <dl data-sort=""><dt>
          <dfn data-dfn-type="dfn" id="dfn-address-line">Address line</dfn>
        </dt>
        <dd>
          The most specific part of the address. It can include, for example, a
          street name, a house number, apartment number, a rural delivery
          route, descriptive instructions, or a post office box number.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-city">City</dfn>
        </dt>
        <dd>
          The city/town portion of the address.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-country">Country</dfn>
        </dt>
        <dd>
          The country corresponding to the address.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-dependent-locality">Dependent locality</dfn>
        </dt>
        <dd>
          The dependent locality or sublocality within a city. For example,
          neighborhoods, boroughs, districts, or UK dependent localities.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-organization">Organization</dfn>
        </dt>
        <dd>
          The organization, firm, company, or institution at the address.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-phone-number">Phone number</dfn>
        </dt>
        <dd>
          The phone number of the recipient or contact person at the address.
        </dd><dt>
          <dfn data-dfn-type="dfn" data-plurals="postal codes" id="dfn-postal-code">Postal code</dfn>
        </dt>
        <dd>
          The postal code or ZIP code, also known as PIN code in India.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-recipient">Recipient</dfn>
        </dt>
        <dd>
          The name of the recipient or contact person at the address.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-region">Region</dfn>
        </dt>
        <dd>
          The top level administrative subdivision of the country. For example,
          this can be a state, a province, an oblast, or a prefecture.
        </dd>
        <dt>
          <dfn data-dfn-type="dfn" id="dfn-sorting-code">Sorting code</dfn>
        </dt>
        <dd>
          The sorting code as used in, for example, France.
        </dd>
        </dl>
      <section data-dfn-for="PaymentAddress" data-link-for="PaymentAddress" id="paymentaddress-interface">
        <h3 id="x11-1-paymentaddress-interface"><bdi>11.1 </bdi>
          <dfn data-dfn-type="interface" data-export="" id="dom-paymentaddress" data-idl="interface" data-title="PaymentAddress" data-dfn-for=""><code>PaymentAddress</code></dfn> interface
        <a aria-label="ยง" href="#paymentaddress-interface"></a></h3>
        <pre><span data-idl="" id="idl-def-paymentaddress" data-title="PaymentAddress">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>)</span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentaddress"><code>PaymentAddress</code></a> {<span data-idl="" id="idl-def-paymentaddress-tojson" data-title="toJSON" data-dfn-for="PaymentAddress">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Default">Default</a></span>]<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentAddress" data-link-type="method" href="#dom-paymentaddress-tojson"><code>toJSON</code></a>();</span><span data-idl="" id="idl-def-paymentaddress-city" data-title="city" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-city"><code>city</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-country" data-title="country" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-country"><code>country</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-dependentlocality" data-title="dependentLocality" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-dependentlocality"><code>dependentLocality</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-organization" data-title="organization" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-organization"><code>organization</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-phone" data-title="phone" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-phone"><code>phone</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-postalcode" data-title="postalCode" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-postalcode"><code>postalCode</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-recipient" data-title="recipient" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-recipient"><code>recipient</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-region" data-title="region" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-region"><code>region</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-sortingcode" data-title="sortingCode" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-sortingcode"><code>sortingCode</code></a>;</span><span data-idl="" id="idl-def-paymentaddress-addressline" data-title="addressLine" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-frozen-array">FrozenArray</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>&gt;</span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-addressline"><code>addressLine</code></a>;</span>
};</span></pre>
        <p>
          The <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a> interface represents a <a href="#dfn-physical-address" data-link-type="dfn">physical
          address</a>.
        </p>
        <div role="note" id="issue-container-generatedID-18"><p><span>Note</span><span>: What happened to regionCode?</span></p></div>
        <section id="internal-constructor">
          <h4 id="x11-1-1-internal-constructor"><bdi>11.1.1 </bdi>
            Internal constructor
          <a aria-label="ยง" href="#internal-constructor"></a></h4>
          <p>
            The steps to <dfn data-lt="PaymentAddress.PaymentAddress()|internally construct a PaymentAddress" data-dfn-type="dfn" id="dfn-paymentaddress-paymentaddress">internally construct a
            <code>PaymentAddress</code></dfn> with an optional
            <a href="#dom-addressinit" data-link-type="idl"><code>AddressInit</code></a> <var>details</var> are given by the following algorithm:
          </p>
          <ol data-link-for="AddressInit">
            <li>Let <var data-type="PaymentAddress">address</var> be a new instance of
            <a data-xref-type="_IDL_" href="#dom-paymentaddress" data-link-type="idl"><code><code>PaymentAddress</code></code></a>.
            </li>
            <li>Set <var data-type="PaymentAddress">address</var>.<a href="#dfn-addressline" data-link-type="dfn">[[addressLine]]</a> to the empty frozen
            array, and all other <a data-lt="PaymentAddress slots" href="#dfn-paymentaddress-slots" data-link-type="dfn">internal
            slots</a> to the empty string.
            </li>
            <li>If <var>details</var> was not passed, return <var data-type="PaymentAddress">address</var>.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-country" data-link-type="idl"><code>country</code></a>"] is present and not the empty
            string:
              <ol>
                <li>Set <var>country</var> the result of <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip leading and trailing
                ASCII whitespace</a> from <var>details</var>["<a href="#dom-addressinit-country" data-link-type="idl"><code>country</code></a>"] and
                performing <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#ascii-uppercase">ASCII uppercase</a>.
                </li>
                <li>If <var>country</var> is not a valid [<cite><a href="#bib-iso3166-1" title="ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 1: Country codes" data-link-type="biblio">ISO3166-1</a></cite>] alpha-2 code,
                throw a "<a data-xref-type="exception" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror"><code>RangeError</code></a>" exception.
                </li>
                <li>Set <var data-type="PaymentAddress">address</var>.<a href="#dfn-country-0" data-link-type="dfn">[[country]]</a> to <var>country</var>.
                </li>
              </ol>
            </li>
            <li>Let <var>cleanAddressLines</var> be an empty list.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-addressline" data-link-type="idl"><code>addressLine</code></a>"] is present, then for each
            <var>item</var> in <var>details</var>["<a href="#dom-addressinit-addressline" data-link-type="idl"><code>addressLine</code></a>"]:
              <ol>
                <li>
                  <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">Strip leading and trailing ASCII whitespace</a> from
                  <var>item</var> and append the result into <var>cleanAddressLines</var>.
                </li>
              </ol>
            </li>
            <li>Set <var data-type="PaymentAddress">address</var>.<a href="#dfn-addressline" data-link-type="dfn">[[addressLine]]</a> to a new frozen array
            created from <var>cleanAddressLines</var>.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-region" data-link-type="idl"><code>region</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip leading and
            trailing ASCII whitespace</a> from <var>details</var>["<a href="#dom-addressinit-region" data-link-type="idl"><code>region</code></a>"] and
            set <var data-type="PaymentAddress">address</var>.<a href="#dfn-region-0" data-link-type="dfn">[[region]]</a> to the result.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-city" data-link-type="idl"><code>city</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip leading and
            trailing ASCII whitespace</a> from <var>details</var>["<a href="#dom-addressinit-city" data-link-type="idl"><code>city</code></a>"] and set
            <var data-type="PaymentAddress">address</var>.<a href="#dfn-city-0" data-link-type="dfn">[[city]]</a> to the result.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-dependentlocality" data-link-type="idl"><code>dependentLocality</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip
            leading and trailing ASCII whitespace</a> from
            <var>details</var>["<a href="#dom-addressinit-dependentlocality" data-link-type="idl"><code>dependentLocality</code></a>"] and set
            <var data-type="PaymentAddress">address</var>.<a href="#dfn-dependentlocality" data-link-type="dfn">[[dependentLocality]]</a> to the result.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-postalcode" data-link-type="idl"><code>postalCode</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip leading
            and trailing ASCII whitespace</a> from
            <var>details</var>["<a href="#dom-addressinit-postalcode" data-link-type="idl"><code>postalCode</code></a>"] and set
            <var data-type="PaymentAddress">address</var>.<a href="#dfn-postalcode" data-link-type="dfn">[[postalCode]]</a> to the result.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-sortingcode" data-link-type="idl"><code>sortingCode</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip leading
            and trailing ASCII whitespace</a> from
            <var>details</var>["<a href="#dom-addressinit-sortingcode" data-link-type="idl"><code>sortingCode</code></a>"] and set
            <var data-type="PaymentAddress">address</var>.<a href="#dfn-sortingcode" data-link-type="dfn">[[sortingCode]]</a> to the result.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-organization" data-link-type="idl"><code>organization</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip
            leading and trailing ASCII whitespace</a> from
            <var>details</var>["<a href="#dom-addressinit-organization" data-link-type="idl"><code>organization</code></a>"] and set
            <var data-type="PaymentAddress">address</var>.<a href="#dfn-organization-0" data-link-type="dfn">[[organization]]</a> to the result.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-recipient" data-link-type="idl"><code>recipient</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip leading
            and trailing ASCII whitespace</a> from
            <var>details</var>["<a href="#dom-addressinit-recipient" data-link-type="idl"><code>recipient</code></a>"] and set
            <var data-type="PaymentAddress">address</var>.<a href="#dfn-recipient-0" data-link-type="dfn">[[recipient]]</a> to the result.
            </li>
            <li>If <var>details</var>["<a href="#dom-addressinit-phone" data-link-type="idl"><code>phone</code></a>"] is present, <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace">strip leading and
            trailing ASCII whitespace</a> from <var>details</var>["<a href="#dom-addressinit-phone" data-link-type="idl"><code>phone</code></a>"] and
            set <var data-type="PaymentAddress">address</var>.<a href="#dfn-phone" data-link-type="dfn">[[phone]]</a> to the result.
            </li>
            <li>Return <var data-type="PaymentAddress">address</var>.
            </li>
          </ol>
        </section>
        <section id="tojson-method">
          <h4 id="x11-1-2-tojson-method"><bdi>11.1.2 </bdi>
            <dfn data-dfn-type="method" data-export="" id="dom-paymentaddress-tojson" data-idl="operation" data-title="toJSON()" data-dfn-for="PaymentAddress" data-type="object" data-lt="PaymentAddress.toJSON()|PaymentAddress.toJSON|toJSON()|toJSON"><code>toJSON()</code></dfn> method
          <a aria-label="ยง" href="#tojson-method"></a></h4>
          <p>
            When called, runs [<cite><a href="#bib-webidl" title="Web IDL" data-link-type="biblio">WEBIDL</a></cite>]'s <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#default-tojson-operation">default toJSON operation</a>.
          </p>
        </section>
        <section id="country-attribute">
          <h4 id="x11-1-3-country-attribute"><bdi>11.1.3 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-country" data-idl="attribute" data-title="country" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.country|country"><code>country</code></dfn> attribute
          <a aria-label="ยง" href="#country-attribute"></a></h4>
          <p data-link-for="">
            Represents the <a href="#dfn-country" data-link-type="dfn">country</a> of the address. When getting, returns
            the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a href="#dfn-country-0" data-link-type="dfn">[[country]]</a>
            internal slot.
          </p>
        </section>
        <section id="addressline-attribute">
          <h4 id="x11-1-4-addressline-attribute"><bdi>11.1.4 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-addressline" data-idl="attribute" data-title="addressLine" data-dfn-for="PaymentAddress" data-type="FrozenArray" data-lt="PaymentAddress.addressLine|addressLine"><code>addressLine</code></dfn> attribute
          <a aria-label="ยง" href="#addressline-attribute"></a></h4>
          <p data-link-for="">
            Represents the <a href="#dfn-address-line" data-link-type="dfn">address line</a> of the address. When getting,
            returns the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s
            <a href="#dfn-addressline" data-link-type="dfn">[[addressLine]]</a> internal slot.
          </p>
        </section>
        <section id="region-attribute">
          <h4 id="x11-1-5-region-attribute"><bdi>11.1.5 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-region" data-idl="attribute" data-title="region" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.region|region"><code>region</code></dfn> attribute
          <a aria-label="ยง" href="#region-attribute"></a></h4>
          <p data-link-for="">
            Represents the <a href="#dfn-region" data-link-type="dfn">region</a> of the address. When getting, returns
            the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a href="#dfn-region-0" data-link-type="dfn">[[region]]</a>
            internal slot.
          </p>
        </section>
        <section id="city-attribute">
          <h4 id="x11-1-6-city-attribute"><bdi>11.1.6 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-city" data-idl="attribute" data-title="city" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.city|city"><code>city</code></dfn> attribute
          <a aria-label="ยง" href="#city-attribute"></a></h4>
          <p data-link-for="">
            Represents the <a href="#dfn-city" data-link-type="dfn">city</a> of the address. When getting, returns
            the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a href="#dfn-city-0" data-link-type="dfn">[[city]]</a> internal
            slot.
          </p>
        </section>
        <section id="dependentlocality-attribute">
          <h4 id="x11-1-7-dependentlocality-attribute"><bdi>11.1.7 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-dependentlocality" data-idl="attribute" data-title="dependentLocality" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.dependentLocality|dependentLocality"><code>dependentLocality</code></dfn> attribute
          <a aria-label="ยง" href="#dependentlocality-attribute"></a></h4>
          <p>
            Represents the <a href="#dfn-dependent-locality" data-link-type="dfn">dependent locality</a> of the address. When
            getting, returns the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s
            <a href="#dfn-dependentlocality" data-link-type="dfn">[[dependentLocality]]</a> internal slot.
          </p>
        </section>
        <section id="postalcode-attribute">
          <h4 id="x11-1-8-postalcode-attribute"><bdi>11.1.8 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-postalcode" data-idl="attribute" data-title="postalCode" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.postalCode|postalCode"><code>postalCode</code></dfn> attribute
          <a aria-label="ยง" href="#postalcode-attribute"></a></h4>
          <p>
            Represents the <a href="#dfn-postal-code" data-link-type="dfn">postal code</a> of the address. When getting,
            returns the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s
            <a href="#dfn-postalcode" data-link-type="dfn">[[postalCode]]</a> internal slot.
          </p>
        </section>
        <section id="sortingcode-attribute">
          <h4 id="x11-1-9-sortingcode-attribute"><bdi>11.1.9 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-sortingcode" data-idl="attribute" data-title="sortingCode" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.sortingCode|sortingCode"><code>sortingCode</code></dfn> attribute
          <a aria-label="ยง" href="#sortingcode-attribute"></a></h4>
          <p>
            Represents the <a href="#dfn-sorting-code" data-link-type="dfn">sorting code</a> of the address. When getting,
            returns the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s
            <a href="#dfn-sortingcode" data-link-type="dfn">[[sortingCode]]</a> internal slot.
          </p>
        </section>
        <section id="organization-attribute">
          <h4 id="x11-1-10-organization-attribute"><bdi>11.1.10 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-organization" data-idl="attribute" data-title="organization" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.organization|organization"><code>organization</code></dfn> attribute
          <a aria-label="ยง" href="#organization-attribute"></a></h4>
          <p data-link-for="">
            Represents the <a href="#dfn-organization" data-link-type="dfn">organization</a> of the address. When getting,
            returns the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s
            <a href="#dfn-organization-0" data-link-type="dfn">[[organization]]</a> internal slot.
          </p>
        </section>
        <section id="recipient-attribute">
          <h4 id="x11-1-11-recipient-attribute"><bdi>11.1.11 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-recipient" data-idl="attribute" data-title="recipient" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.recipient|recipient"><code>recipient</code></dfn> attribute
          <a aria-label="ยง" href="#recipient-attribute"></a></h4>
          <p data-link-for="">
            Represents the <a href="#dfn-recipient" data-link-type="dfn">recipient</a> of the address. When getting,
            returns the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s
            <a href="#dfn-recipient-0" data-link-type="dfn">[[recipient]]</a> internal slot.
          </p>
        </section>
        <section id="phone-attribute">
          <h4 id="x11-1-12-phone-attribute"><bdi>11.1.12 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentaddress-phone" data-idl="attribute" data-title="phone" data-dfn-for="PaymentAddress" data-type="DOMString" data-lt="PaymentAddress.phone|phone"><code>phone</code></dfn> attribute
          <a aria-label="ยง" href="#phone-attribute"></a></h4>
          <p>
            Represents the <a href="#dfn-phone-number" data-link-type="dfn">phone number</a> of the address. When getting,
            returns the value of the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a href="#dfn-phone" data-link-type="dfn">[[phone]]</a>
            internal slot.
          </p>
        </section>
        <section data-link-for="" id="internal-slots-0">
          <h4 id="x11-1-13-internal-slots"><bdi>11.1.13 </bdi>
            <dfn data-lt="PaymentAddress slots" data-lt-nodefault="" data-dfn-type="dfn" id="dfn-paymentaddress-slots">Internal
            slots</dfn>
          <a aria-label="ยง" href="#internal-slots-0"></a></h4>
          <table>
            <tbody><tr>
              <th>
                Internal slot
              </th>
              <th>
                Description (<em>non-normative</em>)
              </th>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-country-0">[[country]]</dfn>
              </td>
              <td>
                A <a href="#dfn-country" data-link-type="dfn">country</a> as an [<cite><a href="#bib-iso3166-1" title="ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 1: Country codes" data-link-type="biblio">ISO3166-1</a></cite>] alpha-2 code stored in its
                canonical uppercase form or the empty string. For example,
                "JP".
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-addressline">[[addressLine]]</dfn>
              </td>
              <td>
                A frozen array, possibly of zero length, representing an
                <a href="#dfn-address-line" data-link-type="dfn">address line</a>.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-region-0">[[region]]</dfn>
              </td>
              <td>
                A <a href="#dfn-region" data-link-type="dfn">region</a> as a <a href="#dfn-country-subdivision-names" data-link-type="dfn">country subdivision name</a> or the
                empty string, such as "Victoria", representing the state of
                Victoria in Australia.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-city-0">[[city]]</dfn>
              </td>
              <td>
                A <a href="#dfn-city" data-link-type="dfn">city</a> or the empty string.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-dependentlocality">[[dependentLocality]]</dfn>
              </td>
              <td>
                A <a href="#dfn-dependent-locality" data-link-type="dfn">dependent locality</a> or the empty string.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-postalcode">[[postalCode]]</dfn>
              </td>
              <td>
                A <a href="#dfn-postal-code" data-link-type="dfn">postal code</a> or the empty string.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-sortingcode">[[sortingCode]]</dfn>
              </td>
              <td>
                A <a href="#dfn-sorting-code" data-link-type="dfn">sorting code</a> or the empty string.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-organization-0">[[organization]]</dfn>
              </td>
              <td>
                An <a href="#dfn-organization" data-link-type="dfn">organization</a> or the empty string.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-recipient-0">[[recipient]]</dfn>
              </td>
              <td>
                A <a href="#dfn-recipient" data-link-type="dfn">recipient</a> or the empty string.
              </td>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-phone">[[phone]]</dfn>
              </td>
              <td>
                A <a href="#dfn-phone-number" data-link-type="dfn">phone number</a> or the empty string.
              </td>
            </tr>
          </tbody></table>
        </section>
      </section>
      <section data-dfn-for="AddressInit" data-link-for="AddressInit" id="addressinit-dictionary">
        <h3 id="x11-2-addressinit-dictionary"><bdi>11.2 </bdi>
          <dfn data-dfn-type="dictionary" data-export="" id="dom-addressinit" data-idl="dictionary" data-title="AddressInit" data-dfn-for=""><code>AddressInit</code></dfn> dictionary
        <a aria-label="ยง" href="#addressinit-dictionary"></a></h3>
        <pre><span data-idl="" id="idl-def-addressinit" data-title="AddressInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-addressinit"><code>AddressInit</code></a> {<span data-idl="" id="idl-def-addressinit-country" data-title="country" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-country"><code>country</code></a>;</span><span data-idl="" id="idl-def-addressinit-addressline" data-title="addressLine" data-dfn-for="AddressInit"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>&gt;</span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-addressline"><code>addressLine</code></a>;</span><span data-idl="" id="idl-def-addressinit-region" data-title="region" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-region"><code>region</code></a>;</span><span data-idl="" id="idl-def-addressinit-city" data-title="city" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-city"><code>city</code></a>;</span><span data-idl="" id="idl-def-addressinit-dependentlocality" data-title="dependentLocality" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-dependentlocality"><code>dependentLocality</code></a>;</span><span data-idl="" id="idl-def-addressinit-postalcode" data-title="postalCode" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-postalcode"><code>postalCode</code></a>;</span><span data-idl="" id="idl-def-addressinit-sortingcode" data-title="sortingCode" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-sortingcode"><code>sortingCode</code></a>;</span><span data-idl="" id="idl-def-addressinit-organization" data-title="organization" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-organization"><code>organization</code></a>;</span><span data-idl="" id="idl-def-addressinit-recipient" data-title="recipient" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-recipient"><code>recipient</code></a>;</span><span data-idl="" id="idl-def-addressinit-phone" data-title="phone" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-phone"><code>phone</code></a>;</span>
};</span></pre>
        <p>
          An <a href="#dom-addressinit" data-link-type="idl"><code>AddressInit</code></a> is passed when <a data-lt="PaymentAddress.PaymentAddress()" href="#dfn-paymentaddress-paymentaddress" data-link-type="dfn">constructing</a> a
          <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>. Its members are as follows.
        </p>
        <dl data-dfn-for="AddressInit" data-link-for="" data-sort="ascending"><dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-addressline" data-idl="field" data-title="addressLine" data-dfn-for="AddressInit" data-type="sequence"><code>addressLine</code></dfn> member
          </dt>
          <dd>
            An <a href="#dfn-address-line" data-link-type="dfn">address line</a>, represented as a sequence.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-city" data-idl="field" data-title="city" data-dfn-for="AddressInit" data-type="DOMString"><code>city</code></dfn> member
          </dt>
          <dd>
            A <a href="#dfn-city" data-link-type="dfn">city</a>.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-country" data-idl="field" data-title="country" data-dfn-for="AddressInit" data-type="DOMString"><code>country</code></dfn> member
          </dt>
          <dd>
            An <a href="#dfn-country" data-link-type="dfn">country</a>, represented as a [<cite><a href="#bib-iso3166-1" title="ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 1: Country codes" data-link-type="biblio">ISO3166-1</a></cite>] country code.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-dependentlocality" data-idl="field" data-title="dependentLocality" data-dfn-for="AddressInit" data-type="DOMString"><code>dependentLocality</code></dfn> member
          </dt>
          <dd>
            A <a href="#dfn-dependent-locality" data-link-type="dfn">dependent locality</a>.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-organization" data-idl="field" data-title="organization" data-dfn-for="AddressInit" data-type="DOMString"><code>organization</code></dfn> member
          </dt>
          <dd>
            An <a href="#dfn-organization" data-link-type="dfn">organization</a>.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-phone" data-idl="field" data-title="phone" data-dfn-for="AddressInit" data-type="DOMString"><code>phone</code></dfn> member
          </dt>
          <dd>
            A <a href="#dfn-phone-number" data-link-type="dfn">phone number</a>, optionally structured to adhere to
            [<cite><a href="#bib-e.164" title="The international public telecommunication numbering plan" data-link-type="biblio">E.164</a></cite>].
          </dd><dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-postalcode" data-idl="field" data-title="postalCode" data-dfn-for="AddressInit" data-type="DOMString"><code>postalCode</code></dfn> member
          </dt>
          <dd>
            A <a href="#dfn-postal-code" data-link-type="dfn">postal code</a>.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-recipient" data-idl="field" data-title="recipient" data-dfn-for="AddressInit" data-type="DOMString"><code>recipient</code></dfn> member
          </dt>
          <dd>
            A <a href="#dfn-recipient" data-link-type="dfn">recipient</a>. Under certain circumstances, this member may
            contain multiline information. For example, it might contain "care
            of" information.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-region" data-idl="field" data-title="region" data-dfn-for="AddressInit" data-type="DOMString"><code>region</code></dfn> member
          </dt>
          <dd>
            A <a href="#dfn-region" data-link-type="dfn">region</a>.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addressinit-sortingcode" data-idl="field" data-title="sortingCode" data-dfn-for="AddressInit" data-type="DOMString"><code>sortingCode</code></dfn> member
          </dt>
          <dd>
            A <a href="#dfn-sorting-code" data-link-type="dfn">sorting code</a>.
          </dd>
          </dl>
      </section>
      <section data-dfn-for="AddressErrors" data-link-for="AddressErrors" id="addresserrors-dictionary">
        <h3 id="x11-3-addresserrors-dictionary"><bdi>11.3 </bdi>
          <dfn data-dfn-type="dictionary" data-export="" id="dom-addresserrors" data-idl="dictionary" data-title="AddressErrors" data-dfn-for=""><code>AddressErrors</code></dfn> dictionary
        <a aria-label="ยง" href="#addresserrors-dictionary"></a></h3>
        <pre><span data-idl="" id="idl-def-addresserrors" data-title="AddressErrors">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-addresserrors"><code>AddressErrors</code></a> {<span data-idl="" id="idl-def-addresserrors-addressline" data-title="addressLine" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-addressline"><code>addressLine</code></a>;</span><span data-idl="" id="idl-def-addresserrors-city" data-title="city" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-city"><code>city</code></a>;</span><span data-idl="" id="idl-def-addresserrors-country" data-title="country" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-country"><code>country</code></a>;</span><span data-idl="" id="idl-def-addresserrors-dependentlocality" data-title="dependentLocality" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-dependentlocality"><code>dependentLocality</code></a>;</span><span data-idl="" id="idl-def-addresserrors-organization" data-title="organization" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-organization"><code>organization</code></a>;</span><span data-idl="" id="idl-def-addresserrors-phone" data-title="phone" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-phone"><code>phone</code></a>;</span><span data-idl="" id="idl-def-addresserrors-postalcode" data-title="postalCode" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-postalcode"><code>postalCode</code></a>;</span><span data-idl="" id="idl-def-addresserrors-recipient" data-title="recipient" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-recipient"><code>recipient</code></a>;</span><span data-idl="" id="idl-def-addresserrors-region" data-title="region" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-region"><code>region</code></a>;</span><span data-idl="" id="idl-def-addresserrors-sortingcode" data-title="sortingCode" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-sortingcode"><code>sortingCode</code></a>;</span>
};</span></pre>
        <p>
          The members of the <a href="#dom-addresserrors" data-link-type="idl"><code>AddressErrors</code></a> dictionary represent
          validation errors with specific parts of a <a href="#dfn-physical-address" data-link-type="dfn">physical address</a>.
          Each dictionary member has a dual function: firstly, its presence
          denotes that a particular part of an address is suffering from a
          validation error. Secondly, the string value allows the developer to
          describe the validation error (and possibly how the end user can fix
          the error).
        </p>
        <div role="note" id="issue-container-generatedID-19"><p><span>Note</span></p><p>
          Developers need to be aware that users might not have the ability to
          fix certain parts of an address. As such, they need to be mindful not
          to ask the user to fix things they might not have control over.
        </p></div>
        <dl>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-addressline" data-idl="field" data-title="addressLine" data-dfn-for="AddressErrors" data-type="DOMString"><code>addressLine</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dfn-address-line" data-link-type="dfn">address line</a> has a validation error. In the
            user agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-addressline" data-link-type="idl"><code>addressLine</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-city" data-idl="field" data-title="city" data-dfn-for="AddressErrors" data-type="DOMString"><code>city</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dom-addresserrors-city" data-link-type="idl"><code>city</code></a> has a validation error. In the user
            agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-city" data-link-type="idl"><code>city</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-country" data-idl="field" data-title="country" data-dfn-for="AddressErrors" data-type="DOMString"><code>country</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dom-addresserrors-country" data-link-type="idl"><code>country</code></a> has a validation error. In the user
            agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-country" data-link-type="idl"><code>country</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-dependentlocality" data-idl="field" data-title="dependentLocality" data-dfn-for="AddressErrors" data-type="DOMString"><code>dependentLocality</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dfn-dependent-locality" data-link-type="dfn">dependent locality</a> has a validation error.
            In the user agent's UI, this member corresponds to the input field
            that provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-dependentlocality" data-link-type="idl"><code>dependentLocality</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-organization" data-idl="field" data-title="organization" data-dfn-for="AddressErrors" data-type="DOMString"><code>organization</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dom-addresserrors-organization" data-link-type="idl"><code>organization</code></a> has a validation error. In the
            user agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-organization" data-link-type="idl"><code>organization</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-phone" data-idl="field" data-title="phone" data-dfn-for="AddressErrors" data-type="DOMString"><code>phone</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dfn-phone-number" data-link-type="dfn">phone number</a> has a validation error. In the
            user agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-phone" data-link-type="idl"><code>phone</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-postalcode" data-idl="field" data-title="postalCode" data-dfn-for="AddressErrors" data-type="DOMString"><code>postalCode</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dfn-postal-code" data-link-type="dfn">postal code</a> has a validation error. In the
            user agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-postalcode" data-link-type="idl"><code>postalCode</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-recipient" data-idl="field" data-title="recipient" data-dfn-for="AddressErrors" data-type="DOMString"><code>recipient</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dom-addresserrors-recipient" data-link-type="idl"><code>recipient</code></a> has a validation error. In the
            user agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-addressline" data-link-type="idl"><code>addressLine</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-region" data-idl="field" data-title="region" data-dfn-for="AddressErrors" data-type="DOMString"><code>region</code></dfn> member
          </dt>
          <dd>
            Denotes that the <a href="#dom-addresserrors-region" data-link-type="idl"><code>region</code></a> has a validation error. In the user
            agent's UI, this member corresponds to the input field that
            provided the <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-region" data-link-type="idl"><code>region</code></a> attribute's value.
          </dd>
          <dt>
            <dfn data-dfn-type="dict-member" data-export="" id="dom-addresserrors-sortingcode" data-idl="field" data-title="sortingCode" data-dfn-for="AddressErrors" data-type="DOMString"><code>sortingCode</code></dfn> member
          </dt>
          <dd>
            The <a href="#dfn-sorting-code" data-link-type="dfn">sorting code</a> has a validation error. In the user agent's
            UI, this member corresponds to the input field that provided the
            <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s <a data-link-for="PaymentAddress" href="#dom-paymentaddress-sortingcode" data-link-type="idl"><code>sortingCode</code></a> attribute's value.
          </dd>
        </dl>
      </section>
      <section id="creating-a-paymentaddress-from-user-provided-input">
        <h3 id="x11-4-creating-a-paymentaddress-from-user-provided-input"><bdi>11.4 </bdi>
          Creating a <code>PaymentAddress</code> from user-provided input
        <a aria-label="ยง" href="#creating-a-paymentaddress-from-user-provided-input"></a></h3>
        <p>
          The steps to <dfn data-dfn-type="dfn" id="dfn-create-a-paymentaddress-from-user-provided-input">create a <code>PaymentAddress</code> from
          user-provided input</dfn> are given by the following algorithm. The
          algorithm takes a <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a> <var>redactList</var>.
        </p>
        <div role="note" id="issue-container-generatedID-20"><p><span>Note</span><span>: Privacy of recipient information (the redactList)</span></p><div>
          <p>
            The <var>redactList</var> optionally gives user agents the possibility to
            limit the amount of personal information about the recipient that
            the API shares with the merchant.
          </p>
          <p>
            For merchants, the resulting <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a> object provides
            enough information to, for example, calculate shipping costs, but,
            in most cases, not enough information to physically locate and
            uniquely identify the recipient.
          </p>
          <p>
            Unfortunately, even with the <var>redactList</var>, recipient anonymity
            cannot be assured. This is because in some countries postal codes
            are so fine-grained that they can uniquely identify a recipient.
          </p>
        </div></div>
        <ol data-link-for="AddressInit">
          <li>Let <var data-type="AddressInit">details</var> be an <a href="#dom-addressinit" data-link-type="idl"><code>AddressInit</code></a> dictionary
          with no members present.
          </li>
          <li>If "addressLine" is not in <var>redactList</var>, set
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-addressline" data-link-type="idl"><code>addressLine</code></a>"] to the result of splitting the
          user-provided address line into a <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a>. If none was provided,
          set it to the empty <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a>.
            
          </li>
          <li>If "country" is not in <var>redactList</var>, set
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-country" data-link-type="idl"><code>country</code></a>"] to the user-provided country as an upper
          case [<cite><a href="#bib-iso3166-1" title="ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 1: Country codes" data-link-type="biblio">ISO3166-1</a></cite>] alpha-2 code, or to the empty string if none was
          provided.
          </li>
          <li>If "phone" is not in <var>redactList</var>, set <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-phone" data-link-type="idl"><code>phone</code></a>"]
          to the user-provided phone number, or to the empty string if none was
          provided.
            <div role="note" id="issue-container-generatedID-22"><p><span>Note</span><span>: Privacy of phone number</span></p></div>
          </li>
          <li>If "city" is not in <var>redactList</var>, set <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-city" data-link-type="idl"><code>city</code></a>"] to
          the user-provided city, or to the empty string if none was provided.
          </li>
          <li>If "dependentLocality" is not in <var>redactList</var>, set
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-dependentlocality" data-link-type="idl"><code>dependentLocality</code></a>"] to the user-provided dependent
          locality, or to the empty string if none was provided.
          </li>
          <li>If "organization" is not in <var>redactList</var>, set
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-organization" data-link-type="idl"><code>organization</code></a>"] to the user-provided recipient
          organization, or to the empty string if none was provided.
          </li>
          <li>If "postalCode" is not in <var>redactList</var>, set
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-postalcode" data-link-type="idl"><code>postalCode</code></a>"] to the user-provided postal code, or
          to the empty string if none was provided. Optionally, redact part of
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-postalcode" data-link-type="idl"><code>postalCode</code></a>"].
            <div role="note" id="issue-container-generatedID-23"><p><span>Note</span><span>: Privacy of Postal Codes</span></p><p>
                <a href="#dfn-postal-code" data-link-type="dfn">Postal codes</a> in certain countries can be so specific as
                to uniquely identify an individual. This being a privacy
                concern, some user agents only return the part of a postal code
                that they deem sufficient for a merchant to calculate shipping
                costs. This varies across countries and regions, and so the
                choice to redact part, or all, of the postal code is left to
                the discretion of implementers in the interest of protecting
                users' privacy.
              </p></div>
          </li>
          <li>If "recipient" is not in <var>redactList</var>, set
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-recipient" data-link-type="idl"><code>recipient</code></a>"] to the user-provided recipient of the
          transaction, or to the empty string if none was provided.
          </li>
          <li>
            <p>
              If "region" is not in <var>redactList</var>:
            </p>
            <div role="note" id="issue-container-generatedID-24"><p><span>Note</span><span>: Countries where regions are not commonly used</span></p><p data-link-for="">
              In some countries (e.g., Belgium) it is uncommon for users to
              include a <a href="#dfn-region" data-link-type="dfn">region</a> as part of a <a href="#dfn-physical-address" data-link-type="dfn">physical address</a>
              (even if all the regions of a country are part of [<cite><a href="#bib-iso3166-2" title="ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 2: Country subdivision code." data-link-type="biblio">ISO3166-2</a></cite>]).
              As such, when the user agent knows that the user is inputting the
              address for a particular country, it might not provide a field
              for the user to input a <a href="#dfn-region" data-link-type="dfn">region</a>. In such cases, the user
              agent returns an empty string for both <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>'s
              <a data-link-for="PaymentAddress" href="#dom-paymentaddress-region" data-link-type="idl"><code>region</code></a> attribute - but the
              address can still serve its intended purpose (e.g., be valid for
              shipping or billing purposes).
            </p></div>
            <ol>
              <li>Set <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-region" data-link-type="idl"><code>region</code></a>"] to the user-provided region,
              or to the empty string if none was provided.
              </li>
            </ol>
          </li>
          <li>If "sortingCode" is not in <var>redactList</var>, set
          <var data-type="AddressInit">details</var>["<a href="#dom-addressinit-sortingcode" data-link-type="idl"><code>sortingCode</code></a>"] to the user-provided sorting code, or
          to the empty string if none was provided.
          </li>
          <li>
            <a data-lt="PaymentAddress.PaymentAddress()" href="#dfn-paymentaddress-paymentaddress" data-link-type="dfn">Internally construct a
            new <code>PaymentAddress</code></a> with <var data-type="AddressInit">details</var> and return the
            result.
          </li>
        </ol>
      </section>
    </section>
    <section data-dfn-for="PaymentShippingOption" id="paymentshippingoption-dictionary">
      <h2 id="x12-paymentshippingoption-dictionary"><bdi>12. </bdi>
        <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentshippingoption" data-idl="dictionary" data-title="PaymentShippingOption" data-dfn-for=""><code>PaymentShippingOption</code></dfn> dictionary
      <a aria-label="ยง" href="#paymentshippingoption-dictionary"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentshippingoption" data-title="PaymentShippingOption">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentshippingoption"><code>PaymentShippingOption</code></a> {<span data-idl="" id="idl-def-paymentshippingoption-id" data-title="id" data-dfn-for="PaymentShippingOption">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-id"><code>id</code></a>;</span><span data-idl="" id="idl-def-paymentshippingoption-label" data-title="label" data-dfn-for="PaymentShippingOption">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-label"><code>label</code></a>;</span><span data-idl="" id="idl-def-paymentshippingoption-amount" data-title="amount" data-dfn-for="PaymentShippingOption">
  required<span> <a data-xref-type="_IDL_" href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-amount"><code>amount</code></a>;</span><span data-idl="" id="idl-def-paymentshippingoption-selected" data-title="selected" data-dfn-for="PaymentShippingOption"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-selected"><code>selected</code></a> = false;</span>
};</span></pre>
      <p>
        The <a href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a> dictionary has members describing a
        shipping option. Developers can provide the user with one or more
        shipping options by calling the <a data-lt="PaymentRequestUpdateEvent.updateWith" href="#dom-paymentrequestupdateevent-updatewith" data-link-type="idl"><code>updateWith()</code></a> method in
        response to a change event.
      </p>
      <dl>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentshippingoption-id" data-idl="field" data-title="id" data-dfn-for="PaymentShippingOption" data-type="DOMString"><code>id</code></dfn> member
        </dt>
        <dd>
          A string identifier used to reference this
          <a href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a>. It <em title="MUST">MUST</em> be unique for a given
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentshippingoption-label" data-idl="field" data-title="label" data-dfn-for="PaymentShippingOption" data-type="DOMString"><code>label</code></dfn> member
        </dt>
        <dd>
          A human-readable string description of the item. The <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> <em title="SHOULD">SHOULD</em> use this string to display the shipping option to
          the user.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentshippingoption-amount" data-idl="field" data-title="amount" data-dfn-for="PaymentShippingOption" data-type="PaymentCurrencyAmount"><code>amount</code></dfn> member
        </dt>
        <dd>
          A <a href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a> containing the monetary amount for the
          item.
        </dd>
        <dt>
          <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentshippingoption-selected" data-idl="field" data-title="selected" data-dfn-for="PaymentShippingOption" data-type="boolean"><code>selected</code></dfn> member
        </dt>
        <dd>
          A boolean. When true, it indicates that this is the default selected
          <a href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a> in a sequence. <a href="#dfn-user-agent" data-link-type="dfn">User agents</a> <em title="SHOULD">SHOULD</em>
          display this option by default in the user interface.
        </dd>
      </dl>
    </section>
    <section data-dfn-for="PaymentComplete" data-link-for="PaymentComplete" id="paymentcomplete-enum">
      <h2 id="x13-paymentcomplete-enum"><bdi>13. </bdi>
        <dfn data-dfn-type="enum" data-export="" id="dom-paymentcomplete" data-idl="enum" data-title="PaymentComplete" data-dfn-for=""><code>PaymentComplete</code></dfn> enum
      <a aria-label="ยง" href="#paymentcomplete-enum"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentcomplete" data-title="PaymentComplete">enum <a data-link-for="" data-link-type="enum" href="#dom-paymentcomplete"><code>PaymentComplete</code></a> {
  <span>"<a data-link-for="PaymentComplete" data-link-type="enum-value" href="#dom-paymentcomplete-fail"><code>fail</code></a>"</span>,
  <span>"<a data-link-for="PaymentComplete" data-link-type="enum-value" href="#dom-paymentcomplete-success"><code>success</code></a>"</span>,
  <span>"<a data-link-for="PaymentComplete" data-link-type="enum-value" href="#dom-paymentcomplete-unknown"><code>unknown</code></a>"</span>
};</span></pre>
      <dl>
        <dt>
          "<dfn data-dfn-type="enum-value" data-export="" id="dom-paymentcomplete-fail" data-idl="enum-value" data-title="fail" data-dfn-for="PaymentComplete"><code>fail</code></dfn>"
        </dt>
        <dd>
          Indicates that processing of the payment failed. The <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> <em title="MAY">MAY</em> display UI indicating failure.
        </dd>
        <dt>
          "<dfn data-dfn-type="enum-value" data-export="" id="dom-paymentcomplete-success" data-idl="enum-value" data-title="success" data-dfn-for="PaymentComplete"><code>success</code></dfn>"
        </dt>
        <dd>
          Indicates the payment was successfully processed. The <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> <em title="MAY">MAY</em> display UI indicating success.
        </dd>
        <dt>
          "<dfn data-dfn-type="enum-value" data-export="" id="dom-paymentcomplete-unknown" data-idl="enum-value" data-title="unknown" data-dfn-for="PaymentComplete"><code>unknown</code></dfn>"
        </dt>
        <dd>
          The developer did not indicate success or failure and the <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> <em title="SHOULD NOT">SHOULD NOT</em> display UI indicating success or failure.
        </dd>
      </dl>
    </section>
    <section data-dfn-for="PaymentResponse" data-link-for="PaymentResponse" id="paymentresponse-interface">
      <h2 id="x14-paymentresponse-interface"><bdi>14. </bdi>
        <dfn data-dfn-type="interface" data-export="" id="dom-paymentresponse" data-idl="interface" data-title="PaymentResponse" data-dfn-for=""><code>PaymentResponse</code></dfn> interface
      <a aria-label="ยง" href="#paymentresponse-interface"></a></h2>
      <pre><span data-idl="" id="idl-def-paymentresponse" data-title="PaymentResponse">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentresponse"><code>PaymentResponse</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span>  {<span data-idl="" id="idl-def-paymentresponse-tojson" data-title="toJSON" data-dfn-for="PaymentResponse">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Default">Default</a></span>]<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentResponse" data-link-type="method" href="#dom-paymentresponse-tojson"><code>toJSON</code></a>();</span><span data-idl="" id="idl-def-paymentresponse-requestid" data-title="requestId" data-dfn-for="PaymentResponse">

  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-requestid"><code>requestId</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-methodname" data-title="methodName" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-methodname"><code>methodName</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-details" data-title="details" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-details"><code>details</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-shippingaddress" data-title="shippingAddress" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-shippingaddress"><code>shippingAddress</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-shippingoption" data-title="shippingOption" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-shippingoption"><code>shippingOption</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-payername" data-title="payerName" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-payername"><code>payerName</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-payeremail" data-title="payerEmail" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-payeremail"><code>payerEmail</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-payerphone" data-title="payerPhone" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-payerphone"><code>payerPhone</code></a>;</span><span data-idl="" id="idl-def-paymentresponse-complete-result" data-title="complete" data-dfn-for="PaymentResponse">

  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a data-link-for="PaymentResponse" data-link-type="method" href="#dom-paymentresponse-complete"><code>complete</code></a>(optional<span> <a data-xref-type="_IDL_" href="#dom-paymentcomplete" data-link-type="idl"><code>PaymentComplete</code></a></span> <span>result</span> = "unknown");</span><span data-idl="" id="idl-def-paymentresponse-retry-errorfields" data-title="retry" data-dfn-for="PaymentResponse">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a data-link-for="PaymentResponse" data-link-type="method" href="#dom-paymentresponse-retry"><code>retry</code></a>(optional<span> <a data-xref-type="_IDL_" href="#dom-paymentvalidationerrors" data-link-type="idl"><code>PaymentValidationErrors</code></a></span> <span>errorFields</span> = {});</span><span data-idl="" id="idl-def-paymentresponse-onpayerdetailchange" data-title="onpayerdetailchange" data-dfn-for="PaymentResponse">

  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-onpayerdetailchange"><code>onpayerdetailchange</code></a>;</span>
};</span></pre>
      <div role="note" id="issue-container-generatedID-25"><p><span>Note</span></p><p>
        A <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a> is returned when a user has selected a payment
        method and approved a payment request.
      </p></div>
      <section id="retry-method">
        <h3 id="x14-1-retry-method"><bdi>14.1 </bdi>
          <dfn data-dfn-type="method" data-export="" id="dom-paymentresponse-retry" data-idl="operation" data-title="retry()" data-dfn-for="PaymentResponse" data-type="Promise" data-lt="PaymentResponse.retry()|PaymentResponse.retry|retry()|retry"><code>retry()</code></dfn> method
        <a aria-label="ยง" href="#retry-method"></a></h3>
        <p data-tests="payment-response/retry-method-manual.https.html">
          The <code>retry(<var>errorFields</var>)</code> method <em title="MUST">MUST</em> act as follows:
        </p>
        <ol>
          <li>Let <var>response</var> be the <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>.
          </li>
          <li>Let <var>request</var> be <var>response</var>.<a href="#dfn-request" data-link-type="dfn">[[request]]</a>.
          </li>
          <li>Let <var data-type="Document">document</var> be <var>request</var>'s <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">relevant global
          object</a>'s <a data-cite-path="window-object.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window">associated Document</a>.
          </li>
          <li data-tests="payment-response/rejects_if_not_active-manual.https.html">If
          <var data-type="Document">document</var> is not <a data-link-for="Document" data-xref-for="Document" data-cite-path="browsers.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active">fully active</a>, then return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise
          rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>If <var>response</var>.<a href="#dfn-complete" data-link-type="dfn">[[complete]]</a> is true, return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise
          rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>If <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> is not null, return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a
          promise rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>"
          <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>".
          </li>
          <li>Let <var>retryPromise</var> be <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise">a new promise</a>.
          </li>
          <li>Set <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> to <var>retryPromise</var>.
          </li>
          <li>If <var>errorFields</var> was passed:
            <ol>
              <li>Optionally, show a warning in the developer console if any of
              the following are true:
                <ol>
                  <li><var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>["<a data-link-for="PaymentOptions" href="#dom-paymentoptions-requestpayername" data-link-type="idl"><code>requestPayerName</code></a>"] is false, and
                  <var>errorFields</var>["<a data-link-for="PaymentValidationErrors" href="#dom-paymentvalidationerrors-payer" data-link-type="idl"><code>payer</code></a>"]["<a data-link-for="PayerErrors" href="#dom-payererrors-name" data-link-type="idl"><code>name</code></a>"] is present.
                  </li>
                  <li><var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>["<a data-link-for="PaymentOptions" href="#dom-paymentoptions-requestpayeremail" data-link-type="idl"><code>requestPayerEmail</code></a>"] is false, and
                  <var>errorFields</var>["<a data-link-for="PaymentValidationErrors" href="#dom-paymentvalidationerrors-payer" data-link-type="idl"><code>payer</code></a>"]["<a data-link-for="PayerErrors" href="#dom-payererrors-email" data-link-type="idl"><code>email</code></a>"] is present.
                  </li>
                  <li><var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>["<a data-link-for="PaymentOptions" href="#dom-paymentoptions-requestpayerphone" data-link-type="idl"><code>requestPayerPhone</code></a>"] is false, and
                  <var>errorFields</var>["<a data-link-for="PaymentValidationErrors" href="#dom-paymentvalidationerrors-payer" data-link-type="idl"><code>payer</code></a>"]["<a data-link-for="PayerErrors" href="#dom-payererrors-phone" data-link-type="idl"><code>phone</code></a>"] is present.
                  </li>
                  <li><var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>["<a data-link-for="PaymentOptions" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a>"] is false, and
                  <var>errorFields</var>["<a data-link-for="PaymentValidationErrors" href="#dom-paymentvalidationerrors-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a>"] is present.
                  </li>
                </ol>
              </li>
              <li data-link-for="PaymentValidationErrors" data-tests="PaymentValidationErrors/retry-shows-error-member-manual.https.html">
              If <var>errorFields</var>["<a href="#dom-paymentvalidationerrors-paymentmethod" data-link-type="idl"><code>paymentMethod</code></a>] member was passed, and if
              required by the specification that defines <var>response</var>'s
              <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>, then <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">convert</a> <var>errorFields</var>'s
              <a href="#dom-paymentvalidationerrors-paymentmethod" data-link-type="idl"><code>paymentMethod</code></a> member to an IDL value of the type specified
              there. Otherwise, <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">convert</a> to <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object"><code>object</code></a>.
              </li>
              <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
              <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
              </li>
              <li>If conversion results in a <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-exception">exception</a> <var>error</var>:
                <ol>
                  <li>Reject <var>retryPromise</var> with <var>error</var>.
                  </li>
                  <li>Set <a href="#dfn-user-agent" data-link-type="dfn">user agent</a>'s <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a>
                  boolean to false.
                  </li>
                  <li>Return.
                  </li>
                </ol>
              </li>
              <li data-link-for="PaymentValidationErrors">By matching the
              members of <var>errorFields</var> to input fields in the user agent's UI,
              indicate to the end user that something is wrong with the data of
              the payment response. For example, a user agent might draw the
              user's attention to the erroneous <var>errorFields</var> in the browser's
              UI and display the value of each field in a manner that helps the
              user fix each error. Similarly, if the <a href="#dom-paymentvalidationerrors-error" data-link-type="idl"><code>error</code></a> member is
              passed, present the error in the user agent's UI. In the case
              where the value of a member is the empty string, the user agent
              <em title="MAY">MAY</em> substitute a value with a suitable error message.
              </li>
            </ol>
          </li>
          <li>Otherwise, if <var>errorFields</var> was not passed, signal to the end
          user to attempt to retry the payment. Re-enable any UI element that
          affords the end user the ability to retry accepting the payment
          request.
          </li>
          <li>
            <span data-tests="payment-response/rejects_if_not_active-manual.https.html">If
            <var data-type="Document">document</var> stops being <a data-link-for="Document" data-xref-for="Document" data-cite-path="browsers.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active">fully active</a> while the user
            interface is being shown, or no longer is by the time this step is
            reached, then:</span>
            <ol>
              <li>Close down the user interface.
              </li>
              <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
              <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
              </li>
            </ol>
          </li>
          <li>Finally, when <var>retryPromise</var> settles, set
          <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> to null.
          </li>
          <li>Return <var>retryPromise</var>.
            
          </li>
        </ol>
        <section data-dfn-for="PaymentValidationErrors" data-link-for="PaymentValidationErrors" id="paymentvalidationerrors-dictionary">
          <h4 id="x14-1-1-paymentvalidationerrors-dictionary"><bdi>14.1.1 </bdi>
            <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentvalidationerrors" data-idl="dictionary" data-title="PaymentValidationErrors" data-dfn-for=""><code>PaymentValidationErrors</code></dfn> dictionary
          <a aria-label="ยง" href="#paymentvalidationerrors-dictionary"></a></h4>
          <pre><span data-idl="" id="idl-def-paymentvalidationerrors" data-title="PaymentValidationErrors">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentvalidationerrors"><code>PaymentValidationErrors</code></a> {<span data-idl="" id="idl-def-paymentvalidationerrors-payer" data-title="payer" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="_IDL_" href="#dom-payererrors" data-link-type="idl"><code>PayerErrors</code></a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-payer"><code>payer</code></a>;</span><span data-idl="" id="idl-def-paymentvalidationerrors-shippingaddress" data-title="shippingAddress" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="_IDL_" href="#dom-addresserrors" data-link-type="idl"><code>AddressErrors</code></a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-shippingaddress"><code>shippingAddress</code></a>;</span><span data-idl="" id="idl-def-paymentvalidationerrors-error" data-title="error" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-error"><code>error</code></a>;</span><span data-idl="" id="idl-def-paymentvalidationerrors-paymentmethod" data-title="paymentMethod" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-paymentmethod"><code>paymentMethod</code></a>;</span>
};</span></pre>
          <dl>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentvalidationerrors-payer" data-idl="field" data-title="payer" data-dfn-for="PaymentValidationErrors" data-type="PayerErrors"><code>payer</code></dfn> member
            </dt>
            <dd>
              Validation errors related to the <a href="#dfn-payer-details" data-link-type="dfn">payer details</a>.
            </dd>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentvalidationerrors-shippingaddress" data-idl="field" data-title="shippingAddress" data-dfn-for="PaymentValidationErrors" data-type="AddressErrors"><code>shippingAddress</code></dfn> member
            </dt>
            <dd data-link-for="PaymentResponse">
              Represents validation errors with the <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>'s
              <a href="#dom-paymentresponse-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a>.
            </dd>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentvalidationerrors-error" data-idl="field" data-title="error" data-dfn-for="PaymentValidationErrors" data-type="DOMString"><code>error</code></dfn> member
            </dt>
            <dd>
              A general description of an error with the payment from which the
              user can attempt to recover. For example, the user may recover by
              retrying the payment. A developer can optionally pass the
              <a href="#dom-paymentvalidationerrors-error" data-link-type="idl"><code>error</code></a> member on its own to give a general overview of
              validation issues, or it can be passed in combination with other
              members of the <a href="#dom-paymentvalidationerrors" data-link-type="idl"><code>PaymentValidationErrors</code></a> dictionary.
            </dd>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentvalidationerrors-paymentmethod" data-idl="field" data-title="paymentMethod" data-dfn-for="PaymentValidationErrors" data-type="object"><code>paymentMethod</code></dfn> member
            </dt>
            <dd>
              A payment method specific errors. See, for example,
              [<cite><a href="#bib-payment-method-basic-card" title="Basic Card Payment" data-link-type="biblio">payment-method-basic-card</a></cite>]'s <a href="https://www.w3.org/TR/payment-method-basic-card/#basiccarderrors-dictionary"><code>BasicCardErrors</code></a>.
            </dd>
          </dl>
        </section>
        <section data-dfn-for="PayerErrors" data-link-for="PayerErrors" id="payererrors-dictionary">
          <h4 id="x14-1-2-payererrors-dictionary"><bdi>14.1.2 </bdi>
            <dfn data-dfn-type="dictionary" data-export="" id="dom-payererrors" data-idl="dictionary" data-title="PayerErrors" data-dfn-for=""><code>PayerErrors</code></dfn> dictionary
          <a aria-label="ยง" href="#payererrors-dictionary"></a></h4>
          <pre><span data-idl="" id="idl-def-payererrors" data-title="PayerErrors">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-payererrors"><code>PayerErrors</code></a> {<span data-idl="" id="idl-def-payererrors-email" data-title="email" data-dfn-for="PayerErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PayerErrors" data-link-type="dict-member" href="#dom-payererrors-email"><code>email</code></a>;</span><span data-idl="" id="idl-def-payererrors-name" data-title="name" data-dfn-for="PayerErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PayerErrors" data-link-type="dict-member" href="#dom-payererrors-name"><code>name</code></a>;</span><span data-idl="" id="idl-def-payererrors-phone" data-title="phone" data-dfn-for="PayerErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PayerErrors" data-link-type="dict-member" href="#dom-payererrors-phone"><code>phone</code></a>;</span>
};</span></pre>
          <p>
            The <a href="#dom-payererrors" data-link-type="idl"><code>PayerErrors</code></a> is used to represent validation errors with
            one or more <a href="#dfn-payer-details" data-link-type="dfn">payer details</a>.
          </p>
          <p>
            <dfn data-dfn-type="dfn" id="dfn-payer-details">Payer details</dfn> are any of the payer's name, payer's phone
            number, and payer's email.
          </p>
          <dl data-link-for="PaymentResponse">
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-payererrors-email" data-idl="field" data-title="email" data-dfn-for="PayerErrors" data-type="DOMString"><code>email</code></dfn> member
            </dt>
            <dd>
              Denotes that the payer's email suffers from a validation error.
              In the user agent's UI, this member corresponds to the input
              field that provided the <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>'s
              <a href="#dom-paymentresponse-payeremail" data-link-type="idl"><code>payerEmail</code></a> attribute's value.
            </dd>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-payererrors-name" data-idl="field" data-title="name" data-dfn-for="PayerErrors" data-type="DOMString"><code>name</code></dfn> member
            </dt>
            <dd>
              Denotes that the payer's name suffers from a validation error. In
              the user agent's UI, this member corresponds to the input field
              that provided the <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>'s <a href="#dom-paymentresponse-payername" data-link-type="idl"><code>payerName</code></a>
              attribute's value.
            </dd>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-payererrors-phone" data-idl="field" data-title="phone" data-dfn-for="PayerErrors" data-type="DOMString"><code>phone</code></dfn> member
            </dt>
            <dd>
              Denotes that the payer's phone number suffers from a validation
              error. In the user agent's UI, this member corresponds to the
              input field that provided the <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>'s
              <a href="#dom-paymentresponse-payerphone" data-link-type="idl"><code>payerPhone</code></a> attribute's value.
            </dd>
          </dl>
          
        </section>
      </section>
      <section id="tojson-method-0">
        <h3 id="x14-2-tojson-method"><bdi>14.2 </bdi>
          <dfn data-dfn-type="method" data-export="" id="dom-paymentresponse-tojson" data-idl="operation" data-title="toJSON()" data-dfn-for="PaymentResponse" data-type="object" data-lt="PaymentResponse.toJSON()|PaymentResponse.toJSON|toJSON()|toJSON"><code>toJSON()</code></dfn> method
        <a aria-label="ยง" href="#tojson-method-0"></a></h3>
        <p>
          When called, runs [<cite><a href="#bib-webidl" title="Web IDL" data-link-type="biblio">WEBIDL</a></cite>]'s <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#default-tojson-operation">default toJSON operation</a>.
        </p>
      </section>
      <section id="methodname-attribute">
        <h3 id="x14-3-methodname-attribute"><bdi>14.3 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-methodname" data-idl="attribute" data-title="methodName" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.methodName|methodName"><code>methodName</code></dfn> attribute
        <a aria-label="ยง" href="#methodname-attribute"></a></h3>
        <p data-tests="payment-response/methodName-attribute-manual.https.html">
          The <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a> for the <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>
          that the user selected to fulfill the transaction.
        </p>
      </section>
      <section id="details-attribute">
        <h3 id="x14-4-details-attribute"><bdi>14.4 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-details" data-idl="attribute" data-title="details" data-dfn-for="PaymentResponse" data-type="object" data-lt="PaymentResponse.details|details"><code>details</code></dfn> attribute
        <a aria-label="ยง" href="#details-attribute"></a></h3>
        <p>
          An <a href="https://heycam.github.io/webidl/#idl-object">object</a> or <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-dictionary">dictionary</a>
          generated by a <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> that a merchant can use to
          process or validate a transaction (depending on the <a href="#dfn-payment-method" data-link-type="dfn">payment
          method</a>).
        </p>
        
      </section>
      <section id="shippingaddress-attribute-0">
        <h3 id="x14-5-shippingaddress-attribute"><bdi>14.5 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-shippingaddress" data-idl="attribute" data-title="shippingAddress" data-dfn-for="PaymentResponse" data-type="PaymentAddress" data-lt="PaymentResponse.shippingAddress|shippingAddress"><code>shippingAddress</code></dfn> attribute
        <a aria-label="ยง" href="#shippingaddress-attribute-0"></a></h3>
        <p data-tests="payment-response/shippingAddress-attribute-manual.https.html">
          If the <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> member was set
          to true in the <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> passed to the
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> constructor, then <a data-lt="PaymentRequest.shippingAddress" href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a> will be the full
          and final shipping address chosen by the user.
        </p>
      </section>
      <section id="shippingoption-attribute-0">
        <h3 id="x14-6-shippingoption-attribute"><bdi>14.6 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-shippingoption" data-idl="attribute" data-title="shippingOption" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.shippingOption|shippingOption"><code>shippingOption</code></dfn> attribute
        <a aria-label="ยง" href="#shippingoption-attribute-0"></a></h3>
        <p data-tests="payment-response/shippingOption-attribute-manual.https.html">
          If the <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> member was set
          to true in the <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> passed to the
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> constructor, then <a data-lt="PaymentRequest.shippingOption" href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a> will be the
          <a data-lt="PaymentShippingOption.id" href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a> attribute of the
          selected shipping option.
        </p>
      </section>
      <section id="payername-attribute">
        <h3 id="x14-7-payername-attribute"><bdi>14.7 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-payername" data-idl="attribute" data-title="payerName" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.payerName|payerName"><code>payerName</code></dfn> attribute
        <a aria-label="ยง" href="#payername-attribute"></a></h3>
        <p data-tests="payment-response/payerName-attribute-manual.https.html">
          If the <a data-lt="PaymentOptions.requestPayerName" href="#dom-paymentoptions-requestpayername" data-link-type="idl"><code>requestPayerName</code></a> member was set
          to true in the <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> passed to the
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> constructor, then <a data-lt="PaymentResponse.payerName" href="#dom-paymentresponse-payername" data-link-type="idl"><code>payerName</code></a> will be the name provided
          by the user.
        </p>
      </section>
      <section id="payeremail-attribute">
        <h3 id="x14-8-payeremail-attribute"><bdi>14.8 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-payeremail" data-idl="attribute" data-title="payerEmail" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.payerEmail|payerEmail"><code>payerEmail</code></dfn> attribute
        <a aria-label="ยง" href="#payeremail-attribute"></a></h3>
        <p data-tests="payment-response/payerEmail-attribute-manual.https.html">
          If the <a data-lt="PaymentOptions.requestPayerEmail" href="#dom-paymentoptions-requestpayeremail" data-link-type="idl"><code>requestPayerEmail</code></a> member was
          set to true in the <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> passed to the
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> constructor, then <a data-lt="PaymentResponse.payerEmail" href="#dom-paymentresponse-payeremail" data-link-type="idl"><code>payerEmail</code></a> will be the email address
          chosen by the user.
        </p>
      </section>
      <section id="payerphone-attribute">
        <h3 id="x14-9-payerphone-attribute"><bdi>14.9 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-payerphone" data-idl="attribute" data-title="payerPhone" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.payerPhone|payerPhone"><code>payerPhone</code></dfn> attribute
        <a aria-label="ยง" href="#payerphone-attribute"></a></h3>
        <p data-tests="payment-response/payerPhone-attribute-manual.https.html">
          If the <a data-lt="PaymentOptions.requestPayerPhone" href="#dom-paymentoptions-requestpayerphone" data-link-type="idl"><code>requestPayerPhone</code></a> member was
          set to true in the <a href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a> passed to the
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> constructor, then <a data-lt="PaymentResponse.payerPhone" href="#dom-paymentresponse-payerphone" data-link-type="idl"><code>payerPhone</code></a> will be the phone number
          chosen by the user.
        </p>
      </section>
      <section id="requestid-attribute">
        <h3 id="x14-10-requestid-attribute"><bdi>14.10 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-requestid" data-idl="attribute" data-title="requestId" data-dfn-for="PaymentResponse" data-type="DOMString" data-lt="PaymentResponse.requestId|requestId"><code>requestId</code></dfn> attribute
        <a aria-label="ยง" href="#requestid-attribute"></a></h3>
        <p data-tests="payment-response/requestId-attribute-manual.https.html">
          The corresponding payment request <a data-lt="PaymentRequest.id" href="#dom-paymentrequest-id" data-link-type="idl"><code>id</code></a> that spawned this payment response.
        </p>
      </section>
      <section data-dfn-for="PaymentResponse" data-link-for="PaymentResponse" id="complete-method">
        <h3 id="x14-11-complete-method"><bdi>14.11 </bdi>
          <dfn data-lt="complete(result)|complete()|PaymentResponse.complete()|PaymentResponse.complete|complete" data-dfn-type="method" data-export="" id="dom-paymentresponse-complete" data-idl="operation" data-title="complete()" data-dfn-for="PaymentResponse" data-type="Promise"><code>complete()</code></dfn> method
        <a aria-label="ยง" href="#complete-method"></a></h3>
        <div role="note" id="issue-container-generatedID-28"><p><span>Note</span></p><p>
          The <a href="#dom-paymentresponse-complete" data-link-type="idl"><code>complete()</code></a> method is called after the user has accepted
          the payment request and the <a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a> has been
          resolved. Calling the <a href="#dom-paymentresponse-complete" data-link-type="idl"><code>complete()</code></a> method tells the <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> that the payment interaction is over (and <em title="SHOULD">SHOULD</em> cause any
          remaining user interface to be closed).
        </p></div>
        <p>
          After the payment request has been accepted and the
          <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a> returned to the caller, but before the caller
          calls <a href="#dom-paymentresponse-complete" data-link-type="idl"><code>complete()</code></a>, the payment request user interface remains
          in a pending state. At this point the user interface <em title="SHOULD NOT">SHOULD NOT</em> offer
          a cancel command because acceptance of the payment request has been
          returned. However, if something goes wrong and the developer never
          calls <a href="#dom-paymentresponse-complete" data-link-type="idl"><code>complete()</code></a> then the user interface is blocked.
        </p>
        <p>
          For this reason, implementations <em title="MAY">MAY</em> impose a timeout for developers
          to call <a href="#dom-paymentresponse-complete" data-link-type="idl"><code>complete()</code></a>. If the timeout expires then the
          implementation will behave as if <a href="#dom-paymentresponse-complete" data-link-type="idl"><code>complete()</code></a> was called with no
          arguments.
        </p>
        <p data-tests="payment-response/complete-method-manual.https.html">
          The <a href="#dom-paymentresponse-complete" data-link-type="idl"><code><code>complete(<var>result</var>)</code></code></a> method <em title="MUST">MUST</em> act as
          follows:
        </p>
        <ol>
          <li>Let <var>response</var> be the <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>.
          </li>
          <li>If <var>response</var>.<a href="#dfn-complete" data-link-type="dfn">[[complete]]</a> is true, return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise
          rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li data-tests="payment-response/retry-method-manual.https.html">If
          <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> is not null, return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise
          rejected with</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>Let <var>promise</var> be <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise">a new promise</a>.
          </li>
          <li>Set <var>response</var>.<a href="#dfn-complete" data-link-type="dfn">[[complete]]</a> to true.
          </li>
          <li>Return <var>promise</var> and perform the remaining steps <a data-cite-path="infrastructure.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in
          parallel</a>.
          </li>
          <li>If <var>document</var> stops being <a data-link-for="Document" data-xref-for="Document" data-cite-path="browsers.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#fully-active">fully active</a> while the
          user interface is being shown, or no longer is by the time this step
          is reached, then:
            <ol>
              <li>Close down the user interface.
              </li>
              <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
              <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
              </li>
            </ol>
          </li>
          <li>Otherwise:
            <ol>
              <li>Close down any remaining user interface. The <a href="#dfn-user-agent" data-link-type="dfn">user
              agent</a> <em title="MAY">MAY</em> use the value <var>result</var> to influence the user
              experience.
              </li>
              <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
              <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
              </li>
              <li>Resolve <var>promise</var> with undefined.
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section data-dfn-for="PaymentResponse" data-link-for="PaymentResponse" id="onpayerdetailchange-attribute">
        <h3 id="x14-12-onpayerdetailchange-attribute"><bdi>14.12 </bdi>
          <dfn data-dfn-type="attribute" data-export="" id="dom-paymentresponse-onpayerdetailchange" data-idl="attribute" data-title="onpayerdetailchange" data-dfn-for="PaymentResponse" data-type="EventHandler" data-lt="PaymentResponse.onpayerdetailchange|onpayerdetailchange"><code>onpayerdetailchange</code></dfn> attribute
        <a aria-label="ยง" href="#onpayerdetailchange-attribute"></a></h3>
        <p>
          Allows a developer to handle "<a href="#dfn-payerdetailchange" data-link-type="dfn"><code>payerdetailchange</code></a>" events.
        </p>
      </section>
      <section id="internal-slots-1">
        <h3 id="x14-13-internal-slots"><bdi>14.13 </bdi>
          Internal Slots
        <a aria-label="ยง" href="#internal-slots-1"></a></h3>
        <p>
          Instances of <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a> are created with the internal
          slots in the following table:
        </p>
        <table>
          <tbody><tr>
            <th>
              Internal Slot
            </th>
            <th>
              Description (<em>non-normative</em>)
            </th>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-complete">[[complete]]</dfn>
            </td>
            <td data-link-for="PaymentResponse">
              Is true if the request for payment has completed (i.e.,
              <a href="#dom-paymentresponse-complete" data-link-type="idl"><code>complete()</code></a> was called, or there was a fatal error that
              made the response not longer usable), or false otherwise.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-request">[[request]]</dfn>
            </td>
            <td>
              The <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> instance that instantiated this
              <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>.
            </td>
          </tr>
          <tr>
            <td>
              <dfn data-dfn-type="dfn" id="dfn-retrypromise">[[retryPromise]]</dfn>
            </td>
            <td>
              Null, or a <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> that resolves when a <a href="#dfn-user-accepts-the-payment-request" data-link-type="dfn">user accepts the
              payment request</a> or rejects if the <a href="#dfn-user-aborts-the-payment-request" data-link-type="dfn">user aborts the payment
              request</a>.
            </td>
          </tr>
        </tbody></table>
      </section>
    </section>
    <section id="paymentrequest-and-iframe-elements">
      <h2 id="x15-paymentrequest-and-iframe-elements"><bdi>15. </bdi>
        <code>PaymentRequest</code> and <code>iframe</code> elements
      <a aria-label="ยง" href="#paymentrequest-and-iframe-elements"></a></h2><p><em>This section is non-normative.</em></p>
      <p>
        To indicate that a cross-origin <a data-cite-path="iframe-embed-object.html" data-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a> is allowed to invoke the
        payment request API, the <a data-xref-type="_IDL_" data-cite-path="iframe-embed-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement"><code>HTMLIFrameElement</code></a>.<a data-xref-type="attribute|dict-member" data-link-for="HTMLIFrameElement" data-xref-for="HTMLIFrameElement" data-cite-path="iframe-embed-object.html" data-type="attribute" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-iframe-allowpaymentrequest"><code>allowPaymentRequest</code></a>
        attribute can be specified on the <a data-cite-path="iframe-embed-object.html" data-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a> element. See <a href="#feature-policy">ยง&nbsp;<bdi>16. </bdi>
        Feature Policy integration
      </a> for details of how <a data-xref-type="_IDL_" data-cite-path="iframe-embed-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement"><code>HTMLIFrameElement</code></a>.<a data-xref-type="attribute|dict-member" data-link-for="HTMLIFrameElement" data-xref-for="HTMLIFrameElement" data-cite-path="iframe-embed-object.html" data-type="attribute" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-iframe-allowpaymentrequest"><code>allowPaymentRequest</code></a> and <cite><a href="https://www.w3.org/TR/feature-policy-1/">Feature Policy</a></cite>
        interact.
      </p>
    </section>
    <section id="feature-policy" data-cite="feature-policy">
      <h2 id="x16-feature-policy-integration"><bdi>16. </bdi>
        Feature Policy integration
      <a aria-label="ยง" href="#feature-policy"></a></h2>
      <p>
        This specification defines a policy-controlled feature identified by
        the string "<code><dfn data-lt="payment-feature|payment" data-nodefault="" data-dfn-type="dfn" id="dfn-payment-feature">payment</dfn></code>". Its <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/feature-policy-1/#default-allowlist">default allowlist</a> is
        '<code>self</code>'.
      </p>
      
    </section>
    <section id="events">
      <h2 id="x17-events"><bdi>17. </bdi>
        Events
      <a aria-label="ยง" href="#events"></a></h2>
      <section id="summary">
        <h3 id="x17-1-summary"><bdi>17.1 </bdi>
          Summary
        <a aria-label="ยง" href="#summary"></a></h3><p><em>This section is non-normative.</em></p>
        <table>
          <tbody><tr>
            <th>
              Event name
            </th>
            <th>
              Interface
            </th>
            <th>
              Dispatched whenโฆ
            </th>
            <th>
              Target
            </th>
          </tr>
          <tr>
            <td>
              <code><dfn data-dfn-type="dfn" id="dfn-merchantvalidation">merchantvalidation</dfn></code>
            </td>
            <td>
              <a data-xref-type="_IDL_" href="#dom-merchantvalidationevent" data-link-type="idl"><code><code>MerchantValidationEvent</code></code></a>
            </td>
            <td>
              The user agent requires the merchant to perform merchant
              validation.
            </td>
            <td>
              <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>
            </td>
          </tr>
          <tr>
            <td>
              <code><dfn data-dfn-type="dfn" id="dfn-shippingaddresschange">shippingaddresschange</dfn></code>
            </td>
            <td>
              <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a>
            </td>
            <td>
              The user provides a new shipping address.
            </td>
            <td>
              <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>
            </td>
          </tr>
          <tr>
            <td>
              <code><dfn data-dfn-type="dfn" id="dfn-shippingoptionchange">shippingoptionchange</dfn></code>
            </td>
            <td>
              <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a>
            </td>
            <td>
              The user chooses a new shipping option.
            </td>
            <td>
              <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>
            </td>
          </tr>
          <tr>
            <td>
              <code><dfn data-dfn-type="dfn" id="dfn-payerdetailchange">payerdetailchange</dfn></code>
            </td>
            <td>
              <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a>
            </td>
            <td>
              The user changes the payer name, the payer email, or the payer
              phone (see <a href="#dfn-payer-detail-changed-algorithm" data-link-type="dfn">payer detail changed algorithm</a>).
            </td>
            <td>
              <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>
            </td>
          </tr>
          <tr>
            <td>
              <code><dfn data-dfn-type="dfn" id="dfn-paymentmethodchange">paymentmethodchange</dfn></code>
            </td>
            <td>
              <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeevent" data-link-type="idl"><code><code>PaymentMethodChangeEvent</code></code></a>
            </td>
            <td>
              The user chooses a different <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> within a
              <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a>.
            </td>
            <td>
              <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>
            </td>
          </tr>
        </tbody></table>
      </section>
      <section data-dfn-for="MerchantValidationEvent" data-link-for="MerchantValidationEvent" id="merchantvalidationevent-interface">
        <h3 id="x17-2-merchantvalidationevent-interface"><bdi>17.2 </bdi>
          <dfn data-dfn-type="interface" data-export="" id="dom-merchantvalidationevent" data-idl="interface" data-title="MerchantValidationEvent" data-dfn-for=""><code>MerchantValidationEvent</code></dfn> interface
        <a aria-label="ยง" href="#merchantvalidationevent-interface"></a></h3>
        <pre><span data-idl="" id="idl-def-merchantvalidationevent" data-title="MerchantValidationEvent">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-merchantvalidationevent"><code>MerchantValidationEvent</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#event">Event</a></span> {<span data-idl="" id="idl-def-merchantvalidationevent-constructor-type-eventinitdict" data-title="constructor" data-dfn-for="MerchantValidationEvent">
  <dfn data-export="" data-dfn-type="constructor" id="dom-merchantvalidationevent-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="MerchantValidationEvent" data-lt="MerchantValidationEvent.constructor()|MerchantValidationEvent.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span>type</span>, optional<span> <a data-xref-type="_IDL_" href="#dom-merchantvalidationeventinit" data-link-type="idl"><code>MerchantValidationEventInit</code></a></span> <span>eventInitDict</span> = {});</span><span data-idl="" id="idl-def-merchantvalidationevent-methodname" data-title="methodName" data-dfn-for="MerchantValidationEvent">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="MerchantValidationEvent" data-link-type="attribute" href="#dom-merchantvalidationevent-methodname"><code>methodName</code></a>;</span><span data-idl="" id="idl-def-merchantvalidationevent-validationurl" data-title="validationURL" data-dfn-for="MerchantValidationEvent">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a data-link-for="MerchantValidationEvent" data-link-type="attribute" href="#dom-merchantvalidationevent-validationurl"><code>validationURL</code></a>;</span><span data-idl="" id="idl-def-merchantvalidationevent-complete-merchantsessionpromise" data-title="complete" data-dfn-for="MerchantValidationEvent"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a data-link-for="MerchantValidationEvent" data-link-type="method" href="#dom-merchantvalidationevent-complete"><code>complete</code></a>(<span><a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <span>merchantSessionPromise</span>);</span>
};</span></pre>
        <section id="methodname-attribute-0">
          <h4 id="x17-2-1-methodname-attribute"><bdi>17.2.1 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-merchantvalidationevent-methodname" data-idl="attribute" data-title="methodName" data-dfn-for="MerchantValidationEvent" data-type="DOMString" data-lt="MerchantValidationEvent.methodName|methodName"><code>methodName</code></dfn> attribute
          <a aria-label="ยง" href="#methodname-attribute-0"></a></h4>
          <p data-link-for="MerchantValidationEventInit">
            When getting, returns the value it was initialized with. See
            <a href="#dom-merchantvalidationeventinit-methodname" data-link-type="idl"><code>methodName</code></a> member of <a href="#dom-merchantvalidationeventinit" data-link-type="idl"><code>MerchantValidationEventInit</code></a> for
            more information.
          </p>
        </section>
        <section id="merchantvalidationevent-constructor">
          <h4 id="x17-2-2-merchantvalidationevent-constructor"><bdi>17.2.2 </bdi>
            <dfn data-lt="MerchantValidationEvent.MerchantValidationEvent()|MerchantValidationEvent constructor" data-dfn-type="dfn" id="dfn-merchantvalidationevent-merchantvalidationevent"><code>MerchantValidationEvent</code>
            constructor</dfn>
          <a aria-label="ยง" href="#merchantvalidationevent-constructor"></a></h4>
          <p data-tests="MerchantValidationEvent/constructor.https.html, MerchantValidationEvent/constructor.http.html">
            The <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-constructor-ext">event constructing steps</a>, which take a
            <a data-xref-type="_IDL_" href="#dom-merchantvalidationevent" data-link-type="idl"><code><code>MerchantValidationEvent</code></code></a> <var>event</var>, are as follows:
          </p>
          <ol>
            <li>Let <var>base</var> be the <a data-lt="context object" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#context-object">event</a>โs
            <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">relevant settings object</a>โs <a data-link-for="environment settings object" data-xref-for="environment settings object" data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url">api
            base URL</a>.
            </li>
            <li data-link-for="MerchantValidationEventInit">Let <var>validationURL</var>
            be the result of <a data-lt="URL parser" data-cite-path="" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser">URL parsing</a>
            <var>eventInitDict</var>["<a href="#dom-merchantvalidationeventinit-validationurl" data-link-type="idl"><code>validationURL</code></a>"] and <var>base</var>.
            </li>
            <li>If <var>validationURL</var> is failure, throw a <a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>.
            </li>
            <li>Initialize <var>event</var>.<a href="#dom-merchantvalidationevent-validationurl" data-link-type="idl"><code>validationURL</code></a> attribute to
            <var>validationURL</var>.
            </li>
            <li>If <var>eventInitDict</var>["<a href="#dom-merchantvalidationevent-methodname" data-link-type="idl"><code>methodName</code></a>"] is not the empty
            string, run the steps to <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-validate-a-payment-method-identifier">validate a payment method
            identifier</a> with <var>eventInitDict</var>["<a href="#dom-merchantvalidationevent-methodname" data-link-type="idl"><code>methodName</code></a>"]. If it
            returns false, then throw a "<a data-xref-type="exception" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror"><code>RangeError</code></a>" exception. Optionally,
            inform the developer that the payment method identifier is invalid.
            </li>
            <li>Initialize <var>event</var>.<a href="#dom-merchantvalidationevent-methodname" data-link-type="idl"><code>methodName</code></a> attribute to
            <var>eventInitDict</var>["<a href="#dom-merchantvalidationevent-methodname" data-link-type="idl"><code>methodName</code></a>"].
            </li>
            <li>Initialize <var>event</var>.<a data-lt="mechvalidation.waitForUpdate" href="#dfn-mechvalidation-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> to false.
            </li>
          </ol>
        </section>
        <section id="validationurl-attribute">
          <h4 id="x17-2-3-validationurl-attribute"><bdi>17.2.3 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-merchantvalidationevent-validationurl" data-idl="attribute" data-title="validationURL" data-dfn-for="MerchantValidationEvent" data-type="USVString" data-lt="MerchantValidationEvent.validationURL|validationURL"><code>validationURL</code></dfn> attribute
          <a aria-label="ยง" href="#validationurl-attribute"></a></h4>
          <p>
            A <a data-cite-path="" data-type="dfn" href="https://url.spec.whatwg.org/#concept-url">URL</a> from which a developer can fetch <a href="#dfn-payment-handler" data-link-type="dfn">payment
            handler</a>-specific verification data. By then passing that data
            (or a promise that resolves with that data) to <a href="#dom-merchantvalidationevent-complete" data-link-type="idl"><code>complete()</code></a>,
            the user agent can verify that the payment request is from an
            authorized merchant.
          </p>
          <p>
            When getting, returns the value it was initialized with.
          </p>
        </section>
        <section id="complete-method-0">
          <h4 id="x17-2-4-complete-method"><bdi>17.2.4 </bdi>
            <dfn data-dfn-type="method" data-export="" id="dom-merchantvalidationevent-complete" data-idl="operation" data-title="complete()" data-dfn-for="MerchantValidationEvent" data-type="void" data-lt="MerchantValidationEvent.complete()|MerchantValidationEvent.complete|complete()|complete"><code>complete()</code></dfn> method
          <a aria-label="ยง" href="#complete-method-0"></a></h4>
          <p data-tests="MerchantValidationEvent/complete-method.https.html">
            The <a data-xref-type="_IDL_" href="#dom-merchantvalidationevent" data-link-type="idl"><code><code>MerchantValidationEvent</code></code></a>'s
            <code>complete(<var>merchantSessionPromise</var>)</code> method <em title="MUST">MUST</em> act as
            follows:
          </p>
          <ol>
            <li>Let <var>event</var> be the <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#context-object">context object</a>.
            </li>
            <li>If <var>event</var>'s <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#event"><code>Event</code></a>.<a data-xref-type="attribute|dict-member" data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="attribute" href="https://dom.spec.whatwg.org/#dom-event-istrusted"><code>isTrusted</code></a> attribute is false, then
            <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>If <var>event</var>.<a data-lt="mechvalidation.waitForUpdate" href="#dfn-mechvalidation-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> is true, then
            <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>Let <var>request</var> be <var>event</var>'s <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#event-target">target</a>.
            </li>
            <li>If <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is not "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>",
            then <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>"
            <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>If <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> is true, then
            <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>Set <var>event</var>'s <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#stop-propagation-flag">stop propagation flag</a> and <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#stop-immediate-propagation-flag">stop
            immediate propagation flag</a>.
            </li>
            <li>Set <var>event</var>.<a data-lt="mechvalidation.waitForUpdate" href="#dfn-mechvalidation-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> to true.
            </li>
            <li>Run the <a href="#dfn-validate-merchant-s-details-algorithm" data-link-type="dfn">validate merchant's details algorithm</a> with
            <var>merchantSessionPromise</var> and <var>request</var>.
            </li>
          </ol>
        </section>
        <section id="internal-slots-2">
          <h4 id="x17-2-5-internal-slots"><bdi>17.2.5 </bdi>
            Internal Slots
          <a aria-label="ยง" href="#internal-slots-2"></a></h4>
          <p>
            Instances of <a data-xref-type="_IDL_" href="#dom-merchantvalidationevent" data-link-type="idl"><code><code>MerchantValidationEvent</code></code></a> are created with the
            internal slots in the following table:
          </p>
          <table>
            <tbody><tr>
              <th>
                Internal Slot
              </th>
              <th>
                Description (<em>non-normative</em>)
              </th>
            </tr>
            <tr>
              <td>
                <dfn data-lt-nodefault="" data-lt="mechvalidation.waitForUpdate" data-dfn-type="dfn" id="dfn-mechvalidation-waitforupdate">[[waitForUpdate]]</dfn>
              </td>
              <td>
                A boolean indicating whether a <a href="#dom-merchantvalidationevent-complete" data-link-type="idl"><code>complete()</code></a>-initiated
                update is currently in progress.
              </td>
            </tr>
          </tbody></table>
        </section>
        <section data-dfn-for="MerchantValidationEventInit" data-link-for="MerchantValidationEventInit" id="merchantvalidationeventinit-dictionary">
          <h4 id="x17-2-6-merchantvalidationeventinit-dictionary"><bdi>17.2.6 </bdi>
            <dfn data-dfn-type="dictionary" data-export="" id="dom-merchantvalidationeventinit" data-idl="dictionary" data-title="MerchantValidationEventInit" data-dfn-for=""><code>MerchantValidationEventInit</code></dfn> dictionary
          <a aria-label="ยง" href="#merchantvalidationeventinit-dictionary"></a></h4>
          <pre><span data-idl="" id="idl-def-merchantvalidationeventinit" data-title="MerchantValidationEventInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-merchantvalidationeventinit"><code>MerchantValidationEventInit</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="dictionary" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a></span> {<span data-idl="" id="idl-def-merchantvalidationeventinit-methodname" data-title="methodName" data-dfn-for="MerchantValidationEventInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="MerchantValidationEventInit" data-link-type="dict-member" href="#dom-merchantvalidationeventinit-methodname"><code>methodName</code></a> = "";</span><span data-idl="" id="idl-def-merchantvalidationeventinit-validationurl" data-title="validationURL" data-dfn-for="MerchantValidationEventInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a data-link-for="MerchantValidationEventInit" data-link-type="dict-member" href="#dom-merchantvalidationeventinit-validationurl"><code>validationURL</code></a> = "";</span>
};</span></pre>
          <dl>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-merchantvalidationeventinit-methodname" data-idl="field" data-title="methodName" data-dfn-for="MerchantValidationEventInit" data-type="DOMString"><code>methodName</code></dfn> member
            </dt>
            <dd>
              A <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a> representing the <a href="#dfn-payment-handler" data-link-type="dfn">payment
              handler</a> that is requiring <a href="#dfn-validate-the-merchant" data-link-type="dfn">merchant validation</a>.
            </dd>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-merchantvalidationeventinit-validationurl" data-idl="field" data-title="validationURL" data-dfn-for="MerchantValidationEventInit" data-type="USVString"><code>validationURL</code></dfn> member
            </dt>
            <dd>
              A URL from which a developer would fetch <a href="#dfn-payment-handler" data-link-type="dfn">payment
              handler</a>-specific verification data.
            </dd>
          </dl>
        </section>
      </section>
      <section data-dfn-for="PaymentMethodChangeEvent" data-link-for="PaymentMethodChangeEvent" id="paymentmethodchangeevent-interface">
        <h3 id="x17-3-paymentmethodchangeevent-interface"><bdi>17.3 </bdi>
          <dfn data-dfn-type="interface" data-export="" id="dom-paymentmethodchangeevent" data-idl="interface" data-title="PaymentMethodChangeEvent" data-dfn-for=""><code>PaymentMethodChangeEvent</code></dfn> interface
        <a aria-label="ยง" href="#paymentmethodchangeevent-interface"></a></h3>
        <pre><span data-idl="" id="idl-def-paymentmethodchangeevent" data-title="PaymentMethodChangeEvent">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentmethodchangeevent"><code>PaymentMethodChangeEvent</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code>PaymentRequestUpdateEvent</code></a></span> {<span data-idl="" id="idl-def-paymentmethodchangeevent-constructor-type-eventinitdict" data-title="constructor" data-dfn-for="PaymentMethodChangeEvent">
  <dfn data-export="" data-dfn-type="constructor" id="dom-paymentmethodchangeevent-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="PaymentMethodChangeEvent" data-lt="PaymentMethodChangeEvent.constructor()|PaymentMethodChangeEvent.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span>type</span>, optional<span> <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeeventinit" data-link-type="idl"><code>PaymentMethodChangeEventInit</code></a></span> <span>eventInitDict</span> = {});</span><span data-idl="" id="idl-def-paymentmethodchangeevent-methodname" data-title="methodName" data-dfn-for="PaymentMethodChangeEvent">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentMethodChangeEvent" data-link-type="attribute" href="#dom-paymentmethodchangeevent-methodname"><code>methodName</code></a>;</span><span data-idl="" id="idl-def-paymentmethodchangeevent-methoddetails" data-title="methodDetails" data-dfn-for="PaymentMethodChangeEvent">
  readonly attribute<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a data-link-for="PaymentMethodChangeEvent" data-link-type="attribute" href="#dom-paymentmethodchangeevent-methoddetails"><code>methodDetails</code></a>;</span>
};</span></pre>
        <section id="methoddetails-attribute">
          <h4 id="x17-3-1-methoddetails-attribute"><bdi>17.3.1 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentmethodchangeevent-methoddetails" data-idl="attribute" data-title="methodDetails" data-dfn-for="PaymentMethodChangeEvent" data-type="object" data-lt="PaymentMethodChangeEvent.methodDetails|methodDetails"><code>methodDetails</code></dfn> attribute
          <a aria-label="ยง" href="#methoddetails-attribute"></a></h4>
          <p data-link-for="PaymentMethodChangeEventInit">
            When getting, returns the value it was initialized with. See
            <a href="#dom-paymentmethodchangeeventinit-methoddetails" data-link-type="idl"><code>methodDetails</code></a> member of <a href="#dom-paymentmethodchangeeventinit" data-link-type="idl"><code>PaymentMethodChangeEventInit</code></a>
            for more information.
          </p>
        </section>
        <section id="methodname-attribute-1">
          <h4 id="x17-3-2-methodname-attribute"><bdi>17.3.2 </bdi>
            <dfn data-dfn-type="attribute" data-export="" id="dom-paymentmethodchangeevent-methodname" data-idl="attribute" data-title="methodName" data-dfn-for="PaymentMethodChangeEvent" data-type="DOMString" data-lt="PaymentMethodChangeEvent.methodName|methodName"><code>methodName</code></dfn> attribute
          <a aria-label="ยง" href="#methodname-attribute-1"></a></h4>
          <p data-link-for="PaymentMethodChangeEventInit">
            When getting, returns the value it was initialized with. See
            <a href="#dom-paymentmethodchangeeventinit-methodname" data-link-type="idl"><code>methodName</code></a> member of <a href="#dom-paymentmethodchangeeventinit" data-link-type="idl"><code>PaymentMethodChangeEventInit</code></a> for
            more information.
          </p>
        </section>
        <section data-dfn-for="PaymentMethodChangeEventInit" data-link-for="PaymentMethodChangeEventInit" id="paymentmethodchangeeventinit-dictionary">
          <h4 id="x17-3-3-paymentmethodchangeeventinit-dictionary"><bdi>17.3.3 </bdi>
            <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentmethodchangeeventinit" data-idl="dictionary" data-title="PaymentMethodChangeEventInit" data-dfn-for=""><code>PaymentMethodChangeEventInit</code></dfn> dictionary
          <a aria-label="ยง" href="#paymentmethodchangeeventinit-dictionary"></a></h4>
          <pre><span data-idl="" id="idl-def-paymentmethodchangeeventinit" data-title="PaymentMethodChangeEventInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentmethodchangeeventinit"><code>PaymentMethodChangeEventInit</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentrequestupdateeventinit" data-link-type="idl"><code>PaymentRequestUpdateEventInit</code></a></span> {<span data-idl="" id="idl-def-paymentmethodchangeeventinit-methodname" data-title="methodName" data-dfn-for="PaymentMethodChangeEventInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentMethodChangeEventInit" data-link-type="dict-member" href="#dom-paymentmethodchangeeventinit-methodname"><code>methodName</code></a> = "";</span><span data-idl="" id="idl-def-paymentmethodchangeeventinit-methoddetails" data-title="methodDetails" data-dfn-for="PaymentMethodChangeEventInit"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a data-link-for="PaymentMethodChangeEventInit" data-link-type="dict-member" href="#dom-paymentmethodchangeeventinit-methoddetails"><code>methodDetails</code></a> = null;</span>
};</span></pre>
          <dl>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentmethodchangeeventinit-methodname" data-idl="field" data-title="methodName" data-dfn-for="PaymentMethodChangeEventInit" data-type="DOMString"><code>methodName</code></dfn> member
            </dt>
            <dd>
              A string representing the <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a>.
            </dd>
            <dt>
              <dfn data-dfn-type="dict-member" data-export="" id="dom-paymentmethodchangeeventinit-methoddetails" data-idl="field" data-title="methodDetails" data-dfn-for="PaymentMethodChangeEventInit" data-type="object"><code>methodDetails</code></dfn> member
            </dt>
            <dd>
              An object representing some data from the payment method, or
              null.
            </dd>
          </dl>
        </section>
      </section>
      <section data-dfn-for="PaymentRequestUpdateEvent" data-link-for="PaymentRequestUpdateEvent" id="paymentrequestupdateevent-interface">
        <h3 id="x17-4-paymentrequestupdateevent-interface"><bdi>17.4 </bdi>
          <dfn data-dfn-type="interface" data-export="" id="dom-paymentrequestupdateevent" data-idl="interface" data-title="PaymentRequestUpdateEvent" data-dfn-for=""><code>PaymentRequestUpdateEvent</code></dfn> interface
        <a aria-label="ยง" href="#paymentrequestupdateevent-interface"></a></h3>
        <pre><span data-idl="" id="idl-def-paymentrequestupdateevent" data-title="PaymentRequestUpdateEvent">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentrequestupdateevent"><code>PaymentRequestUpdateEvent</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#event">Event</a></span> {<span data-idl="" id="idl-def-paymentrequestupdateevent-constructor-type-eventinitdict" data-title="constructor" data-dfn-for="PaymentRequestUpdateEvent">
  <a data-link-for="PaymentRequestUpdateEvent" data-link-type="constructor" href="#dom-paymentrequestupdateevent-constructor"><code>constructor</code></a>(<span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span>type</span>, optional<span> <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateeventinit" data-link-type="idl"><code>PaymentRequestUpdateEventInit</code></a></span> <span>eventInitDict</span> = {});</span><span data-idl="" id="idl-def-paymentrequestupdateevent-updatewith-detailspromise" data-title="updateWith" data-dfn-for="PaymentRequestUpdateEvent"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a data-link-for="PaymentRequestUpdateEvent" data-link-type="method" href="#dom-paymentrequestupdateevent-updatewith"><code>updateWith</code></a>(<span><a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a>&gt;</span> <span>detailsPromise</span>);</span>
};</span></pre>
        <p>
          The <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a> enables developers to update the
          details of the payment request in response to a user interaction.
        </p>
        <section id="constructor-0">
          <h4 id="x17-4-1-constructor"><bdi>17.4.1 </bdi>
            <dfn data-lt="PaymentRequestUpdateEvent.PaymentRequestUpdateEvent()|Constructor|PaymentRequestUpdateEvent.constructor()|PaymentRequestUpdateEvent.constructor|constructor()|constructor" data-dfn-type="constructor" data-export="" id="dom-paymentrequestupdateevent-constructor" data-idl="constructor" data-title="Constructor" data-dfn-for="PaymentRequestUpdateEvent"><code>Constructor</code></dfn>
          <a aria-label="ยง" href="#constructor-0"></a></h4>
          <p data-tests="PaymentRequestUpdateEvent/constructor.https.html, PaymentRequestUpdateEvent/constructor.http.html">
            The <a data-lt="PaymentRequestUpdateEvent" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent(<var>type</var>,
            <var>eventInitDict</var>)</code></code></a> constructor <em title="MUST">MUST</em> act as follows:
          </p>
          <ol>
            <li>Let <var>event</var> be the result of calling the <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-constructor">constructor</a>
            of <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a> with <var>type</var> and <var>eventInitDict</var>.
            </li>
            <li>Set <var>event</var>.<a href="#dfn-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> to false.
            </li>
            <li>Return <var>event</var>.
            </li>
          </ol>
        </section>
        <section id="updatewith-method">
          <h4 id="x17-4-2-updatewith-method"><bdi>17.4.2 </bdi>
            <dfn data-lt="updateWith(detailsPromise)|updateWith()|PaymentRequestUpdateEvent.updateWith()|PaymentRequestUpdateEvent.updateWith|updateWith" data-dfn-type="method" data-export="" id="dom-paymentrequestupdateevent-updatewith" data-idl="operation" data-title="updateWith()" data-dfn-for="PaymentRequestUpdateEvent" data-type="void"><code>updateWith()</code></dfn> method
          <a aria-label="ยง" href="#updatewith-method"></a></h4>
          
          <p data-tests="PaymentRequestUpdateEvent/updatewith-method.https.html, PaymentRequestUpdateEvent/updateWith-incremental-update-manual.https.html">
            The <a href="#dom-paymentrequestupdateevent-updatewith" data-link-type="idl"><code><code>updateWith(<var>detailsPromise</var>)</code></code></a> method <em title="MUST">MUST</em>
            act as follows:
          </p>
          <ol>
            <li>Let <var>event</var> be this <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a> instance.
            </li>
            <li>If <var>event</var>'s <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#event"><code>Event</code></a>.<a data-xref-type="attribute|dict-member" data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="attribute" href="https://dom.spec.whatwg.org/#dom-event-istrusted"><code>isTrusted</code></a> attribute is false, then
            <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>If <var>event</var>.<a href="#dfn-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> is true, then
            <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>If <var>event</var>'s <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#event-target">target</a> is an instance of
            <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>, let <var>request</var> be <var>event</var>'s
            <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#event-target">target</a>.<a href="#dfn-request" data-link-type="dfn">[[request]]</a>.
            </li>
            <li>Otherwise, let <var>request</var> be the value of <var>event</var>'s
            <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#event-target">target</a>.
            </li>
            <li>Assert: <var>request</var> is an instance of <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>.
            </li>
            <li>If <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is not "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>",
            then <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>"
            <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>If <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> is true, then
            <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#invalidstateerror"><code>InvalidStateError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
            </li>
            <li>Set <var>event</var>'s <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#stop-propagation-flag">stop propagation flag</a> and <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#stop-immediate-propagation-flag">stop
            immediate propagation flag</a>.
            </li>
            <li>Set <var>event</var>.<a href="#dfn-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> to true.
            </li>
            <li>Let <var>pmi</var> be null.
            </li>
            <li>If <var>event</var> has a <a data-link-for="PaymentMethodChangeEvent" href="#dom-paymentmethodchangeevent-methodname" data-link-type="idl"><code>methodName</code></a> attribute, set <var>pmi</var> to
            the <a data-link-for="PaymentMethodChangeEvent" href="#dom-paymentmethodchangeevent-methodname" data-link-type="idl"><code>methodName</code></a>
            attribute's value.
            </li>
            <li>Run the <a href="#dfn-update-a-paymentrequest-s-details-algorithm" data-link-type="dfn">update a <code>PaymentRequest</code>'s details
            algorithm</a> with <var>detailsPromise</var>, <var>request</var>, and <var>pmi</var>.
            </li>
          </ol>
        </section>
        <section id="internal-slots-3">
          <h4 id="x17-4-3-internal-slots"><bdi>17.4.3 </bdi>
            Internal Slots
          <a aria-label="ยง" href="#internal-slots-3"></a></h4>
          <p>
            Instances of <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a> are created with the
            internal slots in the following table:
          </p>
          <table>
            <tbody><tr>
              <th>
                Internal Slot
              </th>
              <th>
                Description (<em>non-normative</em>)
              </th>
            </tr>
            <tr>
              <td>
                <dfn data-dfn-type="dfn" id="dfn-waitforupdate">[[waitForUpdate]]</dfn>
              </td>
              <td>
                A boolean indicating whether an <a href="#dom-paymentrequestupdateevent-updatewith" data-link-type="idl"><code>updateWith()</code></a>-initiated
                update is currently in progress.
              </td>
            </tr>
          </tbody></table>
        </section>
        <section id="paymentrequestupdateeventinit-dictionary">
          <h4 id="x17-4-4-paymentrequestupdateeventinit-dictionary"><bdi>17.4.4 </bdi>
            <dfn data-dfn-type="dictionary" data-export="" id="dom-paymentrequestupdateeventinit" data-idl="dictionary" data-title="PaymentRequestUpdateEventInit" data-dfn-for=""><code>PaymentRequestUpdateEventInit</code></dfn> dictionary
          <a aria-label="ยง" href="#paymentrequestupdateeventinit-dictionary"></a></h4>
          <pre><span data-idl="" id="idl-def-paymentrequestupdateeventinit" data-title="PaymentRequestUpdateEventInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentrequestupdateeventinit"><code>PaymentRequestUpdateEventInit</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="dictionary" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a></span> {};</span></pre>
        </section>
      </section>
    </section>
    <section id="algorithms">
      <h2 id="x18-algorithms"><bdi>18. </bdi>
        Algorithms
      <a aria-label="ยง" href="#algorithms"></a></h2>
      <p>
        When the internal slot <a href="#dfn-state" data-link-type="dfn">[[state]]</a> of a <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>
        object is set to "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>", the <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> will
        trigger the following algorithms based on user interaction.
      </p>
      <section id="merchant-validation">
        <h3 id="x18-1-merchant-validation"><bdi>18.1 </bdi>
          Merchant validation
        <a aria-label="ยง" href="#merchant-validation"></a></h3>
        <p>
          <dfn data-lt="Validate the merchant|Merchant validation" data-dfn-type="dfn" id="dfn-validate-the-merchant">Merchant validation</dfn> is the
          process by which a <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> validates the identity of a
          merchant against some <var>value</var> (usually some cryptographic challenge
          response). Validated merchants are allowed to interface with a
          <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a>. Details of how actual validation is performed
          is outside the scope of this specification.
        </p>
        <p>
          It is <em title="OPTIONAL">OPTIONAL</em> for a <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> to support <a href="#dfn-validate-the-merchant" data-link-type="dfn">merchant
          validation</a>.
        </p>
        <p>
          For <a href="#dfn-payment-method" data-link-type="dfn">payment methods</a> that support <a href="#dfn-validate-the-merchant" data-link-type="dfn">merchant validation</a>,
          the user agent runs the <dfn data-dfn-type="dfn" id="dfn-request-merchant-validation-algorithm">request merchant validation
          algorithm</dfn>. The algorithm takes a <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><code>USVString</code></a>
          <var>merchantSpecificURL</var>, provided by the <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a>:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object that the user
          is interacting with.
          </li>
          <li>Let <var>validationURL</var> be a <a data-cite-path="" data-type="dfn" href="https://url.spec.whatwg.org/#absolute-url-string">absolute-URL string</a> from which a
          developer can fetch <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a>-specific verification
          data.
          </li>
          <li>Let <var>methodName</var> be the <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a> for the
          <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> that is requiring <a href="#dfn-validate-the-merchant" data-link-type="dfn">merchant validation</a>.
          </li>
          <li>
            <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
            run the following steps:
            <ol data-link-for="MerchantValidationEventInit">
              <li>Assert: <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> is false.
              </li>
              <li>Assert: <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>".
              </li>
              <li>Let <var>eventInitDict</var> be an new
              <a href="#dom-merchantvalidationeventinit" data-link-type="idl"><code>MerchantValidationEventInit</code></a> dictionary.
              </li>
              <li>Set <var>eventInitDict</var>["<a href="#dom-merchantvalidationeventinit-validationurl" data-link-type="idl"><code>validationURL</code></a>"] to
              <var>validationURL</var>.
              </li>
              <li>Set <var>eventInitDict</var>["<a href="#dom-merchantvalidationeventinit-methodname" data-link-type="idl"><code>methodName</code></a>"] to <var>methodName</var>.
              </li>
              <li>Let <var>event</var> be the result of calling the
              <a data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-constructor">constructor</a> of <a data-xref-type="_IDL_" href="#dom-merchantvalidationevent" data-link-type="idl"><code><code>MerchantValidationEvent</code></code></a> with
              "<a href="#dfn-merchantvalidation" data-link-type="dfn"><code>merchantvalidation</code></a>" and <var>eventInitDict</var>.
              </li>
              <li>Initialize <var>event</var>โs <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#event"><code>Event</code></a>.<a data-xref-type="attribute|dict-member" data-link-for="Event" data-xref-for="Event" data-cite-path="" data-type="attribute" href="https://dom.spec.whatwg.org/#dom-event-istrusted"><code>isTrusted</code></a> attribute to true.
              </li>
              <li>
                <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch">Dispatch</a> <var>event</var> to <var>request</var>.
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section id="shipping-address-changed-algorithm">
        <h3 id="x18-2-shipping-address-changed-algorithm"><bdi>18.2 </bdi>
          Shipping address changed algorithm
        <a aria-label="ยง" href="#shipping-address-changed-algorithm"></a></h3>
        <p data-tests="algorithms-manual.https.html#shipping-address-changed-algo">
          The <dfn data-dfn-type="dfn" id="dfn-shipping-address-changed-algorithm">shipping address changed algorithm</dfn> runs when the user
          provides a new shipping address. It <em title="MUST">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object that the user
          is interacting with.
          </li>
          <li>
            <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
            run the following steps:
            <ol>
              <li>
                <div role="note" id="issue-container-generatedID-31"><p><span>Note</span><span>: Privacy of recipient information</span></p><div>
                  <p>
                    The <var>redactList</var> limits the amount of personal information
                    about the recipient that the API shares with the merchant.
                  </p>
                  <p>
                    For merchants, the resulting <a href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a> object
                    provides enough information to, for example, calculate
                    shipping costs, but, in most cases, not enough information
                    to physically locate and uniquely identify the recipient.
                  </p>
                  <p>
                    Unfortunately, even with the <var>redactList</var>, recipient
                    anonymity cannot be assured. This is because in some
                    countries postal codes are so fine-grained that they can
                    uniquely identify a recipient.
                  </p>
                </div></div>
              </li>
              <li>Let <var>redactList</var> be the empty list. Set <var>redactList</var> to ยซ
              "organization", "phone", "recipient", "addressLine" ยป.
              </li>
              <li>Let <var>address</var> be the result of running the steps to <a href="#dfn-create-a-paymentaddress-from-user-provided-input" data-link-type="dfn">create
              a <code>PaymentAddress</code> from user-provided input</a> with
              <var>redactList</var>.
              </li>
              <li>Set the <a data-lt="PaymentRequest.shippingAddress" href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a> attribute on
              <var>request</var> to <var>address</var>.
              </li>
              <li>Run the <a href="#dfn-paymentrequest-updated-algorithm" data-link-type="dfn">PaymentRequest updated algorithm</a> with
              <var>request</var> and "<a href="#dfn-shippingaddresschange" data-link-type="dfn"><code>shippingaddresschange</code></a>".
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section id="shipping-option-changed-algorithm">
        <h3 id="x18-3-shipping-option-changed-algorithm"><bdi>18.3 </bdi>
          Shipping option changed algorithm
        <a aria-label="ยง" href="#shipping-option-changed-algorithm"></a></h3>
        <p data-tests="algorithms-manual.https.html#shipping-option-changed-algo">
          The <dfn data-dfn-type="dfn" id="dfn-shipping-option-changed-algorithm">shipping option changed algorithm</dfn> runs when the user
          chooses a new shipping option. It <em title="MUST">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object that the user
          is interacting with.
          </li>
          <li>
            <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
            run the following steps:
            <ol>
              <li>Set the <a data-lt="PaymentRequest.shippingOption" href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a> attribute on
              <var>request</var> to the <code>id</code> string of the
              <a href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a> provided by the user.
              </li>
              <li>Run the <a href="#dfn-paymentrequest-updated-algorithm" data-link-type="dfn">PaymentRequest updated algorithm</a> with
              <var>request</var> and "<a href="#dfn-shippingoptionchange" data-link-type="dfn"><code>shippingoptionchange</code></a>".
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section id="payment-method-changed-algorithm">
        <h3 id="x18-4-payment-method-changed-algorithm"><bdi>18.4 </bdi>
          Payment method changed algorithm
        <a aria-label="ยง" href="#payment-method-changed-algorithm"></a></h3>
        <p data-cite="WEBIDL">
          A <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> <em title="MAY">MAY</em> run the <dfn data-dfn-type="dfn" id="dfn-payment-method-changed-algorithm">payment method changed
          algorithm</dfn> when the user changes <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> with
          <var>methodDetails</var>, which is a <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-dictionary">dictionary</a> or an <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object"><code>object</code></a> or
          null, and a <var>methodName</var>, which is a DOMString that represents the
          <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a> of the <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> the
          user is interacting with.
        </p>
        
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object that the user
          is interacting with.
          </li>
          <li>
            <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
            run the following steps:
            <ol>
              <li>Assert: <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> is false. Only one
              update can take place at a time.
              </li>
              <li>Assert: <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>".
              </li>
              <li data-link-for="PaymentMethodChangeEvent">
                <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">Fire an event</a> named "<a href="#dfn-paymentmethodchange" data-link-type="dfn"><code>paymentmethodchange</code></a>" at
                <var>request</var> using <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeevent" data-link-type="idl"><code><code>PaymentMethodChangeEvent</code></code></a>, with its
                <a href="#dom-paymentmethodchangeevent-methodname" data-link-type="idl"><code>methodName</code></a> attribute initialized to <var>methodName</var>, and
                its <a href="#dom-paymentmethodchangeevent-methoddetails" data-link-type="idl"><code>methodDetails</code></a> attribute initialized to
                <var>methodDetails</var>.
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section id="paymentrequest-updated-algorithm">
        <h3 id="x18-5-paymentrequest-updated-algorithm"><bdi>18.5 </bdi>
          PaymentRequest updated algorithm
        <a aria-label="ยง" href="#paymentrequest-updated-algorithm"></a></h3>
        <p data-tests="algorithms-manual.https.html">
          The <dfn data-dfn-type="dfn" id="dfn-paymentrequest-updated-algorithm">PaymentRequest updated algorithm</dfn> is run by other
          algorithms above to <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> to indicate that a user has
          made a change to a <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> called <var>request</var> with an
          event name of <var>name</var>:
        </p>
        <ol>
          <li>Assert: <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> is false. Only one update
          can take place at a time.
          </li>
          <li>Assert: <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>".
          </li>
          <li>Let <var>event</var> be the result of <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-create">creating an event</a> using the
          <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a> interface.
          </li>
          <li>Initialize <var>event</var>'s <code><a href="https://dom.spec.whatwg.org/#dom-event-type">type</a></code> attribute to <var>name</var>.
          </li>
          <li>
            <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch">Dispatch</a> <var>event</var> at <var>request</var>.
          </li>
          <li data-link-for="PaymentRequestUpdateEvent">If
          <var>event</var>.<a href="#dfn-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> is true, disable any part of the
          user interface that could cause another update event to be fired.
          </li>
          <li>Otherwise, set <var>event</var>.<a href="#dfn-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> to true.
          </li>
        </ol>
      </section>
      <section id="payer-detail-changed-algorithm">
        <h3 id="x18-6-payer-detail-changed-algorithm"><bdi>18.6 </bdi>
          Payer detail changed algorithm
        <a aria-label="ยง" href="#payer-detail-changed-algorithm"></a></h3>
        <p>
          The user agent <em title="MUST">MUST</em> run the <dfn data-dfn-type="dfn" id="dfn-payer-detail-changed-algorithm">payer detail changed algorithm</dfn>
          when the user changes the <var>payer name</var>, or the <var>payer email</var>, or the
          <var>payer phone</var> in the user interface:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object that the user
          is interacting with.
          </li>
          <li>If <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a> is null, return.
          </li>
          <li>Let <var>response</var> be <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a>.
          </li>
          <li>
            <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
            run the following steps:
            <ol data-link-for="PaymentResponse">
              <li>Assert: <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> is false.
              </li>
              <li>Assert: <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>".
              </li>
              <li>Let <var>options</var> be <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>.
              </li>
              <li>If <var>payer name</var> changed and <var>options</var>.<a data-link-for="PaymentOptions" href="#dom-paymentoptions-requestpayername" data-link-type="idl"><code>requestPayerName</code></a> is true:
                <ol>
                  <li>Set <var>response</var>'s <a href="#dom-paymentresponse-payername" data-link-type="idl"><code>payerName</code></a> attribute to <var>payer
                  name</var>.
                  </li>
                </ol>
              </li>
              <li>If <var>payer email</var> changed and <var>options</var>.<a data-link-for="PaymentOptions" href="#dom-paymentoptions-requestpayeremail" data-link-type="idl"><code>requestPayerEmail</code></a> is true:
                <ol>
                  <li>Set <var>response</var>'s <a href="#dom-paymentresponse-payeremail" data-link-type="idl"><code>payerEmail</code></a> attribute to <var>payer
                  email</var>.
                  </li>
                </ol>
              </li>
              <li>If <var>payer phone</var> changed and <var>options</var>.<a data-link-for="PaymentOptions" href="#dom-paymentoptions-requestpayerphone" data-link-type="idl"><code>requestPayerPhone</code></a> is true:
                <ol>
                  <li>Set <var>response</var>'s <a href="#dom-paymentresponse-payerphone" data-link-type="idl"><code>payerPhone</code></a> attribute to <var>payer
                  phone</var>.
                  </li>
                </ol>
              </li>
              <li>Let <var>event</var> be the result of <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-create">creating an event</a> using
              <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code><code>PaymentRequestUpdateEvent</code></code></a>.
              </li>
              <li>Initialize <var>event</var>'s <code><a href="https://dom.spec.whatwg.org/#dom-event-type">
                type</a></code> attribute to "<a href="#dfn-payerdetailchange" data-link-type="dfn"><code>payerdetailchange</code></a>".
              </li>
              <li>
                <a data-cite-path="" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch">Dispatch</a> <var>event</var> at <var>response</var>.
              </li>
              <li data-link-for="PaymentRequestUpdateEvent">If
              <var>event</var>.<a href="#dfn-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> is true, disable any part of
              the user interface that could cause another change to the payer
              details to be fired.
              </li>
              <li>Otherwise, set <var>event</var>.<a href="#dfn-waitforupdate" data-link-type="dfn">[[waitForUpdate]]</a> to true.
              </li>
            </ol>
          </li>
        </ol>
      </section>
      <section id="user-accepts-the-payment-request-algorithm">
        <h3 id="x18-7-user-accepts-the-payment-request-algorithm"><bdi>18.7 </bdi>
          User accepts the payment request algorithm
        <a aria-label="ยง" href="#user-accepts-the-payment-request-algorithm"></a></h3>
        <p data-tests="user-accepts-payment-request-algo-manual.https.html">
          The <dfn data-lt="user accepts the payment request|user accepts the payment request algorithm" data-dfn-type="dfn" id="dfn-user-accepts-the-payment-request">user accepts the
          payment request algorithm</dfn> runs when the user accepts the
          payment request and confirms that they want to pay. It <em title="MUST">MUST</em> <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue
          a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to perform the
          following steps:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object that the user
          is interacting with.
          </li>
          <li>If the <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> is true, then terminate
          this algorithm and take no further action. The <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> user
          interface <em title="SHOULD">SHOULD</em> ensure that this never occurs.
          </li>
          <li>If <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is not "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>", then
          terminate this algorithm and take no further action. The <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> user interface <em title="SHOULD">SHOULD</em> ensure that this never occurs.
          </li>
          <li>If the <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> value of
          <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a> is true, then if the <a data-lt="PaymentRequest.shippingAddress" href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a> attribute of
          <var>request</var> is null or if the <a data-lt="PaymentRequest.shippingOption" href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a> attribute of
          <var>request</var> is null, then terminate this algorithm and take no further
          action. The <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="SHOULD">SHOULD</em> ensure that this never occurs.
          </li>
          <li>Let <var>isRetry</var> be true if <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a> is not
          null, false otherwise.
          </li>
          <li>Let <var>response</var> be <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a> if <var>isRetry</var> is
          true, or a new <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a> otherwise.
          </li>
          <li>If <var>isRetry</var> if false, initialize the newly created <var>response</var>:
            <ol>
              <li>Set <var>response</var>.<a href="#dfn-request" data-link-type="dfn">[[request]]</a> to <var>request</var>.
              </li>
              <li>Set <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> to null.
              </li>
              <li>Set <var>response</var>.<a href="#dfn-complete" data-link-type="dfn">[[complete]]</a> to false.
              </li>
              <li>Set the <a data-lt="PaymentResponse.requestId" href="#dom-paymentresponse-requestid" data-link-type="idl"><code>requestId</code></a>
              attribute value of <var>response</var> to the value of
              <var>request</var>.<a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a data-lt="PaymentDetailsInit.id" href="#dom-paymentdetailsinit-id" data-link-type="idl"><code>id</code></a>.
              </li>
              <li>Set <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a> to <var>response</var>.
              </li>
            </ol>
          </li>
          <li>Let <var>handler</var> be the <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> selected by the user.
          </li>
          <li>Set the <a data-lt="PaymentResponse.methodName" href="#dom-paymentresponse-methodname" data-link-type="idl"><code>methodName</code></a>
          attribute value of <var>response</var> to the <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a>
          of <var>handler</var>.
          </li>
          <li>Set the <a data-lt="PaymentResponse.details" href="#dom-paymentresponse-details" data-link-type="idl"><code>details</code></a>
          attribute value of <var>response</var> to an object resulting from running the
          <var>handler</var>'s <a href="#dfn-steps-to-respond-to-a-payment-request" data-link-type="dfn">steps to respond to a payment request</a>.
          </li>
          <li>If the <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> value of
          <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a> is false, then set the <a data-lt="PaymentResponse.shippingAddress" href="#dom-paymentresponse-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a> attribute value
          of <var>response</var> to null. Otherwise:
            <ol>
              <li>Let <var>redactList</var> be the empty <a data-cite-path="" data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a>.
              </li>
              <li>Let <var>shippingAddress</var> be the result of <a href="#dfn-create-a-paymentaddress-from-user-provided-input" data-link-type="dfn">create a
              <code>PaymentAddress</code> from user-provided input</a> with
              <var>redactList</var>.
              </li>
              <li>Set the <a data-lt="PaymentResponse.shippingAddress" href="#dom-paymentresponse-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a> attribute
              value of <var>response</var> to <var>shippingAddress</var>.
              </li>
              <li>Set the <a data-lt="PaymentRequest.shippingAddress" href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a> attribute
              value of <var>request</var> to <var>shippingAddress</var>.
              </li>
            </ol>
          </li>
          <li>If the <a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> value of
          <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a> is true, then set the <a data-lt="PaymentResponse.shippingOption" href="#dom-paymentresponse-shippingoption" data-link-type="idl"><code>shippingOption</code></a> attribute of
          <var>response</var> to the value of the <a data-lt="PaymentRequest.shippingOption" href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a> attribute of
          <var>request</var>. Otherwise, set it to null.
          </li>
          <li>If the <a data-lt="PaymentOptions.requestPayerName" href="#dom-paymentoptions-requestpayername" data-link-type="idl"><code>requestPayerName</code></a> value of
          <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a> is true, then set the <a data-lt="PaymentResponse.payerName" href="#dom-paymentresponse-payername" data-link-type="idl"><code>payerName</code></a> attribute of <var>response</var> to
          the payer's name provided by the user, or to null if none was
          provided. Otherwise, set it to null.
          </li>
          <li>If the <a data-lt="PaymentOptions.requestPayerEmail" href="#dom-paymentoptions-requestpayeremail" data-link-type="idl"><code>requestPayerEmail</code></a> value of
          <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a> is true, then set the <a data-lt="PaymentResponse.payerEmail" href="#dom-paymentresponse-payeremail" data-link-type="idl"><code>payerEmail</code></a> attribute of <var>response</var>
          to the payer's email address provided by the user, or to null if none
          was provided. Otherwise, set it to null.
          </li>
          <li>If the <a data-lt="PaymentOptions.requestPayerPhone" href="#dom-paymentoptions-requestpayerphone" data-link-type="idl"><code>requestPayerPhone</code></a> value of
          <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a> is true, then set the <a data-lt="PaymentResponse.payerPhone" href="#dom-paymentresponse-payerphone" data-link-type="idl"><code>payerPhone</code></a> attribute of <var>response</var>
          to the payer's phone number provided by the user, or to null if none
          was provided. When setting the <a data-lt="PaymentResponse.payerPhone" href="#dom-paymentresponse-payerphone" data-link-type="idl"><code>payerPhone</code></a> value, the user agent
          <em title="SHOULD">SHOULD</em> format the phone number to adhere to [<cite><a href="#bib-e.164" title="The international public telecommunication numbering plan" data-link-type="biblio">E.164</a></cite>].
          </li>
          <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
          </li>
          <li>If <var>isRetry</var> is true, resolve <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a>
          with undefined. Otherwise, resolve
          <var>request</var>.<a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a> with <var>response</var>.
          </li>
        </ol>
      </section>
      <section id="user-aborts-the-payment-request-algorithm">
        <h3 id="x18-8-user-aborts-the-payment-request-algorithm"><bdi>18.8 </bdi>
          User aborts the payment request algorithm
        <a aria-label="ยง" href="#user-aborts-the-payment-request-algorithm"></a></h3>
        <p data-tests="user-abort-algorithm-manual.https.html">
          The <dfn data-lt="user aborts the payment request|user aborts the payment request algorithm" data-dfn-type="dfn" id="dfn-user-aborts-the-payment-request">user aborts the
          payment request algorithm</dfn> runs when the user aborts the payment
          request through the currently interactive user interface. It <em title="MUST">MUST</em>
          <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
          perform the following steps:
        </p>
        <ol>
          <li>Let <var>request</var> be the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> object that the user
          is interacting with.
          </li>
          <li>If <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> is not "<a href="#dfn-interactive" data-link-type="dfn">interactive</a>", then
          terminate this algorithm and take no further action. The <a href="#dfn-user-agent" data-link-type="dfn">user
          agent</a> user interface <em title="SHOULD">SHOULD</em> ensure that this never occurs.
          </li>
          <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
          </li>
          <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
          <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
          </li>
          <li>Let <var>error</var> be an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>Let <var>response</var> be <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a>.
          </li>
          <li>If <var>response</var> is not null:
            <ol>
              <li>Set <var>response</var>.<a href="#dfn-complete" data-link-type="dfn">[[complete]]</a> to true.
              </li>
              <li>Assert: <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> is not null.
              </li>
              <li>Reject <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> with <var>error</var>.
              </li>
            </ol>
          </li>
          <li>Otherwise, reject <var>request</var>.<a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a> with
          <var>error</var>.
          </li>
          <li>Abort the current user interaction and close down any remaining
          user interface.
          </li>
        </ol>
      </section>
      <section id="update-a-paymentrequest-s-details-algorithm">
        <h3 id="x18-9-update-a-paymentrequest-s-details-algorithm"><bdi>18.9 </bdi>
          Update a <code>PaymentRequest</code>'s details algorithm
        <a aria-label="ยง" href="#update-a-paymentrequest-s-details-algorithm"></a></h3>
        <p>
          The <dfn data-dfn-type="dfn" id="dfn-update-a-paymentrequest-s-details-algorithm">update a <code>PaymentRequest</code>'s details
          algorithm</dfn> takes a <a href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a> <var>detailsPromise</var>,
          a <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> <var>request</var>, and <var>pmi</var> that is either a
          DOMString or null (a <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a>). The steps are
          conditional on the <var>detailsPromise</var> settling. If <var>detailsPromise</var>
          never settles then the payment request is blocked. The user agent
          <em title="SHOULD">SHOULD</em> provide the user with a means to abort a payment request.
          Implementations <em title="MAY">MAY</em> choose to implement a timeout for pending updates
          if <var>detailsPromise</var> doesn't settle in a reasonable amount of time.
        </p>
        <p>
          In the case where a timeout occurs, or the user manually aborts, or
          the <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> decides to abort this particular payment,
          the user agent <em title="MUST">MUST</em> run the <a href="#dfn-user-aborts-the-payment-request" data-link-type="dfn">user aborts the payment request
          algorithm</a>.
        </p>
        <ol>
          <li>Set <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> to true.
          </li>
          <li>
            <a data-cite-path="infrastructure.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">In parallel</a>, disable the user interface that allows the user
            to accept the payment request. This is to ensure that the payment
            is not accepted until the user interface is updated with any new
            details.
          </li>
          <li>
            <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection">Upon rejection</a> of <var>detailsPromise</var>:
            <ol>
              <li>
                <a href="#dfn-abort-the-update" data-link-type="dfn">Abort the update</a> with <var>request</var> and an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>"
                <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
              </li>
            </ol>
          </li>
          <li>
            <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment">Upon fulfillment</a> of <var>detailsPromise</var> with value <var>value</var>:
            <ol data-link-for="PaymentDetailsBase">
              <li>Let <var>details</var> be the result of <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">converting</a> <var>value</var> to a
              <a href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a> dictionary. If this
              <a data-link-for="exception" data-xref-for="exception" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> an exception, <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a> with
              <var>request</var> and with the thrown exception.
              </li>
              <li>Let <var>serializedModifierData</var> be an empty list.
              </li>
              <li>Let <var>selectedShippingOption</var> be null.
              </li>
              <li>Let <var>shippingOptions</var> be an empty
              <code><a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a></code>&lt;<a href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a>&gt;.
              </li>
              <li>Validate and canonicalize the details:
                <ol>
                  <li data-link-for="PaymentDetailsUpdate">If the <a href="#dom-paymentdetailsupdate-total" data-link-type="idl"><code>total</code></a>
                  member of <var>details</var> is present, then:
                    <ol>
                      <li>
                        <a href="#dfn-check-and-canonicalize-total-amount" data-link-type="dfn">Check and canonicalize total amount</a>
                        <var>details</var>.<a href="#dom-paymentdetailsupdate-total" data-link-type="idl"><code>total</code></a>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>. If an exception is
                        thrown, then <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a> with <var>request</var> and
                        that exception.
                      </li>
                    </ol>
                  </li>
                  <li>If the <a href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a> member of <var>details</var> is
                  present, then for each <var>item</var> in
                  <var>details</var>.<a href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a>:
                    <ol>
                      <li>
                        <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">Check and canonicalize amount</a> <var>item</var>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>. If an exception is
                        thrown, then <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a> with <var>request</var> and
                        that exception.
                      </li>
                    </ol>
                  </li>
                  <li>If the <a href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a> member of <var>details</var> is
                  present, and <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>.<a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> is true,
                  then:
                    <ol>
                      <li>Let <var>seenIDs</var> be an empty set.
                      </li>
                      <li>For each <var>option</var> in
                      <var>details</var>.<a href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a>:
                        <ol>
                          <li>
                            <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">Check and canonicalize amount</a>
                            <var>option</var>.<a data-lt="PaymentShippingOption.amount" href="#dom-paymentshippingoption-amount" data-link-type="idl"><code>amount</code></a>. If an
                            exception is thrown, then <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a>
                            with <var>request</var> and that exception.
                          </li>
                          <li data-tests="PaymentRequestUpdateEvent/updateWith-duplicate-shipping-options-manual.https.html">
                          If <var>seenIDs</var>[<var>option</var>.<a data-lt="PaymentShippingOption.id" href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a>] exists, then
                          <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a> with <var>request</var> and a
                          <a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a>.
                          </li>
                          <li>Append <var>option</var>.<a data-lt="PaymentShippingOption.id" href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a> to <var>seenIDs</var>.
                          </li>
                          <li>Append <var>option</var> to <var>shippingOptions</var>.
                          </li>
                          <li>If <var>option</var>.<a data-lt="PaymentShippingOption.selected" href="#dom-paymentshippingoption-selected" data-link-type="idl"><code>selected</code></a> is
                          true, then set <var>selectedShippingOption</var> to
                          <var>option</var>.<a data-lt="PaymentShippingOption.id" href="#dom-paymentshippingoption-id" data-link-type="idl"><code>id</code></a>.
                          </li>
                        </ol>
                      </li>
                    </ol>
                  </li>
                  <li>If the <a href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a> member of <var>details</var> is present,
                  then:
                    <ol>
                      <li>Let <var>modifiers</var> be the sequence
                      <var>details</var>.<a href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a>.
                      </li>
                      <li>Let <var>serializedModifierData</var> be an empty list.
                      </li>
                      <li>For each <a href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a> <var>modifier</var> in
                      <var>modifiers</var>:
                        <ol data-link-for="PaymentDetailsModifier">
                          <li data-tests="updateWith-method-pmi-handling-manual.https.html">
                          Run the steps to <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-validate-a-payment-method-identifier">validate a payment method
                          identifier</a> with <var>modifier</var>.<a data-lt="PaymentDetailsModifier.supportedMethods" href="#dom-paymentdetailsmodifier-supportedmethods" data-link-type="idl"><code>supportedMethods</code></a>.
                          If it returns false, then <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a>
                          with <var>request</var> and a "<a data-xref-type="exception" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror"><code>RangeError</code></a>" exception.
                          Optionally, inform the developer that the payment
                          method identifier is invalid.
                          </li>
                          <li>If the <a href="#dom-paymentdetailsmodifier-total" data-link-type="idl"><code>total</code></a> member of <var>modifier</var> is
                          present, then:
                            <ol>
                              <li>
                                <a href="#dfn-check-and-canonicalize-total-amount" data-link-type="dfn">Check and canonicalize total amount</a>
                                <var>modifier</var>.<a href="#dom-paymentdetailsmodifier-total" data-link-type="idl"><code>total</code></a>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>. If an
                                exception is thrown, then <a href="#dfn-abort-the-update" data-link-type="dfn">abort the
                                update</a> with <var>request</var> and that exception.
                              </li>
                            </ol>
                          </li>
                          <li>If the <a href="#dom-paymentdetailsmodifier-additionaldisplayitems" data-link-type="idl"><code>additionalDisplayItems</code></a> member of
                          <var>modifier</var> is present, then for each
                          <a href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a> <var>item</var> in
                          <var>modifier</var>.<a href="#dom-paymentdetailsmodifier-additionaldisplayitems" data-link-type="idl"><code>additionalDisplayItems</code></a>:
                            <ol>
                              <li>
                                <a href="#dfn-check-and-canonicalize-amount" data-link-type="dfn">Check and canonicalize amount</a>
                                <var>item</var>.<a data-lt="PaymentItem.amount" href="#dom-paymentitem-amount" data-link-type="idl"><code>amount</code></a>. If an
                                exception is thrown, then <a href="#dfn-abort-the-update" data-link-type="dfn">abort the
                                update</a> with <var>request</var> and that exception.
                              </li>
                            </ol>
                          </li>
                          <li>If the <a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>
                            data</code></a> member of <var>modifier</var> is missing, let
                            <var>serializedData</var> be null. Otherwise, let
                            <var>serializedData</var> be the result of
                            <a href="#dfn-json-serialized" data-link-type="dfn">JSON-serializing</a> <var>modifier</var>.<a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>data</code></a> into a
                            string. If <a href="#dfn-json-serialized" data-link-type="dfn">JSON-serializing</a> throws an
                            exception, then <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a> with
                            <var>request</var> and that exception.
                          </li>
                          <li>Add <var>serializedData</var> to <var>serializedModifierData</var>.
                          </li>
                          <li>Remove the <a data-lt="PaymentDetailsModifier.data" href="#dom-paymentdetailsmodifier-data" data-link-type="idl"><code>data</code></a> member of
                          <var>modifier</var>, if it is present.
                          </li>
                        </ol>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li data-link-for="PaymentDetailsUpdate">If the
              <a href="#dom-paymentdetailsupdate-paymentmethoderrors" data-link-type="idl"><code>paymentMethodErrors</code></a> member is present and <var>identifier</var> is
              not null:
                <ol>
                  <li>If required by the specification that defines the <var>pmi</var>,
                  then <a data-lt="converted to an IDL value" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">convert</a>
                  <a href="#dom-paymentdetailsupdate-paymentmethoderrors" data-link-type="idl"><code>paymentMethodErrors</code></a> to an IDL value.
                  </li>
                  <li>If conversion results in a <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-exception">exception</a> <var>error</var>, <a href="#dfn-abort-the-update" data-link-type="dfn">
                    abort the update</a> with <var>error</var>.
                  </li>
                  <li>The <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> <em title="SHOULD">SHOULD</em> display an error for
                  each relevant erroneous field of <a href="#dom-paymentdetailsupdate-paymentmethoderrors" data-link-type="idl"><code>paymentMethodErrors</code></a>.
                  </li>
                </ol>
              </li>
              <li>Update the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> using the new details:
                <ol>
                  <li data-link-for="PaymentDetailsUpdate">If the <a href="#dom-paymentdetailsupdate-total" data-link-type="idl"><code>total</code></a>
                  member of <var>details</var> is present, then:
                    <ol>
                      <li>Set <var>request</var>.<a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a data-link-for="PaymentDetailsInit" href="#dom-paymentdetailsinit-total" data-link-type="idl"><code>total</code></a> to <var>details</var>.<a href="#dom-paymentdetailsupdate-total" data-link-type="idl"><code>total</code></a>.
                      </li>
                    </ol>
                  </li>
                  <li>If the <a href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a> member of <var>details</var> is
                  present, then:
                    <ol>
                      <li>Set <var>request</var>.<a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a>
                      to <var>details</var>.<a href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a>.
                      </li>
                    </ol>
                  </li>
                  <li>If the <a href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a> member of <var>details</var> is
                  present, and <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>.<a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> is true,
                  then:
                    <ol>
                      <li>Set
                      <var>request</var>.<a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a> to
                      <var>shippingOptions</var>.
                      </li>
                      <li>Set the value of <var>request</var>'s <a data-lt="PaymentRequest.shippingOption" href="#dom-paymentrequest-shippingoption" data-link-type="idl"><code>shippingOption</code></a>
                      attribute to <var>selectedShippingOption</var>.
                      </li>
                    </ol>
                  </li>
                  <li>If the <a href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a> member of <var>details</var> is present,
                  then:
                    <ol>
                      <li>Set <var>request</var>.<a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a> to
                      <var>details</var>.<a href="#dom-paymentdetailsbase-modifiers" data-link-type="idl"><code>modifiers</code></a>.
                      </li>
                      <li>Set <var>request</var>.<a href="#dfn-serializedmodifierdata" data-link-type="dfn">[[serializedModifierData]]</a> to
                      <var>serializedModifierData</var>.
                      </li>
                    </ol>
                  </li>
                  <li>
                    <p>
                      If <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>.<a data-lt="PaymentOptions.requestShipping" href="#dom-paymentoptions-requestshipping" data-link-type="idl"><code>requestShipping</code></a> is
                      true, and
                      <var>request</var>.<a href="#dfn-details" data-link-type="dfn">[[details]]</a>.<a href="#dom-paymentdetailsbase-shippingoptions" data-link-type="idl"><code>shippingOptions</code></a> is
                      empty, then the developer has signified that there are no
                      valid shipping options for the currently-chosen shipping
                      address (given by <var>request</var>'s <a data-lt="PaymentRequest.shippingAddress" href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a>).
                    </p>
                    <p>
                      In this case, the user agent <em title="SHOULD">SHOULD</em> display an error
                      indicating this, and <em title="MAY">MAY</em> indicate that the
                      currently-chosen shipping address is invalid in some way.
                      The user agent <em title="SHOULD">SHOULD</em> use the <a data-lt="PaymentDetailsUpdate.error" href="#dom-paymentdetailsupdate-error" data-link-type="idl"><code>error</code></a> member of
                      <var>details</var>, if it is present, to give more information
                      about why there are no valid shipping options for that
                      address.
                    </p>
                    <p>
                      Further, if <var>details</var>["<a data-lt="PaymentDetailsUpdate.shippingAddressErrors" href="#dom-paymentdetailsupdate-shippingaddresserrors" data-link-type="idl"><code>shippingAddressErrors</code></a>"]
                      member is present, the user agent <em title="SHOULD">SHOULD</em> display an error
                      specifically for each erroneous field of the shipping
                      address. This is done by matching each present member of
                      the <a href="#dom-addresserrors" data-link-type="idl"><code>AddressErrors</code></a> to a corresponding input field
                      in the shown user interface.
                    </p>
                    <p data-link-for="PaymentDetailsUpdate">
                      Similarly, if <var>details</var>["<a href="#dom-paymentdetailsupdate-payererrors" data-link-type="idl"><code>payerErrors</code></a>"] member is
                      present and <var>request</var>.<a href="#dfn-options" data-link-type="dfn">[[options]]</a>'s <a data-lt="PaymentOptions.requestPayerName" href="#dom-paymentoptions-requestpayername" data-link-type="idl"><code>requestPayerName</code></a>,
                      <a data-lt="PaymentOptions.requestPayerEmail" href="#dom-paymentoptions-requestpayeremail" data-link-type="idl"><code>requestPayerEmail</code></a>,
                      or <a data-lt="PaymentOptions.requestPayerPhone" href="#dom-paymentoptions-requestpayerphone" data-link-type="idl"><code>requestPayerPhone</code></a>
                      is true, then display an error specifically for each
                      erroneous field.
                    </p>
                    <p data-link-for="PaymentDetailsUpdate">
                      Likewise, if <var>details</var>["<a href="#dom-paymentdetailsupdate-paymentmethoderrors" data-link-type="idl"><code>paymentMethodErrors</code></a>"] is
                      present, then display errors specifically for each
                      erroneous input field for the particular payment method.
                    </p>
                  </li>
                </ol>
              </li>
            </ol>
          </li>
          <li>Set <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> to false.
          </li>
          <li>Update the user interface based on any changed values in
          <var>request</var>. Re-enable user interface elements disabled prior to
          running this algorithm.
          </li>
        </ol>
        <section id="abort-the-update">
          <h4 id="x18-9-1-abort-the-update"><bdi>18.9.1 </bdi>
            Abort the update
          <a aria-label="ยง" href="#abort-the-update"></a></h4>
          <p>
            To <dfn data-dfn-type="dfn" id="dfn-abort-the-update">abort the update</dfn> with a <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>
            <var>request</var> and <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-exception">exception</a> <var>exception</var>:
          </p>
          <ol>
            <li>Optionally, show an error message to the user when letting them
            know an error has occurred.
            </li>
            <li>Abort the current user interaction and close down any remaining
            user interface.
            </li>
            <li>
              <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <a data-cite-path="webappapis.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source">user interaction task source</a> to
              perform the following steps:
              <ol>
                <li>Set <var>request</var>'s <a href="#dfn-payment-relevant-browsing-context" data-link-type="dfn">payment-relevant browsing context</a>'s
                <a href="#dfn-payment-request-is-showing" data-link-type="dfn">payment request is showing</a> boolean to false.
                </li>
                <li>Set <var>request</var>.<a href="#dfn-state" data-link-type="dfn">[[state]]</a> to "<a href="#dfn-closed" data-link-type="dfn">closed</a>".
                </li>
                <li>Let <var>response</var> be <var>request</var>.<a href="#dfn-response" data-link-type="dfn">[[response]]</a>.
                </li>
                <li>If <var>response</var> is not null, then:
                  <ol>
                    <li>Set <var>response</var>.<a href="#dfn-complete" data-link-type="dfn">[[complete]]</a> to true.
                    </li>
                    <li>Assert: <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> is not
                    null.
                    </li>
                    <li>Reject <var>response</var>.<a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> with
                    <var>exception</var>.
                    </li>
                  </ol>
                </li>
                <li>Otherwise, reject <var>request</var>.<a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a> with
                <var>exception</var>.
                </li>
                <li>Set <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> to false.
                </li>
              </ol>
            </li>
            <li>Abort the algorithm.
            </li>
          </ol>
        </section>
        <div role="note" id="issue-container-generatedID-33"><p><span>Note</span></p><div>
          <p>
            <a href="#dfn-abort-the-update" data-link-type="dfn">Abort the update</a> runs when there is a fatal error updating
            the payment request, such as the supplied <var>detailsPromise</var>
            rejecting, or its fulfillment value containing invalid data. This
            would potentially leave the payment request in an inconsistent
            state since the developer hasn't successfully handled the change
            event.
          </p>
          <p>
            Consequently, the <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> moves to a "<a href="#dfn-closed" data-link-type="dfn">closed</a>"
            state. The error is signaled to the developer through the rejection
            of the <a href="#dfn-acceptpromise" data-link-type="dfn">[[acceptPromise]]</a>, i.e., the promise returned by
            <a data-lt="PaymentRequest.show" href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a>.
          </p>
          <p data-link-for="PaymentResponse">
            Similarly, <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a> occurring during <a href="#dom-paymentresponse-retry" data-link-type="idl"><code>retry()</code></a>
            causes the <a href="#dfn-retrypromise" data-link-type="dfn">[[retryPromise]]</a> to reject, and the
            corresponding <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a>'s <a href="#dfn-complete" data-link-type="dfn">[[complete]]</a> internal
            slot will be set to true (i.e., it can no longer be used).
          </p>
        </div></div>
      </section>
      <section id="validate-merchant-s-details-algorithm">
        <h3 id="x18-10-validate-merchant-s-details-algorithm"><bdi>18.10 </bdi>
          Validate merchant's details algorithm
        <a aria-label="ยง" href="#validate-merchant-s-details-algorithm"></a></h3>
        <p>
          The <dfn data-dfn-type="dfn" id="dfn-validate-merchant-s-details-algorithm">validate merchant's details algorithm</dfn> takes a
          <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><code>Promise</code></a> <var>opaqueDataPromise</var> and a <a data-xref-type="_IDL_" href="#dom-paymentrequest" data-link-type="idl"><code><code>PaymentRequest</code></code></a> <var>request</var>.
          The steps are conditional on the <var>opaqueDataPromise</var> settling. If
          <var>opaqueDataPromise</var> never settles then the payment request is
          blocked. The user agent <em title="SHOULD">SHOULD</em> provide the user with a means to abort
          a payment request. Implementations <em title="MAY">MAY</em> choose to implement a timeout
          for pending updates if <var>opaqueDataPromise</var> doesn't settle in a
          reasonable amount of time. If an implementation chooses to implement
          a timeout, they <em title="MUST">MUST</em> execute the steps listed below in the "upon
          rejection" path. Such a timeout is a fatal error for the payment
          request.
        </p>
        <ol>
          <li>Set <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> to true.
          </li>
          <li>
            <a data-cite-path="infrastructure.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">In parallel</a>, disable the user interface that allows the user
            to accept the payment request. This is to ensure that the payment
            is not accepted until the user interface is updated with any new
            details.
          </li>
          <li>
            <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection">Upon rejection</a> of <var>opaqueDataPromise</var>:
            <ol>
              <li>
                <a href="#dfn-abort-the-update" data-link-type="dfn">Abort the update</a> with <var>request</var> and an "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#aborterror"><code>AbortError</code></a>"
                <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
              </li>
            </ol>
          </li>
          <li>
            <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment">Upon fulfillment</a> of <var>opaqueDataPromise</var> with value
            <var>opaqueData</var>:
            <ol>
              <li>
                <a href="#dfn-validate-the-merchant" data-link-type="dfn">Validate the merchant</a> using <var>opaqueData</var>.
              </li>
              <li>If <var>opaqueData</var> is invalid, as per the validation rules of
              the <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a>, <a href="#dfn-abort-the-update" data-link-type="dfn">abort the update</a> with
              <var>request</var> and an appropriate <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#dfn-exception">exception</a> and return.
              </li>
              <li>Otherwise, set <var>request</var>.<a href="#dfn-updating" data-link-type="dfn">[[updating]]</a> to false.
              </li>
              <li>Enable the user interface, allowing the request for payment
              to proceed.
              </li>
            </ol>
          </li>
        </ol>
      </section>
    </section>
    <section id="privacy">
      <h2 id="x19-privacy-and-security-considerations"><bdi>19. </bdi>
        Privacy and Security Considerations
      <a aria-label="ยง" href="#privacy"></a></h2>
      <section data-link-for="PaymentRequest" id="user-protections-with-show-method">
        <h3 id="x19-1-user-protections-with-show-method"><bdi>19.1 </bdi>
          User protections with <code>show()</code> method
        <a aria-label="ยง" href="#user-protections-with-show-method"></a></h3><p><em>This section is non-normative.</em></p>
        <p>
          To help ensure that users do not inadvertently share sensitive
          credentials with an origin, this API requires that PaymentRequest's
          <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method be invoked while the relevant <a data-xref-type="_IDL_" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window"><code>Window</code></a> has
          <a data-cite-path="interaction.html" data-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation">transient activation</a> (e.g., via a click or press).
        </p>
        <p>
          To avoid a confusing user experience, this specification limits the
          user agent to displaying one at a time via the <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> method.
          In addition, the user agent can limit the rate at which a page can
          call <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a>.
        </p>
      </section>
      <section id="secure-contexts">
        <h3 id="x19-2-secure-contexts"><bdi>19.2 </bdi>
          Secure contexts
        <a aria-label="ยง" href="#secure-contexts"></a></h3><p><em>This section is non-normative.</em></p>
        <p>
          The API defined in this specification is only exposed in
          <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/secure-contexts/#secure-contexts">secure contexts</a>. In practice, this
          means that this API is only available over HTTPS. This is to limit
          the possibility of payment method data (e.g., credit card numbers)
          being sent in the clear.
        </p>
      </section>
      <section id="cross-origin-payment-requests">
        <h3 id="x19-3-cross-origin-payment-requests"><bdi>19.3 </bdi>
          Cross-origin payment requests
        <a aria-label="ยง" href="#cross-origin-payment-requests"></a></h3><p><em>This section is non-normative.</em></p>
        <p>
          It is common for merchants and other payees to delegate checkout and
          other e-commerce activities to payment service providers through an
          <a data-cite-path="iframe-embed-object.html" data-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a>. This API supports payee-authorized cross-origin
          iframes through [<cite><a href="#bib-html" title="HTML Standard" data-link-type="biblio">HTML</a></cite>]'s <a data-xref-type="_IDL_" data-cite-path="iframe-embed-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement"><code>HTMLIFrameElement</code></a>.<a data-xref-type="attribute|dict-member" data-link-for="HTMLIFrameElement" data-xref-for="HTMLIFrameElement" data-cite-path="iframe-embed-object.html" data-type="attribute" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-iframe-allowpaymentrequest"><code>allowPaymentRequest</code></a> attribute.
        </p>
        <p>
          <a href="#dfn-payment-handler" data-link-type="dfn">Payment handlers</a> have access to both the origin that hosts the
          <a data-cite-path="iframe-embed-object.html" data-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a> and the origin of the <a data-cite-path="iframe-embed-object.html" data-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a> content (where the
          <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> initiates).
        </p>
      </section>
      <section id="encryption-of-data-fields">
        <h3 id="x19-4-encryption-of-data-fields"><bdi>19.4 </bdi>
          Encryption of data fields
        <a aria-label="ยง" href="#encryption-of-data-fields"></a></h3><p><em>This section is non-normative.</em></p>
        <p>
          The <a href="#dom-paymentrequest" data-link-type="idl"><code>PaymentRequest</code></a> API does not directly support encryption of
          data fields. Individual <a href="#dfn-payment-method" data-link-type="dfn">payment methods</a> may choose to include
          support for encrypted data but it is not mandatory that all
          <a href="#dfn-payment-method" data-link-type="dfn">payment methods</a> support this.
        </p>
      </section>
      <section id="how-user-agents-match-payment-handlers">
        <h3 id="x19-5-how-user-agents-match-payment-handlers"><bdi>19.5 </bdi>
          How user agents match payment handlers
        <a aria-label="ยง" href="#how-user-agents-match-payment-handlers"></a></h3><p><em>This section is non-normative.</em></p>
        <p data-link-for="PaymentRequest">
          As part of <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a>, the user agent typically displays a list of
          matching <a href="#dfn-payment-handler" data-link-type="dfn">payment handlers</a> that satisfy the <a href="#dfn-payment-method" data-link-type="dfn">payment
          methods</a> accepted by the merchant and other conditions. Matching
          can take into account <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> information provided as
          input to the API, information provided by the <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>
          owner, the <a href="#dfn-payment-handler" data-link-type="dfn">payment handlers</a> registered by the user, user
          preferences, and other considerations.
        </p>
        <p data-link-for="PaymentRequest">
          For security reasons, a user agent can limit matching (in
          <a href="#dom-paymentrequest-show" data-link-type="idl"><code>show()</code></a> and <a href="#dom-paymentrequest-canmakepayment" data-link-type="idl"><code>canMakePayment()</code></a>) to <a href="#dfn-payment-handler" data-link-type="dfn">payment handlers</a>
          from the same <a href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a> as a URL
          <a data-cite-path="" data-type="dfn" href="https://www.w3.org/TR/payment-method-id/#dfn-pmi">payment method identifier</a>.
        </p>
      </section>
      <section id="data-usage-0">
        <h3 id="data-usage"><bdi>19.6 </bdi>
          Data usage
        <a aria-label="ยง" href="#data-usage-0"></a></h3>
        <p>
          <a href="#dfn-payment-method" data-link-type="dfn">Payment method</a> owners establish the privacy policies for how
          user data collected for the payment method may be used. Payment
          Request API sets a clear expectation that data will be used for the
          purposes of completing a transaction, and user experiences associated
          with this API convey that intention. It is the responsibility of the
          payee to ensure that any data usage conforms to payment method
          policies. For any permitted usage beyond completion of the
          transaction, the payee should clearly communicate that usage to the
          user.
        </p>
      </section>
      <section id="exposing-user-information">
        <h3 id="user-info"><bdi>19.7 </bdi>
          Exposing user information
        <a aria-label="ยง" href="#exposing-user-information"></a></h3>
        <p>
          The <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="MUST NOT">MUST NOT</em> share information about the user with
          a developer (e.g., the shipping address) without user consent.
        </p>
        <p>
          The <a href="#dfn-user-agent" data-link-type="dfn">user agent</a> <em title="MUST NOT">MUST NOT</em> share the values of the <a data-lt="PaymentDetailsBase.displayItems" href="#dom-paymentdetailsbase-displayitems" data-link-type="idl"><code>displayItems</code></a> member or
          <a data-lt="PaymentDetailsModifier.additionalDisplayItems" href="#dom-paymentdetailsmodifier-additionaldisplayitems" data-link-type="idl"><code>additionalDisplayItems</code></a>
          member with a third-party <a href="#dfn-payment-handler" data-link-type="dfn">payment handler</a> without user
          consent.
        </p>
        <p>
          The <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeevent" data-link-type="idl"><code><code>PaymentMethodChangeEvent</code></code></a> enables the payee to update the
          displayed total based on information specific to a selected
          <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>. For example, the billing address associated
          with a selected <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> might affect the tax
          computation (e.g., VAT), and it is desirable that the user interface
          accurately display the total before the payer completes the
          transaction. At the same time, it is desirable to share as little
          information as possible prior to completion of the payment.
          Therefore, when a <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> defines the <a href="#dfn-steps-for-when-a-user-changes-payment-method" data-link-type="dfn">steps for when
          a user changes payment method</a>, it is important to minimize the
          data shared via the <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeevent" data-link-type="idl"><code><code>PaymentMethodChangeEvent</code></code></a>'s <a data-link-for="PaymentMethodChangeEvent" href="#dom-paymentmethodchangeevent-methoddetails" data-link-type="idl"><code>methodDetails</code></a> attribute. Requirements
          and approaches for minimizing shared data are likely to vary by
          <a href="#dfn-payment-method" data-link-type="dfn">payment method</a> and might include:
        </p>
        <ul>
          <li>Use of a "<var>redactList</var>" for <a href="#dfn-physical-address" data-link-type="dfn">physical addresses</a>. The
          current specification makes use of a "<var>redactList</var>" to redact the <a href="#dfn-address-line" data-link-type="dfn">
            address line</a>, <a href="#dfn-organization" data-link-type="dfn">organization</a>, <a href="#dfn-phone-number" data-link-type="dfn">phone number</a>, and
            <a href="#dfn-recipient" data-link-type="dfn">recipient</a> from a <a data-link-for="PaymentRequest" href="#dom-paymentrequest-shippingaddress" data-link-type="idl"><code>shippingAddress</code></a>.
          </li>
          <li>Support for instructions from the payee identifying specific
          elements to exclude or include from the <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>
          response data (returned through <a href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>.<var>details</var>).
          The payee might provide these instructions via
          <a href="#dom-paymentmethoddata" data-link-type="idl"><code>PaymentMethodData</code></a>.<var>data</var>, enabling a <a href="#dfn-payment-method" data-link-type="dfn">payment method</a>
          definition to evolve without requiring changes to the current API.
          </li>
        </ul>
        <p>
          Where sharing of privacy-sensitive information might not be obvious
          to users (e.g., when <a data-lt="payment method changed algorithm" href="#dfn-payment-method-changed-algorithm" data-link-type="dfn">changing payment methods</a>), it
          is <em title="RECOMMENDED">RECOMMENDED</em> that user agents inform the user of exactly what
          information is being shared with a merchant.
        </p>
      </section>
      <section id="merchant-validation-0">
        <h3 id="x19-8-merchant-validation"><bdi>19.8 </bdi>
          Merchant Validation
        <a aria-label="ยง" href="#merchant-validation-0"></a></h3><p><em>This section is non-normative.</em></p>
        <p data-link-for="MerchantValidationEvent">
          It is important that the <a href="#dom-merchantvalidationevent-validationurl" data-link-type="idl"><code>validationURL</code></a> in a
          <a data-xref-type="_IDL_" href="#dom-merchantvalidationevent" data-link-type="idl"><code><code>MerchantValidationEvent</code></code></a> does not expose personally identifying
          information to unauthorized parties.
        </p>
      </section>
      <section id="canmakepayment-protections-0">
        <h3 id="canmakepayment-protections"><bdi>19.9 </bdi>
          <code>canMakePayment()</code> protections
        <a aria-label="ยง" href="#canmakepayment-protections-0"></a></h3>
        <p data-link-for="PaymentRequest">
          The <a href="#dom-paymentrequest-canmakepayment" data-link-type="idl"><code>canMakePayment()</code></a> methods have the potential to expose user
          information that could be abused for fingerprinting purposes. User
          agents are expected to protect the user from abuse of the method. For
          example, user agents can reduce user fingerprinting by:
        </p>
        <ul data-link-for="PaymentRequest">
          <li>Allowing the user to configure the user agent to turn off
          <a href="#dom-paymentrequest-canmakepayment" data-link-type="idl"><code>canMakePayment()</code></a>, which would return <a data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with">a promise rejected
          with</a> a "<a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#notallowederror"><code>NotAllowedError</code></a>" <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMException"><code>DOMException</code></a>.
          </li>
          <li>Rate-limiting the frequency of calls with different parameters.
          </li>
        </ul>
        <p>
          For rate-limiting the user agent might look at repeated calls from:
        </p>
        <ul>
          <li>the same effective top-level domain plus one (eTLD+1).
          </li>
          <li>the top-level browsing context. Alternatively, the user agent may
          block access to the API entirely for origins know to be bad actors.
          </li>
          <li>the origin of an <a data-cite-path="iframe-embed-object.html" data-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">iframe</a> or popup window.
          </li>
        </ul>
        <p>
          These rate-limiting techniques intend to increase the cost associated
          with repeated calls, whether it is the cost of managing multiple
          eTLDs or the user experience friction of opening multiple windows
          (tabs or pop-ups).
        </p>
      </section>
    </section>
    <section id="accessibility-considerations">
      <h2 id="x20-accessibility-considerations"><bdi>20. </bdi>
        Accessibility Considerations
      <a aria-label="ยง" href="#accessibility-considerations"></a></h2><p><em>This section is non-normative.</em></p>
      <p>
        For the user-facing aspects of Payment Request API, implementations
        integrate with platform accessibility APIs via form controls and other
        input modalities. Furthermore, to increase the intelligibility of
        total, shipping addresses, and contact information, implementations
        format data according to system conventions.
      </p>
    </section>
    <section id="dependencies">
      <h2 id="x21-dependencies"><bdi>21. </bdi>
        Dependencies
      <a aria-label="ยง" href="#dependencies"></a></h2>
      <p>
        This specification relies on several other underlying specifications.
      </p>
      <dl data-sort=""><dt>
          ECMAScript
        </dt>
        <dd>
          The terms <dfn data-dfn-type="dfn" data-plurals="internal slots" id="dfn-internal-slot" data-no-export=""><a href="https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">internal
          slot</a></dfn>, and <code><dfn data-dfn-type="dfn" id="dfn-json-stringify" data-no-export=""><a href="https://tc39.es/ecma262/#sec-json.stringify">JSON.stringify</a></dfn></code> are
          defined by [<cite><a href="#bib-ecmascript" title="ECMAScript Language Specification" data-link-type="biblio">ECMASCRIPT</a></cite>].
          <p>
            The term <dfn data-lt="JSON-serialized|JSON-serializing|JSON-serialize" data-dfn-type="dfn" id="dfn-json-serialized">JSON-serialize</dfn> applied to
            a given object means to run the algorithm specified by the original
            value of the <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-json.stringify"><code>JSON.stringify</code></a> function on the supplied object,
            passing the supplied object as the sole argument, and return the
            resulting string. This can throw an exception.
          </p>
        </dd><dt>
          ISO 3366-2
        </dt>
        <dd>
          <dfn data-lt="country subdivision names|Country subdivision name" data-dfn-type="dfn" id="dfn-country-subdivision-names">Country subdivision
          name</dfn> and <dfn data-dfn-type="dfn" id="dfn-country-subdivision-code-element">country subdivision code element</dfn> are
          defined in [<cite><a href="#bib-iso3166-2" title="ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 2: Country subdivision code." data-link-type="biblio">ISO3166-2</a></cite>].
        </dd>
        </dl>
    </section>
    <section id="conformance"><h2 id="x22-conformance"><bdi>22. </bdi>Conformance<a aria-label="ยง" href="#conformance"></a></h2><p>
      As well as sections marked as non-normative, all authoring guidelines,
      diagrams, examples, and notes in this specification are non-normative.
      Everything else in this specification is normative.
    </p><p>
            The key words <em>MAY</em>, <em>MUST</em>, <em>MUST NOT</em>, <em>OPTIONAL</em>, <em>RECOMMENDED</em>, <em>SHOULD</em>, and <em>SHOULD NOT</em> in this document
            are to be interpreted as described in
            <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>
            [<cite><a href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels" data-link-type="biblio">RFC2119</a></cite>]
            [<cite><a href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words" data-link-type="biblio">RFC8174</a></cite>] when, and only when, they appear
            in all capitals, as shown here.
          </p>
      <p>
        There is only one class of product that can claim conformance to this
        specification: a <dfn data-dfn-type="dfn" data-plurals="user agents" id="dfn-user-agent">user agent</dfn>.
      </p>
      <div role="note" id="issue-container-generatedID-34"><p><span>Note</span></p><p>
        Although this specification is primarily targeted at web browsers, it
        is feasible that other software could also implement this specification
        in a conforming manner.
      </p></div>
      <p>
        User agents <em title="MAY">MAY</em> implement algorithms given in this specification in any
        way desired, so long as the end result is indistinguishable from the
        result that would be obtained by the specification's algorithms.
      </p>
      <p data-tests="payment-request-constructor-crash.https.html">
        User agents <em title="MAY">MAY</em> impose implementation-specific limits on otherwise
        unconstrained inputs, e.g., to prevent denial of service attacks, to
        guard against running out of memory, or to work around
        platform-specific limitations. When an input exceeds
        implementation-specific limit, the user agent <em title="MUST">MUST</em> throw, or, in the
        context of a promise, reject with, a <a data-xref-type="_IDL_" data-cite-path="" data-type="exception" href="https://heycam.github.io/webidl/#exceptiondef-typeerror"><code>TypeError</code></a> optionally informing
        the developer of how a particular input exceeded an
        implementation-specific limit.
      </p>
    </section>
    <section id="idl-index"><h2 id="a-idl-index"><bdi>A. </bdi>IDL Index<a aria-label="ยง" href="#idl-index"></a></h2><pre id="actual-idl-index"><span data-idl="" data-title="PaymentRequest">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentrequest"><code>PaymentRequest</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" data-title="constructor" data-dfn-for="PaymentRequest">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="PaymentRequest" data-lt="PaymentRequest.constructor()|PaymentRequest.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span>
    <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentmethoddata" data-link-type="idl"><code>PaymentMethodData</code></a>&gt;</span> <span>methodData</span>,<span>
    <a data-xref-type="_IDL_" href="#dom-paymentdetailsinit" data-link-type="idl"><code>PaymentDetailsInit</code></a></span> <span>details</span>,
    optional<span> <a data-xref-type="_IDL_" href="#dom-paymentoptions" data-link-type="idl"><code>PaymentOptions</code></a></span> <span>options</span> = {}
  );</span><span data-idl="" data-title="show" data-dfn-for="PaymentRequest">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentresponse" data-link-type="idl"><code>PaymentResponse</code></a>&gt;</span> <a data-link-for="PaymentRequest" data-link-type="method" href="#dom-paymentrequest-show"><code>show</code></a>(optional<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a>&gt;</span> <span>detailsPromise</span>);</span><span data-idl="" data-title="abort" data-dfn-for="PaymentRequest">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a data-link-for="PaymentRequest" data-link-type="method" href="#dom-paymentrequest-abort"><code>abort</code></a>();</span><span data-idl="" data-title="canMakePayment" data-dfn-for="PaymentRequest">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a>&gt;</span> <a data-link-for="PaymentRequest" data-link-type="method" href="#dom-paymentrequest-canmakepayment"><code>canMakePayment</code></a>();</span><span data-idl="" data-title="id" data-dfn-for="PaymentRequest">

  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-id"><code>id</code></a>;</span><span data-idl="" data-title="shippingAddress" data-dfn-for="PaymentRequest">
  readonly attribute<span> <a data-xref-type="_IDL_" href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>?</span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-shippingaddress"><code>shippingAddress</code></a>;</span><span data-idl="" data-title="shippingOption" data-dfn-for="PaymentRequest">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-shippingoption"><code>shippingOption</code></a>;</span><span data-idl="" data-title="shippingType" data-dfn-for="PaymentRequest">
  readonly attribute<span> <a data-xref-type="_IDL_" href="#dom-paymentshippingtype" data-link-type="idl"><code>PaymentShippingType</code></a>?</span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-shippingtype"><code>shippingType</code></a>;</span><span data-idl="" data-title="onmerchantvalidation" data-dfn-for="PaymentRequest">

  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onmerchantvalidation"><code>onmerchantvalidation</code></a>;</span><span data-idl="" data-title="onshippingaddresschange" data-dfn-for="PaymentRequest">
  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onshippingaddresschange"><code>onshippingaddresschange</code></a>;</span><span data-idl="" data-title="onshippingoptionchange" data-dfn-for="PaymentRequest">
  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onshippingoptionchange"><code>onshippingoptionchange</code></a>;</span><span data-idl="" data-title="onpaymentmethodchange" data-dfn-for="PaymentRequest">
  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentRequest" data-link-type="attribute" href="#dom-paymentrequest-onpaymentmethodchange"><code>onpaymentmethodchange</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentMethodData">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentmethoddata"><code>PaymentMethodData</code></a> {<span data-idl="" data-title="supportedMethods" data-dfn-for="PaymentMethodData">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentMethodData" data-link-type="dict-member" href="#dom-paymentmethoddata-supportedmethods"><code>supportedMethods</code></a>;</span><span data-idl="" data-title="data" data-dfn-for="PaymentMethodData"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentMethodData" data-link-type="dict-member" href="#dom-paymentmethoddata-data"><code>data</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentCurrencyAmount">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentcurrencyamount"><code>PaymentCurrencyAmount</code></a> {<span data-idl="" data-title="currency" data-dfn-for="PaymentCurrencyAmount">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentCurrencyAmount" data-link-type="dict-member" href="#dom-paymentcurrencyamount-currency"><code>currency</code></a>;</span><span data-idl="" data-title="value" data-dfn-for="PaymentCurrencyAmount">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentCurrencyAmount" data-link-type="dict-member" href="#dom-paymentcurrencyamount-value"><code>value</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentDetailsBase">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsbase"><code>PaymentDetailsBase</code></a> {<span data-idl="" data-title="displayItems" data-dfn-for="PaymentDetailsBase"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a>&gt;</span> <a data-link-for="PaymentDetailsBase" data-link-type="dict-member" href="#dom-paymentdetailsbase-displayitems"><code>displayItems</code></a>;</span><span data-idl="" data-title="shippingOptions" data-dfn-for="PaymentDetailsBase"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentshippingoption" data-link-type="idl"><code>PaymentShippingOption</code></a>&gt;</span> <a data-link-for="PaymentDetailsBase" data-link-type="dict-member" href="#dom-paymentdetailsbase-shippingoptions"><code>shippingOptions</code></a>;</span><span data-idl="" data-title="modifiers" data-dfn-for="PaymentDetailsBase"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentdetailsmodifier" data-link-type="idl"><code>PaymentDetailsModifier</code></a>&gt;</span> <a data-link-for="PaymentDetailsBase" data-link-type="dict-member" href="#dom-paymentdetailsbase-modifiers"><code>modifiers</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentDetailsInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsinit"><code>PaymentDetailsInit</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a></span> {<span data-idl="" data-title="id" data-dfn-for="PaymentDetailsInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentDetailsInit" data-link-type="dict-member" href="#dom-paymentdetailsinit-id"><code>id</code></a>;</span><span data-idl="" data-title="total" data-dfn-for="PaymentDetailsInit">
  required<span> <a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a></span> <a data-link-for="PaymentDetailsInit" data-link-type="dict-member" href="#dom-paymentdetailsinit-total"><code>total</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentDetailsUpdate">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsupdate"><code>PaymentDetailsUpdate</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentdetailsbase" data-link-type="idl"><code>PaymentDetailsBase</code></a></span> {<span data-idl="" data-title="error" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-error"><code>error</code></a>;</span><span data-idl="" data-title="total" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-total"><code>total</code></a>;</span><span data-idl="" data-title="shippingAddressErrors" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" href="#dom-addresserrors" data-link-type="idl"><code>AddressErrors</code></a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-shippingaddresserrors"><code>shippingAddressErrors</code></a>;</span><span data-idl="" data-title="payerErrors" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="_IDL_" href="#dom-payererrors" data-link-type="idl"><code>PayerErrors</code></a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-payererrors"><code>payerErrors</code></a>;</span><span data-idl="" data-title="paymentMethodErrors" data-dfn-for="PaymentDetailsUpdate"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentDetailsUpdate" data-link-type="dict-member" href="#dom-paymentdetailsupdate-paymentmethoderrors"><code>paymentMethodErrors</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentDetailsModifier">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentdetailsmodifier"><code>PaymentDetailsModifier</code></a> {<span data-idl="" data-title="supportedMethods" data-dfn-for="PaymentDetailsModifier">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-supportedmethods"><code>supportedMethods</code></a>;</span><span data-idl="" data-title="total" data-dfn-for="PaymentDetailsModifier"><span>
  <a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a></span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-total"><code>total</code></a>;</span><span data-idl="" data-title="additionalDisplayItems" data-dfn-for="PaymentDetailsModifier"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentitem" data-link-type="idl"><code>PaymentItem</code></a>&gt;</span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-additionaldisplayitems"><code>additionalDisplayItems</code></a>;</span><span data-idl="" data-title="data" data-dfn-for="PaymentDetailsModifier"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentDetailsModifier" data-link-type="dict-member" href="#dom-paymentdetailsmodifier-data"><code>data</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentShippingType">enum <a data-link-for="" data-link-type="enum" href="#dom-paymentshippingtype"><code>PaymentShippingType</code></a> {
  <span>"<a data-link-for="PaymentShippingType" data-link-type="enum-value" href="#dom-paymentshippingtype-shipping"><code>shipping</code></a>"</span>,
  <span>"<a data-link-for="PaymentShippingType" data-link-type="enum-value" href="#dom-paymentshippingtype-delivery"><code>delivery</code></a>"</span>,
  <span>"<a data-link-for="PaymentShippingType" data-link-type="enum-value" href="#dom-paymentshippingtype-pickup"><code>pickup</code></a>"</span>
};</span>

<span data-idl="" data-title="PaymentOptions">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentoptions"><code>PaymentOptions</code></a> {<span data-idl="" data-title="requestPayerName" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestpayername"><code>requestPayerName</code></a> = false;</span><span data-idl="" data-title="requestBillingAddress" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestbillingaddress"><code>requestBillingAddress</code></a> = false;</span><span data-idl="" data-title="requestPayerEmail" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestpayeremail"><code>requestPayerEmail</code></a> = false;</span><span data-idl="" data-title="requestPayerPhone" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestpayerphone"><code>requestPayerPhone</code></a> = false;</span><span data-idl="" data-title="requestShipping" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-requestshipping"><code>requestShipping</code></a> = false;</span><span data-idl="" data-title="shippingType" data-dfn-for="PaymentOptions"><span>
  <a data-xref-type="_IDL_" href="#dom-paymentshippingtype" data-link-type="idl"><code>PaymentShippingType</code></a></span> <a data-link-for="PaymentOptions" data-link-type="dict-member" href="#dom-paymentoptions-shippingtype"><code>shippingType</code></a> = "shipping";</span>
};</span>

<span data-idl="" data-title="PaymentItem">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentitem"><code>PaymentItem</code></a> {<span data-idl="" data-title="label" data-dfn-for="PaymentItem">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentItem" data-link-type="dict-member" href="#dom-paymentitem-label"><code>label</code></a>;</span><span data-idl="" data-title="amount" data-dfn-for="PaymentItem">
  required<span> <a data-xref-type="_IDL_" href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a></span> <a data-link-for="PaymentItem" data-link-type="dict-member" href="#dom-paymentitem-amount"><code>amount</code></a>;</span><span data-idl="" data-title="pending" data-dfn-for="PaymentItem"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentItem" data-link-type="dict-member" href="#dom-paymentitem-pending"><code>pending</code></a> = false;</span>
};</span>

<span data-idl="" data-title="PaymentAddress">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>)</span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentaddress"><code>PaymentAddress</code></a> {<span data-idl="" data-title="toJSON" data-dfn-for="PaymentAddress">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Default">Default</a></span>]<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentAddress" data-link-type="method" href="#dom-paymentaddress-tojson"><code>toJSON</code></a>();</span><span data-idl="" data-title="city" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-city"><code>city</code></a>;</span><span data-idl="" data-title="country" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-country"><code>country</code></a>;</span><span data-idl="" data-title="dependentLocality" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-dependentlocality"><code>dependentLocality</code></a>;</span><span data-idl="" data-title="organization" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-organization"><code>organization</code></a>;</span><span data-idl="" data-title="phone" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-phone"><code>phone</code></a>;</span><span data-idl="" data-title="postalCode" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-postalcode"><code>postalCode</code></a>;</span><span data-idl="" data-title="recipient" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-recipient"><code>recipient</code></a>;</span><span data-idl="" data-title="region" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-region"><code>region</code></a>;</span><span data-idl="" data-title="sortingCode" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-sortingcode"><code>sortingCode</code></a>;</span><span data-idl="" data-title="addressLine" data-dfn-for="PaymentAddress">
  readonly attribute<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-frozen-array">FrozenArray</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>&gt;</span> <a data-link-for="PaymentAddress" data-link-type="attribute" href="#dom-paymentaddress-addressline"><code>addressLine</code></a>;</span>
};</span>

<span data-idl="" data-title="AddressInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-addressinit"><code>AddressInit</code></a> {<span data-idl="" data-title="country" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-country"><code>country</code></a>;</span><span data-idl="" data-title="addressLine" data-dfn-for="AddressInit"><span>
  <a data-xref-type="dfn" data-cite-path="" data-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>&gt;</span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-addressline"><code>addressLine</code></a>;</span><span data-idl="" data-title="region" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-region"><code>region</code></a>;</span><span data-idl="" data-title="city" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-city"><code>city</code></a>;</span><span data-idl="" data-title="dependentLocality" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-dependentlocality"><code>dependentLocality</code></a>;</span><span data-idl="" data-title="postalCode" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-postalcode"><code>postalCode</code></a>;</span><span data-idl="" data-title="sortingCode" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-sortingcode"><code>sortingCode</code></a>;</span><span data-idl="" data-title="organization" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-organization"><code>organization</code></a>;</span><span data-idl="" data-title="recipient" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-recipient"><code>recipient</code></a>;</span><span data-idl="" data-title="phone" data-dfn-for="AddressInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressInit" data-link-type="dict-member" href="#dom-addressinit-phone"><code>phone</code></a>;</span>
};</span>

<span data-idl="" data-title="AddressErrors">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-addresserrors"><code>AddressErrors</code></a> {<span data-idl="" data-title="addressLine" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-addressline"><code>addressLine</code></a>;</span><span data-idl="" data-title="city" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-city"><code>city</code></a>;</span><span data-idl="" data-title="country" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-country"><code>country</code></a>;</span><span data-idl="" data-title="dependentLocality" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-dependentlocality"><code>dependentLocality</code></a>;</span><span data-idl="" data-title="organization" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-organization"><code>organization</code></a>;</span><span data-idl="" data-title="phone" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-phone"><code>phone</code></a>;</span><span data-idl="" data-title="postalCode" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-postalcode"><code>postalCode</code></a>;</span><span data-idl="" data-title="recipient" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-recipient"><code>recipient</code></a>;</span><span data-idl="" data-title="region" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-region"><code>region</code></a>;</span><span data-idl="" data-title="sortingCode" data-dfn-for="AddressErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="AddressErrors" data-link-type="dict-member" href="#dom-addresserrors-sortingcode"><code>sortingCode</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentShippingOption">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentshippingoption"><code>PaymentShippingOption</code></a> {<span data-idl="" data-title="id" data-dfn-for="PaymentShippingOption">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-id"><code>id</code></a>;</span><span data-idl="" data-title="label" data-dfn-for="PaymentShippingOption">
  required<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-label"><code>label</code></a>;</span><span data-idl="" data-title="amount" data-dfn-for="PaymentShippingOption">
  required<span> <a data-xref-type="_IDL_" href="#dom-paymentcurrencyamount" data-link-type="idl"><code>PaymentCurrencyAmount</code></a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-amount"><code>amount</code></a>;</span><span data-idl="" data-title="selected" data-dfn-for="PaymentShippingOption"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <a data-link-for="PaymentShippingOption" data-link-type="dict-member" href="#dom-paymentshippingoption-selected"><code>selected</code></a> = false;</span>
};</span>

<span data-idl="" data-title="PaymentComplete">enum <a data-link-for="" data-link-type="enum" href="#dom-paymentcomplete"><code>PaymentComplete</code></a> {
  <span>"<a data-link-for="PaymentComplete" data-link-type="enum-value" href="#dom-paymentcomplete-fail"><code>fail</code></a>"</span>,
  <span>"<a data-link-for="PaymentComplete" data-link-type="enum-value" href="#dom-paymentcomplete-success"><code>success</code></a>"</span>,
  <span>"<a data-link-for="PaymentComplete" data-link-type="enum-value" href="#dom-paymentcomplete-unknown"><code>unknown</code></a>"</span>
};</span>

<span data-idl="" data-title="PaymentResponse">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentresponse"><code>PaymentResponse</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span>  {<span data-idl="" data-title="toJSON" data-dfn-for="PaymentResponse">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Default">Default</a></span>]<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentResponse" data-link-type="method" href="#dom-paymentresponse-tojson"><code>toJSON</code></a>();</span><span data-idl="" data-title="requestId" data-dfn-for="PaymentResponse">

  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-requestid"><code>requestId</code></a>;</span><span data-idl="" data-title="methodName" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-methodname"><code>methodName</code></a>;</span><span data-idl="" data-title="details" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-details"><code>details</code></a>;</span><span data-idl="" data-title="shippingAddress" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" href="#dom-paymentaddress" data-link-type="idl"><code>PaymentAddress</code></a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-shippingaddress"><code>shippingAddress</code></a>;</span><span data-idl="" data-title="shippingOption" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-shippingoption"><code>shippingOption</code></a>;</span><span data-idl="" data-title="payerName" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-payername"><code>payerName</code></a>;</span><span data-idl="" data-title="payerEmail" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-payeremail"><code>payerEmail</code></a>;</span><span data-idl="" data-title="payerPhone" data-dfn-for="PaymentResponse">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>?</span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-payerphone"><code>payerPhone</code></a>;</span><span data-idl="" data-title="complete" data-dfn-for="PaymentResponse">

  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a data-link-for="PaymentResponse" data-link-type="method" href="#dom-paymentresponse-complete"><code>complete</code></a>(optional<span> <a data-xref-type="_IDL_" href="#dom-paymentcomplete" data-link-type="idl"><code>PaymentComplete</code></a></span> <span>result</span> = "unknown");</span><span data-idl="" data-title="retry" data-dfn-for="PaymentResponse">
  [<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a></span>]<span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a>&gt;</span> <a data-link-for="PaymentResponse" data-link-type="method" href="#dom-paymentresponse-retry"><code>retry</code></a>(optional<span> <a data-xref-type="_IDL_" href="#dom-paymentvalidationerrors" data-link-type="idl"><code>PaymentValidationErrors</code></a></span> <span>errorFields</span> = {});</span><span data-idl="" data-title="onpayerdetailchange" data-dfn-for="PaymentResponse">

  attribute<span> <a data-xref-type="_IDL_" data-cite-path="webappapis.html" data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a data-link-for="PaymentResponse" data-link-type="attribute" href="#dom-paymentresponse-onpayerdetailchange"><code>onpayerdetailchange</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentValidationErrors">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentvalidationerrors"><code>PaymentValidationErrors</code></a> {<span data-idl="" data-title="payer" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="_IDL_" href="#dom-payererrors" data-link-type="idl"><code>PayerErrors</code></a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-payer"><code>payer</code></a>;</span><span data-idl="" data-title="shippingAddress" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="_IDL_" href="#dom-addresserrors" data-link-type="idl"><code>AddressErrors</code></a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-shippingaddress"><code>shippingAddress</code></a>;</span><span data-idl="" data-title="error" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-error"><code>error</code></a>;</span><span data-idl="" data-title="paymentMethod" data-dfn-for="PaymentValidationErrors"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a></span> <a data-link-for="PaymentValidationErrors" data-link-type="dict-member" href="#dom-paymentvalidationerrors-paymentmethod"><code>paymentMethod</code></a>;</span>
};</span>

<span data-idl="" data-title="PayerErrors">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-payererrors"><code>PayerErrors</code></a> {<span data-idl="" data-title="email" data-dfn-for="PayerErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PayerErrors" data-link-type="dict-member" href="#dom-payererrors-email"><code>email</code></a>;</span><span data-idl="" data-title="name" data-dfn-for="PayerErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PayerErrors" data-link-type="dict-member" href="#dom-payererrors-name"><code>name</code></a>;</span><span data-idl="" data-title="phone" data-dfn-for="PayerErrors"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PayerErrors" data-link-type="dict-member" href="#dom-payererrors-phone"><code>phone</code></a>;</span>
};</span>

<span data-idl="" data-title="MerchantValidationEvent">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-merchantvalidationevent"><code>MerchantValidationEvent</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#event">Event</a></span> {<span data-idl="" data-title="constructor" data-dfn-for="MerchantValidationEvent">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="MerchantValidationEvent" data-lt="MerchantValidationEvent.constructor()|MerchantValidationEvent.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span>type</span>, optional<span> <a data-xref-type="_IDL_" href="#dom-merchantvalidationeventinit" data-link-type="idl"><code>MerchantValidationEventInit</code></a></span> <span>eventInitDict</span> = {});</span><span data-idl="" data-title="methodName" data-dfn-for="MerchantValidationEvent">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="MerchantValidationEvent" data-link-type="attribute" href="#dom-merchantvalidationevent-methodname"><code>methodName</code></a>;</span><span data-idl="" data-title="validationURL" data-dfn-for="MerchantValidationEvent">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a data-link-for="MerchantValidationEvent" data-link-type="attribute" href="#dom-merchantvalidationevent-validationurl"><code>validationURL</code></a>;</span><span data-idl="" data-title="complete" data-dfn-for="MerchantValidationEvent"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a data-link-for="MerchantValidationEvent" data-link-type="method" href="#dom-merchantvalidationevent-complete"><code>complete</code></a>(<span><a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> <span>merchantSessionPromise</span>);</span>
};</span>

<span data-idl="" data-title="MerchantValidationEventInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-merchantvalidationeventinit"><code>MerchantValidationEventInit</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="dictionary" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a></span> {<span data-idl="" data-title="methodName" data-dfn-for="MerchantValidationEventInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="MerchantValidationEventInit" data-link-type="dict-member" href="#dom-merchantvalidationeventinit-methodname"><code>methodName</code></a> = "";</span><span data-idl="" data-title="validationURL" data-dfn-for="MerchantValidationEventInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <a data-link-for="MerchantValidationEventInit" data-link-type="dict-member" href="#dom-merchantvalidationeventinit-validationurl"><code>validationURL</code></a> = "";</span>
};</span>

<span data-idl="" data-title="PaymentMethodChangeEvent">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentmethodchangeevent"><code>PaymentMethodChangeEvent</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentrequestupdateevent" data-link-type="idl"><code>PaymentRequestUpdateEvent</code></a></span> {<span data-idl="" data-title="constructor" data-dfn-for="PaymentMethodChangeEvent">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="PaymentMethodChangeEvent" data-lt="PaymentMethodChangeEvent.constructor()|PaymentMethodChangeEvent.constructor|constructor()|constructor"><code>constructor</code></dfn>(<span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span>type</span>, optional<span> <a data-xref-type="_IDL_" href="#dom-paymentmethodchangeeventinit" data-link-type="idl"><code>PaymentMethodChangeEventInit</code></a></span> <span>eventInitDict</span> = {});</span><span data-idl="" data-title="methodName" data-dfn-for="PaymentMethodChangeEvent">
  readonly attribute<span> <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentMethodChangeEvent" data-link-type="attribute" href="#dom-paymentmethodchangeevent-methodname"><code>methodName</code></a>;</span><span data-idl="" data-title="methodDetails" data-dfn-for="PaymentMethodChangeEvent">
  readonly attribute<span> <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a data-link-for="PaymentMethodChangeEvent" data-link-type="attribute" href="#dom-paymentmethodchangeevent-methoddetails"><code>methodDetails</code></a>;</span>
};</span>

<span data-idl="" data-title="PaymentMethodChangeEventInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentmethodchangeeventinit"><code>PaymentMethodChangeEventInit</code></a> : <span><a data-xref-type="_IDL_" href="#dom-paymentrequestupdateeventinit" data-link-type="idl"><code>PaymentRequestUpdateEventInit</code></a></span> {<span data-idl="" data-title="methodName" data-dfn-for="PaymentMethodChangeEventInit"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <a data-link-for="PaymentMethodChangeEventInit" data-link-type="dict-member" href="#dom-paymentmethodchangeeventinit-methodname"><code>methodName</code></a> = "";</span><span data-idl="" data-title="methodDetails" data-dfn-for="PaymentMethodChangeEventInit"><span>
  <a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-object">object</a>?</span> <a data-link-for="PaymentMethodChangeEventInit" data-link-type="dict-member" href="#dom-paymentmethodchangeeventinit-methoddetails"><code>methodDetails</code></a> = null;</span>
};</span>

<span data-idl="" data-title="PaymentRequestUpdateEvent">[<span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext">SecureContext</a></span>, <span><a data-xref-type="extended-attribute" data-cite-path="" data-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=<a data-xref-type="interface" data-cite-path="window-object.html" data-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a></span>]
interface <a data-link-for="" data-link-type="interface" href="#dom-paymentrequestupdateevent"><code>PaymentRequestUpdateEvent</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://dom.spec.whatwg.org/#event">Event</a></span> {<span data-idl="" data-title="constructor" data-dfn-for="PaymentRequestUpdateEvent">
  <a data-link-for="PaymentRequestUpdateEvent" data-link-type="constructor" href="#dom-paymentrequestupdateevent-constructor"><code>constructor</code></a>(<span><a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span>type</span>, optional<span> <a data-xref-type="_IDL_" href="#dom-paymentrequestupdateeventinit" data-link-type="idl"><code>PaymentRequestUpdateEventInit</code></a></span> <span>eventInitDict</span> = {});</span><span data-idl="" data-title="updateWith" data-dfn-for="PaymentRequestUpdateEvent"><span>
  <a data-xref-type="_IDL_" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-void">void</a></span> <a data-link-for="PaymentRequestUpdateEvent" data-link-type="method" href="#dom-paymentrequestupdateevent-updatewith"><code>updateWith</code></a>(<span><a data-xref-type="interface" data-cite-path="" data-type="interface" href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a data-xref-type="_IDL_" href="#dom-paymentdetailsupdate" data-link-type="idl"><code>PaymentDetailsUpdate</code></a>&gt;</span> <span>detailsPromise</span>);</span>
};</span>

<span data-idl="" data-title="PaymentRequestUpdateEventInit">dictionary <a data-link-for="" data-link-type="dictionary" href="#dom-paymentrequestupdateeventinit"><code>PaymentRequestUpdateEventInit</code></a> : <span><a data-xref-type="_IDL_" data-cite-path="" data-type="dictionary" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a></span> {};</span></pre></section>
    <section id="acknowledgements">
      <h2 id="b-acknowledgements"><bdi>B. </bdi>
        Acknowledgements
      <a aria-label="ยง" href="#acknowledgements"></a></h2>
      <p>
        This specification was derived from a report published previously by
        the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator
        Community Group</a>.
      </p>
    </section>
    <section id="changelog">
      <h2 id="c-changelog"><bdi>C. </bdi>Changelog<a aria-label="ยง" href="#changelog"></a></h2>
      
      <p>Changes from between CR2 until now:</p>
      <rs-changelog from="CR2" filter="removeCommits"><ul>
      <li><a href="https://github.com/w3c/payment-request/commit/a0c831d">Remove requirement to reject after document is inactive</a> (<a href="https://github.com/w3c/payment-request/pull/875">#875</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/6f2565b">Add PaymentRequest.prototype.hasEnrolledInstrument()</a> (<a href="https://github.com/w3c/payment-request/pull/833">#833</a>)</li>
      </ul></rs-changelog>
      <p>Changes from between CR1 and CR2:</p>
      <rs-changelog from="CR" to="CR2" filter="removeCommits"><ul>
      <li><a href="https://github.com/w3c/payment-request/commit/9a3c6d9">Changes stemming from privacy review:</a> (<a href="https://github.com/w3c/payment-request/pull/856">#856</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/0358fb3">Set [[waitForUpdate]] to true on dispatch of payerdetailchange</a> (<a href="https://github.com/w3c/payment-request/pull/857">#857</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/26fbcf9">Add privacy protection to MerchantValidationEvent's validationURL</a> (<a href="https://github.com/w3c/payment-request/pull/850">#850</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/76135b9">Describe privacy inplications of changing payment method</a> (<a href="https://github.com/w3c/payment-request/pull/849">#849</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/9dac110">Redact dependentLocality from shippingAddress</a> (<a href="https://github.com/w3c/payment-request/pull/846">#846</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/3f644f4">Changes resulting from 28 February PING privacy review</a> (<a href="https://github.com/w3c/payment-request/pull/843">#843</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/0bc0baa">Do .data IDL conversion in constructor</a> (<a href="https://github.com/w3c/payment-request/pull/829">#829</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/5966e82">Integrate with Feature Policy</a> (<a href="https://github.com/w3c/payment-request/pull/822">#822</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/5906b72">Remove regionCode attribute</a> (<a href="https://github.com/w3c/payment-request/pull/823">#823</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/5459933">Clarify retry() when errorFields are not passed</a> (<a href="https://github.com/w3c/payment-request/pull/825">#825</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/6b5e0ee">Attach 'payment request is showing boolean' to top-level browsing conโฆ</a></li><li><a href="https://github.com/w3c/payment-request/commit/a1e773a">Clarify when the user can abort the payment request algorithm</a> (<a href="https://github.com/w3c/payment-request/pull/810">#810</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/4937ad2">Warn when errorFields don't match request[[options]]</a> (<a href="https://github.com/w3c/payment-request/pull/807">#807</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/974d879">Support requesting billing address</a> (<a href="https://github.com/w3c/payment-request/pull/749">#749</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/1d5bcd8">Added section and paragraph on accessibility considerations</a> (<a href="https://github.com/w3c/payment-request/pull/802">#802</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/bf98afb">Change what canMakePayment() means</a> (<a href="https://github.com/w3c/payment-request/pull/806">#806</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/3fb7e37">Remove PaymentAddress' languageCode</a> (<a href="https://github.com/w3c/payment-request/pull/765">#765</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/277a385">Remove PaymentItem.type</a> (<a href="https://github.com/w3c/payment-request/pull/794">#794</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/7d48c6c">Merge branch 'gh-pages' of github.com:w3c/payment-request into gh-pages</a></li><li><a href="https://github.com/w3c/payment-request/commit/5498f93">Rename PayerErrorFields to PayerErrors</a> (<a href="https://github.com/w3c/payment-request/pull/789">#789</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/21bc47b">Code of Conduct</a></li><li><a href="https://github.com/w3c/payment-request/commit/4020346">Add paymentMethodErrors, payerErrors, to PaymentDetailsUpdate</a> (<a href="https://github.com/w3c/payment-request/pull/768">#768</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/384b538">Add MerchantValidationEvent.prototype.methodName</a> (<a href="https://github.com/w3c/payment-request/pull/776">#776</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/944f512">Add support for merchant validation</a> (<a href="https://github.com/w3c/payment-request/pull/751">#751</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/1816526">Support fine-grained errors for payment methods</a> (<a href="https://github.com/w3c/payment-request/pull/752">#752</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/0273c79">Add error member to PaymentValidationErrors</a> (<a href="https://github.com/w3c/payment-request/pull/747">#747</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/a0ff44f">Check doc fully active during response.complete()</a> (<a href="https://github.com/w3c/payment-request/pull/748">#748</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/3faf6a4">Drop prefixes, suffixes from error field members</a> (<a href="https://github.com/w3c/payment-request/pull/745">#745</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/feaf7de">prepare the manifest for Echidna publication</a></li><li><a href="https://github.com/w3c/payment-request/commit/ebd8310">Added information about redactList to privacy consideration</a> (<a href="https://github.com/w3c/payment-request/pull/738">#738</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/d27cc16">Add PaymentResponse.prototype.onpayerdetailchange</a> (<a href="https://github.com/w3c/payment-request/pull/724">#724</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/b417638">retry() interacting with abort the update</a> (<a href="https://github.com/w3c/payment-request/pull/723">#723</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/634a8a8">teach retry() about payerErrors</a> (<a href="https://github.com/w3c/payment-request/pull/721">#721</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/ee56f25">Define PaymentResponse.prototype.retry() method</a> (<a href="https://github.com/w3c/payment-request/pull/720">#720</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/b336891">add PaymentMethodChangeEvent event</a> (<a href="https://github.com/w3c/payment-request/pull/695">#695</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/10dc96e">Add fine-grained errors reporting for PaymentAddress</a> (<a href="https://github.com/w3c/payment-request/pull/712">#712</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/aa14e2f">Revert "editorial: relocate Algorithms section</a> (<a href="https://github.com/w3c/payment-request/pull/713">#713</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/f0018f9">add PaymentAddress.regionCode attribute</a> (<a href="https://github.com/w3c/payment-request/pull/690">#690</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/6b2aebc">remove currencySystem member</a> (<a href="https://github.com/w3c/payment-request/pull/694">#694</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/56a0c18">add redactList for PaymentAddress</a> (<a href="https://github.com/w3c/payment-request/pull/654">#654</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/d533b86">show() must be triggered by user activation</a></li><li><a href="https://github.com/w3c/payment-request/commit/22195c7">Feat: allow show() to take optional detailsPromise</a></li><li><a href="https://github.com/w3c/payment-request/commit/d891049">Feat: adds PaymentItemType enum + PaymentItem.type</a> (<a href="https://github.com/w3c/payment-request/pull/666">#666</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/0e4539d">Add localization hint for payment sheet</a> (<a href="https://github.com/w3c/payment-request/pull/656">#656</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/e65a217">Return event, because useful</a></li><li><a href="https://github.com/w3c/payment-request/commit/876a9cc">privacy: dont share line items</a> (<a href="https://github.com/w3c/payment-request/pull/670">#670</a>)</li><li><a href="https://github.com/w3c/payment-request/commit/72a62fc">Assure PaymentRequest.id is a UUID (closes #588)</a></li>
      </ul></rs-changelog>
    </section>
  

<section id="references">
      <h2 id="d-references"><bdi>D. </bdi>References<a aria-label="ยง" href="#references"></a></h2>
      
    <section id="normative-references">
        <h3 id="d-1-normative-references"><bdi>D.1 </bdi>Normative references<a aria-label="ยง" href="#normative-references"></a></h3>
      <dl>
        <dt id="bib-dom">[DOM]</dt><dd><a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a></dd><dt id="bib-e.164">[E.164]</dt><dd><a href="https://www.itu.int/rec/dologin_pub.asp?lang=e&amp;id=T-REC-E.164-201011-I!!PDF-E&amp;type=items"><cite>The international public telecommunication numbering plan</cite></a>.  ITU-T. November 2010. Recommendation. URL: <a href="https://www.itu.int/rec/dologin_pub.asp?lang=e&amp;id=T-REC-E.164-201011-I!!PDF-E&amp;type=items">https://www.itu.int/rec/dologin_pub.asp?lang=e&amp;id=T-REC-E.164-201011-I!!PDF-E&amp;type=items</a></dd><dt id="bib-ecma-402">[ecma-402]</dt><dd><a href="https://tc39.github.io/ecma402/"><cite>ECMAScript Internationalization API Specification</cite></a>.  Ecma International. URL: <a href="https://tc39.github.io/ecma402/">https://tc39.github.io/ecma402/</a></dd><dt id="bib-ecmascript">[ECMASCRIPT]</dt><dd><a href="https://tc39.es/ecma262/"><cite>ECMAScript Language Specification</cite></a>.  Ecma International. URL: <a href="https://tc39.es/ecma262/">https://tc39.es/ecma262/</a></dd><dt id="bib-feature-policy">[feature-policy]</dt><dd><a href="https://www.w3.org/TR/feature-policy-1/"><cite>Feature Policy</cite></a>. Ian Clelland.  W3C. 16 April 2019. W3C Working Draft. URL: <a href="https://www.w3.org/TR/feature-policy-1/">https://www.w3.org/TR/feature-policy-1/</a></dd><dt id="bib-html">[HTML]</dt><dd><a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jรคgenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a></dd><dt id="bib-infra">[infra]</dt><dd><a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a></dd><dt id="bib-iso3166-1">[ISO3166-1]</dt><dd><a href="https://www.iso.org/standard/63545.html"><cite>ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 1: Country codes</cite></a>.  International Organization for Standardization (ISO). November 2013. Published. URL: <a href="https://www.iso.org/standard/63545.html">https://www.iso.org/standard/63545.html</a></dd><dt id="bib-iso3166-2">[ISO3166-2]</dt><dd><a href="https://www.iso.org/standard/63546.html"><cite>ISO 3166: Codes for the representation of names of countries and their subdivisions โ Part 2: Country subdivision code.</cite></a>.  International Organization for Standardization (ISO). November 2013. Published. URL: <a href="https://www.iso.org/standard/63546.html">https://www.iso.org/standard/63546.html</a></dd><dt id="bib-iso4217">[ISO4217]</dt><dd><a href="http://www.iso.org/iso/home/standards/currency_codes.htm"><cite>Currency codes - ISO 4217</cite></a>.  ISO. 2015. International Standard. URL: <a href="http://www.iso.org/iso/home/standards/currency_codes.htm">http://www.iso.org/iso/home/standards/currency_codes.htm</a></dd><dt id="bib-payment-method-id">[payment-method-id]</dt><dd><a href="https://www.w3.org/TR/payment-method-id/"><cite>Payment Method Identifiers</cite></a>. Marcos Caceres; Domenic Denicola; Zach Koch; Roy McElmurry.  W3C. 5 September 2019. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/payment-method-id/">https://www.w3.org/TR/payment-method-id/</a></dd><dt id="bib-rfc2119">[RFC2119]</dt><dd><a href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a></dd><dt id="bib-rfc4122">[RFC4122]</dt><dd><a href="https://tools.ietf.org/html/rfc4122"><cite>A Universally Unique IDentifier (UUID) URN Namespace</cite></a>. P. Leach; M. Mealling; R. Salz.  IETF. July 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a></dd><dt id="bib-rfc8174">[RFC8174]</dt><dd><a href="https://tools.ietf.org/html/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc8174">https://tools.ietf.org/html/rfc8174</a></dd><dt id="bib-url">[url]</dt><dd><a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a></dd><dt id="bib-webidl">[WEBIDL]</dt><dd><a href="https://heycam.github.io/webidl/"><cite>Web IDL</cite></a>. Boris Zbarsky.  W3C. 15 December 2016. W3C Editor's Draft. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a></dd>
      </dl></section><section id="informative-references">
        <h3 id="d-2-informative-references"><bdi>D.2 </bdi>Informative references<a aria-label="ยง" href="#informative-references"></a></h3>
      <dl>
        <dt id="bib-fetch">[fetch]</dt><dd><a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a></dd><dt id="bib-payment-method-basic-card">[payment-method-basic-card]</dt><dd><a href="https://www.w3.org/TR/payment-method-basic-card/"><cite>Basic Card Payment</cite></a>. Adrian Bateman; Zach Koch; Roy McElmurry; Marcos Caceres.  W3C. 27 July 2017. W3C Working Draft. URL: <a href="https://www.w3.org/TR/payment-method-basic-card/">https://www.w3.org/TR/payment-method-basic-card/</a></dd><dt id="bib-rfc6454">[rfc6454]</dt><dd><a href="https://tools.ietf.org/html/rfc6454"><cite>The Web Origin Concept</cite></a>. A. Barth.  IETF. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a></dd><dt id="bib-secure-contexts">[secure-contexts]</dt><dd><a href="https://www.w3.org/TR/secure-contexts/"><cite>Secure Contexts</cite></a>. Mike West.  W3C. 15 September 2016. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/secure-contexts/">https://www.w3.org/TR/secure-contexts/</a></dd>
      </dl></section></section><p role="navigation" id="back-to-top"><a href="#title"><abbr title="Back to Top">โ</abbr></a></p>
</div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>