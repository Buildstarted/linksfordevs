<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Data WhiteOps collects - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Data WhiteOps collects - linksfor.dev(s)"/>
    <meta property="article:author" content="Smitop"/>
    <meta property="og:description" content="Today I noticed New Reddit was asking to use DRM. So I went on a source code analysis journey! See the main post for more details."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://smitop.com/post/whiteops-data/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Data WhiteOps collects</title>
<div class="readable">
        <h1>Data WhiteOps collects</h1>
            <div>by Smitop</div>
            <div>Reading time: 15-19 minutes</div>
        <div>Posted here: 09 Jul 2020</div>
        <p><a href="https://smitop.com/post/whiteops-data/">https://smitop.com/post/whiteops-data/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div><section itemscope="" itemtype="http://schema.org/Article" id="content">By  · <span itemprop="datePublished" content="2020-07-08">Jul 8, 2020</span> · 8 minute read<div><article itemprop="articleBody" id="content"><p>Today I noticed <a href="https://reddit.com/">New Reddit</a> was asking to use DRM. So I went on a source code analysis journey! See the <a href="https://smitop.com/post/reddit-whiteops.md">main post</a> for more details.</p><p>It appears Reddit uses <a href="https://whiteops.com/">White Ops</a> for fingerprinting and ad fraud prevention (but only sometimes, I think it’s an A/B test). See this beautified code:</p><div><pre><code data-lang="js"><span>const</span> <span>t</span> <span>=</span> <span>e</span>.<span>user</span>.<span>account</span> <span>?</span> <span>Jt</span>()(<span>e</span>.<span>user</span>.<span>account</span>.<span>id</span>).<span>toString</span>() <span>:</span> <span>void</span> <span>0</span>,
    <span>s</span> <span>=</span> document.<span>createElement</span>(<span>"script"</span>);
<span>s</span>.<span>src</span> <span>=</span> Object(<span>es</span>.<span>a</span>)(<span>"https://s.udkcrj.com/ag/386183/clear.js"</span>, {
    <span>dt</span><span>:</span> <span>"3861831591810830724000"</span>,
    <span>pd</span><span>:</span> <span>"acc"</span>,
    <span>mo</span><span>:</span> <span>0</span>,
    <span>et</span><span>:</span> <span>0</span>,
    <span>ti</span><span>:</span> <span>$t</span>()(),
    <span>ui</span><span>:</span> <span>t</span>,
    <span>si</span><span>:</span> <span>"d2x"</span>
}), document.<span>head</span>.<span>appendChild</span>(<span>s</span>)
</code></pre></div><p>This code is only run if the <code>show_white_ops</code> feature flag is enabled (don’t know how to force this to be true), which is why I assume the tracking is done by <a href="https://www.whiteops.com/">WhiteOps</a>.
Further research into the <code>https://s.udkcrj.com/ag/386183/clear.js</code> file reveals that it ends up loading another script, <code>https://s.udkcrj.com/2/4.71.0/main.js</code>. For reference, here is <a href="https://smitop.com/whiteops-main.js">the beautified source code I saw and analyzed</a>.</p><p>Note: here is a function I used to deobfuscate many strings in the code:</p><div><pre><code data-lang="js"><span>const</span> <span>deob</span> <span>=</span> <span>x</span> =&gt; <span>x</span>.<span>replace</span>(<span>/[A-Za-z]/g</span>, <span>function</span>(<span>e</span>) {
    <span>return</span> String.<span>fromCharCode</span>(<span>e</span>.<span>charCodeAt</span>(<span>0</span>) <span>+</span> (<span>e</span>.<span>toUpperCase</span>() <span>&lt;=</span> <span>"M"</span> <span>?</span> <span>13</span> <span>:</span> <span>-</span><span>13</span>))
})
</code></pre></div><p>Note 2: Ozoki appears to be some sort of internal codename used by WhiteOps.</p><p>This very obfuscated script does many things, including (this is an incomplete list, I have missed many things):</p><ul><li>Communicates with <code>vprza.com</code> and <code>minkatu.com</code></li><li>Does device/OS detection</li><li>Attempts to detect if DevTools is open (looks at <code>__IE_DEVTOOLBAR_CONSOLE_COMMAND_LINE</code>)</li><li>Something weird with the <code>text-underline-offset</code> CSS property</li><li>Has the names of a bunch of ad servers, presumably as to not serve ads to bots</li><li>Attempts to create an <code>ActiveXObject</code> (only exists in old IE versions), and checks if the created ActiveX object <code>isSandboxed</code></li><li>Checks for <code>maxConnectionsPerServer</code> and <code>onhelp</code> properties on <code>window</code> (for browser engine detection I think)</li><li>Attempts to exploit an IE11 vuln!<ul><li>it checks the value of <code>document.documentMode</code>, which in IE11 is <code>11</code>. If it is, then it runs the obfuscated code:</li></ul></li></ul><div><pre><code data-lang="js"><span>// o == document.documentMode == 11
</span><span></span><span>"}o|B65niitbmd,ahg)Z[i$_g"</span>.<span>replace</span>(<span>/./g</span>, <span>function</span>(<span>e</span>) {
    <span>return</span> String.<span>fromCharCode</span>(<span>e</span>.<span>charCodeAt</span>(<span>0</span>) <span>-</span> <span>o</span><span>--</span>)
})
</code></pre></div><ul><li>this evaluates to <code>res://ieframe.dll/acr.js</code>, but only on IE. This string has only one purpose, exploiting the fact that you can put arbitrary HTML in the hash part of the URL and have it get evaluated, I beleive in a privledged context of some sort. This file actually resolves in IE to a internal Windows system file, which is only accessible in JS due to a bug.</li><li>tries to run VBScript:</li></ul><div><pre><code data-lang="js"><span>execScript</span>(<span>"e71012934811a=false::On Error Resume Next::"</span> <span>+</span> <span>e</span> <span>+</span> <span>"::if Err.Number=-2147024891 or Err.Number=5002 then e71012934811a=true::Err.Clear"</span>, <span>"VBScript"</span>), <span>t</span> <span>=</span> <span>"e71012934811a"</span> <span>in</span> window <span>?</span> window.<span>e71012934811a</span> <span>?</span> <span>o</span>.<span>EXISTS</span> <span>:</span> <span>o</span>.<span>MISSING</span> <span>:</span> <span>o</span>.<span>UNKNOWN</span>
</code></pre></div><ul><li>checks for these strings on window (de-obfuscated, I also have the original obfuscated ones in case you are also looking through the source):<ul><li><code>boltsWebViewAppLinkResolverResult</code>, <code>GoogleJsInterface</code>, <code>googleAdsJsInterface</code>, <code>accessibilityTraversal</code>, <code>accessibility</code>, <code>FbPlayableAd</code>, <code>__REACT_WEB_VIEW_BRIDGE</code></li><li>obfuscated in code as <code>obygfJroIvrjNccYvaxErfbyireErfhyg</code>, <code>TbbtyrWfVagresnpr</code>, <code>tbbtyrNqfWfVagresnpr</code>, <code>npprffvovyvglGenirefny</code>, <code>npprffvovyvgl</code>, <code>SoCynlnoyrNq</code>, <code>__ERNPG_JRO_IVRJ_OEVQTR</code></li></ul></li><li>checks the screen’s <code>availHeight</code>, <code>availWidth</code>, <code>width</code>, and `height</li><li>checks the screen’s <code>colorDepth</code>, <code>pixelDepth</code>, and <code>devicePixelRatio</code></li><li>checks for these automation-related properties on <code>window</code>: <code>domAutomation</code>, <code>domAutomationController</code>, <code>_WEBDRIVER_ELEM_CACHE</code>, <code>_phantom</code>, <code>callPhantom</code>, <code>window.chrome._commandLineAPI</code>, <code>window.Debug.debuggerEnabled</code>, <code>__BROWSERTOOLS_CONSOLE</code>, <code>window._FirebugCommandLine</code>, and also if <code>document.documentElement.hasAttribute("webdriver")</code> is true</li><li>checks if <code>"function () { return Function.apply.call(x.log, x, arguments); }" == window.console.log.toString()</code> (also to check for browser automation I guess</li><li>tries to check if the browser is headless with <code>isExternalUrlSafeForNavigation</code>, <code>window.opera._browserjsran</code>, <code>window.opera.browserjsran</code></li><li>checks if <code>navigator.onLine</code> is true</li><li>check the <code>window.chrome</code> object if in Chrome</li><li>extracts data from <code>window.FirefoxInterfaces("wdICoordinate", "wdIMouse", "wdIStatus")</code></li><li>checks if <code>window.XPCOMUtils</code> exists</li><li>checks if <code>window.netscape.security.privilegemanager</code> exists</li><li>appears to check browser console timing</li><li>checks referer against <code>"https://www.google.com", "https://apps.skype.com", "http://apps.skype.com", "https://www.youtube.com", "http://en.wikipedia.org/", "https://en.wikipedia.org/", "https://www.netflix.com", "http://www.netflix.com", "http://www3.oovoo.com"</code></li><li>checks for these properties in <code>window.external</code>: <code>["AddChannel", "AddDesktopComponent", "AddFavorite", "AddSearchProvider", "AddService", "AddToFavoritesBar", "AutoCompleteSaveForm", "AutoScan", "bubbleEvent", "ContentDiscoveryReset", "ImportExportFavorites", "InPrivateFilteringEnabled", "IsSearchProviderInstalled", "IsServiceInstalled", "IsSubscribed", "msActiveXFilteringEnabled", "msAddSiteMode", "msAddTrackingProtectionList", "msClearTile", "msEnableTileNotificationQueue", "msEnableTileNotificationQueueForSquare150x150", "msEnableTileNotificationQueueForSquare310x310", "msEnableTileNotificationQueueForWide310x150", "msIsSiteMode", "msIsSiteModeFirstRun", "msPinnedSiteState", "msProvisionNetworks", "msRemoveScheduledTileNotification", "msReportSafeUrl", "msScheduledTileNotification", "msSiteModeActivate", "msSiteModeAddButtonStyle", "msSiteModeAddJumpListItem", "msSiteModeAddThumbBarButton", "msSiteModeClearBadge", "msSiteModeClearIconOverlay", "msSiteModeClearJumpList", "msSiteModeCreateJumpList", "msSiteModeRefreshBadge", "msSiteModeSetIconOverlay", "msSiteModeShowButtonStyle", "msSiteModeShowJumpList", "msSiteModeShowThumbBar", "msSiteModeUpdateThumbBarButton", "msStartPeriodicBadgeUpdate", "msStartPeriodicTileUpdate", "msStartPeriodicTileUpdateBatch", "msStopPeriodicBadgeUpdate", "msStopPeriodicTileUpdate", "msTrackingProtectionEnabled", "NavigateAndFind", "raiseEvent", "setContextMenu", "ShowBrowserUI", "menuArguments", "onvisibilitychange", "scrollbar", "selectableContent", "version", "visibility", "mssitepinned", "AddUrlAuthentication", "CloseRegPopup", "FeatureEnabled", "GetJsonWebData", "GetRegValue", "Log", "LogShellErrorsOnly", "OpenPopup", "ReadFile", "RunGutsScript", "SaveRegInfo", "SetAppMaximizeTimeToRestart", "SetAppMinimizeTimeToRestart", "SetAutoStart", "SetAutoStartMinimized", "SetMaxMemory", "ShareEventFromBrowser", "ShowPopup", "ShowRadar", "WriteFile", "WriteRegValue", "summonWalrus"</code> and also <code>"AddSearchProvider", "IsSearchProviderInstalled", "QueryInterface", "addPanel", "addPersistentPanel", "addSearchEngine"</code></li><li>checks <code>maxConnectionsPerServer</code> (on Window I think)</li><li>attempts to detect Brave Browser with <code>window.brave</code></li><li>checks for a bunch more properties on <code>window</code>:</li></ul><div><pre><code data-lang="js">                <span>m</span>(<span>"document_referrer"</span>, <span>h</span>), <span>m</span>(<span>"performance_timing"</span>, <span>h</span>, <span>function</span>(<span>e</span>) {
                    <span>return</span> <span>x</span>.<span>qKjvb</span>(<span>e</span>)
                }), <span>m</span>(<span>"maxConnectionsPerServer"</span>, <span>h</span>), <span>m</span>(<span>"status"</span>, <span>h</span>), <span>m</span>(<span>"defaultStatus"</span>, <span>h</span>), <span>m</span>(<span>"performance_memory"</span>, <span>h</span>, <span>_</span>.<span>flatten</span>), <span>m</span>(<span>"screen"</span>, <span>h</span>, <span>function</span>(<span>e</span>) {
                    <span>return</span> <span>e</span> <span>||</span> {}
                }), <span>m</span>(<span>"devicePixelRatio"</span>, <span>h</span>), <span>m</span>(<span>"mozPaintCount"</span>, <span>h</span>), <span>m</span>(<span>"styleMedia_type"</span>, <span>h</span>), <span>m</span>(<span>"history_length"</span>, <span>h</span>), <span>m</span>(<span>"opener"</span>, <span>h</span>, <span>"top_opener"</span>, <span>function</span>(<span>e</span>) {
                    <span>return</span> <span>null</span> <span>!==</span> <span>e</span> <span>?</span> <span>typeof</span> <span>e</span> <span>:</span> <span>"null"</span>
                }), <span>m</span>(<span>"navigator_userAgent"</span>, <span>h</span>), <span>m</span>(<span>"fileCreatedDate"</span>, <span>h</span>), <span>m</span>(<span>"fileModifiedDate"</span>, <span>h</span>), <span>m</span>(<span>"fileUpdatedDate"</span>, <span>h</span>), <span>m</span>(<span>"lastModified"</span>, <span>h</span>), <span>m</span>(<span>"location_href"</span>, <span>h</span>), <span>m</span>(<span>"RemotePlayback"</span>, <span>h</span>), <span>m</span>(<span>"Permissions"</span>, <span>h</span>), <span>m</span>(<span>"Notification"</span>, <span>h</span>), <span>m</span>(<span>"MediaSession"</span>, <span>h</span>), <span>m</span>(<span>"name"</span>, <span>h</span>, <span>function</span>(<span>e</span>) {
                    <span>return</span> <span>e</span>.<span>substr</span>(<span>0</span>, <span>128</span>)
                }), <span>m</span>(<span>"defaultView"</span>, <span>h</span>, <span>"document_defaultView"</span>, <span>function</span>(<span>e</span>) {
                    <span>return</span> <span>void</span> <span>0</span> <span>===</span> <span>e</span> <span>?</span> <span>"undefined"</span> <span>:</span> <span>e</span> <span>===</span> window
                }), <span>m</span>(<span>"console"</span>, <span>h</span>, <span>_</span>.<span>flatten</span>), <span>m</span>(<span>"localStorage"</span>, <span>h</span>, <span>v</span>), <span>m</span>(<span>"webkitNotifications"</span>, <span>h</span>, <span>v</span>), <span>m</span>(<span>"webkitAudioContext"</span>, <span>h</span>, <span>v</span>), <span>m</span>(<span>"chrome"</span>, <span>h</span>, <span>k</span>.<span>Keys</span>), <span>m</span>(<span>"opera"</span>, <span>h</span>, <span>k</span>.<span>Keys</span>), <span>m</span>(<span>"navigator_standalone"</span>, <span>h</span>), <span>m</span>(<span>"navtype"</span>, <span>h</span>, <span>"performance_navigation_type"</span>), <span>m</span>(<span>"navredirs"</span>, <span>h</span>, <span>"performance_navigation_redirectCount"</span>), <span>m</span>(<span>"loadTimes"</span>, <span>h</span>, <span>"chrome_loadTimes"</span>), <span>m</span>(<span>"vendor"</span>, <span>h</span>, <span>"navigator_vendor"</span>), <span>m</span>(<span>"codename"</span>, <span>h</span>, <span>"navigator_appCodeName"</span>), <span>m</span>(<span>"navWebdriver"</span>, <span>h</span>, <span>"navigator_webdriver"</span>), <span>m</span>(<span>"navLanguages"</span>, <span>h</span>, <span>"navigator_languages"</span>), <span>m</span>(<span>"ServiceWorker"</span>, <span>h</span>), <span>m</span>(<span>"ApplePaySetup"</span>, <span>h</span>), <span>m</span>(<span>"ApplePaySession"</span>, <span>h</span>), <span>m</span>(<span>"Cache"</span>, <span>h</span>), <span>m</span>(<span>"PaymentAddress"</span>, <span>h</span>), <span>m</span>(<span>"MerchantValidationEvent"</span>, <span>h</span>), <span>m</span>(<span>"mediaDevices"</span>, <span>h</span>, <span>"navigator_mediaDevices"</span>), <span>m</span>(<span>"share"</span>, <span>h</span>, <span>"navigator_share"</span>), <span>m</span>(<span>"onorientationchange"</span>, <span>h</span>), <span>m</span>(<span>"document_defaultView_safari"</span>, <span>h</span>), <span>m</span>(<span>"navigator_brave"</span>, <span>h</span>), <span>m</span>(<span>"navigator_brave_isBrave"</span>, <span>h</span>), <span>le</span>.<span>hco</span> <span>&amp;&amp;</span> <span>m</span>(<span>"navHardwareConc"</span>, <span>h</span>, <span>"navigator_hardwareConcurrency"</span>), <span>le</span>.<span>ndm</span> <span>&amp;&amp;</span> <span>m</span>(<span>"navDevMem"</span>, <span>h</span>, <span>"navigator_deviceMemory"</span>), <span>le</span>.<span>nvl</span> <span>&amp;&amp;</span> (<span>m</span>(<span>"navLocks"</span>, <span>h</span>, <span>"navigator_locks"</span>, <span>function</span>(<span>e</span>) {
                    <span>var</span> <span>t</span> <span>=</span> <span>typeof</span> <span>e</span>;
                    <span>return</span> <span>"undefined"</span> <span>===</span> <span>t</span> <span>?</span> <span>"undefined"</span> <span>:</span> <span>"object"</span> <span>===</span> <span>t</span> <span>?</span> <span>"obj"</span> <span>:</span> <span>e</span>
                }), <span>m</span>(<span>"navLocksR"</span>, <span>h</span>, <span>"navigator_locks_request"</span>, <span>function</span>(<span>e</span>) {
                    <span>return</span> <span>"undefined"</span> <span>===</span> <span>typeof</span> <span>e</span> <span>?</span> <span>"undefined"</span> <span>:</span> <span>e</span>
                })), <span>le</span>.<span>wor</span> <span>&amp;&amp;</span> <span>m</span>(<span>"origin"</span>, <span>h</span>, <span>"origin"</span>), <span>"object"</span> <span>==</span> <span>typeof</span> <span>location</span> <span>&amp;&amp;</span> <span>m</span>(<span>"protocol"</span>, <span>location</span>), <span>"object"</span> <span>==</span> <span>typeof</span> document <span>&amp;&amp;</span> (<span>m</span>(<span>"hidden"</span>, document), <span>m</span>(<span>"documentMode"</span>, document), <span>m</span>(<span>"compatMode"</span>, document), <span>m</span>(<span>"visibilityState"</span>, document), <span>m</span>(<span>"d_origin"</span>, document, <span>"origin"</span>), <span>m</span>(<span>"ddl_origin"</span>, document, <span>"defaultView_location_origin"</span>));
</code></pre></div><ul><li>checks <code>mozIsLocallyAvailable</code> (which is only available on FF &lt;= 35, and could be for checking if someone is trying to debug this script offline)</li><li>checks how rounding of large and small numbers works, with <code>Math.round(.49999999999999994)</code> and <code>Math.round(Math.pow(2, 52))</code></li><li>checks the installed plugins (with <code>navigator.plugins</code>)</li><li>checks the browser viewport</li><li>attempts to get the “frame depth” (not sure what exactly that is)</li><li>checks for various status bars on <code>window</code> (<code>"locationbar", "menubar", "personalbar", "scrollbars", "statusbar", "toolbar"</code>)</li><li>checks for <code>window.showModalDialog</code></li><li>checks the <code>-webkit-text-size-adjust</code> property</li><li>checks if using <code>xx-small</code> as a font size works</li><li>Checks if image loading is enabled, by trying to load a 1x1 GIF</li><li>Tries to load an image with a URL of <code>https:/</code>, and checking if it loaded or errored</li><li>Checks the stringification o</li><li>checks for these properties on <code>window</code>: <code>StorageItem AnimationTimeline MSFrameUILocalization HTMLDialogElement mozCancelRequestAnimationFrame SVGRenderingIntent SQLException WebKitMediaKeyError SVGGeometryElement SVGMpathElement Permissions devicePixelRatio GetSVGDocument HTMLHtmlElement CSSCharsetRule ondragexit MediaSource external DOMMatrix InternalError ArchiveRequest ByteLengthQueuingStrategy ScreenOrientation onwebkitwillrevealbottom onorientationchange WebKitGamepad GeckoActiveXObject mozInnerScreenX WeakSet PaymentRequest Generator BhxWebRequest oncancel fluid media onmousemove HTMLCollection OpenWindowEventDetail FileError SmartCardEvent guest CSSConditionRule showModelessDialog SecurityPolicyViolationEvent EventSource ServiceWorker EventTarget origin VRDisplay onpointermove HTMLBodyElement vc2hxtaq9c TouchEvent DeviceStorage DeviceLightEvent External webkitPostMessage HTMLAppletElement ErrorEvent URLSearchParams BluetoothRemoteGATTDescriptor RTCStatsReport EventException PERSISTENT MediaKeyStatusMap HTMLOptionsCollection dolphinInfo MSGesture SVGPathSegLinetoRel webkitConvertPointFromNodeToPage doNotTrack CryptoDialogs HTMLPictureElement MediaController</code></li><li>checks for these CSS properties: <code>scroll-snap-coordinate flex-basis webkitMatchNearestMailBlockquoteColor MozOpacity textOverflow position columns msTextSizeAdjust animationDuration msImeAlign webkitBackgroundComposite MozTextAlignLast MozOsxFontSmoothing borderRightStyle webkitGridRow cssText parentRule webkitShapeOutside justifySelf isolation -moz-column-fill offsetRotation overflowWrap OAnimationFillMode borderRight border-inline-start-color webkitLineSnap MozPerspective touchAction enableBackground borderImageSource MozColumnFill webkitAnimationFillMode MozOSXFontSmoothing XvPhonemes length webkitFilter webkitGridAutoColumns</code></li><li>checks the stringification of native functions, and verifies some functions are implemented in native code (including <code>performance.mark</code>, and <code>Function.prototype.toString</code> itself)</li><li>attempts to get the width of the string <code>mmmmmmmmmmlli</code> in all of these fonts: <code>"Ubuntu", "Utopia", "URW Gothic L", "Bitstream Charter", "FreeMono", "DejaVu Sans", "Droid Serif", "Liberation Sans", "Vrinda", "Kartika", "Sylfaen", "CordiaUPC", "Angsana New Bold Italic", "DFKai-SB", "Ebrima", "Lao UI", "Segoe UI Symbol", "Vijaya", "Roboto", "Apple Color Emoji", "Baskerville", "Marker Felt", "Apple Symbols", "Chalkboard", "Herculanum", "Skia", "Bahnschrift", "Andalus", "Yu Gothic", "Aldhabi", "Calibri Light"</code></li><li>checks various user agent properties in <code>navigator</code></li><li>Listens to the <code>voiceschanged</code> event, and keeps track of what text-to-speech voices are available</li><li>Attempts to load <code>chrome://browser/skin/feeds/feedIcon.png</code> (I think this used to be an RSS icon in old Firefox versions)</li><li>checks for scripts injected into the page</li><li>checks availble video codecs and formats: <code>'video/mp4;codecs="avc1.42E01E, mp4a.40.2"', 'video/mp4;codecs="avc1.58A01E, mp4a.40.2"', 'video/mp4;codecs="avc1.4D401E, mp4a.40.2"', 'video/mp4;codecs="avc1.64001E, mp4a.40.2"', 'video/mp4;codecs="mp4v.20.8, mp4a.40.2"', 'video/mp4;codecs="mp4v.20.240, mp4a.40.2"', 'video/3gpp;codecs="mp4v.20.8, samr"', 'video/ogg;codecs="theora, vorbis"', 'video/ogg;codecs="theora, speex"', "audio/ogg;codecs=vorbis", "audio/ogg;codecs=speex", "audio/ogg;codecs=flac", 'video/ogg;codecs="dirac, vorbis"', 'video/x-matroska;codecs="theora, vorbis"', 'video/mp4; codecs="avc1.42E01E"', 'audio/mp4; codecs="mp4a.40.2"', 'audio/mpeg;codecs="mp3"', 'video/webm; codecs="vorbis,vp8"'</code></li><li>checks for <code>window.$cdc_asdjflasutopfhvcZLmcfl_</code> (property used by Chrome Webdriver) (obfuscated as <code>"$" + x.qKjBI("pqp") + "_" + x.qKjBI("nfqwsynfhgbcsuipMYzpsy") + "_"</code>)</li><li>gets WEBGL_debug_renderer_info, which contains GPU-specific info</li><li>tries to detect if <code>IntersectionObserver</code> returns correct data</li><li>checks what DRM solutions are available (although doesn’t actaully use them, this is what causes the DRM popup in Firefox): looks for Widevine, PlayReady, Clearkey, and Primetime</li><li>Attempts to load files stored in Chrome extension’s data (presumably to detect if they are installed):</li></ul><pre><code>chrome-extension://ianldemdppnbbojbafdkpdofceajhica/img/info.svg
chrome-extension://elfchnpigjboibngodkiamfemllklmge/img/info.svg
chrome-extension://npfnhmfcalmmkbpgkhjpdaiajfdhpndm/img/info.svg
chrome-extension://pfobdhfgohkddopcdbifhccbbpjlakaa/img/info.svg
chrome-extension://gfpioeglfjecbkeeomdidlndcagpbmj/img/info.svg
chrome-extension://mnbkfnehljejnebgbgfhdkmjicgmangi/img/info.svg
chrome-extension://adcggpckpldlkcobapimobdijchkigmb/img/info.svg
chrome-extension://poifgggpiofkbhafbjljpbbajafcjafi/img/info.svg
chrome-extension://plkjhgplpjlokmchnngcaeneiigkipeb/img/info.svg
chrome-extension://hhhpajpnecmhngfgkclokcghcpfgbape/img/info.svg
chrome-extension://cnncicmafnkgbonafdjnikijbhjkeink/img/info.svg
chrome-extension://aoeceebmempjbabimmnfkeeioccbjkea/img/info.svg
chrome-extension://pbclflhfplnkbgfokopkmjpejkokcaec/img/info.svg
chrome-extension://pogfikdkppcfejpknaclddnpcjjbalbn/img/info.svg
chrome-extension://mdjpmjaonahjbjncdlkjgeggjfdnnmme/img/info.svg
chrome-extension://cefomhonapiagddecgpooacpnoomabne/img/info.svg
chrome-extension://iokdapkmdldpeomcloobkajedcdleoib/img/info.svg
chrome-extension://cndipecijohebobplligphncocjamhei/content/images/icons/16.png
chrome-extension://lmpknllkkhpbfahgbkgjgopandmdbopi/blocked-notification-bar.html
chrome-extension://blddopfbnibgpgfeheedhjaheikanamn/img/128x128g.png
chrome-extension://nfjcghppefdfgmnblhgelkjhmljpndhh/img/icon16.png
</code></pre><ul><li>checks if the source code of <code>window.close</code> (which is normally <code>[native code]</code>) contains <code>ELECTRON</code></li><li>there is the string “haha jit go brrrrr”, as part of what appears to be some sort of either test for a JS engine bug or exploit</li><li>collects performance data</li><li>checks if Safari is creating a “Web clip” screenshot of the page</li></ul></article></div></section></div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>