<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Successfully Deploying An InProcess ASP.NET Core 2.2 App To Azure -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Successfully Deploying An InProcess ASP.NET Core 2.2 App To Azure</h1><div><div id="" class=""><p class="freshness" data-freshness-datetime="2019-01-21T10:39:51-05:00"><i class="icon heartbeat freshness-icon-js"></i><em>This post is <span class="freshness-days-old-js"></span> days old.</em></p><h2 id="updated-solution">Updated Solution!</h2><p>So after publishing this post, a nice individual by the name of Mickaël suggested that the <code class="language-plaintext highlighter-rouge">dotnet-cli</code> automatically creates this web.config based on the the <code class="language-plaintext highlighter-rouge">csproj</code> settings. It does indeed work! I do suggest you make sure you are on the latest <code class="language-plaintext highlighter-rouge">SDK</code> of <code class="language-plaintext highlighter-rouge">2.2.100</code> or else you won’t see the results you are looking for.</p><p>Note: The build process may suggest that you <em>do not</em> include the version number in your PackageReference. I was not able to get Azure to successfully load the ASP.NET Core application without specifiying the package version of <code class="language-plaintext highlighter-rouge">2.2.1</code>. Try it both ways and see what happens.</p><p>Thanks again to the folks who read and suggest better solutions.</p><hr><p>The year is 2019, and you’ve decided to live on the bleeding edge at the intersection of ASP.NET Core and Windows Azure. ASP.NET Core delivered <code class="language-plaintext highlighter-rouge">InProcess</code> hosting With the release of ASP.NET Core 2.2, which means our applications can take full advantage of IIS resources and be hosted in the IIS Process itself. This post will show you the steps you need to take to make your ASP.NET Core Application work in Azure.</p><h2 id="step-1-update-microsoftaspnetcoreapp">Step 1: Update Microsoft.AspNetCore.App</h2><p>You will need the latest version of <code class="language-plaintext highlighter-rouge">Microsoft.AspNetCore.App</code> which is 2.2.1 as of this post. Once installed via NuGet, you should have a package reference like so:</p><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;PackageReference</span><span class="na">Include=</span><span class="s">"Microsoft.AspNetCore.App"</span><span class="na">Version=</span><span class="s">"2.2.1"</span><span class="nt">/&gt;</span></code></pre></div></div><h2 id="step-2-add-a-webconfig">Step 2: Add A Web.Config</h2><p>This is where you may be scratching your head. Why do I need a <code class="language-plaintext highlighter-rouge">web.config</code>. While the application may be ASP.NET Core, it is hosted in IIS which still uses configuration files.</p><p>This configuration file test IIS to use the correct module when running the ASP.NET Core application. <strong>The web.config is critical</strong>.</p><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="nt">&lt;configuration&gt;</span><span class="nt">&lt;location</span><span class="na">path=</span><span class="s">"."</span><span class="na">inheritInChildApplications=</span><span class="s">"false"</span><span class="nt">&gt;</span><span class="nt">&lt;system.webServer&gt;</span><span class="nt">&lt;handlers&gt;</span><span class="nt">&lt;add</span><span class="na">name=</span><span class="s">"aspNetCore"</span><span class="na">path=</span><span class="s">"*"</span><span class="na">verb=</span><span class="s">"*"</span><span class="na">modules=</span><span class="s">"AspNetCoreModuleV2"</span><span class="na">resourceType=</span><span class="s">"Unspecified"</span><span class="nt">/&gt;</span><span class="nt">&lt;/handlers&gt;</span><span class="nt">&lt;aspNetCore</span><span class="na">processPath=</span><span class="s">"dotnet"</span><span class="err">&lt;!--</span><span class="err">Your</span><span class="err">Application</span><span class="err">Dll</span><span class="err">Goes</span><span class="err">Here</span><span class="err">--</span><span class="nt">&gt;</span>
                        arguments=".\MyApp.dll"
                        stdoutLogEnabled="false"
                        stdoutLogFile=".\logs\stdout"
                        hostingModel="InProcess" /&gt;
        <span class="nt">&lt;/system.webServer&gt;</span><span class="nt">&lt;/location&gt;</span><span class="nt">&lt;/configuration&gt;</span></code></pre></div></div><p>The reason we need a <code class="language-plaintext highlighter-rouge">web.config</code> is due to the handler element, which is set to <code class="language-plaintext highlighter-rouge">AspNetCoreModuleV2</code>.</p><h2 id="step-3-enable-aspnet-core-logging-extensions">Step 3: Enable ASP.NET Core Logging Extensions</h2><p>If you’re hosting in App Services, be sure to install the ASP.NET Core Logging Extensions. It will help you debug issues more easily by enabling the <code class="language-plaintext highlighter-rouge">Diagnostic logs</code> feature in your App Service instance.</p><h2 id="conclusion">Conclusion</h2><p>There you have it. Your ASP.NET Core application is ready to be hosted <code class="language-plaintext highlighter-rouge">InProcess</code> and utilize IIS. You should see a nice performance boost and faster startup times as well.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>