<!DOCTYPE html>
<html lang="en">
<head>
    <title>linksfor.dev(s)</title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <div class="readable">
        <h1>This is relevant only for multimedia apps. I have fintech systems in production... | Hacker News</h1>
        <p>
Reading time: 13-16 minutes        </p>
        <p><a href="https://news.ycombinator.com/item?id=22249230">https://news.ycombinator.com/item?id=22249230</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
            <tbody><tr id="22250650"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22250650" href="https://news.ycombinator.com/vote?id=22250650&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>Thank you for this post. I read "10 Users: Split out the Database Layer" and about had an aneurysm.<p>I also work with fintech systems built upon .NET Core and have similar experiences regarding scaling of these solutions. You can get an incredible amount of throughput from a single box if you are careful with the technologies you use.</p><p>A single .NET Core web API process using Kestrel and whatever RDBMS (even SQLite) can absolutely devour requests in the &lt;1 megabyte range. I would feel confident putting the largest customer we can imagine x10 on a single 16~32 core server for the solution we provide today. Obviously, if you are pushing any form of multimedia this starts to break down rapidly.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
        <tr id="22255031"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22255031" href="https://news.ycombinator.com/vote?id=22255031&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>As someone that uses Python and Django most of the time (a "slow" language), I haven't seen much in the way of performance problems at the application level. Usually some database optimization will do the trick.<p>Actually thinking about it- I have inherited plenty of performance problems at the application layer, but that's because the joins were effectively being done at the application level (and making huge numbers of database calls) when they should have been done at the database layer.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
    <tr id="22251344"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22251344" href="https://news.ycombinator.com/vote?id=22251344&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>It seems like they recommend splitting out the database at the start because using a managed service is much easier than properly managing your own production database.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22251762"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td><center><a id="up_22251762" href="https://news.ycombinator.com/vote?id=22251762&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>I can't speak for high performance/near or realtime system people but I would not trust a managed database service for those needs. My experience is that the managed offerings lag behind upstream versions substantially and usually are economical because they are multitenant. So you have a bit less predictability in io wait / cpu queue, lose host kernel level tunings (page sizes or hugepages, share memory allocation, etc), and - not naming names - some managed db services are so behind they lack critical query planner profiling features. That's not even going into application workload specific tuning for various nosql stores. This is a nice article but its audience is people that haven't scaled up a system but are trying to cope with success. It's not great generalized scaling advice.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22253221"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="120"></td><td><center><a id="up_22253221" href="https://news.ycombinator.com/vote?id=22253221&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Those all sound like concerns that probably aren't your top priority when you have 10 users unless your product is performance critical, and then none of this guidance applies anyway. When you have 10 users, your database concerns are more likely to be: Is my database up? Is my database secured? Do I have automated backups? Am I otherwise at risk of losing data? Is the database fast enough for now to not be a blocker to my business? All of which are concerns that tend to be well covered by managed database services.</span></p></div></td></tr>
      </tbody></table></td></tr>
    <tr id="22252253"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="120"></td><td><center><a id="up_22252253" href="https://news.ycombinator.com/vote?id=22252253&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>All I will say is that our latency getting a business entity in or out of a SQLite database (running on top of NVMe flash) is on the order of tens to hundreds of microseconds. There will never be a hosted/cloud offering that can even remotely approach this without installing some "bring the cloud to you" appliance in your datacenter.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22252744"><td>
            </td></tr>
          <tr id="22265294"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22265294" href="https://news.ycombinator.com/vote?id=22265294&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>I think we also should be more clear with "10 Users". What does he/she mean? What do we mean?<p>It could be 10 users that each views a few web pages once every month or it could be 10 heavy users for an internal system that uses the system most of the working day and creates thousands of calls per user to the system each day.</p><p>It is as a lot of people have mentioned also very different with information that can be easily cached and things like monetary transactions where you don't want to see old data in reads and therefore often can't cache or use read replica db.</p><p>For systems with heavy users I have seen the need to use a few servers even with just 1000 - 2000 users. For a web system the same can happen if you have 1000 users active on the site at the same time (within a minute or so).
              </p></span></p></td></tr>
      </tbody></table></td></tr>
                <tr id="22250613"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22250613" href="https://news.ycombinator.com/vote?id=22250613&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>Yeah, for normal web app, we can easily have 100x users for each step mentioned in article.<p>For our company, we had more than 500k users with 1 small nginx + 1 medium appServer(with autoscaling, though never needed it) + 1 small cache server and RDS till now. We just added a aws managed load balancer into the setup and think it might be overkill.</p><p>For a client with NewsFeed needs, I used a dedicated server(64GB, 2TB space) to run nginx, app, cache, huge elasticsearch and postgres. It was great(and cheap) option for an MVP and let them validate the product for few months with &gt;10k users.</p><p>It was awesome to learn a few years ago, how much compute power we don't use.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
              <tr id="22252880"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22252880" href="https://news.ycombinator.com/vote?id=22252880&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Yes exactly. I have a an app with about 1m concurrent users at peak hours. For years it is running perfectly fine on a single 8 core machine. Linux - &gt; Nginx -&gt; memcache -&gt; nodejs -&gt; filesystem.  Yes filesystem. All content is fetched from files. Another process is populating all files. I pay 40 dollars/m for this self managed machine.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22252918"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22252918" href="https://news.ycombinator.com/vote?id=22252918&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>What do you do when that one machine goes offline? Say there's a power outage, or a networking issue, or you have to reboot with a patched kernel. Now your 1M concurrent users can't use your application. This is why we go to the trouble to use multiple machines, ideally in multiple availability zones if we're using one of the big three cloud providers.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22253232"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td><center><a id="up_22253232" href="https://news.ycombinator.com/vote?id=22253232&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>What is wrong in this case w/ multiple VPS's? For instance, I run a shipping system that our entire operation depends on. I can't afford downtime either, as that would shutdown our entire shipping department. However, 1 server running on-prem, 1 remote in shared hosting and 2 failover servers on DigitalOcean costs ~$120/month.<p>What would a managed cloud like AWS or Azure provide besides higher expenses? Last I checked, AWS would be ~$550/month based on their calculator.</p><p>IT departments managed redundancy long before cloud was a thing, and it's certainly possible to achieve acceptable uptime without the managed services. I realize that I still rely on DO for their uptime, and I'm pricing renting rackspace for that reason. However, uptime is currently within acceptable levels (ie I haven't had to explain to the CEO why all his employees are standing around). We had tried 2 SaaS vendors before our current on-prem solution, and both had had downtime that cost us money. Both were hosted in AWS, so clearly that isn't the panacea for ultimate reliability. If our on-prem server goes down, I get a call. However, I got calls when our SaaS vendor went down as well; sitting on line with their tech support wasn't any great comfort.</p><p>The same graceful failover processes are accessible on machines you control, there's no reason that you have to run on one machine if you avoid the cloud. The biggest hurdle for me to implement this was database concurrency with multiple servers, but a cloud solution wouldn't have done anything to solve that problem.</p><p>[edit:] typos and miss-typed AWS pricing due to mobile keyboard.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
    <tr id="22254041"><td>
            </td></tr>
    <tr id="22253062"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td><center><a id="up_22253062" href="https://news.ycombinator.com/vote?id=22253062&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>That could be solved by mirroring the system to another $40/mo machine in another data center.<p>Redundancy was around long before cloud compute was a thing.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
                  <tr id="22251726"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22251726" href="https://news.ycombinator.com/vote?id=22251726&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Even though the absolute numbers may well not apply to other types of apps, the general concepts of how to scale do.  We have 100k+ users on effectively a single box too (actually two for redundancy, ease of upgrades, etc., but one can handle it), but this is a great overview of how to think about scaling beyond that, however many users that's done at.  Honestly when I was reading the article I read that 1/10/100 as more of a unitless degree of scale than actual numbers of humans.</span></p></div></td></tr>
      </tbody></table></td></tr>
              <tr id="22249423"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22249423" href="https://news.ycombinator.com/vote?id=22249423&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>SQL Server is a different beast. You get alot of performance enhancement out of box. Yes its costs money you save tremendous amount of tweaking time and headaches.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22250578"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22250578" href="https://news.ycombinator.com/vote?id=22250578&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>or you can just use AzureSQL and essentially just pay what it costs for the box, because it is platform as a service. Its far cheaper (and easier to maintain) than what it'd cost to buy a SQL Server license and run it on a VM.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22253053"><td>
            </td></tr>
        <tr id="22253175"><td>
            </td></tr>
        <tr id="22253565"><td>
            </td></tr>
        <tr id="22256068"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="200"></td><td><center><a id="up_22256068" href="https://news.ycombinator.com/vote?id=22256068&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>That is a 10 cal license, so you can only have 10 users using it, and that is 10 assigned users. Don't quote me on that but you have to use core licenses for web apps if you have internet users.</span></p></div></td></tr>
      </tbody></table></td></tr>
    <tr id="22254535"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="200"></td><td><center><a id="up_22254535" href="https://news.ycombinator.com/vote?id=22254535&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Those prices are too good to be true, reminds me of the sites that sell windows or office licenses to personal users for like 10 bucks.</span></p></div></td></tr>
      </tbody></table></td></tr>
    <tr id="22254379"><td>
            </td></tr>
                        <tr id="22250096"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22250096" href="https://news.ycombinator.com/vote?id=22250096&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Yeah, it really depends on the kind of app. My app with a couple of hundred thousand users runs on a single $5 Digital Ocean droplet with standard PHP and MySQL.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22251066"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22251066" href="https://news.ycombinator.com/vote?id=22251066&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>&gt; My app with a couple of hundred thousand users<p>per year? per month? per day? simultaneously? doing what?</p><p>it matters.</p><p>i ask this as someone who runs a $40/mo Linode with a debian/nginx/node/mysql stack that's definitely 20x over-provisioned for an e-commerce site with 10k daily visitors, 15 simultaneous backend users (reporting, order-entry, CRM, analytics) and 0 caching tricks. i could easily run the site on any 5 year old laptop with an SSD and 8GB RAM.</p><p>normalize/de-normalize when needed, understand and hand-write efficient SQL queries (ditch ORMs), choose small/fast libs carefully (or write your own), and you can easily serve 100k users per day on a single cheap VPS with no orchestration/replication/hz-scaling bullshit. definitely can't say the same about 200k <i>simultaneous</i> users - that would need proper hardware, but can still be a single server.</p><p>Monoliths Are the Future: <a href="https://news.ycombinator.com/item?id=22193383" rel="nofollow">https://news.ycombinator.com/item?id=22193383</a>
              </p></span></p></td></tr>
      </tbody></table></td></tr>
        <tr id="22251860"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td><center><a id="up_22251860" href="https://news.ycombinator.com/vote?id=22251860&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>&gt;(ditch ORMs)<p>Depends on which ORM you use I think. Basic ORMs like Dapper in .NET just map your SQL query result to a object model.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
        <tr id="22253968"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="120"></td><td><center><a id="up_22253968" href="https://news.ycombinator.com/vote?id=22253968&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Dapper's a "micro-ORM" and quite lightweight.  Usually folks intend ORM to refer to Hibernate or Entity Framework, maybe ActiveRecord, etc.</span></p></div></td></tr>
      </tbody></table></td></tr>
      <tr id="22251748"><td>
            </td></tr>
        <tr id="22252944"><td>
            </td></tr>
      <tr id="22251451"><td>
            </td></tr>
        <tr id="22252919"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="120"></td><td><center><a id="up_22252919" href="https://news.ycombinator.com/vote?id=22252919&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>i'm working on a blog post about the tech choices &amp; stack. maybe it'll make it to the front page in a month or two - that'll be a good stress test!</span></p></div></td></tr>
      </tbody></table></td></tr>
    <tr id="22251513"><td>
            </td></tr>
        <tr id="22252086"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22252086" href="https://news.ycombinator.com/vote?id=22252086&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>Same thing here, TravelMap.net has 100k+ users (total), handles photo uploads and runs on a simple droplet with PHP and JS.<p>I guess it depends on the daily traffic.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
        <tr id="22252480"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td><center><a id="up_22252480" href="https://news.ycombinator.com/vote?id=22252480&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Do you mind sharing more details on how you store and manage these photo uploads? Are you leveraging NFS or cloudfront + S3 at all?</span></p></div></td></tr>
      </tbody></table></td></tr>
      <tr id="22250284"><td>
            </td></tr>
                <tr id="22251499"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22251499" href="https://news.ycombinator.com/vote?id=22251499&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Hey, really specific question regarding your deployment. A teammate of mine reported difficulties with the .net SqlServer database driver establishing connection from a linux client (container instance based on the public .net core image) to a SqlServer instance (on windows) . Are you familiar with this problem?
I think moving our systems over to .NET Core on linux is the future, but this one experience has somewhat soured the idea for some decision makers and the team managing our db.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22252371"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td><center><a id="up_22252371" href="https://news.ycombinator.com/vote?id=22252371&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>I bumped into that at the office - connecting from a linux server to a microsoft sql server. We were able to connect after installing unixodbc and microsoft's odbc driver for sql server on linux. Note that a local mssql account is required, you can't connect with microsoft domain authentication from a linux box. We haven't finished testing and tweaking, but so far it looks like it's working.</span></p></div></td></tr>
      </tbody></table></td></tr>
        <tr id="22259648"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td><center><a id="up_22259648" href="https://news.ycombinator.com/vote?id=22259648&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>Right, the auth from non-windows was a separate organizational hurdle we had to overcome, there was real hesitancy about not using a GMSA windows user to auth with SqlServer.<p>When you say "local mssql account is required" do you mean a user or some other entity on the linux client? Or do you mean an mssql user that the client with authenticate as?
              </p></span></p></td></tr>
      </tbody></table></td></tr>
        <tr id="22276143"><td>
            </td></tr>
        <tr id="22308765"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="160"></td><td><center><a id="up_22308765" href="https://news.ycombinator.com/vote?id=22308765&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>Two more questions (if you see this, I know it's been a few days), are you running SQL Server on Linux or Windows? And are you using encrypted connections?</span></p></div></td></tr>
      </tbody></table></td></tr>
                      <tr id="22249723"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22249723" href="https://news.ycombinator.com/vote?id=22249723&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><p><span>Any tests on progress? I'm going on Postgress because of Bson support and no-sql with sql duplicate fields for search.<p>Using .net core also.</p><p>In general: I agree, there's rarely a case for really using the cloud. Page loads of my E-commerce project are 8ms for basket, I'm wondering what should kill it first on a big load, even without caching. Probably the database, not sure yet.
              </p></span></p></td></tr>
      </tbody></table></td></tr>
              <tr id="22264664"><td>
            <table>  <tbody><tr>    <td><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td><center><a id="up_22264664" href="https://news.ycombinator.com/vote?id=22264664&amp;how=up&amp;goto=item%3Fid%3D22249230"></a></center></td><td><br><div>
                  <p><span>It also depends on the nature of the fintech app. Imagine running a 100K + users on a  stock trading app for day traders, where latency matters, and a lot of streaming happens.</span></p></div></td></tr>
      </tbody></table></td></tr>
              <tr id="22249288"><td>
            </td></tr>
        <tr id="22249382"><td>
            </td></tr>
              </tbody></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>

</body>
</html>