<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Zoom Security Exploit - Cracking private meeting passwords - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Zoom Security Exploit - Cracking private meeting passwords - linksfor.dev(s)"/>
    <meta property="article:author" content="Tom&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Published&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;July 29, 2020"/>
    <meta property="og:description" content="Short version:"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.tomanthony.co.uk/blog/zoom-security-exploit-crack-private-meeting-passwords/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Zoom Security Exploit - Cracking private meeting passwords</title>
<div class="readable">
        <h1>Zoom Security Exploit - Cracking private meeting passwords</h1>
            <div>by Tom&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Published&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;July 29, 2020</div>
            <div>Reading time: 12-16 minutes</div>
        <div>Posted here: 30 Jul 2020</div>
        <p><a href="https://www.tomanthony.co.uk/blog/zoom-security-exploit-crack-private-meeting-passwords/">https://www.tomanthony.co.uk/blog/zoom-security-exploit-crack-private-meeting-passwords/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div itemprop="mainContentOfPage">
		
<blockquote><p><strong>Short version:</strong></p><p>Zoom meetings were default protected by a 6 digit numeric password, meaning 1 million maximum passwords. I discovered a vulnerability in the Zoom web client that allowed checking if a password is correct for a meeting, due to broken CSRF and no rate limiting.</p><p><strong>This enabled an attacker to attempt all 1 million passwords in a matter of minutes and gain access to other people’s private (password protected) Zoom meetings.</strong></p><p>This also raises the troubling question as to whether others were potentially already using this vulnerability to listen in to other people’s calls (e.g. the UK Cabinet Meeting!).</p><p>I reported the issue to Zoom, who quickly took the web client offline to fix the problem. They seem to have mitigated it by both requiring a user logs in to join meetings in the web client, and updating default meeting passwords to be non-numeric and longer. <strong>Therefore this attack no longer works.</strong></p></blockquote>







<p>On March 31st, Boris Johnson <a href="https://twitter.com/BorisJohnson/status/1244985949534199808">tweeted about</a> chairing the first ever digital cabinet meeting. I was amongst many who noticed that the screenshot included the Zoom Meeting ID. Twitter was alive with people saying they were trying to join, but Zoom protects meetings with a password by default (which was pointed out when the Government <a href="https://www.bbc.co.uk/news/technology-52126534">defended using Zoom</a>).</p>



<p>Having also tried to join, I thought I would see if I could crack the password for private Zoom meetings. Over the next couple of days, I spent time reverse engineering the endpoints for the web client Zoom provide, and found I was able to iterate over all possible default passwords to discover the password for a given private meeting.</p>



<div><figure><img src="https://www.tomanthony.co.uk/blog/wp-content/uploads/2020/04/EUcUBu6XgAcHo93.jpg" alt=""><figcaption>UK Government Cabinet Meeting, over Zoom, clearly showing the meeting ID.<br>The government have reassured the call was password protected.</figcaption></figure></div>



<h2>Background</h2>



<p>After trying to join the Cabinet Meeting, I poked about in the Zoom app and noticed the default passwords being 6 digits and numeric, meaning 1 million maximum passwords.</p>



<p>A fairly standard principle of password security is to rate limit password attempts, to prevent an attacker from iterating over a list of candidate passwords and trying them all. I assumed that Zoom would be doing this, but decided to double check.</p>



<p>I decided to target Zoom’s web client, but my findings apply to meetings initiated and conducted via all versions of the app too.</p>



<h2>Meeting Login Flow</h2>



<p>When a user creates a new meeting, Zoom auto generates a link for people to join, in the form (dummy data below):</p>



<p><code>https://zoom.us/j/618086352?pwd=SE5OWjE6UDhwaDVJR3FJRzUyZUI3QT09</code></p><p>It contains both the meeting ID and the auto generated password. I believe this password is a hashed version of the 6 digit numeric password, but I also found that swapping it out for the 6 digit numeric version was acceptable to the web client endpoints, so we could ignore the hashed version and concentrate on the numeric version.</p>



<p>If you remove the <code>pwd</code> parameter then visit the web client join link (<code>https://zoom.us/wc/join/618086352</code>) then you will see a login screen:</p>



<div><figure><img src="https://www.tomanthony.co.uk/blog/wp-content/uploads/2020/04/2020-04-02_14-32-36.png" alt=""></figure></div>



<p>Filling this in takes you to a privacy policy page:</p>



<div><figure><img src="https://www.tomanthony.co.uk/blog/wp-content/uploads/2020/04/2020-04-02_14-33-43.png" alt=""></figure></div>



<p>This seemed to fire off an XHR GET request then take you to another page.</p>



<h3>Breaking down the flow behind the scenes</h3>



<p>There were several things going on as you move through this flow:</p>



<ol><li>When you first open any web client page, without an existing cookie, a cookie is set which, amongst other bits, contains a GUID. This seems to be your anonymous user ID.</li><li>If you fill in the user/pass form but haven’t completed the privacy agreement you are redirected to it. Completing it was a simple GET request to a given endpoint, which contains your GUID. <em><strong>There was a CSRF HTTP header sent during this step, but if you omitted it then the request still seemed to just work fine anyway.</strong></em></li><li>When you submitted a username and password, you were 302 redirected to another page, irrespective of whether you got the password right or wrong. You would get a 200 response if you haven’t completed the privacy policy.</li><li>The redirect would take you to a new page, which seems to know server side whether your GUID has previously entered the correct password. i.e. The previous step stored state server side marking whether you got the password correct.</li></ol>



<p>The failure on the CSRF token made it even easier to abuse than it would be otherwise, but fixing that wouldn’t provide much protection against this attack.</p>



<p>This process was a little convoluted to automate, which is maybe why this endpoint had not been scrutinised in detail before. There are some details I’ve skipped over, such as parameters that need to be saved from one request to another, but they are not important to understanding the main issue.</p>



<h2>Cracking passwords</h2>



<p>The important thing to note about the above process is that <strong><em>there was no rate limit on repeated password attempts</em></strong> (each comprising of 2 HTTP requests – one to submit the password, and follow up request to check if it was accepted by the server). However, the speed is limited by how quickly you can make HTTP requests, which have a natural latency which would make cracking a password a slow process; the server side state means you have to wait for the first request to complete before you can send the second.</p>



<p>However, we should note that the state was stored against the provided GUID, and you can ask the server for as many of those as you want by sending HTTP requests with no cookie. This means we could request a batch of GUIDs and then chunk the 1 million possible passwords up between them and run multiple requests in parallel.</p>



<p>I put together some (fairly clunky) Python that requests a batch of GUIDs then spawns multiple threads so they can run requests in parallel. An initial test running from my home machine with 100 threads:</p>



<pre><code>===FOUND PASSWORD===
Password: 170118
Passwords tried: 43164
took 28m 52s 392ms</code></pre>



<p>We can see we are checking about 25 passwords a second, and discovered the password (in this example I knew the password so had bounded my search). I ran a similar test from a machine in AWS and checked 91k passwords in 25 minutes.</p>



<p>With improved threading, and distributing across 4-5 cloud servers you could check the entire password space within a few minutes. This would be fairly simple to do, but I resisted as I had demonstrated the process and wanted to be cautious not to interrupt Zoom’s service (I did do some short higher rate tests and never got throttled or blocked).</p>



<p>Note also that the expected time to find a password would be shorter, as you would not normally need to search the entire list of possible passwords.</p>



<p>Also note that recurring meetings, including ‘Personal Meeting IDs (PMIs)’ always use the same password, so once it is cracked you have ongoing access.</p>



<p>The initial version of my attack could only be run once a meeting started, but I later found that the DOM for un-started indicated whether the password was correct vs incorrect, meaning you could crack scheduled meetings too.</p>



<h2>Zoom Password Issues</h2>



<p>Firstly, note that whilst it doesn’t seem possible to change the 6 digit numeric password for spontaneous meetings, it is possible to override it for scheduled meetings, but is an explicit step to change the default password provided. I checked about 20 Zoom meeting invites I’ve received in the past, from various people, and found they all used the default 6 digit password.</p>



<p>If you do override the password and produce a longer alphanumeric password, then a 6 digit numeric password may be produced anyway for phone users. This password <em>is not</em> accepted, at least on the endpoint I was trying for the web client. I’m not sure if this is true for other endpoints – I didn’t check.</p>



<p>Also note that if the password was to be updated to alphanumeric, I estimate you could still run across a password list of, say, the top 10 million passwords in less than an hour.</p>



<p>In other testing, I found that Zoom has a maximum password length of 10 characters, and whilst it accepts non-ASCII characters (such as ü, €, á) it converts them all to ? after you save the password.</p>



<h2>Could someone have eavesdropped on the UK Cabinet Meeting?</h2>



<p>Lastly, I noted in Boris Johnson’s screenshot, that there is a user called simply ‘iPhone’ (see bottom right) that is muted with the camera off:</p>



<figure><img src="https://www.tomanthony.co.uk/blog/wp-content/uploads/2020/04/2020-04-09_17-52-50-1.png" alt=""><figcaption>There was an unnamed, muted &amp; hidden participant in the Cabinet Meeting</figcaption></figure>



<p>It got me wondering whether this flaw has previously been found — if I could discover it then it seems plausible that others could too, which makes this bug particularly worrisome.</p>



<h2>Remediation</h2>



<p>The high level recommendations I passed on to Zoom for fixing this were:</p>



<ol><li>Rate limit GUIDs to a reasonable number of password attempts (e.g 10 [different] failed attempts in an hour for a given meeting)</li><li>Rate limit IP addresses, irrespective of GUID, for password attempts (irrespective of meeting ID)</li><li>Rate limit or trigger a warning should a given meeting pass a set failure rate for failed password attempts</li><li>Fix the CSRF on the Privacy Terms form, so it is harder to automate attacks.</li><li>Increase the length of the default password.</li></ol>



<p>As far as I can tell (Zoom hasn’t given me any insight into what they did to mitigate the issue), it seems Zoom has made a couple of changes:</p>



<ul><li>Started enforcing sign-in for users joining meetings via the web client; it is unclear if this is a permanent change or not (it is a problem for some users as I understand).</li><li>Updated default passwords to be alphanumeric instead. This seems to be in some phased rollout as I’m still sometimes seeing numeric only passwords.</li></ul>



<h2>Zoom Response</h2>



<p>I reported the issue to Zoom directly, and they quickly took the whole web client offline for a few days whilst they triaged the issue, it came up again a few days later.</p>



<p>I’m aware Zoom have been under <a href="https://www.bbc.co.uk/news/business-52115434">a lot of scrutiny</a> for their security practices given their sudden spike in usage brought about by the COVID-19 pandemic. From my interactions with the team, they seemed to care about the security of the platform, and their users and they seemed appreciative of the report.</p>



<p>Zoom run a private, invite only, bug bounty program, which is a fairly common practice for lots of organisations. I was invited to submit this bug to the bug bounty program, but I asked to wait as I was interested in the new bug bounty program they were working on. I wondered if the new program rules would guarantee consent for disclosure, given I felt this was a bug of public interest. Zoom agreed I could submit the bug under the new program when it was launched.</p>



<p>Zoom have since released the results of their 90 day security sprint, and <a href="https://blog.zoom.us/ceo-report-90-days-done-whats-next-for-zoom/">commitment #4</a> on that includes updates to their bug bounty program. Hopefully that is coming soon, but I didn’t want to wait in disclosing the bug (they had agreed to disclosure), given it has been fixed for a while.</p>



<p>I did submit a couple of other small bugs via the private program on HackerOne, and received bounties for those. Thanks Zoom team! 🙂</p>



<h2>Wrap up</h2>



<p>It was surprising to me that there was a lack of rate limiting on the central mechanism of the platform, which combined with a poor default password system and faulty CSRF meant that meetings were really not secure.</p>



<p>However, Zoom’s response was fast, and they quickly addressed the rate limiting issue. Zoom meetings also got a default password upgrade, which is great.</p>



<p>Zoom’s ease of use and video conferencing quality have made it a hugely valuable tool for millions of people over the last few months, during what is a tough time. Many (most?) are using it entirely for free. That is a great thing, and I’m grateful Zoom exists. Thanks Zoom team!</p>



<h2>Timeline</h2>



<ul><li>1st April – I reported the issue to Zoom, with a working Python POC. I sent this via their generic support form, and via email.</li><li>2nd April – I followed up with a draft of this post as additional explanation, and a better commented version of the Python code. I tweeted at Zoom to ask about a status, and in DMs with them passed on the ticket number.</li><li>2nd April – Heard from their team they were looking (this was about 24 hours following my report), then received a follow up from Zoom’s CISO.</li><li>2nd April – Noted that the Zoom Web Client was offline, returning a 403. This also affected the web SDK.</li><li>9th April – Heard from the Zoom team that this was mitigated.</li><li>16th April – Heard they were working on updated bug bounty program.</li><li>15th June – Requested update on BB program. No reply.</li><li>8th July – Asked again if I could submit this for bounty. No reply. (Point of clarity here – the bug is fixed, and they have new issues to deal with so this isn’t exactly a priority for them. I could have chosen to file the bug for a bounty at the time, but didn’t, and wasn’t promised anything if I waited).</li><li>29th July – Disclosure.</li></ul>



<p>Update edit: A few people have asked me or remarked about the lack of bounty. To be clear, I never actually submitted this bug via their bounty program (but was invited to do so), as was holding out for their new program (see post), and fell down the cracks a bit.  Zoom didn’t decide against awarding a bounty – I never submitted for one, and disclosed here instead.</p>





		
									</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>