<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Using ML.NET for deep learning on images in Azure | .NET Blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Using ML.NET for deep learning on images in Azure | .NET Blog - linksfor.dev(s)"/>
    <meta property="article:author" content="Luis QuintanillaContent Developer, Developer RelationsFollow"/>
    <meta property="og:description" content="Introduction&#xA;In March 2020, ML.NET added support for training Image Classification models in Azure. Although the image classification scenario was released in late 2019, users were limited by the resources on their local compute environments. Training in Azure enables users to scale image classification scenarios by using GPU optimized Linux virtual machines."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/dotnet/train-image-classification-model-azure-mlnet-model-builder/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Using ML.NET for deep learning on images in Azure | .NET Blog</title>
<div class="readable">
        <h1>Using ML.NET for deep learning on images in Azure | .NET Blog</h1>
            <div>by Luis QuintanillaContent Developer, Developer RelationsFollow</div>
            <div>Reading time: 11-14 minutes</div>
        <div>Posted here: 11 May 2020</div>
        <p><a href="https://devblogs.microsoft.com/dotnet/train-image-classification-model-azure-mlnet-model-builder/">https://devblogs.microsoft.com/dotnet/train-image-classification-model-azure-mlnet-model-builder/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured"><div><div><div><div><p><img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/luis-150x150.jpg" width="58" height="58" alt="Luis Quintanilla"></p><p>Luis</p></div></div></div><p>May 6th, 2020</p><h2>Introduction</h2><p>In March 2020, ML.NET added <a href="https://devblogs.microsoft.com/dotnet/ml-net-model-builder-updates/">support for training Image Classification models in Azure</a>. Although the image classification scenario was released in late 2019, users were limited by the resources on their local compute environments. Training in Azure enables users to scale image classification scenarios by using GPU optimized Linux virtual machines.</p><p>This post will show how to train a custom image classification model in Azure to categorize flowers using ML.NET Model Builder. Then, you can leverage your existing .NET skills to consume the trained model inside a C# .NET Core console application. Best of all, little to no prior machine learning knowledge is required. Let’s get started!</p><h2>ML.NET Model Builder</h2><p><a href="https://github.com/dotnet/machinelearning" target="_blank">ML.NET</a> is an open-source and cross-platform machine learning framework for .NET developers. Model Builder is a tool in Visual Studio that provides a graphical user interface that uses Automated Machine Learning (Auto ML) to train and consume custom ML.NET models for your .NET applications.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-1024x563.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-1024x563.png" alt="Model Builder choose a scenario screen" width="640" height="352" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-1024x563.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-300x165.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-768x422.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario.png 1280w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><h2>Prerequisites</h2><p>To follow along, you’ll need the following prerequisites:</p><ul><li><a href="https://visualstudio.microsoft.com/vs/preview/" target="_blank">Visual Studio 2019 16.6 preview 2 or later</a></li><li>Azure account. If you don’t have one, you can <a href="http://aka.ms/AMLFree" target="_blank">sign up for a free Azure account</a>.</li><li>.NET Core cross-platform development workload</li></ul><p>To use Model Builder, make sure to enable the preview feature. In the Visual Studio Menu Bar, select <strong>Tools &gt; Options &gt; Environment &gt; Preview Features</strong>. Then, check the <strong>Enable ML.NET Model Builder</strong> box.</p><h2>Model training workflow</h2><p>The process of training models usually consists of the steps outlined below:</p><ol><li>Get the data</li><li>Create a .NET Core application. This can be a console, desktop, or web application.</li><li>Choose a scenario</li><li>Configure your training environment</li><li>Load the data</li><li>Train the model</li><li>Evaluate the model</li><li>Add the code to make predictions</li></ol><h2>Add the data</h2><p>The dataset used in this guide is based on the <a href="https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz" target="_blank">TensorFlow flower photos dataset</a>. All images in this archive are licensed under the Creative Commons By-Attribution License, available at: <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">https://creativecommons.org/licenses/by/4.0/</a></p><p>The full license information is provided in the LICENSE.txt file which is included as part of the same image set.</p><p>The dataset is divided into separate subfolders, one for each flower category:</p><ul><li>Daisy</li><li>Dandelion</li><li>Roses</li><li>Sunflowers</li><li>Tulips</li></ul><p>Download the data anywhere on your PC and unzip it.</p><p>Model Builder requires data to be in a certain format. This dataset is already in the correct format. For more information, see Microsoft Docs to learn more about <a href="https://docs.microsoft.com/en-us/dotnet/machine-learning/how-to-guides/load-data-model-builder#set-up-image-data-files" target="_blank">loading data with Model Builder</a>.</p><h2>Create a .NET Core console application</h2><p>The application that consumes the model is a C# .NET Core console application.</p><p>Open Visual Studio and create a new C# .NET Core console application. In this case, I’ve called my application <em>MBImageClassificationApp</em>.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-dotnet-console-app-1024x705.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-dotnet-console-app-1024x705.png" alt="Create C# .NET Core console application" width="640" height="441" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-dotnet-console-app-1024x705.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-dotnet-console-app-300x207.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-dotnet-console-app-768x529.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-dotnet-console-app.png 1046w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><h2>Choose a scenario</h2><p>In Solution Explorer, right-click your newly created console application project and select <strong>Add &gt; Machine Learning</strong> to launch Model Builder.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/launch-model-builder-1024x563.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/launch-model-builder-1024x563.png" alt="Add Machine Learning" width="640" height="352" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/launch-model-builder-1024x563.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/launch-model-builder-300x165.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/launch-model-builder-768x422.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/launch-model-builder.png 1280w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><p>Once you’re presented with the scenario screen, select <strong>Image Classification</strong> and proceed to the next step.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-1024x563.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-1024x563.png" alt="Model Builder choose a scenario screen" width="640" height="352" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-1024x563.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-300x165.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario-768x422.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-scenario.png 1280w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><h2>Configure your training environment</h2><p>For image classification scenarios, you can choose between training locally or in the cloud. For this sample we’ll train the model in Azure. For scenarios that train on thousands of images and require a large amount of resources, it is recommended to use Azure, which provides GPU optimized virtual machines for training.</p><h3>Create Azure Machine Learning experiment</h3><p>Choose <strong>Azure</strong> form the list of training environments. Then, select the <strong>Set up workspace</strong> button to configure your environment.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-1024x563.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-1024x563.png" alt="Choose environment and create workspace" width="640" height="352" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-1024x563.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-300x165.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-768x422.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment.png 1280w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><p>An Azure Machine Learning experiment is a resource that needs to be created before running Model Builder training on Azure. The experiment encapsulates the configuration and results for one or more machine learning training runs.</p><h3>Set up Azure environment</h3><p>To create an Azure Machine Learning experiment, you first need to configure your environment on Azure. An experiment needs an Azure subscription, workspace, and compute to run on.</p><p>In the Create New Experiment dialog, choose your Azure subscription. Then, select or create a new Azure Machine Learning workspace. A workspace is an Azure Machine Learning resource that provides a central place for all Azure Machine Learning resources and artifacts created as part of a training run.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-subscription.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-subscription.png" alt="Choose Azure subscription" width="636" height="483" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-subscription.png 636w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/choose-subscription-300x228.png 300w" sizes="(max-width: 636px) 100vw, 636px"> </a></p><p>When you create a new workspace, the following resources are provisioned:</p><ul><li>Azure Machine Learning Enterprise workspace</li><li>Azure Storage</li><li>Azure Application Insights</li><li>Azure Container Registry</li><li>Azure Key Vault</li></ul><p>As a result, this process may take a few minutes.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-new-workspace.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-new-workspace.png" alt="Create a new Azure Machine Learning workspace" width="636" height="393" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-new-workspace.png 636w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-new-workspace-300x185.png 300w" sizes="(max-width: 636px) 100vw, 636px"> </a></p><p>When you choose a region, it’s recommended that you select a location close to where you or your customers are.</p><p>Once you’ve chosen or created your workspace, choose or create a new Azure Machine Learning compute. An Azure Machine Learning compute is a cloud-based Linux VM used for training. Learn more about <a href="https://docs.microsoft.com/dotnet/machine-learning/resources/azure-training-concepts-model-builder#what-is-an-azure-machine-learning-compute" target="_blank">compute types supported by Model Builder</a>. This process may take a few minutes.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-compute.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-compute.png" alt="Create a new Azure Machine Learning Compute" width="486" height="318" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-compute.png 486w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-compute-300x196.png 300w" sizes="(max-width: 486px) 100vw, 486px"> </a></p><p>In the Create New Experiment dialog, leave the default experiment name and select <strong>Create</strong>.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-final.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-final.png" alt="Create experiment final" width="636" height="483" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-final.png 636w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/create-experiment-final-300x228.png 300w" sizes="(max-width: 636px) 100vw, 636px"> </a></p><p>The first experiment is created and its name is registered in the workspace. Any subsequent runs – if the same experiment name is used – are logged as part of the same experiment. Otherwise, a new experiment is created.</p><p>If you’re satisfied with your configuration, select the <strong>Data</strong> button to move to the next step.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/submit-experiment-1024x563.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/submit-experiment-1024x563.png" alt="Submit experiment" width="640" height="352" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/submit-experiment-1024x563.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/submit-experiment-300x165.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/submit-experiment-768x422.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/submit-experiment.png 1280w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><h2>Load the data</h2><p>In the Add data screen, load your data by selecting the button next to the Select a folder text box and use the file explorer to find the unzipped directory containing the subdirectories with images.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/load-data-1024x563.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/load-data-1024x563.png" alt="Load the data" width="640" height="352" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/load-data-1024x563.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/load-data-300x165.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/load-data-768x422.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/load-data.png 1280w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><p>Once the data is loaded, select the <strong>Train</strong> button to train your model.</p><h2>Train the model</h2><p>In the Model Builder train screen, select the <strong>Start training</strong> button to start training your model.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/track-training-progress-1024x563.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/track-training-progress-1024x563.png" alt="Track training progress" width="640" height="352" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/track-training-progress-1024x563.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/track-training-progress-300x165.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/track-training-progress-768x422.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/track-training-progress.png 1280w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><p>At this point, your data is uploaded to Azure Storage and the training process begins. The algorithm used to train these models is a <a href="https://wikipedia.org/wiki/Deep_learning#Deep_neural_networks" target="_blank">Deep Neural Network</a> based on the <a href="https://wikipedia.org/wiki/Residual_neural_network" target="_blank">ResNet50 architecture</a>. The training process takes some time and the amount of time may vary depending on the size of compute selected as well as the amount of data.</p><p>For this sample of 3670 images, training took about 30 minutes. The first time a model is trained in Azure, you can expect a slightly longer training time because resources have to be provisioned. You can track the progress of your runs in the Azure Machine Learning portal by selecting the “Monitor current run in Azure portal” link in Visual Studio.</p><p>Once the model is trained, select the <strong>Evaluate</strong> button to move to the next step.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/training-complete-1024x620.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/training-complete-1024x620.png" alt="Training complete" width="640" height="388" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/training-complete-1024x620.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/training-complete-300x182.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/training-complete-768x465.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/training-complete.png 1190w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><h2>Evaluate your model</h2><p>In the evaluate screen, you are able to get an overview of the results from the training process such as how long the model took to train as well as the accuracy. Additionally, you can use the “Try your model” experience to quickly check whether your model is performing as expected. All you need to do is provide an image, preferably one that the model did not use as part of training. The model classifies the image and provides the list of categories along with their probabilities with the predicted value at the top of the list.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/evaluate-model-1024x620.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/evaluate-model-1024x620.png" alt="Evaluate Model" width="640" height="388" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/evaluate-model-1024x620.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/evaluate-model-300x182.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/evaluate-model-768x465.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/evaluate-model.png 1190w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><p>If you’re satisfied with your model, select the <strong>Code</strong> button to add the code to make predictions.</p><h2>Add the code to make predictions</h2><p>In the code screen, select the <strong>Add Projects</strong> button to add the auto-generated projects to your solution.</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/add-projects-1024x620.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/add-projects-1024x620.png" alt="Add auto-generated projects to solution" width="640" height="388" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/add-projects-1024x620.png 1024w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/add-projects-300x182.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/add-projects-768x465.png 768w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/add-projects.png 1190w" sizes="(max-width: 640px) 100vw, 640px"> </a></p><p>Two projects are added to your solution with the following suffixes:</p><ul><li><em>ConsoleApp</em>: A C# .NET Core console application that provides starter code to build the prediction pipeline and make predictions.</li><li><em>Model</em>: A C# .NET Standard application that contains the data models that define the data schema of input and output model data as well as the following assets:<ul><li><em>bestModel.onnx</em>: A serialized version of the model in <a href="https://onnx.ai/" target="_blank">Open Neural Network Exchange (ONNX)</a> format. ONNX is an open-source format for AI models that supports interoperability between frameworks like ML.NET, PyTorch, and TensorFlow.</li><li><em>bestModelMap.json</em>: A list of categories used when making predictions to map the model output to a text category.</li><li><em>MLModel.zip</em>: A serialized version of the ML.NET prediction pipeline that uses the serialized version of the model <em>bestModel.onnx</em> to make predictions and maps outputs using the <em>bestModelMap.json</em> file.</li></ul></li></ul><h2>Use the machine learning model</h2><p>Open the <em>Program.cs</em> file from your console application. In this case, my console application is <em>MBImageClassificationApp</em>.</p><p>Then, replace the code with the following:</p><pre><span>using</span><span> </span><span>System</span><span>;</span><span>
</span><span>using</span><span> </span><span>MBImageClassificationAppML</span><span>.</span><span>Model</span><span>;</span><span>

</span><span>namespace</span><span> </span><span>MBImageClassificationApp</span><span>
</span><span>{</span><span>
    </span><span>class</span><span> </span><span>Program</span><span>
    </span><span>{</span><span>
        </span><span>static</span><span> </span><span>void</span><span> </span><span>Main</span><span>(</span><span>string</span><span>[]</span><span> args</span><span>)</span><span>
        </span><span>{</span><span>
            </span><span>ModelInput</span><span> image </span><span>=</span><span> </span><span>new</span><span> </span><span>ModelInput</span><span>
            </span><span>{</span><span>
                </span><span>ImageSource</span><span> </span><span>=</span><span> </span><span>"Pink_Tulips.jpg"</span><span>
            </span><span>};</span><span>

            </span><span>var</span><span> prediction </span><span>=</span><span> </span><span>ConsumeModel</span><span>.</span><span>Predict</span><span>(</span><span>image</span><span>);</span><span>

            </span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>$</span><span>"Actual: tulips | Predicted: {prediction.Prediction}"</span><span>);</span><span>
        </span><span>}</span><span>
    </span><span>}</span><span>
</span><span>}</span></pre><p>The first thing I’ve done is added a <em>using</em> statement to reference the <em>MBImageClassificationAppML.Model </em>project. To test my application, I’ve downloaded an image of tulips called <a href="https://upload.wikimedia.org/wikipedia/commons/9/92/Pink_Tulips.JPG" target="_blank" data-featherlight="image">Pink_Tulips</a> from the internet and included it in my <em>MBImageClassificationApp</em> project. The model has not seen this image before. A new instance of <em>ModelInput&nbsp;</em>is created and the path of the image is used as the value for the <em>ImageSource</em> property.</p><p>Then, <em>ConsumeModel.Predict</em>, a helper method that loads the <em>MLModel.zip&nbsp;</em>file and uses <em>PredictionEngine</em>, a convenience API to make predictions on a single instance of data, is called with the sample image as input. Finally, both the actual class the image belongs to, as well as the predicted flower category, are printed out to the console.</p><p>When you run the application, you should see output similar to the following in the console:</p><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/console-output.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/console-output.png" alt="Console Application Output" width="979" height="512" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/console-output.png 979w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/console-output-300x157.png 300w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2020/04/console-output-768x402.png 768w" sizes="(max-width: 979px) 100vw, 979px"> </a></p><h2>Clean up resources</h2><p>Azure Machine Learning Enterprises are currently in preview. Therefore, there is no additional surcharge at the moment. Training this model cost less than $0.50. Depending on your scenario, your costs may vary depending on the amount of data and size of your compute. For more information on pricing, see the <a href="https://azure.microsoft.com/pricing/details/virtual-machine-scale-sets/linux/" target="_blank">Linux Virtual Machine Scale Sets pricing page</a>.</p><p>If you no longer plan to use the Azure resources you’ve created, delete them. This prevents you from being charged for unutilized resources that are still running.</p><ol><li>Navigate to the <a href="https://portal.azure.com/" target="_blank">Azure portal</a> and select <strong>Resource groups</strong> in the portal menu.</li><li>From the list of resource groups, select the resource group you created.</li><li>Select <strong>Delete resource group</strong> and follow the instructions in the prompt to delete your resource group.</li></ol><h2>Share your feedback</h2><p>Since Model Builder is still in Preview, your feedback is super important in driving the direction of this tool and ML.NET in general. We would love to <a href="https://www.research.net/r/mlnet-ai-april" target="_blank">hear your feedback</a>!</p><p>If you run into any issues, please let us know by creating an issue in our <a href="https://github.com/dotnet/machinelearning-modelbuilder" target="_blank">GitHub repo</a>.</p><h2>Virtual ML.NET Conference</h2><p>Join the community May 29-30 for a <a href="https://virtualml.net/" target="_blank">free online conference</a>.</p><p>The conference will have a full-day hands-on workshop, followed by another day of sessions.</p><p><a href="https://virtualmlnet.typeform.com/to/MT4ZDG" target="_blank">Sign up to attend</a> or <a href="https://sessionize.com/virtual-ml-net/" target="_blank">submit a talk</a>.</p><p>See you there!</p><h2>Additional resources</h2><p>Watch this video to see how quick it is to <a href="https://www.youtube.com/watch?v=G_ZJZdKLNMc" target="_blank">train and consume an image classification model to recognize clothing garments and accessories in a Blazor web application</a>.</p><p>Check out this <a href="https://docs.microsoft.com/samples/dotnet/machinelearning-samples/mlnet-image-classification-azure-model-builder/" target="_blank">end-to-end sample that uses satellite images to determine land use</a>.</p><p>Learn more about Model Builder from <a href="http://aka.ms/modelbuilder-docs" target="_blank">Microsoft Docs</a>.</p><p>Not currently using Visual Studio? Try out the <a href="http://aka.ms/mlnet-cli" target="_blank">ML.NET CLI</a>.</p></div></div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>