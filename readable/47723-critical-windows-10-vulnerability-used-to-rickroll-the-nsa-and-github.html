<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Critical Windows 10 vulnerability used to Rickroll the NSA and Github -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div class="article-content post-page"> <figure class="intro-image intro-left"> <img src="https://cdn.arstechnica.net/wp-content/uploads/2020/01/rickroll-nsa-800x603.jpeg" alt="Chrome on Windows 10 as it Rickrolls the NSA."> <figcaption class="caption"><div class="caption-text"><a href="https://cdn.arstechnica.net/wp-content/uploads/2020/01/rickroll-nsa.jpeg" class="enlarge-link">Enlarge</a> <span class="sep">/</span> Chrome on Windows 10 as it Rickrolls the NSA.</div></figcaption> </figure> <aside id="social-left" class="social-left"> <a class="comment-count icon-comment-bubble-down" href="https://arstechnica.com/information-technology/2020/01/researcher-develops-working-exploit-for-critical-windows-10-vulnerability/?comments=1"> </a> </aside> <p>Less than a day after Microsoft disclosed one of the most critical Windows vulnerabilities ever, a security researcher has demonstrated how attackers can exploit it to cryptographically impersonate any website or server on the Internet.</p>
<p>Researcher Saleem Rashid on Wednesday tweeted images of the video &quot;Never Gonna Give You Up,&quot; by 1980s heart-throb Rick Astley, playing on Github.com and NSA.gov. The digital sleight of hand is known as <a href="https://en.wikipedia.org/wiki/Rickrolling">Rickrolling</a> and is often used as a humorous and benign way to demonstrate serious security flaws. In this case, Rashid&apos;s exploit causes both the Edge and Chrome browsers to spoof the HTTPS verified websites of Github and the National Security Agency. Brave and other Chrome derivatives, as well as Internet Explorer, are also likely to fall to the same trick. (There&apos;s no indication Firefox is affected.)</p>
<figure class="image shortcode-img right medium"><a href="https://cdn.arstechnica.net/wp-content/uploads/2020/01/rickroll-github.jpeg" class="enlarge" alt="The same exploit used to Rickroll Github on Edge."><img alt="The same exploit used to Rickroll Github on Edge." src="https://cdn.arstechnica.net/wp-content/uploads/2020/01/rickroll-github-300x219.jpeg" width="300" srcset="https://cdn.arstechnica.net/wp-content/uploads/2020/01/rickroll-github-640x467.jpeg 2x"></a><figcaption class="caption"><div class="caption-text"><a href="https://cdn.arstechnica.net/wp-content/uploads/2020/01/rickroll-github.jpeg" class="enlarge-link">Enlarge</a> <span class="sep">/</span> The same exploit used to Rickroll Github on Edge.</div></figcaption></figure>
<p>Rashid&apos;s simulated attack exploits <a href="http://cve.circl.lu/cve/CVE-2020-0601">CVE-2020-0601</a>, the <a href="https://msrc-blog.microsoft.com/2020/01/14/january-2020-security-updates-cve-2020-0601/">critical vulnerability that Microsoft patched</a> on Tuesday after receiving a private tipoff from the NSA. As <a href="https://arstechnica.com/information-technology/2020/01/patch-windows-10-and-server-now-because-certificate-validation-is-broken/">Ars reported</a>, the flaw can completely break certificate validation for websites, software updates, VPNs, and other security-critical computer uses. It affects Windows 10 systems, including server versions Windows Server 2016 and Windows Server 2019. Other versions of Windows are unaffected.</p>
<p>Rashid told me his exploit uses about 100 lines of code but that he could compress it down to 10 lines if he wanted to remove a &quot;few useful tricks&quot; his attack has. While there are constraints and several potentially difficult requirements in getting the exploit to work in real-world, adversarial conditions (more about that later), Wednesday&apos;s proof-of-concept attack demonstrates why the NSA <a href="https://media.defense.gov/2020/Jan/14/2002234275/-1/-1/0/CSA-WINDOWS-10-CRYPT-LIB-20190114.PDF">assesses the vulnerability as &quot;severe&quot;</a> and said sophisticated hackers could understand how to exploit it &quot;quickly.&quot;</p>
<h2>&#x201C;Fairly terrifying&#x201D;</h2>
<p>Other researchers shared the NSA&apos;s sense of urgency.</p>
<p>&quot;What Saleem just demonstrated is: with [a short] script you can generate a cert for any website, and it&apos;s fully trusted on IE and Edge with just the default settings for Windows,&quot; Kenn White, a researcher and security principal at MongoDB, said. That&apos;s fairly horrifying. It affects VPN gateways, VoIP, basically anything that uses network communications.&quot; (I spoke with White before Rashid had demonstrated the attack against Chrome.)</p>
<p>The flaw involves the way the new versions of Windows check the validity of certificates that use <a href="https://arstechnica.com/information-technology/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/">elliptic-curve cryptography</a>. While the vulnerable Windows versions check three ECC parameters, they fail to verify a fourth, crucial one, which is known as a base point generator and is often represented in algorithms as &apos;G.&apos; This failure is a result of Microsoft&apos;s implementation of ECC rather than any flaw or weakness in the ECC algorithms themselves.</p>
<p>Attackers can exploit the flaw by extracting the public key of a root certificate that ships by default in Windows. These certificates are described as root because they belong to big certificate authorities that either issue their own TLS certificates or validate intermediate certificate authorities that sell certificates on the root CA&apos;s behalf. Any root certificate will work, as long as it&apos;s signed with an ECC algorithm. Rashid&apos;s attack started with a root certificate from Sectigo, the Internet&apos;s biggest CA, which previously used the name Comodo. The researcher later modified his attack to use a GlobalSign root certificate. His code made the switch automatic.</p>
<p>The attacker examines the specific ECC algorithm used to generate the root-certificate public key and proceeds to craft a private key that copies all of the certificate parameters for that algorithm except for the point generator. Because vulnerable Windows versions fail to check that parameter, they accept the private key as valid. With that, the attacker has spoofed a Windows-trusted root certificate that can be used to mint any individual certificate used for authentication of websites, software, and other sensitive properties.</p>
<p>The behavior is tantamount to a law enforcement officer who checks someone&apos;s ID to make sure it properly describes the person&apos;s height, address, birthday, and face but fails to notice that the weight is listed as 250 pounds when the person clearly weighs less than half that.</p>
<p>&quot;It&apos;s such a strange bug, because it&apos;s like they&apos;re only halfway checking something that is at the root of the entire trust system,&quot; White said. &quot;It&apos;s a core part of the whole chain of trust.&quot;</p>
<p>For more detailed technical explanations of the bug, see posts <a href="https://news.ycombinator.com/item?id=22048619">here</a> and <a href="https://blog.lessonslearned.org/chain-of-fools/">here</a>&#xA0;and the Twitter thread <a href="https://twitter.com/swiftonsecurity/status/1217159419533893633?s=21">here</a>.</p>
<h2>The caveats</h2>
<p>As noted earlier, there are several requirements and constraints that significantly raise the bar for Rashid&apos;s attack to work in real-world uses by an adversary. The first is that it most likely requires an active <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">man-in-the-middle</a> attack. These types of attacks, which modify data as it passes through networks, may be difficult to carry out. An alternative to an active MitM is to convince a target to click on a fake URL. This method is much easier, but it also requires some targeting. (It wouldn&apos;t apply to attacks against websites or other servers that require a certificate from the connecting client.)</p>
<p>The exploit also requires that the target has recently visited a site with a <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Certificate_pinning">transport layer security</a> certificate that&apos;s chained to an ECC-signed root certificate. That&apos;s because the root certificate must already be cached by the targeted system. In the event a targeted system doesn&apos;t have the root certificate cached, Rashid said, an attacker could still pull off an exploit by adding JavaScript that accesses a site chained to the root certificate.</p>
<p>Another constraint: Chrome uses a mechanism known as <a href="https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning">certificate pinning</a> for google.com and a variety of other sensitive websites. Pinning requires that the certificate authenticating a website contain a specific <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash</a>, even if the certificate offered is otherwise valid. This measure would prevent exploits from working when they spoofed protected sites.</p>
<p>While installing Tuesday&apos;s patch by Microsoft is by far the only reasonable way to prevent attacks, a Google representative said Chrome developers have already distributed a fix in a beta version and will fold the fix into stable versions soon. A word of caution: even with this fix, users of vulnerable Windows versions will still face considerable risk from other attack scenarios.</p>
<h2>A matter of time</h2>
<p>Despite the requirements and limitations, the vulnerability is serious. As NSA officials put it in the above-linked advisory:</p>
<blockquote><p>The vulnerability places Windows endpoints at risk to a broad range of exploitation vectors. NSA assesses the vulnerability to be severe and that sophisticated cyber actors will understand the underlying flaw very quickly and, if exploited, would render the previously mentioned platforms as fundamentally vulnerable. The consequences of not patching the vulnerability are severe and widespread. Remote exploitation tools will likely be made quickly and widely available. Rapid adoption of the patch is the only known mitigation at this time and should be the primary focus for all network owners.</p></blockquote>
<p>The vulnerability may not pose as extreme a threat as those caused by the <a href="http://arstechnica.com/security/2014/04/critical-crypto-bug-in-openssl-opens-two-thirds-of-the-web-to-eavesdropping/">Heartbleed flaw in 2014</a> that allowed attackers to <a href="https://arstechnica.com/information-technology/2014/04/how-i-used-heartbleed-to-steal-a-sites-private-crypto-key/">steal private keys</a>, passwords, and other highly sensitive data from hundreds of thousands of vulnerable sites. But because of the breadth of security measures foiled by the Microsoft vulnerability, it&apos;s worse even than Apple&apos;s critical <a href="https://arstechnica.com/information-technology/2014/02/four-days-in-and-still-no-patch-for-os-x-critical-goto-fail-bug/">goto fail flaw</a>, which prevented iOS and macOS systems from detecting invalid TLS certificates served by websites. That makes CVE-2020-0601 one of the most severe vulnerabilities in recent memory.</p>
<p>Windows&apos; automatic update mechanism is likely to have patched vulnerable systems already. For anyone else, fixes for various vulnerable versions are available <a href="https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0601#ID0EGB">here</a>. Readers who haven&apos;t patched yet should do so immediately.</p>
<p><em>Post updated to correct description of certificate pinning and discussion of man-in-the-middle attacks.</em></p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>