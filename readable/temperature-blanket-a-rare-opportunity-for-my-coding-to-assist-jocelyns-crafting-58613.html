<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Temperature Blanket - A Rare Opportunity for My Coding to Assist Jocelyn&#x27;s Crafting - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Temperature Blanket - A Rare Opportunity for My Coding to Assist Jocelyn&#x27;s Crafting - linksfor.dev(s)"/>
    <meta property="og:description" content="In which, after almost 17 years, Mrs Nelson finally has cause to call upon my programming skills."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://blog.iannelson.uk/temperature-blanket/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Temperature Blanket - A Rare Opportunity for My Coding to Assist Jocelyn&#x27;s Crafting</title>
<div class="readable">
        <h1>Temperature Blanket - A Rare Opportunity for My Coding to Assist Jocelyn&#x27;s Crafting</h1>
            <div>Reading time: 5-6 minutes</div>
        <div>Posted here: 20 Feb 2020</div>
        <p><a href="https://blog.iannelson.uk/temperature-blanket/">https://blog.iannelson.uk/temperature-blanket/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><article>

		<!-- .post-header -->


		<div>
			<p>As the resident geek in our family, it won't surprise you to hear that I am occasionally approached by Jocelyn and our kids to provide tech support. Sadly, most of these queries are invariably of the "how do I print from my phone" or "the Sky box stopped working" ilk, and rarely trouble my software skills. So it came as a pleasant surprise when I recently encountered a genuine reason to use .NET, APIs and Docker in support of one of Jocelyn's craft projects.</p><p>Jocelyn has embarked on crocheting a <em>Temperature Blanket</em> throughout 2020. This will consist of 366 squares, one for each day of this leap year, in colours corresponding to the minimum, maximum and average temperatures that we experienced on that day.</p><figure><img src="https://blog.iannelson.uk/content/images/2020/02/IMG_20200216_190322-1.jpg" alt="Jocelyn's colour blanket so far, spread over my computer keyboard"><figcaption>Lots of blue so far. I'm hoping that changes soon...</figcaption></figure><p>And here was the rub - a notable absence of websites that provided these three daily data points for a location close to home. Some sites only had minimum and maximum, but no average. Others considered a "day" to run from, say, 4am to 4am, rather than midnight to midnight, which just isn't in the spirit of the project. Still others offered the data points she needed, but not for any place close to home.</p><figure><img src="https://blog.iannelson.uk/content/images/2020/02/IMG_20200216_190534.jpg" alt="The temperature-to-colour key for Jocelyn's 2020 temperature blanket"><figcaption>I'm looking forward to some violet days</figcaption></figure><p>Here was my opportunity to help and earn some husbandly brownie points! I already had an account for the excellent <a href="https://darksky.net/dev">Dark Sky API</a>, which offers forecast and historical weather data by latitude and longitude. Further, <a href="https://www.adamweiss.me/">Adam Weiss</a> has made available <a href="https://github.com/amweiss/dark-sky-core">dark-sky-core</a>, a .NET Standard Nuget Package for accessing this API from .NET code. I fired up Rider, started a new console app, bashed out the following quick function, and proudly presented the desired figures to Mrs Nelson.</p><!--kg-card-begin: html--><div id="gist101249869">
    <div>
      <div>
        <div>
  <div id="file-main-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-main-cs-L1" data-line-number="1"></td>
        <td id="file-main-cs-LC1"><span>static</span> <span>void</span> <span>Main</span>(<span>string</span>[] <span>args</span>)</td>
      </tr>
      <tr>
        <td id="file-main-cs-L2" data-line-number="2"></td>
        <td id="file-main-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-main-cs-L3" data-line-number="3"></td>
        <td id="file-main-cs-LC3">    <span>var</span> <span>darkSky</span> <span>=</span> <span>new</span> <span>DarkSky</span>.<span>Services</span>.<span>DarkSkyService</span>(<span><span>"</span>API_KEY_HERE<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L4" data-line-number="4"></td>
        <td id="file-main-cs-LC4">
</td>
      </tr>
      <tr>
        <td id="file-main-cs-L5" data-line-number="5"></td>
        <td id="file-main-cs-LC5">    <span>var</span> <span>date</span> <span>=</span> <span>new</span> <span>DateTime</span>(<span>2020</span>,<span>1</span>,<span>1</span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L6" data-line-number="6"></td>
        <td id="file-main-cs-LC6">
</td>
      </tr>
      <tr>
        <td id="file-main-cs-L7" data-line-number="7"></td>
        <td id="file-main-cs-LC7">    <span>do</span></td>
      </tr>
      <tr>
        <td id="file-main-cs-L8" data-line-number="8"></td>
        <td id="file-main-cs-LC8">    {</td>
      </tr>
      <tr>
        <td id="file-main-cs-L9" data-line-number="9"></td>
        <td id="file-main-cs-LC9">        <span>var</span> <span>forecast</span> <span>=</span> <span>darkSky</span>.<span>GetForecast</span>(<span>53.812174</span>, <span>-</span><span>1.096165</span>,</td>
      </tr>
      <tr>
        <td id="file-main-cs-L10" data-line-number="10"></td>
        <td id="file-main-cs-LC10">            <span>new</span> <span>OptionalParameters</span>{<span>MeasurementUnits</span> <span>=</span><span><span>"</span>uk2<span>"</span></span>, <span>ForecastDateTime</span> <span>=</span> <span>date</span>}).<span>Result</span>;</td>
      </tr>
      <tr>
        <td id="file-main-cs-L11" data-line-number="11"></td>
        <td id="file-main-cs-LC11">
</td>
      </tr>
      <tr>
        <td id="file-main-cs-L12" data-line-number="12"></td>
        <td id="file-main-cs-LC12">        <span>var</span> <span>temperatureLow</span> <span>=</span> <span>Math</span>.<span>Round</span>(<span>forecast</span>.<span>Response</span>.<span>Daily</span>.<span>Data</span>[<span>0</span>].<span>TemperatureMin</span>.<span>Value</span>, <span>0</span>, <span>MidpointRounding</span>.<span>AwayFromZero</span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L13" data-line-number="13"></td>
        <td id="file-main-cs-LC13">        <span>var</span> <span>temperatureHigh</span> <span>=</span> <span>Math</span>.<span>Round</span>(<span>forecast</span>.<span>Response</span>.<span>Daily</span>.<span>Data</span>[<span>0</span>].<span>TemperatureMax</span>.<span>Value</span>, <span>0</span>,</td>
      </tr>
      <tr>
        <td id="file-main-cs-L14" data-line-number="14"></td>
        <td id="file-main-cs-LC14">            <span>MidpointRounding</span>.<span>AwayFromZero</span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L15" data-line-number="15"></td>
        <td id="file-main-cs-LC15">        <span>var</span> <span>temperatureAverage</span> <span>=</span></td>
      </tr>
      <tr>
        <td id="file-main-cs-L16" data-line-number="16"></td>
        <td id="file-main-cs-LC16">            <span>Math</span>.<span>Round</span>(<span>forecast</span>.<span>Response</span>.<span>Hourly</span>.<span>Data</span>.<span>Select</span>(<span>x</span> <span>=&gt;</span> <span>x</span>.<span>Temperature</span>.<span>Value</span>).<span>Average</span>(), <span>0</span>, <span>MidpointRounding</span>.<span>AwayFromZero</span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L17" data-line-number="17"></td>
        <td id="file-main-cs-LC17">
</td>
      </tr>
      <tr>
        <td id="file-main-cs-L18" data-line-number="18"></td>
        <td id="file-main-cs-LC18">        <span>Console</span>.<span>WriteLine</span>(<span><span>$"</span>Date: {<span>date</span>.<span>ToShortDateString</span>()};   Min: {<span>temperatureLow</span>,<span>2</span>};   Max: {<span>temperatureHigh</span>,<span>2</span>};   Avg: {<span>temperatureAverage</span>,<span>2</span>}<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L19" data-line-number="19"></td>
        <td id="file-main-cs-LC19">
</td>
      </tr>
      <tr>
        <td id="file-main-cs-L20" data-line-number="20"></td>
        <td id="file-main-cs-LC20">        <span>date</span> <span>=</span> <span>date</span>.<span>AddDays</span>(<span>1</span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L21" data-line-number="21"></td>
        <td id="file-main-cs-LC21">    } <span>while</span> (<span>date</span><span>&lt;</span><span>DateTime</span>.<span>Today</span>);</td>
      </tr>
      <tr>
        <td id="file-main-cs-L22" data-line-number="22"></td>
        <td id="file-main-cs-LC22">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<!--kg-card-end: html--><p>Scope creep inevitably presented itself at this point, as a console application didn't meet UX requirements. </p><p><em>"That's great Ian - now can you get it to email me the figures every day?"</em></p><p>Hmm. I didn't want to get into <em>that</em>, but I could do one better, and make this into a simple self-service dedicated website. I launched a new Rider instance and created a boilerplate ASP.NET website to show the desired temperatures for the preceding 28 days. I added a standard Dockerfile, built and pushed a container image, and deployed it to an Azure App Service Plan. The final touch was to configure a memorable subdomain and so it was that <a href="http://blanket.iannelson.uk/">http://blanket.iannelson.uk</a> was born.</p><p>The (rough and ready) source code for both the console application and web version can be found on GitHub:</p><ul><li><a href="https://github.com/ianfnelson/ColourBlanket">https://github.com/ianfnelson/ColourBlanket</a></li><li><a href="https://github.com/ianfnelson/ColourBlanketWeb">https://github.com/ianfnelson/ColourBlanketWeb</a></li></ul><p>Photos of Jocelyn's other colourful creations (and the occasional photobomb from our Miniature Schnauzer) can be found <a href="https://www.instagram.com/jocelyngnelson/">on her Instagram profile</a>.</p><figure>
</figure>
		</div><!-- .post-content -->

		<!-- .post-footer -->

		<!-- .comments-area -->




	</article></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>