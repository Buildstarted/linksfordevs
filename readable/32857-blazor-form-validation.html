<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Blazor form validation -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <style type="text/css">
        html {
            font-family: sans-serif;
            line-height: 1.15;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            height: 100%;
        }

        *, ::after, ::before {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #60656a;
            text-align: left;
            background-color: #323b44;
        }

        h1 {
            font-size: 6rem;
            font-weight: 300;
            line-height: 1.2;
            margin-top: 0;
            margin-bottom: 0.5rem;
            margin-bottom: 0.5rem
        }

        a {
            color: #007bff;
            color: #ccc;
            text-decoration: none;
            background-color: transparent;
            word-break: break-all;
        }

        .unseen a {
            font-weight: bold;
        }

        h3 {
            margin-top: 0;
            padding-top: 0;
            font-weight: normal;
        }

        .grid {
            -ms-flex-direction: column;
            flex-direction: column;
            width: 1024px;
            margin: 0 auto;
            flex: 1 0 auto;
        }

        .row {
            -ms-flex-direction: row;
            flex-direction: row;
            width: 100%;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            display: -ms-flexbox;
            display: flex;
        }

        .col {
            margin: 0 10px 0 10px;
            box-sizing: border-box;
            vertical-align: top;
        }

        .col-3-of-4, .col-6-of-8, .col-9-of-12 {
            width: calc(75% - 20px);
        }

        .col-1-of-4, .col-2-of-8, .col-3-of-12 {
            width: calc(25% - 20px);
        }

        @media (max-width:1023px) {
            /* big landscape tablets, laptops, and desktops */
            body {
                overflow-x: hidden;
            }

            main {
                width: 99%;
            }

            h1 {
                font-size: 50px;
            }
        }

        .text-right {
            text-align: right;
        }

        footer {
            left: 0;
            width: 100%;
            margin-top: 2em;
            padding: 50px 0;
            text-align: center;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        .readable {
            color: #949ba2;
        }

        svg:not(:root).svg-inline--fa {
            color: #60656a;
            overflow: visible;
        }

        .svg-inline--fa.fa-w-12 {
            width: 0.75em;
        }

        svg:not(:root) {
            overflow: hidden;
        }

        .svg-inline--fa {
            display: inline-block;
            font-size: inherit;
            height: 1em;
            overflow: visible;
            vertical-align: -0.125em;
        }

        img {
            max-width: 100%;
        }

        .text-center {
            text-align: center;
        }

        .readable h1 {
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Blazor form validation</h1>
    <div class="entry-content clearfix"><p>Client-side Blazor supports DataAnnotations form validation out of box. It&#x2019;s simple and intuitive but also very flexible &#x2013; if needed we can use the same mechanism to replace DataAnnotations validation with some other validation component. This blog post introduces form validation in Blazor applications and peeks also into engine of validation mechanism.</p><blockquote><p><strong>NB!</strong> Form validation in Blazor is experimental and subject to changes. This blog post is written using .NET Core 3.0 Preview 7.</p></blockquote><h3>Data annotations validation</h3><p>Blazor supports <a href="https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.dataannotations?view=netcore-3.0">DataAnnotations validation</a> out-of-box. To use validation we have to have model with data annotations and edit form defined in Blazor view.</p><p>Let&#x2019;s create simple model for guestbook. It has properties for poster name and message.</p><pre><span>public</span>&#xA0;<span>class</span>&#xA0;<span>GuestbookEntry</span>{<p>&#xA0;&#xA0;&#xA0; [<span>Required</span>]</p><br>&#xA0;&#xA0;&#xA0; [<span>MaxLength</span>(10)]<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>string</span> Name { <span>get</span>; <span>set</span>; } <p>&#xA0;&#xA0;&#xA0; [<span>Required</span>]</p><br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>string</span> Text { <span>get</span>; <span>set</span>; }<br>}</pre><p>Here is Blazor form that uses out-of-box form validation. I followed same pattern with validation messages that should be familiar at least those who know ASP.NET MVC.</p><pre><span>@page</span>&#xA0;<span>&quot;/&quot;</span><br><span>@</span>using&#xA0; BlazorFormValidation.Models <p><span>&lt;</span><span>h1</span><span>&gt;</span>My guestbook<span>&lt;/</span><span>h1</span><span>&gt;</span></p> <p><span>&lt;</span><span>p</span><span>&gt;</span>Leave me a message if you like my site<span>&lt;/</span><span>p</span><span>&gt;</span></p> <p><span>&lt;</span><span>EditForm</span>&#xA0;<span>Model</span><span>=</span><span>&quot;</span><span>@</span>Model<span>&quot;</span>&#xA0;<span>OnValidSubmit</span><span>=</span><span>&quot;</span><span>@</span><span>HandleValidSubmit</span><span>&quot;</span>&#xA0;<span>OnInvalidSubmit</span><span>=</span><span>&quot;</span><span>@</span><span>HandleInvalidSubmit</span><span>&quot;</span><span>&gt;</span></p><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;alert </span><span>@</span>StatusClass<span>&quot;</span><span>&gt;</span><span>@</span>StatusMessage<span>&lt;/</span><span>div</span><span>&gt;</span>&#xA0;&#xA0;&#xA0; <p>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>DataAnnotationsValidator</span>&#xA0;<span>/&gt;</span></p><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationSummary</span>&#xA0;<span>/&gt;</span>&#xA0;&#xA0;&#xA0; <p>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span></p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;name&quot;</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputText</span>&#xA0;<span>Id</span><span>=</span><span>&quot;name&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Name<span>&quot;</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Name)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;body&quot;</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputTextArea</span>&#xA0;<span>Id</span><span>=</span><span>&quot;body&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Text<span>&quot;</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Text)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>button</span>&#xA0;<span>type</span><span>=</span><span>&quot;submit&quot;</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span> <p><span>&lt;/</span><span>EditForm</span><span>&gt;</span></p> <p><span>@code</span>&#xA0;</p><br><span>{</span><br>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>string</span> StatusMessage;<br>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>string</span> StatusClass; <p>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>GuestbookEntry</span> Model = <span>new</span>&#xA0;<span>GuestbookEntry</span>();</p> <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>void</span>&#xA0;<span>HandleValidSubmit</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; StatusClass = <span>&quot;alert-info&quot;</span>;</p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; StatusMessage = <span>DateTime</span>.Now + <span>&quot; Handle valid submit&quot;</span>;&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>void</span>&#xA0;<span>HandleInvalidSubmit</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; StatusClass = <span>&quot;alert-danger&quot;</span>;</p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; StatusMessage = <span>DateTime</span>.Now + <span>&quot; Handle invalid submit&quot;</span>;&#xA0;&#xA0;&#xA0; }<p><span>}</span></p></pre><p>EditForm is Blazor container for forms. Validator is added like any other Blazor component. Page above uses DataAnnotationValidator but you can create custom one if you like.</p><p>Here is the screenshot demonstrating form when fields are empty and Ok button is clicked.</p><p><a href="https://gpfblog.azureedge.net/wp-content/uploads/2019/08/blazor-form-validation-failed.png.webp"><img class="lazyload" width="1199" alt="Blazor guestbook form is invalid" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%201199%20910%22%3E%3C/svg%3E" srcset="https://gpfblog.azureedge.net/wp-content/uploads/2019/08/blazor-form-validation-failed_thumb.png.webp"></a></p><p>This is the form with successful validation.</p><p><a href="https://gpfblog.azureedge.net/wp-content/uploads/2019/08/blazor-form-validation-succeeded.png.webp"><img class="lazyload" width="1196" alt="Blazor guestbook form is valid" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%201196%20743%22%3E%3C/svg%3E" srcset="https://gpfblog.azureedge.net/wp-content/uploads/2019/08/blazor-form-validation-succeeded_thumb.png.webp"></a></p><p>I think most of developers will be okay with this solution and I can finish this writing. Or no?</p><h3>Disable button until form is valid</h3><p>We can actually dig deeper and try something fancy. What if we want Ok button to be disabled while form is invalid? I found blog post <a href="https://blogs.u2u.be/peter/post/disabling-the-submit-button-in-blazor-with-validation">Disabling the Submit button in Blazor Validation</a> by <a href="https://twitter.com/peterhimschoot">Peter Himschoot</a> where he provider solution through custom InputWatcher.</p><p>My solution is smaller. We can assign to EditForm either Model or EditContext but not both at same time. When using EditContext we have way more control over validation. This way I solved the need for additional component.</p><p>I solved button disabled status problem with simple but not so straightforward trick. Instead of boolean true-false value for disabled attribute I went with string. Value is either &#x201C;disabled&#x201D; or null. Notice that empty string leaves &#x201C;disabled&#x201D; attribute on button. I had to listen to field change event just like Peter did.</p><pre><span>@page</span>&#xA0;<span>&quot;/&quot;</span><br><span>@</span>using&#xA0; BlazorFormValidation.Models <p><span>&lt;</span><span>h1</span><span>&gt;</span>My guestbook<span>&lt;/</span><span>h1</span><span>&gt;</span></p> <p><span>&lt;</span><span>p</span><span>&gt;</span>Leave me a message if you like my site<span>&lt;/</span><span>p</span><span>&gt;</span></p> <p><span>&lt;</span><span>EditForm</span>&#xA0;<span>EditContext</span><span>=</span><span>&quot;</span><span>@</span>EditContext<span>&quot;</span><span>&gt;</span>&#xA0;&#xA0; </p><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>DataAnnotationsValidator</span>&#xA0;<span>/&gt;</span>&#xA0;&#xA0;&#xA0; <p>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span></p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;name&quot;</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputText</span>&#xA0;<span>Id</span><span>=</span><span>&quot;name&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Name<span>&quot;</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Name)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;body&quot;</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputTextArea</span>&#xA0;<span>Id</span><span>=</span><span>&quot;body&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Text<span>&quot;</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Text)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>button</span>&#xA0;<span>type</span><span>=</span><span>&quot;submit&quot;</span>&#xA0;<span>disabled</span><span>=</span><span>&quot;</span><span>@</span>OkayDisabled<span>&quot;</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span> <p><span>&lt;/</span><span>EditForm</span><span>&gt;</span></p> <p><span>@code</span>&#xA0;</p><br><span>{</span><br>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>EditContext</span> EditContext;<br>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>GuestbookEntry</span> Model = <span>new</span>&#xA0;<span>GuestbookEntry</span>(); <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>string</span> OkayDisabled { <span>get</span>; <span>set</span>; } = <span>&quot;disabled&quot;</span>;</p> <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>override</span>&#xA0;<span>void</span>&#xA0;<span>OnInit</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EditContext = <span>new</span>&#xA0;<span>EditContext</span>(Model);</p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EditContext.OnFieldChanged += <span>EditContext_OnFieldChanged</span>; <p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>base</span>.<span>OnInit</span>();</p>&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>override</span>&#xA0;<span>void</span>&#xA0;<span>OnAfterRender</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>base</span>.<span>OnAfterRender</span>();</p> <p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>SetOkDisabledStatus</span>();</p>&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>void</span>&#xA0;<span>EditContext_OnFieldChanged</span>(<span>object</span>&#xA0;<span>sender</span>, <span>FieldChangedEventArgs</span>&#xA0;<span>e</span>)</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>SetOkDisabledStatus</span>();</p>&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>void</span>&#xA0;<span>SetOkDisabledStatus</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>if</span>(EditContext.<span>Validate</span>())</p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OkayDisabled = <span>null</span>;</p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>else</span></p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OkayDisabled = <span>&quot;disabled&quot;</span>;</p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }&#xA0;&#xA0;&#xA0; }<p><span>}</span></p></pre><p>This is how guestbook opens when I run it. Validation messages are shown for fields and Ok button is disabled.</p><p><a href="https://gpfblog.azureedge.net/wp-content/uploads/2019/08/blazor-form-validation-disable-button.png.webp"><img class="lazyload" width="1197" alt="Blazor guestbook: button is disabled if form is invalid" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%201197%20886%22%3E%3C/svg%3E" srcset="https://gpfblog.azureedge.net/wp-content/uploads/2019/08/blazor-form-validation-disable-button_thumb.png.webp"></a></p><p>With EditContext class we were able to take form under our control.</p><h3>Inside EditContext class</h3><p>There&#x2019;s more about EditContext. Take a look at EditContext class definiton.</p><pre><span>public</span>&#xA0;<span>sealed</span>&#xA0;<span>class</span>&#xA0;<span>EditContext</span>{<p>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>EditContext</span>(<span>object</span>&#xA0;<span>model</span>);</p><br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>object</span> Model { <span>get</span>; } <p>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>event</span>&#xA0;<span>EventHandler</span>&lt;<span>FieldChangedEventArgs</span>&gt; OnFieldChanged;</p><br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>event</span>&#xA0;<span>EventHandler</span>&lt;<span>ValidationRequestedEventArgs</span>&gt; OnValidationRequested;<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>event</span>&#xA0;<span>EventHandler</span>&lt;<span>ValidationStateChangedEventArgs</span>&gt; OnValidationStateChanged; <p>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>FieldIdentifier</span>&#xA0;<span>Field</span>(<span>string</span>&#xA0;<span>fieldName</span>);</p><br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>IEnumerable</span>&lt;<span>string</span>&gt; <span>GetValidationMessages</span>();<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>IEnumerable</span>&lt;<span>string</span>&gt; <span>GetValidationMessages</span>(<span>FieldIdentifier</span>&#xA0;<span>fieldIdentifier</span>);<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>bool</span>&#xA0;<span>IsModified</span>();<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>bool</span>&#xA0;<span>IsModified</span>(<span>in</span>&#xA0;<span>FieldIdentifier</span>&#xA0;<span>fieldIdentifier</span>);<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>void</span>&#xA0;<span>MarkAsUnmodified</span>(<span>in</span>&#xA0;<span>FieldIdentifier</span>&#xA0;<span>fieldIdentifier</span>);<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>void</span>&#xA0;<span>MarkAsUnmodified</span>();<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>void</span>&#xA0;<span>NotifyFieldChanged</span>(<span>in</span>&#xA0;<span>FieldIdentifier</span>&#xA0;<span>fieldIdentifier</span>);<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>void</span>&#xA0;<span>NotifyValidationStateChanged</span>();<br>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>bool</span>&#xA0;<span>Validate</span>();<br>}</pre><p>It has events that are triggered for changes. We have methods to mark fields as unmodified, it&#x2019;s easy to get field ID used bu Blazor and notify EditContext of changes if we need.</p><h3>Check validation status when field changes</h3><p>There&#x2019;s one more minor thing to solve on our form. When form gets valid I want Ok button to be enabled at same moment and not when I leave the field. This functionality would be great for fields validated by regular expression, by example.</p><p>After some research and hacking I came out with ugly solution using KeyUp event and reflection (I&#x2019;m sure Blazor guys don&#x2019;t want you to do it at home). But here my solution is.</p><pre><span>@page</span>&#xA0;<span>&quot;/&quot;</span><br><span>@</span>using&#xA0; BlazorFormValidation.Models <p><span>&lt;</span><span>h1</span><span>&gt;</span>My guestbook<span>&lt;/</span><span>h1</span><span>&gt;</span></p> <p><span>&lt;</span><span>p</span><span>&gt;</span>Leave me a message if you like my site<span>&lt;/</span><span>p</span><span>&gt;</span></p> <p><span>&lt;</span><span>EditForm</span>&#xA0;<span>EditContext</span><span>=</span><span>&quot;</span><span>@</span>EditContext<span>&quot;</span><span>&gt;</span></p><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>DataAnnotationsValidator</span>&#xA0;<span>/&gt;</span> <p>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span></p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;name&quot;</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputText</span>&#xA0;<span>Id</span><span>=</span><span>&quot;name&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Name<span>&quot;</span>&#xA0;<span>onkeyup</span><span>=</span><span>&apos;</span><span>@(</span><span>e</span> =&gt; KeyUp(<span>e</span>, <span>&quot;Name&quot;</span>)<span>)</span><span>&apos;</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Name)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;body&quot;</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputTextArea</span>&#xA0;<span>Id</span><span>=</span><span>&quot;body&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Text<span>&quot;</span>&#xA0;<span>onkeyup</span><span>=</span><span>&apos;</span><span>@(</span><span>e</span> =&gt; KeyUp(<span>e</span>, <span>&quot;Text&quot;</span>)<span>)</span><span>&apos;</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Text)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>button</span>&#xA0;<span>type</span><span>=</span><span>&quot;submit&quot;</span>&#xA0;<span>disabled</span><span>=</span><span>&quot;</span><span>@</span>OkayDisabled<span>&quot;</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span> <p><span>&lt;/</span><span>EditForm</span><span>&gt;</span></p> <p><span>@code</span></p><br><span>{</span><br>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>EditContext</span> EditContext;<br>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>GuestbookEntry</span> Model = <span>new</span>&#xA0;<span>GuestbookEntry</span>(); <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>string</span> OkayDisabled { <span>get</span>; <span>set</span>; } = <span>&quot;disabled&quot;</span>;</p> <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>override</span>&#xA0;<span>void</span>&#xA0;<span>OnInit</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EditContext = <span>new</span>&#xA0;<span>EditContext</span>(Model);</p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EditContext.OnFieldChanged += <span>EditContext_OnFieldChanged</span>; <p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>base</span>.<span>OnInit</span>();</p>&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>protected</span>&#xA0;<span>override</span>&#xA0;<span>void</span>&#xA0;<span>OnAfterRender</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>base</span>.<span>OnAfterRender</span>();</p> <p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>SetOkDisabledStatus</span>();</p>&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>void</span>&#xA0;<span>EditContext_OnFieldChanged</span>(<span>object</span>&#xA0;<span>sender</span>, <span>FieldChangedEventArgs</span>&#xA0;<span>e</span>)</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>SetOkDisabledStatus</span>();</p>&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>void</span>&#xA0;<span>KeyUp</span>(<span>UIKeyboardEventArgs</span>&#xA0;<span>e</span>, <span>string</span>&#xA0;<span>memberName</span>)</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>var</span>&#xA0;<span>property</span> = Model.<span>GetType</span>().<span>GetProperty</span>(<span>memberName</span>);</p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>var</span>&#xA0;<span>value</span> = <span>property</span>.<span>GetValue</span>(Model);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>property</span>.<span>SetValue</span>(Model, <span>value</span> + <span>e</span>.Key); <p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>var</span>&#xA0;<span>id</span> = EditContext.<span>Field</span>(<span>memberName</span>);</p> <p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EditContext.<span>NotifyFieldChanged</span>(<span>id</span>);</p>&#xA0;&#xA0;&#xA0; } <p>&#xA0;&#xA0;&#xA0; <span>private</span>&#xA0;<span>void</span>&#xA0;<span>SetOkDisabledStatus</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>if</span> (EditContext.<span>Validate</span>())</p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OkayDisabled = <span>null</span>;</p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>else</span></p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OkayDisabled = <span>&quot;disabled&quot;</span>;</p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }&#xA0;&#xA0;&#xA0; }<p><span>}</span></p></pre><p>It&#x2019;s a small thing but users will love it. We just made our form even more responsive.</p><h3>Using other validators</h3><p>I found <a href="https://chrissainty.com/using-fluentvalidation-for-forms-validation-in-razor-components/">FluentValidation support for Blazor</a> by <a href="https://twitter.com/chris_sainty">Chris Sainty</a>. <a href="https://fluentvalidation.net/">FluentValidation</a> is popular validation library that supports also advanced validation scenarios.</p><p>With FluentValidation we use validator classes like the one shown here.</p><pre><span>public</span>&#xA0;<span>class</span>&#xA0;<span>GuestbookEntryValidator</span> : <span>AbstractValidator</span>&lt;<span>GuestbookEntry</span>&gt;{<p>&#xA0;&#xA0;&#xA0; <span>public</span>&#xA0;<span>GuestbookEntryValidator</span>()</p>&#xA0;&#xA0;&#xA0; {<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>RuleFor</span>(<span>e</span> =&gt; <span>e</span>.Name)</p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .<span>NotEmpty</span>().<span>WithMessage</span>(<span>&quot;Name is required&quot;</span>)<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .<span>MaximumLength</span>(10).<span>WithMessage</span>(<span>&quot;10 characters maximum&quot;</span>); <p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>RuleFor</span>(<span>e</span> =&gt; <span>e</span>.Text)</p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .<span>NotEmpty</span>().<span>WithMessage</span>(<span>&quot;Text is required&quot;</span>);&#xA0;&#xA0;&#xA0; }<p>}</p></pre><p>Our form doesn&#x2019;t change much. We just have to change validator component.</p><pre><span>&lt;</span><span>EditForm</span>&#xA0;<span>EditContext</span><span>=</span><span>&quot;</span><span>@</span>EditContext<span>&quot;</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>FluentValidationValidator</span>&#xA0;<span>/&gt;</span> <p>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span></p><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;name&quot;</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputText</span>&#xA0;<span>Id</span><span>=</span><span>&quot;name&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Name<span>&quot;</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Name)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>div</span>&#xA0;<span>class</span><span>=</span><span>&quot;form-group&quot;</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>label</span>&#xA0;<span>for</span><span>=</span><span>&quot;body&quot;</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>InputTextArea</span>&#xA0;<span>Id</span><span>=</span><span>&quot;body&quot;</span>&#xA0;<span>Class</span><span>=</span><span>&quot;form-control&quot;</span>&#xA0;<span>@</span><span>bind-Value</span><span>=</span><span>&quot;</span><span>@</span>Model.Text<span>&quot;</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>ValidationMessage</span>&#xA0;<span>For</span><span>=</span><span>&quot;</span><span>@</span>(() =&gt; Model.Text)<span>&quot;</span>&#xA0;<span>/&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&#xA0;&#xA0;&#xA0; <span>&lt;</span><span>button</span>&#xA0;<span>type</span><span>=</span><span>&quot;submit&quot;</span>&#xA0;<span>disabled</span><span>=</span><span>&quot;</span><span>@</span>OkayDisabled<span>&quot;</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span> <p><span>&lt;/</span><span>EditForm</span><span>&gt;</span></p></pre><p>Now we can use full power of FluentValidator on our forms. Check out FluentValidationValidator souce code from Github repository <a href="https://github.com/chrissainty/FluentValidationWithRazorComponents">chrissainty/FluentValidationWithRazorComponents</a>.</p><h3>Wrapping up</h3><p>There&#x2019;s two ways how to go with validation on Blazor. We can use Model property of EditForm and keep things simple for us. If we need more control over validation and UI then we can provide EditContext to EditForm. Those who want to go deep to internals can see how Christ Sainty integrated FluentValidation to Blazor. Although there can be changes to form validation over coming releases of Blazor we can still start building our own advanced components to use with Blazor applications.</p></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
</body>
</html>