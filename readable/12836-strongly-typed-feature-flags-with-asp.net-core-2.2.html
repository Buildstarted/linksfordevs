<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Strongly Typed Feature Flags With ASP.NET Core 2.2 -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Strongly Typed Feature Flags With ASP.NET Core 2.2</h1><div><div id="" class=""><p class="freshness" data-freshness-datetime="2019-04-03T08:30:00-04:00"><i class="icon heartbeat freshness-icon-js"></i><em>This post is <span class="freshness-days-old-js"></span> days old.</em></p><p>Feature flags can be useful for changing the runtime behavior of an application with minimal impact. Having a UI to toggle the feature flags on and off is extra helpful, too!</p><p>That said, we built a library to enable this in a strongly typed fashion! Here’s what the UI looks like:</p><p><img src="https://raw.githubusercontent.com/ritterim/RimDev.FeatureFlags/master/screenshot.png" alt="RimDev.AspNetCore.FeatureFlags Screenshot" class="img-fluid border"></p><h2 id="installation">Installation</h2><p>Install the <a href="https://www.nuget.org/packages/RimDev.AspNetCore.FeatureFlags">RimDev.AspNetCore.FeatureFlags</a> NuGet package.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; dotnet add package RimDev.AspNetCore.FeatureFlags
</code></pre></div></div><p>or</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PM&gt; Install-Package RimDev.AspNetCore.FeatureFlags
</code></pre></div></div><h2 id="usage">Usage</h2><p>You’ll need to wire up <code class="language-plaintext highlighter-rouge">Startup.cs</code> as follows:</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">Microsoft.AspNetCore.Builder</span><span class="p">;</span><span class="k">using</span><span class="nn">Microsoft.AspNetCore.Hosting</span><span class="p">;</span><span class="k">using</span><span class="nn">Microsoft.Extensions.DependencyInjection</span><span class="p">;</span><span class="k">using</span><span class="nn">RimDev.AspNetCore.FeatureFlags</span><span class="p">;</span><span class="k">namespace</span><span class="nn">MyApplication</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">Startup</span><span class="p">{</span><span class="k">private</span><span class="k">static</span><span class="k">readonly</span><span class="n">FeatureFlagOptions</span><span class="n">options</span><span class="p">=</span><span class="k">new</span><span class="nf">FeatureFlagOptions</span><span class="p">()</span><span class="p">.</span><span class="nf">UseCachedSqlFeatureProvider</span><span class="p">(</span><span class="s">@"CONNECTION_STRING_HERE"</span><span class="p">);</span><span class="k">public</span><span class="k">void</span><span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">IServiceCollection</span><span class="n">services</span><span class="p">)</span><span class="p">{</span><span class="n">services</span><span class="p">.</span><span class="nf">AddFeatureFlags</span><span class="p">(</span><span class="n">options</span><span class="p">);</span><span class="p">}</span><span class="k">public</span><span class="k">void</span><span class="nf">Configure</span><span class="p">(</span><span class="n">IApplicationBuilder</span><span class="n">app</span><span class="p">,</span><span class="n">IHostingEnvironment</span><span class="n">env</span><span class="p">)</span><span class="p">{</span><span class="n">app</span><span class="p">.</span><span class="nf">UseFeatureFlags</span><span class="p">(</span><span class="n">options</span><span class="p">);</span><span class="c1">// IMPORTANT: Controlling access of the UI / API of this library is the responsibility of the user.</span><span class="c1">// Apply authentication / authorization around the `UseFeatureFlagsUI` method as needed,</span><span class="c1">// as this method wires up the various endpoints.</span><span class="n">app</span><span class="p">.</span><span class="nf">UseFeatureFlagsUI</span><span class="p">(</span><span class="n">options</span><span class="p">);</span><span class="p">}</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p>Next, create feature flags like this in the ASP.NET Core assembly:</p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">RimDev.AspNetCore.FeatureFlags</span><span class="p">;</span><span class="k">namespace</span><span class="nn">MyApplication</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">MyFeature</span><span class="p">:</span><span class="n">Feature</span><span class="p">{</span><span class="c1">// Optional, displays on UI:</span><span class="k">public</span><span class="k">override</span><span class="kt">string</span><span class="n">Description</span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="p">}</span><span class="p">=</span><span class="s">"My feature description."</span><span class="p">;</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p><strong>Note:</strong><code class="language-plaintext highlighter-rouge">FeatureFlagAssemblies</code> to scan can also be configured in <code class="language-plaintext highlighter-rouge">FeatureFlagOptions</code> if you’d like to scan assemblies other than <code class="language-plaintext highlighter-rouge">Assembly.GetEntryAssembly()</code>.</p><p><strong>Now you can dependency inject any of your feature flags using the standard ASP.NET Core IoC!</strong></p><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span><span class="k">class</span><span class="nc">MyController</span><span class="p">:</span><span class="n">Controller</span><span class="p">{</span><span class="k">private</span><span class="k">readonly</span><span class="n">MyFeature</span><span class="n">myFeature</span><span class="p">;</span><span class="k">public</span><span class="nf">MyController</span><span class="p">(</span><span class="n">MyFeature</span><span class="n">myFeature</span><span class="p">)</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="n">myFeature</span><span class="p">=</span><span class="n">myFeature</span><span class="p">;</span><span class="p">}</span><span class="c1">// Use myFeature instance here, using myFeature.Value for the on/off toggle value.</span><span class="p">}</span></code></pre></div></div><h2 id="ui">UI</h2><p>The UI wired up by <code class="language-plaintext highlighter-rouge">UseFeatureFlagsUI</code> is available by default at <code class="language-plaintext highlighter-rouge">/_features</code>. The UI and API endpoints can be modified in <code class="language-plaintext highlighter-rouge">FeatureFlagOptions</code> if you’d like, too.</p><h2 id="in-closing">In closing</h2><p>We hope this helps you control your applications in production, enabling rapid development while controlling access to new functionality in a controlled manner – decoupled from your deployments. Enjoy!</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>