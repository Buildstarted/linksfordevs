<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Request: a solution that allows us to not have to write 6500 different delegates &amp; overloads &#xB7; Issue #2668 &#xB7; dotnet/csharplang - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Request: a solution that allows us to not have to write 6500 different delegates &amp; overloads &#xB7; Issue #2668 &#xB7; dotnet/csharplang - linksfor.dev(s)"/>
    <meta property="article:author" content="dotnet"/>
    <meta property="og:description" content="In Unity&amp;#39;s new DOTS C# high performance game engine, we support this syntax to allow users to tell the system they want to run an data transformation on all entities that have a Position compon..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/csharplang/issues/2668"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Request: a solution that allows us to not have to write 6500 different delegates &amp; overloads &#xB7; Issue #2668 &#xB7; dotnet/csharplang</title>
<div class="readable">
        <h1>Request: a solution that allows us to not have to write 6500 different delegates &amp; overloads &#xB7; Issue #2668 &#xB7; dotnet/csharplang</h1>
            <div>by dotnet</div>
            <div>Reading time: 52-66 minutes</div>
        <div>Posted here: 17 Jul 2019</div>
        <p><a href="https://github.com/dotnet/csharplang/issues/2668">https://github.com/dotnet/csharplang/issues/2668</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-channel="marked-as-read:issue:469428718">

              
<div data-gid="MDU6SXNzdWU0Njk0Mjg3MTg=" data-url="/_render_node/MDU6SXNzdWU0Njk0Mjg3MTg=/issues/body" data-channel="issue:469428718">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/lucasmeijer/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lucasmeijer"><img height="40" width="40" alt="@lucasmeijer" src="https://avatars1.githubusercontent.com/u/308974?s=88&amp;v=4"></a>

</p>


  
<div id="issue-469428718">
  <div data-body-version="57e75b3f275bdaf5e2eab267821d3cc1" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>In Unity's new DOTS C# high performance game engine, we support this syntax to allow users to tell the system they want to run an data transformation on all entities that have a Position component and a Velocity component.</p>
<pre><code> EntitiesForEach
      .WithBurst(true)
      .WithSupportStructuralChanges(false)
      .WithName("ApplyVelocities")
      .WithCode((ref Position position, in Velocity velocity) =&gt;
        {
           position.Value += velocity.Value;
        });
</code></pre>
<p>Our buildsystem recognizes this pattern, and does some IL postprocessing, by virtue of understanding the users intent.</p>
<p>Notice that the lambda expression that WithCode() takes, has one ref and one in parameter.<br>
This makes the jobsystem that runs these transformations realize it can schedule this transormation in parallel with other readers of Velocity component, but not in parallel with other transformations that need to access Position, since that will be written to, as it's marked ref, not in.</p>
<p>We need WithCode() to be able to take any amount of parameters ideally,  but defenitely not less than 8.   We also would like to give the user full freedom to mark each parameter as ref, in, or by value.    In order to let users write code like this, we today have to create custom delegates like this:</p>
<pre><code>public delegate void RRR&lt;T0, T1, T2&gt;(ref T0 t0, ref T1 t1, ref T2 t2);
public delegate void RRI&lt;T0, T1, T2&gt;(ref T0 t0, ref T1 t1, in T2 t2);
public delegate void RRV&lt;T0, T1, T2&gt;(ref T0 t0, ref T1 t1, T2 t2);
public delegate void RIR&lt;T0, T1, T2&gt;(ref T0 t0, in T1 t1, ref T2 t2);
public delegate void RII&lt;T0, T1, T2&gt;(ref T0 t0, in T1 t1, in T2 t2);
public delegate void RIV&lt;T0, T1, T2&gt;(ref T0 t0, in T1 t1, T2 t2);
public delegate void RVR&lt;T0, T1, T2&gt;(ref T0 t0, T1 t1, ref T2 t2);
public delegate void RVI&lt;T0, T1, T2&gt;(ref T0 t0, T1 t1, in T2 t2);
public delegate void RVV&lt;T0, T1, T2&gt;(ref T0 t0, T1 t1, T2 t2);
public delegate void IRR&lt;T0, T1, T2&gt;(in T0 t0, ref T1 t1, ref T2 t2);
public delegate void IRI&lt;T0, T1, T2&gt;(in T0 t0, ref T1 t1, in T2 t2);
public delegate void IRV&lt;T0, T1, T2&gt;(in T0 t0, ref T1 t1, T2 t2);
public delegate void IIR&lt;T0, T1, T2&gt;(in T0 t0, in T1 t1, ref T2 t2);
public delegate void III&lt;T0, T1, T2&gt;(in T0 t0, in T1 t1, in T2 t2);
public delegate void IIV&lt;T0, T1, T2&gt;(in T0 t0, in T1 t1, T2 t2);
public delegate void IVR&lt;T0, T1, T2&gt;(in T0 t0, T1 t1, ref T2 t2);
public delegate void IVI&lt;T0, T1, T2&gt;(in T0 t0, T1 t1, in T2 t2);
public delegate void IVV&lt;T0, T1, T2&gt;(in T0 t0, T1 t1, T2 t2);
</code></pre>
<p>there are 6500 more where those came from.  I've put them up here for reference: <a rel="nofollow" href="https://gist.github.com/lucasmeijer/e7e7c6ae10ef78adaae9b505ca615470">https://gist.github.com/lucasmeijer/e7e7c6ae10ef78adaae9b505ca615470</a></p>
<p>for each delegate, we need to make a custom overload of the WithCode() function.</p>
<p>It would be great if we wouldn't have to do that.  It makes visualstudio slow, resharper slow, horrible for docs, etc.</p>
<p>One possible solution that comes to mind is having some kind of special delegate type that any lambda expression is allowed to be assigned to.  It's fine for our purposes if that instances of that delegate type are not invokable.  We just need the syntax to be valid.</p>
<p>We'd happily welcome any other ideas, from language features to anything else.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>

</div>


              

  


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2MTIxMg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2MTIxMg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU2MTIxMg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/HaloFour/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/HaloFour"><img height="40" width="40" alt="@HaloFour" src="https://avatars1.githubusercontent.com/u/10102290?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512561212">
    <div>
      

  

<details data-body-version="045b76d84f6464152910433776e6df13">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="045b76d84f6464152910433776e6df13" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>What exactly do you propose?</p>
<p>The CLR and C# don't know anything about lambdas, they only know about delegates, and the CLR requires separate nominal types per signature.  Those types all have the common <code>System.Delegate</code> base type, but the runtime still requires that a concrete implementation where the <code>Invoke</code> method matches the signature of the target method.  I'm not sure what you'd do to work around that.</p>
<p>Also, this proposal seems insanely narrow, in that it only applies to a specific API for a specific runtime that requires IL rewriting to function at all.  I'd have to think that there are more general-purpose ways to build this based on what exists in the language.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2Mjk3MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2Mjk3MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU2Mjk3MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/lucasmeijer/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lucasmeijer"><img height="40" width="40" alt="@lucasmeijer" src="https://avatars1.githubusercontent.com/u/308974?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512562970">
    <div>
      

  

<details data-body-version="9c24763353955db69d769479b98c05fc">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="9c24763353955db69d769479b98c05fc" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>The CLR and C# don't know anything about lambdas, they only know about delegates</p>
</blockquote>
<p>we don't need a delegate.  We just need some type that we're allowed to assign any lambda expression to, and can from IL reason about where the compiler generated function is that was made for the lambda.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2NDY1Mg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2NDY1Mg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU2NDY1Mg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/HaloFour/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/HaloFour"><img height="40" width="40" alt="@HaloFour" src="https://avatars1.githubusercontent.com/u/10102290?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512564652">
    <div>
      

  

<details data-body-version="68f30d64dfc44f777ca5ddcace52437d">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="68f30d64dfc44f777ca5ddcace52437d" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/lucasmeijer/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lucasmeijer">@lucasmeijer</a></p>
<p>All lambdas compile to delegates, even in the case of expression trees.  How would such a language feature apply to projects outside of this specific use case?  Why does it have to use lambdas?  This feels like using lambda syntax to accomplish pattern matching instead of using patterns.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2NjQ2Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU2NjQ2Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU2NjQ2Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512566463">
    <div>
      

  

<details data-body-version="2b96b296e0cb51d2f5d5b3654c4d5d00">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="2b96b296e0cb51d2f5d5b3654c4d5d00" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>Our buildsystem recognizes this pattern, and does some IL postprocessing, by virtue of understanding the users intent.</p>
</blockquote>
<p>How about something like this:</p>
<div><pre>      .<span>WithCode</span>((<span>Position</span> <span>ref_position</span>, <span>Velocity</span> <span>in_velocity</span>) <span>=&gt;</span>
        {
           <span>ref_position</span>.<span>Value</span> <span>+=</span> <span>in_velocity</span>.<span>Value</span>;
        });</pre></div>
<p>Your build system would throw if the user didn't properly name things.  It could then transform the above however it wanted (making actual 'ref' parameters for <code>ref_xxx</code> named params and whatnot).</p>
<p>Now you'd just need the 8 overloads for the 8 types of actions you would take.  You'd still get compile time checking since your tool would verify the 'name' specified how the parameter needed to be passed.</p>
<p>Basically, if you have an IL processing step, you can basically encode things however you want.  Just use a pattern that your processing step will look for (and fail on if incorrect), and then rewrite to whatever actual form your "jobsystem" wants.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU3MjAxMA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU3MjAxMA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU3MjAxMA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/snowinmars/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/snowinmars"><img height="40" width="40" alt="@snowinmars" src="https://avatars0.githubusercontent.com/u/5859735?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512572010">
    <div>
      

  

<details data-body-version="b18fa730c550de649137202481e93de2">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="b18fa730c550de649137202481e93de2" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>There are some restrictions for C#. You can't mark a generic attribute as 'digitable', you can't mark an operator as 'commutativity', you can't overload function by the count of generic arguments without copypasting.<br>
I think that these restrictions keep the language simple. What could be useful in one case could be a mess in another.</p>
<p>I don't know your business flow or demands, but when I face with stuff like this that means that I should achieve my goal in another way.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU3MzYwOQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU3MzYwOQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU3MzYwOQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/kekekeks/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/kekekeks"><img height="40" width="40" alt="@kekekeks" src="https://avatars2.githubusercontent.com/u/1067584?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512573609">
    <div>
      

  

<details data-body-version="cfd0457468c850d00cd80134a9b09db2">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="cfd0457468c850d00cd80134a9b09db2" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <div><pre><span>class</span> <span>DynamicSignatureDelegate</span>
{
      <span>public</span> <span>DynamicSignatureDelegate</span>(<span>object</span> <span>target</span>, <span>MethodInfo</span> <span>methodInfo</span>){}
}</pre></div>
<p>if such class is used instead of a Delegate, compiler should emit</p>
<pre><code>ldloc target
ldtoken Lambda
call MethodBase.GetMethodFromHandle
newobj DynamicSignatureDelegate(object target, MethodInfo method)
</code></pre>
<p>instead of</p>
<pre><code>ldloc target
ldftn Lambda
newobj Action(object target, native int function
</code></pre>
<p>Being able to convert an arbitrary lambda to a MethodInfo would be also quite useful in non-Unity scenarios.</p>
<p>This could also play nicely with <a href="https://github.com/dotnet/csharplang/issues/712" data-hovercard-type="issue" data-hovercard-url="/dotnet/csharplang/issues/712/hovercard">memberof</a> proposal:</p>
<div><pre><span>Foo</span>(<span>memberof</span> <span>int</span> (<span>int</span> <span>x</span>, <span>int</span> <span>y</span>) <span>=</span><span>&gt;</span> <span>x</span><span>+</span><span>y</span>);
</pre></div>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU3OTgxMg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU3OTgxMg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU3OTgxMg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/HaloFour/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/HaloFour"><img height="40" width="40" alt="@HaloFour" src="https://avatars1.githubusercontent.com/u/10102290?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512579812">
    <div>
      

  

<details data-body-version="8d6cb2af533573d5a74d11caf2c88e0e">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="8d6cb2af533573d5a74d11caf2c88e0e" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>You can also define your overloads following such a convention that <code>ref</code> parameters must come last, etc., to reduce the number of overall overloads.  And you could reconsider the requirement that there be up to 8 arguments.  Or you could use interfaces to define a "shape" of the type in question.</p>
<p>DOTS looks like an engine that's already in the wild.  How much does your workflow depend on a feature like this being adopted?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU4MDcxMA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjU4MDcxMA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjU4MDcxMA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512580710">
    <div>
      

  

<details data-body-version="a7f5459ce06b9e884a6939ab8598c23a">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="a7f5459ce06b9e884a6939ab8598c23a" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>there are 6500 more where those came from. I've put them up here for reference: <a href="https://gist.github.com/lucasmeijer/e7e7c6ae10ef78adaae9b505ca615470">https://gist.github.com/lucasmeijer/e7e7c6ae10ef78adaae9b505ca615470</a></p>
</blockquote>
<p>Is this actually a problem?  I assume you're just generating them.  And presumably your IL shaker will just remove teh ones that aren't used (of even remove all of them since you don't actually use delegates at the end of the day).  So is there an actual problem that would be solved by a language feature here?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjcyMTA4OQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjcyMTA4OQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjcyMTA4OQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas"><img height="40" width="40" alt="@scottbilas" src="https://avatars0.githubusercontent.com/u/964720?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512721089">
    <div>
      

  

<details data-body-version="212608da8e3cf3af2330ed67d9fa3d8e">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="212608da8e3cf3af2330ed67d9fa3d8e" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi">@CyrusNajmabadi</a> the problem in the OP is "It makes visualstudio slow, resharper slow, horrible for docs, etc"</p>
<p>It's also insanely confusing for users who have no idea what all this stuff is and will be given a pile of weirdly acronym'd names in their autocomplete.</p>
<p>Anyway from a perf perspective, very few .net tools are expecting a type to have &gt;100 of anything and having 6500 is a good way to discover all the n^2 algorithms that were invisible with low member counts.</p>
<p>Oh and regarding ordering of in/ref etc. to reduce overloads, we've considered this and it's not too bad. It does come with the significant cost of confusing compiler error. Someone changes a ref to an in or vice versa, and then the compiler gives a weird message about some acronym and param types not matching, and what the user is supposed to do is rearrange their parameter list. Not great UX.</p>
<p>What we actually want to do is let people pass in a lambda with whatever they want (lambda because the syntax is so close to an ordinary <code>foreach</code>), and our postprocessor would do the validation and codegen work.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc0OTU2Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc0OTU2Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjc0OTU2Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/benaadams/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/benaadams"><img height="40" width="40" alt="@benaadams" src="https://avatars0.githubusercontent.com/u/1142958?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512749563">
    <div>
      

  

<details data-body-version="15333546406fe532b89e8ba8308fff90">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="15333546406fe532b89e8ba8308fff90" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Something like this to work?</p>
<div><pre><span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>TAction</span>&gt;(<span>TAction</span> <span>action</span>)
    <span>where</span> <span>TAction</span> : <span>Delegate</span>
{
    <span><span>//</span> ...</span>
}</pre></div>
<p>Though currently that will give the error</p>
<pre><code>The type arguments for method 'WithCode&lt;TAction&gt;(TAction)' cannot be inferred from the usage. 
Try specifying the type arguments explicitly.	
</code></pre>
<p>Specifying them then returns you back to the current situation (lots of delegates); also poor usability in the generic type:</p>
<div><pre><span>WithCode</span>&lt;<span>RR</span>&lt;<span>Position</span>, <span>Velocity</span>&gt;&gt;((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span>
{
    <span>position</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>;
});</pre></div>
<p>For</p>
<div><pre><span>WithCode</span>((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span>
{
    <span>position</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>;
});</pre></div>
<p>Also concrete doesn't work</p>
<div><pre><span>public</span> <span>void</span> <span>WithCode</span>(<span>Delegate</span> <span>action</span>)
{
}</pre></div>
<p>As it gives</p>
<pre><code>Cannot convert lambda expression to type 'Delegate' because it is not a delegate type
</code></pre>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc1NDkwNg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc1NDkwNg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjc1NDkwNg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/ogxd/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ogxd"><img height="40" width="40" alt="@ogxd" src="https://avatars0.githubusercontent.com/u/12692438?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512754906">
    <div>
      

  

<details data-body-version="437f0c7bd6864eb5af3c45a36e62fea1">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="437f0c7bd6864eb5af3c45a36e62fea1" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Here is an idea, it make thing much shorter but it has its drawbacks :</p>
<div><pre><span>public</span> <span>delegate</span> <span>void</span> <span>WithCodeHandler</span>&lt;<span>RefParameters</span>, <span>IntParameters</span>&gt;(<span>ref</span> <span>RefParameters</span> <span>referenceParameters</span>, <span>in</span> <span>IntParameters</span> <span>inParameters</span>);

<span>public</span> <span>struct</span> <span>ParameterSet</span>&lt;<span>T0</span>&gt; {
    <span>public</span> <span>T0</span> <span>t0</span>;
}

<span>public</span> <span>struct</span> <span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>&gt; {
    <span>public</span> <span>T0</span> <span>t0</span>;
    <span>public</span> <span>T1</span> <span>t1</span>;
}

<span>public</span> <span>struct</span> <span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt; {
    <span>public</span> <span>T0</span> <span>t0</span>;
    <span>public</span> <span>T1</span> <span>t1</span>;
    <span>public</span> <span>T2</span> <span>t2</span>;
}

<span>public</span> <span>struct</span> <span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt; {
    <span>public</span> <span>T0</span> <span>t0</span>;
    <span>public</span> <span>T1</span> <span>t1</span>;
    <span>public</span> <span>T2</span> <span>t2</span>;
    <span>public</span> <span>T3</span> <span>t3</span>;
}

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>&gt;, <span>ParameterSet</span>&lt;<span>T1</span>&gt;&gt; <span>function</span>) { }

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>&gt;, <span>ParameterSet</span>&lt;<span>T1</span>, <span>T2</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>&gt;, <span>ParameterSet</span>&lt;<span>T2</span>&gt;&gt; <span>function</span>) { }

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>&gt;, <span>ParameterSet</span>&lt;<span>T1</span>, <span>T2</span>, <span>T3</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>&gt;, <span>ParameterSet</span>&lt;<span>T2</span>, <span>T3</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;, <span>ParameterSet</span>&lt;<span>T3</span>&gt;&gt; <span>function</span>) { }

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>&gt;, <span>ParameterSet</span>&lt;<span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>&gt;, <span>ParameterSet</span>&lt;<span>T2</span>, <span>T3</span>, <span>T4</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;, <span>ParameterSet</span>&lt;<span>T3</span>, <span>T4</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;, <span>ParameterSet</span>&lt;<span>T4</span>&gt;&gt; <span>function</span>) { }

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>&gt;, <span>ParameterSet</span>&lt;<span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;, <span>ParameterSet</span>&lt;<span>T3</span>, <span>T4</span>, <span>T5</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;, <span>ParameterSet</span>&lt;<span>T4</span>, <span>T5</span>&gt;&gt; <span>function</span>) { }

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;, <span>ParameterSet</span>&lt;<span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>&gt;&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;, <span>ParameterSet</span>&lt;<span>T4</span>, <span>T5</span>, <span>T6</span>&gt;&gt; <span>function</span>) { }

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>, <span>T7</span>&gt;(<span>WithCodeHandler</span>&lt;<span>ParameterSet</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;, <span>ParameterSet</span>&lt;<span>T4</span>, <span>T5</span>, <span>T6</span>, <span>T7</span>&gt;&gt; <span>function</span>) { }</pre></div>
<p>And it would be used like this :</p>
<div><pre>.<span>WithCode</span>((
    <span>ref</span> <span>ParameterSet</span><span>&lt;</span><span>Position</span>, <span>Rotation</span><span>&gt;</span> <span>refParameters</span>,
    <span>in</span> <span>ParameterSet</span><span>&lt;</span><span>Velocity</span><span>&gt;</span> <span>inParameters</span>) <span>=</span><span>&gt;</span> {
        <span>refParameters</span>.<span>t0</span>.<span>Value</span> <span>+=</span> <span>inParameters</span>.<span>t0</span>.<span>Value</span>;
    <span>return</span>;
 });</pre></div>
<p>Notice I haven't put the value type, only ref and in. Is it required ? That's already a lot less combinations</p>
<p>You could also let the user make his own Parameter containers, that would be recognized by your build system thanks to an attribute or by inheriting from a specific abstract type (<code>RefParameters</code>, <code>InParameters</code>, ...)</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc1ODM2Ng==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc1ODM2Ng==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjc1ODM2Ng==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/RUSshy/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/RUSshy"><img height="40" width="40" alt="@RUSshy" src="https://avatars0.githubusercontent.com/u/18348637?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512758366">
    <div>
      

  

<details data-body-version="546ecbcb1dfb7c095b180f5bb448f61b">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="546ecbcb1dfb7c095b180f5bb448f61b" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>we need something like c++ template meta-programming or else what ever you'll add will be bloated, useless typing, and slow, delegates? bhwaa</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc3MjQ5MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc3MjQ5MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjc3MjQ5MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/yaakov-h/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/yaakov-h"><img height="40" width="40" alt="@yaakov-h" src="https://avatars0.githubusercontent.com/u/426009?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512772490">
    <div>
      

  

<details data-body-version="7a5dd3f5b87a50d90b8883b81684a9dc">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="7a5dd3f5b87a50d90b8883b81684a9dc" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/benaadams/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/benaadams">@benaadams</a> how about <code>WithCode(delegate (...) { ... })</code>?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc3NDI2NA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc3NDI2NA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjc3NDI2NA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/benaadams/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/benaadams"><img height="40" width="40" alt="@benaadams" src="https://avatars0.githubusercontent.com/u/1142958?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512774264">
    <div>
      

  

<details data-body-version="01e56479100d1166f3ff2f695aaf38b7">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="01e56479100d1166f3ff2f695aaf38b7" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/yaakov-h/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/yaakov-h">@yaakov-h</a></p>
<div><pre><span>WithCode</span>(<span>delegate</span>(<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>)
{
    <span>position</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>;
});</pre></div>
<p>Gives</p>
<pre><code>Cannot convert anonymous method to type 'Delegate' because it is not a delegate type
</code></pre>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc5MDczNg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjc5MDczNg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjc5MDczNg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas"><img height="40" width="40" alt="@scottbilas" src="https://avatars0.githubusercontent.com/u/964720?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512790736">
    <div>
      

  

<details data-body-version="32f13dd6a795b4269935f45c8c3ed900">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="32f13dd6a795b4269935f45c8c3ed900" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/ogxd/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ogxd">@ogxd</a> cool idea, though "t0" etc. are hard to read. It can be improved just a little..</p>
<div><pre>    .<span>WithCode</span>((<span>ref</span> (<span>Position</span> <span>pos</span>, <span>Rotation</span> <span>rot</span>) <span>refs</span>, <span>in</span> (<span>Velocity</span> <span>vel</span>) <span>ins</span>) <span>=&gt;</span>
        {
            <span>refs</span>.<span>pos</span>.<span>Value</span> <span>+=</span> <span>ins</span>.<span>vel</span>.<span>Value</span>;
        });</pre></div>
<p>..via receiving ValueTuples as ref/in. Unfortunately there's no way to do a single-element value tuple (<a data-error-text="Failed to load issue title" data-id="255684307" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/csharplang/issues/883" data-hovercard-type="issue" data-hovercard-url="/dotnet/csharplang/issues/883/hovercard" href="https://github.com/dotnet/csharplang/issues/883">#883</a>). :(</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjgxOTA2OQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjgxOTA2OQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjgxOTA2OQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/ogxd/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ogxd"><img height="40" width="40" alt="@ogxd" src="https://avatars0.githubusercontent.com/u/12692438?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512819069">
    <div>
      

  

<details data-body-version="0aa995afbf49247978874e8ddae6cdc7">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="0aa995afbf49247978874e8ddae6cdc7" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas">@scottbilas</a> that is a great usecase for tuples ! It even makes the overloads much cooler :)</p>
<p>For single-element values, I'd say that not making a tuple is fine. The user would have to know that he should use parenthesis to deal with multiple <code>ref</code>s or <code>in</code>s but that's all. And there is nothing to change on the API side as the only delegate is already generic enough to handle both tuples and single elements <g-emoji alias="+1" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png">üëç</g-emoji></p>
<p>That would look like this :</p>
<div><pre><span>public</span> <span>delegate</span> <span>void</span> <span>WithCodeHandler</span>&lt;<span>Refs</span>, <span>Ins</span>&gt;(<span>ref</span> <span>Refs</span> <span>refs</span>, <span>in</span> <span>Ins</span> <span>ins</span>);

<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>&gt;(<span>WithCodeHandler</span>&lt;<span>T0</span>, <span>T1</span>&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;(<span>WithCodeHandler</span>&lt;<span>T0</span>, (<span>T1</span>, <span>T2</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>), <span>T2</span>&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;(<span>WithCodeHandler</span>&lt;<span>T0</span>, (<span>T1</span>, <span>T2</span>, <span>T3</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>), (<span>T2</span>, <span>T3</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>), <span>T3</span>&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;<span>T0</span>, (<span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>), (<span>T2</span>, <span>T3</span>, <span>T4</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>), (<span>T3</span>, <span>T4</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>), <span>T4</span>&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>), (<span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>), (<span>T3</span>, <span>T4</span>, <span>T5</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>), (<span>T4</span>, <span>T5</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>), (<span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>), (<span>T4</span>, <span>T5</span>, <span>T6</span>)&gt; <span>function</span>) { }
<span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>, <span>T4</span>, <span>T5</span>, <span>T6</span>, <span>T7</span>&gt;(<span>WithCodeHandler</span>&lt;(<span>T0</span>, <span>T1</span>, <span>T2</span>, <span>T3</span>), (<span>T4</span>, <span>T5</span>, <span>T6</span>, <span>T7</span>)&gt; <span>function</span>) { }</pre></div>
<div><pre>.<span>WithCode</span>((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span> {
    <span>position</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>;
});

.<span>WithCode</span>((<span>ref</span> (<span>Position</span> <span>position</span>, <span>Rotation</span> <span>rotation</span>) <span>refs</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span> {
    <span>refs</span>.<span>position</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>;
    <span>refs</span>.<span>rotation</span>.<span>Value</span>.<span>y</span> <span>+=</span> <span>0.1f</span>;
});

.<span>WithCode</span>((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> (<span>Velocity</span> <span>velocity</span>, <span>Rotation</span> <span>rotation</span>) <span>ins</span>) <span>=&gt;</span> {
    <span>position</span>.<span>Value</span> <span>+=</span> <span>Vector3</span>.<span>Scale</span>(<span>ins</span>.<span>velocity</span>.<span>Value</span>, <span>ins</span>.<span>rotation</span>.<span>Value</span>);
});</pre></div>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjg0MTU0OQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjg0MTU0OQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjg0MTU0OQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas"><img height="40" width="40" alt="@scottbilas" src="https://avatars0.githubusercontent.com/u/964720?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512841549">
    <div>
      

  

<details data-body-version="8217b12f449593a01dfef76ebdd0dfc6">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="8217b12f449593a01dfef76ebdd0dfc6" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/ogxd/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ogxd">@ogxd</a> - ah of course! Very cool.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkwNDk1Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkwNDk1Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkwNDk1Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512904953">
    <div>
      

  

<details data-body-version="4cf389ea4e37065f840ec4ddf1a3abeb">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="4cf389ea4e37065f840ec4ddf1a3abeb" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>the problem in the OP is "It makes visualstudio slow, resharper slow,</p>
</blockquote>
<p>So, that sounds like an issue with the tooling.  IT's not like you can just add a language feature and it will just be fast in VS.  A lot of work has to be done per feature to make it that way.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkwNTIyNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkwNTIyNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkwNTIyNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512905227">
    <div>
      

  

<details data-body-version="f09f3dfd7efaee4644fc07e7a3a94077">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkxMDc1MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkxMDc1MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkxMDc1MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81"><img height="40" width="40" alt="@popcatalin81" src="https://avatars1.githubusercontent.com/u/1791839?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512910750">
    <div>
      

  

<details data-body-version="59468405bd4ee84070b00a7b0e99de45">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="59468405bd4ee84070b00a7b0e99de45" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas">@scottbilas</a> what's wrong with this proposal:</p>
<p><a href="https://github.com/dotnet/csharplang/issues/2668#issuecomment-512566463" data-hovercard-type="issue" data-hovercard-url="/dotnet/csharplang/issues/2668/hovercard">#2668 (comment)</a></p>
<p>?</p>
</blockquote>
<p>You cannot use the Compiler to enforce assignment &amp; mutability rules. If you use <code>in</code>, <code>out</code> and <code>ref</code> parameter C# compiler will ensure correct assignment and mutability behavior.,</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyMjY2Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyMjY2Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkyMjY2Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512922663">
    <div>
      

  

<details data-body-version="571abc4c2cfaca4a723ce8fc3f68c503">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="571abc4c2cfaca4a723ce8fc3f68c503" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>You cannot use the Compiler to enforce assignment &amp; mutability rules</p>
</blockquote>
<p>You can use analyzers right?</p>
<blockquote>
<p>C# compiler will ensure correct assignment and mutability behavior.,</p>
</blockquote>
<p>I thought this system was rewriting the IL.  Can't you get wahtever behavior you want at that point?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyNTkzNg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyNTkzNg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkyNTkzNg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81"><img height="40" width="40" alt="@popcatalin81" src="https://avatars1.githubusercontent.com/u/1791839?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512925936">
    <div>
      

  

<details data-body-version="c61e2074744f130e07144ac96933edb4">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="c61e2074744f130e07144ac96933edb4" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>You can use analyzers right?</p>
</blockquote>
<p>The Unity userbase if very varied as coding experience and uses all kinds of IDE's from VIM to Notepad++ to VS and VS Code. I assume, Using the compiler to enforce correct behavior is critical. Unity needs to be a "safe" library, not a "use at your own peril, you better know what you are doing" type of library. Besides the scope of mutability and assignment is way too big and complex for an analyzer,</p>
<blockquote>
<p>I thought this system was rewriting the IL. Can't you get wahtever behavior you want at that point?</p>
</blockquote>
<p>Yes, but you still need your users to write correct code which is enforced by the compiler. (Not by the rewriter, the rewriter assumes already correct code, else it becomes easy to complex to implement such a rewriter)</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyNjMzNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyNjMzNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkyNjMzNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512926337">
    <div>
      

  

<details data-body-version="9e94fda4b7bae9e34553d04495349355">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="9e94fda4b7bae9e34553d04495349355" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>Besides the scope of mutability and assignment is way too big and complex for an analyzer,</p>
</blockquote>
<p>Can you clarify that?</p>
<blockquote>
<p>The Unity userbase if very varied as coding experience and uses all kinds of IDE's from VIM to Notepad++ to VS and VS Code.</p>
</blockquote>
<p>An analyzer can be part of your build.  It doesn't need to be in the editor tooling space.  You can add your domain specific errors and have everyone get them.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyNzc0Ng==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkyNzc0Ng==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkyNzc0Ng==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/PathogenDavid/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/PathogenDavid"><img height="40" width="40" alt="@PathogenDavid" src="https://avatars3.githubusercontent.com/u/278957?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512927746">
    <div>
      

  

<details data-body-version="5fdcb594cf0de133da475b1d5085ee88">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="5fdcb594cf0de133da475b1d5085ee88" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>It seems to me like we need anonymous delegates. Basically delegate types emitted by the compiler to allow assigning an arbitrary lambda to a <code>System.Delegate</code>. (Basically to allow <a href="https://github.com/dotnet/csharplang/issues/2668#issuecomment-512749563" data-hovercard-type="issue" data-hovercard-url="/dotnet/csharplang/issues/2668/hovercard">Ben Adams' suggestion</a> without needing a millions of delegate types.</p>
<p>You would write:</p>
<div><pre><span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>TAction</span>&gt;(<span>TAction</span> <span>action</span>)
    <span>where</span> <span>TAction</span>: <span>Delegate</span>
{
    <span><span>//</span> ...</span>
}

<span>public</span> <span>void</span> <span>UsesWithCode</span>()
{
    <span>WithCode</span>((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span>
    {
        <span>position</span>.<span>Value</span> <span>=</span> <span>velocity</span>.<span>Value</span>;
    });
}</pre></div>
<p>Similar to anonymous types, the compiler would essentially emit:</p>
<div><pre><span>public</span> <span>void</span> <span>WithCode</span>&lt;<span>TAction</span>&gt;(<span>TAction</span> <span>action</span>)
    <span>where</span> <span>TAction</span>: <span>Delegate</span>
{
    <span><span>//</span> ...</span>
}

[<span>CompilerGenerated</span>]
<span>delegate</span> <span>__AnonymousDelegate0</span>(<span>ref</span> <span>Position</span> <span>a</span>, <span>in</span> <span>Velocity</span> <span>b</span>);

<span>public</span> <span>void</span> <span>UsesWithCode</span>()
{
    <span>WithCode</span>&lt;<span>__AnonymousDelegate0</span>&gt;((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span>
    {
        <span>position</span>.<span>Value</span> <span>=</span> <span>velocity</span>.<span>Value</span>;
    });
}</pre></div>
<p>That being said, I can't think of any other use-cases of anonymous delegates off the top of my head. (I've definitely wanted it before though, but I forget any specifics.)</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMDA0Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMDA0Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkzMDA0Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512930043">
    <div>
      

  

<details data-body-version="7f9edf597c89da29ab096e192fdd5f07">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="7f9edf597c89da29ab096e192fdd5f07" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>Similar to anonymous types, the compiler would essentially emit:</p>
</blockquote>
<p>My preference would be to do it similar to how anonymous types are done.  i.e. with generics so that you don't have to create so many specialized instances.  So, in thi case, you'd have:</p>
<div><pre>[<span>CompilerGenerated</span>]
<span>delegate</span> <span>void</span> <span>__AnonymousDelegate0</span>&lt;<span>T1</span>, <span>T2</span>&gt;(<span>ref</span> <span>T1</span> <span>a</span>, <span>in</span> <span>T2</span> <span>b</span>);

<span>public</span> <span>void</span> <span>UsesWithCode</span>()
{
    <span>WithCode</span>&lt;<span>__AnonymousDelegate0</span>&lt;<span>Position</span>, <span>Velocity</span>&gt;&gt;((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span>
    {
        <span>position</span>.<span>Value</span> <span>=</span> <span>velocity</span>.<span>Value</span>;
    });
}</pre></div>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMDc4OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMDc4OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkzMDc4OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/PathogenDavid/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/PathogenDavid"><img height="40" width="40" alt="@PathogenDavid" src="https://avatars3.githubusercontent.com/u/278957?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512930788">
    <div>
      

  

<details data-body-version="e17a082938547cbc6d915ceade328329">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="e17a082938547cbc6d915ceade328329" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas">@scottbilas</a></p>
<blockquote>
<p>the problem in the OP is "It makes visualstudio slow, resharper slow, horrible for docs, etc"</p>
</blockquote>
<p>Does marking all of the delegates and most of the overloads with <code>[EditorBrowsable(EditorBrowsableState.Never)]</code> fix the issues with VS and Resharper?</p>
<p>As far as docs go, that sounds like a Unity problem. Your documentation generator needs to be able to skip the overloads listing for <code>WithCode</code>.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMTQwMQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMTQwMQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkzMTQwMQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/HaloFour/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/HaloFour"><img height="40" width="40" alt="@HaloFour" src="https://avatars1.githubusercontent.com/u/10102290?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512931401">
    <div>
      

  

<details data-body-version="b8eb904d30d5c64a00605dc3dc7b063a">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMTY1NQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMTY1NQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkzMTY1NQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/PathogenDavid/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/PathogenDavid"><img height="40" width="40" alt="@PathogenDavid" src="https://avatars3.githubusercontent.com/u/278957?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512931655">
    <div>
      

  

<details data-body-version="18fca420528ded55e9da59f13f0b116c">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="18fca420528ded55e9da59f13f0b116c" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi">@CyrusNajmabadi</a></p>
<blockquote>
<p>My preference would be to do it similar to how anonymous types are done. i.e. with generics so that you don't have to create so many specialized instances. So, in thi case, you'd have:</p>
</blockquote>
<p>For sure, I was ignoring that implementation detail for the sake of simplicity.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMTgxMA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjkzMTgxMA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjkzMTgxMA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512931810">
    <div>
      

  

<details data-body-version="a6c2b0420e2fe86c5e24dbdc55217c36">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="a6c2b0420e2fe86c5e24dbdc55217c36" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>For sure, I was ignoring that implementation detail for the sake of simplicity.</p>
</blockquote>
<p>Gotcha.   Thanks! :)</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjk3ODI2OQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMjk3ODI2OQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMjk3ODI2OQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/daveaglick/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/daveaglick"><img height="40" width="40" alt="@daveaglick" src="https://avatars0.githubusercontent.com/u/1020407?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-512978269">
    <div>
      

  

<details data-body-version="7b2dcaad84bbd5e3a3b6e0640d045ac4">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="7b2dcaad84bbd5e3a3b6e0640d045ac4" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/ogxd/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ogxd">@ogxd</a> <a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas">@scottbilas</a> I like where you were going with this, something using tuples was my first thought as well assuming language enhancements are off the table and/or would take too long. This idea depends on how powerful the codegen/IL rewriting is in DOTS.</p>
<p>Riffing on your ideas, what if you used a single tuple and indicated parameter modifiers with a wrapper instead of in separate tuples. The codegen could figure out when the delegate was casting one of the modifier wrappers and replace it with direct access.</p>
<div><pre><span>EntitiesForEach</span>
    .<span>WithCode</span>(((<span>Ref</span>&lt;<span>Position</span>&gt; <span>position</span>, <span>In</span>&lt;<span>Velocity</span>&gt; <span>velocity</span>, <span>Foo</span> <span>foo</span>) <span>p</span>) <span>=&gt;</span>
{
    ((<span>Position</span>)<span>p</span>.<span>position</span>).<span>Value</span> <span>+=</span> ((<span>Velocity</span>)<span>p</span>.<span>velocity</span>).<span>Value</span> <span>-</span> <span>p</span>.<span>foo</span>.<span>Value</span>;
});

<span>public</span> <span>class</span> <span>Ref</span>&lt;<span>T</span>&gt;
{	
    <span>public</span> <span>static</span> <span>implicit</span> <span>operator</span> <span>T</span>(<span>Ref</span>&lt;<span>T</span>&gt; <span>param</span>) <span>=&gt;</span> <span>default</span>;
}

<span>public</span> <span>class</span> <span>In</span>&lt;<span>T</span>&gt;
{
	<span>public</span> <span>static</span> <span>implicit</span> <span>operator</span> <span>T</span>(<span>In</span>&lt;<span>T</span>&gt; <span>param</span>) <span>=&gt;</span> <span>default</span>;
}

<span>public</span> <span>static</span> <span>class</span> <span>EntitiesForEach</span>
{
    <span>public</span> <span>static</span> <span>void</span> <span>WithCode</span>&lt;<span>T</span>&gt;(<span>Action</span>&lt;<span>T</span>&gt; <span>handler</span>)
    {
        <span><span>//</span> ...</span>
    }
}</pre></div>
<p>Alternatively (or in addition) the modifier wrappers could provide a <code>.Value</code> property to get the underlying value instead of relying on casting. It doesn't really matter as long as the rewritter can swap out those with the real thing.</p>
<p>Actually, now that I'm thinking about it, if you can rewrite the wrappers then you might not even need the tuple. That would provide similar semantics to the original codegen delegates without the explosion from all possible combinations.</p>
<div><pre><span>EntitiesForEach</span>
    .<span>WithCode</span>((<span>Ref</span>&lt;<span>Position</span>&gt; <span>position</span>, <span>In</span>&lt;<span>Velocity</span>&gt; <span>velocity</span>, <span>Foo</span> <span>foo</span>) <span>=&gt;</span>
    {
        ((<span>Position</span>)<span>position</span>).<span>Value</span> <span>+=</span> ((<span>Velocity</span>)<span>velocity</span>).<span>Value</span> <span>-</span> <span>foo</span>.<span>Value</span>;
    });

<span>public</span> <span>class</span> <span>Ref</span>&lt;<span>T</span>&gt;
{	
    <span>public</span> <span>static</span> <span>implicit</span> <span>operator</span> <span>T</span>(<span>Ref</span>&lt;<span>T</span>&gt; <span>param</span>) <span>=&gt;</span> <span>default</span>;
}

<span>public</span> <span>class</span> <span>In</span>&lt;<span>T</span>&gt;
{
    <span>public</span> <span>static</span> <span>implicit</span> <span>operator</span> <span>T</span>(<span>In</span>&lt;<span>T</span>&gt; <span>param</span>) <span>=&gt;</span> <span>default</span>;
}

<span>public</span> <span>static</span> <span>class</span> <span>EntitiesForEach</span>
{
    <span>public</span> <span>static</span> <span>void</span> <span>WithCode</span>&lt;<span>T</span>&gt;(<span>Action</span>&lt;<span>T</span>&gt; <span>handler</span>)
    {
        <span><span>//</span> ...</span>
    }
	
    <span>public</span> <span>static</span> <span>void</span> <span>WithCode</span>&lt;<span>T1</span>, <span>T2</span>&gt;(<span>Action</span>&lt;<span>T1</span>, <span>T2</span>&gt; <span>handler</span>)
    {
        <span><span>//</span> ...</span>
    }

    <span>public</span> <span>static</span> <span>void</span> <span>WithCode</span>&lt;<span>T1</span>, <span>T2</span>, <span>T3</span>&gt;(<span>Action</span>&lt;<span>T1</span>, <span>T2</span>, <span>T3</span>&gt; <span>handler</span>)
    {
        <span><span>//</span> ...</span>
    }
	
    <span><span>//</span> Etc.</span>
}</pre></div>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>



  

    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEyODYzNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEyODYzNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEyODYzNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/DaZombieKiller/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/DaZombieKiller"><img height="40" width="40" alt="@DaZombieKiller" src="https://avatars0.githubusercontent.com/u/6316315?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513128637">
    <div>
      

  

<details data-body-version="ce3955e365d7103b725c051bc6df6ff4">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="ce3955e365d7103b725c051bc6df6ff4" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81">@popcatalin81</a> I see no mention of this intention in the OP (referring to the "with or without IL rewriting" part). That aside, the version I suggested uses <code>struct</code>s and not <code>class</code>es, which could be modified to work as actual by-<code>ref</code>/by-<code>in</code> wrappers if necessary (similar to how <code>Span&lt;T&gt;</code> works.)</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEyOTc4Ng==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEyOTc4Ng==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEyOTc4Ng==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81"><img height="40" width="40" alt="@popcatalin81" src="https://avatars1.githubusercontent.com/u/1791839?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513129786">
    <div>
      

  

<details data-body-version="cb5fcbffdff1005a2252d16fd40dc4f7">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="cb5fcbffdff1005a2252d16fd40dc4f7" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81">@popcatalin81</a> I see no mention of this intention in the OP. That aside, the version I suggested uses <code>struct</code>s and not <code>class</code>es, which could be modified to work as actual by-<code>ref</code>/by-<code>in</code> wrappers if necessary (similar to how <code>Span&lt;T&gt;</code> works.)</p>
</blockquote>
<p>Yes, but you loose end-user simplicity. The 5.5 Million developers of Unity will need to write tons of boilerplate code (<code>In&lt;This&gt; foo</code>, <code>Ref&lt;&lt;That&gt; bar</code>, ) for simple operations like updating an Object's position in the game ... I don't think this is an acceptable tradeoff.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEyOTkyMA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEyOTkyMA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEyOTkyMA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513129920">
    <div>
      

  

<details data-body-version="bb758d52209ef2faa248d1f19af4125f">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="bb758d52209ef2faa248d1f19af4125f" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>I don't think this thread is about "how to circumvent the compiler for this issue", but instead how to "make use of the compiler" and still now have to have so many overloads.</p>
</blockquote>
<p>My approach still uses the compiler.  And it would mean you'd only need like 8 overloads tops...</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMDI0Mw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMDI0Mw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMDI0Mw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513130243">
    <div>
      

  

<details data-body-version="34968ef903442d1cfb0521eb835bbd25">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="34968ef903442d1cfb0521eb835bbd25" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>The problem is that that Unity actually wants to use ref parameters</p>
</blockquote>
<p>My approach would allow you to still have ref-parameters at teh end of the day.  i.e. in the final code that executes you'd presumably still be passing things by ref.  It would just be an impl detail of how the IL rewriter works.</p>
<blockquote>
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi">@CyrusNajmabadi</a> With the above solution, the compiler has more information to work with to ensure the code is correct</p>
</blockquote>
<p>Can you give an example of where it would matter? I'm not really getting it.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMDU1MQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMDU1MQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMDU1MQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513130551">
    <div>
      

  

<details data-body-version="1026b461b6ead08a97495133a67298e0">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="1026b461b6ead08a97495133a67298e0" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>The 5.5 Million developers of Unity will need to write tons of boilerplate code (In foo, Ref&lt; bar, ) for simple operations like updating an Object's position in the game ... I don't think this is an acceptable tradeoff.</p>
</blockquote>
<p>Can you clarify what would be wrong with approach i mentioned?  all they'd have to do is use simple <code>Action&lt;&gt;</code>s with my approach.  And if they wanted ref/in semantics for mutation/perf they could get that with a simple naming pattern that would be easy to teach.</p>
<p>You presumably already need to explain about how this system is actually working since it's not actually lambdas, and you actually have some sort of complex scheduler + rewriter.  So why can't you just explain that the name serves as a way for this system to know what sort of special semantics to have?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMDgxNQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMDgxNQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMDgxNQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/DaZombieKiller/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/DaZombieKiller"><img height="40" width="40" alt="@DaZombieKiller" src="https://avatars0.githubusercontent.com/u/6316315?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513130815">
    <div>
      

  

<details data-body-version="7bc13ae7f7bd39b50653aee576667f63">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="7bc13ae7f7bd39b50653aee576667f63" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81">@popcatalin81</a> I'm not seeing how</p>
<div><pre><span>WithCode</span>((<span>Ref</span>&lt;<span>Position</span>&gt; <span>position</span>, <span>In</span>&lt;<span>Velocity</span>&gt; <span>velocity</span>) <span>=&gt;</span>
{
    <span>position</span>.<span>Value</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>.<span>Value</span>;
});</pre></div>
<p>is significantly worse than</p>
<div><pre><span>WithCode</span>((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span>
{
    <span>position</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>;
});</pre></div>
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi">@CyrusNajmabadi</a><br>
The main advantage of using <code>Ref&lt;T&gt;</code>/<code>In&lt;T&gt;</code> types over the <code>ref_</code>/<code>in_</code> naming scheme is that you get error checking at compile-time (and in your IDE) imo. It just feels less "magic".</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMTQwNA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMTQwNA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMTQwNA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513131404">
    <div>
      

  

<details data-body-version="295e26c6b477c999c2ab6d20755942b8">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="295e26c6b477c999c2ab6d20755942b8" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>types over the ref_/in_ naming scheme is that you get error checking at compile-time (and in your IDE) imo</p>
</blockquote>
<p>You can get compile-time checking with analyzers.  That's the point of them.</p>
<blockquote>
<p>It just feels less "magic".</p>
</blockquote>
<p>it's already a system that takes lambdas and uses IL post processing and has a "jobsystem that runs these transformations realize it can schedule this transformation in parallel with other readers".  That seems amazingly magical.  I'm really struggling to see why that enormous level of magic is totally cool and groovy, but just tagging on a little extra information into the name (and having an analyzer) is now verboten, and instead it would need a language feature that would likely take 1-2 <em>years</em> to come about before it could be used.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMTU2OQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMTU2OQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMTU2OQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81"><img height="40" width="40" alt="@popcatalin81" src="https://avatars1.githubusercontent.com/u/1791839?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513131569">
    <div>
      

  

<details data-body-version="1a21105e40b66f46e1886162db208652">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="1a21105e40b66f46e1886162db208652" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<blockquote>
<p>The 5.5 Million developers of Unity will need to write tons of boilerplate code (In foo, Ref&lt; bar, ) for simple operations like updating an Object's position in the game ... I don't think this is an acceptable tradeoff.</p>
</blockquote>
<p>Can you clarify what would be wrong with approach i mentioned? all they'd have to do is use simple <code>Action&lt;&gt;</code>s with my approach. And if they wanted ref/in semantics for mutation/perf they could get that with a simple naming pattern that would be easy to teach.</p>
</blockquote>
<p>The Nr. 1 problem with this is that it avoids the use of the <code>ref</code> keyword. Not all 25 supported platforms of Unity will make use of the Burst compiler and IL rewriter. The code needs to be performant without IL rewriting and using simple compilation as well.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjMyNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjMyNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMjMyNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/DaZombieKiller/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/DaZombieKiller"><img height="40" width="40" alt="@DaZombieKiller" src="https://avatars0.githubusercontent.com/u/6316315?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513132327">
    <div>
      

  

<details data-body-version="06a822640c595f5d813328f46653abde">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="06a822640c595f5d813328f46653abde" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi">@CyrusNajmabadi</a></p>
<blockquote>
<p>Can you give an example of where it would matter? I'm not really getting it.</p>
</blockquote>
<p>Attempting to write to an <code>in</code> parameter would be caught at compile-time/underlined in the IDE.</p>
<blockquote>
<p>You can get compile-time checking with analyzers. That's the point of them.</p>
</blockquote>
<p>While that would definitely work, I feel like it's more work than is necessary when the compiler can already do all of the necessary checking for you with the <code>Ref&lt;T&gt;</code>/<code>In&lt;T&gt;</code> method.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjM1Mg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjM1Mg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMjM1Mg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513132352">
    <div>
      

  

<details data-body-version="71bf3cbea4317fb6d8a4649876b15d2a">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="71bf3cbea4317fb6d8a4649876b15d2a" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>The Nr. 1 problem with this is that it avoids the use of the ref keyword.</p>
</blockquote>
<p>Why is that an issue?</p>
<blockquote>
<p>Not all 25 supported platforms of Unity will make use of the Burst compiler and IL rewriter.</p>
</blockquote>
<p>This has not been stated as a goal.  So it seems like you want a system that won't go through the IL rewriter.  that changes things <em>massively</em>.  if that's the case, then reading through this whole thread, i'm not sure what's actually being asked of the language.  Because i'm not sure what the language could actually do for you in these cases.  How would you actually want this to work out?  What would this compile down to by the C# compiler for your platforms that wouldn't be doing IL rewriting?</p>
<blockquote>
<p>The code needs to be performant without IL rewriting and using simple compilation as well.</p>
</blockquote>
<p>It would have been <em>super super super</em> valuable to state that in the requirements from the beginning FWIW.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjU2OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjU2OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMjU2OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513132568">
    <div>
      

  

<details data-body-version="a20b8b527f6b5c2e16fcff3700b442b4">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="a20b8b527f6b5c2e16fcff3700b442b4" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>Attempting to write to an in parameter would be caught at compile-time/underlined in the IDE.</p>
</blockquote>
<p>As it would with the proposal i suggested.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjgwNQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjgwNQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMjgwNQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513132805">
    <div>
      

  

<details data-body-version="d5f55986c65628e9868b2b47f43a8383">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="d5f55986c65628e9868b2b47f43a8383" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>While that would definitely work, I feel like it's more work than is necessary when the compiler can already do all of the necessary checking for you with the Ref/In method.</p>
</blockquote>
<p>It would be massively less work.  it could be done <em>today</em> just through already shipped means instead of needing thousands of man hours to actually design, implement, and ship a new language feature like this.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjk2NQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMjk2NQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMjk2NQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/lucasmeijer/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lucasmeijer"><img height="40" width="40" alt="@lucasmeijer" src="https://avatars1.githubusercontent.com/u/308974?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513132965">
    <div>
      

  

<details data-body-version="b5c4814273a6209079d1ff4842b2ac99">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="b5c4814273a6209079d1ff4842b2ac99" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>The Nr. 1 problem with this is that it avoids the use of the <code>ref</code> keyword. Not all 25 supported platforms of Unity will make use of the Burst compiler and IL rewriter. The code needs to be performant without IL rewriting and using simple compilation as well.</p>
</blockquote>
<p>This is not correct, we can IL rewrite for all our platforms, and there is no requirement that a solution we end up with needs to work without IL rewriting.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzE1Ng==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzE1Ng==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMzE1Ng==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513133156">
    <div>
      

  

<details data-body-version="533a40adeb066f68e1f025173a600e6c">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="533a40adeb066f68e1f025173a600e6c" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>I don't know how to reconcile these two statements:</p>
<blockquote>
<p>One possible solution that comes to mind is having some kind of special delegate type that any lambda expression is allowed to be assigned to. It's fine for our purposes if that instances of that delegate type are not invokable. We just need the syntax to be valid.</p>
</blockquote>
<blockquote>
<p>The Nr. 1 problem with this is that it avoids the use of the ref keyword. Not all 25 supported platforms of Unity will make use of the Burst compiler and IL rewriter. The code needs to be performant without IL rewriting and using simple compilation as well.</p>
</blockquote>
<p>These statements seem to contradict each other entirely.  I cannot reconcile them at all.  Can someone please clarify this?</p>
<p>if you're not going to rewrite, but you want the compiler to have some sort of special delegate that isn't invocable, how is it expected that these platforms would actually work?  They need <em>something</em> they can end up executing, no?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzM5OQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzM5OQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMzM5OQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/DaZombieKiller/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/DaZombieKiller"><img height="40" width="40" alt="@DaZombieKiller" src="https://avatars0.githubusercontent.com/u/6316315?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513133399">
    <div>
      

  

<details data-body-version="2ac8d3b8880d35b6dae9c4dd6716b557">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="2ac8d3b8880d35b6dae9c4dd6716b557" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi">@CyrusNajmabadi</a></p>
<blockquote>
<p>It would be massively less work. it could be done today just through already shipped means instead of needing thousands of man hours to actually design, implement, and ship a new language feature like this.</p>
</blockquote>
<p>I think there might be a misunderstanding here. I'm not suggesting that C#/.NET obtain these <code>Ref&lt;T&gt;</code>/<code>In&lt;T&gt;</code> types, but rather that Unity themselves implement and support them in their IL rewriter, rather than changing the language itself.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzU5MA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzU5MA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMzU5MA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/popcatalin81/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/popcatalin81"><img height="40" width="40" alt="@popcatalin81" src="https://avatars1.githubusercontent.com/u/1791839?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513133590">
    <div>
      

  

<details data-body-version="9d4d075ca590ecad62b42e9e662d31ac">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="9d4d075ca590ecad62b42e9e662d31ac" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>This is not correct, we can IL rewrite for all our platforms, and there is no requirement that a solution we end up with needs to work without IL rewriting.</p>
</blockquote>
<p>I'm, happy to hear that. Even when running in IDE will the burst compiler be employed then? Currently, this is not the case.</p>
<p>Also, the Burst compiler seems pretty optional in its current form <a rel="nofollow" href="https://docs.unity3d.com/Packages/com.unity.burst@0.2/manual/index.html">https://docs.unity3d.com/Packages/com.unity.burst@0.2/manual/index.html</a> I'm not implicating this migt not change in the future.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzcwNg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzMzcwNg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzMzcwNg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513133706">
    <div>
      

  

<details data-body-version="742e94fd315295eb560ad8d08892f92e">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="742e94fd315295eb560ad8d08892f92e" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>I think there might be a misunderstanding here. I'm not suggesting that C#/.NET obtain these Ref/In types, but rather that Unity themselves implement and support them in their IL rewriter, rather than changing the language itself.</p>
</blockquote>
<p>I apologize.  You are correct <a data-hovercard-type="user" data-hovercard-url="/users/DaZombieKiller/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/DaZombieKiller">@DaZombieKiller</a> .  I was thinking about the request to just support <code>(ref Velocity v) =&gt; ...</code>, not your proposal.  i was thinking about that when responding to you.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzNDk1Mg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzNDk1Mg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzNDk1Mg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513134952">
    <div>
      

  

<details data-body-version="26a97f1347fa3032f5b5ec137c2b40ff">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="26a97f1347fa3032f5b5ec137c2b40ff" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Currently, i see these options on the table:</p>
<ol>
<li>the status quo.  unpalatable because of hte need to generate thousands of delegate types.</li>
<li>a system that uses types like <code>Ref&lt;T&gt;</code> and <code>In&lt;T&gt;</code>.  Unpalatable because it will seem confusing to users.</li>
<li>a system that using naming conventions to inform the IL rewriter. Unpalatable because it seems too magical, and it seems really important that users actually write <code>ref</code> and <code>in</code> as actual keywords.</li>
<li>a sketch of a request to allow typed lambdas that are compiled into a form that only an IL rewriter could end up making use of.  Unpalatable because of how niche it is and how it basically can't actually be used by anyone except probably unity.  Also, would likely take 2 years to even get them out there.</li>
<li>source generators.  Unpalatable because no clue when we'll ever get them.</li>
</ol>
<p>Is that a fairly accurate lay of the land?</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzNTc4Ng==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzNTc4Ng==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzNTc4Ng==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/lucasmeijer/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lucasmeijer"><img height="40" width="40" alt="@lucasmeijer" src="https://avatars1.githubusercontent.com/u/308974?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513135786">
    <div>
      

  

<details data-body-version="6b15e05438a7780c92985b904871c599">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="6b15e05438a7780c92985b904871c599" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Thanks for all the input from everyone.</p>
<p>The comment from <a data-hovercard-type="user" data-hovercard-url="/users/kekekeks/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/kekekeks">@kekekeks</a> is exactly what I'm hoping for. <a data-error-text="Failed to load issue title" data-id="469428718" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/csharplang/issues/2668" data-hovercard-type="issue" data-hovercard-url="/dotnet/csharplang/issues/2668/hovercard?comment_id=512573609&amp;comment_type=issue_comment" href="https://github.com/dotnet/csharplang/issues/2668#issuecomment-512573609">#2668 (comment)</a></p>
<p>There's a wide range of alternative options kicked around (much appriciated).  Most of them I find not particularly appealing:</p>
<ul>
<li>
<p>the "lets use tuples" approach is hard to make work, because the way the usercode that takes a ref will be invoked is that we pass in a pointer to our actual native datastore for component data.  It's important that we do not have to copy a value out, let the user operate on that, and then copy it back in, since that is obviously slow, and nonobviously prevents the burst compiler from generating any SIMD code.  (the usercode that is written in the WithCode() lambda gets executed in a way where we have our own forloop written around it.  the combination of that forloop + the position and velocity data for all entities being stored linearly in memory, is what makes burst be able to generate such fast code for patterns like this).</p>
</li>
<li>
<p>the genre of suggestions that complicates the syntax/way the user has to write the code.  (requiring .Value.Value, and friends):  while creative, putting burden on our users instead of on ourselves doesn't feel like an amazing tradeoff.  I would prefer to deal with 6k lambdas, and maybe make some sacrifices there (like limiting the amount of elements you can use).</p>
</li>
</ul>
<p>One "oh almost so close" scenario is limiting the amount of delegate combinations through restrictions of the "ref arguments always have to come before in arguments" kind.  I think it is actually fine to require this, except that I cannot find a way to give the user a great error message when they get it wrong (which they will all the time).     If I could find a way to have a overload resolution failure because the delegate the user needs doesn't exist result in an error I can write that clearly explains what the problem is, and how they need to fix it (ideally with an analyzer fixup),  then I think we'd totally go for that approach.<br>
I've been unable to find a way to do that, seems like the compiler tries all overloads, and when it doesn't find one it can convert the lambda expression into, it will use the first overload and explain why that one doesn't work.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzNjc4OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzNjc4OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzNjc4OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CyrusNajmabadi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CyrusNajmabadi"><img height="40" width="40" alt="@CyrusNajmabadi" src="https://avatars3.githubusercontent.com/u/4564579?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513136788">
    <div>
      

  

<details data-body-version="f0183439e5b95ca3db508a03b4f665a3">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="f0183439e5b95ca3db508a03b4f665a3" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>If I could find a way to have a overload resolution failure because the delegate the user needs doesn't exist result in an error I can write that clearly explains what the problem is, and how they need to fix it (ideally with an analyzer fixup), then I think we'd totally go for that approach.</p>
</blockquote>
<p>You could always have an analyzer that provides this error message.  You will likely end up with two error messages for the issue (one from Roslyn and one that you provide) and that will likely take some user education.</p>
<blockquote>
<p>I've been unable to find a way to do that, seems like the compiler tries all overloads, and when it doesn't find one it can convert the lambda expression into, it will use the first overload and explain why that one doesn't work.</p>
</blockquote>
<p>I don't believe this is accurate.  I think the compiler has a bunch of heuristics about picking which overload it thinks is best in error scenairos.  If we can well define your error scenarios we could potentially tweak the compiler heuristic such that it did things better here if it would not regress other areas.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzODM0OA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzEzODM0OA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzEzODM0OA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/canton7/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/canton7"><img height="40" width="40" alt="@canton7" src="https://avatars0.githubusercontent.com/u/568104?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513138348">
    <div>
      

  

<details data-body-version="26733d5a050db9d7cdd06cbefbdbf2c3">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="26733d5a050db9d7cdd06cbefbdbf2c3" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>(I just want to point out that there are 3279 delegates in the file you linked, not 6500 - the rest of the file is method signatures. That's either a good thing or a bad thing depending on your point of view!)</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzE0MjEwOQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzE0MjEwOQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzE0MjEwOQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/canton7/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/canton7"><img height="40" width="40" alt="@canton7" src="https://avatars0.githubusercontent.com/u/568104?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513142109">
    <div>
      

  

<details data-body-version="9d83f04b32a260189de48a1973f92f52">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="9d83f04b32a260189de48a1973f92f52" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Part of the combinatorial explosion comes from the fact that you've got <code>ref</code>, <code>in</code>, <em>and</em> plain values.</p>
<p>Do you need both <code>in</code> and plain values? Since you're rewriting this anyway, you can change any <code>ins</code> to plain values, and vice versa. All you're after is a way to distinguish whether a parameter can be written to, and both <code>in</code> and plain values mean the same thing there.</p>
<p>If you can restrict these delegates to just <code>ref</code> and <code>in</code>, or just <code>ref</code> and plain values, that should help somewhat (down from 3279 delegates to 254, in your original file).</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzIxMjIzOA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzIxMjIzOA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzIxMjIzOA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/benaadams/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/benaadams"><img height="40" width="40" alt="@benaadams" src="https://avatars0.githubusercontent.com/u/1142958?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513212238">
    <div>
      

  

<details data-body-version="fad119b8f7593b4dcc96a85db684af91">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="fad119b8f7593b4dcc96a85db684af91" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>Do you need both <code>in</code> and plain values? Since you're rewriting this anyway, you can change any ins to plain values, and vice versa.</p>
</blockquote>
<p><code>in</code> and by value have different semantics and exchanging them would lose the programmer intent. <code>in</code> has to refer to a memory location; by value can be promoted to registers. by value could involve a large copy; <code>in</code> is just passing a pointer. <code>in</code> makes the fields on a struct readonly; by value they remain mutable.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzIxODYzOA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzIxODYzOA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzIxODYzOA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/canton7/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/canton7"><img height="40" width="40" alt="@canton7" src="https://avatars0.githubusercontent.com/u/568104?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513218638">
    <div>
      

  

<details data-body-version="28dcb8ea78dae8c989d1bfa0a6c0221b">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="28dcb8ea78dae8c989d1bfa0a6c0221b" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>in and by value have different semantics and exchanging them would lose the programmer intent. in has to refer to a memory location; by value can be promoted to registers. by value could involve a large copy; in is just passing a pointer. in makes the fields on a struct readonly; by value they remain mutable.</p>
</blockquote>
<p>Of course, I'm aware of this.</p>
<p>Reading the thread, there's no indication that the OP wants to use <code>ref</code> / <code>in</code> for their pass-by-reference semantics. Rather, they're an indication of whether this particular job modifies a particular components or not, and from that which other jobs it can be scheduled in parallel with.</p>
<p>I don't know what happens to that delegate once it's been rewritten. It could be that it's rewritten such that it's e.g. a method on a class, and the different components (e.g. <code>Position</code> and <code>Velocity</code>) are fields, in which case <code>in</code> has no meaning? It could be that it's ripped apart and becomes part of a larger method, with plain values being rewritten to <code>in</code>? I've got no insight into what DOTS does here.</p>
<p>It could also be that the only parameters to this delegate are components, and it could be that components are always structs which you would never want to pass by value. After all, if your delegate took a primitive like <code>int</code>, how would DOTS decide what <code>int</code> to give it? It might be that nobody in practice would ever use a plain value as an argument to one of these delegates.</p>
<p>Another possibility is that <code>in</code> is being treated purely as an optimization over a plain value. In this case, it might make sense for DOTS to decide what should be passed by value and what should be passed as <code>in</code>, based on which is going to perform better. If this is the case, then plain parameters and <code>in</code> convey the same programmer intent ("I won't modify this component"), and the optimization stuff is left to DOTS. In this case, you don't need both plain parameters and <code>in</code> - pick one or the other.</p>
<p>It could well be that OP has a good reason for wanting both plain parameters <em>and</em> <code>in</code> which answers all of my questions above, but I haven't yet seen it expressed in this thread, so I think it's worth asking the question.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzM0NDI2MQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzM0NDI2MQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzM0NDI2MQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/CodingJar/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/CodingJar"><img height="40" width="40" alt="@CodingJar" src="https://avatars0.githubusercontent.com/u/7340414?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513344261">
    <div>
      

  

<details data-body-version="d16a680631c50cbff240277256f6c4ef">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="d16a680631c50cbff240277256f6c4ef" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Can enforcing a function (as opposed to a lambda) and a simple nameof() be a solution here?</p>
<pre><code>        static void HandlePositionVelocity(ref Position position, in Velocity velocity)
        {
            position.Value += velocity.Value;
        }

        WithFunction( nameof(HandlePositionVelocity) );

</code></pre>
<p>This seems pretty clean to me.  You could potentially even rewrite the IL to follow this pattern if you're worried about people being confused and using a hard-coded "Handle_Position_Velocity".  With this restriction you can even mark-up your functions (HandlePositionVelocity) with attributes in the future to hint at optimizations.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ0MTQ5NA==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ0MTQ5NA==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzQ0MTQ5NA==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas"><img height="40" width="40" alt="@scottbilas" src="https://avatars0.githubusercontent.com/u/964720?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513441494">
    <div>
      

  

<details data-body-version="c9e3e59703a1f9f82242cd5726e97a59">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="c9e3e59703a1f9f82242cd5726e97a59" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/canton7/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/canton7">@canton7</a> I can explain why we want n^3 combos rather than n^2</p>
<ul>
<li><code>ref</code>: because the usercode will be directly modifying ECS memory</li>
<li><code>in</code>: because the usercode will be directly reading ECS memory</li>
<li>(undecorated): because we also support reference types in ECS memory, and <code>in</code>/<code>ref</code> there is nonsensical/surprising/misleading.</li>
</ul>
<p>We need to know programmer intent via <code>in</code> vs <code>ref</code> because it affects all kinds of internal mechanics. We could do this with <code>[ReadOnly] ref foo</code> but lambdas do not support param attrs. It's also nice to reuse existing compiler checks about field modification on <code>in</code> so we don't have to write our own (though obviously we still have the problem with method calls).</p>
<p>I would consider anything we come up with for reducing # combos to be a substandard solution. It will always come with a UX price. Also, if we provide n of something, a user will inevitably want n+1 of those, and then they will be really stuck, probably having to decompile+extend to add the extra param.</p>
<p>What we really want is to take an arbitrary delegate. So long as the compiler can verify that it is well-formed "yes, this is a function", we can handle it. And - crucially - we can give a really nice error message when they do something unsupported, letting them know why it's a problem and what they can do to fix it.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ2Njg4MQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ2Njg4MQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzQ2Njg4MQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/HaloFour/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/HaloFour"><img height="40" width="40" alt="@HaloFour" src="https://avatars1.githubusercontent.com/u/10102290?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513466881">
    <div>
      

  

<details data-body-version="cad630b23a908b933fd19ac1bc55d1d2">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="cad630b23a908b933fd19ac1bc55d1d2" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p><a data-hovercard-type="user" data-hovercard-url="/users/scottbilas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scottbilas">@scottbilas</a></p>
<blockquote>
<p>What we really want is to take an arbitrary delegate.</p>
</blockquote>
<p>You can do this today by having the method accept delegate.  The consumer then has to define their own delegate type, create a lambda and assign it to a delegate variable of that type, and then pass it to the method.  Klunky, yes, but that's what the language supports today.</p>
<p>The timeframe for adding any new features to the language is not short.  Many of the bigger features slated to be released in C# 8.0 have been in the works for years.  And the team is currently heads-down trying to wrap up C# 8.0, so nothing new is going to be considered at the moment.  Even if this got championed immediately and slated for the very next C# release you're likely not going to see something until next year.  Getting championed will likely require demonstrating use cases outside of DOTS, particularly given what you plan on doing with these delegates is so far removed from what normal developers will be able to do.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ3NDUzNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ3NDUzNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzQ3NDUzNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/DaZombieKiller/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/DaZombieKiller"><img height="40" width="40" alt="@DaZombieKiller" src="https://avatars0.githubusercontent.com/u/6316315?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513474537">
    <div>
      

  

<details data-body-version="c21c43a57f93772803e13ab74ec58b66">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="c21c43a57f93772803e13ab74ec58b66" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <blockquote>
<p>You can do this today by having the method accept delegate. The consumer then has to define their own delegate type, create a lambda and assign it to a delegate variable of that type, and then pass it to the method.</p>
</blockquote>
<p>Honestly I think this may be the best approach thus far. By delegating (haha) the declaration of the delegates to the user instead of the API itself, you won't need 6,500 predefined delegates. It wouldn't be hard at all to clearly document either.</p>
<p>This also means the user can supply attributes via the delegate, which I'm sure would be useful down the line.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ4NTU3NQ==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ4NTU3NQ==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzQ4NTU3NQ==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/HaloFour/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/HaloFour"><img height="40" width="40" alt="@HaloFour" src="https://avatars1.githubusercontent.com/u/10102290?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513485575">
    <div>
      

  

<details data-body-version="fc9df6e2561ad6f2475fd2edd11dab7f">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="fc9df6e2561ad6f2475fd2edd11dab7f" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Similarly you could use a generic type parameter constrained to <code>System.Delegate</code>.  The consumer would still have to define their own delegate type and specify it in the generic type argument:</p>
<div><pre><span>public</span> <span>delegate</span> <span>void</span> <span>ApplyVelocities</span>(<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>);

<span>public</span> <span>class</span> <span>C</span> {
    <span>public</span> <span>void</span> <span>M</span>() {
         <span>EntitiesForEach</span>
             .<span>WithBurst</span>(<span>true</span>)
             .<span>WithSupportStructuralChanges</span>(<span>false</span>)
             .<span>WithName</span>(<span><span>"</span>ApplyVelocities<span>"</span></span>) <span><span>//</span> maybe infer from the delegate name?</span>
             .<span>WithCode</span>&lt;<span>ApplyVelocities</span>&gt;((<span>ref</span> <span>Position</span> <span>position</span>, <span>in</span> <span>Velocity</span> <span>velocity</span>) <span>=&gt;</span>
             {
                 <span>position</span>.<span>Value</span> <span>+=</span> <span>velocity</span>.<span>Value</span>;
             });
    }
}</pre></div>
<p>That would give the consumer the flexibility to define literally any combination of parameters that they would want, generically or not, but at the price of having to define the delegate.  Maybe you could offer some overloads of those predefined delegates but to a smaller arity and combination to keep the delegate count reasonable but have this overload as an escape hatch for more complicated scenarios, like more than 8 arguments.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


    
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ4NzAxNg==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUxMzQ4NzAxNg==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUxMzQ4NzAxNg==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/scalablecory/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/scalablecory"><img height="40" width="40" alt="@scalablecory" src="https://avatars1.githubusercontent.com/u/4665835?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-513487016">
    <div>
      

  

<details data-body-version="d7f10f2ba9e05efda3219b7793ec0dfa">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="d7f10f2ba9e05efda3219b7793ec0dfa" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Variadic generics could be very nice, but not used too often</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>





<!-- Rendered timeline since 2019-07-20 10:52:41 -->



            </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>