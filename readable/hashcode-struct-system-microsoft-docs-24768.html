<!DOCTYPE html>
<html lang="en">
<head>
    <title>
HashCode Struct (System) - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="HashCode Struct (System) - linksfor.dev(s)"/>
    <meta property="article:author" content="dotnet-bot"/>
    <meta property="og:description" content="&lt;p sourcefile=&quot;api/System.HashCode.yml&quot; sourcestartlinenumber=&quot;1&quot; jsonPath=&quot;/summary&quot;&gt;Combines the hash code for multiple values into a single hash code.&lt;/p&gt;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://docs.microsoft.com/en-gb/dotnet/api/system.hashcode?view=netstandard-2.1"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - HashCode Struct (System)</title>
<div class="readable">
        <h1>HashCode Struct (System)</h1>
            <div>by dotnet-bot</div>
            <div>Reading time: 13-16 minutes</div>
        <div>Posted here: 22 May 2019</div>
        <p><a href="https://docs.microsoft.com/en-gb/dotnet/api/system.hashcode?view=netstandard-2.1">https://docs.microsoft.com/en-gb/dotnet/api/system.hashcode?view=netstandard-2.1</a></p>
        <hr/>
<div id="readability-page-1" class="page">


	<div data-bi-name="body">

		<div>

			

			<section>
				<div>


				<div id="main-column">

					<main id="main" role="main" data-bi-name="content" lang="en-us" dir="ltr">



						



						<!-- <content> -->
							



	<div>
		<div>
			<p>Combines the hash code for multiple values into a single hash code.</p>

			
		</div>
	</div>
<nav id="center-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="On page navigation">
  <h3>In this article</h3>
<ol><li><a href="#definition">Definition</a></li><li><a href="#remarks">Remarks</a></li><li><a href="#methods">Methods</a></li><li><a href="#moniker-applies-to">Applies to</a></li></ol></nav>
	<pre tabindex="0" hidden=""><code dir="ltr" data-author-content="public value class HashCode">public value class HashCode</code></pre>
	<pre tabindex="0"><code dir="ltr" data-author-content="public struct HashCode">public struct HashCode</code></pre>
	<pre tabindex="0" hidden=""><code dir="ltr" data-author-content="type HashCode = struct">type HashCode = struct</code></pre>
	<pre tabindex="0" hidden=""><code dir="ltr" data-author-content="Public Structure HashCode">Public Structure HashCode</code></pre>
	<dl>
		<dt>Inheritance</dt>
		<dd>
		
		</dd>
	</dl>


	<h2 id="remarks">Remarks<a href="#remarks" aria-labelledby="remarks"></a></h2>
	<p>You can use <a href="https://docs.microsoft.com/en-gb/dotnet/api/system.hashcode?view=netstandard-2.1" data-linktype="relative-path">HashCode</a> to combine multiple values (for example, fields on a structure or class) into a
single hash code. This structure operates in one of two ways:</p>
<ul>
<li>Static methods that accept a set of up to eight values to combine.</li>
<li>Two instance methods that operate in a streaming fashion, accepting values one at a time.</li>
</ul>
<div>
<p><span aria-hidden="true"></span> Warning</p>
<p>It is best-practice to consider hash codes as an implementation detail, as the implementation may change across
assembly versions. Do not store hash codes produced by <a href="https://docs.microsoft.com/en-gb/dotnet/api/system.hashcode?view=netstandard-2.1" data-linktype="relative-path">HashCode</a> in serialized structures, for example,
on-disk. <a href="https://docs.microsoft.com/en-gb/dotnet/api/system.hashcode?view=netstandard-2.1" data-linktype="relative-path">HashCode</a> uses a statically initialized random seed to enforce this best practice, meaning that
the hash codes are only deterministic within the scope of an operating system process.</p>
</div>
<h3 id="static-methods">Static Methods<a href="#static-methods" aria-labelledby="static-methods"></a></h3>
<p>The static methods combine the default hash codes of up to eight values.</p>
<pre tabindex="0"><code name="System.HashCode.Structure#1" data-author-content="using System;
using System.Collections.Generic;

public struct OrderOrderLine : IEquatable<OrderOrderLine>
{
    public int OrderId { get; }
    public int OrderLineId { get; }

    public OrderOrderLine(int orderId, int orderLineId) => (OrderId, OrderLineId) = (orderId, orderLineId);

    public override bool Equals(object obj) => obj is OrderOrderLine o &amp;&amp; Equals(o);

    public bool Equals(OrderOrderLine other) => OrderId == other.OrderId &amp;&amp; OrderLineId == other.OrderLineId;

    public override int GetHashCode() => HashCode.Combine(OrderId, OrderLineId);
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet<OrderOrderLine>
        {
            new OrderOrderLine(1, 1),
            new OrderOrderLine(1, 1),
            new OrderOrderLine(1, 2)
        };

        Console.WriteLine($&quot;Item count: {set.Count}.&quot;);
    }
}
// The example displays the following output:
// Item count: 2.
">using System;
using System.Collections.Generic;

public struct OrderOrderLine : IEquatable&lt;OrderOrderLine&gt;
{
    public int OrderId { get; }
    public int OrderLineId { get; }

    public OrderOrderLine(int orderId, int orderLineId) =&gt; (OrderId, OrderLineId) = (orderId, orderLineId);

    public override bool Equals(object obj) =&gt; obj is OrderOrderLine o &amp;&amp; Equals(o);

    public bool Equals(OrderOrderLine other) =&gt; OrderId == other.OrderId &amp;&amp; OrderLineId == other.OrderLineId;

    public override int GetHashCode() =&gt; HashCode.Combine(OrderId, OrderLineId);
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet&lt;OrderOrderLine&gt;
        {
            new OrderOrderLine(1, 1),
            new OrderOrderLine(1, 1),
            new OrderOrderLine(1, 2)
        };

        Console.WriteLine($"Item count: {set.Count}.");
    }
}
// The example displays the following output:
// Item count: 2.
</code></pre><pre tabindex="0" hidden=""><code name="System.HashCode.Structure#1" data-author-content="Public Structure OrderOrderLine
    Implements IEquatable(Of OrderOrderLine)

    Public ReadOnly Property OrderId As Integer
    Public ReadOnly Property OrderLineId As Integer

    Public Sub New(ByVal orderId As Integer, ByVal orderLineId As Integer)
        Me.OrderId = orderId
        Me.OrderLineId = orderLineId
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is OrderOrderLine) AndAlso Equals(DirectCast(obj, OrderOrderLine))
    End Function

    Public Overloads Function Equals(other As OrderOrderLine) As Boolean Implements IEquatable(Of OrderOrderLine).Equals
        Return OrderId = other.OrderId AndAlso
               OrderLineId = other.OrderLineId
    End Function

    Public Overrides Function GetHashCode() As Integer
        Return HashCode.Combine(OrderId, OrderLineId)
    End Function

End Structure

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of OrderOrderLine) = New HashSet(Of OrderOrderLine)
        hashSet.Add(New OrderOrderLine(1, 1))
        hashSet.Add(New OrderOrderLine(1, 1))
        hashSet.Add(New OrderOrderLine(1, 2))
        Console.WriteLine($&quot;Item count: {hashSet.Count}&quot;)
    End Sub

End Module
' The example displays the following output:
' Item count: 2.
">Public Structure OrderOrderLine
    Implements IEquatable(Of OrderOrderLine)

    Public ReadOnly Property OrderId As Integer
    Public ReadOnly Property OrderLineId As Integer

    Public Sub New(ByVal orderId As Integer, ByVal orderLineId As Integer)
        Me.OrderId = orderId
        Me.OrderLineId = orderLineId
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is OrderOrderLine) AndAlso Equals(DirectCast(obj, OrderOrderLine))
    End Function

    Public Overloads Function Equals(other As OrderOrderLine) As Boolean Implements IEquatable(Of OrderOrderLine).Equals
        Return OrderId = other.OrderId AndAlso
               OrderLineId = other.OrderLineId
    End Function

    Public Overrides Function GetHashCode() As Integer
        Return HashCode.Combine(OrderId, OrderLineId)
    End Function

End Structure

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of OrderOrderLine) = New HashSet(Of OrderOrderLine)
        hashSet.Add(New OrderOrderLine(1, 1))
        hashSet.Add(New OrderOrderLine(1, 1))
        hashSet.Add(New OrderOrderLine(1, 2))
        Console.WriteLine($"Item count: {hashSet.Count}")
    End Sub

End Module
' The example displays the following output:
' Item count: 2.
</code></pre><h3 id="instance-methods">Instance Methods<a href="#instance-methods" aria-labelledby="instance-methods"></a></h3>

<p>The instance methods combine the hash codes of more than eight values.</p>
<pre tabindex="0"><code name="System.HashCode.Structure#2" data-author-content="using System;
using System.Collections.Generic;

public struct Path : IEquatable<Path>
{
    public IReadOnlyList<string> Segments { get; }

    public Path(params string[] segments) => Segments = segments;

    public override bool Equals(object obj) => obj is Path o &amp;&amp; Equals(o);

    public bool Equals(Path other)
    {
        if (ReferenceEquals(Segments, other.Segments)) return true;
        if (Segments is null || other.Segments is null) return false;
        if (Segments.Count != other.Segments.Count) return false;

        for (var i = 0; i < Segments.Count; i++)
        {
            if (!string.Equals(Segments[i], other.Segments[i]))
                return false;
        }

        return true;
    }

    public override int GetHashCode()
    {
        var hash = new HashCode();

        for (var i = 0; i < Segments?.Count; i++)
            hash.Add(Segments[i]);

        return hash.ToHashCode();
    }
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet<Path>
        {
            new Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            new Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            new Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.tmp&quot;)
        };

        Console.WriteLine($&quot;Item count: {set.Count}.&quot;);
    }
}
// The example displays the following output:
// Item count: 2.
">using System;
using System.Collections.Generic;

public struct Path : IEquatable&lt;Path&gt;
{
    public IReadOnlyList&lt;string&gt; Segments { get; }

    public Path(params string[] segments) =&gt; Segments = segments;

    public override bool Equals(object obj) =&gt; obj is Path o &amp;&amp; Equals(o);

    public bool Equals(Path other)
    {
        if (ReferenceEquals(Segments, other.Segments)) return true;
        if (Segments is null || other.Segments is null) return false;
        if (Segments.Count != other.Segments.Count) return false;

        for (var i = 0; i &lt; Segments.Count; i++)
        {
            if (!string.Equals(Segments[i], other.Segments[i]))
                return false;
        }

        return true;
    }

    public override int GetHashCode()
    {
        var hash = new HashCode();

        for (var i = 0; i &lt; Segments?.Count; i++)
            hash.Add(Segments[i]);

        return hash.ToHashCode();
    }
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet&lt;Path&gt;
        {
            new Path("C:", "tmp", "file.txt"),
            new Path("C:", "tmp", "file.txt"),
            new Path("C:", "tmp", "file.tmp")
        };

        Console.WriteLine($"Item count: {set.Count}.");
    }
}
// The example displays the following output:
// Item count: 2.
</code></pre><pre tabindex="0" hidden=""><code name="System.HashCode.Structure#2" data-author-content="Public Structure Path
    Implements IEquatable(Of Path)

    Public ReadOnly Property Segments As IReadOnlyList(Of String)

    Public Sub New(ParamArray ByVal segments() As String)
        Me.Segments = segments
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is Path) AndAlso Equals(DirectCast(obj, Path))
    End Function

    Public Overloads Function Equals(other As Path) As Boolean Implements IEquatable(Of Path).Equals
        If ReferenceEquals(Segments, other.Segments) Then Return True
        If Segments Is Nothing OrElse other.Segments Is Nothing Then Return False
        If Segments.Count <> other.Segments.Count Then Return False

        For i As Integer = 0 To Segments.Count - 1
            If Not String.Equals(Segments(i), other.Segments(i)) Then Return False
        Next

        Return True
    End Function

    Public Overrides Function GetHashCode() As Integer
        Dim hash As HashCode = New HashCode()

        For i As Integer = 0 To Segments?.Count - 1
            hash.Add(Segments(i))
        Next

        Return hash.ToHashCode()
    End Function

End Structure

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of Path) = New HashSet(Of Path) From {
            New Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            New Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            New Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.tmp&quot;)
        }
        Console.WriteLine($&quot;Item count: {hashSet.Count}.&quot;)
    End Sub

End Module
' The example displays the following output:
' Item count: 2.
">Public Structure Path
    Implements IEquatable(Of Path)

    Public ReadOnly Property Segments As IReadOnlyList(Of String)

    Public Sub New(ParamArray ByVal segments() As String)
        Me.Segments = segments
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is Path) AndAlso Equals(DirectCast(obj, Path))
    End Function

    Public Overloads Function Equals(other As Path) As Boolean Implements IEquatable(Of Path).Equals
        If ReferenceEquals(Segments, other.Segments) Then Return True
        If Segments Is Nothing OrElse other.Segments Is Nothing Then Return False
        If Segments.Count &lt;&gt; other.Segments.Count Then Return False

        For i As Integer = 0 To Segments.Count - 1
            If Not String.Equals(Segments(i), other.Segments(i)) Then Return False
        Next

        Return True
    End Function

    Public Overrides Function GetHashCode() As Integer
        Dim hash As HashCode = New HashCode()

        For i As Integer = 0 To Segments?.Count - 1
            hash.Add(Segments(i))
        Next

        Return hash.ToHashCode()
    End Function

End Structure

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of Path) = New HashSet(Of Path) From {
            New Path("C:", "tmp", "file.txt"),
            New Path("C:", "tmp", "file.txt"),
            New Path("C:", "tmp", "file.tmp")
        }
        Console.WriteLine($"Item count: {hashSet.Count}.")
    End Sub

End Module
' The example displays the following output:
' Item count: 2.
</code></pre>
<p>The instance methods also combine the hash codes produced by a specific
<a href="https://docs.microsoft.com/en-gb/dotnet/api/system.collections.generic.iequalitycomparer-1?view=netstandard-2.1" data-linktype="relative-path">IEqualityComparer&lt;T&gt;</a> implementation.</p>
<pre tabindex="0"><code name="System.HashCode.Structure#3" data-author-content="using System;
using System.Collections.Generic;

public struct Path : IEquatable<Path>
{
    public IReadOnlyList<string> Segments { get; }

    public Path(params string[] segments) => Segments = segments;

    public override bool Equals(object obj) => obj is Path o &amp;&amp; Equals(o);

    public bool Equals(Path other)
    {
        if (ReferenceEquals(Segments, other.Segments)) return true;
        if (Segments is null || other.Segments is null) return false;
        if (Segments.Count != other.Segments.Count) return false;

        for (var i = 0; i < Segments.Count; i++)
        {
            if (!string.Equals(Segments[i], other.Segments[i], StringComparison.OrdinalIgnoreCase))
                return false;
        }

        return true;
    }

    public override int GetHashCode()
    {
        var hash = new HashCode();

        for (var i = 0; i < Segments?.Count; i++)
            hash.Add(Segments[i], StringComparer.OrdinalIgnoreCase);

        return hash.ToHashCode();
    }
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet<Path>
        {
            new Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            new Path(&quot;C:&quot;, &quot;TMP&quot;, &quot;file.txt&quot;),
            new Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;FILE.TXT&quot;)
        };

        Console.WriteLine($&quot;Item count: {set.Count}.&quot;);
    }
}
// The example displays the following output:
// Item count: 1.
">using System;
using System.Collections.Generic;

public struct Path : IEquatable&lt;Path&gt;
{
    public IReadOnlyList&lt;string&gt; Segments { get; }

    public Path(params string[] segments) =&gt; Segments = segments;

    public override bool Equals(object obj) =&gt; obj is Path o &amp;&amp; Equals(o);

    public bool Equals(Path other)
    {
        if (ReferenceEquals(Segments, other.Segments)) return true;
        if (Segments is null || other.Segments is null) return false;
        if (Segments.Count != other.Segments.Count) return false;

        for (var i = 0; i &lt; Segments.Count; i++)
        {
            if (!string.Equals(Segments[i], other.Segments[i], StringComparison.OrdinalIgnoreCase))
                return false;
        }

        return true;
    }

    public override int GetHashCode()
    {
        var hash = new HashCode();

        for (var i = 0; i &lt; Segments?.Count; i++)
            hash.Add(Segments[i], StringComparer.OrdinalIgnoreCase);

        return hash.ToHashCode();
    }
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet&lt;Path&gt;
        {
            new Path("C:", "tmp", "file.txt"),
            new Path("C:", "TMP", "file.txt"),
            new Path("C:", "tmp", "FILE.TXT")
        };

        Console.WriteLine($"Item count: {set.Count}.");
    }
}
// The example displays the following output:
// Item count: 1.
</code></pre><pre tabindex="0" hidden=""><code name="System.HashCode.Structure#3" data-author-content="Public Structure Path
    Implements IEquatable(Of Path)

    Public ReadOnly Property Segments As IReadOnlyList(Of String)

    Public Sub New(ParamArray ByVal segments() As String)
        Me.Segments = segments
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is Path) AndAlso Equals(DirectCast(obj, Path))
    End Function

    Public Overloads Function Equals(other As Path) As Boolean Implements IEquatable(Of Path).Equals
        If ReferenceEquals(Segments, other.Segments) Then Return True
        If Segments Is Nothing OrElse other.Segments Is Nothing Then Return False
        If Segments.Count <> other.Segments.Count Then Return False

        For i As Integer = 0 To Segments.Count - 1
            If Not String.Equals(Segments(i), other.Segments(i), StringComparison.OrdinalIgnoreCase) Then Return False
        Next

        Return True
    End Function

    Public Overrides Function GetHashCode() As Integer
        Dim hash As HashCode = New HashCode()

        For i As Integer = 0 To Segments?.Count - 1
            hash.Add(Segments(i), StringComparer.OrdinalIgnoreCase)
        Next

        Return hash.ToHashCode()
    End Function
    
End Structure

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of Path) = New HashSet(Of Path) From {
            New Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            New Path(&quot;C:&quot;, &quot;TMP&quot;, &quot;file.txt&quot;),
            New Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;FILE.TXT&quot;)
        }
        Console.WriteLine($&quot;Item count: {hashSet.Count}.&quot;)
    End Sub

End Module
' The example displays the following output:
' Item count: 1.
">Public Structure Path
    Implements IEquatable(Of Path)

    Public ReadOnly Property Segments As IReadOnlyList(Of String)

    Public Sub New(ParamArray ByVal segments() As String)
        Me.Segments = segments
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is Path) AndAlso Equals(DirectCast(obj, Path))
    End Function

    Public Overloads Function Equals(other As Path) As Boolean Implements IEquatable(Of Path).Equals
        If ReferenceEquals(Segments, other.Segments) Then Return True
        If Segments Is Nothing OrElse other.Segments Is Nothing Then Return False
        If Segments.Count &lt;&gt; other.Segments.Count Then Return False

        For i As Integer = 0 To Segments.Count - 1
            If Not String.Equals(Segments(i), other.Segments(i), StringComparison.OrdinalIgnoreCase) Then Return False
        Next

        Return True
    End Function

    Public Overrides Function GetHashCode() As Integer
        Dim hash As HashCode = New HashCode()

        For i As Integer = 0 To Segments?.Count - 1
            hash.Add(Segments(i), StringComparer.OrdinalIgnoreCase)
        Next

        Return hash.ToHashCode()
    End Function
    
End Structure

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of Path) = New HashSet(Of Path) From {
            New Path("C:", "tmp", "file.txt"),
            New Path("C:", "TMP", "file.txt"),
            New Path("C:", "tmp", "FILE.TXT")
        }
        Console.WriteLine($"Item count: {hashSet.Count}.")
    End Sub

End Module
' The example displays the following output:
' Item count: 1.
</code></pre>
<p>The <a href="https://docs.microsoft.com/en-gb/dotnet/api/system.hashcode?view=netstandard-2.1" data-linktype="relative-path">HashCode</a> structure must be passed by-reference to other methods, as it is a value type.</p>
<pre tabindex="0"><code name="System.HashCode.Structure#4" data-author-content="using System;
using System.Collections.Generic;

public struct Path : IEquatable<Path>
{
    public IReadOnlyList<string> Segments { get; }

    public Path(params string[] segments) => Segments = segments;

    public override bool Equals(object obj) => obj is Path o &amp;&amp; Equals(o);

    public bool Equals(Path other)
    {
        if (ReferenceEquals(Segments, other.Segments)) return true;
        if (Segments is null || other.Segments is null) return false;
        if (Segments.Count != other.Segments.Count) return false;

        for (var i = 0; i < Segments.Count; i++)
        {
            if (!PlatformUtils.PathEquals(Segments[i], other.Segments[i]))
                return false;
        }

        return true;
    }

    public override int GetHashCode()
    {
        var hash = new HashCode();

        for (var i = 0; i < Segments?.Count; i++)
            PlatformUtils.AddPath(ref hash, Segments[i]);

        return hash.ToHashCode();
    }
}

internal static class PlatformUtils
{
    public static bool PathEquals(string a, string b) => string.Equals(a, b, StringComparison.OrdinalIgnoreCase);
    public static void AddPath(ref HashCode hash, string path) => hash.Add(path, StringComparer.OrdinalIgnoreCase);
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet<Path>
        {
            new Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            new Path(&quot;C:&quot;, &quot;TMP&quot;, &quot;file.txt&quot;),
            new Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;FILE.TXT&quot;)
        };

        Console.WriteLine($&quot;Item count: {set.Count}.&quot;);
    }
}
// The example displays the following output:
// Item count: 1.
">using System;
using System.Collections.Generic;

public struct Path : IEquatable&lt;Path&gt;
{
    public IReadOnlyList&lt;string&gt; Segments { get; }

    public Path(params string[] segments) =&gt; Segments = segments;

    public override bool Equals(object obj) =&gt; obj is Path o &amp;&amp; Equals(o);

    public bool Equals(Path other)
    {
        if (ReferenceEquals(Segments, other.Segments)) return true;
        if (Segments is null || other.Segments is null) return false;
        if (Segments.Count != other.Segments.Count) return false;

        for (var i = 0; i &lt; Segments.Count; i++)
        {
            if (!PlatformUtils.PathEquals(Segments[i], other.Segments[i]))
                return false;
        }

        return true;
    }

    public override int GetHashCode()
    {
        var hash = new HashCode();

        for (var i = 0; i &lt; Segments?.Count; i++)
            PlatformUtils.AddPath(ref hash, Segments[i]);

        return hash.ToHashCode();
    }
}

internal static class PlatformUtils
{
    public static bool PathEquals(string a, string b) =&gt; string.Equals(a, b, StringComparison.OrdinalIgnoreCase);
    public static void AddPath(ref HashCode hash, string path) =&gt; hash.Add(path, StringComparer.OrdinalIgnoreCase);
}

class Program
{
    static void Main(string[] args)
    {
        var set = new HashSet&lt;Path&gt;
        {
            new Path("C:", "tmp", "file.txt"),
            new Path("C:", "TMP", "file.txt"),
            new Path("C:", "tmp", "FILE.TXT")
        };

        Console.WriteLine($"Item count: {set.Count}.");
    }
}
// The example displays the following output:
// Item count: 1.
</code></pre><pre tabindex="0" hidden=""><code name="System.HashCode.Structure#4" data-author-content="Public Structure Path
    Implements IEquatable(Of Path)

    Public ReadOnly Property Segments As IReadOnlyList(Of String)

    Public Sub New(ParamArray ByVal segments() As String)
        Me.Segments = segments
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is Path) AndAlso Equals(DirectCast(obj, Path))
    End Function

    Public Overloads Function Equals(other As Path) As Boolean Implements IEquatable(Of Path).Equals
        If ReferenceEquals(Segments, other.Segments) Then Return True
        If Segments Is Nothing OrElse other.Segments Is Nothing Then Return False
        If Segments.Count <> other.Segments.Count Then Return False

        For i As Integer = 0 To Segments.Count - 1
            If Not PathEquals(Segments(i), other.Segments(i)) Then Return False
        Next

        Return True
    End Function

    Public Overrides Function GetHashCode() As Integer
        Dim hash As HashCode = New HashCode()

        For i As Integer = 0 To Segments?.Count - 1
            AddPath(hash, Segments(i))
        Next

        Return hash.ToHashCode()
    End Function
    
End Structure

Friend Module PlatformUtils

    Public Function PathEquals(ByVal a As String, ByVal b As String) As Boolean
        Return String.Equals(a, b, StringComparison.OrdinalIgnoreCase)
    End Function

    Public Sub AddPath(ByRef hash As HashCode, ByVal path As String)
        hash.Add(path, StringComparer.OrdinalIgnoreCase)
    End Sub

End Module

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of Path) = New HashSet(Of Path) From {
            New Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;file.txt&quot;),
            New Path(&quot;C:&quot;, &quot;TMP&quot;, &quot;file.txt&quot;),
            New Path(&quot;C:&quot;, &quot;tmp&quot;, &quot;FILE.TXT&quot;)
        }
        Console.WriteLine($&quot;Item count: {hashSet.Count}.&quot;)
    End Sub

End Module
' The example displays the following output:
' Item count: 1.
">Public Structure Path
    Implements IEquatable(Of Path)

    Public ReadOnly Property Segments As IReadOnlyList(Of String)

    Public Sub New(ParamArray ByVal segments() As String)
        Me.Segments = segments
    End Sub

    Public Overrides Function Equals(obj As Object) As Boolean
        Return (TypeOf obj Is Path) AndAlso Equals(DirectCast(obj, Path))
    End Function

    Public Overloads Function Equals(other As Path) As Boolean Implements IEquatable(Of Path).Equals
        If ReferenceEquals(Segments, other.Segments) Then Return True
        If Segments Is Nothing OrElse other.Segments Is Nothing Then Return False
        If Segments.Count &lt;&gt; other.Segments.Count Then Return False

        For i As Integer = 0 To Segments.Count - 1
            If Not PathEquals(Segments(i), other.Segments(i)) Then Return False
        Next

        Return True
    End Function

    Public Overrides Function GetHashCode() As Integer
        Dim hash As HashCode = New HashCode()

        For i As Integer = 0 To Segments?.Count - 1
            AddPath(hash, Segments(i))
        Next

        Return hash.ToHashCode()
    End Function
    
End Structure

Friend Module PlatformUtils

    Public Function PathEquals(ByVal a As String, ByVal b As String) As Boolean
        Return String.Equals(a, b, StringComparison.OrdinalIgnoreCase)
    End Function

    Public Sub AddPath(ByRef hash As HashCode, ByVal path As String)
        hash.Add(path, StringComparer.OrdinalIgnoreCase)
    End Sub

End Module

Module Program

    Sub Main(args As String())
        Dim hashSet As HashSet(Of Path) = New HashSet(Of Path) From {
            New Path("C:", "tmp", "file.txt"),
            New Path("C:", "TMP", "file.txt"),
            New Path("C:", "tmp", "FILE.TXT")
        }
        Console.WriteLine($"Item count: {hashSet.Count}.")
    End Sub

End Module
' The example displays the following output:
' Item count: 1.
</code></pre>






	<h2 id="methods">
		Methods
	<a href="#methods" aria-labelledby="methods"></a></h2>
	







	<h2 id="moniker-applies-to">Applies to<a href="#moniker-applies-to" aria-labelledby="moniker-applies-to"></a></h2><h4>.NET Core</h4>

			
<h4>.NET Platform Extensions</h4>

			
<h4>.NET Standard</h4>

			




						<!-- </content> -->

						</main>

						<!-- recommended content page section -->


						<!-- end recommended content page section -->

						<!-- rating mobile section -->
								
						<!-- end rating mobile section -->

						<!-- feedback section -->




						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						
					</div>

					

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			
		</div>

		<!--end of .mainContainer -->
	</div>

	

	

	


</div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs" /></noscript>
</body>
</html>