<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Life, part 2 - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Life, part 2 - linksfor.dev(s)"/>
    <meta property="og:description" content="Code for this episode can be found here. There are literally fifty years of articles explaining Conway&#x2019;s Game of Life, starting with the one that introduced it to me: the October 1970 issue o&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://ericlippert.com/2020/04/20/life-part-2/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Life, part 2</title>
<div class="readable">
        <h1>Life, part 2</h1>
            <div>Reading time: 9-11 minutes</div>
        <div>Posted here: 20 Apr 2020</div>
        <p><a href="https://ericlippert.com/2020/04/20/life-part-2/">https://ericlippert.com/2020/04/20/life-part-2/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
		<p data-adtags-visited="true">Code for this episode can be found <a href="https://github.com/ericlippert/ConwaysLife/tree/episode02">here</a>.</p>
<hr>
<p data-adtags-visited="true">There are literally fifty years of articles explaining Conway’s Game of Life, starting with the one that introduced it to me: the October 1970 issue of Scientific American. Seems like a great time to do one more! I’ll go pretty quickly, since this is familiar to a lot of readers already.</p>
<p data-adtags-visited="true">Imagine an infinite flat board of square cells, like a huge piece of ordinary graph paper. Every cell has only two possible states, which we conveniently call “alive” and “dead”.</p>
<p data-adtags-visited="true">Just as the space in which Life is played is divided into discrete portions, so too is time. In the Life universe every time the clock “ticks”, some cells may be born, some may continue to live, and some may die. The rules governing this evolution are straightforward:</p>
<ul>
<li>The “neighbors” of a cell are the eight cells which surround it.</li>
<li>If a cell is alive now and has exactly zero or one living neighbors, it dies of loneliness.</li>
<li>If a cell is alive now and has exactly two or three living neighbors, it survives.</li>
<li>If a cell is alive now and has four or more living neighbors, it dies from overcrowding.</li>
<li>If a cell is dead now and has exactly three living neighbors, it becomes alive.</li>
<li>If a cell is dead now and has any other number of living neighbors, it stays dead.</li>
</ul>
<p data-adtags-visited="true">These rules can be simplified greatly; I leave it as an exercise to the reader to verify that these rules are the same:</p>
<ul>
<li>If a cell has exactly three living neighbors then it is alive on the next tick irrespective of whether it is currently alive or dead.</li>
<li>Otherwise, if a cell is alive and has exactly two living neighbors then it is alive on the next tick.</li>
<li>Otherwise, the cell is dead on the next tick.</li>
</ul>
<p data-adtags-visited="true">Let’s look at some simple examples:</p>
<p data-adtags-visited="true"><a href="https://ericlippert.files.wordpress.com/2020/04/1rmmuu52yio.jpg"><img data-attachment-id="6845" data-permalink="https://ericlippert.com/2020/04/20/life-part-2/1rmmuu52yio/" data-orig-file="https://ericlippert.files.wordpress.com/2020/04/1rmmuu52yio.jpg" data-orig-size="274,192" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1rmmuu52yio" data-image-description="" data-medium-file="https://ericlippert.files.wordpress.com/2020/04/1rmmuu52yio.jpg?w=274" data-large-file="https://ericlippert.files.wordpress.com/2020/04/1rmmuu52yio.jpg?w=274" src="https://ericlippert.files.wordpress.com/2020/04/1rmmuu52yio.jpg?w=584" alt="" srcset="https://ericlippert.files.wordpress.com/2020/04/1rmmuu52yio.jpg 274w, https://ericlippert.files.wordpress.com/2020/04/1rmmuu52yio.jpg?w=150 150w" sizes="(max-width: 274px) 100vw, 274px"></a></p>
<p data-adtags-visited="true">All of the living cells have one or no living neighbors, so they will all be dead on the next tick. None of the dead cells have exactly three living neighbors, so they will stay dead; the next tick has no living cells.</p>
<p data-adtags-visited="true">By contrast, these “still lifes” have the property that every living cell has two or three living neighbors, but no dead cell has exactly three living neighbors. These still lifes are traditionally called the block, beehive, pond, tub, boat and snake; they are stable. There are many, many more stable structures like this.</p>
<p data-adtags-visited="true"><a href="https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg"><img data-attachment-id="6846" data-permalink="https://ericlippert.com/2020/04/20/life-part-2/p2wapf5vmw2/" data-orig-file="https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg" data-orig-size="580,339" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="p2wapf5vmw2" data-image-description="" data-medium-file="https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg?w=300" data-large-file="https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg?w=580" src="https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg?w=584" alt="" srcset="https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg 580w, https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg?w=150 150w, https://ericlippert.files.wordpress.com/2020/04/p2wapf5vmw2.jpg?w=300 300w" sizes="(max-width: 580px) 100vw, 580px"></a></p>
<p data-adtags-visited="true">We haven’t seen any births yet; the easiest one is this triomino:</p>
<p data-adtags-visited="true"><a href="https://ericlippert.files.wordpress.com/2020/04/ntwfacv2rzv.jpg"><img data-attachment-id="6848" data-permalink="https://ericlippert.com/2020/04/20/life-part-2/ntwfacv2rzv/" data-orig-file="https://ericlippert.files.wordpress.com/2020/04/ntwfacv2rzv.jpg" data-orig-size="262,197" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ntwfacv2rzv" data-image-description="" data-medium-file="https://ericlippert.files.wordpress.com/2020/04/ntwfacv2rzv.jpg?w=262" data-large-file="https://ericlippert.files.wordpress.com/2020/04/ntwfacv2rzv.jpg?w=262" src="https://ericlippert.files.wordpress.com/2020/04/ntwfacv2rzv.jpg?w=584" alt="" srcset="https://ericlippert.files.wordpress.com/2020/04/ntwfacv2rzv.jpg 262w, https://ericlippert.files.wordpress.com/2020/04/ntwfacv2rzv.jpg?w=150 150w" sizes="(max-width: 262px) 100vw, 262px"></a></p>
<p data-adtags-visited="true">I’m sure you see which dead cell has exactly three living neighbors; it will be alive in the next tick. All the live cells have two living neighbors, and no other dead cell has three, so this will turn into a block and then will be stable.</p>
<p data-adtags-visited="true">Can we come up with an oscillating pattern? It is not hard!</p>
<p data-adtags-visited="true"><a href="https://ericlippert.files.wordpress.com/2020/04/blinker.gif"><img data-attachment-id="6850" data-permalink="https://ericlippert.com/2020/04/20/life-part-2/blinker/" data-orig-file="https://ericlippert.files.wordpress.com/2020/04/blinker.gif" data-orig-size="262,197" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="blinker" data-image-description="" data-medium-file="https://ericlippert.files.wordpress.com/2020/04/blinker.gif?w=262" data-large-file="https://ericlippert.files.wordpress.com/2020/04/blinker.gif?w=262" src="https://ericlippert.files.wordpress.com/2020/04/blinker.gif?w=584" alt=""></a></p>
<p data-adtags-visited="true">For obvious reasons this triomino is called “blinker”. There are a number of other relatively small configurations like this which oscillate with a period of two ticks.</p>
<p data-adtags-visited="true">I’ll finish this introduction off with the most important simple pattern in Life, the glider:</p>
<p data-adtags-visited="true"><a href="https://ericlippert.files.wordpress.com/2020/04/glider.gif"><img data-attachment-id="6851" data-permalink="https://ericlippert.com/2020/04/20/life-part-2/glider/" data-orig-file="https://ericlippert.files.wordpress.com/2020/04/glider.gif" data-orig-size="275,206" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="glider" data-image-description="" data-medium-file="https://ericlippert.files.wordpress.com/2020/04/glider.gif?w=275" data-large-file="https://ericlippert.files.wordpress.com/2020/04/glider.gif?w=275" src="https://ericlippert.files.wordpress.com/2020/04/glider.gif?w=584" alt=""></a></p>
<p data-adtags-visited="true">The glider oscillates between two basic forms, but after two ticks it has reflected itself along the diagonal axis, and then two ticks later it reflects back again to the original form, but offset by one cell “east” and one cell “south”. The glider is the simplest “spaceship” pattern; it is stable as it moves around the board. Here I’ve shown nine ticks in the life of a glider.</p>
<p data-adtags-visited="true">Clearly we can build gliders that move northeast, northwest and southwest easily enough, just by rotating the glider to “point” another direction.</p>
<hr>
<p data-adtags-visited="true">I want to look at some different techniques for simulating Life. As will become extremely apparent when you look at the code or run the executable, I almost never write the user interface portion of any software package; my entire career I’ve built semantic analyzers for programming languages and there’s not a lot of UI design there. If I make foolish mistakes in my UI code, please feel free to point them out.</p>
<p data-adtags-visited="true">I’m therefore going to divide the project into a client form that has the user interface, that talks to a computation engine over an interface. I’ll point out a few features of the client here and there, but mostly we’ll concentrate on the computations.</p>
<p data-adtags-visited="true">As usual, I’ll put the code on GitHub and I’ll make a separate branch for each episode with new code. Sorry Mac users, it is a WinForms application.</p>
<p data-adtags-visited="true">The initial attempt here barely even has a user interface; it does not respond to user input except for the standard close, resize, and so on. But I’ve laid the groundwork for eventually implementing a more sophisticated client. In particular, a key problem to solve is identifying the rectangle of cells which is currently “in view” in the UI and rendering those cells to the UI. I’d like to be able to zoom in and out.</p>
<p data-adtags-visited="true">We could implement arbitrarily scaled zooming, but as we’ll see in later episodes, it’s going to be convenient to restrict scaling to powers of two, and as I said, I’m interested more in the algorithms than a pleasant UI.</p>
<p data-adtags-visited="true">In order to achieve this, an important bit of form state is:</p>
<pre> private int scale = -5;</pre>
<p data-adtags-visited="true">The convention that I’m using here takes a moment to wrap your head around. The convention is:</p>
<ul>
<li>If the scale is zero, then every on-screen pixel represents exactly one Life cell. This is implemented in the client, but since there is no control surface yet, you’ll have to adjust the scale in the debugger or recompile the code.</li>
<li>If the scale is a negative number, then we are “zoomed in”. Each Life cell is represented by a square that is <code>1 &lt;&lt; -scale</code> pixels wide. By default, I’ve set the scale to -5, which means that each Life cell is represented by a 32 by 32 square of pixels. Again, you can tweak that up or down in the debugger.</li>
<li>If the scale is a positive number then we go the other way: each pixel represents a square that is <code>1 &lt;&lt; scale</code> Life cells wide. <strong>This feature is not yet implemented,</strong> so don’t bump the scale up into positive numbers just yet.</li>
</ul>
<p data-adtags-visited="true">A lot of the code in the form is about translating from the pixel-based bitmap coordinates, where (0, 0) is the upper left corner; the x coordinate increases to the right, and the y coordinate increases as we go <strong>down</strong>. The Life grid is an infinite plane where each cell can be addressed by a pair of integers, so there is no “corner”; I’m using the standard graph paper convention that the x coordinate increases to the right and the y coordinate increases as we go <strong>up</strong>. That entails some tricky bookkeeping, but we’ll manage. I’ve configured the UI so that when it starts up, Life coordinate (-2, -2) is in the lower left corner of the picture box.</p>
<p data-adtags-visited="true">I’ve introduced my own immutable point and rectangle structs to represent regions of the Life grid. That’s for three reasons. First, because the default point and rectangle structs are mutable, which gives me hives. Second, because they use integers, and I’m eventually going to be building Life grids that cannot be addressed by integers. And third, because as long-time readers of this blog know, I like to use the type system to find my mistakes before I make them. I’m not going to mix up <code>LifePoint</code> and <code>Point</code> easily!</p>
<p data-adtags-visited="true">The only other notable thing about the client is that it has a rarity; I’ve written unsafe code for something other than a compiler test case! That has happened only a handful of times in multiple decades of writing C# code. Setting individual pixels in a bitmap is slow and I’m going to be potentially setting a lot of them, so I’ve created a little function that parties directly on the raw bits of a bitmap in memory.</p>
<p data-adtags-visited="true">The interface between the client and the computation engine is straightforward; we’ll be making it more complex in later episodes as we add features to the client:</p>
<pre>interface ILife
{
  void Clear();
  bool this[long x, long y] { get; set; }
  bool this[LifePoint v] { get; set; }
  void Draw(LifeRect rect, Action&lt;LifePoint&gt; setPixel);
  void Step();
}</pre>
<p data-adtags-visited="true">This represents a <em>mutable</em> Life grid; long-time readers of my blog know that I prefer immutable data structures, and we’ll look at how to represent an immutable Life grid efficiently in later episodes. Fortunately it is almost always easy to make a mutable implementation on top of an immutable one, but often not easy to go the other way.</p>
<p data-adtags-visited="true">The two indexers are just for convenience; they are semantically identical.</p>
<p data-adtags-visited="true">The Clear and Step methods should be straightforward; one clears the board of all living cells, and Step moves the board forward one tick.&nbsp; We’ll add methods in later versions to move forward multiple steps.</p>
<p data-adtags-visited="true">The Draw method is the interesting one. Basically the idea here is that Life boards almost always have far more dead cells than alive cells because the overcrowding rule tends to keep the density low. We can therefore get a win by only drawing the live cells.</p>
<p data-adtags-visited="true">The convention for drawing is: the client passes in the rectangular region of the board that the client wishes to render, and the engine calls the callback for every live cell. In order to implement the “zoom out” feature we’ll make this method a little more sophisticated in future versions, so that the engine only calls back once per “block of cells” that contains a live cell.</p>
<hr>
<p data-adtags-visited="true"><strong>Next time on FAIC:</strong> We’ll look at the naive implementation of the engine and discuss its time and memory performance.</p>

			
			
						</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>