<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Supersingular Isogeny Key Exchange for Not-Quite Beginners - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Supersingular Isogeny Key Exchange for Not-Quite Beginners - linksfor.dev(s)"/>
    <meta property="og:description" content="I recently read a great introductory paper on Supersingular Isogeny Diffie-Hellman (SIDH) by Craig Costello and wanted to summarize just the math of it (with some simplifications) for myself. Hopefully this summary is clear enough to also be useful to people who aren&#x2019;t myself."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://mrosenberg.pub/cryptography/2020/01/08/sidh.html"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Supersingular Isogeny Key Exchange for Not-Quite Beginners</title>
<div class="readable">
        <h1>Supersingular Isogeny Key Exchange for Not-Quite Beginners</h1>
            <div>Reading time: 7-8 minutes</div>
        <div>Posted here: 09 Jan 2020</div>
        <p><a href="https://mrosenberg.pub/cryptography/2020/01/08/sidh.html">https://mrosenberg.pub/cryptography/2020/01/08/sidh.html</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>I recently read a <a href="https://eprint.iacr.org/2019/1321">great introductory paper</a> on Supersingular Isogeny Diffie-Hellman (SIDH) by Craig Costello and wanted to summarize just the math of it (with some simplifications) for myself. Hopefully this summary is clear enough to also be useful to people who aren’t myself.</p>
      

<p>We deal with supersingular (we won’t define this word) elliptic curves defined over finite fields of the form <span><span id="MJXp-Span-1"><span id="MJXp-Span-2"><span id="MJXp-Span-3"><span id="MJXp-Span-4">F</span></span><span id="MJXp-Span-5"><span id="MJXp-Span-6"><span id="MJXp-Span-7">p</span><span id="MJXp-Span-8">2</span></span></span></span></span></span>.</p>

<p>For SIDH, we deal only with curves such that <span><span id="MJXp-Span-9"><span id="MJXp-Span-10">E</span><span id="MJXp-Span-11">(</span><span id="MJXp-Span-12"><span id="MJXp-Span-13"><span id="MJXp-Span-14">F</span></span><span id="MJXp-Span-15"><span id="MJXp-Span-16"><span id="MJXp-Span-17">p</span><span id="MJXp-Span-18">2</span></span></span></span><span id="MJXp-Span-19">)</span><span id="MJXp-Span-20">≅</span><span id="MJXp-Span-21"><span id="MJXp-Span-22"><span id="MJXp-Span-23">Z</span></span><span id="MJXp-Span-24"><span id="MJXp-Span-25">p</span><span id="MJXp-Span-26">+</span><span id="MJXp-Span-27">1</span></span></span><span id="MJXp-Span-28">×</span><span id="MJXp-Span-29"><span id="MJXp-Span-30"><span id="MJXp-Span-31">Z</span></span><span id="MJXp-Span-32"><span id="MJXp-Span-33">p</span><span id="MJXp-Span-34">+</span><span id="MJXp-Span-35">1</span></span></span></span></span>. The kernel of the left multiplication map <span><span id="MJXp-Span-36"><span id="MJXp-Span-37">P</span><span id="MJXp-Span-38">→</span><span id="MJXp-Span-39">[</span><span id="MJXp-Span-40">a</span><span id="MJXp-Span-41">]</span><span id="MJXp-Span-42">P</span></span></span> is of the form <span><span id="MJXp-Span-43"><span id="MJXp-Span-44"><span id="MJXp-Span-45"><span id="MJXp-Span-46">Z</span></span><span id="MJXp-Span-47">a</span></span><span id="MJXp-Span-48">×</span><span id="MJXp-Span-49"><span id="MJXp-Span-50"><span id="MJXp-Span-51">Z</span></span><span id="MJXp-Span-52">a</span></span></span></span>. We say that a map <span><span id="MJXp-Span-53"><span id="MJXp-Span-54">ϕ</span><span id="MJXp-Span-55">:</span><span id="MJXp-Span-56">E</span><span id="MJXp-Span-57">→</span><span id="MJXp-Span-58"><span id="MJXp-Span-59">E</span><span id="MJXp-Span-60">′</span></span></span></span> is an <span><span id="MJXp-Span-61"><span id="MJXp-Span-62">ℓ</span></span></span>-isogeny iff <span><span id="MJXp-Span-63"><span id="MJXp-Span-64"><span id="MJXp-Span-65">|</span></span><span id="MJXp-Span-66">ker</span><span id="MJXp-Span-67"></span><span id="MJXp-Span-68">ϕ</span><span id="MJXp-Span-69"><span id="MJXp-Span-70">|</span></span><span id="MJXp-Span-71">=</span><span id="MJXp-Span-72">ℓ</span></span></span>. Notice that <span><span id="MJXp-Span-73"><span id="MJXp-Span-74">ℓ</span></span></span>-isogenies only exist for <span><span id="MJXp-Span-75"><span id="MJXp-Span-76">ℓ</span><span id="MJXp-Span-77">∣</span><span id="MJXp-Span-78">p</span><span id="MJXp-Span-79">+</span><span id="MJXp-Span-80">1</span></span></span>. Every <span><span id="MJXp-Span-81"><span id="MJXp-Span-82">ℓ</span></span></span>-isogeny <span><span id="MJXp-Span-83"><span id="MJXp-Span-84">ϕ</span><span id="MJXp-Span-85">:</span><span id="MJXp-Span-86">E</span><span id="MJXp-Span-87">→</span><span id="MJXp-Span-88"><span id="MJXp-Span-89">E</span><span id="MJXp-Span-90">′</span></span></span></span> also has an associated <span><span id="MJXp-Span-91"><span id="MJXp-Span-92">ℓ</span></span></span>-isogeny, called the dual isogeny <span><span id="MJXp-Span-93"><span id="MJXp-Span-94">ψ</span><span id="MJXp-Span-95">:</span><span id="MJXp-Span-96"><span id="MJXp-Span-97">E</span><span id="MJXp-Span-98">′</span></span><span id="MJXp-Span-99">→</span><span id="MJXp-Span-100">E</span></span></span>, such that <span><span id="MJXp-Span-101"><span id="MJXp-Span-102">ϕ</span><span id="MJXp-Span-103">∘</span><span id="MJXp-Span-104">ψ</span></span></span> is the left-multiplication map <span><span id="MJXp-Span-105"><span id="MJXp-Span-106">[</span><span id="MJXp-Span-107">ℓ</span><span id="MJXp-Span-108">]</span></span></span>. Vélu’s formulas tell us that every subgroup <span><span id="MJXp-Span-109"><span id="MJXp-Span-110">G</span><span id="MJXp-Span-111">≤</span><span id="MJXp-Span-112">E</span></span></span> corresponds to a unique isogeny out of <span><span id="MJXp-Span-113"><span id="MJXp-Span-114">E</span></span></span> (to some curve <span><span id="MJXp-Span-115"><span id="MJXp-Span-116"><span id="MJXp-Span-117">E</span><span id="MJXp-Span-118">′</span></span></span></span>) with kernel G. They also tell us how to construct an isogeny given its desired kernel.</p>

<div>
  <p><strong>Claim:</strong> On a supersingular curve <span><span id="MJXp-Span-119"><span id="MJXp-Span-120">E</span></span></span> of the form above, for any prime <span><span id="MJXp-Span-121"><span id="MJXp-Span-122">ℓ</span><span id="MJXp-Span-123">∣</span><span id="MJXp-Span-124">p</span><span id="MJXp-Span-125">+</span><span id="MJXp-Span-126">1</span></span></span>, there are exactly <span><span id="MJXp-Span-127"><span id="MJXp-Span-128">ℓ</span><span id="MJXp-Span-129">+</span><span id="MJXp-Span-130">1</span></span></span> nontrivial <span><span id="MJXp-Span-131"><span id="MJXp-Span-132">ℓ</span></span></span>-isogenies out of <span><span id="MJXp-Span-133"><span id="MJXp-Span-134">E</span></span></span>.</p>

  <p><strong>Proof:</strong> Using Vélu’s formulas, it suffices to show that E has exactly <span><span id="MJXp-Span-135"><span id="MJXp-Span-136">ℓ</span><span id="MJXp-Span-137">+</span><span id="MJXp-Span-138">1</span></span></span> many subgroups of prime order <span><span id="MJXp-Span-139"><span id="MJXp-Span-140">ℓ</span></span></span>. Firstly, since these are of order <span><span id="MJXp-Span-141"><span id="MJXp-Span-142">ℓ</span></span></span>, they all must be subgroups of <span><span id="MJXp-Span-143"><span id="MJXp-Span-144">E</span><span id="MJXp-Span-145">[</span><span id="MJXp-Span-146">ℓ</span><span id="MJXp-Span-147">]</span><span id="MJXp-Span-148">≅</span><span id="MJXp-Span-149"><span id="MJXp-Span-150"><span id="MJXp-Span-151">Z</span></span><span id="MJXp-Span-152">ℓ</span></span><span id="MJXp-Span-153">×</span><span id="MJXp-Span-154"><span id="MJXp-Span-155"><span id="MJXp-Span-156">Z</span></span><span id="MJXp-Span-157">ℓ</span></span></span></span>. Let <span><span id="MJXp-Span-158"><span id="MJXp-Span-159">P</span></span></span> and <span><span id="MJXp-Span-160"><span id="MJXp-Span-161">Q</span></span></span> denote the free generators of <span><span id="MJXp-Span-162"><span id="MJXp-Span-163">E</span><span id="MJXp-Span-164">[</span><span id="MJXp-Span-165">ℓ</span><span id="MJXp-Span-166">]</span></span></span>.
Consider the family of cyclic subgroups generated by <span><span id="MJXp-Span-167"><span id="MJXp-Span-168">P</span><span id="MJXp-Span-169">+</span><span id="MJXp-Span-170">[</span><span id="MJXp-Span-171">k</span><span id="MJXp-Span-172">]</span><span id="MJXp-Span-173">Q</span></span></span> for <span><span id="MJXp-Span-174"><span id="MJXp-Span-175">0</span><span id="MJXp-Span-176">≤</span><span id="MJXp-Span-177">k</span><span id="MJXp-Span-178">&lt;</span><span id="MJXp-Span-179">ℓ</span></span></span>. We claim that these are not only distinct, but disjoint. Suppose for distinct <span><span id="MJXp-Span-180"><span id="MJXp-Span-181">k</span></span></span>, <span><span id="MJXp-Span-182"><span id="MJXp-Span-183"><span id="MJXp-Span-184">k</span><span id="MJXp-Span-185">′</span></span></span></span> that</p>

  <p><span><span id="MJXp-Span-186"><span id="MJXp-Span-187">α</span><span id="MJXp-Span-188">(</span><span id="MJXp-Span-189">P</span><span id="MJXp-Span-190">+</span><span id="MJXp-Span-191">[</span><span id="MJXp-Span-192">k</span><span id="MJXp-Span-193">]</span><span id="MJXp-Span-194">Q</span><span id="MJXp-Span-195">)</span><span id="MJXp-Span-196">=</span><span id="MJXp-Span-197">β</span><span id="MJXp-Span-198">(</span><span id="MJXp-Span-199">P</span><span id="MJXp-Span-200">+</span><span id="MJXp-Span-201">[</span><span id="MJXp-Span-202"><span id="MJXp-Span-203">k</span><span id="MJXp-Span-204">′</span></span><span id="MJXp-Span-205">]</span><span id="MJXp-Span-206">Q</span><span id="MJXp-Span-207">)</span></span></span></p><p>for some integers <span><span id="MJXp-Span-208"><span id="MJXp-Span-209">α</span></span></span>, <span><span id="MJXp-Span-210"><span id="MJXp-Span-211">β</span></span></span>. Rearranging,</p>

  <p><span><span id="MJXp-Span-212"><span id="MJXp-Span-213">[</span><span id="MJXp-Span-214">α</span><span id="MJXp-Span-215">]</span><span id="MJXp-Span-216">P</span><span id="MJXp-Span-217">−</span><span id="MJXp-Span-218">[</span><span id="MJXp-Span-219">β</span><span id="MJXp-Span-220">]</span><span id="MJXp-Span-221">P</span><span id="MJXp-Span-222">=</span><span id="MJXp-Span-223">[</span><span id="MJXp-Span-224">β</span><span id="MJXp-Span-225">k</span><span id="MJXp-Span-226">]</span><span id="MJXp-Span-227">Q</span><span id="MJXp-Span-228">−</span><span id="MJXp-Span-229">[</span><span id="MJXp-Span-230">α</span><span id="MJXp-Span-231"><span id="MJXp-Span-232">k</span><span id="MJXp-Span-233">′</span></span><span id="MJXp-Span-234">]</span><span id="MJXp-Span-235">Q</span></span></span></p><p>Since <span><span id="MJXp-Span-236"><span id="MJXp-Span-237">P</span></span></span> and <span><span id="MJXp-Span-238"><span id="MJXp-Span-239">Q</span></span></span> are linearly independent, both sides of this equation must be the identity. Therefore,</p>

  <p><span><span id="MJXp-Span-240"><span id="MJXp-Span-241">α</span><span id="MJXp-Span-242">≡</span><span id="MJXp-Span-243">β</span><span id="MJXp-Span-244">&nbsp;</span><span id="MJXp-Span-245">(</span><span id="MJXp-Span-246"><span id="MJXp-Span-247">mod&nbsp;</span></span><span id="MJXp-Span-248">ℓ</span><span id="MJXp-Span-249">)</span></span></span></p><p>Putting this together with the fact that the RHS is the identity,</p>

  <p><span><span id="MJXp-Span-250"><span id="MJXp-Span-251">β</span><span id="MJXp-Span-252">k</span><span id="MJXp-Span-253">≡</span><span id="MJXp-Span-254">α</span><span id="MJXp-Span-255"><span id="MJXp-Span-256">k</span><span id="MJXp-Span-257">′</span></span><span id="MJXp-Span-258">≡</span><span id="MJXp-Span-259">β</span><span id="MJXp-Span-260"><span id="MJXp-Span-261">k</span><span id="MJXp-Span-262">′</span></span><span id="MJXp-Span-263">&nbsp;</span><span id="MJXp-Span-264">(</span><span id="MJXp-Span-265"><span id="MJXp-Span-266">mod&nbsp;</span></span><span id="MJXp-Span-267">ℓ</span><span id="MJXp-Span-268">)</span><span id="MJXp-Span-269">,</span></span></span></p><p>we conclude <span><span id="MJXp-Span-270"><span id="MJXp-Span-271">k</span><span id="MJXp-Span-272">≡</span><span id="MJXp-Span-273"><span id="MJXp-Span-274">k</span><span id="MJXp-Span-275">′</span></span><span id="MJXp-Span-276">&nbsp;</span><span id="MJXp-Span-277">(</span><span id="MJXp-Span-278"><span id="MJXp-Span-279">mod&nbsp;</span></span><span id="MJXp-Span-280">ℓ</span><span id="MJXp-Span-281">)</span></span></span>. This gives us a family of <span><span id="MJXp-Span-282"><span id="MJXp-Span-283">ℓ</span></span></span> many disjoint subgroups. The final subgroup to include is the one generated by <span><span id="MJXp-Span-284"><span id="MJXp-Span-285">Q</span></span></span>. It is clear that this is also disjoint from the previously mentioned subgroups. Finally, there cannot be any more order <span><span id="MJXp-Span-286"><span id="MJXp-Span-287">ℓ</span></span></span> subgroups, since we have listed all the possible cyclic subgroups of <span><span id="MJXp-Span-288"><span id="MJXp-Span-289"><span id="MJXp-Span-290"><span id="MJXp-Span-291">Z</span></span><span id="MJXp-Span-292">ℓ</span></span><span id="MJXp-Span-293">×</span><span id="MJXp-Span-294"><span id="MJXp-Span-295"><span id="MJXp-Span-296">Z</span></span><span id="MJXp-Span-297">ℓ</span></span></span></span>, and all groups of prime order are cyclic.</p>

</div>

<p>A <strong>supersingular <span><span id="MJXp-Span-298"><span id="MJXp-Span-299">ℓ</span></span></span>-isogeny graph</strong> is a graph whose nodes are <span><span id="MJXp-Span-300"><span id="MJXp-Span-301">j</span></span></span>-invariants (i.e., elements of <span><span id="MJXp-Span-302"><span id="MJXp-Span-303"><span id="MJXp-Span-304"><span id="MJXp-Span-305">F</span></span><span id="MJXp-Span-306"><span id="MJXp-Span-307"><span id="MJXp-Span-308">p</span><span id="MJXp-Span-309">2</span></span></span></span></span></span> which are in bijective correspondence with isomorphism classes of elliptic curves) and whose edges represent <span><span id="MJXp-Span-310"><span id="MJXp-Span-311">ℓ</span></span></span>-isogenies between them. Note this is an undirected graph because every <span><span id="MJXp-Span-312"><span id="MJXp-Span-313">ℓ</span></span></span>-isogeny has a dual <span><span id="MJXp-Span-314"><span id="MJXp-Span-315">ℓ</span></span></span>-isogeny going in the other direction. Also, by the above claim, every node has degree <span><span id="MJXp-Span-316"><span id="MJXp-Span-317">ℓ</span><span id="MJXp-Span-318">+</span><span id="MJXp-Span-319">1</span></span></span>. It turns out that this is an expander graph, which means random walks on it mix quickly. In other words, the diameter of an expander graph on <span><span id="MJXp-Span-320"><span id="MJXp-Span-321">N</span></span></span> elements is roughly <span><span id="MJXp-Span-322"><span id="MJXp-Span-323">log</span><span id="MJXp-Span-324"></span><span id="MJXp-Span-325">(</span><span id="MJXp-Span-326">N</span><span id="MJXp-Span-327">)</span></span></span>. SIDH exploits this property to make its security claims.</p>
    
      

<p>The purpose of SIDH is to compute a shared secret by exchanging public shares. Same idea as Diffie Hellman.</p>
    
      <h3 id="public-parameters">
        
        
          <a href="#public-parameters">¶</a> Public Parameters
        
        
      </h3>

<ul>
  <li>A prime <span><span id="MJXp-Span-328"><span id="MJXp-Span-329">p</span><span id="MJXp-Span-330">=</span><span id="MJXp-Span-331"><span id="MJXp-Span-332">2</span><span id="MJXp-Span-333"><span id="MJXp-Span-334"><span id="MJXp-Span-335">e</span><span id="MJXp-Span-336">A</span></span></span></span><span id="MJXp-Span-337"><span id="MJXp-Span-338">3</span><span id="MJXp-Span-339"><span id="MJXp-Span-340"><span id="MJXp-Span-341">e</span><span id="MJXp-Span-342">B</span></span></span></span><span id="MJXp-Span-343">−</span><span id="MJXp-Span-344">1</span></span></span>. This way, <span><span id="MJXp-Span-345"><span id="MJXp-Span-346">p</span><span id="MJXp-Span-347">+</span><span id="MJXp-Span-348">1</span></span></span> is divisible by powers of 2 and 3. <span><span id="MJXp-Span-349"><span id="MJXp-Span-350"><span id="MJXp-Span-351">e</span><span id="MJXp-Span-352">A</span></span></span></span> and <span><span id="MJXp-Span-353"><span id="MJXp-Span-354"><span id="MJXp-Span-355">e</span><span id="MJXp-Span-356">B</span></span></span></span> are chosen so that <span><span id="MJXp-Span-357"><span id="MJXp-Span-358"><span id="MJXp-Span-359">2</span><span id="MJXp-Span-360"><span id="MJXp-Span-361"><span id="MJXp-Span-362">e</span><span id="MJXp-Span-363">A</span></span></span></span><span id="MJXp-Span-364">≈</span><span id="MJXp-Span-365"><span id="MJXp-Span-366">3</span><span id="MJXp-Span-367"><span id="MJXp-Span-368"><span id="MJXp-Span-369">e</span><span id="MJXp-Span-370">B</span></span></span></span></span></span>.</li>
  <li>A starting curve <span><span id="MJXp-Span-371"><span id="MJXp-Span-372">E</span></span></span> defined over <span><span id="MJXp-Span-373"><span id="MJXp-Span-374"><span id="MJXp-Span-375"><span id="MJXp-Span-376">F</span></span><span id="MJXp-Span-377"><span id="MJXp-Span-378"><span id="MJXp-Span-379">p</span><span id="MJXp-Span-380">2</span></span></span></span></span></span></li>
  <li>Two points <span><span id="MJXp-Span-381"><span id="MJXp-Span-382"><span id="MJXp-Span-383">P</span><span id="MJXp-Span-384">A</span></span><span id="MJXp-Span-385">,</span><span id="MJXp-Span-386"><span id="MJXp-Span-387">Q</span><span id="MJXp-Span-388">A</span></span><span id="MJXp-Span-389">∈</span><span id="MJXp-Span-390">E</span></span></span> such that <span><span id="MJXp-Span-391"><span id="MJXp-Span-392">⟨</span><span id="MJXp-Span-393"><span id="MJXp-Span-394">P</span><span id="MJXp-Span-395">A</span></span><span id="MJXp-Span-396">,</span><span id="MJXp-Span-397"><span id="MJXp-Span-398">Q</span><span id="MJXp-Span-399">A</span></span><span id="MJXp-Span-400">⟩</span><span id="MJXp-Span-401">≅</span><span id="MJXp-Span-402"><span id="MJXp-Span-403"><span id="MJXp-Span-404">Z</span></span><span id="MJXp-Span-405"><span id="MJXp-Span-406"><span id="MJXp-Span-407">2</span><span id="MJXp-Span-408"><span id="MJXp-Span-409"><span id="MJXp-Span-410">e</span><span id="MJXp-Span-411">A</span></span></span></span></span></span><span id="MJXp-Span-412">×</span><span id="MJXp-Span-413"><span id="MJXp-Span-414"><span id="MJXp-Span-415">Z</span></span><span id="MJXp-Span-416"><span id="MJXp-Span-417"><span id="MJXp-Span-418">2</span><span id="MJXp-Span-419"><span id="MJXp-Span-420"><span id="MJXp-Span-421">e</span><span id="MJXp-Span-422">A</span></span></span></span></span></span></span></span>.</li>
  <li>Two points <span><span id="MJXp-Span-423"><span id="MJXp-Span-424"><span id="MJXp-Span-425">P</span><span id="MJXp-Span-426">B</span></span><span id="MJXp-Span-427">,</span><span id="MJXp-Span-428"><span id="MJXp-Span-429">Q</span><span id="MJXp-Span-430">B</span></span><span id="MJXp-Span-431">∈</span><span id="MJXp-Span-432">E</span></span></span> such that <span><span id="MJXp-Span-433"><span id="MJXp-Span-434">⟨</span><span id="MJXp-Span-435"><span id="MJXp-Span-436">P</span><span id="MJXp-Span-437">B</span></span><span id="MJXp-Span-438">,</span><span id="MJXp-Span-439"><span id="MJXp-Span-440">Q</span><span id="MJXp-Span-441">B</span></span><span id="MJXp-Span-442">⟩</span><span id="MJXp-Span-443">≅</span><span id="MJXp-Span-444"><span id="MJXp-Span-445"><span id="MJXp-Span-446">Z</span></span><span id="MJXp-Span-447"><span id="MJXp-Span-448"><span id="MJXp-Span-449">3</span><span id="MJXp-Span-450"><span id="MJXp-Span-451"><span id="MJXp-Span-452">e</span><span id="MJXp-Span-453">B</span></span></span></span></span></span><span id="MJXp-Span-454">×</span><span id="MJXp-Span-455"><span id="MJXp-Span-456"><span id="MJXp-Span-457">Z</span></span><span id="MJXp-Span-458"><span id="MJXp-Span-459"><span id="MJXp-Span-460">3</span><span id="MJXp-Span-461"><span id="MJXp-Span-462"><span id="MJXp-Span-463">e</span><span id="MJXp-Span-464">B</span></span></span></span></span></span></span></span>.</li>
</ul>
    
      <h3 id="protocol">
        
        
          <a href="#protocol">¶</a> Protocol
        
        
      </h3>

<p>Here’s the gist of the protocol: Alice takes a walk on a 2-isogeny graph and marks her stopping point. Bob takes a walk on a 3-isogeny graph and marks his stopping point. The constraint that <span><span id="MJXp-Span-465"><span id="MJXp-Span-466"><span id="MJXp-Span-467">2</span><span id="MJXp-Span-468"><span id="MJXp-Span-469"><span id="MJXp-Span-470">e</span><span id="MJXp-Span-471">A</span></span></span></span><span id="MJXp-Span-472">≈</span><span id="MJXp-Span-473"><span id="MJXp-Span-474">3</span><span id="MJXp-Span-475"><span id="MJXp-Span-476"><span id="MJXp-Span-477">e</span><span id="MJXp-Span-478">B</span></span></span></span></span></span> means that the number of possible stopping points that Alice can get to is roughly equal to the number of possible stopping points Bob can get to. They then share their stopping points with each other. Then both of them do the same walks as before, but starting at each other’s stopping point. The final endpoints of Alice’s and Bob’s walks are isomorphic (as elliptic curves, since points on the isogeny graph are curves), which means they have the same <span><span id="MJXp-Span-479"><span id="MJXp-Span-480">j</span></span></span>-invariant.</p>

<p>Concretely, here’s the protocol sequence. Alice initiates:</p>

<p><strong>Alice:</strong></p>

<ol>
  <li>Picks a random secret scalar <span><span id="MJXp-Span-481"><span id="MJXp-Span-482">0</span><span id="MJXp-Span-483">≤</span><span id="MJXp-Span-484"><span id="MJXp-Span-485">k</span><span id="MJXp-Span-486">A</span></span><span id="MJXp-Span-487">&lt;</span><span id="MJXp-Span-488"><span id="MJXp-Span-489">2</span><span id="MJXp-Span-490"><span id="MJXp-Span-491"><span id="MJXp-Span-492">e</span><span id="MJXp-Span-493">A</span></span></span></span></span></span> and defines a secret generator <span><span id="MJXp-Span-494"><span id="MJXp-Span-495"><span id="MJXp-Span-496">S</span><span id="MJXp-Span-497">A</span></span><span id="MJXp-Span-498">=</span><span id="MJXp-Span-499"><span id="MJXp-Span-500">P</span><span id="MJXp-Span-501">A</span></span><span id="MJXp-Span-502">+</span><span id="MJXp-Span-503">[</span><span id="MJXp-Span-504"><span id="MJXp-Span-505">k</span><span id="MJXp-Span-506">A</span></span><span id="MJXp-Span-507">]</span><span id="MJXp-Span-508"><span id="MJXp-Span-509">Q</span><span id="MJXp-Span-510">A</span></span></span></span>. Note that <span><span id="MJXp-Span-511"><span id="MJXp-Span-512"><span id="MJXp-Span-513">S</span><span id="MJXp-Span-514">A</span></span></span></span> has order <span><span id="MJXp-Span-515"><span id="MJXp-Span-516"><span id="MJXp-Span-517">2</span><span id="MJXp-Span-518"><span id="MJXp-Span-519"><span id="MJXp-Span-520">e</span><span id="MJXp-Span-521">A</span></span></span></span></span></span> because <span><span id="MJXp-Span-522"><span id="MJXp-Span-523"><span id="MJXp-Span-524">P</span><span id="MJXp-Span-525">A</span></span></span></span> and <span><span id="MJXp-Span-526"><span id="MJXp-Span-527"><span id="MJXp-Span-528">Q</span><span id="MJXp-Span-529">A</span></span></span></span> are linearly independent. By the proof above, all the possible subgroups <span><span id="MJXp-Span-530"><span id="MJXp-Span-531">⟨</span><span id="MJXp-Span-532"><span id="MJXp-Span-533">S</span><span id="MJXp-Span-534">A</span></span><span id="MJXp-Span-535">⟩</span></span></span> are disjoint.</li>
  <li>Constructs a <span><span id="MJXp-Span-536"><span id="MJXp-Span-537"><span id="MJXp-Span-538">2</span><span id="MJXp-Span-539"><span id="MJXp-Span-540"><span id="MJXp-Span-541">e</span><span id="MJXp-Span-542">A</span></span></span></span></span></span>-isogeny <span><span id="MJXp-Span-543"><span id="MJXp-Span-544"><span id="MJXp-Span-545">ϕ</span><span id="MJXp-Span-546">A</span></span><span id="MJXp-Span-547">:</span><span id="MJXp-Span-548">E</span><span id="MJXp-Span-549">→</span><span id="MJXp-Span-550">E</span><span id="MJXp-Span-551"><span id="MJXp-Span-552">/</span></span><span id="MJXp-Span-553">⟨</span><span id="MJXp-Span-554"><span id="MJXp-Span-555">S</span><span id="MJXp-Span-556">A</span></span><span id="MJXp-Span-557">⟩</span></span></span>. This is done iteratively by repeatedly constructing 2-isogenies with elements of <span><span id="MJXp-Span-558"><span id="MJXp-Span-559">⟨</span><span id="MJXp-Span-560"><span id="MJXp-Span-561">S</span><span id="MJXp-Span-562">A</span></span><span id="MJXp-Span-563">⟩</span></span></span> in the kernel. The way you do this is by getting a point <span><span id="MJXp-Span-564"><span id="MJXp-Span-565"><span id="MJXp-Span-566">R</span><span id="MJXp-Span-567">A</span></span><span id="MJXp-Span-568">=</span><span id="MJXp-Span-569">[</span><span id="MJXp-Span-570"><span id="MJXp-Span-571">2</span><span id="MJXp-Span-572"><span id="MJXp-Span-573"><span id="MJXp-Span-574">e</span><span id="MJXp-Span-575">A</span></span><span id="MJXp-Span-576">−</span><span id="MJXp-Span-577">1</span></span></span><span id="MJXp-Span-578">]</span><span id="MJXp-Span-579"><span id="MJXp-Span-580">S</span><span id="MJXp-Span-581">A</span></span></span></span> of order 2. Using Vélu’s formulas, you can construct a <span><span id="MJXp-Span-582"><span id="MJXp-Span-583"><span id="MJXp-Span-584">ϕ</span><span id="MJXp-Span-585">0</span></span><span id="MJXp-Span-586">:</span><span id="MJXp-Span-587">E</span><span id="MJXp-Span-588">→</span><span id="MJXp-Span-589">E</span><span id="MJXp-Span-590"><span id="MJXp-Span-591">/</span></span><span id="MJXp-Span-592">⟨</span><span id="MJXp-Span-593"><span id="MJXp-Span-594">R</span><span id="MJXp-Span-595">A</span></span><span id="MJXp-Span-596">⟩</span></span></span>. Now let <span><span id="MJXp-Span-597"><span id="MJXp-Span-598"><span id="MJXp-Span-599">S</span><span><span><span><span><span id="MJXp-Span-601">′</span></span></span></span><span><span><span><span id="MJXp-Span-600">A</span></span></span></span></span></span><span id="MJXp-Span-602">=</span><span id="MJXp-Span-603"><span id="MJXp-Span-604">ϕ</span><span id="MJXp-Span-605">0</span></span><span id="MJXp-Span-606">(</span><span id="MJXp-Span-607"><span id="MJXp-Span-608">S</span><span id="MJXp-Span-609">A</span></span><span id="MJXp-Span-610">)</span></span></span>. Then <span><span id="MJXp-Span-611"><span id="MJXp-Span-612"><span id="MJXp-Span-613">S</span><span><span><span><span><span id="MJXp-Span-615">′</span></span></span></span><span><span><span><span id="MJXp-Span-614">A</span></span></span></span></span></span></span></span> has order <span><span id="MJXp-Span-616"><span id="MJXp-Span-617"><span id="MJXp-Span-618">2</span><span id="MJXp-Span-619"><span id="MJXp-Span-620"><span id="MJXp-Span-621">e</span><span id="MJXp-Span-622">A</span></span><span id="MJXp-Span-623">−</span><span id="MJXp-Span-624">1</span></span></span></span></span>. Let <span><span id="MJXp-Span-625"><span id="MJXp-Span-626"><span id="MJXp-Span-627">R</span><span><span><span><span><span id="MJXp-Span-629">′</span></span></span></span><span><span><span><span id="MJXp-Span-628">A</span></span></span></span></span></span><span id="MJXp-Span-630">=</span><span id="MJXp-Span-631">[</span><span id="MJXp-Span-632"><span id="MJXp-Span-633">2</span><span id="MJXp-Span-634"><span id="MJXp-Span-635"><span id="MJXp-Span-636">e</span><span id="MJXp-Span-637">A</span></span><span id="MJXp-Span-638">−</span><span id="MJXp-Span-639">2</span></span></span><span id="MJXp-Span-640">]</span><span id="MJXp-Span-641"><span id="MJXp-Span-642">S</span><span><span><span><span><span id="MJXp-Span-644">′</span></span></span></span><span><span><span><span id="MJXp-Span-643">A</span></span></span></span></span></span></span></span>, … Once you’ve constructed <span><span id="MJXp-Span-645"><span id="MJXp-Span-646"><span id="MJXp-Span-647">ϕ</span><span id="MJXp-Span-648">0</span></span></span></span>, …, <span><span id="MJXp-Span-649"><span id="MJXp-Span-650"><span id="MJXp-Span-651">ϕ</span><span id="MJXp-Span-652"><span id="MJXp-Span-653"><span id="MJXp-Span-654">e</span><span id="MJXp-Span-655">A</span></span></span></span></span></span>, let <span><span id="MJXp-Span-656"><span id="MJXp-Span-657"><span id="MJXp-Span-658">ϕ</span><span id="MJXp-Span-659">A</span></span></span></span> be the composition of all of these.</li>
  <li>Sends Bob <span><span id="MJXp-Span-660"><span id="MJXp-Span-661">(</span><span id="MJXp-Span-662"><span id="MJXp-Span-663">ϕ</span><span id="MJXp-Span-664">A</span></span><span id="MJXp-Span-665">(</span><span id="MJXp-Span-666">E</span><span id="MJXp-Span-667">)</span><span id="MJXp-Span-668">,</span><span id="MJXp-Span-669"><span id="MJXp-Span-670">ϕ</span><span id="MJXp-Span-671">A</span></span><span id="MJXp-Span-672">(</span><span id="MJXp-Span-673"><span id="MJXp-Span-674">P</span><span id="MJXp-Span-675">B</span></span><span id="MJXp-Span-676">)</span><span id="MJXp-Span-677">,</span><span id="MJXp-Span-678"><span id="MJXp-Span-679">ϕ</span><span id="MJXp-Span-680">A</span></span><span id="MJXp-Span-681">(</span><span id="MJXp-Span-682"><span id="MJXp-Span-683">Q</span><span id="MJXp-Span-684">B</span></span><span id="MJXp-Span-685">)</span><span id="MJXp-Span-686">)</span></span></span>, where <span><span id="MJXp-Span-687"><span id="MJXp-Span-688"><span id="MJXp-Span-689">ϕ</span><span id="MJXp-Span-690">A</span></span><span id="MJXp-Span-691">(</span><span id="MJXp-Span-692">E</span><span id="MJXp-Span-693">)</span></span></span> is the description of the output curve.</li>
</ol>

<p><strong>Bob:</strong></p>

<ol>
  <li>Picks a secret <span><span id="MJXp-Span-694"><span id="MJXp-Span-695">0</span><span id="MJXp-Span-696">&lt;</span><span id="MJXp-Span-697"><span id="MJXp-Span-698">k</span><span id="MJXp-Span-699">B</span></span><span id="MJXp-Span-700">≤</span><span id="MJXp-Span-701"><span id="MJXp-Span-702">3</span><span id="MJXp-Span-703"><span id="MJXp-Span-704"><span id="MJXp-Span-705">e</span><span id="MJXp-Span-706">B</span></span></span></span></span></span>, lets <span><span id="MJXp-Span-707"><span id="MJXp-Span-708"><span id="MJXp-Span-709">S</span><span id="MJXp-Span-710">B</span></span><span id="MJXp-Span-711">=</span><span id="MJXp-Span-712"><span id="MJXp-Span-713">P</span><span id="MJXp-Span-714">B</span></span><span id="MJXp-Span-715">+</span><span id="MJXp-Span-716">[</span><span id="MJXp-Span-717"><span id="MJXp-Span-718">k</span><span id="MJXp-Span-719">B</span></span><span id="MJXp-Span-720">]</span><span id="MJXp-Span-721"><span id="MJXp-Span-722">Q</span><span id="MJXp-Span-723">B</span></span></span></span>, and constructs a <span><span id="MJXp-Span-724"><span id="MJXp-Span-725"><span id="MJXp-Span-726">3</span><span id="MJXp-Span-727"><span id="MJXp-Span-728"><span id="MJXp-Span-729">e</span><span id="MJXp-Span-730">B</span></span></span></span></span></span>-isogeny <span><span id="MJXp-Span-731"><span id="MJXp-Span-732"><span id="MJXp-Span-733">ϕ</span><span id="MJXp-Span-734">B</span></span><span id="MJXp-Span-735">:</span><span id="MJXp-Span-736">E</span><span id="MJXp-Span-737">→</span><span id="MJXp-Span-738">E</span><span id="MJXp-Span-739"><span id="MJXp-Span-740">/</span></span><span id="MJXp-Span-741">⟨</span><span id="MJXp-Span-742"><span id="MJXp-Span-743">S</span><span id="MJXp-Span-744">B</span></span><span id="MJXp-Span-745">⟩</span></span></span> in the same way as above.</li>
  <li>Sends Alice <span><span id="MJXp-Span-746"><span id="MJXp-Span-747">(</span><span id="MJXp-Span-748"><span id="MJXp-Span-749">ϕ</span><span id="MJXp-Span-750">B</span></span><span id="MJXp-Span-751">(</span><span id="MJXp-Span-752">E</span><span id="MJXp-Span-753">)</span><span id="MJXp-Span-754">,</span><span id="MJXp-Span-755"><span id="MJXp-Span-756">ϕ</span><span id="MJXp-Span-757">B</span></span><span id="MJXp-Span-758">(</span><span id="MJXp-Span-759"><span id="MJXp-Span-760">P</span><span id="MJXp-Span-761">A</span></span><span id="MJXp-Span-762">)</span><span id="MJXp-Span-763">,</span><span id="MJXp-Span-764"><span id="MJXp-Span-765">ϕ</span><span id="MJXp-Span-766">B</span></span><span id="MJXp-Span-767">(</span><span id="MJXp-Span-768"><span id="MJXp-Span-769">Q</span><span id="MJXp-Span-770">A</span></span><span id="MJXp-Span-771">)</span><span id="MJXp-Span-772">)</span></span></span></li>
</ol>

<p><strong>Alice:</strong></p>

<ol>
  <li>Uses the same method to construct <span><span id="MJXp-Span-773"><span id="MJXp-Span-774"><span id="MJXp-Span-775">ψ</span><span id="MJXp-Span-776">A</span></span><span id="MJXp-Span-777">:</span><span id="MJXp-Span-778"><span id="MJXp-Span-779">ϕ</span><span id="MJXp-Span-780">B</span></span><span id="MJXp-Span-781">(</span><span id="MJXp-Span-782">E</span><span id="MJXp-Span-783">)</span><span id="MJXp-Span-784">→</span><span id="MJXp-Span-785"><span id="MJXp-Span-786">ϕ</span><span id="MJXp-Span-787">B</span></span><span id="MJXp-Span-788">(</span><span id="MJXp-Span-789">E</span><span id="MJXp-Span-790">)</span><span id="MJXp-Span-791"><span id="MJXp-Span-792">/</span></span><span id="MJXp-Span-793">⟨</span><span id="MJXp-Span-794"><span id="MJXp-Span-795">T</span><span id="MJXp-Span-796">A</span></span><span id="MJXp-Span-797">⟩</span></span></span> where
    <span><span id="MJXp-Span-798"><span id="MJXp-Span-799"><span id="MJXp-Span-800">T</span><span id="MJXp-Span-801">A</span></span><span id="MJXp-Span-802">=</span><span id="MJXp-Span-803"><span id="MJXp-Span-804">ϕ</span><span id="MJXp-Span-805">B</span></span><span id="MJXp-Span-806">(</span><span id="MJXp-Span-807"><span id="MJXp-Span-808">S</span><span id="MJXp-Span-809">A</span></span><span id="MJXp-Span-810">)</span><span id="MJXp-Span-811">=</span><span id="MJXp-Span-812"><span id="MJXp-Span-813">ϕ</span><span id="MJXp-Span-814">B</span></span><span id="MJXp-Span-815">(</span><span id="MJXp-Span-816"><span id="MJXp-Span-817">P</span><span id="MJXp-Span-818">A</span></span><span id="MJXp-Span-819">)</span><span id="MJXp-Span-820">+</span><span id="MJXp-Span-821">[</span><span id="MJXp-Span-822"><span id="MJXp-Span-823">k</span><span id="MJXp-Span-824">A</span></span><span id="MJXp-Span-825">]</span><span id="MJXp-Span-826"><span id="MJXp-Span-827">ϕ</span><span id="MJXp-Span-828">B</span></span><span id="MJXp-Span-829">(</span><span id="MJXp-Span-830"><span id="MJXp-Span-831">Q</span><span id="MJXp-Span-832">A</span></span><span id="MJXp-Span-833">)</span></span></span></li>
  <li>Computes the <span><span id="MJXp-Span-834"><span id="MJXp-Span-835">j</span></span></span>-invariant of <span><span id="MJXp-Span-836"><span id="MJXp-Span-837"><span id="MJXp-Span-838">ψ</span><span id="MJXp-Span-839">A</span></span><span id="MJXp-Span-840">(</span><span id="MJXp-Span-841"><span id="MJXp-Span-842">ϕ</span><span id="MJXp-Span-843">B</span></span><span id="MJXp-Span-844">(</span><span id="MJXp-Span-845">E</span><span id="MJXp-Span-846">)</span><span id="MJXp-Span-847">)</span></span></span></li>
</ol>

<p><strong>Bob:</strong></p>

<ol>
  <li>Same idea as above: Construct <span><span id="MJXp-Span-848"><span id="MJXp-Span-849"><span id="MJXp-Span-850">ψ</span><span id="MJXp-Span-851">B</span></span><span id="MJXp-Span-852">:</span><span id="MJXp-Span-853"><span id="MJXp-Span-854">ϕ</span><span id="MJXp-Span-855">A</span></span><span id="MJXp-Span-856">(</span><span id="MJXp-Span-857">E</span><span id="MJXp-Span-858">)</span><span id="MJXp-Span-859">→</span><span id="MJXp-Span-860"><span id="MJXp-Span-861">ϕ</span><span id="MJXp-Span-862">A</span></span><span id="MJXp-Span-863">(</span><span id="MJXp-Span-864">E</span><span id="MJXp-Span-865">)</span><span id="MJXp-Span-866"><span id="MJXp-Span-867">/</span></span><span id="MJXp-Span-868">⟨</span><span id="MJXp-Span-869"><span id="MJXp-Span-870">T</span><span id="MJXp-Span-871">B</span></span><span id="MJXp-Span-872">⟩</span></span></span> where
    <span><span id="MJXp-Span-873"><span id="MJXp-Span-874"><span id="MJXp-Span-875">T</span><span id="MJXp-Span-876">B</span></span><span id="MJXp-Span-877">=</span><span id="MJXp-Span-878"><span id="MJXp-Span-879">ϕ</span><span id="MJXp-Span-880">A</span></span><span id="MJXp-Span-881">(</span><span id="MJXp-Span-882"><span id="MJXp-Span-883">S</span><span id="MJXp-Span-884">B</span></span><span id="MJXp-Span-885">)</span><span id="MJXp-Span-886">=</span><span id="MJXp-Span-887"><span id="MJXp-Span-888">ϕ</span><span id="MJXp-Span-889">A</span></span><span id="MJXp-Span-890">(</span><span id="MJXp-Span-891"><span id="MJXp-Span-892">P</span><span id="MJXp-Span-893">B</span></span><span id="MJXp-Span-894">)</span><span id="MJXp-Span-895">+</span><span id="MJXp-Span-896">[</span><span id="MJXp-Span-897"><span id="MJXp-Span-898">k</span><span id="MJXp-Span-899">B</span></span><span id="MJXp-Span-900">]</span><span id="MJXp-Span-901"><span id="MJXp-Span-902">ϕ</span><span id="MJXp-Span-903">A</span></span><span id="MJXp-Span-904">(</span><span id="MJXp-Span-905"><span id="MJXp-Span-906">Q</span><span id="MJXp-Span-907">B</span></span><span id="MJXp-Span-908">)</span></span></span></li>
  <li>Computes the <span><span id="MJXp-Span-909"><span id="MJXp-Span-910">j</span></span></span>-invariant of <span><span id="MJXp-Span-911"><span id="MJXp-Span-912"><span id="MJXp-Span-913">ψ</span><span id="MJXp-Span-914">B</span></span><span id="MJXp-Span-915">(</span><span id="MJXp-Span-916"><span id="MJXp-Span-917">ϕ</span><span id="MJXp-Span-918">A</span></span><span id="MJXp-Span-919">(</span><span id="MJXp-Span-920">E</span><span id="MJXp-Span-921">)</span><span id="MJXp-Span-922">)</span></span></span></li>
</ol>

<p><strong>End of Protocol</strong></p>

<p>Note that, since <span><span id="MJXp-Span-923"><span id="MJXp-Span-924">j</span></span></span>-variants of isomorphic curves are equal, and</p>

<p><span><span id="MJXp-Span-925"><span id="MJXp-Span-926">(</span><span id="MJXp-Span-927">E</span><span id="MJXp-Span-928"><span id="MJXp-Span-929">/</span></span><span id="MJXp-Span-930">⟨</span><span id="MJXp-Span-931"><span id="MJXp-Span-932">S</span><span id="MJXp-Span-933">A</span></span><span id="MJXp-Span-934">⟩</span><span id="MJXp-Span-935">)</span><span id="MJXp-Span-936"><span id="MJXp-Span-937">/</span></span><span id="MJXp-Span-938">⟨</span><span id="MJXp-Span-939"><span id="MJXp-Span-940">T</span><span id="MJXp-Span-941">B</span></span><span id="MJXp-Span-942">⟩</span><span id="MJXp-Span-943">≅</span><span id="MJXp-Span-944">E</span><span id="MJXp-Span-945"><span id="MJXp-Span-946">/</span></span><span id="MJXp-Span-947">⟨</span><span id="MJXp-Span-948"><span id="MJXp-Span-949">S</span><span id="MJXp-Span-950">A</span></span><span id="MJXp-Span-951">,</span><span id="MJXp-Span-952"><span id="MJXp-Span-953">S</span><span id="MJXp-Span-954">B</span></span><span id="MJXp-Span-955">⟩</span><span id="MJXp-Span-956">≅</span><span id="MJXp-Span-957">(</span><span id="MJXp-Span-958">E</span><span id="MJXp-Span-959"><span id="MJXp-Span-960">/</span></span><span id="MJXp-Span-961">⟨</span><span id="MJXp-Span-962"><span id="MJXp-Span-963">S</span><span id="MJXp-Span-964">B</span></span><span id="MJXp-Span-965">⟩</span><span id="MJXp-Span-966">)</span><span id="MJXp-Span-967"><span id="MJXp-Span-968">/</span></span><span id="MJXp-Span-969">⟨</span><span id="MJXp-Span-970"><span id="MJXp-Span-971">T</span><span id="MJXp-Span-972">A</span></span><span id="MJXp-Span-973">⟩</span><span id="MJXp-Span-974">,</span></span></span></p><p>the computed <span><span id="MJXp-Span-975"><span id="MJXp-Span-976">j</span></span></span>-invariants are the same. Thus, it makes sense to have the <span><span id="MJXp-Span-977"><span id="MJXp-Span-978">j</span></span></span>-invariant be the shared secret.</p>
    
      

<p>This attack is due to <a href="https://eprint.iacr.org/2016/859">Galbraith, Petit, Shani, and Ti</a>. If Alice keeps reusing the same <span><span id="MJXp-Span-979"><span id="MJXp-Span-980"><span id="MJXp-Span-981">k</span><span id="MJXp-Span-982">A</span></span></span></span>, Bob can determine its value by by initiating <span><span id="MJXp-Span-983"><span id="MJXp-Span-984">⌈</span><span id="MJXp-Span-985"><span id="MJXp-Span-986">log</span><span id="MJXp-Span-987">2</span></span><span id="MJXp-Span-988"></span><span id="MJXp-Span-989">(</span><span id="MJXp-Span-990"><span id="MJXp-Span-991">k</span><span id="MJXp-Span-992">A</span></span><span id="MJXp-Span-993">)</span><span id="MJXp-Span-994">⌉</span></span></span> many SIDH exchanges. Here’s the exploit:</p>

<p>Bob can figure out the bottom bit of <span><span id="MJXp-Span-995"><span id="MJXp-Span-996"><span id="MJXp-Span-997">k</span><span id="MJXp-Span-998">A</span></span></span></span> by publishing <span><span id="MJXp-Span-999"><span id="MJXp-Span-1000"><span id="MJXp-Span-1001">ϕ</span><span id="MJXp-Span-1002">B</span></span><span id="MJXp-Span-1003">(</span><span id="MJXp-Span-1004"><span id="MJXp-Span-1005">Q</span><span id="MJXp-Span-1006">A</span></span><span id="MJXp-Span-1007">)</span><span id="MJXp-Span-1008">+</span><span id="MJXp-Span-1009"><span id="MJXp-Span-1010">L</span><span id="MJXp-Span-1011">2</span></span></span></span> instead of <span><span id="MJXp-Span-1012"><span id="MJXp-Span-1013"><span id="MJXp-Span-1014">ϕ</span><span id="MJXp-Span-1015">B</span></span><span id="MJXp-Span-1016">(</span><span id="MJXp-Span-1017"><span id="MJXp-Span-1018">Q</span><span id="MJXp-Span-1019">A</span></span><span id="MJXp-Span-1020">)</span></span></span>, where <span><span id="MJXp-Span-1021"><span id="MJXp-Span-1022"><span id="MJXp-Span-1023">L</span><span id="MJXp-Span-1024">2</span></span></span></span> is a point of order 2. If <span><span id="MJXp-Span-1025"><span id="MJXp-Span-1026"><span id="MJXp-Span-1027">k</span><span id="MJXp-Span-1028">A</span></span></span></span> is odd, i.e., if <span><span id="MJXp-Span-1029"><span id="MJXp-Span-1030"><span id="MJXp-Span-1031">L</span><span id="MJXp-Span-1032">2</span></span></span></span> is not killed by <span><span id="MJXp-Span-1033"><span id="MJXp-Span-1034"><span id="MJXp-Span-1035">k</span><span id="MJXp-Span-1036">A</span></span></span></span>, then the protocol does not produce agreement, because <span><span id="MJXp-Span-1037"><span id="MJXp-Span-1038"><span id="MJXp-Span-1039">T</span><span id="MJXp-Span-1040">A</span></span><span id="MJXp-Span-1041">+</span><span id="MJXp-Span-1042"><span id="MJXp-Span-1043">L</span><span id="MJXp-Span-1044">2</span></span></span></span> is not the image of <span><span id="MJXp-Span-1045"><span id="MJXp-Span-1046"><span id="MJXp-Span-1047">S</span><span id="MJXp-Span-1048">A</span></span></span></span> in Bob’s curve <span><span id="MJXp-Span-1049"><span id="MJXp-Span-1050"><span id="MJXp-Span-1051">ϕ</span><span id="MJXp-Span-1052">B</span></span><span id="MJXp-Span-1053">(</span><span id="MJXp-Span-1054">E</span><span id="MJXp-Span-1055">)</span></span></span>. If <span><span id="MJXp-Span-1056"><span id="MJXp-Span-1057"><span id="MJXp-Span-1058">k</span><span id="MJXp-Span-1059">A</span></span></span></span> is even, then <span><span id="MJXp-Span-1060"><span id="MJXp-Span-1061"><span id="MJXp-Span-1062">L</span><span id="MJXp-Span-1063">2</span></span></span></span> is killed by <span><span id="MJXp-Span-1064"><span id="MJXp-Span-1065"><span id="MJXp-Span-1066">k</span><span id="MJXp-Span-1067">A</span></span></span></span> and the protocol completes successfully. Thus, the bottom bit is leaked.</p>

<p>Say Bob finds it was even. Now Bob wants to know if <span><span id="MJXp-Span-1068"><span id="MJXp-Span-1069"><span id="MJXp-Span-1070">k</span><span id="MJXp-Span-1071">A</span></span><span id="MJXp-Span-1072">≡</span><span id="MJXp-Span-1073">0</span><span id="MJXp-Span-1074">&nbsp;</span><span id="MJXp-Span-1075">(</span><span id="MJXp-Span-1076"><span id="MJXp-Span-1077">mod&nbsp;</span></span><span id="MJXp-Span-1078">4</span><span id="MJXp-Span-1079">)</span></span></span> or <span><span id="MJXp-Span-1080"><span id="MJXp-Span-1081">2</span><span id="MJXp-Span-1082">&nbsp;</span><span id="MJXp-Span-1083">(</span><span id="MJXp-Span-1084"><span id="MJXp-Span-1085">mod&nbsp;</span></span><span id="MJXp-Span-1086">4</span><span id="MJXp-Span-1087">)</span></span></span>. Then he sends <span><span id="MJXp-Span-1088"><span id="MJXp-Span-1089"><span id="MJXp-Span-1090">ϕ</span><span id="MJXp-Span-1091">B</span></span><span id="MJXp-Span-1092">(</span><span id="MJXp-Span-1093"><span id="MJXp-Span-1094">Q</span><span id="MJXp-Span-1095">A</span></span><span id="MJXp-Span-1096">)</span><span id="MJXp-Span-1097">+</span><span id="MJXp-Span-1098"><span id="MJXp-Span-1099">L</span><span id="MJXp-Span-1100">4</span></span></span></span> where <span><span id="MJXp-Span-1101"><span id="MJXp-Span-1102"><span id="MJXp-Span-1103">L</span><span id="MJXp-Span-1104">4</span></span></span></span> is a point of order 4, and uses the same logic. If Bob had found <span><span id="MJXp-Span-1105"><span id="MJXp-Span-1106"><span id="MJXp-Span-1107">k</span><span id="MJXp-Span-1108">A</span></span></span></span> was odd, then he would send <span><span id="MJXp-Span-1109"><span id="MJXp-Span-1110"><span id="MJXp-Span-1111">ϕ</span><span id="MJXp-Span-1112">B</span></span><span id="MJXp-Span-1113">(</span><span id="MJXp-Span-1114"><span id="MJXp-Span-1115">P</span><span id="MJXp-Span-1116">A</span></span><span id="MJXp-Span-1117">)</span><span id="MJXp-Span-1118">−</span><span id="MJXp-Span-1119"><span id="MJXp-Span-1120">L</span><span id="MJXp-Span-1121">4</span></span></span></span> instead of <span><span id="MJXp-Span-1122"><span id="MJXp-Span-1123"><span id="MJXp-Span-1124">ϕ</span><span id="MJXp-Span-1125">B</span></span><span id="MJXp-Span-1126">(</span><span id="MJXp-Span-1127"><span id="MJXp-Span-1128">P</span><span id="MJXp-Span-1129">A</span></span><span id="MJXp-Span-1130">)</span></span></span>, and <span><span id="MJXp-Span-1131"><span id="MJXp-Span-1132"><span id="MJXp-Span-1133">ϕ</span><span id="MJXp-Span-1134">B</span></span><span id="MJXp-Span-1135">(</span><span id="MJXp-Span-1136"><span id="MJXp-Span-1137">Q</span><span id="MJXp-Span-1138">A</span></span><span id="MJXp-Span-1139">)</span><span id="MJXp-Span-1140">+</span><span id="MJXp-Span-1141"><span id="MJXp-Span-1142">L</span><span id="MJXp-Span-1143">4</span></span></span></span> instead of <span><span id="MJXp-Span-1144"><span id="MJXp-Span-1145"><span id="MJXp-Span-1146">ϕ</span><span id="MJXp-Span-1147">B</span></span><span id="MJXp-Span-1148">(</span><span id="MJXp-Span-1149"><span id="MJXp-Span-1150">Q</span><span id="MJXp-Span-1151">A</span></span><span id="MJXp-Span-1152">)</span></span></span>. So if <span><span id="MJXp-Span-1153"><span id="MJXp-Span-1154"><span id="MJXp-Span-1155">k</span><span id="MJXp-Span-1156">A</span></span></span></span> is <span><span id="MJXp-Span-1157"><span id="MJXp-Span-1158">1</span><span id="MJXp-Span-1159">&nbsp;</span><span id="MJXp-Span-1160">(</span><span id="MJXp-Span-1161"><span id="MJXp-Span-1162">mod&nbsp;</span></span><span id="MJXp-Span-1163">4</span><span id="MJXp-Span-1164">)</span></span></span>, then</p>

<p><span><span id="MJXp-Span-1165"><span id="MJXp-Span-1166"><span><span id="MJXp-Span-1167"><span id="MJXp-Span-1168"></span><span id="MJXp-Span-1169"><span id="MJXp-Span-1170"><span id="MJXp-Span-1171">ϕ</span><span id="MJXp-Span-1172">B</span></span><span id="MJXp-Span-1173">(</span><span id="MJXp-Span-1174"><span id="MJXp-Span-1175">P</span><span id="MJXp-Span-1176">A</span></span><span id="MJXp-Span-1177">)</span><span id="MJXp-Span-1178">−</span><span id="MJXp-Span-1179"><span id="MJXp-Span-1180">L</span><span id="MJXp-Span-1181">4</span></span><span id="MJXp-Span-1182">+</span><span id="MJXp-Span-1183"><span id="MJXp-Span-1184">k</span><span id="MJXp-Span-1185">A</span></span><span id="MJXp-Span-1186">(</span><span id="MJXp-Span-1187"><span id="MJXp-Span-1188">ϕ</span><span id="MJXp-Span-1189">B</span></span><span id="MJXp-Span-1190">(</span><span id="MJXp-Span-1191"><span id="MJXp-Span-1192">Q</span><span id="MJXp-Span-1193">A</span></span><span id="MJXp-Span-1194">)</span><span id="MJXp-Span-1195">+</span><span id="MJXp-Span-1196"><span id="MJXp-Span-1197">L</span><span id="MJXp-Span-1198">4</span></span><span id="MJXp-Span-1199">)</span></span></span><span id="MJXp-Span-1200"><span id="MJXp-Span-1201"></span><span id="MJXp-Span-1202"><span id="MJXp-Span-1203"></span><span id="MJXp-Span-1204">=</span><span id="MJXp-Span-1205"><span id="MJXp-Span-1206">ϕ</span><span id="MJXp-Span-1207">B</span></span><span id="MJXp-Span-1208">(</span><span id="MJXp-Span-1209"><span id="MJXp-Span-1210">P</span><span id="MJXp-Span-1211">A</span></span><span id="MJXp-Span-1212">)</span><span id="MJXp-Span-1213">−</span><span id="MJXp-Span-1214"><span id="MJXp-Span-1215">L</span><span id="MJXp-Span-1216">4</span></span><span id="MJXp-Span-1217">+</span><span id="MJXp-Span-1218">[</span><span id="MJXp-Span-1219"><span id="MJXp-Span-1220">k</span><span id="MJXp-Span-1221">A</span></span><span id="MJXp-Span-1222">]</span><span id="MJXp-Span-1223"><span id="MJXp-Span-1224">ϕ</span><span id="MJXp-Span-1225">B</span></span><span id="MJXp-Span-1226">(</span><span id="MJXp-Span-1227"><span id="MJXp-Span-1228">Q</span><span id="MJXp-Span-1229">A</span></span><span id="MJXp-Span-1230">)</span><span id="MJXp-Span-1231">+</span><span id="MJXp-Span-1232"><span id="MJXp-Span-1233">L</span><span id="MJXp-Span-1234">4</span></span></span></span><span id="MJXp-Span-1235"><span id="MJXp-Span-1236"></span><span id="MJXp-Span-1237"><span id="MJXp-Span-1238"></span><span id="MJXp-Span-1239">=</span><span id="MJXp-Span-1240"><span id="MJXp-Span-1241">ϕ</span><span id="MJXp-Span-1242">B</span></span><span id="MJXp-Span-1243">(</span><span id="MJXp-Span-1244"><span id="MJXp-Span-1245">P</span><span id="MJXp-Span-1246">A</span></span><span id="MJXp-Span-1247">)</span><span id="MJXp-Span-1248">+</span><span id="MJXp-Span-1249">[</span><span id="MJXp-Span-1250"><span id="MJXp-Span-1251">k</span><span id="MJXp-Span-1252">A</span></span><span id="MJXp-Span-1253">]</span><span id="MJXp-Span-1254"><span id="MJXp-Span-1255">ϕ</span><span id="MJXp-Span-1256">B</span></span><span id="MJXp-Span-1257">(</span><span id="MJXp-Span-1258"><span id="MJXp-Span-1259">Q</span><span id="MJXp-Span-1260">A</span></span><span id="MJXp-Span-1261">)</span></span></span></span></span></span></span></p><p>and the protocol succeeds. Otherwise,</p>

<p><span><span id="MJXp-Span-1262"><span id="MJXp-Span-1263"><span><span id="MJXp-Span-1264"><span id="MJXp-Span-1265"></span><span id="MJXp-Span-1266"><span id="MJXp-Span-1267"><span id="MJXp-Span-1268">ϕ</span><span id="MJXp-Span-1269">B</span></span><span id="MJXp-Span-1270">(</span><span id="MJXp-Span-1271"><span id="MJXp-Span-1272">P</span><span id="MJXp-Span-1273">A</span></span><span id="MJXp-Span-1274">)</span><span id="MJXp-Span-1275">−</span><span id="MJXp-Span-1276"><span id="MJXp-Span-1277">L</span><span id="MJXp-Span-1278">4</span></span><span id="MJXp-Span-1279">+</span><span id="MJXp-Span-1280"><span id="MJXp-Span-1281">k</span><span id="MJXp-Span-1282">A</span></span><span id="MJXp-Span-1283">(</span><span id="MJXp-Span-1284"><span id="MJXp-Span-1285">ϕ</span><span id="MJXp-Span-1286">B</span></span><span id="MJXp-Span-1287">(</span><span id="MJXp-Span-1288"><span id="MJXp-Span-1289">Q</span><span id="MJXp-Span-1290">A</span></span><span id="MJXp-Span-1291">)</span><span id="MJXp-Span-1292">+</span><span id="MJXp-Span-1293"><span id="MJXp-Span-1294">L</span><span id="MJXp-Span-1295">4</span></span><span id="MJXp-Span-1296">)</span></span></span><span id="MJXp-Span-1297"><span id="MJXp-Span-1298"></span><span id="MJXp-Span-1299"><span id="MJXp-Span-1300"></span><span id="MJXp-Span-1301">=</span><span id="MJXp-Span-1302"><span id="MJXp-Span-1303">ϕ</span><span id="MJXp-Span-1304">B</span></span><span id="MJXp-Span-1305">(</span><span id="MJXp-Span-1306"><span id="MJXp-Span-1307">P</span><span id="MJXp-Span-1308">A</span></span><span id="MJXp-Span-1309">)</span><span id="MJXp-Span-1310">−</span><span id="MJXp-Span-1311"><span id="MJXp-Span-1312">L</span><span id="MJXp-Span-1313">4</span></span><span id="MJXp-Span-1314">+</span><span id="MJXp-Span-1315">[</span><span id="MJXp-Span-1316"><span id="MJXp-Span-1317">k</span><span id="MJXp-Span-1318">A</span></span><span id="MJXp-Span-1319">]</span><span id="MJXp-Span-1320"><span id="MJXp-Span-1321">ϕ</span><span id="MJXp-Span-1322">B</span></span><span id="MJXp-Span-1323">(</span><span id="MJXp-Span-1324"><span id="MJXp-Span-1325">Q</span><span id="MJXp-Span-1326">A</span></span><span id="MJXp-Span-1327">)</span><span id="MJXp-Span-1328">+</span><span id="MJXp-Span-1329">[</span><span id="MJXp-Span-1330">3</span><span id="MJXp-Span-1331">]</span><span id="MJXp-Span-1332"><span id="MJXp-Span-1333">L</span><span id="MJXp-Span-1334">4</span></span></span></span><span id="MJXp-Span-1335"><span id="MJXp-Span-1336"></span><span id="MJXp-Span-1337"><span id="MJXp-Span-1338"></span><span id="MJXp-Span-1339">=</span><span id="MJXp-Span-1340"><span id="MJXp-Span-1341">ϕ</span><span id="MJXp-Span-1342">B</span></span><span id="MJXp-Span-1343">(</span><span id="MJXp-Span-1344"><span id="MJXp-Span-1345">P</span><span id="MJXp-Span-1346">A</span></span><span id="MJXp-Span-1347">)</span><span id="MJXp-Span-1348">+</span><span id="MJXp-Span-1349">[</span><span id="MJXp-Span-1350"><span id="MJXp-Span-1351">k</span><span id="MJXp-Span-1352">A</span></span><span id="MJXp-Span-1353">]</span><span id="MJXp-Span-1354"><span id="MJXp-Span-1355">ϕ</span><span id="MJXp-Span-1356">B</span></span><span id="MJXp-Span-1357">(</span><span id="MJXp-Span-1358"><span id="MJXp-Span-1359">Q</span><span id="MJXp-Span-1360">A</span></span><span id="MJXp-Span-1361">)</span><span id="MJXp-Span-1362">+</span><span id="MJXp-Span-1363">[</span><span id="MJXp-Span-1364">2</span><span id="MJXp-Span-1365">]</span><span id="MJXp-Span-1366"><span id="MJXp-Span-1367">L</span><span id="MJXp-Span-1368">4</span></span></span></span></span></span></span></span></p><p>and the protocol fails. Bob can continue like this to recover each successive bit of <span><span id="MJXp-Span-1369"><span id="MJXp-Span-1370"><span id="MJXp-Span-1371">k</span><span id="MJXp-Span-1372">A</span></span></span></span>.</p>
  </div>
</article>

      </div>
    </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs" /></noscript>
</body>
</html>