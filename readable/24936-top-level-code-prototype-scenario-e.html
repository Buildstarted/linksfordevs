<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Top-Level Code Prototype: Scenario E -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Top-Level Code Prototype: Scenario E</h1><div><div class="entry-content"><p>At last we‚Äôve come to the last of my planned scenarios for this prototype‚Äìa little thing I like to think of as a WYSIWYG Web Service, or <strong>WYSIWYGWS</strong> for short. A few months back I had recently finished the <a href="https://anthonydgreen.net/2019/03/11/json-aficionados-wanted/">JSON literals post and video</a> and was anxiously combing my immediate vicinity for more scenarios when Scott Hanselman came along quite serendipitously with his post, <a href="https://www.hanselman.com/blog/ConvertingAnExcelWorksheetIntoAJSONDocumentWithCAndNETCoreAndExcelDataReader.aspx">Converting an Excel Worksheet into a JSON document with C# and .NET Core and ExcelDataReader</a> to inspired me.</p><p>I asked myself <em>‚ÄúHow
simple can defining a REST endpoint be?‚Äù</em> and here is the result.</p><figure class="wp-block-embed-youtube wp-block-embed is-type-rich wp-embed-aspect-16-9 wp-has-aspect-ratio"><p>Of course there are myriad ways to approach this problem with various trade-offs, this is just one.</p><p>One developer on Twitter asked Scott (paraphrasing) <em>‚ÄúWhy not just use PowerShell?‚Äù</em></p><p>To which Scott replies, <em>‚ÄúVery useful, yes, but would require additional PowerShell to get the output JSON I wanted‚Äù</em></p><p>And another developer says, what are the benefits of using <code>ExcelDataReader</code> over this PowerShell command?</p><p>And Scott reiterates, <em>‚ÄúControl over the result is all‚Äù</em></p><p>And that‚Äôs one key aspect to this scenario. Scott had an idea of what <strong>shape </strong>he wanted at the end and it was just a matter of getting what he had into that shape. And in the video above that‚Äôs exactly how I approach the problem as well, I start with that shape and then populate it. Now that‚Äôs what I call‚Ä¶ <em>Design by Contract! </em>(ba dum chhh)</p><p>Another element to the scenario is data that is‚Ä¶
uncooperative:</p><ul><li>You can‚Äôt control it</li><li>You can‚Äôt annotate it serialization attributes</li><li>The shape isn‚Äôt right for default serialization</li><li>It‚Äôs coming directly from an external (not .NET
objects) data source like a database, mainframe, device, other service, or in
this case a file</li></ul><p>And that last point is more important than you might think. Every day (on Facebook) I see a lot of developers working on apps that use DataSets as their data layer and/or are using an RDBMS that doesn‚Äôt have SQL Server‚Äôs fancy <a href="https://docs.microsoft.com/en-us/sql/relational-databases/json/format-query-results-as-json-with-for-json-sql-server?view=sql-server-2017">`FOR JSON` clause</a>. Without getting into a big argument about whether those folk need to ‚ÄúGet with the times‚Äù and ‚ÄúMove everything over to X‚Äù, what‚Äôs the fastest way for them to Cloud- or Mobile-enable that data? And even if you do have POCOs for your domain-objects, there are a lot of reports in life and not every report deserves its own custom <code>EndOfYearSalesByRegionReportRecordRow</code> class just so you can use JSON serialization.</p><p>It‚Äôs also just a useful way and crazy easy way to mock up an service end-point. When I was <a href="https://anthonydgreen.net/2019/03/11/json-aficionados-wanted/">exploring the GitHub Gist API</a> I was very conscious of how my debugging might look to the GitHub service. Was I hitting the live API up too much? Will I hit a request limit? With this I can just go to a service, grab the output, and paste it and develop against that until I‚Äôm ready to hit the live service. <strong>Ease in testing is its own reward</strong>.</p><p>In <a href="https://anthonydgreen.net/2019/05/03/top-level-code-scenario-d/">my last post</a> I combined top-level expressions with XML literals to create a basic VB.NET view engine for web pages on ASP.NET Core. In this post I took the same strategy but swapped out XML for <a href="https://anthonydgreen.net/2019/03/11/json-aficionados-wanted/">JSON literals</a> to make ASP.NET Core REST services a breeze in VB.NET. The approach has trade-offs and shines especially when dealing with one-off data sources such as files, database reports, and objects you can‚Äôt modify for serialization but yet still need to end up in a particular shape in the end, as well as testing.</p><p><strong>So what about you?</strong></p><p>Do <strong>you </strong>have any data you need to get out of some less that reputable places as painlessly as possible?</p><figure class="wp-block-image"><img data-attachment-id="100" data-permalink="https://anthonydgreen.net/image-3/" data-orig-file="https://onwardvb.files.wordpress.com/2019/05/image.png" data-orig-size="1016,550" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-medium-file="https://onwardvb.files.wordpress.com/2019/05/image.png?w=300" data-large-file="https://onwardvb.files.wordpress.com/2019/05/image.png?w=584" src="https://onwardvb.files.wordpress.com/2019/05/image.png" alt="" class="wp-image-100"><figcaption>See, the Millennium Falcon in this metaphor is the JSON. Or maybe the JSON is Obi-wan. I guess the data is the droids?</figcaption></figure><p>Does the low-ceremony abstraction I presented seem like the kind of thing that would make that easier or more attractive for you?<strong> Let me know in the comments below, or on <a href="https://twitter.com/ThatVBGuy" target="_blank" rel="noreferrer noopener" aria-label="Twitter (opens in a new tab)">Twitter</a></strong>.</p><p>Thanks for your time, your shares, and your feedback!</p><p>Regards,</p><p><strong>-ADG</strong></p><p><strong>P.S. </strong>This is the <strong>last </strong>scenario üò• in this series so my next post will be letting you know that the write-up of my design notes from exploring this idea have been posted on GitHub. Thanks for your patience!</p><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><h3 class="jp-relatedposts-headline"><em>Related</em></h3></div></figure></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>