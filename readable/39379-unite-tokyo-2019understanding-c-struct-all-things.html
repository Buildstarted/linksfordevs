<!DOCTYPE html>
<html lang="en">
<head>
    <title>
&#x3010;Unite Tokyo 2019&#x3011;Understanding C# Struct All Things -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>&#x3010;Unite Tokyo 2019&#x3011;Understanding C# Struct All Things</h1>
    <div><div class="sectionElements"> <div class="playerWrapper"> <div> <div class="player lightPlayer fluidImage presentation_player" id="svPlayerId"> <span class="j-fullscreen-title-banner fullscreen-title-banner"> &#x3010;Unite Tokyo 2019&#x3011;Understanding C# Struct All Things </span> <div class="stage valign-first-slide"> <a class="exit-fullscreen j-exit-fullscreen"> <i class="fa fa-compress fa-2x"></i> </a> <div class="slide_container"> <section class="slide show"> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-1-1024.jpg?cb=1569478193" alt="Understanding
C# Struct
All Things
Cysharp, Inc.
Kawai Yoshifumi "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-2-1024.jpg?cb=1569478193" alt="About Speaker
2
&#x2014; &#x6CB3;&#x5408; &#x5B9C;&#x6587; / Kawai Yoshifumi / @neuecc
&#x2014; Cysharp, Inc. &#x2013; CEO/CTO
&#x2014; Microsoft MVP for Developer Technologies(C..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-3-1024.jpg?cb=1569478193" alt="https://github.com/Cysharp
OSS for Unity &#x2013; GitHub/Cysharp
3
UniTask &#x2605;288
Provides an efficient async/await integration to
..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-4-1024.jpg?cb=1569478193" alt="https://github.com/neuecc
OSS for Unity &#x2013; GitHub/neuecc
4
LINQ-to-GameObject-for-Unity &#x2605;448
Traverse GameObject Hierarchy ..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-5-1024.jpg?cb=1569478193" alt="6
The Evolution of C# Struct "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-6-1024.jpg?cb=1569478193" alt="MessagePack for C#(v2-preview)
7
public ref struct MessagePackWriter
T Deserialize&lt;T&gt;(in ReadOnlySequence&lt;byte&gt; byteSequen..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-7-1024.jpg?cb=1569478193" alt="MessagePack for C#(v2-preview)
8
public ref struct MessagePackWriter
T Deserialize&lt;T&gt;(in ReadOnlySequence&lt;byte&gt; byteSequen..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-8-1024.jpg?cb=1569478193" alt="DOTS(&#x6628;&#x65E5;&#x306E;&#x57FA;&#x8ABF;&#x8B1B;&#x6F14;&#x3088;&#x308A;) "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-9-1024.jpg?cb=1569478193" alt="DOTS(&#x6628;&#x65E5;&#x306E;&#x57FA;&#x8ABF;&#x8B1B;&#x6F14;&#x3088;&#x308A;) "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-10-1024.jpg?cb=1569478193" alt="What&#x2019;s new struct features
11
C# 7.2 C# 7.3 C# 8.0
in modifier on parameter
ref readonly modifier on
method returns, local..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-11-1024.jpg?cb=1569478193" alt="12
Which Unity Version should we support?
Unity Version C# Version .NET Version
Unity 2017.4 6.0 .NET 3.5/.NET 4.6
Unity 2..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-12-1024.jpg?cb=1569478193" alt="13
Which Unity Version should we support?
Unity Version C# Version .NET Version
Unity 2017.4 6.0 .NET 3.5/.NET 4.6
Unity 2..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-13-1024.jpg?cb=1569478193" alt="14
Which Unity Version should we support?
Unity Version C# Version .NET Version
Unity 2017.4 6.0 .NET 3.5/.NET 4.6
Unity 2..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-14-1024.jpg?cb=1569478193" alt="Struct is important for Performance!
15
&#x2014; C# 7&#x4EE5;&#x964D;&#x306E;&#x6025;&#x901F;&#x306A;struct&#x5F37;&#x5316;&#x306F;&#x30D1;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30F3;&#x30B9;&#x306E;&#x305F;&#x3081;
&#x2014; &#x305D;&#x308C;&#x306F; .NET Core &#x3067;&#x3082;&#x3001;Unity&#x3067;&#x3082;
&#x2014; &#x30A2;&#x30D7;&#x30ED;&#x30FC;&#x30C1;&#x306F;&#x7570;&#x306A;&#x308C;&#x3069;&#x3001;&#x4E21;&#x8005;&#x3068;&#x3082;&#x69CB;&#x9020;&#x4F53;&#x3092;&#x30D1;&#x30D5;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-15-1024.jpg?cb=1569478193" alt="16
The Basic of C# Memory "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-16-1024.jpg?cb=1569478193" alt="The Memory of C#
17
AppDomain(Managed)
Thread
Stack
HeapThread
Stack
Unmanaged "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-17-1024.jpg?cb=1569478193" alt="The Memory of C#
18
AppDomain(Managed)
Thread
Stack
HeapThread
Stack
Unmanaged
&#x30ED;&#x30FC;&#x30AB;&#x30EB;&#x5909;&#x6570;&#x306F;&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x9818;&#x57DF;&#x306B;&#x683C;&#x7D0D;&#x3055;&#x308C;&#x308B;
&#x30D2;&#x30FC;&#x30D7;&#x9818;&#x57DF;&#x306B;&#x78BA;&#x4FDD;&#x3055;&#x308C;&#x305F;&#x30C7;&#x30FC;&#x30BF;&#x306F;
GC&#x306E;&#x7BA1;&#x7406;&#x5316;&#x306B;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-18-1024.jpg?cb=1569478193" alt="Let&#x2019;s see memory layout
19
&#x2014; SharpLab&#x3067;&#x30E1;&#x30E2;&#x30EA;&#x306E;&#x4E2D;&#x8EAB;&#x3092;&#x898B;&#x3088;&#x3046;&#xFF01;
&#x2014; https://sharplab.io/
&#x2014; C# to IL, C# to C#, C# to ASM&#x306A;&#x3069;&#x8C4A;&#x5BCC;&#x306A;&#x6A5F;&#x80FD;&#x304C;&#x3042;&#x308B;
&#x2014; Run &#x3068;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-19-1024.jpg?cb=1569478193" alt="Struct Memory
Int(4&#x30D0;&#x30A4;&#x30C8;)&#x306E;X, Y, Z(12&#x30D0;&#x30A4;&#x30C8;)&#x304C;
&#x7D20;&#x76F4;&#x306B;&#x30E1;&#x30E2;&#x30EA;&#x4E0A;(&#x30B9;&#x30BF;&#x30C3;&#x30AF;)&#x306B;&#x4E26;&#x3076; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-20-1024.jpg?cb=1569478193" alt="Class Memory
&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x4E0A;&#x306E;&#x5909;&#x6570;&#x306F;&#x30D2;&#x30FC;&#x30D7;&#x4E0A;
&#x306E;&#x30A2;&#x30C9;&#x30EC;&#x30B9;&#x3092;&#x6307;&#x3059;
&#x30D2;&#x30FC;&#x30D7;&#x4E0A;&#x306B;&#x78BA;&#x4FDD;&#x3055;&#x308C;&#x308B;&#x30E1;&#x30E2;&#x30EA;&#x306F;&#x7BA1;&#x7406;
&#x7528;&#x306E;&#x30D8;&#x30C3;&#x30C0;/&#x578B;&#x60C5;&#x5831; + &#x5B9F;&#x30C7;&#x30FC;&#x30BF; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-21-1024.jpg?cb=1569478193" alt="Pass by Reference/Pass by Value
22
&#x2014; C#&#x306F;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x306F;&#x5168;&#x3066;&#x300C;&#x5024;&#x6E21;&#x3057;&#x300D;
&#x2014; &#x3064;&#x307E;&#x308A;&#x30B3;&#x30D4;&#x30FC;&#x3055;&#x308C;&#x307E;&#x3059;
&#x2014; &#x30ED;&#x30FC;&#x30AB;&#x30EB;&#x5909;&#x6570;&#x3078;&#x306E;&#x4EE3;&#x5165;&#x3082;&#x30B3;&#x30D4;&#x30FC;
(T x) (ref T x)
class &#x53C2;&#x7167;&#x306E;&#x5024;&#x6E21;&#x3057; &#x53C2;&#x7167;&#x306E;&#x53C2;&#x7167;&#x6E21;&#x3057;
s..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-22-1024.jpg?cb=1569478193" alt="&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x9818;&#x57DF;&#x306F;&#x5927;&#x4F53;&#x3053;&#x306E;&#x8FBA;&#x3063;&#x307D;&#x3044; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-23-1024.jpg?cb=1569478193" alt="00 00 00 00 &#x304B;&#x3089;&#x305D;&#x308C;&#x3063;&#x307D;
&#x3044;&#x30C7;&#x30FC;&#x30BF;&#x304C;&#x5165;&#x3063;&#x305F;&#x6C17;&#x914D; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-24-1024.jpg?cb=1569478193" alt="&#x5F15;&#x304D;&#x7D9A;&#x304D;&#x3001; y = x &#x3067;&#x540C;&#x3058;&#x30C7;
&#x30FC;&#x30BF;&#x304C;&#x8FFD;&#x52A0;&#x3067;&#x5165;&#x3063;&#x305F;&#x3063;&#x307D;&#x3044; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-25-1024.jpg?cb=1569478193" alt="&#x5225;&#x306E;&#x3068;&#x3053;&#x308D;&#x306B;x&#x3068;y&#x304C;&#x30B3;&#x30D4;&#x30FC;
&#x3055;&#x308C;&#x3066;&#x5165;&#x3063;&#x305F;&#x6C17;&#x914D; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-26-1024.jpg?cb=1569478193" alt="&#x623B;&#x308A;&#x306E;z&#x3092;&#x53D7;&#x3051;&#x53D6;&#x3063;&#x3066;&#x5168;&#x90E8;
&#x57CB;&#x307E;&#x3063;&#x305F; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-27-1024.jpg?cb=1569478193" alt="int x
int y
int z
&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x6642;(C# -&gt; IL)&#x306E;&#x6BB5;
&#x968E;&#x3067;&#x5909;&#x6570;&#x306E;&#x7F6E;&#x304D;&#x5834;&#x78BA;&#x4FDD;&#x3057;&#x3066;&#x304A;
&#x304D;&#x307E;&#x3059;&#x3001;&#x7684;&#x306A; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-28-1024.jpg?cb=1569478193" alt="Struct&#x306E;&#x57FA;&#x672C;&#x7684;&#x306A;&#x539F;&#x5247;
29
&#x2014; &#x5168;&#x3066;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;
&#x2014; &#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306E;&#x9055;&#x3044;&#x3001;&#x307B;&#x3068;&#x3093;&#x3069;&#x306E;&#x554F;&#x984C;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x5F15;&#x304D;&#x8D77;&#x3053;&#x3055;&#x308C;&#x308B;
&#x2014; &#x5927;&#x304D;&#x306A;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; IntPtr.Size(4 or 8&#x30D0;&#x30A4;&#x30C8;)&#x4EE5;&#x4E0A;&#x306F;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-29-1024.jpg?cb=1569478193" alt="Struct&#x306E;&#x57FA;&#x672C;&#x7684;&#x306A;&#x539F;&#x5247;
30
&#x2014; &#x5168;&#x3066;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;
&#x2014; &#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306E;&#x9055;&#x3044;&#x3001;&#x307B;&#x3068;&#x3093;&#x3069;&#x306E;&#x554F;&#x984C;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x5F15;&#x304D;&#x8D77;&#x3053;&#x3055;&#x308C;&#x308B;
&#x2014; &#x5927;&#x304D;&#x306A;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; IntPtr.Size(4 or 8&#x30D0;&#x30A4;&#x30C8;)&#x4EE5;&#x4E0A;&#x306F;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-30-1024.jpg?cb=1569478193" alt="Struct&#x306E;&#x57FA;&#x672C;&#x7684;&#x306A;&#x539F;&#x5247;
31
&#x2014; &#x5168;&#x3066;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;
&#x2014; &#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306E;&#x9055;&#x3044;&#x3001;&#x307B;&#x3068;&#x3093;&#x3069;&#x306E;&#x554F;&#x984C;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x5F15;&#x304D;&#x8D77;&#x3053;&#x3055;&#x308C;&#x308B;
&#x2014; &#x5927;&#x304D;&#x306A;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; IntPtr.Size(4 or 8&#x30D0;&#x30A4;&#x30C8;)&#x4EE5;&#x4E0A;&#x306F;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-31-1024.jpg?cb=1569478193" alt="Boxed Struct
&#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x5316;
&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x4E0A;&#x306E;&#x5909;&#x6570;&#x306F;
&#x30D2;&#x30FC;&#x30D7;&#x306E;&#x30A2;&#x30C9;&#x30EC;&#x30B9; &#x30D2;&#x30FC;&#x30D7;&#x4E0A;&#x306B;&#x30AF;&#x30E9;&#x30B9;&#x3068;
&#x540C;&#x69D8;&#x30D8;&#x30C3;&#x30C0;&#x304C;&#x4ED8;&#x3044;&#x305F;
&#x3046;&#x3048;&#x3067;&#x9818;&#x57DF;&#x78BA;&#x4FDD;
&#x30A2;&#x30F3;&#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x306E;&#x6BCE;&#x306B;
&#x3053;&#x3053;&#x304B;&#x3089;&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x3078;
&#x30B3;&#x30D4;&#x30FC;&#x3059;&#x308B; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-32-1024.jpg?cb=1569478193" alt="Box&#x5316;&#x3068;&#x306E;&#x6226;&#x3044;
33
&#x2014; &#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x5316;&#x306F;new&#x3068;&#x4E00;&#x7DD2;
&#x2014; &#x3080;&#x3057;&#x308D;&#x30A2;&#x30F3;&#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x306E;&#x983B;&#x5EA6;&#x7684;&#x306B;&#x3088;&#x308A;&#x60AA;&#x3044;
&#x2014; &#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x5316;&#x304C;&#x907F;&#x3051;&#x3089;&#x308C;&#x306A;&#x3044;&#x306A;&#x3089;&#x6700;&#x521D;&#x304B;&#x3089;&#x30AF;&#x30E9;&#x30B9;&#x3067;&#x4F5C;&#x308B;&#x3053;&#x3068;&#x3082;&#x9078;&#x629E;&#x80A2;
&#x2014; &#x30A4;&#x30F3;&#x30BF;&#x30FC;&#x30D5;&#x30A7;&#x30A4;&#x30B9;&#x3078;&#x306E;&#x30AD;&#x30E3;&#x30B9;&#x30C8;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;
&#x2013; &#x30B8;&#x30A7;&#x30CD;&#x30EA;&#x30AF;&#x30B9;&#x3092;&#x4F7F;&#x3063;&#x3066;&#x56DE;&#x907F;&#x3057;&#x3066;&#x3044;&#x304F;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-33-1024.jpg?cb=1569478193" alt="Equals&#x306E;&#x81EA;&#x52D5;&#x5B9F;&#x88C5;&#x3068;Box&#x5316;
34
&#x2014; struct&#x306F;Equals&#x304C;&#x5B9F;&#x88C5;&#x3055;&#x308C;&#x3066;&#x3044;&#x306A;&#x3044;&#x5834;&#x5408;&#x3001;&#x81EA;&#x52D5;&#x7684;&#x306B;&#x4EE5;&#x4E0B;&#x306E;&#x3082;&#x306E;&#x304C;&#x547C;&#x3070;&#x308C;&#x308B;
&#x2014; &#x3081;&#x3063;&#x3061;&#x3083;&#x9045;&#x3044;
&#x2014; Equals&#x306F;&#x8F9E;&#x66F8;&#x306E;Key&#x306B;&#x3059;&#x308B;&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#xFF01;
&#x305D;&#x306E;&#x305F;&#x3081;&#x8F9E;&#x66F8;&#x306E;Key&#x306B;&#x3059;&#x308B;&#x69CB;&#x9020;&#x4F53;&#x306F;
IEquatab..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-34-1024.jpg?cb=1569478193" alt="Struct Layout and Padding
&#x5358;&#x7D14;&#x8A08;&#x7B97;&#x3067;&#x306F;byte(1) + long(8) + int(4) = 13&#x3067;&#x3059;&#x304C;&#x3001;
&#x30A2;&#x30E9;&#x30A4;&#x30F3;&#x30E1;&#x30F3;&#x30C8;&#x8ABF;&#x6574;&#x306E;&#x305F;&#x3081;&#x3001;&#x6700;&#x9577;&#x306E;8&#x306B;&#x305D;&#x308C;&#x305E;&#x308C;&#x304C;&#x5408;
&#x308F;&#x305B;&#x3089;&#x308C;&#x3066;8 * 3 = 24&#x30D0;&#x30A4;&#x30C8;&#x306E;&#x78BA;&#x4FDD;&#x306B;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-35-1024.jpg?cb=1569478193" alt="Struct Layout and Padding StructLayout&#x3084;FieldOffset&#x306B;&#x3088;&#x3063;&#x3066;&#x30EC;&#x30A4;&#x30A2;&#x30A6;
&#x30C8;&#x306F;&#x30AB;&#x30B9;&#x30BF;&#x30DE;&#x30A4;&#x30BA;&#x53EF;&#x80FD;&#x3002;
struct&#x306E;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x306F;Sequential(&#x5BA3;&#x8A00;&#x9806;)
Auto&#x306B;&#x5909;&#x3048;&#x308B;&#x3068;&#x3001;Z&#x3068;X&#x304C;&#x8A70;&#x3081;&#x3089;&#x308C;&#x308B;&#x3053;&#x3068;&#x3067;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-36-1024.jpg?cb=1569478193" alt="Heap Layout: Array
&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x306E;&#x5171;&#x901A;&#x30D8;&#x30C3;&#x30C0;&#x306E;&#x5F8C;
&#x308D;&#x306B;&#x9577;&#x3055;&#x304C;&#x4ED8;&#x3044;&#x3066;&#x308B;
&#x30C7;&#x30FC;&#x30BF;&#x9818;&#x57DF;&#x306B;&#x306F;&#x8981;&#x7D20;&#x304C;&#x305D;&#x306E;&#x307E;&#x307E;&#x9806;&#x756A;&#x306B;&#x4E26;&#x3076;&#x3002;&#x69CB;&#x9020;&#x4F53;&#x306A;
&#x3089;&#x3001;&#x5024;&#x304C;&#x305D;&#x306E;&#x307E;&#x307E;&#x9806;&#x756A;&#x306B;&#x4E26;&#x3093;&#x3067;&#x3044;&#x308B;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;&#xFF08;&#x53C2;&#x7167;
&#x578B;&#x306E;&#x5834;&#x5408;&#x306F;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x304C;&#x4E26;&#x3093;&#x3067;&#x3044;&#x308B;&#x305F;&#x3081;&#x3001;&#x5B9F;&#x614B;&#x306E;&#x30C7;&#x30FC;&#x30BF;
&#x3092;&#x66F4;&#x306B;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-37-1024.jpg?cb=1569478193" alt="38
ref and readonly "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-38-1024.jpg?cb=1569478193" alt="Zero Allocation foreach in List&lt;T&gt;
39
&#x2014; foreach&#x306F; .GetEnumerator -&gt; while(MoveNext()) &#x306B;&#x5909;&#x63DB;&#x3055;&#x308C;&#x308B;
&#x2014; &#xFF08;&#x305F;&#x3060;&#x3057;&#x914D;&#x5217;&#x306E;&#x5834;&#x5408;&#x306F;&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x6642;&#x306B;IL&#x3067;for&#x306B;&#x5909;&#x63DB;&#x3055;&#x308C;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-39-1024.jpg?cb=1569478193" alt="Mutable Struct is Evil but Useful
40
&#x2014; &#x4E00;&#x6642;&#x7684;&#x306A;&#x5165;&#x308C;&#x7269;&#x3068;&#x3057;&#x3066;&#x4F7F;&#x3046;&#x3082;&#x306E;&#x306B;&#x5411;&#x3044;&#x3066;&#x308B;
public struct Enumerator : IEnumerator&lt;T&gt;
{
List&lt;T&gt; list;
int i..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-40-1024.jpg?cb=1569478193" alt="ref struct
41
&#x2014; &#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x306B;&#x3057;&#x304B;&#x7F6E;&#x3051;&#x306A;&#x3044;&#x3068;&#x3044;&#x3046;&#x5236;&#x7D04;&#x304C;ref struct
&#x2013; &#x5143;&#x3005;&#x306F;Span&lt;T&gt;(System.Memory, .NET Standard 2.0&#x5916;&#x90E8;&#x30E9;&#x30A4;&#x30D6;&#x30E9;&#x30EA;)&#x306E;&#x305F;&#x3081;
&#x2013; Span&lt;T&gt;&#x306F;&#x9023;&#x7D9A;&#x3057;&#x305F;&#x30E1;&#x30E2;&#x30EA;&#x9818;&#x57DF;&#x306E;&#x30D3;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-41-1024.jpg?cb=1569478193" alt="internal ref struct TempList&lt;T&gt;
{
int index;
T[] array;
public ReadOnlySpan&lt;T&gt; Span =&gt; new ReadOnlySpan&lt;T&gt;(array, 0, index..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-42-1024.jpg?cb=1569478193" alt="public void DoNanika(IEnumerable&lt;int&gt; idList)
{
var resources = idList.Select(x =&gt; Load(x));
// LINQ&#x306E;&#x9045;&#x5EF6;&#x5B9F;&#x884C;&#x306B;&#x3088;&#x308A;&#x4E8C;&#x56DE;&#x306E;Load&#x304C;&#x8D70;&#x3063;&#x3066;&#x3057;&#x307E;&#x3046;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-43-1024.jpg?cb=1569478193" alt="Avoid the copy, Everywhere
44
&#x2014; &#x5168;&#x3066; ref &#x3067;&#x5F15;&#x304D;&#x56DE;&#x305B;&#x3070;&#x3044;&#x3044;&#x3001;&#x3068;&#x306F;&#x3044;&#x3046;&#x3082;&#x306E;&#x306E;&#x73FE;&#x5B9F;&#x7684;&#x3067;&#x306F;&#x306A;&#x3044;
&#x2014; &#x3042;&#x307E;&#x308A;&#x306B;&#x3082;&#x6700;&#x60AA;&#x306A;&#x66F8;&#x304D;&#x5FC3;&#x5730;&#x306B;&#x306A;&#x308B;&#xFF01;
&#x2014; &#x3042;&#x308B;&#x3044;&#x306F;&#x5168;&#x3066;unsafe&#x3067;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x3067;&#x53D6;&#x308A;&#x56DE;&#x3059;&#x3068;&#x3044;&#x3046;&#x624B;&#x3082;&#x2026;&#x2026;
&#x2014; Unity...."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-44-1024.jpg?cb=1569478193" alt="static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, E..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-45-1024.jpg?cb=1569478193" alt="static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, E..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-46-1024.jpg?cb=1569478193" alt="static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, E..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-47-1024.jpg?cb=1569478193" alt="static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, E..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-48-1024.jpg?cb=1569478193" alt="static void Normal(Vector3 v3)
{
_ = v3.magnitude;
}
static void In(in Vector3 v3)
{
_ = v3.magnitude;
}
static void Ref(r..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-49-1024.jpg?cb=1569478193" alt="static void Normal(Vector3 v3)
{
_ = v3.magnitude;
}
static void In(in Vector3 v3)
{
_ = v3.magnitude;
}
static void Ref(r..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-50-1024.jpg?cb=1569478193" alt="static void Normal(Vector3 v3)
{
_ = v3.magnitude;
_ = v3.magnitude;
}
static void In(in Vector3 v3)
{
_ = v3.magnitude;
_..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-51-1024.jpg?cb=1569478193" alt="Best practice to use `in`
52
&#x2014; in &#x306F;&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x3059;&#x308B;&#x3068;([In][IsReadOnly]ref T t) &#x306B;&#x306A;&#x308B;
&#x2014; &#x8AAD;&#x307F;&#x53D6;&#x308A;&#x5C02;&#x7528;&#x306E;&#x305F;&#x3081;&#x3001;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30C9;&#x3078;&#x306E;&#x4EE3;&#x5165;&#x306F;&#x3067;&#x304D;&#x306A;&#x3044;
&#x2014; v3.x = 10.0f; // com..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-52-1024.jpg?cb=1569478193" alt="Best practice to use `in`
53
&#x2014; in &#x306F;&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x3059;&#x308B;&#x3068;([In][IsReadOnly]ref T t) &#x306B;&#x306A;&#x308B;
&#x2014; &#x8AAD;&#x307F;&#x53D6;&#x308A;&#x5C02;&#x7528;&#x306E;&#x305F;&#x3081;&#x3001;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30C9;&#x3078;&#x306E;&#x4EE3;&#x5165;&#x306F;&#x3067;&#x304D;&#x306A;&#x3044;
&#x2014; v3.x = 10.0f; // com..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-53-1024.jpg?cb=1569478193" alt="readonly field(struct)&#x306E;&#x7F60;
54
&#x2014; readonly&#x306A;field&#x306E;struct&#x306B;mutable&#x306A;&#x64CD;&#x4F5C;&#x3092;&#x884C;&#x3063;&#x3066;&#x3082;&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;
&#x2014; &#x3088;&#x3063;&#x3066;&#x3001;&#x30DF;&#x30E5;&#x30FC;&#x30BF;&#x30D6;&#x30EB;&#x306A;&#x64CD;&#x4F5C;&#x3092;&#x884C;&#x3046;&#x3082;&#x306E;&#x306F;readonly field&#x306B;&#x3059;&#x3079;&#x304D;&#x3067;&#x306F;&#x306A;&#x3044;
&#x2014; &#x539F;&#x5247;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-54-1024.jpg?cb=1569478193" alt="55
Manipulate Memory "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-55-1024.jpg?cb=1569478193" alt="&#x6539;&#x3081;&#x3066;Struct&#x3068;&#x306F;
56
&#x2014; &#x30E1;&#x30E2;&#x30EA;&#x3092;&#x5358;&#x7D14;&#x306B;&#x30DE;&#x30C3;&#x30D4;&#x30F3;&#x30B0;&#x3057;&#x305F;&#x69CB;&#x9020;
&#x2013; &#x305D;&#x306E;&#x3053;&#x3068;&#x3060;&#x3051;&#x610F;&#x8B58;&#x3059;&#x308C;&#x3070;&#x3001;&#x3042;&#x3068;&#x306F;&#x3084;&#x308A;&#x305F;&#x3044;&#x653E;&#x984C;&#x3067;&#x304D;&#x308B;
[StructLayout(LayoutKind.Sequential, Size = 16)]
public struc..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-56-1024.jpg?cb=1569478193" alt="57
// &#x5148;&#x982D;6&#x30D0;&#x30A4;&#x30C8;&#x304C;Timestamp, &#x5F8C;&#x308D;10&#x30D0;&#x30A4;&#x30C8;&#x304C;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x3068;&#x3044;&#x3046;Ulid&#x3068;&#x3044;&#x3046;&#x4ED5;&#x69D8;(&#x30BD;&#x30FC;&#x30C8;&#x53EF;&#x80FD;&#x306A;Guid&#x306E;&#x4EE3;&#x66FF;)
[StructLayout(LayoutKind.Explicit, Size = 16)]
public stru..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-57-1024.jpg?cb=1569478193" alt="58
// &#x5148;&#x982D;6&#x30D0;&#x30A4;&#x30C8;&#x304C;Timestamp, &#x5F8C;&#x308D;10&#x30D0;&#x30A4;&#x30C8;&#x304C;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x3068;&#x3044;&#x3046;Ulid&#x3068;&#x3044;&#x3046;&#x4ED5;&#x69D8;(&#x30BD;&#x30FC;&#x30C8;&#x53EF;&#x80FD;&#x306A;Guid&#x306E;&#x4EE3;&#x66FF;)
[StructLayout(LayoutKind.Explicit, Size = 16)]
public stru..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-58-1024.jpg?cb=1569478193" alt="Union
59
[StructLayout(LayoutKind.Explicit, Pack = 1)]
internal struct GuidBits
{
[FieldOffset(0)]
public readonly Guid Va..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-59-1024.jpg?cb=1569478193" alt="&#x6539;&#x3081;&#x3066;Struct&#x304C;&#x8981;&#x7D20;&#x306E;&#x914D;&#x5217;&#x3068;&#x306F;
60
&#x2014; &#x30E1;&#x30E2;&#x30EA;&#x306B;Struct&#x304C;&#x5358;&#x7D14;&#x306B;&#x4E26;&#x3093;&#x3067;&#x3044;&#x308B;
X Y Z X Y Z X Y Z X Y ZVector3[]
&#x30E1;&#x30E2;&#x30EA;&#x3092;&#x307E;&#x308B;&#x3054;&#x3068;&#x30B3;&#x30D4;&#x30FC;&#x3059;&#x308B;&#x3060;&#x3051;&#x3067;
&#x6700;&#x901F;&#x306E;&#x30B7;&#x30EA;&#x30A2;&#x30E9;&#x30A4;&#x30BA;&#x3060;&#x3088;&#x306D;&#x8AAC;
&#xFF08;&#x30A8;&#x30F3;&#x30C7;&#x30A3;&#x30A2;&#x30F3;&#x306F;&#x63C3;&#x3048;&#x308B;&#xFF09;
&#x5B9F;&#x969B;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-60-1024.jpg?cb=1569478193" alt="61
public class UnsafeDirectBlitArrayFormatter&lt;T&gt; : IMessagePackFormatter&lt;T[]&gt; where T : struct
{
public unsafe int Serial..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-61-1024.jpg?cb=1569478193" alt="62
Span and NativeArray "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-62-1024.jpg?cb=1569478193" alt="Span vs NativeArray
63
&#x2014; Span&lt;T&gt;
&#x2014; System.Memory
&#x2014; .NET Standard 2.1&#x3067;&#x306F;&#x6A19;&#x6E96;(&#x73FE;&#x5728;&#x306F;&#x5916;&#x90E8;&#x30E9;&#x30A4;&#x30D6;&#x30E9;&#x30EA;&#x304C;&#x5FC5;&#x8981;)
&#x2014; C# 7.2&#x3068;&#x7D71;&#x5408;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;
&#x2014; &#x3042;&#x3089;&#x3086;&#x308B;&#x9023;&#x7D9A;&#x3057;&#x305F;&#x30E1;&#x30E2;&#x30EA;&#x9818;&#x57DF;&#x306E;&#x30D3;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-63-1024.jpg?cb=1569478193" alt="&#x30D5;&#x30EC;&#x30FC;&#x30E0;&#x30EF;&#x30FC;&#x30AF;&#x5BFE;&#x5FDC;&#x304C;&#x306A;&#x3044;&#x3068;&#x610F;&#x5473;&#x304C;&#x306A;&#x3044;
64
&#x2014; Span&lt;T&gt;
&#x2014; &#x4ECA;&#x307E;&#x3067;&#x306E;API&#x304C;T[]&#x3057;&#x304B;&#x53D7;&#x3051;&#x5165;&#x308C;&#x306A;&#x304B;&#x3063;&#x305F;&#x308A;&#x3059;&#x308B;&#x3068;&#x3001;&#x7D50;&#x5C40;T[]&#x3078;&#x306E;&#x5909;&#x63DB;&#x304C;&#x5FC5;&#x8981;&#x306B;&#x306A;&#x308B;
&#x2014; &#x7121;&#x99C4;&#x30A2;&#x30ED;&#x30B1;&#x30FC;&#x30C8;
&#x2014; .NET Core 2.1&#x3067;&#x5BFE;&#x5FDC;&#x5145;&#x5B9F;&#x3055;&#x305B;&#x4E2D;
&#x2014; &#x4F8B;&#x3048;&#x3070;Convert..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-64-1024.jpg?cb=1569478193" alt="65
Conclusion "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-65-1024.jpg?cb=1569478193" alt="&#x306E;&#x524D;&#x306B;&#x3002;
66
&#x2014; &#x69CB;&#x9020;&#x4F53;&#x306E;&#x8272;&#x3092;&#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306F;&#x5225;&#x306E;&#x8272;&#x306B;&#x5909;&#x66F4;&#x3057;&#x3066;&#x304A;&#x3053;&#x3046;&#xFF01;
&#x2013; &#x6027;&#x80FD;&#x7279;&#x6027;&#x304C;&#x7570;&#x306A;&#x308B;&#x3082;&#x306E;&#x306E;&#x305F;&#x3081;&#x3001;&#x898B;&#x5206;&#x3051;&#x304C;&#x3064;&#x304F;&#x3068;&#x3001;&#x3068;&#x3066;&#x3082;&#x697D;&#x306B;&#x306A;&#x308B; "> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-66-1024.jpg?cb=1569478193" alt="Struct&#x3092;&#x6050;&#x308C;&#x306A;&#x3044;
67
&#x2014; Struct&#x306E;&#x4F7F;&#x3044;&#x3053;&#x306A;&#x3057;&#x81EA;&#x4F53;&#x306F;&#x3001;&#x3082;&#x306F;&#x3084;&#x5FC5;&#x9808;
&#x2013; Class&#x3092;&#x512A;&#x5148;&#x3059;&#x308B;&#x7267;&#x6B4C;&#x7684;&#x6642;&#x4EE3;&#x306F;&#x7D42;&#x308F;&#x3063;&#x305F;
&#x2013; &#x78BA;&#x304B;&#x306B;&#x7F60;&#x306F;&#xFF08;&#x3044;&#x3063;&#x3071;&#x3044;&#xFF09;&#x3042;&#x308B;&#x304C;&#x3001;&#x96E3;&#x3057;&#x3044;&#x8A71;&#x3067;&#x306F;&#x306A;&#x3044;
&#x2013; &#x899A;&#x3048;&#x308B;&#x30D1;&#x30BF;&#x30FC;&#x30F3;&#x304C;&#xFF08;&#x3061;&#x3087;&#x3063;&#x3068;&#xFF09;&#x591A;&#x3044;&#x3060;&#x3051;&#x3067;
&#x2014; &#x305D;&#x3057;&#x3066;&#x3053;&#x306E;&#x6D41;&#x308C;&#x306F;&#x623B;&#x3089;..."> </section> <section class="slide"> <i class="fa fa-spinner fa-spin"></i> <img class="slide_image" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-67-1024.jpg?cb=1569478193" alt="&#x3010;Unite Tokyo 2019&#x3011;Understanding C# Struct All Things"> </section> <div class="j-next-container next-container"> <div class="content-container"> <div class="next-slideshow-wrapper"> <div class="j-next-slideshow next-slideshow"> <p class="title-container"> <span class="title-text">Upcoming SlideShare</span> </p> </div> <p class="next-timer">Loading in &#x2026;<span class="j-timer-count timer-count">5</span></p> <p class="j-next-cancel">&#xD7;</p> </div> </div> </div> </div> </div> <div class="toolbar_wrapper j-player-toolbar"> <div class="toolbar normal"> <div class="j-progress-bar progress-bar-wrapper"> <div class="j-progress-tooltip progress-tooltip"> <div class="j-tooltip-content progress-tooltip-wrapper"> <img class="j-tooltip-thumb tooltip-thumb" src="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/85/unite-tokyo-2019understanding-c-struct-all-things-67-320.jpg?cb=1569478193"> <span class="j-slidecount-label slidecount-label">1</span> </div> </div>
</div> </div> </div> </div> </div> </div> <div id="lastScreen"> <div class="lastScreen"> <div class="pro-overlay j-lastscreen"> <p class="proSharingText">Like this presentation? Why not share!</p> </div> </div> </div> </div><div class="slideshow-info-container"> <p class="notranslate"> <ol class="j-transcripts transcripts no-bullet no-style"> <li> 1. Understanding
C# Struct
All Things
Cysharp, Inc.
Kawai Yoshifumi </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-2-638.jpg?cb=1569478193"> 2. </a> About Speaker
2
&#x2014; &#x6CB3;&#x5408; &#x5B9C;&#x6587; / Kawai Yoshifumi / @neuecc
&#x2014; Cysharp, Inc. &#x2013; CEO/CTO
&#x2014; Microsoft MVP for Developer Technologies(C#)
&#x2014; 50&#x4EE5;&#x4E0A;&#x306E;OSS&#x516C;&#x958B;(UniRx, MagicOnion, MessagePack for C#, etc..)
&#x2014; &#x682A;&#x5F0F;&#x4F1A;&#x793E;Cysharp
&#x2014; 2019&#x5E74;9&#x6708;, Cygames&#x306E;&#x5B50;&#x4F1A;&#x793E;&#x3068;&#x3057;&#x3066;&#x8A2D;&#x7ACB;
&#x2014; C#&#x95A2;&#x9023;&#x306E;&#x7814;&#x7A76;&#x958B;&#x767A;/OSS/&#x30B3;&#x30F3;&#x30B5;&#x30EB;&#x30C6;&#x30A3;&#x30F3;&#x30B0;&#x3092;&#x884C;&#x3046;
&#x2014; C#&#x5927;&#x7D71;&#x4E00;&#x7406;&#x8AD6;(&#x30B5;&#x30FC;&#x30D0;&#x30FC;/&#x30AF;&#x30E9;&#x30A4;&#x30A2;&#x30F3;&#x30C8;&#x3068;&#x3082;&#x306B;C#&#x3067;&#x5B9F;&#x88C5;&#x3059;&#x308B;)&#x3092;&#x63A8;&#x9032; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-3-638.jpg?cb=1569478193"> 3. </a> https://github.com/Cysharp
OSS for Unity &#x2013; GitHub/Cysharp
3
UniTask &#x2605;288
Provides an efficient async/await integration to
Unity.
RuntimeUnitTestToolkit &#x2605;87
CLI/GUI Frontend of Unity Test Runner to test on
any platforms.
RandomFixtureKit &#x2605;16
Fill random/edge-case value to target type for
unit testing.
MagicOnion &#x2605;1240
Unified Realtime/API Engine for .NET Core and
Unity.
MasterMemory &#x2605;407
Embedded Typed Readonly In-Memory
Document Database for .NET Core and Unity. </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-4-638.jpg?cb=1569478193"> 4. </a> https://github.com/neuecc
OSS for Unity &#x2013; GitHub/neuecc
4
LINQ-to-GameObject-for-Unity &#x2605;448
Traverse GameObject Hierarchy by LINQ.
PhotonWire &#x2605;92
Typed Asynchronous RPC Layer for Photon.
SerializableDictionary &#x2605;87
SerializableCollections for Unity.
ReMotion &#x2605;27
Hyper Fast Reactive Tween Engine for Unity.
UniRx &#x2605;3722
Reactive Extensions for Unity.
MessagePack-CSharp &#x2605;2089
Extremely Fast MessagePack Serializer.
ZeroFormatter &#x2605;1778
Infinitely Fast Deserializer.
Utf8Json &#x2605;1352
Definitely Fastest JSON Serializer. </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-5-638.jpg?cb=1569478193"> 5. </a> 6
The Evolution of C# Struct </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-6-638.jpg?cb=1569478193"> 6. </a> MessagePack for C#(v2-preview)
7
public ref struct MessagePackWriter
T Deserialize&lt;T&gt;(in ReadOnlySequence&lt;byte&gt; byteSequence)
Span&lt;byte&gt; bytes = stackalloc byte[36];
internal ref partial struct SequenceReader&lt;T&gt;
where T : unmanaged, IEquatable&lt;T&gt;
public ref byte GetPointer(int sizeHint)
ref Entry v = ref entry[0]; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-7-638.jpg?cb=1569478193"> 7. </a> MessagePack for C#(v2-preview)
8
public ref struct MessagePackWriter
T Deserialize&lt;T&gt;(in ReadOnlySequence&lt;byte&gt; byteSequence)
Span&lt;byte&gt; bytes = stackalloc byte[36];
internal ref partial struct SequenceReader&lt;T&gt;
where T : unmanaged, IEquatable&lt;T&gt;
ref struct
Span&lt;T&gt; = stackalloc
in parameter
where : unmanaged
public ref byte GetPointer(int sizeHint)
ref Entry v = ref entry[0];
ref return
ref local </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-8-638.jpg?cb=1569478193"> 8. </a> DOTS(&#x6628;&#x65E5;&#x306E;&#x57FA;&#x8ABF;&#x8B1B;&#x6F14;&#x3088;&#x308A;) </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-9-638.jpg?cb=1569478193"> 9. </a> DOTS(&#x6628;&#x65E5;&#x306E;&#x57FA;&#x8ABF;&#x8B1B;&#x6F14;&#x3088;&#x308A;) </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-10-638.jpg?cb=1569478193"> 10. </a> What&#x2019;s new struct features
11
C# 7.2 C# 7.3 C# 8.0
in modifier on parameter
ref readonly modifier on
method returns, local
readonly struct
declaration
ref struct declaration
ref extension method
stackalloc to Span
reassign ref local
additional generics
constraints(unmanage
d, Enum, Delegate)
stackalloc initializer
access fixed field
without pinning
readonly method
Disposable ref structs
Unmanaged
constructed types
https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/
C# 7.0
ref return statement
ref local variables </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-11-638.jpg?cb=1569478193"> 11. </a> 12
Which Unity Version should we support?
Unity Version C# Version .NET Version
Unity 2017.4 6.0 .NET 3.5/.NET 4.6
Unity 2018.2 6.0 .NET 4.x/Standard 2.0
Unity 2018.3 7.3 .NET 4.x/Standard 2.0
Unity 2018.4 7.3 .NET 4.x/Standard 2.0
Unity 2019.1 7.3 .NET 4.x/Standard 2.0 </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-12-638.jpg?cb=1569478193"> 12. </a> 13
Which Unity Version should we support?
Unity Version C# Version .NET Version
Unity 2017.4 6.0 .NET 3.5/.NET 4.6
Unity 2018.2 6.0 .NET 4.x/Standard 2.0
Unity 2018.3 7.3 .NET 4.x/Standard 2.0
Unity 2018.4 7.3 .NET 4.x/Standard 2.0
Unity 2019.1 7.3 .NET 4.x/Standard 2.0
2018.3&#x4EE5;&#x4E0A;&#x4E00;&#x629E;&#x3001;&#x305D;&#x308C;&#x4EE5;&#x4E0B;&#x306E;
&#x30D0;&#x30FC;&#x30B8;&#x30E7;&#x30F3;&#x306F;Not Supported </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-13-638.jpg?cb=1569478193"> 13. </a> 14
Which Unity Version should we support?
Unity Version C# Version .NET Version
Unity 2017.4 6.0 .NET 3.5/.NET 4.6
Unity 2018.2 6.0 .NET 4.x/Standard 2.0
Unity 2018.3 7.3 .NET 4.x/Standard 2.0
Unity 2018.4 7.3 .NET 4.x/Standard 2.0
Unity 2019.1 7.3 .NET 4.x/Standard 2.0
2018.3&#x304B;&#x3089;&#x4EE5;&#x4E0B;&#x306E;&#x8A00;&#x8A9E;&#x306B;&#x95A2;&#x3059;&#x308B;define&#x304C;&#x4F7F;&#x3048;&#x308B;
CSHARP_7_3_OR_NEWER
&#x4EE5;&#x4E0B;&#x306E;&#x3069;&#x3061;&#x3089;&#x304B;&#x9078;&#x3093;&#x3060;&#x307B;&#x3046;&#x304C;&#x5B9A;&#x7FA9;&#x3055;&#x308C;&#x308B;
NET_4_6
NET_STANDARD_2_0 </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-14-638.jpg?cb=1569478193"> 14. </a> Struct is important for Performance!
15
&#x2014; C# 7&#x4EE5;&#x964D;&#x306E;&#x6025;&#x901F;&#x306A;struct&#x5F37;&#x5316;&#x306F;&#x30D1;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30F3;&#x30B9;&#x306E;&#x305F;&#x3081;
&#x2014; &#x305D;&#x308C;&#x306F; .NET Core &#x3067;&#x3082;&#x3001;Unity&#x3067;&#x3082;
&#x2014; &#x30A2;&#x30D7;&#x30ED;&#x30FC;&#x30C1;&#x306F;&#x7570;&#x306A;&#x308C;&#x3069;&#x3001;&#x4E21;&#x8005;&#x3068;&#x3082;&#x69CB;&#x9020;&#x4F53;&#x3092;&#x30D1;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30F3;&#x30B9;&#x306E;&#x305F;&#x3081;&#x6D3B;&#x7528;&#x3057;&#x3066;&#x3044;&#x308B;
&#x2014; &#x7279;&#x306B;Unity&#x306E;&#x63A8;&#x3059;DOTS(Data Oriented Technology Stack)&#x306F;struct&#x306E;&#x584A;
&#x2014; &#x4ECA;&#x3001;&#x5168;&#x3066;&#x3092;&#x5B66;&#x3073;&#x3001;&#x5099;&#x3048;&#x3088;&#x3046;
public unsafe ref struct BlobBuilderArray&lt;T&gt;
where T : struct
public unsafe static ref T AsRef&lt;T&gt;(void* ptr) where T : struct
public readonly struct BuildComponentDataToEntityLookupTask&lt;TComponentData&gt; : IDisposable
where TComponentData : unmanaged, IComponentData, IEquatable&lt;TComponentData&gt;
Unity ECS&#x306E;&#x4E2D;&#x306E;
C# 7.3&#x8868;&#x73FE; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-15-638.jpg?cb=1569478193"> 15. </a> 16
The Basic of C# Memory </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-16-638.jpg?cb=1569478193"> 16. </a> The Memory of C#
17
AppDomain(Managed)
Thread
Stack
HeapThread
Stack
Unmanaged </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-17-638.jpg?cb=1569478193"> 17. </a> The Memory of C#
18
AppDomain(Managed)
Thread
Stack
HeapThread
Stack
Unmanaged
&#x30ED;&#x30FC;&#x30AB;&#x30EB;&#x5909;&#x6570;&#x306F;&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x9818;&#x57DF;&#x306B;&#x683C;&#x7D0D;&#x3055;&#x308C;&#x308B;
&#x30D2;&#x30FC;&#x30D7;&#x9818;&#x57DF;&#x306B;&#x78BA;&#x4FDD;&#x3055;&#x308C;&#x305F;&#x30C7;&#x30FC;&#x30BF;&#x306F;
GC&#x306E;&#x7BA1;&#x7406;&#x5316;&#x306B;&#x5165;&#x308B;
Unity&#x3067;&#x306F;C#&#x7BA1;&#x7406;&#x5916;&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x3092;&#x6271;&#x3046;
&#x3053;&#x3068;&#x3082;&#x3088;&#x304F;&#x3042;&#x308B;(&#x7279;&#x306B;DOTS) </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-18-638.jpg?cb=1569478193"> 18. </a> Let&#x2019;s see memory layout
19
&#x2014; SharpLab&#x3067;&#x30E1;&#x30E2;&#x30EA;&#x306E;&#x4E2D;&#x8EAB;&#x3092;&#x898B;&#x3088;&#x3046;&#xFF01;
&#x2014; https://sharplab.io/
&#x2014; C# to IL, C# to C#, C# to ASM&#x306A;&#x3069;&#x8C4A;&#x5BCC;&#x306A;&#x6A5F;&#x80FD;&#x304C;&#x3042;&#x308B;
&#x2014; Run &#x3068; Inspect&#x3092;&#x7D44;&#x307F;&#x5408;&#x308F;&#x305B;&#x308B;&#x3068;&#x30E1;&#x30E2;&#x30EA;&#x306E;&#x4E2D;&#x8EAB;&#x304C;&#x898B;&#x308C;&#x308B;
&#x306A;&#x304A;&#x3001;&#x7D44;&#x307F;&#x8FBC;&#x307F;&#x578B;&#x306E;&#x5834;&#x5408;&#x3001;Unity(mono)
&#x3068;SharpLab(.NET Core)&#x3067;&#x4E2D;&#x8EAB;&#x304C;&#x7570;&#x306A;&#x308B;
&#x3053;&#x3068;&#x304C;&#x3042;&#x308B;&#x5834;&#x5408;&#x306B;&#x6CE8;&#x610F; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-19-638.jpg?cb=1569478193"> 19. </a> Struct Memory
Int(4&#x30D0;&#x30A4;&#x30C8;)&#x306E;X, Y, Z(12&#x30D0;&#x30A4;&#x30C8;)&#x304C;
&#x7D20;&#x76F4;&#x306B;&#x30E1;&#x30E2;&#x30EA;&#x4E0A;(&#x30B9;&#x30BF;&#x30C3;&#x30AF;)&#x306B;&#x4E26;&#x3076; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-20-638.jpg?cb=1569478193"> 20. </a> Class Memory
&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x4E0A;&#x306E;&#x5909;&#x6570;&#x306F;&#x30D2;&#x30FC;&#x30D7;&#x4E0A;
&#x306E;&#x30A2;&#x30C9;&#x30EC;&#x30B9;&#x3092;&#x6307;&#x3059;
&#x30D2;&#x30FC;&#x30D7;&#x4E0A;&#x306B;&#x78BA;&#x4FDD;&#x3055;&#x308C;&#x308B;&#x30E1;&#x30E2;&#x30EA;&#x306F;&#x7BA1;&#x7406;
&#x7528;&#x306E;&#x30D8;&#x30C3;&#x30C0;/&#x578B;&#x60C5;&#x5831; + &#x5B9F;&#x30C7;&#x30FC;&#x30BF; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-21-638.jpg?cb=1569478193"> 21. </a> Pass by Reference/Pass by Value
22
&#x2014; C#&#x306F;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x306F;&#x5168;&#x3066;&#x300C;&#x5024;&#x6E21;&#x3057;&#x300D;
&#x2014; &#x3064;&#x307E;&#x308A;&#x30B3;&#x30D4;&#x30FC;&#x3055;&#x308C;&#x307E;&#x3059;
&#x2014; &#x30ED;&#x30FC;&#x30AB;&#x30EB;&#x5909;&#x6570;&#x3078;&#x306E;&#x4EE3;&#x5165;&#x3082;&#x30B3;&#x30D4;&#x30FC;
(T x) (ref T x)
class &#x53C2;&#x7167;&#x306E;&#x5024;&#x6E21;&#x3057; &#x53C2;&#x7167;&#x306E;&#x53C2;&#x7167;&#x6E21;&#x3057;
struct &#x5024;&#x306E;&#x5024;&#x6E21;&#x3057; &#x5024;&#x306E;&#x53C2;&#x7167;&#x6E21;&#x3057; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-22-638.jpg?cb=1569478193"> 22. </a> &#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x9818;&#x57DF;&#x306F;&#x5927;&#x4F53;&#x3053;&#x306E;&#x8FBA;&#x3063;&#x307D;&#x3044; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-23-638.jpg?cb=1569478193"> 23. </a> 00 00 00 00 &#x304B;&#x3089;&#x305D;&#x308C;&#x3063;&#x307D;
&#x3044;&#x30C7;&#x30FC;&#x30BF;&#x304C;&#x5165;&#x3063;&#x305F;&#x6C17;&#x914D; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-24-638.jpg?cb=1569478193"> 24. </a> &#x5F15;&#x304D;&#x7D9A;&#x304D;&#x3001; y = x &#x3067;&#x540C;&#x3058;&#x30C7;
&#x30FC;&#x30BF;&#x304C;&#x8FFD;&#x52A0;&#x3067;&#x5165;&#x3063;&#x305F;&#x3063;&#x307D;&#x3044; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-25-638.jpg?cb=1569478193"> 25. </a> &#x5225;&#x306E;&#x3068;&#x3053;&#x308D;&#x306B;x&#x3068;y&#x304C;&#x30B3;&#x30D4;&#x30FC;
&#x3055;&#x308C;&#x3066;&#x5165;&#x3063;&#x305F;&#x6C17;&#x914D; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-26-638.jpg?cb=1569478193"> 26. </a> &#x623B;&#x308A;&#x306E;z&#x3092;&#x53D7;&#x3051;&#x53D6;&#x3063;&#x3066;&#x5168;&#x90E8;
&#x57CB;&#x307E;&#x3063;&#x305F; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-27-638.jpg?cb=1569478193"> 27. </a> int x
int y
int z
&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x6642;(C# -&gt; IL)&#x306E;&#x6BB5;
&#x968E;&#x3067;&#x5909;&#x6570;&#x306E;&#x7F6E;&#x304D;&#x5834;&#x78BA;&#x4FDD;&#x3057;&#x3066;&#x304A;
&#x304D;&#x307E;&#x3059;&#x3001;&#x7684;&#x306A; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-28-638.jpg?cb=1569478193"> 28. </a> Struct&#x306E;&#x57FA;&#x672C;&#x7684;&#x306A;&#x539F;&#x5247;
29
&#x2014; &#x5168;&#x3066;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;
&#x2014; &#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306E;&#x9055;&#x3044;&#x3001;&#x307B;&#x3068;&#x3093;&#x3069;&#x306E;&#x554F;&#x984C;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x5F15;&#x304D;&#x8D77;&#x3053;&#x3055;&#x308C;&#x308B;
&#x2014; &#x5927;&#x304D;&#x306A;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; IntPtr.Size(4 or 8&#x30D0;&#x30A4;&#x30C8;)&#x4EE5;&#x4E0A;&#x306F;&#x53C2;&#x7167;&#x6E21;&#x3057;&#x306B;&#x6BD4;&#x3079;&#x3066;&#x5927;&#x304D;&#x3044;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;
&#x2013; &#x305D;&#x308C;&#x3060;&#x3068;&#x5236;&#x9650;&#x30AD;&#x30C4;&#x3059;&#x304E;&#x306A;&#x306E;&#x3067;&#x3001;&#x4E00;&#x822C;&#x306B;&#x306F;16&#x30D0;&#x30A4;&#x30C8;&#x4EE5;&#x4E0B;&#x3050;&#x3089;&#x3044;&#x3092;&#x76EE;&#x5B89;&#x306B;
&#x2014; &#x5909;&#x66F4;&#x53EF;&#x80FD;&#x306A;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; &#x30B3;&#x30D4;&#x30FC;&#x3055;&#x308C;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x3063;&#x3066;&#x3001;&#x5909;&#x66F4;&#x3057;&#x305F;&#x3064;&#x3082;&#x308A;&#x304C;&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;
&#x2013; &#x4E00;&#x5EA6;&#x306F;&#x60A9;&#x3080;Vector3&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;&#x554F;&#x984C; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-29-638.jpg?cb=1569478193"> 29. </a> Struct&#x306E;&#x57FA;&#x672C;&#x7684;&#x306A;&#x539F;&#x5247;
30
&#x2014; &#x5168;&#x3066;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;
&#x2014; &#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306E;&#x9055;&#x3044;&#x3001;&#x307B;&#x3068;&#x3093;&#x3069;&#x306E;&#x554F;&#x984C;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x5F15;&#x304D;&#x8D77;&#x3053;&#x3055;&#x308C;&#x308B;
&#x2014; &#x5927;&#x304D;&#x306A;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; IntPtr.Size(4 or 8&#x30D0;&#x30A4;&#x30C8;)&#x4EE5;&#x4E0A;&#x306F;&#x53C2;&#x7167;&#x6E21;&#x3057;&#x306B;&#x6BD4;&#x3079;&#x3066;&#x5927;&#x304D;&#x3044;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;
&#x2013; &#x305D;&#x308C;&#x3060;&#x3068;&#x5236;&#x9650;&#x30AD;&#x30C4;&#x3059;&#x304E;&#x306A;&#x306E;&#x3067;&#x3001;&#x4E00;&#x822C;&#x306B;&#x306F;16&#x30D0;&#x30A4;&#x30C8;&#x4EE5;&#x4E0B;&#x3050;&#x3089;&#x3044;&#x3092;&#x76EE;&#x5B89;&#x306B;
&#x2014; &#x5909;&#x66F4;&#x53EF;&#x80FD;&#x306A;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; &#x30B3;&#x30D4;&#x30FC;&#x3055;&#x308C;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x3063;&#x3066;&#x3001;&#x5909;&#x66F4;&#x3057;&#x305F;&#x3064;&#x3082;&#x308A;&#x304C;&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;
&#x2013; &#x4E00;&#x5EA6;&#x306F;&#x60A9;&#x3080;Vector3&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;&#x554F;&#x984C;
// position&#x5909;&#x3048;&#x305F;&#x3064;&#x3082;&#x308A;&#x304C;&#x5909;&#x308F;&#x3089;&#x306A;&#x3044;&#xFF01;
this.transform.position.Set(10f, 20f, 30f);
// &#x3064;&#x307E;&#x308A;&#x3053;&#x3046;&#x3044;&#x3046;&#x3053;&#x3068;&#x3060;&#x304B;&#x3089;
this.transform.INTERNAL_get_position(out Vector3 value);
value.Set(10f, 20f, 30f); </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-30-638.jpg?cb=1569478193"> 30. </a> Struct&#x306E;&#x57FA;&#x672C;&#x7684;&#x306A;&#x539F;&#x5247;
31
&#x2014; &#x5168;&#x3066;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;
&#x2014; &#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306E;&#x9055;&#x3044;&#x3001;&#x307B;&#x3068;&#x3093;&#x3069;&#x306E;&#x554F;&#x984C;&#x306F;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x5F15;&#x304D;&#x8D77;&#x3053;&#x3055;&#x308C;&#x308B;
&#x2014; &#x5927;&#x304D;&#x306A;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; IntPtr.Size(4 or 8&#x30D0;&#x30A4;&#x30C8;)&#x4EE5;&#x4E0A;&#x306F;&#x53C2;&#x7167;&#x6E21;&#x3057;&#x306B;&#x6BD4;&#x3079;&#x3066;&#x5927;&#x304D;&#x3044;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;
&#x2013; &#x305D;&#x308C;&#x3060;&#x3068;&#x5236;&#x9650;&#x30AD;&#x30C4;&#x3059;&#x304E;&#x306A;&#x306E;&#x3067;&#x3001;&#x4E00;&#x822C;&#x306B;&#x306F;16&#x30D0;&#x30A4;&#x30C8;&#x4EE5;&#x4E0B;&#x3050;&#x3089;&#x3044;&#x3092;&#x76EE;&#x5B89;&#x306B;
&#x2014; &#x5909;&#x66F4;&#x53EF;&#x80FD;&#x306A;&#x69CB;&#x9020;&#x4F53;&#x3092;&#xFF08;&#x57FA;&#x672C;&#x7684;&#x306B;&#x306F;&#xFF09;&#x4F5C;&#x3089;&#x306A;&#x3044;
&#x2013; &#x30B3;&#x30D4;&#x30FC;&#x3055;&#x308C;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x3063;&#x3066;&#x3001;&#x5909;&#x66F4;&#x3057;&#x305F;&#x3064;&#x3082;&#x308A;&#x304C;&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;
&#x2013; &#x4E00;&#x5EA6;&#x306F;&#x60A9;&#x3080;Vector3&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;&#x554F;&#x984C;
// position&#x5909;&#x3048;&#x305F;&#x3064;&#x3082;&#x308A;&#x304C;&#x5909;&#x308F;&#x3089;&#x306A;&#x3044;&#xFF01;
this.transform.position.Set(10f, 20f, 30f);
// &#x3064;&#x307E;&#x308A;&#x3053;&#x3046;&#x3044;&#x3046;&#x3053;&#x3068;&#x3060;&#x304B;&#x3089;
this.transform.INTERNAL_get_position(out Vector3 value);
value.Set(10f, 20f, 30f);
position&#x304C;&#x30D7;&#x30ED;&#x30D1;&#x30C6;&#x30A3;&#x306A;&#x306E;&#x304C;&#x60AA;&#x3044;
(&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30C9;&#x306A;&#x3089;&#x30B3;&#x30D4;&#x30FC;&#x306E;&#x554F;&#x984C;&#x306F;&#x8D77;&#x304D;&#x306A;&#x3044;)
&#x304C;&#x3001;&#x3053;&#x308C;&#x306F;transform&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x5B9F;&#x4F53;&#x306F;
&#x30A2;&#x30F3;&#x30DE;&#x30CD;&#x30FC;&#x30B8;&#x30C9;&#x30E1;&#x30E2;&#x30EA;&#x5074;(UnityEngine)&#x306B;&#x3042;&#x308B;
&#x305F;&#x3081;&#x3068;&#x3044;&#x3046;&#x3001;Unity&#x306A;&#x3089;&#x3067;&#x306F;&#x306E;&#x60A9;&#x307F;&#x3067;&#x3082;&#x3042;&#x308B;
(C#/C++&#x8D8A;&#x5883;&#x304C;&#x3069;&#x3046;&#x3057;&#x3066;&#x3082;&#x62B1;&#x3048;&#x308B;&#x8A71;) </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-31-638.jpg?cb=1569478193"> 31. </a> Boxed Struct
&#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x5316;
&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x4E0A;&#x306E;&#x5909;&#x6570;&#x306F;
&#x30D2;&#x30FC;&#x30D7;&#x306E;&#x30A2;&#x30C9;&#x30EC;&#x30B9; &#x30D2;&#x30FC;&#x30D7;&#x4E0A;&#x306B;&#x30AF;&#x30E9;&#x30B9;&#x3068;
&#x540C;&#x69D8;&#x30D8;&#x30C3;&#x30C0;&#x304C;&#x4ED8;&#x3044;&#x305F;
&#x3046;&#x3048;&#x3067;&#x9818;&#x57DF;&#x78BA;&#x4FDD;
&#x30A2;&#x30F3;&#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x306E;&#x6BCE;&#x306B;
&#x3053;&#x3053;&#x304B;&#x3089;&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x3078;
&#x30B3;&#x30D4;&#x30FC;&#x3059;&#x308B; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-32-638.jpg?cb=1569478193"> 32. </a> Box&#x5316;&#x3068;&#x306E;&#x6226;&#x3044;
33
&#x2014; &#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x5316;&#x306F;new&#x3068;&#x4E00;&#x7DD2;
&#x2014; &#x3080;&#x3057;&#x308D;&#x30A2;&#x30F3;&#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x306E;&#x983B;&#x5EA6;&#x7684;&#x306B;&#x3088;&#x308A;&#x60AA;&#x3044;
&#x2014; &#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x5316;&#x304C;&#x907F;&#x3051;&#x3089;&#x308C;&#x306A;&#x3044;&#x306A;&#x3089;&#x6700;&#x521D;&#x304B;&#x3089;&#x30AF;&#x30E9;&#x30B9;&#x3067;&#x4F5C;&#x308B;&#x3053;&#x3068;&#x3082;&#x9078;&#x629E;&#x80A2;
&#x2014; &#x30A4;&#x30F3;&#x30BF;&#x30FC;&#x30D5;&#x30A7;&#x30A4;&#x30B9;&#x3078;&#x306E;&#x30AD;&#x30E3;&#x30B9;&#x30C8;&#x306B;&#x6C17;&#x3092;&#x3064;&#x3051;&#x308B;
&#x2013; &#x30B8;&#x30A7;&#x30CD;&#x30EA;&#x30AF;&#x30B9;&#x3092;&#x4F7F;&#x3063;&#x3066;&#x56DE;&#x907F;&#x3057;&#x3066;&#x3044;&#x304F;
&#x2013; enum&#x306E;&#x5834;&#x5408;&#x306F;Enum(&#x53C2;&#x7167;&#x578B;)&#x3082;&#x540C;&#x69D8;
public static class BoxedInt
{
public static readonly object Zero = 0;
public static readonly object One = 1;
public static readonly object MinusOne = -1;
}
&#x3042;&#x308B;&#x7A0B;&#x5EA6;&#x6C7A;&#x307E;&#x3063;&#x305F;&#x5024;&#x304C;&#x983B;&#x7E41;&#x306B;&#x30DC;&#x30C3;
&#x30AF;&#x30B9;&#x5316;&#x3055;&#x308C;&#x308B;&#x3088;&#x3046;&#x306A;&#x3089;&#x3001;&#x5148;&#x306B;&#x4F5C;&#x3063;
&#x3066;&#x304A;&#x3044;&#x3066;&#x4F7F;&#x3044;&#x56DE;&#x3059;&#x3068;&#x3044;&#x3046;&#x6280; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-33-638.jpg?cb=1569478193"> 33. </a> Equals&#x306E;&#x81EA;&#x52D5;&#x5B9F;&#x88C5;&#x3068;Box&#x5316;
34
&#x2014; struct&#x306F;Equals&#x304C;&#x5B9F;&#x88C5;&#x3055;&#x308C;&#x3066;&#x3044;&#x306A;&#x3044;&#x5834;&#x5408;&#x3001;&#x81EA;&#x52D5;&#x7684;&#x306B;&#x4EE5;&#x4E0B;&#x306E;&#x3082;&#x306E;&#x304C;&#x547C;&#x3070;&#x308C;&#x308B;
&#x2014; &#x3081;&#x3063;&#x3061;&#x3083;&#x9045;&#x3044;
&#x2014; Equals&#x306F;&#x8F9E;&#x66F8;&#x306E;Key&#x306B;&#x3059;&#x308B;&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#xFF01;
&#x305D;&#x306E;&#x305F;&#x3081;&#x8F9E;&#x66F8;&#x306E;Key&#x306B;&#x3059;&#x308B;&#x69CB;&#x9020;&#x4F53;&#x306F;
IEquatable&lt;T&gt;&#x3068;GetHashCode&#x306E;
&#x30AB;&#x30B9;&#x30BF;&#x30E0;&#x5B9F;&#x88C5;&#x3092;&#x5FC5;&#x305A;&#x884C;&#x3046;&#x3053;&#x3068;
internal static bool DefaultEquals(object o1, object o2)
{
RuntimeType o1_type = (RuntimeType)o1.GetType();
RuntimeType o2_type = (RuntimeType)o2.GetType();
object[] fields;
InternalEquals(o1, o2, out fields);
for (int i = 0; i &lt; fields.Length; i += 2)
{
object meVal = fields[i];
object youVal = fields[i + 1];
if (!meVal.Equals(youVal)) return false;
}
return true;
}
object, object&#x6BD4;&#x8F03;&#x306E;&#x30DC;&#x30AF;&#x30B7;&#x30F3;&#x30B0;
&#x305D;&#x3082;&#x305D;&#x3082;&#x30EA;&#x30D5;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3;&#x3067;&#x5168;&#x30D5;&#x30A3;
&#x30FC;&#x30EB;&#x30C9;&#x6BD4;&#x8F03;&#xFF08;&#x9045;&#x3044;&#xFF09;&#x3046;&#x3048;&#x306B;&#x3001;&#x30D5;&#x30A3;
&#x30FC;&#x30EB;&#x30C9;&#x306E;&#x623B;&#x308A;&#x5024;&#x3082;&#x30DC;&#x30AF;&#x30B7;&#x30F3;&#x30B0;
&#x539F;&#x7406;&#x4E3B;&#x7FA9;&#x7684;&#x306B;&#x306F;&#x53EF;&#x80FD;&#x306A;&#x3082;&#x306E;&#x5168;&#x3066;&#x306E;Struct&#x306B;&#x30AB;&#x30B9;&#x30BF;&#x30E0;&#x5B9F;&#x88C5;&#x3092;&#x5165;
&#x308C;&#x305F;&#x307B;&#x3046;&#x304C;&#x3044;&#x3044;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;&#x3051;&#x308C;&#x3069;&#x3001;&#x3042;&#x307E;&#x308A;&#x306B;&#x3082;&#x9762;&#x5012;
&#x306A;&#x306E;&#x3067;&#x3001;&#x3055;&#x3059;&#x304C;&#x306B;&#x305D;&#x3053;&#x306F;&#x30D4;&#x30F3;&#x30DD;&#x30A4;&#x30F3;&#x30C8;(&#x8F9E;&#x66F8;&#x306E;Key&#x306B;&#x306A;&#x308B;&#x3082;&#x306E;
&#x3060;&#x3051;)&#x3067;&#x3044;&#x3044;&#x3068;&#x601D;&#x3044;&#x307E;&#x3059; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-34-638.jpg?cb=1569478193"> 34. </a> Struct Layout and Padding
&#x5358;&#x7D14;&#x8A08;&#x7B97;&#x3067;&#x306F;byte(1) + long(8) + int(4) = 13&#x3067;&#x3059;&#x304C;&#x3001;
&#x30A2;&#x30E9;&#x30A4;&#x30F3;&#x30E1;&#x30F3;&#x30C8;&#x8ABF;&#x6574;&#x306E;&#x305F;&#x3081;&#x3001;&#x6700;&#x9577;&#x306E;8&#x306B;&#x305D;&#x308C;&#x305E;&#x308C;&#x304C;&#x5408;
&#x308F;&#x305B;&#x3089;&#x308C;&#x3066;8 * 3 = 24&#x30D0;&#x30A4;&#x30C8;&#x306E;&#x78BA;&#x4FDD;&#x306B;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-35-638.jpg?cb=1569478193"> 35. </a> Struct Layout and Padding StructLayout&#x3084;FieldOffset&#x306B;&#x3088;&#x3063;&#x3066;&#x30EC;&#x30A4;&#x30A2;&#x30A6;
&#x30C8;&#x306F;&#x30AB;&#x30B9;&#x30BF;&#x30DE;&#x30A4;&#x30BA;&#x53EF;&#x80FD;&#x3002;
struct&#x306E;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x306F;Sequential(&#x5BA3;&#x8A00;&#x9806;)
Auto&#x306B;&#x5909;&#x3048;&#x308B;&#x3068;&#x3001;Z&#x3068;X&#x304C;&#x8A70;&#x3081;&#x3089;&#x308C;&#x308B;&#x3053;&#x3068;&#x3067;&#x6700;
&#x5C0F;&#x306E;16&#x30D0;&#x30A4;&#x30C8;&#x306B;&#x7E2E;&#x3080;
&#x53C2;&#x7167;&#x578B;&#x306F;struct&#x3068;&#x7570;&#x306A;&#x308A;&#x30C7;&#x30D5;&#x30A9;
&#x30EB;&#x30C8;&#x304C;Auto </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-36-638.jpg?cb=1569478193"> 36. </a> Heap Layout: Array
&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x306E;&#x5171;&#x901A;&#x30D8;&#x30C3;&#x30C0;&#x306E;&#x5F8C;
&#x308D;&#x306B;&#x9577;&#x3055;&#x304C;&#x4ED8;&#x3044;&#x3066;&#x308B;
&#x30C7;&#x30FC;&#x30BF;&#x9818;&#x57DF;&#x306B;&#x306F;&#x8981;&#x7D20;&#x304C;&#x305D;&#x306E;&#x307E;&#x307E;&#x9806;&#x756A;&#x306B;&#x4E26;&#x3076;&#x3002;&#x69CB;&#x9020;&#x4F53;&#x306A;
&#x3089;&#x3001;&#x5024;&#x304C;&#x305D;&#x306E;&#x307E;&#x307E;&#x9806;&#x756A;&#x306B;&#x4E26;&#x3093;&#x3067;&#x3044;&#x308B;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;&#xFF08;&#x53C2;&#x7167;
&#x578B;&#x306E;&#x5834;&#x5408;&#x306F;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x304C;&#x4E26;&#x3093;&#x3067;&#x3044;&#x308B;&#x305F;&#x3081;&#x3001;&#x5B9F;&#x614B;&#x306E;&#x30C7;&#x30FC;&#x30BF;
&#x3092;&#x66F4;&#x306B;&#x8FBF;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;&#xFF09; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-37-638.jpg?cb=1569478193"> 37. </a> 38
ref and readonly </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-38-638.jpg?cb=1569478193"> 38. </a> Zero Allocation foreach in List&lt;T&gt;
39
&#x2014; foreach&#x306F; .GetEnumerator -&gt; while(MoveNext()) &#x306B;&#x5909;&#x63DB;&#x3055;&#x308C;&#x308B;
&#x2014; &#xFF08;&#x305F;&#x3060;&#x3057;&#x914D;&#x5217;&#x306E;&#x5834;&#x5408;&#x306F;&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x6642;&#x306B;IL&#x3067;for&#x306B;&#x5909;&#x63DB;&#x3055;&#x308C;&#x308B;&#xFF09;
&#x2014; &#x3064;&#x307E;&#x308A; IEnumerator &#x304C;&#x751F;&#x6210;&#x3055;&#x308C;&#x3066;&#x30D2;&#x30FC;&#x30D7;&#x306B;&#x78BA;&#x4FDD;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#xFF1F;
&#x2014; &#x3055;&#x308C;&#x308B;&#x3088;&#x3046;&#x3067;&#x3055;&#x308C;&#x306A;&#x3044;
var list = new List&lt;int&gt;() { 1, 2, 3 };
foreach (var item in list)
{
/* do anything */
} </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-39-638.jpg?cb=1569478193"> 39. </a> Mutable Struct is Evil but Useful
40
&#x2014; &#x4E00;&#x6642;&#x7684;&#x306A;&#x5165;&#x308C;&#x7269;&#x3068;&#x3057;&#x3066;&#x4F7F;&#x3046;&#x3082;&#x306E;&#x306B;&#x5411;&#x3044;&#x3066;&#x308B;
public struct Enumerator : IEnumerator&lt;T&gt;
{
List&lt;T&gt; list;
int index;
int version;
T current;
}
public struct BinaryReader
{
byte[] bytes;
int offset;
}
List&lt;T&gt;&#x306F;&#x76F4;&#x63A5;GetEnumerator&#x3092;&#x547C;&#x3079;&#x308B;
&#x72B6;&#x6CC1;&#x3067;&#x306F;struct List&lt;T&gt;.Enumerator &#x3092;
&#x8FD4;&#x3059;&#x305F;&#x3081;&#x30BC;&#x30ED;&#x30A2;&#x30ED;&#x30B1;&#x30FC;&#x30B7;&#x30E7;&#x30F3;
&#x30D0;&#x30A4;&#x30CA;&#x30EA;&#x3092;&#x8AAD;&#x307F;&#x3059;&#x3059;&#x3081;&#x308B;&#x969B;&#x306B;ReadXxx
&#x3092;&#x547C;&#x3076;&#x305F;&#x3073;&#x306B;offset&#x3092;&#x8FFD;&#x52A0;&#x3057;&#x3066;&#x3044;&#x304F;&#x3068;&#x3044;
&#x3046;&#x30B9;&#x30C6;&#x30FC;&#x30C8;&#x3092;&#x7BA1;&#x7406;
&#x5C40;&#x6240;&#x7684;&#x306B;&#x3057;&#x304B;&#x4F7F;&#x308F;&#x306A;&#x3044;&#x306E;&#x3067;
class&#x3058;&#x3083;&#x306A;&#x304F;&#x3066;&#x3082;&#x3044;&#x3044; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-40-638.jpg?cb=1569478193"> 40. </a> ref struct
41
&#x2014; &#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x306B;&#x3057;&#x304B;&#x7F6E;&#x3051;&#x306A;&#x3044;&#x3068;&#x3044;&#x3046;&#x5236;&#x7D04;&#x304C;ref struct
&#x2013; &#x5143;&#x3005;&#x306F;Span&lt;T&gt;(System.Memory, .NET Standard 2.0&#x5916;&#x90E8;&#x30E9;&#x30A4;&#x30D6;&#x30E9;&#x30EA;)&#x306E;&#x305F;&#x3081;
&#x2013; Span&lt;T&gt;&#x306F;&#x9023;&#x7D9A;&#x3057;&#x305F;&#x30E1;&#x30E2;&#x30EA;&#x9818;&#x57DF;&#x306E;&#x30D3;&#x30E5;&#x30FC;&#x3067;&#x3001;&#x914D;&#x5217;&#x306E;&#x3088;&#x3046;&#x306B;&#x6271;&#x3048;&#x308B;(NativeArray&#x307F;&#x305F;&#x3044;&#x306A;)
&#x2013; &#x4ECA;&#x307E;&#x3067;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x3067;&#x3057;&#x304B;&#x6271;&#x3048;&#x306A;&#x304B;&#x3063;&#x305F;stackalloc&#x3092;&#x81EA;&#x7136;&#x306B;&#x6271;&#x3048;&#x3066;&#x4FBF;&#x5229;
&#x2013; &#x3057;&#x304B;&#x3057;&#x305D;&#x308C;&#x306B;&#x3088;&#x3063;&#x3066;&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x306B;&#x306E;&#x307F;&#x78BA;&#x4FDD;&#x3057;&#x305F;&#x30E1;&#x30E2;&#x30EA;&#x9818;&#x57DF;&#x3092;&#x30D2;&#x30FC;&#x30D7;&#x306B;&#x79FB;&#x3055;&#x308C;&#x308B;&#x3068;&#x5371;&#x967A;
&#x2013; &#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30C9;&#x306B;&#x7F6E;&#x3051;&#x306A;&#x3044;(ref struct&#x306E;field&#x306E;&#x5834;&#x5408;&#x306E;&#x307F;&#x53EF;)&#x3001;&#x30DC;&#x30AF;&#x30B7;&#x30F3;&#x30B0;&#x3067;&#x304D;&#x306A;&#x3044;&#x3001;&#x30A4;&#x30F3;&#x30BF;&#x30FC;&#x30D5;
&#x30A7;&#x30A4;&#x30B9;&#x3092;&#x5B9F;&#x88C5;&#x3067;&#x304D;&#x306A;&#x3044;&#x3001;&#x30B8;&#x30A7;&#x30CD;&#x30EA;&#x30AF;&#x30B9;&#x306E;&#x578B;&#x5F15;&#x6570;&#x306B;&#x3067;&#x304D;&#x306A;&#x3044;&#x3001;&#x306A;&#x3069;&#x306E;&#x5236;&#x7D04;&#x304C;&#x3042;&#x308B;
&#x2014; &#x30D3;&#x30E5;&#x30FC;&#x7684;&#x306A;&#x3082;&#x306E;&#x3084;&#x4E00;&#x6642;&#x7684;&#x306B;&#x3057;&#x304B;&#x4F7F;&#x308F;&#x306A;&#x3044;&#x72B6;&#x614B;&#x3092;&#x6301;&#x3064;&#x3082;&#x306E;&#x306B;&#x306F;&#x9069;&#x7528;&#x3057;&#x3084;&#x3059;&#x3044;
&#x2013; &#x5236;&#x7D04;&#x304C;&#x591A;&#x3044;&#x306E;&#x3067;&#x7121;&#x7406;&#x306B;&#x4F7F;&#x304A;&#x3046;&#x3068;&#x3059;&#x308B;&#x3068;&#x30CF;&#x30DE;&#x308A;&#x307E;&#x3059;&#x304C;&#x2026;&#x2026;
Span&lt;int&gt; temp = stackalloc int[12]; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-41-638.jpg?cb=1569478193"> 41. </a> internal ref struct TempList&lt;T&gt;
{
int index;
T[] array;
public ReadOnlySpan&lt;T&gt; Span =&gt; new ReadOnlySpan&lt;T&gt;(array, 0, index);
public TempList(int initialCapacity)
{
this.array = ArrayPool&lt;T&gt;.Shared.Rent(initialCapacity);
this.index = 0;
}
public void Add(T value)
{
if (array.Length &lt;= index)
{
var newArray = ArrayPool&lt;T&gt;.Shared.Rent(index * 2);
Array.Copy(array, newArray, index);
ArrayPool&lt;T&gt;.Shared.Return(array, true);
array = newArray;
}
array[index++] = value;
}
public void Dispose()
{
ArrayPool&lt;T&gt;.Shared.Return(array, true); // clear for de-reference all.
}
}
ArrayPool(System.Buffers, Unity&#x3067;
&#x306F;&#x4F3C;&#x305F;&#x3088;&#x3046;&#x306A;&#x3082;&#x306E;&#x3092;&#x81EA;&#x4F5C;&#x3059;&#x308C;&#x3070;&#x2026;&#x2026;)
&#x304B;&#x3089;&#x78BA;&#x4FDD;&#x6E08;&#x307F;&#x914D;&#x5217;&#x3092;&#x53D6;&#x5F97;&#x3057;&#x4F7F;&#x3046;
Dispose&#x3067;&#x8FD4;&#x5374;
&#x4E00;&#x6642;&#x7684;&#x306B;&#x3057;&#x304B;&#x4F7F;&#x308F;&#x306A;&#x3044;&#x914D;
&#x5217;&#x3092;&#x90FD;&#x5EA6;&#x78BA;&#x4FDD;&#x305B;&#x305A;&#x30D7;&#x30FC;&#x30EB;
&#x304B;&#x3089;&#x53D6;&#x5F97;&#x3059;&#x308B;&#x305F;&#x3081;&#x306E;&#x69CB;&#x9020;
(TempList&lt;T&gt;)
&#x30D7;&#x30FC;&#x30EB;&#x3092;&#x6271;&#x3063;&#x3066;&#x3044;&#x308B;&#x306E;&#x3067;&#x3001;
&#x5BFF;&#x547D;&#x306F;&#x660E;&#x78BA;&#x306B;&#x77ED;&#x304F;&#x3042;&#x3063;&#x3066;
&#x307B;&#x3057;&#x3044;&#x306E;&#x3067;ref struct </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-42-638.jpg?cb=1569478193"> 42. </a> public void DoNanika(IEnumerable&lt;int&gt; idList)
{
var resources = idList.Select(x =&gt; Load(x));
// LINQ&#x306E;&#x9045;&#x5EF6;&#x5B9F;&#x884C;&#x306B;&#x3088;&#x308A;&#x4E8C;&#x56DE;&#x306E;Load&#x304C;&#x8D70;&#x3063;&#x3066;&#x3057;&#x307E;&#x3046;
// &#x305D;&#x308C;&#x3092;&#x907F;&#x3051;&#x308B;&#x305F;&#x3081;&#x306B; .ToList() &#x3059;&#x308B;&#x3068;&#x305D;&#x308C;&#x306F;&#x305D;&#x308C;&#x3067;List&#x306E;&#x7121;&#x99C4;&#x3092;&#x611F;&#x3058;&#x308B;
foreach (var item in resources) { /* nanika suru 1 */ }
foreach (var item in resources) { /* nanika suru 2 */ }
}
public void DoNanika(IEnumerable&lt;int&gt; idList)
{
using var resources = idList.Select(x =&gt; Load(x)).ToTempList();
foreach (var item in resources) { /* nanika suru 1 */ }
foreach (var item in resources) { /* nanika suru 2 */ }
}
using&#x3060;&#x3051;&#x3067;&#x672B;&#x5C3E;&#x3067;
Dispose&#x304C;&#x4FBF;&#x5229;
(C# 8.0&#x304B;&#x3089;&#xFF01;
Unity&#x3067;&#x306F;&#x307E;&#x3060;&#xFF01;)
&#x3053;&#x3053;&#x306E;&#x4E2D;&#x3060;&#x3051;&#x3067;&#x4F7F;&#x3046;&#x4E00;&#x6642;&#x914D;&#x5217;&#x306F;Pool&#x304B;&#x3089;
&#x53D6;&#x3063;&#x3066;&#x308B;&#x306E;&#x3067;&#x30A2;&#x30ED;&#x30B1;&#x30FC;&#x30C8;&#x306A;&#x3057;&#x3067;&#x6E08;&#x3093;&#x3060; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-43-638.jpg?cb=1569478193"> 43. </a> Avoid the copy, Everywhere
44
&#x2014; &#x5168;&#x3066; ref &#x3067;&#x5F15;&#x304D;&#x56DE;&#x305B;&#x3070;&#x3044;&#x3044;&#x3001;&#x3068;&#x306F;&#x3044;&#x3046;&#x3082;&#x306E;&#x306E;&#x73FE;&#x5B9F;&#x7684;&#x3067;&#x306F;&#x306A;&#x3044;
&#x2014; &#x3042;&#x307E;&#x308A;&#x306B;&#x3082;&#x6700;&#x60AA;&#x306A;&#x66F8;&#x304D;&#x5FC3;&#x5730;&#x306B;&#x306A;&#x308B;&#xFF01;
&#x2014; &#x3042;&#x308B;&#x3044;&#x306F;&#x5168;&#x3066;unsafe&#x3067;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x3067;&#x53D6;&#x308A;&#x56DE;&#x3059;&#x3068;&#x3044;&#x3046;&#x624B;&#x3082;&#x2026;&#x2026;
&#x2014; Unity.Entities&#x306E;&#x30BD;&#x30FC;&#x30B9;&#x30B3;&#x30FC;&#x30C9;&#x306F;&#x304B;&#x306A;&#x308A;&#x305D;&#x308C;&#x306B;&#x8FD1;&#x3044;
[StructLayout(LayoutKind.Sequential)]
internal unsafe struct Archetype
{
public ArchetypeChunkData Chunks;
public UnsafeChunkPtrList ChunksWithEmptySlots;
public ChunkListMap FreeChunksBySharedComponents;
public int EntityCount;
public int ChunkCapacity;
public int BytesPerInstance;
public ComponentTypeInArchetype* Types;
public int TypesCount;
public int NonZeroSizedTypesCount;
public int* Offsets;
public int* SizeOfs;
public int* BufferCapacities;
public int* TypeMemoryOrder;
public int* ManagedArrayOffset;
public int NumManagedArrays;
// ... &#x307E;&#x3060;&#x307E;&#x3060;&#x3044;&#x3063;&#x3071;&#x3044;
void AddArchetypeIfMatching(
Archetype* archetype,
EntityQueryData* query)
(ECS&#x3088;&#x308A;&#x5F15;&#x7528;)&#x3068;&#x306B;&#x304B;&#x304F;&#x5DE8;&#x5927;&#x306A;Struct
&#x5168;&#x90E8;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x3067;&#x5F15;&#x304D;&#x56DE;&#x3059;&#x304B;&#x3089;OK(&#xFF1F;)
&#xFF08;ECS&#x306F;&#x30CD;&#x30A4;&#x30C6;&#x30A3;&#x30D6;&#x30E1;&#x30E2;&#x30EA;&#x3092;&#x4F7F;&#x3063;&#x305F;&#x308A;&#x8272;&#x3005;
&#x3068;&#x56FA;&#x6709;&#x306E;&#x4E8B;&#x60C5;&#x304C;&#x3042;&#x308B;&#x306E;&#x3067;&#x4E00;&#x822C;&#x8AD6;&#x306F;&#x9069;&#x7528;&#x3067;
&#x304D;&#x306A;&#x3044;&#xFF09; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-44-638.jpg?cb=1569478193"> 44. </a> static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, Everywhere
45
&#x305D;&#x3053;&#x3067;&#x767B;&#x5834;&#x3059;&#x308B;&#x306E;&#x304C;&#x65B0;&#x3057;&#x3044;&#x30AD;&#x30FC;&#x30EF;&#x30FC;&#x30C9;
&#x201C;in&#x201D;
(&#x3053;&#x306E;&#x30B3;&#x30FC;&#x30C9;&#x4F8B;&#x81EA;&#x4F53;&#x306B;&#x306F;&#x4F55;&#x306E;&#x610F;&#x5473;&#x3082;&#x306A;&#x3044;&#x3067;&#x3059;) </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-45-638.jpg?cb=1569478193"> 45. </a> static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, Everywhere
46
Normal(v3);
In(v3);
Ref(ref v3);
&#x547C;&#x3073;&#x5074;&#x306E;&#x30B3;&#x30FC;&#x30C9; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-46-638.jpg?cb=1569478193"> 46. </a> static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, Everywhere
47
ldloc.0
call Noraml
ldloca.0
call In
ldloca.0
call Ref
Normal(v3);
In(v3);
Ref(ref v3);
&#x547C;&#x3073;&#x5074;&#x306E;IL </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-47-638.jpg?cb=1569478193"> 47. </a> static void Normal(Vector3 v3)
{
}
static void In(in Vector3 v3)
{
}
static void Ref(ref Vector3 v3)
{
}
Avoid the copy, Everywhere
48
ldloc.0
call Noraml
ldloca.0
call In
ldloca.0
call Ref
&#x547C;&#x3073;&#x65B9;&#x306F;&#x666E;&#x901A;&#x3068;&#x4E00;&#x7DD2;&#x306A;&#x306E;&#x306B;
ref&#x3068;&#x540C;&#x3058;&#x304F;&#x53C2;&#x7167;&#x6E21;&#x3057;&#x3055;&#x308C;&#x308B;&#xFF01;
Normal(v3);
In(v3);
Ref(ref v3);
&#x3058;&#x3083;&#x3042;&#x5168;&#x90E8; in &#x3067;&#x3044;&#x3044;&#x306D;&#xFF01;
&#xFF08;&#x306B;&#x306F;&#x306A;&#x3089;&#x306A;&#x3044;&#xFF09; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-48-638.jpg?cb=1569478193"> 48. </a> static void Normal(Vector3 v3)
{
_ = v3.magnitude;
}
static void In(in Vector3 v3)
{
_ = v3.magnitude;
}
static void Ref(ref Vector3 v3)
{
_ = v3.magnitude;
}
Avoid the copy, Everywhere
49
ldarga.0
call get_magnitude
ldarg.0
ldobj
stloc.0
ldloca.0
call get_magnitude
ldarg.0
call get_magnitude
&#x547C;&#x3070;&#x308C;&#x5074;&#x306E;IL </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-49-638.jpg?cb=1569478193"> 49. </a> static void Normal(Vector3 v3)
{
_ = v3.magnitude;
}
static void In(in Vector3 v3)
{
_ = v3.magnitude;
}
static void Ref(ref Vector3 v3)
{
_ = v3.magnitude;
}
Avoid the copy, Everywhere
50
ldarga.0
call get_magnitude
ldarg.0
ldobj
stloc.0
ldloca.0
call get_magnitude
ldarg.0
call get_magnitude
&#x547C;&#x3070;&#x308C;&#x5074;&#x306E;IL
&#x30B3;&#x30D4;&#x30FC;&#x3055;&#x308C;&#x3066;&#x308B;&#xFF08;&#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#xFF09;
var v3_2 = v3;
_ = v3_2.magnitude; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-50-638.jpg?cb=1569478193"> 50. </a> static void Normal(Vector3 v3)
{
_ = v3.magnitude;
_ = v3.magnitude;
}
static void In(in Vector3 v3)
{
_ = v3.magnitude;
_ = v3.magnitude;
}
static void Ref(ref Vector3 v3)
{
_ = v3.magnitude;
_ = v3.magnitude;
}
Avoid the copy, Everywhere
51
ldarga.0
call get_magnitude
ldarg.0
ldobj
stloc.0
ldloca.0
call get_magnitude
ldarg.0
call get_magnitude
&#x547C;&#x3070;&#x308C;&#x5074;&#x306E;IL
&#x4E8C;&#x56DE;&#x547C;&#x3079;&#x3070;&#x30B3;&#x30D4;&#x30FC;&#x3082;&#x305D;&#x306E;&#x307E;&#x307E;&#x4E8C;&#x3064;
ldarga.0
call get_magnitude
ldarg.0
ldobj
stloc.0
ldloca.0
call get_magnitude
ldarg.0
call get_magnitude </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-51-638.jpg?cb=1569478193"> 51. </a> Best practice to use `in`
52
&#x2014; in &#x306F;&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x3059;&#x308B;&#x3068;([In][IsReadOnly]ref T t) &#x306B;&#x306A;&#x308B;
&#x2014; &#x8AAD;&#x307F;&#x53D6;&#x308A;&#x5C02;&#x7528;&#x306E;&#x305F;&#x3081;&#x3001;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30C9;&#x3078;&#x306E;&#x4EE3;&#x5165;&#x306F;&#x3067;&#x304D;&#x306A;&#x3044;
&#x2014; v3.x = 10.0f; // compile error
&#x2014; &#x30E1;&#x30BD;&#x30C3;&#x30C9;&#x547C;&#x3073;&#x51FA;&#x3057;&#x306F;&#x53EF;&#x80FD;&#x3060;&#x304C;&#x3001;&#x4E2D;&#x8EAB;&#x304C;&#x5909;&#x308F;&#x3089;&#x306A;&#x3044;&#x4FDD;&#x8A3C;&#x304C;&#x306A;&#x3044;&#x305F;&#x3081;&#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x304C;&#x8D70;&#x308B;
&#x2014; &#x305D;&#x306E;&#x305F;&#x3081;&#x3001;&#x3046;&#x304B;&#x3064;&#x306B;&#x591A;&#x7528;&#x3059;&#x308B;&#x3068;&#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x3001;&#x3080;&#x3057;&#x308D;&#x6027;&#x80FD;&#x4F4E;&#x4E0B;&#x3082;&#x3042;&#x308A;&#x3046;&#x308B;
&#x2014; &#x3082;&#x3057;&#x305D;&#x308C;&#x304C;Mutable Struct&#x3060;&#x3068;&#x3082;&#x306F;&#x3084;&#x308F;&#x3051;&#x308F;&#x304B;&#x3089;&#x306A;&#x3044;&#x3053;&#x3068;&#x306B;
&#x2014; (Vector3.magnitude&#x306F;&#x30D7;&#x30ED;&#x30D1;&#x30C6;&#x30A3;&#x306A;&#x306E;&#x3067;&#x30E1;&#x30BD;&#x30C3;&#x30C9;&#x6271;&#x3044;)
&#x2014; &#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x304C;&#x8D70;&#x3089;&#x306A;&#x3044;&#x6761;&#x4EF6;&#x306F;
&#x2013; &#x30D7;&#x30ED;&#x30D1;&#x30C6;&#x30A3;/&#x30E1;&#x30BD;&#x30C3;&#x30C9;&#x3092;&#x547C;&#x3070;&#x306A;&#x3044;&#x3053;&#x3068;
&#x2013; &#x3042;&#x308B;&#x3044;&#x306F; readonly struct &#x3067;&#x3042;&#x308B;&#x3053;&#x3068;
&#x2013; readonly struct&#x306F;&#x66F8;&#x304D;&#x63DB;&#x308F;&#x3089;&#x306A;&#x3044;&#x3053;&#x3068;&#x304C;&#x4FDD;&#x8A3C;&#x3055;&#x308C;&#x308B;&#x305F;&#x3081;&#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x304C;&#x8D70;&#x3089;&#x306A;&#x3044; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-52-638.jpg?cb=1569478193"> 52. </a> Best practice to use `in`
53
&#x2014; in &#x306F;&#x30B3;&#x30F3;&#x30D1;&#x30A4;&#x30EB;&#x3059;&#x308B;&#x3068;([In][IsReadOnly]ref T t) &#x306B;&#x306A;&#x308B;
&#x2014; &#x8AAD;&#x307F;&#x53D6;&#x308A;&#x5C02;&#x7528;&#x306E;&#x305F;&#x3081;&#x3001;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30C9;&#x3078;&#x306E;&#x4EE3;&#x5165;&#x306F;&#x3067;&#x304D;&#x306A;&#x3044;
&#x2014; v3.x = 10.0f; // compile error
&#x2014; &#x30E1;&#x30BD;&#x30C3;&#x30C9;&#x547C;&#x3073;&#x51FA;&#x3057;&#x306F;&#x53EF;&#x80FD;&#x3060;&#x304C;&#x3001;&#x4E2D;&#x8EAB;&#x304C;&#x5909;&#x308F;&#x3089;&#x306A;&#x3044;&#x4FDD;&#x8A3C;&#x304C;&#x306A;&#x3044;&#x305F;&#x3081;&#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x304C;&#x8D70;&#x308B;
&#x2014; &#x305D;&#x306E;&#x305F;&#x3081;&#x3001;&#x3046;&#x304B;&#x3064;&#x306B;&#x591A;&#x7528;&#x3059;&#x308B;&#x3068;&#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x306B;&#x3088;&#x308A;&#x3001;&#x3080;&#x3057;&#x308D;&#x6027;&#x80FD;&#x4F4E;&#x4E0B;&#x3082;&#x3042;&#x308A;&#x3046;&#x308B;
&#x2014; &#x3082;&#x3057;&#x305D;&#x308C;&#x304C;Mutable Struct&#x3060;&#x3068;&#x3082;&#x306F;&#x3084;&#x308F;&#x3051;&#x308F;&#x304B;&#x3089;&#x306A;&#x3044;&#x3053;&#x3068;&#x306B;
&#x2014; &#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x304C;&#x8D70;&#x3089;&#x306A;&#x3044;&#x6761;&#x4EF6;&#x306F;
&#x2013; &#x30D7;&#x30ED;&#x30D1;&#x30C6;&#x30A3;/&#x30E1;&#x30BD;&#x30C3;&#x30C9;&#x3092;&#x547C;&#x3070;&#x306A;&#x3044;&#x3053;&#x3068;
&#x2013; &#x3042;&#x308B;&#x3044;&#x306F; readonly struct &#x3067;&#x3042;&#x308B;&#x3053;&#x3068;
&#x2013; readonly struct&#x306F;&#x66F8;&#x304D;&#x63DB;&#x308F;&#x3089;&#x306A;&#x3044;&#x3053;&#x3068;&#x304C;&#x4FDD;&#x8A3C;&#x3055;&#x308C;&#x308B;&#x305F;&#x3081;&#x9632;&#x5FA1;&#x7684;&#x30B3;&#x30D4;&#x30FC;&#x304C;&#x8D70;&#x3089;&#x306A;&#x3044;
public readonly struct MyVector3
{
public readonly float x;
public readonly float y;
public readonly float z;
public MyVector3(float x, float y, float z)
{
this.x = x; this.y = y; this.z = z;
}
readonly struct&#x306E;&#x6761;&#x4EF6;&#x306F;&#x5168;&#x3066;&#x306E;&#x30D5;&#x30A3;
&#x30FC;&#x30EB;&#x30C9;&#x304C;readonly&#x3067;&#x3042;&#x308B;&#x3053;&#x3068;
ref readonly struct&#x3082;OK
&#x539F;&#x5247;in&#x306E;&#x5F15;&#x6570;&#x306F;readonly struct
&#x4E2D;&#x3067;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x30C9;&#x3057;&#x304B;&#x7D76;&#x5BFE;&#x89E6;&#x3089;&#x306A;&#x3044;&#x3068;&#x529B;
&#x5F37;&#x304F;&#x8A00;&#x3048;&#x308B;&#x306A;&#x3089;&#x30CA;&#x30B7;&#x3067;&#x306F;&#x306A;&#x3044;
&#x3088;&#x304F;&#x308F;&#x304B;&#x3089;&#x306A;&#x3044;&#x306A;&#x3089;&#x57FA;&#x672C;&#x4F7F;&#x308F;&#x306A;&#x3044; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-53-638.jpg?cb=1569478193"> 53. </a> readonly field(struct)&#x306E;&#x7F60;
54
&#x2014; readonly&#x306A;field&#x306E;struct&#x306B;mutable&#x306A;&#x64CD;&#x4F5C;&#x3092;&#x884C;&#x3063;&#x3066;&#x3082;&#x5909;&#x66F4;&#x3055;&#x308C;&#x306A;&#x3044;
&#x2014; &#x3088;&#x3063;&#x3066;&#x3001;&#x30DF;&#x30E5;&#x30FC;&#x30BF;&#x30D6;&#x30EB;&#x306A;&#x64CD;&#x4F5C;&#x3092;&#x884C;&#x3046;&#x3082;&#x306E;&#x306F;readonly field&#x306B;&#x3059;&#x3079;&#x304D;&#x3067;&#x306F;&#x306A;&#x3044;
&#x2014; &#x539F;&#x5247;&#x7684;&#x306B;&#x306F;&#x300C;&#x53EF;&#x80FD;&#x306A;&#x3082;&#x306E;&#x306F;&#x300D;&#x3068;&#x8A00;&#x3044;&#x305F;&#x3044;&#x3068;&#x3053;&#x308D;&#x3060;&#x3051;&#x3069;
Unity&#x306E;&#x5834;&#x5408;&#x3001;&#x53EF;&#x80FD;&#x306A;&#x3082;&#x306E;&#x304C;&#x591A;&#x3044;&#x306E;&#x3067;&#x2026;&#x2026;
public class NantokaBehaviour : MonoBehaviour
{
public readonly Vector3 NanikanoVector3;
public void Incr()
{
NanikanoVector3.Set(
NanikanoVector3.x + 1f,
NanikanoVector3.y + 1f,
NanikanoVector3.z + 1f);
}
}
&#x4F55;&#x56DE;Incr&#x547C;&#x3093;&#x3067;&#x3082;0, 0, 0&#x306E;&#x307E;&#x307E; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-54-638.jpg?cb=1569478193"> 54. </a> 55
Manipulate Memory </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-55-638.jpg?cb=1569478193"> 55. </a> &#x6539;&#x3081;&#x3066;Struct&#x3068;&#x306F;
56
&#x2014; &#x30E1;&#x30E2;&#x30EA;&#x3092;&#x5358;&#x7D14;&#x306B;&#x30DE;&#x30C3;&#x30D4;&#x30F3;&#x30B0;&#x3057;&#x305F;&#x69CB;&#x9020;
&#x2013; &#x305D;&#x306E;&#x3053;&#x3068;&#x3060;&#x3051;&#x610F;&#x8B58;&#x3059;&#x308C;&#x3070;&#x3001;&#x3042;&#x3068;&#x306F;&#x3084;&#x308A;&#x305F;&#x3044;&#x653E;&#x984C;&#x3067;&#x304D;&#x308B;
[StructLayout(LayoutKind.Sequential, Size = 16)]
public struct Empty16
{
}
public struct LongLong
{
public long X;
public long Y;
}
&#x3069;&#x3061;&#x3089;&#x3082;&#x9023;&#x7D9A;&#x3057;&#x3066;16&#x30D0;&#x30A4;&#x30C8;&#x306E;
&#x9818;&#x57DF;&#x3092;&#x78BA;&#x4FDD;&#x3057;&#x3066;&#x3044;&#x308B;&#x3060;&#x3051;&#x3001;&#x3068;&#x3044;
&#x3046;&#x610F;&#x5473;&#xFF08;&#x306B;&#x8AAD;&#x3081;&#x308B;&#xFF09;
&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;0&#x3068;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;
8&#x306B;&#x30A2;&#x30AF;&#x30BB;&#x30B9;&#x3057;&#x3084;&#x3059;&#x304F;&#x3057;&#x3066;&#x3044;&#x308B;
&#x3060;&#x3051;&#xFF08;&#x3068;&#x3044;&#x3046;&#x98A8;&#x306B;&#x8AAD;&#x3081;&#x308B;&#xFF09; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-56-638.jpg?cb=1569478193"> 56. </a> 57
// &#x5148;&#x982D;6&#x30D0;&#x30A4;&#x30C8;&#x304C;Timestamp, &#x5F8C;&#x308D;10&#x30D0;&#x30A4;&#x30C8;&#x304C;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x3068;&#x3044;&#x3046;Ulid&#x3068;&#x3044;&#x3046;&#x4ED5;&#x69D8;(&#x30BD;&#x30FC;&#x30C8;&#x53EF;&#x80FD;&#x306A;Guid&#x306E;&#x4EE3;&#x66FF;)
[StructLayout(LayoutKind.Explicit, Size = 16)]
public struct Ulid
{
// Timestamp&#x3068;Randomness&#x306E;&#x306F;&#x3058;&#x307E;&#x308A;&#x306E;&#x90E8;&#x5206;&#x3060;&#x3051;&#x6301;&#x3063;&#x3066;&#x304A;&#x304F;(&#x6700;&#x60AA;&#x306A;&#x304F;&#x3066;&#x3082;&#x5225;&#x306B;&#x3044;&#x3044;)
[FieldOffset(0)] byte timestamp0;
[FieldOffset(6)] byte randomness0;
public static Ulid NewUlid()
{
var memory = default(Ulid); // 16&#x30D0;&#x30A4;&#x30C8;&#x78BA;&#x4FDD;
var timestampMilliseconds = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();
ref var fisrtByte = ref Unsafe.As&lt;long, byte&gt;(ref timestampMilliseconds);
Unsafe.Add(ref memory.timestamp0, 0) = Unsafe.Add(ref fisrtByte, 5);
Unsafe.Add(ref memory.timestamp0, 1) = Unsafe.Add(ref fisrtByte, 4);
Unsafe.Add(ref memory.timestamp0, 2) = Unsafe.Add(ref fisrtByte, 3);
Unsafe.Add(ref memory.timestamp0, 3) = Unsafe.Add(ref fisrtByte, 2);
Unsafe.Add(ref memory.timestamp0, 4) = Unsafe.Add(ref fisrtByte, 1);
Unsafe.Add(ref memory.timestamp0, 5) = Unsafe.Add(ref fisrtByte, 0);
Unsafe.WriteUnaligned(ref memory.randomness0, xorshift.NextULong());
Unsafe.WriteUnaligned(ref Unsafe.Add(ref memory.randomness0, 2), xorshift.NextULong());
return memory;
}
Ulid:
[Timestamp(6),
Randomness(10)]
&#x306E;&#x5B9F;&#x88C5;
(System.Runtime
.CompilerService
s.Unsafe&#x3092;&#x5229;&#x7528;&#x3001;
Unity&#x3067;&#x3082;&#x52D5;&#x304D;&#x307E;
&#x3059;&#x304C;&#x5225;&#x9014;&#x53C2;&#x7167;&#x306F;&#x5FC5;
&#x8981;&#x3001;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x3067;&#x3084;
&#x3063;&#x3066;&#x3082;&#x3044;&#x3044;&#x3067;&#x3059;) </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-57-638.jpg?cb=1569478193"> 57. </a> 58
// &#x5148;&#x982D;6&#x30D0;&#x30A4;&#x30C8;&#x304C;Timestamp, &#x5F8C;&#x308D;10&#x30D0;&#x30A4;&#x30C8;&#x304C;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x3068;&#x3044;&#x3046;Ulid&#x3068;&#x3044;&#x3046;&#x4ED5;&#x69D8;(&#x30BD;&#x30FC;&#x30C8;&#x53EF;&#x80FD;&#x306A;Guid&#x306E;&#x4EE3;&#x66FF;)
[StructLayout(LayoutKind.Explicit, Size = 16)]
public struct Ulid
{
// Timestamp&#x3068;Randomness&#x306E;&#x306F;&#x3058;&#x307E;&#x308A;&#x306E;&#x90E8;&#x5206;&#x3060;&#x3051;&#x6301;&#x3063;&#x3066;&#x304A;&#x304F;(&#x6700;&#x60AA;&#x306A;&#x304F;&#x3066;&#x3082;&#x5225;&#x306B;&#x3044;&#x3044;)
[FieldOffset(0)] byte timestamp0;
[FieldOffset(6)] byte randomness0;
public static Ulid NewUlid()
{
var memory = default(Ulid); // 16&#x30D0;&#x30A4;&#x30C8;&#x78BA;&#x4FDD;
var timestampMilliseconds = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();
ref var fisrtByte = ref Unsafe.As&lt;long, byte&gt;(ref timestampMilliseconds);
Unsafe.Add(ref memory.timestamp0, 0) = Unsafe.Add(ref fisrtByte, 5);
Unsafe.Add(ref memory.timestamp0, 1) = Unsafe.Add(ref fisrtByte, 4);
Unsafe.Add(ref memory.timestamp0, 2) = Unsafe.Add(ref fisrtByte, 3);
Unsafe.Add(ref memory.timestamp0, 3) = Unsafe.Add(ref fisrtByte, 2);
Unsafe.Add(ref memory.timestamp0, 4) = Unsafe.Add(ref fisrtByte, 1);
Unsafe.Add(ref memory.timestamp0, 5) = Unsafe.Add(ref fisrtByte, 0);
Unsafe.WriteUnaligned(ref memory.randomness0, xorshift.NextULong());
Unsafe.WriteUnaligned(ref Unsafe.Add(ref memory.randomness0, 2), xorshift.NextULong());
return memory;
}
// &#x30E1;&#x30E2;&#x30EA;&#x9818;&#x57DF;&#x3092;&#x30B3;&#x30D4;&#x30FC;&#x3059;&#x308C;&#x3070;&#x304A;&#xFF4B;&#x3002;
// &#x6587;&#x5B57;&#x5217;&#x8868;&#x73FE;&#x3068;&#x3057;&#x3066;Base32&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C9;(ToString)&#x3082;&#x540C;&#x69D8;&#x306B;&#x81EA;&#x5206;&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x7C8B;&#x304B;&#x3089;&#x7B97;&#x51FA;
public bool TryWriteBytes(Span&lt;byte&gt; destination)
{
if (destination.Length &lt; 16)
{
return false;
}
Unsafe.WriteUnaligned(ref MemoryMarshal.GetReference(destination), this)
return true;
}
&#x51FA;&#x529B;&#x5148;&#x3068;&#x3057;&#x3066;byte[]&#x3068;string&#x304C;&#x3042;&#x308C;&#x3070;&#x305D;&#x308C;&#x3067;&#x3044;&#x3044;
&#x305D;&#x308C;&#x3089;&#x306F;&#x307B;&#x3068;&#x3093;&#x3069;&#x30E1;&#x30E2;&#x30EA;&#x30B3;&#x30D4;&#x30FC;&#x3067;&#x5B9F;&#x73FE;&#x3059;&#x308B; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-58-638.jpg?cb=1569478193"> 58. </a> Union
59
[StructLayout(LayoutKind.Explicit, Pack = 1)]
internal struct GuidBits
{
[FieldOffset(0)]
public readonly Guid Value;
[FieldOffset(0)]
public readonly byte Byte0;
[FieldOffset(1)]
public readonly byte Byte1;
[FieldOffset(2)]
public readonly byte Byte2;
[FieldOffset(3)]
public readonly byte Byte3;
/* &#x4E2D;&#x7565;(Byte4~Byte11) */
[FieldOffset(12)]
public readonly byte Byte12;
[FieldOffset(13)]
public readonly byte Byte13;
[FieldOffset(14)]
public readonly byte Byte14;
[FieldOffset(15)]
public readonly byte Byte15;
Guid&#x3068;byte0~16&#x306E;&#x91CD;&#x306D;&#x5408;&#x308F;&#x305B;
(&#x540C;&#x4E00;FieldOffset)
&#x901A;&#x5E38;String&#x304B;byte[]&#x304B;&#x3089;&#x3057;&#x304B;&#x751F;&#x6210;&#x3067;&#x304D;
&#x306A;&#x3044;Guid&#x3092;&#x3001;byte0~16&#x3092;&#x57CB;&#x3081;&#x308B;&#x3060;&#x3051;
&#x3067;&#x81EA;&#x7531;&#x306B;&#x751F;&#x6210;&#x3059;&#x308B;(&#x672C;&#x6765;&#x5F04;&#x308C;&#x306A;&#x3044;Guid
&#x3068;&#x3057;&#x3066;&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x9818;&#x57DF;&#x3092;&#x91CD;&#x306D;&#x5408;&#x308F;&#x305B;&#x3066;
&#x5B89;&#x5168;&#x306B;(not unsafe)&#x5F04;&#x308B;)
MessagePack for C#&#x3067;Utf8 Bytes&#x306E;&#x30B9;
&#x30E9;&#x30A4;&#x30B9;&#x304B;&#x3089;&#x6587;&#x5B57;&#x5217;&#x306E;&#x30A2;&#x30ED;&#x30B1;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x3092;&#x907F;
&#x3051;&#x3066;&#x76F4;&#x63A5;Guid&#x306B;&#x5909;&#x63DB;&#x3059;&#x308B;&#x306E;&#x306B;&#x5229;&#x7528; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-59-638.jpg?cb=1569478193"> 59. </a> &#x6539;&#x3081;&#x3066;Struct&#x304C;&#x8981;&#x7D20;&#x306E;&#x914D;&#x5217;&#x3068;&#x306F;
60
&#x2014; &#x30E1;&#x30E2;&#x30EA;&#x306B;Struct&#x304C;&#x5358;&#x7D14;&#x306B;&#x4E26;&#x3093;&#x3067;&#x3044;&#x308B;
X Y Z X Y Z X Y Z X Y ZVector3[]
&#x30E1;&#x30E2;&#x30EA;&#x3092;&#x307E;&#x308B;&#x3054;&#x3068;&#x30B3;&#x30D4;&#x30FC;&#x3059;&#x308B;&#x3060;&#x3051;&#x3067;
&#x6700;&#x901F;&#x306E;&#x30B7;&#x30EA;&#x30A2;&#x30E9;&#x30A4;&#x30BA;&#x3060;&#x3088;&#x306D;&#x8AAC;
&#xFF08;&#x30A8;&#x30F3;&#x30C7;&#x30A3;&#x30A2;&#x30F3;&#x306F;&#x63C3;&#x3048;&#x308B;&#xFF09;
&#x5B9F;&#x969B;MagicOnion&#x3067;&#x6709;&#x52B9;&#x306B;&#x3059;&#x308B;&#x3053;&#x3068;&#x304C;&#x53EF;
&#x80FD;(&#x30B5;&#x30FC;&#x30D0;&#x30FC;&#x3082;C#&#x306A;&#x306E;&#x3067;&#x76F4;&#x63A5;&#x30E1;&#x30E2;&#x30EA;&#x3092;&#x3076;
&#x3093;&#x6295;&#x3052;&#x3066;&#x53D7;&#x3051;&#x53D6;&#x308B;&#x306E;&#x304C;&#x7C21;&#x5358;)
&#x305F;&#x3060;&#x3057;Struct&#x306E;&#x4E2D;&#x306B;&#x306F;&#x53C2;&#x7167;&#x578B;(String&#x542B;
&#x3080;)&#x306F;&#x542B;&#x3081;&#x306A;&#x3044;&#x3053;&#x3068;&#x3002;&#x30DD;&#x30A4;&#x30F3; &#x30BF;&#x3092;&#x30B3;&#x30D4;&#x30FC;
&#x3057;&#x3066;&#x3082;&#x610F;&#x5473;&#x304C;&#x306A;&#x3044; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-60-638.jpg?cb=1569478193"> 60. </a> 61
public class UnsafeDirectBlitArrayFormatter&lt;T&gt; : IMessagePackFormatter&lt;T[]&gt; where T : struct
{
public unsafe int Serialize(ref byte[] bytes, int offset, T[] value)
{
var startOffset = offset;
var byteLen = value.Length * UnsafeUtility.SizeOf&lt;T&gt;();
/* &#x4E2D;&#x7565;(MsgPack&#x3067;&#x306E;Ext&#x30D8;&#x30C3;&#x30C0;&#x30FC;&#x66F8;&#x304D;&#x8FBC;&#x307F;) */
ulong handle2;
var srcPointer = UnsafeUtility
.PinGCArrayAndGetDataAddress(value, out handle2);
try
{
fixed (void* dstPointer = &amp;bytes[offset])
{
UnsafeUtility.MemCpy(dstPointer, srcPointer, byteLen);
}
}
finally
{
UnsafeUtility.ReleaseGCObject(handle2);
}
// ...
}
T[]&#x3092;bytes&#x306B;&#x30B7;&#x30EA;&#x30A2;&#x30E9;&#x30A4;&#x30BA;
memcpy&#x3059;&#x308B;&#x3060;&#x3051; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-61-638.jpg?cb=1569478193"> 61. </a> 62
Span and NativeArray </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-62-638.jpg?cb=1569478193"> 62. </a> Span vs NativeArray
63
&#x2014; Span&lt;T&gt;
&#x2014; System.Memory
&#x2014; .NET Standard 2.1&#x3067;&#x306F;&#x6A19;&#x6E96;(&#x73FE;&#x5728;&#x306F;&#x5916;&#x90E8;&#x30E9;&#x30A4;&#x30D6;&#x30E9;&#x30EA;&#x304C;&#x5FC5;&#x8981;)
&#x2014; C# 7.2&#x3068;&#x7D71;&#x5408;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;
&#x2014; &#x3042;&#x3089;&#x3086;&#x308B;&#x9023;&#x7D9A;&#x3057;&#x305F;&#x30E1;&#x30E2;&#x30EA;&#x9818;&#x57DF;&#x306E;&#x30D3;&#x30E5;&#x30FC;
&#x2014; &#x914D;&#x5217;&#x3001;stackalloc&#x3001;&#x30CD;&#x30A4;&#x30C6;&#x30A3;&#x30D6;&#x30E1;&#x30E2;&#x30EA;(&#x30DD;&#x30A4;&#x30F3;&#x30BF;)&#x3001;&#x6587;&#x5B57;&#x5217;(String)
&#x2014; NativeArray
&#x2014; Unity&#x56FA;&#x6709;, &#x7279;&#x306B;DOTS&#x306E;&#x30AD;&#x30FC;&#x30D1;&#x30FC;&#x30C4;
&#x2014; UnsafeUtility.Malloc &#x3067;&#x7372;&#x5F97;&#x3059;&#x308B;Unmanaged Memory&#x306E;&#x30D3;&#x30E5;&#x30FC; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-63-638.jpg?cb=1569478193"> 63. </a> &#x30D5;&#x30EC;&#x30FC;&#x30E0;&#x30EF;&#x30FC;&#x30AF;&#x5BFE;&#x5FDC;&#x304C;&#x306A;&#x3044;&#x3068;&#x610F;&#x5473;&#x304C;&#x306A;&#x3044;
64
&#x2014; Span&lt;T&gt;
&#x2014; &#x4ECA;&#x307E;&#x3067;&#x306E;API&#x304C;T[]&#x3057;&#x304B;&#x53D7;&#x3051;&#x5165;&#x308C;&#x306A;&#x304B;&#x3063;&#x305F;&#x308A;&#x3059;&#x308B;&#x3068;&#x3001;&#x7D50;&#x5C40;T[]&#x3078;&#x306E;&#x5909;&#x63DB;&#x304C;&#x5FC5;&#x8981;&#x306B;&#x306A;&#x308B;
&#x2014; &#x7121;&#x99C4;&#x30A2;&#x30ED;&#x30B1;&#x30FC;&#x30C8;
&#x2014; .NET Core 2.1&#x3067;&#x5BFE;&#x5FDC;&#x5145;&#x5B9F;&#x3055;&#x305B;&#x4E2D;
&#x2014; &#x4F8B;&#x3048;&#x3070;Convert.ToBase64String&#x304C;byte[]&#x306E;&#x307B;&#x304B;ReadOnlySpan&lt;byte&gt;&#x3092;&#x53D7;&#x3051;&#x3068;&#x308B;
&#x2014; &#x3064;&#x307E;&#x308A;Unity&#x3067;&#x306F;API&#x5074;&#x306E;&#x5BFE;&#x5FDC;&#x304C;&#x307B;&#x3068;&#x3093;&#x3069;&#x306A;&#x3044;&#x306E;&#x3067;Span&#x3060;&#x3051;&#x5165;&#x308C;&#x3066;&#x3082;&#x610F;&#x5473;&#x306F;&#x9650;&#x5B9A;&#x7684;
&#x2014; NativeArray
&#x2014; DOTS&#x5468;&#x8FBA;&#x3067;&#x4F7F;&#x3048;&#x308B;&#x3051;&#x308C;&#x3069;&#x3001;&#x3084;&#x306F;&#x308A;&#x4E00;&#x90E8;&#x306E;API&#x306F;&#x5BFE;&#x5FDC;&#x304C;&#x5FC5;&#x8981;
&#x2014; &#x4F8B;&#x3048;&#x3070;Mesh.SetVertexBufferData&#x3068;&#x3057;&#x3066;List&lt;T&gt;&#x3084;T[]&#x4EE5;&#x5916;&#x306B;NativeArray&lt;T&gt;&#x3092;&#x53D7;&#x3051;
&#x53D6;&#x308B;&#x3088;&#x3046;&#x306B;&#x306A;&#x3063;&#x305F;&#x306E;&#x306F; 2019.3&#x304B;&#x3089;
&#x2014; &#x3068;&#x3044;&#x3046;&#x3088;&#x3046;&#x306B;&#x3001;&#x30B9;&#x30E0;&#x30FC;&#x30BA;&#x306B;&#x5168;&#x4F53;&#x7684;&#x306B;&#x7D71;&#x5408;&#x3055;&#x308C;&#x3066;&#x3044;&#x304F;&#x306E;&#x306F;&#x3082;&#x3046;&#x3061;&#x3087;&#x3063;&#x3068;&#x304B;&#x306A;&#xFF1F; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-64-638.jpg?cb=1569478193"> 64. </a> 65
Conclusion </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-65-638.jpg?cb=1569478193"> 65. </a> &#x306E;&#x524D;&#x306B;&#x3002;
66
&#x2014; &#x69CB;&#x9020;&#x4F53;&#x306E;&#x8272;&#x3092;&#x30AF;&#x30E9;&#x30B9;&#x3068;&#x306F;&#x5225;&#x306E;&#x8272;&#x306B;&#x5909;&#x66F4;&#x3057;&#x3066;&#x304A;&#x3053;&#x3046;&#xFF01;
&#x2013; &#x6027;&#x80FD;&#x7279;&#x6027;&#x304C;&#x7570;&#x306A;&#x308B;&#x3082;&#x306E;&#x306E;&#x305F;&#x3081;&#x3001;&#x898B;&#x5206;&#x3051;&#x304C;&#x3064;&#x304F;&#x3068;&#x3001;&#x3068;&#x3066;&#x3082;&#x697D;&#x306B;&#x306A;&#x308B; </li> <li> <a href="https://image.slidesharecdn.com/09261330roomayoshihumikawai-190926055210/95/unite-tokyo-2019understanding-c-struct-all-things-66-638.jpg?cb=1569478193"> 66. </a> Struct&#x3092;&#x6050;&#x308C;&#x306A;&#x3044;
67
&#x2014; Struct&#x306E;&#x4F7F;&#x3044;&#x3053;&#x306A;&#x3057;&#x81EA;&#x4F53;&#x306F;&#x3001;&#x3082;&#x306F;&#x3084;&#x5FC5;&#x9808;
&#x2013; Class&#x3092;&#x512A;&#x5148;&#x3059;&#x308B;&#x7267;&#x6B4C;&#x7684;&#x6642;&#x4EE3;&#x306F;&#x7D42;&#x308F;&#x3063;&#x305F;
&#x2013; &#x78BA;&#x304B;&#x306B;&#x7F60;&#x306F;&#xFF08;&#x3044;&#x3063;&#x3071;&#x3044;&#xFF09;&#x3042;&#x308B;&#x304C;&#x3001;&#x96E3;&#x3057;&#x3044;&#x8A71;&#x3067;&#x306F;&#x306A;&#x3044;
&#x2013; &#x899A;&#x3048;&#x308B;&#x30D1;&#x30BF;&#x30FC;&#x30F3;&#x304C;&#xFF08;&#x3061;&#x3087;&#x3063;&#x3068;&#xFF09;&#x591A;&#x3044;&#x3060;&#x3051;&#x3067;
&#x2014; &#x305D;&#x3057;&#x3066;&#x3053;&#x306E;&#x6D41;&#x308C;&#x306F;&#x623B;&#x3089;&#x306A;&#x3044;
&#x2013; &#x8A00;&#x8A9E;&#x5F37;&#x5316;&#x304B;&#x3089;&#x3001;&#x30D5;&#x30EC;&#x30FC;&#x30E0;&#x30EF;&#x30FC;&#x30AF;&#x306E;&#x629C;&#x672C;&#x7684;&#x5909;&#x66F4;&#x307E;&#x3067;&#x3001;&#x6642;&#x4EE3;&#x306F;&#x65E2;&#x306B;&#x6765;&#x3066;&#x308B;
&#x2013; &#x2026;&#x2026;&#x3068;&#x306F;&#x3044;&#x3048;&#x3001;&#x3058;&#x3083;&#x3042;&#x3044;&#x304D;&#x306A;&#x308A;&#x3081;&#x3063;&#x3061;&#x3083;&#x4F7F;&#x3046;&#x304B;&#x3068;&#x8A00;&#x3046;&#x3068;&#x3001;&#x305D;&#x308C;&#x306F;&#x307E;&#x305F;&#x5225;&#x306E;&#x8A71;
&#x2013; &#x4F7F;&#x3046;&#x3079;&#x304D;&#x6642;&#x306B;&#x4F7F;&#x3044;&#x3001;&#x8AAD;&#x3081;&#x308B;&#x3088;&#x3046;&#x306B;&#x3059;&#x308B;&#x3068;&#x3044;&#x3046;&#x3001;&#x5F53;&#x305F;&#x308A;&#x524D;&#x3092;&#x5927;&#x4E8B;&#x306B;&#x3057;&#x3088;&#x3046; </li> </ol> </p> </div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>