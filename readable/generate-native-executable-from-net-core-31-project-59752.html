<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Generate Native Executable from .NET Core 3.1 Project - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Generate Native Executable from .NET Core 3.1 Project - linksfor.dev(s)"/>
    <meta property="article:author" content="Ray Porter"/>
    <meta property="og:description" content="Make true native executable (no framework required) from .NET Core 3.1 project (factorial calculation project example) with the CoreRT library"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.codeproject.com/Articles/5262251/Generate-native-executable-from-NET-Core-3-1-proje"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Generate Native Executable from .NET Core 3.1 Project</title>
<div class="readable">
        <h1>Generate Native Executable from .NET Core 3.1 Project</h1>
            <div>by Ray Porter</div>
            <div>Reading time: 6-7 minutes</div>
        <div>Posted here: 17 Mar 2020</div>
        <p><a href="https://www.codeproject.com/Articles/5262251/Generate-native-executable-from-NET-Core-3-1-proje">https://www.codeproject.com/Articles/5262251/Generate-native-executable-from-NET-Core-3-1-proje</a></p>
        <hr/>
<div id="readability-page-1" class="page"><p>In this article, we will see a sample program that uses .NET Core 3. We will review the process the developer will have to follow for producing native executable of his application. We will take a look at how to check the Visual Studio Installed Components, add the NuGet Repository which&nbsp;has the ILCompiler, add the dependency to your project, code your application and generate the native executable of the program.</p><div id="contentdiv">
						



<ul>
	<li><a href="https://www.codeproject.com/KB/tips/5262251/prjCoreRT.zip">Download source files - 1.3 KB</a></li></ul>

<p><img src="https://www.codeproject.com/KB/tips/5262251/app.jpg" alt="Image 1" data-sizes="auto" data-srcset="/KB/tips/5262251/app-r-400.jpg 400w, /KB/tips/5262251/app.jpg 595w" sizes="595px" srcset="/KB/tips/5262251/app-r-400.jpg 400w, /KB/tips/5262251/app.jpg 595w"></p>

<h2>Introduction: Compilation of a Managed Code?</h2>

<p>The feature is not integrated in the SDK but provides to the C# developer an amazing way to produce machine executable from a .NET Core 3 original <em>.csproj</em>. From my point of view, this is a critical point when you want to distribute your software in a professional way (this is the way :). I discovered this feature in a stellar book (I didn’t forget to mention the source, for reference): <a href="https://www.amazon.com/Developing-multi-platform-desktop-applications-Visual/dp/1705936229/" target="_blank">Developing multi-platform desktop applications with .NET Core 3 and Visual Studio 2019.</a></p>

<p>With this tool, the .NET Core 3 outmatches the concurrencies (Python, Node, Java) for the development of performance enhanced application (at last, C# almost reached the C++ performances level).</p>

<h2>How It Works: The Principle</h2>

<p>The .NET Core Runtime is used for generating AOT (Ahead of Time) image of the managed project. For building that, the pseudo compiler converts the MSIL program into C++ code and compiles&nbsp;the result for producing a native executable of the application (That’s why the C++ tools are required whatever the OS you are working on).<br>
This <a href="https://mattwarren.org/2018/06/07/CoreRT-.NET-Runtime-for-AOT/" target="_blank">complete process has been very well documented</a> by one of its main developers (a Microsoft guy), Matt Warren.</p>

<p>For resuming, the compiler produces a real native executable, compared to an IL assembly which&nbsp;is compiled at run time to native code by the JIT (Just In Time compiler).</p>

<h2>Fields of Application</h2>

<p>The obvious benefits provided by using native executable are ridiculous performances improvement, the lack of framework to install.</p>

<p>The most adapted program for using the native format are mainly desktop applications (service, console or GUI) because the gain for local computing is quite noticeable for this type of application.</p>

<p>On the other hand, for web applications (Web app and API), the gains are not so obvious because of the kind of deployment they use. In a web server environment, most of the time, the framework is already installed on the machine and the use of a native executable is less manifest.</p>

<h2>Sample Program</h2>

<p>The sample program uses .NET Core 3. Let's review the process the developer will have to follow for making the jump in producing native executable of his application.</p>

<h3>1. Check the Visual Studio Installed Components</h3>

<p>Added to the required .NET Core 3 framework (and all the components required for the development with this framework), the ILCompiler required the setup of the C++ desktop feature.</p>

<p>Here is the C++ feature you have to install on Visual Studio:</p>

<p><img src="https://www.codeproject.com/KB/tips/5262251/nativePre.jpg" alt="Image 2" data-src="/KB/tips/5262251/nativePre.jpg" data-sizes="auto" data-srcset="/KB/tips/5262251/nativePre-r-400.jpg 400w, /KB/tips/5262251/nativePre.jpg 406w" sizes="406px" srcset="/KB/tips/5262251/nativePre-r-400.jpg 400w, /KB/tips/5262251/nativePre.jpg 406w"></p>

<h3>2. Add the NuGet Repository which&nbsp;has the ILCompiler</h3>

<p>A dedicated NuGet repository contains the <code>Microsoft.Dotnet.ILCompiler</code> dependency required for the compilation of your program into real native executable.<br>
This repository URL is:<br>
<b>https://dotnetfeed.blob.core.windows.net/dotnet-core/index.json</b>.</p>

<p>You have to add it to your NuGet source repos, if you use Visual Studio, you have to add it as described in picture 1 below.</p>

<p><img src="https://www.codeproject.com/KB/tips/5262251/nugsrc.jpg" alt="Image 3" data-src="/KB/tips/5262251/nugsrc.jpg" data-sizes="auto" data-srcset="/KB/tips/5262251/nugsrc-r-400.jpg 400w, /KB/tips/5262251/nugsrc.jpg 590w" srcset="/KB/tips/5262251/nugsrc-r-400.jpg 400w, /KB/tips/5262251/nugsrc.jpg 590w"></p>

<p>Picture 1</p>

<h3>3. Add the Dependency to Your Project</h3>

<p>You can add <code>Microsoft.Dotnet.ILCompiler</code>, by selecting it in the list of the available packages list as described in picture 2. Do not forget to check the box “<strong>Include prerelease</strong>” (because the package is still labelled “<strong>alpha</strong>” version).</p>

<p><img src="https://www.codeproject.com/KB/tips/5262251/nugpack.jpg" alt="Image 4" data-src="/KB/tips/5262251/nugpack.jpg"></p>

<p>Picture 2</p>

<h3>4. Code Your Application</h3>

<p>The sample console application does a factorial calculation with display of every rank (each step of the calculation) and displays the final result in red (groovy!).</p>

<p>Here is the source code:</p>

<p><span id="prehide405058" onclick="processCodeBlocks.togglePre(405058);">Hide</span>  &nbsp; <span id="preShrink405058" onclick="processCodeBlocks.shrinkExpand(405058);">Shrink</span> <img id="preimg405058" src="https://www.codeproject.com/images/arrow-up-16.png" onclick="processCodeBlocks.shrinkExpand(405058);">  &nbsp; <span id="copycode405058" onclick="return processCodeBlocks.copyCode(405058);">Copy Code</span></p><pre lang="cs" data-lang-orig="cs" id="pre405058" processed="true"><span>using</span> System;

<span>namespace</span> Net3Factorial
{
    <span>class</span> Program
    {
        <span>static</span> <span>long</span> Factorial(<span>int</span> x)
        {
            <span>long</span> result = <span>1</span>;
            Console.ForegroundColor = ConsoleColor.Blue;
            <span>for</span> (<span>int</span> i = <span>1</span>; i <span>&lt;</span>= x; i++)
            {
                result = result * i;
                Console.WriteLine(<span>"</span><span>Step {0}: {1}"</span>, i, result);
            }
            <span>return</span> result;
        }

        <span>static</span> <span>void</span> Main(<span>string</span>[] args)
        {
            Console.BackgroundColor = ConsoleColor.Black;
            Console.ForegroundColor = ConsoleColor.Green;
            Console.Clear();

            Console.WriteLine(<span>"</span><span>Enter the Integer for the factorial calculation:"</span>);

            <span>int</span> num = Convert.ToInt32(Console.ReadLine());
       
            <span>long</span> f = Factorial(num);
            Console.ForegroundColor = ConsoleColor.Red;

            Console.Write(<span>"</span><span>The Factorial of {0} is: {1}
"</span>, num, f);
        }
    }
}</pre>

<h3>5. Generate the Native Executable of the Program</h3>

<p>Once your project has been debugged and tested, you now want to produce the native executable of your application. The <em>.csproj</em> file has to include the target platform for the generation of the native executable, the runtime identifier (rid).</p>

<p><span id="prehide764607" onclick="processCodeBlocks.togglePre(764607);">Hide</span>  &nbsp; <span id="copycode764607" onclick="return processCodeBlocks.copyCode(764607);">Copy Code</span></p><pre id="pre764607">&lt;runtimeidentifier&gt;win-x64&lt;/runtimeidentifier&gt;
</pre>

<p>If you use Visual Studio 2019, you can use the “<strong>Publish</strong>” command (context menu on the project item) for producing the native executable as shown in picture 3.</p>

<p><img height="413px" src="https://www.codeproject.com/KB/tips/5262251/NativePubl.jpg" width="590px" alt="Image 5" data-src="/KB/tips/5262251/NativePubl.jpg" data-sizes="auto" data-srcset="/KB/tips/5262251/NativePubl-r-400.jpg 400w, /KB/tips/5262251/NativePubl.jpg 590w" srcset="/KB/tips/5262251/NativePubl-r-400.jpg 400w, /KB/tips/5262251/NativePubl.jpg 590w"></p>

<p>Picture 3</p>

<p>You can also use the CLI command "<code>dotnet publish</code>" if you prefer the command line.</p>

<h2>Conclusion</h2>

<p>The generation of a native executable is a significant advantage for .NET Core 3, you benefit from the high productivity of C# and the performances are almost as good as the ones you could achieve using classic C++.</p>

<p>The <code>ILCompiler</code> library can be used on Windows as described in this article, but on Linux and Mac OS X as well.</p>

<h2>History</h2>

<ul>
	<li>16<sup>th</sup> March, 2020: Initial version</li></ul>


						</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>