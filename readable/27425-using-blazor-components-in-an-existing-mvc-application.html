<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Using Blazor Components In An Existing MVC Application -
linksfor.dev(s)
    </title>
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <style type="text/css">
        html {
            font-family: sans-serif;
            line-height: 1.15;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            height: 100%;
        }

        *, ::after, ::before {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #60656a;
            text-align: left;
            background-color: #323b44;
        }

        h1 {
            font-size: 6rem;
            font-weight: 300;
            line-height: 1.2;
            margin-top: 0;
            margin-bottom: 0.5rem;
            margin-bottom: 0.5rem
        }

        a {
            color: #007bff;
            color: #ccc;
            text-decoration: none;
            background-color: transparent;
            word-break: break-all;
        }

        .unseen a {
            font-weight: bold;
        }

        h3 {
            margin-top: 0;
            padding-top: 0;
            font-weight: normal;
        }

        .grid {
            -ms-flex-direction: column;
            flex-direction: column;
            width: 1024px;
            margin: 0 auto;
            flex: 1 0 auto;
        }

        .row {
            -ms-flex-direction: row;
            flex-direction: row;
            width: 100%;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            display: -ms-flexbox;
            display: flex;
        }

        .col {
            margin: 0 10px 0 10px;
            box-sizing: border-box;
            vertical-align: top;
        }

        .col-3-of-4, .col-6-of-8, .col-9-of-12 {
            width: calc(75% - 20px);
        }

        .col-1-of-4, .col-2-of-8, .col-3-of-12 {
            width: calc(25% - 20px);
        }

        @media (max-width:1023px) {
            /* big landscape tablets, laptops, and desktops */
            body {
                overflow-x: hidden;
            }

            main {
                width: 99%;
            }

            h1 {
                font-size: 50px;
            }
        }

        .text-right {
            text-align: right;
        }

        footer {
            left: 0;
            width: 100%;
            margin-top: 2em;
            padding: 50px 0;
            text-align: center;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        .readable {
            color: #949ba2;
        }

        svg:not(:root).svg-inline--fa {
            color: #60656a;
            overflow: visible;
        }

        .svg-inline--fa.fa-w-12 {
            width: 0.75em;
        }

        svg:not(:root) {
            overflow: hidden;
        }

        .svg-inline--fa {
            display: inline-block;
            font-size: inherit;
            height: 1em;
            overflow: visible;
            vertical-align: -0.125em;
        }

        img {
            max-width: 100%;
        }

        .text-center {
            text-align: center;
        }

        .readable h1 {
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Using Blazor Components In An Existing MVC Application</h1>
    <div class="post-content"> <p>I&apos;ve had this post waiting for a while but due to a <a href="https://github.com/aspnet/AspNetCore/issues/9834">bug in Preview 5</a> I&apos;ve been holding off sharing it. But with the release of Preview 6 the bug is gone and I can finally hit the publish button. So let&apos;s get to it!</p><p>One of the many awesome things about Blazor is the migration story it offers. If you&apos;re currently developing or maintaining a MVC or Razor Pages application, then the you&apos;re in for a treat! You can now replace parts of your application with Blazor components. </p><p>In this post, we&apos;re going to cover how to make all the necessary changes to your existing app to allow Blazor components to be used. Then we&apos;ll also look at replacing part of an existing MVC view with a Blazor component.</p><p>All of the source code from this blog post is available on <a href="https://github.com/chrissainty/BlazorInExistingMVCApp">GitHub</a>.</p><h2 id="getting-setup">Getting Setup</h2><p>We&apos;re going to be using the Contoso University sample application. This should make things a little more interesting than using the default MVC templates. </p><p>As Blazor is only available in .NET Core 3, I&apos;ve taken the current .NET Core 2.2 version and upgraded it using <a href="https://docs.microsoft.com/en-us/aspnet/core/migration/22-to-30?view=aspnetcore-2.2&amp;tabs=visual-studio">this guide</a> on the Microsoft Docs site.</p><h2 id="adding-blazor-support-to-an-existing-mvc-application">Adding Blazor Support to an existing MVC application</h2><p>In order to use Blazor in an existing MVC or Razor Pages application we need to make a few changes, they are.</p><ul><li>Add a reference to <code>blazor.server.js</code></li><li>Add the Blazor services to the service container (DI)</li><li>Map Blazors SignalR hub</li></ul><h3 id="referencing-blazors-js">Referencing Blazors JS </h3><p>First on our list is to add a reference to <code>blazor.server.js</code>, we need to do this in the main <code>_Layout.cshtml</code> file. </p><pre><code class="language-html">&lt;footer class=&quot;border-top footer text-muted&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &amp;copy; 2019 - Contoso University - &lt;a asp-area=&quot;&quot; asp-controller=&quot;Home&quot; asp-action=&quot;Privacy&quot;&gt;Privacy&lt;/a&gt;
    &lt;/div&gt;
&lt;/footer&gt;

&lt;script src=&quot;_framework/blazor.server.js&quot;&gt;&lt;/script&gt;

&lt;environment include=&quot;Development&quot;&gt;
    &lt;script src=&quot;~/lib/jquery/dist/jquery.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;~/lib/bootstrap/dist/js/bootstrap.bundle.js&quot;&gt;&lt;/script&gt;
&lt;/environment&gt;
</code></pre>
<h3 id="adding-blazors-services">Adding Blazors services</h3><p>Next, we need to add the services Blazor requires to the service container. We do this in the <code>Startup.cs</code> file.</p><pre><code class="language-csharp">public void ConfigureServices(IServiceCollection services)
{
    ...

    services.AddServerSideBlazor();
    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_3_0);
}
</code></pre>
<h3 id="mapping-blazors-signalr-hub">Mapping Blazors SignalR hub</h3><p>Last but not least, we need to hook up Blazors SignalR hub to the endpoint routing, again in <code>Startup.cs</code>.</p><pre><code class="language-csharp">public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
{
    ...

    app.UseEndpoints(endpoints =&gt;
    {
        endpoints.MapControllerRoute(&quot;default&quot;, &quot;{controller=Home}/{action=Index}/{id?}&quot;);
        endpoints.MapBlazorHub();
    });
}
</code></pre>
<p>With those 3 things in place our application is now ready to use Blazor components.</p><h2 id="adding-a-blazor-component">Adding a Blazor component</h2><p>With our application primed for using Blazor, we are going to replace the grid used on the Courses Index view with a Blazor component. The Index view currently looks like this.</p><pre><code class="language-html">@model IEnumerable&lt;ContosoUniversity.Models.Course&gt;

@{
    ViewData[&quot;Title&quot;] = &quot;Courses&quot;;
}

&lt;h2&gt;Courses&lt;/h2&gt;

&lt;p&gt;
    &lt;a asp-action=&quot;Create&quot;&gt;Create New&lt;/a&gt;
&lt;/p&gt;
&lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.CourseID)
            &lt;/th&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.Title)
            &lt;/th&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.Credits)
            &lt;/th&gt;
            &lt;th&gt;
                @Html.DisplayNameFor(model =&gt; model.Department)
            &lt;/th&gt;
            &lt;th&gt;&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        @foreach (var item in Model)
        {
            &lt;tr&gt;
                &lt;td&gt;
                    @Html.DisplayFor(modelItem =&gt; item.CourseID)
                &lt;/td&gt;
                &lt;td&gt;
                    @Html.DisplayFor(modelItem =&gt; item.Title)
                &lt;/td&gt;
                &lt;td&gt;
                    @Html.DisplayFor(modelItem =&gt; item.Credits)
                &lt;/td&gt;
                &lt;td&gt;
                    @Html.DisplayFor(modelItem =&gt; item.Department.Name)
                &lt;/td&gt;
                &lt;td&gt;
                    &lt;a asp-action=&quot;Edit&quot; asp-route-id=&quot;@item.CourseID&quot;&gt;Edit&lt;/a&gt; |
                    &lt;a asp-action=&quot;Details&quot; asp-route-id=&quot;@item.CourseID&quot;&gt;Details&lt;/a&gt; |
                    &lt;a asp-action=&quot;Delete&quot; asp-route-id=&quot;@item.CourseID&quot;&gt;Delete&lt;/a&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        }
    &lt;/tbody&gt;
&lt;/table&gt;
</code></pre>
<h3 id="creating-the-courseslist-component">Creating the CoursesList component</h3><p>We&apos;re going to start by creating a new folder in the route called <em>Components</em>, this is my preference but you can call this folder whatever you want. In fact you could put your components anywhere you want to in the project. </p><p>Then we&apos;re going to add a new component called <code>CoursesList.razor</code> with the following code.</p><pre><code>@using Microsoft.AspNetCore.Components
@using ContosoUniversity.Models

&lt;table class=&quot;table&quot;&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;
                Number
            &lt;/th&gt;
            &lt;th&gt;
                Title
            &lt;/th&gt;
            &lt;th&gt;
                Credits
            &lt;/th&gt;
            &lt;th&gt;
                Department
            &lt;/th&gt;
            &lt;th&gt;&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        @foreach (var item in Courses)
        {
            &lt;tr&gt;
                &lt;td&gt;
                    @item.CourseID
                &lt;/td&gt;
                &lt;td&gt;
                    @item.Title
                &lt;/td&gt;
                &lt;td&gt;
                    @item.Credits
                &lt;/td&gt;
                &lt;td&gt;
                    @item.Department.Name
                &lt;/td&gt;
                &lt;td&gt;
                    &lt;a href=&quot;Courses/Edit/@item.CourseID&quot;&gt;Edit&lt;/a&gt; |
                    &lt;a href=&quot;Courses/Details/@item.CourseID&quot;&gt;Details&lt;/a&gt; |
                    &lt;a href=&quot;Courses/Delete/@item.CourseID&quot;&gt;Delete&lt;/a&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        }
    &lt;/tbody&gt;
&lt;/table&gt;

@code {
    [Parameter] IEnumerable&lt;Course&gt; Courses { get; set; }
}
</code></pre>
<p>As you can see the code is based on the table from the original Index view. We&apos;ve declared the list of courses as a <code>Parameter</code> to be passed in. Then we&apos;re just iterating over the courses and displaying each one as a row in the table, mimicking the behaviour of the original Index view.</p><h3 id="using-the-courseslist-component-in-a-view">Using the CoursesList component in a view</h3><p>To use our new <code>CoursesList</code> component, we&apos;re going to update the original Index view to look like this.</p><pre><code class="language-html">@model IEnumerable&lt;ContosoUniversity.Models.Course&gt;

@{
    ViewData[&quot;Title&quot;] = &quot;Courses&quot;;
}

&lt;h2&gt;Courses&lt;/h2&gt;
    
&lt;p&gt;
    &lt;a asp-action=&quot;Create&quot;&gt;Create New&lt;/a&gt;
&lt;/p&gt;

@(await Html.RenderComponentAsync&lt;CoursesList&gt;(new { Courses = Model }))
</code></pre>
<p>We&apos;ve removed the original table and replaced it with a call to the <code>RenderComponentAsync</code> HTML helper. This helper is responsible for adding and wiring up our component correctly. </p><p>It&apos;s worth noting that this way of adding components is not going to be the long term solution. The plan is to be able to add components using normal elements, so in our case the above code would look like this.</p><pre><code class="language-html">@model IEnumerable&lt;ContosoUniversity.Models.Course&gt;

@{
    ViewData[&quot;Title&quot;] = &quot;Courses&quot;;
}

&lt;h2&gt;Courses&lt;/h2&gt;
    
&lt;p&gt;
    &lt;a asp-action=&quot;Create&quot;&gt;Create New&lt;/a&gt;
&lt;/p&gt;
    
&lt;CoursesList Courses=&quot;Model&quot; /&gt;
</code></pre>
<p>This work is being tracked by the following issue on GitHub, <a href="https://github.com/aspnet/AspNetCore/issues/6348">#6348</a>.</p><p>And, that&apos;s it! We&apos;ve now successfully replaced a section of a MVC view with a Blazor component. You can fire up the app and browse to the page and everything should look exactly the same as before.</p><p>The ability to replace parts of a MVC view or a Razor page with Blazor components is incredibly powerful. And it offers a great migration path for anyone who is looking to modernise an existing application.</p><p>In this post, I showed how you can enable an existing MVC application to use Blazor components. Then showed how to replace part of an existing MVC view with a Blazor component.</p> <div class="post-tags"> Tagged in: <a href="/blazor-server-side/">Blazor (server-side)</a> | <a href="/blazor/">Blazor</a> | <a href="/aspnet-core/">ASP.NET Core</a> </div> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
</body>
</html>