<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Build software better, together - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Build software better, together - linksfor.dev(s)"/>
    <meta property="article:author" content="pervognsen&#xA;              revised&#xA;            &#xA;            this gist on Feb 18, 2019."/>
    <meta property="og:description" content="GitHub is where people build software. More than 40 million people use GitHub to discover, fork, and contribute to over 100 million projects."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Build software better, together</title>
<div class="readable">
        <h1>Build software better, together</h1>
        <p>
by pervognsen&#xA;              revised&#xA;            &#xA;            this gist on Feb 18, 2019. <br/>Reading time: 96-122 minutes        </p>
        <p><a href="https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions">https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-commit-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/Code">
    <main id="gist-pjax-container" data-pjax-container="">
      


  




<div>
  <div>
    
  

  <ol>
      <li>
        <p>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>4 additions</strong>
                and
                <strong>8 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL115" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR115" data-line-number="..."></td>
    <td>@@ -115,33 +115,29 @@ func hash_init(index: HashIndex*, len: uint32) {</td>
  </tr>

    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL115" data-line-number="115"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR115" data-line-number="115"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL116" data-line-number="116"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR116" data-line-number="116"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL117" data-line-number="117"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR117" data-line-number="117"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, stride: usize, size: usize): HashSlot* {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL118" data-line-number="118"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL120" data-line-number="120"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR118" data-line-number="118"></td>

  <td>
    <span data-code-marker="+">    <span>for</span> (i := h &amp; <span>index</span>.<span>mask</span>) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">        slot := &amp;<span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR120" data-line-number="120"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; <span>memcmp</span>(a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> slot;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL126" data-line-number="126"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (i == <span>n</span>) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (i == <span>alen</span><span>(</span><span>index</span><span>.</span><span>slots</span><span>)</span>) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL127" data-line-number="127"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker=" ">            i = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL128" data-line-number="128"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR126" data-line-number="126"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL129" data-line-number="129"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR127" data-line-number="127"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL130" data-line-number="130"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR128" data-line-number="128"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> <span>0</span>;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL131" data-line-number="131"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR129" data-line-number="129"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL132" data-line-number="132"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR130" data-line-number="130"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL133" data-line-number="133"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR131" data-line-number="131"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_put_slot</span>(index: HashIndex*, new_slot: HashSlot) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL134" data-line-number="134"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL135" data-line-number="135"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := new_slot.<span>h</span> &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL136" data-line-number="136"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR132" data-line-number="132"></td>

  <td>
    <span data-code-marker="+">    <span>for</span> (i := new_slot.<span>h</span> &amp; <span>index</span>.<span>mask</span>) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR133" data-line-number="133"></td>

  <td>
    <span data-code-marker=" ">        slot := &amp;<span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR134" data-line-number="134"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR135" data-line-number="135"></td>

  <td>
    <span data-code-marker=" ">            *slot = new_slot;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR136" data-line-number="136"></td>

  <td>
    <span data-code-marker=" ">            <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL141" data-line-number="141"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span>;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL142" data-line-number="142"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL143" data-line-number="143"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR139" data-line-number="139"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL144" data-line-number="144"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (i == <span>n</span>) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR140" data-line-number="140"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (i == <span>alen</span><span>(</span><span>index</span><span>.</span><span>slots</span><span>)</span>) {</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL145" data-line-number="145"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR141" data-line-number="141"></td>

  <td>
    <span data-code-marker=" ">            i = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL146" data-line-number="146"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR142" data-line-number="142"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="aafde3552cc0dd3c173a9ad45405cb55">
    <td id="diff-61baaa3fba81611f2145e330985325faL147" data-line-number="147"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR143" data-line-number="143"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL585" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR585" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-19T04:21:11Z" title="Feb 18, 2019, 8:21 PM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>4 additions</strong>
                and
                <strong>4 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL47" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR47" data-line-number="..."></td>
    <td>@@ -47,7 +47,7 @@ func null_free(data: void*) {</td>
  </tr>

    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL47" data-line-number="47"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR47" data-line-number="47"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL48" data-line-number="48"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR48" data-line-number="48"></td>

  <td>
    <span data-code-marker=" ">func <span>linear_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL49" data-line-number="49"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR49" data-line-number="49"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; len; i++) {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL50" data-line-number="50"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (<span>memcmp</span>(<span>(:</span><span>char</span><span>*)</span>a + i*stride, x, size) == <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR50" data-line-number="50"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (<span>memcmp</span>(a + i*stride, x, size) == <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL51" data-line-number="51"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR51" data-line-number="51"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL52" data-line-number="52"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR52" data-line-number="52"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL53" data-line-number="53"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR53" data-line-number="53"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL119" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR119" data-line-number="..."></td>
    <td>@@ -119,7 +119,7 @@ func hash_get_slot(index: HashIndex*, a: void const*, x: void const*, h: uint32,</td>
  </tr>

    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL120" data-line-number="120"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR120" data-line-number="120"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker=" ">        slot := &amp;<span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; <span>memcmp</span>(<span>(:</span><span>char</span><span>*)</span>a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; <span>memcmp</span>(a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> slot;</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



      <tr data-position="18">
    <td id="diff-61baaa3fba81611f2145e330985325faHL319" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR319" data-line-number="..."></td>
    <td>@@ -319,7 +319,7 @@ func apop(a: void*) {</td>
  </tr>

    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td id="diff-61baaa3fba81611f2145e330985325faL319" data-line-number="319"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR319" data-line-number="319"></td>

  <td>
    <span data-code-marker=" ">func <span>afill_func</span>(ap: <span>void</span>**, x: <span>void</span> <span>const</span>*, n: usize, elem_size: usize) {</span></td>
</tr>



    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td id="diff-61baaa3fba81611f2145e330985325faL320" data-line-number="320"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR320" data-line-number="320"></td>

  <td>
    <span data-code-marker=" ">    <span>afit_func</span>(ap, <span>alen</span>(*ap) + n, elem_size);</span></td>
</tr>



    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td id="diff-61baaa3fba81611f2145e330985325faL321" data-line-number="321"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR321" data-line-number="321"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td id="diff-61baaa3fba81611f2145e330985325faL322" data-line-number="322"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    p := <span>(:</span><span>char</span><span>*)</span>a + <span>alen</span>(a)*elem_size;</span></td>
</tr>



    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR322" data-line-number="322"></td>

  <td>
    <span data-code-marker="+">    p := a + <span>alen</span>(a)*elem_size;</span></td>
</tr>



    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td id="diff-61baaa3fba81611f2145e330985325faL323" data-line-number="323"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR323" data-line-number="323"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; n; i++) {</span></td>
</tr>



    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td id="diff-61baaa3fba81611f2145e330985325faL324" data-line-number="324"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR324" data-line-number="324"></td>

  <td>
    <span data-code-marker=" ">        <span>memcpy</span>(p, x, elem_size);</span></td>
</tr>



    <tr data-hunk="a2a9c0ae5eaa6699105f8b369c62925c">
    <td id="diff-61baaa3fba81611f2145e330985325faL325" data-line-number="325"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR325" data-line-number="325"></td>

  <td>
    <span data-code-marker=" ">        p += elem_size;</span></td>
</tr>



      <tr data-position="27">
    <td id="diff-61baaa3fba81611f2145e330985325faHL489" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR489" data-line-number="..."></td>
    <td>@@ -489,7 +489,7 @@ func iindex_func(ap: void**, new_index: Index, elem_size: usize, key_size: usize</td>
  </tr>

    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td id="diff-61baaa3fba81611f2145e330985325faL489" data-line-number="489"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR489" data-line-number="489"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>index</span> = new_index;</span></td>
</tr>



    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td id="diff-61baaa3fba81611f2145e330985325faL490" data-line-number="490"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR490" data-line-number="490"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td id="diff-61baaa3fba81611f2145e330985325faL491" data-line-number="491"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR491" data-line-number="491"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; n; i++) {</span></td>
</tr>



    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td id="diff-61baaa3fba81611f2145e330985325faL492" data-line-number="492"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index_set</span>(<span>index</span>, a, <span>(:</span><span>char</span><span>*)</span>a + i*elem_size, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR492" data-line-number="492"></td>

  <td>
    <span data-code-marker="+">        <span>index_set</span>(<span>index</span>, a, a + i*elem_size, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td id="diff-61baaa3fba81611f2145e330985325faL493" data-line-number="493"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR493" data-line-number="493"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td id="diff-61baaa3fba81611f2145e330985325faL494" data-line-number="494"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR494" data-line-number="494"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="991cdacf1ac266abae81cce00b1f43d1">
    <td id="diff-61baaa3fba81611f2145e330985325faL495" data-line-number="495"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR495" data-line-number="495"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL589" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR589" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T21:52:44Z" title="Feb 18, 2019, 1:52 PM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>8 additions</strong>
                and
                <strong>8 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL256" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR256" data-line-number="..."></td>
    <td>@@ -256,7 +256,7 @@ struct ArrayHdr {</td>
  </tr>

    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td id="diff-61baaa3fba81611f2145e330985325faL256" data-line-number="256"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR256" data-line-number="256"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td id="diff-61baaa3fba81611f2145e330985325faL257" data-line-number="257"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR257" data-line-number="257"></td>

  <td>
    <span data-code-marker=" ">func <span>ahdr</span>(a: <span>void</span>*): ArrayHdr* {</span></td>
</tr>



    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td id="diff-61baaa3fba81611f2145e330985325faL258" data-line-number="258"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR258" data-line-number="258"></td>

  <td>
    <span data-code-marker=" ">    #<span>foreign</span>(preamble = <span><span>"</span>#define ahdr(a) ((std_ArrayHdr *)((char *)(a) - offsetof(std_ArrayHdr, buf)))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td id="diff-61baaa3fba81611f2145e330985325faL259" data-line-number="259"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> a ? (:ArrayHdr*)(<span>(:</span><span>char</span><span>*)</span>a - <span>offsetof</span>(ArrayHdr, buf)) : <span>0</span>;</span></td>
</tr>



    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR259" data-line-number="259"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> a ? (:ArrayHdr*)(a - <span>offsetof</span>(ArrayHdr, buf)) : <span>0</span>;</span></td>
</tr>



    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td id="diff-61baaa3fba81611f2145e330985325faL260" data-line-number="260"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR260" data-line-number="260"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td id="diff-61baaa3fba81611f2145e330985325faL261" data-line-number="261"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR261" data-line-number="261"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="a69f45d162d21b3b1a0d480137daf393">
    <td id="diff-61baaa3fba81611f2145e330985325faL262" data-line-number="262"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR262" data-line-number="262"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL393" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR393" data-line-number="..."></td>
    <td>@@ -393,7 +393,7 @@ func adeln_func(a: void*, i: usize, n: usize, elem_size: usize) {</td>
  </tr>

    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL393" data-line-number="393"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR393" data-line-number="393"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i + n &gt; <span>alen</span>(a)) {</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL394" data-line-number="394"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR394" data-line-number="394"></td>

  <td>
    <span data-code-marker=" ">        n = <span>alen</span>(a) - i;</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL395" data-line-number="395"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR395" data-line-number="395"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL396" data-line-number="396"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>memmove</span>(<span>(:</span><span>char</span><span>*)</span>a + i*elem_size, <span>(:</span><span>char</span><span>*)</span>a + (i + n)*elem_size, (<span>alen</span>(a) - (i + n))*elem_size);</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR396" data-line-number="396"></td>

  <td>
    <span data-code-marker="+">    <span>memmove</span>(a + i*elem_size, a + (i + n)*elem_size, (<span>alen</span>(a) - (i + n))*elem_size);</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL397" data-line-number="397"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR397" data-line-number="397"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> -= n;</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL398" data-line-number="398"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR398" data-line-number="398"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL399" data-line-number="399"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR399" data-line-number="399"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="18">
    <td id="diff-61baaa3fba81611f2145e330985325faHL413" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR413" data-line-number="..."></td>
    <td>@@ -413,11 +413,11 @@ func acatn_func(ap: void**, src: void const*, src_len: usize, elem_size: usize)</td>
  </tr>

    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL413" data-line-number="413"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR413" data-line-number="413"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL414" data-line-number="414"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR414" data-line-number="414"></td>

  <td>
    <span data-code-marker=" ">    a_len := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL415" data-line-number="415"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR415" data-line-number="415"></td>

  <td>
    <span data-code-marker=" ">    <span>afit_func</span>(ap, a_len + src_len, elem_size);</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL416" data-line-number="416"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (a != *ap &amp;&amp; a &lt;= src &amp;&amp; <span>(:</span><span>char</span><span>*)</span>src &lt;= <span>(:</span><span>char</span><span>*)</span>a + a_len*elem_size) {</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL417" data-line-number="417"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        src = <span>(:</span><span>char</span><span>*)*</span>ap + (<span>(:</span><span>char</span><span>*)</span>src - <span>(:</span><span>char</span><span>*)</span>a);</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR416" data-line-number="416"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (a != *ap &amp;&amp; a &lt;= src &amp;&amp; src &lt;= a + a_len*elem_size) {</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR417" data-line-number="417"></td>

  <td>
    <span data-code-marker="+">        src = <span>*</span>ap + (src - a);</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL418" data-line-number="418"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR418" data-line-number="418"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL419" data-line-number="419"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR419" data-line-number="419"></td>

  <td>
    <span data-code-marker=" ">    a = *ap;</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL420" data-line-number="420"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>memmove</span>(<span>(:</span><span>char</span><span>*)</span>a + a_len*elem_size, src, src_len*elem_size);</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR420" data-line-number="420"></td>

  <td>
    <span data-code-marker="+">    <span>memmove</span>(a + a_len*elem_size, src, src_len*elem_size);</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL421" data-line-number="421"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR421" data-line-number="421"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> += src_len;</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL422" data-line-number="422"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR422" data-line-number="422"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="cd97489f2e994a021e7ec25a940dc522">
    <td id="diff-61baaa3fba81611f2145e330985325faL423" data-line-number="423"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR423" data-line-number="423"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="33">
    <td id="diff-61baaa3fba81611f2145e330985325faHL526" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR526" data-line-number="..."></td>
    <td>@@ -526,7 +526,7 @@ func iput_func(ap: void**, x: void const*, elem_size: usize, key_size: usize): u</td>
  </tr>

    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL526" data-line-number="526"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR526" data-line-number="526"></td>

  <td>
    <span data-code-marker=" ">        a = *ap;</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL527" data-line-number="527"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR527" data-line-number="527"></td>

  <td>
    <span data-code-marker=" ">        <span>ahdr</span>(a).<span>len</span>++;</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL528" data-line-number="528"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR528" data-line-number="528"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL529" data-line-number="529"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>memcpy</span>(<span>(:</span><span>char</span><span>*)</span>a + i*elem_size, x, elem_size);</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR529" data-line-number="529"></td>

  <td>
    <span data-code-marker="+">    <span>memcpy</span>(a + i*elem_size, x, elem_size);</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL530" data-line-number="530"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR530" data-line-number="530"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL531" data-line-number="531"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR531" data-line-number="531"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL532" data-line-number="532"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR532" data-line-number="532"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="42">
    <td id="diff-61baaa3fba81611f2145e330985325faHL541" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR541" data-line-number="..."></td>
    <td>@@ -541,8 +541,8 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL541" data-line-number="541"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR541" data-line-number="541"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span>;</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL542" data-line-number="542"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR542" data-line-number="542"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL543" data-line-number="543"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR543" data-line-number="543"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i &lt; n-<span>1</span>) {</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL544" data-line-number="544"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        p := <span>(:</span><span>char</span><span>*)</span>a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL545" data-line-number="545"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        q := <span>(:</span><span>char</span><span>*)</span>a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR544" data-line-number="544"></td>

  <td>
    <span data-code-marker="+">        p := a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR545" data-line-number="545"></td>

  <td>
    <span data-code-marker="+">        q := a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL546" data-line-number="546"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR546" data-line-number="546"></td>

  <td>
    <span data-code-marker=" ">        <span>index_set</span>(<span>index</span>, a, q, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL547" data-line-number="547"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR547" data-line-number="547"></td>

  <td>
    <span data-code-marker=" ">        <span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="d08327b89dcb2c531652f25d56f9616b">
    <td id="diff-61baaa3fba81611f2145e330985325faL548" data-line-number="548"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR548" data-line-number="548"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL589" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR589" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T17:20:02Z" title="Feb 18, 2019, 9:20 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>13 additions</strong>
                and
                <strong>13 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL1" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR1" data-line-number="..."></td>
    <td>@@ -1,4 +1,4 @@</td>
  </tr>

    <tr data-hunk="532b94bd44a460c37779892733792f28">
    <td id="diff-61baaa3fba81611f2145e330985325faL1" data-line-number="1"></td>

    <td></td>

  <td>
    <span data-code-marker="-">import libc</span></td>
</tr>



    <tr data-hunk="532b94bd44a460c37779892733792f28">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR1" data-line-number="1"></td>

  <td>
    <span data-code-marker="+">import libc<span> {...}</span></span></td>
</tr>



    <tr data-hunk="532b94bd44a460c37779892733792f28">
    <td id="diff-61baaa3fba81611f2145e330985325faL2" data-line-number="2"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR2" data-line-number="2"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="532b94bd44a460c37779892733792f28">
    <td id="diff-61baaa3fba81611f2145e330985325faL3" data-line-number="3"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR3" data-line-number="3"></td>

  <td>
    <span data-code-marker=" "><span>struct</span> Indexer {</span></td>
</tr>



    <tr data-hunk="532b94bd44a460c37779892733792f28">
    <td id="diff-61baaa3fba81611f2145e330985325faL4" data-line-number="4"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR4" data-line-number="4"></td>

  <td>
    <span data-code-marker=" ">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



      <tr data-position="6">
    <td id="diff-61baaa3fba81611f2145e330985325faHL47" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR47" data-line-number="..."></td>
    <td>@@ -47,7 +47,7 @@ func null_free(data: void*) {</td>
  </tr>

    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL47" data-line-number="47"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR47" data-line-number="47"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL48" data-line-number="48"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR48" data-line-number="48"></td>

  <td>
    <span data-code-marker=" ">func <span>linear_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL49" data-line-number="49"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR49" data-line-number="49"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; len; i++) {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL50" data-line-number="50"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (<span>libc.</span><span>memcmp</span>((:<span>char</span>*)a + i*stride, x, size) == <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR50" data-line-number="50"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (<span>memcmp</span>((:<span>char</span>*)a + i*stride, x, size) == <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL51" data-line-number="51"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR51" data-line-number="51"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL52" data-line-number="52"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR52" data-line-number="52"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="fff036e12ace6790e52e9a4972979583">
    <td id="diff-61baaa3fba81611f2145e330985325faL53" data-line-number="53"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR53" data-line-number="53"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



      <tr data-position="15">
    <td id="diff-61baaa3fba81611f2145e330985325faHL119" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR119" data-line-number="..."></td>
    <td>@@ -119,7 +119,7 @@ func hash_get_slot(index: HashIndex*, a: void const*, x: void const*, h: uint32,</td>
  </tr>

    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL120" data-line-number="120"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR120" data-line-number="120"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker=" ">        slot := &amp;<span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; <span>libc.</span><span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; <span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> slot;</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="1977ca408c82d6a9eefe6cee9ac4f6e9">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



      <tr data-position="24">
    <td id="diff-61baaa3fba81611f2145e330985325faHL284" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR284" data-line-number="..."></td>
    <td>@@ -284,7 +284,7 @@ func afree_func(ap: void**) {</td>
  </tr>

    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td id="diff-61baaa3fba81611f2145e330985325faL284" data-line-number="284"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR284" data-line-number="284"></td>

  <td>
    <span data-code-marker=" ">        #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td id="diff-61baaa3fba81611f2145e330985325faL285" data-line-number="285"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR285" data-line-number="285"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</span></td>
</tr>



    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td id="diff-61baaa3fba81611f2145e330985325faL286" data-line-number="286"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR286" data-line-number="286"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td id="diff-61baaa3fba81611f2145e330985325faL287" data-line-number="287"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>libc.</span><span>free</span>(<span>ahdr</span>(a));</span></td>
</tr>



    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR287" data-line-number="287"></td>

  <td>
    <span data-code-marker="+">    <span>free</span>(<span>ahdr</span>(a));</span></td>
</tr>



    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td id="diff-61baaa3fba81611f2145e330985325faL288" data-line-number="288"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR288" data-line-number="288"></td>

  <td>
    <span data-code-marker=" ">    *ap = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td id="diff-61baaa3fba81611f2145e330985325faL289" data-line-number="289"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR289" data-line-number="289"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="d2734b91638bf5a302b8d0e9391432a2">
    <td id="diff-61baaa3fba81611f2145e330985325faL290" data-line-number="290"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR290" data-line-number="290"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="33">
    <td id="diff-61baaa3fba81611f2145e330985325faHL321" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR321" data-line-number="..."></td>
    <td>@@ -321,7 +321,7 @@ func afill_func(ap: void**, x: void const*, n: usize, elem_size: usize) {</td>
  </tr>

    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td id="diff-61baaa3fba81611f2145e330985325faL321" data-line-number="321"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR321" data-line-number="321"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td id="diff-61baaa3fba81611f2145e330985325faL322" data-line-number="322"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR322" data-line-number="322"></td>

  <td>
    <span data-code-marker=" ">    p := (:<span>char</span>*)a + <span>alen</span>(a)*elem_size;</span></td>
</tr>



    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td id="diff-61baaa3fba81611f2145e330985325faL323" data-line-number="323"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR323" data-line-number="323"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; n; i++) {</span></td>
</tr>



    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td id="diff-61baaa3fba81611f2145e330985325faL324" data-line-number="324"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>libc.</span><span>memcpy</span>(p, x, elem_size);</span></td>
</tr>



    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR324" data-line-number="324"></td>

  <td>
    <span data-code-marker="+">        <span>memcpy</span>(p, x, elem_size);</span></td>
</tr>



    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td id="diff-61baaa3fba81611f2145e330985325faL325" data-line-number="325"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR325" data-line-number="325"></td>

  <td>
    <span data-code-marker=" ">        p += elem_size;</span></td>
</tr>



    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td id="diff-61baaa3fba81611f2145e330985325faL326" data-line-number="326"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR326" data-line-number="326"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="48fea8e9fa221ea75e29dd80c45268ff">
    <td id="diff-61baaa3fba81611f2145e330985325faL327" data-line-number="327"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR327" data-line-number="327"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> += n;</span></td>
</tr>



      <tr data-position="42">
    <td id="diff-61baaa3fba81611f2145e330985325faHL393" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR393" data-line-number="..."></td>
    <td>@@ -393,7 +393,7 @@ func adeln_func(a: void*, i: usize, n: usize, elem_size: usize) {</td>
  </tr>

    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL393" data-line-number="393"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR393" data-line-number="393"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i + n &gt; <span>alen</span>(a)) {</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL394" data-line-number="394"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR394" data-line-number="394"></td>

  <td>
    <span data-code-marker=" ">        n = <span>alen</span>(a) - i;</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL395" data-line-number="395"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR395" data-line-number="395"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL396" data-line-number="396"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>libc.</span><span>memmove</span>((:<span>char</span>*)a + i*elem_size, (:<span>char</span>*)a + (i + n)*elem_size, (<span>alen</span>(a) - (i + n))*elem_size);</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR396" data-line-number="396"></td>

  <td>
    <span data-code-marker="+">    <span>memmove</span>((:<span>char</span>*)a + i*elem_size, (:<span>char</span>*)a + (i + n)*elem_size, (<span>alen</span>(a) - (i + n))*elem_size);</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL397" data-line-number="397"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR397" data-line-number="397"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> -= n;</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL398" data-line-number="398"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR398" data-line-number="398"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="57c53806b31ab6da18e14fc95bf1c2c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL399" data-line-number="399"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR399" data-line-number="399"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="51">
    <td id="diff-61baaa3fba81611f2145e330985325faHL417" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR417" data-line-number="..."></td>
    <td>@@ -417,7 +417,7 @@ func acatn_func(ap: void**, src: void const*, src_len: usize, elem_size: usize)</td>
  </tr>

    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td id="diff-61baaa3fba81611f2145e330985325faL417" data-line-number="417"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR417" data-line-number="417"></td>

  <td>
    <span data-code-marker=" ">        src = (:<span>char</span>*)*ap + ((:<span>char</span>*)src - (:<span>char</span>*)a);</span></td>
</tr>



    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td id="diff-61baaa3fba81611f2145e330985325faL418" data-line-number="418"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR418" data-line-number="418"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td id="diff-61baaa3fba81611f2145e330985325faL419" data-line-number="419"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR419" data-line-number="419"></td>

  <td>
    <span data-code-marker=" ">    a = *ap;</span></td>
</tr>



    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td id="diff-61baaa3fba81611f2145e330985325faL420" data-line-number="420"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>libc.</span><span>memmove</span>((:<span>char</span>*)a + a_len*elem_size, src, src_len*elem_size);</span></td>
</tr>



    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR420" data-line-number="420"></td>

  <td>
    <span data-code-marker="+">    <span>memmove</span>((:<span>char</span>*)a + a_len*elem_size, src, src_len*elem_size);</span></td>
</tr>



    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td id="diff-61baaa3fba81611f2145e330985325faL421" data-line-number="421"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR421" data-line-number="421"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> += src_len;</span></td>
</tr>



    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td id="diff-61baaa3fba81611f2145e330985325faL422" data-line-number="422"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR422" data-line-number="422"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="859ee058f2433fea801ce78f57b981e8">
    <td id="diff-61baaa3fba81611f2145e330985325faL423" data-line-number="423"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR423" data-line-number="423"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="60">
    <td id="diff-61baaa3fba81611f2145e330985325faHL430" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR430" data-line-number="..."></td>
    <td>@@ -430,13 +430,13 @@ func aprintf_func(ap: char**, fmt: char const*, ...) {</td>
  </tr>

    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL430" data-line-number="430"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR430" data-line-number="430"></td>

  <td>
    <span data-code-marker=" ">    args: <span>va_list</span>;</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL431" data-line-number="431"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR431" data-line-number="431"></td>

  <td>
    <span data-code-marker=" ">    <span>va_start</span>(args, fmt);</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL432" data-line-number="432"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR432" data-line-number="432"></td>

  <td>
    <span data-code-marker=" ">    slack := <span>acap</span>(a) - <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL433" data-line-number="433"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    printed := <span>libc.</span><span>vsnprintf</span>(a + <span>alen</span>(a), slack, fmt, args) + <span>1</span>;</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR433" data-line-number="433"></td>

  <td>
    <span data-code-marker="+">    printed := <span>vsnprintf</span>(a + <span>alen</span>(a), slack, fmt, args) + <span>1</span>;</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL434" data-line-number="434"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR434" data-line-number="434"></td>

  <td>
    <span data-code-marker=" ">    <span>va_end</span>(args);</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL435" data-line-number="435"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR435" data-line-number="435"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (printed &gt; slack) {</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL436" data-line-number="436"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR436" data-line-number="436"></td>

  <td>
    <span data-code-marker=" ">        <span>afit</span>(a, <span>alen</span>(a) + printed);</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL437" data-line-number="437"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR437" data-line-number="437"></td>

  <td>
    <span data-code-marker=" ">        <span>va_start</span>(args, fmt);</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL438" data-line-number="438"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR438" data-line-number="438"></td>

  <td>
    <span data-code-marker=" ">        new_slack := <span>acap</span>(a) - <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL439" data-line-number="439"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        printed = <span>libc.</span><span>vsnprintf</span>(a + <span>alen</span>(a), new_slack, fmt, args) + <span>1</span>;</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR439" data-line-number="439"></td>

  <td>
    <span data-code-marker="+">        printed = <span>vsnprintf</span>(a + <span>alen</span>(a), new_slack, fmt, args) + <span>1</span>;</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL440" data-line-number="440"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR440" data-line-number="440"></td>

  <td>
    <span data-code-marker=" ">        <span>va_end</span>(args);</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL441" data-line-number="441"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR441" data-line-number="441"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="62d7d84735cd0ba686d35e4d6f08d988">
    <td id="diff-61baaa3fba81611f2145e330985325faL442" data-line-number="442"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR442" data-line-number="442"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> += printed - <span>1</span>;</span></td>
</tr>



      <tr data-position="76">
    <td id="diff-61baaa3fba81611f2145e330985325faHL457" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR457" data-line-number="..."></td>
    <td>@@ -457,12 +457,12 @@ func asetcap_func(ap: void**, new_cap: usize, elem_size: usize) {</td>
  </tr>

    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL457" data-line-number="457"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR457" data-line-number="457"></td>

  <td>
    <span data-code-marker=" ">    size := <span>offsetof</span>(ArrayHdr, buf) + new_cap*elem_size;</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL458" data-line-number="458"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR458" data-line-number="458"></td>

  <td>
    <span data-code-marker=" ">    hdr: ArrayHdr*;</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL459" data-line-number="459"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR459" data-line-number="459"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (a) {</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL460" data-line-number="460"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        hdr = <span>libc.</span><span>realloc</span>(<span>ahdr</span>(a), size);</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR460" data-line-number="460"></td>

  <td>
    <span data-code-marker="+">        hdr = <span>realloc</span>(<span>ahdr</span>(a), size);</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL461" data-line-number="461"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR461" data-line-number="461"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (hdr.<span>len</span> &gt; new_cap) {</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL462" data-line-number="462"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR462" data-line-number="462"></td>

  <td>
    <span data-code-marker=" ">            hdr.<span>len</span> = new_cap;</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL463" data-line-number="463"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR463" data-line-number="463"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL464" data-line-number="464"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR464" data-line-number="464"></td>

  <td>
    <span data-code-marker=" ">    } <span>else</span> {</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL465" data-line-number="465"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        hdr = <span>libc.</span><span>malloc</span>(size);</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR465" data-line-number="465"></td>

  <td>
    <span data-code-marker="+">        hdr = <span>malloc</span>(size);</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL466" data-line-number="466"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR466" data-line-number="466"></td>

  <td>
    <span data-code-marker=" ">        hdr.<span>len</span> = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL467" data-line-number="467"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR467" data-line-number="467"></td>

  <td>
    <span data-code-marker=" ">        hdr.<span>index</span> = {indexer = default_indexer};</span></td>
</tr>



    <tr data-hunk="2bea18d7b163c54256528b13663bc50f">
    <td id="diff-61baaa3fba81611f2145e330985325faL468" data-line-number="468"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR468" data-line-number="468"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



      <tr data-position="91">
    <td id="diff-61baaa3fba81611f2145e330985325faHL526" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR526" data-line-number="..."></td>
    <td>@@ -526,7 +526,7 @@ func iput_func(ap: void**, x: void const*, elem_size: usize, key_size: usize): u</td>
  </tr>

    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL526" data-line-number="526"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR526" data-line-number="526"></td>

  <td>
    <span data-code-marker=" ">        a = *ap;</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL527" data-line-number="527"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR527" data-line-number="527"></td>

  <td>
    <span data-code-marker=" ">        <span>ahdr</span>(a).<span>len</span>++;</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL528" data-line-number="528"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR528" data-line-number="528"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL529" data-line-number="529"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>libc.</span><span>memcpy</span>((:<span>char</span>*)a + i*elem_size, x, elem_size);</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR529" data-line-number="529"></td>

  <td>
    <span data-code-marker="+">    <span>memcpy</span>((:<span>char</span>*)a + i*elem_size, x, elem_size);</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL530" data-line-number="530"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR530" data-line-number="530"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL531" data-line-number="531"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR531" data-line-number="531"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="379d1886a0d46d586839b7040f3a974b">
    <td id="diff-61baaa3fba81611f2145e330985325faL532" data-line-number="532"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR532" data-line-number="532"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="100">
    <td id="diff-61baaa3fba81611f2145e330985325faHL544" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR544" data-line-number="..."></td>
    <td>@@ -544,7 +544,7 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td id="diff-61baaa3fba81611f2145e330985325faL544" data-line-number="544"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR544" data-line-number="544"></td>

  <td>
    <span data-code-marker=" ">        p := (:<span>char</span>*)a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td id="diff-61baaa3fba81611f2145e330985325faL545" data-line-number="545"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR545" data-line-number="545"></td>

  <td>
    <span data-code-marker=" ">        q := (:<span>char</span>*)a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td id="diff-61baaa3fba81611f2145e330985325faL546" data-line-number="546"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR546" data-line-number="546"></td>

  <td>
    <span data-code-marker=" ">        <span>index_set</span>(<span>index</span>, a, q, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td id="diff-61baaa3fba81611f2145e330985325faL547" data-line-number="547"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>libc.</span><span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR547" data-line-number="547"></td>

  <td>
    <span data-code-marker="+">        <span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td id="diff-61baaa3fba81611f2145e330985325faL548" data-line-number="548"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR548" data-line-number="548"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td id="diff-61baaa3fba81611f2145e330985325faL549" data-line-number="549"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR549" data-line-number="549"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span>--;</span></td>
</tr>



    <tr data-hunk="3e9d0d27cf8754057b1e5235f86a1e1a">
    <td id="diff-61baaa3fba81611f2145e330985325faL550" data-line-number="550"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR550" data-line-number="550"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL589" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR589" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T16:57:05Z" title="Feb 18, 2019, 8:57 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>2 additions</strong>
                and
                <strong>2 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL83" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR83" data-line-number="..."></td>
    <td>@@ -83,7 +83,7 @@ const HASH_MIN_SLOTS: uint32 = 16;</td>
  </tr>

    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td id="diff-61baaa3fba81611f2145e330985325faL83" data-line-number="83"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR83" data-line-number="83"></td>

  <td>
    <span data-code-marker=" ">func <span>hash</span>(buf: <span>void</span> <span>const</span>*, size: usize): uint64 {</span></td>
</tr>



    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td id="diff-61baaa3fba81611f2145e330985325faL84" data-line-number="84"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR84" data-line-number="84"></td>

  <td>
    <span data-code-marker=" ">    h: uint64 = <span>0xcbf29ce484222325</span>;</span></td>
</tr>



    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td id="diff-61baaa3fba81611f2145e330985325faL85" data-line-number="85"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR85" data-line-number="85"></td>

  <td>
    <span data-code-marker=" ">    ptr: <span>char</span> <span>const</span>* = buf;</span></td>
</tr>



    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td id="diff-61baaa3fba81611f2145e330985325faL86" data-line-number="86"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>for</span> (i<span>: usize </span>= <span>0</span>; i &lt; size; i++) {</span></td>
</tr>



    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR86" data-line-number="86"></td>

  <td>
    <span data-code-marker="+">    <span>for</span> (i<span> :</span>= <span>0</span>; i &lt; size; i++) {</span></td>
</tr>



    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td id="diff-61baaa3fba81611f2145e330985325faL87" data-line-number="87"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR87" data-line-number="87"></td>

  <td>
    <span data-code-marker=" ">        h ^= *ptr++;</span></td>
</tr>



    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td id="diff-61baaa3fba81611f2145e330985325faL88" data-line-number="88"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR88" data-line-number="88"></td>

  <td>
    <span data-code-marker=" ">        h *= <span>0x100000001b3</span>;</span></td>
</tr>



    <tr data-hunk="5cc3feaa3c88fe6f5628ebe194cc0695">
    <td id="diff-61baaa3fba81611f2145e330985325faL89" data-line-number="89"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR89" data-line-number="89"></td>

  <td>
    <span data-code-marker=" ">        h ^= h &gt;&gt; <span>32</span>;</span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL212" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR212" data-line-number="..."></td>
    <td>@@ -212,7 +212,7 @@ func hash_rehash(index: HashIndex*, len: uint32) {</td>
  </tr>

    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td id="diff-61baaa3fba81611f2145e330985325faL212" data-line-number="212"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR212" data-line-number="212"></td>

  <td>
    <span data-code-marker=" ">    <span>hash_init</span>(&amp;new_index, len);</span></td>
</tr>



    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td id="diff-61baaa3fba81611f2145e330985325faL213" data-line-number="213"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR213" data-line-number="213"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; <span>alen</span>(<span>index</span>.<span>slots</span>); i++) {</span></td>
</tr>



    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td id="diff-61baaa3fba81611f2145e330985325faL214" data-line-number="214"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR214" data-line-number="214"></td>

  <td>
    <span data-code-marker=" ">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td id="diff-61baaa3fba81611f2145e330985325faL215" data-line-number="215"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (slot.<span>i</span> <span>!= HASH_EMPTY &amp;&amp; slot.</span><span>i</span><span> !=</span> HASH_DELETED) {</span></td>
</tr>



    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR215" data-line-number="215"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (slot.<span>i</span> <span>&lt;</span> HASH_DELETED) {</span></td>
</tr>



    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td id="diff-61baaa3fba81611f2145e330985325faL216" data-line-number="216"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR216" data-line-number="216"></td>

  <td>
    <span data-code-marker=" ">            <span>hash_put_slot</span>(&amp;new_index, slot);</span></td>
</tr>



    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td id="diff-61baaa3fba81611f2145e330985325faL217" data-line-number="217"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR217" data-line-number="217"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="54cc07e7d830cc4c66942666cd512e74">
    <td id="diff-61baaa3fba81611f2145e330985325faL218" data-line-number="218"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR218" data-line-number="218"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL589" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR589" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T14:42:34Z" title="Feb 18, 2019, 6:42 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>35 additions</strong>
                and
                <strong>24 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL236" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR236" data-line-number="..."></td>
    <td>@@ -236,7 +236,15 @@ func hash_index(): Index {</td>
  </tr>

    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td id="diff-61baaa3fba81611f2145e330985325faL236" data-line-number="236"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR236" data-line-number="236"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> Index{data = <span>index</span>, indexer = hash_indexer};</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td id="diff-61baaa3fba81611f2145e330985325faL237" data-line-number="237"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR237" data-line-number="237"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td id="diff-61baaa3fba81611f2145e330985325faL238" data-line-number="238"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR238" data-line-number="238"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td id="diff-61baaa3fba81611f2145e330985325faL239" data-line-number="239"></td>

    <td></td>

  <td>
    <span data-code-marker="-">var default_indexer = &amp;linear_indexer_const;</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR239" data-line-number="239"></td>

  <td>
    <span data-code-marker="+">var default_indexer_const = Indexer{</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR240" data-line-number="240"></td>

  <td>
    <span data-code-marker="+">    get = linear_get,</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR241" data-line-number="241"></td>

  <td>
    <span data-code-marker="+">    put = linear_get,</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR242" data-line-number="242"></td>

  <td>
    <span data-code-marker="+">    del = linear_get,</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR243" data-line-number="243"></td>

  <td>
    <span data-code-marker="+">    set = null_set,</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR244" data-line-number="244"></td>

  <td>
    <span data-code-marker="+">    <span>free</span> = null_free,</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR245" data-line-number="245"></td>

  <td>
    <span data-code-marker="+">};</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR246" data-line-number="246"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR247" data-line-number="247"></td>

  <td>
    <span data-code-marker="+">var default_indexer = &amp;default_indexer_const;</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td id="diff-61baaa3fba81611f2145e330985325faL240" data-line-number="240"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR248" data-line-number="248"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td id="diff-61baaa3fba81611f2145e330985325faL241" data-line-number="241"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR249" data-line-number="249"></td>

  <td>
    <span data-code-marker=" "><span>struct</span> ArrayHdr {</span></td>
</tr>



    <tr data-hunk="b238a93a4161bac208e751156e977458">
    <td id="diff-61baaa3fba81611f2145e330985325faL242" data-line-number="242"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR250" data-line-number="250"></td>

  <td>
    <span data-code-marker=" ">    len: usize;</span></td>
</tr>



      <tr data-position="17">
    <td id="diff-61baaa3fba81611f2145e330985325faHL262" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR270" data-line-number="..."></td>
    <td>@@ -262,13 +270,28 @@ func acap(a: void*): usize {</td>
  </tr>

    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL262" data-line-number="262"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR270" data-line-number="270"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL263" data-line-number="263"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR271" data-line-number="271"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL264" data-line-number="264"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR272" data-line-number="272"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL265" data-line-number="265"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>afree</span>(a: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR273" data-line-number="273"></td>

  <td>
    <span data-code-marker="+">func <span>aclear</span>(a: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR274" data-line-number="274"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (a) {</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR275" data-line-number="275"></td>

  <td>
    <span data-code-marker="+">        <span>ahdr</span>(a).<span>len</span> = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR276" data-line-number="276"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR277" data-line-number="277"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR278" data-line-number="278"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR279" data-line-number="279"></td>

  <td>
    <span data-code-marker="+">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR280" data-line-number="280"></td>

  <td>
    <span data-code-marker="+">func <span>afree_func</span>(ap: <span>void</span>**) {</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR281" data-line-number="281"></td>

  <td>
    <span data-code-marker="+">    a := *ap;</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL266" data-line-number="266"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR282" data-line-number="282"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (a) {</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL267" data-line-number="267"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR283" data-line-number="283"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL268" data-line-number="268"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR284" data-line-number="284"></td>

  <td>
    <span data-code-marker=" ">        #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL269" data-line-number="269"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR285" data-line-number="285"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL270" data-line-number="270"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR286" data-line-number="286"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL271" data-line-number="271"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR287" data-line-number="287"></td>

  <td>
    <span data-code-marker=" ">    libc.<span>free</span>(<span>ahdr</span>(a));</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR288" data-line-number="288"></td>

  <td>
    <span data-code-marker="+">    *ap = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR289" data-line-number="289"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR290" data-line-number="290"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR291" data-line-number="291"></td>

  <td>
    <span data-code-marker="+">@foreign</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR292" data-line-number="292"></td>

  <td>
    <span data-code-marker="+">func <span>afree</span>(a: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR293" data-line-number="293"></td>

  <td>
    <span data-code-marker="+">    afree_func;</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR294" data-line-number="294"></td>

  <td>
    <span data-code-marker="+">    #<span>foreign</span>(preamble = <span><span>"</span>#define afree(a) std_afree_func(&amp;(a))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL272" data-line-number="272"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR295" data-line-number="295"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL273" data-line-number="273"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR296" data-line-number="296"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="638efd3d8a3f751e74a84d2190344680">
    <td id="diff-61baaa3fba81611f2145e330985325faL274" data-line-number="274"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR297" data-line-number="297"></td>

  <td>
    <span data-code-marker=" ">func <span>aalloc_func</span>(): void* {</span></td>
</tr>



      <tr data-position="47">
    <td id="diff-61baaa3fba81611f2145e330985325faHL390" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR413" data-line-number="..."></td>
    <td>@@ -390,6 +413,9 @@ func acatn_func(ap: void**, src: void const*, src_len: usize, elem_size: usize)</td>
  </tr>

    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td id="diff-61baaa3fba81611f2145e330985325faL390" data-line-number="390"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR413" data-line-number="413"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td id="diff-61baaa3fba81611f2145e330985325faL391" data-line-number="391"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR414" data-line-number="414"></td>

  <td>
    <span data-code-marker=" ">    a_len := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td id="diff-61baaa3fba81611f2145e330985325faL392" data-line-number="392"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR415" data-line-number="415"></td>

  <td>
    <span data-code-marker=" ">    <span>afit_func</span>(ap, a_len + src_len, elem_size);</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR416" data-line-number="416"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (a != *ap &amp;&amp; a &lt;= src &amp;&amp; (:<span>char</span>*)src &lt;= (:<span>char</span>*)a + a_len*elem_size) {</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR417" data-line-number="417"></td>

  <td>
    <span data-code-marker="+">        src = (:<span>char</span>*)*ap + ((:<span>char</span>*)src - (:<span>char</span>*)a);</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR418" data-line-number="418"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td id="diff-61baaa3fba81611f2145e330985325faL393" data-line-number="393"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR419" data-line-number="419"></td>

  <td>
    <span data-code-marker=" ">    a = *ap;</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td id="diff-61baaa3fba81611f2145e330985325faL394" data-line-number="394"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR420" data-line-number="420"></td>

  <td>
    <span data-code-marker=" ">    libc.<span>memmove</span>((:<span>char</span>*)a + a_len*elem_size, src, src_len*elem_size);</span></td>
</tr>



    <tr data-hunk="3c3e04db16dbeca5648218014bf1c2a3">
    <td id="diff-61baaa3fba81611f2145e330985325faL395" data-line-number="395"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR421" data-line-number="421"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> += src_len;</span></td>
</tr>



      <tr data-position="57">
    <td id="diff-61baaa3fba81611f2145e330985325faHL402" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR428" data-line-number="..."></td>
    <td>@@ -402,16 +428,16 @@ func acat_func(ap: void**, src: void*, elem_size: usize) {</td>
  </tr>

    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL402" data-line-number="402"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR428" data-line-number="428"></td>

  <td>
    <span data-code-marker=" ">func <span>aprintf_func</span>(ap: <span>char</span>**, fmt: <span>char</span> <span>const</span>*, ...) {</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL403" data-line-number="403"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR429" data-line-number="429"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL404" data-line-number="404"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR430" data-line-number="430"></td>

  <td>
    <span data-code-marker=" ">    args: <span>va_list</span>;</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL405" data-line-number="405"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>va_start</span>(<span>&amp;</span>args, <span>&amp;</span>fmt);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR431" data-line-number="431"></td>

  <td>
    <span data-code-marker="+">    <span>va_start</span>(args, fmt);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL406" data-line-number="406"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR432" data-line-number="432"></td>

  <td>
    <span data-code-marker=" ">    slack := <span>acap</span>(a) - <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL407" data-line-number="407"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR433" data-line-number="433"></td>

  <td>
    <span data-code-marker=" ">    printed := libc.<span>vsnprintf</span>(a + <span>alen</span>(a), slack, fmt, args) + <span>1</span>;</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL408" data-line-number="408"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>va_end</span>(<span>&amp;</span>args);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR434" data-line-number="434"></td>

  <td>
    <span data-code-marker="+">    <span>va_end</span>(args);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL409" data-line-number="409"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR435" data-line-number="435"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (printed &gt; slack) {</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL410" data-line-number="410"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR436" data-line-number="436"></td>

  <td>
    <span data-code-marker=" ">        <span>afit</span>(a, <span>alen</span>(a) + printed);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL411" data-line-number="411"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>va_start</span>(<span>&amp;</span>args, <span>&amp;</span>fmt);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR437" data-line-number="437"></td>

  <td>
    <span data-code-marker="+">        <span>va_start</span>(args, fmt);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL412" data-line-number="412"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR438" data-line-number="438"></td>

  <td>
    <span data-code-marker=" ">        new_slack := <span>acap</span>(a) - <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL413" data-line-number="413"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR439" data-line-number="439"></td>

  <td>
    <span data-code-marker=" ">        printed = libc.<span>vsnprintf</span>(a + <span>alen</span>(a), new_slack, fmt, args) + <span>1</span>;</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL414" data-line-number="414"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>va_end</span>(<span>&amp;</span>args);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR440" data-line-number="440"></td>

  <td>
    <span data-code-marker="+">        <span>va_end</span>(args);</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL415" data-line-number="415"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR441" data-line-number="441"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL416" data-line-number="416"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR442" data-line-number="442"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span> += printed - <span>1</span>;</span></td>
</tr>



    <tr data-hunk="0067c13dd4921abd776419d954f0256a">
    <td id="diff-61baaa3fba81611f2145e330985325faL417" data-line-number="417"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR443" data-line-number="443"></td>

  <td>
    <span data-code-marker=" ">    *ap = a;</span></td>
</tr>



      <tr data-position="78">
    <td id="diff-61baaa3fba81611f2145e330985325faHL428" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR454" data-line-number="..."></td>
    <td>@@ -428,7 +454,7 @@ func asetcap_func(ap: void**, new_cap: usize, elem_size: usize) {</td>
  </tr>

    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL428" data-line-number="428"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR454" data-line-number="454"></td>

  <td>
    <span data-code-marker=" ">            new_cap = cap + cap/<span>2</span>;</span></td>
</tr>



    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL429" data-line-number="429"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR455" data-line-number="455"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL430" data-line-number="430"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR456" data-line-number="456"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL431" data-line-number="431"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    size := <span>sizeof</span>(ArrayHdr) + new_cap*elem_size;</span></td>
</tr>



    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR457" data-line-number="457"></td>

  <td>
    <span data-code-marker="+">    size := <span>offsetof</span>(ArrayHdr<span>, buf</span>) + new_cap*elem_size;</span></td>
</tr>



    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL432" data-line-number="432"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR458" data-line-number="458"></td>

  <td>
    <span data-code-marker=" ">    hdr: ArrayHdr*;</span></td>
</tr>



    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL433" data-line-number="433"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR459" data-line-number="459"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (a) {</span></td>
</tr>



    <tr data-hunk="037dc7c766f0e9e292c3559ce5bd2dcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL434" data-line-number="434"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR460" data-line-number="460"></td>

  <td>
    <span data-code-marker=" ">        hdr = libc.<span>realloc</span>(<span>ahdr</span>(a), size);</span></td>
</tr>



      <tr data-position="87">
    <td id="diff-61baaa3fba81611f2145e330985325faHL451" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR477" data-line-number="..."></td>
    <td>@@ -451,16 +477,6 @@ func afit_func(ap: void**, min_cap: usize, elem_size: usize) {</td>
  </tr>

    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL451" data-line-number="451"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR477" data-line-number="477"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL452" data-line-number="452"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR478" data-line-number="478"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL453" data-line-number="453"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR479" data-line-number="479"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL454" data-line-number="454"></td>

    <td></td>

  <td>
    <span data-code-marker="-">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL455" data-line-number="455"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>klen</span>(a: <span>void</span>*): usize {</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL456" data-line-number="456"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL457" data-line-number="457"></td>

    <td></td>

  <td>
    <span data-code-marker="-">}</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL458" data-line-number="458"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL459" data-line-number="459"></td>

    <td></td>

  <td>
    <span data-code-marker="-">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL460" data-line-number="460"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>kfree</span>(a: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL461" data-line-number="461"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>afree</span>(a);</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL462" data-line-number="462"></td>

    <td></td>

  <td>
    <span data-code-marker="-">}</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL463" data-line-number="463"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL464" data-line-number="464"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR480" data-line-number="480"></td>

  <td>
    <span data-code-marker=" ">func <span>iindex_func</span>(ap: <span>void</span>**, new_index: Index, elem_size: usize, key_size: usize) {</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL465" data-line-number="465"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR481" data-line-number="481"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



    <tr data-hunk="34d183015abcac7aa4c69850b2933630">
    <td id="diff-61baaa3fba81611f2145e330985325faL466" data-line-number="466"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR482" data-line-number="482"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (!a) {</span></td>
</tr>



      <tr data-position="104">
    <td id="diff-61baaa3fba81611f2145e330985325faHL547" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR563" data-line-number="..."></td>
    <td>@@ -547,14 +563,9 @@ func kget(a: void*, x: void): usize {</td>
  </tr>

    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL547" data-line-number="547"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR563" data-line-number="563"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL548" data-line-number="548"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR564" data-line-number="564"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL549" data-line-number="549"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR565" data-line-number="565"></td>

  <td>
    <span data-code-marker=" ">@foreign @intrinsic</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL550" data-line-number="550"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>kadd</span>(a: <span>void</span>*, x: <span>void</span>) {</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR566" data-line-number="566"></td>

  <td>
    <span data-code-marker="+">func <span>kput</span>(a: <span>void</span>*, x: <span>void</span>) {</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL551" data-line-number="551"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR567" data-line-number="567"></td>

  <td>
    <span data-code-marker=" ">    iput_func;</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL552" data-line-number="552"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>foreign</span>(preamble = <span><span>"</span>#define kadd(t, a, x) std_iput_func(&amp;(a), (t[]){x}, sizeof(t), sizeof(t))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL553" data-line-number="553"></td>

    <td></td>

  <td>
    <span data-code-marker="-">}</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL554" data-line-number="554"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL555" data-line-number="555"></td>

    <td></td>

  <td>
    <span data-code-marker="-">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL556" data-line-number="556"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hlen</span>(a: <span>void</span>*): usize {</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL557" data-line-number="557"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR568" data-line-number="568"></td>

  <td>
    <span data-code-marker="+">    #<span>foreign</span>(preamble = <span><span>"</span>#define kput(t, a, x) std_iput_func(&amp;(a), (t[]){x}, sizeof(t), sizeof(t))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL558" data-line-number="558"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR569" data-line-number="569"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL559" data-line-number="559"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR570" data-line-number="570"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="1bd6b22f2bf852bb53edbaeb352377c2">
    <td id="diff-61baaa3fba81611f2145e330985325faL560" data-line-number="560"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR571" data-line-number="571"></td>

  <td>
    <span data-code-marker=" ">@foreign @intrinsic</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL589" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR589" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T10:17:20Z" title="Feb 18, 2019, 2:17 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>1 addition</strong>
                and
                <strong>1 deletion</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL192" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR192" data-line-number="..."></td>
    <td>@@ -192,7 +192,7 @@ func hash_set(data: void*, a: void const*, x: void const*, xi: usize, len: usize</td>
  </tr>

    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker=" ">    i := slot.<span>i</span>;</span></td>
</tr>



    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td id="diff-61baaa3fba81611f2145e330985325faL195" data-line-number="195"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    slot<span>.</span><span>i</span> = <span>xi</span>;</span></td>
</tr>



    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker="+">    <span>*</span>slot = <span>{xi, h}</span>;</span></td>
</tr>



    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td id="diff-61baaa3fba81611f2145e330985325faL196" data-line-number="196"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td id="diff-61baaa3fba81611f2145e330985325faL197" data-line-number="197"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="66f82ce49b580e8f1e06ced8e8449ed8">
    <td id="diff-61baaa3fba81611f2145e330985325faL198" data-line-number="198"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR198" data-line-number="198"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL578" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR578" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T10:15:55Z" title="Feb 18, 2019, 2:15 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>7 additions</strong>
                and
                <strong>0 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL191" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR191" data-line-number="..."></td>
    <td>@@ -191,7 +191,14 @@ func hash_set(data: void*, a: void const*, x: void const*, xi: usize, len: usize</td>
  </tr>

    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td id="diff-61baaa3fba81611f2145e330985325faL191" data-line-number="191"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker="+">    i := slot.<span>i</span>;</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker=" ">    slot.<span>i</span> = xi;</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (i == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker="+">        <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR198" data-line-number="198"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR199" data-line-number="199"></td>

  <td>
    <span data-code-marker="+">            <span>hash_rehash</span>(<span>index</span>, len + <span>1</span>);</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR200" data-line-number="200"></td>

  <td>
    <span data-code-marker="+">        }</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR201" data-line-number="201"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td id="diff-61baaa3fba81611f2145e330985325faL195" data-line-number="195"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR202" data-line-number="202"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td id="diff-61baaa3fba81611f2145e330985325faL196" data-line-number="196"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR203" data-line-number="203"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="cf3aefc63d0c2c11c9f8033eda9d6bae">
    <td id="diff-61baaa3fba81611f2145e330985325faL197" data-line-number="197"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR204" data-line-number="204"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_free</span>(data: <span>void</span>*) {</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL578" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR578" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T10:09:48Z" title="Feb 18, 2019, 2:09 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>1 addition</strong>
                and
                <strong>3 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL191" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR191" data-line-number="..."></td>
    <td>@@ -191,9 +191,7 @@ func hash_set(data: void*, a: void const*, x: void const*, xi: usize, len: usize</td>
  </tr>

    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL191" data-line-number="191"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL195" data-line-number="195"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        slot.<span>i</span> = xi;</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL196" data-line-number="196"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    }</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker="+">    slot.<span>i</span> = xi;</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL197" data-line-number="197"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL198" data-line-number="198"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="ba51719d1a191656ba117c4856730ab0">
    <td id="diff-61baaa3fba81611f2145e330985325faL199" data-line-number="199"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_free</span>(data: <span>void</span>*) {</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL571" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR571" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T10:06:10Z" title="Feb 18, 2019, 2:06 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>4 additions</strong>
                and
                <strong>4 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL118" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR118" data-line-number="..."></td>
    <td>@@ -118,9 +118,9 @@ func hash_get_slot(index: HashIndex*, a: void const*, x: void const*, h: uint32,</td>
  </tr>

    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL118" data-line-number="118"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR118" data-line-number="118"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL120" data-line-number="120"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR120" data-line-number="120"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker="+">        slot := <span>&amp;</span><span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; libc.<span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>return</span> <span>&amp;</span><span>index</span><span>.</span><span>slots</span><span>[i]</span>;</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker="+">            <span>return</span> <span>slot</span>;</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



    <tr data-hunk="ca630eccb828e9e219591156d226be43">
    <td id="diff-61baaa3fba81611f2145e330985325faL126" data-line-number="126"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR126" data-line-number="126"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (i == n) {</span></td>
</tr>



      <tr data-position="12">
    <td id="diff-61baaa3fba81611f2145e330985325faHL134" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR134" data-line-number="..."></td>
    <td>@@ -134,9 +134,9 @@ func hash_put_slot(index: HashIndex*, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL134" data-line-number="134"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR134" data-line-number="134"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL135" data-line-number="135"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR135" data-line-number="135"></td>

  <td>
    <span data-code-marker=" ">    i := new_slot.<span>h</span> &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL136" data-line-number="136"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR136" data-line-number="136"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker="+">        slot := <span>&amp;</span><span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>index</span><span>.</span><span>slots</span><span>[i]</span> = new_slot;</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR139" data-line-number="139"></td>

  <td>
    <span data-code-marker="+">            <span>*slot</span> = new_slot;</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR140" data-line-number="140"></td>

  <td>
    <span data-code-marker=" ">            <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL141" data-line-number="141"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR141" data-line-number="141"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span>;</span></td>
</tr>



    <tr data-hunk="53dba81e00b16d240a09222e1c8d4a19">
    <td id="diff-61baaa3fba81611f2145e330985325faL142" data-line-number="142"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR142" data-line-number="142"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL573" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR573" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T10:01:41Z" title="Feb 18, 2019, 2:01 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>12 additions</strong>
                and
                <strong>14 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL30" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR30" data-line-number="..."></td>
    <td>@@ -30,6 +30,7 @@ func index_del(index: Index, a: void const*, x: void const*, len: usize, stride:</td>
  </tr>

    <tr data-hunk="030057dbe6f8011f4b8b5f8325aa1def">
    <td id="diff-61baaa3fba81611f2145e330985325faL30" data-line-number="30"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR30" data-line-number="30"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="030057dbe6f8011f4b8b5f8325aa1def">
    <td id="diff-61baaa3fba81611f2145e330985325faL31" data-line-number="31"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR31" data-line-number="31"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="030057dbe6f8011f4b8b5f8325aa1def">
    <td id="diff-61baaa3fba81611f2145e330985325faL32" data-line-number="32"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR32" data-line-number="32"></td>

  <td>
    <span data-code-marker=" ">func <span>index_set</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, xi: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="030057dbe6f8011f4b8b5f8325aa1def">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR33" data-line-number="33"></td>

  <td>
    <span data-code-marker="+">    #<span>assert</span>(xi &lt; len);</span></td>
</tr>



    <tr data-hunk="030057dbe6f8011f4b8b5f8325aa1def">
    <td id="diff-61baaa3fba81611f2145e330985325faL33" data-line-number="33"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR34" data-line-number="34"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>indexer</span>.<span>set</span>(<span>index</span>.<span>data</span>, a, x, xi, len, stride, size);</span></td>
</tr>



    <tr data-hunk="030057dbe6f8011f4b8b5f8325aa1def">
    <td id="diff-61baaa3fba81611f2145e330985325faL34" data-line-number="34"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR35" data-line-number="35"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="030057dbe6f8011f4b8b5f8325aa1def">
    <td id="diff-61baaa3fba81611f2145e330985325faL35" data-line-number="35"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR36" data-line-number="36"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="8">
    <td id="diff-61baaa3fba81611f2145e330985325faHL113" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR114" data-line-number="..."></td>
    <td>@@ -113,13 +114,13 @@ func hash_init(index: HashIndex*, len: uint32) {</td>
  </tr>

    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL113" data-line-number="113"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR114" data-line-number="114"></td>

  <td>
    <span data-code-marker=" ">    <span>afill</span>(<span>index</span>.<span>slots</span>, {HASH_EMPTY}, num_slots);</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL114" data-line-number="114"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR115" data-line-number="115"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL115" data-line-number="115"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR116" data-line-number="116"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL116" data-line-number="116"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, stride: usize, size: usize): <span>usize</span> {</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR117" data-line-number="117"></td>

  <td>
    <span data-code-marker="+">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, stride: usize, size: usize): <span>HashSlot*</span> {</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL117" data-line-number="117"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR118" data-line-number="118"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL118" data-line-number="118"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR120" data-line-number="120"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL120" data-line-number="120"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker=" ">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; libc.<span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>return</span> <span>i</span>;</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker="+">            <span>return</span> <span>&amp;</span><span>index</span><span>.</span><span>slots</span><span>[i]</span>;</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



    <tr data-hunk="a297c36fd127d183a093c2b65e7e743f">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR126" data-line-number="126"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (i == n) {</span></td>
</tr>



      <tr data-position="24">
    <td id="diff-61baaa3fba81611f2145e330985325faHL149" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR150" data-line-number="..."></td>
    <td>@@ -149,8 +150,7 @@ func hash_put_slot(index: HashIndex*, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL149" data-line-number="149"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR150" data-line-number="150"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL150" data-line-number="150"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR151" data-line-number="151"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL151" data-line-number="151"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR152" data-line-number="152"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL152" data-line-number="152"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL153" data-line-number="153"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR153" data-line-number="153"></td>

  <td>
    <span data-code-marker="+">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL154" data-line-number="154"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR154" data-line-number="154"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL155" data-line-number="155"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR155" data-line-number="155"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> len;</span></td>
</tr>



    <tr data-hunk="c60d061cc596f41056b2dfbdf3d7ffba">
    <td id="diff-61baaa3fba81611f2145e330985325faL156" data-line-number="156"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR156" data-line-number="156"></td>

  <td>
    <span data-code-marker=" ">    } <span>else</span> {</span></td>
</tr>



      <tr data-position="34">
    <td id="diff-61baaa3fba81611f2145e330985325faHL161" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR161" data-line-number="..."></td>
    <td>@@ -161,10 +161,9 @@ func hash_get(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL161" data-line-number="161"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR161" data-line-number="161"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_put</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL162" data-line-number="162"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR162" data-line-number="162"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL163" data-line-number="163"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR163" data-line-number="163"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL164" data-line-number="164"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL165" data-line-number="165"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR164" data-line-number="164"></td>

  <td>
    <span data-code-marker="+">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL166" data-line-number="166"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR165" data-line-number="165"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL167" data-line-number="167"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span><span>.</span><span>slots</span><span>[i]</span> = {len, h};</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR166" data-line-number="166"></td>

  <td>
    <span data-code-marker="+">        <span>*slot</span> = {len, h};</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL168" data-line-number="168"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR167" data-line-number="167"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL169" data-line-number="169"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR168" data-line-number="168"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</span></td>
</tr>



    <tr data-hunk="57db2057039c0b9ed681188a2cb37b64">
    <td id="diff-61baaa3fba81611f2145e330985325faL170" data-line-number="170"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR169" data-line-number="169"></td>

  <td>
    <span data-code-marker=" ">            <span>hash_rehash</span>(<span>index</span>, len + <span>1</span>);</span></td>
</tr>



      <tr data-position="47">
    <td id="diff-61baaa3fba81611f2145e330985325faHL178" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR177" data-line-number="..."></td>
    <td>@@ -178,10 +177,10 @@ func hash_put(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL178" data-line-number="178"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR177" data-line-number="177"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL179" data-line-number="179"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR178" data-line-number="178"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL180" data-line-number="180"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR179" data-line-number="179"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL181" data-line-number="181"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>i</span> := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL182" data-line-number="182"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>slot</span> := <span>index</span><span>.</span><span>slots</span><span>[i]</span>;</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL183" data-line-number="183"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (<span>slot.</span><span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL184" data-line-number="184"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span><span>.</span><span>slots</span><span>[i]</span> = {HASH_DELETED};</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR180" data-line-number="180"></td>

  <td>
    <span data-code-marker="+">    <span>slot</span> := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR181" data-line-number="181"></td>

  <td>
    <span data-code-marker="+">    <span>i</span> := <span>slot.</span><span>i</span>;</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR182" data-line-number="182"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (i != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR183" data-line-number="183"></td>

  <td>
    <span data-code-marker="+">        <span>*slot</span> = {HASH_DELETED};</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL185" data-line-number="185"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR184" data-line-number="184"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL186" data-line-number="186"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR185" data-line-number="185"></td>

  <td>
    <span data-code-marker=" ">    } <span>else</span> {</span></td>
</tr>



    <tr data-hunk="97612843a9857bd796d33d786e50a942">
    <td id="diff-61baaa3fba81611f2145e330985325faL187" data-line-number="187"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR186" data-line-number="186"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> len;</span></td>
</tr>



      <tr data-position="62">
    <td id="diff-61baaa3fba81611f2145e330985325faHL191" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR190" data-line-number="..."></td>
    <td>@@ -191,10 +190,9 @@ func hash_del(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL191" data-line-number="191"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR190" data-line-number="190"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, xi: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL195" data-line-number="195"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker="+">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL196" data-line-number="196"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL197" data-line-number="197"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span><span>.</span><span>slots</span><span>[i]</span>.<span>i</span> = xi;</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker="+">        <span>slot</span>.<span>i</span> = xi;</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL198" data-line-number="198"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL199" data-line-number="199"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="547009e688ce44432d8a54dd01fb1064">
    <td id="diff-61baaa3fba81611f2145e330985325faL200" data-line-number="200"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR198" data-line-number="198"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL573" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR573" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T09:45:06Z" title="Feb 18, 2019, 1:45 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>10 additions</strong>
                and
                <strong>11 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL3" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR3" data-line-number="..."></td>
    <td>@@ -3,7 +3,7 @@ import libc</td>
  </tr>

    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td id="diff-61baaa3fba81611f2145e330985325faL3" data-line-number="3"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR3" data-line-number="3"></td>

  <td>
    <span data-code-marker=" "><span>struct</span> Indexer {</span></td>
</tr>



    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td id="diff-61baaa3fba81611f2145e330985325faL4" data-line-number="4"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR4" data-line-number="4"></td>

  <td>
    <span data-code-marker=" ">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td id="diff-61baaa3fba81611f2145e330985325faL5" data-line-number="5"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR5" data-line-number="5"></td>

  <td>
    <span data-code-marker=" ">    put: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td id="diff-61baaa3fba81611f2145e330985325faL6" data-line-number="6"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR6" data-line-number="6"></td>

  <td>
    <span data-code-marker="+">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize)<span>: usize</span>;</span></td>
</tr>



    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td id="diff-61baaa3fba81611f2145e330985325faL7" data-line-number="7"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR7" data-line-number="7"></td>

  <td>
    <span data-code-marker=" ">    set: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span> *, xi: usize, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td id="diff-61baaa3fba81611f2145e330985325faL8" data-line-number="8"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR8" data-line-number="8"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span>: <span>func</span>(data: <span>void</span>*);</span></td>
</tr>



    <tr data-hunk="0cadc5231bd727c720eacce30a1888cd">
    <td id="diff-61baaa3fba81611f2145e330985325faL9" data-line-number="9"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR9" data-line-number="9"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL24" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR24" data-line-number="..."></td>
    <td>@@ -24,8 +24,8 @@ func index_put(index: Index, a: void const*, x: void const*, len: usize, stride:</td>
  </tr>

    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL24" data-line-number="24"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR24" data-line-number="24"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL25" data-line-number="25"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR25" data-line-number="25"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL26" data-line-number="26"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR26" data-line-number="26"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL27" data-line-number="27"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>index_del</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL28" data-line-number="28"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span>.<span>indexer</span>.<span>del</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR27" data-line-number="27"></td>

  <td>
    <span data-code-marker="+">func <span>index_del</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize)<span>: usize</span> {</span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR28" data-line-number="28"></td>

  <td>
    <span data-code-marker="+">    <span>return</span><span> </span><span>index</span>.<span>indexer</span>.<span>del</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL29" data-line-number="29"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR29" data-line-number="29"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL30" data-line-number="30"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR30" data-line-number="30"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3111e9b3b939d2536022e95369c583f0">
    <td id="diff-61baaa3fba81611f2145e330985325faL31" data-line-number="31"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR31" data-line-number="31"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



      <tr data-position="20">
    <td id="diff-61baaa3fba81611f2145e330985325faHL38" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR38" data-line-number="..."></td>
    <td>@@ -38,9 +38,6 @@ func index_free(index: Index) {</td>
  </tr>

    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL38" data-line-number="38"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR38" data-line-number="38"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL39" data-line-number="39"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR39" data-line-number="39"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL40" data-line-number="40"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR40" data-line-number="40"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL41" data-line-number="41"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>null_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL42" data-line-number="42"></td>

    <td></td>

  <td>
    <span data-code-marker="-">}</span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL43" data-line-number="43"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL44" data-line-number="44"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR41" data-line-number="41"></td>

  <td>
    <span data-code-marker=" ">func <span>null_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, xi: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL45" data-line-number="45"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR42" data-line-number="42"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="6a971a3537ca58238d7266099333c3fa">
    <td id="diff-61baaa3fba81611f2145e330985325faL46" data-line-number="46"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR43" data-line-number="43"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="30">
    <td id="diff-61baaa3fba81611f2145e330985325faHL59" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR56" data-line-number="..."></td>
    <td>@@ -59,7 +56,7 @@ func linear_get(data: void*, a: void const*, x: void const*, len: usize, stride:</td>
  </tr>

    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td id="diff-61baaa3fba81611f2145e330985325faL59" data-line-number="59"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR56" data-line-number="56"></td>

  <td>
    <span data-code-marker=" ">var linear_indexer_const = Indexer{</span></td>
</tr>



    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td id="diff-61baaa3fba81611f2145e330985325faL60" data-line-number="60"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR57" data-line-number="57"></td>

  <td>
    <span data-code-marker=" ">    get = linear_get,</span></td>
</tr>



    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td id="diff-61baaa3fba81611f2145e330985325faL61" data-line-number="61"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR58" data-line-number="58"></td>

  <td>
    <span data-code-marker=" ">    put = linear_get,</span></td>
</tr>



    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td id="diff-61baaa3fba81611f2145e330985325faL62" data-line-number="62"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    del = <span>null_del</span>,</span></td>
</tr>



    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR59" data-line-number="59"></td>

  <td>
    <span data-code-marker="+">    del = <span>linear_get</span>,</span></td>
</tr>



    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td id="diff-61baaa3fba81611f2145e330985325faL63" data-line-number="63"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR60" data-line-number="60"></td>

  <td>
    <span data-code-marker=" ">    set = null_set,</span></td>
</tr>



    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td id="diff-61baaa3fba81611f2145e330985325faL64" data-line-number="64"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR61" data-line-number="61"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span> = null_free,</span></td>
</tr>



    <tr data-hunk="a3ddbdc3dc63e75a3fda6511e1f8a6de">
    <td id="diff-61baaa3fba81611f2145e330985325faL65" data-line-number="65"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR62" data-line-number="62"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



      <tr data-position="39">
    <td id="diff-61baaa3fba81611f2145e330985325faHL178" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR175" data-line-number="..."></td>
    <td>@@ -178,13 +175,16 @@ func hash_put(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL178" data-line-number="178"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR175" data-line-number="175"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL179" data-line-number="179"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR176" data-line-number="176"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL180" data-line-number="180"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR177" data-line-number="177"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL181" data-line-number="181"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR178" data-line-number="178"></td>

  <td>
    <span data-code-marker="+">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize)<span>: usize</span> {</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL182" data-line-number="182"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR179" data-line-number="179"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL183" data-line-number="183"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR180" data-line-number="180"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL184" data-line-number="184"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR181" data-line-number="181"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL185" data-line-number="185"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR182" data-line-number="182"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL186" data-line-number="186"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR183" data-line-number="183"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL187" data-line-number="187"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR184" data-line-number="184"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>slots</span>[i] = {HASH_DELETED};</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR185" data-line-number="185"></td>

  <td>
    <span data-code-marker="+">        <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR186" data-line-number="186"></td>

  <td>
    <span data-code-marker="+">    } <span>else</span> {</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR187" data-line-number="187"></td>

  <td>
    <span data-code-marker="+">        <span>return</span> len;</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL188" data-line-number="188"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR188" data-line-number="188"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL189" data-line-number="189"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR189" data-line-number="189"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="c6dd57e8e8b316c24794d9da0b4655dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL190" data-line-number="190"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR190" data-line-number="190"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="57">
    <td id="diff-61baaa3fba81611f2145e330985325faHL517" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR517" data-line-number="..."></td>
    <td>@@ -517,13 +517,12 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL517" data-line-number="517"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR517" data-line-number="517"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL518" data-line-number="518"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR518" data-line-number="518"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL519" data-line-number="519"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR519" data-line-number="519"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL520" data-line-number="520"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>index_get</span>(<span>index</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR520" data-line-number="520"></td>

  <td>
    <span data-code-marker="+">    i := <span>index_del</span>(<span>index</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL521" data-line-number="521"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR521" data-line-number="521"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i == n) {</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL522" data-line-number="522"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR522" data-line-number="522"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span>;</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL523" data-line-number="523"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR523" data-line-number="523"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL524" data-line-number="524"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    p := (:<span>char</span>*)a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL525" data-line-number="525"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index_del</span>(<span>index</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL526" data-line-number="526"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR524" data-line-number="524"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i &lt; n-<span>1</span>) {</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR525" data-line-number="525"></td>

  <td>
    <span data-code-marker="+">        p := (:<span>char</span>*)a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL527" data-line-number="527"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR526" data-line-number="526"></td>

  <td>
    <span data-code-marker=" ">        q := (:<span>char</span>*)a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL528" data-line-number="528"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR527" data-line-number="527"></td>

  <td>
    <span data-code-marker=" ">        <span>index_set</span>(<span>index</span>, a, q, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="eed329e57349f88d6999450d34cc55dd">
    <td id="diff-61baaa3fba81611f2145e330985325faL529" data-line-number="529"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR528" data-line-number="528"></td>

  <td>
    <span data-code-marker=" ">        libc.<span>memmove</span>(p, q, elem_size);</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL575" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR575" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T09:38:59Z" title="Feb 18, 2019, 1:38 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>10 additions</strong>
                and
                <strong>8 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL4" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR4" data-line-number="..."></td>
    <td>@@ -4,7 +4,7 @@ struct Indexer {</td>
  </tr>

    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL4" data-line-number="4"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR4" data-line-number="4"></td>

  <td>
    <span data-code-marker=" ">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL5" data-line-number="5"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR5" data-line-number="5"></td>

  <td>
    <span data-code-marker=" ">    put: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL6" data-line-number="6"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR6" data-line-number="6"></td>

  <td>
    <span data-code-marker=" ">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL7" data-line-number="7"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    set: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, <span>src: usize, dest</span>: usize, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR7" data-line-number="7"></td>

  <td>
    <span data-code-marker="+">    set: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, <span>x: </span><span>void</span><span> </span><span>const</span><span> *, xi</span>: usize, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL8" data-line-number="8"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR8" data-line-number="8"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span>: <span>func</span>(data: <span>void</span>*);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL9" data-line-number="9"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR9" data-line-number="9"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL10" data-line-number="10"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR10" data-line-number="10"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL29" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR29" data-line-number="..."></td>
    <td>@@ -29,8 +29,8 @@ func index_del(index: Index, a: void const*, x: void const*, len: usize, stride:</td>
  </tr>

    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL29" data-line-number="29"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR29" data-line-number="29"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL30" data-line-number="30"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR30" data-line-number="30"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL31" data-line-number="31"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR31" data-line-number="31"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL32" data-line-number="32"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>index_set</span>(index: Index, a: <span>void</span> <span>const</span>*, <span>src: usize, dest</span>: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL33" data-line-number="33"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span>.<span>indexer</span>.<span>set</span>(<span>index</span>.<span>data</span>, a, <span>src, dest</span>, len, stride, size);</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR32" data-line-number="32"></td>

  <td>
    <span data-code-marker="+">func <span>index_set</span>(index: Index, a: <span>void</span> <span>const</span>*, <span>x: </span><span>void</span><span> </span><span>const</span><span>*, xi</span>: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR33" data-line-number="33"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>.<span>indexer</span>.<span>set</span>(<span>index</span>.<span>data</span>, a, <span>x, xi</span>, len, stride, size);</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL34" data-line-number="34"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR34" data-line-number="34"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL35" data-line-number="35"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR35" data-line-number="35"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL36" data-line-number="36"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR36" data-line-number="36"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



      <tr data-position="20">
    <td id="diff-61baaa3fba81611f2145e330985325faHL41" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR41" data-line-number="..."></td>
    <td>@@ -41,7 +41,7 @@ func index_free(index: Index) {</td>
  </tr>

    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL41" data-line-number="41"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR41" data-line-number="41"></td>

  <td>
    <span data-code-marker=" ">func <span>null_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL42" data-line-number="42"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR42" data-line-number="42"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL43" data-line-number="43"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR43" data-line-number="43"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL44" data-line-number="44"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>null_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, <span>src: usize, dest</span>: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR44" data-line-number="44"></td>

  <td>
    <span data-code-marker="+">func <span>null_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, <span>x: </span><span>void</span><span> </span><span>const</span><span>*, xi</span>: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL45" data-line-number="45"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR45" data-line-number="45"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL46" data-line-number="46"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR46" data-line-number="46"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL47" data-line-number="47"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR47" data-line-number="47"></td>

  <td>
    <span data-code-marker=" ">func <span>null_free</span>(data: <span>void</span>*) {</span></td>
</tr>



      <tr data-position="29">
    <td id="diff-61baaa3fba81611f2145e330985325faHL188" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR188" data-line-number="..."></td>
    <td>@@ -188,14 +188,13 @@ func hash_del(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL188" data-line-number="188"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR188" data-line-number="188"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL189" data-line-number="189"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR189" data-line-number="189"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL190" data-line-number="190"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR190" data-line-number="190"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL191" data-line-number="191"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, <span>src: usize, dest</span>: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker="+">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, <span>x: </span><span>void</span><span> </span><span>const</span><span>*, xi</span>: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    x := (:<span>char</span>*)a + src*stride;</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL195" data-line-number="195"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL196" data-line-number="196"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL197" data-line-number="197"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL198" data-line-number="198"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span>.<span>slots</span>[i].<span>i</span> = <span>dest</span>;</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker="+">        <span>index</span>.<span>slots</span>[i].<span>i</span> = <span>xi</span>;</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL199" data-line-number="199"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR198" data-line-number="198"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL200" data-line-number="200"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR199" data-line-number="199"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="afb199a6cb84095d6e2b0b96084006d7">
    <td id="diff-61baaa3fba81611f2145e330985325faL201" data-line-number="201"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR200" data-line-number="200"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="46">
    <td id="diff-61baaa3fba81611f2145e330985325faHL470" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR469" data-line-number="..."></td>
    <td>@@ -470,6 +469,9 @@ func iindex_func(ap: void**, new_index: Index, elem_size: usize, key_size: usize</td>
  </tr>

    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td id="diff-61baaa3fba81611f2145e330985325faL470" data-line-number="470"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR469" data-line-number="469"></td>

  <td>
    <span data-code-marker=" ">    <span>index_free</span>(<span>index</span>);</span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td id="diff-61baaa3fba81611f2145e330985325faL471" data-line-number="471"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR470" data-line-number="470"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>index</span> = new_index;</span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td id="diff-61baaa3fba81611f2145e330985325faL472" data-line-number="472"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR471" data-line-number="471"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR472" data-line-number="472"></td>

  <td>
    <span data-code-marker="+">    <span>for</span> (i := <span>0</span>; i &lt; n; i++) {</span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR473" data-line-number="473"></td>

  <td>
    <span data-code-marker="+">        <span>index_set</span>(<span>index</span>, a, (:<span>char</span>*)a + i*elem_size, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR474" data-line-number="474"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td id="diff-61baaa3fba81611f2145e330985325faL473" data-line-number="473"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR475" data-line-number="475"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td id="diff-61baaa3fba81611f2145e330985325faL474" data-line-number="474"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR476" data-line-number="476"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="731b7028a4dab38f962a3fde13b36169">
    <td id="diff-61baaa3fba81611f2145e330985325faL475" data-line-number="475"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR477" data-line-number="477"></td>

  <td>
    <span data-code-marker=" ">@foreign</span></td>
</tr>



      <tr data-position="56">
    <td id="diff-61baaa3fba81611f2145e330985325faHL522" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR524" data-line-number="..."></td>
    <td>@@ -522,8 +524,8 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL522" data-line-number="522"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR524" data-line-number="524"></td>

  <td>
    <span data-code-marker=" ">    p := (:<span>char</span>*)a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL523" data-line-number="523"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR525" data-line-number="525"></td>

  <td>
    <span data-code-marker=" ">    <span>index_del</span>(<span>index</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL524" data-line-number="524"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR526" data-line-number="526"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i &lt; n-<span>1</span>) {</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL525" data-line-number="525"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index_set</span>(<span>index</span>, a, n-<span>1</span>, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL526" data-line-number="526"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR527" data-line-number="527"></td>

  <td>
    <span data-code-marker=" ">        q := (:<span>char</span>*)a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR528" data-line-number="528"></td>

  <td>
    <span data-code-marker="+">        <span>index_set</span>(<span>index</span>, a, q, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL527" data-line-number="527"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR529" data-line-number="529"></td>

  <td>
    <span data-code-marker=" ">        libc.<span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL528" data-line-number="528"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR530" data-line-number="530"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="fc8e3a5b469888a250a49b308968b36b">
    <td id="diff-61baaa3fba81611f2145e330985325faL529" data-line-number="529"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR531" data-line-number="531"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span>--;</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL576" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR576" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T09:22:51Z" title="Feb 18, 2019, 1:22 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>33 additions</strong>
                and
                <strong>27 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL4" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR4" data-line-number="..."></td>
    <td>@@ -4,7 +4,7 @@ struct Indexer {</td>
  </tr>

    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL4" data-line-number="4"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR4" data-line-number="4"></td>

  <td>
    <span data-code-marker=" ">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL5" data-line-number="5"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR5" data-line-number="5"></td>

  <td>
    <span data-code-marker=" ">    put: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL6" data-line-number="6"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR6" data-line-number="6"></td>

  <td>
    <span data-code-marker=" ">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL7" data-line-number="7"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>move</span>: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR7" data-line-number="7"></td>

  <td>
    <span data-code-marker="+">    <span>set</span>: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL8" data-line-number="8"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR8" data-line-number="8"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span>: <span>func</span>(data: <span>void</span>*);</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL9" data-line-number="9"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR9" data-line-number="9"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="ea0c5b696329624a3bb69dbc09e09f6f">
    <td id="diff-61baaa3fba81611f2145e330985325faL10" data-line-number="10"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR10" data-line-number="10"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL29" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR29" data-line-number="..."></td>
    <td>@@ -29,8 +29,8 @@ func index_del(index: Index, a: void const*, x: void const*, len: usize, stride:</td>
  </tr>

    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL29" data-line-number="29"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR29" data-line-number="29"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL30" data-line-number="30"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR30" data-line-number="30"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL31" data-line-number="31"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR31" data-line-number="31"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL32" data-line-number="32"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>index_move</span>(index: Index, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL33" data-line-number="33"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span>.<span>indexer</span>.<span>move</span>(<span>index</span>.<span>data</span>, a, src, dest, len, stride, size);</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR32" data-line-number="32"></td>

  <td>
    <span data-code-marker="+">func <span>index_set</span>(index: Index, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR33" data-line-number="33"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>.<span>indexer</span>.<span>set</span>(<span>index</span>.<span>data</span>, a, src, dest, len, stride, size);</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL34" data-line-number="34"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR34" data-line-number="34"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL35" data-line-number="35"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR35" data-line-number="35"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="7d391cf7970c6ce78551c4a7e6a7db2b">
    <td id="diff-61baaa3fba81611f2145e330985325faL36" data-line-number="36"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR36" data-line-number="36"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



      <tr data-position="20">
    <td id="diff-61baaa3fba81611f2145e330985325faHL41" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR41" data-line-number="..."></td>
    <td>@@ -41,7 +41,7 @@ func index_free(index: Index) {</td>
  </tr>

    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL41" data-line-number="41"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR41" data-line-number="41"></td>

  <td>
    <span data-code-marker=" ">func <span>null_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL42" data-line-number="42"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR42" data-line-number="42"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL43" data-line-number="43"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR43" data-line-number="43"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL44" data-line-number="44"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>null_move</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR44" data-line-number="44"></td>

  <td>
    <span data-code-marker="+">func <span>null_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL45" data-line-number="45"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR45" data-line-number="45"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL46" data-line-number="46"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR46" data-line-number="46"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="77d6e13fce7bd8c76051ae06cc9c3b62">
    <td id="diff-61baaa3fba81611f2145e330985325faL47" data-line-number="47"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR47" data-line-number="47"></td>

  <td>
    <span data-code-marker=" ">func <span>null_free</span>(data: <span>void</span>*) {</span></td>
</tr>



      <tr data-position="29">
    <td id="diff-61baaa3fba81611f2145e330985325faHL60" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR60" data-line-number="..."></td>
    <td>@@ -60,7 +60,7 @@ var linear_indexer_const = Indexer{</td>
  </tr>

    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td id="diff-61baaa3fba81611f2145e330985325faL60" data-line-number="60"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR60" data-line-number="60"></td>

  <td>
    <span data-code-marker=" ">    get = linear_get,</span></td>
</tr>



    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td id="diff-61baaa3fba81611f2145e330985325faL61" data-line-number="61"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR61" data-line-number="61"></td>

  <td>
    <span data-code-marker=" ">    put = linear_get,</span></td>
</tr>



    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td id="diff-61baaa3fba81611f2145e330985325faL62" data-line-number="62"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR62" data-line-number="62"></td>

  <td>
    <span data-code-marker=" ">    del = null_del,</span></td>
</tr>



    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td id="diff-61baaa3fba81611f2145e330985325faL63" data-line-number="63"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>move</span> = <span>null_move</span>,</span></td>
</tr>



    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR63" data-line-number="63"></td>

  <td>
    <span data-code-marker="+">    <span>set</span> = <span>null_set</span>,</span></td>
</tr>



    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td id="diff-61baaa3fba81611f2145e330985325faL64" data-line-number="64"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR64" data-line-number="64"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span> = null_free,</span></td>
</tr>



    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td id="diff-61baaa3fba81611f2145e330985325faL65" data-line-number="65"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR65" data-line-number="65"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



    <tr data-hunk="c5a202908955abfaa733a83c517997eb">
    <td id="diff-61baaa3fba81611f2145e330985325faL66" data-line-number="66"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR66" data-line-number="66"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="38">
    <td id="diff-61baaa3fba81611f2145e330985325faHL188" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR188" data-line-number="..."></td>
    <td>@@ -188,7 +188,7 @@ func hash_del(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td id="diff-61baaa3fba81611f2145e330985325faL188" data-line-number="188"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR188" data-line-number="188"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td id="diff-61baaa3fba81611f2145e330985325faL189" data-line-number="189"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR189" data-line-number="189"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td id="diff-61baaa3fba81611f2145e330985325faL190" data-line-number="190"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR190" data-line-number="190"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td id="diff-61baaa3fba81611f2145e330985325faL191" data-line-number="191"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_move</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker="+">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    x := (:<span>char</span>*)a + src*stride;</span></td>
</tr>



    <tr data-hunk="4450c4e0f68e432053b5df89fc852599">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, size);</span></td>
</tr>



      <tr data-position="47">
    <td id="diff-61baaa3fba81611f2145e330985325faHL222" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR222" data-line-number="..."></td>
    <td>@@ -222,7 +222,7 @@ var hash_indexer_const = Indexer{</td>
  </tr>

    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td id="diff-61baaa3fba81611f2145e330985325faL222" data-line-number="222"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR222" data-line-number="222"></td>

  <td>
    <span data-code-marker=" ">    get = hash_get,</span></td>
</tr>



    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td id="diff-61baaa3fba81611f2145e330985325faL223" data-line-number="223"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR223" data-line-number="223"></td>

  <td>
    <span data-code-marker=" ">    put = hash_put,</span></td>
</tr>



    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td id="diff-61baaa3fba81611f2145e330985325faL224" data-line-number="224"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR224" data-line-number="224"></td>

  <td>
    <span data-code-marker=" ">    del = hash_del,</span></td>
</tr>



    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td id="diff-61baaa3fba81611f2145e330985325faL225" data-line-number="225"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>move</span> = <span>hash_move</span>,</span></td>
</tr>



    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR225" data-line-number="225"></td>

  <td>
    <span data-code-marker="+">    <span>set</span> = <span>hash_set</span>,</span></td>
</tr>



    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td id="diff-61baaa3fba81611f2145e330985325faL226" data-line-number="226"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR226" data-line-number="226"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span> = hash_free,</span></td>
</tr>



    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td id="diff-61baaa3fba81611f2145e330985325faL227" data-line-number="227"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR227" data-line-number="227"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



    <tr data-hunk="14b44b677491dfc60011ee6d9e1a8f5e">
    <td id="diff-61baaa3fba81611f2145e330985325faL228" data-line-number="228"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR228" data-line-number="228"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="56">
    <td id="diff-61baaa3fba81611f2145e330985325faHL291" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR291" data-line-number="..."></td>
    <td>@@ -291,25 +291,6 @@ func apop(a: void*) {</td>
  </tr>

    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL291" data-line-number="291"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR291" data-line-number="291"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL292" data-line-number="292"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR292" data-line-number="292"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL293" data-line-number="293"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR293" data-line-number="293"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL294" data-line-number="294"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>aindex_func</span>(ap: <span>void</span>**, new_index: Index) {</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL295" data-line-number="295"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    a := *ap;</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL296" data-line-number="296"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (!a) {</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL297" data-line-number="297"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>ainit_func</span>(ap);</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL298" data-line-number="298"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        a = *ap;</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL299" data-line-number="299"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    }</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL300" data-line-number="300"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(a);</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL301" data-line-number="301"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL302" data-line-number="302"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL303" data-line-number="303"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL304" data-line-number="304"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>ahdr</span>(a).<span>index</span> = new_index;</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL305" data-line-number="305"></td>

    <td></td>

  <td>
    <span data-code-marker="-">}</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL306" data-line-number="306"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL307" data-line-number="307"></td>

    <td></td>

  <td>
    <span data-code-marker="-">@foreign</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL308" data-line-number="308"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>aindex</span>(a: <span>void</span>*, new_index: Index) {</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL309" data-line-number="309"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    aindex_func;</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL310" data-line-number="310"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>foreign</span>(preamble = <span><span>"</span>#define aindex(a, new_index) std_aindex_func(&amp;(a), (new_index))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL311" data-line-number="311"></td>

    <td></td>

  <td>
    <span data-code-marker="-">}</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL312" data-line-number="312"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL313" data-line-number="313"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR294" data-line-number="294"></td>

  <td>
    <span data-code-marker=" ">func <span>afill_func</span>(ap: <span>void</span>**, x: <span>void</span> <span>const</span>*, n: usize, elem_size: usize) {</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL314" data-line-number="314"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR295" data-line-number="295"></td>

  <td>
    <span data-code-marker=" ">    <span>afit_func</span>(ap, <span>alen</span>(*ap) + n, elem_size);</span></td>
</tr>



    <tr data-hunk="0c4987787767bf4559b82194cf8556e7">
    <td id="diff-61baaa3fba81611f2145e330985325faL315" data-line-number="315"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR296" data-line-number="296"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



      <tr data-position="82">
    <td id="diff-61baaa3fba81611f2145e330985325faHL478" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR459" data-line-number="..."></td>
    <td>@@ -478,6 +459,31 @@ func kfree(a: void*) {</td>
  </tr>

    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td id="diff-61baaa3fba81611f2145e330985325faL478" data-line-number="478"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR459" data-line-number="459"></td>

  <td>
    <span data-code-marker=" ">    <span>afree</span>(a);</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td id="diff-61baaa3fba81611f2145e330985325faL479" data-line-number="479"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR460" data-line-number="460"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td id="diff-61baaa3fba81611f2145e330985325faL480" data-line-number="480"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR461" data-line-number="461"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR462" data-line-number="462"></td>

  <td>
    <span data-code-marker="+">func <span>iindex_func</span>(ap: <span>void</span>**, new_index: Index, elem_size: usize, key_size: usize) {</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR463" data-line-number="463"></td>

  <td>
    <span data-code-marker="+">    a := *ap;</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR464" data-line-number="464"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (!a) {</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR465" data-line-number="465"></td>

  <td>
    <span data-code-marker="+">        <span>ainit_func</span>(ap);</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR466" data-line-number="466"></td>

  <td>
    <span data-code-marker="+">        a = *ap;</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR467" data-line-number="467"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR468" data-line-number="468"></td>

  <td>
    <span data-code-marker="+">    #<span>assert</span>(a);</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR469" data-line-number="469"></td>

  <td>
    <span data-code-marker="+">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR470" data-line-number="470"></td>

  <td>
    <span data-code-marker="+">    <span>index_free</span>(<span>index</span>);</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR471" data-line-number="471"></td>

  <td>
    <span data-code-marker="+">    <span>ahdr</span>(a).<span>index</span> = new_index;</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR472" data-line-number="472"></td>

  <td>
    <span data-code-marker="+">    n := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR473" data-line-number="473"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR474" data-line-number="474"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR475" data-line-number="475"></td>

  <td>
    <span data-code-marker="+">@foreign</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR476" data-line-number="476"></td>

  <td>
    <span data-code-marker="+">func <span>kindex</span>(a: <span>void</span>*, new_index: Index) {</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR477" data-line-number="477"></td>

  <td>
    <span data-code-marker="+">    iindex_func;</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR478" data-line-number="478"></td>

  <td>
    <span data-code-marker="+">    #<span>foreign</span>(preamble = <span><span>"</span>#define kindex(a, new_index) std_iindex_func(&amp;(a), (new_index), sizeof(*(a)), sizeof(*(a)))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR479" data-line-number="479"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR480" data-line-number="480"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR481" data-line-number="481"></td>

  <td>
    <span data-code-marker="+">@foreign @intrinsic</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR482" data-line-number="482"></td>

  <td>
    <span data-code-marker="+">func <span>hindex</span>(a: <span>void</span>*, new_index: Index) {</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR483" data-line-number="483"></td>

  <td>
    <span data-code-marker="+">    iindex_func;</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR484" data-line-number="484"></td>

  <td>
    <span data-code-marker="+">    #<span>foreign</span>(preamble = <span><span>"</span>#define hindex(t, a, new_index) std_iindex_func(&amp;(a), (new_index), sizeof(*(a)), sizeof(t))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR485" data-line-number="485"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR486" data-line-number="486"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td id="diff-61baaa3fba81611f2145e330985325faL481" data-line-number="481"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR487" data-line-number="487"></td>

  <td>
    <span data-code-marker=" ">func <span>iget_func</span>(a: <span>void</span>*, x: <span>void</span> <span>const</span>*, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td id="diff-61baaa3fba81611f2145e330985325faL482" data-line-number="482"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR488" data-line-number="488"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (!a) {</span></td>
</tr>



    <tr data-hunk="0616205dd7236d0c13b19cd0a6b7737c">
    <td id="diff-61baaa3fba81611f2145e330985325faL483" data-line-number="483"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR489" data-line-number="489"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>0</span>;</span></td>
</tr>



      <tr data-position="114">
    <td id="diff-61baaa3fba81611f2145e330985325faHL516" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR522" data-line-number="..."></td>
    <td>@@ -516,7 +522,7 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td id="diff-61baaa3fba81611f2145e330985325faL516" data-line-number="516"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR522" data-line-number="522"></td>

  <td>
    <span data-code-marker=" ">    p := (:<span>char</span>*)a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td id="diff-61baaa3fba81611f2145e330985325faL517" data-line-number="517"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR523" data-line-number="523"></td>

  <td>
    <span data-code-marker=" ">    <span>index_del</span>(<span>index</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td id="diff-61baaa3fba81611f2145e330985325faL518" data-line-number="518"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR524" data-line-number="524"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i &lt; n-<span>1</span>) {</span></td>
</tr>



    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td id="diff-61baaa3fba81611f2145e330985325faL519" data-line-number="519"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index_move</span>(<span>index</span>, a, n-<span>1</span>, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR525" data-line-number="525"></td>

  <td>
    <span data-code-marker="+">        <span>index_set</span>(<span>index</span>, a, n-<span>1</span>, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td id="diff-61baaa3fba81611f2145e330985325faL520" data-line-number="520"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR526" data-line-number="526"></td>

  <td>
    <span data-code-marker=" ">        q := (:<span>char</span>*)a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td id="diff-61baaa3fba81611f2145e330985325faL521" data-line-number="521"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR527" data-line-number="527"></td>

  <td>
    <span data-code-marker=" ">        libc.<span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="04d3910927c316d558bc1ba1b5aa4731">
    <td id="diff-61baaa3fba81611f2145e330985325faL522" data-line-number="522"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR528" data-line-number="528"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL574" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR574" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T08:59:34Z" title="Feb 18, 2019, 12:59 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>1 addition</strong>
                and
                <strong>1 deletion</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL20" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR20" data-line-number="..."></td>
    <td>@@ -20,7 +20,7 @@ func index_get(index: Index, a: void const*, x: void const*, len: usize, stride:</td>
  </tr>

    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td id="diff-61baaa3fba81611f2145e330985325faL20" data-line-number="20"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR20" data-line-number="20"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td id="diff-61baaa3fba81611f2145e330985325faL21" data-line-number="21"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR21" data-line-number="21"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td id="diff-61baaa3fba81611f2145e330985325faL22" data-line-number="22"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR22" data-line-number="22"></td>

  <td>
    <span data-code-marker=" ">func <span>index_put</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td id="diff-61baaa3fba81611f2145e330985325faL23" data-line-number="23"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>put</span>(<span>index</span>.<span>data</span><span> ,</span>a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR23" data-line-number="23"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>put</span>(<span>index</span>.<span>data</span><span>, </span>a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td id="diff-61baaa3fba81611f2145e330985325faL24" data-line-number="24"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR24" data-line-number="24"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td id="diff-61baaa3fba81611f2145e330985325faL25" data-line-number="25"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR25" data-line-number="25"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d9471d5104dd4c76ff45ff93968b219f">
    <td id="diff-61baaa3fba81611f2145e330985325faL26" data-line-number="26"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR26" data-line-number="26"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL568" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR568" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T08:56:50Z" title="Feb 18, 2019, 12:56 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>6 additions</strong>
                and
                <strong>6 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL105" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR105" data-line-number="..."></td>
    <td>@@ -105,15 +105,15 @@ func next_pow2(x: uint32): uint32 {</td>
  </tr>

    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL105" data-line-number="105"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR105" data-line-number="105"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL106" data-line-number="106"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR106" data-line-number="106"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL107" data-line-number="107"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR107" data-line-number="107"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_init</span>(index: HashIndex*, len: uint32) {</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL108" data-line-number="108"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>len </span>= <span>next_pow2</span>(len + len/<span>2</span>);</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL109" data-line-number="109"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (<span>len</span> &lt; HASH_MIN_SLOTS) {</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL110" data-line-number="110"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>len</span> = HASH_MIN_SLOTS;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR108" data-line-number="108"></td>

  <td>
    <span data-code-marker="+">    <span>num_slots :</span>= <span>next_pow2</span>(len + len/<span>2</span>);</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR109" data-line-number="109"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (<span>num_slots</span> &lt; HASH_MIN_SLOTS) {</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR110" data-line-number="110"></td>

  <td>
    <span data-code-marker="+">        <span>num_slots</span> = HASH_MIN_SLOTS;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL111" data-line-number="111"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR111" data-line-number="111"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL112" data-line-number="112"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR112" data-line-number="112"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>slots</span> = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL113" data-line-number="113"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span>.<span>mask</span> = <span>len</span> - <span>1</span>;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR113" data-line-number="113"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>.<span>mask</span> = <span>num_slots</span> - <span>1</span>;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL114" data-line-number="114"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR114" data-line-number="114"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>occupied</span> = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL115" data-line-number="115"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span>.<span>max_occupied</span> = <span>len</span>/<span>2</span> + <span>len</span>/<span>4</span>;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL116" data-line-number="116"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>afill</span>(<span>index</span>.<span>slots</span>, {HASH_EMPTY}, <span>len</span>);</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR115" data-line-number="115"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>.<span>max_occupied</span> = <span>num_slots</span>/<span>2</span> + <span>num_slots</span>/<span>4</span>;</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR116" data-line-number="116"></td>

  <td>
    <span data-code-marker="+">    <span>afill</span>(<span>index</span>.<span>slots</span>, {HASH_EMPTY}, <span>num_slots</span>);</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL117" data-line-number="117"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR117" data-line-number="117"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL118" data-line-number="118"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR118" data-line-number="118"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="ea543ed37aa8a7d6279771221a832ff4">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, stride: usize, size: usize): usize {</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL568" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR568" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T08:49:40Z" title="Feb 18, 2019, 12:49 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>7 additions</strong>
                and
                <strong>7 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL15" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR15" data-line-number="..."></td>
    <td>@@ -15,31 +15,26 @@ struct Index {</td>
  </tr>

    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL15" data-line-number="15"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR15" data-line-number="15"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL16" data-line-number="16"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR16" data-line-number="16"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL17" data-line-number="17"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR17" data-line-number="17"></td>

  <td>
    <span data-code-marker=" ">func <span>index_get</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL18" data-line-number="18"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL19" data-line-number="19"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR18" data-line-number="18"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>get</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL20" data-line-number="20"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR19" data-line-number="19"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL21" data-line-number="21"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR20" data-line-number="20"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL22" data-line-number="22"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR21" data-line-number="21"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL23" data-line-number="23"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR22" data-line-number="22"></td>

  <td>
    <span data-code-marker=" ">func <span>index_put</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL24" data-line-number="24"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL25" data-line-number="25"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR23" data-line-number="23"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>put</span>(<span>index</span>.<span>data</span> ,a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL26" data-line-number="26"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR24" data-line-number="24"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL27" data-line-number="27"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR25" data-line-number="25"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL28" data-line-number="28"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR26" data-line-number="26"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL29" data-line-number="29"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR27" data-line-number="27"></td>

  <td>
    <span data-code-marker=" ">func <span>index_del</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL30" data-line-number="30"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL31" data-line-number="31"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR28" data-line-number="28"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>indexer</span>.<span>del</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL32" data-line-number="32"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR29" data-line-number="29"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL33" data-line-number="33"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR30" data-line-number="30"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL34" data-line-number="34"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR31" data-line-number="31"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL35" data-line-number="35"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR32" data-line-number="32"></td>

  <td>
    <span data-code-marker=" ">func <span>index_move</span>(index: Index, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL36" data-line-number="36"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL37" data-line-number="37"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR33" data-line-number="33"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>indexer</span>.<span>move</span>(<span>index</span>.<span>data</span>, a, src, dest, len, stride, size);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL38" data-line-number="38"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR34" data-line-number="34"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL39" data-line-number="39"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR35" data-line-number="35"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL40" data-line-number="40"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR36" data-line-number="36"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL41" data-line-number="41"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR37" data-line-number="37"></td>

  <td>
    <span data-code-marker=" ">func <span>index_free</span>(index: Index) {</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL42" data-line-number="42"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL43" data-line-number="43"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR38" data-line-number="38"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL44" data-line-number="44"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR39" data-line-number="39"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="d793fd881bfcc6863258ade096151804">
    <td id="diff-61baaa3fba81611f2145e330985325faL45" data-line-number="45"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR40" data-line-number="40"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="32">
    <td id="diff-61baaa3fba81611f2145e330985325faHL196" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR191" data-line-number="..."></td>
    <td>@@ -196,6 +191,12 @@ func hash_del(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td id="diff-61baaa3fba81611f2145e330985325faL196" data-line-number="196"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_move</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td id="diff-61baaa3fba81611f2145e330985325faL197" data-line-number="197"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td id="diff-61baaa3fba81611f2145e330985325faL198" data-line-number="198"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    x := (:<span>char</span>*)a + src*stride;</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker="+">    h := <span>hash</span>(x, size);</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker="+">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker="+">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR198" data-line-number="198"></td>

  <td>
    <span data-code-marker="+">        <span>index</span>.<span>slots</span>[i].<span>i</span> = dest;</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR199" data-line-number="199"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td id="diff-61baaa3fba81611f2145e330985325faL199" data-line-number="199"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR200" data-line-number="200"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td id="diff-61baaa3fba81611f2145e330985325faL200" data-line-number="200"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR201" data-line-number="201"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="5b3bb04fefd4de1c8bb1f39fe11d80fd">
    <td id="diff-61baaa3fba81611f2145e330985325faL201" data-line-number="201"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR202" data-line-number="202"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_free</span>(data: <span>void</span>*) {</span></td>
</tr>



      <tr data-position="45">
    <td id="diff-61baaa3fba81611f2145e330985325faHL515" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR516" data-line-number="..."></td>
    <td>@@ -515,10 +516,9 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL515" data-line-number="515"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR516" data-line-number="516"></td>

  <td>
    <span data-code-marker=" ">    p := (:<span>char</span>*)a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL516" data-line-number="516"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR517" data-line-number="517"></td>

  <td>
    <span data-code-marker=" ">    <span>index_del</span>(<span>index</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL517" data-line-number="517"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR518" data-line-number="518"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i &lt; n-<span>1</span>) {</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR519" data-line-number="519"></td>

  <td>
    <span data-code-marker="+">        <span>index_move</span>(<span>index</span>, a, n-<span>1</span>, i, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL518" data-line-number="518"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR520" data-line-number="520"></td>

  <td>
    <span data-code-marker=" ">        q := (:<span>char</span>*)a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL519" data-line-number="519"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index_del</span>(<span>index</span>, a, q, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL520" data-line-number="520"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR521" data-line-number="521"></td>

  <td>
    <span data-code-marker=" ">        libc.<span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL521" data-line-number="521"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index_put</span>(<span>index</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL522" data-line-number="522"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR522" data-line-number="522"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL523" data-line-number="523"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR523" data-line-number="523"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span>--;</span></td>
</tr>



    <tr data-hunk="8614f5827bb9975a886094fdb0c84bcc">
    <td id="diff-61baaa3fba81611f2145e330985325faL524" data-line-number="524"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR524" data-line-number="524"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL568" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR568" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T08:45:56Z" title="Feb 18, 2019, 12:45 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>48 additions</strong>
                and
                <strong>13 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL4" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR4" data-line-number="..."></td>
    <td>@@ -4,6 +4,7 @@ struct Indexer {</td>
  </tr>

    <tr data-hunk="b564fef57bd12270aa9eee14de073ce4">
    <td id="diff-61baaa3fba81611f2145e330985325faL4" data-line-number="4"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR4" data-line-number="4"></td>

  <td>
    <span data-code-marker=" ">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="b564fef57bd12270aa9eee14de073ce4">
    <td id="diff-61baaa3fba81611f2145e330985325faL5" data-line-number="5"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR5" data-line-number="5"></td>

  <td>
    <span data-code-marker=" ">    put: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</span></td>
</tr>



    <tr data-hunk="b564fef57bd12270aa9eee14de073ce4">
    <td id="diff-61baaa3fba81611f2145e330985325faL6" data-line-number="6"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR6" data-line-number="6"></td>

  <td>
    <span data-code-marker=" ">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="b564fef57bd12270aa9eee14de073ce4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR7" data-line-number="7"></td>

  <td>
    <span data-code-marker="+">    move: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize);</span></td>
</tr>



    <tr data-hunk="b564fef57bd12270aa9eee14de073ce4">
    <td id="diff-61baaa3fba81611f2145e330985325faL7" data-line-number="7"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR8" data-line-number="8"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span>: <span>func</span>(data: <span>void</span>*);</span></td>
</tr>



    <tr data-hunk="b564fef57bd12270aa9eee14de073ce4">
    <td id="diff-61baaa3fba81611f2145e330985325faL8" data-line-number="8"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR9" data-line-number="9"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="b564fef57bd12270aa9eee14de073ce4">
    <td id="diff-61baaa3fba81611f2145e330985325faL9" data-line-number="9"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR10" data-line-number="10"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="8">
    <td id="diff-61baaa3fba81611f2145e330985325faHL12" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR13" data-line-number="..."></td>
    <td>@@ -12,12 +13,45 @@ struct Index {</td>
  </tr>

    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL12" data-line-number="12"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR13" data-line-number="13"></td>

  <td>
    <span data-code-marker=" ">    indexer: Indexer*;</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL13" data-line-number="13"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR14" data-line-number="14"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL14" data-line-number="14"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR15" data-line-number="15"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL15" data-line-number="15"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>null_free</span>(data: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR16" data-line-number="16"></td>

  <td>
    <span data-code-marker="+">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR17" data-line-number="17"></td>

  <td>
    <span data-code-marker="+">func <span>index_get</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR18" data-line-number="18"></td>

  <td>
    <span data-code-marker="+">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR19" data-line-number="19"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>get</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR20" data-line-number="20"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR21" data-line-number="21"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR22" data-line-number="22"></td>

  <td>
    <span data-code-marker="+">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR23" data-line-number="23"></td>

  <td>
    <span data-code-marker="+">func <span>index_put</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR24" data-line-number="24"></td>

  <td>
    <span data-code-marker="+">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR25" data-line-number="25"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>put</span>(<span>index</span>.<span>data</span> ,a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR26" data-line-number="26"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR27" data-line-number="27"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR28" data-line-number="28"></td>

  <td>
    <span data-code-marker="+">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR29" data-line-number="29"></td>

  <td>
    <span data-code-marker="+">func <span>index_del</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR30" data-line-number="30"></td>

  <td>
    <span data-code-marker="+">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR31" data-line-number="31"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>.<span>indexer</span>.<span>del</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR32" data-line-number="32"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR33" data-line-number="33"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR34" data-line-number="34"></td>

  <td>
    <span data-code-marker="+">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR35" data-line-number="35"></td>

  <td>
    <span data-code-marker="+">func <span>index_move</span>(index: Index, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR36" data-line-number="36"></td>

  <td>
    <span data-code-marker="+">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR37" data-line-number="37"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>.<span>indexer</span>.<span>move</span>(<span>index</span>.<span>data</span>, a, src, dest, len, stride, size);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR38" data-line-number="38"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR39" data-line-number="39"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR40" data-line-number="40"></td>

  <td>
    <span data-code-marker="+">@<span>inline</span></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR41" data-line-number="41"></td>

  <td>
    <span data-code-marker="+">func <span>index_free</span>(index: Index) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR42" data-line-number="42"></td>

  <td>
    <span data-code-marker="+">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR43" data-line-number="43"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL16" data-line-number="16"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR44" data-line-number="44"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL17" data-line-number="17"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR45" data-line-number="45"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL18" data-line-number="18"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR46" data-line-number="46"></td>

  <td>
    <span data-code-marker=" ">func <span>null_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL19" data-line-number="19"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR47" data-line-number="47"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL20" data-line-number="20"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR48" data-line-number="48"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR49" data-line-number="49"></td>

  <td>
    <span data-code-marker="+">func <span>null_move</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR50" data-line-number="50"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR51" data-line-number="51"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR52" data-line-number="52"></td>

  <td>
    <span data-code-marker="+">func <span>null_free</span>(data: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR53" data-line-number="53"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR54" data-line-number="54"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL21" data-line-number="21"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR55" data-line-number="55"></td>

  <td>
    <span data-code-marker=" ">func <span>linear_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL22" data-line-number="22"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR56" data-line-number="56"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; len; i++) {</span></td>
</tr>



    <tr data-hunk="638f071b87901d77fa269af501b66b18">
    <td id="diff-61baaa3fba81611f2145e330985325faL23" data-line-number="23"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR57" data-line-number="57"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (libc.<span>memcmp</span>((:<span>char</span>*)a + i*stride, x, size) == <span>0</span>) {</span></td>
</tr>



      <tr data-position="55">
    <td id="diff-61baaa3fba81611f2145e330985325faHL31" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR65" data-line-number="..."></td>
    <td>@@ -31,6 +65,7 @@ var linear_indexer_const = Indexer{</td>
  </tr>

    <tr data-hunk="cdc848ec36b77730720abef4dc54863f">
    <td id="diff-61baaa3fba81611f2145e330985325faL31" data-line-number="31"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR65" data-line-number="65"></td>

  <td>
    <span data-code-marker=" ">    get = linear_get,</span></td>
</tr>



    <tr data-hunk="cdc848ec36b77730720abef4dc54863f">
    <td id="diff-61baaa3fba81611f2145e330985325faL32" data-line-number="32"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR66" data-line-number="66"></td>

  <td>
    <span data-code-marker=" ">    put = linear_get,</span></td>
</tr>



    <tr data-hunk="cdc848ec36b77730720abef4dc54863f">
    <td id="diff-61baaa3fba81611f2145e330985325faL33" data-line-number="33"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR67" data-line-number="67"></td>

  <td>
    <span data-code-marker=" ">    del = null_del,</span></td>
</tr>



    <tr data-hunk="cdc848ec36b77730720abef4dc54863f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR68" data-line-number="68"></td>

  <td>
    <span data-code-marker="+">    move = null_move,</span></td>
</tr>



    <tr data-hunk="cdc848ec36b77730720abef4dc54863f">
    <td id="diff-61baaa3fba81611f2145e330985325faL34" data-line-number="34"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR69" data-line-number="69"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span> = null_free,</span></td>
</tr>



    <tr data-hunk="cdc848ec36b77730720abef4dc54863f">
    <td id="diff-61baaa3fba81611f2145e330985325faL35" data-line-number="35"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR70" data-line-number="70"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



    <tr data-hunk="cdc848ec36b77730720abef4dc54863f">
    <td id="diff-61baaa3fba81611f2145e330985325faL36" data-line-number="36"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR71" data-line-number="71"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="63">
    <td id="diff-61baaa3fba81611f2145e330985325faHL158" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR193" data-line-number="..."></td>
    <td>@@ -158,6 +193,11 @@ func hash_del(data: void*, a: void const*, x: void const*, len: usize, stride: u</td>
  </tr>

    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td id="diff-61baaa3fba81611f2145e330985325faL158" data-line-number="158"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td id="diff-61baaa3fba81611f2145e330985325faL159" data-line-number="159"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td id="diff-61baaa3fba81611f2145e330985325faL160" data-line-number="160"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker="+">func <span>hash_move</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, src: usize, dest: usize, len: usize, stride: usize, size: usize) {</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR198" data-line-number="198"></td>

  <td>
    <span data-code-marker="+">    x := (:<span>char</span>*)a + src*stride;</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR199" data-line-number="199"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR200" data-line-number="200"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td id="diff-61baaa3fba81611f2145e330985325faL161" data-line-number="161"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR201" data-line-number="201"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_free</span>(data: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td id="diff-61baaa3fba81611f2145e330985325faL162" data-line-number="162"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR202" data-line-number="202"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="c31885ab9208be0ec0db0a08a235f525">
    <td id="diff-61baaa3fba81611f2145e330985325faL163" data-line-number="163"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR203" data-line-number="203"></td>

  <td>
    <span data-code-marker=" ">    <span>afree</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



      <tr data-position="75">
    <td id="diff-61baaa3fba81611f2145e330985325faHL181" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR221" data-line-number="..."></td>
    <td>@@ -181,6 +221,7 @@ var hash_indexer_const = Indexer{</td>
  </tr>

    <tr data-hunk="71275636b1b53fbe2e4d2e235db2c94e">
    <td id="diff-61baaa3fba81611f2145e330985325faL181" data-line-number="181"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR221" data-line-number="221"></td>

  <td>
    <span data-code-marker=" ">    get = hash_get,</span></td>
</tr>



    <tr data-hunk="71275636b1b53fbe2e4d2e235db2c94e">
    <td id="diff-61baaa3fba81611f2145e330985325faL182" data-line-number="182"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR222" data-line-number="222"></td>

  <td>
    <span data-code-marker=" ">    put = hash_put,</span></td>
</tr>



    <tr data-hunk="71275636b1b53fbe2e4d2e235db2c94e">
    <td id="diff-61baaa3fba81611f2145e330985325faL183" data-line-number="183"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR223" data-line-number="223"></td>

  <td>
    <span data-code-marker=" ">    del = hash_del,</span></td>
</tr>



    <tr data-hunk="71275636b1b53fbe2e4d2e235db2c94e">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR224" data-line-number="224"></td>

  <td>
    <span data-code-marker="+">    move = hash_move,</span></td>
</tr>



    <tr data-hunk="71275636b1b53fbe2e4d2e235db2c94e">
    <td id="diff-61baaa3fba81611f2145e330985325faL184" data-line-number="184"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR225" data-line-number="225"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span> = hash_free,</span></td>
</tr>



    <tr data-hunk="71275636b1b53fbe2e4d2e235db2c94e">
    <td id="diff-61baaa3fba81611f2145e330985325faL185" data-line-number="185"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR226" data-line-number="226"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



    <tr data-hunk="71275636b1b53fbe2e4d2e235db2c94e">
    <td id="diff-61baaa3fba81611f2145e330985325faL186" data-line-number="186"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR227" data-line-number="227"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="83">
    <td id="diff-61baaa3fba81611f2145e330985325faHL440" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR481" data-line-number="..."></td>
    <td>@@ -440,9 +481,7 @@ func iget_func(a: void*, x: void const*, elem_size: usize, key_size: usize): usi</td>
  </tr>

    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL440" data-line-number="440"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR481" data-line-number="481"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (!a) {</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL441" data-line-number="441"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR482" data-line-number="482"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>0</span>;</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL442" data-line-number="442"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR483" data-line-number="483"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL443" data-line-number="443"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL444" data-line-number="444"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL445" data-line-number="445"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>get</span>(<span>index</span>.<span>data</span>, a, x, <span>alen</span>(a), elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR484" data-line-number="484"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> <span>index_get</span>(<span>ahdr</span>(a).<span>index</span>, a, x, <span>alen</span>(a), elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL446" data-line-number="446"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR485" data-line-number="485"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL447" data-line-number="447"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR486" data-line-number="486"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="584fe9d926d3801981ea63564b3f2985">
    <td id="diff-61baaa3fba81611f2145e330985325faL448" data-line-number="448"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR487" data-line-number="487"></td>

  <td>
    <span data-code-marker=" ">func <span>iput_func</span>(ap: <span>void</span>**, x: <span>void</span> <span>const</span>*, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



      <tr data-position="94">
    <td id="diff-61baaa3fba81611f2145e330985325faHL452" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR491" data-line-number="..."></td>
    <td>@@ -452,9 +491,8 @@ func iput_func(ap: void**, x: void const*, elem_size: usize, key_size: usize): u</td>
  </tr>

    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL452" data-line-number="452"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR491" data-line-number="491"></td>

  <td>
    <span data-code-marker=" ">        a = *ap;</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL453" data-line-number="453"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR492" data-line-number="492"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL454" data-line-number="454"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR493" data-line-number="493"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL455" data-line-number="455"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL456" data-line-number="456"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR494" data-line-number="494"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL457" data-line-number="457"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>index</span><span>.</span><span>indexer</span><span>.</span><span>put</span>(<span>index</span><span>.</span><span>data</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR495" data-line-number="495"></td>

  <td>
    <span data-code-marker="+">    i := <span>index_put</span>(<span>index</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL458" data-line-number="458"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR496" data-line-number="496"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i == n) {</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL459" data-line-number="459"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR497" data-line-number="497"></td>

  <td>
    <span data-code-marker=" ">        <span>afit_func</span>(ap, n + <span>1</span>, elem_size);</span></td>
</tr>



    <tr data-hunk="1e785250de129e80b0af7b4a7295434d">
    <td id="diff-61baaa3fba81611f2145e330985325faL460" data-line-number="460"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR498" data-line-number="498"></td>

  <td>
    <span data-code-marker=" ">        a = *ap;</span></td>
</tr>



      <tr data-position="105">
    <td id="diff-61baaa3fba81611f2145e330985325faHL470" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR508" data-line-number="..."></td>
    <td>@@ -470,20 +508,17 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL470" data-line-number="470"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR508" data-line-number="508"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL471" data-line-number="471"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR509" data-line-number="509"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL472" data-line-number="472"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR510" data-line-number="510"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL473" data-line-number="473"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL474" data-line-number="474"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL475" data-line-number="475"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>index</span>.<span>indexer</span>.<span>get</span>(<span>index</span>.<span>data</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR511" data-line-number="511"></td>

  <td>
    <span data-code-marker="+">    i := <span>index_get</span>(<span>index</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL476" data-line-number="476"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR512" data-line-number="512"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i == n) {</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL477" data-line-number="477"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR513" data-line-number="513"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span>;</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL478" data-line-number="478"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR514" data-line-number="514"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL479" data-line-number="479"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL480" data-line-number="480"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR515" data-line-number="515"></td>

  <td>
    <span data-code-marker=" ">    p := (:<span>char</span>*)a + i*elem_size;</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL481" data-line-number="481"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>index</span><span>.</span><span>indexer</span><span>.</span><span>del</span>(<span>index</span><span>.</span><span>data</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR516" data-line-number="516"></td>

  <td>
    <span data-code-marker="+">    <span>index_del</span>(<span>index</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL482" data-line-number="482"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR517" data-line-number="517"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i &lt; n-<span>1</span>) {</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL483" data-line-number="483"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR518" data-line-number="518"></td>

  <td>
    <span data-code-marker=" ">        q := (:<span>char</span>*)a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL484" data-line-number="484"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span><span>.</span><span>indexer</span><span>.</span><span>del</span>(<span>index</span><span>.</span><span>data</span>, a, q, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR519" data-line-number="519"></td>

  <td>
    <span data-code-marker="+">        <span>index_del</span>(<span>index</span>, a, q, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL485" data-line-number="485"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR520" data-line-number="520"></td>

  <td>
    <span data-code-marker=" ">        libc.<span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL486" data-line-number="486"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span><span>.</span><span>indexer</span><span>.</span><span>put</span>(<span>index</span><span>.</span><span>data</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR521" data-line-number="521"></td>

  <td>
    <span data-code-marker="+">        <span>index_put</span>(<span>index</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL487" data-line-number="487"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR522" data-line-number="522"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL488" data-line-number="488"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR523" data-line-number="523"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span>--;</span></td>
</tr>



    <tr data-hunk="b5d87fe59d0da67489db3f4edd63162a">
    <td id="diff-61baaa3fba81611f2145e330985325faL489" data-line-number="489"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR524" data-line-number="524"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL568" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR568" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T08:20:23Z" title="Feb 18, 2019, 12:20 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>17 additions</strong>
                and
                <strong>17 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL1" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR1" data-line-number="..."></td>
    <td>@@ -1,9 +1,9 @@</td>
  </tr>

    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL1" data-line-number="1"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR1" data-line-number="1"></td>

  <td>
    <span data-code-marker=" ">import libc</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL2" data-line-number="2"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR2" data-line-number="2"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL3" data-line-number="3"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR3" data-line-number="3"></td>

  <td>
    <span data-code-marker=" "><span>struct</span> Indexer {</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL4" data-line-number="4"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize): usize;</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL5" data-line-number="5"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    put: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize): usize;</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL6" data-line-number="6"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize);</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR4" data-line-number="4"></td>

  <td>
    <span data-code-marker="+">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize): usize;</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR5" data-line-number="5"></td>

  <td>
    <span data-code-marker="+">    put: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize): usize;</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR6" data-line-number="6"></td>

  <td>
    <span data-code-marker="+">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize);</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL7" data-line-number="7"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR7" data-line-number="7"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span>: <span>func</span>(data: <span>void</span>*);</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL8" data-line-number="8"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR8" data-line-number="8"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="dd87f4352433155be35576ee3c4c8390">
    <td id="diff-61baaa3fba81611f2145e330985325faL9" data-line-number="9"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR9" data-line-number="9"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="13">
    <td id="diff-61baaa3fba81611f2145e330985325faHL15" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR15" data-line-number="..."></td>
    <td>@@ -15,12 +15,12 @@ struct Index {</td>
  </tr>

    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL15" data-line-number="15"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR15" data-line-number="15"></td>

  <td>
    <span data-code-marker=" ">func <span>null_free</span>(data: <span>void</span>*) {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL16" data-line-number="16"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR16" data-line-number="16"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL17" data-line-number="17"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR17" data-line-number="17"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL18" data-line-number="18"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>null_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize) {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR18" data-line-number="18"></td>

  <td>
    <span data-code-marker="+">func <span>null_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize) {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL19" data-line-number="19"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR19" data-line-number="19"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL20" data-line-number="20"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR20" data-line-number="20"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL21" data-line-number="21"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>linear_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR21" data-line-number="21"></td>

  <td>
    <span data-code-marker="+">func <span>linear_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL22" data-line-number="22"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR22" data-line-number="22"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; len; i++) {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL23" data-line-number="23"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (libc.<span>memcmp</span>((:<span>char</span>*)a + i*<span>elem_size</span>, x, <span>key_size</span>) == <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR23" data-line-number="23"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (libc.<span>memcmp</span>((:<span>char</span>*)a + i*<span>stride</span>, x, <span>size</span>) == <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL24" data-line-number="24"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR24" data-line-number="24"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL25" data-line-number="25"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR25" data-line-number="25"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="430119e72b83e6fe7c9fb79f6ee05cdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL26" data-line-number="26"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR26" data-line-number="26"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



      <tr data-position="29">
    <td id="diff-61baaa3fba81611f2145e330985325faHL86" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR86" data-line-number="..."></td>
    <td>@@ -86,12 +86,12 @@ func hash_init(index: HashIndex*, len: uint32) {</td>
  </tr>

    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL86" data-line-number="86"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR86" data-line-number="86"></td>

  <td>
    <span data-code-marker=" ">    <span>afill</span>(<span>index</span>.<span>slots</span>, {HASH_EMPTY}, len);</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL87" data-line-number="87"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR87" data-line-number="87"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL88" data-line-number="88"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR88" data-line-number="88"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL89" data-line-number="89"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, <span>elem_size</span>: usize, <span>key_size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR89" data-line-number="89"></td>

  <td>
    <span data-code-marker="+">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, <span>stride</span>: usize, <span>size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL90" data-line-number="90"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR90" data-line-number="90"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL91" data-line-number="91"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR91" data-line-number="91"></td>

  <td>
    <span data-code-marker=" ">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL92" data-line-number="92"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR92" data-line-number="92"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL93" data-line-number="93"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR93" data-line-number="93"></td>

  <td>
    <span data-code-marker=" ">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL94" data-line-number="94"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; libc.<span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*<span>elem_size</span>, x, <span>key_size</span>) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR94" data-line-number="94"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; libc.<span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*<span>stride</span>, x, <span>size</span>) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL95" data-line-number="95"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR95" data-line-number="95"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL96" data-line-number="96"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR96" data-line-number="96"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="29d5dcd5d8bfe9c1202b8ec6a3e93ad0">
    <td id="diff-61baaa3fba81611f2145e330985325faL97" data-line-number="97"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR97" data-line-number="97"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



      <tr data-position="44">
    <td id="diff-61baaa3fba81611f2145e330985325faHL119" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR119" data-line-number="..."></td>
    <td>@@ -119,10 +119,10 @@ func hash_put_slot(index: HashIndex*, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL120" data-line-number="120"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR120" data-line-number="120"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker="+">func <span>hash_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    h := <span>hash</span>(x, <span>key_size</span>);</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>elem_size, key_size</span>);</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker="+">    h := <span>hash</span>(x, <span>size</span>);</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker="+">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>stride, size</span>);</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL126" data-line-number="126"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR126" data-line-number="126"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL127" data-line-number="127"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR127" data-line-number="127"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="dd3f4d1492a34294168f0bc78efa3935">
    <td id="diff-61baaa3fba81611f2145e330985325faL128" data-line-number="128"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR128" data-line-number="128"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> len;</span></td>
</tr>



      <tr data-position="58">
    <td id="diff-61baaa3fba81611f2145e330985325faHL131" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR131" data-line-number="..."></td>
    <td>@@ -131,10 +131,10 @@ func hash_get(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL131" data-line-number="131"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR131" data-line-number="131"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL132" data-line-number="132"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR132" data-line-number="132"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL133" data-line-number="133"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR133" data-line-number="133"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL134" data-line-number="134"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_put</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR134" data-line-number="134"></td>

  <td>
    <span data-code-marker="+">func <span>hash_put</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize): usize {</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL135" data-line-number="135"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR135" data-line-number="135"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL136" data-line-number="136"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    h := <span>hash</span>(x, <span>key_size</span>);</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>elem_size, key_size</span>);</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR136" data-line-number="136"></td>

  <td>
    <span data-code-marker="+">    h := <span>hash</span>(x, <span>size</span>);</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker="+">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>stride, size</span>);</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR139" data-line-number="139"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="ed41f16371787ba9fa387a3ff800db2a">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR140" data-line-number="140"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>slots</span>[i] = {len, h};</span></td>
</tr>



      <tr data-position="72">
    <td id="diff-61baaa3fba81611f2145e330985325faHL148" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR148" data-line-number="..."></td>
    <td>@@ -148,10 +148,10 @@ func hash_put(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL148" data-line-number="148"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR148" data-line-number="148"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL149" data-line-number="149"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR149" data-line-number="149"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL150" data-line-number="150"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR150" data-line-number="150"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL151" data-line-number="151"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>elem_size</span>: usize, <span>key_size</span>: usize) {</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR151" data-line-number="151"></td>

  <td>
    <span data-code-marker="+">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, <span>stride</span>: usize, <span>size</span>: usize) {</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL152" data-line-number="152"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR152" data-line-number="152"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL153" data-line-number="153"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    h := <span>hash</span>(x, <span>key_size</span>);</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL154" data-line-number="154"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>elem_size, key_size</span>);</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR153" data-line-number="153"></td>

  <td>
    <span data-code-marker="+">    h := <span>hash</span>(x, <span>size</span>);</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR154" data-line-number="154"></td>

  <td>
    <span data-code-marker="+">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>stride, size</span>);</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL155" data-line-number="155"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR155" data-line-number="155"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL156" data-line-number="156"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR156" data-line-number="156"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="c674f06b3f62971c5d05faaa81f6904f">
    <td id="diff-61baaa3fba81611f2145e330985325faL157" data-line-number="157"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR157" data-line-number="157"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>slots</span>[i] = {HASH_DELETED};</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL533" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR533" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T08:05:06Z" title="Feb 18, 2019, 12:05 AM PST">on Feb 18, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>4 additions</strong>
                and
                <strong>4 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL75" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR75" data-line-number="..."></td>
    <td>@@ -75,7 +75,7 @@ func next_pow2(x: uint32): uint32 {</td>
  </tr>

    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td id="diff-61baaa3fba81611f2145e330985325faL75" data-line-number="75"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR75" data-line-number="75"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td id="diff-61baaa3fba81611f2145e330985325faL76" data-line-number="76"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR76" data-line-number="76"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td id="diff-61baaa3fba81611f2145e330985325faL77" data-line-number="77"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR77" data-line-number="77"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_init</span>(index: HashIndex*, len: uint32) {</span></td>
</tr>



    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td id="diff-61baaa3fba81611f2145e330985325faL78" data-line-number="78"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    len = <span>next_pow2</span>(len);</span></td>
</tr>



    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR78" data-line-number="78"></td>

  <td>
    <span data-code-marker="+">    len = <span>next_pow2</span>(len<span> + len/</span><span>2</span>);</span></td>
</tr>



    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td id="diff-61baaa3fba81611f2145e330985325faL79" data-line-number="79"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR79" data-line-number="79"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (len &lt; HASH_MIN_SLOTS) {</span></td>
</tr>



    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td id="diff-61baaa3fba81611f2145e330985325faL80" data-line-number="80"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR80" data-line-number="80"></td>

  <td>
    <span data-code-marker=" ">        len = HASH_MIN_SLOTS;</span></td>
</tr>



    <tr data-hunk="4f32a271be5b08949f82c20ff3d78923">
    <td id="diff-61baaa3fba81611f2145e330985325faL81" data-line-number="81"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR81" data-line-number="81"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL187" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR187" data-line-number="..."></td>
    <td>@@ -187,9 +187,9 @@ var hash_indexer_const = Indexer{</td>
  </tr>

    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL187" data-line-number="187"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR187" data-line-number="187"></td>

  <td>
    <span data-code-marker=" ">var hash_indexer = &amp;hash_indexer_const;</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL188" data-line-number="188"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR188" data-line-number="188"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL189" data-line-number="189"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR189" data-line-number="189"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_index</span>(): Index {</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL190" data-line-number="190"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>hash_index</span>: HashIndex* = <span>malloc</span>(<span>sizeof</span>(HashIndex));</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL191" data-line-number="191"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>hash_init</span>(<span>hash_index</span>, <span>0</span>);</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> Index{data = <span>hash_index</span>, indexer = hash_indexer};</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR190" data-line-number="190"></td>

  <td>
    <span data-code-marker="+">    <span>index</span>: HashIndex* = <span>malloc</span>(<span>sizeof</span>(HashIndex));</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker="+">    <span>hash_init</span>(<span>index</span>, <span>0</span>);</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> Index{data = <span>index</span>, indexer = hash_indexer};</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="35ca8ee8bd6e1fe4cb9b12dd7f77813a">
    <td id="diff-61baaa3fba81611f2145e330985325faL195" data-line-number="195"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker=" ">var default_indexer = &amp;linear_indexer_const;</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL533" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR533" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:45:11Z" title="Feb 17, 2019, 11:45 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>11 additions</strong>
                and
                <strong>11 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL2" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR2" data-line-number="..."></td>
    <td>@@ -2,7 +2,7 @@ import libc</td>
  </tr>

    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td id="diff-61baaa3fba81611f2145e330985325faL2" data-line-number="2"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR2" data-line-number="2"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td id="diff-61baaa3fba81611f2145e330985325faL3" data-line-number="3"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR3" data-line-number="3"></td>

  <td>
    <span data-code-marker=" "><span>struct</span> Indexer {</span></td>
</tr>



    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td id="diff-61baaa3fba81611f2145e330985325faL4" data-line-number="4"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR4" data-line-number="4"></td>

  <td>
    <span data-code-marker=" ">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize;</span></td>
</tr>



    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td id="diff-61baaa3fba81611f2145e330985325faL5" data-line-number="5"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>set</span>: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize;</span></td>
</tr>



    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR5" data-line-number="5"></td>

  <td>
    <span data-code-marker="+">    <span>put</span>: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize;</span></td>
</tr>



    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td id="diff-61baaa3fba81611f2145e330985325faL6" data-line-number="6"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR6" data-line-number="6"></td>

  <td>
    <span data-code-marker=" ">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize);</span></td>
</tr>



    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td id="diff-61baaa3fba81611f2145e330985325faL7" data-line-number="7"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR7" data-line-number="7"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span>: <span>func</span>(data: <span>void</span>*);</span></td>
</tr>



    <tr data-hunk="efb7138b731d8260a2abff577e50016a">
    <td id="diff-61baaa3fba81611f2145e330985325faL8" data-line-number="8"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR8" data-line-number="8"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL29" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR29" data-line-number="..."></td>
    <td>@@ -29,7 +29,7 @@ func linear_get(data: void*, a: void const*, x: void const*, len: usize, elem_si</td>
  </tr>

    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td id="diff-61baaa3fba81611f2145e330985325faL29" data-line-number="29"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR29" data-line-number="29"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td id="diff-61baaa3fba81611f2145e330985325faL30" data-line-number="30"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR30" data-line-number="30"></td>

  <td>
    <span data-code-marker=" ">var linear_indexer_const = Indexer{</span></td>
</tr>



    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td id="diff-61baaa3fba81611f2145e330985325faL31" data-line-number="31"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR31" data-line-number="31"></td>

  <td>
    <span data-code-marker=" ">    get = linear_get,</span></td>
</tr>



    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td id="diff-61baaa3fba81611f2145e330985325faL32" data-line-number="32"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>set</span> = linear_get,</span></td>
</tr>



    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR32" data-line-number="32"></td>

  <td>
    <span data-code-marker="+">    <span>put</span> = linear_get,</span></td>
</tr>



    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td id="diff-61baaa3fba81611f2145e330985325faL33" data-line-number="33"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR33" data-line-number="33"></td>

  <td>
    <span data-code-marker=" ">    del = null_del,</span></td>
</tr>



    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td id="diff-61baaa3fba81611f2145e330985325faL34" data-line-number="34"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR34" data-line-number="34"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span> = null_free,</span></td>
</tr>



    <tr data-hunk="fcf8773ee5299205309eb1c1575c359a">
    <td id="diff-61baaa3fba81611f2145e330985325faL35" data-line-number="35"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR35" data-line-number="35"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



      <tr data-position="18">
    <td id="diff-61baaa3fba81611f2145e330985325faHL131" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR131" data-line-number="..."></td>
    <td>@@ -131,7 +131,7 @@ func hash_get(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td id="diff-61baaa3fba81611f2145e330985325faL131" data-line-number="131"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR131" data-line-number="131"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td id="diff-61baaa3fba81611f2145e330985325faL132" data-line-number="132"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR132" data-line-number="132"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td id="diff-61baaa3fba81611f2145e330985325faL133" data-line-number="133"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR133" data-line-number="133"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td id="diff-61baaa3fba81611f2145e330985325faL134" data-line-number="134"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR134" data-line-number="134"></td>

  <td>
    <span data-code-marker="+">func <span>hash_put</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td id="diff-61baaa3fba81611f2145e330985325faL135" data-line-number="135"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR135" data-line-number="135"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td id="diff-61baaa3fba81611f2145e330985325faL136" data-line-number="136"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR136" data-line-number="136"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, key_size);</span></td>
</tr>



    <tr data-hunk="95f64bf12cd6adfe8848790d4ce78a8d">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, elem_size, key_size);</span></td>
</tr>



      <tr data-position="27">
    <td id="diff-61baaa3fba81611f2145e330985325faHL179" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR179" data-line-number="..."></td>
    <td>@@ -179,7 +179,7 @@ func hash_rehash(index: HashIndex*, len: uint32) {</td>
  </tr>

    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td id="diff-61baaa3fba81611f2145e330985325faL179" data-line-number="179"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR179" data-line-number="179"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td id="diff-61baaa3fba81611f2145e330985325faL180" data-line-number="180"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR180" data-line-number="180"></td>

  <td>
    <span data-code-marker=" ">var hash_indexer_const = Indexer{</span></td>
</tr>



    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td id="diff-61baaa3fba81611f2145e330985325faL181" data-line-number="181"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR181" data-line-number="181"></td>

  <td>
    <span data-code-marker=" ">    get = hash_get,</span></td>
</tr>



    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td id="diff-61baaa3fba81611f2145e330985325faL182" data-line-number="182"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>set</span> = <span>hash_set</span>,</span></td>
</tr>



    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR182" data-line-number="182"></td>

  <td>
    <span data-code-marker="+">    <span>put</span> = <span>hash_put</span>,</span></td>
</tr>



    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td id="diff-61baaa3fba81611f2145e330985325faL183" data-line-number="183"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR183" data-line-number="183"></td>

  <td>
    <span data-code-marker=" ">    del = hash_del,</span></td>
</tr>



    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td id="diff-61baaa3fba81611f2145e330985325faL184" data-line-number="184"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR184" data-line-number="184"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span> = hash_free,</span></td>
</tr>



    <tr data-hunk="2f91dffb36778ac82dc8151282ac8c14">
    <td id="diff-61baaa3fba81611f2145e330985325faL185" data-line-number="185"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR185" data-line-number="185"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



      <tr data-position="36">
    <td id="diff-61baaa3fba81611f2145e330985325faHL445" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR445" data-line-number="..."></td>
    <td>@@ -445,7 +445,7 @@ func iget_func(a: void*, x: void const*, elem_size: usize, key_size: usize): usi</td>
  </tr>

    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td id="diff-61baaa3fba81611f2145e330985325faL445" data-line-number="445"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR445" data-line-number="445"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>get</span>(<span>index</span>.<span>data</span>, a, x, <span>alen</span>(a), elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td id="diff-61baaa3fba81611f2145e330985325faL446" data-line-number="446"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR446" data-line-number="446"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td id="diff-61baaa3fba81611f2145e330985325faL447" data-line-number="447"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR447" data-line-number="447"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td id="diff-61baaa3fba81611f2145e330985325faL448" data-line-number="448"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>iadd_func</span>(ap: <span>void</span>**, x: <span>void</span> <span>const</span>*, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR448" data-line-number="448"></td>

  <td>
    <span data-code-marker="+">func <span>iput_func</span>(ap: <span>void</span>**, x: <span>void</span> <span>const</span>*, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td id="diff-61baaa3fba81611f2145e330985325faL449" data-line-number="449"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR449" data-line-number="449"></td>

  <td>
    <span data-code-marker=" ">    a := *ap;</span></td>
</tr>



    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td id="diff-61baaa3fba81611f2145e330985325faL450" data-line-number="450"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR450" data-line-number="450"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (!a) {</span></td>
</tr>



    <tr data-hunk="62ca8d7ffd9962404dd147319b88b432">
    <td id="diff-61baaa3fba81611f2145e330985325faL451" data-line-number="451"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR451" data-line-number="451"></td>

  <td>
    <span data-code-marker=" ">        <span>ainit_func</span>(ap);</span></td>
</tr>



      <tr data-position="45">
    <td id="diff-61baaa3fba81611f2145e330985325faHL454" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR454" data-line-number="..."></td>
    <td>@@ -454,7 +454,7 @@ func iadd_func(ap: void**, x: void const*, elem_size: usize, key_size: usize): u</td>
  </tr>

    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL454" data-line-number="454"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR454" data-line-number="454"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</span></td>
</tr>



    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL455" data-line-number="455"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR455" data-line-number="455"></td>

  <td>
    <span data-code-marker=" ">    #<span>assert</span>(<span>index</span>.<span>indexer</span>);</span></td>
</tr>



    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL456" data-line-number="456"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR456" data-line-number="456"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(a);</span></td>
</tr>



    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL457" data-line-number="457"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>index</span>.<span>indexer</span>.<span>set</span>(<span>index</span>.<span>data</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR457" data-line-number="457"></td>

  <td>
    <span data-code-marker="+">    i := <span>index</span>.<span>indexer</span>.<span>put</span>(<span>index</span>.<span>data</span>, a, x, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL458" data-line-number="458"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR458" data-line-number="458"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (i == n) {</span></td>
</tr>



    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL459" data-line-number="459"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR459" data-line-number="459"></td>

  <td>
    <span data-code-marker=" ">        <span>afit_func</span>(ap, n + <span>1</span>, elem_size);</span></td>
</tr>



    <tr data-hunk="2da1a0ce0d5b622d2645b455dfb48bdb">
    <td id="diff-61baaa3fba81611f2145e330985325faL460" data-line-number="460"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR460" data-line-number="460"></td>

  <td>
    <span data-code-marker=" ">        a = *ap;</span></td>
</tr>



      <tr data-position="54">
    <td id="diff-61baaa3fba81611f2145e330985325faHL483" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR483" data-line-number="..."></td>
    <td>@@ -483,7 +483,7 @@ func idel_func(a: void*, x: void const*, elem_size: usize, key_size: usize) {</td>
  </tr>

    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td id="diff-61baaa3fba81611f2145e330985325faL483" data-line-number="483"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR483" data-line-number="483"></td>

  <td>
    <span data-code-marker=" ">        q := (:<span>char</span>*)a + (n-<span>1</span>)*elem_size;</span></td>
</tr>



    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td id="diff-61baaa3fba81611f2145e330985325faL484" data-line-number="484"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR484" data-line-number="484"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>indexer</span>.<span>del</span>(<span>index</span>.<span>data</span>, a, q, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td id="diff-61baaa3fba81611f2145e330985325faL485" data-line-number="485"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR485" data-line-number="485"></td>

  <td>
    <span data-code-marker=" ">        libc.<span>memmove</span>(p, q, elem_size);</span></td>
</tr>



    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td id="diff-61baaa3fba81611f2145e330985325faL486" data-line-number="486"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span>.<span>indexer</span>.<span>set</span>(<span>index</span>.<span>data</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR486" data-line-number="486"></td>

  <td>
    <span data-code-marker="+">        <span>index</span>.<span>indexer</span>.<span>put</span>(<span>index</span>.<span>data</span>, a, p, n, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td id="diff-61baaa3fba81611f2145e330985325faL487" data-line-number="487"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR487" data-line-number="487"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td id="diff-61baaa3fba81611f2145e330985325faL488" data-line-number="488"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR488" data-line-number="488"></td>

  <td>
    <span data-code-marker=" ">    <span>ahdr</span>(a).<span>len</span>--;</span></td>
</tr>



    <tr data-hunk="e3a49bf5a5816e22e50db676b3aebf3a">
    <td id="diff-61baaa3fba81611f2145e330985325faL489" data-line-number="489"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR489" data-line-number="489"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



      <tr data-position="63">
    <td id="diff-61baaa3fba81611f2145e330985325faHL503" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR503" data-line-number="..."></td>
    <td>@@ -503,8 +503,8 @@ func kget(a: void*, x: void): usize {</td>
  </tr>

    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL503" data-line-number="503"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR503" data-line-number="503"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL504" data-line-number="504"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR504" data-line-number="504"></td>

  <td>
    <span data-code-marker=" ">@foreign @intrinsic</span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL505" data-line-number="505"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR505" data-line-number="505"></td>

  <td>
    <span data-code-marker=" ">func <span>kadd</span>(a: <span>void</span>*, x: <span>void</span>) {</span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL506" data-line-number="506"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>iadd_func</span>;</span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL507" data-line-number="507"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>foreign</span>(preamble = <span><span>"</span>#define kadd(t, a, x) <span>std_iadd_func</span>(&amp;(a), (t[]){x}, sizeof(t), sizeof(t))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR506" data-line-number="506"></td>

  <td>
    <span data-code-marker="+">    <span>iput_func</span>;</span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR507" data-line-number="507"></td>

  <td>
    <span data-code-marker="+">    #<span>foreign</span>(preamble = <span><span>"</span>#define kadd(t, a, x) <span>std_iput_func</span>(&amp;(a), (t[]){x}, sizeof(t), sizeof(t))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL508" data-line-number="508"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR508" data-line-number="508"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL509" data-line-number="509"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR509" data-line-number="509"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="568a6498aa26b15265357273d9ce5de4">
    <td id="diff-61baaa3fba81611f2145e330985325faL510" data-line-number="510"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR510" data-line-number="510"></td>

  <td>
    <span data-code-marker=" ">@<span>inline</span></span></td>
</tr>



      <tr data-position="74">
    <td id="diff-61baaa3fba81611f2145e330985325faHL521" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR521" data-line-number="..."></td>
    <td>@@ -521,8 +521,8 @@ func hget(a: void*, x: void): usize {</td>
  </tr>

    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL521" data-line-number="521"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR521" data-line-number="521"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL522" data-line-number="522"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR522" data-line-number="522"></td>

  <td>
    <span data-code-marker=" ">@foreign @intrinsic</span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL523" data-line-number="523"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR523" data-line-number="523"></td>

  <td>
    <span data-code-marker=" ">func <span>hput</span>(a: <span>void</span>*, k: <span>void</span>, v: <span>void</span>) {</span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL524" data-line-number="524"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>iadd_func</span>;</span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL525" data-line-number="525"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    #<span>foreign</span>(preamble = <span><span>"</span>#define hput(t, n, a, k, v) <span>std_iadd_func</span>(&amp;(a), &amp;(t){(k), (v)}, sizeof(*(a)), sizeof((*a).n))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR524" data-line-number="524"></td>

  <td>
    <span data-code-marker="+">    <span>iput_func</span>;</span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR525" data-line-number="525"></td>

  <td>
    <span data-code-marker="+">    #<span>foreign</span>(preamble = <span><span>"</span>#define hput(t, n, a, k, v) <span>std_iput_func</span>(&amp;(a), &amp;(t){(k), (v)}, sizeof(*(a)), sizeof((*a).n))<span>"</span></span>);</span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL526" data-line-number="526"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR526" data-line-number="526"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL527" data-line-number="527"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR527" data-line-number="527"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="6a3697c1f268bc923aab76b248848a99">
    <td id="diff-61baaa3fba81611f2145e330985325faL528" data-line-number="528"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR528" data-line-number="528"></td>

  <td>
    <span data-code-marker=" ">@foreign @intrinsic</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL533" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR533" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:42:47Z" title="Feb 17, 2019, 11:42 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>2 additions</strong>
                and
                <strong>1 deletion</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL138" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR138" data-line-number="..."></td>
    <td>@@ -138,8 +138,9 @@ func hash_set(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR139" data-line-number="139"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR140" data-line-number="140"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>slots</span>[i] = {len, h};</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR141" data-line-number="141"></td>

  <td>
    <span data-code-marker="+">        <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL141" data-line-number="141"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR142" data-line-number="142"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL142" data-line-number="142"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>hash_rehash</span>(<span>index</span>, len);</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR143" data-line-number="143"></td>

  <td>
    <span data-code-marker="+">            <span>hash_rehash</span>(<span>index</span>, len<span> + </span><span>1</span>);</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL143" data-line-number="143"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR144" data-line-number="144"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL144" data-line-number="144"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR145" data-line-number="145"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> len;</span></td>
</tr>



    <tr data-hunk="569c2ea04f058a7cb97a962b052f42b7">
    <td id="diff-61baaa3fba81611f2145e330985325faL145" data-line-number="145"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR146" data-line-number="146"></td>

  <td>
    <span data-code-marker=" ">    } <span>else</span> {</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL533" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR533" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:41:05Z" title="Feb 17, 2019, 11:41 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>1 addition</strong>
                and
                <strong>1 deletion</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL137" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR137" data-line-number="..."></td>
    <td>@@ -137,10 +137,10 @@ func hash_set(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR139" data-line-number="139"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR140" data-line-number="140"></td>

  <td>
    <span data-code-marker="+">        <span>index</span>.<span>slots</span>[i] = {len, h};</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR141" data-line-number="141"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL141" data-line-number="141"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR142" data-line-number="142"></td>

  <td>
    <span data-code-marker=" ">            <span>hash_rehash</span>(<span>index</span>, len);</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL142" data-line-number="142"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR143" data-line-number="143"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL143" data-line-number="143"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>hash_put_slot</span>(<span>index</span>, {len, h});</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL144" data-line-number="144"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR144" data-line-number="144"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> len;</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL145" data-line-number="145"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR145" data-line-number="145"></td>

  <td>
    <span data-code-marker=" ">    } <span>else</span> {</span></td>
</tr>



    <tr data-hunk="1dbd5e75c1f4daa28e142aafb423423d">
    <td id="diff-61baaa3fba81611f2145e330985325faL146" data-line-number="146"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR146" data-line-number="146"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> slot.<span>i</span>;</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL532" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR532" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:37:37Z" title="Feb 17, 2019, 11:37 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>0 additions</strong>
                and
                <strong>1 deletion</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL137" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR137" data-line-number="..."></td>
    <td>@@ -137,7 +137,6 @@ func hash_set(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="1b46851677c00d0756da577174907a79">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="1b46851677c00d0756da577174907a79">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="1b46851677c00d0756da577174907a79">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR139" data-line-number="139"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="1b46851677c00d0756da577174907a79">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="1b46851677c00d0756da577174907a79">
    <td id="diff-61baaa3fba81611f2145e330985325faL141" data-line-number="141"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR140" data-line-number="140"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</span></td>
</tr>



    <tr data-hunk="1b46851677c00d0756da577174907a79">
    <td id="diff-61baaa3fba81611f2145e330985325faL142" data-line-number="142"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR141" data-line-number="141"></td>

  <td>
    <span data-code-marker=" ">            <span>hash_rehash</span>(<span>index</span>, len);</span></td>
</tr>



    <tr data-hunk="1b46851677c00d0756da577174907a79">
    <td id="diff-61baaa3fba81611f2145e330985325faL143" data-line-number="143"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR142" data-line-number="142"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL532" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR532" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:18:43Z" title="Feb 17, 2019, 11:18 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>4 additions</strong>
                and
                <strong>4 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL86" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR86" data-line-number="..."></td>
    <td>@@ -86,7 +86,7 @@ func hash_init(index: HashIndex*, len: uint32) {</td>
  </tr>

    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL86" data-line-number="86"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR86" data-line-number="86"></td>

  <td>
    <span data-code-marker=" ">    <span>afill</span>(<span>index</span>.<span>slots</span>, {HASH_EMPTY}, len);</span></td>
</tr>



    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL87" data-line-number="87"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR87" data-line-number="87"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL88" data-line-number="88"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR88" data-line-number="88"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL89" data-line-number="89"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, <span>len: usize, </span>elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR89" data-line-number="89"></td>

  <td>
    <span data-code-marker="+">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL90" data-line-number="90"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR90" data-line-number="90"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL91" data-line-number="91"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR91" data-line-number="91"></td>

  <td>
    <span data-code-marker=" ">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="c3716af2ee202c7c3492a0d611f3a6bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL92" data-line-number="92"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR92" data-line-number="92"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL122" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR122" data-line-number="..."></td>
    <td>@@ -122,7 +122,7 @@ func hash_put_slot(index: HashIndex*, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, key_size);</span></td>
</tr>



    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>len, </span>elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker="+">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td id="diff-61baaa3fba81611f2145e330985325faL126" data-line-number="126"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR126" data-line-number="126"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td id="diff-61baaa3fba81611f2145e330985325faL127" data-line-number="127"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR127" data-line-number="127"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="aad0b49ccd6c2e146cf3cffc6e8dad24">
    <td id="diff-61baaa3fba81611f2145e330985325faL128" data-line-number="128"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR128" data-line-number="128"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> len;</span></td>
</tr>



      <tr data-position="18">
    <td id="diff-61baaa3fba81611f2145e330985325faHL134" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR134" data-line-number="..."></td>
    <td>@@ -134,7 +134,7 @@ func hash_get(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL134" data-line-number="134"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR134" data-line-number="134"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL135" data-line-number="135"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR135" data-line-number="135"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL136" data-line-number="136"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR136" data-line-number="136"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, key_size);</span></td>
</tr>



    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>len, </span>elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker="+">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR139" data-line-number="139"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="abcba29f21944b7b6dc3978efc9e68bd">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR140" data-line-number="140"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



      <tr data-position="27">
    <td id="diff-61baaa3fba81611f2145e330985325faHL151" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR151" data-line-number="..."></td>
    <td>@@ -151,7 +151,7 @@ func hash_set(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td id="diff-61baaa3fba81611f2145e330985325faL151" data-line-number="151"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR151" data-line-number="151"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize) {</span></td>
</tr>



    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td id="diff-61baaa3fba81611f2145e330985325faL152" data-line-number="152"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR152" data-line-number="152"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td id="diff-61baaa3fba81611f2145e330985325faL153" data-line-number="153"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR153" data-line-number="153"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, key_size);</span></td>
</tr>



    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td id="diff-61baaa3fba81611f2145e330985325faL154" data-line-number="154"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, <span>len, </span>elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR154" data-line-number="154"></td>

  <td>
    <span data-code-marker="+">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td id="diff-61baaa3fba81611f2145e330985325faL155" data-line-number="155"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR155" data-line-number="155"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td id="diff-61baaa3fba81611f2145e330985325faL156" data-line-number="156"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR156" data-line-number="156"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="a7013265bba59486beaade39dce872b0">
    <td id="diff-61baaa3fba81611f2145e330985325faL157" data-line-number="157"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR157" data-line-number="157"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>slots</span>[i] = {HASH_DELETED};</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL533" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR533" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:15:45Z" title="Feb 17, 2019, 11:15 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>2 additions</strong>
                and
                <strong>4 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL121" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR121" data-line-number="..."></td>
    <td>@@ -121,7 +121,6 @@ func hash_put_slot(index: HashIndex*, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="29e69e9ab16e64a1092d4e5f27fc9a89">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="29e69e9ab16e64a1092d4e5f27fc9a89">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="29e69e9ab16e64a1092d4e5f27fc9a89">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR123" data-line-number="123"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="29e69e9ab16e64a1092d4e5f27fc9a89">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="29e69e9ab16e64a1092d4e5f27fc9a89">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR124" data-line-number="124"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, key_size);</span></td>
</tr>



    <tr data-hunk="29e69e9ab16e64a1092d4e5f27fc9a89">
    <td id="diff-61baaa3fba81611f2145e330985325faL126" data-line-number="126"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR125" data-line-number="125"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, len, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="29e69e9ab16e64a1092d4e5f27fc9a89">
    <td id="diff-61baaa3fba81611f2145e330985325faL127" data-line-number="127"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR126" data-line-number="126"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



      <tr data-position="8">
    <td id="diff-61baaa3fba81611f2145e330985325faHL134" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR133" data-line-number="..."></td>
    <td>@@ -134,7 +133,6 @@ func hash_get(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="b5f7c0e828c510a194b41663991c37b3">
    <td id="diff-61baaa3fba81611f2145e330985325faL134" data-line-number="134"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR133" data-line-number="133"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="b5f7c0e828c510a194b41663991c37b3">
    <td id="diff-61baaa3fba81611f2145e330985325faL135" data-line-number="135"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR134" data-line-number="134"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="b5f7c0e828c510a194b41663991c37b3">
    <td id="diff-61baaa3fba81611f2145e330985325faL136" data-line-number="136"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR135" data-line-number="135"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="b5f7c0e828c510a194b41663991c37b3">
    <td id="diff-61baaa3fba81611f2145e330985325faL137" data-line-number="137"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="b5f7c0e828c510a194b41663991c37b3">
    <td id="diff-61baaa3fba81611f2145e330985325faL138" data-line-number="138"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR136" data-line-number="136"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, key_size);</span></td>
</tr>



    <tr data-hunk="b5f7c0e828c510a194b41663991c37b3">
    <td id="diff-61baaa3fba81611f2145e330985325faL139" data-line-number="139"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR137" data-line-number="137"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, len, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="b5f7c0e828c510a194b41663991c37b3">
    <td id="diff-61baaa3fba81611f2145e330985325faL140" data-line-number="140"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR138" data-line-number="138"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



      <tr data-position="16">
    <td id="diff-61baaa3fba81611f2145e330985325faHL152" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR150" data-line-number="..."></td>
    <td>@@ -152,10 +150,10 @@ func hash_set(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL152" data-line-number="152"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR150" data-line-number="150"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL153" data-line-number="153"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR151" data-line-number="151"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize) {</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL154" data-line-number="154"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR152" data-line-number="152"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>: HashIndex* = data;</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL155" data-line-number="155"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL156" data-line-number="156"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR153" data-line-number="153"></td>

  <td>
    <span data-code-marker=" ">    h := <span>hash</span>(x, key_size);</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL157" data-line-number="157"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR154" data-line-number="154"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, len, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL158" data-line-number="158"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (i != n) {</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR155" data-line-number="155"></td>

  <td>
    <span data-code-marker="+">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR156" data-line-number="156"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (slot.<span>i</span> != HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL159" data-line-number="159"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR157" data-line-number="157"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>slots</span>[i] = {HASH_DELETED};</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL160" data-line-number="160"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR158" data-line-number="158"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="681511f7399ab01a094be3aceb17fc0c">
    <td id="diff-61baaa3fba81611f2145e330985325faL161" data-line-number="161"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR159" data-line-number="159"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL533" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR533" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:13:04Z" title="Feb 17, 2019, 11:13 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>24 additions</strong>
                and
                <strong>24 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL86" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR86" data-line-number="..."></td>
    <td>@@ -86,50 +86,37 @@ func hash_init(index: HashIndex*, len: uint32) {</td>
  </tr>

    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL86" data-line-number="86"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR86" data-line-number="86"></td>

  <td>
    <span data-code-marker=" ">    <span>afill</span>(<span>index</span>.<span>slots</span>, {HASH_EMPTY}, len);</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL87" data-line-number="87"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR87" data-line-number="87"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL88" data-line-number="88"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR88" data-line-number="88"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL89" data-line-number="89"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_put_slot</span>(index: HashIndex*, <span>new_slot: HashSlot)</span> {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR89" data-line-number="89"></td>

  <td>
    <span data-code-marker="+">func <span>hash_get_slot</span>(index: HashIndex*, <span>a: </span><span>void</span><span> </span><span>const</span><span>*, x: </span><span>void</span><span> </span><span>const</span><span>*, h: uint32, len: usize, elem_size: usize, key_size: usize): usize</span> {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL90" data-line-number="90"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR90" data-line-number="90"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL91" data-line-number="91"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := <span>new_slot.</span><span>h</span> &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR91" data-line-number="91"></td>

  <td>
    <span data-code-marker="+">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL92" data-line-number="92"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR92" data-line-number="92"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL93" data-line-number="93"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR93" data-line-number="93"></td>

  <td>
    <span data-code-marker=" ">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL94" data-line-number="94"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL95" data-line-number="95"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>index</span>.<span>slots</span>[i] = new_slot;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL96" data-line-number="96"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL97" data-line-number="97"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>return</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR94" data-line-number="94"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; libc.<span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*elem_size, x, key_size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR95" data-line-number="95"></td>

  <td>
    <span data-code-marker="+">            <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL98" data-line-number="98"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR96" data-line-number="96"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL99" data-line-number="99"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR97" data-line-number="97"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL100" data-line-number="100"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR98" data-line-number="98"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (i == n) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL101" data-line-number="101"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR99" data-line-number="99"></td>

  <td>
    <span data-code-marker=" ">            i = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL102" data-line-number="102"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR100" data-line-number="100"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL103" data-line-number="103"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR101" data-line-number="101"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR102" data-line-number="102"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> <span>0</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL104" data-line-number="104"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR103" data-line-number="103"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL105" data-line-number="105"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR104" data-line-number="104"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL106" data-line-number="106"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_rehash</span>(index: HashIndex*, len: uint32) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL107" data-line-number="107"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    new_index: HashIndex;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL108" data-line-number="108"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>hash_init</span>(&amp;new_index, len);</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL109" data-line-number="109"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>for</span> (i := <span>0</span>; i &lt; <span>alen</span>(<span>index</span>.<span>slots</span>); i++) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL110" data-line-number="110"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL111" data-line-number="111"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (slot.<span>i</span> != HASH_EMPTY &amp;&amp; slot.<span>i</span> != HASH_DELETED) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL112" data-line-number="112"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>hash_put_slot</span>(&amp;new_index, slot);</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL113" data-line-number="113"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL114" data-line-number="114"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL115" data-line-number="115"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>afree</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL116" data-line-number="116"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    *<span>index</span> = new_index;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL117" data-line-number="117"></td>

    <td></td>

  <td>
    <span data-code-marker="-">}</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL118" data-line-number="118"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><br></span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL119" data-line-number="119"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR105" data-line-number="105"></td>

  <td>
    <span data-code-marker="+">func <span>hash_put_slot</span>(index: HashIndex*, new_slot: HashSlot) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL120" data-line-number="120"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR106" data-line-number="106"></td>

  <td>
    <span data-code-marker=" ">    n := <span>alen</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL121" data-line-number="121"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    i := h &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR107" data-line-number="107"></td>

  <td>
    <span data-code-marker="+">    i := <span>new_slot.</span><span>h</span> &amp; <span>index</span>.<span>mask</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL122" data-line-number="122"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR108" data-line-number="108"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (;;) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL123" data-line-number="123"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR109" data-line-number="109"></td>

  <td>
    <span data-code-marker=" ">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL124" data-line-number="124"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; libc.<span>memcmp</span>((:<span>char</span>*)a + slot.<span>i</span>*elem_size, x, key_size) == <span>0</span>)) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL125" data-line-number="125"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>return</span> i;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR110" data-line-number="110"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR111" data-line-number="111"></td>

  <td>
    <span data-code-marker="+">            <span>index</span>.<span>slots</span>[i] = new_slot;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR112" data-line-number="112"></td>

  <td>
    <span data-code-marker="+">            <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR113" data-line-number="113"></td>

  <td>
    <span data-code-marker="+">            <span>return</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL126" data-line-number="126"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR114" data-line-number="114"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL127" data-line-number="127"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR115" data-line-number="115"></td>

  <td>
    <span data-code-marker=" ">        i++;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL128" data-line-number="128"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR116" data-line-number="116"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (i == n) {</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL129" data-line-number="129"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR117" data-line-number="117"></td>

  <td>
    <span data-code-marker=" ">            i = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL130" data-line-number="130"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR118" data-line-number="118"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL131" data-line-number="131"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR119" data-line-number="119"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL132" data-line-number="132"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> <span>0</span>;</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL133" data-line-number="133"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR120" data-line-number="120"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL134" data-line-number="134"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR121" data-line-number="121"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="6dbe9cbc6e563207f2fc178f2d6b48d0">
    <td id="diff-61baaa3fba81611f2145e330985325faL135" data-line-number="135"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR122" data-line-number="122"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, elem_size: usize, key_size: usize): usize {</span></td>
</tr>



      <tr data-position="62">
    <td id="diff-61baaa3fba81611f2145e330985325faHL179" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR166" data-line-number="..."></td>
    <td>@@ -179,6 +166,19 @@ func hash_free(data: void*) {</td>
  </tr>

    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td id="diff-61baaa3fba81611f2145e330985325faL179" data-line-number="179"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR166" data-line-number="166"></td>

  <td>
    <span data-code-marker=" ">    <span>free</span>(<span>index</span>);</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td id="diff-61baaa3fba81611f2145e330985325faL180" data-line-number="180"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR167" data-line-number="167"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td id="diff-61baaa3fba81611f2145e330985325faL181" data-line-number="181"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR168" data-line-number="168"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR169" data-line-number="169"></td>

  <td>
    <span data-code-marker="+">func <span>hash_rehash</span>(index: HashIndex*, len: uint32) {</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR170" data-line-number="170"></td>

  <td>
    <span data-code-marker="+">    new_index: HashIndex;</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR171" data-line-number="171"></td>

  <td>
    <span data-code-marker="+">    <span>hash_init</span>(&amp;new_index, len);</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR172" data-line-number="172"></td>

  <td>
    <span data-code-marker="+">    <span>for</span> (i := <span>0</span>; i &lt; <span>alen</span>(<span>index</span>.<span>slots</span>); i++) {</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR173" data-line-number="173"></td>

  <td>
    <span data-code-marker="+">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR174" data-line-number="174"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (slot.<span>i</span> != HASH_EMPTY &amp;&amp; slot.<span>i</span> != HASH_DELETED) {</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR175" data-line-number="175"></td>

  <td>
    <span data-code-marker="+">            <span>hash_put_slot</span>(&amp;new_index, slot);</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR176" data-line-number="176"></td>

  <td>
    <span data-code-marker="+">        }</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR177" data-line-number="177"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR178" data-line-number="178"></td>

  <td>
    <span data-code-marker="+">    <span>afree</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR179" data-line-number="179"></td>

  <td>
    <span data-code-marker="+">    *<span>index</span> = new_index;</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR180" data-line-number="180"></td>

  <td>
    <span data-code-marker="+">}</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR181" data-line-number="181"></td>

  <td>
    <span data-code-marker="+"><br></span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td id="diff-61baaa3fba81611f2145e330985325faL182" data-line-number="182"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR182" data-line-number="182"></td>

  <td>
    <span data-code-marker=" ">var hash_indexer_const = Indexer{</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td id="diff-61baaa3fba81611f2145e330985325faL183" data-line-number="183"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR183" data-line-number="183"></td>

  <td>
    <span data-code-marker=" ">    get = hash_get,</span></td>
</tr>



    <tr data-hunk="6eaf16028ad0be0b234df6fc1ff57c60">
    <td id="diff-61baaa3fba81611f2145e330985325faL184" data-line-number="184"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR184" data-line-number="184"></td>

  <td>
    <span data-code-marker=" ">    set = hash_set,</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL535" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR535" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:12:09Z" title="Feb 17, 2019, 11:12 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>3 additions</strong>
                and
                <strong>4 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL103" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR103" data-line-number="..."></td>
    <td>@@ -103,7 +103,7 @@ func hash_put_slot(index: HashIndex*, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td id="diff-61baaa3fba81611f2145e330985325faL103" data-line-number="103"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR103" data-line-number="103"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td id="diff-61baaa3fba81611f2145e330985325faL104" data-line-number="104"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR104" data-line-number="104"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td id="diff-61baaa3fba81611f2145e330985325faL105" data-line-number="105"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR105" data-line-number="105"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td id="diff-61baaa3fba81611f2145e330985325faL106" data-line-number="106"></td>

    <td></td>

  <td>
    <span data-code-marker="-">func <span>hash_rehash</span>(index: HashIndex*, len: uint32<span>, new_slot: HashSlot</span>) {</span></td>
</tr>



    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR106" data-line-number="106"></td>

  <td>
    <span data-code-marker="+">func <span>hash_rehash</span>(index: HashIndex*, len: uint32) {</span></td>
</tr>



    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td id="diff-61baaa3fba81611f2145e330985325faL107" data-line-number="107"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR107" data-line-number="107"></td>

  <td>
    <span data-code-marker=" ">    new_index: HashIndex;</span></td>
</tr>



    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td id="diff-61baaa3fba81611f2145e330985325faL108" data-line-number="108"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR108" data-line-number="108"></td>

  <td>
    <span data-code-marker=" ">    <span>hash_init</span>(&amp;new_index, len);</span></td>
</tr>



    <tr data-hunk="3c436d5619f3c0dfe15ee647aecb09da">
    <td id="diff-61baaa3fba81611f2145e330985325faL109" data-line-number="109"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR109" data-line-number="109"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; <span>alen</span>(<span>index</span>.<span>slots</span>); i++) {</span></td>
</tr>



      <tr data-position="9">
    <td id="diff-61baaa3fba81611f2145e330985325faHL112" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR112" data-line-number="..."></td>
    <td>@@ -112,7 +112,6 @@ func hash_rehash(index: HashIndex*, len: uint32, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="e1e5627e265136cc3e397f0bca54b0c3">
    <td id="diff-61baaa3fba81611f2145e330985325faL112" data-line-number="112"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR112" data-line-number="112"></td>

  <td>
    <span data-code-marker=" ">            <span>hash_put_slot</span>(&amp;new_index, slot);</span></td>
</tr>



    <tr data-hunk="e1e5627e265136cc3e397f0bca54b0c3">
    <td id="diff-61baaa3fba81611f2145e330985325faL113" data-line-number="113"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR113" data-line-number="113"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="e1e5627e265136cc3e397f0bca54b0c3">
    <td id="diff-61baaa3fba81611f2145e330985325faL114" data-line-number="114"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR114" data-line-number="114"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="e1e5627e265136cc3e397f0bca54b0c3">
    <td id="diff-61baaa3fba81611f2145e330985325faL115" data-line-number="115"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>hash_put_slot</span>(&amp;new_index, new_slot);</span></td>
</tr>



    <tr data-hunk="e1e5627e265136cc3e397f0bca54b0c3">
    <td id="diff-61baaa3fba81611f2145e330985325faL116" data-line-number="116"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR115" data-line-number="115"></td>

  <td>
    <span data-code-marker=" ">    <span>afree</span>(<span>index</span>.<span>slots</span>);</span></td>
</tr>



    <tr data-hunk="e1e5627e265136cc3e397f0bca54b0c3">
    <td id="diff-61baaa3fba81611f2145e330985325faL117" data-line-number="117"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR116" data-line-number="116"></td>

  <td>
    <span data-code-marker=" ">    *<span>index</span> = new_index;</span></td>
</tr>



    <tr data-hunk="e1e5627e265136cc3e397f0bca54b0c3">
    <td id="diff-61baaa3fba81611f2145e330985325faL118" data-line-number="118"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR117" data-line-number="117"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



      <tr data-position="17">
    <td id="diff-61baaa3fba81611f2145e330985325faHL153" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR152" data-line-number="..."></td>
    <td>@@ -153,11 +152,11 @@ func hash_set(data: void*, a: void const*, x: void const*, len: usize, elem_size</td>
  </tr>

    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL153" data-line-number="153"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR152" data-line-number="152"></td>

  <td>
    <span data-code-marker=" ">    i := <span>hash_get_slot</span>(<span>index</span>, a, x, h, len, elem_size, key_size);</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL154" data-line-number="154"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR153" data-line-number="153"></td>

  <td>
    <span data-code-marker=" ">    slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL155" data-line-number="155"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR154" data-line-number="154"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL156" data-line-number="156"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span>.<span>slots</span>[i] = {i = len, h = h};</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL157" data-line-number="157"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR155" data-line-number="155"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span>.<span>occupied</span>++;</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL158" data-line-number="158"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR156" data-line-number="156"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL159" data-line-number="159"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            <span>hash_rehash</span>(<span>index</span>, len<span>, </span><span>index</span><span>.</span><span>slots</span><span>[i]</span>);</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR157" data-line-number="157"></td>

  <td>
    <span data-code-marker="+">            <span>hash_rehash</span>(<span>index</span>, len);</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL160" data-line-number="160"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR158" data-line-number="158"></td>

  <td>
    <span data-code-marker=" ">        }</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR159" data-line-number="159"></td>

  <td>
    <span data-code-marker="+">        <span>hash_put_slot</span>(<span>index</span>, {len, h});</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL161" data-line-number="161"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR160" data-line-number="160"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> len;</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL162" data-line-number="162"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR161" data-line-number="161"></td>

  <td>
    <span data-code-marker=" ">    } <span>else</span> {</span></td>
</tr>



    <tr data-hunk="6fe2270eeeebd14f48b36a61408fc3c8">
    <td id="diff-61baaa3fba81611f2145e330985325faL163" data-line-number="163"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR162" data-line-number="162"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> slot.<span>i</span>;</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL535" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR535" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:07:39Z" title="Feb 17, 2019, 11:07 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>4 additions</strong>
                and
                <strong>1 deletion</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL76" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR76" data-line-number="..."></td>
    <td>@@ -76,6 +76,9 @@ func next_pow2(x: uint32): uint32 {</td>
  </tr>

    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td id="diff-61baaa3fba81611f2145e330985325faL76" data-line-number="76"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR76" data-line-number="76"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td id="diff-61baaa3fba81611f2145e330985325faL77" data-line-number="77"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR77" data-line-number="77"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_init</span>(index: HashIndex*, len: uint32) {</span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td id="diff-61baaa3fba81611f2145e330985325faL78" data-line-number="78"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR78" data-line-number="78"></td>

  <td>
    <span data-code-marker=" ">    len = <span>next_pow2</span>(len);</span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR79" data-line-number="79"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (len &lt; HASH_MIN_SLOTS) {</span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR80" data-line-number="80"></td>

  <td>
    <span data-code-marker="+">        len = HASH_MIN_SLOTS;</span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR81" data-line-number="81"></td>

  <td>
    <span data-code-marker="+">    }</span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td id="diff-61baaa3fba81611f2145e330985325faL79" data-line-number="79"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR82" data-line-number="82"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>slots</span> = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td id="diff-61baaa3fba81611f2145e330985325faL80" data-line-number="80"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR83" data-line-number="83"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>mask</span> = len - <span>1</span>;</span></td>
</tr>



    <tr data-hunk="55e3b70f14a7c8748a719fe7408c6324">
    <td id="diff-61baaa3fba81611f2145e330985325faL81" data-line-number="81"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR84" data-line-number="84"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>occupied</span> = <span>0</span>;</span></td>
</tr>



      <tr data-position="10">
    <td id="diff-61baaa3fba81611f2145e330985325faHL188" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR191" data-line-number="..."></td>
    <td>@@ -188,7 +191,7 @@ var hash_indexer = &amp;hash_indexer_const;</td>
  </tr>

    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td id="diff-61baaa3fba81611f2145e330985325faL188" data-line-number="188"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR191" data-line-number="191"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td id="diff-61baaa3fba81611f2145e330985325faL189" data-line-number="189"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR192" data-line-number="192"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_index</span>(): Index {</span></td>
</tr>



    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td id="diff-61baaa3fba81611f2145e330985325faL190" data-line-number="190"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR193" data-line-number="193"></td>

  <td>
    <span data-code-marker=" ">    hash_index: HashIndex* = <span>malloc</span>(<span>sizeof</span>(HashIndex));</span></td>
</tr>



    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td id="diff-61baaa3fba81611f2145e330985325faL191" data-line-number="191"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>hash_init</span>(hash_index, <span>HASH_MIN_SLOTS</span>);</span></td>
</tr>



    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR194" data-line-number="194"></td>

  <td>
    <span data-code-marker="+">    <span>hash_init</span>(hash_index, <span>0</span>);</span></td>
</tr>



    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td id="diff-61baaa3fba81611f2145e330985325faL192" data-line-number="192"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR195" data-line-number="195"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> Index{data = hash_index, indexer = hash_indexer};</span></td>
</tr>



    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td id="diff-61baaa3fba81611f2145e330985325faL193" data-line-number="193"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR196" data-line-number="196"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="7fd4672833780013a42f506a8a1a7dd4">
    <td id="diff-61baaa3fba81611f2145e330985325faL194" data-line-number="194"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR197" data-line-number="197"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL536" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR536" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
      <li>
        <p><span>
            <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/users/pervognsen/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/pervognsen"><img src="https://avatars2.githubusercontent.com/u/123173?s=48&amp;v=4" width="24" height="24" alt="@pervognsen"></a>
            <strong>
              <a href="https://gist.github.com/pervognsen">pervognsen</a>
              revised
            </strong>
            this gist <relative-time datetime="2019-02-18T07:05:13Z" title="Feb 17, 2019, 11:05 PM PST">on Feb 17, 2019</relative-time>.
          </span>

            <span>
              
                <strong>1 changed file</strong>
                with
                <strong>2 additions</strong>
                and
                <strong>5 deletions</strong>.
            </span>
        </p>

        <div id="files">

  
    
<div id="diff-0" data-file-type=".c" data-file-deleted="false">
  
  <div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38/revisions&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="adac1f12ecf46a683ed671a45cbc8c8121f57f78ecf17bb069f214a197135ebb">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-61baaa3fba81611f2145e330985325fa">

                
      <tbody><tr data-position="0">
    <td id="diff-61baaa3fba81611f2145e330985325faHL75" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR75" data-line-number="..."></td>
    <td>@@ -75,6 +75,7 @@ func next_pow2(x: uint32): uint32 {</td>
  </tr>

    <tr data-hunk="9823153f4c77f815bedb7aeec81b4dd1">
    <td id="diff-61baaa3fba81611f2145e330985325faL75" data-line-number="75"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR75" data-line-number="75"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="9823153f4c77f815bedb7aeec81b4dd1">
    <td id="diff-61baaa3fba81611f2145e330985325faL76" data-line-number="76"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR76" data-line-number="76"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="9823153f4c77f815bedb7aeec81b4dd1">
    <td id="diff-61baaa3fba81611f2145e330985325faL77" data-line-number="77"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR77" data-line-number="77"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_init</span>(index: HashIndex*, len: uint32) {</span></td>
</tr>



    <tr data-hunk="9823153f4c77f815bedb7aeec81b4dd1">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR78" data-line-number="78"></td>

  <td>
    <span data-code-marker="+">    len = <span>next_pow2</span>(len);</span></td>
</tr>



    <tr data-hunk="9823153f4c77f815bedb7aeec81b4dd1">
    <td id="diff-61baaa3fba81611f2145e330985325faL78" data-line-number="78"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR79" data-line-number="79"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>slots</span> = <span>0</span>;</span></td>
</tr>



    <tr data-hunk="9823153f4c77f815bedb7aeec81b4dd1">
    <td id="diff-61baaa3fba81611f2145e330985325faL79" data-line-number="79"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR80" data-line-number="80"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>mask</span> = len - <span>1</span>;</span></td>
</tr>



    <tr data-hunk="9823153f4c77f815bedb7aeec81b4dd1">
    <td id="diff-61baaa3fba81611f2145e330985325faL80" data-line-number="80"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR81" data-line-number="81"></td>

  <td>
    <span data-code-marker=" ">    <span>index</span>.<span>occupied</span> = <span>0</span>;</span></td>
</tr>



      <tr data-position="8">
    <td id="diff-61baaa3fba81611f2145e330985325faHL100" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR101" data-line-number="..."></td>
    <td>@@ -100,12 +101,8 @@ func hash_put_slot(index: HashIndex*, new_slot: HashSlot) {</td>
  </tr>

    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL100" data-line-number="100"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR101" data-line-number="101"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL101" data-line-number="101"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR102" data-line-number="102"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL102" data-line-number="102"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR103" data-line-number="103"></td>

  <td>
    <span data-code-marker=" ">func <span>hash_rehash</span>(index: HashIndex*, len: uint32, new_slot: HashSlot) {</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL103" data-line-number="103"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    new_len := <span>next_pow2</span>(len);</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL104" data-line-number="104"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (new_len &lt; HASH_MIN_SLOTS) {</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL105" data-line-number="105"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        new_len = HASH_MIN_SLOTS;</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL106" data-line-number="106"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    }</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL107" data-line-number="107"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR104" data-line-number="104"></td>

  <td>
    <span data-code-marker=" ">    new_index: HashIndex;</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL108" data-line-number="108"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>hash_init</span>(&amp;new_index, <span>new_len</span>);</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR105" data-line-number="105"></td>

  <td>
    <span data-code-marker="+">    <span>hash_init</span>(&amp;new_index, <span>len</span>);</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL109" data-line-number="109"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR106" data-line-number="106"></td>

  <td>
    <span data-code-marker=" ">    <span>for</span> (i := <span>0</span>; i &lt; <span>alen</span>(<span>index</span>.<span>slots</span>); i++) {</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL110" data-line-number="110"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR107" data-line-number="107"></td>

  <td>
    <span data-code-marker=" ">        slot := <span>index</span>.<span>slots</span>[i];</span></td>
</tr>



    <tr data-hunk="04a236aeccaa74cd3efc435b7f361427">
    <td id="diff-61baaa3fba81611f2145e330985325faL111" data-line-number="111"></td>

    <td id="diff-61baaa3fba81611f2145e330985325faR108" data-line-number="108"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (slot.<span>i</span> != HASH_EMPTY &amp;&amp; slot.<span>i</span> != HASH_DELETED) {</span></td>
</tr>



  <tr data-position="">
    <td id="diff-61baaa3fba81611f2145e330985325faHL533" data-line-number="..."></td>
    <td id="diff-61baaa3fba81611f2145e330985325faHR533" data-line-number="..."></td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div>
</div>

  


</div>






      </li>
  </ol>

  

  </div>
</div><!-- /.container -->

    </main>
  </div>

  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>