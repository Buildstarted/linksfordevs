<!DOCTYPE html>
<html lang="en">
<head>
    <title>
How I&#x27;m able to take notes in mathematics lectures using LaTeX and Vim - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="How I&#x27;m able to take notes in mathematics lectures using LaTeX and Vim - linksfor.dev(s)"/>
    <meta property="og:description" content="A while back I an&#xAD;swered a ques&#xAD;tion on Quora: Can peo&#xAD;ple ac&#xAD;tu&#xAD;al&#xAD;ly keep up with note-&#x200B;taking in Math&#xAD;e&#xAD;mat&#xAD;ics lec&#xAD;tures with LaTeX.&#xA;There, I ex&#xAD;plained my work&#xAD;flow of tak&#xAD;ing lec&#xAD;ture notes in LaTeX using Vim and how I draw fig&#xAD;ures in Inkscape.&#xA;How&#xAD;ev&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://castel.dev/post/lecture-notes-1/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - How I&#x27;m able to take notes in mathematics lectures using LaTeX and Vim</title>
<div class="readable">
        <h1>How I&#x27;m able to take notes in mathematics lectures using LaTeX and Vim</h1>
            <div>Reading time: 15-19 minutes</div>
        <div>Posted here: 21 Mar 2019</div>
        <p><a href="https://castel.dev/post/lecture-notes-1/">https://castel.dev/post/lecture-notes-1/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
<p>I start­ed using LaTeX to write lec­ture notes in the sec­ond se­mes­ter of my bach­e­lor in math­e­mat­ics, and I’ve been using it ever since,
which makes for a total of more than 1700 pages of notes.
To give you an idea of what those notes look like, here are some ex­am­ples:</p>
<p>
  <a href="https://castel.dev/static/ba66c52b01c8fe6b31c97af52b5eb7f7/359dd/ca1.png" target="_blank" rel="noopener">
  
  <span>
    <span>
      <img alt="ca1" title="" src="https://castel.dev/static/ba66c52b01c8fe6b31c97af52b5eb7f7/f9fff/ca1.png" srcset="/static/ba66c52b01c8fe6b31c97af52b5eb7f7/00fd1/ca1.png 170w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/4982e/ca1.png 340w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/f9fff/ca1.png 680w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/90acf/ca1.png 1020w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/359dd/ca1.png 1173w" sizes="(max-width: 680px) 100vw, 680px">
    </span>
  </span>
  
  </a>
    

  <a href="https://castel.dev/static/1a393ac73dbb96f6fbd98b258e8a325a/1d982/ca2.png" target="_blank" rel="noopener">
  
  <span>
    <span>
      <img alt="ca2" title="" src="https://castel.dev/static/1a393ac73dbb96f6fbd98b258e8a325a/f9fff/ca2.png" srcset="/static/1a393ac73dbb96f6fbd98b258e8a325a/00fd1/ca2.png 170w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/4982e/ca2.png 340w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/f9fff/ca2.png 680w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/90acf/ca2.png 1020w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/1d982/ca2.png 1163w" sizes="(max-width: 680px) 100vw, 680px">
    </span>
  </span>
  
  </a>
    

  <a href="https://castel.dev/static/cb323a2ec665d98f93f78e13d3972e0e/41b08/ca3.png" target="_blank" rel="noopener">
  
  <span>
    <span>
      <img alt="ca3" title="" src="https://castel.dev/static/cb323a2ec665d98f93f78e13d3972e0e/f9fff/ca3.png" srcset="/static/cb323a2ec665d98f93f78e13d3972e0e/00fd1/ca3.png 170w,
/static/cb323a2ec665d98f93f78e13d3972e0e/4982e/ca3.png 340w,
/static/cb323a2ec665d98f93f78e13d3972e0e/f9fff/ca3.png 680w,
/static/cb323a2ec665d98f93f78e13d3972e0e/90acf/ca3.png 1020w,
/static/cb323a2ec665d98f93f78e13d3972e0e/41b08/ca3.png 1155w" sizes="(max-width: 680px) 100vw, 680px">
    </span>
  </span>
  
  </a>
    </p>
<p>These lec­ture notes — in­clud­ing fig­ures — are made while at­tend­ing the lec­ture and have not been edit­ed af­ter­wards.
To make note tak­ing using LaTeX vi­able, I had four goals in mind:</p>
<ul>
<li>Writ­ing text and math­e­mat­i­cal for­mu­las in LaTeX should be as fast as the lec­tur­er writ­ing on a black­board: no delay is ac­cept­able.</li>
<li>Draw­ing fig­ures should be al­most as fast as the lec­tur­er.</li>
<li>Man­ag­ing notes, i.e. adding a note, com­pil­ing all my notes, com­pil­ing the last two lec­tures, search­ing in notes, etc. should be easy and quick.</li>
<li>An­no­tat­ing pdf doc­u­ments using LaTeX should be pos­si­ble for when I want to write notes along­side a pdf doc­u­ment.</li>
</ul>
<p>This blog post will focus on the first item: writ­ing LaTeX.</p>

<h2 id="vim-and-latex">Vim and LaTeX</h2>
<p>For writ­ing text and math­e­mat­i­cal for­mu­las in LaTeX, I use Vim.
Vim is a pow­er­ful gen­er­al pur­pose text ed­i­tor that’s very ex­ten­si­ble.
I use it for writ­ing code, LaTeX, mark­down, … ba­si­cal­ly every­thing that’s text-​based.
It has a fair­ly steep learn­ing curve, but once you’ve got the ba­sics down, it’s hard to get back to an ed­i­tor with­out Vim key­bind­ings.
Here’s what my screen looks like when I’m edit­ing LaTeX:</p>
<p>
  <a href="https://castel.dev/static/4282d15d03150c89182ab56634d2b4b0/97817/vimzathura.png" target="_blank" rel="noopener">
  
  <span>
    <span>
      <img alt="Vim and Zathura" title="" src="https://castel.dev/static/4282d15d03150c89182ab56634d2b4b0/f9fff/vimzathura.png" srcset="/static/4282d15d03150c89182ab56634d2b4b0/00fd1/vimzathura.png 170w,
/static/4282d15d03150c89182ab56634d2b4b0/4982e/vimzathura.png 340w,
/static/4282d15d03150c89182ab56634d2b4b0/f9fff/vimzathura.png 680w,
/static/4282d15d03150c89182ab56634d2b4b0/90acf/vimzathura.png 1020w,
/static/4282d15d03150c89182ab56634d2b4b0/f8275/vimzathura.png 1360w,
/static/4282d15d03150c89182ab56634d2b4b0/97817/vimzathura.png 1919w" sizes="(max-width: 680px) 100vw, 680px">
    </span>
  </span>
  
  </a>
    </p>
<p>On the left you see Vim and on the right my pdf view­er, <a href="https://en.wikipedia.org/wiki/Zathura_(document_viewer)" target="_blank" rel="nofollow noopener noreferrer">Za­thu­ra</a>, which also has Vim-​like key­bind­ings.
I’m using Ubun­tu with <a href="https://github.com/baskerville/bspwm" target="_blank" rel="nofollow noopener noreferrer">bspwm</a> as my win­dow man­ag­er.
The LaTeX plu­g­in I’m using in Vim is <a href="https://github.com/lervag/vimtex" target="_blank" rel="nofollow noopener noreferrer">vim­tex</a>.
It pro­vides syn­tax high­light­ing, table of con­tents view, sync­tex, etc.
Using <a href="https://github.com/junegunn/vim-plug" target="_blank" rel="nofollow noopener noreferrer">vim-​plug</a>, I con­fig­ured it as fol­lows:</p>
<div data-language="vim"><pre><code>Plug <span>'lervag/vimtex'</span>
<span>let</span> g<span>:</span>tex_flavor<span>=</span><span>'latex'</span>
<span>let</span> g<span>:</span>vimtex_view_method<span>=</span><span>'zathura'</span>
<span>let</span> g<span>:</span>vimtex_quickfix_mode<span>=</span><span>0</span>
<span>set</span> conceallevel<span>=</span><span>1</span>
<span>let</span> g<span>:</span>tex_conceal<span>=</span><span>'abdmg'</span></code></pre></div>
<p>The last two lines con­fig­ure the con­ceal­ment.
This is a fea­ture where LaTeX code is re­placed or made in­vis­i­ble when your cur­sor is not on that line.
By mak­ing <code>\[</code>, <code>\]</code>, <code>$</code> in­vis­i­ble, they’re less ob­tru­sive which gives you a bet­ter overview of the doc­u­ment. This fea­ture also re­places <code>\bigcap</code> by by <code>∩</code>, <code>\in</code> by <code>∈</code> etc.
The fol­low­ing an­i­ma­tion should make that clear.</p>
<p><img src="https://castel.dev/d362e0b837be308b0f8897482a331ec6/conceal.gif" alt="conceal"></p>
<p>With this set up, I come to the crux of this blog post: writ­ing LaTeX as fast as the lec­tur­er can write on the black­board.
This is where snip­pets come into play.</p>
<h2 id="snippets">Snippets</h2>
<h3 id="whats-a-snippet">What’s a snippet?</h3>
<p>A snip­pet is a short reusable piece of text that can be trig­gered by some other text.
For ex­am­ple, when I type <code>sign</code> and press <kbd>Tab</kbd>, the word <code>sign</code> will be ex­pand­ed to a sig­na­ture:</p>
<p><img src="https://castel.dev/5ab28b1ad6114b68f4ce459d4f89eeae/sign.gif" alt="sign"></p>
<p>Snip­pets can also be dy­nam­ic: when I type <code>today</code> and press <kbd>Tab</kbd>, the word <code>today</code> will be re­placed by the cur­rent date, and <code>box</code> <kbd>Tab</kbd> be­comes a box that au­to­mat­i­cal­ly grows in size.</p>
<p><img src="https://castel.dev/1b6301a6561d104b4bc79654cb75470d/today.gif" alt="today"></p>
<p><img src="https://castel.dev/8b7caefc472eae0941f41365d16e8d2d/box.gif" alt="box"></p>
<p>You can even use one snip­pet in­side an­oth­er:</p>
<p><img src="https://castel.dev/cdd1fded48947d163c2e5e6b974cfec0/todaybox.gif" alt="todaybox"></p>
<h3 id="using-ultisnips-to-create-snippets">Using UltiSnips to create snippets</h3>
<p>I use the plu­g­in <a href="https://github.com/SirVer/ultisnips" target="_blank" rel="nofollow noopener noreferrer">Ul­tiSnips</a> to man­age my snip­pets. My con­fig­u­ra­tion is</p>
<div data-language="vim"><pre><code>Plug <span>'sirver/ultisnips'</span>
<span>let</span> g<span>:</span>UltiSnipsExpandTrigger <span>=</span> <span>'&lt;tab&gt;'</span>
<span>let</span> g<span>:</span>UltiSnipsJumpForwardTrigger <span>=</span> <span>'&lt;tab&gt;'</span>
<span>let</span> g<span>:</span>UltiSnipsJumpBackwardTrigger <span>=</span> <span>'&lt;s-tab&gt;'</span></code></pre></div>
<p>The code for the <code>sign</code> snip­pet is the fol­low­ing:</p>
<div data-language="snip"><pre><code><span>snippet <span>sign </span><span>"Signature"</span></span>
Yours sincerely,

Gilles Castel
<span>endsnippet</span></code></pre></div>
<p>For dy­nam­ic snip­pets, you can put code be­tween back­ticks <code>``</code> which will be run when the snip­pet is ex­pand­ed.
Here, I’ve used bash to for­mat the cur­rent date: <code>date + %F</code>.</p>
<div data-language="snip"><pre><code><span>snippet <span>today </span><span>"Date"</span></span>
`date +%F`
<span>endsnippet</span></code></pre></div>
<p>You can also use Python in­side a <code>`!p ... `</code> block.
Have a look at the code for the <code>box</code> snip­pet:</p>
<div data-language="snip"><pre><code><span>snippet <span>box </span><span>"Box"</span></span>
`<span>!p</span><span> snip<span>.</span>rv <span>=</span> <span>'┌'</span> <span>+</span> <span>'─'</span> <span>*</span> <span>(</span><span>len</span><span>(</span>t<span>[</span><span>1</span><span>]</span><span>)</span> <span>+</span> <span>2</span><span>)</span> <span>+</span> <span>'┐'</span>`</span>
│ <span>$1</span> │
`<span>!p</span><span> snip<span>.</span>rv <span>=</span> <span>'└'</span> <span>+</span> <span>'─'</span> <span>*</span> <span>(</span><span>len</span><span>(</span>t<span>[</span><span>1</span><span>]</span><span>)</span> <span>+</span> <span>2</span><span>)</span> <span>+</span> <span>'┘'</span>`</span>
<span>$0</span>
<span>endsnippet</span></code></pre></div>
<p>These Python code blocks will be re­placed by the value of the vari­able <code>snip.rv</code>.
In­side these blocks, you have ac­cess to the cur­rent state of the snip­pet, e.g. <code>t[1]</code> con­tains the first tab stop, <code>fn</code> the cur­rent file­name, …</p>
<h2 id="latex-snippets">LaTeX snippets</h2>
<p>Using snip­pets, writ­ing LaTeX is a lot faster than writ­ing it by hand.
Es­pe­cial­ly some of the more com­plex snip­pets can save you a lot of time and frus­tra­tion.  Let’s begin with some sim­ple snip­pets.</p>
<h3 id="environments">Environments</h3>
<p>To in­sert an en­vi­ron­ment, all I have to do is type <code>beg</code> at the be­gin­ning of a line.
Then I type the name of the en­vi­ron­ment, which is mir­rored in the <code>\end{}</code> com­mand. Press­ing <kbd>Tab</kbd> places the cur­sor in­side the newly cre­at­ed en­vi­ron­ment.</p>
<p><img src="https://castel.dev/d5ed641a9cb568d13dd56d98fec6376b/beginend.gif" alt="beginend"></p>
<p>The code for this snip­pet is the fol­low­ing.</p>
<div data-language="snip"><pre><code><span>snippet <span>beg </span><span>"begin{} / end{}"</span> <span>bA</span></span>
\begin{<span>$1</span>}
	<span>$0</span>
\end{<span>$1</span>}
<span>endsnippet</span></code></pre></div>
<p>The <code>b</code> means that this snip­pet will only be ex­pand­ed at the be­gin­ning of a line and <code>A</code> stands for auto ex­pand, which means I do not have to press <kbd>Tab</kbd> to ex­pand the snip­pet. Tab stops — i.e. places you can jump to by press­ing <kbd>Tab</kbd> and <kbd>Shift</kbd>+<kbd>Tab</kbd> — are rep­re­sent­ed by <code>$1</code>, <code>$2</code>, … and the last one with <code>$0</code>.</p>
<h3 id="inline-and-display-math">Inline and display math</h3>
<p>Two of my most fre­quent­ly used snip­pets are <code>mk</code> and <code>dm</code>.
They’re the snip­pets re­spon­si­ble for start­ing math mode.
The first one is a snip­pet for in­line math, the sec­ond one for dis­played math.</p>
<p><img src="https://castel.dev/12a16b6a90c4d85a887c7cde0f18bb8c/mkdm.gif" alt="mkdm"></p>
<p>The snip­pet for in­line math is ‘smart’: it knows when to in­sert a space after the dol­lar sign.
When I start typ­ing a word di­rect­ly be­hind the clos­ing <code>$</code>, it adds a space.
How­ev­er, when I type a non-​word char­ac­ter, it does not add a space, which would be pre­ferred for ex­am­ple in the case of <code>$p$-value</code>.</p>
<p><img src="https://castel.dev/1172a1f556fd36b42f7c3642b3952e2c/mk_space.gif" alt="mk_space"></p>
<p>The code for this snip­pet is the fol­low­ing.</p>
<div data-language="snip"><pre><code><span>snippet <span>mk </span><span>"Math"</span> <span>wA</span></span>
$<span>${1}</span>$`<span>!p</span><span>
<span>if</span> t<span>[</span><span>2</span><span>]</span> <span>and</span> t<span>[</span><span>2</span><span>]</span><span>[</span><span>0</span><span>]</span> <span>not</span> <span>in</span> <span>[</span><span>','</span><span>,</span> <span>'.'</span><span>,</span> <span>'?'</span><span>,</span> <span>'-'</span><span>,</span> <span>' '</span><span>]</span><span>:</span>
    snip<span>.</span>rv <span>=</span> <span>' '</span>
<span>else</span><span>:</span>
    snip<span>.</span>rv <span>=</span> <span>''</span>
`</span><span>$2</span>
<span>endsnippet</span></code></pre></div>
<p>The <code>w</code> at the end of the first line means that this snip­pet will ex­pand at word bound­aries, so e.g. <code>hellomk</code> won’t ex­pand, but <code>hello mk</code> will.</p>
<p>The snip­pet for dis­played math is more sim­ple, but it also is quite handy; it makes me never for­get end­ing equa­tions with a pe­ri­od.</p>
<p><img src="https://castel.dev/a682e97365ecfe19fe0c5bc08bacfec6/dm.gif" alt="dm"></p>
<div data-language="snip"><pre><code><span>snippet <span>dm </span><span>"Math"</span> <span>wA</span></span>
\[
<span>$1</span>
.\] <span>$0</span>
<span>endsnippet</span></code></pre></div>
<h3 id="sub--and-superscripts">Sub- and superscripts</h3>
<p>An­oth­er use­ful snip­pet is one for sub­scripts.
It changes changes <code>a1</code> to <code>a_1</code> and <code>a_12</code> to <code>a_{12}</code>.</p>
<p><img src="https://castel.dev/f26633cb822c6b52d346dfbba6e1a1bd/subscripts.gif" alt="subscripts"></p>
<p>The code for this snip­pet uses a reg­u­lar ex­pres­sion for its trig­ger.
It ex­pands the snip­pet when you type a char­ac­ter fol­lowed by a digit, which en­cod­ed by <code>[A-Za-z]\d</code>, or a char­ac­ter fol­lowed by <code>_</code> and two dig­its: <code>[A-Za-z]_\d\d</code>.</p>
<div data-language="snip"><pre><code><span>snippet <span>'([A-Za-z])(\d)' </span><span>"auto subscript"</span> <span>wrA</span></span>
`<span>!p</span><span> snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span>`_`!p snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>2</span><span>)</span>`</span>
<span>endsnippet</span>

<span>snippet <span>'([A-Za-z])_(\d\d)' </span><span>"auto subscript2"</span> <span>wrA</span></span>
`<span>!p</span><span> snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span>`_<span>{</span>`!p snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>2</span><span>)</span>`</span>}
<span>endsnippet</span></code></pre></div>
<p>When you wrap parts of a reg­u­lar ex­pres­sion in a group using paren­the­sis, e.g. <code>(\d\d)</code>, you can use them in the ex­pan­sion of the snip­pet via <code>match.group(i)</code> in Python.</p>
<p>As for su­per­scripts, I use <code>td</code>, which be­comes <code>^{}</code>.  How­ev­er, for squared, cubed, com­ple­ment and a hand­ful of other com­mon ones, I use ded­i­cat­ed snip­pets such as <code>sr</code>, <code>cb</code> and <code>comp</code>.</p>
<p><img src="https://castel.dev/da855cd9e67c48f508fab5ddc8c877fe/superscripts.gif" alt="superscripts"></p>
<div data-language="snip"><pre><code><span>snippet <span>sr </span><span>"^2"</span> <span>iA</span></span>
^2
<span>endsnippet</span>

<span>snippet <span>cb </span><span>"^3"</span> <span>iA</span></span>
^3
<span>endsnippet</span>

<span>snippet <span>compl </span><span>"complement"</span> <span>iA</span></span>
^{c}
<span>endsnippet</span>

<span>snippet <span>td </span><span>"superscript"</span> <span>iA</span></span>
^{<span>$1</span>}<span>$0</span>
<span>endsnippet</span></code></pre></div>
<h3 id="fractions">Fractions</h3>
<p>One of my most con­ve­nient snip­pets is one for frac­tions. This makes the fol­low­ing ex­pan­sions:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>//</code></td>
<td>→</td>
<td><code>\frac{}{}</code></td>
</tr>
<tr>
<td><code>3/</code></td>
<td>→</td>
<td><code>\frac{3}{}</code></td>
</tr>
<tr>
<td><code>4\pi^2/</code></td>
<td>→</td>
<td><code>\frac{4\pi^2}{}</code></td>
</tr>
<tr>
<td><code>(1 + 2 + 3)/</code></td>
<td>→</td>
<td><code>\frac{1 + 2 + 3}{}</code></td>
</tr>
<tr>
<td><code>(1+(2+3)/)</code></td>
<td>→</td>
<td><code>(1 + \frac{2+3}{})</code></td>
</tr>
<tr>
<td><code>(1 + (2+3))/</code></td>
<td>→</td>
<td><code>\frac{1 + (2+3)}{}</code></td>
</tr>
</tbody>
</table>
<p><img src="https://castel.dev/3f83f1bdc3078aa16382e80a276f199f/frac.gif" alt="frac"></p>
<p>The code for the first one is easy:</p>
<div data-language="snip"><pre><code><span>snippet <span>// </span><span>"Fraction"</span> <span>iA</span></span>
\\frac{<span>$1</span>}{<span>$2</span>}<span>$0</span>
<span>endsnippet</span></code></pre></div>
<p>The sec­ond and third ex­am­ples are made pos­si­ble using reg­u­lar ex­pres­sions to match for ex­pres­sions like <code>3/</code>, <code>4ac/</code>, <code>6\pi^2/</code>, <code>a_2/</code>, etc.</p>
<div data-language="snip"><pre><code><span>snippet <span>'((\d+)|(\d*)(\\)?([A-Za-z]+)((\^|_)(\{\d+\}|\d))*)/' </span><span>"Fraction"</span> <span>wrA</span></span>
\\frac{`<span>!p</span><span> snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span>`</span>}{<span>$1</span>}<span>$0</span>
<span>endsnippet</span></code></pre></div>
<p>As you can see, reg­u­lar ex­pres­sions can be­come quite over­whelm­ing, but here’s a di­a­gram that should ex­plain it:</p>
<p><img src="https://castel.dev/908df5ec254f9cd5b08b99b8a54318d0/regex.svg" alt="Diagram of the regular expression"></p>
<p>In the fourth and fifth cases, it tries to find the match­ing paren­the­sis. As this isn’t pos­si­ble using the reg­u­lar ex­pres­sion en­gine of Ul­tiSnips, I re­sort­ed to using Python:</p>
<div data-language="snip"><pre><code><span>priority</span> 1000
<span>snippet <span>'^.*\)/' </span><span>"() Fraction"</span> <span>wrA</span></span>
`<span>!p</span><span>
stripped <span>=</span> match<span>.</span>string<span>[</span><span>:</span><span>-</span><span>1</span><span>]</span>
depth <span>=</span> <span>0</span>
i <span>=</span> <span>len</span><span>(</span>stripped<span>)</span> <span>-</span> <span>1</span>
<span>while</span> <span>True</span><span>:</span>
	<span>if</span> stripped<span>[</span>i<span>]</span> <span>==</span> <span>')'</span><span>:</span> depth <span>+=</span> <span>1</span>
	<span>if</span> stripped<span>[</span>i<span>]</span> <span>==</span> <span>'('</span><span>:</span> depth <span>-=</span> <span>1</span>
	<span>if</span> depth <span>==</span> <span>0</span><span>:</span> <span>break</span><span>;</span>
	i <span>-=</span> <span>1</span>
snip<span>.</span>rv <span>=</span> stripped<span>[</span><span>0</span><span>:</span>i<span>]</span> <span>+</span> <span>"\\frac{"</span> <span>+</span> stripped<span>[</span>i<span>+</span><span>1</span><span>:</span><span>-</span><span>1</span><span>]</span> <span>+</span> <span>"}"</span>
`</span>{<span>$1</span>}<span>$0</span>
<span>endsnippet</span></code></pre></div>
<p>The last snip­pet con­cern­ing frac­tions I’d like to share is one that uses your se­lec­tion to make a frac­tion.  You can use it by first se­lect­ing some text, then press­ing <kbd>Tab</kbd>, typ­ing <code>/</code> and press­ing <kbd>Tab</kbd> again.</p>
<p><img src="https://castel.dev/0da01b9566dc437fabf0c563ed14941f/visualfrac.gif" alt="visualfrac"></p>
<p>The code makes use of the <code>${VISUAL}</code> vari­able that rep­re­sents your se­lec­tion.</p>
<div data-language="snip"><pre><code><span>snippet <span>/ </span><span>"Fraction"</span> <span>iA</span></span>
\\frac{<span>${VISUAL}</span>}{<span>$1</span>}<span>$0</span>
<span>endsnippet</span></code></pre></div>
<h3 id="sympy-and-mathematica">Sympy and Mathematica</h3>
<p>An­oth­er cool — but less used — snip­pet is one that uses <a href="https://www.sympy.org/" target="_blank" rel="nofollow noopener noreferrer">sympy</a> to eval­u­ate math­e­mat­i­cal ex­pres­sions. For ex­am­ple: <code>sympy</code> <kbd>Tab</kbd> ex­pands to <code>sympy | sympy</code>, and <code>sympy 1 + 1 sympy</code> <kbd>Tab</kbd> ex­pands to <code>2</code>.</p>
<p><img src="https://castel.dev/8c8f143fdcdc2f3e6de9853cf7ea3def/sympy.gif" alt="sympy"></p>
<div data-language="snip"><pre><code><span>snippet <span>sympy </span><span>"sympy block "</span> <span>w</span></span>
sympy <span>$1</span> sympy<span>$0</span>
<span>endsnippet</span>

<span>priority</span> 10000
<span>snippet <span>'sympy(.*)sympy' </span><span>"evaluate sympy"</span> <span>wr</span></span>
`<span>!p</span><span>
<span>from</span> sympy <span>import</span> <span>*</span>
x<span>,</span> y<span>,</span> z<span>,</span> t <span>=</span> symbols<span>(</span><span>'x y z t'</span><span>)</span>
k<span>,</span> m<span>,</span> n <span>=</span> symbols<span>(</span><span>'k m n'</span><span>,</span> integer<span>=</span><span>True</span><span>)</span>
f<span>,</span> g<span>,</span> h <span>=</span> symbols<span>(</span><span>'f g h'</span><span>,</span> cls<span>=</span>Function<span>)</span>
init_printing<span>(</span><span>)</span>
snip<span>.</span>rv <span>=</span> <span>eval</span><span>(</span><span>'latex('</span> <span>+</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span><span>.</span>replace<span>(</span><span>'\\'</span><span>,</span> <span>''</span><span>)</span> \
    <span>.</span>replace<span>(</span><span>'^'</span><span>,</span> <span>'**'</span><span>)</span> \
    <span>.</span>replace<span>(</span><span>'{'</span><span>,</span> <span>'('</span><span>)</span> \
    <span>.</span>replace<span>(</span><span>'}'</span><span>,</span> <span>')'</span><span>)</span> <span>+</span> <span>')'</span><span>)</span>
`</span>
<span>endsnippet</span></code></pre></div>
<p>For the Math­e­mat­i­ca users out there, you can do some­thing sim­i­lar:</p>
<p><img src="https://castel.dev/82f7f187a685a52ed7665fded563f936/mathematica.gif" alt="mathematica"></p>
<div data-language="snip"><pre><code><span>priority</span> 1000
<span>snippet <span>math </span><span>"mathematica block"</span> <span>w</span></span>
math <span>$1</span> math<span>$0</span>
<span>endsnippet</span>

<span>priority</span> 10000
<span>snippet <span>'math(.*)math' </span><span>"evaluate mathematica"</span> <span>wr</span></span>
`<span>!p</span><span>
<span>import</span> subprocess
code <span>=</span> <span>'ToString['</span> <span>+</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span> <span>+</span> <span>', TeXForm]'</span>
snip<span>.</span>rv <span>=</span> subprocess<span>.</span>check_output<span>(</span><span>[</span><span>'wolframscript'</span><span>,</span> <span>'-code'</span><span>,</span> code<span>]</span><span>)</span>
`</span>
<span>endsnippet</span></code></pre></div>
<h3 id="postfix-snippets">Postfix snippets</h3>
<p>Some other snip­pets I find worth shar­ing are post­fix snip­pets.
Ex­am­ples of such snip­pets are <code>phat</code> → <code>\hat{p}</code> and <code>zbar</code> → <code>\overline{z}</code>.
A sim­i­lar snip­pet is a post­fix vec­tor, for ex­am­ple <code>v,.</code> → <code>\vec{v}</code> and <code>v.,</code> → <code>\vec{v}</code>.
The order of <code>,</code> and <code>.</code> doesn’t mat­ter, so I can press them both at the same time.
These snip­pets are a real time-​saver, be­cause you can type in the same order the lec­tur­er writes on the black­board.</p>
<p><img src="https://castel.dev/7c2e62aae292bc4d65eae363c816e206/barhatvec.gif" alt="barhatvec"></p>
<p>Note that I can still use <code>bar</code> and <code>hat</code> pre­fix too, as I’ve added them with a lower pri­or­i­ty.
The code for those snip­pets is:</p>
<div data-language="snip"><pre><code><span>priority</span> 10
<span>snippet <span>"bar" </span><span>"bar"</span> <span>riA</span></span>
\overline{<span>$1</span>}<span>$0</span>
<span>endsnippet</span>

<span>priority</span> 100
<span>snippet <span>"([a-zA-Z])bar" </span><span>"bar"</span> <span>riA</span></span>
\overline{`<span>!p</span><span> snip<span>.</span>rv<span>=</span>match<span>.</span>group<span>(</span><span>1</span><span>)</span>`</span>}
<span>endsnippet</span></code></pre></div>
<div data-language="snip"><pre><code><span>priority</span> 10
<span>snippet <span>"hat" </span><span>"hat"</span> <span>riA</span></span>
\hat{<span>$1</span>}<span>$0</span>
<span>endsnippet</span>

<span>priority</span> 100
<span>snippet <span>"([a-zA-Z])hat" </span><span>"hat"</span> <span>riA</span></span>
\hat{`<span>!p</span><span> snip<span>.</span>rv<span>=</span>match<span>.</span>group<span>(</span><span>1</span><span>)</span>`</span>}
<span>endsnippet</span></code></pre></div>
<div data-language="snip"><pre><code><span>snippet <span>"(\\?\w+)(,\.|\.,)" </span><span>"Vector postfix"</span> <span>riA</span></span>
\vec{`<span>!p</span><span> snip<span>.</span>rv<span>=</span>match<span>.</span>group<span>(</span><span>1</span><span>)</span>`</span>}
<span>endsnippet</span> </code></pre></div>
<h3 id="other-snippets">Other snippets</h3>
<p>I have about 100 other com­mon­ly used snip­pets.
They are avail­able <a href="https://github.com/gillescastel/latex-snippets" target="_blank" rel="nofollow noopener noreferrer">here</a>.
Most of them are quite sim­ple.
For ex­am­ple, <code>!&gt;</code> be­comes <code>\mapsto</code>, <code>-&gt;</code> be­comes <code>\to</code>, etc.</p>
<p><img src="https://castel.dev/4ee36ef41c17f1ded1fffe13ba32b60d/complex5.gif" alt="complex5"></p>
<p><code>fun</code> be­comes <code>f: \R \to \R :</code>, <code>!&gt;</code> → <code>\mapsto</code>, <code>-&gt;</code> → <code>\to</code>, <code>cc</code> → <code>\subset</code>.</p>
<p><img src="https://castel.dev/a45092c95d91059b779f74cedda840e1/fun3.gif" alt="fun3"></p>
<p><code>lim</code> be­comes <code>\lim_{n \to \infty}</code>, <code>sum</code> → <code>\sum_{n = 1}^{\infty}</code>, <code>ooo</code> → <code>\infty</code></p>
<p><img src="https://castel.dev/2be9c99e6ab5787fc5196bbf4ce525a7/sum4.gif" alt="sum4"></p>
<p><img src="https://castel.dev/3be522f5e6e5ca7f871138732ba1b14d/bazel2.gif" alt="bazel2"></p>
<h3 id="course-specific-snippets">Course specific snippets</h3>
<p>Be­side my com­mon­ly used snip­pets, I also have course spe­cif­ic snip­pets.
These are loaded by adding the fol­low­ing to my <code>.vimrc</code>:</p>
<div data-language="vim"><pre><code><span>set</span> <span>rtp</span><span>+=</span>~<span>/</span>current_course</code></pre></div>
<p>where <code>current_course</code> is a <a href="https://en.wikipedia.org/wiki/Symbolic_link" target="_blank" rel="nofollow noopener noreferrer">sym­link</a> to my cur­rent­ly ac­ti­vat­ed course (more about that in an­oth­er blog post).
In that fold­er, I have a file <code>~/current_course/UltiSnips/tex.snippets</code> in which I in­clude course spe­cif­ic snip­pets. For ex­am­ple, for quan­tum me­chan­ics, I have snip­pets for bra/ket no­ta­tion.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;a|</code></td>
<td>→</td>
<td><code>\bra{a}</code></td>
</tr>
<tr>
<td><code>&lt;q|</code></td>
<td>→</td>
<td><code>\bra{\psi}</code></td>
</tr>
<tr>
<td><code>|a&gt;</code></td>
<td>→</td>
<td><code>\ket{a}</code></td>
</tr>
<tr>
<td><code>|q&gt;</code></td>
<td>→</td>
<td><code>\ket{\psi}</code></td>
</tr>
<tr>
<td><code>&lt;a|b&gt;</code></td>
<td>→</td>
<td><code>\braket{a}{b}</code></td>
</tr>
</tbody>
</table>
<p>As <code>\psi</code> is used a lot in quan­tum me­chan­ics, I re­place all in­stances of <code>q</code> in a braket with <code>\psi</code> when ex­pand­ed.</p>
<p><img src="https://castel.dev/268d331fdb83b6fa3563b6f2b0baac66/braket.gif" alt="braket"></p>
<div data-language="snip"><pre><code><span>snippet <span>"\&lt;(.*?)\|" </span><span>"bra"</span> <span>riA</span></span>
\bra{`<span>!p</span><span> snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span><span>.</span>replace<span>(</span><span>'q'</span><span>,</span> f<span>'\psi'</span><span>)</span><span>.</span>replace<span>(</span><span>'f'</span><span>,</span> f<span>'\phi'</span><span>)</span>`</span>}
<span>endsnippet</span>

<span>snippet <span>"\|(.*?)\&gt;" </span><span>"ket"</span> <span>riA</span></span>
\ket{`<span>!p</span><span> snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span><span>.</span>replace<span>(</span><span>'q'</span><span>,</span> f<span>'\psi'</span><span>)</span><span>.</span>replace<span>(</span><span>'f'</span><span>,</span> f<span>'\phi'</span><span>)</span>`</span>}
<span>endsnippet</span>

<span>snippet <span>"(.*)\\bra{(.*?)}([^\|]*?)\&gt;" </span><span>"braket"</span> <span>riA</span></span>
`<span>!p</span><span> snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>1</span><span>)</span>`\braket<span>{</span>`!p snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>2</span><span>)</span>`<span>}</span><span>{</span>`!p snip<span>.</span>rv <span>=</span> match<span>.</span>group<span>(</span><span>3</span><span>)</span><span>.</span>replace<span>(</span><span>'q'</span><span>,</span> f<span>'\psi'</span><span>)</span><span>.</span>replace<span>(</span><span>'f'</span><span>,</span> f<span>'\phi'</span><span>)</span>`</span>}
<span>endsnippet</span></code></pre></div>
<h3 id="context">Context</h3>
<p>One thing to con­sid­er when writ­ing these snip­pets is, ‘will these snip­pets col­lide with usual text?’
For ex­am­ple, ac­cord­ing to my dic­tio­nary, there are about 72 words in Eng­lish and 2000 words in Dutch that con­tain <code>sr</code>, which means that while I’m typ­ing the word <code>disregard</code>, the <code>sr</code> would ex­pand to <code>^2</code>, giv­ing me <code>di^2egard</code>.</p>
<p>The so­lu­tion to this prob­lem is adding a <em>con­text</em> to snip­pets. Using the syn­tax high­light­ing of Vim, it can be de­ter­mined whether or not Ul­tiSnips should ex­pand the snip­pet de­pend­ing if you’re in math or text.  I came up with the fol­low­ing:</p>
<div data-language="python"><pre><code><span>global</span> !p
texMathZones <span>=</span> <span>[</span><span>'texMathZone'</span><span>+</span>x <span>for</span> x <span>in</span> <span>[</span><span>'A'</span><span>,</span> <span>'AS'</span><span>,</span> <span>'B'</span><span>,</span> <span>'BS'</span><span>,</span> <span>'C'</span><span>,</span>
<span>'CS'</span><span>,</span> <span>'D'</span><span>,</span> <span>'DS'</span><span>,</span> <span>'E'</span><span>,</span> <span>'ES'</span><span>,</span> <span>'F'</span><span>,</span> <span>'FS'</span><span>,</span> <span>'G'</span><span>,</span> <span>'GS'</span><span>,</span> <span>'H'</span><span>,</span> <span>'HS'</span><span>,</span> <span>'I'</span><span>,</span> <span>'IS'</span><span>,</span>
<span>'J'</span><span>,</span> <span>'JS'</span><span>,</span> <span>'K'</span><span>,</span> <span>'KS'</span><span>,</span> <span>'L'</span><span>,</span> <span>'LS'</span><span>,</span> <span>'DS'</span><span>,</span> <span>'V'</span><span>,</span> <span>'W'</span><span>,</span> <span>'X'</span><span>,</span> <span>'Y'</span><span>,</span> <span>'Z'</span><span>]</span><span>]</span>

texIgnoreMathZones <span>=</span> <span>[</span><span>'texMathText'</span><span>]</span>

texMathZoneIds <span>=</span> vim<span>.</span><span>eval</span><span>(</span><span>'map('</span><span>+</span><span>str</span><span>(</span>texMathZones<span>)</span><span>+</span><span>", 'hlID(v:val)')"</span><span>)</span>
texIgnoreMathZoneIds <span>=</span> vim<span>.</span><span>eval</span><span>(</span><span>'map('</span><span>+</span><span>str</span><span>(</span>texIgnoreMathZones<span>)</span><span>+</span><span>", 'hlID(v:val)')"</span><span>)</span>

ignore <span>=</span> texIgnoreMathZoneIds<span>[</span><span>0</span><span>]</span>

<span>def</span> <span>math</span><span>(</span><span>)</span><span>:</span>
	synstackids <span>=</span> vim<span>.</span><span>eval</span><span>(</span><span>"synstack(line('.'), col('.') - (col('.')&gt;=2 ? 1 : 0))"</span><span>)</span>
	<span>try</span><span>:</span>
		first <span>=</span> <span>next</span><span>(</span>
            i <span>for</span> i <span>in</span> <span>reversed</span><span>(</span>synstackids<span>)</span>
            <span>if</span> i <span>in</span> texIgnoreMathZoneIds <span>or</span> i <span>in</span> texMathZoneIds
        <span>)</span>
		<span>return</span> first <span>!=</span> ignore
	<span>except</span> StopIteration<span>:</span>
		<span>return</span> <span>False</span>
endglobal</code></pre></div>
<p>Now you can add <code>context "math()"</code> to the snip­pets you’d only want to ex­pand in a math­e­mat­i­cal con­text.</p>
<div data-language="snip"><pre><code><span>context</span> "math()"
<span>snippet <span>sr </span><span>"^2"</span> <span>iA</span></span>
^2
<span>endsnippet</span></code></pre></div>
<p>Note that a ‘math­e­mat­i­cal con­text’ is a sub­tle thing.
Some­times you add some text in­side a math en­vi­ron­ment by using <code>\text{...}</code>.
In that case, you do not want snip­pets to ex­pand.
How­ev­er, in the fol­low­ing case: <code>\[ \text{$...$} \]</code>, they <em>should</em> ex­pand.
This is why the code for the <code>math</code> con­text is a bit com­pli­cat­ed.
The fol­low­ing an­i­ma­tion il­lus­trates these sub­tleties.</p>
<p><img src="https://castel.dev/e1b3ca2dd4fc1f5fe39679fb6ba38aad/syntaxtree.gif" alt="syntaxtree"></p>
<h2 id="correcting-spelling-mistakes-on-the-fly">Correcting spelling mistakes on the fly</h2>
<p>While in­sert­ing math­e­mat­ics is an im­por­tant part of my note-​taking setup, most of the time I’m typ­ing Eng­lish. At about 80 words per minute, my typ­ing skills are not bad, but I still make a lot of typos.
This is why I added a key­bind­ing to Vim that cor­rects the spelling mis­takes, with­out in­ter­rupt­ing my flow. When I press <kbd>Ctrl+L</kbd> while I’m typ­ing, the pre­vi­ous spelling mis­take is cor­rect­ed. It looks like this:</p>
<p><img src="https://castel.dev/0add705683b79cb94498104251a6d5b8/spellcheck.gif" alt="spellcheck"></p>
<p>My con­fig­u­ra­tion for spell check is the fol­low­ing:</p>
<div data-language="vim"><pre><code><span>setlocal</span> <span>spell</span>
<span>set</span> <span>spelllang</span><span>=</span>nl<span>,</span>en_gb
inoremap <span>&lt;</span>C<span>-</span><span>l</span><span>&gt;</span> <span>&lt;</span><span>c</span><span>-</span>g<span>&gt;</span><span>u</span><span>&lt;</span>Esc<span>&gt;</span><span>[</span>s1z<span>=</span>`<span>]</span>a<span>&lt;</span><span>c</span><span>-</span>g<span>&gt;</span><span>u</span></code></pre></div>
<p>It ba­si­cal­ly jumps to the pre­vi­ous spelling mis­take <code>[s</code>, then picks the first sug­ges­tion <code>1z=</code>, and then jumps back <code>`]a</code>. The <code>&lt;c-g&gt;u</code> in the mid­dle make it pos­si­ble to undo the spelling cor­rec­tion quick­ly.</p>
<h2 id="in-conclusion">In conclusion</h2>
<p>Using snip­pets in Vim, writ­ing LaTeX is no longer an an­noy­ance, but rather a plea­sure.
In com­bi­na­tion with spell check on the fly, it al­lows for a com­fort­able math­e­mat­i­cal note-​taking setup.
A few pieces are miss­ing though, for ex­am­ple draw­ing fig­ures dig­i­tal­ly and em­bed­ding them in a LaTeX doc­u­ment. This is a topic I’d like to tack­le in a fu­ture blog post.</p>
<p>Liked this blog post? Con­sid­er <a href="https://castel.dev/coffee">buy­ing me a cof­fee</a>!</p></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>