<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Moving from data science to machine learning engineering - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Moving from data science to machine learning engineering - linksfor.dev(s)"/>
    <meta property="article:author" content="https://towardsdatascience.com/@calebkaiser"/>
    <meta property="og:description" content="The world of machine learning&#x200A;&#x2014;&#x200A;and software&#x200A;&#x2014;&#x200A;is changing"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://towardsdatascience.com/moving-from-data-science-to-machine-learning-engineering-68916173eaf3?gi=5a0f382dc00"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Moving from data science to machine learning engineering</title>
<div class="readable">
        <h1>Moving from data science to machine learning engineering</h1>
            <div>by https://towardsdatascience.com/@calebkaiser</div>
            <div>Reading time: 9-12 minutes</div>
        <div>Posted here: 07 Jul 2020</div>
        <p><a href="https://towardsdatascience.com/moving-from-data-science-to-machine-learning-engineering-68916173eaf3?gi=5a0f382dc00">https://towardsdatascience.com/moving-from-data-science-to-machine-learning-engineering-68916173eaf3?gi=5a0f382dc00</a></p>
        <hr/>
<div id="readability-page-1" class="page"><section><div><div><h2 id="f0e5">The world of machine learning — and software — is changing</h2><div><div><div><p><a href="https://towardsdatascience.com/@calebkaiser?source=post_page-----68916173eaf3----------------------" rel="noopener"><img alt="Caleb Kaiser" src="https://miro.medium.com/fit/c/96/96/2*skgRuq75u5nms8oFeU7s8w.jpeg" width="48" height="48"></a></p></div></div></div><p id="fb5e" data-selectable-paragraph="">For the last 20 years, machine learning has been about one question: Can we train a model to do <em>something</em>?</p><p id="2218" data-selectable-paragraph=""><em>Something</em>, of course, can be any task. Predict the next word in a sentence, recognize faces in a photo, generate a certain sound. The goal was to see if machine learning worked, if we could make accurate predictions.</p><p id="a5da" data-selectable-paragraph="">Thanks to decades of work by data scientists, we now have a lot of models that can do a lot of <em>somethings</em>:</p><ul><li id="de03" data-selectable-paragraph="">OpenAI’s GPT-2 (and now GPT-3) can generate passably human text.</li><li id="2b0c" data-selectable-paragraph="">Object detection models like YOLOv5 (debates over the official version aside) can parse objects from 140 frames of video per second.</li><li id="ebc1" data-selectable-paragraph="">Text-to-speech models like Tacotron 2 can generate human-sounding speech.</li></ul><p id="7c8d" data-selectable-paragraph="">The work being done by data scientists and ML researchers is incredible, and as a result, a second question has naturally arisen:</p><p id="669c" data-selectable-paragraph=""><em>What can we build with these models, and how can we do it?</em></p><p id="687a" data-selectable-paragraph="">This is notably <em>not</em> a data science question. This is an engineering question. To answer it, a new discipline has emerged—<strong>machine learning engineering</strong>.</p><p id="8ab3" data-selectable-paragraph="">The difference between data science and machine learning engineering can feel a little intangible at first, and so it’s helpful to look at a few examples.</p><h2 id="4dbc" data-selectable-paragraph="">1. From image classification, to ML-generated catalogues</h2><p id="ca67" data-selectable-paragraph="">Image classification and keyword extraction are classic problems of computer vision and natural language processing, respectively.</p><p id="e67b" data-selectable-paragraph="">Glisten.ai uses an ensemble of models trained for both tasks to create an API that extracts structured information from product images:</p><figure><div><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/max/60/1*qbJ2PhcsZNXdQQmV1pUQgw.png?q=20" width="918" height="758"></p><p><img alt="Image for post" width="918" height="758" src="https://miro.medium.com/max/918/1*qbJ2PhcsZNXdQQmV1pUQgw.png" srcset="https://miro.medium.com/max/276/1*qbJ2PhcsZNXdQQmV1pUQgw.png 276w, https://miro.medium.com/max/552/1*qbJ2PhcsZNXdQQmV1pUQgw.png 552w, https://miro.medium.com/max/640/1*qbJ2PhcsZNXdQQmV1pUQgw.png 640w, https://miro.medium.com/max/700/1*qbJ2PhcsZNXdQQmV1pUQgw.png 700w" sizes="700px"></p></div></div></div></div><figcaption data-selectable-paragraph="">Source: <a href="https://techcrunch.com/2020/03/13/glisten-uses-computer-vision-to-break-down-fashion-photos-to-their-styles-and-parts/" target="_blank" rel="noopener nofollow">TechCrunch</a></figcaption></figure><p id="db62" data-selectable-paragraph="">The models themselves are impressive feats of data science. The Glisten API, however, is a feat of machine learning engineering.</p><h2 id="f67c" data-selectable-paragraph="">2. From object detection, to poacher prevention</h2><p id="6161" data-selectable-paragraph="">Wildlife Protection Solutions is a small nonprofit that uses technology to protect endangered species. Recently, they upgraded their video monitoring system to incorporate an object detection model trained to recognize poachers. The model has already <strong>doubled</strong> its detection rate:</p><figure><div><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/max/54/1*0tOswj0k-XGOvebMS2R9Lg.png?q=20" width="1294" height="1416"></p><p><img alt="Image for post" width="1294" height="1416"></p></div></div></div></div><figcaption data-selectable-paragraph="">Source: <a href="https://silverpond.com.au/case-studies/wildlife-protection-solutions/" target="_blank" rel="noopener nofollow">Silverpond</a></figcaption></figure><p id="aa61" data-selectable-paragraph="">Object detection models like YOLOv4 are successes of data science, and Highlighter—the platform WPS used to train their model—is an impressive data science tool. WPS’s poacher detection system, however, is a feat of machine learning engineering.</p><h2 id="5ae4" data-selectable-paragraph="">3. From machine translation to a COVID19 moonshot</h2><p id="242d" data-selectable-paragraph="">Machine translation refers to the use of machine learning to “translate” data from one form to another—sometimes between human languages, and sometimes between entirely different formats.</p><p id="2c40" data-selectable-paragraph="">PostEra is a medicinal chemistry platform that uses machine translation to “translate” a compound into an engineering blueprint. Currently, chemists are using the platform in an open source effort to find a treatment for COVID19:</p><figure><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/freeze/max/60/0*OdIteU7Q6rJ__ywD.gif?q=20" width="600" height="450"></p><p><img alt="Image for post" width="600" height="450"></p></div></div></div><figcaption data-selectable-paragraph="">Source: <a href="https://postera.ai/demo" target="_blank" rel="noopener nofollow">PostEra</a></figcaption></figure><p id="866a" data-selectable-paragraph="">Developing a model that can translate a molecule into a series of “routes” (transformations to go from one molecule to another) is a feat of data science. Building the PostEra platform is a feat of machine learning engineering.</p><h2 id="4bd2" data-selectable-paragraph="">4. From text generation, to ML dungeon masters</h2><p id="ca2c" data-selectable-paragraph="">OpenAI’s GPT-2 was, at the time of its release, the most powerful text generating model in history. At an insane 1.5 billion parameters, it represented a big step forward in transformer models.</p><p id="bc68" data-selectable-paragraph="">AI Dungeon is a classic dungeon crawler with a twist: its dungeon master is actually GPT-2 fine tuned on text from choose your own adventure stories:</p><figure><div></div></figure><p id="b19a" data-selectable-paragraph="">Training GPT-2 is a historic feat of data science. Building a dungeon crawler out of it is a feat of machine learning engineering.</p><p id="5b45" data-selectable-paragraph="">All of these platforms stand on the shoulders of data science. They wouldn’t work if they couldn’t train a model for their tasks. But, in order to apply these models to real world problems, they need to be engineered into applications.</p><p id="0208" data-selectable-paragraph="">Put another way, <strong>machine learning engineering is how the innovations of data science manifest outside of ML research</strong>.</p><p id="3743" data-selectable-paragraph="">The central challenge machine learning engineering presents, however, is that it introduces an entirely new category of engineering problems—ones we don’t have easy answers for just yet.</p><p id="4201" data-selectable-paragraph="">At a high-level, we can say that machine learning engineering refers to all the tasks required to take a trained model and build production applications:</p><figure><div><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/max/60/1*--HwGOSNS9TkKeeuIFGiNg.png?q=20" width="1676" height="718"></p><p><img alt="Image for post" width="1676" height="718"></p></div></div></div></div></figure><p id="2971" data-selectable-paragraph="">To make this more tangible, we can use a simple example.</p><p id="b5f3" data-selectable-paragraph="">Let’s go back to AI Dungeon, the ML-powered dungeon crawler. The game’s architecture is simple. Players input some text, the game makes a call to the model, the model generates a response, and the game displays it. The obvious way to build this is to deploy the model as a microservice.</p><p id="d90f" data-selectable-paragraph=""><mark>In theory, this should be similar to deploying any other web service. Wrap the model in an API with something like FastAPI, containerize it with Docker, deploy to a Kubernetes cluster, and expose it with a load balancer.</mark></p><figure><div><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/max/60/0*F_7oRcRgfPGIHgFM.png?q=20" width="1492" height="888"></p><p><img alt="Image for post" width="1492" height="888"></p></div></div></div></div><figcaption data-selectable-paragraph="">Source: <a href="https://github.com/cortexlabs/cortex" target="_blank" rel="noopener nofollow">Cortex inference architecture</a></figcaption></figure><p id="42ac" data-selectable-paragraph="">In practice, GPT-2 complicates things:</p><ul><li id="e701" data-selectable-paragraph=""><strong>GPT-2 is huge</strong>. The fully trained model is over 5 GB. In order to serve it, you need a cluster provisioned with large instance types.</li><li id="c472" data-selectable-paragraph=""><strong>GPT-2 is resource-intensive. </strong>A single prediction can lock up a GPU for extended periods of time. Low latency is difficult to achieve, and a single instance cannot handle many requests at once.</li><li id="3c03" data-selectable-paragraph=""><strong>GPT-2 is expensive. </strong>As a result of the above facts, deploying GPT-2 to production means that—assuming you have a decent amount of traffic—you will be running many large GPU instances, which gets expensive.</li></ul><p id="0115" data-selectable-paragraph="">When you consider that the game had over 1 million players very quickly after releasing, these problems become more severe.</p><p id="e447" data-selectable-paragraph="">Writing a performant API, provisioning a cluster with GPU instances, using spot instances to optimize costs, configuring autoscaling for inference workloads, implementing rolling updates so that the API doesn’t crash every time they update the model—it’s a lot of engineering work, and this a <em>simple </em>ML application.</p><p id="f9de" data-selectable-paragraph="">There are a number of common features—retraining, monitoring, multi-model endpoints, batch prediction, etc.—needed for many ML applications, each of which would raise the level of complexity significantly.</p><p id="9369" data-selectable-paragraph="">Solving these problems is what a machine learning engineer (in conjunction with an ML platform team, depending on the org) does, and their job is made significantly harder by the fact that most tooling for working with machine learning was designed for data science, not engineering.</p><p id="83e3" data-selectable-paragraph="">Fortunately, this is changing.</p><p id="8812" data-selectable-paragraph="">A couple years ago, a few of us transitioned from software engineering to MLE. After spending weeks hacking data science workflows and writing glue code to make ML applications work, we started thinking about how we could apply software engineering principles to machine learning engineering.</p><p id="f2c7" data-selectable-paragraph="">For example, look at AI Dungeon. If they were building a normal API—one that didn’t involve GPT-2—they would use something like Lambda to spin up their API in 15 minutes. Because of the ML-specific challenges of serving GPT-2, however, orchestration tools from software engineering won’t work.</p><p id="79f9" data-selectable-paragraph="">But, why shouldn’t the principles still apply?</p><p id="d05b" data-selectable-paragraph="">So, we started working on tools for machine learning engineering, tools that applied those principles. <a href="https://github.com/cortexlabs/cortex" target="_blank" rel="noopener nofollow">Cortex, our open source API platform</a>, makes it as easy as possible for machine learning engineers to deploy models as APIs, using an interface that will be familiar to any software engineer:</p><figure><div><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/max/60/0*CQAsYDXiUUW52nOK?q=20" width="1920" height="1080"></p><p><img alt="Image for post" width="1920" height="1080"></p></div></div></div></div><figcaption data-selectable-paragraph="">Source: <a href="https://github.com/cortexlabs/cortex" target="_blank" rel="noopener nofollow">Cortex repo</a></figcaption></figure><p id="7102" data-selectable-paragraph="">The API platform is actually what AI Dungeon—as well as every other ML startup listed above—used to deploy their models. The design philosophy behind it, and all of our work at Cortex, is very simple:</p><p id="1140" data-selectable-paragraph=""><strong>We treat the challenges of machine learning engineering as engineering—not data science—problems.</strong></p><p id="25b8" data-selectable-paragraph="">For the API platform, that means that instead of notebooks—which are difficult to version, rely on hidden state, and allow for arbitrary execution order—we use YAML and Python files. Instead of a GUI with a “Deploy” button, we built a CLI, through which you can actually manage deployments.</p><p id="30d1" data-selectable-paragraph="">You can apply this philosophy to many of the challenges of using machine learning in production.</p><p id="0fed" data-selectable-paragraph="">Reproducibility, for example, isn’t only a challenge in machine learning. It’s a problem in software engineering too—but we use version control to solve it. And while traditional version control software like Git doesn’t work for machine learning, you can still apply the principles. DVC (Data Version Control), which applies Git-like version control to training data, code, and their resulting models, does just this:</p><figure><div><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/max/60/0*_laV2-vzmlw6bWSP.png?q=20" width="1842" height="716"></p><p><img alt="Image for post" width="1842" height="716"></p></div></div></div></div><figcaption data-selectable-paragraph="">Source: <a href="https://dvc.org/doc/use-cases/versioning-data-and-model-files" target="_blank" rel="noopener nofollow">DVC</a></figcaption></figure><p id="aa1e" data-selectable-paragraph="">And what about all those files of boilerplate and glue code needed to initialize a model and generate predictions? In software engineering, we’d design a framework for this.</p><p id="6368" data-selectable-paragraph="">Finally, we’re seeing this happen in machine learning engineering too. Hugging Face’s Transformers library, for example, provides an easy interface for most popular transformer models:</p><figure><div><div><div><p><img alt="Image for post" src="https://miro.medium.com/max/60/0*ydqpzALyMdRtRG8z.png?q=20" width="504" height="132"></p><p><img alt="Image for post" width="504" height="132"></p></div></div></div><figcaption data-selectable-paragraph="">Source: <a href="https://huggingface.co/" target="_blank" rel="noopener nofollow">Hugging Face</a></figcaption></figure><p id="1f1f" data-selectable-paragraph="">With those six lines of Python, you can download, initialize, and serve predictions from GPT-2, one of the most powerful text generating models. That’s six lines of Python to do something not even mature, well-funded teams could do three years ago.</p><p id="7d29" data-selectable-paragraph="">What makes us so excited about this ecosystem—beyond the fact that we’re a part of it—is that it represents the bridge between decades of research into machine learning and the problems people face every day. Every time one of these projects removes a barrier to machine learning engineering, it becomes that much easier for a new team to solve a problem with machine learning.</p><p id="7c1d" data-selectable-paragraph="">In the future, machine learning is going to become a part of every engineer’s stack. There will hardly be a problem ML doesn’t touch. The pace at which this occurs is entirely dependent on how quickly we can develop platforms like Cortex, and accelerate the proliferation of machine learning engineering.</p><p id="4b59" data-selectable-paragraph="">If that is exciting to you too, <a href="https://github.com/cortexlabs" target="_blank" rel="noopener nofollow">we’re always happy to welcome new contributors</a>.</p></div></div></section></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>