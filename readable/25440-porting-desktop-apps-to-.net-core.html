<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Porting desktop apps to .NET Core -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Porting desktop apps to .NET Core</h1><div><div class="entry-content col-12 sharepostcontent"><div class="row justify-content-center"><div class="col-md-4"><div><img src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2018/10/Olia-Gavrysh-e1538680748374-150x150.jpg" width="58" height="58" alt="Olia Gavrysh" class="avatar avatar-58 wp-user-avatar wp-user-avatar-58 alignnone photo"><p>Olia</p></div></div></div><p>May 28th, 2019</p><p>Since I‚Äôve been working with the community on porting desktop applications from .NET Framework to .NET Core, I‚Äôve noticed that there are two camps of folks: some want a very simple and short list of instructions to get their apps ported to .NET Core while others prefer a more principled approach with more background information. Instead of writing up a ‚ÄúSwiss Army knife‚Äù-document, we are going to publish two blog posts, one for each camp:</p><ul><li><strong>This post is the simple case</strong>. It‚Äôs focused on simple instructions and smaller applications and is the easiest way to move your app to .NET Core.</li><li><strong>We will publish another post for more complicated cases</strong>. This post will focus more on non-trivial applications, such WPF application with dependencies on WCF and third-party UI packages.</li></ul><p>If you prefer watching videos instead of reading, here is the video where I do everything that is described below.</p><h2>Step 0 ‚Äì Prerequisites</h2><p>To port your desktop apps to Core, you‚Äôll need <a href="https://dotnet.microsoft.com/download">.NET Core 3</a> and Visual Studio 2019.</p><h2>Step 1 ‚Äì Run portability analyzer</h2><p>Before porting, you should check how compatible your application is with .NET Core. To do so, download and run <a href="https://blogs.msdn.microsoft.com/dotnet/2018/08/08/are-your-windows-forms-and-wpf-applications-ready-for-net-core-3-0/">.NET Portability Analyzer</a>.</p><ul><li>On the first tab, Portability Summary, if you have only 100% in .NET Core column (everything is highlighted in green), your code is fully compatible, go to Step 2.</li><li>If you have values of less than 100%, first look at all assemblies that aren‚Äôt part of you application. For those, check if their authors are providing versions for .NET Core or .NET Standard.</li><li>Now look at the other part of assemblies that are coming from your code. If you don‚Äôt have any of your assemblies listed in the portability report, go to Step 2. If you do, open Details tab, filter the table by clicking on the column Assembly and only focus on the ones that are from your application. Walk the list and refactor your code to stop using the API or replace the API usage with alternatives from .NET Core.</li></ul><p><a href="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2019/05/portability-report.png"><img class="size-full wp-image-23396" src="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2019/05/portability-report.png" alt="" width="615" height="232" srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2019/05/portability-report.png 615w, https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2019/05/portability-report-300x113.png 300w" sizes="(max-width: 615px) 100vw, 615px"></a></p><h2>Step 2 ‚Äì Migrate to SDK-style .csproj</h2><p>In <strong>Solution Explorer</strong> right-click on your project (not on the solution!). Do you see <strong>Edit Project File</strong>? If you do, you already use the SDK-style project file, so you should move to <strong>Step 3</strong>. If not, do the following.</p><ul><li>Check in the <strong>Solution Explorer</strong> if your project contains a <code>packages.config</code> file. If you don‚Äôt, no action is needed, if you do, right-click on <code>packages.config</code> and choose <strong>Migrate packages.config to PackageReference</strong>. Then click <strong>OK</strong>.</li><li>Open your project file by right-clicking on the project and choose <strong>Unload Project</strong>. Then right-click on the project and choose <strong>Edit &lt;your project name&gt;.csproj</strong>.</li><li>Copy the content of the project file somewhere, for example into Notepad, so you can search in it later.</li><li>Delete everything from your project file opened in Visual Studio (I know it sounds aggressive üòä, but we will add only needed content from the copy we‚Äôve just made in a few steps). Instead of the text you‚Äôve just deleted, paste the following code.For a WinForms application:<p>For a WPF application:<br></p></li><li>In Notepad, search for <code>PackageReference</code>. If you did not find anything, move on. If you found <code>PackageReference</code>, copy the entire <code>&lt;ItemGroup&gt;</code> that contains <code>PackageReference</code> in your project file, opened in Visual Studio, right below the lines you‚Äôve pasted in the step above. Do it for each occurrence of the <code>PackageReference</code> you have found. The copied block should look like this.<br></li><li>Now do the same as above for <code>ProjectReference</code>. If you did not find anything, move on. If you found any <code>ProjectReference</code> items, they would look like this.<br></li><li>You can remove lines with <code>&lt;Project&gt;</code> and <code>&lt;Name&gt;</code> properties, since they are not needed in the new project file style. So for each <code>ProjectReference</code> that you have found (if any), copy only <code>ItemGroup</code> and <code>ProjectReference</code> like this.<br></li><li>Save everything. Close the .csproj file in Visual Studio. Right-click on your project in the <strong>Solution Explorer</strong> and select <strong>Reload Project</strong>. Rebuild and make sure there are no errors.</li></ul><p>Great news, you just updated your project file to the new SDK-style! The project is still targeting .NET Framework, but now you‚Äôll be able to retarget it to .NET Core.</p><h2>Step 3 ‚Äì Retarget to .NET Core</h2><p>Open your project file by double-clicking on your project in <strong>Solution Explorer</strong>. Find the property <code>&lt;TargetFramework&gt;</code> and change the value to <code>netcoreapp3.0</code>. Now your project file should look like this:</p><p>Build and run your project. <strong>Congratulations, you ported to .NET Core 3!</strong></p><h2>Fixing errors</h2><p>If you get errors like</p><pre>The type or namespace &lt;some name&gt; could not be found</pre><p>or</p><pre>The name &lt;some name&gt; does not exist in the current context</pre><p>and your portability report was green, it should be easy to fix by adding a NuGet package with the corresponding library. If you cannot find the NuGet package with the library that is missing, try referencing <a href="https://docs.microsoft.com/dotnet/core/porting/windows-compat-pack">Microsoft.Windows.Compatibility</a>. This package adds ~21K .NET APIs from .NET Framework.</p><h2>Working with designers</h2><p>Even though it is possible to edit the user interface of your application via code, developers usually prefer using the visual designers. With .NET Core we had to rearchitect the way the designers work with .NET Core projects:</p><ul><li>The WPF designer is already in preview and we are working on adding more functionality to it.</li><li>The WinForms designer for .NET Core will be available later, and meanwhile there you can use the .NET Framework WinForms designer as a workaround.</li></ul><p>Here is how you can use the .NET Framework WinForms designer:</p><ol><li>Copy your .csproj file (let‚Äôs say you have <code>MyProject.csproj</code>), give it a different name, for example <code>MyProject.NetFramework.csproj</code> and put it next to your existing project file.</li><li>Make sure your project is closed in Visual Studio, open the new project <code>MyProject.NetFramework.csproj</code>.<br>In <strong>Solution Explorer</strong> right-click on your project and select&nbsp;<strong>Properties</strong>. In the Application tab (should be open by default) set <strong>Assembly name</strong> and <strong>Default namespace</strong> to the same values as in your initial project (remove ‚Äú.NetFramework‚Äù from the names).<br>Save this solution next to your existing solution.</li><li>Open the new project file and change the <code>&lt;TargetFramework&gt;</code> to <code>net472</code>.</li><li>Now when you need to use the WinForms designer, load your project with the <code>MyProject.NetFramework.csproj</code> project file and you‚Äôll get the full experience of .NET Framework designer. When you are done with the designer, close and open your project with the .NET Core project file.</li><li>This is just a workaround until the WinForms designer for .NET Core is ready.</li></ol><h2>Why port to .NET Core</h2><p>Check out the video where Scott Hunter and I are talking about all the new things coming with .NET Core 3 <a href="https://www.youtube.com/watch?v=upVQEUc_KwU&amp;feature=youtu.be">Porting to .NET Core 3.0</a>.</p><div class="authorinfoarea"><div><p>Program Manager,&nbsp;.NET</p><p><strong>Follow Olia</strong>&nbsp;&nbsp;&nbsp;<a class="no-underline stayinformed" aria-label="Olia Gavrysh Twitter profile" target="_blank" href="https://twitter.com/oliagavrysh"></a><a class="no-underline stayinformed" aria-label="Olia Gavrysh GitHub profile" target="_blank" href="https://github.com/OliaG"><i class="fa fa-github"></i></a><a class="no-underline stayinformed hvr-pop" aria-label="Olia Gavrysh RSS Feed" target="_blank" href="https://devblogs.microsoft.com/dotnet/author/olga-gavrysh/feed/"></a></p></div></div></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>