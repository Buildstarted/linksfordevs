<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Learning about .NET Core futures by poking around at David Fowler&#x27;s GitHub -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Learning about .NET Core futures by poking around at David Fowler's GitHub</h1><div><div id="" class="containerInner blogBody"><p><img title="A picture of David silently judging my code, but with love" alt="A picture of David silently judging my code, but with love" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/3627e039e1b0_F508/image_8b6da31e-e498-4f6c-a3fd-90c61a65e02c.png" width="250" align="right" height="322"><a href="https://github.com/davidfowl">David Fowler is the ASP.NET Core Architect</a> (and an <a href="https://www.youtube.com/watch?v=c8AIAEPKM2Q">amazing highly technical public speaker</a>) and I've learned a lot from watching him code. However, what's the best way for YOU to learn from folks like David if you can't sit on their shoulder? Why, look at their GitHub! </p><p>Since .NET Core (and most of Microsoft) is not only open source but also developed in the open now on GitHub, we can actually watch folks in their day to day work as they commit code to projects like the <a href="https://github.com/dotnet/roslyn">C# compiler</a>, <a href="http://github.com/dotnet">.NET Core</a>, and <a href="https://github.com/aspnet/AspNetCore">ASP.NET Core</a>.</p><p>Even more interestingly, we can look at David's github here <a title="https://github.com/davidfowl" href="https://github.com/davidfowl">https://github.com/davidfowl</a> and then under <a href="https://github.com/davidfowl?tab=repositories">Repositories</a> see what he's up to, filter by language and type, and explore! Sometimes <a href="https://github.com/aspnet/aspnetcore/pulls">I just explore the Pull Requests on projects like ASP.NET Core</a>.</p><p>You can have Private repositories on GitHub, as I do, and as I'm sure David does. But GitHub is a social network for code and it's more fun and a better learning experience when we can see each others code and read it. Read with a critical eye, but without judgment as you may not have all the context that the author does. If you went to my GitHub, <a title="https://github.com/shanselman" href="https://github.com/shanselman">https://github.com/shanselman</a> you might be disappointed but you also may be missing the big picture. Just consider that as you Follow people and explore their code.</p><p>David is an advanced .NET developer, while, for example, I am comparatively intermediate. So I realize that not all of David's code is FOR me. It's a scratchpad, it's not educational how-to workshops. However, I <em>can</em> get pick up cool idioms, interesting directions the tech may be going, and more importantly - prototypes and spikes. Spikes are folks testing out technical ideas. They may not be complete. In fact, they may never be complete. But some my be harbingers of things to come.</p><p>Here's a few things I learned today.</p><h3>gRPC for .NET Core</h3><p>For example, at <a title="https://github.com/davidfowl/grpc-dotnet" href="https://github.com/davidfowl/grpc-dotnet">https://github.com/davidfowl/grpc-dotnet</a> I can see David has forked (copied) gRPC for dotnet and his game is working with the gRPC folks to make a fully supported version of gRPC for production workloads with .NET Core! Here are the stated goals:</p><ul><li>We plan to implement a fully-managed version of gRPC for .NET that will be built on top of ASP.NET Core HTTP/2 server.  </li><li>Good integration with the rest of ASP.NET Core ecosystem  </li><li>High-performance (we plan to utilize some of the cutting edge performance features from ASP.NET Core and in .NET plaform itself)</li></ul><p>That sounds cool! I can go learn that gRPC is a modern (google sponsored) Remote Procedure Call framework that can run anywhere. It's used by Netflix and Square and supports basically any languaige and any environment. Nice for this microservice world we are entering and hopefully has learned from the sins of DCOM and CORBA and RMI, because I was there and it sucked.</p><h3>Nothing to see here but moving to a new JSON serializer</h3><p>This Web.Framework sounds fun, and I'll be sure to take the description to heart.</p><p><img title="says &quot;Lame name, just a prototype, nothing to see here (move along)&quot;" alt="says &quot;Lame name, just a prototype, nothing to see here (move along)&quot;" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/3627e039e1b0_F508/image_f91df708-0920-47da-a6be-0cba5109828c.png" width="400" height="130"></p><p>You can see David and James Newton-King kicking ideas around as <a href="https://github.com/davidfowl/Web.Framework/commits/master">you explore the commit log</a>. However, the most interesting commit IMHO is when David moves this little spike from using JSON.NET (the ubiquitous 3rd party JSON serializer) to the new emerging official System.Text.Json. Here is <a href="https://github.com/davidfowl/Web.Framework/commit/be5d5cf06a8bd3d41218e7cb01e2c95a164992e4?diff=unified">the commit with unified differences</a>.</p><p>It's a small change but it also makes me feel good about the API underneath this new JSON API that's coming. My takeway is that it's not as scary as I'd assumed. Looks like a Good Thing(tm).</p><figure><img title="A diff of code shows that just one line is changed to move JSON serializers" alt="A diff of code shows that just one line is changed to move JSON serializers" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/3627e039e1b0_F508/image_e05feeeb-2032-4841-8916-3c4141224686.png" width="999" height="347"></figure><p>Cool!</p><h3>Multi-Protocol ASP.NET Core</h3><p>This looks interesting. </p><blockquote><p>"The following sample shows how you can host a TCP server and HTTP server in the same ASP.NET Core application. Under the covers, it's the same server (Kestrel) running different protocols on different ports. The <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.connections.connectionhandler?view=aspnetcore-2.1">ConnectionHandler</a> is a new primitive introduced in ASP.NET Core 2.1 to support non-HTTP protocols."</p></blockquote><p>I didn't know you could do that! Looks like this sample hasn't changed much since it was conceived of in 2018, but then <a href="https://github.com/davidfowl/MultiProtocolAspNetCore/commits/master">in the last month it's been updated twice</a> and it appears to be part of a larger, <a href="https://github.com/aspnet/KestrelHttpServer/issues/1980">slow-moving architectural issue called Bedrock</a> that's moving forward.</p><p>I learned that Kestral (the ASP.NET Core web server) has <a href="https://github.com/davidfowl/MultiProtocolAspNetCore/blob/73249141dff878bb5937b1895c101da49d4d4b0b/KestrelTcpDemo/Program.cs#L31">a "ListenLocalhost" option on its options object</a>!</p><pre class="brush: csharp; gutter: false; toolbar: false; auto-links: false;">WebHost.CreateDefaultBuilder(args)<br>.ConfigureServices(services =&gt;<br>{<br>// This shows how a custom framework could plug in an experience without using Kestrel APIs directly<br>services.AddFramework(new IPEndPoint(IPAddress.Loopback, 8009));<br>})<br>.UseKestrel(options =&gt;<br>{<br>// TCP 8007<br>options.ListenLocalhost(8007, builder =&gt;<br>{<br>builder.UseConnectionHandler&lt;MyEchoConnectionHandler&gt;();<br>});<p>// HTTP 5000<br>options.ListenLocalhost(5000);</p><p>// HTTPS 5001<br>options.ListenLocalhost(5001, builder =&gt;<br>{<br>builder.UseHttps();<br>});<br>})<br>.UseStartup&lt;Startup&gt;();
</p></pre><p>I can see here that TCP port 8007 is customer and uses a custom <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.kestrel.core.internal.connectionhandler-1?view=aspnetcore-2.0">ConnectionHandler</a> which I also didn't know existed! I can then look at the implementation of that handler and it's cool how clean the API is. You can get the result cleanly off the Transport buffer. You're doing low-level TCP but it doesn't feel low level.</p><pre class="brush: csharp; gutter: false; toolbar: false; auto-links: false;">using System.Threading.Tasks;<br>using Microsoft.AspNetCore.Connections;<br>using Microsoft.Extensions.Logging;<p>namespace KestrelTcpDemo<br>{<br>public class MyEchoConnectionHandler : ConnectionHandler<br>{<br>private readonly ILogger&lt;MyEchoConnectionHandler&gt; _logger;</p><p>public MyEchoConnectionHandler(ILogger&lt;MyEchoConnectionHandler&gt; logger)<br>{<br>_logger = logger;<br>}</p><p>public override async Task OnConnectedAsync(ConnectionContext connection)<br>{<br>_logger.LogInformation(connection.ConnectionId + " connected");</p><p>while (true)<br>{<br>var result = await connection.Transport.Input.ReadAsync();<br>var buffer = result.Buffer;</p><p>foreach (var segment in buffer)<br>{<br>await connection.Transport.Output.WriteAsync(segment);<br>}</p><p>if (result.IsCompleted)<br>{<br>break;<br>}</p><p>connection.Transport.Input.AdvanceTo(buffer.End);<br>}</p><p>_logger.LogInformation(connection.ConnectionId + " disconnected");<br>}<br>}<br>}
</p></pre><p>Pretty slick. This just echos what is sent to that port but not only has it educated me about a thing I didn't know about, it's something I can mentally file away until I need it! </p><p>All of these things I learned in just 30 minutes of exploring someone's public repository.</p><p>What kinds of code do you like to read and what have you learned from just poking around?</p><hr><p><strong>Sponsor:</strong><a href="https://hnsl.mn/2SlZ5Jk">Get the latest JetBrains Rider</a> for remote debugging via SSH, SQL injections, a new Search Everywhere popup, and improved Unity support. </p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>