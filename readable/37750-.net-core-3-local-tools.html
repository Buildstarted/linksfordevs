<!DOCTYPE html>
<html lang="en">
<head>
    <title>
.NET Core 3 Local Tools -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>.NET Core 3 Local Tools</h1><div><div class="post-content"><p>.NET Tools are great, and we've known them for a while in .NET Core as ".NET Core Global Tools", but often we don't want these tools to be shared globally across our machine. This is where "Local Tools" come in handy, introduced in .NET Core SDK 3.0.</p><p>As an example, let's look at the Cake (<a href="https://github.com/cake-build/cake">Cake build</a>) tool, however this applies to any .NET Tool.</p><p>We could install <code>Cake.Tool</code> globally like this:</p><p><span>dotnet&nbsp;tool&nbsp;install&nbsp;--global&nbsp;Cake.Tool</span></p><p>This will work just fine, but if we have multiple projects, we are going to want to have different versions of the Cake tool installer per project.</p><h2 id="the-old-way">The Old Way</h2><p>Previously we could do this by running the following command:</p><p><span>dotnet&nbsp;tool&nbsp;install&nbsp;--tool-path&nbsp;.tools&nbsp;Cake.Tool</span></p><p>Where <code>.tools</code> is the path you'd like to install the tool to. With this we could run cake like this (on macOS, it works similarly on Windows):</p><p><span>./.tools/dotnet-cake&nbsp;--help</span></p><p>That was fine, however there are a few ways the overall approach lacked:</p><ul><li>You didn't have a file with a discoverable list of tools used for the project, you'd typically have the above commands in a script file, and you'd need to think about should it be <code>pwsh</code>, &nbsp;<code>bash</code> or other. </li><li>If you had the same version of a tool in x different folders, you'd have x copies of the tool on your disk (packages here would be restored to <code>.tools/.store/</code>).</li><li>Launching the tool was platform dependant due to the tools file suffix.</li><li>The initial command was hard to remember, I always needed to look up <code>--tool-path</code>.</li></ul><h2 id="the-new-way-">The New Way âœ¨</h2><p>With the .NET Core 3 CLI, you we can now use Local Tools.</p><p>First you need a tools manifest file, this will eventually contain the list of installed tools. We can create it using this command:</p><p><span>dotnet&nbsp;new&nbsp;tool-manifest</span></p><p>Now we have a file created at <code>.config/dotnet-tools.json</code> with the following contents:</p><div class="vscode"><p><span>{</span></p><p><span>&nbsp;&nbsp;</span><span>"version"</span><span>:&nbsp;</span><span>1</span><span>,</span></p><p><span>&nbsp;&nbsp;</span><span>"isRoot"</span><span>:&nbsp;</span><span>true</span><span>,</span></p><p><span>&nbsp;&nbsp;</span><span>"tools"</span><span>:&nbsp;{}</span></p><p><span>}</span></p></div><p>Now we can start installing tools, now with an easier to remember command:</p><p><span>dotnet&nbsp;tool&nbsp;install&nbsp;Cake.Tool</span></p><p>I don't know about you, but I've ran this command many times before they made this "a thing" expecting it to work.</p><p>Now if we look at our <code>dotnet-tools.json</code> file it looks like this:</p><div class="vscode"><p><span>{</span></p><p><span>&nbsp;&nbsp;</span><span>"version"</span><span>:&nbsp;</span><span>1</span><span>,</span></p><p><span>&nbsp;&nbsp;</span><span>"isRoot"</span><span>:&nbsp;</span><span>true</span><span>,</span></p><p><span>&nbsp;&nbsp;</span><span>"tools"</span><span>:&nbsp;{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>"cake.tool"</span><span>:&nbsp;{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>"version"</span><span>:&nbsp;</span><span>"0.34.1"</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>"commands"</span><span>:&nbsp;[</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>"dotnet-cake"</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p><span>&nbsp;&nbsp;}</span></p><p><span>}</span></p></div><p>Now we can run our command with:</p><div class="vscode"><p><span>dotnet&nbsp;cake&nbsp;--help</span></p><p><span>#&nbsp;which&nbsp;is&nbsp;short&nbsp;for</span></p><p><span>dotnet&nbsp;dotnet-cake&nbsp;--help</span></p><p><span>#&nbsp;you&nbsp;can&nbsp;alternatively&nbsp;write&nbsp;it&nbsp;as:</span></p><p><span>dotnet&nbsp;tool&nbsp;run&nbsp;dotnet-cake&nbsp;--help</span></p></div><p>Now we can check in our <code>.config</code> and other users of our project can discover the tools we have added. The tool is installed to the global nuget package cache, like a typical nuget package, if the user does not have the package present they will get the following message when trying to first run the tool:</p><p><span>Run&nbsp;</span><span>"dotnet&nbsp;tool&nbsp;restore"</span><span>&nbsp;to&nbsp;make&nbsp;the&nbsp;</span><span>"dotnet-cake"</span><span>&nbsp;command&nbsp;available.</span></p><p>So they are just one simple command away from restoring the tool and being able to use it.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>