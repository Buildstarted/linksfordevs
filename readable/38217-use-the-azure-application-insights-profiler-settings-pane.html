<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Use the Azure Application Insights Profiler settings pane -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Use the Azure Application Insights Profiler settings pane</h1>
    <main id="main" class="content "> <ul class="metadata page-metadata"> <li class="displayDate loading"> <time>08/06/2018</time> </li> <li class="readingTime">4 minutes to read</li> <li class="contributors-holder"> <a class="has-inner-focus" href="https://github.com/Microsoft/azure-docs/blob/master/articles/azure-monitor/app/profiler-settings.md"> <ul class="contributors"> <li><img src="https://github.com/cweining.png?size=32"></li> <li><img src="https://github.com/nschonni.png?size=32"></li> <li><img src="https://github.com/juliusl.png?size=32"></li> <li><img src="https://github.com/MSshujia.png?size=32"></li> <li><img src="https://github.com/mrbullwinkle.png?size=32"></li> <li><span class="is-size-8 has-text-subtle">+1</span></li> </ul> </a> </li> </ul> <p>The trigger features only work with version 2.6 or newer of the profiler agent. If you are running an Azure App Service, your agent will be updated automatically. You can see what version of the agent you are running if you go to the Kudu URL for your website and append \DiagnosticServices to the end of it, like this: <a href="https://yourwebsite.scm.azurewebsites.net/diagnosticservices">https://yourwebsite.scm.azurewebsites.net/diagnosticservices</a>. The Application Insights Profiler Webjob should version 2.6 or newer. You can force an upgrade by restarting your web app.</p>
<p>If you are running the profiler on a VM or Cloud Service, you need to have Windows Azure Diagnostics (WAD) extension version 16.0.4 or newer installed. You can check the version of WAD by logging onto your VM and looking this directory: C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\1.16.0.4. The directory name is the version of WAD that is installed. The Azure VM agent will update WAD automatically when new versions are available.</p>
<h2 id="profiler-settings-page">Profiler settings page</h2>
<p>To open the Azure Application Insights Profiler settings pane, go to the Application Insights Performance pane, and then select the <strong>Configure Profiler</strong> button.</p>
<p><img src="media/profiler-settings/configure-profiler-entry.png" alt="Link to open Profiler settings page"></p>
<p>That opens a page that looks like this:</p>
<p><img src="media/profiler-settings/configureblade.png" alt="Profiler settings page"></p>
<p>The <strong>Configure Application Insights Profiler</strong> page has these features:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Profile Now</td>
<td>Starts profiling sessions for all apps that are linked to this instance of Application Insights.</td>
</tr>
<tr>
<td>Triggers</td>
<td>Allows you to configure triggers that cause the profiler to run.</td>
</tr>
<tr>
<td>Recent profiling sessions</td>
<td>Displays information about past profiling sessions.</td>
</tr>
</tbody>
</table>
<h2 id="profile-now">Profile Now</h2>
<p>This option allows you to start a profiling session on demand. When you click this link, all profiler agents that are sending data to this Application Insights instance will start to capture a profile. After 5 to 10 minutes, the profile session will show in the list below.</p>
<p>For a user to manually trigger a profiler session, they require at minimum &quot;write&quot; access on their role for the Application Insights component. In most cases, you get this access automatically and no additional work is needed. If you&apos;re having issues, the subscription scope role to add would be the &quot;Application Insights Component Contributor&quot; role. <a href="https://docs.microsoft.com/azure/azure-monitor/app/resources-roles-access-control">See more about role access control with Azure Monitoring</a>.</p>
<h2 id="trigger-settings">Trigger Settings</h2>
<p><img src="media/profiler-settings/cputrigger.png" alt="Trigger Settings Flyout"></p>
<p>Clicking the Triggers button on the menu bar opens the trigger settings box. You can set up trigger to start profiling when the percentage of CPU or Memory use hits the level you set.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>On / Off Button</td>
<td>On: profiler can be started by this trigger; Off: profiler won&apos;t be started by this trigger.</td>
</tr>
<tr>
<td>Memory threshold</td>
<td>When this percentage of memory is in use, the profiler will be started.</td>
</tr>
<tr>
<td>Duration</td>
<td>Sets the length of time the profiler will run when triggered.</td>
</tr>
<tr>
<td>Cooldown</td>
<td>Sets the length of time the profiler will wait before checking for the memory or CPU usage again after it&apos;s triggered.</td>
</tr>
</tbody>
</table>
<h2 id="recent-profiling-sessions">Recent Profiling Sessions</h2>
<p>This section of the page shows information about recent profiling sessions. A profiling session represents the period of time when the profiler agent was taking a profile on one of the machines hosting your application. You can open the profiles from a session by clicking on one of the rows. For each session, we show:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Triggered by</td>
<td>How the session was started, either by a trigger, Profile Now, or default sampling.</td>
</tr>
<tr>
<td>App Name</td>
<td>Name of the application that was profiled.</td>
</tr>
<tr>
<td>Machine Instance</td>
<td>Name of the machine the profiler agent ran on.</td>
</tr>
<tr>
<td>Timestamp</td>
<td>Time when the profile was captured.</td>
</tr>
<tr>
<td>Tracee</td>
<td>Number of traces that were attached to individual requests.</td>
</tr>
<tr>
<td>CPU %</td>
<td>Percentage of CPU that was being used while the profiler was running.</td>
</tr>
<tr>
<td>Memory %</td>
<td>Percentage of memory that was being used while the profiler was running.</td>
</tr>
</tbody>
</table>
<h2 id="profileondemand"> Use web performance tests to generate traffic to your application</h2>
<p>You can trigger Profiler manually with a single click. Suppose you&apos;re running a web performance test. You&apos;ll need traces to help you understand how your web app is running under load. Having control over when traces are captured is crucial, because you know when the load test will be running. But the random sampling interval might miss it.</p>
<p>The next sections illustrate how this scenario works:</p>
<h3 id="step-1-generate-traffic-to-your-web-app-by-starting-a-web-performance-test">Step 1: Generate traffic to your web app by starting a web performance test</h3>
<p>If your web app already has incoming traffic or if you just want to manually generate traffic, skip this section and continue to Step 2.</p>
<ol>
<li><p>In the Application Insights portal, select <strong>Configure</strong> &gt; <strong>Performance Testing</strong>.</p>
</li>
<li><p>To start a new performance test, select the <strong>New</strong> button.</p>
<p><img src="media/profiler-settings/new-performance-test.png" alt="create new performance test"></p>
</li>
<li><p>In the <strong>New performance test</strong> pane, configure the test target URL. Accept all default settings, and then select <strong>Run test</strong> to start running the load test.</p>
<p><img src="media/profiler-settings/configure-performance-test.png" alt="Configure load test"></p>
<p>The new test is queued first, followed by a status of <em>in progress</em>.</p>
<p><img src="media/profiler-settings/load-test-queued.png" alt="Load test is submitted and queued"></p>
<p><img src="media/profiler-settings/load-test-inprogress.png" alt="Load test is running in progress"></p>
</li>
</ol>
<h3 id="step-2-start-a-profiler-on-demand-session">Step 2: Start a Profiler on-demand session</h3>
<ol>
<li><p>When the load test is running, start Profiler to capture traces on the web app while it&apos;s receiving load.</p>
</li>
<li><p>Go to the <strong>Configure Profiler</strong> pane.</p>
</li>
</ol>
<h3 id="step-3-view-traces">Step 3: View traces</h3>
<p>After Profiler finishes running, follow the instructions on notification to go to Performance pane and view traces.</p>
<h2 id="next-steps">Next steps</h2>
<p><a href="profiler-overview?toc=/azure/azure-monitor/toc.json">Enable Profiler and view traces</a></p> </main>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>