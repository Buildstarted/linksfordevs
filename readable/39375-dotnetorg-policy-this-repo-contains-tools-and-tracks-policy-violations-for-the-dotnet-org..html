<!DOCTYPE html>
<html lang="en">
<head>
    <title>
dotnet/org-policy: This repo contains tools and tracks policy violations for the dotnet org. -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>dotnet/org-policy: This repo contains tools and tracks policy violations for the dotnet org.</h1><div><div id="" class="markdown-body entry-content p-5"><p><a href="https://dev.azure.com/dnceng/public/_build/latest?definitionId=650&amp;branchName=master" rel="nofollow"><img src="https://camo.githubusercontent.com/6e244d77177be2807445bbab35d1e51355b13ddb/68747470733a2f2f6465762e617a7572652e636f6d2f646e63656e672f7075626c69632f5f617069732f6275696c642f7374617475732f646f746e65742e6f72672d706f6c6963793f6272616e63684e616d653d6d6173746572" alt="Build Status" data-canonical-src="https://dev.azure.com/dnceng/public/_apis/build/status/dotnet.org-policy?branchName=master"></a></p><p>This repo contains tools and tracks policy violations.</p><h2><a id="user-content-policies-and-process" class="anchor" aria-hidden="true" href="#policies-and-process"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Policies and process</h2><p>For details on policies, see <a href="/dotnet/org-policy/blob/master/doc/README.md">the docs</a>.</p><h2><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage</h2><p>For the <code>dotnet</code> org, the policies are evaluated daily and violations are posted
in the internal repo <a href="https://github.com/dotnet/org-policy-violations">org-policy-violations</a>. The repo is internal because it
contains names of private repos and teams.</p><h2><a id="user-content-running-locally" class="anchor" aria-hidden="true" href="#running-locally"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running locally</h2><p>You can run the tool locally by cloning this repo and running <code>policop.cmd</code> from
the root.</p><h3><a id="user-content-getting-the-org-data" class="anchor" aria-hidden="true" href="#getting-the-org-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Getting the org data</h3><p>Before you can do anything useful, you need to get access to the org data, which
includes repos, teams, users and their relationships. This also includes access
to linking information between Microsoft user accounts and GitHub user accounts.</p><p>Due to performance and API rate limitations it's not practical to query this
information from GitHub when you're experimenting and trying to analyze the org.
So instead, you can download a cached version of the org that was computed and
uploaded to a private Azure DevOps project during the nightly policy runs.</p><p>You do this by running:</p><p>This will download the latest version of the org data and store it on your local
machine. If you run this command for the first time, it will take you to a
website where you'll need to create an access token that the tool will then
store and use on future calls.</p><p>You can check how old your local cache is by running</p><p>You can also clear the cache with</p><h3><a id="user-content-evaluating-policies" class="anchor" aria-hidden="true" href="#evaluating-policies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Evaluating policies</h3><p>In order to check policies, you simply use this command:</p><p>This will compute all policy violations and display the result in Excel. You can
also write them to a file if you prefer that:</p><div class="highlight highlight-source-postscript"><pre><span class="pl-smi">$</span><span class="pl-smi">.\policop</span><span class="pl-smi">check</span><span class="pl-smi">-o</span><span class="pl-smi">D:\temp\test.csv</span></pre></div><h3><a id="user-content-querying-org-data" class="anchor" aria-hidden="true" href="#querying-org-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Querying org data</h3><p>The primary command is <code>policop list</code> which you can use to query information
from the org.</p><p>Using <code>-r</code>, <code>-t</code>, and <code>-u</code> you can list all components of the org:</p><ul><li><code>-r</code> the list of repos</li><li><code>-t</code> the list of teams</li><li><code>-u</code> the list of users</li><li><code>-r -t</code> the list of repos and permissions teams are given</li><li><code>-r -u</code> the list of repos and permissions users are given</li><li><code>-t -u</code> the list of teams and their members</li><li><code>-r -t -u</code> the list of repos and permissions teams &amp; users are given</li></ul><p>Each of those options accept a list of terms you can use to filter,
with basic wild card support, such as <code>*core*</code> or <code>dotnet*</code>.</p><p>So to list all teams whose name contains the text <code>core</code> you'd do this:</p><p>To find all members of all teams named <code>*core*</code> you'd do this:</p><div class="highlight highlight-source-postscript"><pre><span class="pl-smi">#</span><span class="pl-smi">List</span><span class="pl-smi">team</span><span class="pl-smi">members</span><span class="pl-smi">of</span><span class="pl-smi">teams</span><span class="pl-smi">whose</span><span class="pl-smi">name</span><span class="pl-smi">contains</span><span class="pl-smi">"core"</span><span class="pl-smi">$</span><span class="pl-smi">.\policop</span><span class="pl-smi">list</span><span class="pl-smi">-t</span><span class="pl-smi">*core*</span><span class="pl-smi">-u</span></pre></div><p>Using <code>-f</code> you can also filter:</p><div class="highlight highlight-source-postscript"><pre><span class="pl-smi">#</span><span class="pl-smi">List</span><span class="pl-smi">all</span><span class="pl-smi">repos</span><span class="pl-smi">whose</span><span class="pl-smi">name</span><span class="pl-smi">contains</span><span class="pl-smi">dotnet</span><span class="pl-k">and</span><span class="pl-k">where</span><span class="pl-smi">a</span><span class="pl-smi">team</span><span class="pl-smi">#</span><span class="pl-smi">grants</span><span class="pl-smi">admin</span><span class="pl-smi">access</span><span class="pl-smi">$</span><span class="pl-smi">.\policop</span><span class="pl-smi">list</span><span class="pl-smi">-r</span><span class="pl-smi">*dotnet*</span><span class="pl-smi">-t</span><span class="pl-smi">-f</span><span class="pl-smi">rt:permission=admin</span></pre></div><p>For columns returning <code>Yes</code>/<code>No</code> you can also use the simple
version:</p><div class="highlight highlight-source-postscript"><pre><span class="pl-smi">#</span><span class="pl-smi">List</span><span class="pl-smi">all</span><span class="pl-smi">private</span><span class="pl-smi">repos</span><span class="pl-smi">$</span><span class="pl-smi">.\policop</span><span class="pl-smi">list</span><span class="pl-smi">-r</span><span class="pl-smi">-f</span><span class="pl-smi">r:private</span></pre></div><p>And lastly, using <code>-c</code> you can create custom reports with specific columns:</p><div class="highlight highlight-source-postscript"><pre><span class="pl-smi">#</span><span class="pl-smi">List</span><span class="pl-smi">all</span><span class="pl-smi">private</span><span class="pl-smi">repos</span><span class="pl-k">and</span><span class="pl-k">show</span><span class="pl-smi">their</span><span class="pl-smi">name,</span><span class="pl-smi">description</span><span class="pl-k">and</span><span class="pl-smi">list</span><span class="pl-smi">of</span><span class="pl-smi">admins</span><span class="pl-smi">$</span><span class="pl-smi">.\policop</span><span class="pl-smi">list</span><span class="pl-smi">-r</span><span class="pl-smi">-f</span><span class="pl-smi">r:private</span><span class="pl-smi">-c</span><span class="pl-smi">r:name</span><span class="pl-smi">r:description</span><span class="pl-smi">r:admins</span></pre></div><p>The available columns can be listed by running</p><p>The naming convention indicates when the columns can be used:</p><ul><li><code>r:*</code> when repos are included</li><li><code>t:*</code> when teams are included</li><li><code>u:*</code> when users are included</li><li><code>rt:*</code> when repos and teams are included</li><li><code>ru:*</code> when repos and users are included</li><li><code>tu:*</code> when teams and users are included</li><li><code>rtu:*</code> when repos, teams, and users are included</li></ul><p>In general, <code>policop list</code> will print the results to the console but with <code>-o</code>
you can write to a file and with <code>--excel</code> you can send it straight into Excel.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>