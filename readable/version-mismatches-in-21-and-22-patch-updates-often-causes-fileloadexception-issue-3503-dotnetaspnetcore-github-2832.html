<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Version mismatches in 2.1 and 2.2 patch updates (often causes FileLoadException) &#xB7; Issue #3503 &#xB7; dotnet/aspnetcore - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Version mismatches in 2.1 and 2.2 patch updates (often causes FileLoadException) &#xB7; Issue #3503 &#xB7; dotnet/aspnetcore - linksfor.dev(s)"/>
    <meta property="article:author" content="natemcmaster"/>
    <meta property="og:description" content="Some ASP.NET Core 2.1 users have been affected by a bug in the .NET Core host (see https://github.com/dotnet/core-setup/issues/4512) which can cause apps to fail with System.IO.FileLoadException. T..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/aspnet/AspNetCore/issues/3503"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Version mismatches in 2.1 and 2.2 patch updates (often causes FileLoadException) &#xB7; Issue #3503 &#xB7; dotnet/aspnetcore</title>
<div class="readable">
        <h1>Version mismatches in 2.1 and 2.2 patch updates (often causes FileLoadException) &#xB7; Issue #3503 &#xB7; dotnet/aspnetcore</h1>
            <div>by natemcmaster</div>
            <div>Reading time: 3-4 minutes</div>
        <div>Posted here: 27 Feb 2019</div>
        <p><a href="https://github.com/aspnet/AspNetCore/issues/3503">https://github.com/aspnet/AspNetCore/issues/3503</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-commit-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode">
    <main id="js-repo-pjax-container" data-pjax-container="">
      
  




  









  

  

  


<div>
  <div>

    
    
  <div data-pjax="">
    
      



  <div id="show_issue" data-channel="issue:357411824:timeline">

    
  



      <div>
      <div>
        <p><span>Assignees</span></p><p><a data-hovercard-type="user" data-hovercard-url="/users/natemcmaster/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/natemcmaster">
              <img src="https://avatars0.githubusercontent.com/u/2696087?s=40&amp;v=4" width="20" height="20" alt="@natemcmaster">
</a>        </p>
      </div>

      


      
  </div>


    <h2>Comments</h2>
    <div id="discussion_bucket">
      <div>

  <div>
              <div data-quote-markdown=".js-comment-body" data-issue-and-pr-hovercards-enabled="" data-team-hovercards-enabled="">

            <div data-channel="marked-as-read:issue:357411824">

              



              

  


  
  
<div data-gid="MDEyOkxhYmVsZWRFdmVudDE4Mjg5ODcxMjE=">
  
        


  


  


  <div data-team-hovercards-enabled="" id="event-1836693898">
  
  <div>

    

        <p><a data-hovercard-type="user" data-hovercard-url="/users/Eilon/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/Eilon"><img height="20" width="20" alt="@Eilon" src="https://avatars3.githubusercontent.com/u/202643?s=60&amp;v=4"></a>
  <a data-hovercard-type="user" data-hovercard-url="/users/Eilon/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/Eilon">Eilon</a>
  


      
changed the title
<del>Known issue: version mismatches in 2.1 patch updates (often causes FileLoadException)</del>

<ins>2.1.5 Known issue: version mismatches in 2.1 patch updates (often causes FileLoadException)</ins></p><a href="#event-1836693898"><relative-time datetime="2018-09-10T18:11:00Z" title="Sep 10, 2018, 11:11 AM PDT">on Sep 10, 2018</relative-time></a>

  </div>
</div>


  



</div>

  
  



  
  



  
  



  
  


  
  



  
  
<div data-gid="MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTg3MzUwMTczMA==">
  
        <div data-team-hovercards-enabled="" id="event-1873501730">
  
  <div>

    

        <p><a data-hovercard-type="user" data-hovercard-url="/users/natemcmaster/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/natemcmaster"><img height="20" width="20" alt="@natemcmaster" src="https://avatars3.githubusercontent.com/u/2696087?s=60&amp;v=4"></a>
  <a data-hovercard-type="user" data-hovercard-url="/users/natemcmaster/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/natemcmaster">natemcmaster</a>
  


      
changed the title
<del>2.1.5 Known issue: version mismatches in 2.1 patch updates (often causes FileLoadException)</del>

<ins>Version mismatches in 2.1 patch updates (often causes FileLoadException)</ins></p><a href="#event-1873501730"><relative-time datetime="2018-09-28T13:19:57Z" title="Sep 28, 2018, 6:19 AM PDT">on Sep 28, 2018</relative-time></a>

  </div>
</div>


  




</div>

  
  



  
  


  
  



  
  


  
  



  
  
<div data-gid="MDE3OkRlbWlsZXN0b25lZEV2ZW50MjA2OTEwOTkzOA==">
  
        


  


  <div>
  

  <div>
      <div><p>
  This was referenced </p><relative-time datetime="2019-01-11T17:24:03Z" title="Jan 11, 2019, 9:24 AM PST">on Jan 11, 2019</relative-time>
</div>





      





  </div>
</div>



</div>

  
  



  
  



  
  
<div data-gid="MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjA2OTIwODc3NA==">
  
        <div data-team-hovercards-enabled="" id="event-2069208774">
  
  <div>

    

        <p><a data-hovercard-type="user" data-hovercard-url="/users/natemcmaster/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/natemcmaster"><img height="20" width="20" alt="@natemcmaster" src="https://avatars3.githubusercontent.com/u/2696087?s=60&amp;v=4"></a>
  <a data-hovercard-type="user" data-hovercard-url="/users/natemcmaster/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/natemcmaster">natemcmaster</a>
  


      
changed the title
<del>Version mismatches in 2.1 patch updates (often causes FileLoadException)</del>

<ins>Version mismatches in 2.1 and 2.2 patch updates (often causes FileLoadException)</ins></p><a href="#event-2069208774"><relative-time datetime="2019-01-11T18:11:48Z" title="Jan 11, 2019, 10:11 AM PST">on Jan 11, 2019</relative-time></a>

  </div>
</div>


  <div>
  <div id="ref-commit-534919a">
    
  <p><a data-hovercard-type="user" data-hovercard-url="/users/natemcmaster/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/natemcmaster">natemcmaster</a> 

      pushed a commit
        to natemcmaster/AspNetCore
      that referenced
      this issue

    </p><a href="#ref-commit-534919a">
      <relative-time datetime="2019-01-11T20:05:56Z" title="Jan 11, 2019, 12:05 PM PST">on Jan 11, 2019</relative-time>
    </a>
    <div>
      

<div data-channel="repo:142222727:commit:534919ae0ee7b3667ad11182a1b4a20fea65efc2" data-url="/natemcmaster/AspNetCore/commit/534919ae0ee7b3667ad11182a1b4a20fea65efc2/_render_node/commit/condensed">
  <div>
      
<div>
  <p><img src="https://camo.githubusercontent.com/879c6316c1f57bd0362929b6490fdadd5fa5dfc0/68747470733a2f2f312e67726176617461722e636f6d2f6176617461722f39336362383838383731656162343132353864303638363564613530336537373f643d68747470732533412532462532466769746875622e6769746875626173736574732e636f6d253246696d6167657325324667726176617461727325324667726176617461722d757365722d3432302e706e6726723d6726733d3430" width="20" height="20" alt="Nate McMaster">
  </p>
</div>


    

    

    

    
  </div>
    <div>
      <pre>â€¦2.1.0

The 2.0 version of the Microsoft.Extensions.DependencyModel does not
support the assembly/file version metadata. We must have at least 2.1.

Between 2.1.6 and 2.1.7, we switched the build to use MSBuild.exe
("full" MSBuild) instead of `dotnet msbuild` ("core" MSBuild). MSBuild
has different assembly loaders behaviors in core vs full. By switching
MSBuild types, we were also unintentionally switching the version of
Microsoft.Extensions.DependencyModel.dll that was being used by our build
 task from 2.1 back down to 2.0.

The reason we didn't discover this in earlier 2.1.x patches is that
building on msbuild core automatically upgraded our build tasks to
Microsoft.Extensions.DependencyModel.dll, Version=2.1.0.0. This happens
because of differences in the way .NET Core and MSBuild handles
assemblies with the same ID and different versions, and differences in
the layout of MSBuild and the .NET Core CLI.

In the end, this happened because we didn't have test coverage. MSBuild
and custom tasks burned asagain, but we should have just had unit tests
all along, which would have uncovered this regression as soon as we
switched to msbuild.exe.</pre>
    </div>
</div>


    </div>
  </div>
</div>



</div>



    
  


    
  



    
  


    
  



    
  



    
  



    
  



    
  


    
  



    
  


    
  



    
  



    
  





<!-- Rendered timeline since 2019-12-03 12:01:11 -->



            </div>


            
          </div>

</div>

    
</div>


    </div>
  </div>

  </div>


  </div>
</div>

    </main>
  </div>
  

  </div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>