<!DOCTYPE html>
<html lang="en">
<head>
    <title>
ASP.NET Blog | Blazor WebAssembly 3.2.0 Preview 1 release now available -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>ASP.NET Blog | Blazor WebAssembly 3.2.0 Preview 1 release now available</h1>
    <div class="row" id="mainContent"> <p class="col-md" id="primary"> <main class="site-main" id="main"> <article class="addtoanyshare" id="post-23132"> <div class="row justify-content-center postcontent" id="featured"> <div class="entry-content col-12 sharepostcontent"> <div class="row justify-content-center"><div class="col-md-4"><div><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/02/DaniethRothPhoto-150x150.jpeg" width="58" alt="Daniel Roth" class="avatar avatar-58 wp-user-avatar wp-user-avatar-58 alignnone photo"><p>Daniel</p></div></div></div> <p>Today we released a new preview update for Blazor WebAssembly with a bunch of great new features and improvements.</p>
<p>Here&#x2019;s what&#x2019;s new in this release:</p>
<ul>
<li>Version updated to 3.2</li>
<li>Simplified startup</li>
<li>Download size improvements</li>
<li>Support for .NET SignalR client</li>
</ul>
<h2>Get started</h2>
<p>To get started with Blazor WebAssembly 3.2.0 Preview 1 <a href="https://dotnet.microsoft.com/download/dotnet-core/3.1">install the .NET Core 3.1 SDK</a> and then run the following command:</p>
<pre><code>dotnet new -i Microsoft.AspNetCore.Blazor.Templates::3.2.0-preview1.20073.1
</code></pre>
<p>That&#x2019;s it! You can find additional docs and samples on <a href="https://blazor.net">https://blazor.net</a>.</p>
<h2>Upgrade an existing project</h2>
<p>To upgrade an existing Blazor WebAssembly app from 3.1.0 Preview 4 to 3.2.0 Preview 1:</p>
<ul>
<li>Update all Microsoft.AspNetCore.Blazor.* package references to 3.2.0-preview1.20073.1.</li>
<li>In <em>Program.cs</em> in the Blazor WebAssembly client project replace <code>BlazorWebAssemblyHost.CreateDefaultBuilder()</code> with <code>WebAssemblyHostBuilder.CreateDefault()</code>.</li>
<li>Move the root component registrations in the Blazor WebAssembly client project from <code>Startup.Configure</code> to <em>Program.cs</em> by calling <code>builder.RootComponents.Add&lt;TComponent&gt;(string selector)</code>.</li>
<li>Move the configured services in the Blazor WebAssembly client project from <code>Startup.ConfigureServices</code> to <em>Program.cs</em> by adding services to the <code>builder.Services</code> collection.</li>
<li>Remove <em>Startup.cs</em> from the Blazor WebAssembly client project.</li>
</ul>
<h2>Version updated to 3.2</h2>
<p>In this release we updated the versions of the Blazor WebAssembly packages to 3.2 to distinguish them from the recent .NET Core 3.1 Long Term Support (LTS) release. There is no corresponding .NET Core 3.2 release &#x2013; the new 3.2 version applies only to Blazor WebAssembly. Blazor WebAssembly is currently based on .NET Core 3.1, but it doesn&#x2019;t inherit the .NET Core 3.1 LTS status. Instead, the initial release of Blazor WebAssembly scheduled for May of this year will be a <em>Current</em> release, which &#x201C;are supported for three months after a subsequent Current or LTS release&#x201D; as described in the <a href="https://dotnet.microsoft.com/platform/support/policy/dotnet-core">.NET Core support policy</a>. The next planned release for Blazor WebAssembly after the 3.2 release in May will be with <a href="https://devblogs.microsoft.com/dotnet/introducing-net-5/">.NET 5</a>. This means that once .NET 5 ships you&#x2019;ll need to update your Blazor WebAssembly apps to .NET 5 to stay in support.</p>
<h2>Simplified startup</h2>
<p>We&#x2019;ve simplified the startup and hosting APIs for Blazor WebAssembly in this release. Originally the startup and hosting APIs for Blazor WebAssembly were designed to mirror the patterns used by ASP.NET Core, but not all of the concepts were relevant. The updated APIs also enable some new scenarios.</p>
<p>Here&#x2019;s what the new startup code in <em>Program.cs</em> looks like:</p>
<pre><code class="csharp">public class Program
{
    public static async Task Main(string[] args)
    {
        var builder = WebAssemblyHostBuilder.CreateDefault(args);
        builder.RootComponents.Add&lt;App&gt;(&quot;app&quot;);

        await builder.Build().RunAsync();
    }
}
</code></pre>
<p>Blazor WebAssembly apps now support async <code>Main</code> methods for the app entry point.</p>
<p>To a create a default host builder, call <code>WebAssemblyHostBuilder.CreateDefault()</code>. Root components and services are configured using the builder; a separate <code>Startup</code> class is no longer needed.</p>
<p>The following example adds a <code>WeatherService</code> so it&#x2019;s available through dependency injection (DI):</p>
<pre><code class="csharp">public class Program
{
    public static async Task Main(string[] args)
    {
        var builder = WebAssemblyHostBuilder.CreateDefault(args);
        builder.Services.AddSingleton&lt;WeatherService&gt;();
        builder.RootComponents.Add&lt;App&gt;(&quot;app&quot;);

        await builder.Build().RunAsync();
    }
}
</code></pre>
<p>Once the host is built, you can access services from the root DI scope before any components have been rendered. This can be useful if you need to run some initialization logic before anything is rendered:</p>
<pre><code class="csharp">public class Program
{
    public static async Task Main(string[] args)
    {
        var builder = WebAssemblyHostBuilder.CreateDefault(args);
        builder.Services.AddSingleton&lt;WeatherService&gt;();
        builder.RootComponents.Add&lt;App&gt;(&quot;app&quot;);

        var host = builder.Build();

        var weatherService = host.Services.GetRequiredService&lt;WeatherService&gt;();
        await weatherService.InitializeWeatherAsync();

        await host.RunAsync();
    }
}
</code></pre>
<p>The host also now provides a central configuration instance for the app. The configuration isn&#x2019;t populated with any data by default, but you can populate it as required in your app.</p>
<pre><code class="csharp">public class Program
{
    public static async Task Main(string[] args)
    {
        var builder = WebAssemblyHostBuilder.CreateDefault(args);
        builder.Services.AddSingleton&lt;WeatherService&gt;();
        builder.RootComponents.Add&lt;App&gt;(&quot;app&quot;);

        var host = builder.Build();

        var weatherService = host.Services.GetRequiredService&lt;WeatherService&gt;(host.Configuration[&quot;WeatherServiceUrl&quot;]);
        await weatherService.InitializeWeatherAsync();

        await host.RunAsync();
    }
}
</code></pre>
<h2>Download size improvements</h2>
<p>Blazor WebAssembly apps run the .NET IL linker on every build to trim unused code from the app. In previous releases only the core framework libraries were trimmed. Starting with this release the Blazor framework assemblies are trimmed as well resulting in a modest size reduction of about 100 KB transferred. As before, if you ever need to turn off linking, add the <code>&lt;BlazorLinkOnBuild&gt;false&lt;/BlazorLinkOnBuild&gt;</code> property to your project file.</p>
<h2>Support for the .NET SignalR client</h2>
<p>You can now use SignalR from your Blazor WebAssembly apps using the .NET SignalR client.</p>
<p>To give SignalR a try from your Blazor WebAssembly app:</p>
<ol>
<li>
<p>Create an ASP.NET Core hosted Blazor WebAssembly app.</p>
<pre><code>dotnet new blazorwasm -ho -o BlazorSignalRApp
</code></pre>
</li>
<li>
<p>Add the ASP.NET Core SignalR Client package to the <em>Client</em> project.</p>
<pre><code>cd BlazorSignalRApp
dotnet add Client package Microsoft.AspNetCore.SignalR.Client
</code></pre>
</li>
<li>
<p>In the <em>Server</em> project, add the following <em>Hub/ChatHub.cs</em> class.</p>
<pre><code class="csharp">using System.Threading.Tasks;
using Microsoft.AspNetCore.SignalR;

namespace BlazorSignalRApp.Server.Hubs
{
    public class ChatHub : Hub
    {
        public async Task SendMessage(string user, string message)
        {
            await Clients.All.SendAsync(&quot;ReceiveMessage&quot;, user, message);
        }
    }
}
</code></pre>
</li>
<li>
<p>In the <em>Server</em> project, add the SignalR services in the <code>Startup.ConfigureServices</code> method.</p>
<pre><code class="csharp">services.AddSignalR();
</code></pre>
</li>
<li>
<p>Also add an endpoint for the <code>ChatHub</code> in <code>Startup.Configure</code>.</p>
<pre><code class="csharp">.UseEndpoints(endpoints =&gt;
{
    endpoints.MapDefaultControllerRoute();
    endpoints.MapHub&lt;ChatHub&gt;(&quot;/chatHub&quot;);
    endpoints.MapFallbackToClientSideBlazor&lt;Client.Program&gt;(&quot;index.html&quot;);
});
</code></pre>
</li>
<li>
<p>Update <em>Pages/Index.razor</em> in the <em>Client</em> project with the following markup.</p>
<pre><code class="razor">@using Microsoft.AspNetCore.SignalR.Client
@page &quot;/&quot;
@inject NavigationManager NavigationManager

&lt;div&gt;
    &lt;label for=&quot;userInput&quot;&gt;User:&lt;/label&gt;
    &lt;input id=&quot;userInput&quot; @bind=&quot;userInput&quot; /&gt;
&lt;/div&gt;
&lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;messageInput&quot;&gt;Message:&lt;/label&gt;
    &lt;input id=&quot;messageInput&quot; @bind=&quot;messageInput&quot; /&gt;
&lt;/div&gt;
&lt;button @onclick=&quot;Send&quot; disabled=&quot;@(!IsConnected)&quot;&gt;Send Message&lt;/button&gt;

&lt;hr /&gt;

&lt;ul id=&quot;messagesList&quot;&gt;
    @foreach (var message in messages)
    {
        &lt;li&gt;@message&lt;/li&gt;
    }
&lt;/ul&gt;

@code {
    HubConnection hubConnection;
    List&lt;string&gt; messages = new List&lt;string&gt;();
    string userInput;
    string messageInput;

    protected override async Task OnInitializedAsync()
    {
        hubConnection = new HubConnectionBuilder()
            .WithUrl(NavigationManager.ToAbsoluteUri(&quot;/chatHub&quot;))
            .Build();

        hubConnection.On&lt;string, string&gt;(&quot;ReceiveMessage&quot;, (user, message) =&gt;
        {
            var encodedMsg = user + &quot; says &quot; + message;
            messages.Add(encodedMsg);
            StateHasChanged();
        });

        await hubConnection.StartAsync();
    }

    Task Send() =&gt; hubConnection.SendAsync(&quot;SendMessage&quot;, userInput, messageInput);

    public bool IsConnected =&gt; hubConnection.State == HubConnectionState.Connected;
}
</code></pre>
</li>
<li>
<p>Build and run the <em>Server</em> project</p>
<pre><code>cd Server
dotnet run
</code></pre>
</li>
<li>
<p>Open the app in two separate browser tabs to chat in real time over SignalR.</p>
</li>
</ol>
<h2>Known issues</h2>
<p>Below is the list of known issues with this release that will get addressed in a future update.</p>
<ul>
<li>
<p>Running a new ASP.NET Core hosted Blazor WebAssembly app from the command-line results in the warning: <code>CSC : warning CS8034: Unable to load Analyzer assembly C:\Users\user\.nuget\packages\microsoft.aspnetcore.components.analyzers\3.1.0\analyzers\dotnet\cs\Microsoft.AspNetCore.Components.Analyzers.dll : Assembly with same name is already loaded.</code></p>
<ul>
<li>Workaround: This warning can be ignored or suppressed using the <code>&lt;DisableImplicitComponentsAnalyzers&gt;true&lt;/DisableImplicitComponentsAnalyzers&gt;</code> MSBuild property.</li>
</ul>
</li>
</ul>
<h2>Feedback</h2>
<p>We hope you enjoy the new features in this preview release of Blazor WebAssembly! Please let us know what you think by filing issues on <a href="https://github.com/dotnet/aspnetcore/issues">GitHub</a>.</p>
<p>Thanks for trying out Blazor!</p> </div> </div> <footer class="cattagsarea"> <span class="cat-links">Posted in <a href="https://devblogs.microsoft.com/aspnet/category/aspnetcore/">AspNetCore</a>, <a href="https://devblogs.microsoft.com/aspnet/category/blazor/">Blazor</a></span> </footer> </article> </main> </p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>