<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Introduction to Authentication with Blazor -
linksfor.dev(s)
    </title>
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <style type="text/css">
        html {
            font-family: sans-serif;
            line-height: 1.15;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            height: 100%;
        }

        *, ::after, ::before {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #60656a;
            text-align: left;
            background-color: #323b44;
        }

        h1 {
            font-size: 6rem;
            font-weight: 300;
            line-height: 1.2;
            margin-top: 0;
            margin-bottom: 0.5rem;
            margin-bottom: 0.5rem
        }

        a {
            color: #007bff;
            color: #ccc;
            text-decoration: none;
            background-color: transparent;
            word-break: break-all;
        }

        .unseen a {
            font-weight: bold;
        }

        h3 {
            margin-top: 0;
            padding-top: 0;
            font-weight: normal;
        }

        .grid {
            -ms-flex-direction: column;
            flex-direction: column;
            width: 1024px;
            margin: 0 auto;
            flex: 1 0 auto;
        }

        .row {
            -ms-flex-direction: row;
            flex-direction: row;
            width: 100%;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            display: -ms-flexbox;
            display: flex;
        }

        .col {
            margin: 0 10px 0 10px;
            box-sizing: border-box;
            vertical-align: top;
        }

        .col-3-of-4, .col-6-of-8, .col-9-of-12 {
            width: calc(75% - 20px);
        }

        .col-1-of-4, .col-2-of-8, .col-3-of-12 {
            width: calc(25% - 20px);
        }

        @media (max-width:1023px) {
            /* big landscape tablets, laptops, and desktops */
            body {
                overflow-x: hidden;
            }

            main {
                width: 99%;
            }

            h1 {
                font-size: 50px;
            }
        }

        .text-right {
            text-align: right;
        }

        footer {
            left: 0;
            width: 100%;
            margin-top: 2em;
            padding: 50px 0;
            text-align: center;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        .readable {
            color: #949ba2;
        }

        svg:not(:root).svg-inline--fa {
            color: #60656a;
            overflow: visible;
        }

        .svg-inline--fa.fa-w-12 {
            width: 0.75em;
        }

        svg:not(:root) {
            overflow: hidden;
        }

        .svg-inline--fa {
            display: inline-block;
            font-size: inherit;
            height: 1em;
            overflow: visible;
            vertical-align: -0.125em;
        }

        img {
            max-width: 100%;
        }

        .text-center {
            text-align: center;
        }

        .readable h1 {
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Introduction to Authentication with Blazor</h1>
    <div class="post-content"> <p>This is the first post in the series: Securing Your Blazor Apps. </p><p>Part 1 - Introduction to Authentication with Blazor (this post)</p><p>Authentication and authorisation are two fundamental functions in most applications today. Until recently, it wasn&apos;t very clear how to best achieve these functions in Blazor applications. But with the release of <a href="https://devblogs.microsoft.com/aspnet/asp-net-core-and-blazor-updates-in-net-core-3-0-preview-6/">ASP.NET Core 3 Preview 6</a> that all changed.</p><p>In this post, I&apos;ll show you how you can create a new server-side Blazor application with authentication enabled. Then we&apos;ll take a high level look at the services and components which are used in the application.</p><p>Let&apos;s start with the difference between authentication and authorisation as this can sometimes be a bit confusing for new developers.</p><blockquote>Authentication is the process of determining if someone is who they claim to be. </blockquote><p>This can be done in many different ways, but the most common for web applications is a username and password check. Another example of authentication is using your pin code with your debit card at a ATM. </p><p>Whatever the mechanism, authentication verifies you are who you say you are. But what it doesn&apos;t do is define what you have <em>access</em> to, that is where authorisation comes in.</p><blockquote>Authorisation is the process of checking if someone has the rights to access a resource.</blockquote><p>Authorisation occurs after an identity has been established via authentication and determins what parts of a system you can access. For example, if you&apos;re have administrator rights on a system you can access everything. But if you&apos;re a standard user, you may only be able to access specific screens.</p><h2 id="creating-a-blazor-application-with-authentication">Creating a Blazor application with Authentication</h2><p>We&apos;ll get stuck in straight away by creating a new Blazor server-side application with authentication enabled.</p><p>Follow the normal steps for creating a server-side Blazor application.</p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/create-new-project-step-1.jpg" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/create-new-project-step-2.jpg" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/create-new-project-step-3.jpg" class="kg-image"></figure><p>When you hit the project type screen, select Blazor Server App then select the <em>Change</em> link under Authentication.</p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/create-new-project-step-4.jpg" class="kg-image"></figure><p>From the popup window select <em>Individual User Accounts </em>and then<em> OK.</em></p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/create-new-project-step-5.jpg" class="kg-image"></figure><p>Make sure that Authentication is set to <em>Individual User Accounts</em> then click <em>Create</em>.</p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/create-new-project-step-6.jpg" class="kg-image"></figure><p>Once the app has been generated press F5 to run it and you should see the following.</p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/running-app.JPG" class="kg-image"></figure><p>Click the <em>Register</em> link in the top right and fill in your details. Then click <em>Register</em>.</p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/register.jpg" class="kg-image"></figure><p>You should then be presented with the following screen prompting you to run migrations. This will setup the database which holds the account details. Click the <em>Apply Migrations</em> button, then refresh the page when prompted.</p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/apply-migrations.jpg" class="kg-image"></figure><p>You should then be redirected back to the home page as an authenticated user. You should see the <em>Register</em> link has been replaced with your email address and a <em>Log out</em> button. </p><figure class="kg-card kg-image-card"><img src="https://chrissainty.com/content/images/2019/07/loggedinjpg.jpg" class="kg-image"></figure><p>We now have a working Blazor app with authentication, so how is all this achieved? Let&apos;s take a look at the various features which enable all this to happen. </p><h2 id="asp-net-core-identity">ASP.NET Core Identity</h2><p>Blazors authentication system is built to work with different configurations including ASP.NET Core Identity. The registration process and login screens aren&apos;t Blazor components but razor pages. You won&apos;t find them in the project structure either, they are provided by the following call in the <code>Startup.cs</code>.</p><pre><code class="language-csharp">services.AddDefaultIdentity&lt;IdentityUser&gt;()
</code></pre>
<p>This adds the default identity UI to the application along with the necessary configuration and services. Don&apos;t worry, you can override these pages and customise/create your own and we&apos;ll cover that in a future post.</p><h2 id="authenticationstateprovider-service">AuthenticationStateProvider Service</h2><p>This service provides the authentication state for the current user and is used by the <code>CascadingAuthenticationState</code> component. The service provides a consistant way of serving this information regardless of whether it is being used in a client-side or server-side Blazor application.</p><p>When used within a server-side application the current user information is hydrated using the <code>HttpContext</code> which established the connection to the server. </p><p>Where as in a client-side application we would have to configure a custom provider which may populate the user information from a API endpoint. We&apos;ll cover this in a future post.</p><h2 id="cascadingauthenticationstate-component">CascadingAuthenticationState Component</h2><p>Inside the <code>app.razor</code> you will find the following code.</p><pre><code class="language-html">&lt;CascadingAuthenticationState&gt;
    &lt;Router AppAssembly=&quot;typeof(Startup).Assembly&quot;&gt;
        &lt;NotFoundContent&gt;
            &lt;p&gt;Sorry, there&apos;s nothing at this address.&lt;/p&gt;
        &lt;/NotFoundContent&gt;
    &lt;/Router&gt;
&lt;/CascadingAuthenticationState&gt;
</code></pre>
<p>The part we are interested in is the <code>CascadingAuthenticationState</code> component. It&apos;s responsible for providing the current authentication state to it&apos;s decendent components. </p><p>Currently this value is used by the <code>Router</code> and <code>AuthorizeView</code> components to control access to various parts of the UI.</p><p>Inside <code>LoginDisplay.razor</code> we can find an example of the <code>AuthorizeView</code> component.</p><pre><code class="language-html">&lt;AuthorizeView&gt;
    &lt;Authorized&gt;
        &lt;a href=&quot;Identity/Account/Manage&quot;&gt;Hello, @context.User.Identity.Name!&lt;/a&gt;
        &lt;a href=&quot;Identity/Account/LogOut&quot;&gt;Log out&lt;/a&gt;
    &lt;/Authorized&gt;
    &lt;NotAuthorized&gt;
        &lt;a href=&quot;Identity/Account/Register&quot;&gt;Register&lt;/a&gt;
        &lt;a href=&quot;Identity/Account/Login&quot;&gt;Log in&lt;/a&gt;
    &lt;/NotAuthorized&gt;
&lt;/AuthorizeView&gt;
</code></pre>
<p>This component allows us to control what parts of the UI are displayed depending on what the user is <em>authorised</em> to view. By default, if no other policy is applied, then <em>non-authenticated</em> users are treated as <em>not authorised</em>. Logged in users are treated as <em>authorised</em>.</p><p>It also exposes a <code>context</code> parameter which can be used to view the currently logged in users information. As well as the following 3 templates, two of which you can see used in the code snippet above.</p><ul><li><strong>NotAuthorized</strong> - Any content placed in this template will only be shown to non-authorised users.</li><li><strong>Authorizing</strong> - Any content placed in this template will be shown during asyncronous authorisation.</li><li><strong>Authorized</strong> - Any content placed in this template will only be shown to authorised users.</li></ul><p>In this post, I showed you how to create a new server-side Blazor application with authentication. I then talked through some of the services and components used in the application to enable authentication.</p><p>In the next post, I&apos;ll dive a bit deeper into some the these features I covered and look at how to configure authorisation in the app. &#xA0;</p> <div class="post-tags"> Tagged in: <a href="/blazor/">Blazor</a> | <a href="/authentication/">Authentication</a> </div> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
</body>
</html>