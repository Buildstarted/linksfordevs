<!DOCTYPE html>
<html lang="en">
<head>
    <title>
New IL instruction or new IL pattern to represent an invocation of a method implementation found in specific base type &#xB7; Issue #12886 &#xB7; dotnet/runtime &#xB7; GitHub -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>New IL instruction or new IL pattern to represent an invocation of a method implementation found in specific base type  · Issue #12886 · dotnet/runtime · GitHub</h1><div><div id="" class="d-block comment-body markdown-body  js-comment-body"><p>These are my thoughts on the additional runtime support needed for the <code>base(T)</code> feature request.</p><p>We should be able to support this with a variation on the constrained prefix. This is my idea of what the spec would generally look like.</p><pre><code>.constrained &lt;type&gt; call &lt;method&gt;
Stack Transition:
..., this reference, arg1, arg2, arg3, argN -&gt; ..., retVal (not always returned)
</code></pre><p>Description:<br>The <code>.constrained &lt;type&gt; call &lt;method&gt;</code> instruction calls implementation of the method indicated by the descriptor method on the type <code>&lt;type&gt;</code>. This sequence may be preceded by the <code>.tail</code> prefix to specify that the current method state should be released before transferring control. If <code>&lt;type&gt;</code> is an interface, the target method is chosen using the default interface method resolution rules where <code>&lt;type&gt;</code> is the most derived interface. If <code>&lt;type&gt;</code> is not an interface type, the target method is resolved by computing the normal virtual resolution algorithm as if it was called on an object of runtime type <code>&lt;type&gt;</code>, and calling that method. If <code>&lt;method&gt;</code> is an interface method, and the resolution would be ambiguous, throw an <code>AmbiguousMatchException</code> (as with other failed Default Interface Method resolution failures). If the resolution does not find a target method body, throw an <code>System.EntryPointNotFoundException</code>.</p><p>If <code>&lt;type&gt;</code> is an interface type, <code>&lt;method&gt;</code> must be defined on an interface type.<br>If <code>&lt;type&gt;</code> is not an interface type, <code>&lt;method&gt;</code> must be defined on a class.</p><p><em>Add note about how <code>&lt;method&gt;</code> resolves that matches the details of method token resolution as specified in the call instruction</em></p><p>Correctness:<br>Correct CIL ensures that the <code>&lt;method&gt;</code> is defined on <code>&lt;type&gt;</code> or on a superclass of <code>&lt;type&gt;</code>. <code>&lt;type&gt;</code> must be a reference type. <code>&lt;method&gt;</code> must be a virtual or abstract function. <code>&lt;method&gt;</code> must be an instance function.</p><p>Verifiability:<br>Verification checks to ensure that <code>&lt;type&gt;</code> is a superclass of the type that defines the method being compiled, and that <code>&lt;method&gt;</code> is accessible to the method providing IL. and the types of the objects on the stack are consistent with the types expected by the method call. It also verifies that the first parameter is <code>this</code> pointer if the current IL method body is defined on a reference type, or a boxed instance of the current method bodie's type.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>