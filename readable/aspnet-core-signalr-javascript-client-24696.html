<!DOCTYPE html>
<html lang="en">
<head>
    <title>
ASP.NET Core SignalR JavaScript client - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="ASP.NET Core SignalR JavaScript client - linksfor.dev(s)"/>
    <meta property="article:author" content="bradygaster"/>
    <meta property="og:description" content="Overview of ASP.NET Core SignalR JavaScript client."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://docs.microsoft.com/en-us/aspnet/core/signalr/javascript-client?view=aspnetcore-3.0"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - ASP.NET Core SignalR JavaScript client</title>
<div class="readable">
        <h1>ASP.NET Core SignalR JavaScript client</h1>
            <div>by bradygaster</div>
            <div>Reading time: 15-18 minutes</div>
        <div>Posted here: 22 May 2019</div>
        <p><a href="https://docs.microsoft.com/en-us/aspnet/core/signalr/javascript-client?view=aspnetcore-3.0">https://docs.microsoft.com/en-us/aspnet/core/signalr/javascript-client?view=aspnetcore-3.0</a></p>
        <hr/>
<div id="readability-page-1" class="page">


	<div data-bi-name="body">

		<div>

			

			<section>
				<div>


				<div id="main-column">

					<main id="main" role="main" data-bi-name="content" lang="en-us" dir="ltr">



						

						<ul data-bi-name="page info" lang="en-us" dir="ltr">
							<li>
								<time role="presentation" datetime="2019-11-12T00:00:00.000Z" data-article-date-source="ms.date">11/12/2019</time>
							</li>
								<li>8 minutes to read</li>
							<li>
								<a href="https://github.com/aspnet/AspNetCore.Docs/blob/master/aspnetcore/signalr/javascript-client.md" title="15 Contributors" aria-label="15 Contributors">
									
								</a>
							</li>

						</ul>

						<nav id="center-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
							<h3>In this article</h3>
						<ol><li><a href="#install-the-signalr-client-package">Install the SignalR client package</a></li><li><a href="#use-the-signalr-javascript-client">Use the SignalR JavaScript client</a></li><li><a href="#connect-to-a-hub">Connect to a hub</a></li><li><a href="#call-hub-methods-from-client">Call hub methods from client</a></li><li><a href="#call-client-methods-from-hub">Call client methods from hub</a></li><li><a href="#error-handling-and-logging">Error handling and logging</a></li><li><a href="#reconnect-clients">Reconnect clients</a></li><li><a href="#additional-resources">Additional resources</a></li></ol></nav>


						<!-- <content> -->
							
<p>By <a href="https://twitter.com/rachelappel" data-linktype="external">Rachel Appel</a></p>
<p>The ASP.NET Core SignalR JavaScript client library enables developers to call server-side hub code.</p>
<p><a href="https://github.com/aspnet/AspNetCore.Docs/tree/live/aspnetcore/signalr/javascript-client/sample" data-linktype="external">View or download sample code</a> (<a href="https://docs.microsoft.com/en-us/aspnet/core/?view=aspnetcore-3.0#how-to-download-a-sample" data-linktype="relative-path">how to download</a>)</p>
<h2 id="install-the-signalr-client-package">Install the SignalR client package<a href="#install-the-signalr-client-package" aria-labelledby="install-the-signalr-client-package"></a></h2>
<p>The SignalR JavaScript client library is delivered as an <a href="https://www.npmjs.com/" data-linktype="external">npm</a> package. If you're using Visual Studio, run <code>npm install</code> from the <strong>Package Manager Console</strong> while in the root folder. For Visual Studio Code, run the command from the <strong>Integrated Terminal</strong>.</p>
<div data-moniker="aspnetcore-3.0 aspnetcore-3.1">
<pre tabindex="0"><code data-author-content="npm init -y
npm install @microsoft/signalr
">npm init -y
npm install @microsoft/signalr
</code></pre>
<p>npm installs the package contents in the <em>node_modules\@microsoft\signalr\dist\browser</em> folder. Create a new folder named <em>signalr</em> under the <em>wwwroot\lib</em> folder. Copy the <em>signalr.js</em> file to the <em>wwwroot\lib\signalr</em> folder.</p>
</div>
<div data-moniker="aspnetcore-2.1 aspnetcore-2.2">
<pre tabindex="0"><code data-author-content="npm init -y
npm install @aspnet/signalr
">npm init -y
npm install @aspnet/signalr
</code></pre>
<p>npm installs the package contents in the <em>node_modules\@aspnet\signalr\dist\browser</em> folder. Create a new folder named <em>signalr</em> under the <em>wwwroot\lib</em> folder. Copy the <em>signalr.js</em> file to the <em>wwwroot\lib\signalr</em> folder.</p>
</div>
<h2 id="use-the-signalr-javascript-client">Use the SignalR JavaScript client<a href="#use-the-signalr-javascript-client" aria-labelledby="use-the-signalr-javascript-client"></a></h2>
<p>Reference the SignalR JavaScript client in the <code>&lt;script&gt;</code> element.</p>
<pre tabindex="0"><code data-author-content="<script src=&quot;~/lib/signalr/signalr.js&quot;></script>
">&lt;script src="~/lib/signalr/signalr.js"&gt;&lt;/script&gt;
</code></pre>
<h2 id="connect-to-a-hub">Connect to a hub<a href="#connect-to-a-hub" aria-labelledby="connect-to-a-hub"></a></h2>
<p>The following code creates and starts a connection. The hub's name is case insensitive.</p>
<pre tabindex="0"><code name="Call hub methods" data-author-content="const connection = new signalR.HubConnectionBuilder()
    .withUrl(&quot;/chatHub&quot;)
    .configureLogging(signalR.LogLevel.Information)
    .build();

connection.start().then(function () {
    console.log(&quot;connected&quot;);
});
">const connection = new signalR.HubConnectionBuilder()
    .withUrl("/chatHub")
    .configureLogging(signalR.LogLevel.Information)
    .build();

connection.start().then(function () {
    console.log("connected");
});
</code></pre><h3 id="cross-origin-connections">Cross-origin connections<a href="#cross-origin-connections" aria-labelledby="cross-origin-connections"></a></h3>
<p>Typically, browsers load connections from the same domain as the requested page. However, there are occasions when a connection to another domain is required.</p>
<p>To prevent a malicious site from reading sensitive data from another site, <a href="https://docs.microsoft.com/en-us/aspnet/core/security/cors?view=aspnetcore-3.0" data-linktype="relative-path">cross-origin connections</a> are disabled by default. To allow a cross-origin request, enable it in the <code>Startup</code> class.</p>
<pre tabindex="0"><code name="Cross-origin connections" highlight-lines="29-35,56" data-author-content="using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using SignalRChat.Hubs;

namespace SignalRChat
{
    public class Startup
    {
        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        public IConfiguration Configuration { get; }

        public void ConfigureServices(IServiceCollection services)
        {
            services.Configure<CookiePolicyOptions>(options =>
            {
                options.CheckConsentNeeded = context => true;
                options.MinimumSameSitePolicy = SameSiteMode.None;
            });

            services.AddMvc();

            services.AddCors(options => options.AddPolicy(&quot;CorsPolicy&quot;, 
            builder => 
            {
                builder.AllowAnyMethod().AllowAnyHeader()
                       .WithOrigins(&quot;http://localhost:55830&quot;)
                       .AllowCredentials();
            }));

            services.AddSignalR();
        }

        public void Configure(IApplicationBuilder app, IHostingEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseBrowserLink();
                app.UseDeveloperExceptionPage();
            }
            else
            {
                app.UseExceptionHandler(&quot;/Error&quot;);
                app.UseHsts();
            }

            app.UseHttpsRedirection();
            app.UseStaticFiles();
            app.UseCookiePolicy();
            app.UseCors(&quot;CorsPolicy&quot;);
            app.UseSignalR(routes => 
            {
                routes.MapHub<ChatHub>(&quot;/chathub&quot;);
            });
            app.UseMvc();            
        }
    }
}
">using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using SignalRChat.Hubs;

namespace SignalRChat
{
    public class Startup
    {
        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        public IConfiguration Configuration { get; }

        public void ConfigureServices(IServiceCollection services)
        {
            services.Configure&lt;CookiePolicyOptions&gt;(options =&gt;
            {
                options.CheckConsentNeeded = context =&gt; true;
                options.MinimumSameSitePolicy = SameSiteMode.None;
            });

            services.AddMvc();

            services.AddCors(options =&gt; options.AddPolicy("CorsPolicy", 
            builder =&gt; 
            {
                builder.AllowAnyMethod().AllowAnyHeader()
                       .WithOrigins("http://localhost:55830")
                       .AllowCredentials();
            }));

            services.AddSignalR();
        }

        public void Configure(IApplicationBuilder app, IHostingEnvironment env)
        {
            if (env.IsDevelopment())
            {
                app.UseBrowserLink();
                app.UseDeveloperExceptionPage();
            }
            else
            {
                app.UseExceptionHandler("/Error");
                app.UseHsts();
            }

            app.UseHttpsRedirection();
            app.UseStaticFiles();
            app.UseCookiePolicy();
            app.UseCors("CorsPolicy");
            app.UseSignalR(routes =&gt; 
            {
                routes.MapHub&lt;ChatHub&gt;("/chathub");
            });
            app.UseMvc();            
        }
    }
}
</code></pre><h2 id="call-hub-methods-from-client">Call hub methods from client<a href="#call-hub-methods-from-client" aria-labelledby="call-hub-methods-from-client"></a></h2>
<p>JavaScript clients call public methods on hubs via the <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnection#invoke" data-linktype="absolute-path">invoke</a> method of the <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnection" data-linktype="absolute-path">HubConnection</a>. The <code>invoke</code> method accepts two arguments:</p>
<ul>
<li><p>The name of the hub method. In the following example, the method name on the hub is <code>SendMessage</code>.</p>
</li>
<li><p>Any arguments defined in the hub method. In the following example, the argument name is <code>message</code>. The example code uses arrow function syntax that is supported in current versions of all major browsers except Internet Explorer.</p>
<pre tabindex="0"><code name="Call hub methods" data-author-content="connection.invoke(&quot;SendMessage&quot;, user, message).catch(err => console.error(err.toString()));
">connection.invoke("SendMessage", user, message).catch(err =&gt; console.error(err.toString()));
</code></pre></li>
</ul>
<div>
<p><span aria-hidden="true"></span> Note</p>
<p>If you're using Azure SignalR Service in <em>Serverless mode</em>, you cannot call hub methods from a client. For more information, see the <a href="https://docs.microsoft.com/en-us/azure/azure-signalr/signalr-concept-serverless-development-config" data-linktype="absolute-path">SignalR Service documentation</a>.</p>
</div>
<p>The <code>invoke</code> method returns a JavaScript <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise" data-linktype="external">Promise</a>. The <code>Promise</code> is resolved with the return value (if any) when the method on the server returns. If the method on the server throws an error, the <code>Promise</code> is rejected with the error message. Use the <code>then</code> and <code>catch</code> methods on the <code>Promise</code> itself to handle these cases (or <code>await</code> syntax).</p>
<p>The <code>send</code> method returns a JavaScript <code>Promise</code>. The <code>Promise</code> is resolved when the message has been sent to the server. If there is an error sending the message, the <code>Promise</code> is rejected with the error message. Use the <code>then</code> and <code>catch</code> methods on the <code>Promise</code> itself to handle these cases (or <code>await</code> syntax).</p>
<div>
<p><span aria-hidden="true"></span> Note</p>
<p>Using <code>send</code> doesn't wait until the server has received the message. Consequently, it's not possible to return data or errors from the server.</p>
</div>
<h2 id="call-client-methods-from-hub">Call client methods from hub<a href="#call-client-methods-from-hub" aria-labelledby="call-client-methods-from-hub"></a></h2>
<p>To receive messages from the hub, define a method using the <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnection#on" data-linktype="absolute-path">on</a> method of the <code>HubConnection</code>.</p>
<ul>
<li>The name of the JavaScript client method. In the following example, the method name is <code>ReceiveMessage</code>.</li>
<li>Arguments the hub passes to the method. In the following example, the argument value is <code>message</code>.</li>
</ul>
<pre tabindex="0"><code name="Receive calls from hub" data-author-content="connection.on(&quot;ReceiveMessage&quot;, (user, message) => {
    const encodedMsg = user + &quot; says &quot; + message;
    const li = document.createElement(&quot;li&quot;);
    li.textContent = encodedMsg;
    document.getElementById(&quot;messagesList&quot;).appendChild(li);
});
">connection.on("ReceiveMessage", (user, message) =&gt; {
    const encodedMsg = user + " says " + message;
    const li = document.createElement("li");
    li.textContent = encodedMsg;
    document.getElementById("messagesList").appendChild(li);
});
</code></pre>
<p>The preceding code in <code>connection.on</code> runs when server-side code calls it using the <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.signalr.clientproxyextensions.sendasync" data-linktype="absolute-path">SendAsync</a> method.</p>
<pre tabindex="0"><code name="Call client-side" data-author-content="public async Task SendMessage(string user, string message)
{
    await Clients.All.SendAsync(&quot;ReceiveMessage&quot;, user, message);
}
">public async Task SendMessage(string user, string message)
{
    await Clients.All.SendAsync("ReceiveMessage", user, message);
}
</code></pre>
<p>SignalR determines which client method to call by matching the method name and arguments defined in <code>SendAsync</code> and <code>connection.on</code>.</p>
<div>
<p><span aria-hidden="true"></span> Note</p>
<p>As a best practice, call the <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnection#start" data-linktype="absolute-path">start</a> method on the <code>HubConnection</code> after <code>on</code>. Doing so ensures your handlers are registered before any messages are received.</p>
</div>
<h2 id="error-handling-and-logging">Error handling and logging<a href="#error-handling-and-logging" aria-labelledby="error-handling-and-logging"></a></h2>
<p>Chain a <code>catch</code> method to the end of the <code>start</code> method to handle client-side errors. Use <code>console.error</code> to output errors to the browser's console.</p>
<pre tabindex="0"><code name="Error handling" data-author-content="connection.start().catch(function (err) {
    return console.error(err.toString());
});
">connection.start().catch(function (err) {
    return console.error(err.toString());
});
</code></pre>
<p>Setup client-side log tracing by passing a logger and type of event to log when the connection is made. Messages are logged with the specified log level and higher. Available log levels are as follows:</p>
<ul>
<li><code>signalR.LogLevel.Error</code> – Error messages. Logs <code>Error</code> messages only.</li>
<li><code>signalR.LogLevel.Warning</code> – Warning messages about potential errors. Logs <code>Warning</code>, and <code>Error</code> messages.</li>
<li><code>signalR.LogLevel.Information</code> – Status messages without errors. Logs <code>Information</code>, <code>Warning</code>, and <code>Error</code> messages.</li>
<li><code>signalR.LogLevel.Trace</code> – Trace messages. Logs everything, including data transported between hub and client.</li>
</ul>
<p>Use the <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnectionbuilder#configurelogging" data-linktype="absolute-path">configureLogging</a> method on <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnectionbuilder" data-linktype="absolute-path">HubConnectionBuilder</a> to configure the log level. Messages are logged to the browser console.</p>
<pre tabindex="0"><code name="Logging levels" data-author-content="const connection = new signalR.HubConnectionBuilder()
    .withUrl(&quot;/chatHub&quot;)
    .configureLogging(signalR.LogLevel.Information)
    .build();
">const connection = new signalR.HubConnectionBuilder()
    .withUrl("/chatHub")
    .configureLogging(signalR.LogLevel.Information)
    .build();
</code></pre><h2 id="reconnect-clients">Reconnect clients<a href="#reconnect-clients" aria-labelledby="reconnect-clients"></a></h2>
<div data-moniker="aspnetcore-3.0 aspnetcore-3.1">
<h3 id="automatically-reconnect">Automatically reconnect<a href="#automatically-reconnect" aria-labelledby="automatically-reconnect"></a></h3>
<p>The JavaScript client for SignalR can be configured to automatically reconnect using the <code>withAutomaticReconnect</code> method on <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnectionbuilder" data-linktype="absolute-path">HubConnectionBuilder</a>. It won't automatically reconnect by default.</p>
<pre tabindex="0"><code data-author-content="const connection = new signalR.HubConnectionBuilder()
    .withUrl(&quot;/chatHub&quot;)
    .withAutomaticReconnect()
    .build();
">const connection = new signalR.HubConnectionBuilder()
    .withUrl("/chatHub")
    .withAutomaticReconnect()
    .build();
</code></pre>
<p>Without any parameters, <code>withAutomaticReconnect()</code> configures the client to wait 0, 2, 10, and 30 seconds respectively before trying each reconnect attempt, stopping after four failed attempts.</p>
<p>Before starting any reconnect attempts, the <code>HubConnection</code> will transition to the <code>HubConnectionState.Reconnecting</code> state and fire its <code>onreconnecting</code> callbacks instead of transitioning to the <code>Disconnected</code> state and triggering its <code>onclose</code> callbacks like a <code>HubConnection</code> without automatic reconnect configured. This provides an opportunity to warn users that the connection has been lost and to disable UI elements.</p>
<pre tabindex="0"><code data-author-content="connection.onreconnecting((error) => {
    console.assert(connection.state === signalR.HubConnectionState.Reconnecting);

    document.getElementById(&quot;messageInput&quot;).disabled = true;

    const li = document.createElement(&quot;li&quot;);
    li.textContent = `Connection lost due to error &quot;${error}&quot;. Reconnecting.`;
    document.getElementById(&quot;messagesList&quot;).appendChild(li);
});
">connection.onreconnecting((error) =&gt; {
    console.assert(connection.state === signalR.HubConnectionState.Reconnecting);

    document.getElementById("messageInput").disabled = true;

    const li = document.createElement("li");
    li.textContent = `Connection lost due to error "${error}". Reconnecting.`;
    document.getElementById("messagesList").appendChild(li);
});
</code></pre>
<p>If the client successfully reconnects within its first four attempts, the <code>HubConnection</code> will transition back to the <code>Connected</code> state and fire its <code>onreconnected</code> callbacks. This provides an opportunity to inform users the connection has been reestablished.</p>
<p>Since the connection looks entirely new to the server, a new <code>connectionId</code> will be provided to the <code>onreconnected</code> callback.</p>
<div>
<p><span aria-hidden="true"></span> Warning</p>
<p>The <code>onreconnected</code> callback's <code>connectionId</code> parameter will be undefined if the <code>HubConnection</code> was configured to <a href="https://docs.microsoft.com/en-us/aspnet/core/signalr/configuration?view=aspnetcore-3.0#configure-client-options" data-linktype="relative-path">skip negotiation</a>.</p>
</div>
<pre tabindex="0"><code data-author-content="connection.onreconnected((connectionId) => {
    console.assert(connection.state === signalR.HubConnectionState.Connected);

    document.getElementById(&quot;messageInput&quot;).disabled = false;

    const li = document.createElement(&quot;li&quot;);
    li.textContent = `Connection reestablished. Connected with connectionId &quot;${connectionId}&quot;.`;
    document.getElementById(&quot;messagesList&quot;).appendChild(li);
});
">connection.onreconnected((connectionId) =&gt; {
    console.assert(connection.state === signalR.HubConnectionState.Connected);

    document.getElementById("messageInput").disabled = false;

    const li = document.createElement("li");
    li.textContent = `Connection reestablished. Connected with connectionId "${connectionId}".`;
    document.getElementById("messagesList").appendChild(li);
});
</code></pre>
<p><code>withAutomaticReconnect()</code> won't configure the <code>HubConnection</code> to retry initial start failures, so start failures need to be handled manually:</p>
<pre tabindex="0"><code data-author-content="async function start() {
    try {
        await connection.start();
        console.assert(connection.state === signalR.HubConnectionState.Connected);
        console.log(&quot;connected&quot;);
    } catch (err) {
        console.assert(connection.state === signalR.HubConnectionState.Disconnected);
        console.log(err);
        setTimeout(() => start(), 5000);
    }
};
">async function start() {
    try {
        await connection.start();
        console.assert(connection.state === signalR.HubConnectionState.Connected);
        console.log("connected");
    } catch (err) {
        console.assert(connection.state === signalR.HubConnectionState.Disconnected);
        console.log(err);
        setTimeout(() =&gt; start(), 5000);
    }
};
</code></pre>
<p>If the client doesn't successfully reconnect within its first four attempts, the <code>HubConnection</code> will transition to the <code>Disconnected</code> state and fire its <a href="https://docs.microsoft.com/en-us/javascript/api/%40aspnet/signalr/hubconnection#onclose" data-linktype="absolute-path">onclose</a> callbacks. This provides an opportunity to inform users the connection has been permanently lost and recommend refreshing the page:</p>
<pre tabindex="0"><code data-author-content="connection.onclose((error) => {
    console.assert(connection.state === signalR.HubConnectionState.Disconnected);

    document.getElementById(&quot;messageInput&quot;).disabled = true;

    const li = document.createElement(&quot;li&quot;);
    li.textContent = `Connection closed due to error &quot;${error}&quot;. Try refreshing this page to restart the connection.`;
    document.getElementById(&quot;messagesList&quot;).appendChild(li);
});
">connection.onclose((error) =&gt; {
    console.assert(connection.state === signalR.HubConnectionState.Disconnected);

    document.getElementById("messageInput").disabled = true;

    const li = document.createElement("li");
    li.textContent = `Connection closed due to error "${error}". Try refreshing this page to restart the connection.`;
    document.getElementById("messagesList").appendChild(li);
});
</code></pre>
<p>In order to configure a custom number of reconnect attempts before disconnecting or change the reconnect timing, <code>withAutomaticReconnect</code> accepts an array of numbers representing the delay in milliseconds to wait before starting each reconnect attempt.</p>
<pre tabindex="0"><code data-author-content="const connection = new signalR.HubConnectionBuilder()
    .withUrl(&quot;/chatHub&quot;)
    .withAutomaticReconnect([0, 0, 10000])
    .build();

    // .withAutomaticReconnect([0, 2000, 10000, 30000]) yields the default behavior
">const connection = new signalR.HubConnectionBuilder()
    .withUrl("/chatHub")
    .withAutomaticReconnect([0, 0, 10000])
    .build();

    // .withAutomaticReconnect([0, 2000, 10000, 30000]) yields the default behavior
</code></pre>
<p>The preceding example configures the <code>HubConnection</code> to start attempting reconnects immediately after the connection is lost. This is also true for the default configuration.</p>
<p>If the first reconnect attempt fails, the second reconnect attempt will also start immediately instead of waiting 2 seconds like it would in the default configuration.</p>
<p>If the second reconnect attempt fails, the third reconnect attempt will start in 10 seconds which is again like the default configuration.</p>
<p>The custom behavior then diverges again from the default behavior by stopping after the third reconnect attempt failure instead of trying one more reconnect attempt in another 30 seconds like it would in the default configuration.</p>
<p>If you want even more control over the timing and number of automatic reconnect attempts, <code>withAutomaticReconnect</code> accepts an object implementing the <code>IRetryPolicy</code> interface, which has a single method named <code>nextRetryDelayInMilliseconds</code>.</p>
<p><code>nextRetryDelayInMilliseconds</code> takes a single argument with the type <code>RetryContext</code>. The <code>RetryContext</code> has three properties: <code>previousRetryCount</code>, <code>elapsedMilliseconds</code> and <code>retryReason</code> which are a <code>number</code>, a <code>number</code> and an <code>Error</code> respectively. Before the first reconnect attempt, both <code>previousRetryCount</code> and <code>elapsedMilliseconds</code> will be zero, and the <code>retryReason</code> will be the Error that caused the connection to be lost. After each failed retry attempt, <code>previousRetryCount</code> will be incremented by one, <code>elapsedMilliseconds</code> will be updated to reflect the amount of time spent reconnecting so far in milliseconds, and the <code>retryReason</code> will be the Error that caused the last reconnect attempt to fail.</p>
<p><code>nextRetryDelayInMilliseconds</code> must return either a number representing the number of milliseconds to wait before the next reconnect attempt or <code>null</code> if the <code>HubConnection</code> should stop reconnecting.</p>
<pre tabindex="0"><code data-author-content="const connection = new signalR.HubConnectionBuilder()
    .withUrl(&quot;/chatHub&quot;)
    .withAutomaticReconnect({
        nextRetryDelayInMilliseconds: retryContext => {
            if (retryContext.elapsedMilliseconds < 60000) {
                // If we've been reconnecting for less than 60 seconds so far,
                // wait between 0 and 10 seconds before the next reconnect attempt.
                return Math.random() * 10000;
            } else {
                // If we've been reconnecting for more than 60 seconds so far, stop reconnecting.
                return null;
            }
        }
    })
    .build();
">const connection = new signalR.HubConnectionBuilder()
    .withUrl("/chatHub")
    .withAutomaticReconnect({
        nextRetryDelayInMilliseconds: retryContext =&gt; {
            if (retryContext.elapsedMilliseconds &lt; 60000) {
                // If we've been reconnecting for less than 60 seconds so far,
                // wait between 0 and 10 seconds before the next reconnect attempt.
                return Math.random() * 10000;
            } else {
                // If we've been reconnecting for more than 60 seconds so far, stop reconnecting.
                return null;
            }
        }
    })
    .build();
</code></pre>
<p>Alternatively, you can write code that will reconnect your client manually as demonstrated in <a href="#manually-reconnect" data-linktype="self-bookmark">Manually reconnect</a>.</p>
</div>
<h3 id="manually-reconnect">Manually reconnect<a href="#manually-reconnect" aria-labelledby="manually-reconnect"></a></h3>
<div data-moniker="aspnetcore-2.1 aspnetcore-2.2">
<div>
<p><span aria-hidden="true"></span> Warning</p>
<p>Prior to 3.0, the JavaScript client for SignalR doesn't automatically reconnect. You must write code that will reconnect your client manually.</p>
</div>
</div>
<p>The following code demonstrates a typical manual reconnection approach:</p>
<ol>
<li>A function (in this case, the <code>start</code> function) is created to start the connection.</li>
<li>Call the <code>start</code> function in the connection's <code>onclose</code> event handler.</li>
</ol>
<pre tabindex="0"><code name="Reconnect the JavaScript client" data-author-content="async function start() {
    try {
        await connection.start();
        console.log(&quot;connected&quot;);
    } catch (err) {
        console.log(err);
        setTimeout(() => start(), 5000);
    }
};

connection.onclose(async () => {
    await start();
});
">async function start() {
    try {
        await connection.start();
        console.log("connected");
    } catch (err) {
        console.log(err);
        setTimeout(() =&gt; start(), 5000);
    }
};

connection.onclose(async () =&gt; {
    await start();
});
</code></pre>
<p>A real-world implementation would use an exponential back-off or retry a specified number of times before giving up.</p>
<h2 id="additional-resources">Additional resources<a href="#additional-resources" aria-labelledby="additional-resources"></a></h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/javascript/api/?view=signalr-js-latest" data-linktype="absolute-path">JavaScript API reference</a></li>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/tutorials/signalr?view=aspnetcore-3.0" data-linktype="relative-path">JavaScript tutorial</a></li>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/tutorials/signalr-typescript-webpack?view=aspnetcore-3.0" data-linktype="relative-path">WebPack and TypeScript tutorial</a></li>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/signalr/hubs?view=aspnetcore-3.0" data-linktype="relative-path">Hubs</a></li>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/signalr/dotnet-client?view=aspnetcore-3.0" data-linktype="relative-path">.NET client</a></li>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/signalr/publish-to-azure-web-app?view=aspnetcore-3.0" data-linktype="relative-path">Publish to Azure</a></li>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/security/cors?view=aspnetcore-3.0" data-linktype="relative-path">Cross-Origin Requests (CORS)</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-signalr/signalr-concept-serverless-development-config" data-linktype="absolute-path">Azure SignalR Service serverless documentation</a></li>
</ul>

						<!-- </content> -->

						</main>

						<!-- recommended content page section -->

							<nav data-bi-name="recommendation-bottom" hidden="" id="recommended-content-center" aria-labelledby="recommended-content-center-title">
								<h3 id="recommended-content-center-title">Related Articles</h3>
							</nav>

						<!-- end recommended content page section -->

						<!-- rating mobile section -->
								
						<!-- end rating mobile section -->

						<!-- feedback section -->



<section data-bi-name="feedback-section">

	<h2 id="feedback">Feedback</h2>

	

	

	

	<div data-tab-group-independent="" hidden="" data-bi-name="tab-group">
		<ul role="tablist">
			<li role="presentation">
				<a href="#tabpanel-issues-open" role="tab" aria-controls="tabpanel-issues-open" data-tab="issues-open" data-bi-name="tab" aria-selected="true" tabindex="0"></a>
			</li>
			<li role="presentation">
				<a href="#tabpanel-issues-closed" role="tab" aria-controls="tabpanel-issues-closed" data-tab="issues-closed" data-bi-name="tab" aria-selected="false" tabindex="-1"></a>
			</li>
		</ul>
		<section id="tabpanel-issues-open" role="tabpanel" data-tab="issues-open">
			
			<ul aria-label="Open Issues"></ul>
		</section>
		<section id="tabpanel-issues-closed" role="tabpanel" data-tab="issues-closed" hidden="hidden" aria-hidden="true">
			<div>There are no closed issues</div>
			<ul aria-label="Closed Issues"></ul>
		</section>
	</div>
	
</section>

						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						
					</div>

					

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			
		</div>

		<!--end of .mainContainer -->
	</div>

	

	

	


</div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>