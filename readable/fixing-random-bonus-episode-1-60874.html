<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Fixing Random, bonus episode 1 - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Fixing Random, bonus episode 1 - linksfor.dev(s)"/>
    <meta property="og:description" content="I just thought of a really cute application of the stochastic workflow technology we&#x2019;ve been working on; most of the series has already been written but it fits in here, so I&#x2019;m going to&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://ericlippert.com/2019/04/01/fixing-random-bonus-episode-1/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Fixing Random, bonus episode 1</title>
<div class="readable">
        <h1>Fixing Random, bonus episode 1</h1>
            <div>Reading time: 5-6 minutes</div>
        <div>Posted here: 21 Apr 2020</div>
        <p><a href="https://ericlippert.com/2019/04/01/fixing-random-bonus-episode-1/">https://ericlippert.com/2019/04/01/fixing-random-bonus-episode-1/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
		<p data-adtags-visited="true">I just thought of a really cute application of the stochastic workflow technology we’ve been working on; most of the series has already been written but it fits in here, so I’m going to insert this extra bonus episode. We’ll implement the zero value next time.</p>
<p data-adtags-visited="true"><a href="https://github.com/ericlippert/probability/tree/bonus01">Code for this bonus episode is here.</a></p>
<hr>
<p data-adtags-visited="true">You are probably familiar with the famous “Monty Hall” problem, but if not, here it is:</p>
<p data-adtags-visited="true"><img data-attachment-id="5823" data-permalink="https://ericlippert.com/2019/04/01/fixing-random-bonus-episode-1/800px-monty_hall_abc_tv/" data-orig-file="https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg" data-orig-size="800,1042" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="800px-Monty_hall_abc_tv" data-image-description="" data-medium-file="https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg?w=230" data-large-file="https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg?w=584" src="https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg?w=240&amp;h=313" alt="800px-Monty_hall_abc_tv.JPG" width="240" height="313" srcset="https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg?w=240&amp;h=313 240w, https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg?w=480&amp;h=626 480w, https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg?w=115&amp;h=150 115w, https://ericlippert.files.wordpress.com/2019/04/800px-monty_hall_abc_tv.jpg?w=230&amp;h=300 230w" sizes="(max-width: 240px) 100vw, 240px"></p>
<ul>
<li>You’re on a game show hosted by Monty Hall, the handsome Canadian fellow pictured above.</li>
<li>Before you there are three closed doors; behind a <em>uniformly randomly selected</em> door there is a new car; behind the other two there is nothing.</li>
<li>You get to choose a door, and you get what is behind it as a prize: either a car, or nothing.</li>
<li>You randomly choose a door, again by some uniform process.</li>
<li>Monty — <em>who knows where the car is</em> — now <em>always</em> opens a door that meets two criteria: it does not have the car behind it, and it is not the door you chose.</li>
<li>To clarify: if you chose the door with the car, Monty chooses one of the remaining two doors by a <em>uniform random</em> choice. If you chose a door without the car, Monty only has one door he can open, and he opens that one.</li>
<li>Monty gives you the opportunity to switch your choice to the <em>other</em> still-closed door.</li>
<li>Assuming you wish to maximize your probability of winning the car, should you <strong>switch</strong>&nbsp;doors or <strong>stay</strong> with your original choice?</li>
</ul>
<hr>
<p data-adtags-visited="true"><strong>Aside:</strong> I’ve tried to be very precise in my description of the game for the purposes of our analysis. In the real game as played on television there were irrelevant details such as: the “prizes” behind the other two doors were goats or other bizarre, undesirable items, and so on. But there were also germane differences between the real game and our model above; for example, in the real game Monty would sometimes offer choices like “<em>do you want to switch your door, or forget about the doors entirely and take the prize that is in this box?</em>” and it is not clear by what process Monty decided to offer those choices. In this simplified version of the game I’ve removed all human agency from Monty; for our purposes, Monty is just a machine that is following an algorithm that involves generating random outcomes.</p>
<hr>
<p data-adtags-visited="true"><strong>Exercise 1:</strong> If you don’t already know the solution, work it out. The answer is below.</p>
<hr>

<p data-adtags-visited="true">.</p>
<p data-adtags-visited="true">.</p>
<p data-adtags-visited="true">.</p>
<p data-adtags-visited="true">.</p>
<p data-adtags-visited="true">.</p>
<p data-adtags-visited="true"><strong>You are two-to-one more likely to win the car if you switch than if you stay.&nbsp;</strong>But don’t take my word for it. Let’s solve the problem with computers, not by thinking!</p>
<p data-adtags-visited="true">Plainly the key to the problem is&nbsp;<em>what is the distribution of Monty’s choice?</em>&nbsp;Monty chooses a random door, but is observed to not pick a door with a car or the door which you picked. We can represent that as a two-parameter likelihood function:</p>
<p data-adtags-visited="true"><span><span>IDiscreteDistribution</span><span>&lt;</span><span>int</span><span>&gt;</span><span>&nbsp;</span><span>doors</span><span>&nbsp;</span><span>=</span><span>&nbsp;</span><span>SDU</span><span>.</span><span>Distribution</span><span>(</span><span>1</span><span>,</span><span>&nbsp;</span><span>3</span><span>);</span><br>
<span>IDiscreteDistribution</span><span>&lt;</span><span>int</span><span>&gt;</span><span>&nbsp;</span><span>Monty</span><span>(</span><span>int</span><span>&nbsp;</span><span>car</span><span>,</span><span>&nbsp;</span><span>int</span><span>&nbsp;</span><span>you</span><span>)</span><span>&nbsp;</span><span>=&gt;</span><br>
<span>&nbsp; &nbsp;&nbsp;</span><span>from</span><span>&nbsp;</span><span>m</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>doors</span><span>&nbsp;</span><br>
<span>&nbsp; &nbsp;&nbsp;</span><span>where</span><span>&nbsp;</span><span>m</span><span>&nbsp;</span><span>!=</span><span>&nbsp;</span><span>car</span><span>&nbsp;</span><br>
<span>&nbsp; &nbsp;&nbsp;</span><span>where</span><span>&nbsp;</span><span>m</span><span>&nbsp;</span><span>!=</span><span>&nbsp;</span><span>you</span><span>&nbsp;</span><br>
<span>&nbsp; &nbsp;&nbsp;</span><span>select</span><span>&nbsp;</span><span>m</span><span>;</span></span></p>
<p data-adtags-visited="true">There’s no logical difficulty in adding more parameters to a likelihood function; think of the parameters as a tuple if that makes you feel better.</p>
<p data-adtags-visited="true">Now we can answer the question. Here’s the probability distribution of winning <strong>if you do not switch:</strong></p>
<p data-adtags-visited="true"><span><span>var</span><span>&nbsp;</span><span>noSwitch1</span><span>&nbsp;</span><span>=</span><span>&nbsp;</span><br>
<span>&nbsp; </span><span>from</span><span>&nbsp;</span><span>car</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>doors</span><br>
<span>&nbsp; </span><span>from</span><span>&nbsp;</span><span>you</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>doors</span><br>
<span>&nbsp; </span><span>from</span><span>&nbsp;</span><span>monty</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>Monty</span><span>(</span><span>car</span><span>,</span><span>&nbsp;</span><span>you</span><span>)</span><br>
<span>&nbsp; </span><span>select</span><span>&nbsp;</span><span>car</span><span>&nbsp;</span><span>==</span><span>&nbsp;</span><span>you ? “Win” : “Lose”</span><span>;</span><br>
<span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>noSwitch1</span><span>.</span><span>ShowWeights</span><span>());</span></span></p>
<p data-adtags-visited="true">And the output is:</p>
<pre>Win:1
Lose:2</pre>
<p data-adtags-visited="true">As predicted by thinking, you are twice as likely to lose if you do not switch. Computers for the win!</p>
<hr>
<p data-adtags-visited="true"><strong>Exercise 2:</strong>&nbsp;Wait a minute, we never even <em>used</em>&nbsp;the value of range variable <code>monty</code>&nbsp;in the query. <strong>How is it possible that adding a <code>from</code> clause to the query changes its outcome</strong> when the sampled value is not even used?!?</p>
<p data-adtags-visited="true">Give this some thought and answer in the comments.</p>
<hr>
<p data-adtags-visited="true"><strong>Exercise 3:</strong>&nbsp;OK smart person, if you thought that one was easy, take a look at this one.</p>
<p data-adtags-visited="true">We have our likelihood function <code>Monty()</code>&nbsp;which is just a query comprehension, and our <code>noSwitch1</code>&nbsp;which is also just a query comprehension. We can make the program a little bit shorter by combining them together in the obvious way:</p>
<p data-adtags-visited="true"><span><span>var</span><span>&nbsp;</span><span>noSwitch2</span><span>&nbsp;</span><span>=</span><span>&nbsp;</span><br>
<span>&nbsp; </span><span>from</span><span>&nbsp;</span><span>car</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>doors</span><br>
<span>&nbsp; </span><span>from</span><span>&nbsp;</span><span>you</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>doors</span><br>
<span>&nbsp; </span><span>from</span><span>&nbsp;</span><span>monty</span><span>&nbsp;</span><span>in</span><span>&nbsp;</span><span>doors</span><br>
<span>&nbsp; </span><span>where</span><span>&nbsp;</span><span>monty</span><span>&nbsp;</span><span>!=</span><span>&nbsp;</span><span>car</span><span>&nbsp;</span><br>
<span>&nbsp; </span><span>where</span><span>&nbsp;</span><span>monty</span><span>&nbsp;</span><span>!=</span><span>&nbsp;</span><span>you</span><span>&nbsp;</span><br>
<span>&nbsp; </span><span>select</span><span>&nbsp;</span><span>car</span><span>&nbsp;</span><span>==</span><span>&nbsp;</span><span>you ? “Win” : “Lose”;</span></span></p>
<p data-adtags-visited="true">And if we print out the weights of that one… uh oh.</p>
<pre>Win:1
Lose:1</pre>
<p data-adtags-visited="true">I would have thought this program fragment to be logically the same as before, but this gives weights of 1:1 when we know the correct answer is 1:2.</p>
<p data-adtags-visited="true"><strong>Where did I go wrong?</strong></p>
<p data-adtags-visited="true">Again, answer in the comments.</p>
<hr>
<p data-adtags-visited="true"><strong>Next time on FAIC:</strong>&nbsp;Let’s get back on track from this silly diversion! We were talking about the zero value, so let’s implement it.</p>
			
			
						</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>