<!DOCTYPE html>
<html lang="en">
<head>
    <title>
.NET Core/Standard Auto Incrementing Versioning - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content=".NET Core/Standard Auto Incrementing Versioning - linksfor.dev(s)"/>
    <meta property="og:description" content="Using The AutoGenerated .NET Core/Standard AssemblyInfo.cs When you create a new .NET Core/.NET Standard project you will get a auto generated set of attributes, which is based on these settings fo&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://sachabarbs.wordpress.com/2020/02/23/net-core-standard-auto-incrementing-versioning/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - .NET Core/Standard Auto Incrementing Versioning</title>
<div class="readable">
        <h1>.NET Core/Standard Auto Incrementing Versioning</h1>
            <div>Reading time: 6-7 minutes</div>
        <div>Posted here: 24 Feb 2020</div>
        <p><a href="https://sachabarbs.wordpress.com/2020/02/23/net-core-standard-auto-incrementing-versioning/">https://sachabarbs.wordpress.com/2020/02/23/net-core-standard-auto-incrementing-versioning/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><article id="post-3847">
			<!-- .entry-header -->
		<div>
		<div>
			<h3>Using The AutoGenerated .NET Core/Standard AssemblyInfo.cs</h3>
<p>When you create a new .NET Core/.NET Standard project you will get a auto generated set of attributes, which is based on these settings for the project<u></u><u></u>  </p>
<p>Which you can in effect in the <strong>obj</strong> folder, where a auto generated <strong><span>xxxxAssemblyInfo.cs</span></strong> class is created for you.</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:52298523-af78-41a8-bc17-0bb194f324a1">
<pre><div><div id="highlighter_517484"><table><tbody><tr><td><p>01</p><p>02</p><p>03</p><p>04</p><p>05</p><p>06</p><p>07</p><p>08</p><p>09</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p></td><td><div><p><code>/------------------------------------------------------------------------------</code></p><p><code>using</code> <code>System;</code></p><p><code>using</code> <code>System.Reflection;</code></p><p><code>[assembly: System.Reflection.AssemblyCompanyAttribute(</code><code>"SomeDemoCode.Std"</code><code>)]</code></p><p><code>[assembly: System.Reflection.AssemblyConfigurationAttribute(</code><code>"Debug"</code><code>)]</code></p><p><code>[assembly: System.Reflection.AssemblyFileVersionAttribute(</code><code>"1.0.0.0"</code><code>)]</code></p><p><code>[assembly: System.Reflection.AssemblyInformationalVersionAttribute(</code><code>"1.0.0"</code><code>)]</code></p><p><code>[assembly: System.Reflection.AssemblyProductAttribute(</code><code>"SomeDemoCode.Std"</code><code>)]</code></p><p><code>[assembly: System.Reflection.AssemblyTitleAttribute(</code><code>"SomeDemoCode.Std"</code><code>)]</code></p><p><code>[assembly: System.Reflection.AssemblyVersionAttribute(</code><code>"1.0.0.0"</code><code>)]</code></p></div></td></tr></tbody></table></div></div>
</pre></div>
<p>So when we build the project we would end up with this version being applied to the resulting output for the project </p>
<p>Ok that explains how the AssemblyInfo stuff works in .NET Core/Standard, but what is the .NET Cote/Standard way of doing auto incrementing versions?<u></u><u></u> </p>
<p>Well believe it or not there is not a native feature for this, there are various efforts/attempts at this which you can read more about <u></u><u></u></p>
<p><u></u>· <u></u><a href="https://stackoverflow.com/questions/43019832/auto-versioning-in-visual-studio-2017-net-core">https://stackoverflow.com/questions/43019832/auto-versioning-in-visual-studio-2017-net-core</a><u></u><u></u> </p>
<p><u></u>· <u></u><a href="https://andrewlock.net/version-vs-versionsuffix-vs-packageversion-what-do-they-all-mean/">https://andrewlock.net/version-vs-versionsuffix-vs-packageversion-what-do-they-all-mean/</a><u></u><u></u> </p>
<p>After reading all of those the best approach seemed to be based upon sticking with using the Auto generated <span>Assembly.info</span> stuff, but to come up with some scheme that would aid in the generation of the assembly version at build time.<u></u><u></u> </p>
<p>What that means is you want to ensure your <strong>.csproj</strong> file looks something like this, where it can be seen that some of the .NET Core/Standard auto generated AssemblyInfo stuff is made available directly in the project file</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:2dc2379b-892c-4db2-93ec-2cd1a4010f30">
<pre><div><div id="highlighter_477114"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p></td><td><div><p><code>&lt;</code><code>Project</code> <code>Sdk</code><code>=</code><code>"Microsoft.NET.Sdk"</code><code>&gt;</code></p><p><code>&lt;</code><code>PropertyGroup</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>TargetFramework</code><code>&gt;netstandard2.0&lt;/</code><code>TargetFramework</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Platforms</code><code>&gt;x64&lt;/</code><code>Platforms</code><code>&gt;</code></p><p><code>&lt;/</code><code>PropertyGroup</code><code>&gt;</code></p><p><code>&lt;</code><code>PropertyGroup</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>DefineConstants</code><code>&gt;STD&lt;/</code><code>DefineConstants</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>PlatformTarget</code><code>&gt;x64&lt;/</code><code>PlatformTarget</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>AssemblyName</code><code>&gt;SomeDemoCode.Std&lt;/</code><code>AssemblyName</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>RootNamespace</code><code>&gt;SomeDemoCode.Std&lt;/</code><code>RootNamespace</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>VersionSuffix</code><code>&gt;1.0.0.$([System.DateTime]::UtcNow.ToString(mmff))&lt;/</code><code>VersionSuffix</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>AssemblyVersion</code> <code>Condition</code><code>=</code><code>" '$(VersionSuffix)' == '' "</code><code>&gt;0.0.0.1&lt;/</code><code>AssemblyVersion</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>AssemblyVersion</code> <code>Condition</code><code>=</code><code>" '$(VersionSuffix)' != '' "</code><code>&gt;$(VersionSuffix)&lt;/</code><code>AssemblyVersion</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Version</code> <code>Condition</code><code>=</code><code>" '$(VersionSuffix)' == '' "</code><code>&gt;0.0.1.0&lt;/</code><code>Version</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Version</code> <code>Condition</code><code>=</code><code>" '$(VersionSuffix)' != '' "</code><code>&gt;$(VersionSuffix)&lt;/</code><code>Version</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Company</code><code>&gt;SAS&lt;/</code><code>Company</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Authors</code><code>&gt;SAS&lt;/</code><code>Authors</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Copyright</code><code>&gt;Copyright © SAS 2020&lt;/</code><code>Copyright</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Product</code><code>&gt;Demo 1.0&lt;/</code><code>Product</code><code>&gt;</code></p><p><code>&lt;/</code><code>PropertyGroup</code><code>&gt;</code></p><p><code>&lt;/</code><code>Project</code><code>&gt;</code></p></div></td></tr></tbody></table></div></div>
</pre></div>
<p>With this in place you will get a auto versioned Assembly version using just .NET Core/Standard approach</p>
<h3>But what about InternalsVisibleTo?</h3>
<p>Quite often we want to still expose our .NET Standard projects to test projects. And if the .NET Core/Standard projects auto generate the AssemblyInfo based on either defaults or attributes in the actual <strong>.csproj</strong> file, how do we add a <strong>InternalsVisibleTo</strong>, this doesn’t seem to be covered by the auto generated AssemblyInfo that gets created for .NET Core/Standard project, nor does it seem to be available as a csproj level MSBUILD property item. So how do we do this ?<u></u><u></u> </p>
<p>luckily this is quite simple we just need to do the following in a custom file which you can call anything you want, you can even call it “<strong><span>AssemblyInfo.cs</span></strong>” if you want</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:d443d844-c850-4eea-b5c4-9785bf380aca">
<pre><div><div id="highlighter_791322"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p></td><td><div><p><code>using</code> <code>System.Runtime.CompilerServices;</code></p><p><code>[assembly: InternalsVisibleTo(</code><code>"SomeDemoCode.IntegrationTests"</code><code>)]</code></p></div></td></tr></tbody></table></div></div>
</pre></div>
<h3>Opting Out Of the Auto Assembly Info Generation Process And Using Our Own Auto Increment Scheme</h3>
<p>If you want to use the .NET Framework approach to auto versioning this is normally done with a wildcard in the</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:5eb04898-2f63-45d5-ae90-debbff767346">
<pre><div><div id="highlighter_48668"><table><tbody><tr><td><p>1</p></td><td><div><p><code>[assembly: AssemblyVersion(</code><code>"1.0.*"</code><code>)]</code></p></div></td></tr></tbody></table></div></div>
</pre></div>
<p>So you might think, hmm so I can just override this by adding my own <strong><span>AssemblyInfo.cs</span></strong>, But this will not work you will get this when you build</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:989a575c-24f9-46d2-9144-1f39d48fdd10">
<pre><div><div id="highlighter_451682"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p></td><td><div><p><code>&gt; Error CS0579: Duplicate </code><code>'System.Reflection.AssemblyFileVersionAttribute'</code> <code>attribute</code></p><p><code>&gt; Error CS0579: Duplicate </code><code>'System.Reflection.AssemblyInformationalVersionAttribute'</code> <code>attribute</code></p><p><code>&gt; Error CS0579: Duplicate </code><code>'System.Reflection.AssemblyVersionAttribute'</code> <code>attribute</code></p></div></td></tr></tbody></table></div></div>
</pre></div>
<p>Luckily we can opt out of this auto generation process, where we have to add the following to our .NET Core/.NET standard csproj file</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:d0298dc7-afa0-40c5-a802-da09505c3906">
<pre><div><div id="highlighter_801865"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p></td><td><div><p><code>&lt;</code><code>PropertyGroup</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>GenerateAssemblyInfo</code><code>&gt;false&lt;/</code><code>GenerateAssemblyInfo</code><code>&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>&lt;</code><code>Deterministic</code><code>&gt;false&lt;/</code><code>Deterministic</code><code>&gt;</code></p><p><code>&lt;/</code><code>PropertyGroup</code><code>&gt;</code></p></div></td></tr></tbody></table></div></div>
</pre></div>
<p>You need the deterministic property otherwise you will get this error</p>
<pre>Wildcards are only allowed if the build is not deterministic, which is the default for .Net Core projects. Adding False to csproj fixes the issue.
</pre>
<p>With this in place we can now include a custom <strong><span>AssemblyInfo.cs</span></strong> which could for example use a auto incrementing version number, where we use a wild card when specifying the <strong>AssemblyVersion</strong><u></u><u></u></p>

<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:703db4b3-44c5-4c50-8f13-79e273a57d00">
<pre><div><div id="highlighter_713200"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p></td><td><div><p><code>using</code> <code>System.Reflection;</code></p><p><code>using</code> <code>System.Runtime.InteropServices;</code></p><p><code>[assembly: AssemblyTitle(</code><code>"SomeDemoCode.Std"</code><code>)]</code></p><p><code>[assembly: AssemblyDescription(</code><code>"SomeDemoCode .NET Standard"</code><code>)]</code></p><p><code>[assembly: AssemblyConfiguration(</code><code>""</code><code>)]</code></p><p><code>[assembly: AssemblyCompany(</code><code>"SAS"</code><code>)]</code></p><p><code>[assembly: AssemblyProduct(</code><code>"SAS 1.0"</code><code>)]</code></p><p><code>[assembly: AssemblyCopyright(</code><code>"Copyright © SAS 2020"</code><code>)]</code></p><p><code>[assembly: AssemblyTrademark(</code><code>""</code><code>)]</code></p><p><code>[assembly: AssemblyCulture(</code><code>""</code><code>)]</code></p><p><code>[assembly: ComVisible(</code><code>false</code><code>)]</code></p><p><code>[assembly: Guid(</code><code>"CA7543D7-0F0F-4B48-9398-2712098E9324"</code><code>)]</code></p><p><code>[assembly: AssemblyVersion(</code><code>"1.0.*"</code><code>)]</code></p></div></td></tr></tbody></table></div></div>
</pre></div>

<p>Now when we build you will get some nice auto incrementing assembly versions inside your .NET Core/Standard projects</p>
			
			
								</div><!-- .entry-content -->

		<!-- .entry-footer -->
	</div><!-- .content-wrapper -->
</article></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>