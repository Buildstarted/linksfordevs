<!DOCTYPE html>
<html lang="en">
<head>
    <title>
ASP.NET Blog | ASP.NET Core updates in .NET Core 3.0 Preview 3 - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="ASP.NET Blog | ASP.NET Core updates in .NET Core 3.0 Preview 3 - linksfor.dev(s)"/>
    <meta property="article:author" content="Daniel RothPrincipal Program Manager,&#xA0;ASP.NETFollow Daniel"/>
    <meta property="og:description" content=".NET Core 3.0 Preview 3 is now available and it includes a bunch of new updates to ASP.NET Core.&#xA;Here&#x2019;s the list of what&#x2019;s new in this preview:&#xA;&#xA;Razor Components improvements:&#xA;&#xA;Single project template&#xA;New .razor extension&#xA;Endpoint routing integration&#xA;Prerendering&#xA;Razor Components in Razor Class Libraries&#xA;Improved event handling&#xA;Forms &amp;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/aspnet/asp-net-core-updates-in-net-core-3-0-preview-3/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - ASP.NET Blog | ASP.NET Core updates in .NET Core 3.0 Preview 3</title>
<div class="readable">
        <h1>ASP.NET Blog | ASP.NET Core updates in .NET Core 3.0 Preview 3</h1>
            <div>by Daniel RothPrincipal Program Manager,&#xA0;ASP.NETFollow Daniel</div>
            <div>Reading time: 19-24 minutes</div>
        <div>Posted here: 06 Mar 2019</div>
        <p><a href="https://devblogs.microsoft.com/aspnet/asp-net-core-updates-in-net-core-3-0-preview-3/">https://devblogs.microsoft.com/aspnet/asp-net-core-updates-in-net-core-3-0-preview-3/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured">

	<div>
                
         <div><div><div><p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/02/DaniethRothPhoto-150x150.jpeg" width="58" height="58" alt="Daniel Roth"></p><p>Daniel</p></div></div></div>     
        <p>March 6th, 2019</p><!-- .entry-meta -->

		<p><a href="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-preview-3/">.NET Core 3.0 Preview 3 is now available</a> and it includes a bunch of new updates to ASP.NET Core.</p>
<p>Here’s the list of what’s new in this preview:</p>
<ul>
<li>Razor Components improvements:
<ul>
<li>Single project template</li>
<li>New .razor extension</li>
<li>Endpoint routing integration</li>
<li>Prerendering</li>
<li>Razor Components in Razor Class Libraries</li>
<li>Improved event handling</li>
<li>Forms &amp; validation</li>
</ul>
</li>
<li>Runtime compilation</li>
<li>Worker Service template</li>
<li>gRPC template</li>
<li>Angular template updated to Angular 7</li>
<li>Authentication for Single Page Applications</li>
<li>SignalR integration with endpoint routing</li>
<li>SignalR Java client support for long polling</li>
</ul>
<p>Please see the <a href="https://aka.ms/netcore3releasenotes" target="_blank">release notes</a> for additional details and known issues.</p>
<h2>Get started</h2>
<p>To get started with ASP.NET Core in .NET Core 3.0 Preview 3 <a href="https://aka.ms/netcore3download" target="_blank">install the .NET Core 3.0 Preview 3 SDK</a></p>
<p>If you’re on Windows using Visual Studio, you’ll also want to <a href="https://visualstudio.com/preview" target="_blank">install the latest preview of Visual Studio 2019</a>.</p>
<ul>
<li>Note: To use use this preview of .NET Core 3.0 with the <em>release</em> channel of Visual Studio 2019, you will need to enable the option to use previews of the .NET Core SDK by going to <em>Tools &gt; Options &gt; Projects and Solutions &gt; .NET Core &gt; Use previews of the .NET Core SDK</em></li>
</ul>
<h2>Upgrade an existing project</h2>
<p>To upgrade an existing an ASP.NET Core app to .NET Core 3.0 Preview 3, follow the <a href="https://docs.microsoft.com/en-us/aspnet/core/migration/22-to-30" target="_blank">migrations steps in the ASP.NET Core docs</a>.</p>
<p>Please also see the full list of <a href="https://github.com/aspnet/announcements/issues?utf8=%E2%9C%93&amp;q=is%3Aissue+label%3A3.0.0+label%3A%22Breaking+change%22" target="_blank">breaking changes</a> in ASP.NET Core 3.0.</p>
<h2>Razor Components improvements</h2>
<p>In the previous preview, we introduced Razor Components as a new way to build interactive client-side web UI with ASP.NET Core. This section covers the various improvements we’ve made to Razor Components in this preview update.</p>
<h3>Single project template</h3>
<p>The Razor Components project template is now a single project instead of two projects in the same solution. The authored Razor Components live directly in the ASP.NET Core app that hosts them. The same ASP.NET Core project can contain Razor Components, Pages, and Views. The Razor Components template also has HTTPS enabled by default like the other ASP.NET Core web app templates.</p>
<h3>New .razor extension</h3>
<p>Razor Components are authored using Razor syntax, but are compiled differently than Razor Pages and Views. To clarify which Razor files should be compiled as Razor Components we’ve introduced a new file extension: .razor. In the Razor Components template all component files now use the .razor extension. Razor Pages and Views still use the .cshtml extension.</p>
<p>Razor Components can still be authored using the .cshtml file extension as long as those files are identified as Razor Component files using the <code>_RazorComponentInclude</code> MSBuild property. For example, the Razor Component template in this release specifies that all .cshtml files under the <em>Components</em> folder should be treated as Razor Components.</p>
<pre><code><span>&lt;_RazorComponentInclude&gt;Components\**\*.cshtml&lt;/_RazorComponentInclude&gt;</span></code></pre>
<p>Please note that there are a number of limitations with .razor files in this release. Please refer to the <a href="https://github.com/aspnet/AspNetCore/releases/tag/v3.0.0-preview3-19153-02" target="_blank">release notes</a> for the list of known issues and available workarounds.</p>
<h3>Endpoint routing integration</h3>
<p>Razor Components are now integrated into ASP.NET Core’s new Endpoint Routing system. To enable Razor Components support in your application, use <code>MapComponentHub&lt;TComponent&gt;</code> within your routing configuration. For example,</p>
<pre><code><span>app</span><span>.</span><span>UseRouting</span><span>(</span><span>routes </span><span>=&gt;</span><span>
</span><span>{</span><span>
    routes</span><span>.</span><span>MapRazorPages</span><span>();</span><span>
    routes</span><span>.</span><span>MapComponentHub</span><span>&lt;</span><span>App</span><span>&gt;(</span><span>"app"</span><span>);</span><span>
</span><span>});</span></code></pre>
<p>This configures the application to accept incoming connections for interactive Razor Components, and specifies that the root component <code>App</code> should be rendered within a DOM element matching the selector <code>app</code>.</p>
<h3>Prerendering</h3>
<p>The Razor Components project template now does server-side prerendering by default. This means that when a user navigates to your application, the server will perform an initial render of your Razor Components and deliver the result to their browser as plain static HTML. Then, the browser will reconnect to the server via SignalR and switch the Razor Components into a fully interactive mode. This two-phase delivery is beneficial because:</p>
<ul>
<li>It improves the perceived performance of the site, because the UI can appear sooner, without waiting to make any WebSocket connections or even running any client-side script. This makes a bigger difference for users on slow connections, such as 2G/3G mobiles.</li>
<li>It can make your application easily crawlable by search engines.</li>
</ul>
<p>For users on faster connections, such as intranet users, this feature has less impact because the UI should appear near-instantly regardless.</p>
<p>To set up prerendering, the Razor Components project template no longer has a static HTML file. Instead a single Razor Page, <em>/Pages/Index.cshtml</em>, is used to prerender the app content using the <code>Html.RenderComponentAsync&lt;TComponent&gt;()</code> HTML helper. The page also references the <em>components.server.js</em> script to set up the SignalR connection after the content has been prerendered and downloaded. And because this is a Razor Page, features like the environment tag helper just work.</p>
<p><em>Index.cshtml</em></p>
<pre><code><span>@page</span><span> </span><span>"{*clientPath}"</span><span>
</span><span>&lt;!</span><span>DOCTYPE html</span><span>&gt;</span><span>
</span><span>&lt;html&gt;</span><span>
</span><span>&lt;head&gt;</span><span>
    </span><span>...</span><span>
</span><span>&lt;/</span><span>head</span><span>&gt;</span><span>
</span><span>&lt;body&gt;</span><span>
    </span><span>&lt;app&gt;</span><span>@(</span><span>await </span><span>Html</span><span>.</span><span>RenderComponentAsync</span><span>&lt;</span><span>App</span><span>&gt;())&lt;/</span><span>app</span><span>&gt;</span><span>

    </span><span>&lt;</span><span>script src</span><span>=</span><span>"_framework/components.server.js"</span><span>&gt;&lt;/</span><span>script</span><span>&gt;</span><span>
</span><span>&lt;/</span><span>body</span><span>&gt;</span><span>
</span><span>&lt;/</span><span>html</span><span>&gt;</span></code></pre>
<p>Besides the app loading faster, you can see that prerendering is happening by looking at the downloaded HTML source in the browser dev tools. The Razor Components are fully rendered in the HTML.</p>
<h3>Razor Components in Razor Class Libraries</h3>
<p>You can now add Razor Components to Razor Class Libraries and reference them from ASP.NET Core projects using Razor Components.</p>
<p>To create reusable Razor Components in a Razor Class Library:</p>
<ol>
<li>
<p>Create an Razor Components app:</p>
<pre><code><span>dotnet </span><span>new</span><span> razorcomponents </span><span>-</span><span>o </span><span>RazorComponentsApp1</span></code></pre>
</li>
<li>
<p>Create a new Razor Class Library</p>
<pre><code><span>dotnet </span><span>new</span><span> razorclasslib </span><span>-</span><span>o </span><span>RazorClassLib1</span></code></pre>
</li>
<li>
<p>Add a <em>Component1.razor</em> file to the Razor Class Library</p>
</li>
</ol>
<p><em>Component1.razor</em></p>
<pre><code><span>&lt;h1&gt;</span><span>Component1</span><span>&lt;/h1&gt;</span><span>

</span><span>&lt;p&gt;</span><span>@message</span><span>&lt;/p&gt;</span><span>

@functions {
    string message = "Hello from a Razor Class Library"!;
}</span></code></pre>
<ol>
<li>
<p>Reference the Razor Class Library from an ASP.NET Core app using Razor Components:</p>
<pre><code><span>dotnet add </span><span>RazorComponentsApp1</span><span> reference </span><span>RazorClassLib1</span></code></pre>
</li>
<li>
<p>In the Razor Components app, import all components from the Razor Class Library using the <code>@addTagHelper</code> directive and then use <code>Component1</code> in the app:</p>
</li>
</ol>
<p><em>Index.razor</em></p>
<pre><code><span>@page</span><span> </span><span>"/"</span><span>
</span><span>@addTagHelper</span><span> </span><span>*,</span><span> </span><span>RazorClassLib1</span><span>

</span><span>&lt;h1&gt;</span><span>Hello</span><span>,</span><span> world</span><span>!&lt;/</span><span>h1</span><span>&gt;</span><span>

</span><span>Welcome</span><span> to your </span><span>new</span><span> app</span><span>.</span><span>

</span><span>&lt;</span><span>Component1</span><span> </span><span>/&gt;</span></code></pre>
<p>Note that Razor Class Libraries are not compatible with Blazor apps in this release. Also, Razor Class Libraries do not yet support static assets. To create components in a library that can be shared with Blazor and Razor Components apps you still need to use a <a href="https://docs.microsoft.com/en-us/aspnet/core/razor-components/class-libraries" target="_blank">Blazor Class Library</a>. This is something we expect to address in a future update.</p>
<h3>Improved event handling</h3>
<p>The new <code>EventCallback</code> and <code>EventCallback&lt;&gt;</code> types make defining component callbacks much more straightforward. For example consider the following two components:</p>
<p><em>MyButton.razor</em></p>
<pre><code><span>&lt;button</span><span> </span><span>onclick</span><span>=</span><span>"</span><span>@OnClick</span><span>"</span><span>&gt;</span><span>Click here and see what happens!</span><span>&lt;/button&gt;</span><span>

@functions {
    [Parameter] EventCallback</span><span>&lt;UIMouseEventArgs&gt;</span><span> OnClick { get; set; }
}</span></code></pre>
<p><em>UsesMyButton.razor</em></p>
<pre><code><span>&lt;div&gt;</span><span>@text</span><span>&lt;/div&gt;</span><span>

</span><span>&lt;MyButton</span><span> </span><span>OnClick</span><span>=</span><span>"</span><span>ShowMessage</span><span>"</span><span> </span><span>/&gt;</span><span>

@function {
    string text;

    void ShowMessage(UIMouseEventArgs e)
    {
        text = "Hello, world!";
    }
}</span></code></pre>
<p>The <code>OnClick</code> callback is of type <code>EventCallback&lt;UIMouseEventArgs&gt;</code> (instead of <code>Action&lt;UIMouseEventArgs&gt;</code>), which <code>MyButton</code> passes off directly to the <code>onclick</code> event handler. The compiler handles converting the delegate to an <code>EventCallback</code>, and will do some other things to make sure that the rendering process has enough information to render the correct target component. As a result an explicit call to <code>StateHasChanged</code> in the <code>ShowMessage</code> event handler isn’t necessary.</p>
<p>By using the <code>EventCallback&lt;&gt;</code> type <code>OnClick</code> handler can now also be asynchronous without any additional code changes to <code>MyButton</code>:</p>
<p><em>UsesMyButton.razor</em></p>
<pre><code><span>&lt;div&gt;</span><span>@text</span><span>&lt;/div&gt;</span><span>

</span><span>&lt;MyButton</span><span> </span><span>OnClick</span><span>=</span><span>"</span><span>ShowMessageAsync</span><span>"</span><span> </span><span>/&gt;</span><span>

@function {
    string text;

    async Task ShowMessageAsync(UIMouseEventArgs e)
    {
        await Task.Yield(); 
        text = "Hello, world!";
    }
}</span></code></pre>
<p>We recommend using <code>EventCallback</code> and <code>EventCallback&lt;T&gt;</code> when you define component parameters for event handling and binding. Use <code>EventCallback&lt;&gt;</code> where possible because it’s strongly typed and will provide better feedback to users of your component. Use <code>EventCallback</code> when there’s no value you will pass to the callback.</p>
<p>Note that consumers don’t have to write different code when using a component because of <code>EventCallback</code>. The same event handling code should still work, while removing some thorny issues and improving the usability of your components.</p>
<h3>Forms &amp; validation</h3>
<p>This preview release adds built-in components and infrastructure for handling forms and validation.</p>
<p>One of the benefits of using .NET for client-side web development is the ability to share the same implementation logic between the client and the server. Validation logic is a prime example. The new forms &amp; validation support in Razor Components includes support for handling validation using data annotations, or you can plug in your preferred validation system.</p>
<p>For example, the following <code>Person</code> type defines validation logic using data annotations:</p>
<pre><code><span>public</span><span> </span><span>class</span><span> </span><span>Person</span><span>
</span><span>{</span><span>
    </span><span>[</span><span>Required</span><span>(</span><span>ErrorMessage</span><span> </span><span>=</span><span> </span><span>"Enter a name"</span><span>)]</span><span>
    </span><span>[</span><span>StringLength</span><span>(</span><span>10</span><span>,</span><span> </span><span>ErrorMessage</span><span> </span><span>=</span><span> </span><span>"That name is too long"</span><span>)]</span><span>
    </span><span>public</span><span> </span><span>string</span><span> </span><span>Name</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span><span>

    </span><span>[</span><span>Range</span><span>(</span><span>0</span><span>,</span><span> </span><span>200</span><span>,</span><span> </span><span>ErrorMessage</span><span> </span><span>=</span><span> </span><span>"Nobody is that old"</span><span>)]</span><span>
    </span><span>public</span><span> </span><span>int</span><span> </span><span>AgeInYears</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span><span>

    </span><span>[</span><span>Required</span><span>]</span><span>
    </span><span>[</span><span>Range</span><span>(</span><span>typeof</span><span>(</span><span>bool</span><span>),</span><span> </span><span>"true"</span><span>,</span><span> </span><span>"true"</span><span>,</span><span> </span><span>ErrorMessage</span><span> </span><span>=</span><span> </span><span>"Must accept terms"</span><span>)]</span><span>
    </span><span>public</span><span> </span><span>bool</span><span> </span><span>AcceptsTerms</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span><span>
</span><span>}</span></code></pre>
<p>Here’s how you can create a validating form based on this <code>Person</code> model:</p>
<pre><code><span>&lt;EditForm</span><span> </span><span>Model</span><span>=</span><span>"@person"</span><span> </span><span>OnValidSubmit</span><span>=</span><span>"</span><span>@HandleValidSubmit</span><span>"</span><span>&gt;</span><span>
    </span><span>&lt;DataAnnotationsValidator</span><span> </span><span>/&gt;</span><span>
    </span><span>&lt;ValidationSummary</span><span> </span><span>/&gt;</span><span>

    </span><span>&lt;p</span><span> </span><span>class</span><span>=</span><span>"name"</span><span>&gt;</span><span>
        Name: </span><span>&lt;InputText</span><span> </span><span>bind-Value</span><span>=</span><span>"@person.Name"</span><span> </span><span>/&gt;</span><span>
    </span><span>&lt;/p&gt;</span><span>
    </span><span>&lt;p</span><span> </span><span>class</span><span>=</span><span>"age"</span><span>&gt;</span><span>
        Age (years): </span><span>&lt;InputNumber</span><span> </span><span>bind-Value</span><span>=</span><span>"@person.AgeInYears"</span><span> </span><span>/&gt;</span><span>
    </span><span>&lt;/p&gt;</span><span>
    </span><span>&lt;p</span><span> </span><span>class</span><span>=</span><span>"accepts-terms"</span><span>&gt;</span><span>
        Accepts terms: </span><span>&lt;InputCheckbox</span><span> </span><span>bind-Value</span><span>=</span><span>"@person.AcceptsTerms"</span><span> </span><span>/&gt;</span><span>
    </span><span>&lt;/p&gt;</span><span>

    </span><span>&lt;button</span><span> </span><span>type</span><span>=</span><span>"submit"</span><span>&gt;</span><span>Submit</span><span>&lt;/button&gt;</span><span>
</span><span>&lt;/EditForm&gt;</span><span>

@functions {
    Person person = new Person();

    void HandleValidSubmit()
    {
        Console.WriteLine("OnValidSubmit");
    }
}</span></code></pre>
<p>If you add this form to your app and run it you will get a basic form that automatically validates the field inputs when they are changed and when the form is submitted.</p>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/razor-components-validating-form.png" alt="Validating form"></p>
<p>There are quite a few things going on here, so let’s break it down piece by piece:</p>
<ul>
<li>The form is defined using the new <code>EditForm</code> component. The <code>EditForm</code> sets up an <code>EditContext</code> as a <a href="https://docs.microsoft.com/en-us/aspnet/core/razor-components/components#cascading-values-and-parameters" target="_blank">cascading value</a> that tracks metadata about the edit process (e.g. what’s been modified, current validation messages, etc.). The <code>EditForm</code> also provides convenient events for valid and invalid submits (<code>OnValidSubmit</code>, <code>OnInvalidSubmit</code>). Or you can use <code>OnSubmit</code> directly if you want to trigger the validation yourself.</li>
<li>The <code>DataAnnotationsValidator</code> component attaches validation support using data annotations to the cascaded <code>EditContext</code>. Enabling support for validation using data annotations currently requires this explicit gesture, but we are considering making this the default behavior that you can then override.</li>
<li>Each of the form fields are defined using a set of built-in input components (<code>InputText</code>, <code>InputNumber</code>, <code>InputCheckbox</code>, <code>InputSelect</code>, etc.). These components provide default behavior for validating on edit and changing their CSS class to reflect the field state. Some of them have useful parsing logic (e.g., <code>InputDate</code> and <code>InputNumber</code> handle unparseable values gracefully by registering them as validation errors). The relevant ones also support nullability of the target field (e.g., int?).</li>
<li>The <code>ValidationMessage</code> component displays validation messages for a specific field.</li>
<li>The <code>ValidationSummary</code> component summarizes all validation messages (similar to the validation summary tag helper).</li>
</ul>
<p>There are some limitations with the built-in input components that we expect to improve in future updates. For example, you can’t currently specify arbitrary attributes on the generate input tags. In the future, we plan to enable components that pass through all extra attributes. For now, you’ll need to build your own component subclasses to handle these cases.</p>
<h2>Runtime compilation</h2>
<p>Support for runtime compilation was removed from the ASP.NET Core shared framework in .NET Core 3.0, but you can now enable it by adding a package to your app.</p>
<p>To enable runtime compilation:</p>
<ol>
<li>
<p>Add a package reference to Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation</p>
<pre><code><span>&lt;PackageReference</span><span> </span><span>Include</span><span>=</span><span>"Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation"</span><span> </span><span>Version</span><span>=</span><span>"3.0.0-preview3-19153-02"</span><span> </span><span>/&gt;</span></code></pre>
</li>
<li>
<p>In <code>Startup.ConfigureServices</code> add a call to <code>AddRazorRuntimeCompilation</code></p>
<pre><code><span>services</span><span>.</span><span>AddMvc</span><span>().</span><span>AddRazorRuntimeCompilation</span><span>();</span></code></pre>
</li>
</ol>
<h2>Worker Service Template</h2>
<p>In 3.0.0-preview3 we are introducing a new template called ‘Worker Service’. This template is designed as a starting point for running long-running background processes like you might run as a Windows Service or Linux Daemon. Examples of this would be producing/consuming messages from a message queue or monitoring a file to process when it appears. It’s intended to provide the productivity features of ASP.NET Core such as Logging, DI, Configuration, etc without carrying any web dependencies.</p>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/worker-service.png" alt="Worker Service"></p>
<p>In the coming days we will publish a few blog posts giving more walkthroughs on using the Worker template to get started. We will have dedicated posts about publishing as a Windows/Systemd service, running on ACI/AKS, as well as running as a WebJob.</p>
<h3>Caveats</h3>
<p>Whilst the intent is for the worker template to not have any dependencies on web technologies by default, in preview3 it still uses the Web SDK and is shown after you select ‘ASP.NET Core WebApplication’ in Visual Studio. This is temporary and will be changed in a future preview. This means that for preview3 you will see many options in VS that may not make sense, such as publishing your worker as a web app to IIS.</p>
<h2>Angular template updated to Angular 7</h2>
<p>The Angular template is now updated to Angular 7. We anticipate updating again to Angular 8 before .NET Core 3.0 ships a stable release.</p>
<h2>Authentication for the Single Page Application templates</h2>
<p>This release introduces support for authentication in our Angular and React templates. In this section we show how to create a new Angular or React template that allows us to authenticate users and access a protected API resource.</p>
<p>Our support for authenticating and authorizing users is powered behind the scenes by <a href="https://identityserver.io/" target="_blank">IdentityServer</a>, with some extensions we built to simplify the configuration experience for the scenarios we are targeting.</p>
<p>Note: In this post we showcase authentication support for Angular but the React template offers equivalent functionality.</p>
<h3>Create a new Angular application</h3>
<p>To create a new Angular application with authentication support we invoke the following command:</p>
<pre><code><span>dotnet </span><span>new</span><span> angular </span><span>-</span><span>au </span><span>Individual</span></code></pre>
<p>This command creates a new ASP.NET Core application with a hosted client Angular application. The ASP.NET Core application includes an Identity Server instance already configured so that your Angular application can authenticate users and send HTTP requests against the protected resources in the ASP.NET Core application.</p>
<p>The authentication and authorization support is built as an Angular module that gets imported into your application and offers a suite of components and services to enhance the functionality of the main applicaiton module.</p>
<h3>Run the application</h3>
<p>To run the application simply execute the command below and open the browser in the url displayed on the console:</p>
<pre><code><span>dotnet run</span></code></pre>
<pre><code><span>Hosting</span><span> environment</span><span>:</span><span> </span><span>Development</span><span>
</span><span>Content</span><span> root path</span><span>:</span><span> C</span><span>:</span><span>\angularapp
</span><span>Now</span><span> listening on</span><span>:</span><span> https</span><span>:</span><span>//localhost:5001</span><span>
</span><span>Now</span><span> listening on</span><span>:</span><span> http</span><span>:</span><span>//localhost:5000</span><span>
</span><span>Application</span><span> started</span><span>.</span><span> </span><span>Press</span><span> </span><span>Ctrl</span><span>+</span><span>C to shut down</span><span>.</span></code></pre>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/spa-auth-index.png" alt="SPA index"></p>
<p>When we open the application we see the usual Home, Counter and Fetch data menu options and two new options: Register and Login. If we click on Register we get sent to the default Identity UI where (after running migrations and updating the database) we can register as a new user.</p>
<h3>Register a new user</h3>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/spa-auth-register.png" alt="SPA register"></p>
<p>After registering as a new user we get redirected back to the application where we can see that we are successfully authenticated</p>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/spa-logged-in.png" alt="SPA logged in"></p>
<h3>Call an authenticated API</h3>
<p>If we click on the Fetch data we can see the weather forecast data table</p>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/spa-fetch-data.png" alt="SPA fetch data"></p>
<h3>Protect an existing API</h3>
<p>To protect an API on the server we simply need to use the <code>[Authorize]</code> attribute on the controller or action that we want to protect.</p>
<pre><code><span>[</span><span>Authorize</span><span>]</span><span>
</span><span>[</span><span>Route</span><span>(</span><span>"api/[controller]"</span><span>)]</span><span>
</span><span>public</span><span> </span><span>class</span><span> </span><span>SampleDataController</span><span> </span><span>:</span><span> </span><span>Controller</span><span>
</span><span>{</span><span>
</span><span>...</span><span>
</span><span>}</span></code></pre>
<h3>Require authentication for a client route.</h3>
<p>To require the user be authenticated when visiting a page in the Angular application we apply the <code>[AuthorizeGuard]</code> to the route we are configuring.</p>
<pre><code><span>import</span><span> </span><span>{</span><span> </span><span>ApiAuthorizationModule</span><span> </span><span>}</span><span> </span><span>from</span><span> </span><span>'src/api-authorization/api-authorization.module'</span><span>;</span><span>
</span><span>import</span><span> </span><span>{</span><span> </span><span>AuthorizeGuard</span><span> </span><span>}</span><span> </span><span>from</span><span> </span><span>'src/api-authorization/authorize.guard'</span><span>;</span><span>
</span><span>import</span><span> </span><span>{</span><span> </span><span>AuthorizeInterceptor</span><span> </span><span>}</span><span> </span><span>from</span><span> </span><span>'src/api-authorization/authorize.interceptor'</span><span>;</span><span>

</span><span>@NgModule</span><span>({</span><span>
  declarations</span><span>:</span><span> </span><span>[</span><span>
    </span><span>AppComponent</span><span>,</span><span>
    </span><span>NavMenuComponent</span><span>,</span><span>
    </span><span>HomeComponent</span><span>,</span><span>
    </span><span>CounterComponent</span><span>,</span><span>
    </span><span>FetchDataComponent</span><span>
  </span><span>],</span><span>
  imports</span><span>:</span><span> </span><span>[</span><span>
    </span><span>BrowserModule</span><span>.</span><span>withServerTransition</span><span>({</span><span> appId</span><span>:</span><span> </span><span>'ng-cli-universal'</span><span> </span><span>}),</span><span>
    </span><span>HttpClientModule</span><span>,</span><span>
    </span><span>FormsModule</span><span>,</span><span>
    </span><span>ApiAuthorizationModule</span><span>,</span><span>
    </span><span>RouterModule</span><span>.</span><span>forRoot</span><span>([</span><span>
      </span><span>{</span><span> path</span><span>:</span><span> </span><span>''</span><span>,</span><span> component</span><span>:</span><span> </span><span>HomeComponent</span><span>,</span><span> pathMatch</span><span>:</span><span> </span><span>'full'</span><span> </span><span>},</span><span>
      </span><span>{</span><span> path</span><span>:</span><span> </span><span>'counter'</span><span>,</span><span> component</span><span>:</span><span> </span><span>CounterComponent</span><span> </span><span>},</span><span>
      </span><span>{</span><span> path</span><span>:</span><span> </span><span>'fetch-data'</span><span>,</span><span> component</span><span>:</span><span> </span><span>FetchDataComponent</span><span>,</span><span> canActivate</span><span>:</span><span> </span><span>[</span><span>AuthorizeGuard</span><span>]</span><span> </span><span>},</span><span>
    </span><span>])</span><span>
  </span><span>],</span><span>
  providers</span><span>:</span><span> </span><span>[</span><span>
    </span><span>{</span><span> provide</span><span>:</span><span> HTTP_INTERCEPTORS</span><span>,</span><span> useClass</span><span>:</span><span> </span><span>AuthorizeInterceptor</span><span>,</span><span> multi</span><span>:</span><span> </span><span>true</span><span> </span><span>}</span><span>
  </span><span>],</span><span>
  bootstrap</span><span>:</span><span> </span><span>[</span><span>AppComponent</span><span>]</span><span>
</span><span>})</span><span>
</span><span>export</span><span> </span><span>class</span><span> </span><span>AppModule</span><span> </span><span>{</span><span> </span><span>}</span></code></pre>
<h3>Get more details by visiting the docs page</h3>
<p>This is a quick introduction to what our new authentication support for Single Page Applications has to offer. For more details check out the <a href="https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity-api-authorization" target="_blank">docs</a>.</p>
<h2>Endpoint Routing with SignalR Hubs</h2>
<p>In 3.0.0-preview3 we are hooking SignalR hubs into the new <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing" target="_blank">Endpoint Routing</a> feature recently released. SignalR hub wire-up was previously done explicitly:</p>
<pre><code><span>app</span><span>.</span><span>UseSignalR</span><span>(</span><span>routes </span><span>=&gt;</span><span>
</span><span>{</span><span>
    routes</span><span>.</span><span>MapHub</span><span>&lt;</span><span>ChatHub</span><span>&gt;(</span><span>"hubs/chat"</span><span>);</span><span>
</span><span>});</span></code></pre>
<p>This meant developers would need to wire up controllers, Razor pages, and hubs in a variety of different places during startup, leading to a series of nearly-identical routing segments:</p>
<pre><code><span>app</span><span>.</span><span>UseSignalR</span><span>(</span><span>routes </span><span>=&gt;</span><span>
</span><span>{</span><span>
    routes</span><span>.</span><span>MapHub</span><span>&lt;</span><span>ChatHub</span><span>&gt;(</span><span>"hubs/chat"</span><span>);</span><span>
</span><span>});</span><span>

app</span><span>.</span><span>UseRouting</span><span>(</span><span>routes </span><span>=&gt;</span><span>
</span><span>{</span><span>
    routes</span><span>.</span><span>MapRazorPages</span><span>();</span><span>
</span><span>});</span></code></pre>
<p>Now, SignalR hubs can also be routed via endpoint routing, so you’ve got a one-stop place to route nearly everything in ASP.NET Core.</p>
<pre><code><span>app</span><span>.</span><span>UseRouting</span><span>(</span><span>routes </span><span>=&gt;</span><span>
</span><span>{</span><span>
    routes</span><span>.</span><span>MapRazorPages</span><span>();</span><span>
    routes</span><span>.</span><span>MapHub</span><span>&lt;</span><span>ChatHub</span><span>&gt;(</span><span>"hubs/chat"</span><span>);</span><span>
</span><span>});</span></code></pre>
<h3>Long Polling for Java SignalR Client</h3>
<p>We added long polling support to the Java client which enables it to establish connections even in environments that do not support WebSockets. This also gives you the ability to specifically select the long polling transport in your client apps.</p>
<h2>gRPC Template</h2>
<p>This preview release introduces a new template for building gRPC services with ASP.NET Core using a new gRPC framework we are building in collaboration with Google.</p>
<p><a href="https://grpc.io/" target="_blank">gRPC</a> is a popular RPC (remote procedure call) framework that offers an opinionated contract-first approach to API development. It uses HTTP/2 for transport, Protocol Buffers as the interface description language, and provides features such as authentication, bidirectional streaming and flow control, and cancellation and timeouts.</p>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/grpc-service.png" alt="gRPC template"></p>
<p>The templates create two projects: a gRPC service hosted inside ASP.NET Core, and a console application to test it with.</p>
<p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/03/grpc-templatepng.png" alt="gRPC solution"></p>
<p>This is the first public preview of gRPC for ASP.NET Core and it doesn’t implement all of gRPC’s features, but we’re working hard to make the best gRPC experience for ASP.NET possible. Please try it out and give us feedback at <a href="https://github.com/grpc/grpc-dotnet/issues" target="_blank">grpc/grpc-dotnet</a> on GitHub.</p>
<p>Stay tuned for future blog posts discussing gRPC for ASP.NET Core in more detail.</p>
<h2>Give feedback</h2>
<p>We hope you enjoy the new features in this preview release of ASP.NET Core! Please let us know what you think by filing issues on <a href="https://github.com/aspnet/aspnetcore/issues" target="_blank">Github</a>.</p>
        
        
        
        

		        
        
        
	</div><!-- .entry-content -->
    
    </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>