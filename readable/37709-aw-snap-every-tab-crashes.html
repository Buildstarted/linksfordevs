<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Aw, snap! Every Tab&#xA0;Crashes -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Aw, snap! Every Tab&#xA0;Crashes</h1>
    <div class="entry-content"> <p>For a small number of users of Chromium-based browsers (including Chrome and the new Microsoft Edge) on Windows 10, after updating to 78.0.3875.0, every new tab crashes immediately when the browser starts.</p>
<p>You can open as many new tabs as you like, but they will all instantly crash:</p>
<p><img class="alignnone size-full wp-image-2284" src="https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=800" alt="EveryTabCrashes" srcset="https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=800 800w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=150 150w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=300 300w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=768 768w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=1024 1024w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png 1099w" sizes="(max-width: 800px) 100vw, 800px"></p>
<p>What&#x2019;s going wrong?&#xA0;This problem relates to a security/reliability improvement made to <a href="https://www.google.com/googlebooks/chrome/med_26.html">Chromium&#x2019;s sandboxing</a>. Chromium runs each of the tabs (and extensions) within locked down (&#x201C;sandboxed&#x201D;) processes:</p>
<p><img class=" size-full wp-image-2286 aligncenter" src="https://textplain.files.wordpress.com/2019/09/jail.png?w=576" alt="JAIL" srcset="https://textplain.files.wordpress.com/2019/09/jail.png 576w, https://textplain.files.wordpress.com/2019/09/jail.png?w=150 150w, https://textplain.files.wordpress.com/2019/09/jail.png?w=300 300w" sizes="(max-width: 576px) 100vw, 576px"></p>
<p>In Chrome 78, a change&#xA0;was made to prevent 3rd-party code from injecting itself into these sandboxed processes. 3rd-party code is a top source of browser reliability and performance problems, and it has been a longstanding goal for browser vendors to get this code out of the web platform engine.</p>
<p>This new feature relies on setting a Windows&#xA0;<a href="https://cs.chromium.org/chromium/src/sandbox/win/src/security_level.h?l=258&amp;rcl=ec4125c8457ad14fabca25857c5fbb06ac899cd8">Process Mitigation policy</a> that instructs the OS loader to refuse to load binaries that aren&#x2019;t signed by Microsoft. <a href="https://blogs.windows.com/msedgedev/2015/11/17/microsoft-edge-module-code-integrity/">Edge 13</a> implemented this mitigation in 2015, and the Chromium change brings parity to the new Edge 78+. Notably, Chrome&#x2019;s own DLLs aren&#x2019;t signed by Microsoft and are <a href="https://cs.chromium.org/chromium/src/chrome/browser/chrome_content_browser_client.cc?l=3696&amp;rcl=bb70610ea25529616f351fd7e104e8549fa83915">specially exempted</a> by the Chromium sandboxing code.</p>
<p>Unfortunately, the impact of this change is that the renderer is killed (<a href="https://crbug.com/990640">resulting in the &#x201C;Aw snap&#x201D; page</a>) if disallowed code attempts to load, for instance, if your antivirus software attempts to inject its DLLs into the renderer processes. For example, Symantec Endpoint Protection versions <a href="https://support.symantec.com/us/en/article.tech256047.html">before 14.2</a>&#xA0;are <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=993099">known</a> to trigger this problem.</p>
<p>If you encounter this problem, you should follow the following steps:</p>
<h3>Update any security software you have to the latest version.</h3>
<p>Other than malware, security software is the other likely cause of code being unexpectedly injected into the renderers.</p>
<h3>Temporarily disable the new protection</h3>
<p>You can temporarily launch the browser without this sandbox feature to ensure that it&#x2019;s the source of the crashes.</p>
<ol>
<li>Close all browser instances (ensure there are no hidden chrome.exe or msedge.exe processes in Task Manager)</li>
<li>Use Windows+R to launch the browser with the command line override:</li>
</ol>
<pre>msedge.exe --disable-features=RendererCodeIntegrity
chrome.exe --disable-features=RendererCodeIntegrity</pre>
<p>Ensure that the tab processes work properly when code integrity checks are disabled.</p>
<p>If so, you&#x2019;ve proven that code integrity checks are the culprit.</p>
<h4>Hunt down the culprit</h4>
<p>Visit <strong>chrome://conflicts&#xA0;</strong>to collect the full list of modules loaded into the browser process. Look for any files that are not <strong>Signed By</strong> Microsoft or Google. If you see any, they are&#xA0;<em>suspects</em>. (There will likely be a few listed as &#x201C;Shell Extension&#x201D;s; e.g. 7-Zip.dll, that do not cause this problem). You should install all updates to any of your&#xA0;<em>suspects</em> to see if it fixes the problem.</p>
<h3>Use Enterprise Policy to disable the new protection</h3>
<p>If needed, IT Adminstrators can disable the new protection using the RendererCodeIntegrity policy for&#xA0;<a href="https://cloud.google.com/docs/chrome-enterprise/policies/?policy=RendererCodeIntegrityEnabled">Chrome</a>&#xA0;and <a href="https://docs.microsoft.com/en-us/DeployEdge/microsoft-edge-policies#renderercodeintegrityenabled">Edge</a>. You should outreach to the software vendors responsible for the problematic applications and request that they update them.</p>
<h2>Other possible culprits</h2>
<p>Note that it&#x2019;s possible that you could have a PC that encounters symptoms like this (all subprocesses crash) but&#xA0;<em>not</em> a result of the new code integrity check.</p>
<p>For instance, Chrome once had <a href="https://textslashplain.com/2016/08/18/file-the-bug/">an obscure bug</a>&#xA0;in their sandboxing code that caused all sandboxes to crash depending on the state of Address Space Layout Randomization. Similarly, Chrome and Edge still&#xA0;have <a href="http://740132">an active bug</a> where all renderers crash on startup if the PC has AppLocker enabled and the browser is launched elevated (as Administrator).</p>
<p>-Eric</p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>