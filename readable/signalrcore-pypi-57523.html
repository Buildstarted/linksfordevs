<!DOCTYPE html>
<html lang="en">
<head>
    <title>
signalrcore - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="signalrcore - linksfor.dev(s)"/>
    <meta property="og:description" content="A Python SignalR Core client, with invocation auth and two way streaming. Compatible with azure / serverless functions. Also with automatic reconnect and manually reconnect."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://pypi.org/project/signalrcore/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - signalrcore</title>
<div class="readable">
        <h1>signalrcore</h1>
            <div>Reading time: 10-13 minutes</div>
        <div>Posted here: 10 Feb 2020</div>
        <p><a href="https://pypi.org/project/signalrcore/">https://pypi.org/project/signalrcore/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
            
<p><a href="https://www.paypal.me/mandrewcito/1" rel="nofollow"><img alt="Donate" src="https://warehouse-camo.ingress.cmh1.psfhosted.org/3bb22c67e9ddb1beb055a68d5707766480222b41/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446f6e6174652d50617950616c2d677265656e2e7376673f6c6f676f3d70617970616c267374796c653d666c61742d737175617265"></a>
<img alt="Pypi" src="https://warehouse-camo.ingress.cmh1.psfhosted.org/a77ce7963b363f2185183e019815330815647d8b/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f7369676e616c72636f72652e737667">
<img alt="Pypi - downloads month" src="https://warehouse-camo.ingress.cmh1.psfhosted.org/bfa0993663c34fdda76e961f9fee462c6d870686/68747470733a2f2f696d672e736869656c64732e696f2f707970692f646d2f7369676e616c72636f72652e737667">
<img alt="Issues" src="https://warehouse-camo.ingress.cmh1.psfhosted.org/4148a4c204f4ccd20b28c1da42f09c46018434e9/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732f6d616e647265776369746f2f7369676e616c72636f72652e737667">
<img alt="Open issues" src="https://warehouse-camo.ingress.cmh1.psfhosted.org/ba86c1d588ab8d7698523d7f0e4cb4e5c749a9ab/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732d7261772f6d616e647265776369746f2f7369676e616c72636f72652e737667"></p>
<p><img alt="logo alt" src="https://warehouse-camo.ingress.cmh1.psfhosted.org/6512d16cfe8929379f938cad926ca9519b6616b5/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6d616e647265776369746f2f7369676e616c72636f72652f6d61737465722f646f63732f696d672f6c6f676f5f74656d702e3132382e7376672e706e67"></p>

<ul>
<li>
<p><a href="https://dev.to/mandrewcito/singlar-core-python-client-58e7" rel="nofollow">Dev to posts with library examples and implementation</a></p>
</li>
<li>
<p><a href="https://pypi.org/project/signalrcore/" rel="nofollow">Pypy</a></p>
</li>
<li>
<p><a href="https://mandrewcito.github.io/signalrcore/" rel="nofollow">Wiki - This Doc</a></p>
</li>
</ul>

<h2>Connect to a server without auth</h2>
<pre><span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>)</span>\
    <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span>\
    <span>.</span><span>with_automatic_reconnect</span><span>({</span>
        <span>"type"</span><span>:</span> <span>"raw"</span><span>,</span>
        <span>"keep_alive_interval"</span><span>:</span> <span>10</span><span>,</span>
        <span>"reconnect_interval"</span><span>:</span> <span>5</span><span>,</span>
        <span>"max_attempts"</span><span>:</span> <span>5</span>
    <span>})</span><span>.</span><span>build</span><span>()</span>
</pre>
<h2>Connect to a server with auth</h2>
<p>login_function must provide auth token</p>
<pre><span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
            <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span>
            <span>options</span><span>=</span><span>{</span>
                <span>"access_token_factory"</span><span>:</span> <span>login_function</span><span>,</span>
                <span>"headers"</span><span>:</span> <span>{</span>
                    <span>"mycustomheader"</span><span>:</span> <span>"mycustomheadervalue"</span>
                <span>}</span>
            <span>})</span>\
            <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span>\
            <span>.</span><span>with_automatic_reconnect</span><span>({</span>
                <span>"type"</span><span>:</span> <span>"raw"</span><span>,</span>
                <span>"keep_alive_interval"</span><span>:</span> <span>10</span><span>,</span>
                <span>"reconnect_interval"</span><span>:</span> <span>5</span><span>,</span>
                <span>"max_attempts"</span><span>:</span> <span>5</span>
            <span>})</span><span>.</span><span>build</span><span>()</span>
</pre>
<h2>Configure logging</h2>
<pre><span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span>
    <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span>
    <span>...</span>
</pre>
<h2>Configure socket trace</h2>
<pre><span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span>
    <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>,</span> <span>socket_trace</span><span>=</span><span>True</span><span>)</span> 
    <span>...</span> 
</pre>
<h2>Configure your own handler</h2>
<pre><span>import</span> <span>logging</span>
<span>handler</span> <span>=</span> <span>logging</span><span>.</span><span>StreamHandler</span><span>()</span>
<span>handler</span><span>.</span><span>setLevel</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span>
<span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
   <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span> <span>options</span><span>=</span><span>{</span><span>"verify_ssl"</span><span>:</span> <span>False</span><span>})</span> \
   <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>,</span> <span>socket_trace</span><span>=</span><span>True</span><span>,</span> <span>handler</span><span>=</span><span>handler</span><span>)</span>
   <span>...</span>
</pre>
<h2>Configuring reconection</h2>
<p>After reaching max_attemps an exeption will be thrown and on_disconnect event will be
fired.</p>
<pre><span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>)</span>\
    <span>...</span>
    <span>.</span><span>build</span><span>()</span>
</pre>
<h2>Configuring aditional headers</h2>
<pre><span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
            <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span>
            <span>options</span><span>=</span><span>{</span>
                <span>"headers"</span><span>:</span> <span>{</span>
                    <span>"mycustomheader"</span><span>:</span> <span>"mycustomheadervalue"</span>
                <span>}</span>
            <span>})</span>
            <span>...</span>
            <span>.</span><span>build</span><span>()</span>
</pre>
<h2>Configuring aditional querystring parameters</h2>
<pre><span>server_url</span> <span>=</span><span>"http.... /?myquerystringparam=134&amp;foo=bar"</span>
<span>connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
            <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span>
            <span>options</span><span>=</span><span>{</span>
            <span>})</span>\
            <span>.</span><span>build</span><span>()</span>
</pre>
<h2>Congfigure skip negotiation</h2>
<pre><span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span> \
        <span>.</span><span>with_url</span><span>(</span><span>"ws://"</span><span>+</span><span>server_url</span><span>,</span> <span>options</span><span>=</span><span>{</span>
            <span>"verify_ssl"</span><span>:</span> <span>False</span><span>,</span>
            <span>"skip_negotiation"</span><span>:</span> <span>False</span><span>,</span>
            <span>"headers"</span><span>:</span> <span>{</span>
            <span>}</span>
        <span>})</span> \
        <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>,</span> <span>socket_trace</span><span>=</span><span>True</span><span>,</span> <span>handler</span><span>=</span><span>handler</span><span>)</span> \
        <span>.</span><span>build</span><span>()</span>
</pre>
<h2>Configuring ping(keep alive)</h2>
<p>keep_alive_interval sets the secconds of ping message</p>
<pre><span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>)</span>\
    <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span>\
    <span>.</span><span>with_automatic_reconnect</span><span>({</span>
        <span>"type"</span><span>:</span> <span>"raw"</span><span>,</span>
        <span>"keep_alive_interval"</span><span>:</span> <span>10</span><span>,</span>
        <span>"reconnect_interval"</span><span>:</span> <span>5</span><span>,</span>
        <span>"max_attempts"</span><span>:</span> <span>5</span>
    <span>})</span><span>.</span><span>build</span><span>()</span>
</pre>
<h2>Configuring logging</h2>
<pre><span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>)</span>\
    <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span>\
    <span>.</span><span>with_automatic_reconnect</span><span>({</span>
        <span>"type"</span><span>:</span> <span>"raw"</span><span>,</span>
        <span>"keep_alive_interval"</span><span>:</span> <span>10</span><span>,</span>
        <span>"reconnect_interval"</span><span>:</span> <span>5</span><span>,</span>
        <span>"max_attempts"</span><span>:</span> <span>5</span>
    <span>})</span><span>.</span><span>build</span><span>()</span>
</pre>
<h2>Events</h2>
<h3>On connect / On disconnect</h3>
<p>on_open - fires when connection is openned and ready to send messages
on_close - fires when connection is closed</p>
<pre><span>hub_connection</span><span>.</span><span>on_open</span><span>(</span><span>lambda</span><span>:</span> <span>print</span><span>(</span><span>"connection opened and handshake received ready to send messages"</span><span>))</span>
<span>hub_connection</span><span>.</span><span>on_close</span><span>(</span><span>lambda</span><span>:</span> <span>print</span><span>(</span><span>"connection closed"</span><span>))</span>
</pre>
<h3>Register an operation</h3>
<p>ReceiveMessage - signalr method
print - function that has as parameters args of signalr method</p>
<pre><span>hub_connection</span><span>.</span><span>on</span><span>(</span><span>"ReceiveMessage"</span><span>,</span> <span>print</span><span>)</span>
</pre>
<h2>Sending messages</h2>
<p>SendMessage - signalr method
username, message - parameters of signalrmethod</p>
<pre>    <span>hub_connection</span><span>.</span><span>send</span><span>(</span><span>"SendMessage"</span><span>,</span> <span>[</span><span>username</span><span>,</span> <span>message</span><span>])</span>
</pre>
<h2>Requesting streaming (Server to client)</h2>
<pre><span>hub_connection</span><span>.</span><span>stream</span><span>(</span>
            <span>"Counter"</span><span>,</span>
            <span>[</span><span>len</span><span>(</span><span>self</span><span>.</span><span>items</span><span>),</span> <span>500</span><span>])</span><span>.</span><span>subscribe</span><span>({</span>
                <span>"next"</span><span>:</span> <span>self</span><span>.</span><span>on_next</span><span>,</span>
                <span>"complete"</span><span>:</span> <span>self</span><span>.</span><span>on_complete</span><span>,</span>
                <span>"error"</span><span>:</span> <span>self</span><span>.</span><span>on_error</span>
            <span>})</span>
</pre>
<h2>Client side Streaming</h2>
<pre><span>from</span> <span>signalrcore.subject</span> <span>import</span>  <span>Subject</span>

<span>subject</span> <span>=</span> <span>Subject</span><span>()</span>

<span># Start Streaming</span>
<span>hub_connection</span><span>.</span><span>send</span><span>(</span><span>"UploadStream"</span><span>,</span> <span>subject</span><span>)</span>

<span># Each iteration</span>
<span>subject</span><span>.</span><span>next</span><span>(</span><span>str</span><span>(</span><span>iteration</span><span>))</span>

<span># End streaming</span>
<span>subject</span><span>.</span><span>complete</span><span>()</span>
</pre>

<p>Using package from <a href="https://codeload.github.com/aspnet/Docs/zip/master" rel="nofollow">aspnet core - SignalRChat</a>
example chat without auth</p>
<pre><span>from</span> <span>signalrcore.hub_connection_builder</span> <span>import</span> <span>HubConnectionBuilder</span>


<span>def</span> <span>input_with_default</span><span>(</span><span>input_text</span><span>,</span> <span>default_value</span><span>):</span>
    <span>value</span> <span>=</span> <span>input</span><span>(</span><span>input_text</span><span>.</span><span>format</span><span>(</span><span>default_value</span><span>))</span>
    <span>return</span> <span>default_value</span> <span>if</span> <span>value</span> <span>is</span> <span>None</span> <span>or</span> <span>value</span><span>.</span><span>strip</span><span>()</span> <span>==</span> <span>""</span> <span>else</span> <span>value</span>


<span>server_url</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your server url(default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"ws://localhost:62342/chathub"</span><span>)</span>
<span>username</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your username (default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"mandrewcito"</span><span>)</span>

<span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span><span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>)</span><span>.</span><span>with_automatic_reconnect</span><span>({</span>
        <span>"type"</span><span>:</span> <span>"raw"</span><span>,</span>
        <span>"keep_alive_interval"</span><span>:</span> <span>10</span><span>,</span>
        <span>"reconnect_interval"</span><span>:</span> <span>5</span><span>,</span>
        <span>"max_attempts"</span><span>:</span> <span>5</span>
    <span>})</span><span>.</span><span>build</span><span>()</span>
<span>hub_connection</span><span>.</span><span>on</span><span>(</span><span>"ReceiveMessage"</span><span>,</span> <span>print</span><span>)</span>
<span>hub_connection</span><span>.</span><span>start</span><span>()</span>
<span>message</span> <span>=</span> <span>None</span>
<span># Do login</span>

<span>while</span> <span>message</span> <span>!=</span> <span>"exit()"</span><span>:</span>
    <span>message</span> <span>=</span> <span>input</span><span>(</span><span>"&gt;&gt; "</span><span>)</span>
    <span>if</span> <span>message</span> <span>is</span> <span>not</span> <span>None</span> <span>and</span> <span>message</span> <span>is</span> <span>not</span> <span>""</span> <span>and</span> <span>message</span> <span>is</span> <span>not</span> <span>"exit()"</span><span>:</span>
        <span>hub_connection</span><span>.</span><span>send</span><span>(</span><span>"SendMessage"</span><span>,</span> <span>[</span><span>username</span><span>,</span> <span>message</span><span>])</span>
<span>hub_connection</span><span>.</span><span>stop</span><span>()</span>
</pre>
<p>Using package from <a href="https://codeload.github.com/aspnet/Docs/zip/master" rel="nofollow">aspnet core - SignalRAuthenticationSample</a> ,</p>

<pre><span>import</span> <span>requests</span>
<span>from</span> <span>signalrcore.hub_connection_builder</span> <span>import</span> <span>HubConnectionBuilder</span>


<span>def</span> <span>input_with_default</span><span>(</span><span>input_text</span><span>,</span> <span>default_value</span><span>):</span>
    <span>value</span> <span>=</span> <span>input</span><span>(</span><span>input_text</span><span>.</span><span>format</span><span>(</span><span>default_value</span><span>))</span>
    <span>return</span> <span>default_value</span> <span>if</span> <span>value</span> <span>is</span> <span>None</span> <span>or</span> <span>value</span><span>.</span><span>strip</span><span>()</span> <span>==</span> <span>""</span> <span>else</span> <span>value</span>


<span>def</span> <span>signalr_core_example_login</span><span>(</span><span>url</span><span>,</span> <span>user</span><span>,</span> <span>username_password</span><span>):</span>
    <span>response</span> <span>=</span> <span>requests</span><span>.</span><span>post</span><span>(</span><span>url</span><span>,</span> <span>data</span><span>=</span><span>{</span><span>"email"</span><span>:</span> <span>user</span><span>,</span> <span>"password"</span><span>:</span> <span>username_password</span><span>})</span>
    <span>return</span> <span>response</span><span>.</span><span>json</span><span>()[</span><span>"token"</span><span>]</span>


<span>login_url</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your server login url(</span><span>{0}</span><span>):'</span><span>,</span> <span>"http://localhost:50746/account/token"</span><span>)</span>
<span>server_url</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your server url(default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"ws://localhost:50746/hubs/chat"</span><span>)</span>
<span>username</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your username (default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"mandrewcito@mandrewcito.com"</span><span>)</span>
<span>password</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your password (default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"Abc123.--123?"</span><span>)</span>

<span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span> <span>options</span><span>=</span><span>{</span>
        <span>"access_token_factory"</span><span>:</span> <span>lambda</span><span>:</span> <span>signalr_core_example_login</span><span>(</span><span>login_url</span><span>,</span> <span>username</span><span>,</span> <span>password</span><span>)</span>
    <span>})</span><span>.</span><span>with_automatic_reconnect</span><span>({</span>
        <span>"type"</span><span>:</span> <span>"interval"</span><span>,</span>
        <span>"keep_alive_interval"</span><span>:</span> <span>10</span><span>,</span>
        <span>"intervals"</span><span>:</span> <span>[</span><span>1</span><span>,</span> <span>3</span><span>,</span> <span>5</span><span>,</span> <span>6</span><span>,</span> <span>7</span><span>,</span> <span>87</span><span>,</span> <span>3</span><span>]</span>
    <span>})</span>\
    <span>.</span><span>build</span><span>()</span>

<span>hub_connection</span><span>.</span><span>on</span><span>(</span><span>"ReceiveSystemMessage"</span><span>,</span> <span>print</span><span>)</span>
<span>hub_connection</span><span>.</span><span>on</span><span>(</span><span>"ReceiveChatMessage"</span><span>,</span> <span>print</span><span>)</span>
<span>hub_connection</span><span>.</span><span>on</span><span>(</span><span>"ReceiveDirectMessage"</span><span>,</span> <span>print</span><span>)</span>
<span>hub_connection</span><span>.</span><span>start</span><span>()</span>
<span>message</span> <span>=</span> <span>None</span>
<span>while</span> <span>message</span> <span>!=</span> <span>"exit()"</span><span>:</span>
    <span>message</span> <span>=</span> <span>input</span><span>(</span><span>"&gt;&gt; "</span><span>)</span>
    <span>if</span> <span>message</span> <span>is</span> <span>not</span> <span>None</span> <span>and</span> <span>message</span> <span>is</span> <span>not</span> <span>""</span> <span>and</span> <span>message</span> <span>is</span> <span>not</span> <span>"exit()"</span><span>:</span>
        <span>hub_connection</span><span>.</span><span>send</span><span>(</span><span>"Send"</span><span>,</span> <span>[</span><span>message</span><span>])</span>
<span>hub_connection</span><span>.</span><span>stop</span><span>()</span>
</pre>

<p>Using package from <a href="https://codeload.github.com/aspnet/Docs/zip/master" rel="nofollow">aspnet core - SignalRStreaming</a> ,</p>
<pre><span>import</span> <span>time</span>
<span>import</span> <span>sys</span>
<span>from</span> <span>signalrcore.hub_connection_builder</span> <span>import</span> <span>HubConnectionBuilder</span>


<span>def</span> <span>input_with_default</span><span>(</span><span>input_text</span><span>,</span> <span>default_value</span><span>):</span>
    <span>value</span> <span>=</span> <span>input</span><span>(</span><span>input_text</span><span>.</span><span>format</span><span>(</span><span>default_value</span><span>))</span>
    <span>return</span> <span>default_value</span> <span>if</span> <span>value</span> <span>is</span> <span>None</span> <span>or</span> <span>value</span><span>.</span><span>strip</span><span>()</span> <span>==</span> <span>""</span> <span>else</span> <span>value</span>


<span>server_url</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your server url(default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"ws://localhost:57957/streamHub"</span><span>)</span>

<span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span><span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>)</span><span>.</span><span>build</span><span>()</span>
<span>hub_connection</span><span>.</span><span>start</span><span>()</span>
<span>time</span><span>.</span><span>sleep</span><span>(</span><span>10</span><span>)</span>


<span>def</span> <span>bye</span><span>(</span><span>error</span><span>,</span> <span>x</span><span>):</span>
    <span>if</span> <span>error</span><span>:</span>
        <span>print</span><span>(</span><span>"error </span><span>{0}</span><span>"</span><span>.</span><span>format</span><span>(</span><span>x</span><span>))</span>
    <span>else</span><span>:</span>
        <span>print</span><span>(</span><span>"complete! "</span><span>)</span>
    <span>global</span> <span>hub_connection</span>
    <span>hub_connection</span><span>.</span><span>stop</span><span>()</span>
    <span>sys</span><span>.</span><span>exit</span><span>(</span><span>0</span><span>)</span>


<span>hub_connection</span><span>.</span><span>stream</span><span>(</span>
    <span>"Counter"</span><span>,</span>
    <span>[</span><span>10</span><span>,</span> <span>500</span><span>])</span><span>.</span><span>subscribe</span><span>({</span>
        <span>"next"</span><span>:</span> <span>lambda</span> <span>x</span><span>:</span> <span>print</span><span>(</span><span>"next callback: "</span><span>,</span> <span>x</span><span>),</span>
        <span>"complete"</span><span>:</span> <span>lambda</span> <span>x</span><span>:</span> <span>bye</span><span>(</span><span>False</span><span>,</span> <span>x</span><span>),</span>
        <span>"error"</span><span>:</span> <span>lambda</span> <span>x</span><span>:</span> <span>bye</span><span>(</span><span>True</span><span>,</span> <span>x</span><span>)</span>
    <span>})</span>
</pre>

<p>Using package from <a href="https://docs.microsoft.com/es-es/aspnet/core/signalr/streaming?view=aspnetcore-3.1" rel="nofollow">aspnet core - SignalRStreaming</a> ,</p>
<pre><span>from</span> <span>signalrcore.hub_connection_builder</span> <span>import</span> <span>HubConnectionBuilder</span>
<span>from</span> <span>signalrcore.subject</span> <span>import</span> <span>Subject</span>


<span>def</span> <span>input_with_default</span><span>(</span><span>input_text</span><span>,</span> <span>default_value</span><span>):</span>
    <span>value</span> <span>=</span> <span>input</span><span>(</span><span>input_text</span><span>.</span><span>format</span><span>(</span><span>default_value</span><span>))</span>
    <span>return</span> <span>default_value</span> <span>if</span> <span>value</span> <span>is</span> <span>None</span> <span>or</span> <span>value</span><span>.</span><span>strip</span><span>()</span> <span>==</span> <span>""</span> <span>else</span> <span>value</span>


<span>server_url</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your server url(default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"wss://localhost:44376/chatHub"</span><span>)</span>

<span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span>\
    <span>.</span><span>with_url</span><span>(</span><span>server_url</span><span>,</span> <span>options</span><span>=</span><span>{</span><span>"verify_ssl"</span><span>:</span> <span>False</span><span>})</span> \
    <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span> \
    <span>.</span><span>with_automatic_reconnect</span><span>({</span>
            <span>"type"</span><span>:</span> <span>"interval"</span><span>,</span>
            <span>"keep_alive_interval"</span><span>:</span> <span>10</span><span>,</span>
            <span>"intervals"</span><span>:</span> <span>[</span><span>1</span><span>,</span> <span>3</span><span>,</span> <span>5</span><span>,</span> <span>6</span><span>,</span> <span>7</span><span>,</span> <span>87</span><span>,</span> <span>3</span><span>]</span>
        <span>})</span>\
    <span>.</span><span>build</span><span>()</span>
<span>hub_connection</span><span>.</span><span>start</span><span>()</span>
<span>time</span><span>.</span><span>sleep</span><span>(</span><span>10</span><span>)</span>


<span>def</span> <span>bye</span><span>(</span><span>error</span><span>,</span> <span>x</span><span>):</span>
    <span>if</span> <span>error</span><span>:</span>
        <span>print</span><span>(</span><span>"error </span><span>{0}</span><span>"</span><span>.</span><span>format</span><span>(</span><span>x</span><span>))</span>
    <span>else</span><span>:</span>
        <span>print</span><span>(</span><span>"complete! "</span><span>)</span>
    <span>global</span> <span>hub_connection</span>
    <span>hub_connection</span><span>.</span><span>stop</span><span>()</span>
    <span>sys</span><span>.</span><span>exit</span><span>(</span><span>0</span><span>)</span>


<span>iteration</span> <span>=</span> <span>0</span>
<span>subject</span> <span>=</span> <span>Subject</span><span>()</span>


<span>def</span> <span>interval_handle</span><span>():</span>
    <span>global</span> <span>iteration</span>
    <span>iteration</span> <span>+=</span> <span>1</span>
    <span>subject</span><span>.</span><span>next</span><span>(</span><span>str</span><span>(</span><span>iteration</span><span>))</span>
    <span>if</span> <span>iteration</span> <span>==</span> <span>10</span><span>:</span>
        <span>subject</span><span>.</span><span>complete</span><span>()</span>


<span>hub_connection</span><span>.</span><span>send</span><span>(</span><span>"UploadStream"</span><span>,</span> <span>subject</span><span>)</span>

<span>while</span> <span>iteration</span> <span>!=</span> <span>10</span><span>:</span>
    <span>interval_handle</span><span>()</span>
    <span>time</span><span>.</span><span>sleep</span><span>(</span><span>0.5</span><span>)</span>
</pre>

<p>Using this <a href="https://docs.microsoft.com/es-es/azure/azure-signalr/signalr-quickstart-azure-functions-javascript?WT.mc_id=signalrquickstart-github-antchu" rel="nofollow">example</a> ,</p>
<pre><span>import</span> <span>logging</span>
<span>import</span> <span>sys</span>
<span>import</span> <span>requests</span>
<span>from</span> <span>signalrcore.hub_connection_builder</span> <span>import</span> <span>HubConnectionBuilder</span>


<span>def</span> <span>input_with_default</span><span>(</span><span>input_text</span><span>,</span> <span>default_value</span><span>):</span>
    <span>value</span> <span>=</span> <span>input</span><span>(</span><span>input_text</span><span>.</span><span>format</span><span>(</span><span>default_value</span><span>))</span>
    <span>return</span> <span>default_value</span> <span>if</span> <span>value</span> <span>is</span> <span>None</span> <span>or</span> <span>value</span><span>.</span><span>strip</span><span>()</span> <span>==</span> <span>""</span> <span>else</span> <span>value</span>


<span>server_url</span> <span>=</span> <span>input_with_default</span><span>(</span>
    <span>'Enter your server url(default: </span><span>{0}</span><span>): '</span><span>,</span>
    <span>"localhost:7071/api"</span><span>)</span>
<span>username</span> <span>=</span> <span>input_with_default</span><span>(</span><span>'Enter your username (default: </span><span>{0}</span><span>): '</span><span>,</span> <span>"mandrewcito"</span><span>)</span>
<span>handler</span> <span>=</span> <span>logging</span><span>.</span><span>StreamHandler</span><span>()</span>
<span>handler</span><span>.</span><span>setLevel</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>)</span>
<span>formatter</span> <span>=</span> <span>logging</span><span>.</span><span>Formatter</span><span>(</span><span>'</span><span>%(asctime)s</span><span> - </span><span>%(name)s</span><span> - </span><span>%(levelname)s</span><span> - </span><span>%(message)s</span><span>'</span><span>)</span>
<span>handler</span><span>.</span><span>setFormatter</span><span>(</span><span>formatter</span><span>)</span>
<span>hub_connection</span> <span>=</span> <span>HubConnectionBuilder</span><span>()</span> \
        <span>.</span><span>with_url</span><span>(</span><span>"ws://"</span><span>+</span><span>server_url</span><span>,</span> <span>options</span><span>=</span><span>{</span>
            <span>"verify_ssl"</span><span>:</span> <span>False</span><span>,</span>
            <span>"skip_negotiation"</span><span>:</span> <span>False</span><span>,</span>
            <span>"headers"</span><span>:</span> <span>{</span>
            <span>}</span>
        <span>})</span> \
        <span>.</span><span>configure_logging</span><span>(</span><span>logging</span><span>.</span><span>DEBUG</span><span>,</span> <span>socket_trace</span><span>=</span><span>True</span><span>,</span> <span>handler</span><span>=</span><span>handler</span><span>)</span> \
        <span>.</span><span>build</span><span>()</span>

<span>hub_connection</span><span>.</span><span>on_open</span><span>(</span><span>lambda</span><span>:</span> <span>print</span><span>(</span><span>"connection opened and handshake received ready to send messages"</span><span>))</span>
<span>hub_connection</span><span>.</span><span>on_close</span><span>(</span><span>lambda</span><span>:</span> <span>print</span><span>(</span><span>"connection closed"</span><span>))</span>

<span>hub_connection</span><span>.</span><span>on</span><span>(</span><span>"newMessage"</span><span>,</span> <span>print</span><span>)</span>
<span>hub_connection</span><span>.</span><span>start</span><span>()</span>
<span>message</span> <span>=</span> <span>None</span>

<span># Do login</span>

<span>while</span> <span>message</span> <span>!=</span> <span>"exit()"</span><span>:</span>
    <span>message</span> <span>=</span> <span>input</span><span>(</span><span>"&gt;&gt; "</span><span>)</span>
    <span>if</span> <span>message</span> <span>is</span> <span>not</span> <span>None</span> <span>and</span> <span>message</span> <span>is</span> <span>not</span> <span>""</span> <span>and</span> <span>message</span> <span>is</span> <span>not</span> <span>"exit()"</span><span>:</span>
        <span># hub_connection.send("sendMessage", [username, message])</span>
        <span>requests</span><span>.</span><span>post</span><span>(</span><span>"http://localhost:7071/api/messages"</span><span>,</span> <span>json</span><span>=</span><span>{</span><span>"sender"</span><span>:</span> <span>username</span><span>,</span> <span>"text"</span><span>:</span> <span>message</span><span>})</span>

<span>hub_connection</span><span>.</span><span>stop</span><span>()</span>

<span>sys</span><span>.</span><span>exit</span><span>(</span><span>0</span><span>)</span>
</pre>

          </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>