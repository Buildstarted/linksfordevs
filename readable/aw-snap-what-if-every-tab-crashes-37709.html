<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Aw, snap! What if Every Tab Crashes? - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Aw, snap! What if Every Tab Crashes? - linksfor.dev(s)"/>
    <meta property="article:author" content="About ericlaw"/>
    <meta property="og:description" content="For a small number of users of Chromium-based browsers (including Chrome and the new Microsoft Edge) on Windows 10, after updating to 78.0.3875.0, every new tab crashes immediately when the browser&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://textslashplain.com/2019/09/27/aw-snap-every-tab-crashes/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Aw, snap! What if Every Tab Crashes?</title>
<div class="readable">
        <h1>Aw, snap! What if Every Tab Crashes?</h1>
            <div>by About ericlaw</div>
            <div>Reading time: 4-5 minutes</div>
        <div>Posted here: 27 Sep 2019</div>
        <p><a href="https://textslashplain.com/2019/09/27/aw-snap-every-tab-crashes/">https://textslashplain.com/2019/09/27/aw-snap-every-tab-crashes/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>

		
	<div>

		<p>For a small number of users of Chromium-based browsers (including Chrome and the new Microsoft Edge) on Windows 10, after updating to 78.0.3875.0, every new tab crashes immediately when the browser starts.</p>
<p>Impacted users can open as many new tabs as they like, but each will instantly crash:</p>
<p><img data-attachment-id="2284" data-permalink="https://textslashplain.com/2019/09/27/aw-snap-every-tab-crashes/everytabcrashes/" data-orig-file="https://textplain.files.wordpress.com/2019/09/everytabcrashes.png" data-orig-size="1099,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EveryTabCrashes" data-image-description="" data-medium-file="https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=300" data-large-file="https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=800" title="Chrome crashed tab page" src="https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=800" alt="EveryTabCrashes" srcset="https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=800 800w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=150 150w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=300 300w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=768 768w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png?w=1024 1024w, https://textplain.files.wordpress.com/2019/09/everytabcrashes.png 1099w" sizes="(max-width: 800px) 100vw, 800px"></p>
<p><img data-attachment-id="2345" data-permalink="https://textslashplain.com/2019/09/27/aw-snap-every-tab-crashes/edgehavingaproblem-2/" data-orig-file="https://textplain.files.wordpress.com/2019/09/edgehavingaproblem-1.png" data-orig-size="467,358" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="EdgeHavingAProblem" data-image-description="" data-medium-file="https://textplain.files.wordpress.com/2019/09/edgehavingaproblem-1.png?w=300" data-large-file="https://textplain.files.wordpress.com/2019/09/edgehavingaproblem-1.png?w=467" title="Edge crashed tab page" src="https://textplain.files.wordpress.com/2019/09/edgehavingaproblem-1.png?w=800" alt="EdgeHavingAProblem" srcset="https://textplain.files.wordpress.com/2019/09/edgehavingaproblem-1.png 467w, https://textplain.files.wordpress.com/2019/09/edgehavingaproblem-1.png?w=150 150w, https://textplain.files.wordpress.com/2019/09/edgehavingaproblem-1.png?w=300 300w" sizes="(max-width: 467px) 100vw, 467px"></p>
<p>As of <a href="https://chromium-review.googlesource.com/c/chromium/src/+/1947360">Chrome 81.0.3992</a>, the page will<em>&nbsp;</em>show the string <strong>Error Code: STATUS_INVALID_IMAGE_HASH</strong>.</p>
<p>What’s going wrong?</p>
<p>This problem relates to a security/reliability improvement made to <a href="https://www.google.com/googlebooks/chrome/med_26.html">Chromium’s sandboxing</a>. Chromium runs each of the tabs (and extensions) within locked down (“sandboxed”) processes:</p>
<p><img data-attachment-id="2286" data-permalink="https://textslashplain.com/2019/09/27/aw-snap-every-tab-crashes/jail/" data-orig-file="https://textplain.files.wordpress.com/2019/09/jail.png" data-orig-size="576,402" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="JAIL" data-image-description="" data-medium-file="https://textplain.files.wordpress.com/2019/09/jail.png?w=300" data-large-file="https://textplain.files.wordpress.com/2019/09/jail.png?w=576" src="https://textplain.files.wordpress.com/2019/09/jail.png?w=800" alt="JAIL" srcset="https://textplain.files.wordpress.com/2019/09/jail.png 576w, https://textplain.files.wordpress.com/2019/09/jail.png?w=150 150w, https://textplain.files.wordpress.com/2019/09/jail.png?w=300 300w" sizes="(max-width: 576px) 100vw, 576px"></p>
<p>In Chrome 78, a change&nbsp;was made to prevent 3rd-party code from injecting itself into these sandboxed processes. 3rd-party code is a top source of browser reliability and performance problems, and it has been a longstanding goal for browser vendors to get this code out of the web platform engine.</p>
<p>This new feature relies on setting a <strong>Windows 10</strong>&nbsp;<a href="https://cs.chromium.org/chromium/src/sandbox/win/src/security_level.h?l=258&amp;rcl=ec4125c8457ad14fabca25857c5fbb06ac899cd8">Process Mitigation policy</a> that instructs the OS loader to refuse to load binaries that aren’t signed by Microsoft. <a href="https://blogs.windows.com/msedgedev/2015/11/17/microsoft-edge-module-code-integrity/">Edge 13</a>&nbsp;enabled this mitigation in 2015, and the Chromium change brings parity to the new Edge 78+. Notably, Chrome’s own DLLs aren’t signed by Microsoft so they are <a href="https://cs.chromium.org/chromium/src/chrome/browser/chrome_content_browser_client.cc?l=3696&amp;rcl=bb70610ea25529616f351fd7e104e8549fa83915">specially exempted</a> by the Chromium sandboxing code.</p>
<p>Unfortunately, the impact of this change is that the renderer is killed (<a href="https://crbug.com/990640">resulting in the “Aw snap” page</a>) if any disallowed DLL attempts to load, for instance, if your antivirus software attempts to inject its DLLs into the renderer processes. For example, Symantec Endpoint Protection versions <a href="https://support.symantec.com/us/en/article.tech256047.html">before 14.2</a>&nbsp;are <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=993099">known</a> to trigger this problem.</p>
<p>If you encounter this problem, you should follow the following steps:</p>
<h3>Update any security software you have to the latest version.</h3>
<p>Other than malware, security software is the other likely cause of code being unexpectedly injected into the renderers.</p>
<h3>Temporarily disable the new protection</h3>
<p>You can temporarily launch the browser without this sandbox feature to verify that it’s the source of the crashes.</p>
<ol>
<li>Close all browser instances (verify that there are no hidden chrome.exe or msedge.exe processes using Task Manager)</li>
<li>Use Windows+R to launch the browser with the command line override:</li>
</ol>
<pre>msedge.exe --disable-features=RendererCodeIntegrity</pre>
<p>or</p>
<pre>chrome.exe --disable-features=RendererCodeIntegrity</pre>
<p>Ensure that the tab processes work properly when code integrity checks are disabled.</p>
<p>If so, you’ve proven that code integrity checks are causing the crashes.</p>
<h4>Hunt down the culprit</h4>
<p>Visit <strong>chrome://conflicts#R&nbsp;</strong>to show the list of modules loaded by the client. Look for any files that are not <strong>Signed By</strong> Microsoft or Google.</p>
<p>If you see any, they are&nbsp;<em>suspects</em>. (There will likely be a few listed as “Shell Extension”s; e.g. 7-Zip.dll, that <em>do not</em> cause this problem)– check for an <b>R</b> in the <b>Process types</b> column to find modules loading in the Renderers.</p>
<p>You should install any available updates for any of your&nbsp;<em>suspects</em> to see if doing so fixes the problem.</p>
<h4>Check the Event Log</h4>
<p>The Windows Event Log will contain information about modules denied loading. Open <strong>Event Viewer</strong>. Expand <strong>Applications and Services Logs</strong> &gt; <strong>Microsoft</strong> &gt; <strong>Windows</strong> &gt; <strong>CodeIntegrity</strong> &gt; <strong>Operational</strong> and look for events with ID <strong>3033</strong>. The detail information will indicate the name and location of the DLL that caused the crash:<img data-attachment-id="2448" data-permalink="https://textslashplain.com/2019/09/27/aw-snap-every-tab-crashes/codeintegrity/" data-orig-file="https://textplain.files.wordpress.com/2019/09/codeintegrity.png" data-orig-size="819,330" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CodeIntegrity" data-image-description="" data-medium-file="https://textplain.files.wordpress.com/2019/09/codeintegrity.png?w=300" data-large-file="https://textplain.files.wordpress.com/2019/09/codeintegrity.png?w=800" src="https://textplain.files.wordpress.com/2019/09/codeintegrity.png?w=800" alt="CodeIntegrity" srcset="https://textplain.files.wordpress.com/2019/09/codeintegrity.png?w=800 800w, https://textplain.files.wordpress.com/2019/09/codeintegrity.png?w=150 150w, https://textplain.files.wordpress.com/2019/09/codeintegrity.png?w=300 300w, https://textplain.files.wordpress.com/2019/09/codeintegrity.png?w=768 768w, https://textplain.files.wordpress.com/2019/09/codeintegrity.png 819w" sizes="(max-width: 800px) 100vw, 800px"></p>
<h3>Optional: Use Enterprise Policy to disable the new protection</h3>
<p>If needed, IT Adminstrators can disable the new protection using the RendererCodeIntegrity policy for&nbsp;<a href="https://cloud.google.com/docs/chrome-enterprise/policies/?policy=RendererCodeIntegrityEnabled">Chrome</a>&nbsp;and <a href="https://docs.microsoft.com/en-us/DeployEdge/microsoft-edge-policies#renderercodeintegrityenabled">Edge</a>. You should outreach to the software vendors responsible for the problematic applications and request that they update them.</p>
<h2>Other possible causes</h2>
<p>Note that it’s possible that you could have a PC that encounters symptoms like this (all subprocesses crash) but&nbsp;<em>not</em> a result of the new code integrity check. In such cases, the Error Code on the crash page will be something&nbsp;<em>other&nbsp;</em>than STATUS_INVALID_IMAGE_HASH.</p>
<ul>
<li>For instance, Chromium once had <a href="https://textslashplain.com/2016/08/18/file-the-bug/">an obscure bug</a>&nbsp;in its sandboxing code that caused all sandboxes to crash depending on the random memory mapping of Address Space Layout Randomization.</li>
<li>Similarly, Chrome and Edge still&nbsp;have <a href="https://crbug.com/740132">an active bug</a> where all renderers crash on startup if the PC has AppLocker enabled and the browser is launched elevated (as Administrator).</li>
</ul>
<p>-Eric</p>

		
	</div><!--.entry-content-->

	
	
<!-- #comments -->

		</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>