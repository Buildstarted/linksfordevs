<!DOCTYPE html>
<html lang="en">
<head>
    <title>
libreoffice/core - main, development code repository -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>libreoffice/core - main, development code repository</h1>
    <td><p class="hunk">@@ -619,7 +619,6 @@ OfaViewTabPage::OfaViewTabPage(vcl::Window* pParent, const SfxItemSet&amp; rSet)</p><p class="ctx"> , mpDrawinglayerOpt(new SvtOptionsDrawinglayer)</p><p class="ctx"> , mpOpenGLConfig(new svt::OpenGLCfg)</p><p class="ctx"> {</p><p class="del">- get(m_pWindowSizeMF, &quot;windowsize&quot;);</p><p class="ctx"> get(m_pIconSizeLB, &quot;iconsize&quot;);</p><p class="ctx"> get(m_pSidebarIconSizeLB, &quot;sidebariconsize&quot;);</p><p class="ctx"> get(m_pIconStyleLB, &quot;iconstyle&quot;);</p><p class="hunk">@@ -701,7 +700,6 @@ void OfaViewTabPage::dispose()</p><p class="ctx"> pCanvasSettings = nullptr;</p><p class="ctx"> delete pAppearanceCfg;</p><p class="ctx"> pAppearanceCfg = nullptr;</p><p class="del">- m_pWindowSizeMF.clear();</p><p class="ctx"> m_pIconSizeLB.clear();</p><p class="ctx"> m_pSidebarIconSizeLB.clear();</p><p class="ctx"> m_pIconStyleLB.clear();</p><p class="hunk">@@ -795,17 +793,6 @@ bool OfaViewTabPage::FillItemSet( SfxItemSet* )</p><p class="ctx"> bool bAppearanceChanged = false;</p><p class="del">-</p><p class="del">- // Screen Scaling</p><p class="del">- sal_uInt16 nOldScale = pAppearanceCfg-&gt;GetScaleFactor();</p><p class="del">- sal_uInt16 nNewScale = (sal_uInt16)m_pWindowSizeMF-&gt;GetValue();</p><p class="del">-</p><p class="del">- if ( nNewScale != nOldScale )</p><p class="del">- {</p><p class="del">- pAppearanceCfg-&gt;SetScaleFactor(nNewScale);</p><p class="del">- bAppearanceChanged = true;</p><p class="del">- }</p><p class="del">-</p><p class="ctx"> // Mouse Snap Mode</p><p class="ctx"> SnapType eOldSnap = pAppearanceCfg-&gt;GetSnapMode();</p><p class="ctx"> SnapType eNewSnap = (SnapType)m_pMousePosLB-&gt;GetSelectEntryPos();</p><p class="hunk">@@ -941,8 +928,6 @@ void OfaViewTabPage::Reset( const SfxItemSet* )</p><p class="ctx"> m_pIconStyleLB-&gt;SelectEntryPos( nStyleLB_InitialSelection );</p><p class="ctx"> m_pIconStyleLB-&gt;SaveValue();</p><p class="del">- // Screen Scaling</p><p class="del">- m_pWindowSizeMF-&gt;SetValue ( pAppearanceCfg-&gt;GetScaleFactor() );</p><p class="ctx"> // Mouse Snap</p><p class="ctx"> m_pMousePosLB-&gt;SelectEntryPos((sal_Int32)pAppearanceCfg-&gt;GetSnapMode());</p><p class="ctx"> m_pMousePosLB-&gt;SaveValue();</p><p class="hunk">@@ -79,7 +79,6 @@ class SvtTabAppearanceCfg;</p><p class="ctx"> class OfaViewTabPage : public SfxTabPage</p><p class="ctx"> {</p><p class="ctx"> private:</p><p class="del">- VclPtr&lt;MetricField&gt; m_pWindowSizeMF;</p><p class="ctx"> VclPtr&lt;ListBox&gt; m_pIconSizeLB;</p><p class="ctx"> VclPtr&lt;ListBox&gt; m_pSidebarIconSizeLB;</p><p class="ctx"> VclPtr&lt;ListBox&gt; m_pIconStyleLB;</p><p class="hunk">@@ -1,5 +1,5 @@</p><p class="ctx"> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</p><p class="del">-&lt;!-- Generated with glade 3.19.0 --&gt;</p><p class="add">+&lt;!-- Generated with glade 3.20.0 --&gt;</p><p class="ctx"> &lt;interface&gt;</p><p class="ctx"> &lt;requires lib=&quot;gtk+&quot; version=&quot;3.0&quot;/&gt;</p><p class="ctx"> &lt;object class=&quot;GtkAdjustment&quot; id=&quot;adjustment1&quot;&gt;</p><p class="hunk">@@ -306,33 +306,6 @@</p><p class="ctx"> &lt;property name=&quot;row_spacing&quot;&gt;6&lt;/property&gt;</p><p class="ctx"> &lt;property name=&quot;column_spacing&quot;&gt;12&lt;/property&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="del">- &lt;object class=&quot;GtkLabel&quot; id=&quot;label7&quot;&gt;</p><p class="del">- &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;can_focus&quot;&gt;False&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;halign&quot;&gt;end&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Sc_aling:&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;mnemonic_widget&quot;&gt;windowsize:0%&lt;/property&gt;</p><p class="del">- &lt;/object&gt;</p><p class="del">- &lt;packing&gt;</p><p class="del">- &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;/packing&gt;</p><p class="del">- &lt;/child&gt;</p><p class="del">- &lt;child&gt;</p><p class="del">- &lt;object class=&quot;GtkSpinButton&quot; id=&quot;windowsize:0%&quot;&gt;</p><p class="del">- &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;halign&quot;&gt;start&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;invisible_char&quot;&gt;&#x2022;&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;adjustment&quot;&gt;adjustment1&lt;/property&gt;</p><p class="del">- &lt;/object&gt;</p><p class="del">- &lt;packing&gt;</p><p class="del">- &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;/packing&gt;</p><p class="del">- &lt;/child&gt;</p><p class="del">- &lt;child&gt;</p><p class="ctx"> &lt;object class=&quot;GtkLabel&quot; id=&quot;label8&quot;&gt;</p><p class="ctx"> &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;</p><p class="ctx"> &lt;property name=&quot;can_focus&quot;&gt;False&lt;/property&gt;</p><p class="hunk">@@ -343,7 +316,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="hunk">@@ -367,7 +340,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="hunk">@@ -382,7 +355,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="hunk">@@ -396,7 +369,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="hunk">@@ -411,7 +384,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;4&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;</p><p class="ctx"> &lt;property name=&quot;width&quot;&gt;2&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="hunk">@@ -426,7 +399,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;5&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;4&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="hunk">@@ -439,7 +412,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;5&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;4&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="hunk">@@ -453,7 +426,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;child&gt;</p><p class="hunk">@@ -468,7 +441,7 @@</p><p class="ctx"> &lt;/object&gt;</p><p class="ctx"> &lt;packing&gt;</p><p class="ctx"> &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;</p><p class="del">- &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;</p><p class="add">+ &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;</p><p class="ctx"> &lt;/packing&gt;</p><p class="ctx"> &lt;/child&gt;</p><p class="ctx"> &lt;/object&gt;</p><p class="hunk">@@ -41,7 +41,6 @@ enum class DragMode {</p><p class="ctx"> class SVT_DLLPUBLIC SvtTabAppearanceCfg : public utl::ConfigItem</p><p class="ctx"> {</p><p class="ctx"> DragMode nDragMode ;</p><p class="del">- short nScaleFactor ;</p><p class="ctx"> SnapType nSnapMode ;</p><p class="ctx"> MouseMiddleButtonAction nMiddleMouse;</p><p class="ctx"> #if defined( UNX )</p><p class="hunk">@@ -66,9 +65,6 @@ public:</p><p class="ctx"> DragMode GetDragMode () const { return nDragMode; }</p><p class="del">- sal_uInt16 GetScaleFactor () const { return nScaleFactor; }</p><p class="del">- void SetScaleFactor ( sal_uInt16 nSet );</p><p class="del">-</p><p class="ctx"> SnapType GetSnapMode () const { return nSnapMode; }</p><p class="ctx"> void SetSnapMode ( SnapType nSet );</p><p class="hunk">@@ -501,12 +501,6 @@ public:</p><p class="ctx"> void SetCursorBlinkTime( sal_uInt64 nBlinkTime );</p><p class="ctx"> sal_uInt64 GetCursorBlinkTime() const;</p><p class="del">- void SetScreenZoom( sal_uInt16 nPercent );</p><p class="del">- sal_uInt16 GetScreenZoom() const;</p><p class="del">-</p><p class="del">- void SetScreenFontZoom( sal_uInt16 nPercent );</p><p class="del">- sal_uInt16 GetScreenFontZoom() const;</p><p class="del">-</p><p class="ctx"> void SetDragFullOptions( DragFullOptions nOptions );</p><p class="ctx"> DragFullOptions GetDragFullOptions() const;</p><p class="hunk">@@ -2621,29 +2621,6 @@</p><p class="ctx"> &lt;info&gt;</p><p class="ctx"> &lt;desc&gt;Contains window and dialog settings.&lt;/desc&gt;</p><p class="ctx"> &lt;/info&gt;</p><p class="del">- &lt;prop oor:name=&quot;FontScaling&quot; oor:type=&quot;xs:short&quot; oor:nillable=&quot;false&quot;&gt;</p><p class="del">- &lt;!--OldPath: General/View --&gt;</p><p class="del">- &lt;!--OldLocation: soffice.cfg--&gt;</p><p class="del">- &lt;!--UIHints: Tools Options - General View [Section] Display--&gt;</p><p class="del">- &lt;info&gt;</p><p class="del">- &lt;desc&gt;Specifies the scaling only of the screen representation</p><p class="del">- [UNIT=%].&lt;/desc&gt;</p><p class="del">- &lt;label&gt;Scaling&lt;/label&gt;</p><p class="del">- &lt;/info&gt;</p><p class="del">- &lt;constraints&gt;</p><p class="del">- &lt;minInclusive oor:value=&quot;50&quot;&gt;</p><p class="del">- &lt;info&gt;</p><p class="del">- &lt;desc&gt;Specifies the minimum range of the scaling.&lt;/desc&gt;</p><p class="del">- &lt;/info&gt;</p><p class="del">- &lt;/minInclusive&gt;</p><p class="del">- &lt;maxInclusive oor:value=&quot;200&quot;&gt;</p><p class="del">- &lt;info&gt;</p><p class="del">- &lt;desc&gt;Specifies the maximum range of the scaling.&lt;/desc&gt;</p><p class="del">- &lt;/info&gt;</p><p class="del">- &lt;/maxInclusive&gt;</p><p class="del">- &lt;/constraints&gt;</p><p class="del">- &lt;value&gt;100&lt;/value&gt;</p><p class="del">- &lt;/prop&gt;</p><p class="ctx"> &lt;group oor:name=&quot;NewDocumentHandling&quot;&gt;</p><p class="ctx"> &lt;info&gt;</p><p class="ctx"> &lt;desc&gt;Contains settings to change new document window behavior.&lt;/desc&gt;</p><p class="hunk">@@ -500,6 +500,8 @@ class ScGlobal</p><p class="ctx"> static ScFieldEditEngine* pFieldEditEngine;</p><p class="add">+ static void InitPPT();</p><p class="add">+</p><p class="ctx"> public:</p><p class="ctx"> static SvtSysLocale* pSysLocale;</p><p class="ctx"> // for faster access a pointer to the single instance provided by SvtSysLocale</p><p class="hunk">@@ -556,8 +558,6 @@ public:</p><p class="ctx"> static void InitAddIns();</p><p class="ctx"> static void Clear(); // at the end of the program</p><p class="del">- static void UpdatePPT(OutputDevice* pDev);</p><p class="del">-</p><p class="ctx"> static void InitTextHeight(SfxItemPool* pPool);</p><p class="ctx"> static SvxBrushItem* GetEmptyBrushItem() { return pEmptyBrushItem; }</p><p class="ctx"> static SvxBrushItem* GetButtonBrushItem();</p><p class="hunk">@@ -130,8 +130,6 @@ sal_uInt16 ScGlobal::nStdRowHeight = 256;</p><p class="ctx"> long ScGlobal::nLastRowHeightExtra = 0;</p><p class="ctx"> long ScGlobal::nLastColWidthExtra = STD_EXTRA_WIDTH;</p><p class="del">-static sal_uInt16 nPPTZoom = 0; // ScreenZoom used to determine nScreenPPTX/Y</p><p class="del">-</p><p class="ctx"> SfxViewShell* pScActiveViewShell = nullptr; //FIXME: Make this a member</p><p class="ctx"> sal_uInt16 nScClickMouseModifier = 0; //FIXME: This too</p><p class="ctx"> sal_uInt16 nScFillModeMouseModifier = 0; //FIXME: And this</p><p class="hunk">@@ -521,7 +519,7 @@ void ScGlobal::Init()</p><p class="ctx"> pEmbeddedBrushItem = new SvxBrushItem( Color( COL_LIGHTCYAN ), ATTR_BACKGROUND );</p><p class="ctx"> pProtectedBrushItem = new SvxBrushItem( Color( COL_LIGHTGRAY ), ATTR_BACKGROUND );</p><p class="del">- UpdatePPT(nullptr);</p><p class="add">+ InitPPT();</p><p class="ctx"> //ScCompiler::InitSymbolsNative();</p><p class="ctx"> // ScParameterClassification _after_ Compiler, needs function resources if</p><p class="ctx"> // arguments are to be merged in, which in turn need strings of function</p><p class="hunk">@@ -536,23 +534,12 @@ void ScGlobal::Init()</p><p class="ctx"> // ScDocumentPool::InitVersionMaps() has been called earlier already</p><p class="ctx"> }</p><p class="del">-void ScGlobal::UpdatePPT( OutputDevice* pDev )</p><p class="add">+void ScGlobal::InitPPT()</p><p class="ctx"> {</p><p class="del">- sal_uInt16 nCurrentZoom = Application::GetSettings().GetStyleSettings().GetScreenZoom();</p><p class="del">- if ( nCurrentZoom != nPPTZoom )</p><p class="del">- {</p><p class="del">- // Screen PPT values must be updated when ScreenZoom has changed.</p><p class="del">- // If called from Window::DataChanged, the window is passed as pDev,</p><p class="del">- // to make sure LogicToPixel uses a device which already uses the new zoom.</p><p class="del">- // For the initial settings, NULL is passed and GetDefaultDevice used.</p><p class="del">-</p><p class="del">- if ( !pDev )</p><p class="del">- pDev = Application::GetDefaultDevice();</p><p class="del">- Point aPix1000 = pDev-&gt;LogicToPixel( Point(100000,100000), MAP_TWIP );</p><p class="del">- nScreenPPTX = aPix1000.X() / 100000.0;</p><p class="del">- nScreenPPTY = aPix1000.Y() / 100000.0;</p><p class="del">- nPPTZoom = nCurrentZoom;</p><p class="del">- }</p><p class="add">+ OutputDevice* pDev = Application::GetDefaultDevice();</p><p class="add">+ Point aPix1000 = pDev-&gt;LogicToPixel( Point(100000,100000), MAP_TWIP );</p><p class="add">+ nScreenPPTX = aPix1000.X() / 100000.0;</p><p class="add">+ nScreenPPTY = aPix1000.Y() / 100000.0;</p><p class="ctx"> }</p><p class="ctx"> const OUString&amp; ScGlobal::GetClipDocName()</p><p class="hunk">@@ -1905,8 +1905,6 @@ void ScGridWindow::DataChanged( const DataChangedEvent&amp; rDCEvt )</p><p class="ctx"> {</p><p class="ctx"> ScTabView* pView = pViewData-&gt;GetView();</p><p class="del">- // update scale in case the UI ScreenZoom has changed</p><p class="del">- ScGlobal::UpdatePPT(this);</p><p class="ctx"> pView-&gt;RecalcPPT();</p><p class="ctx"> // RepeatResize in case scroll bar sizes have changed</p><p class="hunk">@@ -749,20 +749,6 @@ void Window::DataChanged( const DataChangedEvent&amp; rDCEvt )</p><p class="ctx"> if ( (rDCEvt.GetType() == DataChangedEventType::SETTINGS) &amp;&amp;</p><p class="ctx"> (rDCEvt.GetFlags() &amp; AllSettingsFlags::STYLE) )</p><p class="ctx"> {</p><p class="del">- // When the screen zoom factor has changed then reset the zoom</p><p class="del">- // factor of the frame to always display the whole page.</p><p class="del">- const AllSettings* pOldSettings = rDCEvt.GetOldSettings ();</p><p class="del">- const AllSettings&amp; rNewSettings = GetSettings ();</p><p class="del">- if (pOldSettings &amp;&amp; mpViewShell)</p><p class="del">- {</p><p class="del">- if (pOldSettings-&gt;GetStyleSettings().GetScreenZoom()</p><p class="del">- != rNewSettings.GetStyleSettings().GetScreenZoom())</p><p class="del">- {</p><p class="del">- mpViewShell-&gt;GetViewFrame()-&gt;GetDispatcher()-&gt;</p><p class="del">- Execute(SID_SIZE_PAGE, SfxCallMode::ASYNCHRON | SfxCallMode::RECORD);</p><p class="del">- }</p><p class="del">- }</p><p class="del">-</p><p class="ctx"> /* Rearrange or initiate Resize for scroll bars since the size of</p><p class="ctx"> the scroll bars my have changed. Within this, inside the resize-</p><p class="ctx"> handler, the size of the scroll bars will be asked from the</p><p class="hunk">@@ -28,7 +28,6 @@</p><p class="ctx"> #define DEFAULT_DRAGMODE DragMode::SystemDep</p><p class="ctx"> #define DEFAULT_SNAPMODE SnapType::ToButton</p><p class="del">-#define DEFAULT_SCALEFACTOR 100</p><p class="ctx"> #if defined UNX</p><p class="ctx"> #define DEFAULT_AAMINHEIGHT 8</p><p class="ctx"> #endif</p><p class="hunk">@@ -40,7 +39,6 @@ bool SvtTabAppearanceCfg::bInitialized = false;</p><p class="ctx"> SvtTabAppearanceCfg::SvtTabAppearanceCfg()</p><p class="ctx"> :ConfigItem(OUString(&quot;Office.Common/View&quot;))</p><p class="ctx"> ,nDragMode ( DEFAULT_DRAGMODE )</p><p class="del">- ,nScaleFactor ( DEFAULT_SCALEFACTOR )</p><p class="ctx"> ,nSnapMode ( DEFAULT_SNAPMODE )</p><p class="ctx"> ,nMiddleMouse ( MouseMiddleButtonAction::AutoScroll )</p><p class="ctx"> #if defined( UNX )</p><p class="hunk">@@ -64,26 +62,25 @@ SvtTabAppearanceCfg::SvtTabAppearanceCfg()</p><p class="ctx"> {</p><p class="ctx"> switch(nProp)</p><p class="ctx"> {</p><p class="del">- case 0: *pValues &gt;&gt;= nScaleFactor; break; //&quot;FontScaling&quot;,</p><p class="del">- case 1: //&quot;Window/Drag&quot;</p><p class="add">+ case 0: //&quot;Window/Drag&quot;</p><p class="ctx"> {</p><p class="ctx"> short nTmp;</p><p class="ctx"> if (*pValues &gt;&gt;= nTmp)</p><p class="ctx"> nDragMode = (DragMode)nTmp;</p><p class="ctx"> break;</p><p class="ctx"> }</p><p class="del">- case 2: bMenuMouseFollow = *o3tl::doAccess&lt;bool&gt;(*pValues); break; //&quot;Menu/FollowMouse&quot;,</p><p class="del">- case 3:</p><p class="add">+ case 1: bMenuMouseFollow = *o3tl::doAccess&lt;bool&gt;(*pValues); break; //&quot;Menu/FollowMouse&quot;,</p><p class="add">+ case 2:</p><p class="ctx"> {</p><p class="ctx"> short nTmp;</p><p class="ctx"> if (*pValues &gt;&gt;= nTmp)</p><p class="ctx"> nSnapMode = (SnapType)nTmp; //&quot;Dialog/MousePositioning&quot;,</p><p class="ctx"> break;</p><p class="ctx"> }</p><p class="del">- case 4: { short nTmp = 0; *pValues &gt;&gt;= nTmp; nMiddleMouse = static_cast&lt;MouseMiddleButtonAction&gt;(nTmp); break; } //&quot;Dialog/MiddleMouseButton&quot;,</p><p class="add">+ case 3: { short nTmp = 0; *pValues &gt;&gt;= nTmp; nMiddleMouse = static_cast&lt;MouseMiddleButtonAction&gt;(nTmp); break; } //&quot;Dialog/MiddleMouseButton&quot;,</p><p class="ctx"> #if defined( UNX )</p><p class="del">- case 5: bFontAntialiasing = *o3tl::doAccess&lt;bool&gt;(*pValues); break; // &quot;FontAntialising/Enabled&quot;,</p><p class="del">- case 6: *pValues &gt;&gt;= nAAMinPixelHeight; break; // &quot;FontAntialising/MinPixelHeight&quot;,</p><p class="add">+ case 4: bFontAntialiasing = *o3tl::doAccess&lt;bool&gt;(*pValues); break; // &quot;FontAntialising/Enabled&quot;,</p><p class="add">+ case 5: *pValues &gt;&gt;= nAAMinPixelHeight; break; // &quot;FontAntialising/MinPixelHeight&quot;,</p><p class="ctx"> #endif</p><p class="ctx"> }</p><p class="ctx"> }</p><p class="hunk">@@ -102,14 +99,13 @@ const Sequence&lt;OUString&gt;&amp; SvtTabAppearanceCfg::GetPropertyNames()</p><p class="ctx"> {</p><p class="ctx"> static const sal_Char* aPropNames[] =</p><p class="ctx"> {</p><p class="del">- &quot;FontScaling&quot; // 0</p><p class="del">- ,&quot;Window/Drag&quot; // 1</p><p class="del">- ,&quot;Menu/FollowMouse&quot; // 2</p><p class="del">- ,&quot;Dialog/MousePositioning&quot; // 3</p><p class="del">- ,&quot;Dialog/MiddleMouseButton&quot; // 4</p><p class="add">+ &quot;Window/Drag&quot; // 0</p><p class="add">+ ,&quot;Menu/FollowMouse&quot; // 1</p><p class="add">+ ,&quot;Dialog/MousePositioning&quot; // 2</p><p class="add">+ ,&quot;Dialog/MiddleMouseButton&quot; // 3</p><p class="ctx"> #if defined( UNX )</p><p class="del">- ,&quot;FontAntiAliasing/Enabled&quot; // 5</p><p class="del">- ,&quot;FontAntiAliasing/MinPixelHeight&quot; // 6</p><p class="add">+ ,&quot;FontAntiAliasing/Enabled&quot; // 4</p><p class="add">+ ,&quot;FontAntiAliasing/MinPixelHeight&quot; // 5</p><p class="ctx"> #endif</p><p class="ctx"> };</p><p class="ctx"> const int nCount = SAL_N_ELEMENTS( aPropNames );</p><p class="hunk">@@ -133,14 +129,13 @@ void SvtTabAppearanceCfg::ImplCommit()</p><p class="ctx"> {</p><p class="ctx"> switch(nProp)</p><p class="ctx"> {</p><p class="del">- case 0: pValues[nProp] &lt;&lt;= nScaleFactor; break; // &quot;FontScaling&quot;,</p><p class="del">- case 1: pValues[nProp] &lt;&lt;= (short)nDragMode; break; //&quot;Window/Drag&quot;,</p><p class="del">- case 2: pValues[nProp] &lt;&lt;= bMenuMouseFollow; break; //&quot;Menu/FollowMouse&quot;,</p><p class="del">- case 3: pValues[nProp] &lt;&lt;= (short)nSnapMode; break; //&quot;Dialog/MousePositioning&quot;,</p><p class="del">- case 4: pValues[nProp] &lt;&lt;= static_cast&lt;short&gt;(nMiddleMouse); break; //&quot;Dialog/MiddleMouseButton&quot;,</p><p class="add">+ case 0: pValues[nProp] &lt;&lt;= (short)nDragMode; break; // &quot;Window/Drag&quot;,</p><p class="add">+ case 1: pValues[nProp] &lt;&lt;= bMenuMouseFollow; break; // &quot;Menu/FollowMouse&quot;,</p><p class="add">+ case 2: pValues[nProp] &lt;&lt;= (short)nSnapMode; break; // &quot;Dialog/MousePositioning&quot;,</p><p class="add">+ case 3: pValues[nProp] &lt;&lt;= static_cast&lt;short&gt;(nMiddleMouse); break; // &quot;Dialog/MiddleMouseButton&quot;,</p><p class="ctx"> #if defined( UNX )</p><p class="del">- case 5: pValues[nProp] &lt;&lt;= bFontAntialiasing; break; // &quot;FontAntialising/Enabled&quot;,</p><p class="del">- case 6: pValues[nProp] &lt;&lt;= nAAMinPixelHeight; break; // &quot;FontAntialising/MinPixelHeight&quot;,</p><p class="add">+ case 4: pValues[nProp] &lt;&lt;= bFontAntialiasing; break; // &quot;FontAntialising/Enabled&quot;,</p><p class="add">+ case 5: pValues[nProp] &lt;&lt;= nAAMinPixelHeight; break; // &quot;FontAntialising/MinPixelHeight&quot;,</p><p class="ctx"> #endif</p><p class="ctx"> }</p><p class="ctx"> }</p><p class="hunk">@@ -151,12 +146,6 @@ void SvtTabAppearanceCfg::Notify( const css::uno::Sequence&lt; OUString &gt;&amp; )</p><p class="ctx"> {</p><p class="ctx"> }</p><p class="del">-void SvtTabAppearanceCfg::SetScaleFactor ( sal_uInt16 nSet )</p><p class="del">-{</p><p class="del">- nScaleFactor = nSet;</p><p class="del">- SetModified();</p><p class="del">-}</p><p class="del">-</p><p class="ctx"> void SvtTabAppearanceCfg::SetSnapMode ( SnapType nSet )</p><p class="ctx"> {</p><p class="ctx"> nSnapMode = nSet;</p><p class="hunk">@@ -183,11 +172,6 @@ void SvtTabAppearanceCfg::SetApplicationDefaults ( Application* pApp )</p><p class="ctx"> // and set it here</p><p class="ctx"> hAppStyle.SetUseSystemUIFonts( bUseSystemUIFonts );</p><p class="del">- // Screen and ScreenFont Scaling</p><p class="del">-</p><p class="del">- hAppStyle.SetScreenZoom( nScaleFactor );</p><p class="del">- hAppStyle.SetScreenFontZoom( nScaleFactor );</p><p class="del">-</p><p class="ctx"> #if defined( UNX )</p><p class="ctx"> // font anti aliasing</p><p class="ctx"> hAppStyle.SetAntialiasingMinPixelHeight( nAAMinPixelHeight );</p><p class="hunk">@@ -171,8 +171,6 @@ struct ImplStyleData</p><p class="ctx"> ToolbarIconSize mnToolbarIconSize;</p><p class="ctx"> bool mnUseFlatMenus;</p><p class="ctx"> StyleSettingsOptions mnOptions;</p><p class="del">- sal_uInt16 mnScreenZoom;</p><p class="del">- sal_uInt16 mnScreenFontZoom;</p><p class="ctx"> bool mbHighContrast;</p><p class="ctx"> bool mbUseSystemUIFonts;</p><p class="ctx"> bool mbAutoMnemonic;</p><p class="hunk">@@ -539,8 +537,6 @@ ImplStyleData::ImplStyleData() :</p><p class="ctx"> mnAntialiasedMin = 0;</p><p class="ctx"> mnCursorSize = 2;</p><p class="ctx"> mnCursorBlinkTime = STYLE_CURSOR_NOBLINKTIME;</p><p class="del">- mnScreenZoom = 100;</p><p class="del">- mnScreenFontZoom = 100;</p><p class="ctx"> mnDragFullOptions = DragFullOptions::All;</p><p class="ctx"> mnSelectionOptions = SelectionOptions::NONE;</p><p class="ctx"> mnDisplayOptions = DisplayOptions::NONE;</p><p class="hunk">@@ -648,8 +644,6 @@ ImplStyleData::ImplStyleData( const ImplStyleData&amp; rData ) :</p><p class="ctx"> mnAntialiasedMin = rData.mnAntialiasedMin;</p><p class="ctx"> mnCursorSize = rData.mnCursorSize;</p><p class="ctx"> mnCursorBlinkTime = rData.mnCursorBlinkTime;</p><p class="del">- mnScreenZoom = rData.mnScreenZoom;</p><p class="del">- mnScreenFontZoom = rData.mnScreenFontZoom;</p><p class="ctx"> mnDragFullOptions = rData.mnDragFullOptions;</p><p class="ctx"> mnSelectionOptions = rData.mnSelectionOptions;</p><p class="ctx"> mnDisplayOptions = rData.mnDisplayOptions;</p><p class="hunk">@@ -1834,32 +1828,6 @@ StyleSettings::GetCursorBlinkTime() const</p><p class="ctx"> }</p><p class="ctx"> void</p><p class="del">-StyleSettings::SetScreenZoom( sal_uInt16 nPercent )</p><p class="del">-{</p><p class="del">- CopyData();</p><p class="del">- mxData-&gt;mnScreenZoom = nPercent;</p><p class="del">-}</p><p class="del">-</p><p class="del">-sal_uInt16</p><p class="del">-StyleSettings::GetScreenZoom() const</p><p class="del">-{</p><p class="del">- return mxData-&gt;mnScreenZoom;</p><p class="del">-}</p><p class="del">-</p><p class="del">-void</p><p class="del">-StyleSettings::SetScreenFontZoom( sal_uInt16 nPercent )</p><p class="del">-{</p><p class="del">- CopyData();</p><p class="del">- mxData-&gt;mnScreenFontZoom = nPercent;</p><p class="del">-}</p><p class="del">-</p><p class="del">-sal_uInt16</p><p class="del">-StyleSettings::GetScreenFontZoom() const</p><p class="del">-{</p><p class="del">- return mxData-&gt;mnScreenFontZoom;</p><p class="del">-}</p><p class="del">-</p><p class="del">-void</p><p class="ctx"> StyleSettings::SetDragFullOptions( DragFullOptions nOptions )</p><p class="ctx"> {</p><p class="ctx"> CopyData();</p><p class="hunk">@@ -2312,8 +2280,6 @@ bool StyleSettings::operator ==( const StyleSettings&amp; rSet ) const</p><p class="ctx"> (mxData-&gt;mnSplitSize == rSet.mxData-&gt;mnSplitSize) &amp;&amp;</p><p class="ctx"> (mxData-&gt;mnSpinSize == rSet.mxData-&gt;mnSpinSize) &amp;&amp;</p><p class="ctx"> (mxData-&gt;mnAntialiasedMin == rSet.mxData-&gt;mnAntialiasedMin) &amp;&amp;</p><p class="del">- (mxData-&gt;mnScreenZoom == rSet.mxData-&gt;mnScreenZoom) &amp;&amp;</p><p class="del">- (mxData-&gt;mnScreenFontZoom == rSet.mxData-&gt;mnScreenFontZoom) &amp;&amp;</p><p class="ctx"> (mxData-&gt;mbHighContrast == rSet.mxData-&gt;mbHighContrast) &amp;&amp;</p><p class="ctx"> (mxData-&gt;mbUseSystemUIFonts == rSet.mxData-&gt;mbUseSystemUIFonts) &amp;&amp;</p><p class="ctx"> (mxData-&gt;mnUseFlatBorders == rSet.mxData-&gt;mnUseFlatBorders) &amp;&amp;</p><p class="hunk">@@ -1138,14 +1138,13 @@ void Window::ImplInit( vcl::Window* pParent, WinBits nStyle, SystemParentData* p</p><p class="ctx"> // setup the scale factor for Hi-DPI displays</p><p class="ctx"> mnDPIScaleFactor = CountDPIScaleFactor(mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY);</p><p class="add">+ mnDPIX = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p class="add">+ mnDPIY = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p><p class="ctx"> if (!utl::ConfigManager::IsAvoidConfig())</p><p class="ctx"> {</p><p class="ctx"> const StyleSettings&amp; rStyleSettings = mxSettings-&gt;GetStyleSettings();</p><p class="del">- sal_uInt16 nScreenZoom = rStyleSettings.GetScreenZoom();</p><p class="del">- mnDPIX = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX*nScreenZoom)/100;</p><p class="del">- mnDPIY = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY*nScreenZoom)/100;</p><p class="del">- maFont = rStyleSettings.GetAppFont();</p><p class="add">+ maFont = rStyleSettings.GetAppFont();</p><p class="ctx"> if ( nStyle &amp; WB_3DLOOK )</p><p class="ctx"> {</p><p class="hunk">@@ -1160,8 +1159,6 @@ void Window::ImplInit( vcl::Window* pParent, WinBits nStyle, SystemParentData* p</p><p class="ctx"> }</p><p class="ctx"> else</p><p class="ctx"> {</p><p class="del">- mnDPIX = 96;</p><p class="del">- mnDPIY = 96;</p><p class="ctx"> maFont = GetDefaultFont( DefaultFontType::FIXED, LANGUAGE_ENGLISH_US, GetDefaultFontFlags::NONE );</p><p class="ctx"> }</p><p class="hunk">@@ -1326,13 +1323,12 @@ void Window::ImplInitResolutionSettings()</p><p class="ctx"> // recalculate AppFont-resolution and DPI-resolution</p><p class="ctx"> if (mpWindowImpl-&gt;mbFrame)</p><p class="ctx"> {</p><p class="del">- const StyleSettings&amp; rStyleSettings = mxSettings-&gt;GetStyleSettings();</p><p class="del">- sal_uInt16 nScreenZoom = rStyleSettings.GetScreenZoom();</p><p class="del">- mnDPIX = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX*nScreenZoom)/100;</p><p class="del">- mnDPIY = (mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY*nScreenZoom)/100;</p><p class="add">+ mnDPIX = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p class="add">+ mnDPIY = mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p><p class="ctx"> // setup the scale factor for Hi-DPI displays</p><p class="ctx"> mnDPIScaleFactor = CountDPIScaleFactor(mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY);</p><p class="add">+ const StyleSettings&amp; rStyleSettings = mxSettings-&gt;GetStyleSettings();</p><p class="ctx"> SetPointFont(*this, rStyleSettings.GetAppFont());</p><p class="ctx"> }</p><p class="ctx"> else if ( mpWindowImpl-&gt;mpParent )</p><p class="hunk">@@ -1355,25 +1351,16 @@ void Window::ImplInitResolutionSettings()</p><p class="ctx"> void Window::ImplPointToLogic(vcl::RenderContext&amp; rRenderContext, vcl::Font&amp; rFont) const</p><p class="ctx"> {</p><p class="ctx"> Size aSize = rFont.GetFontSize();</p><p class="del">- sal_uInt16 nScreenFontZoom;</p><p class="del">- if (!utl::ConfigManager::IsAvoidConfig())</p><p class="del">- nScreenFontZoom = rRenderContext.GetSettings().GetStyleSettings().GetScreenFontZoom();</p><p class="del">- else</p><p class="del">- nScreenFontZoom = 100;</p><p class="ctx"> if (aSize.Width())</p><p class="ctx"> {</p><p class="ctx"> aSize.Width() *= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p class="ctx"> aSize.Width() += 72 / 2;</p><p class="ctx"> aSize.Width() /= 72;</p><p class="del">- aSize.Width() *= nScreenFontZoom;</p><p class="del">- aSize.Width() /= 100;</p><p class="ctx"> }</p><p class="ctx"> aSize.Height() *= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p><p class="ctx"> aSize.Height() += 72/2;</p><p class="ctx"> aSize.Height() /= 72;</p><p class="del">- aSize.Height() *= nScreenFontZoom;</p><p class="del">- aSize.Height() /= 100;</p><p class="ctx"> if (rRenderContext.IsMapModeEnabled())</p><p class="ctx"> aSize = rRenderContext.PixelToLogic(aSize);</p><p class="hunk">@@ -1384,25 +1371,16 @@ void Window::ImplPointToLogic(vcl::RenderContext&amp; rRenderContext, vcl::Font&amp; rFo</p><p class="ctx"> void Window::ImplLogicToPoint(vcl::RenderContext&amp; rRenderContext, vcl::Font&amp; rFont) const</p><p class="ctx"> {</p><p class="ctx"> Size aSize = rFont.GetFontSize();</p><p class="del">- sal_uInt16 nScreenFontZoom;</p><p class="del">- if (!utl::ConfigManager::IsAvoidConfig())</p><p class="del">- nScreenFontZoom = rRenderContext.GetSettings().GetStyleSettings().GetScreenFontZoom();</p><p class="del">- else</p><p class="del">- nScreenFontZoom = 100;</p><p class="ctx"> if (rRenderContext.IsMapModeEnabled())</p><p class="ctx"> aSize = rRenderContext.LogicToPixel(aSize);</p><p class="ctx"> if (aSize.Width())</p><p class="ctx"> {</p><p class="del">- aSize.Width() *= 100;</p><p class="del">- aSize.Width() /= nScreenFontZoom;</p><p class="ctx"> aSize.Width() *= 72;</p><p class="ctx"> aSize.Width() += mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX / 2;</p><p class="ctx"> aSize.Width() /= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIX;</p><p class="ctx"> }</p><p class="del">- aSize.Height() *= 100;</p><p class="del">- aSize.Height() /= nScreenFontZoom;</p><p class="ctx"> aSize.Height() *= 72;</p><p class="ctx"> aSize.Height() += mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY / 2;</p><p class="ctx"> aSize.Height() /= mpWindowImpl-&gt;mpFrameData-&gt;mnDPIY;</p></td>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>