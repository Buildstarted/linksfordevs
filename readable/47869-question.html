<!DOCTYPE html>
<html lang="en">
<head>
    <title>
question -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>question</h1>
    <div><div class="post-gravatar question-gravatar col-sm-1"> <a href="/answers/users/960667/stefanschackowmsft-4594.html" class="gravatar"><span> <img class="gravatar " width="48" src="https://secure.gravatar.com/avatar/?d=identicon&amp;r=PG&amp;s=48" id alt="StefanSchackowMSFT-4594 avatar image"> </span></a> </div><div id="question-6842" class="question post col-sm-11"> <div class="question-body post-body"> <p>As part of Azure App Service&#x2019;s January 2020 update, the service is installing .NET Framework patches that update how .NET framework apps handle the SameSite cookie property. The service is also deploying an App Service compatibility behavior that applies to all applications running on App Service for scenarios where a cookie has set the SameSite property to &quot;None&quot;.</p> <p>.NET Core versions on the App Service platform already contain updates for SameSite cookie handling and are not changing as part of the January 2020 service update. </p> <p>The Azure App Service payload is deploying throughout the month of January 2020, with an estimated completion date of the end of January 2020 across the public Azure cloud, all App Service Environments, and national clouds.</p> <p>Since the updates are deployed incrementally across the service, applications will start running on the newer App Service payload at different times during the deployment period. Developers can determine if applications are running on the updated App Service payload by checking the version of App Service in the SCM site. The SCM site is available in the portal from the Development Tools --&gt; Advanced Tools option. Alternatively, developers can navigate directly to the SCM site for an application using the following Url format: <a href="https://*your-sitename-here*.scm.azurewebsites.net.">https://*your-sitename-here*.scm.azurewebsites.net.</a></p> <p>For Windows App Service sites, the home page of the SCM site shows the Azure App Service version. If the version is <strong>86.0.7.148</strong> (or later), then the associated application is running on the newly patched version of App Service.</p> <p>For Linux App Service sites, clicking on the Environment option in top menu of the SCM site will return a page with all of the sites&#x2019; environment variables. The resultant page will have a Url format like: <a href="https://*your-sitename-here*.scm.azurewebsites.net/Env.">https://*your-sitename-here*.scm.azurewebsites.net/Env.</a> The PLATFORM_VERSION environment variable shows the current App Service version. If the version is <strong>86.0.7.148</strong> (or later), then the associated application is running on the newly patched version of App Service.</p> <p><strong>Details on the .NET Framework Patch for SameSite</strong></p> <p>Specific details on differences in SameSite cookie handling included in the .NET Framework 4.7.2 patch are described in this article: <a href="https://support.microsoft.com/help/4533013/kb4533013-cumulative-update-for-net-framework.">https://support.microsoft.com/help/4533013/kb4533013-cumulative-update-for-net-framework.</a></p> <p>With the .NET Framework patch installed, the .NET Framework changes the defaults for the <em>cookieSameSite</em> configuration property for Session State and Forms Authentication to &quot;Lax&quot;. The .NET Framework also automatically sends the SameSite=None cookie property on the wire when <em>HttpCookie.SameSite</em> has been set to a value of &quot;None&quot;.</p> <p>Additional information about SameSite cookie handling with the .NET Framework is available in these articles:</p> <p><a href="https://devblogs.microsoft.com/aspnet/upcoming-samesite-cookie-changes-in-asp-net-and-asp-net-core/">https://devblogs.microsoft.com/aspnet/upcoming-samesite-cookie-changes-in-asp-net-and-asp-net-core/</a></p> <p><a href="https://docs.microsoft.com/aspnet/samesite/system-web-samesite">https://docs.microsoft.com/aspnet/samesite/system-web-samesite</a></p> <p>Documentation on the forms authentication <em>cookieSameSite</em> default is available in this article: <a href="https://docs.microsoft.com/dotnet/api/system.web.configuration.formsauthenticationconfiguration.cookiesamesite">https://docs.microsoft.com/dotnet/api/system.web.configuration.formsauthenticationconfiguration.cookiesamesite</a></p> <p>Documentation on the session state <em>cookieSameSite</em> default is available in this article: <a href="https://docs.microsoft.com/dotnet/api/system.web.configuration.sessionstatesection.cookiesamesite">https://docs.microsoft.com/dotnet/api/system.web.configuration.sessionstatesection.cookiesamesite</a></p> <p>Additional information about SameSite cookie handling with .NET Core is available in this article: <a href="https://docs.microsoft.com/aspnet/core/security/samesite">https://docs.microsoft.com/aspnet/core/security/samesite</a></p> <p><strong>Details on Azure App Service Compatibility Behavior</strong></p> <p>In addition to the .NET Framework patch, Azure App Service has introduced a compatibility behavior for the scenario where an HTTP/HTTPS response includes a cookie header with a SameSite property set to a value of &quot;None&quot;, and the requesting user agent matches a specific subset of older browsers that do not support the newer 2019 SameSite standard and hence do not recognize the SameSite property of &quot;None&quot;. When an older browser is detected, Azure App Service will automatically remove the SameSite=None cookie property if it is detected in the response headers.</p> <p>The net effect of the App Service compatibility behavior is that a specific subset of older browsers won&#x2019;t receive an unrecognized SameSite value (which can cause older browsers to revert to SameSite=Strict behavior), while newer browsers (like Chrome v80) will receive the SameSite=None cookie property.</p> <p>The specific detection logic used by App Service for deciding when to remove the SameSite=None property from a response follows the pseudo-logic documented in this article: <a href="https://docs.microsoft.com/en-us/aspnet/samesite/system-web-samesite#supporting-older-browsers">https://docs.microsoft.com/en-us/aspnet/samesite/system-web-samesite#supporting-older-browsers</a></p> <p>It is recommended for developers to review their applications&#x2019; usage and reliance (if any) on the SameSite cookie property, and update application logic with user agent detection and special handling as appropriate for each application&#x2019;s scenario. The App Service platform&#x2019;s compatibility behavior is intended only as a partial mitigation to aid developers while applications are updated to handle the 2019 SameSite behavior implemented in newer browser versions.</p> <p>Developers should also review additional browser requirements when cookies include the SameSite=None property. For example, Chrome v80 will only honor SameSite=None if the cookie is also marked with the Secure attribute, and the cookie is flowing over an HTTPS connection. More details are available in this article: <a href="https://blog.chromium.org/2019/10/developers-get-ready-for-new.html">https://blog.chromium.org/2019/10/developers-get-ready-for-new.html</a></p> <p>The Azure App Service compatibility behavior is implemented on App Service&#x2019;s network edge infrastructure. The behavior is active for all sites running on App Service, regardless of the language or framework used by the site. The compatibility functionality works for sites running on both the Linux and Windows variations of App Service, for App Service Environments, and for all national cloud deployments of Azure App Service.</p> </div> <span class="tags" id="id_tags_container"> <a href="/answers/topics/azure-webapps.html" class="tag"><span>azure-webapps</span></a> </span> <p class="comment-tools"> <span class="add-comment-link "><a href="#">Comment</a></span> </p> </div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>