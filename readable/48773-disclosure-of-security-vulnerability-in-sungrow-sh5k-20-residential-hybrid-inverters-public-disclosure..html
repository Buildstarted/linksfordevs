<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Disclosure of security vulnerability in Sungrow SH5k-20 Residential Hybrid Inverters - Public disclosure. -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Disclosure of security vulnerability in Sungrow SH5k-20 Residential Hybrid Inverters - Public disclosure.</h1>
    <body class="c13"> <p class="c0"><span class="c14">Note: This is a summarised version of the disclosures sent to Sungrow Australia on 2019-09-20 and 2019-09-22. Specific passwords and protocols have been removed.</span></p> <br> <p class="c3"><span><img alt src="images/image4.png"></span></p> <br> <p class="c0"><span class="c7">The Sungrow SH5k-20 is a solar inverter installed as a part of a solar and battery system. It typically connects together solar panels, batteries, a house and the electricity grid and transfers power between them as required. Many of these units have been installed throughout Australia. These systems are also available in other parts of the world.</span></p> <br> <p class="c3"><span><img alt src="images/image3.png"></span></p> <br> <p class="c0"><span class="c7">These systems are typically equipped with a Sungrow SolarInfo WiFi dongle to enable the smart features of the inverter. The system installer, in consultation with their customer, configures the dongle to connect to the customer&#x2019;s private home WiFi network. With internet access the inverter can now transmit data to Sungrow&#x2019;s monitoring system. Customers can log in via a web page or smartphone app to see the status of their system and historical data.</span></p> <br> <p class="c3"><span><img alt src="images/image1.png"></span></p> <br> <p class="c3"><span class="c7">Example of the data available on the iSolarCloud smartphone app.</span></p> <p class="c0"><span class="c7">Consumers can also connect directly to their inverters by connecting to a WiFi Access Point (AP) that the dongle broadcasts with a distinctive name with the format &#x201C;SG-###########&#x201D;, where the hashes (#) represent the inverter&#x2019;s serial number. No password is required to connect to this AP. Once connected, the iSolarCloud smartphone app can be used to provide a username and password to access the inverter statistics. Once logged in a consumer can monitor their solar storage system without an internet connection. The range on this access point is reported to be up to 150 meters in open air. It is at least 10 meters through walls. Consumers cannot set a password on this access point.</span></p> <p class="c0"><span class="c7">In a cursory survey of two residential suburbs of Brisbane, covering approximately 22km of street, 22 susceptible access points were discovered. These were found by running an access point discovery smartphone app while driving on public roads.</span></p> <p class="c0"><span class="c7">Packet loggers are a type of software that enable the capture of low level &#x201C;packets&#x201D; of data transmitted to or from a device over its network connections. Sensitive information like usernames and passwords can be extracted from this data. Well-designed security measures can protect this private information during transmission.</span></p> <h2 class="c10" id="h.3cgr4gcqcg2b"><p class="c9">Vulnerability</p></h2> <p class="c0"><span class="c7">The user-level credentials used to connect from the iSolarCloud smartphone app to the SolarInfo WiFi dongle are public information. It is possible to use a network packet capture tool, running on an unmodified Android smartphone, to record the data exchanged between the inverter and the smartphone during this connection process.</span></p> <p class="c0"><span class="c7">Contained within this information are numerous sensitive pieces of data, including:</span></p><br> <ul class="c11 lst-kix_keoz1yhpoynx-0 start"> <li class="c0 c6"><p class="c7">The elevated installer-level login credentials,</p></li> <li class="c0 c6"><p class="c7">A hidden web interface password,</p></li> <li class="c0 c6"><p class="c7">The customer&#x2019;s WiFi access point password, and</p></li> <li class="c0 c6"><p class="c7">The protocol used by the smartphone app to change the configuration of the inverter.</p></li> </ul> <p class="c0"><span class="c7">&#xA0;The inverter passwords used are short and do not differ between units. The network protocols used to configure the wifi connection and inverter settings are unencrypted, designed for use over closed industrial networks, not public WiFi connections.</span></p> <p class="c0"><span class="c7">Once an attacker has collected the elevated installer-level and hidden web interface passwords from one Sungrow SH5k-20 unit they may re-use that information in attacks against other units of the same model. This can be done in a few seconds from inside a car parked on the street outside a home equipped with one of these inverters.</span></p> <h3 class="c4" id="h.hqxnpsakdd2h"><p class="c2">Attack 1: WiFi password theft</p></h3> <p class="c0"><span class="c7">An attacker can read a customer&#x2019;s WiFi access credentials from the SolarInfo wifi dongle. They can then use this information to connect to the customer&#x2019;s home WiFi network. This exposes networked equipment such as printers, cameras, baby monitors, TVs, intercoms, and other smart home devices to attack.</span></p> <h3 class="c4" id="h.4rhkygjui0ki"><p class="c2">Attack 2: Battery damage</p></h3> <p class="c0"><span class="c7">An attacker has access to battery settings intended for use by qualified service and installation personnel. These settings can be accessed via the installer-level login credentials in the iSolarCloud smartphone app, or via a direct connection to the inverter using an unencrypted industrial protocol. These settings include maximum battery voltage, temperature and discharge current. Intentional misconfiguration of these settings could lead to:</span></p> <ul class="c11 lst-kix_urjdtkxu317q-0 start"> <li class="c0 c6"><p class="c7">Blackouts,</p></li> <li class="c0 c6"><p class="c7">Grid power interference,</p></li> <li class="c0 c6"><p class="c7">Increased degradation of battery capacity,</p></li> <li class="c0 c6"><p class="c7">Excess power consumption,</p></li> <li class="c0 c6"><p class="c7">Energising &#xA0;the power grid during scheduled outages for maintenance,</p></li> <li class="c0 c6"><p class="c7">Battery explosion and fire.</p></li> </ul> <p class="c3"><span><img alt src="images/image2.png"></span></p> <p class="c3"><span>Some of the settings available in the inverter.</span></p> <h3 class="c4" id="h.ar9jwon2oymy"><p class="c2">Attack 3: Man-in-the-middle</p></h3> <p class="c0"><span>The inverter communicates to Sungrow&#x2019;s internet servers using an unencrypted and unauthenticated Internet of Things (IoT) protocol. It would be possible for a hostile actor to imitate this server, or otherwise inject messages, and send arbitrary commands to the inverter.</span> </p> <h2 class="c10" id="h.5ggeb1q25n39"><p class="c9">Suggested Immediate steps</p></h2> <h3 class="c4" id="h.grdq3pq4v7s3"><p class="c8">Users</p></h3> <p class="c0"><span class="c7">Unscrew the two bolts attaching the Sungrow WiFi dongle from the bottom of your inverter with a phillips-head screwdriver. Pull the WiFi dongle straight down. Put a piece of tape over the port to keep out dust and insects. Do not connect an ethernet connection to this port. It may cause damage to the inverter or your network equipment. There is an ethernet connection inside the inverter housing, but it should only be connected by qualified personnel. Contact the installer of your solar storage system for the next steps.</span></p> <h3 class="c4" id="h.53vkvmd1h2ze"><p class="c8">Suppliers/Installers</p></h3> <p class="c0"><span class="c7">Halt sale and installation of the Sungrow SolarInfo WiFi dongle. Notify previous customers of these vulnerabilities. Contact Sungrow Australia for further information on rectifying these cybersecurity issues.</span></p> <h3 class="c4" id="h.snsinvo7ci71"><p class="c8">Manufacturer</p></h3> <p class="c0"><span class="c7">Notify all suppliers/installers of the vulnerabilities and issue a recall of affected hardware. </span></p> <p class="c0"><span class="c7">Employ industry-standard cybersecurity principals, such as:</span></p><br> <ul class="c11 lst-kix_jfk4quu4ej9e-0 start"> <li class="c0 c6"><p class="c7">Secure signed firmware updates,</p></li> <li class="c0 c6"><p class="c7">Use a complex initial password unique to each unit,</p></li> <li class="c0 c6"><p class="c7">Encrypt all network communications,</p></li> <li class="c0 c6"><p class="c7">Disable the configuration wifi access point once the customer&#x2019;s network has been configured,</p></li> <li class="c0 c6"><p class="c7">Employ Over the Air (OtA) updates to rectify security vulnerabilities in installed hardware.</p></li> </ul> <h2 class="c10" id="h.wgj3ohytwruq"><p class="c9">Responsible disclosure</p></h2> <p class="c0"><span class="c7">Details of the vulnerabilities disclosed in this document were provided to Sungrow Australia on 2019-09-20. Every effort was made to assist them in understanding the severity of these issues and the risks to which their customers were exposed. They did not commit to rectifying these issues.</span></p> <br> <a href="mailto: solarcyberseccontact@gmail.com">Contact: solarcyberseccontact@gmail.com</a>
</body>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>