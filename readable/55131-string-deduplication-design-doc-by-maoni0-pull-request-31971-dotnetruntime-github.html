<!DOCTYPE html>
<html lang="en">
<head>
    <title>
String Deduplication Design Doc by Maoni0 &#xB7; Pull Request #31971 &#xB7; dotnet/runtime &#xB7; GitHub -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>String Deduplication Design Doc by Maoni0 · Pull Request #31971 · dotnet/runtime · GitHub</h1><div><div id="" class="d-block comment-body markdown-body  js-comment-body"><p>Related: Kestrel does string dedupe in byte-&gt;string conversion across requests on a single connection (checking if the new string for the request is the same as the one from the previous request; before trying to create it) <a class="issue-link js-issue-link" data-error-text="Failed to load issue title" data-id="419101220" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/aspnetcore/issues/8374" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/aspnetcore/pull/8374/hovercard" href="https://github.com/dotnet/aspnetcore/pull/8374">dotnet/aspnetcore#8374</a>.</p><p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/1142958/74079871-1a1c3600-4a35-11ea-958c-7bcc816f1048.png"><img src="https://user-images.githubusercontent.com/1142958/74079871-1a1c3600-4a35-11ea-958c-7bcc816f1048.png" alt="image"></a></p><p>This helps with http, as the values of some of the more egregious sized strings <code>Cookie</code>, <code>User-Agent</code>, <code>Authorization</code> are sent again and again with every request and are generally always identical for every request on a connection.</p><p>While runtime string dedupe wouldn't help necessarily directly with these strings (as they may be unique); since it also makes the strings become longer lived it would automagically widen this deduping to be across connection for the values of other common strings <code>Host</code>, <code>accept-encoding</code> and common <code>User-Agent</code>s etc so rather than being one per connection they would naturally tend to become one value per process.</p><p>This wider string deduplication for longer lived strings would be a beautiful addition; and also an advantage a non-GC'd environment would find very hard to replicate.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>