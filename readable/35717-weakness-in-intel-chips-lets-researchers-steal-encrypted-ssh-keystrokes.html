<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Weakness in Intel chips lets researchers steal encrypted SSH keystrokes -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <style type="text/css">
        html {
            font-family: sans-serif;
            line-height: 1.15;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            height: 100%;
        }

        *, ::after, ::before {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #60656a;
            text-align: left;
            background-color: #323b44;
        }

        h1 {
            font-size: 6rem;
            font-weight: 300;
            line-height: 1.2;
            margin-top: 0;
            margin-bottom: 0.5rem;
            margin-bottom: 0.5rem
        }

        a {
            color: #007bff;
            color: #ccc;
            text-decoration: none;
            background-color: transparent;
            word-break: break-all;
        }

        .unseen a {
            font-weight: bold;
        }

        h3 {
            margin-top: 0;
            padding-top: 0;
            font-weight: normal;
        }

        .grid {
            -ms-flex-direction: column;
            flex-direction: column;
            width: 1024px;
            margin: 0 auto;
            flex: 1 0 auto;
        }

        .row {
            -ms-flex-direction: row;
            flex-direction: row;
            width: 100%;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            display: -ms-flexbox;
            display: flex;
        }

        .col {
            margin: 0 10px 0 10px;
            box-sizing: border-box;
            vertical-align: top;
        }

        .col-3-of-4, .col-6-of-8, .col-9-of-12 {
            width: calc(75% - 20px);
        }

        .col-1-of-4, .col-2-of-8, .col-3-of-12 {
            width: calc(25% - 20px);
        }

        @media (max-width:1023px) {
            /* big landscape tablets, laptops, and desktops */
            body {
                overflow-x: hidden;
            }

            main {
                width: 99%;
            }

            h1 {
                font-size: 50px;
            }
        }

        .text-right {
            text-align: right;
        }

        footer {
            left: 0;
            width: 100%;
            margin-top: 2em;
            padding: 50px 0;
            text-align: center;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        .readable {
            color: #949ba2;
        }

        svg:not(:root).svg-inline--fa {
            color: #60656a;
            overflow: visible;
        }

        .svg-inline--fa.fa-w-12 {
            width: 0.75em;
        }

        svg:not(:root) {
            overflow: hidden;
        }

        .svg-inline--fa {
            display: inline-block;
            font-size: inherit;
            height: 1em;
            overflow: visible;
            vertical-align: -0.125em;
        }

        img {
            max-width: 100%;
        }

        .text-center {
            text-align: center;
        }

        .readable h1 {
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Weakness in Intel chips lets researchers steal encrypted SSH keystrokes</h1>
    <div class="article-content post-page"> <figure class="intro-image intro-left"> <img src="https://cdn.arstechnica.net/wp-content/uploads/2019/09/xeon-800x800.jpg" alt="Weakness in Intel chips lets researchers steal encrypted SSH keystrokes"> <figcaption class="caption"></figcaption> </figure> <aside id="social-left"> <a class="comment-count icon-comment-bubble-down" href="https://arstechnica.com/information-technology/2019/09/weakness-in-intel-chips-lets-researchers-steal-encrypted-ssh-keystrokes/?comments=1"> </a> </aside> <p>In late 2011, Intel <a href="https://www.intel.com/content/www/us/en/io/data-direct-i-o-technology.html">introduced a performance enhancement</a> to its line of server processors that allowed network cards and other peripherals to connect directly to a CPU&apos;s last-level cache, rather than following the standard (and significantly longer) path through the server&apos;s main memory. By avoiding system memory, Intel&apos;s DDIO&#x2014;short for Data-Direct I/O&#x2014;increased input/output bandwidth and reduced latency and power consumption.</p>
<p>Now, researchers are warning that, in certain scenarios, attackers can abuse DDIO to obtain keystrokes and possibly other types of sensitive data that flow through the memory of vulnerable servers. The most serious form of attack can take place in data centers and cloud environments that have both DDIO and <a href="https://en.wikipedia.org/wiki/Remote_direct_memory_access">remote direct memory access</a> enabled to allow servers to exchange data. A server leased by a malicious hacker could abuse the vulnerability to attack other customers. To prove their point, the researchers devised an attack that allows a server to steal keystrokes typed into the protected SSH (or <a href="https://en.wikipedia.org/wiki/Secure_Shell">secure shell</a> session) established between another server and an application server.</p>
<h2>Merely scratching the surface</h2>
<p>The researchers have named their attack NetCAT, short for Network Cache ATtack. Their research is prompting an <a href="https://software.intel.com/security-software-guidance/insights/more-information-netcat">advisory for Intel</a> that effectively recommends turning off either DDIO or RDMA in untrusted networks. The researchers say future attacks may be able to steal other types of data, possibly even when RDMA isn&apos;t enabled. They are also advising hardware makers do a better job of securing microarchitectural enhancements before putting them into billions of real-world servers.</p>
<p>&quot;While NetCAT is powerful even with only minimal assumptions, we believe that we have merely scratched the surface of possibilities for network-based cache attacks, and we expect similar attacks based on NetCAT in the future,&quot; the researchers, from the Vrije Universiteit Amsterdam and ETH Zurich, wrote in a <a href="https://www.vusec.net/projects/netcat/">paper published on Tuesday</a>. &quot;We hope that our efforts caution processor vendors against exposing microarchitectural elements to peripherals without a thorough security design to prevent abuse.&quot;</p>
<p>The researchers devised NetCAT after reverse-engineering DDIO and finding that last-level caches were sharing data across CPUs and peripherals, even when they received untrusted or potentially malicious input. Among the things this shared resource divulged was the precise arrival times of data packets sent in sensitive connections such as SSH. The information gave the researchers a <a href="https://en.wikipedia.org/wiki/Side-channel_attack">side channel</a>&#xA0;they could use to deduce the contents of each keystroke.</p>
<p>NetCAT is based partly on the observation that humans follow largely universal typing patterns that can often reveal clues about the keys they enter into a keyboard. For instance, it&apos;s usually faster for most people to type an &quot;s&quot; immediately after an &quot;a&quot; than to type a &quot;g&quot; right after typing an &quot;s.&quot; These patterns allowed the researchers to use DDIO to carry out a keystroke timing attack, similar to <a href="https://users.ece.cmu.edu/~dawnsong/papers/ssh-timing.pdf">this one</a>, that uses statistical analysis of the inter-arrival timings of packets. Below is a video demonstrating the attack:</p>
<figure class="video"><div class="wrapper"><iframe type="text/html" width="560" height="315" src="https://www.youtube.com/embed/QXut1XBymAk?start=0&amp;wmode=transparent" class></iframe></div><figcaption class="caption"><div class="caption-text">NetCAT remotely leaking keystrokes from a victim SSH session.</div></figcaption></figure>
<p>The researchers used rapid delivery provided by RDMA to simplify the attack, but it&apos;s not a strict requirement, and future attacks may not need it at all. In an email, Kaveh Razavi, one of the Vrije Universiteit researchers who wrote the paper <em>NetCAT: Practical Cache Attacks from the Network</em>, wrote:</p>
<blockquote><p>In short, the root cause of the vulnerability boils down to Intel&apos;s DDIO feature enabling the (last-level) CPU cache to be shared with arbitrary peripherals such as network cards. This dramatically extends the attack surface of traditional cache side-channel attacks, which are normally mounted on a local setting (say from a VM to another in the cloud), exposing servers to cache side-channel disclosure from untrusted clients over the network. Using RDMA (for convenience), we have demonstrated the vulnerability can be exploited in real-world settings to leak sensitive information (e.g., keystrokes from an SSH session).</p></blockquote>
<h2>PRIME+PROBE</h2>
<p>To suss out the timing information from the last-level cache, the researchers used a technique known as PRIME+PROBE. It involves first priming the cache by receiving packets that will be read from certain memory locations. The result: the technique brings the cache to a known state. The attack then waits for the target SSH client to type a letter. That triggers the PROBE stage, which attempts to detect any changes by receiving the same packets from the same memory locations.</p>
<p>&quot;If the client has typed a key, then these packets will arrive slightly slower, signaling a keystroke,&quot; Razavi wrote. &quot;By performing PRIME+PROBE in a loop, NetCAT can find out whenever the victim types something in a network connection.&quot;</p>
<p>The researchers proposed a second attack scenario that uses DDIO as a covert channel to funnel sensitive data off a server. In one variation, the covert channel connects a targeted server to an unnetworked, cooperating sandboxed process on a remote machine. A second variation creates a covert channel between two cooperating network clients running inside two separate networks.</p>
<p>Covert channels are mechanisms attackers use to transfer data between processes or hardware that are barred by security policies from communicating with one another. By stealthily bypassing this policy, attackers can steal sensitive data in a way that&apos;s not detectable by the target.</p>
<p>The research is impressive, and the vulnerability it reveals is serious. Anyone who uses Intel-made processors inside data centers or other untrusted networks should carefully review the research, Intel&apos;s advisory, and any advisories by the network provider to ensure DDIO doesn&apos;t present a threat. People should also be aware that disabling DDIO comes at a significant performance cost. So far as the researchers know, chips from AMD and other manufacturers aren&apos;t vulnerable because they don&apos;t store networking data on shared CPU caches.</p>
<p>At the same time, people should remember that the research isn&apos;t likely to materialize into widespread attacks in the real world any time soon.</p>
<p>&quot;NetCAT is a complex attack and is likely not the low-hanging fruit for the attackers,&quot; Razavi wrote. &quot;In server settings with untrusted clients, where security matters more than performance, however, we recommend DDIO to be disabled.&quot;</p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
</body>
</html>