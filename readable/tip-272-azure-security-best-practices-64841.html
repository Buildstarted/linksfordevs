<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Tip 272 - Azure Security Best Practices - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Tip 272 - Azure Security Best Practices - linksfor.dev(s)"/>
    <meta property="og:description" content="When you run an application, it needs to be secure. There are many ways that attackers can attack your application and potentially get at your data or bring your app down. When you run your application in Azure, you get a lot of world-class protection out-of-the-box. However, you should still follow security best practices to make sure that your application and infrastructure in Azure is as secure as possible. In this post, we&#x27;ll explore some of the security best practices for Azure that can help you to make your application more secure."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://microsoft.github.io/AzureTipsAndTricks/blog/tip272.html"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Tip 272 - Azure Security Best Practices</title>
<div class="readable">
        <h1>Tip 272 - Azure Security Best Practices</h1>
            <div>Reading time: 11-14 minutes</div>
        <div>Posted here: 27 Jul 2020</div>
        <p><a href="https://microsoft.github.io/AzureTipsAndTricks/blog/tip272.html">https://microsoft.github.io/AzureTipsAndTricks/blog/tip272.html</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-v-0e4468e2=""> <h4 id="security-is-essential"> Security is essential</h4> <p>When you run an application, it needs to be secure. There are many ways that attackers can attack your application and potentially get at your data or bring your app down. When you run your application in Azure, you get a lot of world-class protection out-of-the-box. However, you should still follow security best practices to make sure that your application and infrastructure in Azure is as secure as possible. In this post, we'll explore some of the security best practices for Azure that can help you to make your application more secure.</p> <h4 id="_1-encrypt-data-at-rest-and-in-flight"> 1. Encrypt data at rest and in-flight</h4> <p>Your data is often the most important asset of your business. This means that you need to protect it against attackers. There are many things that you can do, but in the worst-case scenario, it could be that an attacker gains access to your data, like data in your <a href="https://docs.microsoft.com/azure/sql-database/sql-database-technical-overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure SQL Database</a>. Even if this happens, your data can be protected. Because by default, <a href="https://docs.microsoft.com/azure/sql-database/transparent-data-encryption-azure-sql?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">TDE (Transparent Data Encryption)</a> is enabled in Azure SQL and <a href="https://azure.microsoft.com/services/synapse-analytics?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Synapse Analytics</a>. And equivalent technology is enabled for <a href="https://azure.microsoft.com/services/postgresql?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Database of PostgreSQL</a> and <a href="https://azure.microsoft.com/services/mysql?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Database for MySQL</a>. These technologies encrypt your data, so that it is not readable by anybody but the services that hold the encryption keys. Azure manages the encryption keys for encryption of data at rest. And if you need to, you can <a href="https://docs.microsoft.com/azure/sql-database/transparent-data-encryption-byok-azure-sql?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">bring your own encryption keys</a> to Azure SQL Database and Azure Synapse Analytics.</p> <p><img src="https://microsoft.github.io/AzureTipsAndTricks/files/60azuresqltde.png"></p><p>(Azure SQL Database TDE setting)</p> <p><a href="https://azure.microsoft.com/services/storage?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Storage</a> also encrypts data at rest by default. This encryption cannot be disabled, which is a good thing. By default, Azure manages the encryption keys for Azure Storage encryption. You can also bring your own encryption keys to encrypt and decrypt data in <a href="https://azure.microsoft.com/services/storage/blobs?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Blob Storage</a> and <a href="https://azure.microsoft.com/services/storage/files?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Files</a>.</p> <p>Encrypting data at rest is very important, but it is also important to make sure that attackers can't intercept data when it travels from service to service or to a web browser. This type of data is called in-flight data and you can encrypt it using TLS (also called SSL) encryption. TLS is enabled for all Azure services by default and for most services, it cannot be disabled. It encrypts the tunnel that data travels through. On top of using TLS, you can use the <a href="https://docs.microsoft.com/dotnet/api/overview/azure/storage/?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Storage Client Library</a> to encrypt data within client applications before uploading to Azure Storage, and decrypting data while downloading to the client.</p> <p>The best practices to take away are:</p> <ul><li>Always encrypt data at rest</li> <li>Always encrypt in-flight data</li></ul> <h4 id="_2-restrict-access-to-your-databases"> 2. Restrict access to your databases</h4> <p>Your databases serve as the backbone of your applications. Your applications need to access them and sometimes administrators need to access them from workstations, to run queries or perform maintenance. How can you make sure that your databases can be accessed securely, without leaving vulnerabilities that attackers might use to gain access to your database?</p> <p>In <a href="https://docs.microsoft.com/azure/sql-database/sql-database-technical-overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure SQL Databases</a>, <a href="https://azure.microsoft.com/services/synapse-analytics?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Synapse Analytics</a>, <a href="https://azure.microsoft.com/services/postgresql?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Database for PostgreSQL</a> and <a href="https://azure.microsoft.com/services/mysql?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Database for MySQL</a>, you should make sure that firewalls are enabled. The firewall for these services is enabled by default and only let's Azure services through and IP-addresses that you specify. This is a big restriction on who can access your database, which is a really good step towards securing your databases.</p> <p><img src="https://microsoft.github.io/AzureTipsAndTricks/files/60azuresqlfirewall.png"></p><p>(Azure SQL Database Firewall)</p> <p>Using the database firewall is a good idea, but is hard to manage in a production environment. In production, you ideally want the database to be completely shielded from the outside world, and be only accessible from the services that you want. You can do that by using <a href="https://docs.microsoft.com/azure/sql-database/sql-database-private-endpoint-overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Private Link</a>, which allows you to connect to various services in Azure via a private endpoint. A private endpoint is a private IP address within a specific VNet and Subnet. With Private Link, you could grant access to your web application and maybe to a Virtual Machine in the VNet, that you use to log into the database (using a tool like <a href="https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">SQL Server Management Studio</a>) and manage it.</p> <p>The databases in Azure also <a href="https://docs.microsoft.com/azure/sql-database/sql-database-aad-authentication-configure?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">support authentication through an Azure Active Directory (AAD) account</a>. When you use an AAD account, instead of a database server specific account (like a SQL Server Authentication account), your database is more secure, because:</p> <ul><li>An AAD account can authenticate identities on a database level, where a database server specific account grants access to the whole server and all its databases by default</li> <li>You can manage password policies and password rotation for an AAD account in a single place</li> <li>Authenticating with AAD accounts is secure by default. You can couple it to a Windows user you can enable Multi-Factor Authentication</li></ul> <p>The best practices to take away are:</p> <ul><li>Enable database firewalls and maintain them strictly</li> <li>In production, shield databases from the outside world using <a href="https://azure.microsoft.com/services/private-link?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Private Link</a></li> <li>Use <a href="https://azure.microsoft.com/services/active-directory?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Active Directory</a> accounts for database access</li></ul> <h4 id="_3-restrict-access-to-your-vms"> 3. Restrict access to your VMS</h4> <p>If you are running applications in Azure Virtual Machines (VM), or if you use a VM for something else, like managing a database, you need to make sure that the VM is secure. Most people log into a VM using RDP or SSH, which requires you to open ports on the VM that expose it to attackers. What can you do to make your VMs more secure?</p> <p>You should disable RDP/SSH Access to your VMs. When you create a VM in Azure, the RDP and SSH ports can be enabled in the creation wizard. Disable them as that minimizes the attack surface of your VM. Instead, you should deploy your VMs in a Virtual Network and use <a href="https://docs.microsoft.com/azure/bastion/bastion-overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Bastion</a> to access them. Azure Bastion provides secure RDP and SSH connectivity to your VMS, without the need to open RDP or SSH ports on your VMS. When you use Azure Bastion, your VMs don't need to have a public IP address, which means that attackers haven no chance of accessing the VM.</p> <p><img src="https://microsoft.github.io/AzureTipsAndTricks/files/60defaultports.png"></p><p>(Enable ports in the Azure VM creation wizard)</p> <p>The best practices to take away are:</p> <ul><li>Keep the RDP and SSH ports of your VMs disabled</li> <li>Use <a href="https://docs.microsoft.com/azure/bastion/bastion-overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Bastion</a> to connect to your VMs</li></ul> <h4 id="_4-protect-your-application-secrets"> 4. Protect your application secrets</h4> <p>You applications store secrets, like API keys and connection keys, to connect to other services, like APIs and databases. It is not a good idea to store these secrets in application code, as the keys would be available for everybody who has access to the code. Instead, application secrets should be stored in a secure place, that is meant for storing secrets.</p> <p>In Azure, you should store your application secrets, keys and certificates in <a href="https://azure.microsoft.com/services/key-vault?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Key Vault</a>. Azure Key Vault is a secure service that your applications can connect to, in order to retrieve secrets. In addition to storing your secrets safely, you can let your secrets be managed by the people that should manage them (not by developers). For instance, a DevOps engineer can manage a connection string to a database in Azure Key Vault. Only that engineer handles the secret and anybody else that works on the application or infrastructure doesn't know the secret. This is a secure way of working.</p> <p>If secrets are stored in Azure Key Vault and your applications retrieve these secrets, how do your applications connect to Azure Key Vault? Your applications run in services like <a href="https://azure.microsoft.com/services/app-service/web?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Web Apps</a>, which support <a href="https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Managed Service Identities</a>. These are identities that live in Azure Active Directory. Using these, your Web Apps can be granted access to Azure Key Vault without using connection strings or API keys.</p> <p><img src="https://microsoft.github.io/AzureTipsAndTricks/files/60keyvaultsecret.png"></p><p>(Azure Key Vault secret)</p> <p>The best practices to take away are:</p> <ul><li>Store application secrets in a central place, like <a href="https://azure.microsoft.com/services/key-vault?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Key Vault</a></li> <li>Use a built-in mechanism, like <a href="https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Managed Service Identities</a>, to connect to Azure Key Vault</li></ul> <h4 id="_5-use-a-separate-azure-subscription-for-production"> 5. Use a separate Azure Subscription for production</h4> <p>You might have many different environment that you use to develop and test your applications. These environments might be separated into different Azure Resource Groups to make it clear which service belongs to which environment. You could use this mechanism to secure access to your services, as you can apply <a href="https://docs.microsoft.com/azure/role-based-access-control/overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Role-based Access Control (RBAC)</a> to Resource Groups. Using RBAC, you can grant rights to certain people, to be able to manage services in certain resource groups. This works well and is recommended for development and test environments.</p> <p>For production environments, the best practice is to create a separate Azure subscription. This helps you keep your production data and other assets out of your dev/test environments. You can also easily apply two different sets of policies across the resources in the two subscriptions. If your setup is complicated and contains many services, possibly spread out over multiple geographic locations and serving different purposes, you might want to consider creating an <a href="https://docs.microsoft.com/azure/cloud-adoption-framework/decision-guides/subscriptions?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Management Group structure</a> that can have multiple subscriptions and policies for the production environment.</p> <p>The best practices to take away are:</p> <ul><li>Always apply <a href="https://docs.microsoft.com/azure/role-based-access-control/overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Role-based Access Control</a> to control who can access which Azure resources</li> <li>Separate production resources from non-production resources</li></ul> <h4 id="_6-implement-a-web-application-firewall-waf"> 6. Implement a Web Application Firewall (WAF)</h4> <p>When your applications are exposed to the internet, they will be attacked. Common attacks that you face are SQL injection attacks and cross site scripting attacks and there are many more.</p> <p>You can protect your web applications from attacks by implementing a Web Application Firewall (WAF). In Azure, You can enable the <a href="https://docs.microsoft.com/azure/web-application-firewall/afds/afds-overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">WAF feature of Azure Front Door</a>, which is a service that you put in front of your web applications and it acts as a gateway to your applications, allowing you to set routing rules and filter traffic. You can also enable the WAF feature of <a href="https://docs.microsoft.com/azure/application-gateway/overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Application Gateway</a>, which is a similar service to <a href="https://azure.microsoft.com/services/frontdoor?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Front Door</a>, but operates on a different network layer and has different features. The WAF protects you against all sorts of attacks, including those from the <a href="https://owasp.org/www-project-modsecurity-core-rule-set?WT.mc_id=other-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Open Web Application Security Project (OWASP) core rule sets</a>.</p> <p>You can customize the behavior of the WAF by selecting the attack that it needs to protect against and telling it what to do when you get attacked. You can block an attack, forward it to somewhere else, log it, and more. You can also add more rules and restrict IP addresses that are allowed to access your web applications or limit the amount of traffic from certain IP addresses.</p> <p><img src="https://microsoft.github.io/AzureTipsAndTricks/files/60wafpolicies.png"></p><p>(Azure WAF policies)</p> <p>The best practices to take away are:</p> <ul><li>Implement a gateway service, like <a href="https://docs.microsoft.com/azure/application-gateway/overview?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Application Gateway</a> or <a href="https://azure.microsoft.com/services/frontdoor?WT.mc_id=azure-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Front Door</a>, in front of your web applications</li> <li>Enable the Web Application Firewall feature to protect you against attacks</li></ul> <h4 id="_7-use-azure-security-center-to-monitor-and-improve-security-and-act-on-security-events"> 7. Use Azure Security Center to monitor and improve security and act on security events</h4> <p>If there is only one best practice that you adopt from this post, it should be this one. Use <a href="https://docs.microsoft.com/azure/security-center/security-center-intro?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Security Center</a>. This is an Azure service that you can use for free, or in a paid tier, that tells you what your security state is, what you can improve and how to do that. You can use Azure Security Center to periodically check the security of your resources and to be alerted when something needs your attention. Security Center helps you to implement security best practices by telling you where they need to be implemented and allows you to directly implement them from the Security Center.</p> <p><img src="https://microsoft.github.io/AzureTipsAndTricks/files/60securitycenter.png"></p><p>(Azure Security Center)</p> <p>The best practice to take away is:</p> <ul><li>Use <a href="https://docs.microsoft.com/azure/security-center/security-center-intro?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Security Center</a></li></ul> <h4 id="conclusion"> Conclusion</h4> <p>Security is a complex topic. There are many things that you should do to optimize your security and maintain it. Learn more about Azure security best practices <a href="https://docs.microsoft.com/azure/security/fundamentals/best-practices-and-patterns?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">here</a> and make sure to use the <a href="https://docs.microsoft.com/azure/security-center/security-center-intro?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure Security Center</a> to implement the best practices in your Azure subscription. Stay safe!</p></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>