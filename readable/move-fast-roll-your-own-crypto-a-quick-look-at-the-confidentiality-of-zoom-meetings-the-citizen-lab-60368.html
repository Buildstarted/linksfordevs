<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Move Fast &amp; Roll Your Own Crypto: A Quick Look at the Confidentiality of Zoom Meetings - The Citizen Lab - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Move Fast &amp; Roll Your Own Crypto: A Quick Look at the Confidentiality of Zoom Meetings - The Citizen Lab - linksfor.dev(s)"/>
    <meta property="article:author" content="Bill Marczak"/>
    <meta property="og:description" content="This report examines the encryption that protects meetings in Zoom and finds that they have made their own encryption scheme and has significant weaknesses."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://citizenlab.ca/2020/04/move-fast-roll-your-own-crypto-a-quick-look-at-the-confidentiality-of-zoom-meetings/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Move Fast &amp; Roll Your Own Crypto: A Quick Look at the Confidentiality of Zoom Meetings - The Citizen Lab</title>
<div class="readable">
        <h1>Move Fast &amp; Roll Your Own Crypto: A Quick Look at the Confidentiality of Zoom Meetings - The Citizen Lab</h1>
            <div>by Bill Marczak</div>
            <div>Reading time: 21-27 minutes</div>
        <div>Posted here: 03 Apr 2020</div>
        <p><a href="https://citizenlab.ca/2020/04/move-fast-roll-your-own-crypto-a-quick-look-at-the-confidentiality-of-zoom-meetings/">https://citizenlab.ca/2020/04/move-fast-roll-your-own-crypto-a-quick-look-at-the-confidentiality-of-zoom-meetings/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="main" role="main" itemscope="" itemprop="mainContentOfPage" itemtype="http://schema.org/Blog" tabindex="-1">
			<section id="content">


						
							
                            
              <article id="post-73444" dir="ltr" 73444role="article" itemscope="" itemprop="blogPost" itemtype="http://schema.org/BlogPosting">

                <header>
                  <p dir="ltr"><a href="https://citizenlab.ca/category/research/">Research<img src="https://citizenlab.ca/wp-content/themes/citizenlab-1.9.8/library/images/chevron-left.svg" alt=""></a><a href="https://citizenlab.ca/category/research/app-privacy-and-security/">App Privacy and Controls</a></p>

                  
                    

                </header>                 <section itemprop="articleBody">
                  
<p><span>This report examines the encryption that protects meetings in the popular Zoom teleconference app. We find that Zoom has “rolled their own” encryption scheme, which has significant weaknesses. In addition, we identify potential areas of concern in Zoom’s infrastructure, including observing the transmission of meeting encryption keys through China.</span></p>
<h2><b>Key Findings</b></h2>
<ul><li><span>Zoom </span><a href="https://zoom.us/docs/doc/Zoom-Security-White-Paper.pdf"><span>documentation</span></a><span> claims that the app uses “AES-256” encryption for meetings where possible. However, we find that in each Zoom meeting, a single AES-128 key is used in ECB mode by all participants to encrypt and decrypt audio and video. The use of ECB mode is not recommended because patterns present in the plaintext are preserved during encryption.</span></li>
<li><span>The AES-128 keys, which we verified are sufficient to decrypt Zoom packets intercepted in Internet traffic, appear to be generated by Zoom servers, and in some cases, are delivered to participants in a Zoom meeting through servers in China, even when all meeting participants, and the Zoom subscriber’s company, are outside of China.</span></li>
<li><span>Zoom, a Silicon Valley-based company, appears to own three companies in China through which at least 700 employees are paid to develop Zoom’s software. This arrangement is ostensibly an effort at </span><i><span>labor arbitrage</span></i><span>: Zoom can avoid paying US wages while selling to US customers, thus increasing their profit margin. However, this arrangement may make Zoom responsive to pressure from Chinese authorities.</span><span><br></span></li>
</ul><h2><b>1. Background: A US Company with a Chinese Heart?</b></h2>
<p><span>Zoom is a popular teleconference app whose popularity has increased dramatically, given much of the world is under mandatory work-from-home orders due to the spread of COVID-19. The app’s overarching design goal seems to be reducing friction in videoconferencing and making things “</span><a href="https://www.youtube.com/watch?v=2udq_yL7ys8"><span>just work</span></a><span>.”</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image7.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image7.png" alt="" width="512" height="384" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image7.png 512w, https://citizenlab.ca/wp-content/uploads/2020/04/image7-300x225.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image7-453x340.png 453w, https://citizenlab.ca/wp-content/uploads/2020/04/image7-265x199.png 265w, https://citizenlab.ca/wp-content/uploads/2020/04/image7-369x277.png 369w, https://citizenlab.ca/wp-content/uploads/2020/04/image7-180x135.png 180w" sizes="(max-width: 512px) 100vw, 512px"></a></p><figcaption>Figure 1: A picture shows the Zoom logo above the name of one of Zoom’s Chinese developer companies, “Ruanshi Software (Suzhou) Ltd.” (<a href="http://www.sispark.com.cn:8180/manbuyunduan-2017-04_article-1037-8216.html">Source</a>)</figcaption></figure>
<p><span>While Zoom is headquartered in the United States, and listed on the NASDAQ, the mainline Zoom app appears to be developed by three companies in China, which all have the name 软视软件 (“Ruanshi Software”). </span><a href="https://www.tianyancha.com/company/2350548813"><span>Two</span></a> <a href="https://www.tianyancha.com/company/2329843620"><span>of</span></a><span> the three companies are owned by Zoom, whereas </span><a href="https://www.tianyancha.com/company/831873710"><span>one</span></a><span> is owned by an entity called 美国云视频软件技术有限公司 (“American Cloud Video Software Technology Co., Ltd.”) Job </span><a href="https://jobs.51job.com/yx/co5065032.html"><span>postings</span></a><span> for Ruanshi Software in Suzhou include open positions for C++ coders, Android and iOS app developers, and testing engineers.</span></p>
<p><span>Zoom’s </span><a href="https://investors.zoom.us/static-files/09a01665-5f33-4007-8e90-de02219886aa"><span>most recent SEC filing</span></a><span> shows that the company (through its Chinese affiliates) employs at least 700 employees in China that work in “research and development.” The filing also implies that 81% of Zoom’s revenue comes from North America. Running development out of China likely saves Zoom having to pay Silicon Valley salaries, reducing their expenses and increasing their profit margin. However, this arrangement could also open up Zoom to pressure from Chinese authorities. While the mainline Zoom app (zoom.us) was reportedly blocked in China in November 2019, there are several third-party Chinese companies that sell the Zoom app within China (e.g., zoom.cn, zoomvip.cn, zoomcloud.cn).</span></p>
<h3><b>Any Feature You Like, As Long As It’s Speed</b></h3>
<p><span>In the past few years, a number of security issues regarding Zoom have come to light. These issues have included unintentional bugs, such as vulnerabilities in Zoom’s </span><a href="https://medium.com/tenable-techblog/remotely-exploiting-zoom-meetings-5a811342ba1d"><span>screen sharing feature</span></a><span>, and privacy concerns, such as Zoom </span><a href="https://www.vice.com/en_us/article/k7e599/zoom-ios-app-sends-data-to-facebook-even-if-you-dont-have-a-facebook-account"><span>sharing data</span></a><span> with Facebook. However, perhaps the most prominent security issues with Zoom surround deliberate features designed to reduce friction in meetings, which also, by design, reduce privacy or security. This includes Zoom installing </span><a href="https://www.theverge.com/2019/7/9/20688113/zoom-apple-mac-patch-vulnerability-emergency-fix-web-server-remove"><span>a hidden web-server</span></a><span> on Mac computers to circumvent a Safari popup that users had to click through before they joined a Zoom meeting, a Zoom feature that </span><a href="https://twitter.com/c1truz_/status/1244737675191619584"><span>removes a password prompt</span></a><span> during the installation process (and instead displays a misleading password prompt later), a </span><a href="https://www.vice.com/en_us/article/k7e95m/zoom-leaking-email-addresses-photos"><span>Zoom feature</span></a><span> intended to allow Zoom users at the same company (or ISP) to easily find each other, and Zoom’s easy 9 or 10 digit code which is sufficient to join a meeting created with default settings, leading to the well-reported phenomenon of “</span><a href="https://www.fbi.gov/contact-us/field-offices/boston/news/press-releases/fbi-warns-of-teleconferencing-and-online-classroom-hijacking-during-covid-19-pandemic"><span>Zoom Bombing</span></a><span>.”</span></p>
<h3><b>Encryption Questions Come to Light</b></h3>
<p><span>Zoom’s documentation has a number of unclear claims about encryption that the platform offers. Some Zoom documentation (as well as the Zoom app itself) claims that Zoom offers a feature for “end-to-end (E2E) encrypted meetings.</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image4.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image4.png" alt="" width="654" height="186" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image4.png 654w, https://citizenlab.ca/wp-content/uploads/2020/04/image4-300x85.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image4-605x172.png 605w, https://citizenlab.ca/wp-content/uploads/2020/04/image4-297x84.png 297w, https://citizenlab.ca/wp-content/uploads/2020/04/image4-500x142.png 500w, https://citizenlab.ca/wp-content/uploads/2020/04/image4-180x51.png 180w" sizes="(max-width: 654px) 100vw, 654px"></a></p><figcaption>Figure 2: Zoom’s app displays a message incorrectly claiming that a call is “end-to-end” encrypted.</figcaption></figure>
<p><span>Typically, the computer security community understands the term “end-to-end encrypted” to mean that </span><i><span>only</span></i><span> the parties to the communication can access it (and not any middlemen that relay the communication). Other Zoom documentation </span><a href="https://support.zoom.us/hc/en-us/articles/201362723-Encryption-for-Meetings"><span>says that</span></a><span> Zoom’s meeting software for Windows, MacOS, and Linux “by default” uses the industry-standard TLS 1.2 scheme for transport encryption, though a </span><a href="https://blog.zoom.us/wordpress/2014/09/04/complete-guide-secure-zoom-experience/"><span>September 2014 blog post</span></a><span> implies that this software does </span><i><span>not</span></i><span> use TLS.</span></p>
<p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image10.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image10-1024x340.png" alt="" width="640" height="213" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image10-1024x340.png 1024w, https://citizenlab.ca/wp-content/uploads/2020/04/image10-300x100.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image10-768x255.png 768w, https://citizenlab.ca/wp-content/uploads/2020/04/image10-605x201.png 605w, https://citizenlab.ca/wp-content/uploads/2020/04/image10-297x99.png 297w, https://citizenlab.ca/wp-content/uploads/2020/04/image10-500x166.png 500w, https://citizenlab.ca/wp-content/uploads/2020/04/image10-180x60.png 180w, https://citizenlab.ca/wp-content/uploads/2020/04/image10.png 1444w" sizes="(max-width: 640px) 100vw, 640px"></a></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image3.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image3.png" alt="" width="712" height="502" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image3.png 712w, https://citizenlab.ca/wp-content/uploads/2020/04/image3-300x212.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image3-482x340.png 482w, https://citizenlab.ca/wp-content/uploads/2020/04/image3-282x199.png 282w, https://citizenlab.ca/wp-content/uploads/2020/04/image3-393x277.png 393w, https://citizenlab.ca/wp-content/uploads/2020/04/image3-180x127.png 180w" sizes="(max-width: 712px) 100vw, 712px"></a></p><figcaption>Figure 3a and 3b: Zoom claims regarding TLS and AES encryption (Source: Zoom documentation, Zoom website).</figcaption></figure>
<p><span>In response to this confusion, Zoom </span><a href="https://blog.zoom.us/wordpress/2020/04/01/facts-around-zoom-encryption-for-meetings-webinars/"><span>released a blog post</span></a><span> in April 2020 describing their encryption scheme. The blog post clarifies that Zoom does not currently implement “end-to-end” encryption as most people understand the term; Zoom used the term “end-to-end” to describe a situation where all conference participants (except those dialing in via the public switched telephone network) are required to use </span><i><span>transport</span></i><span> encryption between their devices and Zoom servers. Zoom’s definition of “end-to-end” </span><a href="https://help.webex.com/en-us/WBX44739/What-Does-End-to-End-Encryption-Do"><span>does not seem to be a standard one</span></a><span>, even in the realm of enterprise videoconferencing solutions. Because Zoom does not implement true end-to-end encryption, they have the theoretical ability to decrypt and monitor Zoom calls. Nevertheless, </span><a href="https://blog.zoom.us/wordpress/2020/04/01/facts-around-zoom-encryption-for-meetings-webinars/"><span>Zoom mentions</span></a><span> that they have not built any mechanism to intercept their customers meetings: </span><i><span>“</span></i><i><span>Zoom has never built a mechanism to decrypt live meetings for lawful intercept purposes, nor do we have means to insert our employees or others into meetings without being reflected in the participant list.”</span></i></p>
<p><span>Zoom’s </span><a href="https://blog.zoom.us/wordpress/2020/04/01/facts-around-zoom-encryption-for-meetings-webinars/"><span>April 2020 blog post </span></a><span>does not, however, provide details about exactly how their encryption works, or clarify whether they use TLS or AES-256. Because of the potentially misleading and conflicting claims regarding Zoom’s encryption, and the proliferation of Zoom’s technology in the business, government, civil society, and healthcare sectors where confidentiality may be desired, we decided to examine exactly how Zoom meetings are encrypted.</span></p>
<h2><b>2. COVID-19: A New Gold Rush for Cyber Spies</b></h2>
<p><span>Social distancing and work-from-home policies have shifted government, economic, and personal activity online. In the rush to reconnect, users are rapidly adopting new apps and communications platforms. Some popular video chat and collaboration tools have added </span><a href="https://www.cnbc.com/2020/02/26/zoom-has-added-more-users-so-far-this-year-than-in-2019-bernstein.html"><span>millions of users</span></a><span>, almost overnight. In many cases, consumer choice appears to be driven by the need for usability, speed, and stability, rather than careful assessment of privacy policies and security protocols.&nbsp;</span></p>
<p><span>At the same time, the newly remote workforce is heavily reliant on personal equipment and online accounts for work business. The shift away from work networks and accounts denies cyber defenders the ability to enforce security standards, while blocking their visibility into potential compromises.</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image6.jpg"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image6.jpg" alt="" width="860" height="693" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image6.jpg 860w, https://citizenlab.ca/wp-content/uploads/2020/04/image6-300x242.jpg 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image6-768x619.jpg 768w, https://citizenlab.ca/wp-content/uploads/2020/04/image6-422x340.jpg 422w, https://citizenlab.ca/wp-content/uploads/2020/04/image6-247x199.jpg 247w, https://citizenlab.ca/wp-content/uploads/2020/04/image6-344x277.jpg 344w, https://citizenlab.ca/wp-content/uploads/2020/04/image6-180x145.jpg 180w" sizes="(max-width: 860px) 100vw, 860px"></a></p><figcaption>Figure 4: UK PM Boris Johnson conducting a cabinet meeting over Zoom (<a href="https://twitter.com/AmichaiStein1/status/1244998914773827586">Source</a>).</figcaption></figure>
<p><span>Interactions that were previously conducted in the real world are now mediated by popular digital platforms. Until a few weeks ago, it would have been uncommon for high stakes business negotiations, high level diplomacy, political strategy conferences, and cabinet meetings to be conducted over platforms whose security properties are unknown. Eavesdropping on these encounters would have been out of reach to all but the most sophisticated digital adversaries.</span></p>
<p><span>Now, some of the most sensitive conversations in the world are taking place on devices and platforms vulnerable to basic forms of eavesdropping and attack techniques. This “new normal” is a </span><a href="https://medium.com/@_jsr/another-critical-covid-19-shortage-digital-security-374b1617fea7"><span>potential goldmine</span></a><span> for cyber spies. Given the business value of meetings currently being conducted on Zoom, it is reasonable to expect that the platform is being closely scrutinized by groups engaged in industrial and political espionage, and cybercrime.&nbsp;</span></p>
<h3><b>Zoom as an Intelligence Target</b></h3>
<p><span>Zoom’s success has led it to attract conversations that are of high priority interest to multiple governments. We suspect that this makes Zoom a high priority target for signals intelligence (SIGINT) gathering and targeted intrusion operations.</span></p>
<p><span>Most governments conduct electronic espionage operations. Their targets include other governments, businesses, and individuals. Some, including the Chinese government, are known to conduct </span><a href="https://www.cfr.org/report/threat-chinese-espionage"><span>extensive industrial espionage</span></a><span>. In addition, a growing number of governments have sought out </span><a href="https://citizenlab.ca/tag/nso-group/"><span>mobile phone hacking technology</span></a><span> and abused it to target the personal phones of journalists, lawyers, judges, and others who seek to hold them to account.</span></p>
<p><span>In addition, as digital rights advocacy group Access Now has pointed out in an open letter </span><a href="https://www.accessnow.org/cms/assets/uploads/2020/03/Letter-to-Zoom-.pdf"><span>calling for a transparency report</span></a><span>, Zoom has not publicly disclosed information such as statistics of requests for data by governments, and what Zoom has done in response to these requests. Zoom’s policies concerning notifications to users over breaches or the handing-over of data to governments are also unknown, however the company has just promised at the time of writing to release such a report </span><a href="https://blog.zoom.us/wordpress/2020/04/01/a-message-to-our-users/"><span>within 90 days of April 2nd</span></a><span>.</span></p>
<h2><b>3. Results: Custom Crypto, Chinese Servers, Security Issues</b></h2>
<p><span>Rather than using a standard protocol for sending voice and video, Zoom appears to implement their own transport protocol. The Zoom transport protocol appears to be a bespoke extension of the existing </span><a href="https://en.wikipedia.org/wiki/Real-time_Transport_Protocol"><span>RTP standard</span></a><span>.&nbsp;</span></p>
<p><span>The Zoom transport protocol adds Zoom’s own encryption scheme to RTP in an unusual way. By default, all participants’ audio and video in a Zoom meeting appears to be encrypted and decrypted with a single AES-128 key shared amongst the participants. The AES key appears to be generated and distributed to the meeting’s participants by Zoom servers. Zoom’s encryption and decryption use AES in ECB mode, which is well-understood to be a bad idea, because this mode of encryption preserves patterns in the input. Industry standard protocols for encryption of streaming media (e.g., the </span><a href="https://en.wikipedia.org/wiki/Secure_Real-time_Transport_Protocol"><span>SRTP standard</span></a><span>) recommend the use of AES in Segmented Integer Counter Mode or f8-mode, which do not have the same weakness as ECB mode. </span><b>Figure 5</b><span> is a classic illustration of the perils of ECB mode: the outline of a penguin is still visible in an image encrypted with ECB mode.<sup><a id="ref1" href="#fn1">1</a></sup></span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image1.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image1.png" alt="" width="804" height="484" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image1.png 804w, https://citizenlab.ca/wp-content/uploads/2020/04/image1-300x181.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image1-768x462.png 768w, https://citizenlab.ca/wp-content/uploads/2020/04/image1-565x340.png 565w, https://citizenlab.ca/wp-content/uploads/2020/04/image1-297x179.png 297w, https://citizenlab.ca/wp-content/uploads/2020/04/image1-460x277.png 460w, https://citizenlab.ca/wp-content/uploads/2020/04/image1-180x108.png 180w" sizes="(max-width: 804px) 100vw, 804px"></a></p><figcaption>Figure 5: A classic illustration of why ECB mode is not recommended. An image of a penguin (left) is encrypted in ECB mode and then visualized (right). Note that the outline of the penguin remains visible in the encrypted image (Source: Wikipedia).</figcaption></figure>
<p><span>During a test of a Zoom meeting with two users, one in the United States and one in Canada, we found that the AES-128 key for conference encryption and decryption was sent to one of the participants over TLS from a Zoom server apparently located in Beijing, 52.81.151.250. A scan shows </span><a href="https://censys.io/ipv4?q=%22zoom+is+ok%21%22+AND+%22zoom.us%22"><span>a total of</span></a><span> five servers in China and 68 in the United States that apparently run the same Zoom server software as the Beijing server. We suspect that keys may be distributed through these servers. A company </span><a href="https://investors.zoom.us/static-files/09a01665-5f33-4007-8e90-de02219886aa"><span>primarily catering</span></a><span> to North American clients that sometimes distributes encryption keys through servers in China is potentially concerning, given that Zoom may be </span><a href="https://www.newamerica.org/cybersecurity-initiative/digichina/blog/translation-cybersecurity-law-peoples-republic-china/"><span>legally obligated</span></a><span> to disclose these keys to authorities in China.</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest.png" alt="" width="966" height="508" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest.png 966w, https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest-300x158.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest-768x404.png 768w, https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest-605x318.png 605w, https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest-297x156.png 297w, https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest-500x263.png 500w, https://citizenlab.ca/wp-content/uploads/2020/04/ALICE-ZOOMS-BOB-latest-180x95.png 180w" sizes="(max-width: 966px) 100vw, 966px"></a></p><figcaption>Figure 6: The topology of our Zoom test call.</figcaption></figure>
<p><span>During our analysis, we also identified a security issue with Zoom’s </span><a href="https://support.zoom.us/hc/en-us/articles/115000332726-Waiting-Room"><span>Waiting Room</span></a><span> feature. Assessing that the issue presented a risk to users, we have initiated a responsible vulnerability disclosure process with Zoom. We are not currently providing public information about the issue to prevent it from being abused. We intend to publish details of the vulnerability once Zoom has had a chance to address the issue. In the meantime, </span><span>Section 5</span><span> provides recommendations on how users can mitigate the issue.</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image9.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image9-1024x803.png" alt="" width="640" height="502" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image9-1024x803.png 1024w, https://citizenlab.ca/wp-content/uploads/2020/04/image9-300x235.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image9-768x603.png 768w, https://citizenlab.ca/wp-content/uploads/2020/04/image9-433x340.png 433w, https://citizenlab.ca/wp-content/uploads/2020/04/image9-254x199.png 254w, https://citizenlab.ca/wp-content/uploads/2020/04/image9-353x277.png 353w, https://citizenlab.ca/wp-content/uploads/2020/04/image9-180x141.png 180w, https://citizenlab.ca/wp-content/uploads/2020/04/image9.png 1300w" sizes="(max-width: 640px) 100vw, 640px"></a></p><figcaption>Figure 7: A Zoom call participant in the Waiting Room, to be admitted to a Meeting Room.</figcaption></figure>
<h2><b>4. How we Investigated</b></h2>
<p><span>We began by observing Internet traffic associated with Zoom meetings using the Zoom clients on Windows, MacOS, and Linux. We used </span><a href="https://www.wireshark.org/"><span>Wireshark</span></a><span> to record our Internet traffic while we joined and participated in Zoom meetings. The vast majority of the Internet traffic during our Zoom meetings was exchanged between our computer and servers owned by Zoom on UDP port 8801. A further examination of the UDP traffic revealed that Zoom had apparently designed their own transport protocol, which wraps the well-known RTP protocol for transferring audio and video.</span></p>
<h3><b>Identifying Encrypted Video</b></h3>
<p><span>On some packets, whose UDP payload began with 0x05100100, the RTP header often encoded a type value of 98. In these packets, the RTP payload appeared to contain an H.264 video stream using the format in </span><a href="https://tools.ietf.org/html/rfc6184"><span>RFC 6184</span></a><span>. In this format, the RTP payload is a series of one or more NALUs (Network Abstraction Layer Units), which carry components of the video (e.g., various types of video frames, metadata on decoder settings, etc). Some of the NALUs were </span><i><span>fragmented</span></i><span> using the scheme from the RFC for “Fragmentation Unit A” (FU-A). We re-assembled these into unfragmented NALUs. Per </span><a href="https://tools.ietf.org/html/rfc6184"><span>the RFC</span></a><span>, each NALU has a “type value” indicating which component of the video it carries. In Zoom’s case, all of the NALU values were set to zero, which is invalid per the RFC, so we suspected that the NALU payload was a format bespoke to Zoom.</span></p>
<p><span>Each NALU payload consisted of a 4-byte big-endian value that appeared to describe a length (these 4-byte values were all less than, but close to the size of the packets), followed by a number of bytes that was always the lowest multiple of 16 larger than the 4-byte length value (i.e., if the 4-byte length value was between 145 and 160, it would be followed by 160 bytes). This suggested to us the use of the AES encryption scheme, which operates on blocks of 16 bytes. If the length of a message to be encrypted is not a multiple of 16 bytes, then </span><i><span>padding</span></i><span> is added to the end of the message to inflate the length to a multiple of 16. An examination of a memory dump of the Zoom process during a meeting revealed an AES-128 key in memory associated with the string </span><i><span>conf.skey</span></i><span>, which we speculated stood for “conference secret key.”</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image2.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image2-1024x669.png" alt="" width="640" height="418" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image2-1024x669.png 1024w, https://citizenlab.ca/wp-content/uploads/2020/04/image2-300x196.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image2-768x502.png 768w, https://citizenlab.ca/wp-content/uploads/2020/04/image2-521x340.png 521w, https://citizenlab.ca/wp-content/uploads/2020/04/image2-297x194.png 297w, https://citizenlab.ca/wp-content/uploads/2020/04/image2-424x277.png 424w, https://citizenlab.ca/wp-content/uploads/2020/04/image2-180x118.png 180w, https://citizenlab.ca/wp-content/uploads/2020/04/image2.png 1280w" sizes="(max-width: 640px) 100vw, 640px"></a></p><figcaption>Figure 8: A novelty placard and a Citizen Lab notebook are visible in this frame of H.264 video we extracted from a PCAP of a Zoom call and decrypted using the AES-128 conf.skey in ECB mode.</figcaption></figure>
<p><span>To extract video for each participant, we first grouped the RTP packets by the SSRC (Synchronization Source Identifier) value in the RTP header. Each SSRC value indicates a single participant. For each SSRC, we reassembled fragmented H264 NALUs in the correct order using RTP timestamps and sequence numbers, then decrypted them with the AES-128 key in ECB mode, then de-padded the decrypted result (using the 4-byte length value), and finally wrote the decrypted data to disk in a raw H.264 stream file. We were able to play the file using the following </span><a href="https://en.wikipedia.org/wiki/VLC_media_player"><span>VLC media player</span></a><span> command:</span></p>
<p><code>$ vlc raw.h264 --demux h264</code></p>
<h3><b>Identifying Encrypted Audio</b></h3>
<p><span>We also noticed other packets in our Wireshark capture that began with the header value 0x050f0100 and the RTP header in these packets often contained a type value of 112. In these packets, the RTP timestamp was incremented by 640 between subsequent packets. We located a </span><a href="https://commons.erau.edu/cgi/viewcontent.cgi?article=1174&amp;context=jdfsl"><span>research paper</span></a><span> that describes how to infer the type of RTP audio codecs by looking at various metadata in the RTP packets, including the difference between the RTP timestamps in subsequent packets. The paper provides one possibility for a timestamp difference of 640, which is the </span><a href="https://en.wikipedia.org/wiki/SILK"><span>Skype-developed SILK codec</span></a><span>, at a 16000Hz sample rate. We also noted that the RTP payloads in these packets appeared to have a similar encryption format as the NALU payloads in the video packets, though they appeared to contain a two-byte rather than four-byte length header.</span></p>
<p><span>To extract audio for each participant, we first grouped the RTP packets by SSRC. For each participant (SSRC), we created a SILK file, beginning with the magic bytes “#!SILK_V3”. For each SSRC, we decrypted the bytes following the two-byte length value (using the same AES-128 key in ECB mode). We wrote the decrypted bytes, prepended with the two-byte length value (in little-endian byte order) from the RTP payload. We then obtained a </span><a href="https://github.com/kn007/silk-v3-decoder"><span>SILK transcoder</span></a><span> and successfully transcoded each SILK file into an MP3 containing the audio from one of the participants.</span></p>
<p><code>$ sh converter.sh raw.silk mp3</code></p>
<p><span><strong>Figure 9</strong> shows the layers of encapsulation involved in both Zoom video and audio packets.</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest.png" alt="" width="848" height="638" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest.png 848w, https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest-300x226.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest-768x578.png 768w, https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest-452x340.png 452w, https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest-265x199.png 265w, https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest-368x277.png 368w, https://citizenlab.ca/wp-content/uploads/2020/04/Zoom-Network-Protocol-latest-180x135.png 180w" sizes="(max-width: 848px) 100vw, 848px"></a></p><figcaption>Figure 9: A protocol layer diagram showing the encapsulation present on Zoom video (left) and audio (right) packets.</figcaption></figure>
<h3><b>Identifying AES Key Transmission</b></h3>
<p><span>We next sought out to discover how the meeting’s AES-128 encryption key (</span><i><span>conf.skey</span></i><span>) was derived. We noticed that before the large amount of traffic on UDP port 8801, there was some TLS traffic between our computer and Zoom servers. We set up </span><a href="https://mitmproxy.org/"><span>mitmproxy</span></a><span> to intercept the TLS traffic and configured the Zoom Linux client to route its TLS traffic through mitmproxy.<sup><a id="ref2" href="#fn2">2</a></sup></span><span> Fortunately, the Zoom client </span><i><span>did</span></i><span> appear to warn us that the fake TLS certificates generated by mitmproxy were untrusted. After we trusted the certificates, we observed a series of messages exchanged between our Zoom client and Zoom servers. In one of the messages, the Zoom server sent us the encryption key in </span><b>Figure 10</b><span>.</span></p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2020/04/image8.png"><img src="https://citizenlab.ca/wp-content/uploads/2020/04/image8-1024x71.png" alt="" width="640" height="44" srcset="https://citizenlab.ca/wp-content/uploads/2020/04/image8-1024x71.png 1024w, https://citizenlab.ca/wp-content/uploads/2020/04/image8-300x21.png 300w, https://citizenlab.ca/wp-content/uploads/2020/04/image8-768x53.png 768w, https://citizenlab.ca/wp-content/uploads/2020/04/image8-605x42.png 605w, https://citizenlab.ca/wp-content/uploads/2020/04/image8-297x21.png 297w, https://citizenlab.ca/wp-content/uploads/2020/04/image8-500x35.png 500w, https://citizenlab.ca/wp-content/uploads/2020/04/image8-180x12.png 180w, https://citizenlab.ca/wp-content/uploads/2020/04/image8.png 1070w" sizes="(max-width: 640px) 100vw, 640px"></a></p><figcaption>Figure 10: An example of an AES-128 conf.skey transmitted from the Zoom server to our Zoom client and decrypted with mitmproxy.</figcaption></figure>
<p><span>It is unclear to us whether Zoom servers use a cryptographically secure random number generator to create the meeting encryption keys or whether the keys may somehow be predictable. We confirmed that all participants in a Zoom meeting have the same </span><i><span>conf.skey</span></i><span> value and that this key does </span><i><span>not</span></i><span> change when participants join or leave. The key does, however, change when </span><i><span>all</span></i><span> users leave the meeting for a period of time; any new participant joining an empty meeting will cause the generation of a new </span><i><span>conf.skey</span></i><span> value.</span></p>
<h2><b>5. Conclusion: Not Suited for Secrets</b></h2>
<p><span>Zoom’s product is user-friendly and has </span><a href="https://www.cnbc.com/2020/02/26/zoom-has-added-more-users-so-far-this-year-than-in-2019-bernstein.html"><span>rapidly grown its user base</span></a><span> during the COVID-19 pandemic by “just working.” Zoom’s fast growing user base, combined with marketing language around encryption and security, have attracted many sensitive conversations. This sudden popularity likely puts the product in the crosshairs of government intelligence agencies and cybercriminals.</span></p>
<h3><b>Questionable Crypto &amp; Encryption Keys Sent to Beijing</b></h3>
<p><span>Unfortunately for those hoping for privacy, the implementation of call security in Zoom may not match its exceptional usability. We determined that the Zoom app uses non-industry-standard cryptographic techniques with identifiable weaknesses. In addition, during multiple test calls in North America, we observed keys for encrypting and decrypting meetings transmitted to servers in Beijing, China.&nbsp;</span></p>
<p><span>An app with easily-identifiable limitations in cryptography, security issues, and offshore servers located in China which handle meeting keys presents a clear target to reasonably well-resourced nation state attackers, including the People’s Republic of China.</span></p>
<p><span>Our report comes amidst a number of other recent research findings and lawsuits identifying other potential security and privacy concerns with the Zoom app. In addition, advocacy groups have also pointed out that </span><a href="https://www.accessnow.org/letter-to-zoom/"><span>Zoom lacks a transparency report,</span></a><span> a critical step towards addressing concerns arising when companies have access to sensitive user data. Zoom </span><a href="https://blog.zoom.us/wordpress/2020/04/01/a-message-to-our-users/"><span>has just stated</span></a><span> (April 2nd, 2020) that it will release such a report within 90 days.</span></p>
<p>As a result of these troubling security issues, we discourage the use of Zoom at this time for use cases that require strong privacy and confidentiality, including:</p>
<ul><li><span>Governments worried about espionage</span></li>
<li><span>Businesses concerned about cybercrime and industrial espionage</span></li>
<li><span>Healthcare providers handling sensitive patient information</span></li>
<li><span>Activists, lawyers, and journalists working on sensitive topics</span></li>
</ul><p><span>For those using Zoom to keep in touch with friends, hold social events, or organize courses or lectures that they might otherwise hold in a public or semi-public venue, our findings should not necessarily be concerning.</span></p>
<p><span>For those who have no choice but to use Zoom, including in contexts where secrets may be shared, we speculate that the browser plugin may have some marginally better security properties, as data transmission occurs over TLS.&nbsp;</span></p>
<h3><b>Use Zoom Passwords, Avoid Waiting Rooms</b></h3>
<p><span>As part of our research, we identified what we believe to be a serious security issue with Zoom’s </span><a href="https://support.zoom.us/hc/en-us/articles/115000332726-Waiting-Room"><span>Waiting Room</span></a><span> feature. We have initiated a responsible disclosure process with Zoom, which is currently being responsive. We hope that the company will quickly act to patch and provide an advisory. In the meantime, we advise Zoom users who desire confidentiality to</span> <b><i>not</i></b><b> use Zoom Waiting Rooms</b><span>. Instead, we encourage users to </span><b>use Zoom’s password feature</b><span>, which appears to offer a higher level of confidentiality than waiting rooms. Instructions on password features </span><a href="https://support.zoom.us/hc/en-us/articles/360033559832-Meeting-and-Webinar-Passwords-"><span>can be found here</span></a><span>.</span></p>
<h3><b>Scrutiny Needed</b></h3>
<p><span>The rapid uptake of teleconference platforms such as Zoom, without proper vetting, potentially puts trade secrets, state secrets, and human rights defenders at risk. Companies and individuals might erroneously assume that because a company is publicly listed or is a major household name, that this means the app is designed using security best practices.&nbsp;</span></p>
<p><span>As we showed in this report, that assumption is false.</span></p>
<h2><b>Acknowledgements</b></h2>
<p><span>Thanks to Masashi Nishihata, Miles Kenyon, and Lotus Ruan.&nbsp;&nbsp;</span></p>
<p><span>Bill Marczak’s work on this report is partially supported by </span><a href="https://cltc.berkeley.edu/"><span>the Center for Long Term Cybersecurity (CLTC) at UC Berkeley</span></a> and <a href="https://www.icsi.berkeley.edu/icsi/"><span>the International Computer Science Institute</span></a>,</p>
<p><span>The Citizen Lab is grateful for support from <a href="https://www.fordfoundation.org/">the Ford Foundation</a> and</span>&nbsp;<a href="https://www.macfound.org/">the John D. and Catherine T MacArthur Foundation</a>.</p>
<hr><h2>Footnotes</h2>
<p><sup id="fn1">1.</sup> Note that the penguin image on the left of Figure 5 is an uncompressed bitmap. If it were compressed (e.g., a JPEG or PNG), visualizing the outline of the encrypted penguin on the right would be somewhat more difficult.<a role="doc-backlink" href="#ref1">↩︎</a><br><sup id="fn2">2.</sup> The Zoom Linux client allows a feature for explicitly configuring an HTTPS proxy, whereas the Mac and Windows clients do not appear to have this feature. <a role="doc-backlink" href="#ref2">↩︎</a></p>
                </section>
                                 
              </article> 
						
						
			</section>
		</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>