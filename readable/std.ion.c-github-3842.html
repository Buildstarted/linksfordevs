<!DOCTYPE html>
<html lang="en">
<head>
    <title>linksfor.dev(s)</title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - std.ion.c</title>
<div class="readable">
        <h1>std.ion.c</h1>
        <p>
Reading time: 31-39 minutes        </p>
        <p><a href="https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38">https://gist.github.com/pervognsen/f76116abb2407a4d0438a2e9f554dc38</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
  <div id="file-std-ion-c">
      
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-std-ion-c-L1" data-line-number="1"></td>
        <td id="file-std-ion-c-LC1">import libc {...}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L2" data-line-number="2"></td>
        <td id="file-std-ion-c-LC2">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L3" data-line-number="3"></td>
        <td id="file-std-ion-c-LC3"><span>struct</span> Indexer {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L4" data-line-number="4"></td>
        <td id="file-std-ion-c-LC4">    get: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L5" data-line-number="5"></td>
        <td id="file-std-ion-c-LC5">    put: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L6" data-line-number="6"></td>
        <td id="file-std-ion-c-LC6">    del: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L7" data-line-number="7"></td>
        <td id="file-std-ion-c-LC7">    set: <span>func</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span> *, xi: usize, len: usize, stride: usize, size: usize);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L8" data-line-number="8"></td>
        <td id="file-std-ion-c-LC8">    <span>free</span>: <span>func</span>(data: <span>void</span>*);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L9" data-line-number="9"></td>
        <td id="file-std-ion-c-LC9">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L10" data-line-number="10"></td>
        <td id="file-std-ion-c-LC10">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L11" data-line-number="11"></td>
        <td id="file-std-ion-c-LC11"><span>struct</span> Index {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L12" data-line-number="12"></td>
        <td id="file-std-ion-c-LC12">    data: <span>void</span>*;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L13" data-line-number="13"></td>
        <td id="file-std-ion-c-LC13">    indexer: Indexer*;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L14" data-line-number="14"></td>
        <td id="file-std-ion-c-LC14">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L15" data-line-number="15"></td>
        <td id="file-std-ion-c-LC15">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L16" data-line-number="16"></td>
        <td id="file-std-ion-c-LC16">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L17" data-line-number="17"></td>
        <td id="file-std-ion-c-LC17">func <span>index_get</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L18" data-line-number="18"></td>
        <td id="file-std-ion-c-LC18">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>get</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L19" data-line-number="19"></td>
        <td id="file-std-ion-c-LC19">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L20" data-line-number="20"></td>
        <td id="file-std-ion-c-LC20">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L21" data-line-number="21"></td>
        <td id="file-std-ion-c-LC21">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L22" data-line-number="22"></td>
        <td id="file-std-ion-c-LC22">func <span>index_put</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L23" data-line-number="23"></td>
        <td id="file-std-ion-c-LC23">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>put</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L24" data-line-number="24"></td>
        <td id="file-std-ion-c-LC24">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L25" data-line-number="25"></td>
        <td id="file-std-ion-c-LC25">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L26" data-line-number="26"></td>
        <td id="file-std-ion-c-LC26">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L27" data-line-number="27"></td>
        <td id="file-std-ion-c-LC27">func <span>index_del</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L28" data-line-number="28"></td>
        <td id="file-std-ion-c-LC28">    <span>return</span> <span>index</span>.<span>indexer</span>.<span>del</span>(<span>index</span>.<span>data</span>, a, x, len, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L29" data-line-number="29"></td>
        <td id="file-std-ion-c-LC29">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L30" data-line-number="30"></td>
        <td id="file-std-ion-c-LC30">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L31" data-line-number="31"></td>
        <td id="file-std-ion-c-LC31">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L32" data-line-number="32"></td>
        <td id="file-std-ion-c-LC32">func <span>index_set</span>(index: Index, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, xi: usize, len: usize, stride: usize, size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L33" data-line-number="33"></td>
        <td id="file-std-ion-c-LC33">    #<span>assert</span>(xi &lt; len);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L34" data-line-number="34"></td>
        <td id="file-std-ion-c-LC34">    <span>index</span>.<span>indexer</span>.<span>set</span>(<span>index</span>.<span>data</span>, a, x, xi, len, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L35" data-line-number="35"></td>
        <td id="file-std-ion-c-LC35">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L36" data-line-number="36"></td>
        <td id="file-std-ion-c-LC36">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L37" data-line-number="37"></td>
        <td id="file-std-ion-c-LC37">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L38" data-line-number="38"></td>
        <td id="file-std-ion-c-LC38">func <span>index_free</span>(index: Index) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L39" data-line-number="39"></td>
        <td id="file-std-ion-c-LC39">    <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L40" data-line-number="40"></td>
        <td id="file-std-ion-c-LC40">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L41" data-line-number="41"></td>
        <td id="file-std-ion-c-LC41">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L42" data-line-number="42"></td>
        <td id="file-std-ion-c-LC42">func <span>null_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, xi: usize, len: usize, stride: usize, size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L43" data-line-number="43"></td>
        <td id="file-std-ion-c-LC43">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L44" data-line-number="44"></td>
        <td id="file-std-ion-c-LC44">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L45" data-line-number="45"></td>
        <td id="file-std-ion-c-LC45">func <span>null_free</span>(data: <span>void</span>*) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L46" data-line-number="46"></td>
        <td id="file-std-ion-c-LC46">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L47" data-line-number="47"></td>
        <td id="file-std-ion-c-LC47">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L48" data-line-number="48"></td>
        <td id="file-std-ion-c-LC48">func <span>linear_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L49" data-line-number="49"></td>
        <td id="file-std-ion-c-LC49">    <span>for</span> (i := <span>0</span>; i &lt; len; i++) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L50" data-line-number="50"></td>
        <td id="file-std-ion-c-LC50">        <span>if</span> (<span>memcmp</span>(a + i*stride, x, size) == <span>0</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L51" data-line-number="51"></td>
        <td id="file-std-ion-c-LC51">            <span>return</span> i;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L52" data-line-number="52"></td>
        <td id="file-std-ion-c-LC52">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L53" data-line-number="53"></td>
        <td id="file-std-ion-c-LC53">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L54" data-line-number="54"></td>
        <td id="file-std-ion-c-LC54">    <span>return</span> len;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L55" data-line-number="55"></td>
        <td id="file-std-ion-c-LC55">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L56" data-line-number="56"></td>
        <td id="file-std-ion-c-LC56">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L57" data-line-number="57"></td>
        <td id="file-std-ion-c-LC57">var linear_indexer_const = Indexer{</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L58" data-line-number="58"></td>
        <td id="file-std-ion-c-LC58">    get = linear_get,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L59" data-line-number="59"></td>
        <td id="file-std-ion-c-LC59">    put = linear_get,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L60" data-line-number="60"></td>
        <td id="file-std-ion-c-LC60">    del = linear_get,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L61" data-line-number="61"></td>
        <td id="file-std-ion-c-LC61">    set = null_set,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L62" data-line-number="62"></td>
        <td id="file-std-ion-c-LC62">    <span>free</span> = null_free,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L63" data-line-number="63"></td>
        <td id="file-std-ion-c-LC63">};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L64" data-line-number="64"></td>
        <td id="file-std-ion-c-LC64">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L65" data-line-number="65"></td>
        <td id="file-std-ion-c-LC65">var linear_indexer = &amp;linear_indexer_const;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L66" data-line-number="66"></td>
        <td id="file-std-ion-c-LC66">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L67" data-line-number="67"></td>
        <td id="file-std-ion-c-LC67"><span>struct</span> HashSlot {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L68" data-line-number="68"></td>
        <td id="file-std-ion-c-LC68">    i: uint32;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L69" data-line-number="69"></td>
        <td id="file-std-ion-c-LC69">    h: uint32;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L70" data-line-number="70"></td>
        <td id="file-std-ion-c-LC70">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L71" data-line-number="71"></td>
        <td id="file-std-ion-c-LC71">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L72" data-line-number="72"></td>
        <td id="file-std-ion-c-LC72"><span>struct</span> HashIndex {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L73" data-line-number="73"></td>
        <td id="file-std-ion-c-LC73">    slots: HashSlot*;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L74" data-line-number="74"></td>
        <td id="file-std-ion-c-LC74">    mask: uint32;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L75" data-line-number="75"></td>
        <td id="file-std-ion-c-LC75">    occupied: uint32;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L76" data-line-number="76"></td>
        <td id="file-std-ion-c-LC76">    max_occupied: uint32;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L77" data-line-number="77"></td>
        <td id="file-std-ion-c-LC77">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L78" data-line-number="78"></td>
        <td id="file-std-ion-c-LC78">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L79" data-line-number="79"></td>
        <td id="file-std-ion-c-LC79"><span>const</span> HASH_EMPTY: uint32 = <span>0xffffffff</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L80" data-line-number="80"></td>
        <td id="file-std-ion-c-LC80"><span>const</span> HASH_DELETED: uint32 = <span>0xfffffffe</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L81" data-line-number="81"></td>
        <td id="file-std-ion-c-LC81"><span>const</span> HASH_MIN_SLOTS: uint32 = <span>16</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L82" data-line-number="82"></td>
        <td id="file-std-ion-c-LC82">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L83" data-line-number="83"></td>
        <td id="file-std-ion-c-LC83">func <span>hash</span>(buf: <span>void</span> <span>const</span>*, size: usize): uint64 {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L84" data-line-number="84"></td>
        <td id="file-std-ion-c-LC84">    h: uint64 = <span>0xcbf29ce484222325</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L85" data-line-number="85"></td>
        <td id="file-std-ion-c-LC85">    ptr: <span>char</span> <span>const</span>* = buf;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L86" data-line-number="86"></td>
        <td id="file-std-ion-c-LC86">    <span>for</span> (i := <span>0</span>; i &lt; size; i++) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L87" data-line-number="87"></td>
        <td id="file-std-ion-c-LC87">        h ^= *ptr++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L88" data-line-number="88"></td>
        <td id="file-std-ion-c-LC88">        h *= <span>0x100000001b3</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L89" data-line-number="89"></td>
        <td id="file-std-ion-c-LC89">        h ^= h &gt;&gt; <span>32</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L90" data-line-number="90"></td>
        <td id="file-std-ion-c-LC90">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L91" data-line-number="91"></td>
        <td id="file-std-ion-c-LC91">    <span>return</span> h;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L92" data-line-number="92"></td>
        <td id="file-std-ion-c-LC92">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L93" data-line-number="93"></td>
        <td id="file-std-ion-c-LC93">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L94" data-line-number="94"></td>
        <td id="file-std-ion-c-LC94">func <span>next_pow2</span>(x: uint32): uint32 {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L95" data-line-number="95"></td>
        <td id="file-std-ion-c-LC95">    x--;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L96" data-line-number="96"></td>
        <td id="file-std-ion-c-LC96">    x |= x &gt;&gt; <span>1</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L97" data-line-number="97"></td>
        <td id="file-std-ion-c-LC97">    x |= x &gt;&gt; <span>2</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L98" data-line-number="98"></td>
        <td id="file-std-ion-c-LC98">    x |= x &gt;&gt; <span>4</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L99" data-line-number="99"></td>
        <td id="file-std-ion-c-LC99">    x |= x &gt;&gt; <span>8</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L100" data-line-number="100"></td>
        <td id="file-std-ion-c-LC100">    x |= x &gt;&gt; <span>16</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L101" data-line-number="101"></td>
        <td id="file-std-ion-c-LC101">    x++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L102" data-line-number="102"></td>
        <td id="file-std-ion-c-LC102">    <span>return</span> x;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L103" data-line-number="103"></td>
        <td id="file-std-ion-c-LC103">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L104" data-line-number="104"></td>
        <td id="file-std-ion-c-LC104">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L105" data-line-number="105"></td>
        <td id="file-std-ion-c-LC105">func <span>hash_init</span>(index: HashIndex*, len: uint32) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L106" data-line-number="106"></td>
        <td id="file-std-ion-c-LC106">    num_slots := <span>next_pow2</span>(len + len/<span>2</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L107" data-line-number="107"></td>
        <td id="file-std-ion-c-LC107">    <span>if</span> (num_slots &lt; HASH_MIN_SLOTS) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L108" data-line-number="108"></td>
        <td id="file-std-ion-c-LC108">        num_slots = HASH_MIN_SLOTS;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L109" data-line-number="109"></td>
        <td id="file-std-ion-c-LC109">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L110" data-line-number="110"></td>
        <td id="file-std-ion-c-LC110">    <span>index</span>.<span>slots</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L111" data-line-number="111"></td>
        <td id="file-std-ion-c-LC111">    <span>index</span>.<span>mask</span> = num_slots - <span>1</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L112" data-line-number="112"></td>
        <td id="file-std-ion-c-LC112">    <span>index</span>.<span>occupied</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L113" data-line-number="113"></td>
        <td id="file-std-ion-c-LC113">    <span>index</span>.<span>max_occupied</span> = num_slots/<span>2</span> + num_slots/<span>4</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L114" data-line-number="114"></td>
        <td id="file-std-ion-c-LC114">    <span>afill</span>(<span>index</span>.<span>slots</span>, {HASH_EMPTY}, num_slots);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L115" data-line-number="115"></td>
        <td id="file-std-ion-c-LC115">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L116" data-line-number="116"></td>
        <td id="file-std-ion-c-LC116">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L117" data-line-number="117"></td>
        <td id="file-std-ion-c-LC117">func <span>hash_get_slot</span>(index: HashIndex*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, h: uint32, stride: usize, size: usize): HashSlot* {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L118" data-line-number="118"></td>
        <td id="file-std-ion-c-LC118">    <span>for</span> (i := h &amp; <span>index</span>.<span>mask</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L119" data-line-number="119"></td>
        <td id="file-std-ion-c-LC119">        slot := &amp;<span>index</span>.<span>slots</span>[i];</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L120" data-line-number="120"></td>
        <td id="file-std-ion-c-LC120">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY || (slot.<span>i</span> != HASH_DELETED &amp;&amp; h == slot.<span>h</span> &amp;&amp; <span>memcmp</span>(a + slot.<span>i</span>*stride, x, size) == <span>0</span>)) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L121" data-line-number="121"></td>
        <td id="file-std-ion-c-LC121">            <span>return</span> slot;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L122" data-line-number="122"></td>
        <td id="file-std-ion-c-LC122">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L123" data-line-number="123"></td>
        <td id="file-std-ion-c-LC123">        i++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L124" data-line-number="124"></td>
        <td id="file-std-ion-c-LC124">        <span>if</span> (i == <span>alen</span>(<span>index</span>.<span>slots</span>)) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L125" data-line-number="125"></td>
        <td id="file-std-ion-c-LC125">            i = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L126" data-line-number="126"></td>
        <td id="file-std-ion-c-LC126">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L127" data-line-number="127"></td>
        <td id="file-std-ion-c-LC127">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L128" data-line-number="128"></td>
        <td id="file-std-ion-c-LC128">    <span>return</span> <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L129" data-line-number="129"></td>
        <td id="file-std-ion-c-LC129">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L130" data-line-number="130"></td>
        <td id="file-std-ion-c-LC130">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L131" data-line-number="131"></td>
        <td id="file-std-ion-c-LC131">func <span>hash_put_slot</span>(index: HashIndex*, new_slot: HashSlot) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L132" data-line-number="132"></td>
        <td id="file-std-ion-c-LC132">    <span>for</span> (i := new_slot.<span>h</span> &amp; <span>index</span>.<span>mask</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L133" data-line-number="133"></td>
        <td id="file-std-ion-c-LC133">        slot := &amp;<span>index</span>.<span>slots</span>[i];</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L134" data-line-number="134"></td>
        <td id="file-std-ion-c-LC134">        <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L135" data-line-number="135"></td>
        <td id="file-std-ion-c-LC135">            *slot = new_slot;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L136" data-line-number="136"></td>
        <td id="file-std-ion-c-LC136">            <span>index</span>.<span>occupied</span>++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L137" data-line-number="137"></td>
        <td id="file-std-ion-c-LC137">            <span>return</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L138" data-line-number="138"></td>
        <td id="file-std-ion-c-LC138">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L139" data-line-number="139"></td>
        <td id="file-std-ion-c-LC139">        i++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L140" data-line-number="140"></td>
        <td id="file-std-ion-c-LC140">        <span>if</span> (i == <span>alen</span>(<span>index</span>.<span>slots</span>)) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L141" data-line-number="141"></td>
        <td id="file-std-ion-c-LC141">            i = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L142" data-line-number="142"></td>
        <td id="file-std-ion-c-LC142">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L143" data-line-number="143"></td>
        <td id="file-std-ion-c-LC143">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L144" data-line-number="144"></td>
        <td id="file-std-ion-c-LC144">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L145" data-line-number="145"></td>
        <td id="file-std-ion-c-LC145">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L146" data-line-number="146"></td>
        <td id="file-std-ion-c-LC146">func <span>hash_get</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L147" data-line-number="147"></td>
        <td id="file-std-ion-c-LC147">    <span>index</span>: HashIndex* = data;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L148" data-line-number="148"></td>
        <td id="file-std-ion-c-LC148">    h := <span>hash</span>(x, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L149" data-line-number="149"></td>
        <td id="file-std-ion-c-LC149">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L150" data-line-number="150"></td>
        <td id="file-std-ion-c-LC150">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L151" data-line-number="151"></td>
        <td id="file-std-ion-c-LC151">        <span>return</span> len;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L152" data-line-number="152"></td>
        <td id="file-std-ion-c-LC152">    } <span>else</span> {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L153" data-line-number="153"></td>
        <td id="file-std-ion-c-LC153">        <span>return</span> slot.<span>i</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L154" data-line-number="154"></td>
        <td id="file-std-ion-c-LC154">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L155" data-line-number="155"></td>
        <td id="file-std-ion-c-LC155">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L156" data-line-number="156"></td>
        <td id="file-std-ion-c-LC156">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L157" data-line-number="157"></td>
        <td id="file-std-ion-c-LC157">func <span>hash_put</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L158" data-line-number="158"></td>
        <td id="file-std-ion-c-LC158">    <span>index</span>: HashIndex* = data;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L159" data-line-number="159"></td>
        <td id="file-std-ion-c-LC159">    h := <span>hash</span>(x, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L160" data-line-number="160"></td>
        <td id="file-std-ion-c-LC160">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L161" data-line-number="161"></td>
        <td id="file-std-ion-c-LC161">    <span>if</span> (slot.<span>i</span> == HASH_EMPTY) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L162" data-line-number="162"></td>
        <td id="file-std-ion-c-LC162">        *slot = {len, h};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L163" data-line-number="163"></td>
        <td id="file-std-ion-c-LC163">        <span>index</span>.<span>occupied</span>++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L164" data-line-number="164"></td>
        <td id="file-std-ion-c-LC164">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L165" data-line-number="165"></td>
        <td id="file-std-ion-c-LC165">            <span>hash_rehash</span>(<span>index</span>, len + <span>1</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L166" data-line-number="166"></td>
        <td id="file-std-ion-c-LC166">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L167" data-line-number="167"></td>
        <td id="file-std-ion-c-LC167">        <span>return</span> len;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L168" data-line-number="168"></td>
        <td id="file-std-ion-c-LC168">    } <span>else</span> {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L169" data-line-number="169"></td>
        <td id="file-std-ion-c-LC169">        <span>return</span> slot.<span>i</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L170" data-line-number="170"></td>
        <td id="file-std-ion-c-LC170">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L171" data-line-number="171"></td>
        <td id="file-std-ion-c-LC171">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L172" data-line-number="172"></td>
        <td id="file-std-ion-c-LC172">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L173" data-line-number="173"></td>
        <td id="file-std-ion-c-LC173">func <span>hash_del</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, len: usize, stride: usize, size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L174" data-line-number="174"></td>
        <td id="file-std-ion-c-LC174">    <span>index</span>: HashIndex* = data;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L175" data-line-number="175"></td>
        <td id="file-std-ion-c-LC175">    h := <span>hash</span>(x, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L176" data-line-number="176"></td>
        <td id="file-std-ion-c-LC176">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L177" data-line-number="177"></td>
        <td id="file-std-ion-c-LC177">    i := slot.<span>i</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L178" data-line-number="178"></td>
        <td id="file-std-ion-c-LC178">    <span>if</span> (i != HASH_EMPTY) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L179" data-line-number="179"></td>
        <td id="file-std-ion-c-LC179">        *slot = {HASH_DELETED};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L180" data-line-number="180"></td>
        <td id="file-std-ion-c-LC180">        <span>return</span> i;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L181" data-line-number="181"></td>
        <td id="file-std-ion-c-LC181">    } <span>else</span> {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L182" data-line-number="182"></td>
        <td id="file-std-ion-c-LC182">        <span>return</span> len;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L183" data-line-number="183"></td>
        <td id="file-std-ion-c-LC183">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L184" data-line-number="184"></td>
        <td id="file-std-ion-c-LC184">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L185" data-line-number="185"></td>
        <td id="file-std-ion-c-LC185">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L186" data-line-number="186"></td>
        <td id="file-std-ion-c-LC186">func <span>hash_set</span>(data: <span>void</span>*, a: <span>void</span> <span>const</span>*, x: <span>void</span> <span>const</span>*, xi: usize, len: usize, stride: usize, size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L187" data-line-number="187"></td>
        <td id="file-std-ion-c-LC187">    <span>index</span>: HashIndex* = data;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L188" data-line-number="188"></td>
        <td id="file-std-ion-c-LC188">    h := <span>hash</span>(x, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L189" data-line-number="189"></td>
        <td id="file-std-ion-c-LC189">    slot := <span>hash_get_slot</span>(<span>index</span>, a, x, h, stride, size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L190" data-line-number="190"></td>
        <td id="file-std-ion-c-LC190">    i := slot.<span>i</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L191" data-line-number="191"></td>
        <td id="file-std-ion-c-LC191">    *slot = {xi, h};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L192" data-line-number="192"></td>
        <td id="file-std-ion-c-LC192">    <span>if</span> (i == HASH_EMPTY) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L193" data-line-number="193"></td>
        <td id="file-std-ion-c-LC193">        <span>index</span>.<span>occupied</span>++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L194" data-line-number="194"></td>
        <td id="file-std-ion-c-LC194">        <span>if</span> (<span>index</span>.<span>occupied</span> &gt;= <span>index</span>.<span>max_occupied</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L195" data-line-number="195"></td>
        <td id="file-std-ion-c-LC195">            <span>hash_rehash</span>(<span>index</span>, len + <span>1</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L196" data-line-number="196"></td>
        <td id="file-std-ion-c-LC196">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L197" data-line-number="197"></td>
        <td id="file-std-ion-c-LC197">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L198" data-line-number="198"></td>
        <td id="file-std-ion-c-LC198">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L199" data-line-number="199"></td>
        <td id="file-std-ion-c-LC199">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L200" data-line-number="200"></td>
        <td id="file-std-ion-c-LC200">func <span>hash_free</span>(data: <span>void</span>*) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L201" data-line-number="201"></td>
        <td id="file-std-ion-c-LC201">    <span>index</span>: HashIndex* = data;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L202" data-line-number="202"></td>
        <td id="file-std-ion-c-LC202">    <span>afree</span>(<span>index</span>.<span>slots</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L203" data-line-number="203"></td>
        <td id="file-std-ion-c-LC203">    <span>free</span>(<span>index</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L204" data-line-number="204"></td>
        <td id="file-std-ion-c-LC204">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L205" data-line-number="205"></td>
        <td id="file-std-ion-c-LC205">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L206" data-line-number="206"></td>
        <td id="file-std-ion-c-LC206">func <span>hash_rehash</span>(index: HashIndex*, len: uint32) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L207" data-line-number="207"></td>
        <td id="file-std-ion-c-LC207">    new_index: HashIndex;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L208" data-line-number="208"></td>
        <td id="file-std-ion-c-LC208">    <span>hash_init</span>(&amp;new_index, len);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L209" data-line-number="209"></td>
        <td id="file-std-ion-c-LC209">    <span>for</span> (i := <span>0</span>; i &lt; <span>alen</span>(<span>index</span>.<span>slots</span>); i++) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L210" data-line-number="210"></td>
        <td id="file-std-ion-c-LC210">        slot := <span>index</span>.<span>slots</span>[i];</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L211" data-line-number="211"></td>
        <td id="file-std-ion-c-LC211">        <span>if</span> (slot.<span>i</span> &lt; HASH_DELETED) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L212" data-line-number="212"></td>
        <td id="file-std-ion-c-LC212">            <span>hash_put_slot</span>(&amp;new_index, slot);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L213" data-line-number="213"></td>
        <td id="file-std-ion-c-LC213">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L214" data-line-number="214"></td>
        <td id="file-std-ion-c-LC214">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L215" data-line-number="215"></td>
        <td id="file-std-ion-c-LC215">    <span>afree</span>(<span>index</span>.<span>slots</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L216" data-line-number="216"></td>
        <td id="file-std-ion-c-LC216">    *<span>index</span> = new_index;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L217" data-line-number="217"></td>
        <td id="file-std-ion-c-LC217">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L218" data-line-number="218"></td>
        <td id="file-std-ion-c-LC218">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L219" data-line-number="219"></td>
        <td id="file-std-ion-c-LC219">var hash_indexer_const = Indexer{</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L220" data-line-number="220"></td>
        <td id="file-std-ion-c-LC220">    get = hash_get,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L221" data-line-number="221"></td>
        <td id="file-std-ion-c-LC221">    put = hash_put,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L222" data-line-number="222"></td>
        <td id="file-std-ion-c-LC222">    del = hash_del,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L223" data-line-number="223"></td>
        <td id="file-std-ion-c-LC223">    set = hash_set,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L224" data-line-number="224"></td>
        <td id="file-std-ion-c-LC224">    <span>free</span> = hash_free,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L225" data-line-number="225"></td>
        <td id="file-std-ion-c-LC225">};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L226" data-line-number="226"></td>
        <td id="file-std-ion-c-LC226">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L227" data-line-number="227"></td>
        <td id="file-std-ion-c-LC227">var hash_indexer = &amp;hash_indexer_const;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L228" data-line-number="228"></td>
        <td id="file-std-ion-c-LC228">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L229" data-line-number="229"></td>
        <td id="file-std-ion-c-LC229">func <span>hash_index</span>(): Index {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L230" data-line-number="230"></td>
        <td id="file-std-ion-c-LC230">    <span>index</span>: HashIndex* = <span>malloc</span>(<span>sizeof</span>(HashIndex));</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L231" data-line-number="231"></td>
        <td id="file-std-ion-c-LC231">    <span>hash_init</span>(<span>index</span>, <span>0</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L232" data-line-number="232"></td>
        <td id="file-std-ion-c-LC232">    <span>return</span> Index{data = <span>index</span>, indexer = hash_indexer};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L233" data-line-number="233"></td>
        <td id="file-std-ion-c-LC233">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L234" data-line-number="234"></td>
        <td id="file-std-ion-c-LC234">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L235" data-line-number="235"></td>
        <td id="file-std-ion-c-LC235">var default_indexer_const = Indexer{</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L236" data-line-number="236"></td>
        <td id="file-std-ion-c-LC236">    get = linear_get,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L237" data-line-number="237"></td>
        <td id="file-std-ion-c-LC237">    put = linear_get,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L238" data-line-number="238"></td>
        <td id="file-std-ion-c-LC238">    del = linear_get,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L239" data-line-number="239"></td>
        <td id="file-std-ion-c-LC239">    set = null_set,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L240" data-line-number="240"></td>
        <td id="file-std-ion-c-LC240">    <span>free</span> = null_free,</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L241" data-line-number="241"></td>
        <td id="file-std-ion-c-LC241">};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L242" data-line-number="242"></td>
        <td id="file-std-ion-c-LC242">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L243" data-line-number="243"></td>
        <td id="file-std-ion-c-LC243">var default_indexer = &amp;default_indexer_const;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L244" data-line-number="244"></td>
        <td id="file-std-ion-c-LC244">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L245" data-line-number="245"></td>
        <td id="file-std-ion-c-LC245"><span>struct</span> ArrayHdr {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L246" data-line-number="246"></td>
        <td id="file-std-ion-c-LC246">    len: usize;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L247" data-line-number="247"></td>
        <td id="file-std-ion-c-LC247">    cap: usize;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L248" data-line-number="248"></td>
        <td id="file-std-ion-c-LC248">    <span>index</span>: Index;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L249" data-line-number="249"></td>
        <td id="file-std-ion-c-LC249">    buf: <span>char</span>[];</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L250" data-line-number="250"></td>
        <td id="file-std-ion-c-LC250">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L251" data-line-number="251"></td>
        <td id="file-std-ion-c-LC251">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L252" data-line-number="252"></td>
        <td id="file-std-ion-c-LC252">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L253" data-line-number="253"></td>
        <td id="file-std-ion-c-LC253">func <span>ahdr</span>(a: <span>void</span>*): ArrayHdr* {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L254" data-line-number="254"></td>
        <td id="file-std-ion-c-LC254">    #<span>foreign</span>(preamble = <span><span>"</span>#define ahdr(a) ((std_ArrayHdr *)((char *)(a) - offsetof(std_ArrayHdr, buf)))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L255" data-line-number="255"></td>
        <td id="file-std-ion-c-LC255">    <span>return</span> a ? (:ArrayHdr*)(a - <span>offsetof</span>(ArrayHdr, buf)) : <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L256" data-line-number="256"></td>
        <td id="file-std-ion-c-LC256">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L257" data-line-number="257"></td>
        <td id="file-std-ion-c-LC257">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L258" data-line-number="258"></td>
        <td id="file-std-ion-c-LC258">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L259" data-line-number="259"></td>
        <td id="file-std-ion-c-LC259">func <span>alen</span>(a: <span>void</span>*): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L260" data-line-number="260"></td>
        <td id="file-std-ion-c-LC260">    <span>return</span> a ? <span>ahdr</span>(a).<span>len</span> : <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L261" data-line-number="261"></td>
        <td id="file-std-ion-c-LC261">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L262" data-line-number="262"></td>
        <td id="file-std-ion-c-LC262">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L263" data-line-number="263"></td>
        <td id="file-std-ion-c-LC263">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L264" data-line-number="264"></td>
        <td id="file-std-ion-c-LC264">func <span>acap</span>(a: <span>void</span>*): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L265" data-line-number="265"></td>
        <td id="file-std-ion-c-LC265">    <span>return</span> a ? <span>ahdr</span>(a).<span>cap</span> : <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L266" data-line-number="266"></td>
        <td id="file-std-ion-c-LC266">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L267" data-line-number="267"></td>
        <td id="file-std-ion-c-LC267">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L268" data-line-number="268"></td>
        <td id="file-std-ion-c-LC268">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L269" data-line-number="269"></td>
        <td id="file-std-ion-c-LC269">func <span>aclear</span>(a: <span>void</span>*) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L270" data-line-number="270"></td>
        <td id="file-std-ion-c-LC270">    <span>if</span> (a) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L271" data-line-number="271"></td>
        <td id="file-std-ion-c-LC271">        <span>ahdr</span>(a).<span>len</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L272" data-line-number="272"></td>
        <td id="file-std-ion-c-LC272">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L273" data-line-number="273"></td>
        <td id="file-std-ion-c-LC273">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L274" data-line-number="274"></td>
        <td id="file-std-ion-c-LC274">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L275" data-line-number="275"></td>
        <td id="file-std-ion-c-LC275">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L276" data-line-number="276"></td>
        <td id="file-std-ion-c-LC276">func <span>afree_func</span>(ap: <span>void</span>**) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L277" data-line-number="277"></td>
        <td id="file-std-ion-c-LC277">    a := *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L278" data-line-number="278"></td>
        <td id="file-std-ion-c-LC278">    <span>if</span> (a) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L279" data-line-number="279"></td>
        <td id="file-std-ion-c-LC279">        <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L280" data-line-number="280"></td>
        <td id="file-std-ion-c-LC280">        #<span>assert</span>(<span>index</span>.<span>indexer</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L281" data-line-number="281"></td>
        <td id="file-std-ion-c-LC281">        <span>index</span>.<span>indexer</span>.<span>free</span>(<span>index</span>.<span>data</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L282" data-line-number="282"></td>
        <td id="file-std-ion-c-LC282">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L283" data-line-number="283"></td>
        <td id="file-std-ion-c-LC283">    <span>free</span>(<span>ahdr</span>(a));</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L284" data-line-number="284"></td>
        <td id="file-std-ion-c-LC284">    *ap = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L285" data-line-number="285"></td>
        <td id="file-std-ion-c-LC285">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L286" data-line-number="286"></td>
        <td id="file-std-ion-c-LC286">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L287" data-line-number="287"></td>
        <td id="file-std-ion-c-LC287">@foreign</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L288" data-line-number="288"></td>
        <td id="file-std-ion-c-LC288">func <span>afree</span>(a: <span>void</span>*) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L289" data-line-number="289"></td>
        <td id="file-std-ion-c-LC289">    afree_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L290" data-line-number="290"></td>
        <td id="file-std-ion-c-LC290">    #<span>foreign</span>(preamble = <span><span>"</span>#define afree(a) std_afree_func(&amp;(a))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L291" data-line-number="291"></td>
        <td id="file-std-ion-c-LC291">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L292" data-line-number="292"></td>
        <td id="file-std-ion-c-LC292">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L293" data-line-number="293"></td>
        <td id="file-std-ion-c-LC293">func <span>aalloc_func</span>(): void* {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L294" data-line-number="294"></td>
        <td id="file-std-ion-c-LC294">    hdr: ArrayHdr* = <span>malloc</span>(<span>sizeof</span>(ArrayHdr));</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L295" data-line-number="295"></td>
        <td id="file-std-ion-c-LC295">    hdr.<span>len</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L296" data-line-number="296"></td>
        <td id="file-std-ion-c-LC296">    hdr.<span>cap</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L297" data-line-number="297"></td>
        <td id="file-std-ion-c-LC297">    hdr.<span>index</span> = {indexer = default_indexer};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L298" data-line-number="298"></td>
        <td id="file-std-ion-c-LC298">    <span>return</span> hdr.<span>buf</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L299" data-line-number="299"></td>
        <td id="file-std-ion-c-LC299">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L300" data-line-number="300"></td>
        <td id="file-std-ion-c-LC300">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L301" data-line-number="301"></td>
        <td id="file-std-ion-c-LC301">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L302" data-line-number="302"></td>
        <td id="file-std-ion-c-LC302">func <span>ainit_func</span>(ap: <span>void</span>**) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L303" data-line-number="303"></td>
        <td id="file-std-ion-c-LC303">    <span>if</span> (!*ap) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L304" data-line-number="304"></td>
        <td id="file-std-ion-c-LC304">        *ap = <span>aalloc_func</span>();</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L305" data-line-number="305"></td>
        <td id="file-std-ion-c-LC305">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L306" data-line-number="306"></td>
        <td id="file-std-ion-c-LC306">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L307" data-line-number="307"></td>
        <td id="file-std-ion-c-LC307">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L308" data-line-number="308"></td>
        <td id="file-std-ion-c-LC308">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L309" data-line-number="309"></td>
        <td id="file-std-ion-c-LC309">func <span>apop</span>(a: <span>void</span>*) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L310" data-line-number="310"></td>
        <td id="file-std-ion-c-LC310">    <span>if</span> (<span>alen</span>(a) &gt; <span>0</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L311" data-line-number="311"></td>
        <td id="file-std-ion-c-LC311">        <span>ahdr</span>(a).<span>len</span>--;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L312" data-line-number="312"></td>
        <td id="file-std-ion-c-LC312">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L313" data-line-number="313"></td>
        <td id="file-std-ion-c-LC313">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L314" data-line-number="314"></td>
        <td id="file-std-ion-c-LC314">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L315" data-line-number="315"></td>
        <td id="file-std-ion-c-LC315">func <span>afill_func</span>(ap: <span>void</span>**, x: <span>void</span> <span>const</span>*, n: usize, elem_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L316" data-line-number="316"></td>
        <td id="file-std-ion-c-LC316">    <span>afit_func</span>(ap, <span>alen</span>(*ap) + n, elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L317" data-line-number="317"></td>
        <td id="file-std-ion-c-LC317">    a := *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L318" data-line-number="318"></td>
        <td id="file-std-ion-c-LC318">    p := a + <span>alen</span>(a)*elem_size;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L319" data-line-number="319"></td>
        <td id="file-std-ion-c-LC319">    <span>for</span> (i := <span>0</span>; i &lt; n; i++) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L320" data-line-number="320"></td>
        <td id="file-std-ion-c-LC320">        <span>memcpy</span>(p, x, elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L321" data-line-number="321"></td>
        <td id="file-std-ion-c-LC321">        p += elem_size;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L322" data-line-number="322"></td>
        <td id="file-std-ion-c-LC322">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L323" data-line-number="323"></td>
        <td id="file-std-ion-c-LC323">    <span>ahdr</span>(a).<span>len</span> += n;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L324" data-line-number="324"></td>
        <td id="file-std-ion-c-LC324">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L325" data-line-number="325"></td>
        <td id="file-std-ion-c-LC325">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L326" data-line-number="326"></td>
        <td id="file-std-ion-c-LC326">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L327" data-line-number="327"></td>
        <td id="file-std-ion-c-LC327">func <span>afill</span>(a: <span>void</span>*, x: <span>void</span>, n: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L328" data-line-number="328"></td>
        <td id="file-std-ion-c-LC328">    afill_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L329" data-line-number="329"></td>
        <td id="file-std-ion-c-LC329">    #<span>foreign</span>(preamble = <span><span>"</span>#define afill(t, a, x, n) std_afill_func(&amp;(a), (t[]){x}, n, sizeof(t))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L330" data-line-number="330"></td>
        <td id="file-std-ion-c-LC330">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L331" data-line-number="331"></td>
        <td id="file-std-ion-c-LC331">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L332" data-line-number="332"></td>
        <td id="file-std-ion-c-LC332">@foreign</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L333" data-line-number="333"></td>
        <td id="file-std-ion-c-LC333">func <span>asetcap</span>(a: <span>void</span>*, new_cap: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L334" data-line-number="334"></td>
        <td id="file-std-ion-c-LC334">    asetcap_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L335" data-line-number="335"></td>
        <td id="file-std-ion-c-LC335">    #<span>foreign</span>(preamble = <span><span>"</span>#define asetcap(a, n) std_asetcap_func(&amp;(a), (n), sizeof(*(a)))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L336" data-line-number="336"></td>
        <td id="file-std-ion-c-LC336">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L337" data-line-number="337"></td>
        <td id="file-std-ion-c-LC337">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L338" data-line-number="338"></td>
        <td id="file-std-ion-c-LC338">@foreign</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L339" data-line-number="339"></td>
        <td id="file-std-ion-c-LC339">func <span>afit</span>(a: <span>void</span>*, min_cap: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L340" data-line-number="340"></td>
        <td id="file-std-ion-c-LC340">    afit_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L341" data-line-number="341"></td>
        <td id="file-std-ion-c-LC341">    #<span>foreign</span>(preamble = <span><span>"</span>#define afit(a, n) std_afit_func(&amp;(a), (n), sizeof(*(a)))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L342" data-line-number="342"></td>
        <td id="file-std-ion-c-LC342">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L343" data-line-number="343"></td>
        <td id="file-std-ion-c-LC343">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L344" data-line-number="344"></td>
        <td id="file-std-ion-c-LC344">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L345" data-line-number="345"></td>
        <td id="file-std-ion-c-LC345">func <span>apush</span>(a: <span>void</span>*, x: <span>void</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L346" data-line-number="346"></td>
        <td id="file-std-ion-c-LC346">    acap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L347" data-line-number="347"></td>
        <td id="file-std-ion-c-LC347">    alen;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L348" data-line-number="348"></td>
        <td id="file-std-ion-c-LC348">    ahdr;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L349" data-line-number="349"></td>
        <td id="file-std-ion-c-LC349">    asetcap_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L350" data-line-number="350"></td>
        <td id="file-std-ion-c-LC350">    #<span>foreign</span>(preamble = <span><span>"</span><span>"</span><span>"</span>#define apush(t, a, x)                                  \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L351" data-line-number="351"></td>
        <td id="file-std-ion-c-LC351"><span>    do {                                                \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L352" data-line-number="352"></td>
        <td id="file-std-ion-c-LC352"><span>        void **__ap = &amp;(a);                             \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L353" data-line-number="353"></td>
        <td id="file-std-ion-c-LC353"><span>        void *__a = *__ap;                              \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L354" data-line-number="354"></td>
        <td id="file-std-ion-c-LC354"><span>        size_t __n = std_alen(__a);                     \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L355" data-line-number="355"></td>
        <td id="file-std-ion-c-LC355"><span>        if (__n &lt; std_acap(__a)) {                      \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L356" data-line-number="356"></td>
        <td id="file-std-ion-c-LC356"><span>            ((t*)__a)[__n] = (x);                       \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L357" data-line-number="357"></td>
        <td id="file-std-ion-c-LC357"><span>            ahdr(__a)-&gt;len++;                           \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L358" data-line-number="358"></td>
        <td id="file-std-ion-c-LC358"><span>        } else {                                        \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L359" data-line-number="359"></td>
        <td id="file-std-ion-c-LC359"><span>            std_asetcap_func(__ap, __n+1, sizeof(t));   \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L360" data-line-number="360"></td>
        <td id="file-std-ion-c-LC360"><span>            __a = *__ap;                                \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L361" data-line-number="361"></td>
        <td id="file-std-ion-c-LC361"><span>            ((t*)__a)[__n] = (x);                       \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L362" data-line-number="362"></td>
        <td id="file-std-ion-c-LC362"><span>            ahdr(__a)-&gt;len++;                           \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L363" data-line-number="363"></td>
        <td id="file-std-ion-c-LC363"><span>        }                                               \</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L364" data-line-number="364"></td>
        <td id="file-std-ion-c-LC364"><span>    } while(0)<span>"</span><span>"</span><span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L365" data-line-number="365"></td>
        <td id="file-std-ion-c-LC365">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L366" data-line-number="366"></td>
        <td id="file-std-ion-c-LC366">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L367" data-line-number="367"></td>
        <td id="file-std-ion-c-LC367">@foreign</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L368" data-line-number="368"></td>
        <td id="file-std-ion-c-LC368">func <span>aprintf</span>(a: <span>char</span>*, fmt: <span>char</span> <span>const</span>*, ...) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L369" data-line-number="369"></td>
        <td id="file-std-ion-c-LC369">    aprintf_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L370" data-line-number="370"></td>
        <td id="file-std-ion-c-LC370">    #<span>foreign</span>(preamble = <span><span>"</span>#define aprintf(a, fmt, ...) std_aprintf_func(&amp;(a), (fmt), __VA_ARGS__)<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L371" data-line-number="371"></td>
        <td id="file-std-ion-c-LC371">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L372" data-line-number="372"></td>
        <td id="file-std-ion-c-LC372">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L373" data-line-number="373"></td>
        <td id="file-std-ion-c-LC373">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L374" data-line-number="374"></td>
        <td id="file-std-ion-c-LC374">func <span>acatn</span>(a: <span>void</span>*, src: <span>void</span>*, src_len: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L375" data-line-number="375"></td>
        <td id="file-std-ion-c-LC375">    acatn_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L376" data-line-number="376"></td>
        <td id="file-std-ion-c-LC376">    #<span>foreign</span>(preamble = <span><span>"</span>#define acatn(a, b, n) std_acatn_func(&amp;(a), b, n, sizeof(*a))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L377" data-line-number="377"></td>
        <td id="file-std-ion-c-LC377">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L378" data-line-number="378"></td>
        <td id="file-std-ion-c-LC378">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L379" data-line-number="379"></td>
        <td id="file-std-ion-c-LC379">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L380" data-line-number="380"></td>
        <td id="file-std-ion-c-LC380">func <span>acat</span>(a: <span>void</span>*, src: <span>void</span>*) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L381" data-line-number="381"></td>
        <td id="file-std-ion-c-LC381">    acat_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L382" data-line-number="382"></td>
        <td id="file-std-ion-c-LC382">    #<span>foreign</span>(preamble = <span><span>"</span>#define acat(a, b) std_acat_func(&amp;(a), b, sizeof(*a))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L383" data-line-number="383"></td>
        <td id="file-std-ion-c-LC383">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L384" data-line-number="384"></td>
        <td id="file-std-ion-c-LC384">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L385" data-line-number="385"></td>
        <td id="file-std-ion-c-LC385">func <span>adeln_func</span>(a: <span>void</span>*, i: usize, n: usize, elem_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L386" data-line-number="386"></td>
        <td id="file-std-ion-c-LC386">    <span>if</span> (i &gt;= <span>alen</span>(a)) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L387" data-line-number="387"></td>
        <td id="file-std-ion-c-LC387">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L388" data-line-number="388"></td>
        <td id="file-std-ion-c-LC388">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L389" data-line-number="389"></td>
        <td id="file-std-ion-c-LC389">    <span>if</span> (i + n &gt; <span>alen</span>(a)) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L390" data-line-number="390"></td>
        <td id="file-std-ion-c-LC390">        n = <span>alen</span>(a) - i;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L391" data-line-number="391"></td>
        <td id="file-std-ion-c-LC391">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L392" data-line-number="392"></td>
        <td id="file-std-ion-c-LC392">    <span>memmove</span>(a + i*elem_size, a + (i + n)*elem_size, (<span>alen</span>(a) - (i + n))*elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L393" data-line-number="393"></td>
        <td id="file-std-ion-c-LC393">    <span>ahdr</span>(a).<span>len</span> -= n;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L394" data-line-number="394"></td>
        <td id="file-std-ion-c-LC394">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L395" data-line-number="395"></td>
        <td id="file-std-ion-c-LC395">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L396" data-line-number="396"></td>
        <td id="file-std-ion-c-LC396">@foreign</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L397" data-line-number="397"></td>
        <td id="file-std-ion-c-LC397">func <span>adel</span>(a: <span>void</span>*, i: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L398" data-line-number="398"></td>
        <td id="file-std-ion-c-LC398">    adeln_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L399" data-line-number="399"></td>
        <td id="file-std-ion-c-LC399">    #<span>foreign</span>(preamble = <span><span>"</span>#define adel(a, i) std_adeln_func((a), (i), 1, sizeof(*(a)))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L400" data-line-number="400"></td>
        <td id="file-std-ion-c-LC400">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L401" data-line-number="401"></td>
        <td id="file-std-ion-c-LC401">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L402" data-line-number="402"></td>
        <td id="file-std-ion-c-LC402">@foreign</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L403" data-line-number="403"></td>
        <td id="file-std-ion-c-LC403">func <span>adeln</span>(a: <span>void</span>*, i: usize, n: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L404" data-line-number="404"></td>
        <td id="file-std-ion-c-LC404">    adeln_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L405" data-line-number="405"></td>
        <td id="file-std-ion-c-LC405">    #<span>foreign</span>(preamble = <span><span>"</span>#define adeln(a, i, n) std_adeln_func((a), (i), (n), sizeof(*(a)))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L406" data-line-number="406"></td>
        <td id="file-std-ion-c-LC406">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L407" data-line-number="407"></td>
        <td id="file-std-ion-c-LC407">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L408" data-line-number="408"></td>
        <td id="file-std-ion-c-LC408">func <span>acatn_func</span>(ap: <span>void</span>**, src: <span>void</span> <span>const</span>*, src_len: usize, elem_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L409" data-line-number="409"></td>
        <td id="file-std-ion-c-LC409">    a := *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L410" data-line-number="410"></td>
        <td id="file-std-ion-c-LC410">    a_len := <span>alen</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L411" data-line-number="411"></td>
        <td id="file-std-ion-c-LC411">    <span>afit_func</span>(ap, a_len + src_len, elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L412" data-line-number="412"></td>
        <td id="file-std-ion-c-LC412">    <span>if</span> (a != *ap &amp;&amp; a &lt;= src &amp;&amp; src &lt;= a + a_len*elem_size) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L413" data-line-number="413"></td>
        <td id="file-std-ion-c-LC413">        src = *ap + (src - a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L414" data-line-number="414"></td>
        <td id="file-std-ion-c-LC414">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L415" data-line-number="415"></td>
        <td id="file-std-ion-c-LC415">    a = *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L416" data-line-number="416"></td>
        <td id="file-std-ion-c-LC416">    <span>memmove</span>(a + a_len*elem_size, src, src_len*elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L417" data-line-number="417"></td>
        <td id="file-std-ion-c-LC417">    <span>ahdr</span>(a).<span>len</span> += src_len;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L418" data-line-number="418"></td>
        <td id="file-std-ion-c-LC418">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L419" data-line-number="419"></td>
        <td id="file-std-ion-c-LC419">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L420" data-line-number="420"></td>
        <td id="file-std-ion-c-LC420">func <span>acat_func</span>(ap: <span>void</span>**, src: <span>void</span>*, elem_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L421" data-line-number="421"></td>
        <td id="file-std-ion-c-LC421">    <span>acatn_func</span>(ap, src, <span>alen</span>(src), elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L422" data-line-number="422"></td>
        <td id="file-std-ion-c-LC422">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L423" data-line-number="423"></td>
        <td id="file-std-ion-c-LC423">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L424" data-line-number="424"></td>
        <td id="file-std-ion-c-LC424">func <span>aprintf_func</span>(ap: <span>char</span>**, fmt: <span>char</span> <span>const</span>*, ...) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L425" data-line-number="425"></td>
        <td id="file-std-ion-c-LC425">    a := *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L426" data-line-number="426"></td>
        <td id="file-std-ion-c-LC426">    args: <span>va_list</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L427" data-line-number="427"></td>
        <td id="file-std-ion-c-LC427">    <span>va_start</span>(args, fmt);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L428" data-line-number="428"></td>
        <td id="file-std-ion-c-LC428">    slack := <span>acap</span>(a) - <span>alen</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L429" data-line-number="429"></td>
        <td id="file-std-ion-c-LC429">    printed := <span>vsnprintf</span>(a + <span>alen</span>(a), slack, fmt, args) + <span>1</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L430" data-line-number="430"></td>
        <td id="file-std-ion-c-LC430">    <span>va_end</span>(args);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L431" data-line-number="431"></td>
        <td id="file-std-ion-c-LC431">    <span>if</span> (printed &gt; slack) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L432" data-line-number="432"></td>
        <td id="file-std-ion-c-LC432">        <span>afit</span>(a, <span>alen</span>(a) + printed);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L433" data-line-number="433"></td>
        <td id="file-std-ion-c-LC433">        <span>va_start</span>(args, fmt);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L434" data-line-number="434"></td>
        <td id="file-std-ion-c-LC434">        new_slack := <span>acap</span>(a) - <span>alen</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L435" data-line-number="435"></td>
        <td id="file-std-ion-c-LC435">        printed = <span>vsnprintf</span>(a + <span>alen</span>(a), new_slack, fmt, args) + <span>1</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L436" data-line-number="436"></td>
        <td id="file-std-ion-c-LC436">        <span>va_end</span>(args);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L437" data-line-number="437"></td>
        <td id="file-std-ion-c-LC437">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L438" data-line-number="438"></td>
        <td id="file-std-ion-c-LC438">    <span>ahdr</span>(a).<span>len</span> += printed - <span>1</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L439" data-line-number="439"></td>
        <td id="file-std-ion-c-LC439">    *ap = a;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L440" data-line-number="440"></td>
        <td id="file-std-ion-c-LC440">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L441" data-line-number="441"></td>
        <td id="file-std-ion-c-LC441">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L442" data-line-number="442"></td>
        <td id="file-std-ion-c-LC442">func <span>asetcap_func</span>(ap: <span>void</span>**, new_cap: usize, elem_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L443" data-line-number="443"></td>
        <td id="file-std-ion-c-LC443">    a := *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L444" data-line-number="444"></td>
        <td id="file-std-ion-c-LC444">    cap := <span>acap</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L445" data-line-number="445"></td>
        <td id="file-std-ion-c-LC445">    <span>if</span> (new_cap &gt; cap) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L446" data-line-number="446"></td>
        <td id="file-std-ion-c-LC446">        <span>if</span> (new_cap &lt; <span>16</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L447" data-line-number="447"></td>
        <td id="file-std-ion-c-LC447">            new_cap = <span>16</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L448" data-line-number="448"></td>
        <td id="file-std-ion-c-LC448">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L449" data-line-number="449"></td>
        <td id="file-std-ion-c-LC449">        <span>if</span> (<span>2</span>*new_cap &lt; <span>3</span>*cap) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L450" data-line-number="450"></td>
        <td id="file-std-ion-c-LC450">            new_cap = cap + cap/<span>2</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L451" data-line-number="451"></td>
        <td id="file-std-ion-c-LC451">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L452" data-line-number="452"></td>
        <td id="file-std-ion-c-LC452">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L453" data-line-number="453"></td>
        <td id="file-std-ion-c-LC453">    size := <span>offsetof</span>(ArrayHdr, buf) + new_cap*elem_size;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L454" data-line-number="454"></td>
        <td id="file-std-ion-c-LC454">    hdr: ArrayHdr*;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L455" data-line-number="455"></td>
        <td id="file-std-ion-c-LC455">    <span>if</span> (a) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L456" data-line-number="456"></td>
        <td id="file-std-ion-c-LC456">        hdr = <span>realloc</span>(<span>ahdr</span>(a), size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L457" data-line-number="457"></td>
        <td id="file-std-ion-c-LC457">        <span>if</span> (hdr.<span>len</span> &gt; new_cap) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L458" data-line-number="458"></td>
        <td id="file-std-ion-c-LC458">            hdr.<span>len</span> = new_cap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L459" data-line-number="459"></td>
        <td id="file-std-ion-c-LC459">        }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L460" data-line-number="460"></td>
        <td id="file-std-ion-c-LC460">    } <span>else</span> {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L461" data-line-number="461"></td>
        <td id="file-std-ion-c-LC461">        hdr = <span>malloc</span>(size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L462" data-line-number="462"></td>
        <td id="file-std-ion-c-LC462">        hdr.<span>len</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L463" data-line-number="463"></td>
        <td id="file-std-ion-c-LC463">        hdr.<span>index</span> = {indexer = default_indexer};</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L464" data-line-number="464"></td>
        <td id="file-std-ion-c-LC464">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L465" data-line-number="465"></td>
        <td id="file-std-ion-c-LC465">    hdr.<span>cap</span> = new_cap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L466" data-line-number="466"></td>
        <td id="file-std-ion-c-LC466">    *ap = hdr.<span>buf</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L467" data-line-number="467"></td>
        <td id="file-std-ion-c-LC467">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L468" data-line-number="468"></td>
        <td id="file-std-ion-c-LC468">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L469" data-line-number="469"></td>
        <td id="file-std-ion-c-LC469">@<span>inline</span></td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L470" data-line-number="470"></td>
        <td id="file-std-ion-c-LC470">func <span>afit_func</span>(ap: <span>void</span>**, min_cap: usize, elem_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L471" data-line-number="471"></td>
        <td id="file-std-ion-c-LC471">    <span>if</span> (min_cap &gt; <span>acap</span>(*ap)) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L472" data-line-number="472"></td>
        <td id="file-std-ion-c-LC472">        <span>asetcap_func</span>(ap, min_cap, elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L473" data-line-number="473"></td>
        <td id="file-std-ion-c-LC473">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L474" data-line-number="474"></td>
        <td id="file-std-ion-c-LC474">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L475" data-line-number="475"></td>
        <td id="file-std-ion-c-LC475">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L476" data-line-number="476"></td>
        <td id="file-std-ion-c-LC476">func <span>iindex_func</span>(ap: <span>void</span>**, new_index: Index, elem_size: usize, key_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L477" data-line-number="477"></td>
        <td id="file-std-ion-c-LC477">    a := *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L478" data-line-number="478"></td>
        <td id="file-std-ion-c-LC478">    <span>if</span> (!a) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L479" data-line-number="479"></td>
        <td id="file-std-ion-c-LC479">        <span>ainit_func</span>(ap);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L480" data-line-number="480"></td>
        <td id="file-std-ion-c-LC480">        a = *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L481" data-line-number="481"></td>
        <td id="file-std-ion-c-LC481">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L482" data-line-number="482"></td>
        <td id="file-std-ion-c-LC482">    #<span>assert</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L483" data-line-number="483"></td>
        <td id="file-std-ion-c-LC483">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L484" data-line-number="484"></td>
        <td id="file-std-ion-c-LC484">    <span>index_free</span>(<span>index</span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L485" data-line-number="485"></td>
        <td id="file-std-ion-c-LC485">    <span>ahdr</span>(a).<span>index</span> = new_index;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L486" data-line-number="486"></td>
        <td id="file-std-ion-c-LC486">    n := <span>alen</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L487" data-line-number="487"></td>
        <td id="file-std-ion-c-LC487">    <span>for</span> (i := <span>0</span>; i &lt; n; i++) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L488" data-line-number="488"></td>
        <td id="file-std-ion-c-LC488">        <span>index_set</span>(<span>index</span>, a, a + i*elem_size, i, n, elem_size, key_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L489" data-line-number="489"></td>
        <td id="file-std-ion-c-LC489">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L490" data-line-number="490"></td>
        <td id="file-std-ion-c-LC490">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L491" data-line-number="491"></td>
        <td id="file-std-ion-c-LC491">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L492" data-line-number="492"></td>
        <td id="file-std-ion-c-LC492">@foreign</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L493" data-line-number="493"></td>
        <td id="file-std-ion-c-LC493">func <span>kindex</span>(a: <span>void</span>*, new_index: Index) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L494" data-line-number="494"></td>
        <td id="file-std-ion-c-LC494">    iindex_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L495" data-line-number="495"></td>
        <td id="file-std-ion-c-LC495">    #<span>foreign</span>(preamble = <span><span>"</span>#define kindex(a, new_index) std_iindex_func(&amp;(a), (new_index), sizeof(*(a)), sizeof(*(a)))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L496" data-line-number="496"></td>
        <td id="file-std-ion-c-LC496">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L497" data-line-number="497"></td>
        <td id="file-std-ion-c-LC497">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L498" data-line-number="498"></td>
        <td id="file-std-ion-c-LC498">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L499" data-line-number="499"></td>
        <td id="file-std-ion-c-LC499">func <span>hindex</span>(a: <span>void</span>*, new_index: Index) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L500" data-line-number="500"></td>
        <td id="file-std-ion-c-LC500">    iindex_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L501" data-line-number="501"></td>
        <td id="file-std-ion-c-LC501">    #<span>foreign</span>(preamble = <span><span>"</span>#define hindex(t, a, new_index) std_iindex_func(&amp;(a), (new_index), sizeof(*(a)), sizeof(t))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L502" data-line-number="502"></td>
        <td id="file-std-ion-c-LC502">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L503" data-line-number="503"></td>
        <td id="file-std-ion-c-LC503">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L504" data-line-number="504"></td>
        <td id="file-std-ion-c-LC504">func <span>iget_func</span>(a: <span>void</span>*, x: <span>void</span> <span>const</span>*, elem_size: usize, key_size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L505" data-line-number="505"></td>
        <td id="file-std-ion-c-LC505">    <span>if</span> (!a) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L506" data-line-number="506"></td>
        <td id="file-std-ion-c-LC506">        <span>return</span> <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L507" data-line-number="507"></td>
        <td id="file-std-ion-c-LC507">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L508" data-line-number="508"></td>
        <td id="file-std-ion-c-LC508">    <span>return</span> <span>index_get</span>(<span>ahdr</span>(a).<span>index</span>, a, x, <span>alen</span>(a), elem_size, key_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L509" data-line-number="509"></td>
        <td id="file-std-ion-c-LC509">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L510" data-line-number="510"></td>
        <td id="file-std-ion-c-LC510">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L511" data-line-number="511"></td>
        <td id="file-std-ion-c-LC511">func <span>iput_func</span>(ap: <span>void</span>**, x: <span>void</span> <span>const</span>*, elem_size: usize, key_size: usize): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L512" data-line-number="512"></td>
        <td id="file-std-ion-c-LC512">    a := *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L513" data-line-number="513"></td>
        <td id="file-std-ion-c-LC513">    <span>if</span> (!a) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L514" data-line-number="514"></td>
        <td id="file-std-ion-c-LC514">        <span>ainit_func</span>(ap);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L515" data-line-number="515"></td>
        <td id="file-std-ion-c-LC515">        a = *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L516" data-line-number="516"></td>
        <td id="file-std-ion-c-LC516">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L517" data-line-number="517"></td>
        <td id="file-std-ion-c-LC517">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L518" data-line-number="518"></td>
        <td id="file-std-ion-c-LC518">    n := <span>alen</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L519" data-line-number="519"></td>
        <td id="file-std-ion-c-LC519">    i := <span>index_put</span>(<span>index</span>, a, x, n, elem_size, key_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L520" data-line-number="520"></td>
        <td id="file-std-ion-c-LC520">    <span>if</span> (i == n) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L521" data-line-number="521"></td>
        <td id="file-std-ion-c-LC521">        <span>afit_func</span>(ap, n + <span>1</span>, elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L522" data-line-number="522"></td>
        <td id="file-std-ion-c-LC522">        a = *ap;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L523" data-line-number="523"></td>
        <td id="file-std-ion-c-LC523">        <span>ahdr</span>(a).<span>len</span>++;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L524" data-line-number="524"></td>
        <td id="file-std-ion-c-LC524">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L525" data-line-number="525"></td>
        <td id="file-std-ion-c-LC525">    <span>memcpy</span>(a + i*elem_size, x, elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L526" data-line-number="526"></td>
        <td id="file-std-ion-c-LC526">    <span>return</span> i;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L527" data-line-number="527"></td>
        <td id="file-std-ion-c-LC527">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L528" data-line-number="528"></td>
        <td id="file-std-ion-c-LC528">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L529" data-line-number="529"></td>
        <td id="file-std-ion-c-LC529">func <span>idel_func</span>(a: <span>void</span>*, x: <span>void</span> <span>const</span>*, elem_size: usize, key_size: usize) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L530" data-line-number="530"></td>
        <td id="file-std-ion-c-LC530">    <span>if</span> (!a) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L531" data-line-number="531"></td>
        <td id="file-std-ion-c-LC531">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L532" data-line-number="532"></td>
        <td id="file-std-ion-c-LC532">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L533" data-line-number="533"></td>
        <td id="file-std-ion-c-LC533">    n := <span>alen</span>(a);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L534" data-line-number="534"></td>
        <td id="file-std-ion-c-LC534">    <span>index</span> := <span>ahdr</span>(a).<span>index</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L535" data-line-number="535"></td>
        <td id="file-std-ion-c-LC535">    i := <span>index_del</span>(<span>index</span>, a, x, n, elem_size, key_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L536" data-line-number="536"></td>
        <td id="file-std-ion-c-LC536">    <span>if</span> (i == n) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L537" data-line-number="537"></td>
        <td id="file-std-ion-c-LC537">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L538" data-line-number="538"></td>
        <td id="file-std-ion-c-LC538">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L539" data-line-number="539"></td>
        <td id="file-std-ion-c-LC539">    <span>if</span> (i &lt; n-<span>1</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L540" data-line-number="540"></td>
        <td id="file-std-ion-c-LC540">        p := a + i*elem_size;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L541" data-line-number="541"></td>
        <td id="file-std-ion-c-LC541">        q := a + (n-<span>1</span>)*elem_size;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L542" data-line-number="542"></td>
        <td id="file-std-ion-c-LC542">        <span>index_set</span>(<span>index</span>, a, q, i, n, elem_size, key_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L543" data-line-number="543"></td>
        <td id="file-std-ion-c-LC543">        <span>memmove</span>(p, q, elem_size);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L544" data-line-number="544"></td>
        <td id="file-std-ion-c-LC544">    }</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L545" data-line-number="545"></td>
        <td id="file-std-ion-c-LC545">    <span>ahdr</span>(a).<span>len</span>--;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L546" data-line-number="546"></td>
        <td id="file-std-ion-c-LC546">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L547" data-line-number="547"></td>
        <td id="file-std-ion-c-LC547">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L548" data-line-number="548"></td>
        <td id="file-std-ion-c-LC548">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L549" data-line-number="549"></td>
        <td id="file-std-ion-c-LC549">func <span>kdel</span>(a: <span>void</span>*, k: <span>void</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L550" data-line-number="550"></td>
        <td id="file-std-ion-c-LC550">    idel_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L551" data-line-number="551"></td>
        <td id="file-std-ion-c-LC551">    #<span>foreign</span>(preamble = <span><span>"</span>#define kdel(t, a, x) std_idel_func((a), (t[]){x}, sizeof(t), sizeof(t))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L552" data-line-number="552"></td>
        <td id="file-std-ion-c-LC552">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L553" data-line-number="553"></td>
        <td id="file-std-ion-c-LC553">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L554" data-line-number="554"></td>
        <td id="file-std-ion-c-LC554">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L555" data-line-number="555"></td>
        <td id="file-std-ion-c-LC555">func <span>kget</span>(a: <span>void</span>*, x: <span>void</span>): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L556" data-line-number="556"></td>
        <td id="file-std-ion-c-LC556">    iget_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L557" data-line-number="557"></td>
        <td id="file-std-ion-c-LC557">    #<span>foreign</span>(preamble = <span><span>"</span>#define kget(t, a, x) std_iget_func((a), (t[]){x}, sizeof(t), sizeof(t))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L558" data-line-number="558"></td>
        <td id="file-std-ion-c-LC558">    <span>return</span> <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L559" data-line-number="559"></td>
        <td id="file-std-ion-c-LC559">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L560" data-line-number="560"></td>
        <td id="file-std-ion-c-LC560">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L561" data-line-number="561"></td>
        <td id="file-std-ion-c-LC561">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L562" data-line-number="562"></td>
        <td id="file-std-ion-c-LC562">func <span>kput</span>(a: <span>void</span>*, x: <span>void</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L563" data-line-number="563"></td>
        <td id="file-std-ion-c-LC563">    iput_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L564" data-line-number="564"></td>
        <td id="file-std-ion-c-LC564">    #<span>foreign</span>(preamble = <span><span>"</span>#define kput(t, a, x) std_iput_func(&amp;(a), (t[]){x}, sizeof(t), sizeof(t))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L565" data-line-number="565"></td>
        <td id="file-std-ion-c-LC565">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L566" data-line-number="566"></td>
        <td id="file-std-ion-c-LC566">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L567" data-line-number="567"></td>
        <td id="file-std-ion-c-LC567">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L568" data-line-number="568"></td>
        <td id="file-std-ion-c-LC568">func <span>hget</span>(a: <span>void</span>*, x: <span>void</span>): usize {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L569" data-line-number="569"></td>
        <td id="file-std-ion-c-LC569">    iget_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L570" data-line-number="570"></td>
        <td id="file-std-ion-c-LC570">    #<span>foreign</span>(preamble = <span><span>"</span>#define hget(t, a, x) std_iget_func((a), (t[]){x}, sizeof(*(a)), sizeof(t))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L571" data-line-number="571"></td>
        <td id="file-std-ion-c-LC571">    <span>return</span> <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L572" data-line-number="572"></td>
        <td id="file-std-ion-c-LC572">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L573" data-line-number="573"></td>
        <td id="file-std-ion-c-LC573">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L574" data-line-number="574"></td>
        <td id="file-std-ion-c-LC574">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L575" data-line-number="575"></td>
        <td id="file-std-ion-c-LC575">func <span>hput</span>(a: <span>void</span>*, k: <span>void</span>, v: <span>void</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L576" data-line-number="576"></td>
        <td id="file-std-ion-c-LC576">    iput_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L577" data-line-number="577"></td>
        <td id="file-std-ion-c-LC577">    #<span>foreign</span>(preamble = <span><span>"</span>#define hput(t, n, a, k, v) std_iput_func(&amp;(a), &amp;(t){(k), (v)}, sizeof(*(a)), sizeof((*a).n))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L578" data-line-number="578"></td>
        <td id="file-std-ion-c-LC578">}</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L579" data-line-number="579"></td>
        <td id="file-std-ion-c-LC579">
</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L580" data-line-number="580"></td>
        <td id="file-std-ion-c-LC580">@foreign @intrinsic</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L581" data-line-number="581"></td>
        <td id="file-std-ion-c-LC581">func <span>hdel</span>(a: <span>void</span>*, k: <span>void</span>) {</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L582" data-line-number="582"></td>
        <td id="file-std-ion-c-LC582">    idel_func;</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L583" data-line-number="583"></td>
        <td id="file-std-ion-c-LC583">    #<span>foreign</span>(preamble = <span><span>"</span>#define hdel(t, a, x) std_idel_func((a), (t[]){x}, sizeof(*(a)), sizeof(t))<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-std-ion-c-L584" data-line-number="584"></td>
        <td id="file-std-ion-c-LC584">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>