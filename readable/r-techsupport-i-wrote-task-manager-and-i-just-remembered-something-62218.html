<!DOCTYPE html>
<html lang="en">
<head>
    <title>
r/techsupport - I wrote Task Manager and I just remembered something... - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="r/techsupport - I wrote Task Manager and I just remembered something... - linksfor.dev(s)"/>
    <meta property="og:description" content="10,154 votes and 274 comments so far on Reddit"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.reddit.com/r/techsupport/comments/gqb915/i_wrote_task_manager_and_i_just_remembered/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - r/techsupport - I wrote Task Manager and I just remembered something...</title>
<div class="readable">
        <h1>r/techsupport - I wrote Task Manager and I just remembered something...</h1>
            <div>Reading time: 6-7 minutes</div>
        <div>Posted here: 29 May 2020</div>
        <p><a href="https://www.reddit.com/r/techsupport/comments/gqb915/i_wrote_task_manager_and_i_just_remembered/">https://www.reddit.com/r/techsupport/comments/gqb915/i_wrote_task_manager_and_i_just_remembered/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-click-id="text"><div theme="[object Object]"><p>Figured I should write this stuff down before I forget it all, and where better for TaskManager than <a href="https://www.reddit.com/r/techsupport/" rel="noopener nofollow ugc" target="_blank">r/techsupport</a>!  If there's any appetite for this, I'll expand on it!   I don't blog, so here goes...</p><p>Some Task Manager lore: I'm the Microsoft (Redmond, '93) developer that wrote TaskMgr at home in my den in about 1994 and then the NT silverback devs let me check it into the main tree even though I was a greenhorn at the time.  So that meant I got to bring it into work and polish it up and make it an official part of Windows, where it remains to this day.  So I got to define my own day job, actually, which was nice!  I don't know if it's still like that, but great culture and people.</p><p>This is all based on XP, as I left long ago, but it's still the same core app underneath.  In no particular order:</p><p>- If Task Manager ever hangs or crashes, start another by pressing ctrl-shift-esc.  Winlogon will look for an existing instance and try to revive it for up to 10 seconds.  If the old Taskmgr doesn't start making sense by responding with a secret code within that time, another one will be launched.  That way, you're never without a Taskmgr as long as there are some resources available.</p><p>- Task Manager will load in reduced mode if resources are short, like only loading the Processes page if that's what's needed to get going.  It's one of the very few apps that won't just "fail and bail" when things go wrong.</p><p>- If Task Manager ever becomes internally corrupted, kill/close it.  Restart it while holding down CTRL, ALT, and SHIFT, and Task Manager will reset ALL internal settings to factory fresh if it sees that key combo at startup.  Same works for every app I've written, btw, I think!</p><p>- If all your titlebars disappear and you just have a graph, double-click dead client space to switch back to normal mode.  This no-titlebar mode is a mode I added to follow the NT clock, where you could remove borders as well, but it confused more people than it ever helped I'm sure!</p><p>- I initially drew the meters as 7-segment LEDs but that wasn't localizable to all cultures (How do you do a right-to-left reading 7-segment LED for Saudi Arabia?) so they only lasted for one version or so.</p><p>- CTRL-SHIFT-ESC will launch Taskmgr without any help from the Shell, so if the Shell/Explorer is dead use this key combo to bring up TM and then reset/restart the shell.  Even if your tray is missing and gone, this combo should start it.</p><p>- If the shell can't start something or is hung, try Task Manager.  It has a mode where it will load without ANY references to the shell32.dll and allow you to start programs like CMD.EXE without the start menu.</p><p>- You can find the binary for any executing process in the process table by right clicking and pick "Show File Location".  You can also search it online, but I don't know if they have useful info for much.</p><p>- There should be nothing that TaskMgr can't kill - it will even escalate privilege and (if you have it) enable debug privilege to attach to and kill apps that way if needed.  If TM can't kill it, you've got a kernel problem.</p><p>- A lot of people don't seem to know you can add many additional columns, remove others, drag them around to reorder, etc.</p><p>- The reason there's a Window class called "DavesFrameWndProc" is because to get flicker-free resizing I needed group boxes to not try to paint on one another, so subclass them, give them their own wndproc, and enabling WS_CLIPSIBLINGS during WM_CREATE.  At least I think so!</p><p>- TM is one of the apps I'm most proud of because it is probably the first or at least most visually complicated app to ever be fully resizable in all dimensions without any flicker up till then.  I was hardcore about memory and flicker in my day, so it was under 100K for the exe and never flashed or crashed, that was my thing!  Having the GDI32 and User32 guys down the hall sure helped.</p><p>I also wrote/ported Space Cadet pinball, zip folders, worked on start menu, shell, calc, ole32, product activation, and some other stuff.  I was in MS-DOS before that but I doubt anyone is still supporting MS-DOS!</p><p>Edit:  Looks like comments have been locked, so I'll update this one time with some answers to the most interesting/common questions below!</p><p>- On the command line, I'm stumped, as I don't remember command line args to it at all!</p><p>- On Space Cadet, yes, you can run it on Windows 10, but I doubt it's official or legal, so will point you at your favorite search engine for that one, but it's easy.  And on Space Cadet, reminder that Maxis did the very original (M. Ridgeway) and mine was just a rewrite in 32-bit portable C using their art.  That way it ran on the PowerPC, Alpha, and MIPS as well.  And yes, in the original there is a "God Mode" where you can drag the ball around, click on targets, etc.  Search is your friend there as well.</p><p>- On what I'm doing these days, I volunteer to teach kids to program at school, or used to until recently, so now I'm mostly coding and working on my coding channel, which you can follow here: <a href="https://bit.ly/36wDLJK" rel="noopener nofollow ugc" target="_blank">https://bit.ly/36wDLJK</a> and I also restore old musclecars, pickups, etc.  So yes, I still code every day!</p><p>- On the notion that there are some things that Taskmgr can't kill, there were post-XP for sure but they were intentional limits.  I remember something about journalists making news by using TM to kill the root winlogon session, for example, which would bugcheck the machine intentionally.  But the fact you could bluescreen NT didn't look good, I suspect, so they likely started to protect people from themselves by disallowing killing win32k.sys and other essential components.</p><p>- Thanks to the mods for being flexible on this one!</p></div></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>