<!DOCTYPE html>
<html lang="en">
<head>
    <title>
ASP.NET Blog | Blazor WebAssembly 3.2.0 Preview 1 release now available - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="ASP.NET Blog | Blazor WebAssembly 3.2.0 Preview 1 release now available - linksfor.dev(s)"/>
    <meta property="article:author" content="Daniel RothPrincipal Program Manager,&#xA0;ASP.NETFollow Daniel"/>
    <meta property="og:description" content="Today we released a new preview update for Blazor WebAssembly with a bunch of great new features and improvements.&#xA;Here&#x2019;s what&#x2019;s new in this release:&#xA;&#xA;Version updated to 3.2&#xA;Simplified startup&#xA;Download size improvements&#xA;Support for .NET SignalR client&#xA;&#xA;Get started&#xA;To get started with Blazor WebAssembly 3.2.0 Preview 1 install the .NET Core 3.1 SDK and then run the following command:&#xA;dotnet new -i Microsoft.AspNetCore.Blazor.Templates::3.2.0-preview1.20073.1&#xA;&#xA;That&#x2019;s it!"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/aspnet/blazor-webassembly-3-2-0-preview-1-release-now-available/?ocid=AID2423380_TWITTER_oo_spl100001159383227"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - ASP.NET Blog | Blazor WebAssembly 3.2.0 Preview 1 release now available</title>
<div class="readable">
        <h1>ASP.NET Blog | Blazor WebAssembly 3.2.0 Preview 1 release now available</h1>
            <div>by Daniel RothPrincipal Program Manager,&#xA0;ASP.NETFollow Daniel</div>
            <div>Reading time: 9-11 minutes</div>
        <div>Posted here: 04 Mar 2020</div>
        <p><a href="https://devblogs.microsoft.com/aspnet/blazor-webassembly-3-2-0-preview-1-release-now-available/?ocid=AID2423380_TWITTER_oo_spl100001159383227">https://devblogs.microsoft.com/aspnet/blazor-webassembly-3-2-0-preview-1-release-now-available/?ocid=AID2423380_TWITTER_oo_spl100001159383227</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured">

	<div>
                
         <div><div><div><p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2019/02/DaniethRothPhoto-150x150.jpeg" width="58" height="58" alt="Daniel Roth"></p><p>Daniel</p></div></div></div>     
        <p>January 28th, 2020</p><!-- .entry-meta -->

		<p>Today we released a new preview update for Blazor WebAssembly with a bunch of great new features and improvements.</p>
<p>Here’s what’s new in this release:</p>
<ul>
<li>Version updated to 3.2</li>
<li>Simplified startup</li>
<li>Download size improvements</li>
<li>Support for .NET SignalR client</li>
</ul>
<h2>Get started</h2>
<p>To get started with Blazor WebAssembly 3.2.0 Preview 1 <a href="https://dotnet.microsoft.com/download/dotnet-core/3.1" target="_blank">install the .NET Core 3.1 SDK</a> and then run the following command:</p>
<pre><code><span>dotnet </span><span>new</span><span> </span><span>-</span><span>i </span><span>Microsoft</span><span>.</span><span>AspNetCore</span><span>.</span><span>Blazor</span><span>.</span><span>Templates</span><span>::</span><span>3.2</span><span>.</span><span>0</span><span>-</span><span>preview1</span><span>.</span><span>20073.1</span></code></pre>
<p>That’s it! You can find additional docs and samples on <a href="https://blazor.net/" target="_blank">https://blazor.net</a>.</p>
<h2>Upgrade an existing project</h2>
<p>To upgrade an existing Blazor WebAssembly app from 3.1.0 Preview 4 to 3.2.0 Preview 1:</p>
<ul>
<li>Update all Microsoft.AspNetCore.Blazor.* package references to 3.2.0-preview1.20073.1.</li>
<li>In <em>Program.cs</em> in the Blazor WebAssembly client project replace <code>BlazorWebAssemblyHost.CreateDefaultBuilder()</code> with <code>WebAssemblyHostBuilder.CreateDefault()</code>.</li>
<li>Replace <code>IWebAssemblyHost</code> with <code>WebAssemblyHost</code>.</li>
<li>Replace <code>IWebAssemblyHostBuilder</code> with <code>WebAssemblyHostBuilder</code>.</li>
<li>Move the root component registrations in the Blazor WebAssembly client project from <code>Startup.Configure</code> to <em>Program.cs</em> by calling <code>builder.RootComponents.Add&lt;TComponent&gt;(string selector)</code>.</li>
<li>Move the configured services in the Blazor WebAssembly client project from <code>Startup.ConfigureServices</code> to <em>Program.cs</em> by adding services to the <code>builder.Services</code> collection.</li>
<li>Remove <em>Startup.cs</em> from the Blazor WebAssembly client project.</li>
<li>If you’re hosting Blazor WebAssembly with ASP.NET Core, in your <em>Server</em> project replace the call to <code>app.UseClientSideBlazorFiles&lt;Client.Startup&gt;(...)</code> with <code>app.UseClientSideBlazorFiles&lt;Client.Program&gt;(...)</code>.</li>
</ul>
<h2>Version updated to 3.2</h2>
<p>In this release we updated the versions of the Blazor WebAssembly packages to 3.2 to distinguish them from the recent .NET Core 3.1 Long Term Support (LTS) release. There is no corresponding .NET Core 3.2 release – the new 3.2 version applies only to Blazor WebAssembly. Blazor WebAssembly is currently based on .NET Core 3.1, but it doesn’t inherit the .NET Core 3.1 LTS status. Instead, the initial release of Blazor WebAssembly scheduled for May of this year will be a <em>Current</em> release, which “are supported for three months after a subsequent Current or LTS release” as described in the <a href="https://dotnet.microsoft.com/platform/support/policy/dotnet-core" target="_blank">.NET Core support policy</a>. The next planned release for Blazor WebAssembly after the 3.2 release in May will be with <a href="https://devblogs.microsoft.com/dotnet/introducing-net-5/">.NET 5</a>. This means that once .NET 5 ships you’ll need to update your Blazor WebAssembly apps to .NET 5 to stay in support.</p>
<h2>Simplified startup</h2>
<p>We’ve simplified the startup and hosting APIs for Blazor WebAssembly in this release. Originally the startup and hosting APIs for Blazor WebAssembly were designed to mirror the patterns used by ASP.NET Core, but not all of the concepts were relevant. The updated APIs also enable some new scenarios.</p>
<p>Here’s what the new startup code in <em>Program.cs</em> looks like:</p>
<pre><code><span>public</span><span> </span><span>class</span><span> </span><span>Program</span><span>
</span><span>{</span><span>
    </span><span>public</span><span> </span><span>static</span><span> async </span><span>Task</span><span> </span><span>Main</span><span>(</span><span>string</span><span>[]</span><span> args</span><span>)</span><span>
    </span><span>{</span><span>
        </span><span>var</span><span> builder </span><span>=</span><span> </span><span>WebAssemblyHostBuilder</span><span>.</span><span>CreateDefault</span><span>(</span><span>args</span><span>);</span><span>
        builder</span><span>.</span><span>RootComponents</span><span>.</span><span>Add</span><span>&lt;</span><span>App</span><span>&gt;(</span><span>"app"</span><span>);</span><span>

        await builder</span><span>.</span><span>Build</span><span>().</span><span>RunAsync</span><span>();</span><span>
    </span><span>}</span><span>
</span><span>}</span></code></pre>
<p>Blazor WebAssembly apps now support async <code>Main</code> methods for the app entry point.</p>
<p>To a create a default host builder, call <code>WebAssemblyHostBuilder.CreateDefault()</code>. Root components and services are configured using the builder; a separate <code>Startup</code> class is no longer needed.</p>
<p>The following example adds a <code>WeatherService</code> so it’s available through dependency injection (DI):</p>
<pre><code><span>public</span><span> </span><span>class</span><span> </span><span>Program</span><span>
</span><span>{</span><span>
    </span><span>public</span><span> </span><span>static</span><span> async </span><span>Task</span><span> </span><span>Main</span><span>(</span><span>string</span><span>[]</span><span> args</span><span>)</span><span>
    </span><span>{</span><span>
        </span><span>var</span><span> builder </span><span>=</span><span> </span><span>WebAssemblyHostBuilder</span><span>.</span><span>CreateDefault</span><span>(</span><span>args</span><span>);</span><span>
        builder</span><span>.</span><span>Services</span><span>.</span><span>AddSingleton</span><span>&lt;</span><span>WeatherService</span><span>&gt;();</span><span>
        builder</span><span>.</span><span>RootComponents</span><span>.</span><span>Add</span><span>&lt;</span><span>App</span><span>&gt;(</span><span>"app"</span><span>);</span><span>

        await builder</span><span>.</span><span>Build</span><span>().</span><span>RunAsync</span><span>();</span><span>
    </span><span>}</span><span>
</span><span>}</span></code></pre>
<p>Once the host is built, you can access services from the root DI scope before any components have been rendered. This can be useful if you need to run some initialization logic before anything is rendered:</p>
<pre><code><span>public</span><span> </span><span>class</span><span> </span><span>Program</span><span>
</span><span>{</span><span>
    </span><span>public</span><span> </span><span>static</span><span> async </span><span>Task</span><span> </span><span>Main</span><span>(</span><span>string</span><span>[]</span><span> args</span><span>)</span><span>
    </span><span>{</span><span>
        </span><span>var</span><span> builder </span><span>=</span><span> </span><span>WebAssemblyHostBuilder</span><span>.</span><span>CreateDefault</span><span>(</span><span>args</span><span>);</span><span>
        builder</span><span>.</span><span>Services</span><span>.</span><span>AddSingleton</span><span>&lt;</span><span>WeatherService</span><span>&gt;();</span><span>
        builder</span><span>.</span><span>RootComponents</span><span>.</span><span>Add</span><span>&lt;</span><span>App</span><span>&gt;(</span><span>"app"</span><span>);</span><span>

        </span><span>var</span><span> host </span><span>=</span><span> builder</span><span>.</span><span>Build</span><span>();</span><span>

        </span><span>var</span><span> weatherService </span><span>=</span><span> host</span><span>.</span><span>Services</span><span>.</span><span>GetRequiredService</span><span>&lt;</span><span>WeatherService</span><span>&gt;();</span><span>
        await weatherService</span><span>.</span><span>InitializeWeatherAsync</span><span>();</span><span>

        await host</span><span>.</span><span>RunAsync</span><span>();</span><span>
    </span><span>}</span><span>
</span><span>}</span></code></pre>
<p>The host also now provides a central configuration instance for the app. The configuration isn’t populated with any data by default, but you can populate it as required in your app.</p>
<pre><code><span>public</span><span> </span><span>class</span><span> </span><span>Program</span><span>
</span><span>{</span><span>
    </span><span>public</span><span> </span><span>static</span><span> async </span><span>Task</span><span> </span><span>Main</span><span>(</span><span>string</span><span>[]</span><span> args</span><span>)</span><span>
    </span><span>{</span><span>
        </span><span>var</span><span> builder </span><span>=</span><span> </span><span>WebAssemblyHostBuilder</span><span>.</span><span>CreateDefault</span><span>(</span><span>args</span><span>);</span><span>
        builder</span><span>.</span><span>Services</span><span>.</span><span>AddSingleton</span><span>&lt;</span><span>WeatherService</span><span>&gt;();</span><span>
        builder</span><span>.</span><span>RootComponents</span><span>.</span><span>Add</span><span>&lt;</span><span>App</span><span>&gt;(</span><span>"app"</span><span>);</span><span>

        </span><span>var</span><span> host </span><span>=</span><span> builder</span><span>.</span><span>Build</span><span>();</span><span>

        </span><span>var</span><span> weatherService </span><span>=</span><span> host</span><span>.</span><span>Services</span><span>.</span><span>GetRequiredService</span><span>&lt;</span><span>WeatherService</span><span>&gt;();</span><span>
        await weatherService</span><span>.</span><span>InitializeWeatherAsync</span><span>(</span><span>host</span><span>.</span><span>Configuration</span><span>[</span><span>"WeatherServiceUrl"</span><span>]);</span><span>

        await host</span><span>.</span><span>RunAsync</span><span>();</span><span>
    </span><span>}</span><span>
</span><span>}</span></code></pre>
<h2>Download size improvements</h2>
<p>Blazor WebAssembly apps run the .NET IL linker on every build to trim unused code from the app. In previous releases only the core framework libraries were trimmed. Starting with this release the Blazor framework assemblies are trimmed as well resulting in a modest size reduction of about 100 KB  transferred. As before, if you ever need to turn off linking, add the <code>&lt;BlazorLinkOnBuild&gt;false&lt;/BlazorLinkOnBuild&gt;</code> property to your project file.</p>
<h2>Support for the .NET SignalR client</h2>
<p>You can now use SignalR from your Blazor WebAssembly apps using the .NET SignalR client.</p>
<p>To give SignalR a try from your Blazor WebAssembly app:</p>
<ol>
<li>
<p>Create an ASP.NET Core hosted Blazor WebAssembly app.</p>
<pre><code><span>dotnet </span><span>new</span><span> blazorwasm </span><span>-</span><span>ho </span><span>-</span><span>o </span><span>BlazorSignalRApp</span></code></pre>
</li>
<li>
<p>Add the ASP.NET Core SignalR Client package to the <em>Client</em> project.</p>
<pre><code><span>cd </span><span>BlazorSignalRApp</span><span>
dotnet add </span><span>Client</span><span> </span><span>package</span><span> </span><span>Microsoft</span><span>.</span><span>AspNetCore</span><span>.</span><span>SignalR</span><span>.</span><span>Client</span></code></pre>
</li>
<li>
<p>In the <em>Server</em> project, add the following <em>Hub/ChatHub.cs</em> class.</p>
<pre><code><span>using</span><span> </span><span>System</span><span>.</span><span>Threading</span><span>.</span><span>Tasks</span><span>;</span><span>
</span><span>using</span><span> </span><span>Microsoft</span><span>.</span><span>AspNetCore</span><span>.</span><span>SignalR</span><span>;</span><span>

</span><span>namespace</span><span> </span><span>BlazorSignalRApp</span><span>.</span><span>Server</span><span>.</span><span>Hubs</span><span>
</span><span>{</span><span>
    </span><span>public</span><span> </span><span>class</span><span> </span><span>ChatHub</span><span> </span><span>:</span><span> </span><span>Hub</span><span>
    </span><span>{</span><span>
        </span><span>public</span><span> async </span><span>Task</span><span> </span><span>SendMessage</span><span>(</span><span>string</span><span> user</span><span>,</span><span> </span><span>string</span><span> message</span><span>)</span><span>
        </span><span>{</span><span>
            await </span><span>Clients</span><span>.</span><span>All</span><span>.</span><span>SendAsync</span><span>(</span><span>"ReceiveMessage"</span><span>,</span><span> user</span><span>,</span><span> message</span><span>);</span><span>
        </span><span>}</span><span>
    </span><span>}</span><span>
</span><span>}</span></code></pre>
</li>
<li>
<p>In the <em>Server</em> project, add the SignalR services in the <code>Startup.ConfigureServices</code> method.</p>
<pre><code><span>services</span><span>.</span><span>AddSignalR</span><span>();</span></code></pre>
</li>
<li>
<p>Also add an endpoint for the <code>ChatHub</code> in <code>Startup.Configure</code>.</p>
<pre><code><span>.</span><span>UseEndpoints</span><span>(</span><span>endpoints </span><span>=&gt;</span><span>
</span><span>{</span><span>
    endpoints</span><span>.</span><span>MapDefaultControllerRoute</span><span>();</span><span>
    endpoints</span><span>.</span><span>MapHub</span><span>&lt;</span><span>ChatHub</span><span>&gt;(</span><span>"/chatHub"</span><span>);</span><span>
    endpoints</span><span>.</span><span>MapFallbackToClientSideBlazor</span><span>&lt;</span><span>Client</span><span>.</span><span>Program</span><span>&gt;(</span><span>"index.html"</span><span>);</span><span>
</span><span>});</span></code></pre>
</li>
<li>
<p>Update <em>Pages/Index.razor</em> in the <em>Client</em> project with the following markup.</p>
<pre><code><span>@using</span><span> </span><span>Microsoft</span><span>.</span><span>AspNetCore</span><span>.</span><span>SignalR</span><span>.</span><span>Client</span><span>
</span><span>@page</span><span> </span><span>"/"</span><span>
</span><span>@inject</span><span> </span><span>NavigationManager</span><span> </span><span>NavigationManager</span><span>

</span><span>&lt;div&gt;</span><span>
    </span><span>&lt;</span><span>label </span><span>for</span><span>=</span><span>"userInput"</span><span>&gt;</span><span>User</span><span>:&lt;/</span><span>label</span><span>&gt;</span><span>
    </span><span>&lt;</span><span>input id</span><span>=</span><span>"userInput"</span><span> </span><span>@bind</span><span>=</span><span>"userInput"</span><span> </span><span>/&gt;</span><span>
</span><span>&lt;/</span><span>div</span><span>&gt;</span><span>
</span><span>&lt;</span><span>div </span><span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><span>
    </span><span>&lt;</span><span>label </span><span>for</span><span>=</span><span>"messageInput"</span><span>&gt;</span><span>Message</span><span>:&lt;/</span><span>label</span><span>&gt;</span><span>
    </span><span>&lt;</span><span>input id</span><span>=</span><span>"messageInput"</span><span> </span><span>@bind</span><span>=</span><span>"messageInput"</span><span> </span><span>/&gt;</span><span>
</span><span>&lt;/</span><span>div</span><span>&gt;</span><span>
</span><span>&lt;</span><span>button </span><span>@onclick</span><span>=</span><span>"Send"</span><span> disabled</span><span>=</span><span>"@(!IsConnected)"</span><span>&gt;</span><span>Send</span><span> </span><span>Message</span><span>&lt;/</span><span>button</span><span>&gt;</span><span>

</span><span>&lt;</span><span>hr </span><span>/&gt;</span><span>

</span><span>&lt;</span><span>ul id</span><span>=</span><span>"messagesList"</span><span>&gt;</span><span>
    </span><span>@foreach</span><span> </span><span>(</span><span>var</span><span> message </span><span>in</span><span> messages</span><span>)</span><span>
    </span><span>{</span><span>
        </span><span>&lt;li&gt;</span><span>@message</span><span>&lt;/</span><span>li</span><span>&gt;</span><span>
    </span><span>}</span><span>
</span><span>&lt;/</span><span>ul</span><span>&gt;</span><span>

</span><span>@code</span><span> </span><span>{</span><span>
    </span><span>HubConnection</span><span> hubConnection</span><span>;</span><span>
    </span><span>List</span><span>&lt;string&gt;</span><span> messages </span><span>=</span><span> </span><span>new</span><span> </span><span>List</span><span>&lt;string&gt;</span><span>();</span><span>
    </span><span>string</span><span> userInput</span><span>;</span><span>
    </span><span>string</span><span> messageInput</span><span>;</span><span>

    </span><span>protected</span><span> </span><span>override</span><span> async </span><span>Task</span><span> </span><span>OnInitializedAsync</span><span>()</span><span>
    </span><span>{</span><span>
        hubConnection </span><span>=</span><span> </span><span>new</span><span> </span><span>HubConnectionBuilder</span><span>()</span><span>
            </span><span>.</span><span>WithUrl</span><span>(</span><span>NavigationManager</span><span>.</span><span>ToAbsoluteUri</span><span>(</span><span>"/chatHub"</span><span>))</span><span>
            </span><span>.</span><span>Build</span><span>();</span><span>

        hubConnection</span><span>.</span><span>On</span><span>&lt;</span><span>string</span><span>,</span><span> </span><span>string</span><span>&gt;(</span><span>"ReceiveMessage"</span><span>,</span><span> </span><span>(</span><span>user</span><span>,</span><span> message</span><span>)</span><span> </span><span>=&gt;</span><span>
        </span><span>{</span><span>
            </span><span>var</span><span> encodedMsg </span><span>=</span><span> user </span><span>+</span><span> </span><span>" says "</span><span> </span><span>+</span><span> message</span><span>;</span><span>
            messages</span><span>.</span><span>Add</span><span>(</span><span>encodedMsg</span><span>);</span><span>
            </span><span>StateHasChanged</span><span>();</span><span>
        </span><span>});</span><span>

        await hubConnection</span><span>.</span><span>StartAsync</span><span>();</span><span>
    </span><span>}</span><span>

    </span><span>Task</span><span> </span><span>Send</span><span>()</span><span> </span><span>=&gt;</span><span> hubConnection</span><span>.</span><span>SendAsync</span><span>(</span><span>"SendMessage"</span><span>,</span><span> userInput</span><span>,</span><span> messageInput</span><span>);</span><span>

    </span><span>public</span><span> </span><span>bool</span><span> </span><span>IsConnected</span><span> </span><span>=&gt;</span><span> hubConnection</span><span>.</span><span>State</span><span> </span><span>==</span><span> </span><span>HubConnectionState</span><span>.</span><span>Connected</span><span>;</span><span>
</span><span>}</span></code></pre>
</li>
<li>
<p>Build and run the <em>Server</em> project</p>
<pre><code><span>cd </span><span>Server</span><span>
dotnet run</span></code></pre>
</li>
<li>
<p>Open the app in two separate browser tabs to chat in real time over SignalR.</p>
</li>
</ol>
<h2>Known issues</h2>
<p>Below is the list of known issues with this release that will get addressed in a future update.</p>
<ul>
<li>
<p>Running a new ASP.NET Core hosted Blazor WebAssembly app from the command-line results in the warning: <code>CSC : warning CS8034: Unable to load Analyzer assembly C:\Users\user\.nuget\packages\microsoft.aspnetcore.components.analyzers\3.1.0\analyzers\dotnet\cs\Microsoft.AspNetCore.Components.Analyzers.dll : Assembly with same name is already loaded.</code></p>
<ul>
<li>Workaround: This warning can be ignored or suppressed using the <code>&lt;DisableImplicitComponentsAnalyzers&gt;true&lt;/DisableImplicitComponentsAnalyzers&gt;</code> MSBuild property.</li>
</ul>
</li>
</ul>
<h2>Feedback</h2>
<p>We hope you enjoy the new features in this preview release of Blazor WebAssembly! Please let us know what you think by filing issues on <a href="https://github.com/dotnet/aspnetcore/issues" target="_blank">GitHub</a>.</p>
<p>Thanks for trying out Blazor!</p>
        
        
        
        

		        
        
        
	</div><!-- .entry-content -->
    
    </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>