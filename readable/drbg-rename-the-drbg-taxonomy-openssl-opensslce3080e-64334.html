<!DOCTYPE html>
<html lang="en">
<head>
    <title>
DRBG: rename the DRBG taxonomy. &#xB7; openssl/openssl@ce3080e - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="DRBG: rename the DRBG taxonomy. &#xB7; openssl/openssl@ce3080e - linksfor.dev(s)"/>
    <meta property="article:author" content="paulidale"/>
    <meta property="og:description" content="The existing wording didn&amp;#39;t capture the reality of the default setup, this new&#xA;nomenclature attempts to improve the situation.&#xA;&#xA;Reviewed-by: Mark J. Cox &amp;lt;mark@awe.com&amp;gt;&#xA;Reviewed-by: Tomas ..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/openssl/openssl/commit/ce3080e931d77fda3bb4f2d923fcc6cec967d1a3"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - DRBG: rename the DRBG taxonomy. &#xB7; openssl/openssl@ce3080e</title>
<div class="readable">
        <h1>DRBG: rename the DRBG taxonomy. &#xB7; openssl/openssl@ce3080e</h1>
            <div>by paulidale</div>
            <div>Reading time: 20-26 minutes</div>
        <div>Posted here: 15 Jul 2020</div>
        <p><a href="https://github.com/openssl/openssl/commit/ce3080e931d77fda3bb4f2d923fcc6cec967d1a3">https://github.com/openssl/openssl/commit/ce3080e931d77fda3bb4f2d923fcc6cec967d1a3</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-hydro-view="{&quot;event_type&quot;:&quot;pull_request.select_diff_range&quot;,&quot;payload&quot;:{&quot;actor_id&quot;:null,&quot;pull_request_id&quot;:null,&quot;repository_id&quot;:null,&quot;diff_type&quot;:&quot;UNIFIED&quot;,&quot;whitespace_ignored&quot;:false,&quot;originating_url&quot;:&quot;https://github.com/openssl/openssl/commit/ce3080e931d77fda3bb4f2d923fcc6cec967d1a3&quot;,&quot;user_id&quot;:null}}" data-hydro-view-hmac="0cde0eb5e42694cbd2d325600081455cc655e9706363dd82ed7a49a9d114043d">
        <div>
          <table data-tab-size="8" data-diff-anchor="diff-9181ac017a6177a5f2619f65c9b7a346" data-paste-markdown-skip="">

                
      <tbody><tr data-position="0">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=&amp;last_right=&amp;left=41&amp;left_hunk_size=73&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=41&amp;right_hunk_size=77" data-left-range="1-40" data-right-range="1-40">
            
          </a>
    </td>
    <td>@@ -41,73 +41,77 @@ typedef struct drbg_global_st {</td>
  </tr>

    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L41" data-line-number="41"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R41" data-line-number="41"></td>

  <td>
    <span data-code-marker=" ">    <span><span>/*</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L42" data-line-number="42"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R42" data-line-number="42"></td>

  <td>
    <span data-code-marker=" "><span>     * The three shared DRBG instances</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L43" data-line-number="43"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R43" data-line-number="43"></td>

  <td>
    <span data-code-marker=" "><span>     *</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L44" data-line-number="44"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>     * There are three shared DRBG instances: &lt;master&gt;, &lt;public&gt;, and &lt;private&gt;.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R44" data-line-number="44"></td>

  <td>
    <span data-code-marker="+"><span>     * There are three shared DRBG instances: &lt;primary&gt;, &lt;public&gt;, and</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R45" data-line-number="45"></td>

  <td>
    <span data-code-marker="+"><span>     * &lt;private&gt;.  The &lt;public&gt; and &lt;private&gt; DRBGs are secondary ones.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R46" data-line-number="46"></td>

  <td>
    <span data-code-marker="+"><span>     * These are used for non-secret (e.g. nonces) and secret</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R47" data-line-number="47"></td>

  <td>
    <span data-code-marker="+"><span>     * (e.g. private keys) data respectively.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L45" data-line-number="45"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R48" data-line-number="48"></td>

  <td>
    <span data-code-marker=" "><span>     <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L46" data-line-number="46"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R49" data-line-number="49"></td>

  <td>
    <span data-code-marker=" ">    CRYPTO_RWLOCK *lock;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L47" data-line-number="47"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R50" data-line-number="50"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L48" data-line-number="48"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R51" data-line-number="51"></td>

  <td>
    <span data-code-marker=" ">    <span><span>/*</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L49" data-line-number="49"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>     * The &lt;<span>master</span>&gt; DRBG</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R52" data-line-number="52"></td>

  <td>
    <span data-code-marker="+"><span>     * The &lt;<span>primary</span>&gt; DRBG</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L50" data-line-number="50"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R53" data-line-number="53"></td>

  <td>
    <span data-code-marker=" "><span>     *</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L51" data-line-number="51"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R54" data-line-number="54"></td>

  <td>
    <span data-code-marker=" "><span>     * Not used directly by the application, only for reseeding the two other</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L52" data-line-number="52"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R55" data-line-number="55"></td>

  <td>
    <span data-code-marker=" "><span>     * DRBGs. It reseeds itself by pulling either randomness from os entropy</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L53" data-line-number="53"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R56" data-line-number="56"></td>

  <td>
    <span data-code-marker=" "><span>     * sources or by consuming randomness which was added by RAND_add().</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L54" data-line-number="54"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R57" data-line-number="57"></td>

  <td>
    <span data-code-marker=" "><span>     *</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L55" data-line-number="55"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>     * The &lt;<span>master</span>&gt; DRBG is a global instance which is accessed concurrently by</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R58" data-line-number="58"></td>

  <td>
    <span data-code-marker="+"><span>     * The &lt;<span>primary</span>&gt; DRBG is a global instance which is accessed concurrently by</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L56" data-line-number="56"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R59" data-line-number="59"></td>

  <td>
    <span data-code-marker=" "><span>     * all threads. The necessary locking is managed automatically by its child</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L57" data-line-number="57"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R60" data-line-number="60"></td>

  <td>
    <span data-code-marker=" "><span>     * DRBG instances during reseeding.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L58" data-line-number="58"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R61" data-line-number="61"></td>

  <td>
    <span data-code-marker=" "><span>     <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L59" data-line-number="59"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    RAND_DRBG *<span>master_drbg</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R62" data-line-number="62"></td>

  <td>
    <span data-code-marker="+">    RAND_DRBG *<span>primary_drbg</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L60" data-line-number="60"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R63" data-line-number="63"></td>

  <td>
    <span data-code-marker=" ">    <span><span>/*</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L61" data-line-number="61"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R64" data-line-number="64"></td>

  <td>
    <span data-code-marker=" "><span>     * The &lt;public&gt; DRBG</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L62" data-line-number="62"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R65" data-line-number="65"></td>

  <td>
    <span data-code-marker=" "><span>     *</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L63" data-line-number="63"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R66" data-line-number="66"></td>

  <td>
    <span data-code-marker=" "><span>     * Used by default for generating random bytes using RAND_bytes().</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L64" data-line-number="64"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R67" data-line-number="67"></td>

  <td>
    <span data-code-marker=" "><span>     *</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L65" data-line-number="65"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>     * The &lt;public&gt; DRBG is thread-local, i.e., there is one instance<span> per</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L66" data-line-number="66"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>     * thread.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R68" data-line-number="68"></td>

  <td>
    <span data-code-marker="+"><span>     * The &lt;public&gt; <span>secondary </span>DRBG is thread-local, i.e., there is one instance</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R69" data-line-number="69"></td>

  <td>
    <span data-code-marker="+"><span>     * <span>per </span>thread.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L67" data-line-number="67"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R70" data-line-number="70"></td>

  <td>
    <span data-code-marker=" "><span>     <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L68" data-line-number="68"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R71" data-line-number="71"></td>

  <td>
    <span data-code-marker=" ">    CRYPTO_THREAD_LOCAL public_drbg;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L69" data-line-number="69"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R72" data-line-number="72"></td>

  <td>
    <span data-code-marker=" ">    <span><span>/*</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L70" data-line-number="70"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R73" data-line-number="73"></td>

  <td>
    <span data-code-marker=" "><span>     * The &lt;private&gt; DRBG</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L71" data-line-number="71"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R74" data-line-number="74"></td>

  <td>
    <span data-code-marker=" "><span>     *</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L72" data-line-number="72"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R75" data-line-number="75"></td>

  <td>
    <span data-code-marker=" "><span>     * Used by default for generating private keys using RAND_priv_bytes()</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L73" data-line-number="73"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R76" data-line-number="76"></td>

  <td>
    <span data-code-marker=" "><span>     *</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L74" data-line-number="74"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>     * The &lt;private&gt; DRBG is thread-local, i.e., there is one<span> instance per</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L75" data-line-number="75"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>     * thread.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R77" data-line-number="77"></td>

  <td>
    <span data-code-marker="+"><span>     * The &lt;private&gt; <span>secondary </span>DRBG is thread-local, i.e., there is one</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R78" data-line-number="78"></td>

  <td>
    <span data-code-marker="+"><span>     * <span>instance per </span>thread.</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L76" data-line-number="76"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R79" data-line-number="79"></td>

  <td>
    <span data-code-marker=" "><span>     <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L77" data-line-number="77"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R80" data-line-number="80"></td>

  <td>
    <span data-code-marker=" ">    CRYPTO_THREAD_LOCAL private_drbg;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L78" data-line-number="78"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R81" data-line-number="81"></td>

  <td>
    <span data-code-marker=" ">} DRBG_GLOBAL;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L79" data-line-number="79"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R82" data-line-number="82"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L80" data-line-number="80"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R83" data-line-number="83"></td>

  <td>
    <span data-code-marker=" ">#<span>define</span> <span>RAND_DRBG_TYPE_FLAGS</span>    ( </span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L81" data-line-number="81"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>RAND_DRBG_FLAG_MASTER</span> | RAND_DRBG_FLAG_PUBLIC | RAND_DRBG_FLAG_PRIVATE )</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R84" data-line-number="84"></td>

  <td>
    <span data-code-marker="+">    <span>RAND_DRBG_FLAG_PRIMARY</span> | RAND_DRBG_FLAG_PUBLIC | RAND_DRBG_FLAG_PRIVATE )</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L82" data-line-number="82"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R85" data-line-number="85"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L83" data-line-number="83"></td>

    <td></td>

  <td>
    <span data-code-marker="-">#<span>define</span> <span>RAND_DRBG_TYPE_MASTER</span><span> </span>                    <span>0</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R86" data-line-number="86"></td>

  <td>
    <span data-code-marker="+">#<span>define</span> <span>RAND_DRBG_TYPE_PRIMARY</span>                    <span>0</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L84" data-line-number="84"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R87" data-line-number="87"></td>

  <td>
    <span data-code-marker=" ">#<span>define</span> <span>RAND_DRBG_TYPE_PUBLIC</span>                     <span>1</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L85" data-line-number="85"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R88" data-line-number="88"></td>

  <td>
    <span data-code-marker=" ">#<span>define</span> <span>RAND_DRBG_TYPE_PRIVATE</span>                    <span>2</span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L86" data-line-number="86"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R89" data-line-number="89"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L87" data-line-number="87"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R90" data-line-number="90"></td>

  <td>
    <span data-code-marker=" "><span><span>/*</span> Defaults <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L88" data-line-number="88"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R91" data-line-number="91"></td>

  <td>
    <span data-code-marker=" "><span>static</span> <span>int</span> rand_drbg_type[<span>3</span>] = {</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L89" data-line-number="89"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    RAND_DRBG_TYPE, <span><span>/*</span> <span>Master</span> <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R92" data-line-number="92"></td>

  <td>
    <span data-code-marker="+">    RAND_DRBG_TYPE, <span><span>/*</span> <span>Primary</span> <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L90" data-line-number="90"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R93" data-line-number="93"></td>

  <td>
    <span data-code-marker=" ">    RAND_DRBG_TYPE, <span><span>/*</span> Public <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L91" data-line-number="91"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R94" data-line-number="94"></td>

  <td>
    <span data-code-marker=" ">    RAND_DRBG_TYPE  <span><span>/*</span> Private <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L92" data-line-number="92"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R95" data-line-number="95"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L93" data-line-number="93"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R96" data-line-number="96"></td>

  <td>
    <span data-code-marker=" "><span>static</span> <span>unsigned</span> <span>int</span> rand_drbg_flags[<span>3</span>] = {</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L94" data-line-number="94"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    RAND_DRBG_FLAGS | <span>RAND_DRBG_FLAG_MASTER</span>, <span><span>/*</span> <span>Master</span> <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L95" data-line-number="95"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    RAND_DRBG_FLAGS | RAND_DRBG_FLAG_PUBLIC, <span><span>/*</span> Public <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L96" data-line-number="96"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    RAND_DRBG_FLAGS | RAND_DRBG_FLAG_PRIVATE <span><span>/*</span> Private <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R97" data-line-number="97"></td>

  <td>
    <span data-code-marker="+">    RAND_DRBG_FLAGS | <span>RAND_DRBG_FLAG_PRIMARY</span>, <span><span>/*</span> <span>Primary</span> <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R98" data-line-number="98"></td>

  <td>
    <span data-code-marker="+">    RAND_DRBG_FLAGS | RAND_DRBG_FLAG_PUBLIC, <span> </span><span><span>/*</span> Public <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R99" data-line-number="99"></td>

  <td>
    <span data-code-marker="+">    RAND_DRBG_FLAGS | RAND_DRBG_FLAG_PRIVATE <span> </span><span><span>/*</span> Private <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L97" data-line-number="97"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R100" data-line-number="100"></td>

  <td>
    <span data-code-marker=" ">};</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L98" data-line-number="98"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R101" data-line-number="101"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L99" data-line-number="99"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>static</span> <span>unsigned</span> <span>int</span> <span>master_reseed_interval</span> = <span>MASTER_RESEED_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L100" data-line-number="100"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>static</span> <span>unsigned</span> <span>int</span> <span>slave_reseed_interval  = SLAVE_RESEED_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R102" data-line-number="102"></td>

  <td>
    <span data-code-marker="+"><span>static</span> <span>unsigned</span> <span>int</span> <span>primary_reseed_interval</span> = <span>PRIMARY_RESEED_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R103" data-line-number="103"></td>

  <td>
    <span data-code-marker="+"><span>static</span> <span>unsigned</span> <span>int</span> <span>secondary_reseed_interval = SECONDARY_RESEED_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L101" data-line-number="101"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R104" data-line-number="104"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L102" data-line-number="102"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>static</span> <span>time_t</span> <span>master_reseed_time_interval</span> = <span>MASTER_RESEED_TIME_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L103" data-line-number="103"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>static</span> <span>time_t</span> <span>slave_reseed_time_interval  = SLAVE_RESEED_TIME_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R105" data-line-number="105"></td>

  <td>
    <span data-code-marker="+"><span>static</span> <span>time_t</span> <span>primary_reseed_time_interval</span> = <span>PRIMARY_RESEED_TIME_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R106" data-line-number="106"></td>

  <td>
    <span data-code-marker="+"><span>static</span> <span>time_t</span> <span>secondary_reseed_time_interval = SECONDARY_RESEED_TIME_INTERVAL</span>;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L104" data-line-number="104"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R107" data-line-number="107"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L105" data-line-number="105"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R108" data-line-number="108"></td>

  <td>
    <span data-code-marker=" "><span><span>/*</span> A logical OR of all used DRBG flag bits (currently there is only one) <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L106" data-line-number="106"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R109" data-line-number="109"></td>

  <td>
    <span data-code-marker=" "><span>static</span> <span>const</span> <span>unsigned</span> <span>int</span> rand_drbg_used_flags =</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L107" data-line-number="107"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R110" data-line-number="110"></td>

  <td>
    <span data-code-marker=" ">    RAND_DRBG_FLAG_CTR_NO_DF | RAND_DRBG_FLAG_HMAC | RAND_DRBG_TYPE_FLAGS;</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L108" data-line-number="108"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R111" data-line-number="111"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L109" data-line-number="109"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R112" data-line-number="112"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L110" data-line-number="110"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span>static</span> RAND_DRBG *<span>drbg_setup</span>(OPENSSL_CTX *ctx, RAND_DRBG *parent, <span>int</span> drbg_type);</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R113" data-line-number="113"></td>

  <td>
    <span data-code-marker="+"><span>static</span> RAND_DRBG *<span>drbg_setup</span>(OPENSSL_CTX *ctx, RAND_DRBG *parent,</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R114" data-line-number="114"></td>

  <td>
    <span data-code-marker="+">                             <span>int</span> drbg_type);</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L111" data-line-number="111"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R115" data-line-number="115"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L112" data-line-number="112"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R116" data-line-number="116"></td>

  <td>
    <span data-code-marker=" "><span>static</span> <span>int</span> <span>get_drbg_params</span>(<span>int</span> type, <span>unsigned</span> <span>int</span> flags, <span>const</span> <span>char</span> **name,</span></td>
</tr>



    <tr data-hunk="31887b396afb8a514dae83261e90e9f1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L113" data-line-number="113"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R117" data-line-number="117"></td>

  <td>
    <span data-code-marker=" ">                           OSSL_PARAM params[<span>3</span>])</span></td>
</tr>



      <tr data-position="97">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=113&amp;last_right=117&amp;left=229&amp;left_hunk_size=7&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=233&amp;right_hunk_size=7" data-left-range="114-170" data-right-range="118-174">
            
          </a>
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=113&amp;last_right=117&amp;left=229&amp;left_hunk_size=7&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=233&amp;right_hunk_size=7" data-left-range="171-228" data-right-range="175-232">
            
          </a>
    </td>
    <td>@@ -229,7 +233,7 @@ static void drbg_ossl_ctx_free(void *vdgbl)</td>
  </tr>

    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L229" data-line-number="229"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R233" data-line-number="233"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span>;</span></td>
</tr>



    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L230" data-line-number="230"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R234" data-line-number="234"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L231" data-line-number="231"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R235" data-line-number="235"></td>

  <td>
    <span data-code-marker=" ">    <span>CRYPTO_THREAD_lock_free</span>(dgbl-&gt;<span>lock</span>);</span></td>
</tr>



    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L232" data-line-number="232"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>RAND_DRBG_free</span>(dgbl-&gt;<span>master_drbg</span>);</span></td>
</tr>



    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R236" data-line-number="236"></td>

  <td>
    <span data-code-marker="+">    <span>RAND_DRBG_free</span>(dgbl-&gt;<span>primary_drbg</span>);</span></td>
</tr>



    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L233" data-line-number="233"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R237" data-line-number="237"></td>

  <td>
    <span data-code-marker=" ">    <span>CRYPTO_THREAD_cleanup_local</span>(&amp;dgbl-&gt;<span>private_drbg</span>);</span></td>
</tr>



    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L234" data-line-number="234"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R238" data-line-number="238"></td>

  <td>
    <span data-code-marker=" ">    <span>CRYPTO_THREAD_cleanup_local</span>(&amp;dgbl-&gt;<span>public_drbg</span>);</span></td>
</tr>



    <tr data-hunk="f3dbfcccc09d735302456550ac80e0fd">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L235" data-line-number="235"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R239" data-line-number="239"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="106">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=235&amp;last_right=239&amp;left=293&amp;left_hunk_size=16&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=297&amp;right_hunk_size=16" data-left-range="236-263" data-right-range="240-267">
            
          </a>
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=235&amp;last_right=239&amp;left=293&amp;left_hunk_size=16&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=297&amp;right_hunk_size=16" data-left-range="264-292" data-right-range="268-296">
            
          </a>
    </td>
    <td>@@ -293,16 +297,16 @@ int RAND_DRBG_set(RAND_DRBG *drbg, int type, unsigned int flags)</td>
  </tr>

    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L293" data-line-number="293"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R297" data-line-number="297"></td>

  <td>
    <span data-code-marker=" ">    <span>int</span> use_df;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L294" data-line-number="294"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R298" data-line-number="298"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L295" data-line-number="295"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R299" data-line-number="299"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (type == <span>0</span> &amp;&amp; flags == <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L296" data-line-number="296"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        type = rand_drbg_type[<span>RAND_DRBG_TYPE_MASTER</span>];</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L297" data-line-number="297"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        flags = rand_drbg_flags[<span>RAND_DRBG_TYPE_MASTER</span>];</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R300" data-line-number="300"></td>

  <td>
    <span data-code-marker="+">        type = rand_drbg_type[<span>RAND_DRBG_TYPE_PRIMARY</span>];</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R301" data-line-number="301"></td>

  <td>
    <span data-code-marker="+">        flags = rand_drbg_flags[<span>RAND_DRBG_TYPE_PRIMARY</span>];</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L298" data-line-number="298"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R302" data-line-number="302"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L299" data-line-number="299"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R303" data-line-number="303"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L300" data-line-number="300"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R304" data-line-number="304"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (drbg-&gt;<span>parent</span> == <span>NULL</span>) {</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L301" data-line-number="301"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        reseed_interval = <span>master_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L302" data-line-number="302"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        reseed_time_interval = <span>master_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R305" data-line-number="305"></td>

  <td>
    <span data-code-marker="+">        reseed_interval = <span>primary_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R306" data-line-number="306"></td>

  <td>
    <span data-code-marker="+">        reseed_time_interval = <span>primary_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L303" data-line-number="303"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R307" data-line-number="307"></td>

  <td>
    <span data-code-marker=" ">    } <span>else</span> {</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L304" data-line-number="304"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        reseed_interval = <span>slave_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L305" data-line-number="305"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        reseed_time_interval = <span>slave_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R308" data-line-number="308"></td>

  <td>
    <span data-code-marker="+">        reseed_interval = <span>secondary_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R309" data-line-number="309"></td>

  <td>
    <span data-code-marker="+">        reseed_time_interval = <span>secondary_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L306" data-line-number="306"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R310" data-line-number="310"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L307" data-line-number="307"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R311" data-line-number="311"></td>

  <td>
    <span data-code-marker=" ">    *p++ = <span>OSSL_PARAM_construct_uint</span>(OSSL_DRBG_PARAM_RESEED_REQUESTS,</span></td>
</tr>



    <tr data-hunk="8509cd6451811911532b75cdd85371aa">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L308" data-line-number="308"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R312" data-line-number="312"></td>

  <td>
    <span data-code-marker=" ">                                     &amp;reseed_interval);</span></td>
</tr>



      <tr data-position="129">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=308&amp;last_right=312&amp;left=371&amp;left_hunk_size=17&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=375&amp;right_hunk_size=19" data-left-range="309-338" data-right-range="313-342">
            
          </a>
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=308&amp;last_right=312&amp;left=371&amp;left_hunk_size=17&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=375&amp;right_hunk_size=19" data-left-range="339-370" data-right-range="343-374">
            
          </a>
    </td>
    <td>@@ -371,17 +375,19 @@ int RAND_DRBG_set_defaults(int type, unsigned int flags)</td>
  </tr>

    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L371" data-line-number="371"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R375" data-line-number="375"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L372" data-line-number="372"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R376" data-line-number="376"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L373" data-line-number="373"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R377" data-line-number="377"></td>

  <td>
    <span data-code-marker=" ">    all = ((flags &amp; RAND_DRBG_TYPE_FLAGS) == <span>0</span>);</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L374" data-line-number="374"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (all || (flags &amp; RAND_DRBG_FLAG_MASTER) != <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L375" data-line-number="375"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        rand_drbg_type[RAND_DRBG_TYPE_MASTER] = type;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L376" data-line-number="376"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        rand_drbg_flags[RAND_DRBG_TYPE_MASTER] = flags | RAND_DRBG_FLAG_MASTER;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R378" data-line-number="378"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (all || (flags &amp; RAND_DRBG_FLAG_PRIMARY) != <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R379" data-line-number="379"></td>

  <td>
    <span data-code-marker="+">        rand_drbg_type[RAND_DRBG_TYPE_PRIMARY] = type;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R380" data-line-number="380"></td>

  <td>
    <span data-code-marker="+">        rand_drbg_flags[RAND_DRBG_TYPE_PRIMARY] = flags</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R381" data-line-number="381"></td>

  <td>
    <span data-code-marker="+">                                                  | RAND_DRBG_FLAG_PRIMARY;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L377" data-line-number="377"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R382" data-line-number="382"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L378" data-line-number="378"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R383" data-line-number="383"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (all || (flags &amp; RAND_DRBG_FLAG_PUBLIC) != <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L379" data-line-number="379"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R384" data-line-number="384"></td>

  <td>
    <span data-code-marker=" ">        rand_drbg_type[RAND_DRBG_TYPE_PUBLIC]  = type;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L380" data-line-number="380"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R385" data-line-number="385"></td>

  <td>
    <span data-code-marker=" ">        rand_drbg_flags[RAND_DRBG_TYPE_PUBLIC] = flags | RAND_DRBG_FLAG_PUBLIC;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L381" data-line-number="381"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R386" data-line-number="386"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L382" data-line-number="382"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R387" data-line-number="387"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (all || (flags &amp; RAND_DRBG_FLAG_PRIVATE) != <span>0</span>) {</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L383" data-line-number="383"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R388" data-line-number="388"></td>

  <td>
    <span data-code-marker=" ">        rand_drbg_type[RAND_DRBG_TYPE_PRIVATE] = type;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L384" data-line-number="384"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        rand_drbg_flags[RAND_DRBG_TYPE_PRIVATE] = flags | RAND_DRBG_FLAG_PRIVATE;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R389" data-line-number="389"></td>

  <td>
    <span data-code-marker="+">        rand_drbg_flags[RAND_DRBG_TYPE_PRIVATE] = flags</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R390" data-line-number="390"></td>

  <td>
    <span data-code-marker="+">                                                  | RAND_DRBG_FLAG_PRIVATE;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L385" data-line-number="385"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R391" data-line-number="391"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L386" data-line-number="386"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R392" data-line-number="392"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> <span>1</span>;</span></td>
</tr>



    <tr data-hunk="8f203d2a35119e121e7c60fe317db67c">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L387" data-line-number="387"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R393" data-line-number="393"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



      <tr data-position="153">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=387&amp;last_right=393&amp;left=473&amp;left_hunk_size=8&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=479&amp;right_hunk_size=8" data-left-range="388-429" data-right-range="394-435">
            
          </a>
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=387&amp;last_right=393&amp;left=473&amp;left_hunk_size=8&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=479&amp;right_hunk_size=8" data-left-range="430-472" data-right-range="436-478">
            
          </a>
    </td>
    <td>@@ -473,8 +479,8 @@ int RAND_DRBG_uninstantiate(RAND_DRBG *drbg)</td>
  </tr>

    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L473" data-line-number="473"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R479" data-line-number="479"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>0</span>;</span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L474" data-line-number="474"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R480" data-line-number="480"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L475" data-line-number="475"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R481" data-line-number="481"></td>

  <td>
    <span data-code-marker=" ">    <span><span>/*</span> The reset uses the default values for type and flags <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L476" data-line-number="476"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (drbg-&gt;<span>flags</span> &amp; <span>RAND_DRBG_FLAG_MASTER</span>)</span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L477" data-line-number="477"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>index</span> = <span>RAND_DRBG_TYPE_MASTER</span>;</span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R482" data-line-number="482"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (drbg-&gt;<span>flags</span> &amp; <span>RAND_DRBG_FLAG_PRIMARY</span>)</span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R483" data-line-number="483"></td>

  <td>
    <span data-code-marker="+">        <span>index</span> = <span>RAND_DRBG_TYPE_PRIMARY</span>;</span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L478" data-line-number="478"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R484" data-line-number="484"></td>

  <td>
    <span data-code-marker=" ">    <span>else</span> <span>if</span> (drbg-&gt;<span>flags</span> &amp; RAND_DRBG_FLAG_PRIVATE)</span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L479" data-line-number="479"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R485" data-line-number="485"></td>

  <td>
    <span data-code-marker=" ">        <span>index</span> = RAND_DRBG_TYPE_PRIVATE;</span></td>
</tr>



    <tr data-hunk="8e0cdb180d3b2d45ef5cc35a92938f1d">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L480" data-line-number="480"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R486" data-line-number="486"></td>

  <td>
    <span data-code-marker=" ">    <span>else</span> <span>if</span> (drbg-&gt;<span>flags</span> &amp; RAND_DRBG_FLAG_PUBLIC)</span></td>
</tr>



      <tr data-position="164">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=480&amp;last_right=486&amp;left=730&amp;left_hunk_size=32&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=736&amp;right_hunk_size=32" data-left-range="481-604" data-right-range="487-610">
            
          </a>
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=480&amp;last_right=486&amp;left=730&amp;left_hunk_size=32&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=736&amp;right_hunk_size=32" data-left-range="605-729" data-right-range="611-735">
            
          </a>
    </td>
    <td>@@ -730,32 +736,32 @@ int RAND_DRBG_set_reseed_time_interval(RAND_DRBG *drbg, time_t interval)</td>
  </tr>

    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L730" data-line-number="730"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R736" data-line-number="736"></td>

  <td>
    <span data-code-marker=" "><span><span>/*</span></span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L731" data-line-number="731"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R737" data-line-number="737"></td>

  <td>
    <span data-code-marker=" "><span> * Set the default values for reseed (time) intervals of new DRBG instances</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L732" data-line-number="732"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R738" data-line-number="738"></td>

  <td>
    <span data-code-marker=" "><span> *</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L733" data-line-number="733"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span> * The default values can be set independently for <span>master</span> DRBG instances</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L734" data-line-number="734"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span> * (without a parent) and <span>slave</span> DRBG instances (with parent).</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R739" data-line-number="739"></td>

  <td>
    <span data-code-marker="+"><span> * The default values can be set independently for <span>primary</span> DRBG instances</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R740" data-line-number="740"></td>

  <td>
    <span data-code-marker="+"><span> * (without a parent) and <span>secondary</span> DRBG instances (with parent).</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L735" data-line-number="735"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R741" data-line-number="741"></td>

  <td>
    <span data-code-marker=" "><span> *</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L736" data-line-number="736"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R742" data-line-number="742"></td>

  <td>
    <span data-code-marker=" "><span> * Returns 1 on success, 0 on failure.</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L737" data-line-number="737"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R743" data-line-number="743"></td>

  <td>
    <span data-code-marker=" "><span> <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L738" data-line-number="738"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R744" data-line-number="744"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L739" data-line-number="739"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R745" data-line-number="745"></td>

  <td>
    <span data-code-marker=" "><span>int</span> <span>RAND_DRBG_set_reseed_defaults</span>(</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L740" data-line-number="740"></td>

    <td></td>

  <td>
    <span data-code-marker="-">                                  <span>unsigned</span> <span>int</span> <span>_master_reseed_interval</span>,</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L741" data-line-number="741"></td>

    <td></td>

  <td>
    <span data-code-marker="-">                                  <span>unsigned</span> <span>int</span> <span>_slave_reseed_interval</span>,</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L742" data-line-number="742"></td>

    <td></td>

  <td>
    <span data-code-marker="-">                                  <span>time_t</span> <span>_master_reseed_time_interval</span>,</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L743" data-line-number="743"></td>

    <td></td>

  <td>
    <span data-code-marker="-">                                  <span>time_t</span> <span>_slave_reseed_time_interval</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R746" data-line-number="746"></td>

  <td>
    <span data-code-marker="+">                                  <span>unsigned</span> <span>int</span> <span>_primary_reseed_interval</span>,</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R747" data-line-number="747"></td>

  <td>
    <span data-code-marker="+">                                  <span>unsigned</span> <span>int</span> <span>_secondary_reseed_interval</span>,</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R748" data-line-number="748"></td>

  <td>
    <span data-code-marker="+">                                  <span>time_t</span> <span>_primary_reseed_time_interval</span>,</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R749" data-line-number="749"></td>

  <td>
    <span data-code-marker="+">                                  <span>time_t</span> <span>_secondary_reseed_time_interval</span></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L744" data-line-number="744"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R750" data-line-number="750"></td>

  <td>
    <span data-code-marker=" ">                                  )</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L745" data-line-number="745"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R751" data-line-number="751"></td>

  <td>
    <span data-code-marker=" ">{</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L746" data-line-number="746"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (<span>_master_reseed_interval</span> &gt; MAX_RESEED_INTERVAL</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L747" data-line-number="747"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        || <span>_slave_reseed_interval</span> &gt; MAX_RESEED_INTERVAL)</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R752" data-line-number="752"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (<span>_primary_reseed_interval</span> &gt; MAX_RESEED_INTERVAL</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R753" data-line-number="753"></td>

  <td>
    <span data-code-marker="+">        || <span>_secondary_reseed_interval</span> &gt; MAX_RESEED_INTERVAL)</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L748" data-line-number="748"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R754" data-line-number="754"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>0</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L749" data-line-number="749"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R755" data-line-number="755"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L750" data-line-number="750"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (<span>_master_reseed_time_interval</span> &gt; MAX_RESEED_TIME_INTERVAL</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L751" data-line-number="751"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        || <span>_slave_reseed_time_interval</span> &gt; MAX_RESEED_TIME_INTERVAL)</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R756" data-line-number="756"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (<span>_primary_reseed_time_interval</span> &gt; MAX_RESEED_TIME_INTERVAL</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R757" data-line-number="757"></td>

  <td>
    <span data-code-marker="+">        || <span>_secondary_reseed_time_interval</span> &gt; MAX_RESEED_TIME_INTERVAL)</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L752" data-line-number="752"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R758" data-line-number="758"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>0</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L753" data-line-number="753"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R759" data-line-number="759"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L754" data-line-number="754"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>master_reseed_interval</span> = <span>_master_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L755" data-line-number="755"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>slave_reseed_interval</span> = <span>_slave_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R760" data-line-number="760"></td>

  <td>
    <span data-code-marker="+">    <span>primary_reseed_interval</span> = <span>_primary_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R761" data-line-number="761"></td>

  <td>
    <span data-code-marker="+">    <span>secondary_reseed_interval</span> = <span>_secondary_reseed_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L756" data-line-number="756"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R762" data-line-number="762"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L757" data-line-number="757"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>master_reseed_time_interval</span> = <span>_master_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L758" data-line-number="758"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>slave_reseed_time_interval</span> = <span>_slave_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R763" data-line-number="763"></td>

  <td>
    <span data-code-marker="+">    <span>primary_reseed_time_interval</span> = <span>_primary_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R764" data-line-number="764"></td>

  <td>
    <span data-code-marker="+">    <span>secondary_reseed_time_interval</span> = <span>_secondary_reseed_time_interval</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L759" data-line-number="759"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R765" data-line-number="765"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L760" data-line-number="760"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R766" data-line-number="766"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> <span>1</span>;</span></td>
</tr>



    <tr data-hunk="53cfc5cd1f157d177be2a8716a77c6a2">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L761" data-line-number="761"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R767" data-line-number="767"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



      <tr data-position="211">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=761&amp;last_right=767&amp;left=793&amp;left_hunk_size=7&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=799&amp;right_hunk_size=7" data-left-range="762-776" data-right-range="768-782">
            
          </a>
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=761&amp;last_right=767&amp;left=793&amp;left_hunk_size=7&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=799&amp;right_hunk_size=7" data-left-range="777-792" data-right-range="783-798">
            
          </a>
    </td>
    <td>@@ -793,7 +799,7 @@ static RAND_DRBG *drbg_setup(OPENSSL_CTX *ctx, RAND_DRBG *parent, int drbg_type)</td>
  </tr>

    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L793" data-line-number="793"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R799" data-line-number="799"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (drbg == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L794" data-line-number="794"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R800" data-line-number="800"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L795" data-line-number="795"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R801" data-line-number="801"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L796" data-line-number="796"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span><span>/*</span> Only the <span>master</span> DRBG needs to have a lock <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R802" data-line-number="802"></td>

  <td>
    <span data-code-marker="+">    <span><span>/*</span> Only the <span>primary</span> DRBG needs to have a lock <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L797" data-line-number="797"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R803" data-line-number="803"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (parent == <span>NULL</span> &amp;&amp; <span>EVP_RAND_enable_locking</span>(drbg-&gt;<span>rand</span>) == <span>0</span>)</span></td>
</tr>



    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L798" data-line-number="798"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R804" data-line-number="804"></td>

  <td>
    <span data-code-marker=" ">        <span>goto</span> err;</span></td>
</tr>



    <tr data-hunk="48a43afce522241d4fe2924f1a200b71">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L799" data-line-number="799"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R805" data-line-number="805"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



      <tr data-position="220">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=799&amp;last_right=805&amp;left=878&amp;left_hunk_size=30&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=884&amp;right_hunk_size=30" data-left-range="800-837" data-right-range="806-843">
            
          </a>
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Up" aria-label="Expand Up" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=up&amp;in_wiki_context=&amp;last_left=799&amp;last_right=805&amp;left=878&amp;left_hunk_size=30&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=884&amp;right_hunk_size=30" data-left-range="838-877" data-right-range="844-883">
            
          </a>
    </td>
    <td>@@ -878,30 +884,30 @@ int RAND_DRBG_verify_zeroization(RAND_DRBG *drbg)</td>
  </tr>

    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L878" data-line-number="878"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R884" data-line-number="884"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L879" data-line-number="879"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R885" data-line-number="885"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L880" data-line-number="880"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R886" data-line-number="886"></td>

  <td>
    <span data-code-marker=" "><span><span>/*</span></span></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L881" data-line-number="881"></td>

    <td></td>

  <td>
    <span data-code-marker="-"><span> * Get the <span>master</span> DRBG.</span></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R887" data-line-number="887"></td>

  <td>
    <span data-code-marker="+"><span> * Get the <span>primary</span> DRBG.</span></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L882" data-line-number="882"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R888" data-line-number="888"></td>

  <td>
    <span data-code-marker=" "><span> * Returns pointer to the DRBG on success, NULL on failure.</span></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L883" data-line-number="883"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R889" data-line-number="889"></td>

  <td>
    <span data-code-marker=" "><span> *</span></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L884" data-line-number="884"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R890" data-line-number="890"></td>

  <td>
    <span data-code-marker=" "><span> <span>*/</span></span></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L885" data-line-number="885"></td>

    <td></td>

  <td>
    <span data-code-marker="-">RAND_DRBG *<span>OPENSSL_CTX_get0_master_drbg</span>(OPENSSL_CTX *ctx)</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R891" data-line-number="891"></td>

  <td>
    <span data-code-marker="+">RAND_DRBG *<span>OPENSSL_CTX_get0_primary_drbg</span>(OPENSSL_CTX *ctx)</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L886" data-line-number="886"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R892" data-line-number="892"></td>

  <td>
    <span data-code-marker=" ">{</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L887" data-line-number="887"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R893" data-line-number="893"></td>

  <td>
    <span data-code-marker=" ">    DRBG_GLOBAL *dgbl = <span>drbg_get_global</span>(ctx);</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L888" data-line-number="888"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R894" data-line-number="894"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L889" data-line-number="889"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R895" data-line-number="895"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (dgbl == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L890" data-line-number="890"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R896" data-line-number="896"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L891" data-line-number="891"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R897" data-line-number="897"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L892" data-line-number="892"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>if</span> (dgbl-&gt;<span>master_drbg</span> == <span>NULL</span>) {</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R898" data-line-number="898"></td>

  <td>
    <span data-code-marker="+">    <span>if</span> (dgbl-&gt;<span>primary_drbg</span> == <span>NULL</span>) {</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L893" data-line-number="893"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R899" data-line-number="899"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (!<span>CRYPTO_THREAD_write_lock</span>(dgbl-&gt;<span>lock</span>))</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L894" data-line-number="894"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R900" data-line-number="900"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L895" data-line-number="895"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (dgbl-&gt;<span>master_drbg</span> == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L896" data-line-number="896"></td>

    <td></td>

  <td>
    <span data-code-marker="-">            dgbl-&gt;<span>master_drbg</span> = <span>drbg_setup</span>(ctx, <span>NULL</span>, <span>RAND_DRBG_TYPE_MASTER</span>);</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R901" data-line-number="901"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (dgbl-&gt;<span>primary_drbg</span> == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R902" data-line-number="902"></td>

  <td>
    <span data-code-marker="+">            dgbl-&gt;<span>primary_drbg</span> = <span>drbg_setup</span>(ctx, <span>NULL</span>, <span>RAND_DRBG_TYPE_PRIMARY</span>);</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L897" data-line-number="897"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R903" data-line-number="903"></td>

  <td>
    <span data-code-marker=" ">        <span>CRYPTO_THREAD_unlock</span>(dgbl-&gt;<span>lock</span>);</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L898" data-line-number="898"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R904" data-line-number="904"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L899" data-line-number="899"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> dgbl-&gt;<span>master_drbg</span>;</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R905" data-line-number="905"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> dgbl-&gt;<span>primary_drbg</span>;</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L900" data-line-number="900"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R906" data-line-number="906"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L901" data-line-number="901"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R907" data-line-number="907"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L902" data-line-number="902"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R908" data-line-number="908"></td>

  <td>
    <span data-code-marker=" ">RAND_DRBG *<span>RAND_DRBG_get0_master</span>(<span>void</span>)</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L903" data-line-number="903"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R909" data-line-number="909"></td>

  <td>
    <span data-code-marker=" ">{</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L904" data-line-number="904"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    <span>return</span> <span>OPENSSL_CTX_get0_master_drbg</span>(<span>NULL</span>);</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R910" data-line-number="910"></td>

  <td>
    <span data-code-marker="+">    <span>return</span> <span>OPENSSL_CTX_get0_primary_drbg</span>(<span>NULL</span>);</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L905" data-line-number="905"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R911" data-line-number="911"></td>

  <td>
    <span data-code-marker=" ">}</span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L906" data-line-number="906"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R912" data-line-number="912"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="3ea7b46e817dcde45494ed8c00b1b582">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L907" data-line-number="907"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R913" data-line-number="913"></td>

  <td>
    <span data-code-marker=" "><span><span>/*</span></span></span></td>
</tr>



      <tr data-position="258">
    <td colspan="2">
        <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand All" aria-label="Expand All" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;in_wiki_context=&amp;last_left=907&amp;last_right=913&amp;left=911&amp;left_hunk_size=15&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=917&amp;right_hunk_size=15" data-left-range="908-908" data-right-range="914-914">
          
        </a>
    </td>
    <td>@@ -911,15 +917,15 @@ RAND_DRBG *RAND_DRBG_get0_master(void)</td>
  </tr>

    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L911" data-line-number="911"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R917" data-line-number="917"></td>

  <td>
    <span data-code-marker=" ">RAND_DRBG *<span>OPENSSL_CTX_get0_public_drbg</span>(OPENSSL_CTX *ctx)</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L912" data-line-number="912"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R918" data-line-number="918"></td>

  <td>
    <span data-code-marker=" ">{</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L913" data-line-number="913"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R919" data-line-number="919"></td>

  <td>
    <span data-code-marker=" ">    DRBG_GLOBAL *dgbl = <span>drbg_get_global</span>(ctx);</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L914" data-line-number="914"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    RAND_DRBG *drbg, *<span>master</span>;</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R920" data-line-number="920"></td>

  <td>
    <span data-code-marker="+">    RAND_DRBG *drbg, *<span>primary</span>;</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L915" data-line-number="915"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R921" data-line-number="921"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L916" data-line-number="916"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R922" data-line-number="922"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (dgbl == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L917" data-line-number="917"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R923" data-line-number="923"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L918" data-line-number="918"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R924" data-line-number="924"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L919" data-line-number="919"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R925" data-line-number="925"></td>

  <td>
    <span data-code-marker=" ">    drbg = <span>CRYPTO_THREAD_get_local</span>(&amp;dgbl-&gt;<span>public_drbg</span>);</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L920" data-line-number="920"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R926" data-line-number="926"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (drbg == <span>NULL</span>) {</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L921" data-line-number="921"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>master</span> = <span>OPENSSL_CTX_get0_master_drbg</span>(ctx);</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L922" data-line-number="922"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (<span>master</span> == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R927" data-line-number="927"></td>

  <td>
    <span data-code-marker="+">        <span>primary</span> = <span>OPENSSL_CTX_get0_primary_drbg</span>(ctx);</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R928" data-line-number="928"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (<span>primary</span> == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L923" data-line-number="923"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R929" data-line-number="929"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L924" data-line-number="924"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R930" data-line-number="930"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="17fd4fc41f994af47ed0725341ba17b6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L925" data-line-number="925"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R931" data-line-number="931"></td>

  <td>
    <span data-code-marker=" ">        ctx = <span>openssl_ctx_get_concrete</span>(ctx);</span></td>
</tr>



      <tr data-position="277">
    <td colspan="2">
        <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand All" aria-label="Expand All" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;in_wiki_context=&amp;last_left=925&amp;last_right=931&amp;left=930&amp;left_hunk_size=7&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=936&amp;right_hunk_size=7" data-left-range="926-926" data-right-range="932-932">
          
        </a>
    </td>
    <td>@@ -930,7 +936,7 @@ RAND_DRBG *OPENSSL_CTX_get0_public_drbg(OPENSSL_CTX *ctx)</td>
  </tr>

    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L930" data-line-number="930"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R936" data-line-number="936"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>CRYPTO_THREAD_get_local</span>(&amp;dgbl-&gt;<span>private_drbg</span>) == <span>NULL</span></span></td>
</tr>



    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L931" data-line-number="931"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R937" data-line-number="937"></td>

  <td>
    <span data-code-marker=" ">                &amp;&amp; !<span>ossl_init_thread_start</span>(<span>NULL</span>, ctx, drbg_delete_thread_state))</span></td>
</tr>



    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L932" data-line-number="932"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R938" data-line-number="938"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L933" data-line-number="933"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        drbg = <span>drbg_setup</span>(ctx, <span>master</span>, RAND_DRBG_TYPE_PUBLIC);</span></td>
</tr>



    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R939" data-line-number="939"></td>

  <td>
    <span data-code-marker="+">        drbg = <span>drbg_setup</span>(ctx, <span>primary</span>, RAND_DRBG_TYPE_PUBLIC);</span></td>
</tr>



    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L934" data-line-number="934"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R940" data-line-number="940"></td>

  <td>
    <span data-code-marker=" ">        <span>CRYPTO_THREAD_set_local</span>(&amp;dgbl-&gt;<span>public_drbg</span>, drbg);</span></td>
</tr>



    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L935" data-line-number="935"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R941" data-line-number="941"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="7c06ec4bf80b622e1a622a53a4aa48a6">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L936" data-line-number="936"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R942" data-line-number="942"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> drbg;</span></td>
</tr>



      <tr data-position="286">
    <td colspan="2">
        <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand All" aria-label="Expand All" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;in_wiki_context=&amp;last_left=936&amp;last_right=942&amp;left=948&amp;left_hunk_size=15&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=954&amp;right_hunk_size=15" data-left-range="937-941" data-right-range="943-947">
          
        </a>
    </td>
    <td>@@ -948,15 +954,15 @@ RAND_DRBG *RAND_DRBG_get0_public(void)</td>
  </tr>

    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L948" data-line-number="948"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R954" data-line-number="954"></td>

  <td>
    <span data-code-marker=" ">RAND_DRBG *<span>OPENSSL_CTX_get0_private_drbg</span>(OPENSSL_CTX *ctx)</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L949" data-line-number="949"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R955" data-line-number="955"></td>

  <td>
    <span data-code-marker=" ">{</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L950" data-line-number="950"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R956" data-line-number="956"></td>

  <td>
    <span data-code-marker=" ">    DRBG_GLOBAL *dgbl = <span>drbg_get_global</span>(ctx);</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L951" data-line-number="951"></td>

    <td></td>

  <td>
    <span data-code-marker="-">    RAND_DRBG *drbg, *<span>master</span>;</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R957" data-line-number="957"></td>

  <td>
    <span data-code-marker="+">    RAND_DRBG *drbg, *<span>primary</span>;</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L952" data-line-number="952"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R958" data-line-number="958"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L953" data-line-number="953"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R959" data-line-number="959"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (dgbl == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L954" data-line-number="954"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R960" data-line-number="960"></td>

  <td>
    <span data-code-marker=" ">        <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L955" data-line-number="955"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R961" data-line-number="961"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L956" data-line-number="956"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R962" data-line-number="962"></td>

  <td>
    <span data-code-marker=" ">    drbg = <span>CRYPTO_THREAD_get_local</span>(&amp;dgbl-&gt;<span>private_drbg</span>);</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L957" data-line-number="957"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R963" data-line-number="963"></td>

  <td>
    <span data-code-marker=" ">    <span>if</span> (drbg == <span>NULL</span>) {</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L958" data-line-number="958"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>master</span> = <span>OPENSSL_CTX_get0_master_drbg</span>(ctx);</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L959" data-line-number="959"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        <span>if</span> (<span>master</span> == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R964" data-line-number="964"></td>

  <td>
    <span data-code-marker="+">        <span>primary</span> = <span>OPENSSL_CTX_get0_primary_drbg</span>(ctx);</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R965" data-line-number="965"></td>

  <td>
    <span data-code-marker="+">        <span>if</span> (<span>primary</span> == <span>NULL</span>)</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L960" data-line-number="960"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R966" data-line-number="966"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L961" data-line-number="961"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R967" data-line-number="967"></td>

  <td>
    <span data-code-marker=" "><br></span></td>
</tr>



    <tr data-hunk="ff48a7f50a974a77cdc8b67b89d188a1">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L962" data-line-number="962"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R968" data-line-number="968"></td>

  <td>
    <span data-code-marker=" ">        ctx = <span>openssl_ctx_get_concrete</span>(ctx);</span></td>
</tr>



      <tr data-position="305">
    <td colspan="2">
        <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand All" aria-label="Expand All" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;in_wiki_context=&amp;last_left=962&amp;last_right=968&amp;left=967&amp;left_hunk_size=7&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=973&amp;right_hunk_size=7" data-left-range="963-963" data-right-range="969-969">
          
        </a>
    </td>
    <td>@@ -967,7 +973,7 @@ RAND_DRBG *OPENSSL_CTX_get0_private_drbg(OPENSSL_CTX *ctx)</td>
  </tr>

    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L967" data-line-number="967"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R973" data-line-number="973"></td>

  <td>
    <span data-code-marker=" ">        <span>if</span> (<span>CRYPTO_THREAD_get_local</span>(&amp;dgbl-&gt;<span>public_drbg</span>) == <span>NULL</span></span></td>
</tr>



    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L968" data-line-number="968"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R974" data-line-number="974"></td>

  <td>
    <span data-code-marker=" ">                &amp;&amp; !<span>ossl_init_thread_start</span>(<span>NULL</span>, ctx, drbg_delete_thread_state))</span></td>
</tr>



    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L969" data-line-number="969"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R975" data-line-number="975"></td>

  <td>
    <span data-code-marker=" ">            <span>return</span> <span>NULL</span>;</span></td>
</tr>



    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L970" data-line-number="970"></td>

    <td></td>

  <td>
    <span data-code-marker="-">        drbg = <span>drbg_setup</span>(ctx, <span>master</span>, RAND_DRBG_TYPE_PRIVATE);</span></td>
</tr>



    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R976" data-line-number="976"></td>

  <td>
    <span data-code-marker="+">        drbg = <span>drbg_setup</span>(ctx, <span>primary</span>, RAND_DRBG_TYPE_PRIVATE);</span></td>
</tr>



    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L971" data-line-number="971"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R977" data-line-number="977"></td>

  <td>
    <span data-code-marker=" ">        <span>CRYPTO_THREAD_set_local</span>(&amp;dgbl-&gt;<span>private_drbg</span>, drbg);</span></td>
</tr>



    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L972" data-line-number="972"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R978" data-line-number="978"></td>

  <td>
    <span data-code-marker=" ">    }</span></td>
</tr>



    <tr data-hunk="42d593404fd657412375e1f060c58586">
    <td id="diff-9181ac017a6177a5f2619f65c9b7a346L973" data-line-number="973"></td>

    <td id="diff-9181ac017a6177a5f2619f65c9b7a346R979" data-line-number="979"></td>

  <td>
    <span data-code-marker=" ">    <span>return</span> drbg;</span></td>
</tr>



  <tr data-position="">
    <td colspan="2">
          <a href="#diff-9181ac017a6177a5f2619f65c9b7a346" title="Expand Down" aria-label="Expand Down" data-url="/openssl/openssl/blob_excerpt/4b5d832df21a867c8750e5084e67c1e33490dc27?diff=unified&amp;direction=down&amp;in_wiki_context=&amp;last_left=973&amp;last_right=979&amp;left=1004&amp;left_hunk_size=&amp;mode=100644&amp;path=crypto%2Frand%2Fdrbg_lib.c&amp;right=1004&amp;right_hunk_size=" data-left-range="974-1003" data-right-range="980-1003">
            
          </a>
    </td>
    <td></td>
  </tr>


          </tbody></table>
        </div>

  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>