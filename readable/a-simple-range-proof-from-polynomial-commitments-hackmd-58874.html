<!DOCTYPE html>
<html lang="en">
<head>
    <title>
A Simple Range Proof From Polynomial Commitments - HackMD - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="A Simple Range Proof From Polynomial Commitments - HackMD - linksfor.dev(s)"/>
    <meta property="og:description" content=" $$ \def\Fp{\mathbb{F}_p} \def\FF{\Fp^{\scriptscriptstyle{(&lt;n)}}[X]} \def\com{\mathbf{com}} \def\ran"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://hackmd.io/@dabo/B1U4kx8XI"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - A Simple Range Proof From Polynomial Commitments - HackMD</title>
<div class="readable">
        <h1>A Simple Range Proof From Polynomial Commitments - HackMD</h1>
            <div>Reading time: 5-7 minutes</div>
        <div>Posted here: 23 Feb 2020</div>
        <p><a href="https://hackmd.io/@dabo/B1U4kx8XI">https://hackmd.io/@dabo/B1U4kx8XI</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="doc" data-hard-breaks="true">

<h3 id="Dan-Boneh-Ben-Fisch-Ariel-Gabizon-and-Zac-Williamson"><a href="#Dan-Boneh-Ben-Fisch-Ariel-Gabizon-and-Zac-Williamson" title="Dan-Boneh-Ben-Fisch-Ariel-Gabizon-and-Zac-Williamson" smoothhashscroll=""><span></span></a>Dan Boneh, Ben Fisch, Ariel Gabizon, and Zac Williamson</h3>
<hr>
<p>Let’s construct a simple zero knowledge range proof from a
hiding polynomial commitment scheme (PCS).</p>
<h3 id="The-setup"><a href="#The-setup" title="The-setup" smoothhashscroll=""><span></span></a>The setup</h3>
<p>Let <span><span></span><span id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span></span> be a prime, where <span><span></span><span id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo>&amp;gt;</mo><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>&gt;</mo><msup><mn>2</mn><mi>n</mi></msup></math></span></span></span> for some <span><span></span><span id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span></span>. We want a commitment scheme for elements in <span><span></span><span id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span> that allows a prover to efficiently convince a verifier that a committed quantity <span><span></span><span id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span> is in the range <span><span></span><span id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;#x2264;</mo><mi>z</mi><mo>&amp;lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><mi>z</mi><mo>&lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math></span></span></span>.</p>
<p>We show that for a committed <span><span></span><span id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span>, the prover can provide an HVZK proof to convince the verifier
that <span><span></span><span id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;#x2264;</mo><mi>z</mi><mo>&amp;lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><mi>z</mi><mo>&lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math></span></span></span> by committing to <strong>two</strong> polynomials of degree <span><span></span><span id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></span>, and running the polynomial evaluation protocol <strong>three</strong> times. Therefore:</p>
<ul>
<li>For the pairing-based polynomial commitment scheme of Kate, Zaverucha and Goldberg, this gives a range proof of length <span><span></span><span id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>O</mi><mi>&amp;#x03BB;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>O</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></span> that can be verified in time <span><span></span><span id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>O</mi><mi>&amp;#x03BB;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>O</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></span>, with a trusted setup and an updatable SRS of size <span><span></span><span id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>O</mi><mi>&amp;#x03BB;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>O</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span></span>.</li>
<li>For the DARK polynomial commitment scheme of Bünz, Fisch, and Szepieniec, this gives a range proof of length <span><span></span><span id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>O</mi><mi>&amp;#x03BB;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>O</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span></span> that can be verified in time <span><span></span><span id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>O</mi><mi>&amp;#x03BB;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>O</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span></span>, with no trusted setup.</li>
<li>For comparison, recall that Bulletproofs give a range proof with no trusted setup of length <span><span></span><span id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>O</mi><mi>&amp;#x03BB;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>O</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span></span> that can be verified in time <span><span></span><span id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>O</mi><mi>&amp;#x03BB;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>O</mi><mi>λ</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span></span>.</li>
</ul>
<p>In what follows we use <span><span></span><span id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;2&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mstyle></mrow></msubsup><mo stretchy=&quot;false&quot;>[</mo><mi>X</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi><mrow><mstyle displaystyle="false" scriptlevel="2"><mrow><mo stretchy="false">(</mo><mo>&lt;</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mrow></msubsup><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></math></span></span></span> to denote polynomials in <span><span></span><span id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub><mo stretchy=&quot;false&quot;>[</mo><mi>X</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></math></span></span></span> of degree less than <span><span></span><span id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span></span>.  We assume that <span><span></span><span id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span></span> divides <span><span></span><span id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>−</mo><mn>1</mn></math></span></span></span> so that there is an element <span><span></span><span id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C9;</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span> of order <span><span></span><span id="MathJax-Element-24-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span></span>.  Let <span><span></span><span id="MathJax-Element-25-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>,</mo><mi>&amp;#x03C9;</mi><mo>,</mo><msup><mi>&amp;#x03C9;</mi><mn>2</mn></msup><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mi>ω</mi><mo>,</mo><msup><mi>ω</mi><mn>2</mn></msup><mo>,</mo><mo>…</mo><mo>,</mo><msup><mi>ω</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo fence="false" stretchy="false">}</mo></math></span></span></span>.</p>
<h3 id="The-commitment-scheme"><a href="#The-commitment-scheme" title="The-commitment-scheme" smoothhashscroll=""><span></span></a>The commitment scheme</h3>
<p>Suppose that we have available a hiding and binding PCS for polynomials in <span><span></span><span id="MathJax-Element-26-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;2&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mstyle></mrow></msubsup><mo stretchy=&quot;false&quot;>[</mo><mi>X</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi><mrow><mstyle displaystyle="false" scriptlevel="2"><mrow><mo stretchy="false">(</mo><mo>&lt;</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mrow></msubsup><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></math></span></span></span>. Moreover, we assume that the polynomial evaluation protocol is HVZK.</p>
<p>To commit to an element <span><span></span><span id="MathJax-Element-27-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span>, choose an arbitrary polynomial <span><span></span><span id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo>&amp;#x2208;</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;2&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mstyle></mrow></msubsup><mo stretchy=&quot;false&quot;>[</mo><mi>X</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo>∈</mo><msubsup><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi><mrow><mstyle displaystyle="false" scriptlevel="2"><mrow><mo stretchy="false">(</mo><mo>&lt;</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mrow></msubsup><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></math></span></span></span> such that <span><span></span><span id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>z</mi></math></span></span></span>. Taking <span><span></span><span id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span></span> as the constant polynomial <span><span></span><span id="MathJax-Element-31-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>z</mi></math></span></span></span> is sufficient.  The commitment to <span><span></span><span id="MathJax-Element-32-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span></span> is the polynomial commitment <span><span></span><span id="MathJax-Element-33-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>c</mi><mi mathvariant=&quot;bold&quot;>o</mi><mi mathvariant=&quot;bold&quot;>m</mi></mrow><mi>f</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="bold">c</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">m</mi></mrow><mi>f</mi></msub></math></span></span></span> to <span><span></span><span id="MathJax-Element-34-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span></span>.</p>
<p>If the PCS is additive,
then the commitment scheme is additively homomorphic:
given commitments to <span><span></span><span id="MathJax-Element-35-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>1</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>1</mn></msub></math></span></span></span> and <span><span></span><span id="MathJax-Element-36-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>2</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>2</mn></msub></math></span></span></span> in <span><span></span><span id="MathJax-Element-37-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span>,
anyone can construct a commitment to <span><span></span><span id="MathJax-Element-38-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>1</mn></msub><mo>+</mo><msub><mi>z</mi><mn>2</mn></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>1</mn></msub><mo>+</mo><msub><mi>z</mi><mn>2</mn></msub></math></span></span></span>.</p>
<h3 id="Range-proof-for-the-range-02n"><a href="#Range-proof-for-the-range-02n" title="Range-proof-for-the-range-02n" smoothhashscroll=""><span></span></a>Range proof for the range <span><span></span><span id="MathJax-Element-39-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></math></span></span></span></h3>
<p>Let <span><span></span><span id="MathJax-Element-40-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>c</mi><mi mathvariant=&quot;bold&quot;>o</mi><mi mathvariant=&quot;bold&quot;>m</mi></mrow><mi>f</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="bold">c</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">m</mi></mrow><mi>f</mi></msub></math></span></span></span> be a commitment to <span><span></span><span id="MathJax-Element-41-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span>
so that <span><span></span><span id="MathJax-Element-42-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>z</mi></math></span></span></span>, as above.
Let <span><span></span><span id="MathJax-Element-43-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>0</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>0</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span></span> be the binary digits of <span><span></span><span id="MathJax-Element-44-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span></span>, so that <span><span></span><span id="MathJax-Element-45-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></munderover><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msup><mo>&amp;#x22C5;</mo><msub><mi>z</mi><mi>i</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><msup><mn>2</mn><mrow><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>z</mi><mi>i</mi></msub></math></span></span></span>.</p>
<p>Now, given <span><span></span><span id="MathJax-Element-46-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>c</mi><mi mathvariant=&quot;bold&quot;>o</mi><mi mathvariant=&quot;bold&quot;>m</mi></mrow><mi>f</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="bold">c</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">m</mi></mrow><mi>f</mi></msub></math></span></span></span>, the prover proves that <span><span></span><span id="MathJax-Element-47-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;#x2264;</mo><mi>z</mi><mo>&amp;lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><mi>z</mi><mo>&lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math></span></span></span>,
by constructing a degree-<span><span></span><span id="MathJax-Element-48-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></span> polynomial <span><span></span><span id="MathJax-Element-49-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo>&amp;#x2208;</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;2&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mstyle></mrow></msubsup><mo stretchy=&quot;false&quot;>[</mo><mi>X</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo>∈</mo><msubsup><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi><mrow><mstyle displaystyle="false" scriptlevel="2"><mrow><mo stretchy="false">(</mo><mo>&lt;</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mrow></msubsup><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></math></span></span></span> such that
<span><span></span><span><span id="MathJax-Element-50-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mspace width=&quot;1em&quot; /><mtext>and</mtext><mspace width=&quot;1em&quot; /><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mtext>&amp;#xA0;</mtext></mrow><mtext>&amp;#xA0;for all&amp;#xA0;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mn>0</mn></mrow><mtext>.</mtext></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>g</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><msub><mi>z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mspace width="1em"></mspace><mtext>and</mtext><mspace width="1em"></mspace><mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mrow><mi>i</mi></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>g</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>+</mo><msub><mi>z</mi><mrow><mi>i</mi></mrow></msub><mtext>&nbsp;</mtext></mrow><mtext>&nbsp;for all&nbsp;</mtext><mrow><mi>i</mi><mo>=</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>0</mn></mrow><mtext>.</mtext></mrow></math></span></span></span></span>
Observe that <span><span></span><span id="MathJax-Element-51-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mn>0</mn></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></munderover><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msup><mo>&amp;#x22C5;</mo><msub><mi>z</mi><mi>i</mi></msub><mo>=</mo><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mn>0</mn></msup><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><msup><mn>2</mn><mrow><mi>i</mi></mrow></msup><mo>⋅</mo><msub><mi>z</mi><mi>i</mi></msub><mo>=</mo><mi>z</mi></math></span></span></span>.
Now the prover needs to prove three things:</p>
<ol>
<li><span><span></span><span id="MathJax-Element-52-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mtext>&amp;#xA0;</mtext><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></span>,</li>
<li><span><span></span><span id="MathJax-Element-53-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mtext>&amp;#xA0;</mtext><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mi>g</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span></span>, &nbsp; and</li>
<li><span><span></span><span id="MathJax-Element-54-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mtext>&amp;#xA0;</mtext><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mn>2</mn><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mi>ω</mi><mo stretchy="false">)</mo><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span></span> &nbsp;
for all <span><span></span><span id="MathJax-Element-55-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2208;</mo><mi>H</mi><mo class=&quot;MJX-variant&quot;>&amp;#x2216;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∈</mo><mi>H</mi><mo>∖</mo><mo fence="false" stretchy="false">{</mo><msup><mi>ω</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo fence="false" stretchy="false">}</mo></math></span></span></span>.</li>
</ol>
<p>Condition (1) proves that <span><span></span><span id="MathJax-Element-56-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>z</mi></math></span></span></span>;
Conditions (2) and (3) prove that <span><span></span><span id="MathJax-Element-57-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>z</mi><mn>0</mn></msub><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>0</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>z</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span></span> are all in <span><span></span><span id="MathJax-Element-58-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span></span> and are the binary digital of <span><span></span><span id="MathJax-Element-59-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span></span>.
Together, these conditions prove that <span><span></span><span id="MathJax-Element-60-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;#x2264;</mo><mi>z</mi><mo>&amp;lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><mi>z</mi><mo>&lt;</mo><msup><mn>2</mn><mi>n</mi></msup></math></span></span></span>, as required.</p>
<p>To prove Conditions (1)-(3), the prover sends to the verifier
a polynomial commitment to <span><span></span><span id="MathJax-Element-61-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span></span>.
It then proves to the verifier that the following polynomials evaluate to zero for all <span><span></span><span id="MathJax-Element-62-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2208;</mo><mi>H</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∈</mo><mi>H</mi></math></span></span></span>:
<span><span></span><span><span id="MathJax-Element-63-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;0.867em 0.867em 0.3em&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mi></mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>g</mi><mo>&amp;#x2212;</mo><mi>f</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow><mo>(</mo><mfrac><mrow><msup><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msup><mo>&amp;#x2212;</mo><mn>1</mn></mrow><mrow><mi>X</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></mfrac><mo>)</mo></mrow></mrow><mo>,</mo></mstyle></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>g</mi><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>g</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow><mo>(</mo><mfrac><mrow><msup><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msup><mo>&amp;#x2212;</mo><mn>1</mn></mrow><mrow><mi>X</mi><mo>&amp;#x2212;</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>)</mo></mrow></mrow><mo>,</mo><mspace width=&quot;1em&quot; /><mtext>and</mtext></mstyle></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mi></mi><mo>=</mo><mstyle scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow></mstyle><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mn>2</mn><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo><mstyle scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></mstyle><mo>&amp;#x22C5;</mo><mstyle scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow></mstyle><mn>1</mn><mo>&amp;#x2212;</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>2</mn><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo><mstyle scriptlevel=&quot;0&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></mstyle><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo>&amp;#x2212;</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></mtd></mtr></mtable></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="0.867em 0.867em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mo stretchy="false">(</mo><mi>g</mi><mo>−</mo><mi>f</mi><mo stretchy="false">)</mo><mo>⋅</mo><mstyle displaystyle="false" scriptlevel="0"><mrow><mrow><mo>(</mo><mfrac><mrow><msup><mi>X</mi><mrow><mi>n</mi></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>X</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo>)</mo></mrow></mrow><mo>,</mo></mstyle></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>g</mi><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>g</mi><mo stretchy="false">)</mo><mo>⋅</mo><mstyle displaystyle="false" scriptlevel="0"><mrow><mrow><mo>(</mo><mfrac><mrow><msup><mi>X</mi><mrow><mi>n</mi></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>X</mi><mo>−</mo><msup><mi>ω</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>)</mo></mrow></mrow><mo>,</mo><mspace width="1em"></mspace><mtext>and</mtext></mstyle></mtd></mtr><mtr><mtd><msub><mi>w</mi><mn>3</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mstyle scriptlevel="0"><mrow><mo maxsize="1.2em" minsize="1.2em">[</mo></mrow></mstyle><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mi>ω</mi><mo stretchy="false">)</mo><mstyle scriptlevel="0"><mrow><mo maxsize="1.2em" minsize="1.2em">]</mo></mrow></mstyle><mo>⋅</mo><mstyle scriptlevel="0"><mrow><mo maxsize="1.2em" minsize="1.2em">[</mo></mrow></mstyle><mn>1</mn><mo>−</mo><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mi>ω</mi><mo stretchy="false">)</mo><mstyle scriptlevel="0"><mrow><mo maxsize="1.2em" minsize="1.2em">]</mo></mrow></mstyle><mo>⋅</mo><mo stretchy="false">(</mo><mi>X</mi><mo>−</mo><msup><mi>ω</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>.</mo></mtd></mtr></mtable></math></span></span></span></span>
This can be done efficiently using a
batch opening technique described in <a href="https://eprint.iacr.org/2020/081" target="_blank" rel="noopener">this paper</a>.
The verifier sends a radom <span><span></span><span id="MathJax-Element-64-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span> to the prover,
and the prover computes the quotient polynomial
<span><span></span><span><span id="MathJax-Element-65-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mi>&amp;#x03C4;</mi><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><msup><mi>&amp;#x03C4;</mi><mn>2</mn></msup><msub><mi>w</mi><mn>3</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msup><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msup><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>q</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mi>τ</mi><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><msup><mi>τ</mi><mn>2</mn></msup><msub><mi>w</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mrow><mo>/</mo></mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mrow><mi>n</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>.</mo></math></span></span></span></span>
The prover sends a polynomial commitment to <span><span></span><span id="MathJax-Element-66-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span></span> to the verifier,
and then proves that the polynomial
<span><span></span><span><span id="MathJax-Element-67-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mi>&amp;#x03C4;</mi><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><msup><mi>&amp;#x03C4;</mi><mn>2</mn></msup><msub><mi>w</mi><mn>3</mn></msub><mo>&amp;#x2212;</mo><mi>q</mi><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msup><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>w</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mi>τ</mi><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><msup><mi>τ</mi><mn>2</mn></msup><msub><mi>w</mi><mn>3</mn></msub><mo>−</mo><mi>q</mi><mo>⋅</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mrow><mi>n</mi></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></span></span>
is the zero polynomial.
To do so, the verifier sends a random <span><span></span><span id="MathJax-Element-68-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C1;</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span> to the prover,
and together they run the evaluation protocol three times:
once for <span><span></span><span id="MathJax-Element-69-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>,
once for <span><span></span><span id="MathJax-Element-70-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mi>ω</mi><mo stretchy="false">)</mo></math></span></span></span>, and
once for evaluating <span><span></span><span id="MathJax-Element-71-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>, where <span><span></span><span id="MathJax-Element-72-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mrow><mo>(</mo><mfrac><mrow><msup><mi>&amp;#x03C1;</mi><mi>n</mi></msup><mo>&amp;#x2212;</mo><mn>1</mn></mrow><mrow><mi>&amp;#x03C1;</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></mfrac><mo>)</mo></mrow><mo>+</mo><mi>q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C1;</mi><mi>n</mi></msup><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>⋅</mo><mrow><mo>(</mo><mfrac><mrow><msup><mi>ρ</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>ρ</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo>)</mo></mrow><mo>+</mo><mi>q</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msup><mi>ρ</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></span>.
This <span><span></span><span id="MathJax-Element-73-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span></span> is a linear combination of <span><span></span><span id="MathJax-Element-74-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span></span> and <span><span></span><span id="MathJax-Element-75-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span></span>,
and therefore the verifier can construct a commitment to <span><span></span><span id="MathJax-Element-76-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span></span> using the additiving property of the PCS.  The three evaluations, <span><span></span><span id="MathJax-Element-77-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>, <span><span></span><span id="MathJax-Element-78-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>, and <span><span></span><span id="MathJax-Element-79-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mi>ω</mi><mo stretchy="false">)</mo></math></span></span></span>,  along with <span><span></span><span id="MathJax-Element-80-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C1;</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span></span> and <span><span></span><span id="MathJax-Element-81-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span></span>, are sufficient to evaluate <span><span></span><span id="MathJax-Element-82-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span> and confirm that the result is zero.
This proves, with high probability, that <span><span></span><span id="MathJax-Element-83-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span></span> is the zero polynomial.</p>
<p>There is one remaining issue, which is that revealing
<span><span></span><span id="MathJax-Element-84-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>, <span><span></span><span id="MathJax-Element-85-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>, and <span><span></span><span id="MathJax-Element-86-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mi>ω</mi><mo stretchy="false">)</mo></math></span></span></span> is not zero-knowledge.
The fix is simple: the prover constructs <span><span></span><span id="MathJax-Element-87-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span></span> as a degree <span><span></span><span id="MathJax-Element-88-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>+</mo><mn>1</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>+</mo><mn>1</mn></math></span></span></span>
polynomial by interpolating <span><span></span><span id="MathJax-Element-89-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span></span> to a random value at two more points
<span><span></span><span id="MathJax-Element-90-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03C9;</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>&amp;#x03C9;</mi><mo>&amp;#x2033;</mo></msup></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>ω</mi><mo>′</mo></msup><mo>,</mo><msup><mi>ω</mi><mo>″</mo></msup></math></span></span></span> outside <span><span></span><span id="MathJax-Element-91-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span></span>.
That is, <span><span></span><span id="MathJax-Element-92-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span></span> is defined in exactly
the same way on all points in <span><span></span><span id="MathJax-Element-93-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span></span>,
but <span><span></span><span id="MathJax-Element-94-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03B1;</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mi>α</mi></math></span></span></span> and <span><span></span><span id="MathJax-Element-95-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mo>&amp;#x2033;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03B2;</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mo>″</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mi>β</mi></math></span></span></span>
for random <span><span></span><span id="MathJax-Element-96-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>,</mo><mi>&amp;#x03B2;</mi><mo>&amp;#x2208;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi><mo>,</mo><mi>β</mi><mo>∈</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span> and <span><span></span><span id="MathJax-Element-97-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C9;</mi><mo>,</mo><msup><mi>&amp;#x03C9;</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2209;</mo><mi>H</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi><mo>,</mo><msup><mi>ω</mi><mo>′</mo></msup><mo>∉</mo><mi>H</mi></math></span></span></span>.
Since <span><span></span><span id="MathJax-Element-98-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span></span> has the same values over all points in <span><span></span><span id="MathJax-Element-99-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span></span>,
this has no effect on the relations checked above.
This is zero-knowledge because <span><span></span><span id="MathJax-Element-100-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span> and <span><span></span><span id="MathJax-Element-101-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mi>ω</mi><mo stretchy="false">)</mo></math></span></span></span>
can now be simulated as independent random values in <span><span></span><span id="MathJax-Element-102-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub></math></span></span></span>.
Moreover, the value of <span><span></span><span id="MathJax-Element-103-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span> is completely determined
by the fact that <span><span></span><span id="MathJax-Element-104-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span></span>, and can therefore also be simulated.
Note that we need to restrict the choice of <span><span></span><span id="MathJax-Element-105-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C1;</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span></span> to <span><span></span><span id="MathJax-Element-106-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>F</mi></mrow><mi>p</mi></msub><mo class=&quot;MJX-variant&quot;>&amp;#x2216;</mo><mi>H</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mrow><mi mathvariant="double-struck">F</mi></mrow><mi>p</mi></msub><mo>∖</mo><mi>H</mi><mo stretchy="false">)</mo></math></span></span></span> to ensure that the simulation is valid.</p>
<p>This entire process makes two polynomial commitments, to <span><span></span><span id="MathJax-Element-107-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span></span> and <span><span></span><span id="MathJax-Element-108-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span></span>,
and uses the polynomial evaluation protocol three times to
evaluate <span><span></span><span id="MathJax-Element-109-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>, <span><span></span><span id="MathJax-Element-110-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mi>w</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></math></span></span></span>, and <span><span></span><span id="MathJax-Element-111-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C1;</mi><mi>&amp;#x03C9;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>ρ</mi><mi>ω</mi><mo stretchy="false">)</mo></math></span></span></span>.
We note that, if needed, it is possible to reduce the degree of <span><span></span><span id="MathJax-Element-112-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span></span> by writing <span><span></span><span id="MathJax-Element-113-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><span role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span></span> in a base greater than 2.</p>
<h3 id="Other-constructions"><a href="#Other-constructions" title="Other-constructions" smoothhashscroll=""><span></span></a>Other constructions</h3>
<p>The <a href="https://eprint.iacr.org/2017/1066.pdf" target="_blank" rel="noopener">Bulletproofs paper</a> (Section 4.1) shows how to implement a range proof using an inner-product argument.  The DARK paper shows how to implemement an inner-product argument using a polynomial commitment scheme.  Combining the two gives another way to construct a range proof from a polynomial commitment scheme with similar properties as the range proof described above.  Interestingly, the resulting protocol is quite different.</p>

<p>This scheme initially appeared as a component of <a href="https://github.com/AztecProtocol/barretenberg/blob/master/src/barretenberg/waffle/proof_system/widgets/turbo_range_widget.cpp" target="_blank" rel="noopener">Turbo Plonk</a> by Ariel Gabizon and Zac Williamson</p>
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>