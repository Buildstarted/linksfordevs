<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Modular Monoliths And Composite UIs With .NET Core Razor Class Libraries -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Modular Monoliths And Composite UIs With .NET Core Razor Class Libraries</h1>
    <div class="body" id="article-body"> <p><em><a href="https://www.blog.jamesmichaelhickey.com/How-To-Build-Modular-Monoliths-With-NETCore-Razor-Class-Libraries/">Originally published on my blog.</a></em></p> <p><strong>Microservices are all the rage now.</strong> </p> <p>But, many are (finally) realizing that it&apos;s not for everyone. Most of us aren&apos;t at the scale of Netflix, LinkedIn, etc. and therefore don&apos;t have the organizational manpower to offset the overhead of a full-blown microservices architecture.</p> <p>An alternative to a full-blown microservices architecture that&apos;s been getting a lot of press lately is called &quot;modular monoliths.&quot;</p> <blockquote>
<p>Shouldn&apos;t well-written monoliths be modular anyways?</p>
</blockquote> <p>Sure. But modular monoliths are done in a <strong>very intentional</strong> way that usually follows a domain-driven approach.</p> <h2> <a href="#summary-table-of-contents" class="anchor"> </a> Summary / Table Of Contents
</h2> <p>This is part of the 2019 C# Advent! <a href="https://crosscuttingconcerns.com/The-Third-Annual-csharp-Advent">Take a look at all the other awesome articles for this year!</a></p> <p>Here are the main sections in the article in case you would like to skip certain parts:</p> <p><strong>The GitHub repo for everything in this article <a href="https://github.com/jamesmh/net-core-modular-monolith-razor-lib">is here</a>.</strong></p> <h2> <a href="#why-modular-monoliths" class="anchor"> </a> Why Modular Monoliths?
</h2> <p>The biggest benefits that microservices give us (loose coupling, code ownership, etc.) can be had in a well-designed modular monolith. By leveraging the domain-driven concept of bounded contexts, we can treat each context as an isolated application. </p> <p>But, instead of hosting each context as an independent process (like with microservices), we can extract each bounded context as a module within a larger system or web of modules. </p> <p>For example, each module might be a .NET project/assembly. These assemblies would be combined at run-time and hosted within one main process.</p> <p>Compared to microservices, the benefits of modular monoliths include:</p> <ul>
<li>In-memory communication between contexts are more performant and reliable than doing it on the network</li>
<li>A much simpler deployment process for smaller teams</li>
<li>Retain boundaries and ownership around specific contexts</li>
<li>Simplified upgrades to contexts/services</li>
<li>Modules are &quot;ready&quot; to be extracted as services if needed</li>
</ul> <p>I see modular monoliths as a step within the potential evolution of a system&apos;s architecture:</p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--HgGoDkQo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/qt3uhl7hqzrbewpw787a.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--HgGoDkQo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/qt3uhl7hqzrbewpw787a.png" alt="architecture spectrum"></a></p> <p>For domain-driven approaches, starting with a modular monolith might make the most sense and is definitely worth considering.</p> <p>Here&apos;s a more in-depth <a href="https://www.kamilgrzybek.com/design/modular-monolith-primer/">primer on modular monoliths</a> by Kamil Grzybek if you&apos;re interested.</p> <h2> <a href="#how-can-i-build-them" class="anchor"> </a> How Can I Build Them?
</h2> <p>There are many ways to build modular monoliths!</p> <p>For example, Kamil Grzybek has created <a href="https://github.com/kgrzybek/modular-monolith-with-ddd">a production-ready modular monolith sample</a>.</p> <p>I personally prefer less separation within each bounded context / module, but his example is super detailed and worth looking at!</p> <p>And, of course, Kamil says it well in his repo&apos;s disclaimer:</p> <blockquote>
<p>The architecture and implementation presented in this repository is one of the many ways to solve some problems</p>
</blockquote> <p>In this article, we&apos;ll be looking at a much simpler approach to building modular monoliths. Again, the direction and implementation depends on your needs (business requirements, team experience, time-to-market required, etc.)</p> <p>We&apos;ll be looking at one way that&apos;s unique to .NET Core by using a new-ish feature of .NET Core called <a href="https://docs.microsoft.com/en-us/aspnet/core/razor-pages/ui-class?view=aspnetcore-3.0&amp;tabs=visual-studio">razor class libraries</a>. Razor class libraries allow you to build entire UI pages, controllers and components inside of a sharable library! It&apos;s the approach I&apos;ve used for <a href="https://www.pro.coravel.net/">Coravel Pro</a> and enables some exciting possibilities.</p> <h2> <a href="#life-insurance-application" class="anchor"> </a> Life Insurance Application
</h2> <p>I recently wrote <a href="https://www.blog.jamesmichaelhickey.com/DDD-Use-Case-Life-Insurance-Platform/">an article</a> about using some domain-driven approaches to think about and re-design an insurance selling platform I once worked on.</p> <p>To keep things simple for now, let&apos;s imagine we&apos;ve determined two bounded contexts from this domain:</p> <ul>
<li>Insurance Application</li>
<li>Medical Questionnaire</li>
</ul> <p>The specific details are not so important since the remainder of this article will look at implementation and code.</p> <p>The structure of our solution will roughly look like the following - with a .NET Core web application as the host:</p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--cOhZfpyo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/lfbc3cdn6otd6jp2wust.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--cOhZfpyo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/lfbc3cdn6otd6jp2wust.png" alt="Modules"></a></p> <h2> <a href="#creating-our-skeleton" class="anchor"> </a> Creating Our Skeleton
</h2> <p>Let&apos;s implement the skeleton for our modular monolith and use razor class libraries as a way to implement our bounded contexts.</p> <p>First, create a new root host process:</p> <p><code>dotnet new webapp -o HostApp</code></p> <p>Next, we&apos;ll create our two modules as razor class libraries:</p> <p><code>dotnet new razorclasslib -o Modules/InsuranceApplication</code></p> <p><code>dotnet new razorclasslib -o Modules/MedicalQuestions</code></p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--vth9wGe0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jr215zg4o2ouf96mgwjt.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--vth9wGe0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jr215zg4o2ouf96mgwjt.png" alt="Folder structure"></a></p> <p>Then, we&apos;ll reference our modules from the host project.</p> <p>From within the host project:</p> <p><code>dotnet add reference ../Modules/InsuranceApplication/InsuranceApplication.csproj</code></p> <p><code>dotnet add reference ../Modules/MedicalQuestions/MedicalQuestions.csproj</code></p> <h2> <a href="#building-our-first-module" class="anchor"> </a> Building Our First Module
</h2> <p>Navigate to the Insurance Application module at <code>Modules/InsuranceApplication</code>.</p> <p>Your razor class library will have some sample Blazor files, <code>www</code> folder, etc. You can remove all those generated files.</p> <p>Let&apos;s build a couple of Razor Pages that will be used as this bounded context&apos;s UI:</p> <p><code>dotnet new page -o Areas/InsuranceApplication/Pages -n ContactInfo</code></p> <p><code>dotnet new page -o Areas/InsuranceApplication/Pages -n InsuranceSelection</code></p> <blockquote>
<p>You might have to go into your razor pages and adjust the generated namespaces. In my example, I changed them to <code>InsuranceApplication.Areas.InsuranceApplication.Pages</code>.</p>
</blockquote> <h2> <a href="#oops-it-doesnt-work" class="anchor"> </a> Oops! It Doesn&apos;t Work!
</h2> <p>Navigate back to the <code>HostApp</code> web project and try to build it. </p> <p><em>It will fail!</em></p> <p>Our razor class libraries are trying to use razor pages - which is a web function. This requires referencing the appropriate reference assemblies.</p> <p>Before .NET Core 3.0, we would have added a reference to some extra NuGet packages like <code>Microsoft.AspNetCore.Mvc</code>, etc. As of .NET Core 3.0, many of these ASP related packages are actually included in the .NET Core SDK.</p> <blockquote>
<p>For some projects, this breaking change can cause issues and confusion! For more details, check out Andrew Lock&apos;s <a href="https://andrewlock.net/converting-a-netstandard-2-library-to-netcore-3/">in-depth look at this issue.</a></p>
</blockquote> <p>So, let&apos;s change the project files of our two razor class libraries to the following:<br>
</p> <div class="highlight"><pre class="highlight xml"><code><span class="nt">&lt;Project</span> <span class="na">Sdk=</span><span class="s">&quot;Microsoft.NET.Sdk.Razor&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;PropertyGroup&gt;</span> <span class="nt">&lt;TargetFramework&gt;</span>netcoreapp3.0<span class="nt">&lt;/TargetFramework&gt;</span> <span class="nt">&lt;AddRazorSupportForMvc&gt;</span>True<span class="nt">&lt;/AddRazorSupportForMvc&gt;</span> <span class="nt">&lt;/PropertyGroup&gt;</span> <span class="nt">&lt;ItemGroup&gt;</span> <span class="nt">&lt;FrameworkReference</span> <span class="na">Include=</span><span class="s">&quot;Microsoft.AspNetCore.App&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;/ItemGroup&gt;</span> <span class="nt">&lt;/Project&gt;</span>
</code></pre></div> <blockquote>
<p>Yes, I removed all the boilerplate Blazor code since the appropriate references are included in the <code>FrameworkReference</code>.</p>
</blockquote> <h2> <a href="#its-alive" class="anchor"> </a> It&apos;s Alive!
</h2> <p>Go into the razor pages you created and add some dummy HTML.</p> <p>For example:<br>
</p> <div class="highlight"><pre class="highlight html"><code>@page
@model InsuranceApplication.Areas.InsuranceApplication.Pages.ContactInfoModel
@{
} <span class="nt">&lt;h1&gt;</span>Insurance Contact Info<span class="nt">&lt;/h1&gt;</span>
</code></pre></div> <p>Try running your host application and navigate to <code>/InsuranceApplication/ContactInfo</code> and <code>/InsuranceApplication/InsuranceSelection</code>.</p> <p>Both pages should display. Cool!</p> <h2> <a href="#ui-flow-beginning-the-insurance-application" class="anchor"> </a> UI Flow: Beginning The Insurance Application
</h2> <p>Let&apos;s look at building out a basic flow between our two modules.</p> <p>First, in the <code>HostApp</code> project, in your <code>Pages/Index.cshtml</code> file add the following HTML:<br>
</p> <div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/InsuranceApplication/ContactInfo&quot;</span><span class="nt">&gt;</span>Begin Your Application!<span class="nt">&lt;/a&gt;</span>
</code></pre></div> <p>That will give us a link to click from our home screen to begin the flow through our application logic.</p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--LraZCJi2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/uf21lwhozoph149amcsd.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--LraZCJi2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/uf21lwhozoph149amcsd.png" alt="Screen 1"></a></p> <h2> <a href="#ui-flow-inside-the-insurance-application-module" class="anchor"> </a> UI Flow: Inside The Insurance Application Module
</h2> <p>In your <code>ContactInfo.cshtml</code> file within the <code>InsuranceApplication</code> project, insert the following:<br>
</p> <div class="highlight"><pre class="highlight html"><code>@page
@model InsuranceApplication.Areas.InsuranceApplication.Pages.ContactInfoModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers <span class="nt">&lt;h1&gt;</span>Insurance Contact Info<span class="nt">&lt;/h1&gt;</span> <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;label&gt;</span>Email:<span class="nt">&lt;/label&gt;</span> <span class="nt">&lt;input</span> <span class="na">asp-for=</span><span class="s">&quot;EmailAddress&quot;</span> <span class="na">required</span> <span class="na">type=</span><span class="s">&quot;email&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span><span class="nt">&gt;</span>submit<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div> <p>In <code>ContactInfo.cshtml.cs</code>, add the following:<br>
</p> <div class="highlight"><pre class="highlight csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc.RazorPages</span><span class="p">;</span> <span class="k">namespace</span> <span class="nn">InsuranceApplication.Areas.InsuranceApplication.Pages</span>
<span class="p">{</span> <span class="k">public</span> <span class="k">class</span> <span class="nc">ContactInfoModel</span> <span class="p">:</span> <span class="n">PageModel</span> <span class="p">{</span> <span class="p">[</span><span class="n">BindProperty</span><span class="p">]</span> <span class="k">public</span> <span class="kt">string</span> <span class="n">EmailAddress</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">OnPostAsync</span><span class="p">()</span> <span class="p">{</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$&quot;Email Address is </span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="n">EmailAddress</span><span class="p">}</span><span class="s">.&quot;</span><span class="p">);</span> <span class="k">return</span> <span class="nf">RedirectToPage</span><span class="p">(</span><span class="s">&quot;./InsuranceSelection&quot;</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>This will allow us to enter an email address and move to the next page in our flow.</p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--0AyKxE8E--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/9w0hlk02ysx4drvp0yse.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--0AyKxE8E--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/9w0hlk02ysx4drvp0yse.png" alt="Screen 2"></a></p> <p>In the <code>InsuranceSelection.cshtml</code> page - just add a link to keep things simple:<br>
</p> <div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/MedicalQuestionnaire/Questions&quot;</span><span class="nt">&gt;</span>Next<span class="nt">&lt;a&gt;</span>
</code></pre></div> <blockquote>
<p>You can imagine that this page would allow the user to select a specific insurance plan they want to apply for.</p>
</blockquote> <h2> <a href="#ui-flow-medical-questionnaire-module" class="anchor"> </a> UI Flow: Medical Questionnaire Module
</h2> <p>You might have noticed that we never created any razor pages in the Medical Questionnaire module. Let&apos;s do that now.</p> <p>Navigate to the root of the <code>MedicalQuestions</code> project and enter the following from your terminal:</p> <p><code>dotnet new page -o Areas/MedicalQuestionnaire/Pages -n Questions</code></p> <blockquote>
<p>Again, you might need to adjust the generated namespaces.</p>
</blockquote> <p>Within the <code>Questions.cshtml</code> file, add a link:<br>
</p> <div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;h1&gt;</span>Medical Questionnaire<span class="nt">&lt;/h1&gt;</span> <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>Finish<span class="nt">&lt;a&gt;</span>
</code></pre></div> <p>Try running your host project with <code>dotnet run</code> and run through the entire UI!</p> <h2> <a href="#composite-uis-with-blazor-components" class="anchor"> </a> Composite UIs With Blazor Components
</h2> <p>When working with these kinds of loosely coupled modules a question arises: </p> <p><strong>What happens when we need to display information from multiple bounded contexts on the same screen?</strong></p> <p>Usually, we resort to building composite UIs. </p> <p>These are UIs where various parts of the UI are rendered and controlled by components owned by a specific bounded context, service or module.</p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--7xmG1Y24--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ab4ux3ntndlvikpyq4il.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--7xmG1Y24--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ab4ux3ntndlvikpyq4il.png" alt="Composite UI"></a></p> <p>As you can see in the image above, each component might be owned by a different back-end module and would be isolated from and loosely coupled to the other modules.</p> <p>Let&apos;s build a simple composite UI using some exciting new .NET Core 3.0 technologies!</p> <h3> <a href="#configure-blazor-components" class="anchor"> </a> Configure Blazor Components
</h3> <p>We need to configure our host application to support the new blazor/razor components.</p> <ol>
<li>Add the following script to <code>Pages/Shared/_Layout.cshtml</code>:
</li>
</ol> <div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;_framework/blazor.server.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div> <ol>
<li>In <code>Startup.cs</code> in <code>ConfigureServices</code> add:
</li>
</ol> <div class="highlight"><pre class="highlight csharp"><code><span class="n">services</span><span class="p">.</span><span class="nf">AddServerSideBlazor</span><span class="p">();</span>
</code></pre></div> <div class="highlight"><pre class="highlight csharp"><code><span class="n">app</span><span class="p">.</span><span class="nf">UseEndpoints</span><span class="p">(</span><span class="n">endpoints</span> <span class="p">=&gt;</span>
<span class="p">{</span> <span class="n">endpoints</span><span class="p">.</span><span class="nf">MapRazorPages</span><span class="p">();</span> <span class="n">endpoints</span><span class="p">.</span><span class="nf">MapBlazorHub</span><span class="p">();</span> <span class="c1">// Add this one.</span>
<span class="p">});</span>
</code></pre></div> <h3> <a href="#create-insurance-application-component" class="anchor"> </a> Create Insurance Application Component
</h3> <p>Navigate to the <code>InsuranceApplication</code> project&apos;s root directory and execute the following:</p> <p><code>dotnet new razorcomponent -o ./Components -n ApplicationDashboard</code></p> <p>Replace the contents of your new razor component with the following:<br>
</p> <div class="highlight"><pre class="highlight html"><code>@using Microsoft.AspNetCore.Components.Web <span class="nt">&lt;h3&gt;</span>Application Dashboard<span class="nt">&lt;/h3&gt;</span> <span class="nt">&lt;p&gt;</span> Time: @currentTime
<span class="nt">&lt;/p&gt;</span> <span class="nt">&lt;button</span> <span class="err">@</span><span class="na">onclick=</span><span class="s">&quot;Update&quot;</span><span class="nt">&gt;</span>Update<span class="nt">&lt;/button&gt;</span>

@code {
    private string currentTime = DateTime.Now.ToString();

    private void Update()
    {
        currentTime = DateTime.Now.ToString();       
    }
}
</code></pre></div> <h3> <a href="#create-medical-questions-component" class="anchor"> </a> Create Medical Questions Component
</h3> <p>Do the same steps within the <code>MedicalQuestions</code> module to create a dummy razor component (but change the title of the component).</p> <h3> <a href="#putting-it-together" class="anchor"> </a> Putting It Together
</h3> <p>Now, back in your host application project, within the <code>Pages/Index.cshtml</code> page, add the following to the top of the file:<br>
</p> <div class="highlight"><pre class="highlight csharp"><code><span class="n">@page</span>
<span class="n">@using</span> <span class="n">InsuranceApplication</span><span class="p">.</span><span class="n">Components</span> <span class="c1">// Add this.</span>
<span class="n">@using</span> <span class="n">MedicalQuestions</span><span class="p">.</span><span class="n">Components</span> <span class="c1">// Add this.</span>
<span class="n">@model</span> <span class="n">IndexModel</span>
</code></pre></div> <p>Then, in the middle of your HTML page, add:<br>
</p> <div class="highlight"><pre class="highlight html"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row&quot;</span><span class="nt">&gt;</span> <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-6&quot;</span><span class="nt">&gt;</span> @(await Html.RenderComponentAsync<span class="nt">&lt;ApplicationDashboard&gt;</span>(RenderMode.ServerPrerendered)) <span class="nt">&lt;/div&gt;</span> <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-6&quot;</span><span class="nt">&gt;</span> @(await Html.RenderComponentAsync<span class="nt">&lt;QuestionsDashboard&gt;</span>(RenderMode.ServerPrerendered)) <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div> <p>Finally... start your host project using <code>dotnet run</code>!</p> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--iOL2cHOG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/dptkqybd9xvv6ctybgu5.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--iOL2cHOG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/dptkqybd9xvv6ctybgu5.png" alt="Composite UI Screenshot"></a></p> <p>Any time one of the components needs to be changed, the host application will (most likely) not need to change. Both bounded contexts are still isolated from each other but our architecture allows us to be smart about how we display that information.</p> <p><em>Note: There are other ways to build these types of components: <a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/view-components?view=aspnetcore-3.1">view components</a>, <a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro?view=aspnetcore-3.1">tag helpers</a>, <a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/th-components?view=aspnetcore-3.1">tag helper components</a>, javascript components, etc.</em></p> <h2> <a href="#other-considerations" class="anchor"> </a> Other Considerations
</h2> <ul>
<li><p>Modules can be deployed as NuGet packages so that they ultimately can be managed by independent teams and be isolated as true modules.</p></li>
<li>
<p>Each bounded context can:</p> <ul>
<li>Use its own isolated database</li>
<li>Have its own self-contained business logic</li>
<li>Communicate with other bounded contexts by using messaging and domain events</li>
<li>etc.</li>
</ul> </li>
<li><p>In terms of service/module interaction, any calls between modules could use a shared abstractions library which would be configured in DI at run-time to use the concrete service from the appropriate bounded context:</p></li>
</ul> <p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--WQ-X8xFY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/zjqq7t4y7zuxz51sk1l9.png" class="article-body-image-wrapper"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--WQ-X8xFY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/zjqq7t4y7zuxz51sk1l9.png" alt="References"></a></p> <p>It doesn&apos;t show on the diagram, but the Medical Questions context might need to get some information from the Insurance Application context in some scenarios where using messaging isn&apos;t appropriate.</p> <p>In this case, the Medical Questions code would use the <code>IInsuranceApplicationService</code> interface (from DI) to make those calls.</p> <p>Then, at run-time, the host process would configure the concrete implementation (<code>InsuranceApplicationFacade</code>) to be given to anyone who asks for the interface.</p> <p>This technique keeps each module loosely coupled and enforces a strict contract in terms of what one bounded context can be explicitly be &quot;asked for&quot;.</p> <p><em>However, some might say the need to make direct calls to another bounded context is a sign that the boundaries are incorrect...a topic for another day.</em></p> <h2> <a href="#conclusion" class="anchor"> </a> Conclusion
</h2> <p>I hope you found this article helpful and informative. I&apos;m sure you can see that razor class libraries are a really exciting feature of .NET Core that hasn&apos;t been talked about too much.</p> <p>This is one way to use them and for some cases it might work really well!</p> <p>Here are some resources about the topics we covered:</p> <p>Check out my book about keeping your code healthy!</p> <p><a href="https://leanpub.com/refactoringtypescript"><img src="/img/refactoringts.png" alt="Refactoring TypeScript book"><br>
</a></p> <p>Don&apos;t forget to connect with me on:</p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>