<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Firefox 79: The safe return of shared memory, new tooling, and platform updates &#x2013; Mozilla Hacks - the Web developer blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Firefox 79: The safe return of shared memory, new tooling, and platform updates &#x2013; Mozilla Hacks - the Web developer blog - linksfor.dev(s)"/>
    <meta property="article:author" content="https://developer.mozilla.org@floscholz"/>
    <meta property="og:description" content="Firefox 79 offers a new Promise method, more secure target=_blank links, logical assignment operators, tooling improvements for better JavaScript debugging, and many other updates of interest to web developers. In ..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://hacks.mozilla.org/2020/07/firefox-79/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Firefox 79: The safe return of shared memory, new tooling, and platform updates &#x2013; Mozilla Hacks - the Web developer blog</title>
<div class="readable">
        <h1>Firefox 79: The safe return of shared memory, new tooling, and platform updates &#x2013; Mozilla Hacks - the Web developer blog</h1>
            <div>by https://developer.mozilla.org@floscholz</div>
            <div>Reading time: 11-14 minutes</div>
        <div>Posted here: 28 Jul 2020</div>
        <p><a href="https://hacks.mozilla.org/2020/07/firefox-79/">https://hacks.mozilla.org/2020/07/firefox-79/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><article role="article">
    <p>A new stable version of Firefox brings July to a close with the return of shared memory! Firefox 79 also offers a new Promise method, more secure <code>target=_blank</code> links, logical assignment operators, and other updates of interest to web developers.</p>
<p>This blog post provides merely a set of highlights; for all the details, check out the following:</p>
<ul>
<li><a href="https://developer.mozilla.org/docs/Mozilla/Firefox/Releases/79" target="_blank">Firefox 79 for developers on MDN</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/79.0/releasenotes/" target="_blank" rel="noopener noreferrer">Firefox 79 end-user release notes</a></li>
</ul>
<h2>New in Developer Tools</h2>
<p>First, we look at the new additions to the Firefox DevTools in version 79.</p>
<h3>JavaScript logging and debugging capabilities</h3>
<h4>Async stack traces everywhere</h4>
<p>Modern JavaScript depends on promises, async/await, events, and timeouts to orchestrate complex scheduling between your code, libraries, and the browser. And yet, it can be challenging to debug async code to understand control and data flow. Operations are broken up over time. Async stack traces solve this by combining the live synchronous part of the stack with the part that is captured and asynchronous.</p>
<p>Now you can enjoy detailed async execution chains in the Firefox JavaScript Debugger’s call stack, Console errors, and Network initiators.</p>
<p><a href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/Async-Stacks-2.png" target="_blank"><img src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/Async-Stacks-2.png" alt="Async stacks in Console &amp; Debugger" width="1322" height="1140" srcset="https://hacks.mozilla.org/files/2020/07/Async-Stacks-2.png 1322w, https://hacks.mozilla.org/files/2020/07/Async-Stacks-2-250x216.png 250w, https://hacks.mozilla.org/files/2020/07/Async-Stacks-2-500x431.png 500w, https://hacks.mozilla.org/files/2020/07/Async-Stacks-2-768x662.png 768w" sizes="(max-width: 1322px) 100vw, 1322px"></a></p>
<p>To make this work, the JavaScript engine captures the stack when a promise is allocated or when some async operation begins. Then the captured stack is appended to any new stacks captured.</p>
<h4>Better debugging for erroneous network responses</h4>
<p>Failing server requests can lead to a cascade of errors. Previously, you had to switch between the Console and Network panels to debug, or enable the <i>XHR/Requests</i> filters in the Console. With Firefox 79, the Console shows network requests with 4xx/5xx error status codes by default. In addition, the request/response details can be expanded to inspect the full details. These are also available in the Network Inspector.</p>
<p><a href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/5xx-Console.png" target="_blank"><img src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/5xx-Console.png" alt="Console showing details for erroneous responses" width="1008" height="432" srcset="https://hacks.mozilla.org/files/2020/07/5xx-Console.png 1008w, https://hacks.mozilla.org/files/2020/07/5xx-Console-250x107.png 250w, https://hacks.mozilla.org/files/2020/07/5xx-Console-500x214.png 500w, https://hacks.mozilla.org/files/2020/07/5xx-Console-768x329.png 768w" sizes="(max-width: 1008px) 100vw, 1008px"></a></p>
<p><em>Tip:</em> To further debug, retry, or verify server-side changes, use the “Resend Request” context-menu option. It’s available in both the Console and Network panels. You can send a new request with the same parameters and headers. The additional “Edit and Resend” option is only available in the Network panel. It opens an editor to tweak the request before sending it.</p>
<h4>Debugger highlights errors in code</h4>
<p>Many debugging sessions start by jumping from a logged JavaScript error to the Debugger. To make this flow easier, errors are now highlighted in their corresponding source location in the Debugger. Furthermore, relevant details are shown on hover, in the context of the code, and paused variable state.</p>
<p><a href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/error-highlight.png" target="_blank"><img src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/error-highlight.png" alt="Error highlighted in the Debugger" width="764" height="268" srcset="https://hacks.mozilla.org/files/2020/07/error-highlight.png 764w, https://hacks.mozilla.org/files/2020/07/error-highlight-250x88.png 250w, https://hacks.mozilla.org/files/2020/07/error-highlight-500x175.png 500w" sizes="(max-width: 764px) 100vw, 764px"></a></p>
<p>We’d like to say thanks to core contributor <a href="https://bugzilla.mozilla.org/user_profile?user_id=652974" target="_blank">Stepan Stava</a>, who is already building this feature out, further blurring the line between logging and debugging.</p>
<h4>Restart frame in Call Stack</h4>
<p>When you restart frames from the Debugger, the call stack moves the execution pointer to the top of the function. With the caveat that the state of variables is not reset, this allows time-traveling within the current call stack.</p>
<p><a href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/debugger-restart.gif" target="_blank"><img src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2020/07/debugger-restart.gif" alt="Restarting frames in Debugger" width="828" height="472"></a></p>
<p>“Restart Frame” is now available as a context-menu option in the Debugger’s call stack. Again, we have <a href="https://bugzilla.mozilla.org/user_profile?user_id=652974" target="_blank">Stepan Stava</a> to thank for this addition, which Debugger users will recognize from Chrome and VS Code.</p>
<h4>Faster JavaScript debugging</h4>
<p>Performance improvements in this release speed up debugging, particularly for projects with large files. We also fixed a bottleneck that affected eval-heavy code patterns, which will now just work.</p>
<h3>Inspector updates</h3>
<h4>Better source map references for SCSS and CSS-in-JS</h4>
<p>We’ve improved source map handling across all panels, so that opening SCSS and CSS-in-JS sources from the Inspector now works more reliably. You can quickly jump from the rules definitions in the Inspector side panel to the original file in the <a href="https://developer.mozilla.org/en-US/docs/Tools/Style_Editor" target="_blank">Style Editor</a>.</p>
<h4>New Inspect accessibility properties context menu</h4>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Tools/Accessibility_inspector" target="_blank">Accessibility Inspector</a> is now always available in the browser context menu. allows you can open the element in the Accessibility panel directly, to inspect <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA" rel="noopener noreferrer" target="_blank">ARIA</a> properties and run audits.</p>
<h3>More tooling updates</h3>
<ul>
<li>The “Disable Cache” option in the Network panel now also deactivates <a href="https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request" target="_blank">CORS preflight request</a> caching. This makes it easier to iterate on your <a href="https://developer.mozilla.org/en-US/docs/Web/Security" target="_blank">web security</a> settings.</li>
<li>Contributor <a href="https://bugzilla.mozilla.org/user_profile?user_id=657869" target="_blank">KC</a> aligned the styling for blocked requests shown in Console with their appearance in the Network panel.</li>
<li><a href="https://github.com/richorrichard" target="_blank">Richard Sherman</a> extended the reach of tooltips, which now describe the type and value for previewed object values across Console and Debugger.</li>
<li>To consolidate sidebar tabs, <a href="https://farooqar.github.io/" target="_blank">Farooq AR</a> moved Network’s WebSocket “Messages” tab into the “Response” tab.</li>
<li>Debugger’s references to “blackbox” were renamed “ignore”, to align wording with other tools and make it more inclusive. Thanks to <a href="https://github.com/richorrichard" target="_blank">Richard Sherman</a> for this update too!</li>
</ul>
<h2>Web platform updates</h2>
<h3>Implicit <code>rel=noopener</code> with <code>target=_blank</code> links</h3>
<p>To prevent the DOM property <a href="https://developer.mozilla.org/docs/Web/API/Window/opener" target="_blank"><code>window.opener</code></a> from being abused by untrusted third-party sites, Firefox 79 now automatically sets <code>rel=noopener</code> for all links that contain <code>target=_blank</code>. Previously, you had to set <code>rel=noopener</code> manually to make <code>window.opener = null</code> for every link that uses <code>target=_blank</code>. In case you need <code>window.opener</code>, explicitly enable it using <code>rel=opener</code>.</p>
<h3>SharedArrayBuffer returns</h3>
<p>At the start of 2018, <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer" target="_blank">Shared Memory</a> and high-resolution timers were effectively <a href="https://blog.mozilla.org/security/2018/01/03/mitigations-landing-new-class-timing-attack/" target="_blank" rel="noopener noreferrer">disabled</a> in light of <a href="https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)" target="_blank">Spectre</a>. In 2020, a new, more secure approach has been standardized to re-enable shared memory. As a baseline requirement, your document needs to be in a secure context. For top-level documents, you must set two headers to cross-origin isolate your document:</p>
<ul>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy" target="_blank"><code>Cross-Origin-Opener-Policy</code></a> set to <code>same-origin</code>.</li>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy" target="_blank"><code>Cross-Origin-Embedder-Policy</code></a> set to <code>require-corp</code>.</li>
</ul>
<p>To check if cross-origin isolation has been successful, you can test against the <a href="https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/crossOriginIsolated" target="_blank"><code>crossOriginIsolated</code></a> property available to window and worker contexts:</p>
<pre><code lang="javascript"><span>if</span> (crossOriginIsolated) {
<span>//</span> use postMessage <span>and</span> SharedArrayBuffer
} <span>else</span> {
<span>//</span> Do something <span>else</span>
}</code></pre>
<p>Read more in the post <a href="https://hacks.mozilla.org/2020/07/safely-reviving-shared-memory/" target="_blank" rel="noreferrer noopener">Safely reviving shared memory.</a></p>
<h3>Promise.any support</h3>
<p>The new <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise/any" target="_blank"><code>Promise.any()</code></a> method takes an iterable of <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><code>Promise</code></a> objects and, as soon as one of the promises in the iterable fulfills, returns a single promise resolving to the value from that promise. Essentially, this method is the opposite of <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" target="_blank"><code>Promise.all()</code></a>. Additionally, <code>Promise.any()</code> is different from <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise/race" target="_blank"><code>Promise.race()</code></a>. What matters is the order in which a promise is fulfilled, as opposed to which promise settles first.</p>
<p>If all of the promises given are rejected, a new error class called <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/AggregateError" target="_blank"><code>AggregateError</code></a> is returned. In addition, it indicates the reason for the rejection(s).</p>
<pre><code lang="javascript"><span>const</span> promise1 = <span>Promise</span>.reject(<span>0</span>);
<span>const</span> promise2 = <span>new</span> <span>Promise</span>(<span>(<span>resolve</span>) =&gt;</span> setTimeout(resolve, <span>100</span>, <span>'quick'</span>));
<span>const</span> promise3 = <span>new</span> <span>Promise</span>(<span>(<span>resolve</span>) =&gt;</span> setTimeout(resolve, <span>500</span>, <span>'slow'</span>));
<span>const</span> promises = [promise1, promise2, promise3];

<span>Promise</span>.any(promises).then(<span>(<span>value</span>) =&gt;</span> <span>console</span>.log(value));
</code></pre>
<h3>Logical assignment operators</h3>
<p>JavaScript supports a variety of <a href="https://developer.mozilla.org/docs/Web/JavaScript/Guide/Expressions_and_Operators#Assignment" target="_blank">assignment operators</a> already. The <a href="https://github.com/tc39/proposal-logical-assignment" target="_blank">Logical Assignment Operator Proposal</a> specifies three new logical operators that are now enabled by default in Firefox:</p>
<ul>
<li><code>??=</code> — <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/Logical_nullish_assignment" target="_blank">Logical nullish assignment</a>.</li>
<li><code>&amp;&amp;=</code> — <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/Logical_AND_assignment" target="_blank">Logical AND assignment</a>.</li>
<li><code>||=</code> — and, <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/Logical_OR_assignment" target="_blank">Logical OR assignment</a>.</li>
</ul>
<p>These new logical assignment operators have the same short-circuit behavior that the existing <a href="https://developer.mozilla.org/docs/Web/JavaScript/Guide/Expressions_and_Operators#Logical_operators" target="_blank">logical operations</a> implement already. Assignment only happens if the logical operation would evaluate the right-hand side.</p>
<p>For example, if the “lyrics” element is empty, set the <code>innerHTML</code> to a default value:</p>
<pre><code><span>document</span>.getElementById(<span>'lyrics'</span>).innerHTML ||= <span>'&lt;i&gt;No lyrics.&lt;/i&gt;'</span></code></pre>
<p>Here the short-circuit is especially beneficial, since the element will not be updated unnecessarily. Moreover, it won’t cause unwanted side-effects such as additional parsing or rendering work, or loss of focus.</p>
<h3>Weakly held references</h3>
<p>In JavaScript, references to objects are generally held strongly. Thus, as long as you have a reference to an object, it won’t be garbage collected. This changed with the addition of <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakMap" target="_blank"><code>WeakMap</code></a> and <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakSet" target="_blank"><code>WeakSet</code></a> in ES2015. However, since that time JavaScript has not provided a more advanced API for weakly held references. The <a href="https://github.com/tc39/proposal-weakrefs" target="_blank" rel="noopener noreferrer">WeakRef proposal</a> adds this capability. Now Firefox supports the <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakRef" target="_blank"><code>WeakRef</code></a> and <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry" target="_blank"><code>FinalizationRegistry</code></a> objects.</p>
<p>Hop over to the MDN docs for <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakRef#Examples" target="_blank">example usage</a> of <code>WeakRef</code>. Garbage collectors are complicated, so make sure you also read <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakRef#Avoid_where_possible" target="_blank">this note of caution</a> before using WeakRefs.</p>
<h3>WebAssembly</h3>
<p>Firefox 79 includes new WebAssembly functionality:</p>
<ul>
<li>First off, seven new built-in operations are provided for <a href="https://developer.mozilla.org/docs/WebAssembly/Understanding_the_text_format#Bulk_memory_operations" target="_blank">bulk memory operations</a>. For example, copying and initializing allow WebAssembly to model native functions such as <code>memcpy</code> and <code>memmove</code> in a more efficient, performant way.</li>
<li>The <a href="https://github.com/WebAssembly/reference-types" target="_blank" rel="noopener noreferrer">reference-types proposal</a> is now supported. It provides a new type, <code>externref</code>, which can hold any JavaScript value, for example strings, DOM references, or objects. The <a href="https://rustwasm.github.io/docs/wasm-bindgen/" target="_blank"><code>wasm-bindgen</code></a> documentation includes guidance for taking advantage of <code>externref</code> from Rust.</li>
<li>With the return of SharedArrayBuffer objects, we’re now also able to support <a href="https://developer.mozilla.org/docs/WebAssembly/Understanding_the_text_format#WebAssembly_threads" target="_blank">WebAssembly threads</a>. Thus, it is now possible for WebAssembly Memory objects to be shared across multiple WebAssembly instances running in separate Web Workers. The outcome? Very fast communication between Workers, as well as significant performance gains in web applications.</li>
</ul>
<h2>WebExtensions updates</h2>
<p>Starting with Firefox 79, developers of tab management extensions can improve the perceived performance when users switch tabs. The new <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/warmup" target="_blank"><code>tabs.warmup()</code></a> function will prepare the tab to be displayed. Developers can use this function, when they anticipate a tab switch, e.g. when hovering over a button or link.</p>
<p>If you’re an extension developer and your extensions sync items across multiple devices, be aware that we ported <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage/sync" target="_blank"><code>storage.sync</code> area</a> to a Rust-based implementation. Extension data that had been stored locally in existing profiles will automatically migrate the first time an installed extension tries to access <code>storage.sync</code> data in Firefox 79. As a quick note, the new implementation enforces client-side quota limits. You should estimate how much data your extension stores locally and test how your extension behaves once the data limit is exceeded. Check out <a href="https://blog.mozilla.org/addons/2020/07/09/changes-to-storage-sync-in-firefox-79/" target="_blank" rel="noopener noreferrer">this post</a> for testing instructions and more information about this change.</p>
<p>Take a look at the <a href="https://blog.mozilla.org/addons/" target="_blank" rel="noopener noreferrer">Add-ons Blog</a> for more updates to the WebExtensions API in Firefox 79!</p>
<h2>Summary</h2>
<p>As always, feel free to share constructive feedback and ask questions in the comments. And thanks for keeping your <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank" rel="noopener noreferrer">Firefox up to date</a>!</p>
    <section>
                                
                      <p>Florian is the Content Lead for MDN Web Docs, writes about Web platform technologies and researches browser compatibility data. He lives in Bremen, Germany.</p>
                                <p><a href="https://hacks.mozilla.org/author/fscholzmozilla-com/">More articles by Florian Scholz…</a></p>
                  
                      <p>Chris Mills is a senior tech writer at Mozilla, where he writes docs and demos about open web apps, HTML/CSS/JavaScript, A11y, WebAssembly, and more. He loves tinkering around with web technologies, and gives occasional tech talks at conferences and universities. He used to work for Opera and W3C, and enjoys playing heavy metal drums and drinking good beer. He lives near Manchester, UK, with his good lady and three beautiful children.</p>
                                <p><a href="https://hacks.mozilla.org/author/cmillsmozilla-com/">More articles by Chris Mills…</a></p>
                  
                      <p>Harald "digitarald" Kirschner is a Product Manager for Firefox's Developer Experience and Tools – striving to empower creators to code, design &amp; maintain a web that is open and accessible to all. During his 8 years at Mozilla, he has grown his skill set amidst performance, web APIs, mobile, installable web apps, data visualization, and developer outreach projects.</p>
                                <p><a href="https://hacks.mozilla.org/author/hkirschnermozilla-com/">More articles by Harald Kirschner (digitarald)…</a></p>
                  </section>
  </article></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>