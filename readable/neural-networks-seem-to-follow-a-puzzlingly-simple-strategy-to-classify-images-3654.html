<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Neural Networks seem to follow a puzzlingly simple strategy to classify images - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Neural Networks seem to follow a puzzlingly simple strategy to classify images - linksfor.dev(s)"/>
    <meta property="article:author" content="Wieland Brendel"/>
    <meta property="og:description" content="This explains a range of observations, leads to more interpretable models and suggests novel avenues towards human-like perception."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://medium.com/bethgelab/neural-networks-seem-to-follow-a-puzzlingly-simple-strategy-to-classify-images-f4229317261f"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">üéâ</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Neural Networks seem to follow a puzzlingly simple strategy to classify images</title>
<div class="readable">
        <h1>Neural Networks seem to follow a puzzlingly simple strategy to classify images</h1>
        <p>
by Wieland Brendel <br/>Reading time: 9-11 minutes        </p>
        <p><a href="https://medium.com/bethgelab/neural-networks-seem-to-follow-a-puzzlingly-simple-strategy-to-classify-images-f4229317261f">https://medium.com/bethgelab/neural-networks-seem-to-follow-a-puzzlingly-simple-strategy-to-classify-images-f4229317261f</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div><div><div><div><div><div><p><a rel="noopener" href="https://medium.com/@wielandbr?source=post_page-----f4229317261f----------------------"><img alt="Wieland Brendel" src="https://miro.medium.com/fit/c/48/48/1*CYG8sM-kmYb_2z9V-7LJtg.jpeg" width="48" height="48"></a></p></div></div></div></div></div></div><div><div><p id="04ff" data-selectable-paragraph="">In this post I will show why state-of-the-art Deep Neural Networks can still recognise scrambled images perfectly well and how this helps to uncover a puzzlingy simple strategy that DNNs seem to use to classify natural images. These findings, <a href="https://openreview.net/pdf?id=SkfMWhAqYQ" target="_blank" rel="noopener nofollow">published at ICLR 2019</a>, have a number of ramifications: first, they show that solving ImageNet is much simpler than many have thought. Second, the findings allow us to build much more interpretable and transparent image classification pipelines. Third, they explain a number of phenomena observed in modern CNNs like their bias towards texture (<a href="https://openreview.net/forum?id=Bygh9j09KX" target="_blank" rel="noopener nofollow">see our other paper at ICLR 2019</a> and our <a href="https://blog.usejournal.com/why-deep-learning-works-differently-than-we-thought-ec28823bdbc" target="_blank" rel="noopener nofollow">corresponding blog post</a>) and their neglect of the spatial ordering of object parts.</p><h2 id="4693" data-selectable-paragraph="">Good ol‚Äô bag-of-features models</h2><p id="2395" data-selectable-paragraph="">In the old days, before Deep Learning, object recognition in natural images used to be fairly simple: define a set of key visual features (‚Äúwords‚Äù), recognize how often each visual feature is present in an image (‚Äúbag‚Äù) and then classify the image based on these numbers. These models are therefore called ‚Äúbag-of-features‚Äù models (BoF models). For illustration, say we have only two visual features, a human eye and a feather, and we want to classify images into ‚Äúhuman‚Äù and ‚Äúbird‚Äù class. The simplest BoF model would work as follows: for each eye in the image it increases evidence for ‚Äúhuman‚Äù by +1. Vice versa, for each feather in the image it will increase evidence for ‚Äúbird‚Äù by +1. Whatever class accumulates the most evidence across the image will be the predicted one.</p><p id="a44d" data-selectable-paragraph="">A nice property of this simplest BoF model is its interpretability and transparent decision making: we can check exactly which image features carry evidence for a given class, the spatial integration of evidence is super simple (in contrast to the deep non-linear feature integration in deep neural networks) and so it is quite straight-forward to understand how the model reaches its decisions.</p><p id="1c05" data-selectable-paragraph="">Traditional BoF models have been extremely popular and state-of-the-art before the onset of Deep Learning but quickly fell out of favour due to their subpar classification performance. But are we sure that Deep Neural Networks really use a fundamentally different decision-strategy as BoF-models?</p><h2 id="9537" data-selectable-paragraph="">A deep but interpretable bag-of-feature network (BagNet)</h2><p id="e480" data-selectable-paragraph="">To test this we combine the interpretability and transparency of BoF models with the performance of DNNs. The high-level strategy is as follows:</p><ul><li id="d282" data-selectable-paragraph="">Split the image into small <em>q</em> x <em>q</em> image patches</li><li id="2ff4" data-selectable-paragraph="">Pass patches through a DNN to get class evidences (logits) for each patch.</li><li id="ac3e" data-selectable-paragraph="">Sum the evidence over all patches to reach an image-level decision.</li></ul><figure><div><div><div><div><p><img src="https://miro.medium.com/max/30/1*5GhHIvpnpGYs6Ll_qAGGqw.png?q=20" width="1200" height="929" role="presentation"></p><p><img width="1200" height="929" role="presentation"></p></div></div></div></div><figcaption data-selectable-paragraph="">Classification strategy of BagNets: for each patch we extract class evidences (logits) using a DNN and sum up the total class evidences over all patches.</figcaption></figure><p id="8580" data-selectable-paragraph="">To implement this strategy in the simplest and most efficient way we take a standard ResNet-50 architecture and replace most (but not all) 3x3 convolutions with 1x1 convolutions. In this case the hidden units in the last convolutional layer each only ‚Äúsee‚Äù a small part of the image (i.e. their receptive field is much smaller than the size of the image). This avoids an explicit partitioning of the image and is as close as possible to standard CNNs while still implementing the outlined strategy. We call the resulting model architecture <strong>BagNet-<em>q</em></strong> where <em>q</em> stands for the receptive field size of the top-most layer (we test <em>q</em> = 9, 17 and 33). The runtime of BagNet-<em>q</em> is roughly 2,5 the runtime of a ResNet-50.</p><figure><div><div><div><div><p><img src="https://miro.medium.com/max/30/1*sX-AZP9jf2ZociFGC2h-aQ.jpeg?q=20" width="1485" height="925" role="presentation"></p><p><img width="1485" height="925" role="presentation"></p></div></div></div></div><figcaption data-selectable-paragraph="">Performance of BagNets with different patch sizes on ImageNet.</figcaption></figure><p id="3fba" data-selectable-paragraph="">The performance of BagNets on ImageNet is impressive even for very small patch sizes: image features of size 17 x 17 pixels are enough to reach AlexNet-level performance while features of size 33 x 33 pixels are sufficient to reach around 87% top-5 accuracy. Higher performance values might be achievable with a more careful placement of the 3 x 3 convolutions and additional hyperparameter tuning.</p><p id="b5fc" data-selectable-paragraph="">That‚Äôs our first main result: you can solve ImageNet using only a collection of small image features. Long-range spatial relationships like object shape or the relation between object parts can be completely neglected and are unnecessary to solve the task.</p><p id="0507" data-selectable-paragraph="">A great feature of the BagNets is their transparent decision-making. For example, we can now look which image features are most predictive for a given class (see below). For example, a tench (a very big fish) is typically recognized by fingers on top of a greenish background. Why? Because most images in this category feature a fisherman holding up the tench like a trophy. Whenever the BagNet wrongly classifies an image as a tench it‚Äôs often because there are some fingers on top of a greenish background somewhere in the image.</p></div></div><div><p id="8550" data-selectable-paragraph="">Similarly, we also get a precisely defined heatmap that shows which parts of the image contributed to a certain decision.</p></div><div><div><h2 id="568c" data-selectable-paragraph="">ResNet-50 is surprisingly similar to BagNets</h2><p id="8803" data-selectable-paragraph="">BagNets show that one can reach high accuracy on ImageNet just based on the weak statistical correlations between local image features and the object category. If that‚Äôs enough, why would standard deep nets like ResNet-50 learn anything fundamentally different? Why should a ResNet-50 learn about complex large-scale relationships like object shape if the abundance of local image features is sufficient to solve the task?</p><p id="c95a" data-selectable-paragraph="">To test the hypothesis that modern DNNs follow a similar strategy as simple bag-of-feature networks we test different ResNets, DenseNets and VGGs on the following ‚Äúsignatures‚Äù of BagNets:</p><ul><li id="f613" data-selectable-paragraph="">Decisions are invariant against spatial shuffling of image features (could only be tested on VGG models).</li><li id="06e1" data-selectable-paragraph="">Modifications of different image parts should be independent (in terms of their effect on the total class evidence).</li><li id="1e56" data-selectable-paragraph="">Errors made by standard CNNs and BagNets should be similar.</li><li id="c570" data-selectable-paragraph="">Standard CNNs and BagNets should be sensitive to similar features.</li></ul><p id="e970" data-selectable-paragraph="">In all four experiments we find a strikingly similar behaviour between CNNs and BagNets. As an example, in the last experiment we show that those image parts to which the BagNets are most sensitive to (e.g. if you occlude those parts) are basically the same to which CNNs are most sensitive to. In fact, the heatmaps (the spatial map of sensitivity) of BagNets are better predictors of the sensitivity of DenseNet-169 than heatmaps generated by attribution methods like DeepLift (which compute heatmaps directly for DenseNet-169). Of course, DNNs do not perfectly resemble bag-of-feature models but do show some deviations. In particular, we find increased features sizes and more long-range dependencies the deeper the networks get. Hence, deeper neural networks do improve over simpler bag-of-feature models but I don‚Äôt think that the core classification strategy has really changed.</p><h2 id="cd68" data-selectable-paragraph="">Going beyond bag-of-features classification</h2><p id="4859" data-selectable-paragraph="">Viewing the decision-making of CNNs as a bag-of-feature strategy could explain several weird observations about CNNs. First, it would explain why CNNs have such a <a href="https://openreview.net/forum?id=Bygh9j09KX" target="_blank" rel="noopener nofollow">strong texture-bias</a>. Second, it would explain why CNNs are so insensitive to the <a href="https://www.sciencedirect.com/science/article/pii/S095943881730065X" target="_blank" rel="noopener nofollow">shuffling of image parts</a>. It might even explain the existence of adversarial stickers and adversarial perturbations in general: one can place misleading signals anywhere in the image and the CNN will still reliably pick up that signal whether or not these signal fit to the rest of the image.</p><p id="36e0" data-selectable-paragraph="">At its core our work shows that CNNs use the many weak statistical regularities present in natural images for classification and don‚Äôt make the jump towards object-level integration of image parts like humans. The same is likely true for other tasks and sensory modalities.</p><p id="08f3" data-selectable-paragraph="">We have to think hard about how to build our architectures, tasks and learning methods to counteract this tendency towards weak statistical correlations. One angle would be to improve the inductive biases of CNNs away from small local features towards more global features. Another angle would be to remove or replace those features onto which the networks should not rely, which is exactly what we did in another <a href="https://openreview.net/forum?id=Bygh9j09KX" target="_blank" rel="noopener nofollow">ICLR 2019 publication</a> using a style transfer preprocessing to remove the natural object texture.</p><p id="96f7" data-selectable-paragraph="">One of the biggest problems, however, is certainly the task of image classification itself: <mark>if local image features are sufficient to solve the task, there is no incentive to learn the true ‚Äúphysics‚Äù of the natural world</mark>. We will have to restructure the task itself in a way that pushes models to learn the physical nature of objects. This likely has to go beyond purely observational learning of correlations between input and output features in order to allow models to extract causal dependencies.</p><p id="5e40" data-selectable-paragraph="">Taken together, our results suggest that CNNs might follow an extremely simple classification strategy. The fact that such a discovery can still be made in the year 2019 highlights how little we have yet understood about the inner workings of deep neural networks. This lack of understanding prevents us from developing fundamentally better models and architectures that close the gap between human and machine perception. Deepening our understanding will allow us to uncover ways to close this gap. This can be extremely fruitful: as we tried to bias CNNs towards more physical properties of objects we suddenly reached <a href="https://openreview.net/forum?id=Bygh9j09KX" target="_blank" rel="noopener nofollow">human-like noise robustness</a>. I expect many more exciting results on our way towards CNNs that truly learn the physical and causal nature of our world.</p></div></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>