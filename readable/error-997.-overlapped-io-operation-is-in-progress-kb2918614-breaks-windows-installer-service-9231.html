<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Error 997. Overlapped I/O operation is in progress: KB2918614 breaks Windows Installer Service - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Error 997. Overlapped I/O operation is in progress: KB2918614 breaks Windows Installer Service - linksfor.dev(s)"/>
    <meta property="og:description" content="Certain MSI packages may fail with an error &quot;Error 997. Overlapped I/O operation is in progress&quot;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/vsnetsetup/2014/10/27/error-997-overlapped-io-operation-is-in-progress-kb2918614-breaks-windows-installer-service/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
                <span style="cursor: default" title="linksfor.dev(s) has been running for 1 year! :partypopper:">ðŸŽ‰</span>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Error 997. Overlapped I/O operation is in progress: KB2918614 breaks Windows Installer Service</title>
<div class="readable">
        <h1>Error 997. Overlapped I/O operation is in progress: KB2918614 breaks Windows Installer Service</h1>
        <p>
Reading time: 3-4 minutes        </p>
        <p><a href="https://blogs.msdn.microsoft.com/vsnetsetup/2014/10/27/error-997-overlapped-io-operation-is-in-progress-kb2918614-breaks-windows-installer-service/">https://blogs.msdn.microsoft.com/vsnetsetup/2014/10/27/error-997-overlapped-io-operation-is-in-progress-kb2918614-breaks-windows-installer-service/</a></p>
        <hr/>
<div id="readability-page-1" class="page">


	<div data-bi-name="body">

		<div>

			

			<section>
				<div>


				<div id="main-column">

					<main id="main" role="main" data-bi-name="content" lang="en-us" dir="ltr">



						

						<ul data-bi-name="page info" lang="en-us" dir="ltr">
							<li>
								<time role="presentation" datetime="2014-10-27T00:00:00.000Z" data-article-date-source="ms.date">10/27/2014</time>
							</li>
								<li>2 minutes to read</li>

						</ul>

						<nav id="center-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline" hidden="">
							<h3>In this article</h3>
						</nav>


						<!-- <content> -->
							
<p>Certain MSI packages may fail with an error "Error 997. Overlapped I/O operation is in progress"</p>
<p>As per the MSI log:</p>
<p>MSI (s) (44:48) [15:07:21:799]: Determining source type<br>
MSI (s) (44:48) [15:07:21:799]: Source type from package 'My_Package.msi': 2<br>
MSI (s) (44:48) [15:07:21:799]: SECREPAIR: Hash Database:<br>
C:\Windows\Installer\SourceHash{AC1B6088-A6FC-9CDA-ABF2-60530F5DA203}<br>
MSI (s) (44:48) [15:07:21:799]: Note: 1: 2262 2: SourceHash 3: -2147287038<br>
MSI (s) (44:48) [15:07:21:815]: SECREPAIR: New Hash Database creation complete.<br>
MSI (s) (44:48) [15:07:21:815]: <strong>SECREPAIR: A general error running CryptAcquireContext</strong><br>
MSI (s) (44:48) [15:07:21:815]: SECREPAIR: Crypt Provider not initialized. Error:997<br>
MSI (s) (44:48) [15:07:21:815]: SECUREREPAIR: Failed to CreateContentHash of the file:<br>
My_Package.msi: for computing its hash. Error: 997 MSI (s) (44:48)<br>
[15:07:21:815]: SECREPAIR: Failed to create hash for the install source files<br>
MSI (s) (44:48) [15:07:21:815]: Note: 1: 2262 2: SourceHash 3: -2147287038<br>
MSI (s) (44:48) [15:07:21:815]: SECUREREPAIR: SecureRepair Failed. Error code: 3e5E99334B8<br>
MSI (c) (A0:8C) [15:07:21:877]: Font created.&nbsp; Charset: Req=0, Ret=0, Font: Req=MS Shell Dlg, Ret=MS Shell Dlg<br>
Error 997. Overlapped I/O operation is in progress.<br>
MSI (s) (44:48) [15:07:30:769]: Note: 1: 2205 2:&nbsp; 3: Error<br>
MSI (s) (44:48) [15:07:30:769]: Note: 1: 2228 2:&nbsp; 3: Error 4: SELECT `Message` FROM `Error` WHERE `Error` = 1709</p>
<p>As per the application Event log:</p>
<p>Log Name:&nbsp;&nbsp; Application<br>
Source:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsiInstaller<br>
Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2014-09-05 15:07:30<br>
Event ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10997<br>
Task Category: None<br>
Level:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;Error<br>
Keywords:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Classic<br>
User:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S-1-5-21-1655003508-46252071-1983596133-179088<br>
Computer:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; My_Machine</p>
<p>Description:<br>
The description for Event ID 10997 from source MsiInstaller cannot be found. Either the component that raises this event is not installed on your local computer or the installation is corrupted. You can install or repair the component on the local computer.&nbsp;</p>
<p>If the event originated on another computer, the display information had to be saved with the event. The following information was included with the event:<br>
Product: My_Package 1.0.0.1 -- Error 997. Overlapped I/O operation is in progress.</p>
<p><em>This is a known issue with the security patch <strong><a href="https://support.microsoft.com/kb/2918614" data-linktype="external">KB2918614</a></strong> released on 12th August. This issue occurs because update 2918614 uses cryptographic keys and certificates for hashing the installation files together with the logged-in user profile. However, cryptographic keys and certificates cannot be used by mandatory or temporary user profiles. Therefore, when a user uses a mandatory or temporary user profile to install any MSI package, the MSI package installation fails and the error message returns.</em></p>
<p>Resolution: Please apply this <strong><a href="https://support.microsoft.com/kb/3000988" data-linktype="external">hotfix</a></strong></p>
<p>P.S. An official fix is in testing and being tracked for release in November patch Tuesday(14-11). There could be some changes due to unexpected events.</p>

						<!-- </content> -->

						</main>

						<!-- recommended content page section -->

							<nav data-bi-name="recommendation-bottom" hidden="" id="recommended-content-center" aria-labelledby="recommended-content-center-title">
								<h3 id="recommended-content-center-title">Related Articles</h3>
							</nav>

						<!-- end recommended content page section -->

						<!-- rating mobile section -->
						<!-- end rating mobile section -->

						<!-- feedback section -->




						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						
					</div>

					

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			
		</div>

		<!--end of .mainContainer -->
	</div>

	

	

	


</div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>