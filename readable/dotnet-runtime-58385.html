<!DOCTYPE html>
<html lang="en">
<head>
    <title>
dotnet/runtime - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="dotnet/runtime - linksfor.dev(s)"/>
    <meta property="og:description" content=".NET is a cross-platform runtime for cloud, IoT, and desktop apps. - dotnet/runtime"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/runtime/blob/fcd862e/src/coreclr/src/vm/jitinterface.cpp"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - dotnet/runtime</title>
<div class="readable">
        <h1>dotnet/runtime</h1>
            <div>Reading time: 841-1069 minutes</div>
        <div>Posted here: 17 Feb 2020</div>
        <p><a href="https://github.com/dotnet/runtime/blob/fcd862e/src/coreclr/src/vm/jitinterface.cpp">https://github.com/dotnet/runtime/blob/fcd862e/src/coreclr/src/vm/jitinterface.cpp</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div itemprop="text">
      
<table data-tab-size="4">
      <tbody><tr>
        <td id="L1" data-line-number="1"></td>
        <td id="LC1"><span><span>//</span> Licensed to the .NET Foundation under one or more agreements.</span></td>
      </tr>
      <tr>
        <td id="L2" data-line-number="2"></td>
        <td id="LC2"><span><span>//</span> The .NET Foundation licenses this file to you under the MIT license.</span></td>
      </tr>
      <tr>
        <td id="L3" data-line-number="3"></td>
        <td id="LC3"><span><span>//</span> See the LICENSE file in the project root for more information.</span></td>
      </tr>
      <tr>
        <td id="L4" data-line-number="4"></td>
        <td id="LC4"><span>// ===========================================================================</span></td>
      </tr>
      <tr>
        <td id="L5" data-line-number="5"></td>
        <td id="LC5"><span><span>//</span> File: JITinterface.CPP</span></td>
      </tr>
      <tr>
        <td id="L6" data-line-number="6"></td>
        <td id="LC6"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7" data-line-number="7"></td>
        <td id="LC7">
</td>
      </tr>
      <tr>
        <td id="L8" data-line-number="8"></td>
        <td id="LC8"><span>// ===========================================================================</span></td>
      </tr>
      <tr>
        <td id="L9" data-line-number="9"></td>
        <td id="LC9">
</td>
      </tr>
      <tr>
        <td id="L10" data-line-number="10"></td>
        <td id="LC10">
</td>
      </tr>
      <tr>
        <td id="L11" data-line-number="11"></td>
        <td id="LC11">#<span>include</span> <span><span>"</span>common.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L12" data-line-number="12"></td>
        <td id="LC12">#<span>include</span> <span><span>"</span>jitinterface.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L13" data-line-number="13"></td>
        <td id="LC13">#<span>include</span> <span><span>"</span>codeman.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L14" data-line-number="14"></td>
        <td id="LC14">#<span>include</span> <span><span>"</span>method.hpp<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L15" data-line-number="15"></td>
        <td id="LC15">#<span>include</span> <span><span>"</span>class.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L16" data-line-number="16"></td>
        <td id="LC16">#<span>include</span> <span><span>"</span>object.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L17" data-line-number="17"></td>
        <td id="LC17">#<span>include</span> <span><span>"</span>field.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L18" data-line-number="18"></td>
        <td id="LC18">#<span>include</span> <span><span>"</span>stublink.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L19" data-line-number="19"></td>
        <td id="LC19">#<span>include</span> <span><span>"</span>virtualcallstub.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L20" data-line-number="20"></td>
        <td id="LC20">#<span>include</span> <span><span>"</span>corjit.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L21" data-line-number="21"></td>
        <td id="LC21">#<span>include</span> <span><span>"</span>eeconfig.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L22" data-line-number="22"></td>
        <td id="LC22">#<span>include</span> <span><span>"</span>excep.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L23" data-line-number="23"></td>
        <td id="LC23">#<span>include</span> <span><span>"</span>log.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L24" data-line-number="24"></td>
        <td id="LC24">#<span>include</span> <span><span>"</span>excep.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L25" data-line-number="25"></td>
        <td id="LC25">#<span>include</span> <span><span>"</span>float.h<span>"</span></span>      <span><span>//</span> for isnan</span></td>
      </tr>
      <tr>
        <td id="L26" data-line-number="26"></td>
        <td id="LC26">#<span>include</span> <span><span>"</span>dbginterface.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L27" data-line-number="27"></td>
        <td id="LC27">#<span>include</span> <span><span>"</span>dllimport.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L28" data-line-number="28"></td>
        <td id="LC28">#<span>include</span> <span><span>"</span>gcheaputilities.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L29" data-line-number="29"></td>
        <td id="LC29">#<span>include</span> <span><span>"</span>comdelegate.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L30" data-line-number="30"></td>
        <td id="LC30">#<span>include</span> <span><span>"</span>jitperf.h<span>"</span></span> <span><span>//</span> to track jit perf</span></td>
      </tr>
      <tr>
        <td id="L31" data-line-number="31"></td>
        <td id="LC31">#<span>include</span> <span><span>"</span>corprof.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L32" data-line-number="32"></td>
        <td id="LC32">#<span>include</span> <span><span>"</span>eeprofinterfaces.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L33" data-line-number="33"></td>
        <td id="LC33">#<span>ifdef</span> PROFILING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L34" data-line-number="34"></td>
        <td id="LC34">#<span>include</span> <span><span>"</span>proftoeeinterfaceimpl.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L35" data-line-number="35"></td>
        <td id="LC35">#<span>include</span> <span><span>"</span>eetoprofinterfaceimpl.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L36" data-line-number="36"></td>
        <td id="LC36">#<span>include</span> <span><span>"</span>eetoprofinterfaceimpl.inl<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L37" data-line-number="37"></td>
        <td id="LC37">#<span>include</span> <span><span>"</span>profilepriv.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L38" data-line-number="38"></td>
        <td id="LC38">#<span>include</span> <span><span>"</span>rejit.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L39" data-line-number="39"></td>
        <td id="LC39">#<span>endif</span> <span><span>//</span> PROFILING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L40" data-line-number="40"></td>
        <td id="LC40">#<span>include</span> <span><span>"</span>ecall.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L41" data-line-number="41"></td>
        <td id="LC41">#<span>include</span> <span><span>"</span>generics.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L42" data-line-number="42"></td>
        <td id="LC42">#<span>include</span> <span><span>"</span>typestring.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L43" data-line-number="43"></td>
        <td id="LC43">#<span>include</span> <span><span>"</span>typedesc.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L44" data-line-number="44"></td>
        <td id="LC44">#<span>include</span> <span><span>"</span>genericdict.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L45" data-line-number="45"></td>
        <td id="LC45">#<span>include</span> <span><span>"</span>array.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L46" data-line-number="46"></td>
        <td id="LC46">#<span>include</span> <span><span>"</span>debuginfostore.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L47" data-line-number="47"></td>
        <td id="LC47">#<span>include</span> <span><span>"</span>safemath.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L48" data-line-number="48"></td>
        <td id="LC48">#<span>include</span> <span><span>"</span>runtimehandles.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L49" data-line-number="49"></td>
        <td id="LC49">#<span>include</span> <span><span>"</span>sigbuilder.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L50" data-line-number="50"></td>
        <td id="LC50">#<span>include</span> <span><span>"</span>openum.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L51" data-line-number="51"></td>
        <td id="LC51">#<span>ifdef</span> HAVE_GCCOVER</td>
      </tr>
      <tr>
        <td id="L52" data-line-number="52"></td>
        <td id="LC52">#<span>include</span> <span><span>"</span>gccover.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L53" data-line-number="53"></td>
        <td id="LC53">#<span>endif</span> <span><span>//</span> HAVE_GCCOVER</span></td>
      </tr>
      <tr>
        <td id="L54" data-line-number="54"></td>
        <td id="LC54">
</td>
      </tr>
      <tr>
        <td id="L55" data-line-number="55"></td>
        <td id="LC55">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L56" data-line-number="56"></td>
        <td id="LC56">#<span>include</span> <span><span>"</span>compile.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L57" data-line-number="57"></td>
        <td id="LC57">#<span>include</span> <span><span>"</span>corcompile.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L58" data-line-number="58"></td>
        <td id="LC58">#<span>endif</span> <span><span>//</span> FEATURE_PREJIT</span></td>
      </tr>
      <tr>
        <td id="L59" data-line-number="59"></td>
        <td id="LC59">
</td>
      </tr>
      <tr>
        <td id="L60" data-line-number="60"></td>
        <td id="LC60">
</td>
      </tr>
      <tr>
        <td id="L61" data-line-number="61"></td>
        <td id="LC61">#<span>ifdef</span> FEATURE_INTERPRETER</td>
      </tr>
      <tr>
        <td id="L62" data-line-number="62"></td>
        <td id="LC62">#<span>include</span> <span><span>"</span>interpreter.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L63" data-line-number="63"></td>
        <td id="LC63">#<span>endif</span> <span><span>//</span> FEATURE_INTERPRETER</span></td>
      </tr>
      <tr>
        <td id="L64" data-line-number="64"></td>
        <td id="LC64">
</td>
      </tr>
      <tr>
        <td id="L65" data-line-number="65"></td>
        <td id="LC65">#<span>ifdef</span> FEATURE_PERFMAP</td>
      </tr>
      <tr>
        <td id="L66" data-line-number="66"></td>
        <td id="LC66">#<span>include</span> <span><span>"</span>perfmap.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L67" data-line-number="67"></td>
        <td id="LC67">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L68" data-line-number="68"></td>
        <td id="LC68">
</td>
      </tr>
      <tr>
        <td id="L69" data-line-number="69"></td>
        <td id="LC69"><span><span>//</span> The Stack Overflow probe takes place in the COOPERATIVE_TRANSITION_BEGIN() macro</span></td>
      </tr>
      <tr>
        <td id="L70" data-line-number="70"></td>
        <td id="LC70"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L71" data-line-number="71"></td>
        <td id="LC71">
</td>
      </tr>
      <tr>
        <td id="L72" data-line-number="72"></td>
        <td id="LC72">#<span>define</span> <span>JIT_TO_EE_TRANSITION</span>()          MAKE_CURRENT_THREAD_AVAILABLE_EX(m_pThread);                \</td>
      </tr>
      <tr>
        <td id="L73" data-line-number="73"></td>
        <td id="LC73">                                        <span>_ASSERTE</span>(CURRENT_THREAD == GetThread());                    \</td>
      </tr>
      <tr>
        <td id="L74" data-line-number="74"></td>
        <td id="LC74">                                        INSTALL_UNWIND_AND_CONTINUE_HANDLER_NO_PROBE;               \</td>
      </tr>
      <tr>
        <td id="L75" data-line-number="75"></td>
        <td id="LC75">                                        <span>COOPERATIVE_TRANSITION_BEGIN</span>();                             \</td>
      </tr>
      <tr>
        <td id="L76" data-line-number="76"></td>
        <td id="LC76">                                        <span>START_NON_JIT_PERF</span>();</td>
      </tr>
      <tr>
        <td id="L77" data-line-number="77"></td>
        <td id="LC77">
</td>
      </tr>
      <tr>
        <td id="L78" data-line-number="78"></td>
        <td id="LC78">#<span>define</span> <span>EE_TO_JIT_TRANSITION</span>()          STOP_NON_JIT_PERF();                                        \</td>
      </tr>
      <tr>
        <td id="L79" data-line-number="79"></td>
        <td id="LC79">                                        <span>COOPERATIVE_TRANSITION_END</span>();                               \</td>
      </tr>
      <tr>
        <td id="L80" data-line-number="80"></td>
        <td id="LC80">                                        UNINSTALL_UNWIND_AND_CONTINUE_HANDLER_NO_PROBE;</td>
      </tr>
      <tr>
        <td id="L81" data-line-number="81"></td>
        <td id="LC81">
</td>
      </tr>
      <tr>
        <td id="L82" data-line-number="82"></td>
        <td id="LC82">#<span>define</span> <span>JIT_TO_EE_TRANSITION_LEAF</span>()</td>
      </tr>
      <tr>
        <td id="L83" data-line-number="83"></td>
        <td id="LC83">#<span>define</span> <span>EE_TO_JIT_TRANSITION_LEAF</span>()</td>
      </tr>
      <tr>
        <td id="L84" data-line-number="84"></td>
        <td id="LC84">
</td>
      </tr>
      <tr>
        <td id="L85" data-line-number="85"></td>
        <td id="LC85">
</td>
      </tr>
      <tr>
        <td id="L86" data-line-number="86"></td>
        <td id="LC86">#<span>if</span> defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L87" data-line-number="87"></td>
        <td id="LC87"><span>static</span> <span>const</span> <span>char</span> *<span>const</span> hlpNameTable[CORINFO_HELP_COUNT] = {</td>
      </tr>
      <tr>
        <td id="L88" data-line-number="88"></td>
        <td id="LC88">#<span>define</span> <span>JITHELPER</span>(<span>code, pfnHelper, sig</span>) #code,</td>
      </tr>
      <tr>
        <td id="L89" data-line-number="89"></td>
        <td id="LC89">#<span>include</span> <span><span>"</span>jithelpers.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L90" data-line-number="90"></td>
        <td id="LC90">};</td>
      </tr>
      <tr>
        <td id="L91" data-line-number="91"></td>
        <td id="LC91">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L92" data-line-number="92"></td>
        <td id="LC92">
</td>
      </tr>
      <tr>
        <td id="L93" data-line-number="93"></td>
        <td id="LC93">#<span>ifdef</span> DACCESS_COMPILE</td>
      </tr>
      <tr>
        <td id="L94" data-line-number="94"></td>
        <td id="LC94">
</td>
      </tr>
      <tr>
        <td id="L95" data-line-number="95"></td>
        <td id="LC95"><span><span>//</span> The real definitions are in jithelpers.cpp. However, those files are not included in the DAC build.</span></td>
      </tr>
      <tr>
        <td id="L96" data-line-number="96"></td>
        <td id="LC96"><span><span>//</span> Hence, we add them here.</span></td>
      </tr>
      <tr>
        <td id="L97" data-line-number="97"></td>
        <td id="LC97"><span>GARY_IMPL</span>(VMHELPDEF, hlpFuncTable, CORINFO_HELP_COUNT);</td>
      </tr>
      <tr>
        <td id="L98" data-line-number="98"></td>
        <td id="LC98"><span>GARY_IMPL</span>(VMHELPDEF, hlpDynamicFuncTable, DYNAMIC_CORINFO_HELP_COUNT);</td>
      </tr>
      <tr>
        <td id="L99" data-line-number="99"></td>
        <td id="LC99">
</td>
      </tr>
      <tr>
        <td id="L100" data-line-number="100"></td>
        <td id="LC100">#<span>else</span> <span><span>//</span> DACCESS_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L101" data-line-number="101"></td>
        <td id="LC101">
</td>
      </tr>
      <tr>
        <td id="L102" data-line-number="102"></td>
        <td id="LC102"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L103" data-line-number="103"></td>
        <td id="LC103">
</td>
      </tr>
      <tr>
        <td id="L104" data-line-number="104"></td>
        <td id="LC104"><span>inline</span> CORINFO_MODULE_HANDLE <span>GetScopeHandle</span>(MethodDesc* method)</td>
      </tr>
      <tr>
        <td id="L105" data-line-number="105"></td>
        <td id="LC105">{</td>
      </tr>
      <tr>
        <td id="L106" data-line-number="106"></td>
        <td id="LC106">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L107" data-line-number="107"></td>
        <td id="LC107">    <span>if</span> (method-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L108" data-line-number="108"></td>
        <td id="LC108">    {</td>
      </tr>
      <tr>
        <td id="L109" data-line-number="109"></td>
        <td id="LC109">        <span>return</span> <span>MakeDynamicScope</span>(method-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>());</td>
      </tr>
      <tr>
        <td id="L110" data-line-number="110"></td>
        <td id="LC110">    }</td>
      </tr>
      <tr>
        <td id="L111" data-line-number="111"></td>
        <td id="LC111">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L112" data-line-number="112"></td>
        <td id="LC112">    {</td>
      </tr>
      <tr>
        <td id="L113" data-line-number="113"></td>
        <td id="LC113">        <span>return</span> <span>GetScopeHandle</span>(method-&gt;<span>GetModule</span>());</td>
      </tr>
      <tr>
        <td id="L114" data-line-number="114"></td>
        <td id="LC114">    }</td>
      </tr>
      <tr>
        <td id="L115" data-line-number="115"></td>
        <td id="LC115">}</td>
      </tr>
      <tr>
        <td id="L116" data-line-number="116"></td>
        <td id="LC116">
</td>
      </tr>
      <tr>
        <td id="L117" data-line-number="117"></td>
        <td id="LC117"><span><span>//</span>This is common refactored code from within several of the access check functions.</span></td>
      </tr>
      <tr>
        <td id="L118" data-line-number="118"></td>
        <td id="LC118">BOOL <span>ModifyCheckForDynamicMethod</span>(DynamicResolver *pResolver,</td>
      </tr>
      <tr>
        <td id="L119" data-line-number="119"></td>
        <td id="LC119">                                 TypeHandle *pOwnerTypeForSecurity,</td>
      </tr>
      <tr>
        <td id="L120" data-line-number="120"></td>
        <td id="LC120">                                 AccessCheckOptions::AccessCheckType *pAccessCheckType,</td>
      </tr>
      <tr>
        <td id="L121" data-line-number="121"></td>
        <td id="LC121">                                 DynamicResolver** ppAccessContext)</td>
      </tr>
      <tr>
        <td id="L122" data-line-number="122"></td>
        <td id="LC122">{</td>
      </tr>
      <tr>
        <td id="L123" data-line-number="123"></td>
        <td id="LC123">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L124" data-line-number="124"></td>
        <td id="LC124">        STANDARD_VM_CHECK;</td>
      </tr>
      <tr>
        <td id="L125" data-line-number="125"></td>
        <td id="LC125">        <span>PRECONDITION</span>(<span>CheckPointer</span>(pResolver));</td>
      </tr>
      <tr>
        <td id="L126" data-line-number="126"></td>
        <td id="LC126">        <span>PRECONDITION</span>(<span>CheckPointer</span>(pOwnerTypeForSecurity));</td>
      </tr>
      <tr>
        <td id="L127" data-line-number="127"></td>
        <td id="LC127">        <span>PRECONDITION</span>(<span>CheckPointer</span>(pAccessCheckType));</td>
      </tr>
      <tr>
        <td id="L128" data-line-number="128"></td>
        <td id="LC128">        <span>PRECONDITION</span>(<span>CheckPointer</span>(ppAccessContext));</td>
      </tr>
      <tr>
        <td id="L129" data-line-number="129"></td>
        <td id="LC129">        <span>PRECONDITION</span>(*pAccessCheckType == AccessCheckOptions::<span>kNormalAccessibilityChecks</span>);</td>
      </tr>
      <tr>
        <td id="L130" data-line-number="130"></td>
        <td id="LC130">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L131" data-line-number="131"></td>
        <td id="LC131">
</td>
      </tr>
      <tr>
        <td id="L132" data-line-number="132"></td>
        <td id="LC132">    BOOL doAccessCheck = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L133" data-line-number="133"></td>
        <td id="LC133">
</td>
      </tr>
      <tr>
        <td id="L134" data-line-number="134"></td>
        <td id="LC134">    <span><span>//</span>Do not blindly initialize fields, since they've already got important values.</span></td>
      </tr>
      <tr>
        <td id="L135" data-line-number="135"></td>
        <td id="LC135">    DynamicResolver::SecurityControlFlags dwSecurityFlags = DynamicResolver::Default;</td>
      </tr>
      <tr>
        <td id="L136" data-line-number="136"></td>
        <td id="LC136">
</td>
      </tr>
      <tr>
        <td id="L137" data-line-number="137"></td>
        <td id="LC137">    TypeHandle dynamicOwner;</td>
      </tr>
      <tr>
        <td id="L138" data-line-number="138"></td>
        <td id="LC138">    pResolver-&gt;<span>GetJitContext</span>(&amp;dwSecurityFlags, &amp;dynamicOwner);</td>
      </tr>
      <tr>
        <td id="L139" data-line-number="139"></td>
        <td id="LC139">    <span>if</span> (!dynamicOwner.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L140" data-line-number="140"></td>
        <td id="LC140">        *pOwnerTypeForSecurity = dynamicOwner;</td>
      </tr>
      <tr>
        <td id="L141" data-line-number="141"></td>
        <td id="LC141">
</td>
      </tr>
      <tr>
        <td id="L142" data-line-number="142"></td>
        <td id="LC142">    <span>if</span> (dwSecurityFlags &amp; DynamicResolver::SkipVisibilityChecks)</td>
      </tr>
      <tr>
        <td id="L143" data-line-number="143"></td>
        <td id="LC143">    {</td>
      </tr>
      <tr>
        <td id="L144" data-line-number="144"></td>
        <td id="LC144">        doAccessCheck = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L145" data-line-number="145"></td>
        <td id="LC145">    }</td>
      </tr>
      <tr>
        <td id="L146" data-line-number="146"></td>
        <td id="LC146">    <span>else</span> <span>if</span> (dwSecurityFlags &amp; DynamicResolver::RestrictedSkipVisibilityChecks)</td>
      </tr>
      <tr>
        <td id="L147" data-line-number="147"></td>
        <td id="LC147">    {</td>
      </tr>
      <tr>
        <td id="L148" data-line-number="148"></td>
        <td id="LC148">        *pAccessCheckType = AccessCheckOptions::<span>kRestrictedMemberAccessNoTransparency</span>;</td>
      </tr>
      <tr>
        <td id="L149" data-line-number="149"></td>
        <td id="LC149">    }</td>
      </tr>
      <tr>
        <td id="L150" data-line-number="150"></td>
        <td id="LC150">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L151" data-line-number="151"></td>
        <td id="LC151">    {</td>
      </tr>
      <tr>
        <td id="L152" data-line-number="152"></td>
        <td id="LC152">        *pAccessCheckType = AccessCheckOptions::<span>kNormalAccessNoTransparency</span>;</td>
      </tr>
      <tr>
        <td id="L153" data-line-number="153"></td>
        <td id="LC153">    }</td>
      </tr>
      <tr>
        <td id="L154" data-line-number="154"></td>
        <td id="LC154">
</td>
      </tr>
      <tr>
        <td id="L155" data-line-number="155"></td>
        <td id="LC155">    <span>return</span> doAccessCheck;</td>
      </tr>
      <tr>
        <td id="L156" data-line-number="156"></td>
        <td id="LC156">}</td>
      </tr>
      <tr>
        <td id="L157" data-line-number="157"></td>
        <td id="LC157">
</td>
      </tr>
      <tr>
        <td id="L158" data-line-number="158"></td>
        <td id="LC158"><span><span>/*</span>***************************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L159" data-line-number="159"></td>
        <td id="LC159">
</td>
      </tr>
      <tr>
        <td id="L160" data-line-number="160"></td>
        <td id="LC160"><span><span>//</span> Initialize from data we passed across to the JIT</span></td>
      </tr>
      <tr>
        <td id="L161" data-line-number="161"></td>
        <td id="LC161"><span>inline</span> <span>static</span> <span>void</span> <span>GetTypeContext</span>(<span>const</span> CORINFO_SIG_INST *info, SigTypeContext *pTypeContext)</td>
      </tr>
      <tr>
        <td id="L162" data-line-number="162"></td>
        <td id="LC162">{</td>
      </tr>
      <tr>
        <td id="L163" data-line-number="163"></td>
        <td id="LC163">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L164" data-line-number="164"></td>
        <td id="LC164">    <span>SigTypeContext::InitTypeContext</span>(</td>
      </tr>
      <tr>
        <td id="L165" data-line-number="165"></td>
        <td id="LC165">        <span>Instantiation</span>((TypeHandle *) info-&gt;<span>classInst</span>, info-&gt;<span>classInstCount</span>),</td>
      </tr>
      <tr>
        <td id="L166" data-line-number="166"></td>
        <td id="LC166">        <span>Instantiation</span>((TypeHandle *) info-&gt;<span>methInst</span>, info-&gt;<span>methInstCount</span>),</td>
      </tr>
      <tr>
        <td id="L167" data-line-number="167"></td>
        <td id="LC167">        pTypeContext);</td>
      </tr>
      <tr>
        <td id="L168" data-line-number="168"></td>
        <td id="LC168">}</td>
      </tr>
      <tr>
        <td id="L169" data-line-number="169"></td>
        <td id="LC169">
</td>
      </tr>
      <tr>
        <td id="L170" data-line-number="170"></td>
        <td id="LC170"><span>static</span> MethodDesc* <span>GetMethodFromContext</span>(CORINFO_CONTEXT_HANDLE context)</td>
      </tr>
      <tr>
        <td id="L171" data-line-number="171"></td>
        <td id="LC171">{</td>
      </tr>
      <tr>
        <td id="L172" data-line-number="172"></td>
        <td id="LC172">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L173" data-line-number="173"></td>
        <td id="LC173">    <span>if</span> (((<span>size_t</span>) context &amp; CORINFO_CONTEXTFLAGS_MASK) == CORINFO_CONTEXTFLAGS_CLASS)</td>
      </tr>
      <tr>
        <td id="L174" data-line-number="174"></td>
        <td id="LC174">    {</td>
      </tr>
      <tr>
        <td id="L175" data-line-number="175"></td>
        <td id="LC175">        <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L176" data-line-number="176"></td>
        <td id="LC176">    }</td>
      </tr>
      <tr>
        <td id="L177" data-line-number="177"></td>
        <td id="LC177">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L178" data-line-number="178"></td>
        <td id="LC178">    {</td>
      </tr>
      <tr>
        <td id="L179" data-line-number="179"></td>
        <td id="LC179">        <span>return</span> <span>GetMethod</span>((CORINFO_METHOD_HANDLE)((<span>size_t</span>) context &amp; ~CORINFO_CONTEXTFLAGS_MASK));</td>
      </tr>
      <tr>
        <td id="L180" data-line-number="180"></td>
        <td id="LC180">    }</td>
      </tr>
      <tr>
        <td id="L181" data-line-number="181"></td>
        <td id="LC181">}</td>
      </tr>
      <tr>
        <td id="L182" data-line-number="182"></td>
        <td id="LC182">
</td>
      </tr>
      <tr>
        <td id="L183" data-line-number="183"></td>
        <td id="LC183"><span>static</span> TypeHandle <span>GetTypeFromContext</span>(CORINFO_CONTEXT_HANDLE context)</td>
      </tr>
      <tr>
        <td id="L184" data-line-number="184"></td>
        <td id="LC184">{</td>
      </tr>
      <tr>
        <td id="L185" data-line-number="185"></td>
        <td id="LC185">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L186" data-line-number="186"></td>
        <td id="LC186">    <span>if</span> (((<span>size_t</span>) context &amp; CORINFO_CONTEXTFLAGS_MASK) == CORINFO_CONTEXTFLAGS_CLASS)</td>
      </tr>
      <tr>
        <td id="L187" data-line-number="187"></td>
        <td id="LC187">    {</td>
      </tr>
      <tr>
        <td id="L188" data-line-number="188"></td>
        <td id="LC188">        <span>return</span> <span>TypeHandle</span>((CORINFO_CLASS_HANDLE) ((<span>size_t</span>) context &amp; ~CORINFO_CONTEXTFLAGS_MASK));</td>
      </tr>
      <tr>
        <td id="L189" data-line-number="189"></td>
        <td id="LC189">    }</td>
      </tr>
      <tr>
        <td id="L190" data-line-number="190"></td>
        <td id="LC190">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L191" data-line-number="191"></td>
        <td id="LC191">    {</td>
      </tr>
      <tr>
        <td id="L192" data-line-number="192"></td>
        <td id="LC192">        MethodTable * pMT = <span>GetMethodFromContext</span>(context)-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L193" data-line-number="193"></td>
        <td id="LC193">        <span>return</span> <span>TypeHandle</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L194" data-line-number="194"></td>
        <td id="LC194">    }</td>
      </tr>
      <tr>
        <td id="L195" data-line-number="195"></td>
        <td id="LC195">}</td>
      </tr>
      <tr>
        <td id="L196" data-line-number="196"></td>
        <td id="LC196">
</td>
      </tr>
      <tr>
        <td id="L197" data-line-number="197"></td>
        <td id="LC197"><span><span>//</span> Initialize from a context parameter passed to the JIT and back.  This is a parameter</span></td>
      </tr>
      <tr>
        <td id="L198" data-line-number="198"></td>
        <td id="LC198"><span><span>//</span> that indicates which method is being jitted.</span></td>
      </tr>
      <tr>
        <td id="L199" data-line-number="199"></td>
        <td id="LC199">
</td>
      </tr>
      <tr>
        <td id="L200" data-line-number="200"></td>
        <td id="LC200"><span>inline</span> <span>static</span> <span>void</span> <span>GetTypeContext</span>(CORINFO_CONTEXT_HANDLE context, SigTypeContext *pTypeContext)</td>
      </tr>
      <tr>
        <td id="L201" data-line-number="201"></td>
        <td id="LC201">{</td>
      </tr>
      <tr>
        <td id="L202" data-line-number="202"></td>
        <td id="LC202">    CONTRACTL</td>
      </tr>
      <tr>
        <td id="L203" data-line-number="203"></td>
        <td id="LC203">    {</td>
      </tr>
      <tr>
        <td id="L204" data-line-number="204"></td>
        <td id="LC204">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L205" data-line-number="205"></td>
        <td id="LC205">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L206" data-line-number="206"></td>
        <td id="LC206">        MODE_ANY;</td>
      </tr>
      <tr>
        <td id="L207" data-line-number="207"></td>
        <td id="LC207">        <span>PRECONDITION</span>(context != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L208" data-line-number="208"></td>
        <td id="LC208">    }</td>
      </tr>
      <tr>
        <td id="L209" data-line-number="209"></td>
        <td id="LC209">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L210" data-line-number="210"></td>
        <td id="LC210">    <span>if</span> (<span>GetMethodFromContext</span>(context))</td>
      </tr>
      <tr>
        <td id="L211" data-line-number="211"></td>
        <td id="LC211">    {</td>
      </tr>
      <tr>
        <td id="L212" data-line-number="212"></td>
        <td id="LC212">        <span>SigTypeContext::InitTypeContext</span>(<span>GetMethodFromContext</span>(context), pTypeContext);</td>
      </tr>
      <tr>
        <td id="L213" data-line-number="213"></td>
        <td id="LC213">    }</td>
      </tr>
      <tr>
        <td id="L214" data-line-number="214"></td>
        <td id="LC214">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L215" data-line-number="215"></td>
        <td id="LC215">    {</td>
      </tr>
      <tr>
        <td id="L216" data-line-number="216"></td>
        <td id="LC216">        <span>SigTypeContext::InitTypeContext</span>(<span>GetTypeFromContext</span>(context), pTypeContext);</td>
      </tr>
      <tr>
        <td id="L217" data-line-number="217"></td>
        <td id="LC217">    }</td>
      </tr>
      <tr>
        <td id="L218" data-line-number="218"></td>
        <td id="LC218">}</td>
      </tr>
      <tr>
        <td id="L219" data-line-number="219"></td>
        <td id="LC219">
</td>
      </tr>
      <tr>
        <td id="L220" data-line-number="220"></td>
        <td id="LC220"><span>static</span> BOOL <span>ContextIsShared</span>(CORINFO_CONTEXT_HANDLE context)</td>
      </tr>
      <tr>
        <td id="L221" data-line-number="221"></td>
        <td id="LC221">{</td>
      </tr>
      <tr>
        <td id="L222" data-line-number="222"></td>
        <td id="LC222">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L223" data-line-number="223"></td>
        <td id="LC223">    MethodDesc *pContextMD = <span>GetMethodFromContext</span>(context);</td>
      </tr>
      <tr>
        <td id="L224" data-line-number="224"></td>
        <td id="LC224">    <span>if</span> (pContextMD != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L225" data-line-number="225"></td>
        <td id="LC225">    {</td>
      </tr>
      <tr>
        <td id="L226" data-line-number="226"></td>
        <td id="LC226">        <span>return</span> pContextMD-&gt;<span>IsSharedByGenericInstantiations</span>();</td>
      </tr>
      <tr>
        <td id="L227" data-line-number="227"></td>
        <td id="LC227">    }</td>
      </tr>
      <tr>
        <td id="L228" data-line-number="228"></td>
        <td id="LC228">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L229" data-line-number="229"></td>
        <td id="LC229">    {</td>
      </tr>
      <tr>
        <td id="L230" data-line-number="230"></td>
        <td id="LC230">        <span><span>//</span> Type handle contexts are non-shared and are used for inlining of</span></td>
      </tr>
      <tr>
        <td id="L231" data-line-number="231"></td>
        <td id="LC231">        <span><span>//</span> non-generic methods in generic classes</span></td>
      </tr>
      <tr>
        <td id="L232" data-line-number="232"></td>
        <td id="LC232">        <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L233" data-line-number="233"></td>
        <td id="LC233">    }</td>
      </tr>
      <tr>
        <td id="L234" data-line-number="234"></td>
        <td id="LC234">}</td>
      </tr>
      <tr>
        <td id="L235" data-line-number="235"></td>
        <td id="LC235">
</td>
      </tr>
      <tr>
        <td id="L236" data-line-number="236"></td>
        <td id="LC236"><span><span>//</span> Returns true if context is providing any generic variables</span></td>
      </tr>
      <tr>
        <td id="L237" data-line-number="237"></td>
        <td id="LC237"><span>static</span> BOOL <span>ContextIsInstantiated</span>(CORINFO_CONTEXT_HANDLE context)</td>
      </tr>
      <tr>
        <td id="L238" data-line-number="238"></td>
        <td id="LC238">{</td>
      </tr>
      <tr>
        <td id="L239" data-line-number="239"></td>
        <td id="LC239">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L240" data-line-number="240"></td>
        <td id="LC240">    <span>if</span> (<span>GetMethodFromContext</span>(context))</td>
      </tr>
      <tr>
        <td id="L241" data-line-number="241"></td>
        <td id="LC241">    {</td>
      </tr>
      <tr>
        <td id="L242" data-line-number="242"></td>
        <td id="LC242">        <span>return</span> <span>GetMethodFromContext</span>(context)-&gt;<span>HasClassOrMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L243" data-line-number="243"></td>
        <td id="LC243">    }</td>
      </tr>
      <tr>
        <td id="L244" data-line-number="244"></td>
        <td id="LC244">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L245" data-line-number="245"></td>
        <td id="LC245">    {</td>
      </tr>
      <tr>
        <td id="L246" data-line-number="246"></td>
        <td id="LC246">        <span>return</span> <span>GetTypeFromContext</span>(context).<span>HasInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L247" data-line-number="247"></td>
        <td id="LC247">    }</td>
      </tr>
      <tr>
        <td id="L248" data-line-number="248"></td>
        <td id="LC248">}</td>
      </tr>
      <tr>
        <td id="L249" data-line-number="249"></td>
        <td id="LC249">
</td>
      </tr>
      <tr>
        <td id="L250" data-line-number="250"></td>
        <td id="LC250"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L251" data-line-number="251"></td>
        <td id="LC251"><span><span>//</span> This normalizes EE type information into the form expected by the JIT.</span></td>
      </tr>
      <tr>
        <td id="L252" data-line-number="252"></td>
        <td id="LC252"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L253" data-line-number="253"></td>
        <td id="LC253"><span><span>//</span> If typeHnd contains exact type information, then *clsRet will contain</span></td>
      </tr>
      <tr>
        <td id="L254" data-line-number="254"></td>
        <td id="LC254"><span><span>//</span> the normalized CORINFO_CLASS_HANDLE information on return.</span></td>
      </tr>
      <tr>
        <td id="L255" data-line-number="255"></td>
        <td id="LC255">
</td>
      </tr>
      <tr>
        <td id="L256" data-line-number="256"></td>
        <td id="LC256"><span><span>//</span> Static</span></td>
      </tr>
      <tr>
        <td id="L257" data-line-number="257"></td>
        <td id="LC257">CorInfoType <span>CEEInfo::asCorInfoType</span>(CorElementType eeType,</td>
      </tr>
      <tr>
        <td id="L258" data-line-number="258"></td>
        <td id="LC258">                                   TypeHandle typeHnd, <span><span>/*</span> optional in <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L259" data-line-number="259"></td>
        <td id="LC259">                                   CORINFO_CLASS_HANDLE *clsRet<span><span>/*</span> optional out <span>*/</span></span> ) {</td>
      </tr>
      <tr>
        <td id="L260" data-line-number="260"></td>
        <td id="LC260">    <span>CONTRACT</span>(CorInfoType) {</td>
      </tr>
      <tr>
        <td id="L261" data-line-number="261"></td>
        <td id="LC261">        THROWS;</td>
      </tr>
      <tr>
        <td id="L262" data-line-number="262"></td>
        <td id="LC262">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L263" data-line-number="263"></td>
        <td id="LC263">        <span>PRECONDITION</span>((<span>CorTypeInfo::IsGenericVariable</span>(eeType)) ==</td>
      </tr>
      <tr>
        <td id="L264" data-line-number="264"></td>
        <td id="LC264">                     (!typeHnd.<span>IsNull</span>() &amp;&amp; typeHnd.<span>IsGenericVariable</span>()));</td>
      </tr>
      <tr>
        <td id="L265" data-line-number="265"></td>
        <td id="LC265">        <span>PRECONDITION</span>(eeType != ELEMENT_TYPE_GENERICINST);</td>
      </tr>
      <tr>
        <td id="L266" data-line-number="266"></td>
        <td id="LC266">    } CONTRACT_END;</td>
      </tr>
      <tr>
        <td id="L267" data-line-number="267"></td>
        <td id="LC267">
</td>
      </tr>
      <tr>
        <td id="L268" data-line-number="268"></td>
        <td id="LC268">    TypeHandle typeHndUpdated = typeHnd;</td>
      </tr>
      <tr>
        <td id="L269" data-line-number="269"></td>
        <td id="LC269">
</td>
      </tr>
      <tr>
        <td id="L270" data-line-number="270"></td>
        <td id="LC270">    <span>if</span> (!typeHnd.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L271" data-line-number="271"></td>
        <td id="LC271">    {</td>
      </tr>
      <tr>
        <td id="L272" data-line-number="272"></td>
        <td id="LC272">        CorElementType normType = typeHnd.<span>GetInternalCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L273" data-line-number="273"></td>
        <td id="LC273">        <span><span>//</span> If we have a type handle, then it has the better type</span></td>
      </tr>
      <tr>
        <td id="L274" data-line-number="274"></td>
        <td id="LC274">        <span><span>//</span> in some cases</span></td>
      </tr>
      <tr>
        <td id="L275" data-line-number="275"></td>
        <td id="LC275">        <span>if</span> (eeType == ELEMENT_TYPE_VALUETYPE &amp;&amp; !<span>CorTypeInfo::IsObjRef</span>(normType))</td>
      </tr>
      <tr>
        <td id="L276" data-line-number="276"></td>
        <td id="LC276">            eeType = normType;</td>
      </tr>
      <tr>
        <td id="L277" data-line-number="277"></td>
        <td id="LC277">
</td>
      </tr>
      <tr>
        <td id="L278" data-line-number="278"></td>
        <td id="LC278">        <span><span>//</span> Zap the typeHnd when the type _really_ is a primitive</span></td>
      </tr>
      <tr>
        <td id="L279" data-line-number="279"></td>
        <td id="LC279">        <span><span>//</span> as far as verification is concerned. Returning a null class</span></td>
      </tr>
      <tr>
        <td id="L280" data-line-number="280"></td>
        <td id="LC280">        <span><span>//</span> handle means it is is a primitive.</span></td>
      </tr>
      <tr>
        <td id="L281" data-line-number="281"></td>
        <td id="LC281">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L282" data-line-number="282"></td>
        <td id="LC282">        <span><span>//</span> Enums are exactly like primitives, even from a verification standpoint,</span></td>
      </tr>
      <tr>
        <td id="L283" data-line-number="283"></td>
        <td id="LC283">        <span><span>//</span> so we zap the type handle in this case.</span></td>
      </tr>
      <tr>
        <td id="L284" data-line-number="284"></td>
        <td id="LC284">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L285" data-line-number="285"></td>
        <td id="LC285">        <span><span>//</span> However RuntimeTypeHandle etc. are reported as E_T_INT (or something like that)</span></td>
      </tr>
      <tr>
        <td id="L286" data-line-number="286"></td>
        <td id="LC286">        <span><span>//</span> but don't count as primitives as far as verification is concerned...</span></td>
      </tr>
      <tr>
        <td id="L287" data-line-number="287"></td>
        <td id="LC287">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L288" data-line-number="288"></td>
        <td id="LC288">        <span><span>//</span> To make things stranger, TypedReference returns true for "IsTruePrimitive".</span></td>
      </tr>
      <tr>
        <td id="L289" data-line-number="289"></td>
        <td id="LC289">        <span><span>//</span> However the JIT likes us to report the type handle in that case.</span></td>
      </tr>
      <tr>
        <td id="L290" data-line-number="290"></td>
        <td id="LC290">        <span>if</span> (!typeHnd.<span>IsTypeDesc</span>() &amp;&amp; (</td>
      </tr>
      <tr>
        <td id="L291" data-line-number="291"></td>
        <td id="LC291">                (typeHnd.<span>AsMethodTable</span>()-&gt;<span>IsTruePrimitive</span>() &amp;&amp; typeHnd != <span>TypeHandle</span>(g_TypedReferenceMT))</td>
      </tr>
      <tr>
        <td id="L292" data-line-number="292"></td>
        <td id="LC292">                    || typeHnd.<span>AsMethodTable</span>()-&gt;<span>IsEnum</span>()) )</td>
      </tr>
      <tr>
        <td id="L293" data-line-number="293"></td>
        <td id="LC293">        {</td>
      </tr>
      <tr>
        <td id="L294" data-line-number="294"></td>
        <td id="LC294">            typeHndUpdated = <span>TypeHandle</span>();</td>
      </tr>
      <tr>
        <td id="L295" data-line-number="295"></td>
        <td id="LC295">        }</td>
      </tr>
      <tr>
        <td id="L296" data-line-number="296"></td>
        <td id="LC296">
</td>
      </tr>
      <tr>
        <td id="L297" data-line-number="297"></td>
        <td id="LC297">    }</td>
      </tr>
      <tr>
        <td id="L298" data-line-number="298"></td>
        <td id="LC298">
</td>
      </tr>
      <tr>
        <td id="L299" data-line-number="299"></td>
        <td id="LC299">    <span>static</span> <span>const</span> BYTE map[] = {</td>
      </tr>
      <tr>
        <td id="L300" data-line-number="300"></td>
        <td id="LC300">        CORINFO_TYPE_UNDEF,</td>
      </tr>
      <tr>
        <td id="L301" data-line-number="301"></td>
        <td id="LC301">        CORINFO_TYPE_VOID,</td>
      </tr>
      <tr>
        <td id="L302" data-line-number="302"></td>
        <td id="LC302">        CORINFO_TYPE_BOOL,</td>
      </tr>
      <tr>
        <td id="L303" data-line-number="303"></td>
        <td id="LC303">        CORINFO_TYPE_CHAR,</td>
      </tr>
      <tr>
        <td id="L304" data-line-number="304"></td>
        <td id="LC304">        CORINFO_TYPE_BYTE,</td>
      </tr>
      <tr>
        <td id="L305" data-line-number="305"></td>
        <td id="LC305">        CORINFO_TYPE_UBYTE,</td>
      </tr>
      <tr>
        <td id="L306" data-line-number="306"></td>
        <td id="LC306">        CORINFO_TYPE_SHORT,</td>
      </tr>
      <tr>
        <td id="L307" data-line-number="307"></td>
        <td id="LC307">        CORINFO_TYPE_USHORT,</td>
      </tr>
      <tr>
        <td id="L308" data-line-number="308"></td>
        <td id="LC308">        CORINFO_TYPE_INT,</td>
      </tr>
      <tr>
        <td id="L309" data-line-number="309"></td>
        <td id="LC309">        CORINFO_TYPE_UINT,</td>
      </tr>
      <tr>
        <td id="L310" data-line-number="310"></td>
        <td id="LC310">        CORINFO_TYPE_LONG,</td>
      </tr>
      <tr>
        <td id="L311" data-line-number="311"></td>
        <td id="LC311">        CORINFO_TYPE_ULONG,</td>
      </tr>
      <tr>
        <td id="L312" data-line-number="312"></td>
        <td id="LC312">        CORINFO_TYPE_FLOAT,</td>
      </tr>
      <tr>
        <td id="L313" data-line-number="313"></td>
        <td id="LC313">        CORINFO_TYPE_DOUBLE,</td>
      </tr>
      <tr>
        <td id="L314" data-line-number="314"></td>
        <td id="LC314">        CORINFO_TYPE_STRING,</td>
      </tr>
      <tr>
        <td id="L315" data-line-number="315"></td>
        <td id="LC315">        CORINFO_TYPE_PTR,            <span><span>//</span> PTR</span></td>
      </tr>
      <tr>
        <td id="L316" data-line-number="316"></td>
        <td id="LC316">        CORINFO_TYPE_BYREF,</td>
      </tr>
      <tr>
        <td id="L317" data-line-number="317"></td>
        <td id="LC317">        CORINFO_TYPE_VALUECLASS,</td>
      </tr>
      <tr>
        <td id="L318" data-line-number="318"></td>
        <td id="LC318">        CORINFO_TYPE_CLASS,</td>
      </tr>
      <tr>
        <td id="L319" data-line-number="319"></td>
        <td id="LC319">        CORINFO_TYPE_VAR,            <span><span>//</span> VAR (type variable)</span></td>
      </tr>
      <tr>
        <td id="L320" data-line-number="320"></td>
        <td id="LC320">        CORINFO_TYPE_CLASS,          <span><span>//</span> ARRAY</span></td>
      </tr>
      <tr>
        <td id="L321" data-line-number="321"></td>
        <td id="LC321">        CORINFO_TYPE_CLASS,          <span><span>//</span> WITH</span></td>
      </tr>
      <tr>
        <td id="L322" data-line-number="322"></td>
        <td id="LC322">        CORINFO_TYPE_REFANY,</td>
      </tr>
      <tr>
        <td id="L323" data-line-number="323"></td>
        <td id="LC323">        CORINFO_TYPE_UNDEF,          <span><span>//</span> VALUEARRAY_UNSUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L324" data-line-number="324"></td>
        <td id="LC324">        CORINFO_TYPE_NATIVEINT,      <span><span>//</span> I</span></td>
      </tr>
      <tr>
        <td id="L325" data-line-number="325"></td>
        <td id="LC325">        CORINFO_TYPE_NATIVEUINT,     <span><span>//</span> U</span></td>
      </tr>
      <tr>
        <td id="L326" data-line-number="326"></td>
        <td id="LC326">        CORINFO_TYPE_UNDEF,          <span><span>//</span> R_UNSUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L327" data-line-number="327"></td>
        <td id="LC327">
</td>
      </tr>
      <tr>
        <td id="L328" data-line-number="328"></td>
        <td id="LC328">        <span><span>//</span> put the correct type when we know our implementation</span></td>
      </tr>
      <tr>
        <td id="L329" data-line-number="329"></td>
        <td id="LC329">        CORINFO_TYPE_PTR,            <span><span>//</span> FNPTR</span></td>
      </tr>
      <tr>
        <td id="L330" data-line-number="330"></td>
        <td id="LC330">        CORINFO_TYPE_CLASS,          <span><span>//</span> OBJECT</span></td>
      </tr>
      <tr>
        <td id="L331" data-line-number="331"></td>
        <td id="LC331">        CORINFO_TYPE_CLASS,          <span><span>//</span> SZARRAY</span></td>
      </tr>
      <tr>
        <td id="L332" data-line-number="332"></td>
        <td id="LC332">        CORINFO_TYPE_VAR,            <span><span>//</span> MVAR</span></td>
      </tr>
      <tr>
        <td id="L333" data-line-number="333"></td>
        <td id="LC333">
</td>
      </tr>
      <tr>
        <td id="L334" data-line-number="334"></td>
        <td id="LC334">        CORINFO_TYPE_UNDEF,          <span><span>//</span> CMOD_REQD</span></td>
      </tr>
      <tr>
        <td id="L335" data-line-number="335"></td>
        <td id="LC335">        CORINFO_TYPE_UNDEF,          <span><span>//</span> CMOD_OPT</span></td>
      </tr>
      <tr>
        <td id="L336" data-line-number="336"></td>
        <td id="LC336">        CORINFO_TYPE_UNDEF,          <span><span>//</span> INTERNAL</span></td>
      </tr>
      <tr>
        <td id="L337" data-line-number="337"></td>
        <td id="LC337">        };</td>
      </tr>
      <tr>
        <td id="L338" data-line-number="338"></td>
        <td id="LC338">
</td>
      </tr>
      <tr>
        <td id="L339" data-line-number="339"></td>
        <td id="LC339">    <span>_ASSERTE</span>(<span>sizeof</span>(map) == ELEMENT_TYPE_MAX);</td>
      </tr>
      <tr>
        <td id="L340" data-line-number="340"></td>
        <td id="LC340">    <span>_ASSERTE</span>(eeType &lt; (CorElementType) <span>sizeof</span>(map));</td>
      </tr>
      <tr>
        <td id="L341" data-line-number="341"></td>
        <td id="LC341">        <span><span>//</span> spot check of the map</span></td>
      </tr>
      <tr>
        <td id="L342" data-line-number="342"></td>
        <td id="LC342">    <span>_ASSERTE</span>((CorInfoType) map[ELEMENT_TYPE_I4] == CORINFO_TYPE_INT);</td>
      </tr>
      <tr>
        <td id="L343" data-line-number="343"></td>
        <td id="LC343">    <span>_ASSERTE</span>((CorInfoType) map[ELEMENT_TYPE_PTR] == CORINFO_TYPE_PTR);</td>
      </tr>
      <tr>
        <td id="L344" data-line-number="344"></td>
        <td id="LC344">    <span>_ASSERTE</span>((CorInfoType) map[ELEMENT_TYPE_TYPEDBYREF] == CORINFO_TYPE_REFANY);</td>
      </tr>
      <tr>
        <td id="L345" data-line-number="345"></td>
        <td id="LC345">
</td>
      </tr>
      <tr>
        <td id="L346" data-line-number="346"></td>
        <td id="LC346">    CorInfoType res = ((<span>unsigned</span>)eeType &lt; ELEMENT_TYPE_MAX) ? ((CorInfoType) map[(<span>unsigned</span>)eeType]) : CORINFO_TYPE_UNDEF;</td>
      </tr>
      <tr>
        <td id="L347" data-line-number="347"></td>
        <td id="LC347">
</td>
      </tr>
      <tr>
        <td id="L348" data-line-number="348"></td>
        <td id="LC348">    <span>if</span> (clsRet)</td>
      </tr>
      <tr>
        <td id="L349" data-line-number="349"></td>
        <td id="LC349">        *clsRet = <span>CORINFO_CLASS_HANDLE</span>(typeHndUpdated.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L350" data-line-number="350"></td>
        <td id="LC350">
</td>
      </tr>
      <tr>
        <td id="L351" data-line-number="351"></td>
        <td id="LC351">    RETURN res;</td>
      </tr>
      <tr>
        <td id="L352" data-line-number="352"></td>
        <td id="LC352">}</td>
      </tr>
      <tr>
        <td id="L353" data-line-number="353"></td>
        <td id="LC353">
</td>
      </tr>
      <tr>
        <td id="L354" data-line-number="354"></td>
        <td id="LC354">
</td>
      </tr>
      <tr>
        <td id="L355" data-line-number="355"></td>
        <td id="LC355"><span>inline</span> <span>static</span> CorInfoType <span>toJitType</span>(TypeHandle typeHnd, CORINFO_CLASS_HANDLE *clsRet = <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L356" data-line-number="356"></td>
        <td id="LC356">{</td>
      </tr>
      <tr>
        <td id="L357" data-line-number="357"></td>
        <td id="LC357">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L358" data-line-number="358"></td>
        <td id="LC358">    <span>return</span> <span>CEEInfo::asCorInfoType</span>(typeHnd.<span>GetInternalCorElementType</span>(), typeHnd, clsRet);</td>
      </tr>
      <tr>
        <td id="L359" data-line-number="359"></td>
        <td id="LC359">}</td>
      </tr>
      <tr>
        <td id="L360" data-line-number="360"></td>
        <td id="LC360">
</td>
      </tr>
      <tr>
        <td id="L361" data-line-number="361"></td>
        <td id="LC361"><span>void</span> <span>CheckForEquivalenceAndLoadTypeBeforeCodeIsRun</span>(Module *pModule, mdToken token, Module *pDefModule, mdToken defToken, <span>const</span> SigParser *ptr, SigTypeContext *pTypeContext, <span>void</span> *pData)</td>
      </tr>
      <tr>
        <td id="L362" data-line-number="362"></td>
        <td id="LC362">{</td>
      </tr>
      <tr>
        <td id="L363" data-line-number="363"></td>
        <td id="LC363">    CONTRACTL</td>
      </tr>
      <tr>
        <td id="L364" data-line-number="364"></td>
        <td id="LC364">    {</td>
      </tr>
      <tr>
        <td id="L365" data-line-number="365"></td>
        <td id="LC365">        THROWS;</td>
      </tr>
      <tr>
        <td id="L366" data-line-number="366"></td>
        <td id="LC366">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L367" data-line-number="367"></td>
        <td id="LC367">    }</td>
      </tr>
      <tr>
        <td id="L368" data-line-number="368"></td>
        <td id="LC368">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L369" data-line-number="369"></td>
        <td id="LC369">
</td>
      </tr>
      <tr>
        <td id="L370" data-line-number="370"></td>
        <td id="LC370">    <span>if</span> (<span>IsTypeDefEquivalent</span>(defToken, pDefModule))</td>
      </tr>
      <tr>
        <td id="L371" data-line-number="371"></td>
        <td id="LC371">    {</td>
      </tr>
      <tr>
        <td id="L372" data-line-number="372"></td>
        <td id="LC372">        SigPointer <span>sigPtr</span>(*ptr);</td>
      </tr>
      <tr>
        <td id="L373" data-line-number="373"></td>
        <td id="LC373">        TypeHandle th = sigPtr.<span>GetTypeHandleThrowing</span>(pModule, pTypeContext);</td>
      </tr>
      <tr>
        <td id="L374" data-line-number="374"></td>
        <td id="LC374">        ((ICorDynamicInfo *)pData)-&gt;<span>classMustBeLoadedBeforeCodeIsRun</span>(<span>CORINFO_CLASS_HANDLE</span>(th.<span>AsPtr</span>()));</td>
      </tr>
      <tr>
        <td id="L375" data-line-number="375"></td>
        <td id="LC375">    }</td>
      </tr>
      <tr>
        <td id="L376" data-line-number="376"></td>
        <td id="LC376">}</td>
      </tr>
      <tr>
        <td id="L377" data-line-number="377"></td>
        <td id="LC377">
</td>
      </tr>
      <tr>
        <td id="L378" data-line-number="378"></td>
        <td id="LC378"><span>inline</span> <span>static</span> <span>void</span> <span>TypeEquivalenceFixupSpecificationHelper</span>(ICorDynamicInfo * pCorInfo, MethodDesc *pMD)</td>
      </tr>
      <tr>
        <td id="L379" data-line-number="379"></td>
        <td id="LC379">{</td>
      </tr>
      <tr>
        <td id="L380" data-line-number="380"></td>
        <td id="LC380">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L381" data-line-number="381"></td>
        <td id="LC381">
</td>
      </tr>
      <tr>
        <td id="L382" data-line-number="382"></td>
        <td id="LC382">    <span><span>//</span> A fixup is necessary to ensure that the parameters to the method are loaded before the method</span></td>
      </tr>
      <tr>
        <td id="L383" data-line-number="383"></td>
        <td id="LC383">    <span><span>//</span> is called. In these cases we will not perform the appropriate loading when we load parameter</span></td>
      </tr>
      <tr>
        <td id="L384" data-line-number="384"></td>
        <td id="LC384">    <span><span>//</span> types because with type equivalence, the parameter types at the call site do not necessarily</span></td>
      </tr>
      <tr>
        <td id="L385" data-line-number="385"></td>
        <td id="LC385">    <span><span>//</span> match that those in the actual function. (They must be equivalent, but not necessarily the same.)</span></td>
      </tr>
      <tr>
        <td id="L386" data-line-number="386"></td>
        <td id="LC386">    <span><span>//</span> In non-ngen scenarios this code here will force the types to be loaded directly by the call to</span></td>
      </tr>
      <tr>
        <td id="L387" data-line-number="387"></td>
        <td id="LC387">    <span><span>//</span> HasTypeEquivalentStructParameters.</span></td>
      </tr>
      <tr>
        <td id="L388" data-line-number="388"></td>
        <td id="LC388">    <span>if</span> (!pMD-&gt;<span>IsVirtual</span>())</td>
      </tr>
      <tr>
        <td id="L389" data-line-number="389"></td>
        <td id="LC389">    {</td>
      </tr>
      <tr>
        <td id="L390" data-line-number="390"></td>
        <td id="LC390">        <span>if</span> (pMD-&gt;<span>HasTypeEquivalentStructParameters</span>())</td>
      </tr>
      <tr>
        <td id="L391" data-line-number="391"></td>
        <td id="LC391">        {</td>
      </tr>
      <tr>
        <td id="L392" data-line-number="392"></td>
        <td id="LC392">            <span>if</span> (<span>IsCompilationProcess</span>())</td>
      </tr>
      <tr>
        <td id="L393" data-line-number="393"></td>
        <td id="LC393">                pMD-&gt;<span>WalkValueTypeParameters</span>(pMD-&gt;<span>GetMethodTable</span>(), CheckForEquivalenceAndLoadTypeBeforeCodeIsRun, pCorInfo);</td>
      </tr>
      <tr>
        <td id="L394" data-line-number="394"></td>
        <td id="LC394">        }</td>
      </tr>
      <tr>
        <td id="L395" data-line-number="395"></td>
        <td id="LC395">    }</td>
      </tr>
      <tr>
        <td id="L396" data-line-number="396"></td>
        <td id="LC396">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L397" data-line-number="397"></td>
        <td id="LC397">    {</td>
      </tr>
      <tr>
        <td id="L398" data-line-number="398"></td>
        <td id="LC398">        <span>if</span> (pMD-&gt;<span>GetMethodTable</span>()-&gt;<span>DependsOnEquivalentOrForwardedStructs</span>())</td>
      </tr>
      <tr>
        <td id="L399" data-line-number="399"></td>
        <td id="LC399">        {</td>
      </tr>
      <tr>
        <td id="L400" data-line-number="400"></td>
        <td id="LC400">            <span>if</span> (pMD-&gt;<span>HasTypeEquivalentStructParameters</span>())</td>
      </tr>
      <tr>
        <td id="L401" data-line-number="401"></td>
        <td id="LC401">                pCorInfo-&gt;<span>classMustBeLoadedBeforeCodeIsRun</span>((CORINFO_CLASS_HANDLE)pMD-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L402" data-line-number="402"></td>
        <td id="LC402">        }</td>
      </tr>
      <tr>
        <td id="L403" data-line-number="403"></td>
        <td id="LC403">    }</td>
      </tr>
      <tr>
        <td id="L404" data-line-number="404"></td>
        <td id="LC404">}</td>
      </tr>
      <tr>
        <td id="L405" data-line-number="405"></td>
        <td id="LC405">
</td>
      </tr>
      <tr>
        <td id="L406" data-line-number="406"></td>
        <td id="LC406"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L407" data-line-number="407"></td>
        <td id="LC407"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L408" data-line-number="408"></td>
        <td id="LC408"><span><span>//</span>@GENERICS:</span></td>
      </tr>
      <tr>
        <td id="L409" data-line-number="409"></td>
        <td id="LC409"><span><span>//</span> The method handle is used to instantiate method and class type parameters</span></td>
      </tr>
      <tr>
        <td id="L410" data-line-number="410"></td>
        <td id="LC410"><span><span>//</span> It's also used to determine whether an extra dictionary parameter is required</span></td>
      </tr>
      <tr>
        <td id="L411" data-line-number="411"></td>
        <td id="LC411"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L412" data-line-number="412"></td>
        <td id="LC412"><span><span>//</span> sig          - Input metadata signature</span></td>
      </tr>
      <tr>
        <td id="L413" data-line-number="413"></td>
        <td id="LC413"><span><span>//</span> scopeHnd     - The signature is to be interpreted in the context of this scope (module)</span></td>
      </tr>
      <tr>
        <td id="L414" data-line-number="414"></td>
        <td id="LC414"><span><span>//</span> token        - Metadata token used to refer to the signature (may be mdTokenNil for dynamic methods)</span></td>
      </tr>
      <tr>
        <td id="L415" data-line-number="415"></td>
        <td id="LC415"><span><span>//</span> sigRet       - Resulting output signature in a format that is understood by native compilers</span></td>
      </tr>
      <tr>
        <td id="L416" data-line-number="416"></td>
        <td id="LC416"><span><span>//</span> pContextMD   - The method with any instantiation information (may be NULL)</span></td>
      </tr>
      <tr>
        <td id="L417" data-line-number="417"></td>
        <td id="LC417"><span><span>//</span> localSig     - Is it a local variables declaration, or a method signature (with return type, etc).</span></td>
      </tr>
      <tr>
        <td id="L418" data-line-number="418"></td>
        <td id="LC418"><span><span>//</span> contextType  - The type with any instantiaton information</span></td>
      </tr>
      <tr>
        <td id="L419" data-line-number="419"></td>
        <td id="LC419"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L420" data-line-number="420"></td>
        <td id="LC420"><span><span>//</span>static</span></td>
      </tr>
      <tr>
        <td id="L421" data-line-number="421"></td>
        <td id="LC421"><span>void</span></td>
      </tr>
      <tr>
        <td id="L422" data-line-number="422"></td>
        <td id="LC422"><span>CEEInfo::ConvToJitSig</span>(</td>
      </tr>
      <tr>
        <td id="L423" data-line-number="423"></td>
        <td id="LC423">    PCCOR_SIGNATURE       pSig,</td>
      </tr>
      <tr>
        <td id="L424" data-line-number="424"></td>
        <td id="LC424">    DWORD                 cbSig,</td>
      </tr>
      <tr>
        <td id="L425" data-line-number="425"></td>
        <td id="LC425">    CORINFO_MODULE_HANDLE scopeHnd,</td>
      </tr>
      <tr>
        <td id="L426" data-line-number="426"></td>
        <td id="LC426">    mdToken               token,</td>
      </tr>
      <tr>
        <td id="L427" data-line-number="427"></td>
        <td id="LC427">    CORINFO_SIG_INFO *    sigRet,</td>
      </tr>
      <tr>
        <td id="L428" data-line-number="428"></td>
        <td id="LC428">    MethodDesc *          pContextMD,</td>
      </tr>
      <tr>
        <td id="L429" data-line-number="429"></td>
        <td id="LC429">    <span>bool</span>                  localSig,</td>
      </tr>
      <tr>
        <td id="L430" data-line-number="430"></td>
        <td id="LC430">    TypeHandle            contextType)</td>
      </tr>
      <tr>
        <td id="L431" data-line-number="431"></td>
        <td id="LC431">{</td>
      </tr>
      <tr>
        <td id="L432" data-line-number="432"></td>
        <td id="LC432">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L433" data-line-number="433"></td>
        <td id="LC433">        THROWS;</td>
      </tr>
      <tr>
        <td id="L434" data-line-number="434"></td>
        <td id="LC434">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L435" data-line-number="435"></td>
        <td id="LC435">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L436" data-line-number="436"></td>
        <td id="LC436">
</td>
      </tr>
      <tr>
        <td id="L437" data-line-number="437"></td>
        <td id="LC437">    SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L438" data-line-number="438"></td>
        <td id="LC438">
</td>
      </tr>
      <tr>
        <td id="L439" data-line-number="439"></td>
        <td id="LC439">    <span>uint32_t</span> sigRetFlags = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L440" data-line-number="440"></td>
        <td id="LC440">    <span>if</span> (pContextMD)</td>
      </tr>
      <tr>
        <td id="L441" data-line-number="441"></td>
        <td id="LC441">    {</td>
      </tr>
      <tr>
        <td id="L442" data-line-number="442"></td>
        <td id="LC442">        <span>SigTypeContext::InitTypeContext</span>(pContextMD, contextType, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L443" data-line-number="443"></td>
        <td id="LC443">        <span>if</span> (pContextMD-&gt;<span>ShouldSuppressGCTransition</span>())</td>
      </tr>
      <tr>
        <td id="L444" data-line-number="444"></td>
        <td id="LC444">            sigRetFlags |= CORINFO_SIGFLAG_SUPPRESS_GC_TRANSITION;</td>
      </tr>
      <tr>
        <td id="L445" data-line-number="445"></td>
        <td id="LC445">    }</td>
      </tr>
      <tr>
        <td id="L446" data-line-number="446"></td>
        <td id="LC446">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L447" data-line-number="447"></td>
        <td id="LC447">    {</td>
      </tr>
      <tr>
        <td id="L448" data-line-number="448"></td>
        <td id="LC448">        <span>SigTypeContext::InitTypeContext</span>(contextType, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L449" data-line-number="449"></td>
        <td id="LC449">    }</td>
      </tr>
      <tr>
        <td id="L450" data-line-number="450"></td>
        <td id="LC450">
</td>
      </tr>
      <tr>
        <td id="L451" data-line-number="451"></td>
        <td id="LC451">    <span>_ASSERTE</span>(CORINFO_CALLCONV_DEFAULT == (CorInfoCallConv) IMAGE_CEE_CS_CALLCONV_DEFAULT);</td>
      </tr>
      <tr>
        <td id="L452" data-line-number="452"></td>
        <td id="LC452">    <span>_ASSERTE</span>(CORINFO_CALLCONV_VARARG == (CorInfoCallConv) IMAGE_CEE_CS_CALLCONV_VARARG);</td>
      </tr>
      <tr>
        <td id="L453" data-line-number="453"></td>
        <td id="LC453">    <span>_ASSERTE</span>(CORINFO_CALLCONV_MASK == (CorInfoCallConv) IMAGE_CEE_CS_CALLCONV_MASK);</td>
      </tr>
      <tr>
        <td id="L454" data-line-number="454"></td>
        <td id="LC454">    <span>_ASSERTE</span>(CORINFO_CALLCONV_HASTHIS == (CorInfoCallConv) IMAGE_CEE_CS_CALLCONV_HASTHIS);</td>
      </tr>
      <tr>
        <td id="L455" data-line-number="455"></td>
        <td id="LC455">
</td>
      </tr>
      <tr>
        <td id="L456" data-line-number="456"></td>
        <td id="LC456">    TypeHandle typeHnd = <span>TypeHandle</span>();</td>
      </tr>
      <tr>
        <td id="L457" data-line-number="457"></td>
        <td id="LC457">
</td>
      </tr>
      <tr>
        <td id="L458" data-line-number="458"></td>
        <td id="LC458">    sigRet-&gt;<span>pSig</span> = pSig;</td>
      </tr>
      <tr>
        <td id="L459" data-line-number="459"></td>
        <td id="LC459">    sigRet-&gt;<span>cbSig</span> = cbSig;</td>
      </tr>
      <tr>
        <td id="L460" data-line-number="460"></td>
        <td id="LC460">    sigRet-&gt;<span>retTypeClass</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L461" data-line-number="461"></td>
        <td id="LC461">    sigRet-&gt;<span>retTypeSigClass</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L462" data-line-number="462"></td>
        <td id="LC462">    sigRet-&gt;<span>scope</span> = scopeHnd;</td>
      </tr>
      <tr>
        <td id="L463" data-line-number="463"></td>
        <td id="LC463">    sigRet-&gt;<span>token</span> = token;</td>
      </tr>
      <tr>
        <td id="L464" data-line-number="464"></td>
        <td id="LC464">    sigRet-&gt;<span>sigInst</span>.<span>classInst</span> = (CORINFO_CLASS_HANDLE *) typeContext.<span>m_classInst</span>.<span>GetRawArgs</span>();</td>
      </tr>
      <tr>
        <td id="L465" data-line-number="465"></td>
        <td id="LC465">    sigRet-&gt;<span>sigInst</span>.<span>classInstCount</span> = (<span>unsigned</span>) typeContext.<span>m_classInst</span>.<span>GetNumArgs</span>();</td>
      </tr>
      <tr>
        <td id="L466" data-line-number="466"></td>
        <td id="LC466">    sigRet-&gt;<span>sigInst</span>.<span>methInst</span> = (CORINFO_CLASS_HANDLE *) typeContext.<span>m_methodInst</span>.<span>GetRawArgs</span>();</td>
      </tr>
      <tr>
        <td id="L467" data-line-number="467"></td>
        <td id="LC467">    sigRet-&gt;<span>sigInst</span>.<span>methInstCount</span> = (<span>unsigned</span>) typeContext.<span>m_methodInst</span>.<span>GetNumArgs</span>();</td>
      </tr>
      <tr>
        <td id="L468" data-line-number="468"></td>
        <td id="LC468">
</td>
      </tr>
      <tr>
        <td id="L469" data-line-number="469"></td>
        <td id="LC469">    SigPointer <span>sig</span>(pSig, cbSig);</td>
      </tr>
      <tr>
        <td id="L470" data-line-number="470"></td>
        <td id="LC470">
</td>
      </tr>
      <tr>
        <td id="L471" data-line-number="471"></td>
        <td id="LC471">    <span>if</span> (!localSig)</td>
      </tr>
      <tr>
        <td id="L472" data-line-number="472"></td>
        <td id="LC472">    {</td>
      </tr>
      <tr>
        <td id="L473" data-line-number="473"></td>
        <td id="LC473">        <span><span>//</span> This is a method signature which includes calling convention, return type,</span></td>
      </tr>
      <tr>
        <td id="L474" data-line-number="474"></td>
        <td id="LC474">        <span><span>//</span> arguments, etc</span></td>
      </tr>
      <tr>
        <td id="L475" data-line-number="475"></td>
        <td id="LC475">
</td>
      </tr>
      <tr>
        <td id="L476" data-line-number="476"></td>
        <td id="LC476">        <span>_ASSERTE</span>(!sig.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L477" data-line-number="477"></td>
        <td id="LC477">        Module * module = <span>GetModule</span>(scopeHnd);</td>
      </tr>
      <tr>
        <td id="L478" data-line-number="478"></td>
        <td id="LC478">
</td>
      </tr>
      <tr>
        <td id="L479" data-line-number="479"></td>
        <td id="LC479">        ULONG data;</td>
      </tr>
      <tr>
        <td id="L480" data-line-number="480"></td>
        <td id="LC480">        <span>IfFailThrow</span>(sig.<span>GetCallingConvInfo</span>(&amp;data));</td>
      </tr>
      <tr>
        <td id="L481" data-line-number="481"></td>
        <td id="LC481">        sigRet-&gt;<span>callConv</span> = (CorInfoCallConv) data;</td>
      </tr>
      <tr>
        <td id="L482" data-line-number="482"></td>
        <td id="LC482">
</td>
      </tr>
      <tr>
        <td id="L483" data-line-number="483"></td>
        <td id="LC483">#<span>if</span> defined(TARGET_UNIX) || defined(TARGET_ARM)</td>
      </tr>
      <tr>
        <td id="L484" data-line-number="484"></td>
        <td id="LC484">        <span>if</span> ((<span>isCallConv</span>(sigRet-&gt;<span>callConv</span>, IMAGE_CEE_CS_CALLCONV_VARARG)) ||</td>
      </tr>
      <tr>
        <td id="L485" data-line-number="485"></td>
        <td id="LC485">            (<span>isCallConv</span>(sigRet-&gt;<span>callConv</span>, IMAGE_CEE_CS_CALLCONV_NATIVEVARARG)))</td>
      </tr>
      <tr>
        <td id="L486" data-line-number="486"></td>
        <td id="LC486">        {</td>
      </tr>
      <tr>
        <td id="L487" data-line-number="487"></td>
        <td id="LC487">            <span><span>//</span> This signature corresponds to a method that uses varargs, which are not supported.</span></td>
      </tr>
      <tr>
        <td id="L488" data-line-number="488"></td>
        <td id="LC488">             <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>, IDS_EE_VARARG_NOT_SUPPORTED);</td>
      </tr>
      <tr>
        <td id="L489" data-line-number="489"></td>
        <td id="LC489">        }</td>
      </tr>
      <tr>
        <td id="L490" data-line-number="490"></td>
        <td id="LC490">#<span>endif</span> <span><span>//</span> defined(TARGET_UNIX) || defined(TARGET_ARM)</span></td>
      </tr>
      <tr>
        <td id="L491" data-line-number="491"></td>
        <td id="LC491">
</td>
      </tr>
      <tr>
        <td id="L492" data-line-number="492"></td>
        <td id="LC492">        <span><span>//</span> Skip number of type arguments</span></td>
      </tr>
      <tr>
        <td id="L493" data-line-number="493"></td>
        <td id="LC493">        <span>if</span> (sigRet-&gt;<span>callConv</span> &amp; IMAGE_CEE_CS_CALLCONV_GENERIC)</td>
      </tr>
      <tr>
        <td id="L494" data-line-number="494"></td>
        <td id="LC494">          <span>IfFailThrow</span>(sig.<span>GetData</span>(<span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L495" data-line-number="495"></td>
        <td id="LC495">
</td>
      </tr>
      <tr>
        <td id="L496" data-line-number="496"></td>
        <td id="LC496">        ULONG numArgs;</td>
      </tr>
      <tr>
        <td id="L497" data-line-number="497"></td>
        <td id="LC497">        <span>IfFailThrow</span>(sig.<span>GetData</span>(&amp;numArgs));</td>
      </tr>
      <tr>
        <td id="L498" data-line-number="498"></td>
        <td id="LC498">        <span>if</span> (numArgs != (<span>unsigned</span> <span>short</span>) numArgs)</td>
      </tr>
      <tr>
        <td id="L499" data-line-number="499"></td>
        <td id="LC499">            <span>COMPlusThrowHR</span>(COR_E_INVALIDPROGRAM);</td>
      </tr>
      <tr>
        <td id="L500" data-line-number="500"></td>
        <td id="LC500">
</td>
      </tr>
      <tr>
        <td id="L501" data-line-number="501"></td>
        <td id="LC501">        sigRet-&gt;<span>numArgs</span> = (<span>unsigned</span> <span>short</span>) numArgs;</td>
      </tr>
      <tr>
        <td id="L502" data-line-number="502"></td>
        <td id="LC502">
</td>
      </tr>
      <tr>
        <td id="L503" data-line-number="503"></td>
        <td id="LC503">        CorElementType type = sig.<span>PeekElemTypeClosed</span>(module, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L504" data-line-number="504"></td>
        <td id="LC504">
</td>
      </tr>
      <tr>
        <td id="L505" data-line-number="505"></td>
        <td id="LC505">        <span>if</span> (!<span>CorTypeInfo::IsPrimitiveType</span>(type))</td>
      </tr>
      <tr>
        <td id="L506" data-line-number="506"></td>
        <td id="LC506">        {</td>
      </tr>
      <tr>
        <td id="L507" data-line-number="507"></td>
        <td id="LC507">            typeHnd = sig.<span>GetTypeHandleThrowing</span>(module, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L508" data-line-number="508"></td>
        <td id="LC508">            <span>_ASSERTE</span>(!typeHnd.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L509" data-line-number="509"></td>
        <td id="LC509">
</td>
      </tr>
      <tr>
        <td id="L510" data-line-number="510"></td>
        <td id="LC510">            <span><span>//</span> I believe it doesn't make any diff. if this is</span></td>
      </tr>
      <tr>
        <td id="L511" data-line-number="511"></td>
        <td id="LC511">            <span><span>//</span> GetInternalCorElementType or GetSignatureCorElementType</span></td>
      </tr>
      <tr>
        <td id="L512" data-line-number="512"></td>
        <td id="LC512">            type = typeHnd.<span>GetSignatureCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L513" data-line-number="513"></td>
        <td id="LC513">
</td>
      </tr>
      <tr>
        <td id="L514" data-line-number="514"></td>
        <td id="LC514">        }</td>
      </tr>
      <tr>
        <td id="L515" data-line-number="515"></td>
        <td id="LC515">        sigRet-&gt;<span>retType</span> = <span>CEEInfo::asCorInfoType</span>(type, typeHnd, &amp;sigRet-&gt;<span>retTypeClass</span>);</td>
      </tr>
      <tr>
        <td id="L516" data-line-number="516"></td>
        <td id="LC516">        sigRet-&gt;<span>retTypeSigClass</span> = <span>CORINFO_CLASS_HANDLE</span>(typeHnd.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L517" data-line-number="517"></td>
        <td id="LC517">
</td>
      </tr>
      <tr>
        <td id="L518" data-line-number="518"></td>
        <td id="LC518">        <span>IfFailThrow</span>(sig.<span>SkipExactlyOne</span>());  <span><span>//</span> must to a skip so we skip any class tokens associated with the return type</span></td>
      </tr>
      <tr>
        <td id="L519" data-line-number="519"></td>
        <td id="LC519">        <span>_ASSERTE</span>(sigRet-&gt;<span>retType</span> &lt; CORINFO_TYPE_COUNT);</td>
      </tr>
      <tr>
        <td id="L520" data-line-number="520"></td>
        <td id="LC520">
</td>
      </tr>
      <tr>
        <td id="L521" data-line-number="521"></td>
        <td id="LC521">        sigRet-&gt;<span>args</span> = (CORINFO_ARG_LIST_HANDLE)sig.<span>GetPtr</span>();</td>
      </tr>
      <tr>
        <td id="L522" data-line-number="522"></td>
        <td id="LC522">    }</td>
      </tr>
      <tr>
        <td id="L523" data-line-number="523"></td>
        <td id="LC523">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L524" data-line-number="524"></td>
        <td id="LC524">    {</td>
      </tr>
      <tr>
        <td id="L525" data-line-number="525"></td>
        <td id="LC525">        <span><span>//</span> This is local variables declaration</span></td>
      </tr>
      <tr>
        <td id="L526" data-line-number="526"></td>
        <td id="LC526">        sigRetFlags |= CORINFO_SIGFLAG_IS_LOCAL_SIG;</td>
      </tr>
      <tr>
        <td id="L527" data-line-number="527"></td>
        <td id="LC527">
</td>
      </tr>
      <tr>
        <td id="L528" data-line-number="528"></td>
        <td id="LC528">        sigRet-&gt;<span>callConv</span> = CORINFO_CALLCONV_DEFAULT;</td>
      </tr>
      <tr>
        <td id="L529" data-line-number="529"></td>
        <td id="LC529">        sigRet-&gt;<span>retType</span> = CORINFO_TYPE_VOID;</td>
      </tr>
      <tr>
        <td id="L530" data-line-number="530"></td>
        <td id="LC530">        sigRet-&gt;<span>numArgs</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L531" data-line-number="531"></td>
        <td id="LC531">        <span>if</span> (!sig.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L532" data-line-number="532"></td>
        <td id="LC532">        {</td>
      </tr>
      <tr>
        <td id="L533" data-line-number="533"></td>
        <td id="LC533">            ULONG callConv;</td>
      </tr>
      <tr>
        <td id="L534" data-line-number="534"></td>
        <td id="LC534">            <span>IfFailThrow</span>(sig.<span>GetCallingConvInfo</span>(&amp;callConv));</td>
      </tr>
      <tr>
        <td id="L535" data-line-number="535"></td>
        <td id="LC535">            <span>if</span> (callConv != IMAGE_CEE_CS_CALLCONV_LOCAL_SIG)</td>
      </tr>
      <tr>
        <td id="L536" data-line-number="536"></td>
        <td id="LC536">            {</td>
      </tr>
      <tr>
        <td id="L537" data-line-number="537"></td>
        <td id="LC537">                <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT, BFA_CALLCONV_NOT_LOCAL_SIG);</td>
      </tr>
      <tr>
        <td id="L538" data-line-number="538"></td>
        <td id="LC538">            }</td>
      </tr>
      <tr>
        <td id="L539" data-line-number="539"></td>
        <td id="LC539">
</td>
      </tr>
      <tr>
        <td id="L540" data-line-number="540"></td>
        <td id="LC540">            ULONG numArgs;</td>
      </tr>
      <tr>
        <td id="L541" data-line-number="541"></td>
        <td id="LC541">            <span>IfFailThrow</span>(sig.<span>GetData</span>(&amp;numArgs));</td>
      </tr>
      <tr>
        <td id="L542" data-line-number="542"></td>
        <td id="LC542">
</td>
      </tr>
      <tr>
        <td id="L543" data-line-number="543"></td>
        <td id="LC543">            <span>if</span> (numArgs != (<span>unsigned</span> <span>short</span>) numArgs)</td>
      </tr>
      <tr>
        <td id="L544" data-line-number="544"></td>
        <td id="LC544">                <span>COMPlusThrowHR</span>(COR_E_INVALIDPROGRAM);</td>
      </tr>
      <tr>
        <td id="L545" data-line-number="545"></td>
        <td id="LC545">
</td>
      </tr>
      <tr>
        <td id="L546" data-line-number="546"></td>
        <td id="LC546">            sigRet-&gt;<span>numArgs</span> = (<span>unsigned</span> <span>short</span>) numArgs;</td>
      </tr>
      <tr>
        <td id="L547" data-line-number="547"></td>
        <td id="LC547">        }</td>
      </tr>
      <tr>
        <td id="L548" data-line-number="548"></td>
        <td id="LC548">
</td>
      </tr>
      <tr>
        <td id="L549" data-line-number="549"></td>
        <td id="LC549">        sigRet-&gt;<span>args</span> = (CORINFO_ARG_LIST_HANDLE)sig.<span>GetPtr</span>();</td>
      </tr>
      <tr>
        <td id="L550" data-line-number="550"></td>
        <td id="LC550">    }</td>
      </tr>
      <tr>
        <td id="L551" data-line-number="551"></td>
        <td id="LC551">
</td>
      </tr>
      <tr>
        <td id="L552" data-line-number="552"></td>
        <td id="LC552">    <span><span>//</span> Set computed flags</span></td>
      </tr>
      <tr>
        <td id="L553" data-line-number="553"></td>
        <td id="LC553">    sigRet-&gt;<span>flags</span> = sigRetFlags;</td>
      </tr>
      <tr>
        <td id="L554" data-line-number="554"></td>
        <td id="LC554">
</td>
      </tr>
      <tr>
        <td id="L555" data-line-number="555"></td>
        <td id="LC555">    <span>_ASSERTE</span>(<span>SigInfoFlagsAreValid</span>(sigRet));</td>
      </tr>
      <tr>
        <td id="L556" data-line-number="556"></td>
        <td id="LC556">} <span><span>//</span> CEEInfo::ConvToJitSig</span></td>
      </tr>
      <tr>
        <td id="L557" data-line-number="557"></td>
        <td id="LC557">
</td>
      </tr>
      <tr>
        <td id="L558" data-line-number="558"></td>
        <td id="LC558"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L559" data-line-number="559"></td>
        <td id="LC559"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L560" data-line-number="560"></td>
        <td id="LC560">CORINFO_CLASS_HANDLE <span>CEEInfo::getTokenTypeAsHandle</span> (CORINFO_RESOLVED_TOKEN * pResolvedToken)</td>
      </tr>
      <tr>
        <td id="L561" data-line-number="561"></td>
        <td id="LC561">{</td>
      </tr>
      <tr>
        <td id="L562" data-line-number="562"></td>
        <td id="LC562">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L563" data-line-number="563"></td>
        <td id="LC563">        THROWS;</td>
      </tr>
      <tr>
        <td id="L564" data-line-number="564"></td>
        <td id="LC564">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L565" data-line-number="565"></td>
        <td id="LC565">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L566" data-line-number="566"></td>
        <td id="LC566">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L567" data-line-number="567"></td>
        <td id="LC567">
</td>
      </tr>
      <tr>
        <td id="L568" data-line-number="568"></td>
        <td id="LC568">    CORINFO_CLASS_HANDLE tokenType = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L569" data-line-number="569"></td>
        <td id="LC569">
</td>
      </tr>
      <tr>
        <td id="L570" data-line-number="570"></td>
        <td id="LC570">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L571" data-line-number="571"></td>
        <td id="LC571">
</td>
      </tr>
      <tr>
        <td id="L572" data-line-number="572"></td>
        <td id="LC572">    <span>_ASSERTE</span>((pResolvedToken-&gt;<span>hMethod</span> == <span>NULL</span>) || (pResolvedToken-&gt;<span>hField</span> == <span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L573" data-line-number="573"></td>
        <td id="LC573">
</td>
      </tr>
      <tr>
        <td id="L574" data-line-number="574"></td>
        <td id="LC574">    BinderClassID classID = CLASS__TYPE_HANDLE;</td>
      </tr>
      <tr>
        <td id="L575" data-line-number="575"></td>
        <td id="LC575">
</td>
      </tr>
      <tr>
        <td id="L576" data-line-number="576"></td>
        <td id="LC576">    <span>if</span> (pResolvedToken-&gt;<span>hMethod</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L577" data-line-number="577"></td>
        <td id="LC577">    {</td>
      </tr>
      <tr>
        <td id="L578" data-line-number="578"></td>
        <td id="LC578">        classID = CLASS__METHOD_HANDLE;</td>
      </tr>
      <tr>
        <td id="L579" data-line-number="579"></td>
        <td id="LC579">    }</td>
      </tr>
      <tr>
        <td id="L580" data-line-number="580"></td>
        <td id="LC580">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L581" data-line-number="581"></td>
        <td id="LC581">    <span>if</span> (pResolvedToken-&gt;<span>hField</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L582" data-line-number="582"></td>
        <td id="LC582">    {</td>
      </tr>
      <tr>
        <td id="L583" data-line-number="583"></td>
        <td id="LC583">        classID = CLASS__FIELD_HANDLE;</td>
      </tr>
      <tr>
        <td id="L584" data-line-number="584"></td>
        <td id="LC584">    }</td>
      </tr>
      <tr>
        <td id="L585" data-line-number="585"></td>
        <td id="LC585">
</td>
      </tr>
      <tr>
        <td id="L586" data-line-number="586"></td>
        <td id="LC586">    tokenType = <span>CORINFO_CLASS_HANDLE</span>(<span>MscorlibBinder::GetClass</span>(classID));</td>
      </tr>
      <tr>
        <td id="L587" data-line-number="587"></td>
        <td id="LC587">
</td>
      </tr>
      <tr>
        <td id="L588" data-line-number="588"></td>
        <td id="LC588">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L589" data-line-number="589"></td>
        <td id="LC589">
</td>
      </tr>
      <tr>
        <td id="L590" data-line-number="590"></td>
        <td id="LC590">    <span>return</span> tokenType;</td>
      </tr>
      <tr>
        <td id="L591" data-line-number="591"></td>
        <td id="LC591">}</td>
      </tr>
      <tr>
        <td id="L592" data-line-number="592"></td>
        <td id="LC592">
</td>
      </tr>
      <tr>
        <td id="L593" data-line-number="593"></td>
        <td id="LC593"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L594" data-line-number="594"></td>
        <td id="LC594"><span>size_t</span> <span>CEEInfo::findNameOfToken</span> (</td>
      </tr>
      <tr>
        <td id="L595" data-line-number="595"></td>
        <td id="LC595">            CORINFO_MODULE_HANDLE       scopeHnd,</td>
      </tr>
      <tr>
        <td id="L596" data-line-number="596"></td>
        <td id="LC596">            mdToken                     metaTOK,</td>
      </tr>
      <tr>
        <td id="L597" data-line-number="597"></td>
        <td id="LC597">            <span>__out_ecount</span> (FQNameCapacity)  char * szFQName,</td>
      </tr>
      <tr>
        <td id="L598" data-line-number="598"></td>
        <td id="LC598">            size_t FQNameCapacity)</td>
      </tr>
      <tr>
        <td id="L599" data-line-number="599"></td>
        <td id="LC599">{</td>
      </tr>
      <tr>
        <td id="L600" data-line-number="600"></td>
        <td id="LC600">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L601" data-line-number="601"></td>
        <td id="LC601">        THROWS;</td>
      </tr>
      <tr>
        <td id="L602" data-line-number="602"></td>
        <td id="LC602">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L603" data-line-number="603"></td>
        <td id="LC603">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L604" data-line-number="604"></td>
        <td id="LC604">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L605" data-line-number="605"></td>
        <td id="LC605">
</td>
      </tr>
      <tr>
        <td id="L606" data-line-number="606"></td>
        <td id="LC606">    <span>size_t</span> NameLen = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L607" data-line-number="607"></td>
        <td id="LC607">
</td>
      </tr>
      <tr>
        <td id="L608" data-line-number="608"></td>
        <td id="LC608">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L609" data-line-number="609"></td>
        <td id="LC609">
</td>
      </tr>
      <tr>
        <td id="L610" data-line-number="610"></td>
        <td id="LC610">    <span>if</span> (<span>IsDynamicScope</span>(scopeHnd))</td>
      </tr>
      <tr>
        <td id="L611" data-line-number="611"></td>
        <td id="LC611">    {</td>
      </tr>
      <tr>
        <td id="L612" data-line-number="612"></td>
        <td id="LC612">        <span>strncpy_s</span> (szFQName, FQNameCapacity, <span><span>"</span>DynamicToken<span>"</span></span>, FQNameCapacity - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L613" data-line-number="613"></td>
        <td id="LC613">        NameLen = <span>strlen</span> (szFQName);</td>
      </tr>
      <tr>
        <td id="L614" data-line-number="614"></td>
        <td id="LC614">    }</td>
      </tr>
      <tr>
        <td id="L615" data-line-number="615"></td>
        <td id="LC615">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L616" data-line-number="616"></td>
        <td id="LC616">    {</td>
      </tr>
      <tr>
        <td id="L617" data-line-number="617"></td>
        <td id="LC617">        Module* module = (Module *)scopeHnd;</td>
      </tr>
      <tr>
        <td id="L618" data-line-number="618"></td>
        <td id="LC618">        NameLen = <span>findNameOfToken</span>(module, metaTOK, szFQName, FQNameCapacity);</td>
      </tr>
      <tr>
        <td id="L619" data-line-number="619"></td>
        <td id="LC619">    }</td>
      </tr>
      <tr>
        <td id="L620" data-line-number="620"></td>
        <td id="LC620">
</td>
      </tr>
      <tr>
        <td id="L621" data-line-number="621"></td>
        <td id="LC621">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L622" data-line-number="622"></td>
        <td id="LC622">
</td>
      </tr>
      <tr>
        <td id="L623" data-line-number="623"></td>
        <td id="LC623">    <span>return</span> NameLen;</td>
      </tr>
      <tr>
        <td id="L624" data-line-number="624"></td>
        <td id="LC624">}</td>
      </tr>
      <tr>
        <td id="L625" data-line-number="625"></td>
        <td id="LC625">
</td>
      </tr>
      <tr>
        <td id="L626" data-line-number="626"></td>
        <td id="LC626">CorInfoCanSkipVerificationResult <span>CEEInfo::canSkipMethodVerification</span>(CORINFO_METHOD_HANDLE ftnHnd)</td>
      </tr>
      <tr>
        <td id="L627" data-line-number="627"></td>
        <td id="LC627">{</td>
      </tr>
      <tr>
        <td id="L628" data-line-number="628"></td>
        <td id="LC628">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L629" data-line-number="629"></td>
        <td id="LC629">        THROWS;</td>
      </tr>
      <tr>
        <td id="L630" data-line-number="630"></td>
        <td id="LC630">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L631" data-line-number="631"></td>
        <td id="LC631">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L632" data-line-number="632"></td>
        <td id="LC632">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L633" data-line-number="633"></td>
        <td id="LC633">
</td>
      </tr>
      <tr>
        <td id="L634" data-line-number="634"></td>
        <td id="LC634">    <span>return</span> CORINFO_VERIFICATION_CAN_SKIP;</td>
      </tr>
      <tr>
        <td id="L635" data-line-number="635"></td>
        <td id="LC635">}</td>
      </tr>
      <tr>
        <td id="L636" data-line-number="636"></td>
        <td id="LC636">
</td>
      </tr>
      <tr>
        <td id="L637" data-line-number="637"></td>
        <td id="LC637"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L638" data-line-number="638"></td>
        <td id="LC638">BOOL <span>CEEInfo::shouldEnforceCallvirtRestriction</span>(</td>
      </tr>
      <tr>
        <td id="L639" data-line-number="639"></td>
        <td id="LC639">        CORINFO_MODULE_HANDLE scopeHnd)</td>
      </tr>
      <tr>
        <td id="L640" data-line-number="640"></td>
        <td id="LC640">{</td>
      </tr>
      <tr>
        <td id="L641" data-line-number="641"></td>
        <td id="LC641">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L642" data-line-number="642"></td>
        <td id="LC642">    <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L643" data-line-number="643"></td>
        <td id="LC643">}</td>
      </tr>
      <tr>
        <td id="L644" data-line-number="644"></td>
        <td id="LC644">
</td>
      </tr>
      <tr>
        <td id="L645" data-line-number="645"></td>
        <td id="LC645">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L646" data-line-number="646"></td>
        <td id="LC646">
</td>
      </tr>
      <tr>
        <td id="L647" data-line-number="647"></td>
        <td id="LC647"><span><span>//</span> Returns true if assemblies are in the same version bubble</span></td>
      </tr>
      <tr>
        <td id="L648" data-line-number="648"></td>
        <td id="LC648"><span><span>//</span> Right now each assembly is in its own version bubble.</span></td>
      </tr>
      <tr>
        <td id="L649" data-line-number="649"></td>
        <td id="LC649"><span><span>//</span> If the need arises (i.e. performance issues) we will define sets of assemblies (e.g. all app assemblies)</span></td>
      </tr>
      <tr>
        <td id="L650" data-line-number="650"></td>
        <td id="LC650"><span><span>//</span> The main point is that all this logic is concentrated in one place.</span></td>
      </tr>
      <tr>
        <td id="L651" data-line-number="651"></td>
        <td id="LC651">
</td>
      </tr>
      <tr>
        <td id="L652" data-line-number="652"></td>
        <td id="LC652"><span><span>//</span> NOTICE: If you change this logic to allow multi-assembly version bubbles you</span></td>
      </tr>
      <tr>
        <td id="L653" data-line-number="653"></td>
        <td id="LC653"><span><span>//</span> need to consider the impact on diagnostic tools. Currently there is an inlining</span></td>
      </tr>
      <tr>
        <td id="L654" data-line-number="654"></td>
        <td id="LC654"><span><span>//</span> table which tracks inliner/inlinee relationships in R2R images but it is not</span></td>
      </tr>
      <tr>
        <td id="L655" data-line-number="655"></td>
        <td id="LC655"><span><span>//</span> yet capable of encoding cross-assembly inlines. The scenario where this</span></td>
      </tr>
      <tr>
        <td id="L656" data-line-number="656"></td>
        <td id="LC656"><span><span>//</span> may show are instrumenting profilers that want to instrument a given method A</span></td>
      </tr>
      <tr>
        <td id="L657" data-line-number="657"></td>
        <td id="LC657"><span><span>//</span> using the ReJit APIs. If method A happens to inlined within method B in another</span></td>
      </tr>
      <tr>
        <td id="L658" data-line-number="658"></td>
        <td id="LC658"><span><span>//</span> assembly then the profiler needs to know that so it can rejit B too.</span></td>
      </tr>
      <tr>
        <td id="L659" data-line-number="659"></td>
        <td id="LC659"><span><span>//</span> The recommended approach is to upgrade the inlining table (vm\inlinetracking.h\.cpp)</span></td>
      </tr>
      <tr>
        <td id="L660" data-line-number="660"></td>
        <td id="LC660"><span><span>//</span> now that presumably R2R images have some way to refer to methods in other</span></td>
      </tr>
      <tr>
        <td id="L661" data-line-number="661"></td>
        <td id="LC661"><span><span>//</span> assemblies in their version bubble. Chat with the diagnostics team if you need more</span></td>
      </tr>
      <tr>
        <td id="L662" data-line-number="662"></td>
        <td id="LC662"><span><span>//</span> details.</span></td>
      </tr>
      <tr>
        <td id="L663" data-line-number="663"></td>
        <td id="LC663"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L664" data-line-number="664"></td>
        <td id="LC664"><span><span>//</span> There already is a case where cross-assembly inlining occurs in an</span></td>
      </tr>
      <tr>
        <td id="L665" data-line-number="665"></td>
        <td id="LC665"><span><span>//</span> unreported fashion for methods marked NonVersionable. There is a specific</span></td>
      </tr>
      <tr>
        <td id="L666" data-line-number="666"></td>
        <td id="LC666"><span><span>//</span> exemption called out for this on ICorProfilerInfo6::EnumNgenModuleMethodsInliningThisMethod</span></td>
      </tr>
      <tr>
        <td id="L667" data-line-number="667"></td>
        <td id="LC667"><span><span>//</span> and the impact of the cut was vetted with partners. It would not be appropriate</span></td>
      </tr>
      <tr>
        <td id="L668" data-line-number="668"></td>
        <td id="LC668"><span><span>//</span> to increase that unreported set without additional review.</span></td>
      </tr>
      <tr>
        <td id="L669" data-line-number="669"></td>
        <td id="LC669">
</td>
      </tr>
      <tr>
        <td id="L670" data-line-number="670"></td>
        <td id="LC670">
</td>
      </tr>
      <tr>
        <td id="L671" data-line-number="671"></td>
        <td id="LC671"><span>bool</span> <span>IsInSameVersionBubble</span>(Assembly * current, Assembly * target)</td>
      </tr>
      <tr>
        <td id="L672" data-line-number="672"></td>
        <td id="LC672">{</td>
      </tr>
      <tr>
        <td id="L673" data-line-number="673"></td>
        <td id="LC673">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L674" data-line-number="674"></td>
        <td id="LC674">
</td>
      </tr>
      <tr>
        <td id="L675" data-line-number="675"></td>
        <td id="LC675">    <span><span>//</span> trivial case: current and target are identical</span></td>
      </tr>
      <tr>
        <td id="L676" data-line-number="676"></td>
        <td id="LC676">    <span><span>//</span> DO NOT change this without reading the notice above</span></td>
      </tr>
      <tr>
        <td id="L677" data-line-number="677"></td>
        <td id="LC677">    <span>if</span> (current == target)</td>
      </tr>
      <tr>
        <td id="L678" data-line-number="678"></td>
        <td id="LC678">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L679" data-line-number="679"></td>
        <td id="LC679">
</td>
      </tr>
      <tr>
        <td id="L680" data-line-number="680"></td>
        <td id="LC680">    <span>return</span> <span>IsLargeVersionBubbleEnabled</span>();</td>
      </tr>
      <tr>
        <td id="L681" data-line-number="681"></td>
        <td id="LC681">}</td>
      </tr>
      <tr>
        <td id="L682" data-line-number="682"></td>
        <td id="LC682">
</td>
      </tr>
      <tr>
        <td id="L683" data-line-number="683"></td>
        <td id="LC683"><span><span>//</span> Returns true if the assemblies defining current and target are in the same version bubble</span></td>
      </tr>
      <tr>
        <td id="L684" data-line-number="684"></td>
        <td id="LC684"><span>static</span> <span>bool</span> <span>IsInSameVersionBubble</span>(MethodDesc* pCurMD, MethodDesc *pTargetMD)</td>
      </tr>
      <tr>
        <td id="L685" data-line-number="685"></td>
        <td id="LC685">{</td>
      </tr>
      <tr>
        <td id="L686" data-line-number="686"></td>
        <td id="LC686">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L687" data-line-number="687"></td>
        <td id="LC687">    <span><span>//</span> DO NOT change this without reading the notice above</span></td>
      </tr>
      <tr>
        <td id="L688" data-line-number="688"></td>
        <td id="LC688">    <span>if</span> (<span>IsInSameVersionBubble</span>(pCurMD-&gt;<span>GetModule</span>()-&gt;<span>GetAssembly</span>(),</td>
      </tr>
      <tr>
        <td id="L689" data-line-number="689"></td>
        <td id="LC689">                              pTargetMD-&gt;<span>GetModule</span>()-&gt;<span>GetAssembly</span>()))</td>
      </tr>
      <tr>
        <td id="L690" data-line-number="690"></td>
        <td id="LC690">    {</td>
      </tr>
      <tr>
        <td id="L691" data-line-number="691"></td>
        <td id="LC691">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L692" data-line-number="692"></td>
        <td id="LC692">    }</td>
      </tr>
      <tr>
        <td id="L693" data-line-number="693"></td>
        <td id="LC693">    <span>if</span> (<span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L694" data-line-number="694"></td>
        <td id="LC694">    {</td>
      </tr>
      <tr>
        <td id="L695" data-line-number="695"></td>
        <td id="LC695">        <span>if</span> (pTargetMD-&gt;<span>GetModule</span>()-&gt;<span>GetMDImport</span>()-&gt;<span>GetCustomAttributeByName</span>(pTargetMD-&gt;<span>GetMemberDef</span>(),</td>
      </tr>
      <tr>
        <td id="L696" data-line-number="696"></td>
        <td id="LC696">                NONVERSIONABLE_TYPE, <span>NULL</span>, <span>NULL</span>) == S_OK)</td>
      </tr>
      <tr>
        <td id="L697" data-line-number="697"></td>
        <td id="LC697">        {</td>
      </tr>
      <tr>
        <td id="L698" data-line-number="698"></td>
        <td id="LC698">            <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L699" data-line-number="699"></td>
        <td id="LC699">        }</td>
      </tr>
      <tr>
        <td id="L700" data-line-number="700"></td>
        <td id="LC700">    }</td>
      </tr>
      <tr>
        <td id="L701" data-line-number="701"></td>
        <td id="LC701">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L702" data-line-number="702"></td>
        <td id="LC702">
</td>
      </tr>
      <tr>
        <td id="L703" data-line-number="703"></td>
        <td id="LC703">}</td>
      </tr>
      <tr>
        <td id="L704" data-line-number="704"></td>
        <td id="LC704">
</td>
      </tr>
      <tr>
        <td id="L705" data-line-number="705"></td>
        <td id="LC705">#<span>endif</span> <span><span>//</span> FEATURE_READYTORUN_COMPILER</span></td>
      </tr>
      <tr>
        <td id="L706" data-line-number="706"></td>
        <td id="LC706">
</td>
      </tr>
      <tr>
        <td id="L707" data-line-number="707"></td>
        <td id="LC707"><span>static</span> <span>bool</span> <span>CallerAndCalleeInSystemVersionBubble</span>(MethodDesc* pCaller, MethodDesc* pCallee)</td>
      </tr>
      <tr>
        <td id="L708" data-line-number="708"></td>
        <td id="LC708">{</td>
      </tr>
      <tr>
        <td id="L709" data-line-number="709"></td>
        <td id="LC709">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L710" data-line-number="710"></td>
        <td id="LC710">
</td>
      </tr>
      <tr>
        <td id="L711" data-line-number="711"></td>
        <td id="LC711">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L712" data-line-number="712"></td>
        <td id="LC712">    <span>if</span> (<span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L713" data-line-number="713"></td>
        <td id="LC713">        <span>return</span> pCallee-&gt;<span>GetModule</span>()-&gt;<span>IsSystem</span>() &amp;&amp; <span>IsInSameVersionBubble</span>(pCaller, pCallee);</td>
      </tr>
      <tr>
        <td id="L714" data-line-number="714"></td>
        <td id="LC714">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L715" data-line-number="715"></td>
        <td id="LC715">
</td>
      </tr>
      <tr>
        <td id="L716" data-line-number="716"></td>
        <td id="LC716">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L717" data-line-number="717"></td>
        <td id="LC717">}</td>
      </tr>
      <tr>
        <td id="L718" data-line-number="718"></td>
        <td id="LC718">
</td>
      </tr>
      <tr>
        <td id="L719" data-line-number="719"></td>
        <td id="LC719">
</td>
      </tr>
      <tr>
        <td id="L720" data-line-number="720"></td>
        <td id="LC720"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L721" data-line-number="721"></td>
        <td id="LC721">CorInfoCanSkipVerificationResult <span>CEEInfo::canSkipVerification</span>(</td>
      </tr>
      <tr>
        <td id="L722" data-line-number="722"></td>
        <td id="LC722">        CORINFO_MODULE_HANDLE moduleHnd)</td>
      </tr>
      <tr>
        <td id="L723" data-line-number="723"></td>
        <td id="LC723">{</td>
      </tr>
      <tr>
        <td id="L724" data-line-number="724"></td>
        <td id="LC724">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L725" data-line-number="725"></td>
        <td id="LC725">        THROWS;</td>
      </tr>
      <tr>
        <td id="L726" data-line-number="726"></td>
        <td id="LC726">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L727" data-line-number="727"></td>
        <td id="LC727">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L728" data-line-number="728"></td>
        <td id="LC728">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L729" data-line-number="729"></td>
        <td id="LC729">
</td>
      </tr>
      <tr>
        <td id="L730" data-line-number="730"></td>
        <td id="LC730">    <span>return</span> CORINFO_VERIFICATION_CAN_SKIP;</td>
      </tr>
      <tr>
        <td id="L731" data-line-number="731"></td>
        <td id="LC731">}</td>
      </tr>
      <tr>
        <td id="L732" data-line-number="732"></td>
        <td id="LC732">
</td>
      </tr>
      <tr>
        <td id="L733" data-line-number="733"></td>
        <td id="LC733"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L734" data-line-number="734"></td>
        <td id="LC734"><span><span>//</span> Checks if the given metadata token is valid</span></td>
      </tr>
      <tr>
        <td id="L735" data-line-number="735"></td>
        <td id="LC735">BOOL <span>CEEInfo::isValidToken</span> (</td>
      </tr>
      <tr>
        <td id="L736" data-line-number="736"></td>
        <td id="LC736">        CORINFO_MODULE_HANDLE       module,</td>
      </tr>
      <tr>
        <td id="L737" data-line-number="737"></td>
        <td id="LC737">        mdToken                     metaTOK)</td>
      </tr>
      <tr>
        <td id="L738" data-line-number="738"></td>
        <td id="LC738">{</td>
      </tr>
      <tr>
        <td id="L739" data-line-number="739"></td>
        <td id="LC739">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L740" data-line-number="740"></td>
        <td id="LC740">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L741" data-line-number="741"></td>
        <td id="LC741">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L742" data-line-number="742"></td>
        <td id="LC742">        MODE_ANY;</td>
      </tr>
      <tr>
        <td id="L743" data-line-number="743"></td>
        <td id="LC743">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L744" data-line-number="744"></td>
        <td id="LC744">
</td>
      </tr>
      <tr>
        <td id="L745" data-line-number="745"></td>
        <td id="LC745">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L746" data-line-number="746"></td>
        <td id="LC746">
</td>
      </tr>
      <tr>
        <td id="L747" data-line-number="747"></td>
        <td id="LC747">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L748" data-line-number="748"></td>
        <td id="LC748">
</td>
      </tr>
      <tr>
        <td id="L749" data-line-number="749"></td>
        <td id="LC749">    <span>if</span> (<span>IsDynamicScope</span>(module))</td>
      </tr>
      <tr>
        <td id="L750" data-line-number="750"></td>
        <td id="LC750">    {</td>
      </tr>
      <tr>
        <td id="L751" data-line-number="751"></td>
        <td id="LC751">        <span><span>//</span> No explicit token validation for dynamic code. Validation is</span></td>
      </tr>
      <tr>
        <td id="L752" data-line-number="752"></td>
        <td id="LC752">        <span><span>//</span> side-effect of token resolution.</span></td>
      </tr>
      <tr>
        <td id="L753" data-line-number="753"></td>
        <td id="LC753">        result = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L754" data-line-number="754"></td>
        <td id="LC754">    }</td>
      </tr>
      <tr>
        <td id="L755" data-line-number="755"></td>
        <td id="LC755">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L756" data-line-number="756"></td>
        <td id="LC756">    {</td>
      </tr>
      <tr>
        <td id="L757" data-line-number="757"></td>
        <td id="LC757">        result = ((Module *)module)-&gt;<span>GetMDImport</span>()-&gt;<span>IsValidToken</span>(metaTOK);</td>
      </tr>
      <tr>
        <td id="L758" data-line-number="758"></td>
        <td id="LC758">    }</td>
      </tr>
      <tr>
        <td id="L759" data-line-number="759"></td>
        <td id="LC759">
</td>
      </tr>
      <tr>
        <td id="L760" data-line-number="760"></td>
        <td id="LC760">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L761" data-line-number="761"></td>
        <td id="LC761">
</td>
      </tr>
      <tr>
        <td id="L762" data-line-number="762"></td>
        <td id="LC762">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L763" data-line-number="763"></td>
        <td id="LC763">}</td>
      </tr>
      <tr>
        <td id="L764" data-line-number="764"></td>
        <td id="LC764">
</td>
      </tr>
      <tr>
        <td id="L765" data-line-number="765"></td>
        <td id="LC765"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L766" data-line-number="766"></td>
        <td id="LC766"><span><span>//</span> Checks if the given metadata token is valid StringRef</span></td>
      </tr>
      <tr>
        <td id="L767" data-line-number="767"></td>
        <td id="LC767">BOOL <span>CEEInfo::isValidStringRef</span> (</td>
      </tr>
      <tr>
        <td id="L768" data-line-number="768"></td>
        <td id="LC768">        CORINFO_MODULE_HANDLE       module,</td>
      </tr>
      <tr>
        <td id="L769" data-line-number="769"></td>
        <td id="LC769">        mdToken                     metaTOK)</td>
      </tr>
      <tr>
        <td id="L770" data-line-number="770"></td>
        <td id="LC770">{</td>
      </tr>
      <tr>
        <td id="L771" data-line-number="771"></td>
        <td id="LC771">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L772" data-line-number="772"></td>
        <td id="LC772">        THROWS;</td>
      </tr>
      <tr>
        <td id="L773" data-line-number="773"></td>
        <td id="LC773">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L774" data-line-number="774"></td>
        <td id="LC774">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L775" data-line-number="775"></td>
        <td id="LC775">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L776" data-line-number="776"></td>
        <td id="LC776">
</td>
      </tr>
      <tr>
        <td id="L777" data-line-number="777"></td>
        <td id="LC777">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L778" data-line-number="778"></td>
        <td id="LC778">
</td>
      </tr>
      <tr>
        <td id="L779" data-line-number="779"></td>
        <td id="LC779">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L780" data-line-number="780"></td>
        <td id="LC780">
</td>
      </tr>
      <tr>
        <td id="L781" data-line-number="781"></td>
        <td id="LC781">    <span>if</span> (<span>IsDynamicScope</span>(module))</td>
      </tr>
      <tr>
        <td id="L782" data-line-number="782"></td>
        <td id="LC782">    {</td>
      </tr>
      <tr>
        <td id="L783" data-line-number="783"></td>
        <td id="LC783">        result = <span>GetDynamicResolver</span>(module)-&gt;<span>IsValidStringRef</span>(metaTOK);</td>
      </tr>
      <tr>
        <td id="L784" data-line-number="784"></td>
        <td id="LC784">    }</td>
      </tr>
      <tr>
        <td id="L785" data-line-number="785"></td>
        <td id="LC785">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L786" data-line-number="786"></td>
        <td id="LC786">    {</td>
      </tr>
      <tr>
        <td id="L787" data-line-number="787"></td>
        <td id="LC787">        result = ((Module *)module)-&gt;<span>CheckStringRef</span>(metaTOK);</td>
      </tr>
      <tr>
        <td id="L788" data-line-number="788"></td>
        <td id="LC788">        <span>if</span> (result)</td>
      </tr>
      <tr>
        <td id="L789" data-line-number="789"></td>
        <td id="LC789">        {</td>
      </tr>
      <tr>
        <td id="L790" data-line-number="790"></td>
        <td id="LC790">            DWORD dwCharCount;</td>
      </tr>
      <tr>
        <td id="L791" data-line-number="791"></td>
        <td id="LC791">            LPCWSTR pString;</td>
      </tr>
      <tr>
        <td id="L792" data-line-number="792"></td>
        <td id="LC792">            result = (!<span>FAILED</span>(((Module *)module)-&gt;<span>GetMDImport</span>()-&gt;<span>GetUserString</span>(metaTOK, &amp;dwCharCount, <span>NULL</span>, &amp;pString)) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L793" data-line-number="793"></td>
        <td id="LC793">                     pString != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L794" data-line-number="794"></td>
        <td id="LC794">        }</td>
      </tr>
      <tr>
        <td id="L795" data-line-number="795"></td>
        <td id="LC795">    }</td>
      </tr>
      <tr>
        <td id="L796" data-line-number="796"></td>
        <td id="LC796">
</td>
      </tr>
      <tr>
        <td id="L797" data-line-number="797"></td>
        <td id="LC797">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L798" data-line-number="798"></td>
        <td id="LC798">
</td>
      </tr>
      <tr>
        <td id="L799" data-line-number="799"></td>
        <td id="LC799">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L800" data-line-number="800"></td>
        <td id="LC800">}</td>
      </tr>
      <tr>
        <td id="L801" data-line-number="801"></td>
        <td id="LC801">
</td>
      </tr>
      <tr>
        <td id="L802" data-line-number="802"></td>
        <td id="LC802"><span><span>/*</span> static <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L803" data-line-number="803"></td>
        <td id="LC803"><span>size_t</span> <span>CEEInfo::findNameOfToken</span> (Module* module,</td>
      </tr>
      <tr>
        <td id="L804" data-line-number="804"></td>
        <td id="LC804">                                                 mdToken metaTOK,</td>
      </tr>
      <tr>
        <td id="L805" data-line-number="805"></td>
        <td id="LC805">                                                 <span>__out_ecount</span> (FQNameCapacity) char * szFQName,</td>
      </tr>
      <tr>
        <td id="L806" data-line-number="806"></td>
        <td id="LC806">                                                 size_t FQNameCapacity)</td>
      </tr>
      <tr>
        <td id="L807" data-line-number="807"></td>
        <td id="LC807">{</td>
      </tr>
      <tr>
        <td id="L808" data-line-number="808"></td>
        <td id="LC808">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L809" data-line-number="809"></td>
        <td id="LC809">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L810" data-line-number="810"></td>
        <td id="LC810">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L811" data-line-number="811"></td>
        <td id="LC811">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L812" data-line-number="812"></td>
        <td id="LC812">
</td>
      </tr>
      <tr>
        <td id="L813" data-line-number="813"></td>
        <td id="LC813">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L814" data-line-number="814"></td>
        <td id="LC814">    PCCOR_SIGNATURE sig = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L815" data-line-number="815"></td>
        <td id="LC815">    DWORD           cSig;</td>
      </tr>
      <tr>
        <td id="L816" data-line-number="816"></td>
        <td id="LC816">    LPCUTF8         pszNamespace = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L817" data-line-number="817"></td>
        <td id="LC817">    LPCUTF8         pszClassName = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L818" data-line-number="818"></td>
        <td id="LC818">
</td>
      </tr>
      <tr>
        <td id="L819" data-line-number="819"></td>
        <td id="LC819">    mdToken tokType = <span>TypeFromToken</span>(metaTOK);</td>
      </tr>
      <tr>
        <td id="L820" data-line-number="820"></td>
        <td id="LC820">    <span>switch</span>(tokType)</td>
      </tr>
      <tr>
        <td id="L821" data-line-number="821"></td>
        <td id="LC821">    {</td>
      </tr>
      <tr>
        <td id="L822" data-line-number="822"></td>
        <td id="LC822">        <span>case</span> mdtTypeRef:</td>
      </tr>
      <tr>
        <td id="L823" data-line-number="823"></td>
        <td id="LC823">            {</td>
      </tr>
      <tr>
        <td id="L824" data-line-number="824"></td>
        <td id="LC824">                <span>if</span> (<span>FAILED</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetNameOfTypeRef</span>(metaTOK, &amp;pszNamespace, &amp;pszClassName)))</td>
      </tr>
      <tr>
        <td id="L825" data-line-number="825"></td>
        <td id="LC825">                {</td>
      </tr>
      <tr>
        <td id="L826" data-line-number="826"></td>
        <td id="LC826">                    pszNamespace = pszClassName = <span><span>"</span>Invalid TypeRef record<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L827" data-line-number="827"></td>
        <td id="LC827">                }</td>
      </tr>
      <tr>
        <td id="L828" data-line-number="828"></td>
        <td id="LC828">                <span>ns::MakePath</span>(szFQName, (<span>int</span>)FQNameCapacity, pszNamespace, pszClassName);</td>
      </tr>
      <tr>
        <td id="L829" data-line-number="829"></td>
        <td id="LC829">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L830" data-line-number="830"></td>
        <td id="LC830">            }</td>
      </tr>
      <tr>
        <td id="L831" data-line-number="831"></td>
        <td id="LC831">        <span>case</span> mdtTypeDef:</td>
      </tr>
      <tr>
        <td id="L832" data-line-number="832"></td>
        <td id="LC832">            {</td>
      </tr>
      <tr>
        <td id="L833" data-line-number="833"></td>
        <td id="LC833">                <span>if</span> (<span>FAILED</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetNameOfTypeDef</span>(metaTOK, &amp;pszClassName, &amp;pszNamespace)))</td>
      </tr>
      <tr>
        <td id="L834" data-line-number="834"></td>
        <td id="LC834">                {</td>
      </tr>
      <tr>
        <td id="L835" data-line-number="835"></td>
        <td id="LC835">                    pszClassName = pszNamespace = <span><span>"</span>Invalid TypeDef record<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L836" data-line-number="836"></td>
        <td id="LC836">                }</td>
      </tr>
      <tr>
        <td id="L837" data-line-number="837"></td>
        <td id="LC837">                <span>ns::MakePath</span>(szFQName, (<span>int</span>)FQNameCapacity, pszNamespace, pszClassName);</td>
      </tr>
      <tr>
        <td id="L838" data-line-number="838"></td>
        <td id="LC838">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L839" data-line-number="839"></td>
        <td id="LC839">            }</td>
      </tr>
      <tr>
        <td id="L840" data-line-number="840"></td>
        <td id="LC840">        <span>case</span> mdtFieldDef:</td>
      </tr>
      <tr>
        <td id="L841" data-line-number="841"></td>
        <td id="LC841">            {</td>
      </tr>
      <tr>
        <td id="L842" data-line-number="842"></td>
        <td id="LC842">                LPCSTR szFieldName;</td>
      </tr>
      <tr>
        <td id="L843" data-line-number="843"></td>
        <td id="LC843">                <span>if</span> (<span>FAILED</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetNameOfFieldDef</span>(metaTOK, &amp;szFieldName)))</td>
      </tr>
      <tr>
        <td id="L844" data-line-number="844"></td>
        <td id="LC844">                {</td>
      </tr>
      <tr>
        <td id="L845" data-line-number="845"></td>
        <td id="LC845">                    szFieldName = <span><span>"</span>Invalid FieldDef record<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L846" data-line-number="846"></td>
        <td id="LC846">                }</td>
      </tr>
      <tr>
        <td id="L847" data-line-number="847"></td>
        <td id="LC847">                <span>strncpy_s</span>(szFQName,  FQNameCapacity,  (<span>char</span>*)szFieldName, FQNameCapacity - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L848" data-line-number="848"></td>
        <td id="LC848">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L849" data-line-number="849"></td>
        <td id="LC849">            }</td>
      </tr>
      <tr>
        <td id="L850" data-line-number="850"></td>
        <td id="LC850">        <span>case</span> mdtMethodDef:</td>
      </tr>
      <tr>
        <td id="L851" data-line-number="851"></td>
        <td id="LC851">            {</td>
      </tr>
      <tr>
        <td id="L852" data-line-number="852"></td>
        <td id="LC852">                LPCSTR szMethodName;</td>
      </tr>
      <tr>
        <td id="L853" data-line-number="853"></td>
        <td id="LC853">                <span>if</span> (<span>FAILED</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetNameOfMethodDef</span>(metaTOK, &amp;szMethodName)))</td>
      </tr>
      <tr>
        <td id="L854" data-line-number="854"></td>
        <td id="LC854">                {</td>
      </tr>
      <tr>
        <td id="L855" data-line-number="855"></td>
        <td id="LC855">                    szMethodName = <span><span>"</span>Invalid MethodDef record<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L856" data-line-number="856"></td>
        <td id="LC856">                }</td>
      </tr>
      <tr>
        <td id="L857" data-line-number="857"></td>
        <td id="LC857">                <span>strncpy_s</span>(szFQName, FQNameCapacity, (<span>char</span>*)szMethodName, FQNameCapacity - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L858" data-line-number="858"></td>
        <td id="LC858">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L859" data-line-number="859"></td>
        <td id="LC859">            }</td>
      </tr>
      <tr>
        <td id="L860" data-line-number="860"></td>
        <td id="LC860">        <span>case</span> mdtMemberRef:</td>
      </tr>
      <tr>
        <td id="L861" data-line-number="861"></td>
        <td id="LC861">            {</td>
      </tr>
      <tr>
        <td id="L862" data-line-number="862"></td>
        <td id="LC862">                LPCSTR szName;</td>
      </tr>
      <tr>
        <td id="L863" data-line-number="863"></td>
        <td id="LC863">                <span>if</span> (<span>FAILED</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetNameAndSigOfMemberRef</span>((mdMemberRef)metaTOK, &amp;sig, &amp;cSig, &amp;szName)))</td>
      </tr>
      <tr>
        <td id="L864" data-line-number="864"></td>
        <td id="LC864">                {</td>
      </tr>
      <tr>
        <td id="L865" data-line-number="865"></td>
        <td id="LC865">                    szName = <span><span>"</span>Invalid MemberRef record<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L866" data-line-number="866"></td>
        <td id="LC866">                }</td>
      </tr>
      <tr>
        <td id="L867" data-line-number="867"></td>
        <td id="LC867">                <span>strncpy_s</span>(szFQName, FQNameCapacity, (<span>char</span> *)szName, FQNameCapacity - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L868" data-line-number="868"></td>
        <td id="LC868">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L869" data-line-number="869"></td>
        <td id="LC869">            }</td>
      </tr>
      <tr>
        <td id="L870" data-line-number="870"></td>
        <td id="LC870">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L871" data-line-number="871"></td>
        <td id="LC871">            <span>sprintf_s</span>(szFQName, FQNameCapacity, <span><span>"</span>!TK_%x<span>"</span></span>, metaTOK);</td>
      </tr>
      <tr>
        <td id="L872" data-line-number="872"></td>
        <td id="LC872">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L873" data-line-number="873"></td>
        <td id="LC873">    }</td>
      </tr>
      <tr>
        <td id="L874" data-line-number="874"></td>
        <td id="LC874">
</td>
      </tr>
      <tr>
        <td id="L875" data-line-number="875"></td>
        <td id="LC875">#<span>else</span> <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L876" data-line-number="876"></td>
        <td id="LC876">    <span>strncpy_s</span> (szFQName, FQNameCapacity, <span><span>"</span>&lt;UNKNOWN&gt;<span>"</span></span>, FQNameCapacity - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L877" data-line-number="877"></td>
        <td id="LC877">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L878" data-line-number="878"></td>
        <td id="LC878">
</td>
      </tr>
      <tr>
        <td id="L879" data-line-number="879"></td>
        <td id="LC879">
</td>
      </tr>
      <tr>
        <td id="L880" data-line-number="880"></td>
        <td id="LC880">    <span>return</span> <span>strlen</span> (szFQName);</td>
      </tr>
      <tr>
        <td id="L881" data-line-number="881"></td>
        <td id="LC881">}</td>
      </tr>
      <tr>
        <td id="L882" data-line-number="882"></td>
        <td id="LC882">
</td>
      </tr>
      <tr>
        <td id="L883" data-line-number="883"></td>
        <td id="LC883">CorInfoHelpFunc <span>CEEInfo::getLazyStringLiteralHelper</span>(CORINFO_MODULE_HANDLE handle)</td>
      </tr>
      <tr>
        <td id="L884" data-line-number="884"></td>
        <td id="LC884">{</td>
      </tr>
      <tr>
        <td id="L885" data-line-number="885"></td>
        <td id="LC885">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L886" data-line-number="886"></td>
        <td id="LC886">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L887" data-line-number="887"></td>
        <td id="LC887">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L888" data-line-number="888"></td>
        <td id="LC888">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L889" data-line-number="889"></td>
        <td id="LC889">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L890" data-line-number="890"></td>
        <td id="LC890">
</td>
      </tr>
      <tr>
        <td id="L891" data-line-number="891"></td>
        <td id="LC891">    CorInfoHelpFunc result = CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L892" data-line-number="892"></td>
        <td id="LC892">
</td>
      </tr>
      <tr>
        <td id="L893" data-line-number="893"></td>
        <td id="LC893">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L894" data-line-number="894"></td>
        <td id="LC894">
</td>
      </tr>
      <tr>
        <td id="L895" data-line-number="895"></td>
        <td id="LC895">    result = <span>IsDynamicScope</span>(handle) ? CORINFO_HELP_UNDEF : CORINFO_HELP_STRCNS;</td>
      </tr>
      <tr>
        <td id="L896" data-line-number="896"></td>
        <td id="LC896">
</td>
      </tr>
      <tr>
        <td id="L897" data-line-number="897"></td>
        <td id="LC897">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L898" data-line-number="898"></td>
        <td id="LC898">
</td>
      </tr>
      <tr>
        <td id="L899" data-line-number="899"></td>
        <td id="LC899">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L900" data-line-number="900"></td>
        <td id="LC900">}</td>
      </tr>
      <tr>
        <td id="L901" data-line-number="901"></td>
        <td id="LC901">
</td>
      </tr>
      <tr>
        <td id="L902" data-line-number="902"></td>
        <td id="LC902">
</td>
      </tr>
      <tr>
        <td id="L903" data-line-number="903"></td>
        <td id="LC903">CHECK <span>CheckContext</span>(CORINFO_MODULE_HANDLE scopeHnd, CORINFO_CONTEXT_HANDLE context)</td>
      </tr>
      <tr>
        <td id="L904" data-line-number="904"></td>
        <td id="LC904">{</td>
      </tr>
      <tr>
        <td id="L905" data-line-number="905"></td>
        <td id="LC905">    <span>CHECK_MSG</span>(scopeHnd != <span>NULL</span>, <span><span>"</span>Illegal null scope<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L906" data-line-number="906"></td>
        <td id="LC906">    <span>CHECK_MSG</span>(((<span>size_t</span>) context &amp; ~CORINFO_CONTEXTFLAGS_MASK) != <span>NULL</span>, <span><span>"</span>Illegal null context<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L907" data-line-number="907"></td>
        <td id="LC907">    <span>if</span> (((<span>size_t</span>) context &amp; CORINFO_CONTEXTFLAGS_MASK) == CORINFO_CONTEXTFLAGS_CLASS)</td>
      </tr>
      <tr>
        <td id="L908" data-line-number="908"></td>
        <td id="LC908">    {</td>
      </tr>
      <tr>
        <td id="L909" data-line-number="909"></td>
        <td id="LC909">        TypeHandle <span>handle</span>((CORINFO_CLASS_HANDLE) ((<span>size_t</span>) context &amp; ~CORINFO_CONTEXTFLAGS_MASK));</td>
      </tr>
      <tr>
        <td id="L910" data-line-number="910"></td>
        <td id="LC910">        <span>CHECK_MSG</span>(handle.<span>GetModule</span>() == <span>GetModule</span>(scopeHnd), <span><span>"</span>Inconsistent scope and context<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L911" data-line-number="911"></td>
        <td id="LC911">    }</td>
      </tr>
      <tr>
        <td id="L912" data-line-number="912"></td>
        <td id="LC912">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L913" data-line-number="913"></td>
        <td id="LC913">    {</td>
      </tr>
      <tr>
        <td id="L914" data-line-number="914"></td>
        <td id="LC914">        MethodDesc* handle = (MethodDesc*) ((<span>size_t</span>) context &amp; ~CORINFO_CONTEXTFLAGS_MASK);</td>
      </tr>
      <tr>
        <td id="L915" data-line-number="915"></td>
        <td id="LC915">        <span>CHECK_MSG</span>(handle-&gt;<span>GetModule</span>() == <span>GetModule</span>(scopeHnd), <span><span>"</span>Inconsistent scope and context<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L916" data-line-number="916"></td>
        <td id="LC916">    }</td>
      </tr>
      <tr>
        <td id="L917" data-line-number="917"></td>
        <td id="LC917">
</td>
      </tr>
      <tr>
        <td id="L918" data-line-number="918"></td>
        <td id="LC918">    CHECK_OK;</td>
      </tr>
      <tr>
        <td id="L919" data-line-number="919"></td>
        <td id="LC919">}</td>
      </tr>
      <tr>
        <td id="L920" data-line-number="920"></td>
        <td id="LC920">
</td>
      </tr>
      <tr>
        <td id="L921" data-line-number="921"></td>
        <td id="LC921">
</td>
      </tr>
      <tr>
        <td id="L922" data-line-number="922"></td>
        <td id="LC922"><span>static</span> DECLSPEC_NORETURN <span>void</span> <span>ThrowBadTokenException</span>(CORINFO_RESOLVED_TOKEN * pResolvedToken)</td>
      </tr>
      <tr>
        <td id="L923" data-line-number="923"></td>
        <td id="LC923">{</td>
      </tr>
      <tr>
        <td id="L924" data-line-number="924"></td>
        <td id="LC924">    <span>switch</span> (pResolvedToken-&gt;<span>tokenType</span> &amp; CORINFO_TOKENKIND_Mask)</td>
      </tr>
      <tr>
        <td id="L925" data-line-number="925"></td>
        <td id="LC925">    {</td>
      </tr>
      <tr>
        <td id="L926" data-line-number="926"></td>
        <td id="LC926">    <span>case</span> CORINFO_TOKENKIND_Class:</td>
      </tr>
      <tr>
        <td id="L927" data-line-number="927"></td>
        <td id="LC927">        <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT, BFA_BAD_CLASS_TOKEN);</td>
      </tr>
      <tr>
        <td id="L928" data-line-number="928"></td>
        <td id="LC928">    <span>case</span> CORINFO_TOKENKIND_Method:</td>
      </tr>
      <tr>
        <td id="L929" data-line-number="929"></td>
        <td id="LC929">        <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT, BFA_INVALID_METHOD_TOKEN);</td>
      </tr>
      <tr>
        <td id="L930" data-line-number="930"></td>
        <td id="LC930">    <span>case</span> CORINFO_TOKENKIND_Field:</td>
      </tr>
      <tr>
        <td id="L931" data-line-number="931"></td>
        <td id="LC931">        <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT, BFA_BAD_FIELD_TOKEN);</td>
      </tr>
      <tr>
        <td id="L932" data-line-number="932"></td>
        <td id="LC932">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L933" data-line-number="933"></td>
        <td id="LC933">        <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L934" data-line-number="934"></td>
        <td id="LC934">    }</td>
      </tr>
      <tr>
        <td id="L935" data-line-number="935"></td>
        <td id="LC935">}</td>
      </tr>
      <tr>
        <td id="L936" data-line-number="936"></td>
        <td id="LC936">
</td>
      </tr>
      <tr>
        <td id="L937" data-line-number="937"></td>
        <td id="LC937"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L938" data-line-number="938"></td>
        <td id="LC938"><span>void</span> <span>CEEInfo::resolveToken</span>(<span><span>/*</span> IN, OUT <span>*/</span></span> CORINFO_RESOLVED_TOKEN * pResolvedToken)</td>
      </tr>
      <tr>
        <td id="L939" data-line-number="939"></td>
        <td id="LC939">{</td>
      </tr>
      <tr>
        <td id="L940" data-line-number="940"></td>
        <td id="LC940">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L941" data-line-number="941"></td>
        <td id="LC941">        THROWS;</td>
      </tr>
      <tr>
        <td id="L942" data-line-number="942"></td>
        <td id="LC942">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L943" data-line-number="943"></td>
        <td id="LC943">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L944" data-line-number="944"></td>
        <td id="LC944">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L945" data-line-number="945"></td>
        <td id="LC945">
</td>
      </tr>
      <tr>
        <td id="L946" data-line-number="946"></td>
        <td id="LC946">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L947" data-line-number="947"></td>
        <td id="LC947">
</td>
      </tr>
      <tr>
        <td id="L948" data-line-number="948"></td>
        <td id="LC948">    <span>_ASSERTE</span>(<span>CheckContext</span>(pResolvedToken-&gt;<span>tokenScope</span>, pResolvedToken-&gt;<span>tokenContext</span>));</td>
      </tr>
      <tr>
        <td id="L949" data-line-number="949"></td>
        <td id="LC949">
</td>
      </tr>
      <tr>
        <td id="L950" data-line-number="950"></td>
        <td id="LC950">    pResolvedToken-&gt;<span>pTypeSpec</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L951" data-line-number="951"></td>
        <td id="LC951">    pResolvedToken-&gt;<span>cbTypeSpec</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L952" data-line-number="952"></td>
        <td id="LC952">    pResolvedToken-&gt;<span>pMethodSpec</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L953" data-line-number="953"></td>
        <td id="LC953">    pResolvedToken-&gt;<span>cbMethodSpec</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L954" data-line-number="954"></td>
        <td id="LC954">
</td>
      </tr>
      <tr>
        <td id="L955" data-line-number="955"></td>
        <td id="LC955">    TypeHandle th;</td>
      </tr>
      <tr>
        <td id="L956" data-line-number="956"></td>
        <td id="LC956">    MethodDesc * pMD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L957" data-line-number="957"></td>
        <td id="LC957">    FieldDesc * pFD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L958" data-line-number="958"></td>
        <td id="LC958">
</td>
      </tr>
      <tr>
        <td id="L959" data-line-number="959"></td>
        <td id="LC959">    CorInfoTokenKind tokenType = pResolvedToken-&gt;<span>tokenType</span>;</td>
      </tr>
      <tr>
        <td id="L960" data-line-number="960"></td>
        <td id="LC960">
</td>
      </tr>
      <tr>
        <td id="L961" data-line-number="961"></td>
        <td id="LC961">    <span>if</span> (<span>IsDynamicScope</span>(pResolvedToken-&gt;<span>tokenScope</span>))</td>
      </tr>
      <tr>
        <td id="L962" data-line-number="962"></td>
        <td id="LC962">    {</td>
      </tr>
      <tr>
        <td id="L963" data-line-number="963"></td>
        <td id="LC963">        <span>GetDynamicResolver</span>(pResolvedToken-&gt;<span>tokenScope</span>)-&gt;<span>ResolveToken</span>(pResolvedToken-&gt;<span>token</span>, &amp;th, &amp;pMD, &amp;pFD);</td>
      </tr>
      <tr>
        <td id="L964" data-line-number="964"></td>
        <td id="LC964">
</td>
      </tr>
      <tr>
        <td id="L965" data-line-number="965"></td>
        <td id="LC965">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L966" data-line-number="966"></td>
        <td id="LC966">        <span><span>//</span> Check that we got the expected handles and fill in missing data if necessary</span></td>
      </tr>
      <tr>
        <td id="L967" data-line-number="967"></td>
        <td id="LC967">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L968" data-line-number="968"></td>
        <td id="LC968">
</td>
      </tr>
      <tr>
        <td id="L969" data-line-number="969"></td>
        <td id="LC969">        CorTokenType tkType = (CorTokenType)<span>TypeFromToken</span>(pResolvedToken-&gt;<span>token</span>);</td>
      </tr>
      <tr>
        <td id="L970" data-line-number="970"></td>
        <td id="LC970">
</td>
      </tr>
      <tr>
        <td id="L971" data-line-number="971"></td>
        <td id="LC971">        <span>if</span> (pMD != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L972" data-line-number="972"></td>
        <td id="LC972">        {</td>
      </tr>
      <tr>
        <td id="L973" data-line-number="973"></td>
        <td id="LC973">            <span>if</span> ((tkType != mdtMethodDef) &amp;&amp; (tkType != mdtMemberRef))</td>
      </tr>
      <tr>
        <td id="L974" data-line-number="974"></td>
        <td id="LC974">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L975" data-line-number="975"></td>
        <td id="LC975">            <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Method) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L976" data-line-number="976"></td>
        <td id="LC976">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L977" data-line-number="977"></td>
        <td id="LC977">            <span>if</span> (th.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L978" data-line-number="978"></td>
        <td id="LC978">                th = pMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L979" data-line-number="979"></td>
        <td id="LC979">
</td>
      </tr>
      <tr>
        <td id="L980" data-line-number="980"></td>
        <td id="LC980">            <span><span>//</span> "PermitUninstDefOrRef" check</span></td>
      </tr>
      <tr>
        <td id="L981" data-line-number="981"></td>
        <td id="LC981">            <span>if</span> ((tokenType != CORINFO_TOKENKIND_Ldtoken) &amp;&amp; pMD-&gt;<span>ContainsGenericVariables</span>())</td>
      </tr>
      <tr>
        <td id="L982" data-line-number="982"></td>
        <td id="LC982">            {</td>
      </tr>
      <tr>
        <td id="L983" data-line-number="983"></td>
        <td id="LC983">                <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>);</td>
      </tr>
      <tr>
        <td id="L984" data-line-number="984"></td>
        <td id="LC984">            }</td>
      </tr>
      <tr>
        <td id="L985" data-line-number="985"></td>
        <td id="LC985">
</td>
      </tr>
      <tr>
        <td id="L986" data-line-number="986"></td>
        <td id="LC986">            <span><span>//</span> if this is a BoxedEntryPointStub get the UnboxedEntryPoint one</span></td>
      </tr>
      <tr>
        <td id="L987" data-line-number="987"></td>
        <td id="LC987">            <span>if</span> (pMD-&gt;<span>IsUnboxingStub</span>())</td>
      </tr>
      <tr>
        <td id="L988" data-line-number="988"></td>
        <td id="LC988">            {</td>
      </tr>
      <tr>
        <td id="L989" data-line-number="989"></td>
        <td id="LC989">                pMD = pMD-&gt;<span>GetMethodTable</span>()-&gt;<span>GetUnboxedEntryPointMD</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L990" data-line-number="990"></td>
        <td id="LC990">            }</td>
      </tr>
      <tr>
        <td id="L991" data-line-number="991"></td>
        <td id="LC991">
</td>
      </tr>
      <tr>
        <td id="L992" data-line-number="992"></td>
        <td id="LC992">            <span><span>//</span> Activate target if required</span></td>
      </tr>
      <tr>
        <td id="L993" data-line-number="993"></td>
        <td id="LC993">            <span>if</span> (tokenType != CORINFO_TOKENKIND_Ldtoken)</td>
      </tr>
      <tr>
        <td id="L994" data-line-number="994"></td>
        <td id="LC994">            {</td>
      </tr>
      <tr>
        <td id="L995" data-line-number="995"></td>
        <td id="LC995">                <span>ScanTokenForDynamicScope</span>(pResolvedToken, th, pMD);</td>
      </tr>
      <tr>
        <td id="L996" data-line-number="996"></td>
        <td id="LC996">            }</td>
      </tr>
      <tr>
        <td id="L997" data-line-number="997"></td>
        <td id="LC997">        }</td>
      </tr>
      <tr>
        <td id="L998" data-line-number="998"></td>
        <td id="LC998">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L999" data-line-number="999"></td>
        <td id="LC999">        <span>if</span> (pFD != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1000" data-line-number="1000"></td>
        <td id="LC1000">        {</td>
      </tr>
      <tr>
        <td id="L1001" data-line-number="1001"></td>
        <td id="LC1001">            <span>if</span> ((tkType != mdtFieldDef) &amp;&amp; (tkType != mdtMemberRef))</td>
      </tr>
      <tr>
        <td id="L1002" data-line-number="1002"></td>
        <td id="LC1002">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1003" data-line-number="1003"></td>
        <td id="LC1003">            <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Field) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1004" data-line-number="1004"></td>
        <td id="LC1004">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1005" data-line-number="1005"></td>
        <td id="LC1005">            <span>if</span> (th.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L1006" data-line-number="1006"></td>
        <td id="LC1006">                th = pFD-&gt;<span>GetApproxEnclosingMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L1007" data-line-number="1007"></td>
        <td id="LC1007">
</td>
      </tr>
      <tr>
        <td id="L1008" data-line-number="1008"></td>
        <td id="LC1008">            <span>if</span> (pFD-&gt;<span>IsStatic</span>() &amp;&amp; (tokenType != CORINFO_TOKENKIND_Ldtoken))</td>
      </tr>
      <tr>
        <td id="L1009" data-line-number="1009"></td>
        <td id="LC1009">            {</td>
      </tr>
      <tr>
        <td id="L1010" data-line-number="1010"></td>
        <td id="LC1010">                <span>ScanTokenForDynamicScope</span>(pResolvedToken, th);</td>
      </tr>
      <tr>
        <td id="L1011" data-line-number="1011"></td>
        <td id="LC1011">            }</td>
      </tr>
      <tr>
        <td id="L1012" data-line-number="1012"></td>
        <td id="LC1012">        }</td>
      </tr>
      <tr>
        <td id="L1013" data-line-number="1013"></td>
        <td id="LC1013">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L1014" data-line-number="1014"></td>
        <td id="LC1014">        {</td>
      </tr>
      <tr>
        <td id="L1015" data-line-number="1015"></td>
        <td id="LC1015">            <span>if</span> ((tkType != mdtTypeDef) &amp;&amp; (tkType != mdtTypeRef))</td>
      </tr>
      <tr>
        <td id="L1016" data-line-number="1016"></td>
        <td id="LC1016">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1017" data-line-number="1017"></td>
        <td id="LC1017">            <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Class) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1018" data-line-number="1018"></td>
        <td id="LC1018">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1019" data-line-number="1019"></td>
        <td id="LC1019">            <span>if</span> (th.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L1020" data-line-number="1020"></td>
        <td id="LC1020">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1021" data-line-number="1021"></td>
        <td id="LC1021">
</td>
      </tr>
      <tr>
        <td id="L1022" data-line-number="1022"></td>
        <td id="LC1022">            <span>if</span> (tokenType == CORINFO_TOKENKIND_Box || tokenType == CORINFO_TOKENKIND_Constrained)</td>
      </tr>
      <tr>
        <td id="L1023" data-line-number="1023"></td>
        <td id="LC1023">            {</td>
      </tr>
      <tr>
        <td id="L1024" data-line-number="1024"></td>
        <td id="LC1024">                <span>ScanTokenForDynamicScope</span>(pResolvedToken, th);</td>
      </tr>
      <tr>
        <td id="L1025" data-line-number="1025"></td>
        <td id="LC1025">            }</td>
      </tr>
      <tr>
        <td id="L1026" data-line-number="1026"></td>
        <td id="LC1026">        }</td>
      </tr>
      <tr>
        <td id="L1027" data-line-number="1027"></td>
        <td id="LC1027">
</td>
      </tr>
      <tr>
        <td id="L1028" data-line-number="1028"></td>
        <td id="LC1028">        <span>_ASSERTE</span>((pMD == <span>NULL</span>) || (pFD == <span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L1029" data-line-number="1029"></td>
        <td id="LC1029">        <span>_ASSERTE</span>(!th.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L1030" data-line-number="1030"></td>
        <td id="LC1030">
</td>
      </tr>
      <tr>
        <td id="L1031" data-line-number="1031"></td>
        <td id="LC1031">        <span><span>//</span> "PermitUninstDefOrRef" check</span></td>
      </tr>
      <tr>
        <td id="L1032" data-line-number="1032"></td>
        <td id="LC1032">        <span>if</span> ((tokenType != CORINFO_TOKENKIND_Ldtoken) &amp;&amp; th.<span>ContainsGenericVariables</span>())</td>
      </tr>
      <tr>
        <td id="L1033" data-line-number="1033"></td>
        <td id="LC1033">        {</td>
      </tr>
      <tr>
        <td id="L1034" data-line-number="1034"></td>
        <td id="LC1034">            <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>);</td>
      </tr>
      <tr>
        <td id="L1035" data-line-number="1035"></td>
        <td id="LC1035">        }</td>
      </tr>
      <tr>
        <td id="L1036" data-line-number="1036"></td>
        <td id="LC1036">    }</td>
      </tr>
      <tr>
        <td id="L1037" data-line-number="1037"></td>
        <td id="LC1037">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1038" data-line-number="1038"></td>
        <td id="LC1038">    {</td>
      </tr>
      <tr>
        <td id="L1039" data-line-number="1039"></td>
        <td id="LC1039">        <span>unsigned</span> metaTOK = pResolvedToken-&gt;<span>token</span>;</td>
      </tr>
      <tr>
        <td id="L1040" data-line-number="1040"></td>
        <td id="LC1040">        Module * pModule = (Module *)pResolvedToken-&gt;<span>tokenScope</span>;</td>
      </tr>
      <tr>
        <td id="L1041" data-line-number="1041"></td>
        <td id="LC1041">
</td>
      </tr>
      <tr>
        <td id="L1042" data-line-number="1042"></td>
        <td id="LC1042">        <span>switch</span> (<span>TypeFromToken</span>(metaTOK))</td>
      </tr>
      <tr>
        <td id="L1043" data-line-number="1043"></td>
        <td id="LC1043">        {</td>
      </tr>
      <tr>
        <td id="L1044" data-line-number="1044"></td>
        <td id="LC1044">        <span>case</span> mdtModuleRef:</td>
      </tr>
      <tr>
        <td id="L1045" data-line-number="1045"></td>
        <td id="LC1045">            <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Class) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1046" data-line-number="1046"></td>
        <td id="LC1046">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1047" data-line-number="1047"></td>
        <td id="LC1047">
</td>
      </tr>
      <tr>
        <td id="L1048" data-line-number="1048"></td>
        <td id="LC1048">            {</td>
      </tr>
      <tr>
        <td id="L1049" data-line-number="1049"></td>
        <td id="LC1049">                DomainFile *pTargetModule = pModule-&gt;<span>LoadModule</span>(<span>GetAppDomain</span>(), metaTOK, <span>FALSE</span> <span><span>/*</span> loadResources <span>*/</span></span>);</td>
      </tr>
      <tr>
        <td id="L1050" data-line-number="1050"></td>
        <td id="LC1050">                <span>if</span> (pTargetModule == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1051" data-line-number="1051"></td>
        <td id="LC1051">                    <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L1052" data-line-number="1052"></td>
        <td id="LC1052">                th = <span>TypeHandle</span>(pTargetModule-&gt;<span>GetModule</span>()-&gt;<span>GetGlobalMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L1053" data-line-number="1053"></td>
        <td id="LC1053">                <span>if</span> (th.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L1054" data-line-number="1054"></td>
        <td id="LC1054">                    <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L1055" data-line-number="1055"></td>
        <td id="LC1055">            }</td>
      </tr>
      <tr>
        <td id="L1056" data-line-number="1056"></td>
        <td id="LC1056">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1057" data-line-number="1057"></td>
        <td id="LC1057">
</td>
      </tr>
      <tr>
        <td id="L1058" data-line-number="1058"></td>
        <td id="LC1058">        <span>case</span> mdtTypeDef:</td>
      </tr>
      <tr>
        <td id="L1059" data-line-number="1059"></td>
        <td id="LC1059">        <span>case</span> mdtTypeRef:</td>
      </tr>
      <tr>
        <td id="L1060" data-line-number="1060"></td>
        <td id="LC1060">            <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Class) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1061" data-line-number="1061"></td>
        <td id="LC1061">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1062" data-line-number="1062"></td>
        <td id="LC1062">
</td>
      </tr>
      <tr>
        <td id="L1063" data-line-number="1063"></td>
        <td id="LC1063">            th = <span>ClassLoader::LoadTypeDefOrRefThrowing</span>(pModule, metaTOK,</td>
      </tr>
      <tr>
        <td id="L1064" data-line-number="1064"></td>
        <td id="LC1064">                                         ClassLoader::ThrowIfNotFound,</td>
      </tr>
      <tr>
        <td id="L1065" data-line-number="1065"></td>
        <td id="LC1065">                                         (tokenType == CORINFO_TOKENKIND_Ldtoken) ?</td>
      </tr>
      <tr>
        <td id="L1066" data-line-number="1066"></td>
        <td id="LC1066">                                            ClassLoader::PermitUninstDefOrRef : ClassLoader::FailIfUninstDefOrRef);</td>
      </tr>
      <tr>
        <td id="L1067" data-line-number="1067"></td>
        <td id="LC1067">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1068" data-line-number="1068"></td>
        <td id="LC1068">
</td>
      </tr>
      <tr>
        <td id="L1069" data-line-number="1069"></td>
        <td id="LC1069">        <span>case</span> mdtTypeSpec:</td>
      </tr>
      <tr>
        <td id="L1070" data-line-number="1070"></td>
        <td id="LC1070">            {</td>
      </tr>
      <tr>
        <td id="L1071" data-line-number="1071"></td>
        <td id="LC1071">                <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Class) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1072" data-line-number="1072"></td>
        <td id="LC1072">                    <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1073" data-line-number="1073"></td>
        <td id="LC1073">
</td>
      </tr>
      <tr>
        <td id="L1074" data-line-number="1074"></td>
        <td id="LC1074">                <span>IfFailThrow</span>(pModule-&gt;<span>GetMDImport</span>()-&gt;<span>GetTypeSpecFromToken</span>(metaTOK, &amp;pResolvedToken-&gt;<span>pTypeSpec</span>, &amp;pResolvedToken-&gt;<span>cbTypeSpec</span>));</td>
      </tr>
      <tr>
        <td id="L1075" data-line-number="1075"></td>
        <td id="LC1075">
</td>
      </tr>
      <tr>
        <td id="L1076" data-line-number="1076"></td>
        <td id="LC1076">                SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L1077" data-line-number="1077"></td>
        <td id="LC1077">                <span>GetTypeContext</span>(pResolvedToken-&gt;<span>tokenContext</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L1078" data-line-number="1078"></td>
        <td id="LC1078">
</td>
      </tr>
      <tr>
        <td id="L1079" data-line-number="1079"></td>
        <td id="LC1079">                SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L1080" data-line-number="1080"></td>
        <td id="LC1080">                th = sigptr.<span>GetTypeHandleThrowing</span>(pModule, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L1081" data-line-number="1081"></td>
        <td id="LC1081">            }</td>
      </tr>
      <tr>
        <td id="L1082" data-line-number="1082"></td>
        <td id="LC1082">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1083" data-line-number="1083"></td>
        <td id="LC1083">
</td>
      </tr>
      <tr>
        <td id="L1084" data-line-number="1084"></td>
        <td id="LC1084">        <span>case</span> mdtMethodDef:</td>
      </tr>
      <tr>
        <td id="L1085" data-line-number="1085"></td>
        <td id="LC1085">            <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Method) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1086" data-line-number="1086"></td>
        <td id="LC1086">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1087" data-line-number="1087"></td>
        <td id="LC1087">
</td>
      </tr>
      <tr>
        <td id="L1088" data-line-number="1088"></td>
        <td id="LC1088">            pMD = <span>MemberLoader::GetMethodDescFromMethodDef</span>(pModule, metaTOK, (tokenType != CORINFO_TOKENKIND_Ldtoken));</td>
      </tr>
      <tr>
        <td id="L1089" data-line-number="1089"></td>
        <td id="LC1089">
</td>
      </tr>
      <tr>
        <td id="L1090" data-line-number="1090"></td>
        <td id="LC1090">            th = pMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L1091" data-line-number="1091"></td>
        <td id="LC1091">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1092" data-line-number="1092"></td>
        <td id="LC1092">
</td>
      </tr>
      <tr>
        <td id="L1093" data-line-number="1093"></td>
        <td id="LC1093">        <span>case</span> mdtFieldDef:</td>
      </tr>
      <tr>
        <td id="L1094" data-line-number="1094"></td>
        <td id="LC1094">            <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Field) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1095" data-line-number="1095"></td>
        <td id="LC1095">                <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1096" data-line-number="1096"></td>
        <td id="LC1096">
</td>
      </tr>
      <tr>
        <td id="L1097" data-line-number="1097"></td>
        <td id="LC1097">            pFD = <span>MemberLoader::GetFieldDescFromFieldDef</span>(pModule, metaTOK, (tokenType != CORINFO_TOKENKIND_Ldtoken));</td>
      </tr>
      <tr>
        <td id="L1098" data-line-number="1098"></td>
        <td id="LC1098">
</td>
      </tr>
      <tr>
        <td id="L1099" data-line-number="1099"></td>
        <td id="LC1099">            th = pFD-&gt;<span>GetEnclosingMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L1100" data-line-number="1100"></td>
        <td id="LC1100">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1101" data-line-number="1101"></td>
        <td id="LC1101">
</td>
      </tr>
      <tr>
        <td id="L1102" data-line-number="1102"></td>
        <td id="LC1102">        <span>case</span> mdtMemberRef:</td>
      </tr>
      <tr>
        <td id="L1103" data-line-number="1103"></td>
        <td id="LC1103">            {</td>
      </tr>
      <tr>
        <td id="L1104" data-line-number="1104"></td>
        <td id="LC1104">                SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L1105" data-line-number="1105"></td>
        <td id="LC1105">                <span>GetTypeContext</span>(pResolvedToken-&gt;<span>tokenContext</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L1106" data-line-number="1106"></td>
        <td id="LC1106">
</td>
      </tr>
      <tr>
        <td id="L1107" data-line-number="1107"></td>
        <td id="LC1107">                <span>MemberLoader::GetDescFromMemberRef</span>(pModule, metaTOK, &amp;pMD, &amp;pFD, &amp;typeContext, (tokenType != CORINFO_TOKENKIND_Ldtoken),</td>
      </tr>
      <tr>
        <td id="L1108" data-line-number="1108"></td>
        <td id="LC1108">                    &amp;th, <span>TRUE</span>, &amp;pResolvedToken-&gt;<span>pTypeSpec</span>, &amp;pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L1109" data-line-number="1109"></td>
        <td id="LC1109">
</td>
      </tr>
      <tr>
        <td id="L1110" data-line-number="1110"></td>
        <td id="LC1110">                <span>_ASSERTE</span>((pMD != <span>NULL</span>) ^ (pFD != <span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L1111" data-line-number="1111"></td>
        <td id="LC1111">                <span>_ASSERTE</span>(!th.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L1112" data-line-number="1112"></td>
        <td id="LC1112">
</td>
      </tr>
      <tr>
        <td id="L1113" data-line-number="1113"></td>
        <td id="LC1113">                <span>if</span> (pMD != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1114" data-line-number="1114"></td>
        <td id="LC1114">                {</td>
      </tr>
      <tr>
        <td id="L1115" data-line-number="1115"></td>
        <td id="LC1115">                    <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Method) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1116" data-line-number="1116"></td>
        <td id="LC1116">                        <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1117" data-line-number="1117"></td>
        <td id="LC1117">                }</td>
      </tr>
      <tr>
        <td id="L1118" data-line-number="1118"></td>
        <td id="LC1118">                <span>else</span></td>
      </tr>
      <tr>
        <td id="L1119" data-line-number="1119"></td>
        <td id="LC1119">                {</td>
      </tr>
      <tr>
        <td id="L1120" data-line-number="1120"></td>
        <td id="LC1120">                    <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Field) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1121" data-line-number="1121"></td>
        <td id="LC1121">                        <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1122" data-line-number="1122"></td>
        <td id="LC1122">                }</td>
      </tr>
      <tr>
        <td id="L1123" data-line-number="1123"></td>
        <td id="LC1123">            }</td>
      </tr>
      <tr>
        <td id="L1124" data-line-number="1124"></td>
        <td id="LC1124">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1125" data-line-number="1125"></td>
        <td id="LC1125">
</td>
      </tr>
      <tr>
        <td id="L1126" data-line-number="1126"></td>
        <td id="LC1126">        <span>case</span> mdtMethodSpec:</td>
      </tr>
      <tr>
        <td id="L1127" data-line-number="1127"></td>
        <td id="LC1127">            {</td>
      </tr>
      <tr>
        <td id="L1128" data-line-number="1128"></td>
        <td id="LC1128">                <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Method) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1129" data-line-number="1129"></td>
        <td id="LC1129">                    <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1130" data-line-number="1130"></td>
        <td id="LC1130">
</td>
      </tr>
      <tr>
        <td id="L1131" data-line-number="1131"></td>
        <td id="LC1131">                SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L1132" data-line-number="1132"></td>
        <td id="LC1132">                <span>GetTypeContext</span>(pResolvedToken-&gt;<span>tokenContext</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L1133" data-line-number="1133"></td>
        <td id="LC1133">
</td>
      </tr>
      <tr>
        <td id="L1134" data-line-number="1134"></td>
        <td id="LC1134">                <span><span>//</span> We need the method desc to carry exact instantiation, thus allowInstParam == FALSE.</span></td>
      </tr>
      <tr>
        <td id="L1135" data-line-number="1135"></td>
        <td id="LC1135">                pMD = <span>MemberLoader::GetMethodDescFromMethodSpec</span>(pModule, metaTOK, &amp;typeContext, (tokenType != CORINFO_TOKENKIND_Ldtoken), <span>FALSE</span> <span><span>/*</span> allowInstParam <span>*/</span></span>,</td>
      </tr>
      <tr>
        <td id="L1136" data-line-number="1136"></td>
        <td id="LC1136">                    &amp;th, <span>TRUE</span>, &amp;pResolvedToken-&gt;<span>pTypeSpec</span>, &amp;pResolvedToken-&gt;<span>cbTypeSpec</span>, &amp;pResolvedToken-&gt;<span>pMethodSpec</span>, &amp;pResolvedToken-&gt;<span>cbMethodSpec</span>);</td>
      </tr>
      <tr>
        <td id="L1137" data-line-number="1137"></td>
        <td id="LC1137">            }</td>
      </tr>
      <tr>
        <td id="L1138" data-line-number="1138"></td>
        <td id="LC1138">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1139" data-line-number="1139"></td>
        <td id="LC1139">
</td>
      </tr>
      <tr>
        <td id="L1140" data-line-number="1140"></td>
        <td id="LC1140">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L1141" data-line-number="1141"></td>
        <td id="LC1141">            <span>ThrowBadTokenException</span>(pResolvedToken);</td>
      </tr>
      <tr>
        <td id="L1142" data-line-number="1142"></td>
        <td id="LC1142">        }</td>
      </tr>
      <tr>
        <td id="L1143" data-line-number="1143"></td>
        <td id="LC1143">
</td>
      </tr>
      <tr>
        <td id="L1144" data-line-number="1144"></td>
        <td id="LC1144">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1145" data-line-number="1145"></td>
        <td id="LC1145">        <span><span>//</span> Module dependency tracking</span></td>
      </tr>
      <tr>
        <td id="L1146" data-line-number="1146"></td>
        <td id="LC1146">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1147" data-line-number="1147"></td>
        <td id="LC1147">        <span>if</span> (pMD != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1148" data-line-number="1148"></td>
        <td id="LC1148">        {</td>
      </tr>
      <tr>
        <td id="L1149" data-line-number="1149"></td>
        <td id="LC1149">            <span>ScanToken</span>(pModule, pResolvedToken, th, pMD);</td>
      </tr>
      <tr>
        <td id="L1150" data-line-number="1150"></td>
        <td id="LC1150">        }</td>
      </tr>
      <tr>
        <td id="L1151" data-line-number="1151"></td>
        <td id="LC1151">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L1152" data-line-number="1152"></td>
        <td id="LC1152">        <span>if</span> (pFD != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1153" data-line-number="1153"></td>
        <td id="LC1153">        {</td>
      </tr>
      <tr>
        <td id="L1154" data-line-number="1154"></td>
        <td id="LC1154">            <span>if</span> (pFD-&gt;<span>IsStatic</span>())</td>
      </tr>
      <tr>
        <td id="L1155" data-line-number="1155"></td>
        <td id="LC1155">                <span>ScanToken</span>(pModule, pResolvedToken, th);</td>
      </tr>
      <tr>
        <td id="L1156" data-line-number="1156"></td>
        <td id="LC1156">        }</td>
      </tr>
      <tr>
        <td id="L1157" data-line-number="1157"></td>
        <td id="LC1157">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L1158" data-line-number="1158"></td>
        <td id="LC1158">        {</td>
      </tr>
      <tr>
        <td id="L1159" data-line-number="1159"></td>
        <td id="LC1159">            <span><span>//</span> It should not be required to trigger the modules cctors for ldtoken, it is done for backward compatibility only.</span></td>
      </tr>
      <tr>
        <td id="L1160" data-line-number="1160"></td>
        <td id="LC1160">            <span>if</span> (tokenType == CORINFO_TOKENKIND_Box || tokenType == CORINFO_TOKENKIND_Constrained || tokenType == CORINFO_TOKENKIND_Ldtoken)</td>
      </tr>
      <tr>
        <td id="L1161" data-line-number="1161"></td>
        <td id="LC1161">                <span>ScanToken</span>(pModule, pResolvedToken, th);</td>
      </tr>
      <tr>
        <td id="L1162" data-line-number="1162"></td>
        <td id="LC1162">        }</td>
      </tr>
      <tr>
        <td id="L1163" data-line-number="1163"></td>
        <td id="LC1163">    }</td>
      </tr>
      <tr>
        <td id="L1164" data-line-number="1164"></td>
        <td id="LC1164">
</td>
      </tr>
      <tr>
        <td id="L1165" data-line-number="1165"></td>
        <td id="LC1165">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1166" data-line-number="1166"></td>
        <td id="LC1166">    <span><span>//</span> tokenType specific verification and transformations</span></td>
      </tr>
      <tr>
        <td id="L1167" data-line-number="1167"></td>
        <td id="LC1167">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1168" data-line-number="1168"></td>
        <td id="LC1168">    CorElementType et = th.<span>GetInternalCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L1169" data-line-number="1169"></td>
        <td id="LC1169">    <span>switch</span> (tokenType)</td>
      </tr>
      <tr>
        <td id="L1170" data-line-number="1170"></td>
        <td id="LC1170">    {</td>
      </tr>
      <tr>
        <td id="L1171" data-line-number="1171"></td>
        <td id="LC1171">        <span>case</span> CORINFO_TOKENKIND_Ldtoken:</td>
      </tr>
      <tr>
        <td id="L1172" data-line-number="1172"></td>
        <td id="LC1172">            <span><span>//</span> Allow everything.</span></td>
      </tr>
      <tr>
        <td id="L1173" data-line-number="1173"></td>
        <td id="LC1173">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1174" data-line-number="1174"></td>
        <td id="LC1174">
</td>
      </tr>
      <tr>
        <td id="L1175" data-line-number="1175"></td>
        <td id="LC1175">        <span>case</span> CORINFO_TOKENKIND_Newarr:</td>
      </tr>
      <tr>
        <td id="L1176" data-line-number="1176"></td>
        <td id="LC1176">            <span><span>//</span> Disallow ELEMENT_TYPE_BYREF and ELEMENT_TYPE_VOID</span></td>
      </tr>
      <tr>
        <td id="L1177" data-line-number="1177"></td>
        <td id="LC1177">            <span>if</span> (et == ELEMENT_TYPE_BYREF || et == ELEMENT_TYPE_VOID)</td>
      </tr>
      <tr>
        <td id="L1178" data-line-number="1178"></td>
        <td id="LC1178">                <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>);</td>
      </tr>
      <tr>
        <td id="L1179" data-line-number="1179"></td>
        <td id="LC1179">
</td>
      </tr>
      <tr>
        <td id="L1180" data-line-number="1180"></td>
        <td id="LC1180">            th = <span>ClassLoader::LoadArrayTypeThrowing</span>(th);</td>
      </tr>
      <tr>
        <td id="L1181" data-line-number="1181"></td>
        <td id="LC1181">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1182" data-line-number="1182"></td>
        <td id="LC1182">
</td>
      </tr>
      <tr>
        <td id="L1183" data-line-number="1183"></td>
        <td id="LC1183">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L1184" data-line-number="1184"></td>
        <td id="LC1184">            <span><span>//</span> Disallow ELEMENT_TYPE_BYREF and ELEMENT_TYPE_VOID</span></td>
      </tr>
      <tr>
        <td id="L1185" data-line-number="1185"></td>
        <td id="LC1185">            <span>if</span> (et == ELEMENT_TYPE_BYREF || et == ELEMENT_TYPE_VOID)</td>
      </tr>
      <tr>
        <td id="L1186" data-line-number="1186"></td>
        <td id="LC1186">                <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>);</td>
      </tr>
      <tr>
        <td id="L1187" data-line-number="1187"></td>
        <td id="LC1187">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1188" data-line-number="1188"></td>
        <td id="LC1188">    }</td>
      </tr>
      <tr>
        <td id="L1189" data-line-number="1189"></td>
        <td id="LC1189">
</td>
      </tr>
      <tr>
        <td id="L1190" data-line-number="1190"></td>
        <td id="LC1190">    <span><span>//</span> The JIT interface should always return fully loaded types</span></td>
      </tr>
      <tr>
        <td id="L1191" data-line-number="1191"></td>
        <td id="LC1191">    <span>_ASSERTE</span>(th.<span>IsFullyLoaded</span>());</td>
      </tr>
      <tr>
        <td id="L1192" data-line-number="1192"></td>
        <td id="LC1192">
</td>
      </tr>
      <tr>
        <td id="L1193" data-line-number="1193"></td>
        <td id="LC1193">    pResolvedToken-&gt;<span>hClass</span> = <span>CORINFO_CLASS_HANDLE</span>(th.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L1194" data-line-number="1194"></td>
        <td id="LC1194">    pResolvedToken-&gt;<span>hMethod</span> = <span>CORINFO_METHOD_HANDLE</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L1195" data-line-number="1195"></td>
        <td id="LC1195">    pResolvedToken-&gt;<span>hField</span> = <span>CORINFO_FIELD_HANDLE</span>(pFD);</td>
      </tr>
      <tr>
        <td id="L1196" data-line-number="1196"></td>
        <td id="LC1196">
</td>
      </tr>
      <tr>
        <td id="L1197" data-line-number="1197"></td>
        <td id="LC1197">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L1198" data-line-number="1198"></td>
        <td id="LC1198">}</td>
      </tr>
      <tr>
        <td id="L1199" data-line-number="1199"></td>
        <td id="LC1199">
</td>
      </tr>
      <tr>
        <td id="L1200" data-line-number="1200"></td>
        <td id="LC1200"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L1201" data-line-number="1201"></td>
        <td id="LC1201"><span>struct</span> <span>TryResolveTokenFilterParam</span></td>
      </tr>
      <tr>
        <td id="L1202" data-line-number="1202"></td>
        <td id="LC1202">{</td>
      </tr>
      <tr>
        <td id="L1203" data-line-number="1203"></td>
        <td id="LC1203">    CEEInfo* m_this;</td>
      </tr>
      <tr>
        <td id="L1204" data-line-number="1204"></td>
        <td id="LC1204">    CORINFO_RESOLVED_TOKEN* m_resolvedToken;</td>
      </tr>
      <tr>
        <td id="L1205" data-line-number="1205"></td>
        <td id="LC1205">    EXCEPTION_POINTERS m_exceptionPointers;</td>
      </tr>
      <tr>
        <td id="L1206" data-line-number="1206"></td>
        <td id="LC1206">    <span>bool</span> m_success;</td>
      </tr>
      <tr>
        <td id="L1207" data-line-number="1207"></td>
        <td id="LC1207">};</td>
      </tr>
      <tr>
        <td id="L1208" data-line-number="1208"></td>
        <td id="LC1208">
</td>
      </tr>
      <tr>
        <td id="L1209" data-line-number="1209"></td>
        <td id="LC1209"><span>bool</span> <span>isValidTokenForTryResolveToken</span>(CEEInfo* info, CORINFO_RESOLVED_TOKEN* resolvedToken)</td>
      </tr>
      <tr>
        <td id="L1210" data-line-number="1210"></td>
        <td id="LC1210">{</td>
      </tr>
      <tr>
        <td id="L1211" data-line-number="1211"></td>
        <td id="LC1211">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1212" data-line-number="1212"></td>
        <td id="LC1212">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L1213" data-line-number="1213"></td>
        <td id="LC1213">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L1214" data-line-number="1214"></td>
        <td id="LC1214">        MODE_ANY;</td>
      </tr>
      <tr>
        <td id="L1215" data-line-number="1215"></td>
        <td id="LC1215">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1216" data-line-number="1216"></td>
        <td id="LC1216">
</td>
      </tr>
      <tr>
        <td id="L1217" data-line-number="1217"></td>
        <td id="LC1217">    <span>if</span> (!info-&gt;<span>isValidToken</span>(resolvedToken-&gt;<span>tokenScope</span>, resolvedToken-&gt;<span>token</span>))</td>
      </tr>
      <tr>
        <td id="L1218" data-line-number="1218"></td>
        <td id="LC1218">    {</td>
      </tr>
      <tr>
        <td id="L1219" data-line-number="1219"></td>
        <td id="LC1219">        <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1220" data-line-number="1220"></td>
        <td id="LC1220">    }</td>
      </tr>
      <tr>
        <td id="L1221" data-line-number="1221"></td>
        <td id="LC1221">
</td>
      </tr>
      <tr>
        <td id="L1222" data-line-number="1222"></td>
        <td id="LC1222">    CorInfoTokenKind tokenType = resolvedToken-&gt;<span>tokenType</span>;</td>
      </tr>
      <tr>
        <td id="L1223" data-line-number="1223"></td>
        <td id="LC1223">    <span>switch</span> (<span>TypeFromToken</span>(resolvedToken-&gt;<span>token</span>))</td>
      </tr>
      <tr>
        <td id="L1224" data-line-number="1224"></td>
        <td id="LC1224">    {</td>
      </tr>
      <tr>
        <td id="L1225" data-line-number="1225"></td>
        <td id="LC1225">    <span>case</span> mdtModuleRef:</td>
      </tr>
      <tr>
        <td id="L1226" data-line-number="1226"></td>
        <td id="LC1226">    <span>case</span> mdtTypeDef:</td>
      </tr>
      <tr>
        <td id="L1227" data-line-number="1227"></td>
        <td id="LC1227">    <span>case</span> mdtTypeRef:</td>
      </tr>
      <tr>
        <td id="L1228" data-line-number="1228"></td>
        <td id="LC1228">    <span>case</span> mdtTypeSpec:</td>
      </tr>
      <tr>
        <td id="L1229" data-line-number="1229"></td>
        <td id="LC1229">        <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Class) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1230" data-line-number="1230"></td>
        <td id="LC1230">            <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1231" data-line-number="1231"></td>
        <td id="LC1231">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1232" data-line-number="1232"></td>
        <td id="LC1232">
</td>
      </tr>
      <tr>
        <td id="L1233" data-line-number="1233"></td>
        <td id="LC1233">    <span>case</span> mdtMethodDef:</td>
      </tr>
      <tr>
        <td id="L1234" data-line-number="1234"></td>
        <td id="LC1234">    <span>case</span> mdtMethodSpec:</td>
      </tr>
      <tr>
        <td id="L1235" data-line-number="1235"></td>
        <td id="LC1235">        <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Method) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1236" data-line-number="1236"></td>
        <td id="LC1236">            <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1237" data-line-number="1237"></td>
        <td id="LC1237">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1238" data-line-number="1238"></td>
        <td id="LC1238">
</td>
      </tr>
      <tr>
        <td id="L1239" data-line-number="1239"></td>
        <td id="LC1239">    <span>case</span> mdtFieldDef:</td>
      </tr>
      <tr>
        <td id="L1240" data-line-number="1240"></td>
        <td id="LC1240">        <span>if</span> ((tokenType &amp; CORINFO_TOKENKIND_Field) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1241" data-line-number="1241"></td>
        <td id="LC1241">            <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1242" data-line-number="1242"></td>
        <td id="LC1242">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1243" data-line-number="1243"></td>
        <td id="LC1243">
</td>
      </tr>
      <tr>
        <td id="L1244" data-line-number="1244"></td>
        <td id="LC1244">    <span>case</span> mdtMemberRef:</td>
      </tr>
      <tr>
        <td id="L1245" data-line-number="1245"></td>
        <td id="LC1245">        <span>if</span> ((tokenType &amp; (CORINFO_TOKENKIND_Method | CORINFO_TOKENKIND_Field)) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L1246" data-line-number="1246"></td>
        <td id="LC1246">            <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1247" data-line-number="1247"></td>
        <td id="LC1247">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1248" data-line-number="1248"></td>
        <td id="LC1248">
</td>
      </tr>
      <tr>
        <td id="L1249" data-line-number="1249"></td>
        <td id="LC1249">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L1250" data-line-number="1250"></td>
        <td id="LC1250">        <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1251" data-line-number="1251"></td>
        <td id="LC1251">    }</td>
      </tr>
      <tr>
        <td id="L1252" data-line-number="1252"></td>
        <td id="LC1252">
</td>
      </tr>
      <tr>
        <td id="L1253" data-line-number="1253"></td>
        <td id="LC1253">    <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L1254" data-line-number="1254"></td>
        <td id="LC1254">}</td>
      </tr>
      <tr>
        <td id="L1255" data-line-number="1255"></td>
        <td id="LC1255">
</td>
      </tr>
      <tr>
        <td id="L1256" data-line-number="1256"></td>
        <td id="LC1256">LONG <span>EEFilterException</span>(<span>struct</span> <span>_EXCEPTION_POINTERS</span>* exceptionPointers, <span>void</span>* unused);</td>
      </tr>
      <tr>
        <td id="L1257" data-line-number="1257"></td>
        <td id="LC1257">
</td>
      </tr>
      <tr>
        <td id="L1258" data-line-number="1258"></td>
        <td id="LC1258">LONG <span>TryResolveTokenFilter</span>(<span>struct</span> <span>_EXCEPTION_POINTERS</span>* exceptionPointers, <span>void</span>* theParam)</td>
      </tr>
      <tr>
        <td id="L1259" data-line-number="1259"></td>
        <td id="LC1259">{</td>
      </tr>
      <tr>
        <td id="L1260" data-line-number="1260"></td>
        <td id="LC1260">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1261" data-line-number="1261"></td>
        <td id="LC1261">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L1262" data-line-number="1262"></td>
        <td id="LC1262">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L1263" data-line-number="1263"></td>
        <td id="LC1263">        MODE_ANY;</td>
      </tr>
      <tr>
        <td id="L1264" data-line-number="1264"></td>
        <td id="LC1264">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1265" data-line-number="1265"></td>
        <td id="LC1265">
</td>
      </tr>
      <tr>
        <td id="L1266" data-line-number="1266"></td>
        <td id="LC1266">    <span><span>//</span> Backward compatibility: Convert bad image format exceptions thrown while resolving tokens</span></td>
      </tr>
      <tr>
        <td id="L1267" data-line-number="1267"></td>
        <td id="LC1267">    <span><span>//</span> to simple true/false successes. This is done for backward compatibility only. Ideally,</span></td>
      </tr>
      <tr>
        <td id="L1268" data-line-number="1268"></td>
        <td id="LC1268">    <span><span>//</span> we would always treat bad tokens in the IL  stream as fatal errors.</span></td>
      </tr>
      <tr>
        <td id="L1269" data-line-number="1269"></td>
        <td id="LC1269">    <span>if</span> (exceptionPointers-&gt;<span>ExceptionRecord</span>-&gt;<span>ExceptionCode</span> == EXCEPTION_COMPLUS)</td>
      </tr>
      <tr>
        <td id="L1270" data-line-number="1270"></td>
        <td id="LC1270">    {</td>
      </tr>
      <tr>
        <td id="L1271" data-line-number="1271"></td>
        <td id="LC1271">        <span>auto</span>* param = <span>reinterpret_cast</span>&lt;TryResolveTokenFilterParam*&gt;(theParam);</td>
      </tr>
      <tr>
        <td id="L1272" data-line-number="1272"></td>
        <td id="LC1272">        <span>if</span> (!<span>isValidTokenForTryResolveToken</span>(param-&gt;<span>m_this</span>, param-&gt;<span>m_resolvedToken</span>))</td>
      </tr>
      <tr>
        <td id="L1273" data-line-number="1273"></td>
        <td id="LC1273">        {</td>
      </tr>
      <tr>
        <td id="L1274" data-line-number="1274"></td>
        <td id="LC1274">            param-&gt;<span>m_exceptionPointers</span> = *exceptionPointers;</td>
      </tr>
      <tr>
        <td id="L1275" data-line-number="1275"></td>
        <td id="LC1275">            <span>return</span> <span>EEFilterException</span>(exceptionPointers, <span>nullptr</span>);</td>
      </tr>
      <tr>
        <td id="L1276" data-line-number="1276"></td>
        <td id="LC1276">        }</td>
      </tr>
      <tr>
        <td id="L1277" data-line-number="1277"></td>
        <td id="LC1277">    }</td>
      </tr>
      <tr>
        <td id="L1278" data-line-number="1278"></td>
        <td id="LC1278">
</td>
      </tr>
      <tr>
        <td id="L1279" data-line-number="1279"></td>
        <td id="LC1279">    <span>return</span> EXCEPTION_CONTINUE_SEARCH;</td>
      </tr>
      <tr>
        <td id="L1280" data-line-number="1280"></td>
        <td id="LC1280">}</td>
      </tr>
      <tr>
        <td id="L1281" data-line-number="1281"></td>
        <td id="LC1281">
</td>
      </tr>
      <tr>
        <td id="L1282" data-line-number="1282"></td>
        <td id="LC1282"><span>bool</span> <span>CEEInfo::tryResolveToken</span>(CORINFO_RESOLVED_TOKEN* resolvedToken)</td>
      </tr>
      <tr>
        <td id="L1283" data-line-number="1283"></td>
        <td id="LC1283">{</td>
      </tr>
      <tr>
        <td id="L1284" data-line-number="1284"></td>
        <td id="LC1284">    <span><span>//</span> No dynamic contract here because SEH is used</span></td>
      </tr>
      <tr>
        <td id="L1285" data-line-number="1285"></td>
        <td id="LC1285">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L1286" data-line-number="1286"></td>
        <td id="LC1286">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L1287" data-line-number="1287"></td>
        <td id="LC1287">    STATIC_CONTRACT_MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1288" data-line-number="1288"></td>
        <td id="LC1288">
</td>
      </tr>
      <tr>
        <td id="L1289" data-line-number="1289"></td>
        <td id="LC1289">    TryResolveTokenFilterParam param;</td>
      </tr>
      <tr>
        <td id="L1290" data-line-number="1290"></td>
        <td id="LC1290">    param.<span>m_this</span> = <span>this</span>;</td>
      </tr>
      <tr>
        <td id="L1291" data-line-number="1291"></td>
        <td id="LC1291">    param.<span>m_resolvedToken</span> = resolvedToken;</td>
      </tr>
      <tr>
        <td id="L1292" data-line-number="1292"></td>
        <td id="LC1292">    param.<span>m_success</span> = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L1293" data-line-number="1293"></td>
        <td id="LC1293">
</td>
      </tr>
      <tr>
        <td id="L1294" data-line-number="1294"></td>
        <td id="LC1294">    <span>PAL_TRY</span>(TryResolveTokenFilterParam*, pParam, &amp;param)</td>
      </tr>
      <tr>
        <td id="L1295" data-line-number="1295"></td>
        <td id="LC1295">    {</td>
      </tr>
      <tr>
        <td id="L1296" data-line-number="1296"></td>
        <td id="LC1296">        pParam-&gt;<span>m_this</span>-&gt;<span>resolveToken</span>(pParam-&gt;<span>m_resolvedToken</span>);</td>
      </tr>
      <tr>
        <td id="L1297" data-line-number="1297"></td>
        <td id="LC1297">    }</td>
      </tr>
      <tr>
        <td id="L1298" data-line-number="1298"></td>
        <td id="LC1298">    <span>PAL_EXCEPT_FILTER</span>(TryResolveTokenFilter)</td>
      </tr>
      <tr>
        <td id="L1299" data-line-number="1299"></td>
        <td id="LC1299">    {</td>
      </tr>
      <tr>
        <td id="L1300" data-line-number="1300"></td>
        <td id="LC1300">        <span>if</span> (param.<span>m_exceptionPointers</span>.<span>ExceptionRecord</span>-&gt;<span>ExceptionCode</span> == EXCEPTION_COMPLUS)</td>
      </tr>
      <tr>
        <td id="L1301" data-line-number="1301"></td>
        <td id="LC1301">        {</td>
      </tr>
      <tr>
        <td id="L1302" data-line-number="1302"></td>
        <td id="LC1302">            <span>HandleException</span>(&amp;param.<span>m_exceptionPointers</span>);</td>
      </tr>
      <tr>
        <td id="L1303" data-line-number="1303"></td>
        <td id="LC1303">        }</td>
      </tr>
      <tr>
        <td id="L1304" data-line-number="1304"></td>
        <td id="LC1304">
</td>
      </tr>
      <tr>
        <td id="L1305" data-line-number="1305"></td>
        <td id="LC1305">        param.<span>m_success</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1306" data-line-number="1306"></td>
        <td id="LC1306">    }</td>
      </tr>
      <tr>
        <td id="L1307" data-line-number="1307"></td>
        <td id="LC1307">    PAL_ENDTRY</td>
      </tr>
      <tr>
        <td id="L1308" data-line-number="1308"></td>
        <td id="LC1308">
</td>
      </tr>
      <tr>
        <td id="L1309" data-line-number="1309"></td>
        <td id="LC1309">    <span>return</span> param.<span>m_success</span>;</td>
      </tr>
      <tr>
        <td id="L1310" data-line-number="1310"></td>
        <td id="LC1310">}</td>
      </tr>
      <tr>
        <td id="L1311" data-line-number="1311"></td>
        <td id="LC1311">
</td>
      </tr>
      <tr>
        <td id="L1312" data-line-number="1312"></td>
        <td id="LC1312"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L1313" data-line-number="1313"></td>
        <td id="LC1313"><span><span>//</span> We have a few frequently used constants in mscorlib that are defined as</span></td>
      </tr>
      <tr>
        <td id="L1314" data-line-number="1314"></td>
        <td id="LC1314"><span><span>//</span> readonly static fields for historic reasons. Check for them here and</span></td>
      </tr>
      <tr>
        <td id="L1315" data-line-number="1315"></td>
        <td id="LC1315"><span><span>//</span> allow them to be treated as actual constants by the JIT.</span></td>
      </tr>
      <tr>
        <td id="L1316" data-line-number="1316"></td>
        <td id="LC1316"><span>static</span> CORINFO_FIELD_ACCESSOR <span>getFieldIntrinsic</span>(FieldDesc * field)</td>
      </tr>
      <tr>
        <td id="L1317" data-line-number="1317"></td>
        <td id="LC1317">{</td>
      </tr>
      <tr>
        <td id="L1318" data-line-number="1318"></td>
        <td id="LC1318">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L1319" data-line-number="1319"></td>
        <td id="LC1319">
</td>
      </tr>
      <tr>
        <td id="L1320" data-line-number="1320"></td>
        <td id="LC1320">    <span>if</span> (<span>MscorlibBinder::GetField</span>(FIELD__STRING__EMPTY) == field)</td>
      </tr>
      <tr>
        <td id="L1321" data-line-number="1321"></td>
        <td id="LC1321">    {</td>
      </tr>
      <tr>
        <td id="L1322" data-line-number="1322"></td>
        <td id="LC1322">        <span>return</span> CORINFO_FIELD_INTRINSIC_EMPTY_STRING;</td>
      </tr>
      <tr>
        <td id="L1323" data-line-number="1323"></td>
        <td id="LC1323">    }</td>
      </tr>
      <tr>
        <td id="L1324" data-line-number="1324"></td>
        <td id="LC1324">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1325" data-line-number="1325"></td>
        <td id="LC1325">    <span>if</span> ((<span>MscorlibBinder::GetField</span>(FIELD__INTPTR__ZERO) == field) ||</td>
      </tr>
      <tr>
        <td id="L1326" data-line-number="1326"></td>
        <td id="LC1326">        (<span>MscorlibBinder::GetField</span>(FIELD__UINTPTR__ZERO) == field))</td>
      </tr>
      <tr>
        <td id="L1327" data-line-number="1327"></td>
        <td id="LC1327">    {</td>
      </tr>
      <tr>
        <td id="L1328" data-line-number="1328"></td>
        <td id="LC1328">        <span>return</span> CORINFO_FIELD_INTRINSIC_ZERO;</td>
      </tr>
      <tr>
        <td id="L1329" data-line-number="1329"></td>
        <td id="LC1329">    }</td>
      </tr>
      <tr>
        <td id="L1330" data-line-number="1330"></td>
        <td id="LC1330">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1331" data-line-number="1331"></td>
        <td id="LC1331">    <span>if</span> (<span>MscorlibBinder::GetField</span>(FIELD__BITCONVERTER__ISLITTLEENDIAN) == field)</td>
      </tr>
      <tr>
        <td id="L1332" data-line-number="1332"></td>
        <td id="LC1332">    {</td>
      </tr>
      <tr>
        <td id="L1333" data-line-number="1333"></td>
        <td id="LC1333">        <span>return</span> CORINFO_FIELD_INTRINSIC_ISLITTLEENDIAN;</td>
      </tr>
      <tr>
        <td id="L1334" data-line-number="1334"></td>
        <td id="LC1334">    }</td>
      </tr>
      <tr>
        <td id="L1335" data-line-number="1335"></td>
        <td id="LC1335">
</td>
      </tr>
      <tr>
        <td id="L1336" data-line-number="1336"></td>
        <td id="LC1336">    <span>return</span> (CORINFO_FIELD_ACCESSOR)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L1337" data-line-number="1337"></td>
        <td id="LC1337">}</td>
      </tr>
      <tr>
        <td id="L1338" data-line-number="1338"></td>
        <td id="LC1338">
</td>
      </tr>
      <tr>
        <td id="L1339" data-line-number="1339"></td>
        <td id="LC1339"><span>static</span> CorInfoHelpFunc <span>getGenericStaticsHelper</span>(FieldDesc * pField)</td>
      </tr>
      <tr>
        <td id="L1340" data-line-number="1340"></td>
        <td id="LC1340">{</td>
      </tr>
      <tr>
        <td id="L1341" data-line-number="1341"></td>
        <td id="LC1341">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L1342" data-line-number="1342"></td>
        <td id="LC1342">
</td>
      </tr>
      <tr>
        <td id="L1343" data-line-number="1343"></td>
        <td id="LC1343">    <span>int</span> helper = CORINFO_HELP_GETGENERICS_NONGCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1344" data-line-number="1344"></td>
        <td id="LC1344">
</td>
      </tr>
      <tr>
        <td id="L1345" data-line-number="1345"></td>
        <td id="LC1345">    <span>if</span> (pField-&gt;<span>GetFieldType</span>() == ELEMENT_TYPE_CLASS ||</td>
      </tr>
      <tr>
        <td id="L1346" data-line-number="1346"></td>
        <td id="LC1346">        pField-&gt;<span>GetFieldType</span>() == ELEMENT_TYPE_VALUETYPE)</td>
      </tr>
      <tr>
        <td id="L1347" data-line-number="1347"></td>
        <td id="LC1347">    {</td>
      </tr>
      <tr>
        <td id="L1348" data-line-number="1348"></td>
        <td id="LC1348">        helper = CORINFO_HELP_GETGENERICS_GCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1349" data-line-number="1349"></td>
        <td id="LC1349">    }</td>
      </tr>
      <tr>
        <td id="L1350" data-line-number="1350"></td>
        <td id="LC1350">
</td>
      </tr>
      <tr>
        <td id="L1351" data-line-number="1351"></td>
        <td id="LC1351">    <span>if</span> (pField-&gt;<span>IsThreadStatic</span>())</td>
      </tr>
      <tr>
        <td id="L1352" data-line-number="1352"></td>
        <td id="LC1352">    {</td>
      </tr>
      <tr>
        <td id="L1353" data-line-number="1353"></td>
        <td id="LC1353">        <span>const</span> <span>int</span> delta = CORINFO_HELP_GETGENERICS_GCTHREADSTATIC_BASE - CORINFO_HELP_GETGENERICS_GCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1354" data-line-number="1354"></td>
        <td id="LC1354">
</td>
      </tr>
      <tr>
        <td id="L1355" data-line-number="1355"></td>
        <td id="LC1355">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETGENERICS_NONGCTHREADSTATIC_BASE</td>
      </tr>
      <tr>
        <td id="L1356" data-line-number="1356"></td>
        <td id="LC1356">            == CORINFO_HELP_GETGENERICS_NONGCSTATIC_BASE + delta);</td>
      </tr>
      <tr>
        <td id="L1357" data-line-number="1357"></td>
        <td id="LC1357">
</td>
      </tr>
      <tr>
        <td id="L1358" data-line-number="1358"></td>
        <td id="LC1358">        helper += (CORINFO_HELP_GETGENERICS_GCTHREADSTATIC_BASE - CORINFO_HELP_GETGENERICS_GCSTATIC_BASE);</td>
      </tr>
      <tr>
        <td id="L1359" data-line-number="1359"></td>
        <td id="LC1359">    }</td>
      </tr>
      <tr>
        <td id="L1360" data-line-number="1360"></td>
        <td id="LC1360">
</td>
      </tr>
      <tr>
        <td id="L1361" data-line-number="1361"></td>
        <td id="LC1361">    <span>return</span> (CorInfoHelpFunc)helper;</td>
      </tr>
      <tr>
        <td id="L1362" data-line-number="1362"></td>
        <td id="LC1362">}</td>
      </tr>
      <tr>
        <td id="L1363" data-line-number="1363"></td>
        <td id="LC1363">
</td>
      </tr>
      <tr>
        <td id="L1364" data-line-number="1364"></td>
        <td id="LC1364">CorInfoHelpFunc <span>CEEInfo::getSharedStaticsHelper</span>(FieldDesc * pField, MethodTable * pFieldMT)</td>
      </tr>
      <tr>
        <td id="L1365" data-line-number="1365"></td>
        <td id="LC1365">{</td>
      </tr>
      <tr>
        <td id="L1366" data-line-number="1366"></td>
        <td id="LC1366">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L1367" data-line-number="1367"></td>
        <td id="LC1367">
</td>
      </tr>
      <tr>
        <td id="L1368" data-line-number="1368"></td>
        <td id="LC1368">    <span>int</span> helper = CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1369" data-line-number="1369"></td>
        <td id="LC1369">
</td>
      </tr>
      <tr>
        <td id="L1370" data-line-number="1370"></td>
        <td id="LC1370">    <span>if</span> (pField-&gt;<span>GetFieldType</span>() == ELEMENT_TYPE_CLASS ||</td>
      </tr>
      <tr>
        <td id="L1371" data-line-number="1371"></td>
        <td id="LC1371">        pField-&gt;<span>GetFieldType</span>() == ELEMENT_TYPE_VALUETYPE)</td>
      </tr>
      <tr>
        <td id="L1372" data-line-number="1372"></td>
        <td id="LC1372">    {</td>
      </tr>
      <tr>
        <td id="L1373" data-line-number="1373"></td>
        <td id="LC1373">        helper = CORINFO_HELP_GETSHARED_GCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1374" data-line-number="1374"></td>
        <td id="LC1374">    }</td>
      </tr>
      <tr>
        <td id="L1375" data-line-number="1375"></td>
        <td id="LC1375">
</td>
      </tr>
      <tr>
        <td id="L1376" data-line-number="1376"></td>
        <td id="LC1376">    <span>if</span> (pFieldMT-&gt;<span>IsDynamicStatics</span>())</td>
      </tr>
      <tr>
        <td id="L1377" data-line-number="1377"></td>
        <td id="LC1377">    {</td>
      </tr>
      <tr>
        <td id="L1378" data-line-number="1378"></td>
        <td id="LC1378">        <span>const</span> <span>int</span> delta = CORINFO_HELP_GETSHARED_GCSTATIC_BASE_DYNAMICCLASS - CORINFO_HELP_GETSHARED_GCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1379" data-line-number="1379"></td>
        <td id="LC1379">
</td>
      </tr>
      <tr>
        <td id="L1380" data-line-number="1380"></td>
        <td id="LC1380">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE_DYNAMICCLASS</td>
      </tr>
      <tr>
        <td id="L1381" data-line-number="1381"></td>
        <td id="LC1381">            == CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE + delta);</td>
      </tr>
      <tr>
        <td id="L1382" data-line-number="1382"></td>
        <td id="LC1382">
</td>
      </tr>
      <tr>
        <td id="L1383" data-line-number="1383"></td>
        <td id="LC1383">        helper += delta;</td>
      </tr>
      <tr>
        <td id="L1384" data-line-number="1384"></td>
        <td id="LC1384">    }</td>
      </tr>
      <tr>
        <td id="L1385" data-line-number="1385"></td>
        <td id="LC1385">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1386" data-line-number="1386"></td>
        <td id="LC1386">    <span>if</span> (!pFieldMT-&gt;<span>HasClassConstructor</span>() &amp;&amp; !pFieldMT-&gt;<span>HasBoxedRegularStatics</span>())</td>
      </tr>
      <tr>
        <td id="L1387" data-line-number="1387"></td>
        <td id="LC1387">    {</td>
      </tr>
      <tr>
        <td id="L1388" data-line-number="1388"></td>
        <td id="LC1388">        <span>const</span> <span>int</span> delta = CORINFO_HELP_GETSHARED_GCSTATIC_BASE_NOCTOR - CORINFO_HELP_GETSHARED_GCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1389" data-line-number="1389"></td>
        <td id="LC1389">
</td>
      </tr>
      <tr>
        <td id="L1390" data-line-number="1390"></td>
        <td id="LC1390">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE_NOCTOR</td>
      </tr>
      <tr>
        <td id="L1391" data-line-number="1391"></td>
        <td id="LC1391">            == CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE + delta);</td>
      </tr>
      <tr>
        <td id="L1392" data-line-number="1392"></td>
        <td id="LC1392">
</td>
      </tr>
      <tr>
        <td id="L1393" data-line-number="1393"></td>
        <td id="LC1393">        helper += delta;</td>
      </tr>
      <tr>
        <td id="L1394" data-line-number="1394"></td>
        <td id="LC1394">    }</td>
      </tr>
      <tr>
        <td id="L1395" data-line-number="1395"></td>
        <td id="LC1395">
</td>
      </tr>
      <tr>
        <td id="L1396" data-line-number="1396"></td>
        <td id="LC1396">    <span>if</span> (pField-&gt;<span>IsThreadStatic</span>())</td>
      </tr>
      <tr>
        <td id="L1397" data-line-number="1397"></td>
        <td id="LC1397">    {</td>
      </tr>
      <tr>
        <td id="L1398" data-line-number="1398"></td>
        <td id="LC1398">        <span>const</span> <span>int</span> delta = CORINFO_HELP_GETSHARED_GCTHREADSTATIC_BASE - CORINFO_HELP_GETSHARED_GCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L1399" data-line-number="1399"></td>
        <td id="LC1399">
</td>
      </tr>
      <tr>
        <td id="L1400" data-line-number="1400"></td>
        <td id="LC1400">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETSHARED_NONGCTHREADSTATIC_BASE</td>
      </tr>
      <tr>
        <td id="L1401" data-line-number="1401"></td>
        <td id="LC1401">            == CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE + delta);</td>
      </tr>
      <tr>
        <td id="L1402" data-line-number="1402"></td>
        <td id="LC1402">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETSHARED_GCTHREADSTATIC_BASE_NOCTOR</td>
      </tr>
      <tr>
        <td id="L1403" data-line-number="1403"></td>
        <td id="LC1403">            == CORINFO_HELP_GETSHARED_GCSTATIC_BASE_NOCTOR + delta);</td>
      </tr>
      <tr>
        <td id="L1404" data-line-number="1404"></td>
        <td id="LC1404">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETSHARED_NONGCTHREADSTATIC_BASE_NOCTOR</td>
      </tr>
      <tr>
        <td id="L1405" data-line-number="1405"></td>
        <td id="LC1405">            == CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE_NOCTOR + delta);</td>
      </tr>
      <tr>
        <td id="L1406" data-line-number="1406"></td>
        <td id="LC1406">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETSHARED_GCTHREADSTATIC_BASE_DYNAMICCLASS</td>
      </tr>
      <tr>
        <td id="L1407" data-line-number="1407"></td>
        <td id="LC1407">            == CORINFO_HELP_GETSHARED_GCSTATIC_BASE_DYNAMICCLASS + delta);</td>
      </tr>
      <tr>
        <td id="L1408" data-line-number="1408"></td>
        <td id="LC1408">        <span>static_assert_no_msg</span>(CORINFO_HELP_GETSHARED_NONGCTHREADSTATIC_BASE_DYNAMICCLASS</td>
      </tr>
      <tr>
        <td id="L1409" data-line-number="1409"></td>
        <td id="LC1409">            == CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE_DYNAMICCLASS + delta);</td>
      </tr>
      <tr>
        <td id="L1410" data-line-number="1410"></td>
        <td id="LC1410">
</td>
      </tr>
      <tr>
        <td id="L1411" data-line-number="1411"></td>
        <td id="LC1411">        helper += delta;</td>
      </tr>
      <tr>
        <td id="L1412" data-line-number="1412"></td>
        <td id="LC1412">    }</td>
      </tr>
      <tr>
        <td id="L1413" data-line-number="1413"></td>
        <td id="LC1413">
</td>
      </tr>
      <tr>
        <td id="L1414" data-line-number="1414"></td>
        <td id="LC1414">    <span>return</span> (CorInfoHelpFunc)helper;</td>
      </tr>
      <tr>
        <td id="L1415" data-line-number="1415"></td>
        <td id="LC1415">}</td>
      </tr>
      <tr>
        <td id="L1416" data-line-number="1416"></td>
        <td id="LC1416">
</td>
      </tr>
      <tr>
        <td id="L1417" data-line-number="1417"></td>
        <td id="LC1417"><span>static</span> CorInfoHelpFunc <span>getInstanceFieldHelper</span>(FieldDesc * pField, CORINFO_ACCESS_FLAGS flags)</td>
      </tr>
      <tr>
        <td id="L1418" data-line-number="1418"></td>
        <td id="LC1418">{</td>
      </tr>
      <tr>
        <td id="L1419" data-line-number="1419"></td>
        <td id="LC1419">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L1420" data-line-number="1420"></td>
        <td id="LC1420">
</td>
      </tr>
      <tr>
        <td id="L1421" data-line-number="1421"></td>
        <td id="LC1421">    <span>int</span> helper;</td>
      </tr>
      <tr>
        <td id="L1422" data-line-number="1422"></td>
        <td id="LC1422">
</td>
      </tr>
      <tr>
        <td id="L1423" data-line-number="1423"></td>
        <td id="LC1423">    CorElementType type = pField-&gt;<span>GetFieldType</span>();</td>
      </tr>
      <tr>
        <td id="L1424" data-line-number="1424"></td>
        <td id="LC1424">
</td>
      </tr>
      <tr>
        <td id="L1425" data-line-number="1425"></td>
        <td id="LC1425">    <span>if</span> (<span>CorTypeInfo::IsObjRef</span>(type))</td>
      </tr>
      <tr>
        <td id="L1426" data-line-number="1426"></td>
        <td id="LC1426">        helper = CORINFO_HELP_GETFIELDOBJ;</td>
      </tr>
      <tr>
        <td id="L1427" data-line-number="1427"></td>
        <td id="LC1427">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1428" data-line-number="1428"></td>
        <td id="LC1428">    <span>switch</span> (type)</td>
      </tr>
      <tr>
        <td id="L1429" data-line-number="1429"></td>
        <td id="LC1429">    {</td>
      </tr>
      <tr>
        <td id="L1430" data-line-number="1430"></td>
        <td id="LC1430">    <span>case</span> ELEMENT_TYPE_VALUETYPE:</td>
      </tr>
      <tr>
        <td id="L1431" data-line-number="1431"></td>
        <td id="LC1431">        helper = CORINFO_HELP_GETFIELDSTRUCT;</td>
      </tr>
      <tr>
        <td id="L1432" data-line-number="1432"></td>
        <td id="LC1432">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1433" data-line-number="1433"></td>
        <td id="LC1433">    <span>case</span> ELEMENT_TYPE_I1:</td>
      </tr>
      <tr>
        <td id="L1434" data-line-number="1434"></td>
        <td id="LC1434">    <span>case</span> ELEMENT_TYPE_BOOLEAN:</td>
      </tr>
      <tr>
        <td id="L1435" data-line-number="1435"></td>
        <td id="LC1435">    <span>case</span> ELEMENT_TYPE_U1:</td>
      </tr>
      <tr>
        <td id="L1436" data-line-number="1436"></td>
        <td id="LC1436">        helper = CORINFO_HELP_GETFIELD8;</td>
      </tr>
      <tr>
        <td id="L1437" data-line-number="1437"></td>
        <td id="LC1437">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1438" data-line-number="1438"></td>
        <td id="LC1438">    <span>case</span> ELEMENT_TYPE_I2:</td>
      </tr>
      <tr>
        <td id="L1439" data-line-number="1439"></td>
        <td id="LC1439">    <span>case</span> ELEMENT_TYPE_CHAR:</td>
      </tr>
      <tr>
        <td id="L1440" data-line-number="1440"></td>
        <td id="LC1440">    <span>case</span> ELEMENT_TYPE_U2:</td>
      </tr>
      <tr>
        <td id="L1441" data-line-number="1441"></td>
        <td id="LC1441">        helper = CORINFO_HELP_GETFIELD16;</td>
      </tr>
      <tr>
        <td id="L1442" data-line-number="1442"></td>
        <td id="LC1442">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1443" data-line-number="1443"></td>
        <td id="LC1443">    <span>case</span> ELEMENT_TYPE_I4:</td>
      </tr>
      <tr>
        <td id="L1444" data-line-number="1444"></td>
        <td id="LC1444">    <span>case</span> ELEMENT_TYPE_U4:</td>
      </tr>
      <tr>
        <td id="L1445" data-line-number="1445"></td>
        <td id="LC1445">    <span>IN_TARGET_32BIT</span>(<span>default</span>:)</td>
      </tr>
      <tr>
        <td id="L1446" data-line-number="1446"></td>
        <td id="LC1446">        helper = CORINFO_HELP_GETFIELD32;</td>
      </tr>
      <tr>
        <td id="L1447" data-line-number="1447"></td>
        <td id="LC1447">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1448" data-line-number="1448"></td>
        <td id="LC1448">    <span>case</span> ELEMENT_TYPE_I8:</td>
      </tr>
      <tr>
        <td id="L1449" data-line-number="1449"></td>
        <td id="LC1449">    <span>case</span> ELEMENT_TYPE_U8:</td>
      </tr>
      <tr>
        <td id="L1450" data-line-number="1450"></td>
        <td id="LC1450">    <span>IN_TARGET_64BIT</span>(<span>default</span>:)</td>
      </tr>
      <tr>
        <td id="L1451" data-line-number="1451"></td>
        <td id="LC1451">        helper = CORINFO_HELP_GETFIELD64;</td>
      </tr>
      <tr>
        <td id="L1452" data-line-number="1452"></td>
        <td id="LC1452">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1453" data-line-number="1453"></td>
        <td id="LC1453">    <span>case</span> ELEMENT_TYPE_R4:</td>
      </tr>
      <tr>
        <td id="L1454" data-line-number="1454"></td>
        <td id="LC1454">        helper = CORINFO_HELP_GETFIELDFLOAT;</td>
      </tr>
      <tr>
        <td id="L1455" data-line-number="1455"></td>
        <td id="LC1455">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1456" data-line-number="1456"></td>
        <td id="LC1456">    <span>case</span> ELEMENT_TYPE_R8:</td>
      </tr>
      <tr>
        <td id="L1457" data-line-number="1457"></td>
        <td id="LC1457">        helper = CORINFO_HELP_GETFIELDDOUBLE;</td>
      </tr>
      <tr>
        <td id="L1458" data-line-number="1458"></td>
        <td id="LC1458">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L1459" data-line-number="1459"></td>
        <td id="LC1459">    }</td>
      </tr>
      <tr>
        <td id="L1460" data-line-number="1460"></td>
        <td id="LC1460">
</td>
      </tr>
      <tr>
        <td id="L1461" data-line-number="1461"></td>
        <td id="LC1461">    <span>if</span> (flags &amp; CORINFO_ACCESS_SET)</td>
      </tr>
      <tr>
        <td id="L1462" data-line-number="1462"></td>
        <td id="LC1462">    {</td>
      </tr>
      <tr>
        <td id="L1463" data-line-number="1463"></td>
        <td id="LC1463">        <span>const</span> <span>int</span> delta = CORINFO_HELP_SETFIELDOBJ - CORINFO_HELP_GETFIELDOBJ;</td>
      </tr>
      <tr>
        <td id="L1464" data-line-number="1464"></td>
        <td id="LC1464">
</td>
      </tr>
      <tr>
        <td id="L1465" data-line-number="1465"></td>
        <td id="LC1465">        <span>static_assert_no_msg</span>(CORINFO_HELP_SETFIELD8 == CORINFO_HELP_GETFIELD8 + delta);</td>
      </tr>
      <tr>
        <td id="L1466" data-line-number="1466"></td>
        <td id="LC1466">        <span>static_assert_no_msg</span>(CORINFO_HELP_SETFIELD16 == CORINFO_HELP_GETFIELD16 + delta);</td>
      </tr>
      <tr>
        <td id="L1467" data-line-number="1467"></td>
        <td id="LC1467">        <span>static_assert_no_msg</span>(CORINFO_HELP_SETFIELD32 == CORINFO_HELP_GETFIELD32 + delta);</td>
      </tr>
      <tr>
        <td id="L1468" data-line-number="1468"></td>
        <td id="LC1468">        <span>static_assert_no_msg</span>(CORINFO_HELP_SETFIELD64 == CORINFO_HELP_GETFIELD64 + delta);</td>
      </tr>
      <tr>
        <td id="L1469" data-line-number="1469"></td>
        <td id="LC1469">        <span>static_assert_no_msg</span>(CORINFO_HELP_SETFIELDSTRUCT == CORINFO_HELP_GETFIELDSTRUCT + delta);</td>
      </tr>
      <tr>
        <td id="L1470" data-line-number="1470"></td>
        <td id="LC1470">        <span>static_assert_no_msg</span>(CORINFO_HELP_SETFIELDFLOAT == CORINFO_HELP_GETFIELDFLOAT + delta);</td>
      </tr>
      <tr>
        <td id="L1471" data-line-number="1471"></td>
        <td id="LC1471">        <span>static_assert_no_msg</span>(CORINFO_HELP_SETFIELDDOUBLE == CORINFO_HELP_GETFIELDDOUBLE + delta);</td>
      </tr>
      <tr>
        <td id="L1472" data-line-number="1472"></td>
        <td id="LC1472">
</td>
      </tr>
      <tr>
        <td id="L1473" data-line-number="1473"></td>
        <td id="LC1473">        helper += delta;</td>
      </tr>
      <tr>
        <td id="L1474" data-line-number="1474"></td>
        <td id="LC1474">    }</td>
      </tr>
      <tr>
        <td id="L1475" data-line-number="1475"></td>
        <td id="LC1475">
</td>
      </tr>
      <tr>
        <td id="L1476" data-line-number="1476"></td>
        <td id="LC1476">    <span>return</span> (CorInfoHelpFunc)helper;</td>
      </tr>
      <tr>
        <td id="L1477" data-line-number="1477"></td>
        <td id="LC1477">}</td>
      </tr>
      <tr>
        <td id="L1478" data-line-number="1478"></td>
        <td id="LC1478">
</td>
      </tr>
      <tr>
        <td id="L1479" data-line-number="1479"></td>
        <td id="LC1479"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L1480" data-line-number="1480"></td>
        <td id="LC1480"><span>void</span> <span>CEEInfo::getFieldInfo</span> (CORINFO_RESOLVED_TOKEN * pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L1481" data-line-number="1481"></td>
        <td id="LC1481">                            CORINFO_METHOD_HANDLE  callerHandle,</td>
      </tr>
      <tr>
        <td id="L1482" data-line-number="1482"></td>
        <td id="LC1482">                            CORINFO_ACCESS_FLAGS   flags,</td>
      </tr>
      <tr>
        <td id="L1483" data-line-number="1483"></td>
        <td id="LC1483">                            CORINFO_FIELD_INFO    *pResult</td>
      </tr>
      <tr>
        <td id="L1484" data-line-number="1484"></td>
        <td id="LC1484">                           )</td>
      </tr>
      <tr>
        <td id="L1485" data-line-number="1485"></td>
        <td id="LC1485">{</td>
      </tr>
      <tr>
        <td id="L1486" data-line-number="1486"></td>
        <td id="LC1486">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1487" data-line-number="1487"></td>
        <td id="LC1487">        THROWS;</td>
      </tr>
      <tr>
        <td id="L1488" data-line-number="1488"></td>
        <td id="LC1488">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L1489" data-line-number="1489"></td>
        <td id="LC1489">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1490" data-line-number="1490"></td>
        <td id="LC1490">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1491" data-line-number="1491"></td>
        <td id="LC1491">
</td>
      </tr>
      <tr>
        <td id="L1492" data-line-number="1492"></td>
        <td id="LC1492">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L1493" data-line-number="1493"></td>
        <td id="LC1493">
</td>
      </tr>
      <tr>
        <td id="L1494" data-line-number="1494"></td>
        <td id="LC1494">    <span>_ASSERTE</span>((flags &amp; (CORINFO_ACCESS_GET | CORINFO_ACCESS_SET | CORINFO_ACCESS_ADDRESS | CORINFO_ACCESS_INIT_ARRAY)) != <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L1495" data-line-number="1495"></td>
        <td id="LC1495">
</td>
      </tr>
      <tr>
        <td id="L1496" data-line-number="1496"></td>
        <td id="LC1496">    <span>INDEBUG</span>(<span>memset</span>(pResult, <span>0xCC</span>, <span>sizeof</span>(*pResult)));</td>
      </tr>
      <tr>
        <td id="L1497" data-line-number="1497"></td>
        <td id="LC1497">
</td>
      </tr>
      <tr>
        <td id="L1498" data-line-number="1498"></td>
        <td id="LC1498">    FieldDesc * pField = (FieldDesc*)pResolvedToken-&gt;<span>hField</span>;</td>
      </tr>
      <tr>
        <td id="L1499" data-line-number="1499"></td>
        <td id="LC1499">    MethodTable * pFieldMT = pField-&gt;<span>GetApproxEnclosingMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L1500" data-line-number="1500"></td>
        <td id="LC1500">
</td>
      </tr>
      <tr>
        <td id="L1501" data-line-number="1501"></td>
        <td id="LC1501">    <span><span>//</span> Helper to use if the field access requires it</span></td>
      </tr>
      <tr>
        <td id="L1502" data-line-number="1502"></td>
        <td id="LC1502">    CORINFO_FIELD_ACCESSOR fieldAccessor = (CORINFO_FIELD_ACCESSOR)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L1503" data-line-number="1503"></td>
        <td id="LC1503">    DWORD fieldFlags = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L1504" data-line-number="1504"></td>
        <td id="LC1504">
</td>
      </tr>
      <tr>
        <td id="L1505" data-line-number="1505"></td>
        <td id="LC1505">    pResult-&gt;<span>offset</span> = pField-&gt;<span>GetOffset</span>();</td>
      </tr>
      <tr>
        <td id="L1506" data-line-number="1506"></td>
        <td id="LC1506">    <span>if</span> (pField-&gt;<span>IsStatic</span>())</td>
      </tr>
      <tr>
        <td id="L1507" data-line-number="1507"></td>
        <td id="LC1507">    {</td>
      </tr>
      <tr>
        <td id="L1508" data-line-number="1508"></td>
        <td id="LC1508">        fieldFlags |= CORINFO_FLG_FIELD_STATIC;</td>
      </tr>
      <tr>
        <td id="L1509" data-line-number="1509"></td>
        <td id="LC1509">
</td>
      </tr>
      <tr>
        <td id="L1510" data-line-number="1510"></td>
        <td id="LC1510">        <span>if</span> (pField-&gt;<span>IsRVA</span>())</td>
      </tr>
      <tr>
        <td id="L1511" data-line-number="1511"></td>
        <td id="LC1511">        {</td>
      </tr>
      <tr>
        <td id="L1512" data-line-number="1512"></td>
        <td id="LC1512">            fieldFlags |= CORINFO_FLG_FIELD_UNMANAGED;</td>
      </tr>
      <tr>
        <td id="L1513" data-line-number="1513"></td>
        <td id="LC1513">
</td>
      </tr>
      <tr>
        <td id="L1514" data-line-number="1514"></td>
        <td id="LC1514">            Module* module = pFieldMT-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L1515" data-line-number="1515"></td>
        <td id="LC1515">            <span>if</span> (module-&gt;<span>IsRvaFieldTls</span>(pResult-&gt;<span>offset</span>))</td>
      </tr>
      <tr>
        <td id="L1516" data-line-number="1516"></td>
        <td id="LC1516">            {</td>
      </tr>
      <tr>
        <td id="L1517" data-line-number="1517"></td>
        <td id="LC1517">                fieldAccessor = CORINFO_FIELD_STATIC_TLS;</td>
      </tr>
      <tr>
        <td id="L1518" data-line-number="1518"></td>
        <td id="LC1518">
</td>
      </tr>
      <tr>
        <td id="L1519" data-line-number="1519"></td>
        <td id="LC1519">                <span><span>//</span> Provide helper to use if the JIT is not able to emit the TLS access</span></td>
      </tr>
      <tr>
        <td id="L1520" data-line-number="1520"></td>
        <td id="LC1520">                <span><span>//</span> as intrinsic</span></td>
      </tr>
      <tr>
        <td id="L1521" data-line-number="1521"></td>
        <td id="LC1521">                pResult-&gt;<span>helper</span> = CORINFO_HELP_GETSTATICFIELDADDR_TLS;</td>
      </tr>
      <tr>
        <td id="L1522" data-line-number="1522"></td>
        <td id="LC1522">
</td>
      </tr>
      <tr>
        <td id="L1523" data-line-number="1523"></td>
        <td id="LC1523">                pResult-&gt;<span>offset</span> = module-&gt;<span>GetFieldTlsOffset</span>(pResult-&gt;<span>offset</span>);</td>
      </tr>
      <tr>
        <td id="L1524" data-line-number="1524"></td>
        <td id="LC1524">            }</td>
      </tr>
      <tr>
        <td id="L1525" data-line-number="1525"></td>
        <td id="LC1525">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L1526" data-line-number="1526"></td>
        <td id="LC1526">            {</td>
      </tr>
      <tr>
        <td id="L1527" data-line-number="1527"></td>
        <td id="LC1527">                fieldAccessor = CORINFO_FIELD_STATIC_RVA_ADDRESS;</td>
      </tr>
      <tr>
        <td id="L1528" data-line-number="1528"></td>
        <td id="LC1528">            }</td>
      </tr>
      <tr>
        <td id="L1529" data-line-number="1529"></td>
        <td id="LC1529">
</td>
      </tr>
      <tr>
        <td id="L1530" data-line-number="1530"></td>
        <td id="LC1530">            <span><span>//</span> We are not going through a helper. The constructor has to be triggered explicitly.</span></td>
      </tr>
      <tr>
        <td id="L1531" data-line-number="1531"></td>
        <td id="LC1531">            <span>if</span> (!pFieldMT-&gt;<span>IsClassPreInited</span>())</td>
      </tr>
      <tr>
        <td id="L1532" data-line-number="1532"></td>
        <td id="LC1532">                fieldFlags |= CORINFO_FLG_FIELD_INITCLASS;</td>
      </tr>
      <tr>
        <td id="L1533" data-line-number="1533"></td>
        <td id="LC1533">        }</td>
      </tr>
      <tr>
        <td id="L1534" data-line-number="1534"></td>
        <td id="LC1534">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L1535" data-line-number="1535"></td>
        <td id="LC1535">        {</td>
      </tr>
      <tr>
        <td id="L1536" data-line-number="1536"></td>
        <td id="LC1536">            <span><span>//</span> Regular or thread static</span></td>
      </tr>
      <tr>
        <td id="L1537" data-line-number="1537"></td>
        <td id="LC1537">            CORINFO_FIELD_ACCESSOR intrinsicAccessor;</td>
      </tr>
      <tr>
        <td id="L1538" data-line-number="1538"></td>
        <td id="LC1538">
</td>
      </tr>
      <tr>
        <td id="L1539" data-line-number="1539"></td>
        <td id="LC1539">            <span>if</span> (pField-&gt;<span>GetFieldType</span>() == ELEMENT_TYPE_VALUETYPE)</td>
      </tr>
      <tr>
        <td id="L1540" data-line-number="1540"></td>
        <td id="LC1540">                fieldFlags |= CORINFO_FLG_FIELD_STATIC_IN_HEAP;</td>
      </tr>
      <tr>
        <td id="L1541" data-line-number="1541"></td>
        <td id="LC1541">
</td>
      </tr>
      <tr>
        <td id="L1542" data-line-number="1542"></td>
        <td id="LC1542">            <span>if</span> (pFieldMT-&gt;<span>IsSharedByGenericInstantiations</span>())</td>
      </tr>
      <tr>
        <td id="L1543" data-line-number="1543"></td>
        <td id="LC1543">            {</td>
      </tr>
      <tr>
        <td id="L1544" data-line-number="1544"></td>
        <td id="LC1544">                fieldAccessor = CORINFO_FIELD_STATIC_GENERICS_STATIC_HELPER;</td>
      </tr>
      <tr>
        <td id="L1545" data-line-number="1545"></td>
        <td id="LC1545">
</td>
      </tr>
      <tr>
        <td id="L1546" data-line-number="1546"></td>
        <td id="LC1546">                pResult-&gt;<span>helper</span> = <span>getGenericStaticsHelper</span>(pField);</td>
      </tr>
      <tr>
        <td id="L1547" data-line-number="1547"></td>
        <td id="LC1547">            }</td>
      </tr>
      <tr>
        <td id="L1548" data-line-number="1548"></td>
        <td id="LC1548">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L1549" data-line-number="1549"></td>
        <td id="LC1549">            <span>if</span> (pFieldMT-&gt;<span>GetModule</span>()-&gt;<span>IsSystem</span>() &amp;&amp; (flags &amp; CORINFO_ACCESS_GET) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L1550" data-line-number="1550"></td>
        <td id="LC1550">                (intrinsicAccessor = <span>getFieldIntrinsic</span>(pField)) != (CORINFO_FIELD_ACCESSOR)-<span>1</span>)</td>
      </tr>
      <tr>
        <td id="L1551" data-line-number="1551"></td>
        <td id="LC1551">            {</td>
      </tr>
      <tr>
        <td id="L1552" data-line-number="1552"></td>
        <td id="LC1552">                <span><span>//</span> Intrinsics</span></td>
      </tr>
      <tr>
        <td id="L1553" data-line-number="1553"></td>
        <td id="LC1553">                fieldAccessor = intrinsicAccessor;</td>
      </tr>
      <tr>
        <td id="L1554" data-line-number="1554"></td>
        <td id="LC1554">            }</td>
      </tr>
      <tr>
        <td id="L1555" data-line-number="1555"></td>
        <td id="LC1555">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L1556" data-line-number="1556"></td>
        <td id="LC1556">            <span>if</span> (m_pMethodBeingCompiled-&gt;<span>IsZapped</span>() || <span>IsCompilingForNGen</span>() ||</td>
      </tr>
      <tr>
        <td id="L1557" data-line-number="1557"></td>
        <td id="LC1557">                <span><span>//</span> Static fields are not pinned in collectible types. We will always access</span></td>
      </tr>
      <tr>
        <td id="L1558" data-line-number="1558"></td>
        <td id="LC1558">                <span><span>//</span> them using a helper since the address cannot be embeded into the code.</span></td>
      </tr>
      <tr>
        <td id="L1559" data-line-number="1559"></td>
        <td id="LC1559">                pFieldMT-&gt;<span>Collectible</span>() ||</td>
      </tr>
      <tr>
        <td id="L1560" data-line-number="1560"></td>
        <td id="LC1560">                <span><span>//</span> We always treat accessing thread statics as if we are in domain neutral code.</span></td>
      </tr>
      <tr>
        <td id="L1561" data-line-number="1561"></td>
        <td id="LC1561">                pField-&gt;<span>IsThreadStatic</span>()</td>
      </tr>
      <tr>
        <td id="L1562" data-line-number="1562"></td>
        <td id="LC1562">                )</td>
      </tr>
      <tr>
        <td id="L1563" data-line-number="1563"></td>
        <td id="LC1563">            {</td>
      </tr>
      <tr>
        <td id="L1564" data-line-number="1564"></td>
        <td id="LC1564">                fieldAccessor = CORINFO_FIELD_STATIC_SHARED_STATIC_HELPER;</td>
      </tr>
      <tr>
        <td id="L1565" data-line-number="1565"></td>
        <td id="LC1565">
</td>
      </tr>
      <tr>
        <td id="L1566" data-line-number="1566"></td>
        <td id="LC1566">                pResult-&gt;<span>helper</span> = <span>getSharedStaticsHelper</span>(pField, pFieldMT);</td>
      </tr>
      <tr>
        <td id="L1567" data-line-number="1567"></td>
        <td id="LC1567">            }</td>
      </tr>
      <tr>
        <td id="L1568" data-line-number="1568"></td>
        <td id="LC1568">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L1569" data-line-number="1569"></td>
        <td id="LC1569">            {</td>
      </tr>
      <tr>
        <td id="L1570" data-line-number="1570"></td>
        <td id="LC1570">                fieldAccessor = CORINFO_FIELD_STATIC_ADDRESS;</td>
      </tr>
      <tr>
        <td id="L1571" data-line-number="1571"></td>
        <td id="LC1571">
</td>
      </tr>
      <tr>
        <td id="L1572" data-line-number="1572"></td>
        <td id="LC1572">                <span><span>//</span> We are not going through a helper. The constructor has to be triggered explicitly.</span></td>
      </tr>
      <tr>
        <td id="L1573" data-line-number="1573"></td>
        <td id="LC1573">                <span>if</span> (!pFieldMT-&gt;<span>IsClassPreInited</span>())</td>
      </tr>
      <tr>
        <td id="L1574" data-line-number="1574"></td>
        <td id="LC1574">                    fieldFlags |= CORINFO_FLG_FIELD_INITCLASS;</td>
      </tr>
      <tr>
        <td id="L1575" data-line-number="1575"></td>
        <td id="LC1575">            }</td>
      </tr>
      <tr>
        <td id="L1576" data-line-number="1576"></td>
        <td id="LC1576">        }</td>
      </tr>
      <tr>
        <td id="L1577" data-line-number="1577"></td>
        <td id="LC1577">
</td>
      </tr>
      <tr>
        <td id="L1578" data-line-number="1578"></td>
        <td id="LC1578">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1579" data-line-number="1579"></td>
        <td id="LC1579">        <span><span>//</span> Currently, we only this optimization for regular statics, but it</span></td>
      </tr>
      <tr>
        <td id="L1580" data-line-number="1580"></td>
        <td id="LC1580">        <span><span>//</span> looks like it may be permissible to do this optimization for</span></td>
      </tr>
      <tr>
        <td id="L1581" data-line-number="1581"></td>
        <td id="LC1581">        <span><span>//</span> thread statics as well.</span></td>
      </tr>
      <tr>
        <td id="L1582" data-line-number="1582"></td>
        <td id="LC1582">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1583" data-line-number="1583"></td>
        <td id="LC1583">        <span>if</span> ((flags &amp; CORINFO_ACCESS_ADDRESS) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L1584" data-line-number="1584"></td>
        <td id="LC1584">            !pField-&gt;<span>IsThreadStatic</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L1585" data-line-number="1585"></td>
        <td id="LC1585">            (fieldAccessor != CORINFO_FIELD_STATIC_TLS))</td>
      </tr>
      <tr>
        <td id="L1586" data-line-number="1586"></td>
        <td id="LC1586">        {</td>
      </tr>
      <tr>
        <td id="L1587" data-line-number="1587"></td>
        <td id="LC1587">            fieldFlags |= CORINFO_FLG_FIELD_SAFESTATIC_BYREF_RETURN;</td>
      </tr>
      <tr>
        <td id="L1588" data-line-number="1588"></td>
        <td id="LC1588">        }</td>
      </tr>
      <tr>
        <td id="L1589" data-line-number="1589"></td>
        <td id="LC1589">    }</td>
      </tr>
      <tr>
        <td id="L1590" data-line-number="1590"></td>
        <td id="LC1590">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1591" data-line-number="1591"></td>
        <td id="LC1591">    {</td>
      </tr>
      <tr>
        <td id="L1592" data-line-number="1592"></td>
        <td id="LC1592">        BOOL <span>fInstanceHelper</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L1593" data-line-number="1593"></td>
        <td id="LC1593">
</td>
      </tr>
      <tr>
        <td id="L1594" data-line-number="1594"></td>
        <td id="LC1594">        <span>if</span> (<span>fInstanceHelper</span>)</td>
      </tr>
      <tr>
        <td id="L1595" data-line-number="1595"></td>
        <td id="LC1595">        {</td>
      </tr>
      <tr>
        <td id="L1596" data-line-number="1596"></td>
        <td id="LC1596">            <span>if</span> (flags &amp; CORINFO_ACCESS_ADDRESS)</td>
      </tr>
      <tr>
        <td id="L1597" data-line-number="1597"></td>
        <td id="LC1597">            {</td>
      </tr>
      <tr>
        <td id="L1598" data-line-number="1598"></td>
        <td id="LC1598">                fieldAccessor = CORINFO_FIELD_INSTANCE_ADDR_HELPER;</td>
      </tr>
      <tr>
        <td id="L1599" data-line-number="1599"></td>
        <td id="LC1599">
</td>
      </tr>
      <tr>
        <td id="L1600" data-line-number="1600"></td>
        <td id="LC1600">                pResult-&gt;<span>helper</span> = CORINFO_HELP_GETFIELDADDR;</td>
      </tr>
      <tr>
        <td id="L1601" data-line-number="1601"></td>
        <td id="LC1601">            }</td>
      </tr>
      <tr>
        <td id="L1602" data-line-number="1602"></td>
        <td id="LC1602">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L1603" data-line-number="1603"></td>
        <td id="LC1603">            {</td>
      </tr>
      <tr>
        <td id="L1604" data-line-number="1604"></td>
        <td id="LC1604">                fieldAccessor = CORINFO_FIELD_INSTANCE_HELPER;</td>
      </tr>
      <tr>
        <td id="L1605" data-line-number="1605"></td>
        <td id="LC1605">
</td>
      </tr>
      <tr>
        <td id="L1606" data-line-number="1606"></td>
        <td id="LC1606">                pResult-&gt;<span>helper</span> = <span>getInstanceFieldHelper</span>(pField, flags);</td>
      </tr>
      <tr>
        <td id="L1607" data-line-number="1607"></td>
        <td id="LC1607">            }</td>
      </tr>
      <tr>
        <td id="L1608" data-line-number="1608"></td>
        <td id="LC1608">        }</td>
      </tr>
      <tr>
        <td id="L1609" data-line-number="1609"></td>
        <td id="LC1609">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L1610" data-line-number="1610"></td>
        <td id="LC1610">        <span>if</span> (pField-&gt;<span>IsEnCNew</span>())</td>
      </tr>
      <tr>
        <td id="L1611" data-line-number="1611"></td>
        <td id="LC1611">        {</td>
      </tr>
      <tr>
        <td id="L1612" data-line-number="1612"></td>
        <td id="LC1612">            fieldAccessor = CORINFO_FIELD_INSTANCE_ADDR_HELPER;</td>
      </tr>
      <tr>
        <td id="L1613" data-line-number="1613"></td>
        <td id="LC1613">
</td>
      </tr>
      <tr>
        <td id="L1614" data-line-number="1614"></td>
        <td id="LC1614">            pResult-&gt;<span>helper</span> = CORINFO_HELP_GETFIELDADDR;</td>
      </tr>
      <tr>
        <td id="L1615" data-line-number="1615"></td>
        <td id="LC1615">        }</td>
      </tr>
      <tr>
        <td id="L1616" data-line-number="1616"></td>
        <td id="LC1616">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L1617" data-line-number="1617"></td>
        <td id="LC1617">        {</td>
      </tr>
      <tr>
        <td id="L1618" data-line-number="1618"></td>
        <td id="LC1618">            fieldAccessor = CORINFO_FIELD_INSTANCE;</td>
      </tr>
      <tr>
        <td id="L1619" data-line-number="1619"></td>
        <td id="LC1619">        }</td>
      </tr>
      <tr>
        <td id="L1620" data-line-number="1620"></td>
        <td id="LC1620">
</td>
      </tr>
      <tr>
        <td id="L1621" data-line-number="1621"></td>
        <td id="LC1621">        <span><span>//</span> FieldDesc::GetOffset() does not include the size of Object</span></td>
      </tr>
      <tr>
        <td id="L1622" data-line-number="1622"></td>
        <td id="LC1622">        <span>if</span> (!pFieldMT-&gt;<span>IsValueType</span>())</td>
      </tr>
      <tr>
        <td id="L1623" data-line-number="1623"></td>
        <td id="LC1623">        {</td>
      </tr>
      <tr>
        <td id="L1624" data-line-number="1624"></td>
        <td id="LC1624">            pResult-&gt;<span>offset</span> += OBJECT_SIZE;</td>
      </tr>
      <tr>
        <td id="L1625" data-line-number="1625"></td>
        <td id="LC1625">        }</td>
      </tr>
      <tr>
        <td id="L1626" data-line-number="1626"></td>
        <td id="LC1626">    }</td>
      </tr>
      <tr>
        <td id="L1627" data-line-number="1627"></td>
        <td id="LC1627">
</td>
      </tr>
      <tr>
        <td id="L1628" data-line-number="1628"></td>
        <td id="LC1628">    <span><span>//</span> TODO: This is touching metadata. Can we avoid it?</span></td>
      </tr>
      <tr>
        <td id="L1629" data-line-number="1629"></td>
        <td id="LC1629">    DWORD fieldAttribs = pField-&gt;<span>GetAttributes</span>();</td>
      </tr>
      <tr>
        <td id="L1630" data-line-number="1630"></td>
        <td id="LC1630">
</td>
      </tr>
      <tr>
        <td id="L1631" data-line-number="1631"></td>
        <td id="LC1631">    <span>if</span> (<span>IsFdFamily</span>(fieldAttribs))</td>
      </tr>
      <tr>
        <td id="L1632" data-line-number="1632"></td>
        <td id="LC1632">        fieldFlags |= CORINFO_FLG_FIELD_PROTECTED;</td>
      </tr>
      <tr>
        <td id="L1633" data-line-number="1633"></td>
        <td id="LC1633">
</td>
      </tr>
      <tr>
        <td id="L1634" data-line-number="1634"></td>
        <td id="LC1634">    <span>if</span> (<span>IsFdInitOnly</span>(fieldAttribs))</td>
      </tr>
      <tr>
        <td id="L1635" data-line-number="1635"></td>
        <td id="LC1635">        fieldFlags |= CORINFO_FLG_FIELD_FINAL;</td>
      </tr>
      <tr>
        <td id="L1636" data-line-number="1636"></td>
        <td id="LC1636">
</td>
      </tr>
      <tr>
        <td id="L1637" data-line-number="1637"></td>
        <td id="LC1637">    pResult-&gt;<span>fieldAccessor</span> = fieldAccessor;</td>
      </tr>
      <tr>
        <td id="L1638" data-line-number="1638"></td>
        <td id="LC1638">    pResult-&gt;<span>fieldFlags</span> = fieldFlags;</td>
      </tr>
      <tr>
        <td id="L1639" data-line-number="1639"></td>
        <td id="LC1639">
</td>
      </tr>
      <tr>
        <td id="L1640" data-line-number="1640"></td>
        <td id="LC1640">    <span>if</span> (!(flags &amp; CORINFO_ACCESS_INLINECHECK))</td>
      </tr>
      <tr>
        <td id="L1641" data-line-number="1641"></td>
        <td id="LC1641">    {</td>
      </tr>
      <tr>
        <td id="L1642" data-line-number="1642"></td>
        <td id="LC1642">        <span><span>//</span>get the field's type.  Grab the class for structs.</span></td>
      </tr>
      <tr>
        <td id="L1643" data-line-number="1643"></td>
        <td id="LC1643">        pResult-&gt;<span>fieldType</span> = <span>getFieldTypeInternal</span>(pResolvedToken-&gt;<span>hField</span>, &amp;pResult-&gt;<span>structType</span>, pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L1644" data-line-number="1644"></td>
        <td id="LC1644">
</td>
      </tr>
      <tr>
        <td id="L1645" data-line-number="1645"></td>
        <td id="LC1645">
</td>
      </tr>
      <tr>
        <td id="L1646" data-line-number="1646"></td>
        <td id="LC1646">        MethodDesc * pCallerForSecurity = <span>GetMethodForSecurity</span>(callerHandle);</td>
      </tr>
      <tr>
        <td id="L1647" data-line-number="1647"></td>
        <td id="LC1647">
</td>
      </tr>
      <tr>
        <td id="L1648" data-line-number="1648"></td>
        <td id="LC1648">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1649" data-line-number="1649"></td>
        <td id="LC1649">        <span><span>//</span>Since we can't get the special verify-only instantiated FD like we can with MDs, go back to the parent</span></td>
      </tr>
      <tr>
        <td id="L1650" data-line-number="1650"></td>
        <td id="LC1650">        <span><span>//</span>of the memberRef and load that one.  That should give us the open instantiation.</span></td>
      </tr>
      <tr>
        <td id="L1651" data-line-number="1651"></td>
        <td id="LC1651">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1652" data-line-number="1652"></td>
        <td id="LC1652">        <span><span>//</span>If the field we found is owned by a generic type, you have to go back to the signature and reload.</span></td>
      </tr>
      <tr>
        <td id="L1653" data-line-number="1653"></td>
        <td id="LC1653">        <span><span>//</span>Otherwise we filled in !0.</span></td>
      </tr>
      <tr>
        <td id="L1654" data-line-number="1654"></td>
        <td id="LC1654">        TypeHandle fieldTypeForSecurity = <span>TypeHandle</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L1655" data-line-number="1655"></td>
        <td id="LC1655">        <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1656" data-line-number="1656"></td>
        <td id="LC1656">        {</td>
      </tr>
      <tr>
        <td id="L1657" data-line-number="1657"></td>
        <td id="LC1657">            SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L1658" data-line-number="1658"></td>
        <td id="LC1658">            <span>SigTypeContext::InitTypeContext</span>(pCallerForSecurity, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L1659" data-line-number="1659"></td>
        <td id="LC1659">
</td>
      </tr>
      <tr>
        <td id="L1660" data-line-number="1660"></td>
        <td id="LC1660">            SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L1661" data-line-number="1661"></td>
        <td id="LC1661">            fieldTypeForSecurity = sigptr.<span>GetTypeHandleThrowing</span>((Module *)pResolvedToken-&gt;<span>tokenScope</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L1662" data-line-number="1662"></td>
        <td id="LC1662">
</td>
      </tr>
      <tr>
        <td id="L1663" data-line-number="1663"></td>
        <td id="LC1663">            <span><span>//</span> typeHnd can be a variable type</span></td>
      </tr>
      <tr>
        <td id="L1664" data-line-number="1664"></td>
        <td id="LC1664">            <span>if</span> (fieldTypeForSecurity.<span>GetMethodTable</span>() == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1665" data-line-number="1665"></td>
        <td id="LC1665">            {</td>
      </tr>
      <tr>
        <td id="L1666" data-line-number="1666"></td>
        <td id="LC1666">                <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT, BFA_METHODDEF_PARENT_NO_MEMBERS);</td>
      </tr>
      <tr>
        <td id="L1667" data-line-number="1667"></td>
        <td id="LC1667">            }</td>
      </tr>
      <tr>
        <td id="L1668" data-line-number="1668"></td>
        <td id="LC1668">        }</td>
      </tr>
      <tr>
        <td id="L1669" data-line-number="1669"></td>
        <td id="LC1669">
</td>
      </tr>
      <tr>
        <td id="L1670" data-line-number="1670"></td>
        <td id="LC1670">        BOOL doAccessCheck = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L1671" data-line-number="1671"></td>
        <td id="LC1671">        AccessCheckOptions::AccessCheckType accessCheckType = AccessCheckOptions::<span>kNormalAccessibilityChecks</span>;</td>
      </tr>
      <tr>
        <td id="L1672" data-line-number="1672"></td>
        <td id="LC1672">
</td>
      </tr>
      <tr>
        <td id="L1673" data-line-number="1673"></td>
        <td id="LC1673">        DynamicResolver * pAccessContext = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L1674" data-line-number="1674"></td>
        <td id="LC1674">
</td>
      </tr>
      <tr>
        <td id="L1675" data-line-number="1675"></td>
        <td id="LC1675">        <span><span>//</span>More in code:CEEInfo::getCallInfo, but the short version is that the caller and callee Descs do</span></td>
      </tr>
      <tr>
        <td id="L1676" data-line-number="1676"></td>
        <td id="LC1676">        <span><span>//</span>not completely describe the type.</span></td>
      </tr>
      <tr>
        <td id="L1677" data-line-number="1677"></td>
        <td id="LC1677">        TypeHandle callerTypeForSecurity = <span>TypeHandle</span>(pCallerForSecurity-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L1678" data-line-number="1678"></td>
        <td id="LC1678">        <span>if</span> (<span>IsDynamicScope</span>(pResolvedToken-&gt;<span>tokenScope</span>))</td>
      </tr>
      <tr>
        <td id="L1679" data-line-number="1679"></td>
        <td id="LC1679">        {</td>
      </tr>
      <tr>
        <td id="L1680" data-line-number="1680"></td>
        <td id="LC1680">            doAccessCheck = <span>ModifyCheckForDynamicMethod</span>(<span>GetDynamicResolver</span>(pResolvedToken-&gt;<span>tokenScope</span>), &amp;callerTypeForSecurity,</td>
      </tr>
      <tr>
        <td id="L1681" data-line-number="1681"></td>
        <td id="LC1681">                &amp;accessCheckType, &amp;pAccessContext);</td>
      </tr>
      <tr>
        <td id="L1682" data-line-number="1682"></td>
        <td id="LC1682">        }</td>
      </tr>
      <tr>
        <td id="L1683" data-line-number="1683"></td>
        <td id="LC1683">
</td>
      </tr>
      <tr>
        <td id="L1684" data-line-number="1684"></td>
        <td id="LC1684">        <span><span>//</span>Now for some link time checks.</span></td>
      </tr>
      <tr>
        <td id="L1685" data-line-number="1685"></td>
        <td id="LC1685">        <span><span>//</span>Um... where are the field link demands?</span></td>
      </tr>
      <tr>
        <td id="L1686" data-line-number="1686"></td>
        <td id="LC1686">
</td>
      </tr>
      <tr>
        <td id="L1687" data-line-number="1687"></td>
        <td id="LC1687">        pResult-&gt;<span>accessAllowed</span> = CORINFO_ACCESS_ALLOWED;</td>
      </tr>
      <tr>
        <td id="L1688" data-line-number="1688"></td>
        <td id="LC1688">
</td>
      </tr>
      <tr>
        <td id="L1689" data-line-number="1689"></td>
        <td id="LC1689">        <span>if</span> (doAccessCheck)</td>
      </tr>
      <tr>
        <td id="L1690" data-line-number="1690"></td>
        <td id="LC1690">        {</td>
      </tr>
      <tr>
        <td id="L1691" data-line-number="1691"></td>
        <td id="LC1691">            <span><span>//</span>Well, let's check some visibility at least.</span></td>
      </tr>
      <tr>
        <td id="L1692" data-line-number="1692"></td>
        <td id="LC1692">            AccessCheckOptions <span>accessCheckOptions</span>(accessCheckType,</td>
      </tr>
      <tr>
        <td id="L1693" data-line-number="1693"></td>
        <td id="LC1693">                pAccessContext,</td>
      </tr>
      <tr>
        <td id="L1694" data-line-number="1694"></td>
        <td id="LC1694">                <span>FALSE</span>,</td>
      </tr>
      <tr>
        <td id="L1695" data-line-number="1695"></td>
        <td id="LC1695">                pField);</td>
      </tr>
      <tr>
        <td id="L1696" data-line-number="1696"></td>
        <td id="LC1696">
</td>
      </tr>
      <tr>
        <td id="L1697" data-line-number="1697"></td>
        <td id="LC1697">            <span>_ASSERTE</span>(pCallerForSecurity != <span>NULL</span> &amp;&amp; callerTypeForSecurity != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L1698" data-line-number="1698"></td>
        <td id="LC1698">            AccessCheckContext <span>accessContext</span>(pCallerForSecurity, callerTypeForSecurity.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L1699" data-line-number="1699"></td>
        <td id="LC1699">
</td>
      </tr>
      <tr>
        <td id="L1700" data-line-number="1700"></td>
        <td id="LC1700">            BOOL canAccess = <span>ClassLoader::CanAccess</span>(</td>
      </tr>
      <tr>
        <td id="L1701" data-line-number="1701"></td>
        <td id="LC1701">                &amp;accessContext,</td>
      </tr>
      <tr>
        <td id="L1702" data-line-number="1702"></td>
        <td id="LC1702">                fieldTypeForSecurity.<span>GetMethodTable</span>(),</td>
      </tr>
      <tr>
        <td id="L1703" data-line-number="1703"></td>
        <td id="LC1703">                fieldTypeForSecurity.<span>GetAssembly</span>(),</td>
      </tr>
      <tr>
        <td id="L1704" data-line-number="1704"></td>
        <td id="LC1704">                fieldAttribs,</td>
      </tr>
      <tr>
        <td id="L1705" data-line-number="1705"></td>
        <td id="LC1705">                <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L1706" data-line-number="1706"></td>
        <td id="LC1706">                (flags &amp; CORINFO_ACCESS_INIT_ARRAY) ? <span>NULL</span> : pField, <span><span>//</span> For InitializeArray, we don't need tocheck the type of the field.</span></td>
      </tr>
      <tr>
        <td id="L1707" data-line-number="1707"></td>
        <td id="LC1707">                accessCheckOptions);</td>
      </tr>
      <tr>
        <td id="L1708" data-line-number="1708"></td>
        <td id="LC1708">
</td>
      </tr>
      <tr>
        <td id="L1709" data-line-number="1709"></td>
        <td id="LC1709">            <span>if</span> (!canAccess)</td>
      </tr>
      <tr>
        <td id="L1710" data-line-number="1710"></td>
        <td id="LC1710">            {</td>
      </tr>
      <tr>
        <td id="L1711" data-line-number="1711"></td>
        <td id="LC1711">                <span><span>//</span>Set up the throw helper</span></td>
      </tr>
      <tr>
        <td id="L1712" data-line-number="1712"></td>
        <td id="LC1712">                pResult-&gt;<span>accessAllowed</span> = CORINFO_ACCESS_ILLEGAL;</td>
      </tr>
      <tr>
        <td id="L1713" data-line-number="1713"></td>
        <td id="LC1713">
</td>
      </tr>
      <tr>
        <td id="L1714" data-line-number="1714"></td>
        <td id="LC1714">                pResult-&gt;<span>accessCalloutHelper</span>.<span>helperNum</span> = CORINFO_HELP_FIELD_ACCESS_EXCEPTION;</td>
      </tr>
      <tr>
        <td id="L1715" data-line-number="1715"></td>
        <td id="LC1715">                pResult-&gt;<span>accessCalloutHelper</span>.<span>numArgs</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L1716" data-line-number="1716"></td>
        <td id="LC1716">
</td>
      </tr>
      <tr>
        <td id="L1717" data-line-number="1717"></td>
        <td id="LC1717">                pResult-&gt;<span>accessCalloutHelper</span>.<span>args</span>[<span>0</span>].<span>Set</span>(<span>CORINFO_METHOD_HANDLE</span>(pCallerForSecurity));</td>
      </tr>
      <tr>
        <td id="L1718" data-line-number="1718"></td>
        <td id="LC1718">                pResult-&gt;<span>accessCalloutHelper</span>.<span>args</span>[<span>1</span>].<span>Set</span>(<span>CORINFO_FIELD_HANDLE</span>(pField));</td>
      </tr>
      <tr>
        <td id="L1719" data-line-number="1719"></td>
        <td id="LC1719">
</td>
      </tr>
      <tr>
        <td id="L1720" data-line-number="1720"></td>
        <td id="LC1720">                <span>if</span> (<span>IsCompilingForNGen</span>())</td>
      </tr>
      <tr>
        <td id="L1721" data-line-number="1721"></td>
        <td id="LC1721">                {</td>
      </tr>
      <tr>
        <td id="L1722" data-line-number="1722"></td>
        <td id="LC1722">                    <span><span>//</span>see code:CEEInfo::getCallInfo for more information.</span></td>
      </tr>
      <tr>
        <td id="L1723" data-line-number="1723"></td>
        <td id="LC1723">                    <span>if</span> (pCallerForSecurity-&gt;<span>ContainsGenericVariables</span>())</td>
      </tr>
      <tr>
        <td id="L1724" data-line-number="1724"></td>
        <td id="LC1724">                        <span>COMPlusThrowNonLocalized</span>(<span>kNotSupportedException</span>, <span>W</span>(<span><span>"</span>Cannot embed generic MethodDesc<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L1725" data-line-number="1725"></td>
        <td id="LC1725">                }</td>
      </tr>
      <tr>
        <td id="L1726" data-line-number="1726"></td>
        <td id="LC1726">            }</td>
      </tr>
      <tr>
        <td id="L1727" data-line-number="1727"></td>
        <td id="LC1727">        }</td>
      </tr>
      <tr>
        <td id="L1728" data-line-number="1728"></td>
        <td id="LC1728">    }</td>
      </tr>
      <tr>
        <td id="L1729" data-line-number="1729"></td>
        <td id="LC1729">
</td>
      </tr>
      <tr>
        <td id="L1730" data-line-number="1730"></td>
        <td id="LC1730">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L1731" data-line-number="1731"></td>
        <td id="LC1731">}</td>
      </tr>
      <tr>
        <td id="L1732" data-line-number="1732"></td>
        <td id="LC1732">
</td>
      </tr>
      <tr>
        <td id="L1733" data-line-number="1733"></td>
        <td id="LC1733"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L1734" data-line-number="1734"></td>
        <td id="LC1734"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1735" data-line-number="1735"></td>
        <td id="LC1735"><span>bool</span> <span>CEEInfo::isFieldStatic</span>(CORINFO_FIELD_HANDLE fldHnd)</td>
      </tr>
      <tr>
        <td id="L1736" data-line-number="1736"></td>
        <td id="LC1736">{</td>
      </tr>
      <tr>
        <td id="L1737" data-line-number="1737"></td>
        <td id="LC1737">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1738" data-line-number="1738"></td>
        <td id="LC1738">        THROWS;</td>
      </tr>
      <tr>
        <td id="L1739" data-line-number="1739"></td>
        <td id="LC1739">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L1740" data-line-number="1740"></td>
        <td id="LC1740">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1741" data-line-number="1741"></td>
        <td id="LC1741">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1742" data-line-number="1742"></td>
        <td id="LC1742">
</td>
      </tr>
      <tr>
        <td id="L1743" data-line-number="1743"></td>
        <td id="LC1743">    <span>bool</span> res = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1744" data-line-number="1744"></td>
        <td id="LC1744">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1745" data-line-number="1745"></td>
        <td id="LC1745">    FieldDesc* field = (FieldDesc*)fldHnd;</td>
      </tr>
      <tr>
        <td id="L1746" data-line-number="1746"></td>
        <td id="LC1746">    res = (field-&gt;<span>IsStatic</span>() != <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L1747" data-line-number="1747"></td>
        <td id="LC1747">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1748" data-line-number="1748"></td>
        <td id="LC1748">    <span>return</span> res;</td>
      </tr>
      <tr>
        <td id="L1749" data-line-number="1749"></td>
        <td id="LC1749">}</td>
      </tr>
      <tr>
        <td id="L1750" data-line-number="1750"></td>
        <td id="LC1750">
</td>
      </tr>
      <tr>
        <td id="L1751" data-line-number="1751"></td>
        <td id="LC1751"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L1752" data-line-number="1752"></td>
        <td id="LC1752"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1753" data-line-number="1753"></td>
        <td id="LC1753"><span>void</span></td>
      </tr>
      <tr>
        <td id="L1754" data-line-number="1754"></td>
        <td id="LC1754"><span>CEEInfo::findCallSiteSig</span>(</td>
      </tr>
      <tr>
        <td id="L1755" data-line-number="1755"></td>
        <td id="LC1755">    CORINFO_MODULE_HANDLE  scopeHnd,</td>
      </tr>
      <tr>
        <td id="L1756" data-line-number="1756"></td>
        <td id="LC1756">    <span>unsigned</span>               sigMethTok,</td>
      </tr>
      <tr>
        <td id="L1757" data-line-number="1757"></td>
        <td id="LC1757">    CORINFO_CONTEXT_HANDLE context,</td>
      </tr>
      <tr>
        <td id="L1758" data-line-number="1758"></td>
        <td id="LC1758">    CORINFO_SIG_INFO *     sigRet)</td>
      </tr>
      <tr>
        <td id="L1759" data-line-number="1759"></td>
        <td id="LC1759">{</td>
      </tr>
      <tr>
        <td id="L1760" data-line-number="1760"></td>
        <td id="LC1760">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1761" data-line-number="1761"></td>
        <td id="LC1761">        THROWS;</td>
      </tr>
      <tr>
        <td id="L1762" data-line-number="1762"></td>
        <td id="LC1762">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L1763" data-line-number="1763"></td>
        <td id="LC1763">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1764" data-line-number="1764"></td>
        <td id="LC1764">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1765" data-line-number="1765"></td>
        <td id="LC1765">
</td>
      </tr>
      <tr>
        <td id="L1766" data-line-number="1766"></td>
        <td id="LC1766">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L1767" data-line-number="1767"></td>
        <td id="LC1767">
</td>
      </tr>
      <tr>
        <td id="L1768" data-line-number="1768"></td>
        <td id="LC1768">    PCCOR_SIGNATURE       pSig = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L1769" data-line-number="1769"></td>
        <td id="LC1769">    DWORD                 cbSig = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L1770" data-line-number="1770"></td>
        <td id="LC1770">
</td>
      </tr>
      <tr>
        <td id="L1771" data-line-number="1771"></td>
        <td id="LC1771">    <span>if</span> (<span>IsDynamicScope</span>(scopeHnd))</td>
      </tr>
      <tr>
        <td id="L1772" data-line-number="1772"></td>
        <td id="LC1772">    {</td>
      </tr>
      <tr>
        <td id="L1773" data-line-number="1773"></td>
        <td id="LC1773">        DynamicResolver * pResolver = <span>GetDynamicResolver</span>(scopeHnd);</td>
      </tr>
      <tr>
        <td id="L1774" data-line-number="1774"></td>
        <td id="LC1774">        SigPointer sig;</td>
      </tr>
      <tr>
        <td id="L1775" data-line-number="1775"></td>
        <td id="LC1775">
</td>
      </tr>
      <tr>
        <td id="L1776" data-line-number="1776"></td>
        <td id="LC1776">        <span>if</span> (<span>TypeFromToken</span>(sigMethTok) == mdtMemberRef)</td>
      </tr>
      <tr>
        <td id="L1777" data-line-number="1777"></td>
        <td id="LC1777">        {</td>
      </tr>
      <tr>
        <td id="L1778" data-line-number="1778"></td>
        <td id="LC1778">            sig = pResolver-&gt;<span>ResolveSignatureForVarArg</span>(sigMethTok);</td>
      </tr>
      <tr>
        <td id="L1779" data-line-number="1779"></td>
        <td id="LC1779">        }</td>
      </tr>
      <tr>
        <td id="L1780" data-line-number="1780"></td>
        <td id="LC1780">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L1781" data-line-number="1781"></td>
        <td id="LC1781">        {</td>
      </tr>
      <tr>
        <td id="L1782" data-line-number="1782"></td>
        <td id="LC1782">            <span>_ASSERTE</span>(<span>TypeFromToken</span>(sigMethTok) == mdtMethodDef);</td>
      </tr>
      <tr>
        <td id="L1783" data-line-number="1783"></td>
        <td id="LC1783">
</td>
      </tr>
      <tr>
        <td id="L1784" data-line-number="1784"></td>
        <td id="LC1784">            TypeHandle classHandle;</td>
      </tr>
      <tr>
        <td id="L1785" data-line-number="1785"></td>
        <td id="LC1785">            MethodDesc * pMD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L1786" data-line-number="1786"></td>
        <td id="LC1786">            FieldDesc * pFD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L1787" data-line-number="1787"></td>
        <td id="LC1787">
</td>
      </tr>
      <tr>
        <td id="L1788" data-line-number="1788"></td>
        <td id="LC1788">            <span><span>//</span> in this case a method is asked for its sig. Resolve the method token and get the sig</span></td>
      </tr>
      <tr>
        <td id="L1789" data-line-number="1789"></td>
        <td id="LC1789">            pResolver-&gt;<span>ResolveToken</span>(sigMethTok, &amp;classHandle, &amp;pMD, &amp;pFD);</td>
      </tr>
      <tr>
        <td id="L1790" data-line-number="1790"></td>
        <td id="LC1790">            <span>if</span> (pMD == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1791" data-line-number="1791"></td>
        <td id="LC1791">                <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>);</td>
      </tr>
      <tr>
        <td id="L1792" data-line-number="1792"></td>
        <td id="LC1792">
</td>
      </tr>
      <tr>
        <td id="L1793" data-line-number="1793"></td>
        <td id="LC1793">            PCCOR_SIGNATURE pSig = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L1794" data-line-number="1794"></td>
        <td id="LC1794">            DWORD           cbSig;</td>
      </tr>
      <tr>
        <td id="L1795" data-line-number="1795"></td>
        <td id="LC1795">            pMD-&gt;<span>GetSig</span>(&amp;pSig, &amp;cbSig);</td>
      </tr>
      <tr>
        <td id="L1796" data-line-number="1796"></td>
        <td id="LC1796">            sig = <span>SigPointer</span>(pSig, cbSig);</td>
      </tr>
      <tr>
        <td id="L1797" data-line-number="1797"></td>
        <td id="LC1797">
</td>
      </tr>
      <tr>
        <td id="L1798" data-line-number="1798"></td>
        <td id="LC1798">            context = <span>MAKE_METHODCONTEXT</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L1799" data-line-number="1799"></td>
        <td id="LC1799">            scopeHnd = <span>GetScopeHandle</span>(pMD-&gt;<span>GetModule</span>());</td>
      </tr>
      <tr>
        <td id="L1800" data-line-number="1800"></td>
        <td id="LC1800">        }</td>
      </tr>
      <tr>
        <td id="L1801" data-line-number="1801"></td>
        <td id="LC1801">
</td>
      </tr>
      <tr>
        <td id="L1802" data-line-number="1802"></td>
        <td id="LC1802">        sig.<span>GetSignature</span>(&amp;pSig, &amp;cbSig);</td>
      </tr>
      <tr>
        <td id="L1803" data-line-number="1803"></td>
        <td id="LC1803">        sigMethTok = mdTokenNil;</td>
      </tr>
      <tr>
        <td id="L1804" data-line-number="1804"></td>
        <td id="LC1804">    }</td>
      </tr>
      <tr>
        <td id="L1805" data-line-number="1805"></td>
        <td id="LC1805">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1806" data-line-number="1806"></td>
        <td id="LC1806">    {</td>
      </tr>
      <tr>
        <td id="L1807" data-line-number="1807"></td>
        <td id="LC1807">        Module * module = (Module *)scopeHnd;</td>
      </tr>
      <tr>
        <td id="L1808" data-line-number="1808"></td>
        <td id="LC1808">        LPCUTF8  szName;</td>
      </tr>
      <tr>
        <td id="L1809" data-line-number="1809"></td>
        <td id="LC1809">
</td>
      </tr>
      <tr>
        <td id="L1810" data-line-number="1810"></td>
        <td id="LC1810">        <span>if</span> (<span>TypeFromToken</span>(sigMethTok) == mdtMemberRef)</td>
      </tr>
      <tr>
        <td id="L1811" data-line-number="1811"></td>
        <td id="LC1811">        {</td>
      </tr>
      <tr>
        <td id="L1812" data-line-number="1812"></td>
        <td id="LC1812">            <span>IfFailThrow</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetNameAndSigOfMemberRef</span>(sigMethTok, &amp;pSig, &amp;cbSig, &amp;szName));</td>
      </tr>
      <tr>
        <td id="L1813" data-line-number="1813"></td>
        <td id="LC1813">        }</td>
      </tr>
      <tr>
        <td id="L1814" data-line-number="1814"></td>
        <td id="LC1814">        <span>else</span> <span>if</span> (<span>TypeFromToken</span>(sigMethTok) == mdtMethodDef)</td>
      </tr>
      <tr>
        <td id="L1815" data-line-number="1815"></td>
        <td id="LC1815">        {</td>
      </tr>
      <tr>
        <td id="L1816" data-line-number="1816"></td>
        <td id="LC1816">            <span>IfFailThrow</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetSigOfMethodDef</span>(sigMethTok, &amp;cbSig, &amp;pSig));</td>
      </tr>
      <tr>
        <td id="L1817" data-line-number="1817"></td>
        <td id="LC1817">        }</td>
      </tr>
      <tr>
        <td id="L1818" data-line-number="1818"></td>
        <td id="LC1818">    }</td>
      </tr>
      <tr>
        <td id="L1819" data-line-number="1819"></td>
        <td id="LC1819">
</td>
      </tr>
      <tr>
        <td id="L1820" data-line-number="1820"></td>
        <td id="LC1820">    <span>CEEInfo::ConvToJitSig</span>(</td>
      </tr>
      <tr>
        <td id="L1821" data-line-number="1821"></td>
        <td id="LC1821">        pSig,</td>
      </tr>
      <tr>
        <td id="L1822" data-line-number="1822"></td>
        <td id="LC1822">        cbSig,</td>
      </tr>
      <tr>
        <td id="L1823" data-line-number="1823"></td>
        <td id="LC1823">        scopeHnd,</td>
      </tr>
      <tr>
        <td id="L1824" data-line-number="1824"></td>
        <td id="LC1824">        sigMethTok,</td>
      </tr>
      <tr>
        <td id="L1825" data-line-number="1825"></td>
        <td id="LC1825">        sigRet,</td>
      </tr>
      <tr>
        <td id="L1826" data-line-number="1826"></td>
        <td id="LC1826">        <span>GetMethodFromContext</span>(context),</td>
      </tr>
      <tr>
        <td id="L1827" data-line-number="1827"></td>
        <td id="LC1827">        <span>false</span>,</td>
      </tr>
      <tr>
        <td id="L1828" data-line-number="1828"></td>
        <td id="LC1828">        <span>GetTypeFromContext</span>(context));</td>
      </tr>
      <tr>
        <td id="L1829" data-line-number="1829"></td>
        <td id="LC1829">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L1830" data-line-number="1830"></td>
        <td id="LC1830">} <span><span>//</span> CEEInfo::findCallSiteSig</span></td>
      </tr>
      <tr>
        <td id="L1831" data-line-number="1831"></td>
        <td id="LC1831">
</td>
      </tr>
      <tr>
        <td id="L1832" data-line-number="1832"></td>
        <td id="LC1832"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L1833" data-line-number="1833"></td>
        <td id="LC1833"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1834" data-line-number="1834"></td>
        <td id="LC1834"><span>void</span></td>
      </tr>
      <tr>
        <td id="L1835" data-line-number="1835"></td>
        <td id="LC1835"><span>CEEInfo::findSig</span>(</td>
      </tr>
      <tr>
        <td id="L1836" data-line-number="1836"></td>
        <td id="LC1836">    CORINFO_MODULE_HANDLE  scopeHnd,</td>
      </tr>
      <tr>
        <td id="L1837" data-line-number="1837"></td>
        <td id="LC1837">    <span>unsigned</span>               sigTok,</td>
      </tr>
      <tr>
        <td id="L1838" data-line-number="1838"></td>
        <td id="LC1838">    CORINFO_CONTEXT_HANDLE context,</td>
      </tr>
      <tr>
        <td id="L1839" data-line-number="1839"></td>
        <td id="LC1839">    CORINFO_SIG_INFO *     sigRet)</td>
      </tr>
      <tr>
        <td id="L1840" data-line-number="1840"></td>
        <td id="LC1840">{</td>
      </tr>
      <tr>
        <td id="L1841" data-line-number="1841"></td>
        <td id="LC1841">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1842" data-line-number="1842"></td>
        <td id="LC1842">        THROWS;</td>
      </tr>
      <tr>
        <td id="L1843" data-line-number="1843"></td>
        <td id="LC1843">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L1844" data-line-number="1844"></td>
        <td id="LC1844">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1845" data-line-number="1845"></td>
        <td id="LC1845">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1846" data-line-number="1846"></td>
        <td id="LC1846">
</td>
      </tr>
      <tr>
        <td id="L1847" data-line-number="1847"></td>
        <td id="LC1847">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L1848" data-line-number="1848"></td>
        <td id="LC1848">
</td>
      </tr>
      <tr>
        <td id="L1849" data-line-number="1849"></td>
        <td id="LC1849">    PCCOR_SIGNATURE       pSig = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L1850" data-line-number="1850"></td>
        <td id="LC1850">    DWORD                 cbSig = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L1851" data-line-number="1851"></td>
        <td id="LC1851">
</td>
      </tr>
      <tr>
        <td id="L1852" data-line-number="1852"></td>
        <td id="LC1852">    <span>if</span> (<span>IsDynamicScope</span>(scopeHnd))</td>
      </tr>
      <tr>
        <td id="L1853" data-line-number="1853"></td>
        <td id="LC1853">    {</td>
      </tr>
      <tr>
        <td id="L1854" data-line-number="1854"></td>
        <td id="LC1854">        SigPointer sig = <span>GetDynamicResolver</span>(scopeHnd)-&gt;<span>ResolveSignature</span>(sigTok);</td>
      </tr>
      <tr>
        <td id="L1855" data-line-number="1855"></td>
        <td id="LC1855">        sig.<span>GetSignature</span>(&amp;pSig, &amp;cbSig);</td>
      </tr>
      <tr>
        <td id="L1856" data-line-number="1856"></td>
        <td id="LC1856">        sigTok = mdTokenNil;</td>
      </tr>
      <tr>
        <td id="L1857" data-line-number="1857"></td>
        <td id="LC1857">    }</td>
      </tr>
      <tr>
        <td id="L1858" data-line-number="1858"></td>
        <td id="LC1858">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L1859" data-line-number="1859"></td>
        <td id="LC1859">    {</td>
      </tr>
      <tr>
        <td id="L1860" data-line-number="1860"></td>
        <td id="LC1860">        Module * module = (Module *)scopeHnd;</td>
      </tr>
      <tr>
        <td id="L1861" data-line-number="1861"></td>
        <td id="LC1861">
</td>
      </tr>
      <tr>
        <td id="L1862" data-line-number="1862"></td>
        <td id="LC1862">        <span><span>//</span> We need to resolve this stand alone sig</span></td>
      </tr>
      <tr>
        <td id="L1863" data-line-number="1863"></td>
        <td id="LC1863">        <span>IfFailThrow</span>(module-&gt;<span>GetMDImport</span>()-&gt;<span>GetSigFromToken</span>(</td>
      </tr>
      <tr>
        <td id="L1864" data-line-number="1864"></td>
        <td id="LC1864">            (mdSignature)sigTok,</td>
      </tr>
      <tr>
        <td id="L1865" data-line-number="1865"></td>
        <td id="LC1865">            &amp;cbSig,</td>
      </tr>
      <tr>
        <td id="L1866" data-line-number="1866"></td>
        <td id="LC1866">            &amp;pSig));</td>
      </tr>
      <tr>
        <td id="L1867" data-line-number="1867"></td>
        <td id="LC1867">    }</td>
      </tr>
      <tr>
        <td id="L1868" data-line-number="1868"></td>
        <td id="LC1868">
</td>
      </tr>
      <tr>
        <td id="L1869" data-line-number="1869"></td>
        <td id="LC1869">    <span>CEEInfo::ConvToJitSig</span>(</td>
      </tr>
      <tr>
        <td id="L1870" data-line-number="1870"></td>
        <td id="LC1870">        pSig,</td>
      </tr>
      <tr>
        <td id="L1871" data-line-number="1871"></td>
        <td id="LC1871">        cbSig,</td>
      </tr>
      <tr>
        <td id="L1872" data-line-number="1872"></td>
        <td id="LC1872">        scopeHnd,</td>
      </tr>
      <tr>
        <td id="L1873" data-line-number="1873"></td>
        <td id="LC1873">        sigTok,</td>
      </tr>
      <tr>
        <td id="L1874" data-line-number="1874"></td>
        <td id="LC1874">        sigRet,</td>
      </tr>
      <tr>
        <td id="L1875" data-line-number="1875"></td>
        <td id="LC1875">        <span>GetMethodFromContext</span>(context),</td>
      </tr>
      <tr>
        <td id="L1876" data-line-number="1876"></td>
        <td id="LC1876">        <span>false</span>,</td>
      </tr>
      <tr>
        <td id="L1877" data-line-number="1877"></td>
        <td id="LC1877">        <span>GetTypeFromContext</span>(context));</td>
      </tr>
      <tr>
        <td id="L1878" data-line-number="1878"></td>
        <td id="LC1878">
</td>
      </tr>
      <tr>
        <td id="L1879" data-line-number="1879"></td>
        <td id="LC1879">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L1880" data-line-number="1880"></td>
        <td id="LC1880">} <span><span>//</span> CEEInfo::findSig</span></td>
      </tr>
      <tr>
        <td id="L1881" data-line-number="1881"></td>
        <td id="LC1881">
</td>
      </tr>
      <tr>
        <td id="L1882" data-line-number="1882"></td>
        <td id="LC1882"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L1883" data-line-number="1883"></td>
        <td id="LC1883"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1884" data-line-number="1884"></td>
        <td id="LC1884"><span>unsigned</span></td>
      </tr>
      <tr>
        <td id="L1885" data-line-number="1885"></td>
        <td id="LC1885"><span>CEEInfo::getClassSize</span>(</td>
      </tr>
      <tr>
        <td id="L1886" data-line-number="1886"></td>
        <td id="LC1886">    CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L1887" data-line-number="1887"></td>
        <td id="LC1887">{</td>
      </tr>
      <tr>
        <td id="L1888" data-line-number="1888"></td>
        <td id="LC1888">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1889" data-line-number="1889"></td>
        <td id="LC1889">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L1890" data-line-number="1890"></td>
        <td id="LC1890">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L1891" data-line-number="1891"></td>
        <td id="LC1891">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1892" data-line-number="1892"></td>
        <td id="LC1892">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1893" data-line-number="1893"></td>
        <td id="LC1893">
</td>
      </tr>
      <tr>
        <td id="L1894" data-line-number="1894"></td>
        <td id="LC1894">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L1895" data-line-number="1895"></td>
        <td id="LC1895">
</td>
      </tr>
      <tr>
        <td id="L1896" data-line-number="1896"></td>
        <td id="LC1896">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1897" data-line-number="1897"></td>
        <td id="LC1897">
</td>
      </tr>
      <tr>
        <td id="L1898" data-line-number="1898"></td>
        <td id="LC1898">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L1899" data-line-number="1899"></td>
        <td id="LC1899">    result = VMClsHnd.<span>GetSize</span>();</td>
      </tr>
      <tr>
        <td id="L1900" data-line-number="1900"></td>
        <td id="LC1900">
</td>
      </tr>
      <tr>
        <td id="L1901" data-line-number="1901"></td>
        <td id="LC1901">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1902" data-line-number="1902"></td>
        <td id="LC1902">
</td>
      </tr>
      <tr>
        <td id="L1903" data-line-number="1903"></td>
        <td id="LC1903">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L1904" data-line-number="1904"></td>
        <td id="LC1904">}</td>
      </tr>
      <tr>
        <td id="L1905" data-line-number="1905"></td>
        <td id="LC1905">
</td>
      </tr>
      <tr>
        <td id="L1906" data-line-number="1906"></td>
        <td id="LC1906"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L1907" data-line-number="1907"></td>
        <td id="LC1907"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1908" data-line-number="1908"></td>
        <td id="LC1908"><span><span>//</span> Get the size of a reference type as allocated on the heap. This includes the size of the fields</span></td>
      </tr>
      <tr>
        <td id="L1909" data-line-number="1909"></td>
        <td id="LC1909"><span><span>//</span> (and any padding between the fields) and the size of a method table pointer but doesn't include</span></td>
      </tr>
      <tr>
        <td id="L1910" data-line-number="1910"></td>
        <td id="LC1910"><span><span>//</span> object header size or any padding for minimum size.</span></td>
      </tr>
      <tr>
        <td id="L1911" data-line-number="1911"></td>
        <td id="LC1911"><span>unsigned</span></td>
      </tr>
      <tr>
        <td id="L1912" data-line-number="1912"></td>
        <td id="LC1912"><span>CEEInfo::getHeapClassSize</span>(</td>
      </tr>
      <tr>
        <td id="L1913" data-line-number="1913"></td>
        <td id="LC1913">    CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L1914" data-line-number="1914"></td>
        <td id="LC1914">{</td>
      </tr>
      <tr>
        <td id="L1915" data-line-number="1915"></td>
        <td id="LC1915">    CONTRACTL{</td>
      </tr>
      <tr>
        <td id="L1916" data-line-number="1916"></td>
        <td id="LC1916">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L1917" data-line-number="1917"></td>
        <td id="LC1917">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L1918" data-line-number="1918"></td>
        <td id="LC1918">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1919" data-line-number="1919"></td>
        <td id="LC1919">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1920" data-line-number="1920"></td>
        <td id="LC1920">
</td>
      </tr>
      <tr>
        <td id="L1921" data-line-number="1921"></td>
        <td id="LC1921">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L1922" data-line-number="1922"></td>
        <td id="LC1922">
</td>
      </tr>
      <tr>
        <td id="L1923" data-line-number="1923"></td>
        <td id="LC1923">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1924" data-line-number="1924"></td>
        <td id="LC1924">
</td>
      </tr>
      <tr>
        <td id="L1925" data-line-number="1925"></td>
        <td id="LC1925">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L1926" data-line-number="1926"></td>
        <td id="LC1926">    MethodTable* pMT = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L1927" data-line-number="1927"></td>
        <td id="LC1927">    <span>_ASSERTE</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L1928" data-line-number="1928"></td>
        <td id="LC1928">    <span>_ASSERTE</span>(!pMT-&gt;<span>IsValueType</span>());</td>
      </tr>
      <tr>
        <td id="L1929" data-line-number="1929"></td>
        <td id="LC1929">    <span>_ASSERTE</span>(!pMT-&gt;<span>HasComponentSize</span>());</td>
      </tr>
      <tr>
        <td id="L1930" data-line-number="1930"></td>
        <td id="LC1930">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L1931" data-line-number="1931"></td>
        <td id="LC1931">    <span>_ASSERTE</span>(!<span>IsReadyToRunCompilation</span>() || pMT-&gt;<span>IsInheritanceChainLayoutFixedInCurrentVersionBubble</span>());</td>
      </tr>
      <tr>
        <td id="L1932" data-line-number="1932"></td>
        <td id="LC1932">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L1933" data-line-number="1933"></td>
        <td id="LC1933">
</td>
      </tr>
      <tr>
        <td id="L1934" data-line-number="1934"></td>
        <td id="LC1934">    <span><span>//</span> Add OBJECT_SIZE to account for method table pointer.</span></td>
      </tr>
      <tr>
        <td id="L1935" data-line-number="1935"></td>
        <td id="LC1935">    result = pMT-&gt;<span>GetNumInstanceFieldBytes</span>() + OBJECT_SIZE;</td>
      </tr>
      <tr>
        <td id="L1936" data-line-number="1936"></td>
        <td id="LC1936">
</td>
      </tr>
      <tr>
        <td id="L1937" data-line-number="1937"></td>
        <td id="LC1937">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1938" data-line-number="1938"></td>
        <td id="LC1938">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L1939" data-line-number="1939"></td>
        <td id="LC1939">}</td>
      </tr>
      <tr>
        <td id="L1940" data-line-number="1940"></td>
        <td id="LC1940">
</td>
      </tr>
      <tr>
        <td id="L1941" data-line-number="1941"></td>
        <td id="LC1941"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L1942" data-line-number="1942"></td>
        <td id="LC1942"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L1943" data-line-number="1943"></td>
        <td id="LC1943"><span><span>//</span> Return TRUE if an object of this type can be allocated on the stack.</span></td>
      </tr>
      <tr>
        <td id="L1944" data-line-number="1944"></td>
        <td id="LC1944">BOOL <span>CEEInfo::canAllocateOnStack</span>(CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L1945" data-line-number="1945"></td>
        <td id="LC1945">{</td>
      </tr>
      <tr>
        <td id="L1946" data-line-number="1946"></td>
        <td id="LC1946">    CONTRACTL{</td>
      </tr>
      <tr>
        <td id="L1947" data-line-number="1947"></td>
        <td id="LC1947">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L1948" data-line-number="1948"></td>
        <td id="LC1948">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L1949" data-line-number="1949"></td>
        <td id="LC1949">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1950" data-line-number="1950"></td>
        <td id="LC1950">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1951" data-line-number="1951"></td>
        <td id="LC1951">
</td>
      </tr>
      <tr>
        <td id="L1952" data-line-number="1952"></td>
        <td id="LC1952">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L1953" data-line-number="1953"></td>
        <td id="LC1953">
</td>
      </tr>
      <tr>
        <td id="L1954" data-line-number="1954"></td>
        <td id="LC1954">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1955" data-line-number="1955"></td>
        <td id="LC1955">
</td>
      </tr>
      <tr>
        <td id="L1956" data-line-number="1956"></td>
        <td id="LC1956">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L1957" data-line-number="1957"></td>
        <td id="LC1957">    MethodTable* pMT = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L1958" data-line-number="1958"></td>
        <td id="LC1958">    <span>_ASSERTE</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L1959" data-line-number="1959"></td>
        <td id="LC1959">    <span>_ASSERTE</span>(!pMT-&gt;<span>IsValueType</span>());</td>
      </tr>
      <tr>
        <td id="L1960" data-line-number="1960"></td>
        <td id="LC1960">
</td>
      </tr>
      <tr>
        <td id="L1961" data-line-number="1961"></td>
        <td id="LC1961">    result = !pMT-&gt;<span>HasFinalizer</span>();</td>
      </tr>
      <tr>
        <td id="L1962" data-line-number="1962"></td>
        <td id="LC1962">
</td>
      </tr>
      <tr>
        <td id="L1963" data-line-number="1963"></td>
        <td id="LC1963">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L1964" data-line-number="1964"></td>
        <td id="LC1964">    <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp; !pMT-&gt;<span>IsInheritanceChainLayoutFixedInCurrentVersionBubble</span>())</td>
      </tr>
      <tr>
        <td id="L1965" data-line-number="1965"></td>
        <td id="LC1965">    {</td>
      </tr>
      <tr>
        <td id="L1966" data-line-number="1966"></td>
        <td id="LC1966">        result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L1967" data-line-number="1967"></td>
        <td id="LC1967">    }</td>
      </tr>
      <tr>
        <td id="L1968" data-line-number="1968"></td>
        <td id="LC1968">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L1969" data-line-number="1969"></td>
        <td id="LC1969">
</td>
      </tr>
      <tr>
        <td id="L1970" data-line-number="1970"></td>
        <td id="LC1970">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1971" data-line-number="1971"></td>
        <td id="LC1971">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L1972" data-line-number="1972"></td>
        <td id="LC1972">}</td>
      </tr>
      <tr>
        <td id="L1973" data-line-number="1973"></td>
        <td id="LC1973">
</td>
      </tr>
      <tr>
        <td id="L1974" data-line-number="1974"></td>
        <td id="LC1974"><span>unsigned</span> <span>CEEInfo::getClassAlignmentRequirement</span>(CORINFO_CLASS_HANDLE type, BOOL <span>fDoubleAlignHint</span>)</td>
      </tr>
      <tr>
        <td id="L1975" data-line-number="1975"></td>
        <td id="LC1975">{</td>
      </tr>
      <tr>
        <td id="L1976" data-line-number="1976"></td>
        <td id="LC1976">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L1977" data-line-number="1977"></td>
        <td id="LC1977">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L1978" data-line-number="1978"></td>
        <td id="LC1978">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L1979" data-line-number="1979"></td>
        <td id="LC1979">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L1980" data-line-number="1980"></td>
        <td id="LC1980">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L1981" data-line-number="1981"></td>
        <td id="LC1981">
</td>
      </tr>
      <tr>
        <td id="L1982" data-line-number="1982"></td>
        <td id="LC1982">    <span><span>//</span> Default alignment is sizeof(void*)</span></td>
      </tr>
      <tr>
        <td id="L1983" data-line-number="1983"></td>
        <td id="LC1983">    <span>unsigned</span> result = TARGET_POINTER_SIZE;</td>
      </tr>
      <tr>
        <td id="L1984" data-line-number="1984"></td>
        <td id="LC1984">
</td>
      </tr>
      <tr>
        <td id="L1985" data-line-number="1985"></td>
        <td id="LC1985">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L1986" data-line-number="1986"></td>
        <td id="LC1986">
</td>
      </tr>
      <tr>
        <td id="L1987" data-line-number="1987"></td>
        <td id="LC1987">    TypeHandle <span>clsHnd</span>(type);</td>
      </tr>
      <tr>
        <td id="L1988" data-line-number="1988"></td>
        <td id="LC1988">
</td>
      </tr>
      <tr>
        <td id="L1989" data-line-number="1989"></td>
        <td id="LC1989">#<span>ifdef</span> FEATURE_DOUBLE_ALIGNMENT_HINT</td>
      </tr>
      <tr>
        <td id="L1990" data-line-number="1990"></td>
        <td id="LC1990">    <span>if</span> (<span>fDoubleAlignHint</span>)</td>
      </tr>
      <tr>
        <td id="L1991" data-line-number="1991"></td>
        <td id="LC1991">    {</td>
      </tr>
      <tr>
        <td id="L1992" data-line-number="1992"></td>
        <td id="LC1992">        MethodTable* pMT = clsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L1993" data-line-number="1993"></td>
        <td id="LC1993">        <span>if</span> (pMT != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L1994" data-line-number="1994"></td>
        <td id="LC1994">        {</td>
      </tr>
      <tr>
        <td id="L1995" data-line-number="1995"></td>
        <td id="LC1995">            <span><span>//</span> Return the size of the double align hint. Ignore the actual alignment info account</span></td>
      </tr>
      <tr>
        <td id="L1996" data-line-number="1996"></td>
        <td id="LC1996">            <span><span>//</span> so that structs with 64-bit integer fields do not trigger double aligned frames on x86.</span></td>
      </tr>
      <tr>
        <td id="L1997" data-line-number="1997"></td>
        <td id="LC1997">            <span>if</span> (pMT-&gt;<span>GetClass</span>()-&gt;<span>IsAlign8Candidate</span>())</td>
      </tr>
      <tr>
        <td id="L1998" data-line-number="1998"></td>
        <td id="LC1998">                result = <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L1999" data-line-number="1999"></td>
        <td id="LC1999">        }</td>
      </tr>
      <tr>
        <td id="L2000" data-line-number="2000"></td>
        <td id="LC2000">    }</td>
      </tr>
      <tr>
        <td id="L2001" data-line-number="2001"></td>
        <td id="LC2001">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2002" data-line-number="2002"></td>
        <td id="LC2002">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L2003" data-line-number="2003"></td>
        <td id="LC2003">    {</td>
      </tr>
      <tr>
        <td id="L2004" data-line-number="2004"></td>
        <td id="LC2004">        result = <span>getClassAlignmentRequirementStatic</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L2005" data-line-number="2005"></td>
        <td id="LC2005">    }</td>
      </tr>
      <tr>
        <td id="L2006" data-line-number="2006"></td>
        <td id="LC2006">
</td>
      </tr>
      <tr>
        <td id="L2007" data-line-number="2007"></td>
        <td id="LC2007">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L2008" data-line-number="2008"></td>
        <td id="LC2008">
</td>
      </tr>
      <tr>
        <td id="L2009" data-line-number="2009"></td>
        <td id="LC2009">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2010" data-line-number="2010"></td>
        <td id="LC2010">}</td>
      </tr>
      <tr>
        <td id="L2011" data-line-number="2011"></td>
        <td id="LC2011">
</td>
      </tr>
      <tr>
        <td id="L2012" data-line-number="2012"></td>
        <td id="LC2012"><span>unsigned</span> <span>CEEInfo::getClassAlignmentRequirementStatic</span>(TypeHandle clsHnd)</td>
      </tr>
      <tr>
        <td id="L2013" data-line-number="2013"></td>
        <td id="LC2013">{</td>
      </tr>
      <tr>
        <td id="L2014" data-line-number="2014"></td>
        <td id="LC2014">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2015" data-line-number="2015"></td>
        <td id="LC2015">
</td>
      </tr>
      <tr>
        <td id="L2016" data-line-number="2016"></td>
        <td id="LC2016">    <span><span>//</span> Default alignment is sizeof(void*)</span></td>
      </tr>
      <tr>
        <td id="L2017" data-line-number="2017"></td>
        <td id="LC2017">    <span>unsigned</span> result = TARGET_POINTER_SIZE;</td>
      </tr>
      <tr>
        <td id="L2018" data-line-number="2018"></td>
        <td id="LC2018">
</td>
      </tr>
      <tr>
        <td id="L2019" data-line-number="2019"></td>
        <td id="LC2019">    MethodTable * pMT = clsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2020" data-line-number="2020"></td>
        <td id="LC2020">    <span>if</span> (pMT == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L2021" data-line-number="2021"></td>
        <td id="LC2021">        <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2022" data-line-number="2022"></td>
        <td id="LC2022">
</td>
      </tr>
      <tr>
        <td id="L2023" data-line-number="2023"></td>
        <td id="LC2023">    <span>if</span> (pMT-&gt;<span>HasLayout</span>())</td>
      </tr>
      <tr>
        <td id="L2024" data-line-number="2024"></td>
        <td id="LC2024">    {</td>
      </tr>
      <tr>
        <td id="L2025" data-line-number="2025"></td>
        <td id="LC2025">        EEClassLayoutInfo* pInfo = pMT-&gt;<span>GetLayoutInfo</span>();</td>
      </tr>
      <tr>
        <td id="L2026" data-line-number="2026"></td>
        <td id="LC2026">
</td>
      </tr>
      <tr>
        <td id="L2027" data-line-number="2027"></td>
        <td id="LC2027">        <span>if</span> (clsHnd.<span>IsNativeValueType</span>())</td>
      </tr>
      <tr>
        <td id="L2028" data-line-number="2028"></td>
        <td id="LC2028">        {</td>
      </tr>
      <tr>
        <td id="L2029" data-line-number="2029"></td>
        <td id="LC2029">            <span><span>//</span> if it's the unmanaged view of the managed type, we always use the unmanaged alignment requirement</span></td>
      </tr>
      <tr>
        <td id="L2030" data-line-number="2030"></td>
        <td id="LC2030">            result = pInfo-&gt;<span>m_LargestAlignmentRequirementOfAllMembers</span>;</td>
      </tr>
      <tr>
        <td id="L2031" data-line-number="2031"></td>
        <td id="LC2031">        }</td>
      </tr>
      <tr>
        <td id="L2032" data-line-number="2032"></td>
        <td id="LC2032">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L2033" data-line-number="2033"></td>
        <td id="LC2033">        <span>if</span> (pInfo-&gt;<span>IsManagedSequential</span>())</td>
      </tr>
      <tr>
        <td id="L2034" data-line-number="2034"></td>
        <td id="LC2034">        {</td>
      </tr>
      <tr>
        <td id="L2035" data-line-number="2035"></td>
        <td id="LC2035">            <span>_ASSERTE</span>(!pMT-&gt;<span>ContainsPointers</span>());</td>
      </tr>
      <tr>
        <td id="L2036" data-line-number="2036"></td>
        <td id="LC2036">
</td>
      </tr>
      <tr>
        <td id="L2037" data-line-number="2037"></td>
        <td id="LC2037">            <span><span>//</span> if it's managed sequential, we use the managed alignment requirement</span></td>
      </tr>
      <tr>
        <td id="L2038" data-line-number="2038"></td>
        <td id="LC2038">            result = pInfo-&gt;<span>m_ManagedLargestAlignmentRequirementOfAllMembers</span>;</td>
      </tr>
      <tr>
        <td id="L2039" data-line-number="2039"></td>
        <td id="LC2039">        }</td>
      </tr>
      <tr>
        <td id="L2040" data-line-number="2040"></td>
        <td id="LC2040">        <span>else</span> <span>if</span> (pInfo-&gt;<span>IsBlittable</span>())</td>
      </tr>
      <tr>
        <td id="L2041" data-line-number="2041"></td>
        <td id="LC2041">        {</td>
      </tr>
      <tr>
        <td id="L2042" data-line-number="2042"></td>
        <td id="LC2042">            <span>_ASSERTE</span>(!pMT-&gt;<span>ContainsPointers</span>());</td>
      </tr>
      <tr>
        <td id="L2043" data-line-number="2043"></td>
        <td id="LC2043">
</td>
      </tr>
      <tr>
        <td id="L2044" data-line-number="2044"></td>
        <td id="LC2044">            <span><span>//</span> if it's blittable, we use the unmanaged alignment requirement</span></td>
      </tr>
      <tr>
        <td id="L2045" data-line-number="2045"></td>
        <td id="LC2045">            result = pInfo-&gt;<span>m_LargestAlignmentRequirementOfAllMembers</span>;</td>
      </tr>
      <tr>
        <td id="L2046" data-line-number="2046"></td>
        <td id="LC2046">        }</td>
      </tr>
      <tr>
        <td id="L2047" data-line-number="2047"></td>
        <td id="LC2047">    }</td>
      </tr>
      <tr>
        <td id="L2048" data-line-number="2048"></td>
        <td id="LC2048">
</td>
      </tr>
      <tr>
        <td id="L2049" data-line-number="2049"></td>
        <td id="LC2049">#<span>ifdef</span> FEATURE_64BIT_ALIGNMENT</td>
      </tr>
      <tr>
        <td id="L2050" data-line-number="2050"></td>
        <td id="LC2050">    <span>if</span> (result &lt; <span>8</span> &amp;&amp; pMT-&gt;<span>RequiresAlign8</span>())</td>
      </tr>
      <tr>
        <td id="L2051" data-line-number="2051"></td>
        <td id="LC2051">    {</td>
      </tr>
      <tr>
        <td id="L2052" data-line-number="2052"></td>
        <td id="LC2052">        <span><span>//</span> If the structure contains 64-bit primitive fields and the platform requires 8-byte alignment for</span></td>
      </tr>
      <tr>
        <td id="L2053" data-line-number="2053"></td>
        <td id="LC2053">        <span><span>//</span> such fields then make sure we return at least 8-byte alignment. Note that it's technically possible</span></td>
      </tr>
      <tr>
        <td id="L2054" data-line-number="2054"></td>
        <td id="LC2054">        <span><span>//</span> to create unmanaged APIs that take unaligned structures containing such fields and this</span></td>
      </tr>
      <tr>
        <td id="L2055" data-line-number="2055"></td>
        <td id="LC2055">        <span><span>//</span> unconditional alignment bump would cause us to get the calling convention wrong on platforms such</span></td>
      </tr>
      <tr>
        <td id="L2056" data-line-number="2056"></td>
        <td id="LC2056">        <span><span>//</span> as ARM. If we see such cases in the future we'd need to add another control (such as an alignment</span></td>
      </tr>
      <tr>
        <td id="L2057" data-line-number="2057"></td>
        <td id="LC2057">        <span><span>//</span> property for the StructLayout attribute or a marshaling directive attribute for p/invoke arguments)</span></td>
      </tr>
      <tr>
        <td id="L2058" data-line-number="2058"></td>
        <td id="LC2058">        <span><span>//</span> that allows more precise control. For now we'll go with the likely scenario.</span></td>
      </tr>
      <tr>
        <td id="L2059" data-line-number="2059"></td>
        <td id="LC2059">        result = <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L2060" data-line-number="2060"></td>
        <td id="LC2060">    }</td>
      </tr>
      <tr>
        <td id="L2061" data-line-number="2061"></td>
        <td id="LC2061">#<span>endif</span> <span><span>//</span> FEATURE_64BIT_ALIGNMENT</span></td>
      </tr>
      <tr>
        <td id="L2062" data-line-number="2062"></td>
        <td id="LC2062">
</td>
      </tr>
      <tr>
        <td id="L2063" data-line-number="2063"></td>
        <td id="LC2063">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2064" data-line-number="2064"></td>
        <td id="LC2064">}</td>
      </tr>
      <tr>
        <td id="L2065" data-line-number="2065"></td>
        <td id="LC2065">
</td>
      </tr>
      <tr>
        <td id="L2066" data-line-number="2066"></td>
        <td id="LC2066">CORINFO_FIELD_HANDLE</td>
      </tr>
      <tr>
        <td id="L2067" data-line-number="2067"></td>
        <td id="LC2067"><span>CEEInfo::getFieldInClass</span>(CORINFO_CLASS_HANDLE clsHnd, INT num)</td>
      </tr>
      <tr>
        <td id="L2068" data-line-number="2068"></td>
        <td id="LC2068">{</td>
      </tr>
      <tr>
        <td id="L2069" data-line-number="2069"></td>
        <td id="LC2069">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2070" data-line-number="2070"></td>
        <td id="LC2070">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L2071" data-line-number="2071"></td>
        <td id="LC2071">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L2072" data-line-number="2072"></td>
        <td id="LC2072">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2073" data-line-number="2073"></td>
        <td id="LC2073">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2074" data-line-number="2074"></td>
        <td id="LC2074">
</td>
      </tr>
      <tr>
        <td id="L2075" data-line-number="2075"></td>
        <td id="LC2075">    CORINFO_FIELD_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L2076" data-line-number="2076"></td>
        <td id="LC2076">
</td>
      </tr>
      <tr>
        <td id="L2077" data-line-number="2077"></td>
        <td id="LC2077">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L2078" data-line-number="2078"></td>
        <td id="LC2078">
</td>
      </tr>
      <tr>
        <td id="L2079" data-line-number="2079"></td>
        <td id="LC2079">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L2080" data-line-number="2080"></td>
        <td id="LC2080">
</td>
      </tr>
      <tr>
        <td id="L2081" data-line-number="2081"></td>
        <td id="LC2081">    MethodTable* pMT= VMClsHnd.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2082" data-line-number="2082"></td>
        <td id="LC2082">
</td>
      </tr>
      <tr>
        <td id="L2083" data-line-number="2083"></td>
        <td id="LC2083">    result = (CORINFO_FIELD_HANDLE) ((pMT-&gt;<span>GetApproxFieldDescListRaw</span>()) + num);</td>
      </tr>
      <tr>
        <td id="L2084" data-line-number="2084"></td>
        <td id="LC2084">
</td>
      </tr>
      <tr>
        <td id="L2085" data-line-number="2085"></td>
        <td id="LC2085">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L2086" data-line-number="2086"></td>
        <td id="LC2086">
</td>
      </tr>
      <tr>
        <td id="L2087" data-line-number="2087"></td>
        <td id="LC2087">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2088" data-line-number="2088"></td>
        <td id="LC2088">}</td>
      </tr>
      <tr>
        <td id="L2089" data-line-number="2089"></td>
        <td id="LC2089">
</td>
      </tr>
      <tr>
        <td id="L2090" data-line-number="2090"></td>
        <td id="LC2090">mdMethodDef</td>
      </tr>
      <tr>
        <td id="L2091" data-line-number="2091"></td>
        <td id="LC2091"><span>CEEInfo::getMethodDefFromMethod</span>(CORINFO_METHOD_HANDLE hMethod)</td>
      </tr>
      <tr>
        <td id="L2092" data-line-number="2092"></td>
        <td id="LC2092">{</td>
      </tr>
      <tr>
        <td id="L2093" data-line-number="2093"></td>
        <td id="LC2093">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2094" data-line-number="2094"></td>
        <td id="LC2094">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L2095" data-line-number="2095"></td>
        <td id="LC2095">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L2096" data-line-number="2096"></td>
        <td id="LC2096">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2097" data-line-number="2097"></td>
        <td id="LC2097">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2098" data-line-number="2098"></td>
        <td id="LC2098">
</td>
      </tr>
      <tr>
        <td id="L2099" data-line-number="2099"></td>
        <td id="LC2099">    mdMethodDef result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L2100" data-line-number="2100"></td>
        <td id="LC2100">
</td>
      </tr>
      <tr>
        <td id="L2101" data-line-number="2101"></td>
        <td id="LC2101">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L2102" data-line-number="2102"></td>
        <td id="LC2102">
</td>
      </tr>
      <tr>
        <td id="L2103" data-line-number="2103"></td>
        <td id="LC2103">    MethodDesc* pMD = <span>GetMethod</span>(hMethod);</td>
      </tr>
      <tr>
        <td id="L2104" data-line-number="2104"></td>
        <td id="LC2104">
</td>
      </tr>
      <tr>
        <td id="L2105" data-line-number="2105"></td>
        <td id="LC2105">    <span>if</span> (pMD-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L2106" data-line-number="2106"></td>
        <td id="LC2106">    {</td>
      </tr>
      <tr>
        <td id="L2107" data-line-number="2107"></td>
        <td id="LC2107">        <span><span>//</span> Dynamic methods do not have tokens</span></td>
      </tr>
      <tr>
        <td id="L2108" data-line-number="2108"></td>
        <td id="LC2108">        result = mdMethodDefNil;</td>
      </tr>
      <tr>
        <td id="L2109" data-line-number="2109"></td>
        <td id="LC2109">    }</td>
      </tr>
      <tr>
        <td id="L2110" data-line-number="2110"></td>
        <td id="LC2110">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2111" data-line-number="2111"></td>
        <td id="LC2111">    {</td>
      </tr>
      <tr>
        <td id="L2112" data-line-number="2112"></td>
        <td id="LC2112">        result = pMD-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L2113" data-line-number="2113"></td>
        <td id="LC2113">    }</td>
      </tr>
      <tr>
        <td id="L2114" data-line-number="2114"></td>
        <td id="LC2114">
</td>
      </tr>
      <tr>
        <td id="L2115" data-line-number="2115"></td>
        <td id="LC2115">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L2116" data-line-number="2116"></td>
        <td id="LC2116">
</td>
      </tr>
      <tr>
        <td id="L2117" data-line-number="2117"></td>
        <td id="LC2117">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2118" data-line-number="2118"></td>
        <td id="LC2118">}</td>
      </tr>
      <tr>
        <td id="L2119" data-line-number="2119"></td>
        <td id="LC2119">
</td>
      </tr>
      <tr>
        <td id="L2120" data-line-number="2120"></td>
        <td id="LC2120">BOOL <span>CEEInfo::checkMethodModifier</span>(CORINFO_METHOD_HANDLE hMethod,</td>
      </tr>
      <tr>
        <td id="L2121" data-line-number="2121"></td>
        <td id="LC2121">                                  LPCSTR modifier,</td>
      </tr>
      <tr>
        <td id="L2122" data-line-number="2122"></td>
        <td id="LC2122">                                  BOOL <span>fOptional</span>)</td>
      </tr>
      <tr>
        <td id="L2123" data-line-number="2123"></td>
        <td id="LC2123">{</td>
      </tr>
      <tr>
        <td id="L2124" data-line-number="2124"></td>
        <td id="LC2124">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2125" data-line-number="2125"></td>
        <td id="LC2125">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2126" data-line-number="2126"></td>
        <td id="LC2126">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2127" data-line-number="2127"></td>
        <td id="LC2127">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2128" data-line-number="2128"></td>
        <td id="LC2128">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2129" data-line-number="2129"></td>
        <td id="LC2129">
</td>
      </tr>
      <tr>
        <td id="L2130" data-line-number="2130"></td>
        <td id="LC2130">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L2131" data-line-number="2131"></td>
        <td id="LC2131">
</td>
      </tr>
      <tr>
        <td id="L2132" data-line-number="2132"></td>
        <td id="LC2132">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2133" data-line-number="2133"></td>
        <td id="LC2133">
</td>
      </tr>
      <tr>
        <td id="L2134" data-line-number="2134"></td>
        <td id="LC2134">    MethodDesc* pMD = <span>GetMethod</span>(hMethod);</td>
      </tr>
      <tr>
        <td id="L2135" data-line-number="2135"></td>
        <td id="LC2135">    Module* pModule = pMD-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L2136" data-line-number="2136"></td>
        <td id="LC2136">    MetaSig <span>sig</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L2137" data-line-number="2137"></td>
        <td id="LC2137">    CorElementType eeType = <span>fOptional</span> ? ELEMENT_TYPE_CMOD_OPT : ELEMENT_TYPE_CMOD_REQD;</td>
      </tr>
      <tr>
        <td id="L2138" data-line-number="2138"></td>
        <td id="LC2138">
</td>
      </tr>
      <tr>
        <td id="L2139" data-line-number="2139"></td>
        <td id="LC2139">    <span><span>//</span> modopts/modreqs for the method are by convention stored on the return type</span></td>
      </tr>
      <tr>
        <td id="L2140" data-line-number="2140"></td>
        <td id="LC2140">    result = sig.<span>GetReturnProps</span>().<span>HasCustomModifier</span>(pModule, modifier, eeType);</td>
      </tr>
      <tr>
        <td id="L2141" data-line-number="2141"></td>
        <td id="LC2141">
</td>
      </tr>
      <tr>
        <td id="L2142" data-line-number="2142"></td>
        <td id="LC2142">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2143" data-line-number="2143"></td>
        <td id="LC2143">
</td>
      </tr>
      <tr>
        <td id="L2144" data-line-number="2144"></td>
        <td id="LC2144">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2145" data-line-number="2145"></td>
        <td id="LC2145">}</td>
      </tr>
      <tr>
        <td id="L2146" data-line-number="2146"></td>
        <td id="LC2146">
</td>
      </tr>
      <tr>
        <td id="L2147" data-line-number="2147"></td>
        <td id="LC2147"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L2148" data-line-number="2148"></td>
        <td id="LC2148"><span>static</span> <span>unsigned</span> <span>ComputeGCLayout</span>(MethodTable * pMT, BYTE* gcPtrs)</td>
      </tr>
      <tr>
        <td id="L2149" data-line-number="2149"></td>
        <td id="LC2149">{</td>
      </tr>
      <tr>
        <td id="L2150" data-line-number="2150"></td>
        <td id="LC2150">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2151" data-line-number="2151"></td>
        <td id="LC2151">
</td>
      </tr>
      <tr>
        <td id="L2152" data-line-number="2152"></td>
        <td id="LC2152">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L2153" data-line-number="2153"></td>
        <td id="LC2153">
</td>
      </tr>
      <tr>
        <td id="L2154" data-line-number="2154"></td>
        <td id="LC2154">    <span>_ASSERTE</span>(pMT-&gt;<span>IsValueType</span>());</td>
      </tr>
      <tr>
        <td id="L2155" data-line-number="2155"></td>
        <td id="LC2155">
</td>
      </tr>
      <tr>
        <td id="L2156" data-line-number="2156"></td>
        <td id="LC2156">    <span>if</span> (pMT-&gt;<span>HasSameTypeDefAs</span>(g_pByReferenceClass))</td>
      </tr>
      <tr>
        <td id="L2157" data-line-number="2157"></td>
        <td id="LC2157">    {</td>
      </tr>
      <tr>
        <td id="L2158" data-line-number="2158"></td>
        <td id="LC2158">        <span>if</span> (gcPtrs[<span>0</span>] == TYPE_GC_NONE)</td>
      </tr>
      <tr>
        <td id="L2159" data-line-number="2159"></td>
        <td id="LC2159">        {</td>
      </tr>
      <tr>
        <td id="L2160" data-line-number="2160"></td>
        <td id="LC2160">            gcPtrs[<span>0</span>] = TYPE_GC_BYREF;</td>
      </tr>
      <tr>
        <td id="L2161" data-line-number="2161"></td>
        <td id="LC2161">            result++;</td>
      </tr>
      <tr>
        <td id="L2162" data-line-number="2162"></td>
        <td id="LC2162">        }</td>
      </tr>
      <tr>
        <td id="L2163" data-line-number="2163"></td>
        <td id="LC2163">        <span>else</span> <span>if</span> (gcPtrs[<span>0</span>] != TYPE_GC_BYREF)</td>
      </tr>
      <tr>
        <td id="L2164" data-line-number="2164"></td>
        <td id="LC2164">        {</td>
      </tr>
      <tr>
        <td id="L2165" data-line-number="2165"></td>
        <td id="LC2165">            <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L2166" data-line-number="2166"></td>
        <td id="LC2166">        }</td>
      </tr>
      <tr>
        <td id="L2167" data-line-number="2167"></td>
        <td id="LC2167">        <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2168" data-line-number="2168"></td>
        <td id="LC2168">    }</td>
      </tr>
      <tr>
        <td id="L2169" data-line-number="2169"></td>
        <td id="LC2169">
</td>
      </tr>
      <tr>
        <td id="L2170" data-line-number="2170"></td>
        <td id="LC2170">    ApproxFieldDescIterator <span>fieldIterator</span>(pMT, ApproxFieldDescIterator::INSTANCE_FIELDS);</td>
      </tr>
      <tr>
        <td id="L2171" data-line-number="2171"></td>
        <td id="LC2171">    <span>for</span> (FieldDesc *pFD = fieldIterator.<span>Next</span>(); pFD != <span>NULL</span>; pFD = fieldIterator.<span>Next</span>())</td>
      </tr>
      <tr>
        <td id="L2172" data-line-number="2172"></td>
        <td id="LC2172">    {</td>
      </tr>
      <tr>
        <td id="L2173" data-line-number="2173"></td>
        <td id="LC2173">        <span>int</span> fieldStartIndex = pFD-&gt;<span>GetOffset</span>() / TARGET_POINTER_SIZE;</td>
      </tr>
      <tr>
        <td id="L2174" data-line-number="2174"></td>
        <td id="LC2174">
</td>
      </tr>
      <tr>
        <td id="L2175" data-line-number="2175"></td>
        <td id="LC2175">        <span>if</span> (pFD-&gt;<span>GetFieldType</span>() != ELEMENT_TYPE_VALUETYPE)</td>
      </tr>
      <tr>
        <td id="L2176" data-line-number="2176"></td>
        <td id="LC2176">        {</td>
      </tr>
      <tr>
        <td id="L2177" data-line-number="2177"></td>
        <td id="LC2177">            <span>if</span> (pFD-&gt;<span>IsObjRef</span>())</td>
      </tr>
      <tr>
        <td id="L2178" data-line-number="2178"></td>
        <td id="LC2178">            {</td>
      </tr>
      <tr>
        <td id="L2179" data-line-number="2179"></td>
        <td id="LC2179">                <span>if</span> (gcPtrs[fieldStartIndex] == TYPE_GC_NONE)</td>
      </tr>
      <tr>
        <td id="L2180" data-line-number="2180"></td>
        <td id="LC2180">                {</td>
      </tr>
      <tr>
        <td id="L2181" data-line-number="2181"></td>
        <td id="LC2181">                    gcPtrs[fieldStartIndex] = TYPE_GC_REF;</td>
      </tr>
      <tr>
        <td id="L2182" data-line-number="2182"></td>
        <td id="LC2182">                    result++;</td>
      </tr>
      <tr>
        <td id="L2183" data-line-number="2183"></td>
        <td id="LC2183">                }</td>
      </tr>
      <tr>
        <td id="L2184" data-line-number="2184"></td>
        <td id="LC2184">                <span>else</span> <span>if</span> (gcPtrs[fieldStartIndex] != TYPE_GC_REF)</td>
      </tr>
      <tr>
        <td id="L2185" data-line-number="2185"></td>
        <td id="LC2185">                {</td>
      </tr>
      <tr>
        <td id="L2186" data-line-number="2186"></td>
        <td id="LC2186">                    <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L2187" data-line-number="2187"></td>
        <td id="LC2187">                }</td>
      </tr>
      <tr>
        <td id="L2188" data-line-number="2188"></td>
        <td id="LC2188">            }</td>
      </tr>
      <tr>
        <td id="L2189" data-line-number="2189"></td>
        <td id="LC2189">        }</td>
      </tr>
      <tr>
        <td id="L2190" data-line-number="2190"></td>
        <td id="LC2190">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L2191" data-line-number="2191"></td>
        <td id="LC2191">        {</td>
      </tr>
      <tr>
        <td id="L2192" data-line-number="2192"></td>
        <td id="LC2192">            MethodTable * pFieldMT = pFD-&gt;<span>GetApproxFieldTypeHandleThrowing</span>().<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2193" data-line-number="2193"></td>
        <td id="LC2193">            result += <span>ComputeGCLayout</span>(pFieldMT, gcPtrs + fieldStartIndex);</td>
      </tr>
      <tr>
        <td id="L2194" data-line-number="2194"></td>
        <td id="LC2194">        }</td>
      </tr>
      <tr>
        <td id="L2195" data-line-number="2195"></td>
        <td id="LC2195">    }</td>
      </tr>
      <tr>
        <td id="L2196" data-line-number="2196"></td>
        <td id="LC2196">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2197" data-line-number="2197"></td>
        <td id="LC2197">}</td>
      </tr>
      <tr>
        <td id="L2198" data-line-number="2198"></td>
        <td id="LC2198">
</td>
      </tr>
      <tr>
        <td id="L2199" data-line-number="2199"></td>
        <td id="LC2199"><span>unsigned</span> <span>CEEInfo::getClassGClayout</span> (CORINFO_CLASS_HANDLE clsHnd, BYTE* gcPtrs)</td>
      </tr>
      <tr>
        <td id="L2200" data-line-number="2200"></td>
        <td id="LC2200">{</td>
      </tr>
      <tr>
        <td id="L2201" data-line-number="2201"></td>
        <td id="LC2201">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2202" data-line-number="2202"></td>
        <td id="LC2202">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2203" data-line-number="2203"></td>
        <td id="LC2203">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2204" data-line-number="2204"></td>
        <td id="LC2204">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2205" data-line-number="2205"></td>
        <td id="LC2205">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2206" data-line-number="2206"></td>
        <td id="LC2206">
</td>
      </tr>
      <tr>
        <td id="L2207" data-line-number="2207"></td>
        <td id="LC2207">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L2208" data-line-number="2208"></td>
        <td id="LC2208">
</td>
      </tr>
      <tr>
        <td id="L2209" data-line-number="2209"></td>
        <td id="LC2209">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2210" data-line-number="2210"></td>
        <td id="LC2210">
</td>
      </tr>
      <tr>
        <td id="L2211" data-line-number="2211"></td>
        <td id="LC2211">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L2212" data-line-number="2212"></td>
        <td id="LC2212">
</td>
      </tr>
      <tr>
        <td id="L2213" data-line-number="2213"></td>
        <td id="LC2213">    MethodTable* pMT = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2214" data-line-number="2214"></td>
        <td id="LC2214">
</td>
      </tr>
      <tr>
        <td id="L2215" data-line-number="2215"></td>
        <td id="LC2215">    <span>if</span> (VMClsHnd.<span>IsNativeValueType</span>())</td>
      </tr>
      <tr>
        <td id="L2216" data-line-number="2216"></td>
        <td id="LC2216">    {</td>
      </tr>
      <tr>
        <td id="L2217" data-line-number="2217"></td>
        <td id="LC2217">        <span><span>//</span> native value types have no GC pointers</span></td>
      </tr>
      <tr>
        <td id="L2218" data-line-number="2218"></td>
        <td id="LC2218">        result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L2219" data-line-number="2219"></td>
        <td id="LC2219">        <span>memset</span>(gcPtrs, TYPE_GC_NONE,</td>
      </tr>
      <tr>
        <td id="L2220" data-line-number="2220"></td>
        <td id="LC2220">               (VMClsHnd.<span>GetSize</span>() + TARGET_POINTER_SIZE - <span>1</span>) / TARGET_POINTER_SIZE);</td>
      </tr>
      <tr>
        <td id="L2221" data-line-number="2221"></td>
        <td id="LC2221">    }</td>
      </tr>
      <tr>
        <td id="L2222" data-line-number="2222"></td>
        <td id="LC2222">    <span>else</span> <span>if</span> (pMT-&gt;<span>IsByRefLike</span>())</td>
      </tr>
      <tr>
        <td id="L2223" data-line-number="2223"></td>
        <td id="LC2223">    {</td>
      </tr>
      <tr>
        <td id="L2224" data-line-number="2224"></td>
        <td id="LC2224">        <span>memset</span>(gcPtrs, TYPE_GC_NONE,</td>
      </tr>
      <tr>
        <td id="L2225" data-line-number="2225"></td>
        <td id="LC2225">            (VMClsHnd.<span>GetSize</span>() + TARGET_POINTER_SIZE - <span>1</span>) / TARGET_POINTER_SIZE);</td>
      </tr>
      <tr>
        <td id="L2226" data-line-number="2226"></td>
        <td id="LC2226">        <span><span>//</span> ByRefLike structs can be included as fields in other value types.</span></td>
      </tr>
      <tr>
        <td id="L2227" data-line-number="2227"></td>
        <td id="LC2227">        result = <span>ComputeGCLayout</span>(VMClsHnd.<span>AsMethodTable</span>(), gcPtrs);</td>
      </tr>
      <tr>
        <td id="L2228" data-line-number="2228"></td>
        <td id="LC2228">    }</td>
      </tr>
      <tr>
        <td id="L2229" data-line-number="2229"></td>
        <td id="LC2229">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2230" data-line-number="2230"></td>
        <td id="LC2230">    {</td>
      </tr>
      <tr>
        <td id="L2231" data-line-number="2231"></td>
        <td id="LC2231">        <span>_ASSERTE</span>(<span>sizeof</span>(BYTE) == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L2232" data-line-number="2232"></td>
        <td id="LC2232">
</td>
      </tr>
      <tr>
        <td id="L2233" data-line-number="2233"></td>
        <td id="LC2233">        BOOL isValueClass = pMT-&gt;<span>IsValueType</span>();</td>
      </tr>
      <tr>
        <td id="L2234" data-line-number="2234"></td>
        <td id="LC2234">
</td>
      </tr>
      <tr>
        <td id="L2235" data-line-number="2235"></td>
        <td id="LC2235">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L2236" data-line-number="2236"></td>
        <td id="LC2236">        <span>_ASSERTE</span>(isValueClass || !<span>IsReadyToRunCompilation</span>() || pMT-&gt;<span>IsInheritanceChainLayoutFixedInCurrentVersionBubble</span>());</td>
      </tr>
      <tr>
        <td id="L2237" data-line-number="2237"></td>
        <td id="LC2237">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L2238" data-line-number="2238"></td>
        <td id="LC2238">
</td>
      </tr>
      <tr>
        <td id="L2239" data-line-number="2239"></td>
        <td id="LC2239">        <span>unsigned</span> <span>int</span> size = isValueClass ? VMClsHnd.<span>GetSize</span>() : pMT-&gt;<span>GetNumInstanceFieldBytes</span>() + OBJECT_SIZE;</td>
      </tr>
      <tr>
        <td id="L2240" data-line-number="2240"></td>
        <td id="LC2240">
</td>
      </tr>
      <tr>
        <td id="L2241" data-line-number="2241"></td>
        <td id="LC2241">        <span><span>//</span> assume no GC pointers at first</span></td>
      </tr>
      <tr>
        <td id="L2242" data-line-number="2242"></td>
        <td id="LC2242">        result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L2243" data-line-number="2243"></td>
        <td id="LC2243">        <span>memset</span>(gcPtrs, TYPE_GC_NONE,</td>
      </tr>
      <tr>
        <td id="L2244" data-line-number="2244"></td>
        <td id="LC2244">               (size + TARGET_POINTER_SIZE - <span>1</span>) / TARGET_POINTER_SIZE);</td>
      </tr>
      <tr>
        <td id="L2245" data-line-number="2245"></td>
        <td id="LC2245">
</td>
      </tr>
      <tr>
        <td id="L2246" data-line-number="2246"></td>
        <td id="LC2246">        <span><span>//</span> walk the GC descriptors, turning on the correct bits</span></td>
      </tr>
      <tr>
        <td id="L2247" data-line-number="2247"></td>
        <td id="LC2247">        <span>if</span> (pMT-&gt;<span>ContainsPointers</span>())</td>
      </tr>
      <tr>
        <td id="L2248" data-line-number="2248"></td>
        <td id="LC2248">        {</td>
      </tr>
      <tr>
        <td id="L2249" data-line-number="2249"></td>
        <td id="LC2249">            CGCDesc* map = <span>CGCDesc::GetCGCDescFromMT</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L2250" data-line-number="2250"></td>
        <td id="LC2250">            CGCDescSeries * pByValueSeries = map-&gt;<span>GetLowestSeries</span>();</td>
      </tr>
      <tr>
        <td id="L2251" data-line-number="2251"></td>
        <td id="LC2251">
</td>
      </tr>
      <tr>
        <td id="L2252" data-line-number="2252"></td>
        <td id="LC2252">            <span>for</span> (SIZE_T i = <span>0</span>; i &lt; map-&gt;<span>GetNumSeries</span>(); i++)</td>
      </tr>
      <tr>
        <td id="L2253" data-line-number="2253"></td>
        <td id="LC2253">            {</td>
      </tr>
      <tr>
        <td id="L2254" data-line-number="2254"></td>
        <td id="LC2254">                <span><span>//</span> Get offset into the value class of the first pointer field (includes a +Object)</span></td>
      </tr>
      <tr>
        <td id="L2255" data-line-number="2255"></td>
        <td id="LC2255">                <span>size_t</span> cbSeriesSize = pByValueSeries-&gt;<span>GetSeriesSize</span>() + pMT-&gt;<span>GetBaseSize</span>();</td>
      </tr>
      <tr>
        <td id="L2256" data-line-number="2256"></td>
        <td id="LC2256">                <span>size_t</span> cbSeriesOffset = pByValueSeries-&gt;<span>GetSeriesOffset</span>();</td>
      </tr>
      <tr>
        <td id="L2257" data-line-number="2257"></td>
        <td id="LC2257">                <span>size_t</span> cbOffset = isValueClass ? cbSeriesOffset - OBJECT_SIZE : cbSeriesOffset;</td>
      </tr>
      <tr>
        <td id="L2258" data-line-number="2258"></td>
        <td id="LC2258">
</td>
      </tr>
      <tr>
        <td id="L2259" data-line-number="2259"></td>
        <td id="LC2259">                <span>_ASSERTE</span> (cbOffset % TARGET_POINTER_SIZE == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L2260" data-line-number="2260"></td>
        <td id="LC2260">                <span>_ASSERTE</span> (cbSeriesSize % TARGET_POINTER_SIZE == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L2261" data-line-number="2261"></td>
        <td id="LC2261">
</td>
      </tr>
      <tr>
        <td id="L2262" data-line-number="2262"></td>
        <td id="LC2262">                result += (<span>unsigned</span>) (cbSeriesSize / TARGET_POINTER_SIZE);</td>
      </tr>
      <tr>
        <td id="L2263" data-line-number="2263"></td>
        <td id="LC2263">                <span>memset</span>(&amp;gcPtrs[cbOffset / TARGET_POINTER_SIZE], TYPE_GC_REF, cbSeriesSize / TARGET_POINTER_SIZE);</td>
      </tr>
      <tr>
        <td id="L2264" data-line-number="2264"></td>
        <td id="LC2264">
</td>
      </tr>
      <tr>
        <td id="L2265" data-line-number="2265"></td>
        <td id="LC2265">                pByValueSeries++;</td>
      </tr>
      <tr>
        <td id="L2266" data-line-number="2266"></td>
        <td id="LC2266">            }</td>
      </tr>
      <tr>
        <td id="L2267" data-line-number="2267"></td>
        <td id="LC2267">        }</td>
      </tr>
      <tr>
        <td id="L2268" data-line-number="2268"></td>
        <td id="LC2268">    }</td>
      </tr>
      <tr>
        <td id="L2269" data-line-number="2269"></td>
        <td id="LC2269">
</td>
      </tr>
      <tr>
        <td id="L2270" data-line-number="2270"></td>
        <td id="LC2270">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2271" data-line-number="2271"></td>
        <td id="LC2271">
</td>
      </tr>
      <tr>
        <td id="L2272" data-line-number="2272"></td>
        <td id="LC2272">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2273" data-line-number="2273"></td>
        <td id="LC2273">}</td>
      </tr>
      <tr>
        <td id="L2274" data-line-number="2274"></td>
        <td id="LC2274">
</td>
      </tr>
      <tr>
        <td id="L2275" data-line-number="2275"></td>
        <td id="LC2275"><span><span>//</span> returns the enregister info for a struct based on type of fields, alignment, etc.</span></td>
      </tr>
      <tr>
        <td id="L2276" data-line-number="2276"></td>
        <td id="LC2276"><span>bool</span> <span>CEEInfo::getSystemVAmd64PassStructInRegisterDescriptor</span>(</td>
      </tr>
      <tr>
        <td id="L2277" data-line-number="2277"></td>
        <td id="LC2277">                                                <span><span>/*</span>IN<span>*/</span></span>  CORINFO_CLASS_HANDLE structHnd,</td>
      </tr>
      <tr>
        <td id="L2278" data-line-number="2278"></td>
        <td id="LC2278">                                                <span><span>/*</span>OUT<span>*/</span></span> SYSTEMV_AMD64_CORINFO_STRUCT_REG_PASSING_DESCRIPTOR* structPassInRegDescPtr)</td>
      </tr>
      <tr>
        <td id="L2279" data-line-number="2279"></td>
        <td id="LC2279">{</td>
      </tr>
      <tr>
        <td id="L2280" data-line-number="2280"></td>
        <td id="LC2280">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2281" data-line-number="2281"></td>
        <td id="LC2281">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2282" data-line-number="2282"></td>
        <td id="LC2282">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2283" data-line-number="2283"></td>
        <td id="LC2283">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2284" data-line-number="2284"></td>
        <td id="LC2284">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2285" data-line-number="2285"></td>
        <td id="LC2285">
</td>
      </tr>
      <tr>
        <td id="L2286" data-line-number="2286"></td>
        <td id="LC2286">#<span>if</span> defined(UNIX_AMD64_ABI_ITF)</td>
      </tr>
      <tr>
        <td id="L2287" data-line-number="2287"></td>
        <td id="LC2287">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2288" data-line-number="2288"></td>
        <td id="LC2288">
</td>
      </tr>
      <tr>
        <td id="L2289" data-line-number="2289"></td>
        <td id="LC2289">    <span>_ASSERTE</span>(structPassInRegDescPtr != <span>nullptr</span>);</td>
      </tr>
      <tr>
        <td id="L2290" data-line-number="2290"></td>
        <td id="LC2290">    TypeHandle <span>th</span>(structHnd);</td>
      </tr>
      <tr>
        <td id="L2291" data-line-number="2291"></td>
        <td id="LC2291">
</td>
      </tr>
      <tr>
        <td id="L2292" data-line-number="2292"></td>
        <td id="LC2292">    structPassInRegDescPtr-&gt;<span>passedInRegisters</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L2293" data-line-number="2293"></td>
        <td id="LC2293">
</td>
      </tr>
      <tr>
        <td id="L2294" data-line-number="2294"></td>
        <td id="LC2294">    <span><span>//</span> Make sure this is a value type.</span></td>
      </tr>
      <tr>
        <td id="L2295" data-line-number="2295"></td>
        <td id="LC2295">    <span>if</span> (th.<span>IsValueType</span>())</td>
      </tr>
      <tr>
        <td id="L2296" data-line-number="2296"></td>
        <td id="LC2296">    {</td>
      </tr>
      <tr>
        <td id="L2297" data-line-number="2297"></td>
        <td id="LC2297">        <span>_ASSERTE</span>(<span>CorInfoType2UnixAmd64Classification</span>(th.<span>GetInternalCorElementType</span>()) == SystemVClassificationTypeStruct);</td>
      </tr>
      <tr>
        <td id="L2298" data-line-number="2298"></td>
        <td id="LC2298">
</td>
      </tr>
      <tr>
        <td id="L2299" data-line-number="2299"></td>
        <td id="LC2299">        <span><span>//</span> The useNativeLayout in this case tracks whether the classification</span></td>
      </tr>
      <tr>
        <td id="L2300" data-line-number="2300"></td>
        <td id="LC2300">        <span><span>//</span> is for a native layout of the struct or not.</span></td>
      </tr>
      <tr>
        <td id="L2301" data-line-number="2301"></td>
        <td id="LC2301">        <span><span>//</span> If the struct has special marshaling it has a native layout.</span></td>
      </tr>
      <tr>
        <td id="L2302" data-line-number="2302"></td>
        <td id="LC2302">        <span><span>//</span> In such cases the classifier needs to use the native layout.</span></td>
      </tr>
      <tr>
        <td id="L2303" data-line-number="2303"></td>
        <td id="LC2303">        <span><span>//</span> For structs with no native layout, the managed layout should be used</span></td>
      </tr>
      <tr>
        <td id="L2304" data-line-number="2304"></td>
        <td id="LC2304">        <span><span>//</span> even if classified for the purposes of marshaling/PInvoke passing.</span></td>
      </tr>
      <tr>
        <td id="L2305" data-line-number="2305"></td>
        <td id="LC2305">        <span>bool</span> useNativeLayout = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L2306" data-line-number="2306"></td>
        <td id="LC2306">        MethodTable* methodTablePtr = <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L2307" data-line-number="2307"></td>
        <td id="LC2307">        <span>if</span> (!th.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L2308" data-line-number="2308"></td>
        <td id="LC2308">        {</td>
      </tr>
      <tr>
        <td id="L2309" data-line-number="2309"></td>
        <td id="LC2309">            methodTablePtr = th.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2310" data-line-number="2310"></td>
        <td id="LC2310">        }</td>
      </tr>
      <tr>
        <td id="L2311" data-line-number="2311"></td>
        <td id="LC2311">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L2312" data-line-number="2312"></td>
        <td id="LC2312">        {</td>
      </tr>
      <tr>
        <td id="L2313" data-line-number="2313"></td>
        <td id="LC2313">            <span>_ASSERTE</span>(th.<span>IsNativeValueType</span>());</td>
      </tr>
      <tr>
        <td id="L2314" data-line-number="2314"></td>
        <td id="LC2314">
</td>
      </tr>
      <tr>
        <td id="L2315" data-line-number="2315"></td>
        <td id="LC2315">            useNativeLayout = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L2316" data-line-number="2316"></td>
        <td id="LC2316">            methodTablePtr = th.<span>AsNativeValueType</span>();</td>
      </tr>
      <tr>
        <td id="L2317" data-line-number="2317"></td>
        <td id="LC2317">        }</td>
      </tr>
      <tr>
        <td id="L2318" data-line-number="2318"></td>
        <td id="LC2318">        <span>_ASSERTE</span>(methodTablePtr != <span>nullptr</span>);</td>
      </tr>
      <tr>
        <td id="L2319" data-line-number="2319"></td>
        <td id="LC2319">
</td>
      </tr>
      <tr>
        <td id="L2320" data-line-number="2320"></td>
        <td id="LC2320">        <span><span>//</span> If we have full support for UNIX_AMD64_ABI, and not just the interface,</span></td>
      </tr>
      <tr>
        <td id="L2321" data-line-number="2321"></td>
        <td id="LC2321">        <span><span>//</span> then we've cached whether this is a reg passed struct in the MethodTable, computed during</span></td>
      </tr>
      <tr>
        <td id="L2322" data-line-number="2322"></td>
        <td id="LC2322">        <span><span>//</span> MethodTable construction. Otherwise, we are just building in the interface, and we haven't</span></td>
      </tr>
      <tr>
        <td id="L2323" data-line-number="2323"></td>
        <td id="LC2323">        <span><span>//</span> computed or cached anything, so we need to compute it now.</span></td>
      </tr>
      <tr>
        <td id="L2324" data-line-number="2324"></td>
        <td id="LC2324">#<span>if</span> defined(UNIX_AMD64_ABI)</td>
      </tr>
      <tr>
        <td id="L2325" data-line-number="2325"></td>
        <td id="LC2325">        <span>bool</span> canPassInRegisters = useNativeLayout ? methodTablePtr-&gt;<span>GetLayoutInfo</span>()-&gt;<span>IsNativeStructPassedInRegisters</span>()</td>
      </tr>
      <tr>
        <td id="L2326" data-line-number="2326"></td>
        <td id="LC2326">                                                  : methodTablePtr-&gt;<span>IsRegPassedStruct</span>();</td>
      </tr>
      <tr>
        <td id="L2327" data-line-number="2327"></td>
        <td id="LC2327">#<span>else</span> <span><span>//</span> !defined(UNIX_AMD64_ABI)</span></td>
      </tr>
      <tr>
        <td id="L2328" data-line-number="2328"></td>
        <td id="LC2328">        <span>bool</span> canPassInRegisters = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L2329" data-line-number="2329"></td>
        <td id="LC2329">        SystemVStructRegisterPassingHelper <span>helper</span>((<span>unsigned</span> <span>int</span>)th.<span>GetSize</span>());</td>
      </tr>
      <tr>
        <td id="L2330" data-line-number="2330"></td>
        <td id="LC2330">        <span>if</span> (th.<span>GetSize</span>() &lt;= CLR_SYSTEMV_MAX_STRUCT_BYTES_TO_PASS_IN_REGISTERS)</td>
      </tr>
      <tr>
        <td id="L2331" data-line-number="2331"></td>
        <td id="LC2331">        {</td>
      </tr>
      <tr>
        <td id="L2332" data-line-number="2332"></td>
        <td id="LC2332">            canPassInRegisters = methodTablePtr-&gt;<span>ClassifyEightBytes</span>(&amp;helper, <span>0</span>, <span>0</span>, useNativeLayout);</td>
      </tr>
      <tr>
        <td id="L2333" data-line-number="2333"></td>
        <td id="LC2333">        }</td>
      </tr>
      <tr>
        <td id="L2334" data-line-number="2334"></td>
        <td id="LC2334">#<span>endif</span> <span><span>//</span> !defined(UNIX_AMD64_ABI)</span></td>
      </tr>
      <tr>
        <td id="L2335" data-line-number="2335"></td>
        <td id="LC2335">
</td>
      </tr>
      <tr>
        <td id="L2336" data-line-number="2336"></td>
        <td id="LC2336">        <span>if</span> (canPassInRegisters)</td>
      </tr>
      <tr>
        <td id="L2337" data-line-number="2337"></td>
        <td id="LC2337">        {</td>
      </tr>
      <tr>
        <td id="L2338" data-line-number="2338"></td>
        <td id="LC2338">#<span>if</span> defined(UNIX_AMD64_ABI)</td>
      </tr>
      <tr>
        <td id="L2339" data-line-number="2339"></td>
        <td id="LC2339">            SystemVStructRegisterPassingHelper <span>helper</span>((<span>unsigned</span> <span>int</span>)th.<span>GetSize</span>());</td>
      </tr>
      <tr>
        <td id="L2340" data-line-number="2340"></td>
        <td id="LC2340">            <span>bool</span> result = methodTablePtr-&gt;<span>ClassifyEightBytes</span>(&amp;helper, <span>0</span>, <span>0</span>, useNativeLayout);</td>
      </tr>
      <tr>
        <td id="L2341" data-line-number="2341"></td>
        <td id="LC2341">
</td>
      </tr>
      <tr>
        <td id="L2342" data-line-number="2342"></td>
        <td id="LC2342">            <span><span>//</span> The answer must be true at this point.</span></td>
      </tr>
      <tr>
        <td id="L2343" data-line-number="2343"></td>
        <td id="LC2343">            <span>_ASSERTE</span>(result);</td>
      </tr>
      <tr>
        <td id="L2344" data-line-number="2344"></td>
        <td id="LC2344">#<span>endif</span> <span><span>//</span> UNIX_AMD64_ABI</span></td>
      </tr>
      <tr>
        <td id="L2345" data-line-number="2345"></td>
        <td id="LC2345">
</td>
      </tr>
      <tr>
        <td id="L2346" data-line-number="2346"></td>
        <td id="LC2346">            structPassInRegDescPtr-&gt;<span>passedInRegisters</span> = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L2347" data-line-number="2347"></td>
        <td id="LC2347">
</td>
      </tr>
      <tr>
        <td id="L2348" data-line-number="2348"></td>
        <td id="LC2348">            structPassInRegDescPtr-&gt;<span>eightByteCount</span> = helper.<span>eightByteCount</span>;</td>
      </tr>
      <tr>
        <td id="L2349" data-line-number="2349"></td>
        <td id="LC2349">            <span>_ASSERTE</span>(structPassInRegDescPtr-&gt;<span>eightByteCount</span> &lt;= CLR_SYSTEMV_MAX_EIGHTBYTES_COUNT_TO_PASS_IN_REGISTERS);</td>
      </tr>
      <tr>
        <td id="L2350" data-line-number="2350"></td>
        <td id="LC2350">
</td>
      </tr>
      <tr>
        <td id="L2351" data-line-number="2351"></td>
        <td id="LC2351">            <span>for</span> (<span>unsigned</span> <span>int</span> i = <span>0</span>; i &lt; CLR_SYSTEMV_MAX_EIGHTBYTES_COUNT_TO_PASS_IN_REGISTERS; i++)</td>
      </tr>
      <tr>
        <td id="L2352" data-line-number="2352"></td>
        <td id="LC2352">            {</td>
      </tr>
      <tr>
        <td id="L2353" data-line-number="2353"></td>
        <td id="LC2353">                structPassInRegDescPtr-&gt;<span>eightByteClassifications</span>[i] = helper.<span>eightByteClassifications</span>[i];</td>
      </tr>
      <tr>
        <td id="L2354" data-line-number="2354"></td>
        <td id="LC2354">                structPassInRegDescPtr-&gt;<span>eightByteSizes</span>[i] = helper.<span>eightByteSizes</span>[i];</td>
      </tr>
      <tr>
        <td id="L2355" data-line-number="2355"></td>
        <td id="LC2355">                structPassInRegDescPtr-&gt;<span>eightByteOffsets</span>[i] = helper.<span>eightByteOffsets</span>[i];</td>
      </tr>
      <tr>
        <td id="L2356" data-line-number="2356"></td>
        <td id="LC2356">            }</td>
      </tr>
      <tr>
        <td id="L2357" data-line-number="2357"></td>
        <td id="LC2357">        }</td>
      </tr>
      <tr>
        <td id="L2358" data-line-number="2358"></td>
        <td id="LC2358">
</td>
      </tr>
      <tr>
        <td id="L2359" data-line-number="2359"></td>
        <td id="LC2359">        <span>_ASSERTE</span>(structPassInRegDescPtr-&gt;<span>passedInRegisters</span> == canPassInRegisters);</td>
      </tr>
      <tr>
        <td id="L2360" data-line-number="2360"></td>
        <td id="LC2360">    }</td>
      </tr>
      <tr>
        <td id="L2361" data-line-number="2361"></td>
        <td id="LC2361">
</td>
      </tr>
      <tr>
        <td id="L2362" data-line-number="2362"></td>
        <td id="LC2362">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2363" data-line-number="2363"></td>
        <td id="LC2363">
</td>
      </tr>
      <tr>
        <td id="L2364" data-line-number="2364"></td>
        <td id="LC2364">    <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L2365" data-line-number="2365"></td>
        <td id="LC2365">#<span>else</span> <span><span>//</span> !defined(UNIX_AMD64_ABI_ITF)</span></td>
      </tr>
      <tr>
        <td id="L2366" data-line-number="2366"></td>
        <td id="LC2366">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L2367" data-line-number="2367"></td>
        <td id="LC2367">#<span>endif</span> <span><span>//</span> !defined(UNIX_AMD64_ABI_ITF)</span></td>
      </tr>
      <tr>
        <td id="L2368" data-line-number="2368"></td>
        <td id="LC2368">}</td>
      </tr>
      <tr>
        <td id="L2369" data-line-number="2369"></td>
        <td id="LC2369">
</td>
      </tr>
      <tr>
        <td id="L2370" data-line-number="2370"></td>
        <td id="LC2370"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L2371" data-line-number="2371"></td>
        <td id="LC2371"><span>unsigned</span> <span>CEEInfo::getClassNumInstanceFields</span> (CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L2372" data-line-number="2372"></td>
        <td id="LC2372">{</td>
      </tr>
      <tr>
        <td id="L2373" data-line-number="2373"></td>
        <td id="LC2373">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2374" data-line-number="2374"></td>
        <td id="LC2374">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L2375" data-line-number="2375"></td>
        <td id="LC2375">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L2376" data-line-number="2376"></td>
        <td id="LC2376">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2377" data-line-number="2377"></td>
        <td id="LC2377">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2378" data-line-number="2378"></td>
        <td id="LC2378">
</td>
      </tr>
      <tr>
        <td id="L2379" data-line-number="2379"></td>
        <td id="LC2379">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L2380" data-line-number="2380"></td>
        <td id="LC2380">
</td>
      </tr>
      <tr>
        <td id="L2381" data-line-number="2381"></td>
        <td id="LC2381">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L2382" data-line-number="2382"></td>
        <td id="LC2382">
</td>
      </tr>
      <tr>
        <td id="L2383" data-line-number="2383"></td>
        <td id="LC2383">    TypeHandle <span>th</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L2384" data-line-number="2384"></td>
        <td id="LC2384">
</td>
      </tr>
      <tr>
        <td id="L2385" data-line-number="2385"></td>
        <td id="LC2385">    <span>if</span> (!th.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L2386" data-line-number="2386"></td>
        <td id="LC2386">    {</td>
      </tr>
      <tr>
        <td id="L2387" data-line-number="2387"></td>
        <td id="LC2387">        result = th.<span>AsMethodTable</span>()-&gt;<span>GetNumInstanceFields</span>();</td>
      </tr>
      <tr>
        <td id="L2388" data-line-number="2388"></td>
        <td id="LC2388">    }</td>
      </tr>
      <tr>
        <td id="L2389" data-line-number="2389"></td>
        <td id="LC2389">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2390" data-line-number="2390"></td>
        <td id="LC2390">    {</td>
      </tr>
      <tr>
        <td id="L2391" data-line-number="2391"></td>
        <td id="LC2391">        <span><span>//</span> native value types are opaque aggregates with explicit size</span></td>
      </tr>
      <tr>
        <td id="L2392" data-line-number="2392"></td>
        <td id="LC2392">        result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L2393" data-line-number="2393"></td>
        <td id="LC2393">    }</td>
      </tr>
      <tr>
        <td id="L2394" data-line-number="2394"></td>
        <td id="LC2394">
</td>
      </tr>
      <tr>
        <td id="L2395" data-line-number="2395"></td>
        <td id="LC2395">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L2396" data-line-number="2396"></td>
        <td id="LC2396">
</td>
      </tr>
      <tr>
        <td id="L2397" data-line-number="2397"></td>
        <td id="LC2397">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2398" data-line-number="2398"></td>
        <td id="LC2398">}</td>
      </tr>
      <tr>
        <td id="L2399" data-line-number="2399"></td>
        <td id="LC2399">
</td>
      </tr>
      <tr>
        <td id="L2400" data-line-number="2400"></td>
        <td id="LC2400">
</td>
      </tr>
      <tr>
        <td id="L2401" data-line-number="2401"></td>
        <td id="LC2401">CorInfoType <span>CEEInfo::asCorInfoType</span> (CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L2402" data-line-number="2402"></td>
        <td id="LC2402">{</td>
      </tr>
      <tr>
        <td id="L2403" data-line-number="2403"></td>
        <td id="LC2403">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2404" data-line-number="2404"></td>
        <td id="LC2404">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2405" data-line-number="2405"></td>
        <td id="LC2405">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2406" data-line-number="2406"></td>
        <td id="LC2406">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2407" data-line-number="2407"></td>
        <td id="LC2407">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2408" data-line-number="2408"></td>
        <td id="LC2408">
</td>
      </tr>
      <tr>
        <td id="L2409" data-line-number="2409"></td>
        <td id="LC2409">    CorInfoType result = CORINFO_TYPE_UNDEF;</td>
      </tr>
      <tr>
        <td id="L2410" data-line-number="2410"></td>
        <td id="LC2410">
</td>
      </tr>
      <tr>
        <td id="L2411" data-line-number="2411"></td>
        <td id="LC2411">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2412" data-line-number="2412"></td>
        <td id="LC2412">
</td>
      </tr>
      <tr>
        <td id="L2413" data-line-number="2413"></td>
        <td id="LC2413">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L2414" data-line-number="2414"></td>
        <td id="LC2414">    result = <span>toJitType</span>(VMClsHnd);</td>
      </tr>
      <tr>
        <td id="L2415" data-line-number="2415"></td>
        <td id="LC2415">
</td>
      </tr>
      <tr>
        <td id="L2416" data-line-number="2416"></td>
        <td id="LC2416">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2417" data-line-number="2417"></td>
        <td id="LC2417">
</td>
      </tr>
      <tr>
        <td id="L2418" data-line-number="2418"></td>
        <td id="LC2418">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2419" data-line-number="2419"></td>
        <td id="LC2419">}</td>
      </tr>
      <tr>
        <td id="L2420" data-line-number="2420"></td>
        <td id="LC2420">
</td>
      </tr>
      <tr>
        <td id="L2421" data-line-number="2421"></td>
        <td id="LC2421">
</td>
      </tr>
      <tr>
        <td id="L2422" data-line-number="2422"></td>
        <td id="LC2422">CORINFO_LOOKUP_KIND <span>CEEInfo::getLocationOfThisType</span>(CORINFO_METHOD_HANDLE context)</td>
      </tr>
      <tr>
        <td id="L2423" data-line-number="2423"></td>
        <td id="LC2423">{</td>
      </tr>
      <tr>
        <td id="L2424" data-line-number="2424"></td>
        <td id="LC2424">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2425" data-line-number="2425"></td>
        <td id="LC2425">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2426" data-line-number="2426"></td>
        <td id="LC2426">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2427" data-line-number="2427"></td>
        <td id="LC2427">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2428" data-line-number="2428"></td>
        <td id="LC2428">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2429" data-line-number="2429"></td>
        <td id="LC2429">
</td>
      </tr>
      <tr>
        <td id="L2430" data-line-number="2430"></td>
        <td id="LC2430">    CORINFO_LOOKUP_KIND result;</td>
      </tr>
      <tr>
        <td id="L2431" data-line-number="2431"></td>
        <td id="LC2431">
</td>
      </tr>
      <tr>
        <td id="L2432" data-line-number="2432"></td>
        <td id="LC2432">    <span><span>/*</span> Initialize fields of result for debug build warning <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L2433" data-line-number="2433"></td>
        <td id="LC2433">    result.<span>needsRuntimeLookup</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L2434" data-line-number="2434"></td>
        <td id="LC2434">    result.<span>runtimeLookupKind</span>  = CORINFO_LOOKUP_THISOBJ;</td>
      </tr>
      <tr>
        <td id="L2435" data-line-number="2435"></td>
        <td id="LC2435">
</td>
      </tr>
      <tr>
        <td id="L2436" data-line-number="2436"></td>
        <td id="LC2436">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2437" data-line-number="2437"></td>
        <td id="LC2437">
</td>
      </tr>
      <tr>
        <td id="L2438" data-line-number="2438"></td>
        <td id="LC2438">    MethodDesc *pContextMD = <span>GetMethod</span>(context);</td>
      </tr>
      <tr>
        <td id="L2439" data-line-number="2439"></td>
        <td id="LC2439">
</td>
      </tr>
      <tr>
        <td id="L2440" data-line-number="2440"></td>
        <td id="LC2440">    <span><span>//</span> If the method table is not shared, then return CONST</span></td>
      </tr>
      <tr>
        <td id="L2441" data-line-number="2441"></td>
        <td id="LC2441">    <span>if</span> (!pContextMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsSharedByGenericInstantiations</span>())</td>
      </tr>
      <tr>
        <td id="L2442" data-line-number="2442"></td>
        <td id="LC2442">    {</td>
      </tr>
      <tr>
        <td id="L2443" data-line-number="2443"></td>
        <td id="LC2443">        result.<span>needsRuntimeLookup</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L2444" data-line-number="2444"></td>
        <td id="LC2444">    }</td>
      </tr>
      <tr>
        <td id="L2445" data-line-number="2445"></td>
        <td id="LC2445">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2446" data-line-number="2446"></td>
        <td id="LC2446">    {</td>
      </tr>
      <tr>
        <td id="L2447" data-line-number="2447"></td>
        <td id="LC2447">        result.<span>needsRuntimeLookup</span> = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L2448" data-line-number="2448"></td>
        <td id="LC2448">
</td>
      </tr>
      <tr>
        <td id="L2449" data-line-number="2449"></td>
        <td id="LC2449">        <span><span>//</span> If we've got a vtable extra argument, go through that</span></td>
      </tr>
      <tr>
        <td id="L2450" data-line-number="2450"></td>
        <td id="LC2450">        <span>if</span> (pContextMD-&gt;<span>RequiresInstMethodTableArg</span>())</td>
      </tr>
      <tr>
        <td id="L2451" data-line-number="2451"></td>
        <td id="LC2451">        {</td>
      </tr>
      <tr>
        <td id="L2452" data-line-number="2452"></td>
        <td id="LC2452">            result.<span>runtimeLookupKind</span> = CORINFO_LOOKUP_CLASSPARAM;</td>
      </tr>
      <tr>
        <td id="L2453" data-line-number="2453"></td>
        <td id="LC2453">        }</td>
      </tr>
      <tr>
        <td id="L2454" data-line-number="2454"></td>
        <td id="LC2454">        <span><span>//</span> If we've got an object, go through its vtable</span></td>
      </tr>
      <tr>
        <td id="L2455" data-line-number="2455"></td>
        <td id="LC2455">        <span>else</span> <span>if</span> (pContextMD-&gt;<span>AcquiresInstMethodTableFromThis</span>())</td>
      </tr>
      <tr>
        <td id="L2456" data-line-number="2456"></td>
        <td id="LC2456">        {</td>
      </tr>
      <tr>
        <td id="L2457" data-line-number="2457"></td>
        <td id="LC2457">            result.<span>runtimeLookupKind</span> = CORINFO_LOOKUP_THISOBJ;</td>
      </tr>
      <tr>
        <td id="L2458" data-line-number="2458"></td>
        <td id="LC2458">        }</td>
      </tr>
      <tr>
        <td id="L2459" data-line-number="2459"></td>
        <td id="LC2459">        <span><span>//</span> Otherwise go through the method-desc argument</span></td>
      </tr>
      <tr>
        <td id="L2460" data-line-number="2460"></td>
        <td id="LC2460">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L2461" data-line-number="2461"></td>
        <td id="LC2461">        {</td>
      </tr>
      <tr>
        <td id="L2462" data-line-number="2462"></td>
        <td id="LC2462">            <span>_ASSERTE</span>(pContextMD-&gt;<span>RequiresInstMethodDescArg</span>());</td>
      </tr>
      <tr>
        <td id="L2463" data-line-number="2463"></td>
        <td id="LC2463">            result.<span>runtimeLookupKind</span> = CORINFO_LOOKUP_METHODPARAM;</td>
      </tr>
      <tr>
        <td id="L2464" data-line-number="2464"></td>
        <td id="LC2464">        }</td>
      </tr>
      <tr>
        <td id="L2465" data-line-number="2465"></td>
        <td id="LC2465">    }</td>
      </tr>
      <tr>
        <td id="L2466" data-line-number="2466"></td>
        <td id="LC2466">
</td>
      </tr>
      <tr>
        <td id="L2467" data-line-number="2467"></td>
        <td id="LC2467">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2468" data-line-number="2468"></td>
        <td id="LC2468">
</td>
      </tr>
      <tr>
        <td id="L2469" data-line-number="2469"></td>
        <td id="LC2469">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2470" data-line-number="2470"></td>
        <td id="LC2470">}</td>
      </tr>
      <tr>
        <td id="L2471" data-line-number="2471"></td>
        <td id="LC2471">
</td>
      </tr>
      <tr>
        <td id="L2472" data-line-number="2472"></td>
        <td id="LC2472">CORINFO_METHOD_HANDLE <span>CEEInfo::GetDelegateCtor</span>(</td>
      </tr>
      <tr>
        <td id="L2473" data-line-number="2473"></td>
        <td id="LC2473">                                        CORINFO_METHOD_HANDLE methHnd,</td>
      </tr>
      <tr>
        <td id="L2474" data-line-number="2474"></td>
        <td id="LC2474">                                        CORINFO_CLASS_HANDLE clsHnd,</td>
      </tr>
      <tr>
        <td id="L2475" data-line-number="2475"></td>
        <td id="LC2475">                                        CORINFO_METHOD_HANDLE targetMethodHnd,</td>
      </tr>
      <tr>
        <td id="L2476" data-line-number="2476"></td>
        <td id="LC2476">                                        DelegateCtorArgs *pCtorData)</td>
      </tr>
      <tr>
        <td id="L2477" data-line-number="2477"></td>
        <td id="LC2477">{</td>
      </tr>
      <tr>
        <td id="L2478" data-line-number="2478"></td>
        <td id="LC2478">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2479" data-line-number="2479"></td>
        <td id="LC2479">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2480" data-line-number="2480"></td>
        <td id="LC2480">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2481" data-line-number="2481"></td>
        <td id="LC2481">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2482" data-line-number="2482"></td>
        <td id="LC2482">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2483" data-line-number="2483"></td>
        <td id="LC2483">
</td>
      </tr>
      <tr>
        <td id="L2484" data-line-number="2484"></td>
        <td id="LC2484">    <span>if</span> (<span>isVerifyOnly</span>())</td>
      </tr>
      <tr>
        <td id="L2485" data-line-number="2485"></td>
        <td id="LC2485">    {</td>
      </tr>
      <tr>
        <td id="L2486" data-line-number="2486"></td>
        <td id="LC2486">        <span><span>//</span> No sense going through the optimized case just for verification and it can cause issues parsing</span></td>
      </tr>
      <tr>
        <td id="L2487" data-line-number="2487"></td>
        <td id="LC2487">        <span><span>//</span> uninstantiated generic signatures.</span></td>
      </tr>
      <tr>
        <td id="L2488" data-line-number="2488"></td>
        <td id="LC2488">        <span>return</span> methHnd;</td>
      </tr>
      <tr>
        <td id="L2489" data-line-number="2489"></td>
        <td id="LC2489">    }</td>
      </tr>
      <tr>
        <td id="L2490" data-line-number="2490"></td>
        <td id="LC2490">
</td>
      </tr>
      <tr>
        <td id="L2491" data-line-number="2491"></td>
        <td id="LC2491">    CORINFO_METHOD_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L2492" data-line-number="2492"></td>
        <td id="LC2492">
</td>
      </tr>
      <tr>
        <td id="L2493" data-line-number="2493"></td>
        <td id="LC2493">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2494" data-line-number="2494"></td>
        <td id="LC2494">
</td>
      </tr>
      <tr>
        <td id="L2495" data-line-number="2495"></td>
        <td id="LC2495">    MethodDesc *pCurrentCtor = (MethodDesc*)methHnd;</td>
      </tr>
      <tr>
        <td id="L2496" data-line-number="2496"></td>
        <td id="LC2496">    <span>if</span> (!pCurrentCtor-&gt;<span>IsFCall</span>())</td>
      </tr>
      <tr>
        <td id="L2497" data-line-number="2497"></td>
        <td id="LC2497">    {</td>
      </tr>
      <tr>
        <td id="L2498" data-line-number="2498"></td>
        <td id="LC2498">        result =  methHnd;</td>
      </tr>
      <tr>
        <td id="L2499" data-line-number="2499"></td>
        <td id="LC2499">    }</td>
      </tr>
      <tr>
        <td id="L2500" data-line-number="2500"></td>
        <td id="LC2500">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2501" data-line-number="2501"></td>
        <td id="LC2501">    {</td>
      </tr>
      <tr>
        <td id="L2502" data-line-number="2502"></td>
        <td id="LC2502">        MethodDesc *pTargetMethod = (MethodDesc*)targetMethodHnd;</td>
      </tr>
      <tr>
        <td id="L2503" data-line-number="2503"></td>
        <td id="LC2503">        TypeHandle delegateType = (TypeHandle)clsHnd;</td>
      </tr>
      <tr>
        <td id="L2504" data-line-number="2504"></td>
        <td id="LC2504">
</td>
      </tr>
      <tr>
        <td id="L2505" data-line-number="2505"></td>
        <td id="LC2505">        MethodDesc *pDelegateCtor = <span>COMDelegate::GetDelegateCtor</span>(delegateType, pTargetMethod, pCtorData);</td>
      </tr>
      <tr>
        <td id="L2506" data-line-number="2506"></td>
        <td id="LC2506">        <span>if</span> (!pDelegateCtor)</td>
      </tr>
      <tr>
        <td id="L2507" data-line-number="2507"></td>
        <td id="LC2507">            pDelegateCtor = pCurrentCtor;</td>
      </tr>
      <tr>
        <td id="L2508" data-line-number="2508"></td>
        <td id="LC2508">        result = (CORINFO_METHOD_HANDLE)pDelegateCtor;</td>
      </tr>
      <tr>
        <td id="L2509" data-line-number="2509"></td>
        <td id="LC2509">    }</td>
      </tr>
      <tr>
        <td id="L2510" data-line-number="2510"></td>
        <td id="LC2510">
</td>
      </tr>
      <tr>
        <td id="L2511" data-line-number="2511"></td>
        <td id="LC2511">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2512" data-line-number="2512"></td>
        <td id="LC2512">
</td>
      </tr>
      <tr>
        <td id="L2513" data-line-number="2513"></td>
        <td id="LC2513">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L2514" data-line-number="2514"></td>
        <td id="LC2514">}</td>
      </tr>
      <tr>
        <td id="L2515" data-line-number="2515"></td>
        <td id="LC2515">
</td>
      </tr>
      <tr>
        <td id="L2516" data-line-number="2516"></td>
        <td id="LC2516"><span>void</span> <span>CEEInfo::MethodCompileComplete</span>(CORINFO_METHOD_HANDLE methHnd)</td>
      </tr>
      <tr>
        <td id="L2517" data-line-number="2517"></td>
        <td id="LC2517">{</td>
      </tr>
      <tr>
        <td id="L2518" data-line-number="2518"></td>
        <td id="LC2518">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2519" data-line-number="2519"></td>
        <td id="LC2519">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2520" data-line-number="2520"></td>
        <td id="LC2520">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2521" data-line-number="2521"></td>
        <td id="LC2521">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2522" data-line-number="2522"></td>
        <td id="LC2522">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2523" data-line-number="2523"></td>
        <td id="LC2523">
</td>
      </tr>
      <tr>
        <td id="L2524" data-line-number="2524"></td>
        <td id="LC2524">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2525" data-line-number="2525"></td>
        <td id="LC2525">
</td>
      </tr>
      <tr>
        <td id="L2526" data-line-number="2526"></td>
        <td id="LC2526">    MethodDesc* pMD = <span>GetMethod</span>(methHnd);</td>
      </tr>
      <tr>
        <td id="L2527" data-line-number="2527"></td>
        <td id="LC2527">
</td>
      </tr>
      <tr>
        <td id="L2528" data-line-number="2528"></td>
        <td id="LC2528">    <span>if</span> (pMD-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L2529" data-line-number="2529"></td>
        <td id="LC2529">    {</td>
      </tr>
      <tr>
        <td id="L2530" data-line-number="2530"></td>
        <td id="LC2530">        pMD-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>()-&gt;<span>FreeCompileTimeState</span>();</td>
      </tr>
      <tr>
        <td id="L2531" data-line-number="2531"></td>
        <td id="LC2531">    }</td>
      </tr>
      <tr>
        <td id="L2532" data-line-number="2532"></td>
        <td id="LC2532">
</td>
      </tr>
      <tr>
        <td id="L2533" data-line-number="2533"></td>
        <td id="LC2533">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2534" data-line-number="2534"></td>
        <td id="LC2534">}</td>
      </tr>
      <tr>
        <td id="L2535" data-line-number="2535"></td>
        <td id="LC2535">
</td>
      </tr>
      <tr>
        <td id="L2536" data-line-number="2536"></td>
        <td id="LC2536"><span><span>//</span> Given a module scope (scopeHnd), a method handle (context) and an metadata token,</span></td>
      </tr>
      <tr>
        <td id="L2537" data-line-number="2537"></td>
        <td id="LC2537"><span><span>//</span> attempt to load the handle (type, field or method) associated with the token.</span></td>
      </tr>
      <tr>
        <td id="L2538" data-line-number="2538"></td>
        <td id="LC2538"><span><span>//</span> If this is not possible at compile-time (because the method code is shared and the token contains type parameters)</span></td>
      </tr>
      <tr>
        <td id="L2539" data-line-number="2539"></td>
        <td id="LC2539"><span><span>//</span> then indicate how the handle should be looked up at run-time.</span></td>
      </tr>
      <tr>
        <td id="L2540" data-line-number="2540"></td>
        <td id="LC2540"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2541" data-line-number="2541"></td>
        <td id="LC2541"><span><span>//</span> See corinfo.h for more details</span></td>
      </tr>
      <tr>
        <td id="L2542" data-line-number="2542"></td>
        <td id="LC2542"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2543" data-line-number="2543"></td>
        <td id="LC2543"><span>void</span> <span>CEEInfo::embedGenericHandle</span>(</td>
      </tr>
      <tr>
        <td id="L2544" data-line-number="2544"></td>
        <td id="LC2544">            CORINFO_RESOLVED_TOKEN * pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L2545" data-line-number="2545"></td>
        <td id="LC2545">            BOOL                     <span>fEmbedParent</span>,</td>
      </tr>
      <tr>
        <td id="L2546" data-line-number="2546"></td>
        <td id="LC2546">            CORINFO_GENERICHANDLE_RESULT *pResult)</td>
      </tr>
      <tr>
        <td id="L2547" data-line-number="2547"></td>
        <td id="LC2547">{</td>
      </tr>
      <tr>
        <td id="L2548" data-line-number="2548"></td>
        <td id="LC2548">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L2549" data-line-number="2549"></td>
        <td id="LC2549">        THROWS;</td>
      </tr>
      <tr>
        <td id="L2550" data-line-number="2550"></td>
        <td id="LC2550">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L2551" data-line-number="2551"></td>
        <td id="LC2551">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L2552" data-line-number="2552"></td>
        <td id="LC2552">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L2553" data-line-number="2553"></td>
        <td id="LC2553">
</td>
      </tr>
      <tr>
        <td id="L2554" data-line-number="2554"></td>
        <td id="LC2554">    <span>INDEBUG</span>(<span>memset</span>(pResult, <span>0xCC</span>, <span>sizeof</span>(*pResult)));</td>
      </tr>
      <tr>
        <td id="L2555" data-line-number="2555"></td>
        <td id="LC2555">
</td>
      </tr>
      <tr>
        <td id="L2556" data-line-number="2556"></td>
        <td id="LC2556">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2557" data-line-number="2557"></td>
        <td id="LC2557">
</td>
      </tr>
      <tr>
        <td id="L2558" data-line-number="2558"></td>
        <td id="LC2558">    BOOL <span>fRuntimeLookup</span>;</td>
      </tr>
      <tr>
        <td id="L2559" data-line-number="2559"></td>
        <td id="LC2559">    MethodDesc * pTemplateMD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L2560" data-line-number="2560"></td>
        <td id="LC2560">
</td>
      </tr>
      <tr>
        <td id="L2561" data-line-number="2561"></td>
        <td id="LC2561">    <span>if</span> (!<span>fEmbedParent</span> &amp;&amp; pResolvedToken-&gt;<span>hMethod</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L2562" data-line-number="2562"></td>
        <td id="LC2562">    {</td>
      </tr>
      <tr>
        <td id="L2563" data-line-number="2563"></td>
        <td id="LC2563">        MethodDesc * pMD = (MethodDesc *)pResolvedToken-&gt;<span>hMethod</span>;</td>
      </tr>
      <tr>
        <td id="L2564" data-line-number="2564"></td>
        <td id="LC2564">        TypeHandle <span>th</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L2565" data-line-number="2565"></td>
        <td id="LC2565">
</td>
      </tr>
      <tr>
        <td id="L2566" data-line-number="2566"></td>
        <td id="LC2566">        pResult-&gt;<span>handleType</span> = CORINFO_HANDLETYPE_METHOD;</td>
      </tr>
      <tr>
        <td id="L2567" data-line-number="2567"></td>
        <td id="LC2567">
</td>
      </tr>
      <tr>
        <td id="L2568" data-line-number="2568"></td>
        <td id="LC2568">        Instantiation methodInst = pMD-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L2569" data-line-number="2569"></td>
        <td id="LC2569">
</td>
      </tr>
      <tr>
        <td id="L2570" data-line-number="2570"></td>
        <td id="LC2570">        pMD = <span>MethodDesc::FindOrCreateAssociatedMethodDesc</span>(pMD, th.<span>GetMethodTable</span>(), <span>FALSE</span>, methodInst, <span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L2571" data-line-number="2571"></td>
        <td id="LC2571">
</td>
      </tr>
      <tr>
        <td id="L2572" data-line-number="2572"></td>
        <td id="LC2572">        <span><span>//</span> Normalize the method handle for reflection</span></td>
      </tr>
      <tr>
        <td id="L2573" data-line-number="2573"></td>
        <td id="LC2573">        <span>if</span> (pResolvedToken-&gt;<span>tokenType</span> == CORINFO_TOKENKIND_Ldtoken)</td>
      </tr>
      <tr>
        <td id="L2574" data-line-number="2574"></td>
        <td id="LC2574">            pMD = <span>MethodDesc::FindOrCreateAssociatedMethodDescForReflection</span>(pMD, th, methodInst);</td>
      </tr>
      <tr>
        <td id="L2575" data-line-number="2575"></td>
        <td id="LC2575">
</td>
      </tr>
      <tr>
        <td id="L2576" data-line-number="2576"></td>
        <td id="LC2576">        pResult-&gt;<span>compileTimeHandle</span> = (CORINFO_GENERIC_HANDLE)pMD;</td>
      </tr>
      <tr>
        <td id="L2577" data-line-number="2577"></td>
        <td id="LC2577">        pTemplateMD = pMD;</td>
      </tr>
      <tr>
        <td id="L2578" data-line-number="2578"></td>
        <td id="LC2578">
</td>
      </tr>
      <tr>
        <td id="L2579" data-line-number="2579"></td>
        <td id="LC2579">        <span><span>//</span> Runtime lookup is only required for stubs. Regular entrypoints are always the same shared MethodDescs.</span></td>
      </tr>
      <tr>
        <td id="L2580" data-line-number="2580"></td>
        <td id="LC2580">        <span>fRuntimeLookup</span> = pMD-&gt;<span>IsWrapperStub</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L2581" data-line-number="2581"></td>
        <td id="LC2581">            (pMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsSharedByGenericInstantiations</span>() || <span>TypeHandle::IsCanonicalSubtypeInstantiation</span>(methodInst));</td>
      </tr>
      <tr>
        <td id="L2582" data-line-number="2582"></td>
        <td id="LC2582">    }</td>
      </tr>
      <tr>
        <td id="L2583" data-line-number="2583"></td>
        <td id="LC2583">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2584" data-line-number="2584"></td>
        <td id="LC2584">    <span>if</span> (!<span>fEmbedParent</span> &amp;&amp; pResolvedToken-&gt;<span>hField</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L2585" data-line-number="2585"></td>
        <td id="LC2585">    {</td>
      </tr>
      <tr>
        <td id="L2586" data-line-number="2586"></td>
        <td id="LC2586">        FieldDesc * pFD = (FieldDesc *)pResolvedToken-&gt;<span>hField</span>;</td>
      </tr>
      <tr>
        <td id="L2587" data-line-number="2587"></td>
        <td id="LC2587">        TypeHandle <span>th</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L2588" data-line-number="2588"></td>
        <td id="LC2588">
</td>
      </tr>
      <tr>
        <td id="L2589" data-line-number="2589"></td>
        <td id="LC2589">        pResult-&gt;<span>handleType</span> = CORINFO_HANDLETYPE_FIELD;</td>
      </tr>
      <tr>
        <td id="L2590" data-line-number="2590"></td>
        <td id="LC2590">
</td>
      </tr>
      <tr>
        <td id="L2591" data-line-number="2591"></td>
        <td id="LC2591">        pResult-&gt;<span>compileTimeHandle</span> = (CORINFO_GENERIC_HANDLE)pFD;</td>
      </tr>
      <tr>
        <td id="L2592" data-line-number="2592"></td>
        <td id="LC2592">
</td>
      </tr>
      <tr>
        <td id="L2593" data-line-number="2593"></td>
        <td id="LC2593">        <span>fRuntimeLookup</span> = th.<span>IsSharedByGenericInstantiations</span>() &amp;&amp; pFD-&gt;<span>IsStatic</span>();</td>
      </tr>
      <tr>
        <td id="L2594" data-line-number="2594"></td>
        <td id="LC2594">    }</td>
      </tr>
      <tr>
        <td id="L2595" data-line-number="2595"></td>
        <td id="LC2595">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2596" data-line-number="2596"></td>
        <td id="LC2596">    {</td>
      </tr>
      <tr>
        <td id="L2597" data-line-number="2597"></td>
        <td id="LC2597">        TypeHandle <span>th</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L2598" data-line-number="2598"></td>
        <td id="LC2598">
</td>
      </tr>
      <tr>
        <td id="L2599" data-line-number="2599"></td>
        <td id="LC2599">        pResult-&gt;<span>handleType</span> = CORINFO_HANDLETYPE_CLASS;</td>
      </tr>
      <tr>
        <td id="L2600" data-line-number="2600"></td>
        <td id="LC2600">        pResult-&gt;<span>compileTimeHandle</span> = (CORINFO_GENERIC_HANDLE)th.<span>AsPtr</span>();</td>
      </tr>
      <tr>
        <td id="L2601" data-line-number="2601"></td>
        <td id="LC2601">
</td>
      </tr>
      <tr>
        <td id="L2602" data-line-number="2602"></td>
        <td id="LC2602">        <span>if</span> (<span>fEmbedParent</span> &amp;&amp; pResolvedToken-&gt;<span>hMethod</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L2603" data-line-number="2603"></td>
        <td id="LC2603">        {</td>
      </tr>
      <tr>
        <td id="L2604" data-line-number="2604"></td>
        <td id="LC2604">            MethodDesc * pDeclaringMD = (MethodDesc *)pResolvedToken-&gt;<span>hMethod</span>;</td>
      </tr>
      <tr>
        <td id="L2605" data-line-number="2605"></td>
        <td id="LC2605">
</td>
      </tr>
      <tr>
        <td id="L2606" data-line-number="2606"></td>
        <td id="LC2606">            <span>if</span> (!pDeclaringMD-&gt;<span>GetMethodTable</span>()-&gt;<span>HasSameTypeDefAs</span>(th.<span>GetMethodTable</span>()))</td>
      </tr>
      <tr>
        <td id="L2607" data-line-number="2607"></td>
        <td id="LC2607">            {</td>
      </tr>
      <tr>
        <td id="L2608" data-line-number="2608"></td>
        <td id="LC2608">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2609" data-line-number="2609"></td>
        <td id="LC2609">                <span><span>//</span> The method type may point to a sub-class of the actual class that declares the method.</span></td>
      </tr>
      <tr>
        <td id="L2610" data-line-number="2610"></td>
        <td id="LC2610">                <span><span>//</span> It is important to embed the declaring type in this case.</span></td>
      </tr>
      <tr>
        <td id="L2611" data-line-number="2611"></td>
        <td id="LC2611">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2612" data-line-number="2612"></td>
        <td id="LC2612">
</td>
      </tr>
      <tr>
        <td id="L2613" data-line-number="2613"></td>
        <td id="LC2613">                pTemplateMD = pDeclaringMD;</td>
      </tr>
      <tr>
        <td id="L2614" data-line-number="2614"></td>
        <td id="LC2614">
</td>
      </tr>
      <tr>
        <td id="L2615" data-line-number="2615"></td>
        <td id="LC2615">                pResult-&gt;<span>compileTimeHandle</span> = (CORINFO_GENERIC_HANDLE)pDeclaringMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2616" data-line-number="2616"></td>
        <td id="LC2616">            }</td>
      </tr>
      <tr>
        <td id="L2617" data-line-number="2617"></td>
        <td id="LC2617">        }</td>
      </tr>
      <tr>
        <td id="L2618" data-line-number="2618"></td>
        <td id="LC2618">
</td>
      </tr>
      <tr>
        <td id="L2619" data-line-number="2619"></td>
        <td id="LC2619">        <span><span>//</span> IsSharedByGenericInstantiations would not work here. The runtime lookup is required</span></td>
      </tr>
      <tr>
        <td id="L2620" data-line-number="2620"></td>
        <td id="LC2620">        <span><span>//</span> even for standalone generic variables that show up as __Canon here.</span></td>
      </tr>
      <tr>
        <td id="L2621" data-line-number="2621"></td>
        <td id="LC2621">        <span>fRuntimeLookup</span> = th.<span>IsCanonicalSubtype</span>();</td>
      </tr>
      <tr>
        <td id="L2622" data-line-number="2622"></td>
        <td id="LC2622">    }</td>
      </tr>
      <tr>
        <td id="L2623" data-line-number="2623"></td>
        <td id="LC2623">
</td>
      </tr>
      <tr>
        <td id="L2624" data-line-number="2624"></td>
        <td id="LC2624">    <span>_ASSERTE</span>(pResult-&gt;<span>compileTimeHandle</span>);</td>
      </tr>
      <tr>
        <td id="L2625" data-line-number="2625"></td>
        <td id="LC2625">
</td>
      </tr>
      <tr>
        <td id="L2626" data-line-number="2626"></td>
        <td id="LC2626">    <span>if</span> (<span>fRuntimeLookup</span></td>
      </tr>
      <tr>
        <td id="L2627" data-line-number="2627"></td>
        <td id="LC2627">            <span><span>//</span> Handle invalid IL - see comment in code:CEEInfo::ComputeRuntimeLookupForSharedGenericToken</span></td>
      </tr>
      <tr>
        <td id="L2628" data-line-number="2628"></td>
        <td id="LC2628">            &amp;&amp; <span>ContextIsShared</span>(pResolvedToken-&gt;<span>tokenContext</span>))</td>
      </tr>
      <tr>
        <td id="L2629" data-line-number="2629"></td>
        <td id="LC2629">    {</td>
      </tr>
      <tr>
        <td id="L2630" data-line-number="2630"></td>
        <td id="LC2630">        DictionaryEntryKind entryKind = EmptySlot;</td>
      </tr>
      <tr>
        <td id="L2631" data-line-number="2631"></td>
        <td id="LC2631">        <span>switch</span> (pResult-&gt;<span>handleType</span>)</td>
      </tr>
      <tr>
        <td id="L2632" data-line-number="2632"></td>
        <td id="LC2632">        {</td>
      </tr>
      <tr>
        <td id="L2633" data-line-number="2633"></td>
        <td id="LC2633">        <span>case</span> CORINFO_HANDLETYPE_CLASS:</td>
      </tr>
      <tr>
        <td id="L2634" data-line-number="2634"></td>
        <td id="LC2634">            entryKind = (pTemplateMD != <span>NULL</span>) ? DeclaringTypeHandleSlot : TypeHandleSlot;</td>
      </tr>
      <tr>
        <td id="L2635" data-line-number="2635"></td>
        <td id="LC2635">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2636" data-line-number="2636"></td>
        <td id="LC2636">        <span>case</span> CORINFO_HANDLETYPE_METHOD:</td>
      </tr>
      <tr>
        <td id="L2637" data-line-number="2637"></td>
        <td id="LC2637">            entryKind = MethodDescSlot;</td>
      </tr>
      <tr>
        <td id="L2638" data-line-number="2638"></td>
        <td id="LC2638">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2639" data-line-number="2639"></td>
        <td id="LC2639">        <span>case</span> CORINFO_HANDLETYPE_FIELD:</td>
      </tr>
      <tr>
        <td id="L2640" data-line-number="2640"></td>
        <td id="LC2640">            entryKind = FieldDescSlot;</td>
      </tr>
      <tr>
        <td id="L2641" data-line-number="2641"></td>
        <td id="LC2641">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2642" data-line-number="2642"></td>
        <td id="LC2642">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L2643" data-line-number="2643"></td>
        <td id="LC2643">            <span>_ASSERTE</span>(<span>false</span>);</td>
      </tr>
      <tr>
        <td id="L2644" data-line-number="2644"></td>
        <td id="LC2644">        }</td>
      </tr>
      <tr>
        <td id="L2645" data-line-number="2645"></td>
        <td id="LC2645">
</td>
      </tr>
      <tr>
        <td id="L2646" data-line-number="2646"></td>
        <td id="LC2646">        <span>ComputeRuntimeLookupForSharedGenericToken</span>(entryKind,</td>
      </tr>
      <tr>
        <td id="L2647" data-line-number="2647"></td>
        <td id="LC2647">                                                  pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L2648" data-line-number="2648"></td>
        <td id="LC2648">                                                  <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L2649" data-line-number="2649"></td>
        <td id="LC2649">                                                  pTemplateMD,</td>
      </tr>
      <tr>
        <td id="L2650" data-line-number="2650"></td>
        <td id="LC2650">                                                  &amp;pResult-&gt;<span>lookup</span>);</td>
      </tr>
      <tr>
        <td id="L2651" data-line-number="2651"></td>
        <td id="LC2651">    }</td>
      </tr>
      <tr>
        <td id="L2652" data-line-number="2652"></td>
        <td id="LC2652">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L2653" data-line-number="2653"></td>
        <td id="LC2653">    {</td>
      </tr>
      <tr>
        <td id="L2654" data-line-number="2654"></td>
        <td id="LC2654">        <span><span>//</span> If the target is not shared then we've already got our result and</span></td>
      </tr>
      <tr>
        <td id="L2655" data-line-number="2655"></td>
        <td id="LC2655">        <span><span>//</span> can simply do a static look up</span></td>
      </tr>
      <tr>
        <td id="L2656" data-line-number="2656"></td>
        <td id="LC2656">        pResult-&gt;<span>lookup</span>.<span>lookupKind</span>.<span>needsRuntimeLookup</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L2657" data-line-number="2657"></td>
        <td id="LC2657">
</td>
      </tr>
      <tr>
        <td id="L2658" data-line-number="2658"></td>
        <td id="LC2658">        pResult-&gt;<span>lookup</span>.<span>constLookup</span>.<span>handle</span> = pResult-&gt;<span>compileTimeHandle</span>;</td>
      </tr>
      <tr>
        <td id="L2659" data-line-number="2659"></td>
        <td id="LC2659">        pResult-&gt;<span>lookup</span>.<span>constLookup</span>.<span>accessType</span> = IAT_VALUE;</td>
      </tr>
      <tr>
        <td id="L2660" data-line-number="2660"></td>
        <td id="LC2660">    }</td>
      </tr>
      <tr>
        <td id="L2661" data-line-number="2661"></td>
        <td id="LC2661">
</td>
      </tr>
      <tr>
        <td id="L2662" data-line-number="2662"></td>
        <td id="LC2662">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L2663" data-line-number="2663"></td>
        <td id="LC2663">}</td>
      </tr>
      <tr>
        <td id="L2664" data-line-number="2664"></td>
        <td id="LC2664">
</td>
      </tr>
      <tr>
        <td id="L2665" data-line-number="2665"></td>
        <td id="LC2665"><span>void</span> <span>CEEInfo::ScanForModuleDependencies</span>(Module* pModule, SigPointer psig)</td>
      </tr>
      <tr>
        <td id="L2666" data-line-number="2666"></td>
        <td id="LC2666">{</td>
      </tr>
      <tr>
        <td id="L2667" data-line-number="2667"></td>
        <td id="LC2667">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2668" data-line-number="2668"></td>
        <td id="LC2668">
</td>
      </tr>
      <tr>
        <td id="L2669" data-line-number="2669"></td>
        <td id="LC2669">    <span>_ASSERTE</span>(pModule &amp;&amp; !pModule-&gt;<span>IsSystem</span>());</td>
      </tr>
      <tr>
        <td id="L2670" data-line-number="2670"></td>
        <td id="LC2670">
</td>
      </tr>
      <tr>
        <td id="L2671" data-line-number="2671"></td>
        <td id="LC2671">    CorElementType eType;</td>
      </tr>
      <tr>
        <td id="L2672" data-line-number="2672"></td>
        <td id="LC2672">    <span>IfFailThrow</span>(psig.<span>GetElemType</span>(&amp;eType));</td>
      </tr>
      <tr>
        <td id="L2673" data-line-number="2673"></td>
        <td id="LC2673">
</td>
      </tr>
      <tr>
        <td id="L2674" data-line-number="2674"></td>
        <td id="LC2674">    <span>switch</span> (eType)</td>
      </tr>
      <tr>
        <td id="L2675" data-line-number="2675"></td>
        <td id="LC2675">    {</td>
      </tr>
      <tr>
        <td id="L2676" data-line-number="2676"></td>
        <td id="LC2676">        <span>case</span> ELEMENT_TYPE_GENERICINST:</td>
      </tr>
      <tr>
        <td id="L2677" data-line-number="2677"></td>
        <td id="LC2677">        {</td>
      </tr>
      <tr>
        <td id="L2678" data-line-number="2678"></td>
        <td id="LC2678">            <span>ScanForModuleDependencies</span>(pModule,psig);</td>
      </tr>
      <tr>
        <td id="L2679" data-line-number="2679"></td>
        <td id="LC2679">            <span>IfFailThrow</span>(psig.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L2680" data-line-number="2680"></td>
        <td id="LC2680">
</td>
      </tr>
      <tr>
        <td id="L2681" data-line-number="2681"></td>
        <td id="LC2681">            ULONG ntypars;</td>
      </tr>
      <tr>
        <td id="L2682" data-line-number="2682"></td>
        <td id="LC2682">            <span>IfFailThrow</span>(psig.<span>GetData</span>(&amp;ntypars));</td>
      </tr>
      <tr>
        <td id="L2683" data-line-number="2683"></td>
        <td id="LC2683">            <span>for</span> (ULONG i = <span>0</span>; i &lt; ntypars; i++)</td>
      </tr>
      <tr>
        <td id="L2684" data-line-number="2684"></td>
        <td id="LC2684">            {</td>
      </tr>
      <tr>
        <td id="L2685" data-line-number="2685"></td>
        <td id="LC2685">              <span>ScanForModuleDependencies</span>(pModule,psig);</td>
      </tr>
      <tr>
        <td id="L2686" data-line-number="2686"></td>
        <td id="LC2686">              <span>IfFailThrow</span>(psig.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L2687" data-line-number="2687"></td>
        <td id="LC2687">            }</td>
      </tr>
      <tr>
        <td id="L2688" data-line-number="2688"></td>
        <td id="LC2688">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2689" data-line-number="2689"></td>
        <td id="LC2689">        }</td>
      </tr>
      <tr>
        <td id="L2690" data-line-number="2690"></td>
        <td id="LC2690">
</td>
      </tr>
      <tr>
        <td id="L2691" data-line-number="2691"></td>
        <td id="LC2691">        <span>case</span> ELEMENT_TYPE_VALUETYPE:</td>
      </tr>
      <tr>
        <td id="L2692" data-line-number="2692"></td>
        <td id="LC2692">        <span>case</span> ELEMENT_TYPE_CLASS:</td>
      </tr>
      <tr>
        <td id="L2693" data-line-number="2693"></td>
        <td id="LC2693">        {</td>
      </tr>
      <tr>
        <td id="L2694" data-line-number="2694"></td>
        <td id="LC2694">            mdToken tk;</td>
      </tr>
      <tr>
        <td id="L2695" data-line-number="2695"></td>
        <td id="LC2695">            <span>IfFailThrow</span>(psig.<span>GetToken</span>(&amp;tk));</td>
      </tr>
      <tr>
        <td id="L2696" data-line-number="2696"></td>
        <td id="LC2696">            <span>if</span> (<span>TypeFromToken</span>(tk) ==  mdtTypeRef)</td>
      </tr>
      <tr>
        <td id="L2697" data-line-number="2697"></td>
        <td id="LC2697">            {</td>
      </tr>
      <tr>
        <td id="L2698" data-line-number="2698"></td>
        <td id="LC2698">                Module * pTypeDefModule;</td>
      </tr>
      <tr>
        <td id="L2699" data-line-number="2699"></td>
        <td id="LC2699">                mdToken tkTypeDef;</td>
      </tr>
      <tr>
        <td id="L2700" data-line-number="2700"></td>
        <td id="LC2700">
</td>
      </tr>
      <tr>
        <td id="L2701" data-line-number="2701"></td>
        <td id="LC2701">                <span>if</span>  (<span>ClassLoader::ResolveTokenToTypeDefThrowing</span>(pModule, tk, &amp;pTypeDefModule, &amp;tkTypeDef))</td>
      </tr>
      <tr>
        <td id="L2702" data-line-number="2702"></td>
        <td id="LC2702">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2703" data-line-number="2703"></td>
        <td id="LC2703">
</td>
      </tr>
      <tr>
        <td id="L2704" data-line-number="2704"></td>
        <td id="LC2704">                <span>if</span> (!pTypeDefModule-&gt;<span>IsSystem</span>() &amp;&amp; (pModule != pTypeDefModule))</td>
      </tr>
      <tr>
        <td id="L2705" data-line-number="2705"></td>
        <td id="LC2705">                {</td>
      </tr>
      <tr>
        <td id="L2706" data-line-number="2706"></td>
        <td id="LC2706">                    m_pOverride-&gt;<span>addActiveDependency</span>((CORINFO_MODULE_HANDLE)pModule, (CORINFO_MODULE_HANDLE)pTypeDefModule);</td>
      </tr>
      <tr>
        <td id="L2707" data-line-number="2707"></td>
        <td id="LC2707">                }</td>
      </tr>
      <tr>
        <td id="L2708" data-line-number="2708"></td>
        <td id="LC2708">            }</td>
      </tr>
      <tr>
        <td id="L2709" data-line-number="2709"></td>
        <td id="LC2709">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2710" data-line-number="2710"></td>
        <td id="LC2710">        }</td>
      </tr>
      <tr>
        <td id="L2711" data-line-number="2711"></td>
        <td id="LC2711">
</td>
      </tr>
      <tr>
        <td id="L2712" data-line-number="2712"></td>
        <td id="LC2712">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L2713" data-line-number="2713"></td>
        <td id="LC2713">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2714" data-line-number="2714"></td>
        <td id="LC2714">    }</td>
      </tr>
      <tr>
        <td id="L2715" data-line-number="2715"></td>
        <td id="LC2715">}</td>
      </tr>
      <tr>
        <td id="L2716" data-line-number="2716"></td>
        <td id="LC2716">
</td>
      </tr>
      <tr>
        <td id="L2717" data-line-number="2717"></td>
        <td id="LC2717"><span>void</span> <span>CEEInfo::ScanMethodSpec</span>(Module * pModule, PCCOR_SIGNATURE pMethodSpec, ULONG cbMethodSpec)</td>
      </tr>
      <tr>
        <td id="L2718" data-line-number="2718"></td>
        <td id="LC2718">{</td>
      </tr>
      <tr>
        <td id="L2719" data-line-number="2719"></td>
        <td id="LC2719">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2720" data-line-number="2720"></td>
        <td id="LC2720">
</td>
      </tr>
      <tr>
        <td id="L2721" data-line-number="2721"></td>
        <td id="LC2721">    SigPointer <span>sp</span>(pMethodSpec, cbMethodSpec);</td>
      </tr>
      <tr>
        <td id="L2722" data-line-number="2722"></td>
        <td id="LC2722">
</td>
      </tr>
      <tr>
        <td id="L2723" data-line-number="2723"></td>
        <td id="LC2723">    BYTE etype;</td>
      </tr>
      <tr>
        <td id="L2724" data-line-number="2724"></td>
        <td id="LC2724">    <span>IfFailThrow</span>(sp.<span>GetByte</span>(&amp;etype));</td>
      </tr>
      <tr>
        <td id="L2725" data-line-number="2725"></td>
        <td id="LC2725">
</td>
      </tr>
      <tr>
        <td id="L2726" data-line-number="2726"></td>
        <td id="LC2726">    <span>_ASSERT</span>(etype == (BYTE)IMAGE_CEE_CS_CALLCONV_GENERICINST);</td>
      </tr>
      <tr>
        <td id="L2727" data-line-number="2727"></td>
        <td id="LC2727">
</td>
      </tr>
      <tr>
        <td id="L2728" data-line-number="2728"></td>
        <td id="LC2728">    ULONG nGenericMethodArgs;</td>
      </tr>
      <tr>
        <td id="L2729" data-line-number="2729"></td>
        <td id="LC2729">    <span>IfFailThrow</span>(sp.<span>GetData</span>(&amp;nGenericMethodArgs));</td>
      </tr>
      <tr>
        <td id="L2730" data-line-number="2730"></td>
        <td id="LC2730">
</td>
      </tr>
      <tr>
        <td id="L2731" data-line-number="2731"></td>
        <td id="LC2731">    <span>for</span> (ULONG i = <span>0</span>; i &lt; nGenericMethodArgs; i++)</td>
      </tr>
      <tr>
        <td id="L2732" data-line-number="2732"></td>
        <td id="LC2732">    {</td>
      </tr>
      <tr>
        <td id="L2733" data-line-number="2733"></td>
        <td id="LC2733">        <span>ScanForModuleDependencies</span>(pModule,sp);</td>
      </tr>
      <tr>
        <td id="L2734" data-line-number="2734"></td>
        <td id="LC2734">        <span>IfFailThrow</span>(sp.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L2735" data-line-number="2735"></td>
        <td id="LC2735">    }</td>
      </tr>
      <tr>
        <td id="L2736" data-line-number="2736"></td>
        <td id="LC2736">}</td>
      </tr>
      <tr>
        <td id="L2737" data-line-number="2737"></td>
        <td id="LC2737">
</td>
      </tr>
      <tr>
        <td id="L2738" data-line-number="2738"></td>
        <td id="LC2738">BOOL <span>CEEInfo::ScanTypeSpec</span>(Module * pModule, PCCOR_SIGNATURE pTypeSpec, ULONG cbTypeSpec)</td>
      </tr>
      <tr>
        <td id="L2739" data-line-number="2739"></td>
        <td id="LC2739">{</td>
      </tr>
      <tr>
        <td id="L2740" data-line-number="2740"></td>
        <td id="LC2740">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2741" data-line-number="2741"></td>
        <td id="LC2741">
</td>
      </tr>
      <tr>
        <td id="L2742" data-line-number="2742"></td>
        <td id="LC2742">    SigPointer <span>sp</span>(pTypeSpec, cbTypeSpec);</td>
      </tr>
      <tr>
        <td id="L2743" data-line-number="2743"></td>
        <td id="LC2743">
</td>
      </tr>
      <tr>
        <td id="L2744" data-line-number="2744"></td>
        <td id="LC2744">    CorElementType eType;</td>
      </tr>
      <tr>
        <td id="L2745" data-line-number="2745"></td>
        <td id="LC2745">    <span>IfFailThrow</span>(sp.<span>GetElemType</span>(&amp;eType));</td>
      </tr>
      <tr>
        <td id="L2746" data-line-number="2746"></td>
        <td id="LC2746">
</td>
      </tr>
      <tr>
        <td id="L2747" data-line-number="2747"></td>
        <td id="LC2747">    <span><span>//</span> Filter out non-instantiated types and typedescs (typevars, arrays, ...)</span></td>
      </tr>
      <tr>
        <td id="L2748" data-line-number="2748"></td>
        <td id="LC2748">    <span>if</span> (eType != ELEMENT_TYPE_GENERICINST)</td>
      </tr>
      <tr>
        <td id="L2749" data-line-number="2749"></td>
        <td id="LC2749">    {</td>
      </tr>
      <tr>
        <td id="L2750" data-line-number="2750"></td>
        <td id="LC2750">        <span><span>//</span> Scanning of the parent chain is required for reference types only.</span></td>
      </tr>
      <tr>
        <td id="L2751" data-line-number="2751"></td>
        <td id="LC2751">        <span><span>//</span> Note that the parent chain MUST NOT be scanned for instantiated</span></td>
      </tr>
      <tr>
        <td id="L2752" data-line-number="2752"></td>
        <td id="LC2752">        <span><span>//</span> generic variables because of they are not a real dependencies.</span></td>
      </tr>
      <tr>
        <td id="L2753" data-line-number="2753"></td>
        <td id="LC2753">        <span>return</span> (eType == ELEMENT_TYPE_CLASS);</td>
      </tr>
      <tr>
        <td id="L2754" data-line-number="2754"></td>
        <td id="LC2754">    }</td>
      </tr>
      <tr>
        <td id="L2755" data-line-number="2755"></td>
        <td id="LC2755">
</td>
      </tr>
      <tr>
        <td id="L2756" data-line-number="2756"></td>
        <td id="LC2756">    <span>IfFailThrow</span>(sp.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L2757" data-line-number="2757"></td>
        <td id="LC2757">
</td>
      </tr>
      <tr>
        <td id="L2758" data-line-number="2758"></td>
        <td id="LC2758">    ULONG ntypars;</td>
      </tr>
      <tr>
        <td id="L2759" data-line-number="2759"></td>
        <td id="LC2759">    <span>IfFailThrow</span>(sp.<span>GetData</span>(&amp;ntypars));</td>
      </tr>
      <tr>
        <td id="L2760" data-line-number="2760"></td>
        <td id="LC2760">
</td>
      </tr>
      <tr>
        <td id="L2761" data-line-number="2761"></td>
        <td id="LC2761">    <span>for</span> (ULONG i = <span>0</span>; i &lt; ntypars; i++)</td>
      </tr>
      <tr>
        <td id="L2762" data-line-number="2762"></td>
        <td id="LC2762">    {</td>
      </tr>
      <tr>
        <td id="L2763" data-line-number="2763"></td>
        <td id="LC2763">        <span>ScanForModuleDependencies</span>(pModule,sp);</td>
      </tr>
      <tr>
        <td id="L2764" data-line-number="2764"></td>
        <td id="LC2764">        <span>IfFailThrow</span>(sp.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L2765" data-line-number="2765"></td>
        <td id="LC2765">    }</td>
      </tr>
      <tr>
        <td id="L2766" data-line-number="2766"></td>
        <td id="LC2766">
</td>
      </tr>
      <tr>
        <td id="L2767" data-line-number="2767"></td>
        <td id="LC2767">    <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L2768" data-line-number="2768"></td>
        <td id="LC2768">}</td>
      </tr>
      <tr>
        <td id="L2769" data-line-number="2769"></td>
        <td id="LC2769">
</td>
      </tr>
      <tr>
        <td id="L2770" data-line-number="2770"></td>
        <td id="LC2770"><span>void</span> <span>CEEInfo::ScanInstantiation</span>(Module * pModule, Instantiation inst)</td>
      </tr>
      <tr>
        <td id="L2771" data-line-number="2771"></td>
        <td id="LC2771">{</td>
      </tr>
      <tr>
        <td id="L2772" data-line-number="2772"></td>
        <td id="LC2772">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2773" data-line-number="2773"></td>
        <td id="LC2773">
</td>
      </tr>
      <tr>
        <td id="L2774" data-line-number="2774"></td>
        <td id="LC2774">    <span>for</span> (DWORD i = <span>0</span>; i &lt; inst.<span>GetNumArgs</span>(); i++)</td>
      </tr>
      <tr>
        <td id="L2775" data-line-number="2775"></td>
        <td id="LC2775">    {</td>
      </tr>
      <tr>
        <td id="L2776" data-line-number="2776"></td>
        <td id="LC2776">        TypeHandle th = inst[i];</td>
      </tr>
      <tr>
        <td id="L2777" data-line-number="2777"></td>
        <td id="LC2777">        <span>if</span> (th.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L2778" data-line-number="2778"></td>
        <td id="LC2778">            <span>continue</span>;</td>
      </tr>
      <tr>
        <td id="L2779" data-line-number="2779"></td>
        <td id="LC2779">
</td>
      </tr>
      <tr>
        <td id="L2780" data-line-number="2780"></td>
        <td id="LC2780">        MethodTable * pMT = th.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2781" data-line-number="2781"></td>
        <td id="LC2781">
</td>
      </tr>
      <tr>
        <td id="L2782" data-line-number="2782"></td>
        <td id="LC2782">        Module * pDefModule = pMT-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L2783" data-line-number="2783"></td>
        <td id="LC2783">
</td>
      </tr>
      <tr>
        <td id="L2784" data-line-number="2784"></td>
        <td id="LC2784">        <span>if</span> (!pDefModule-&gt;<span>IsSystem</span>() &amp;&amp; (pModule != pDefModule))</td>
      </tr>
      <tr>
        <td id="L2785" data-line-number="2785"></td>
        <td id="LC2785">        {</td>
      </tr>
      <tr>
        <td id="L2786" data-line-number="2786"></td>
        <td id="LC2786">            m_pOverride-&gt;<span>addActiveDependency</span>((CORINFO_MODULE_HANDLE)pModule, (CORINFO_MODULE_HANDLE)pDefModule);</td>
      </tr>
      <tr>
        <td id="L2787" data-line-number="2787"></td>
        <td id="LC2787">        }</td>
      </tr>
      <tr>
        <td id="L2788" data-line-number="2788"></td>
        <td id="LC2788">
</td>
      </tr>
      <tr>
        <td id="L2789" data-line-number="2789"></td>
        <td id="LC2789">        <span>if</span> (pMT-&gt;<span>HasInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L2790" data-line-number="2790"></td>
        <td id="LC2790">        {</td>
      </tr>
      <tr>
        <td id="L2791" data-line-number="2791"></td>
        <td id="LC2791">            <span>ScanInstantiation</span>(pModule, pMT-&gt;<span>GetInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L2792" data-line-number="2792"></td>
        <td id="LC2792">        }</td>
      </tr>
      <tr>
        <td id="L2793" data-line-number="2793"></td>
        <td id="LC2793">    }</td>
      </tr>
      <tr>
        <td id="L2794" data-line-number="2794"></td>
        <td id="LC2794">}</td>
      </tr>
      <tr>
        <td id="L2795" data-line-number="2795"></td>
        <td id="LC2795">
</td>
      </tr>
      <tr>
        <td id="L2796" data-line-number="2796"></td>
        <td id="LC2796"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2797" data-line-number="2797"></td>
        <td id="LC2797"><span><span>//</span> ScanToken is used to track triggers for creation of per-AppDomain state instead, including allocations required for statics and</span></td>
      </tr>
      <tr>
        <td id="L2798" data-line-number="2798"></td>
        <td id="LC2798"><span><span>//</span> triggering of module cctors.</span></td>
      </tr>
      <tr>
        <td id="L2799" data-line-number="2799"></td>
        <td id="LC2799"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2800" data-line-number="2800"></td>
        <td id="LC2800"><span><span>//</span> The basic rule is: There should be no possibility of a shared module that is "active" to have a direct call into a  module that</span></td>
      </tr>
      <tr>
        <td id="L2801" data-line-number="2801"></td>
        <td id="LC2801"><span><span>//</span> is not "active". And we don't want to intercept every call during runtime, so during compile time we track static calls and</span></td>
      </tr>
      <tr>
        <td id="L2802" data-line-number="2802"></td>
        <td id="LC2802"><span><span>//</span> everything that can result in new virtual calls.</span></td>
      </tr>
      <tr>
        <td id="L2803" data-line-number="2803"></td>
        <td id="LC2803"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2804" data-line-number="2804"></td>
        <td id="LC2804"><span><span>//</span> The current algorithm (scan the parent type chain and instantiation variables) is more than enough to maintain this invariant.</span></td>
      </tr>
      <tr>
        <td id="L2805" data-line-number="2805"></td>
        <td id="LC2805"><span><span>//</span> One could come up with a more efficient algorithm that still maintains the invariant, but it may introduce backward compatibility</span></td>
      </tr>
      <tr>
        <td id="L2806" data-line-number="2806"></td>
        <td id="LC2806"><span><span>//</span> issues.</span></td>
      </tr>
      <tr>
        <td id="L2807" data-line-number="2807"></td>
        <td id="LC2807"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2808" data-line-number="2808"></td>
        <td id="LC2808"><span><span>//</span> For efficiency, the implementation leverages the loaded types as much as possible. Unfortunately, we still have to go back to</span></td>
      </tr>
      <tr>
        <td id="L2809" data-line-number="2809"></td>
        <td id="LC2809"><span><span>//</span> metadata when the generic variables could have been substituted via generic context.</span></td>
      </tr>
      <tr>
        <td id="L2810" data-line-number="2810"></td>
        <td id="LC2810"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2811" data-line-number="2811"></td>
        <td id="LC2811"><span>void</span> <span>CEEInfo::ScanToken</span>(Module * pModule, CORINFO_RESOLVED_TOKEN * pResolvedToken, TypeHandle th, MethodDesc * pMD)</td>
      </tr>
      <tr>
        <td id="L2812" data-line-number="2812"></td>
        <td id="LC2812">{</td>
      </tr>
      <tr>
        <td id="L2813" data-line-number="2813"></td>
        <td id="LC2813">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2814" data-line-number="2814"></td>
        <td id="LC2814">
</td>
      </tr>
      <tr>
        <td id="L2815" data-line-number="2815"></td>
        <td id="LC2815">    <span>if</span> (pModule-&gt;<span>IsSystem</span>())</td>
      </tr>
      <tr>
        <td id="L2816" data-line-number="2816"></td>
        <td id="LC2816">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L2817" data-line-number="2817"></td>
        <td id="LC2817">
</td>
      </tr>
      <tr>
        <td id="L2818" data-line-number="2818"></td>
        <td id="LC2818">    <span>if</span> (<span>isVerifyOnly</span>())</td>
      </tr>
      <tr>
        <td id="L2819" data-line-number="2819"></td>
        <td id="LC2819">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L2820" data-line-number="2820"></td>
        <td id="LC2820">
</td>
      </tr>
      <tr>
        <td id="L2821" data-line-number="2821"></td>
        <td id="LC2821">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2822" data-line-number="2822"></td>
        <td id="LC2822">    <span><span>//</span> Scan method instantiation</span></td>
      </tr>
      <tr>
        <td id="L2823" data-line-number="2823"></td>
        <td id="LC2823">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2824" data-line-number="2824"></td>
        <td id="LC2824">    <span>if</span> (pMD != <span>NULL</span> &amp;&amp; pResolvedToken-&gt;<span>pMethodSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L2825" data-line-number="2825"></td>
        <td id="LC2825">    {</td>
      </tr>
      <tr>
        <td id="L2826" data-line-number="2826"></td>
        <td id="LC2826">        <span>if</span> (<span>ContextIsInstantiated</span>(pResolvedToken-&gt;<span>tokenContext</span>))</td>
      </tr>
      <tr>
        <td id="L2827" data-line-number="2827"></td>
        <td id="LC2827">        {</td>
      </tr>
      <tr>
        <td id="L2828" data-line-number="2828"></td>
        <td id="LC2828">            <span>ScanMethodSpec</span>(pModule, pResolvedToken-&gt;<span>pMethodSpec</span>, pResolvedToken-&gt;<span>cbMethodSpec</span>);</td>
      </tr>
      <tr>
        <td id="L2829" data-line-number="2829"></td>
        <td id="LC2829">        }</td>
      </tr>
      <tr>
        <td id="L2830" data-line-number="2830"></td>
        <td id="LC2830">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L2831" data-line-number="2831"></td>
        <td id="LC2831">        {</td>
      </tr>
      <tr>
        <td id="L2832" data-line-number="2832"></td>
        <td id="LC2832">            <span>ScanInstantiation</span>(pModule, pMD-&gt;<span>GetMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L2833" data-line-number="2833"></td>
        <td id="LC2833">        }</td>
      </tr>
      <tr>
        <td id="L2834" data-line-number="2834"></td>
        <td id="LC2834">    }</td>
      </tr>
      <tr>
        <td id="L2835" data-line-number="2835"></td>
        <td id="LC2835">
</td>
      </tr>
      <tr>
        <td id="L2836" data-line-number="2836"></td>
        <td id="LC2836">    <span>if</span> (th.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L2837" data-line-number="2837"></td>
        <td id="LC2837">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L2838" data-line-number="2838"></td>
        <td id="LC2838">
</td>
      </tr>
      <tr>
        <td id="L2839" data-line-number="2839"></td>
        <td id="LC2839">    MethodTable * pMT = th.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2840" data-line-number="2840"></td>
        <td id="LC2840">
</td>
      </tr>
      <tr>
        <td id="L2841" data-line-number="2841"></td>
        <td id="LC2841">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2842" data-line-number="2842"></td>
        <td id="LC2842">    <span><span>//</span> Scan type instantiation</span></td>
      </tr>
      <tr>
        <td id="L2843" data-line-number="2843"></td>
        <td id="LC2843">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2844" data-line-number="2844"></td>
        <td id="LC2844">    <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L2845" data-line-number="2845"></td>
        <td id="LC2845">    {</td>
      </tr>
      <tr>
        <td id="L2846" data-line-number="2846"></td>
        <td id="LC2846">        <span>if</span> (<span>ContextIsInstantiated</span>(pResolvedToken-&gt;<span>tokenContext</span>))</td>
      </tr>
      <tr>
        <td id="L2847" data-line-number="2847"></td>
        <td id="LC2847">        {</td>
      </tr>
      <tr>
        <td id="L2848" data-line-number="2848"></td>
        <td id="LC2848">            <span>if</span> (!<span>ScanTypeSpec</span>(pModule, pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>))</td>
      </tr>
      <tr>
        <td id="L2849" data-line-number="2849"></td>
        <td id="LC2849">                <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L2850" data-line-number="2850"></td>
        <td id="LC2850">        }</td>
      </tr>
      <tr>
        <td id="L2851" data-line-number="2851"></td>
        <td id="LC2851">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L2852" data-line-number="2852"></td>
        <td id="LC2852">        {</td>
      </tr>
      <tr>
        <td id="L2853" data-line-number="2853"></td>
        <td id="LC2853">            <span>ScanInstantiation</span>(pModule, pMT-&gt;<span>GetInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L2854" data-line-number="2854"></td>
        <td id="LC2854">        }</td>
      </tr>
      <tr>
        <td id="L2855" data-line-number="2855"></td>
        <td id="LC2855">    }</td>
      </tr>
      <tr>
        <td id="L2856" data-line-number="2856"></td>
        <td id="LC2856">
</td>
      </tr>
      <tr>
        <td id="L2857" data-line-number="2857"></td>
        <td id="LC2857">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2858" data-line-number="2858"></td>
        <td id="LC2858">    <span><span>//</span> Scan chain of parent types</span></td>
      </tr>
      <tr>
        <td id="L2859" data-line-number="2859"></td>
        <td id="LC2859">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L2860" data-line-number="2860"></td>
        <td id="LC2860">    <span>for</span> (;;)</td>
      </tr>
      <tr>
        <td id="L2861" data-line-number="2861"></td>
        <td id="LC2861">    {</td>
      </tr>
      <tr>
        <td id="L2862" data-line-number="2862"></td>
        <td id="LC2862">        Module * pDefModule = pMT-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L2863" data-line-number="2863"></td>
        <td id="LC2863">        <span>if</span> (pDefModule-&gt;<span>IsSystem</span>())</td>
      </tr>
      <tr>
        <td id="L2864" data-line-number="2864"></td>
        <td id="LC2864">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2865" data-line-number="2865"></td>
        <td id="LC2865">
</td>
      </tr>
      <tr>
        <td id="L2866" data-line-number="2866"></td>
        <td id="LC2866">        <span>if</span> (pModule != pDefModule)</td>
      </tr>
      <tr>
        <td id="L2867" data-line-number="2867"></td>
        <td id="LC2867">        {</td>
      </tr>
      <tr>
        <td id="L2868" data-line-number="2868"></td>
        <td id="LC2868">            m_pOverride-&gt;<span>addActiveDependency</span>((CORINFO_MODULE_HANDLE)pModule, (CORINFO_MODULE_HANDLE)pDefModule);</td>
      </tr>
      <tr>
        <td id="L2869" data-line-number="2869"></td>
        <td id="LC2869">        }</td>
      </tr>
      <tr>
        <td id="L2870" data-line-number="2870"></td>
        <td id="LC2870">
</td>
      </tr>
      <tr>
        <td id="L2871" data-line-number="2871"></td>
        <td id="LC2871">        MethodTable * pParentMT = pMT-&gt;<span>GetParentMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L2872" data-line-number="2872"></td>
        <td id="LC2872">        <span>if</span> (pParentMT == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L2873" data-line-number="2873"></td>
        <td id="LC2873">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L2874" data-line-number="2874"></td>
        <td id="LC2874">
</td>
      </tr>
      <tr>
        <td id="L2875" data-line-number="2875"></td>
        <td id="LC2875">        <span>if</span> (pParentMT-&gt;<span>HasInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L2876" data-line-number="2876"></td>
        <td id="LC2876">        {</td>
      </tr>
      <tr>
        <td id="L2877" data-line-number="2877"></td>
        <td id="LC2877">            IMDInternalImport* pInternalImport = pDefModule-&gt;<span>GetMDImport</span>();</td>
      </tr>
      <tr>
        <td id="L2878" data-line-number="2878"></td>
        <td id="LC2878">
</td>
      </tr>
      <tr>
        <td id="L2879" data-line-number="2879"></td>
        <td id="LC2879">            mdToken tkParent;</td>
      </tr>
      <tr>
        <td id="L2880" data-line-number="2880"></td>
        <td id="LC2880">            <span>IfFailThrow</span>(pInternalImport-&gt;<span>GetTypeDefProps</span>(pMT-&gt;<span>GetCl</span>(), <span>NULL</span>, &amp;tkParent));</td>
      </tr>
      <tr>
        <td id="L2881" data-line-number="2881"></td>
        <td id="LC2881">
</td>
      </tr>
      <tr>
        <td id="L2882" data-line-number="2882"></td>
        <td id="LC2882">            <span>if</span> (<span>TypeFromToken</span>(tkParent) == mdtTypeSpec)</td>
      </tr>
      <tr>
        <td id="L2883" data-line-number="2883"></td>
        <td id="LC2883">            {</td>
      </tr>
      <tr>
        <td id="L2884" data-line-number="2884"></td>
        <td id="LC2884">                PCCOR_SIGNATURE pTypeSpec;</td>
      </tr>
      <tr>
        <td id="L2885" data-line-number="2885"></td>
        <td id="LC2885">                ULONG           cbTypeSpec;</td>
      </tr>
      <tr>
        <td id="L2886" data-line-number="2886"></td>
        <td id="LC2886">                <span>IfFailThrow</span>(pInternalImport-&gt;<span>GetTypeSpecFromToken</span>(tkParent, &amp;pTypeSpec, &amp;cbTypeSpec));</td>
      </tr>
      <tr>
        <td id="L2887" data-line-number="2887"></td>
        <td id="LC2887">
</td>
      </tr>
      <tr>
        <td id="L2888" data-line-number="2888"></td>
        <td id="LC2888">                <span>ScanTypeSpec</span>(pDefModule, pTypeSpec, cbTypeSpec);</td>
      </tr>
      <tr>
        <td id="L2889" data-line-number="2889"></td>
        <td id="LC2889">            }</td>
      </tr>
      <tr>
        <td id="L2890" data-line-number="2890"></td>
        <td id="LC2890">        }</td>
      </tr>
      <tr>
        <td id="L2891" data-line-number="2891"></td>
        <td id="LC2891">
</td>
      </tr>
      <tr>
        <td id="L2892" data-line-number="2892"></td>
        <td id="LC2892">        pMT = pParentMT;</td>
      </tr>
      <tr>
        <td id="L2893" data-line-number="2893"></td>
        <td id="LC2893">    }</td>
      </tr>
      <tr>
        <td id="L2894" data-line-number="2894"></td>
        <td id="LC2894">}</td>
      </tr>
      <tr>
        <td id="L2895" data-line-number="2895"></td>
        <td id="LC2895">
</td>
      </tr>
      <tr>
        <td id="L2896" data-line-number="2896"></td>
        <td id="LC2896"><span>void</span> <span>CEEInfo::ScanTokenForDynamicScope</span>(CORINFO_RESOLVED_TOKEN * pResolvedToken, TypeHandle th, MethodDesc * pMD)</td>
      </tr>
      <tr>
        <td id="L2897" data-line-number="2897"></td>
        <td id="LC2897">{</td>
      </tr>
      <tr>
        <td id="L2898" data-line-number="2898"></td>
        <td id="LC2898">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2899" data-line-number="2899"></td>
        <td id="LC2899">
</td>
      </tr>
      <tr>
        <td id="L2900" data-line-number="2900"></td>
        <td id="LC2900">    <span>if</span> (m_pMethodBeingCompiled-&gt;<span>IsLCGMethod</span>())</td>
      </tr>
      <tr>
        <td id="L2901" data-line-number="2901"></td>
        <td id="LC2901">    {</td>
      </tr>
      <tr>
        <td id="L2902" data-line-number="2902"></td>
        <td id="LC2902">        <span><span>//</span> The dependency tracking for LCG is irrelevant. Perform immediate activation.</span></td>
      </tr>
      <tr>
        <td id="L2903" data-line-number="2903"></td>
        <td id="LC2903">        <span>if</span> (pMD != <span>NULL</span> &amp;&amp; pMD-&gt;<span>HasMethodInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L2904" data-line-number="2904"></td>
        <td id="LC2904">            pMD-&gt;<span>EnsureActive</span>();</td>
      </tr>
      <tr>
        <td id="L2905" data-line-number="2905"></td>
        <td id="LC2905">        <span>if</span> (!th.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L2906" data-line-number="2906"></td>
        <td id="LC2906">            th.<span>AsMethodTable</span>()-&gt;<span>EnsureInstanceActive</span>();</td>
      </tr>
      <tr>
        <td id="L2907" data-line-number="2907"></td>
        <td id="LC2907">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L2908" data-line-number="2908"></td>
        <td id="LC2908">    }</td>
      </tr>
      <tr>
        <td id="L2909" data-line-number="2909"></td>
        <td id="LC2909">
</td>
      </tr>
      <tr>
        <td id="L2910" data-line-number="2910"></td>
        <td id="LC2910">    <span><span>//</span> Stubs-as-IL have to do regular dependency tracking because they can be shared cross-domain.</span></td>
      </tr>
      <tr>
        <td id="L2911" data-line-number="2911"></td>
        <td id="LC2911">    Module * pModule = <span>GetDynamicResolver</span>(pResolvedToken-&gt;<span>tokenScope</span>)-&gt;<span>GetDynamicMethod</span>()-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L2912" data-line-number="2912"></td>
        <td id="LC2912">    <span>ScanToken</span>(pModule, pResolvedToken, th, pMD);</td>
      </tr>
      <tr>
        <td id="L2913" data-line-number="2913"></td>
        <td id="LC2913">}</td>
      </tr>
      <tr>
        <td id="L2914" data-line-number="2914"></td>
        <td id="LC2914">
</td>
      </tr>
      <tr>
        <td id="L2915" data-line-number="2915"></td>
        <td id="LC2915">MethodDesc * <span>CEEInfo::GetMethodForSecurity</span>(CORINFO_METHOD_HANDLE callerHandle)</td>
      </tr>
      <tr>
        <td id="L2916" data-line-number="2916"></td>
        <td id="LC2916">{</td>
      </tr>
      <tr>
        <td id="L2917" data-line-number="2917"></td>
        <td id="LC2917">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2918" data-line-number="2918"></td>
        <td id="LC2918">
</td>
      </tr>
      <tr>
        <td id="L2919" data-line-number="2919"></td>
        <td id="LC2919">    <span><span>//</span> Cache the cast lookup</span></td>
      </tr>
      <tr>
        <td id="L2920" data-line-number="2920"></td>
        <td id="LC2920">    <span>if</span> (callerHandle == m_hMethodForSecurity_Key)</td>
      </tr>
      <tr>
        <td id="L2921" data-line-number="2921"></td>
        <td id="LC2921">    {</td>
      </tr>
      <tr>
        <td id="L2922" data-line-number="2922"></td>
        <td id="LC2922">        <span>return</span> m_pMethodForSecurity_Value;</td>
      </tr>
      <tr>
        <td id="L2923" data-line-number="2923"></td>
        <td id="LC2923">    }</td>
      </tr>
      <tr>
        <td id="L2924" data-line-number="2924"></td>
        <td id="LC2924">
</td>
      </tr>
      <tr>
        <td id="L2925" data-line-number="2925"></td>
        <td id="LC2925">    MethodDesc * pCallerMethod = (MethodDesc *)callerHandle;</td>
      </tr>
      <tr>
        <td id="L2926" data-line-number="2926"></td>
        <td id="LC2926">
</td>
      </tr>
      <tr>
        <td id="L2927" data-line-number="2927"></td>
        <td id="LC2927">    <span><span>//</span>If the caller is generic, load the open type and then load the field again,  This allows us to</span></td>
      </tr>
      <tr>
        <td id="L2928" data-line-number="2928"></td>
        <td id="LC2928">    <span><span>//</span>differentiate between BadGeneric&lt;T&gt; containing a memberRef for a field of type InaccessibleClass and</span></td>
      </tr>
      <tr>
        <td id="L2929" data-line-number="2929"></td>
        <td id="LC2929">    <span><span>//</span>GoodGeneric&lt;T&gt; containing a memberRef for a field of type T instantiated over InaccessibleClass.</span></td>
      </tr>
      <tr>
        <td id="L2930" data-line-number="2930"></td>
        <td id="LC2930">    MethodDesc * pMethodForSecurity = pCallerMethod-&gt;<span>IsILStub</span>() ?</td>
      </tr>
      <tr>
        <td id="L2931" data-line-number="2931"></td>
        <td id="LC2931">        pCallerMethod : pCallerMethod-&gt;<span>LoadTypicalMethodDefinition</span>();</td>
      </tr>
      <tr>
        <td id="L2932" data-line-number="2932"></td>
        <td id="LC2932">
</td>
      </tr>
      <tr>
        <td id="L2933" data-line-number="2933"></td>
        <td id="LC2933">    m_hMethodForSecurity_Key = callerHandle;</td>
      </tr>
      <tr>
        <td id="L2934" data-line-number="2934"></td>
        <td id="LC2934">    m_pMethodForSecurity_Value = pMethodForSecurity;</td>
      </tr>
      <tr>
        <td id="L2935" data-line-number="2935"></td>
        <td id="LC2935">
</td>
      </tr>
      <tr>
        <td id="L2936" data-line-number="2936"></td>
        <td id="LC2936">    <span>return</span> pMethodForSecurity;</td>
      </tr>
      <tr>
        <td id="L2937" data-line-number="2937"></td>
        <td id="LC2937">}</td>
      </tr>
      <tr>
        <td id="L2938" data-line-number="2938"></td>
        <td id="LC2938">
</td>
      </tr>
      <tr>
        <td id="L2939" data-line-number="2939"></td>
        <td id="LC2939"><span><span>//</span> Check that the instantation is &lt;!/!!0, ..., !/!!(n-1)&gt;</span></td>
      </tr>
      <tr>
        <td id="L2940" data-line-number="2940"></td>
        <td id="LC2940"><span>static</span> BOOL <span>IsSignatureForTypicalInstantiation</span>(SigPointer sigptr, CorElementType varType, ULONG ntypars)</td>
      </tr>
      <tr>
        <td id="L2941" data-line-number="2941"></td>
        <td id="LC2941">{</td>
      </tr>
      <tr>
        <td id="L2942" data-line-number="2942"></td>
        <td id="LC2942">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2943" data-line-number="2943"></td>
        <td id="LC2943">
</td>
      </tr>
      <tr>
        <td id="L2944" data-line-number="2944"></td>
        <td id="LC2944">    <span>for</span> (ULONG i = <span>0</span>; i &lt; ntypars; i++)</td>
      </tr>
      <tr>
        <td id="L2945" data-line-number="2945"></td>
        <td id="LC2945">    {</td>
      </tr>
      <tr>
        <td id="L2946" data-line-number="2946"></td>
        <td id="LC2946">        CorElementType type;</td>
      </tr>
      <tr>
        <td id="L2947" data-line-number="2947"></td>
        <td id="LC2947">        <span>IfFailThrow</span>(sigptr.<span>GetElemType</span>(&amp;type));</td>
      </tr>
      <tr>
        <td id="L2948" data-line-number="2948"></td>
        <td id="LC2948">        <span>if</span> (type != varType)</td>
      </tr>
      <tr>
        <td id="L2949" data-line-number="2949"></td>
        <td id="LC2949">            <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L2950" data-line-number="2950"></td>
        <td id="LC2950">
</td>
      </tr>
      <tr>
        <td id="L2951" data-line-number="2951"></td>
        <td id="LC2951">        ULONG data;</td>
      </tr>
      <tr>
        <td id="L2952" data-line-number="2952"></td>
        <td id="LC2952">        <span>IfFailThrow</span>(sigptr.<span>GetData</span>(&amp;data));</td>
      </tr>
      <tr>
        <td id="L2953" data-line-number="2953"></td>
        <td id="LC2953">
</td>
      </tr>
      <tr>
        <td id="L2954" data-line-number="2954"></td>
        <td id="LC2954">        <span>if</span> (data != i)</td>
      </tr>
      <tr>
        <td id="L2955" data-line-number="2955"></td>
        <td id="LC2955">             <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L2956" data-line-number="2956"></td>
        <td id="LC2956">    }</td>
      </tr>
      <tr>
        <td id="L2957" data-line-number="2957"></td>
        <td id="LC2957">
</td>
      </tr>
      <tr>
        <td id="L2958" data-line-number="2958"></td>
        <td id="LC2958">    <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L2959" data-line-number="2959"></td>
        <td id="LC2959">}</td>
      </tr>
      <tr>
        <td id="L2960" data-line-number="2960"></td>
        <td id="LC2960">
</td>
      </tr>
      <tr>
        <td id="L2961" data-line-number="2961"></td>
        <td id="LC2961"><span><span>//</span> Check that methodSpec instantiation is &lt;!!0, ..., !!(n-1)&gt;</span></td>
      </tr>
      <tr>
        <td id="L2962" data-line-number="2962"></td>
        <td id="LC2962"><span>static</span> BOOL <span>IsMethodSpecForTypicalInstantation</span>(SigPointer sigptr)</td>
      </tr>
      <tr>
        <td id="L2963" data-line-number="2963"></td>
        <td id="LC2963">{</td>
      </tr>
      <tr>
        <td id="L2964" data-line-number="2964"></td>
        <td id="LC2964">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2965" data-line-number="2965"></td>
        <td id="LC2965">
</td>
      </tr>
      <tr>
        <td id="L2966" data-line-number="2966"></td>
        <td id="LC2966">    BYTE etype;</td>
      </tr>
      <tr>
        <td id="L2967" data-line-number="2967"></td>
        <td id="LC2967">    <span>IfFailThrow</span>(sigptr.<span>GetByte</span>(&amp;etype));</td>
      </tr>
      <tr>
        <td id="L2968" data-line-number="2968"></td>
        <td id="LC2968">    <span>_ASSERTE</span>(etype == (BYTE)IMAGE_CEE_CS_CALLCONV_GENERICINST);</td>
      </tr>
      <tr>
        <td id="L2969" data-line-number="2969"></td>
        <td id="LC2969">
</td>
      </tr>
      <tr>
        <td id="L2970" data-line-number="2970"></td>
        <td id="LC2970">    ULONG ntypars;</td>
      </tr>
      <tr>
        <td id="L2971" data-line-number="2971"></td>
        <td id="LC2971">    <span>IfFailThrow</span>(sigptr.<span>GetData</span>(&amp;ntypars));</td>
      </tr>
      <tr>
        <td id="L2972" data-line-number="2972"></td>
        <td id="LC2972">
</td>
      </tr>
      <tr>
        <td id="L2973" data-line-number="2973"></td>
        <td id="LC2973">    <span>return</span> <span>IsSignatureForTypicalInstantiation</span>(sigptr, ELEMENT_TYPE_MVAR, ntypars);</td>
      </tr>
      <tr>
        <td id="L2974" data-line-number="2974"></td>
        <td id="LC2974">}</td>
      </tr>
      <tr>
        <td id="L2975" data-line-number="2975"></td>
        <td id="LC2975">
</td>
      </tr>
      <tr>
        <td id="L2976" data-line-number="2976"></td>
        <td id="LC2976"><span><span>//</span> Check that typeSpec instantiation is &lt;!0, ..., !(n-1)&gt;</span></td>
      </tr>
      <tr>
        <td id="L2977" data-line-number="2977"></td>
        <td id="LC2977"><span>static</span> BOOL <span>IsTypeSpecForTypicalInstantiation</span>(SigPointer sigptr)</td>
      </tr>
      <tr>
        <td id="L2978" data-line-number="2978"></td>
        <td id="LC2978">{</td>
      </tr>
      <tr>
        <td id="L2979" data-line-number="2979"></td>
        <td id="LC2979">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L2980" data-line-number="2980"></td>
        <td id="LC2980">
</td>
      </tr>
      <tr>
        <td id="L2981" data-line-number="2981"></td>
        <td id="LC2981">    CorElementType type;</td>
      </tr>
      <tr>
        <td id="L2982" data-line-number="2982"></td>
        <td id="LC2982">    <span>IfFailThrow</span>(sigptr.<span>GetElemType</span>(&amp;type));</td>
      </tr>
      <tr>
        <td id="L2983" data-line-number="2983"></td>
        <td id="LC2983">    <span>if</span> (type != ELEMENT_TYPE_GENERICINST)</td>
      </tr>
      <tr>
        <td id="L2984" data-line-number="2984"></td>
        <td id="LC2984">        <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L2985" data-line-number="2985"></td>
        <td id="LC2985">
</td>
      </tr>
      <tr>
        <td id="L2986" data-line-number="2986"></td>
        <td id="LC2986">    <span>IfFailThrow</span>(sigptr.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L2987" data-line-number="2987"></td>
        <td id="LC2987">
</td>
      </tr>
      <tr>
        <td id="L2988" data-line-number="2988"></td>
        <td id="LC2988">    ULONG ntypars;</td>
      </tr>
      <tr>
        <td id="L2989" data-line-number="2989"></td>
        <td id="LC2989">    <span>IfFailThrow</span>(sigptr.<span>GetData</span>(&amp;ntypars));</td>
      </tr>
      <tr>
        <td id="L2990" data-line-number="2990"></td>
        <td id="LC2990">
</td>
      </tr>
      <tr>
        <td id="L2991" data-line-number="2991"></td>
        <td id="LC2991">    <span>return</span> <span>IsSignatureForTypicalInstantiation</span>(sigptr, ELEMENT_TYPE_VAR, ntypars);</td>
      </tr>
      <tr>
        <td id="L2992" data-line-number="2992"></td>
        <td id="LC2992">}</td>
      </tr>
      <tr>
        <td id="L2993" data-line-number="2993"></td>
        <td id="LC2993">
</td>
      </tr>
      <tr>
        <td id="L2994" data-line-number="2994"></td>
        <td id="LC2994"><span>void</span> <span>CEEInfo::ComputeRuntimeLookupForSharedGenericToken</span>(DictionaryEntryKind entryKind,</td>
      </tr>
      <tr>
        <td id="L2995" data-line-number="2995"></td>
        <td id="LC2995">                                                        CORINFO_RESOLVED_TOKEN * pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L2996" data-line-number="2996"></td>
        <td id="LC2996">                                                        CORINFO_RESOLVED_TOKEN * pConstrainedResolvedToken,</td>
      </tr>
      <tr>
        <td id="L2997" data-line-number="2997"></td>
        <td id="LC2997">                                                        MethodDesc * pTemplateMD <span><span>/*</span> for method-based slots <span>*/</span></span>,</td>
      </tr>
      <tr>
        <td id="L2998" data-line-number="2998"></td>
        <td id="LC2998">                                                        CORINFO_LOOKUP *pResultLookup)</td>
      </tr>
      <tr>
        <td id="L2999" data-line-number="2999"></td>
        <td id="LC2999">{</td>
      </tr>
      <tr>
        <td id="L3000" data-line-number="3000"></td>
        <td id="LC3000">    CONTRACTL{</td>
      </tr>
      <tr>
        <td id="L3001" data-line-number="3001"></td>
        <td id="LC3001">        STANDARD_VM_CHECK;</td>
      </tr>
      <tr>
        <td id="L3002" data-line-number="3002"></td>
        <td id="LC3002">        <span>PRECONDITION</span>(<span>CheckPointer</span>(pResultLookup));</td>
      </tr>
      <tr>
        <td id="L3003" data-line-number="3003"></td>
        <td id="LC3003">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3004" data-line-number="3004"></td>
        <td id="LC3004">
</td>
      </tr>
      <tr>
        <td id="L3005" data-line-number="3005"></td>
        <td id="LC3005">
</td>
      </tr>
      <tr>
        <td id="L3006" data-line-number="3006"></td>
        <td id="LC3006">    <span><span>//</span> We should never get here when we are only verifying</span></td>
      </tr>
      <tr>
        <td id="L3007" data-line-number="3007"></td>
        <td id="LC3007">    <span>_ASSERTE</span>(!<span>isVerifyOnly</span>());</td>
      </tr>
      <tr>
        <td id="L3008" data-line-number="3008"></td>
        <td id="LC3008">
</td>
      </tr>
      <tr>
        <td id="L3009" data-line-number="3009"></td>
        <td id="LC3009">    pResultLookup-&gt;<span>lookupKind</span>.<span>needsRuntimeLookup</span> = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L3010" data-line-number="3010"></td>
        <td id="LC3010">    pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupFlags</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3011" data-line-number="3011"></td>
        <td id="LC3011">
</td>
      </tr>
      <tr>
        <td id="L3012" data-line-number="3012"></td>
        <td id="LC3012">    CORINFO_RUNTIME_LOOKUP *pResult = &amp;pResultLookup-&gt;<span>runtimeLookup</span>;</td>
      </tr>
      <tr>
        <td id="L3013" data-line-number="3013"></td>
        <td id="LC3013">    pResult-&gt;<span>signature</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3014" data-line-number="3014"></td>
        <td id="LC3014">
</td>
      </tr>
      <tr>
        <td id="L3015" data-line-number="3015"></td>
        <td id="LC3015">    pResult-&gt;<span>indirectFirstOffset</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3016" data-line-number="3016"></td>
        <td id="LC3016">    pResult-&gt;<span>indirectSecondOffset</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3017" data-line-number="3017"></td>
        <td id="LC3017">
</td>
      </tr>
      <tr>
        <td id="L3018" data-line-number="3018"></td>
        <td id="LC3018">    <span><span>//</span> Unless we decide otherwise, just do the lookup via a helper function</span></td>
      </tr>
      <tr>
        <td id="L3019" data-line-number="3019"></td>
        <td id="LC3019">    pResult-&gt;<span>indirections</span> = CORINFO_USEHELPER;</td>
      </tr>
      <tr>
        <td id="L3020" data-line-number="3020"></td>
        <td id="LC3020">
</td>
      </tr>
      <tr>
        <td id="L3021" data-line-number="3021"></td>
        <td id="LC3021">    MethodDesc *pContextMD = <span>GetMethodFromContext</span>(pResolvedToken-&gt;<span>tokenContext</span>);</td>
      </tr>
      <tr>
        <td id="L3022" data-line-number="3022"></td>
        <td id="LC3022">    MethodTable *pContextMT = pContextMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L3023" data-line-number="3023"></td>
        <td id="LC3023">
</td>
      </tr>
      <tr>
        <td id="L3024" data-line-number="3024"></td>
        <td id="LC3024">    <span><span>//</span> Do not bother computing the runtime lookup if we are inlining. The JIT is going</span></td>
      </tr>
      <tr>
        <td id="L3025" data-line-number="3025"></td>
        <td id="LC3025">    <span><span>//</span> to abort the inlining attempt anyway.</span></td>
      </tr>
      <tr>
        <td id="L3026" data-line-number="3026"></td>
        <td id="LC3026">    <span>if</span> (pContextMD != m_pMethodBeingCompiled)</td>
      </tr>
      <tr>
        <td id="L3027" data-line-number="3027"></td>
        <td id="LC3027">    {</td>
      </tr>
      <tr>
        <td id="L3028" data-line-number="3028"></td>
        <td id="LC3028">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L3029" data-line-number="3029"></td>
        <td id="LC3029">    }</td>
      </tr>
      <tr>
        <td id="L3030" data-line-number="3030"></td>
        <td id="LC3030">
</td>
      </tr>
      <tr>
        <td id="L3031" data-line-number="3031"></td>
        <td id="LC3031">    <span><span>//</span> There is a pathological case where invalid IL refereces __Canon type directly, but there is no dictionary availabled to store the lookup.</span></td>
      </tr>
      <tr>
        <td id="L3032" data-line-number="3032"></td>
        <td id="LC3032">    <span><span>//</span> All callers of ComputeRuntimeLookupForSharedGenericToken have to filter out this case. We can't do much about it here.</span></td>
      </tr>
      <tr>
        <td id="L3033" data-line-number="3033"></td>
        <td id="LC3033">    <span>_ASSERTE</span>(pContextMD-&gt;<span>IsSharedByGenericInstantiations</span>());</td>
      </tr>
      <tr>
        <td id="L3034" data-line-number="3034"></td>
        <td id="LC3034">
</td>
      </tr>
      <tr>
        <td id="L3035" data-line-number="3035"></td>
        <td id="LC3035">    BOOL <span>fInstrument</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L3036" data-line-number="3036"></td>
        <td id="LC3036">
</td>
      </tr>
      <tr>
        <td id="L3037" data-line-number="3037"></td>
        <td id="LC3037">#<span>ifdef</span> FEATURE_NATIVE_IMAGE_GENERATION</td>
      </tr>
      <tr>
        <td id="L3038" data-line-number="3038"></td>
        <td id="LC3038">    <span><span>//</span> This will make sure that when IBC logging is turned on we will go through a version</span></td>
      </tr>
      <tr>
        <td id="L3039" data-line-number="3039"></td>
        <td id="LC3039">    <span><span>//</span> of JIT_GenericHandle which logs the access. Note that we still want the dictionaries</span></td>
      </tr>
      <tr>
        <td id="L3040" data-line-number="3040"></td>
        <td id="LC3040">    <span><span>//</span> to be populated to prepopulate the types at NGen time.</span></td>
      </tr>
      <tr>
        <td id="L3041" data-line-number="3041"></td>
        <td id="LC3041">    <span>if</span> (<span>IsCompilingForNGen</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L3042" data-line-number="3042"></td>
        <td id="LC3042">        <span>GetAppDomain</span>()-&gt;<span>ToCompilationDomain</span>()-&gt;<span>m_fForceInstrument</span>)</td>
      </tr>
      <tr>
        <td id="L3043" data-line-number="3043"></td>
        <td id="LC3043">    {</td>
      </tr>
      <tr>
        <td id="L3044" data-line-number="3044"></td>
        <td id="LC3044">        <span>fInstrument</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L3045" data-line-number="3045"></td>
        <td id="LC3045">    }</td>
      </tr>
      <tr>
        <td id="L3046" data-line-number="3046"></td>
        <td id="LC3046">#<span>endif</span> <span><span>//</span> FEATURE_NATIVE_IMAGE_GENERATION</span></td>
      </tr>
      <tr>
        <td id="L3047" data-line-number="3047"></td>
        <td id="LC3047">
</td>
      </tr>
      <tr>
        <td id="L3048" data-line-number="3048"></td>
        <td id="LC3048">    <span>if</span> (pContextMD-&gt;<span>RequiresInstMethodDescArg</span>())</td>
      </tr>
      <tr>
        <td id="L3049" data-line-number="3049"></td>
        <td id="LC3049">    {</td>
      </tr>
      <tr>
        <td id="L3050" data-line-number="3050"></td>
        <td id="LC3050">        pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupKind</span> = CORINFO_LOOKUP_METHODPARAM;</td>
      </tr>
      <tr>
        <td id="L3051" data-line-number="3051"></td>
        <td id="LC3051">    }</td>
      </tr>
      <tr>
        <td id="L3052" data-line-number="3052"></td>
        <td id="LC3052">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L3053" data-line-number="3053"></td>
        <td id="LC3053">    {</td>
      </tr>
      <tr>
        <td id="L3054" data-line-number="3054"></td>
        <td id="LC3054">        <span>if</span> (pContextMD-&gt;<span>RequiresInstMethodTableArg</span>())</td>
      </tr>
      <tr>
        <td id="L3055" data-line-number="3055"></td>
        <td id="LC3055">            pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupKind</span> = CORINFO_LOOKUP_CLASSPARAM;</td>
      </tr>
      <tr>
        <td id="L3056" data-line-number="3056"></td>
        <td id="LC3056">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L3057" data-line-number="3057"></td>
        <td id="LC3057">            pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupKind</span> = CORINFO_LOOKUP_THISOBJ;</td>
      </tr>
      <tr>
        <td id="L3058" data-line-number="3058"></td>
        <td id="LC3058">    }</td>
      </tr>
      <tr>
        <td id="L3059" data-line-number="3059"></td>
        <td id="LC3059">
</td>
      </tr>
      <tr>
        <td id="L3060" data-line-number="3060"></td>
        <td id="LC3060">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L3061" data-line-number="3061"></td>
        <td id="LC3061">    <span>if</span> (<span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L3062" data-line-number="3062"></td>
        <td id="LC3062">    {</td>
      </tr>
      <tr>
        <td id="L3063" data-line-number="3063"></td>
        <td id="LC3063">        pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupArgs</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3064" data-line-number="3064"></td>
        <td id="LC3064">
</td>
      </tr>
      <tr>
        <td id="L3065" data-line-number="3065"></td>
        <td id="LC3065">        <span>switch</span> (entryKind)</td>
      </tr>
      <tr>
        <td id="L3066" data-line-number="3066"></td>
        <td id="LC3066">        {</td>
      </tr>
      <tr>
        <td id="L3067" data-line-number="3067"></td>
        <td id="LC3067">        <span>case</span> DeclaringTypeHandleSlot:</td>
      </tr>
      <tr>
        <td id="L3068" data-line-number="3068"></td>
        <td id="LC3068">            <span>_ASSERTE</span>(pTemplateMD != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L3069" data-line-number="3069"></td>
        <td id="LC3069">            pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupArgs</span> = pTemplateMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L3070" data-line-number="3070"></td>
        <td id="LC3070">            pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupFlags</span> = READYTORUN_FIXUP_DeclaringTypeHandle;</td>
      </tr>
      <tr>
        <td id="L3071" data-line-number="3071"></td>
        <td id="LC3071">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L3072" data-line-number="3072"></td>
        <td id="LC3072">
</td>
      </tr>
      <tr>
        <td id="L3073" data-line-number="3073"></td>
        <td id="LC3073">        <span>case</span> TypeHandleSlot:</td>
      </tr>
      <tr>
        <td id="L3074" data-line-number="3074"></td>
        <td id="LC3074">            pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupFlags</span> = READYTORUN_FIXUP_TypeHandle;</td>
      </tr>
      <tr>
        <td id="L3075" data-line-number="3075"></td>
        <td id="LC3075">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L3076" data-line-number="3076"></td>
        <td id="LC3076">
</td>
      </tr>
      <tr>
        <td id="L3077" data-line-number="3077"></td>
        <td id="LC3077">        <span>case</span> MethodDescSlot:</td>
      </tr>
      <tr>
        <td id="L3078" data-line-number="3078"></td>
        <td id="LC3078">        <span>case</span> MethodEntrySlot:</td>
      </tr>
      <tr>
        <td id="L3079" data-line-number="3079"></td>
        <td id="LC3079">        <span>case</span> ConstrainedMethodEntrySlot:</td>
      </tr>
      <tr>
        <td id="L3080" data-line-number="3080"></td>
        <td id="LC3080">        <span>case</span> DispatchStubAddrSlot:</td>
      </tr>
      <tr>
        <td id="L3081" data-line-number="3081"></td>
        <td id="LC3081">        {</td>
      </tr>
      <tr>
        <td id="L3082" data-line-number="3082"></td>
        <td id="LC3082">            <span>if</span> (pTemplateMD != (MethodDesc*)pResolvedToken-&gt;<span>hMethod</span>)</td>
      </tr>
      <tr>
        <td id="L3083" data-line-number="3083"></td>
        <td id="LC3083">                <span>ThrowHR</span>(E_NOTIMPL);</td>
      </tr>
      <tr>
        <td id="L3084" data-line-number="3084"></td>
        <td id="LC3084">
</td>
      </tr>
      <tr>
        <td id="L3085" data-line-number="3085"></td>
        <td id="LC3085">            <span>if</span> (entryKind == MethodDescSlot)</td>
      </tr>
      <tr>
        <td id="L3086" data-line-number="3086"></td>
        <td id="LC3086">                pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupFlags</span> = READYTORUN_FIXUP_MethodHandle;</td>
      </tr>
      <tr>
        <td id="L3087" data-line-number="3087"></td>
        <td id="LC3087">            <span>else</span> <span>if</span> (entryKind == MethodEntrySlot || entryKind == ConstrainedMethodEntrySlot)</td>
      </tr>
      <tr>
        <td id="L3088" data-line-number="3088"></td>
        <td id="LC3088">                pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupFlags</span> = READYTORUN_FIXUP_MethodEntry;</td>
      </tr>
      <tr>
        <td id="L3089" data-line-number="3089"></td>
        <td id="LC3089">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3090" data-line-number="3090"></td>
        <td id="LC3090">                pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupFlags</span> = READYTORUN_FIXUP_VirtualEntry;</td>
      </tr>
      <tr>
        <td id="L3091" data-line-number="3091"></td>
        <td id="LC3091">
</td>
      </tr>
      <tr>
        <td id="L3092" data-line-number="3092"></td>
        <td id="LC3092">            pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupArgs</span> = pConstrainedResolvedToken;</td>
      </tr>
      <tr>
        <td id="L3093" data-line-number="3093"></td>
        <td id="LC3093">
</td>
      </tr>
      <tr>
        <td id="L3094" data-line-number="3094"></td>
        <td id="LC3094">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L3095" data-line-number="3095"></td>
        <td id="LC3095">        }</td>
      </tr>
      <tr>
        <td id="L3096" data-line-number="3096"></td>
        <td id="LC3096">
</td>
      </tr>
      <tr>
        <td id="L3097" data-line-number="3097"></td>
        <td id="LC3097">        <span>case</span> FieldDescSlot:</td>
      </tr>
      <tr>
        <td id="L3098" data-line-number="3098"></td>
        <td id="LC3098">            pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupFlags</span> = READYTORUN_FIXUP_FieldHandle;</td>
      </tr>
      <tr>
        <td id="L3099" data-line-number="3099"></td>
        <td id="LC3099">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L3100" data-line-number="3100"></td>
        <td id="LC3100">
</td>
      </tr>
      <tr>
        <td id="L3101" data-line-number="3101"></td>
        <td id="LC3101">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L3102" data-line-number="3102"></td>
        <td id="LC3102">            <span>_ASSERTE</span>(!<span><span>"</span>Unknown dictionary entry kind!<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L3103" data-line-number="3103"></td>
        <td id="LC3103">            <span>IfFailThrow</span>(E_FAIL);</td>
      </tr>
      <tr>
        <td id="L3104" data-line-number="3104"></td>
        <td id="LC3104">        }</td>
      </tr>
      <tr>
        <td id="L3105" data-line-number="3105"></td>
        <td id="LC3105">
</td>
      </tr>
      <tr>
        <td id="L3106" data-line-number="3106"></td>
        <td id="LC3106">        <span><span>//</span> For R2R compilations, we don't generate the dictionary lookup signatures (dictionary lookups are done in a</span></td>
      </tr>
      <tr>
        <td id="L3107" data-line-number="3107"></td>
        <td id="LC3107">        <span><span>//</span> different way that is more version resilient... plus we can't have pointers to existing MTs/MDs in the sigs)</span></td>
      </tr>
      <tr>
        <td id="L3108" data-line-number="3108"></td>
        <td id="LC3108">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L3109" data-line-number="3109"></td>
        <td id="LC3109">    }</td>
      </tr>
      <tr>
        <td id="L3110" data-line-number="3110"></td>
        <td id="LC3110">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L3111" data-line-number="3111"></td>
        <td id="LC3111">    <span><span>//</span> If we've got a  method type parameter of any kind then we must look in the method desc arg</span></td>
      </tr>
      <tr>
        <td id="L3112" data-line-number="3112"></td>
        <td id="LC3112">    <span>if</span> (pContextMD-&gt;<span>RequiresInstMethodDescArg</span>())</td>
      </tr>
      <tr>
        <td id="L3113" data-line-number="3113"></td>
        <td id="LC3113">    {</td>
      </tr>
      <tr>
        <td id="L3114" data-line-number="3114"></td>
        <td id="LC3114">        pResult-&gt;<span>helper</span> = <span>fInstrument</span> ? CORINFO_HELP_RUNTIMEHANDLE_METHOD_LOG : CORINFO_HELP_RUNTIMEHANDLE_METHOD;</td>
      </tr>
      <tr>
        <td id="L3115" data-line-number="3115"></td>
        <td id="LC3115">
</td>
      </tr>
      <tr>
        <td id="L3116" data-line-number="3116"></td>
        <td id="LC3116">        <span>if</span> (<span>fInstrument</span>)</td>
      </tr>
      <tr>
        <td id="L3117" data-line-number="3117"></td>
        <td id="LC3117">            <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3118" data-line-number="3118"></td>
        <td id="LC3118">
</td>
      </tr>
      <tr>
        <td id="L3119" data-line-number="3119"></td>
        <td id="LC3119">        <span><span>//</span> Special cases:</span></td>
      </tr>
      <tr>
        <td id="L3120" data-line-number="3120"></td>
        <td id="LC3120">        <span><span>//</span> (1) Naked method type variable: look up directly in instantiation hanging off runtime md</span></td>
      </tr>
      <tr>
        <td id="L3121" data-line-number="3121"></td>
        <td id="LC3121">        <span><span>//</span> (2) Reference to method-spec of current method (e.g. a recursive call) i.e. currentmeth&lt;!0,...,!(n-1)&gt;</span></td>
      </tr>
      <tr>
        <td id="L3122" data-line-number="3122"></td>
        <td id="LC3122">        <span>if</span> ((entryKind == TypeHandleSlot) &amp;&amp; (pResolvedToken-&gt;<span>tokenType</span> != CORINFO_TOKENKIND_Newarr))</td>
      </tr>
      <tr>
        <td id="L3123" data-line-number="3123"></td>
        <td id="LC3123">        {</td>
      </tr>
      <tr>
        <td id="L3124" data-line-number="3124"></td>
        <td id="LC3124">            SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L3125" data-line-number="3125"></td>
        <td id="LC3125">            CorElementType type;</td>
      </tr>
      <tr>
        <td id="L3126" data-line-number="3126"></td>
        <td id="LC3126">            <span>IfFailThrow</span>(sigptr.<span>GetElemType</span>(&amp;type));</td>
      </tr>
      <tr>
        <td id="L3127" data-line-number="3127"></td>
        <td id="LC3127">            <span>if</span> (type == ELEMENT_TYPE_MVAR)</td>
      </tr>
      <tr>
        <td id="L3128" data-line-number="3128"></td>
        <td id="LC3128">            {</td>
      </tr>
      <tr>
        <td id="L3129" data-line-number="3129"></td>
        <td id="LC3129">                pResult-&gt;<span>indirections</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L3130" data-line-number="3130"></td>
        <td id="LC3130">                pResult-&gt;<span>testForNull</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3131" data-line-number="3131"></td>
        <td id="LC3131">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L3132" data-line-number="3132"></td>
        <td id="LC3132">                pResult-&gt;<span>testForFixup</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3133" data-line-number="3133"></td>
        <td id="LC3133">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L3134" data-line-number="3134"></td>
        <td id="LC3134">                pResult-&gt;<span>testForFixup</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3135" data-line-number="3135"></td>
        <td id="LC3135">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L3136" data-line-number="3136"></td>
        <td id="LC3136">                pResult-&gt;<span>offsets</span>[<span>0</span>] = <span>offsetof</span>(InstantiatedMethodDesc, m_pPerInstInfo);</td>
      </tr>
      <tr>
        <td id="L3137" data-line-number="3137"></td>
        <td id="LC3137">
</td>
      </tr>
      <tr>
        <td id="L3138" data-line-number="3138"></td>
        <td id="LC3138">                <span>if</span> (<span>decltype</span>(InstantiatedMethodDesc::m_pPerInstInfo)::isRelative)</td>
      </tr>
      <tr>
        <td id="L3139" data-line-number="3139"></td>
        <td id="LC3139">                {</td>
      </tr>
      <tr>
        <td id="L3140" data-line-number="3140"></td>
        <td id="LC3140">                    pResult-&gt;<span>indirectFirstOffset</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3141" data-line-number="3141"></td>
        <td id="LC3141">                }</td>
      </tr>
      <tr>
        <td id="L3142" data-line-number="3142"></td>
        <td id="LC3142">
</td>
      </tr>
      <tr>
        <td id="L3143" data-line-number="3143"></td>
        <td id="LC3143">                ULONG data;</td>
      </tr>
      <tr>
        <td id="L3144" data-line-number="3144"></td>
        <td id="LC3144">                <span>IfFailThrow</span>(sigptr.<span>GetData</span>(&amp;data));</td>
      </tr>
      <tr>
        <td id="L3145" data-line-number="3145"></td>
        <td id="LC3145">                pResult-&gt;<span>offsets</span>[<span>1</span>] = <span>sizeof</span>(TypeHandle) * data;</td>
      </tr>
      <tr>
        <td id="L3146" data-line-number="3146"></td>
        <td id="LC3146">
</td>
      </tr>
      <tr>
        <td id="L3147" data-line-number="3147"></td>
        <td id="LC3147">                <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L3148" data-line-number="3148"></td>
        <td id="LC3148">            }</td>
      </tr>
      <tr>
        <td id="L3149" data-line-number="3149"></td>
        <td id="LC3149">        }</td>
      </tr>
      <tr>
        <td id="L3150" data-line-number="3150"></td>
        <td id="LC3150">        <span>else</span> <span>if</span> (entryKind == MethodDescSlot)</td>
      </tr>
      <tr>
        <td id="L3151" data-line-number="3151"></td>
        <td id="LC3151">        {</td>
      </tr>
      <tr>
        <td id="L3152" data-line-number="3152"></td>
        <td id="LC3152">            <span><span>//</span> It's the context itself (i.e. a recursive call)</span></td>
      </tr>
      <tr>
        <td id="L3153" data-line-number="3153"></td>
        <td id="LC3153">            <span>if</span> (!pTemplateMD-&gt;<span>HasSameMethodDefAs</span>(pContextMD))</td>
      </tr>
      <tr>
        <td id="L3154" data-line-number="3154"></td>
        <td id="LC3154">                <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3155" data-line-number="3155"></td>
        <td id="LC3155">
</td>
      </tr>
      <tr>
        <td id="L3156" data-line-number="3156"></td>
        <td id="LC3156">            <span><span>//</span> Now just check that the instantiation is (!!0, ..., !!(n-1))</span></td>
      </tr>
      <tr>
        <td id="L3157" data-line-number="3157"></td>
        <td id="LC3157">            <span>if</span> (!<span>IsMethodSpecForTypicalInstantation</span>(<span>SigPointer</span>(pResolvedToken-&gt;<span>pMethodSpec</span>, pResolvedToken-&gt;<span>cbMethodSpec</span>)))</td>
      </tr>
      <tr>
        <td id="L3158" data-line-number="3158"></td>
        <td id="LC3158">                <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3159" data-line-number="3159"></td>
        <td id="LC3159">
</td>
      </tr>
      <tr>
        <td id="L3160" data-line-number="3160"></td>
        <td id="LC3160">            <span><span>//</span> Type instantiation has to match too if there is one</span></td>
      </tr>
      <tr>
        <td id="L3161" data-line-number="3161"></td>
        <td id="LC3161">            <span>if</span> (pContextMT-&gt;<span>HasInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L3162" data-line-number="3162"></td>
        <td id="LC3162">            {</td>
      </tr>
      <tr>
        <td id="L3163" data-line-number="3163"></td>
        <td id="LC3163">                TypeHandle <span>thTemplate</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L3164" data-line-number="3164"></td>
        <td id="LC3164">
</td>
      </tr>
      <tr>
        <td id="L3165" data-line-number="3165"></td>
        <td id="LC3165">                <span>if</span> (thTemplate.<span>IsTypeDesc</span>() || !thTemplate.<span>AsMethodTable</span>()-&gt;<span>HasSameTypeDefAs</span>(pContextMT))</td>
      </tr>
      <tr>
        <td id="L3166" data-line-number="3166"></td>
        <td id="LC3166">                    <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3167" data-line-number="3167"></td>
        <td id="LC3167">
</td>
      </tr>
      <tr>
        <td id="L3168" data-line-number="3168"></td>
        <td id="LC3168">                <span><span>//</span> This check filters out method instantiation on generic type definition, like G::M&lt;!!0&gt;()</span></td>
      </tr>
      <tr>
        <td id="L3169" data-line-number="3169"></td>
        <td id="LC3169">                <span><span>//</span> We may not ever get it here. Filter it out just to be sure...</span></td>
      </tr>
      <tr>
        <td id="L3170" data-line-number="3170"></td>
        <td id="LC3170">                <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3171" data-line-number="3171"></td>
        <td id="LC3171">                    <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3172" data-line-number="3172"></td>
        <td id="LC3172">
</td>
      </tr>
      <tr>
        <td id="L3173" data-line-number="3173"></td>
        <td id="LC3173">                <span>if</span> (!<span>IsTypeSpecForTypicalInstantiation</span>(<span>SigPointer</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>)))</td>
      </tr>
      <tr>
        <td id="L3174" data-line-number="3174"></td>
        <td id="LC3174">                    <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3175" data-line-number="3175"></td>
        <td id="LC3175">            }</td>
      </tr>
      <tr>
        <td id="L3176" data-line-number="3176"></td>
        <td id="LC3176">
</td>
      </tr>
      <tr>
        <td id="L3177" data-line-number="3177"></td>
        <td id="LC3177">            <span><span>//</span> Just use the method descriptor that was passed in!</span></td>
      </tr>
      <tr>
        <td id="L3178" data-line-number="3178"></td>
        <td id="LC3178">            pResult-&gt;<span>indirections</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3179" data-line-number="3179"></td>
        <td id="LC3179">            pResult-&gt;<span>testForNull</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3180" data-line-number="3180"></td>
        <td id="LC3180">            pResult-&gt;<span>testForFixup</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3181" data-line-number="3181"></td>
        <td id="LC3181">
</td>
      </tr>
      <tr>
        <td id="L3182" data-line-number="3182"></td>
        <td id="LC3182">            <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L3183" data-line-number="3183"></td>
        <td id="LC3183">        }</td>
      </tr>
      <tr>
        <td id="L3184" data-line-number="3184"></td>
        <td id="LC3184">    }</td>
      </tr>
      <tr>
        <td id="L3185" data-line-number="3185"></td>
        <td id="LC3185">    <span><span>//</span> Otherwise we must just have class type variables</span></td>
      </tr>
      <tr>
        <td id="L3186" data-line-number="3186"></td>
        <td id="LC3186">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L3187" data-line-number="3187"></td>
        <td id="LC3187">    {</td>
      </tr>
      <tr>
        <td id="L3188" data-line-number="3188"></td>
        <td id="LC3188">        <span>_ASSERTE</span>(pContextMT-&gt;<span>GetNumGenericArgs</span>() &gt; <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L3189" data-line-number="3189"></td>
        <td id="LC3189">
</td>
      </tr>
      <tr>
        <td id="L3190" data-line-number="3190"></td>
        <td id="LC3190">        <span>if</span> (pContextMD-&gt;<span>RequiresInstMethodTableArg</span>())</td>
      </tr>
      <tr>
        <td id="L3191" data-line-number="3191"></td>
        <td id="LC3191">        {</td>
      </tr>
      <tr>
        <td id="L3192" data-line-number="3192"></td>
        <td id="LC3192">            <span><span>//</span> If we've got a vtable extra argument, go through that</span></td>
      </tr>
      <tr>
        <td id="L3193" data-line-number="3193"></td>
        <td id="LC3193">            pResult-&gt;<span>helper</span> = <span>fInstrument</span> ? CORINFO_HELP_RUNTIMEHANDLE_CLASS_LOG : CORINFO_HELP_RUNTIMEHANDLE_CLASS;</td>
      </tr>
      <tr>
        <td id="L3194" data-line-number="3194"></td>
        <td id="LC3194">        }</td>
      </tr>
      <tr>
        <td id="L3195" data-line-number="3195"></td>
        <td id="LC3195">        <span><span>//</span> If we've got an object, go through its vtable</span></td>
      </tr>
      <tr>
        <td id="L3196" data-line-number="3196"></td>
        <td id="LC3196">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L3197" data-line-number="3197"></td>
        <td id="LC3197">        {</td>
      </tr>
      <tr>
        <td id="L3198" data-line-number="3198"></td>
        <td id="LC3198">            <span>_ASSERTE</span>(pContextMD-&gt;<span>AcquiresInstMethodTableFromThis</span>());</td>
      </tr>
      <tr>
        <td id="L3199" data-line-number="3199"></td>
        <td id="LC3199">            pResult-&gt;<span>helper</span> = <span>fInstrument</span> ? CORINFO_HELP_RUNTIMEHANDLE_CLASS_LOG : CORINFO_HELP_RUNTIMEHANDLE_CLASS;</td>
      </tr>
      <tr>
        <td id="L3200" data-line-number="3200"></td>
        <td id="LC3200">        }</td>
      </tr>
      <tr>
        <td id="L3201" data-line-number="3201"></td>
        <td id="LC3201">
</td>
      </tr>
      <tr>
        <td id="L3202" data-line-number="3202"></td>
        <td id="LC3202">        <span>if</span> (<span>fInstrument</span>)</td>
      </tr>
      <tr>
        <td id="L3203" data-line-number="3203"></td>
        <td id="LC3203">            <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3204" data-line-number="3204"></td>
        <td id="LC3204">
</td>
      </tr>
      <tr>
        <td id="L3205" data-line-number="3205"></td>
        <td id="LC3205">        <span><span>//</span> Special cases:</span></td>
      </tr>
      <tr>
        <td id="L3206" data-line-number="3206"></td>
        <td id="LC3206">        <span><span>//</span> (1) Naked class type variable: look up directly in instantiation hanging off vtable</span></td>
      </tr>
      <tr>
        <td id="L3207" data-line-number="3207"></td>
        <td id="LC3207">        <span><span>//</span> (2) C&lt;!0,...,!(n-1)&gt; where C is the context's class and C is sealed: just return vtable ptr</span></td>
      </tr>
      <tr>
        <td id="L3208" data-line-number="3208"></td>
        <td id="LC3208">        <span>if</span> ((entryKind == TypeHandleSlot) &amp;&amp; (pResolvedToken-&gt;<span>tokenType</span> != CORINFO_TOKENKIND_Newarr))</td>
      </tr>
      <tr>
        <td id="L3209" data-line-number="3209"></td>
        <td id="LC3209">        {</td>
      </tr>
      <tr>
        <td id="L3210" data-line-number="3210"></td>
        <td id="LC3210">            SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L3211" data-line-number="3211"></td>
        <td id="LC3211">            CorElementType type;</td>
      </tr>
      <tr>
        <td id="L3212" data-line-number="3212"></td>
        <td id="LC3212">            <span>IfFailThrow</span>(sigptr.<span>GetElemType</span>(&amp;type));</td>
      </tr>
      <tr>
        <td id="L3213" data-line-number="3213"></td>
        <td id="LC3213">            <span>if</span> (type == ELEMENT_TYPE_VAR)</td>
      </tr>
      <tr>
        <td id="L3214" data-line-number="3214"></td>
        <td id="LC3214">            {</td>
      </tr>
      <tr>
        <td id="L3215" data-line-number="3215"></td>
        <td id="LC3215">                pResult-&gt;<span>indirections</span> = <span>3</span>;</td>
      </tr>
      <tr>
        <td id="L3216" data-line-number="3216"></td>
        <td id="LC3216">                pResult-&gt;<span>testForNull</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3217" data-line-number="3217"></td>
        <td id="LC3217">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L3218" data-line-number="3218"></td>
        <td id="LC3218">                pResult-&gt;<span>testForFixup</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3219" data-line-number="3219"></td>
        <td id="LC3219">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L3220" data-line-number="3220"></td>
        <td id="LC3220">                pResult-&gt;<span>testForFixup</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3221" data-line-number="3221"></td>
        <td id="LC3221">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L3222" data-line-number="3222"></td>
        <td id="LC3222">                pResult-&gt;<span>offsets</span>[<span>0</span>] = <span>MethodTable::GetOffsetOfPerInstInfo</span>();</td>
      </tr>
      <tr>
        <td id="L3223" data-line-number="3223"></td>
        <td id="LC3223">                pResult-&gt;<span>offsets</span>[<span>1</span>] = <span>sizeof</span>(TypeHandle*) * (pContextMT-&gt;<span>GetNumDicts</span>() - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L3224" data-line-number="3224"></td>
        <td id="LC3224">                ULONG data;</td>
      </tr>
      <tr>
        <td id="L3225" data-line-number="3225"></td>
        <td id="LC3225">                <span>IfFailThrow</span>(sigptr.<span>GetData</span>(&amp;data));</td>
      </tr>
      <tr>
        <td id="L3226" data-line-number="3226"></td>
        <td id="LC3226">                pResult-&gt;<span>offsets</span>[<span>2</span>] = <span>sizeof</span>(TypeHandle) * data;</td>
      </tr>
      <tr>
        <td id="L3227" data-line-number="3227"></td>
        <td id="LC3227">
</td>
      </tr>
      <tr>
        <td id="L3228" data-line-number="3228"></td>
        <td id="LC3228">                <span>if</span> (<span>MethodTable::IsPerInstInfoRelative</span>())</td>
      </tr>
      <tr>
        <td id="L3229" data-line-number="3229"></td>
        <td id="LC3229">                {</td>
      </tr>
      <tr>
        <td id="L3230" data-line-number="3230"></td>
        <td id="LC3230">                    pResult-&gt;<span>indirectFirstOffset</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3231" data-line-number="3231"></td>
        <td id="LC3231">                    pResult-&gt;<span>indirectSecondOffset</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3232" data-line-number="3232"></td>
        <td id="LC3232">                }</td>
      </tr>
      <tr>
        <td id="L3233" data-line-number="3233"></td>
        <td id="LC3233">
</td>
      </tr>
      <tr>
        <td id="L3234" data-line-number="3234"></td>
        <td id="LC3234">                <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L3235" data-line-number="3235"></td>
        <td id="LC3235">            }</td>
      </tr>
      <tr>
        <td id="L3236" data-line-number="3236"></td>
        <td id="LC3236">            <span>else</span> <span>if</span> (type == ELEMENT_TYPE_GENERICINST &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L3237" data-line-number="3237"></td>
        <td id="LC3237">                (pContextMT-&gt;<span>IsSealed</span>() || pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupKind</span> == CORINFO_LOOKUP_CLASSPARAM))</td>
      </tr>
      <tr>
        <td id="L3238" data-line-number="3238"></td>
        <td id="LC3238">            {</td>
      </tr>
      <tr>
        <td id="L3239" data-line-number="3239"></td>
        <td id="LC3239">                TypeHandle <span>thTemplate</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L3240" data-line-number="3240"></td>
        <td id="LC3240">
</td>
      </tr>
      <tr>
        <td id="L3241" data-line-number="3241"></td>
        <td id="LC3241">                <span>if</span> (thTemplate.<span>IsTypeDesc</span>() || !thTemplate.<span>AsMethodTable</span>()-&gt;<span>HasSameTypeDefAs</span>(pContextMT))</td>
      </tr>
      <tr>
        <td id="L3242" data-line-number="3242"></td>
        <td id="LC3242">                    <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3243" data-line-number="3243"></td>
        <td id="LC3243">
</td>
      </tr>
      <tr>
        <td id="L3244" data-line-number="3244"></td>
        <td id="LC3244">                <span>if</span> (!<span>IsTypeSpecForTypicalInstantiation</span>(<span>SigPointer</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>)))</td>
      </tr>
      <tr>
        <td id="L3245" data-line-number="3245"></td>
        <td id="LC3245">                    <span>goto</span> NoSpecialCase;</td>
      </tr>
      <tr>
        <td id="L3246" data-line-number="3246"></td>
        <td id="LC3246">
</td>
      </tr>
      <tr>
        <td id="L3247" data-line-number="3247"></td>
        <td id="LC3247">                <span><span>//</span> Just use the vtable pointer itself!</span></td>
      </tr>
      <tr>
        <td id="L3248" data-line-number="3248"></td>
        <td id="LC3248">                pResult-&gt;<span>indirections</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3249" data-line-number="3249"></td>
        <td id="LC3249">                pResult-&gt;<span>testForNull</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3250" data-line-number="3250"></td>
        <td id="LC3250">                pResult-&gt;<span>testForFixup</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3251" data-line-number="3251"></td>
        <td id="LC3251">
</td>
      </tr>
      <tr>
        <td id="L3252" data-line-number="3252"></td>
        <td id="LC3252">                <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L3253" data-line-number="3253"></td>
        <td id="LC3253">            }</td>
      </tr>
      <tr>
        <td id="L3254" data-line-number="3254"></td>
        <td id="LC3254">        }</td>
      </tr>
      <tr>
        <td id="L3255" data-line-number="3255"></td>
        <td id="LC3255">    }</td>
      </tr>
      <tr>
        <td id="L3256" data-line-number="3256"></td>
        <td id="LC3256">
</td>
      </tr>
      <tr>
        <td id="L3257" data-line-number="3257"></td>
        <td id="LC3257">NoSpecialCase:</td>
      </tr>
      <tr>
        <td id="L3258" data-line-number="3258"></td>
        <td id="LC3258">
</td>
      </tr>
      <tr>
        <td id="L3259" data-line-number="3259"></td>
        <td id="LC3259">    SigBuilder sigBuilder;</td>
      </tr>
      <tr>
        <td id="L3260" data-line-number="3260"></td>
        <td id="LC3260">
</td>
      </tr>
      <tr>
        <td id="L3261" data-line-number="3261"></td>
        <td id="LC3261">    sigBuilder.<span>AppendData</span>(entryKind);</td>
      </tr>
      <tr>
        <td id="L3262" data-line-number="3262"></td>
        <td id="LC3262">
</td>
      </tr>
      <tr>
        <td id="L3263" data-line-number="3263"></td>
        <td id="LC3263">    <span>if</span> (pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupKind</span> != CORINFO_LOOKUP_METHODPARAM)</td>
      </tr>
      <tr>
        <td id="L3264" data-line-number="3264"></td>
        <td id="LC3264">    {</td>
      </tr>
      <tr>
        <td id="L3265" data-line-number="3265"></td>
        <td id="LC3265">        <span>_ASSERTE</span>(pContextMT-&gt;<span>GetNumDicts</span>() &gt; <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L3266" data-line-number="3266"></td>
        <td id="LC3266">        sigBuilder.<span>AppendData</span>(pContextMT-&gt;<span>GetNumDicts</span>() - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L3267" data-line-number="3267"></td>
        <td id="LC3267">    }</td>
      </tr>
      <tr>
        <td id="L3268" data-line-number="3268"></td>
        <td id="LC3268">
</td>
      </tr>
      <tr>
        <td id="L3269" data-line-number="3269"></td>
        <td id="LC3269">    Module * pModule = (Module *)pResolvedToken-&gt;<span>tokenScope</span>;</td>
      </tr>
      <tr>
        <td id="L3270" data-line-number="3270"></td>
        <td id="LC3270">
</td>
      </tr>
      <tr>
        <td id="L3271" data-line-number="3271"></td>
        <td id="LC3271">    <span>switch</span> (entryKind)</td>
      </tr>
      <tr>
        <td id="L3272" data-line-number="3272"></td>
        <td id="LC3272">    {</td>
      </tr>
      <tr>
        <td id="L3273" data-line-number="3273"></td>
        <td id="LC3273">    <span>case</span> DeclaringTypeHandleSlot:</td>
      </tr>
      <tr>
        <td id="L3274" data-line-number="3274"></td>
        <td id="LC3274">        <span>_ASSERTE</span>(pTemplateMD != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L3275" data-line-number="3275"></td>
        <td id="LC3275">        sigBuilder.<span>AppendElementType</span>(ELEMENT_TYPE_INTERNAL);</td>
      </tr>
      <tr>
        <td id="L3276" data-line-number="3276"></td>
        <td id="LC3276">        sigBuilder.<span>AppendPointer</span>(pTemplateMD-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L3277" data-line-number="3277"></td>
        <td id="LC3277">        <span><span>//</span> fall through</span></td>
      </tr>
      <tr>
        <td id="L3278" data-line-number="3278"></td>
        <td id="LC3278">
</td>
      </tr>
      <tr>
        <td id="L3279" data-line-number="3279"></td>
        <td id="LC3279">    <span>case</span> TypeHandleSlot:</td>
      </tr>
      <tr>
        <td id="L3280" data-line-number="3280"></td>
        <td id="LC3280">        {</td>
      </tr>
      <tr>
        <td id="L3281" data-line-number="3281"></td>
        <td id="LC3281">            <span>if</span> (pResolvedToken-&gt;<span>tokenType</span> == CORINFO_TOKENKIND_Newarr)</td>
      </tr>
      <tr>
        <td id="L3282" data-line-number="3282"></td>
        <td id="LC3282">            {</td>
      </tr>
      <tr>
        <td id="L3283" data-line-number="3283"></td>
        <td id="LC3283">                sigBuilder.<span>AppendElementType</span>(ELEMENT_TYPE_SZARRAY);</td>
      </tr>
      <tr>
        <td id="L3284" data-line-number="3284"></td>
        <td id="LC3284">            }</td>
      </tr>
      <tr>
        <td id="L3285" data-line-number="3285"></td>
        <td id="LC3285">
</td>
      </tr>
      <tr>
        <td id="L3286" data-line-number="3286"></td>
        <td id="LC3286">            <span><span>//</span> Note that we can come here with pResolvedToken-&gt;pTypeSpec == NULL for invalid IL that</span></td>
      </tr>
      <tr>
        <td id="L3287" data-line-number="3287"></td>
        <td id="LC3287">            <span><span>//</span> directly references __Canon</span></td>
      </tr>
      <tr>
        <td id="L3288" data-line-number="3288"></td>
        <td id="LC3288">            <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3289" data-line-number="3289"></td>
        <td id="LC3289">            {</td>
      </tr>
      <tr>
        <td id="L3290" data-line-number="3290"></td>
        <td id="LC3290">                SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L3291" data-line-number="3291"></td>
        <td id="LC3291">                sigptr.<span>ConvertToInternalExactlyOne</span>(pModule, <span>NULL</span>, &amp;sigBuilder);</td>
      </tr>
      <tr>
        <td id="L3292" data-line-number="3292"></td>
        <td id="LC3292">            }</td>
      </tr>
      <tr>
        <td id="L3293" data-line-number="3293"></td>
        <td id="LC3293">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3294" data-line-number="3294"></td>
        <td id="LC3294">            {</td>
      </tr>
      <tr>
        <td id="L3295" data-line-number="3295"></td>
        <td id="LC3295">                sigBuilder.<span>AppendElementType</span>(ELEMENT_TYPE_INTERNAL);</td>
      </tr>
      <tr>
        <td id="L3296" data-line-number="3296"></td>
        <td id="LC3296">                sigBuilder.<span>AppendPointer</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L3297" data-line-number="3297"></td>
        <td id="LC3297">            }</td>
      </tr>
      <tr>
        <td id="L3298" data-line-number="3298"></td>
        <td id="LC3298">        }</td>
      </tr>
      <tr>
        <td id="L3299" data-line-number="3299"></td>
        <td id="LC3299">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L3300" data-line-number="3300"></td>
        <td id="LC3300">
</td>
      </tr>
      <tr>
        <td id="L3301" data-line-number="3301"></td>
        <td id="LC3301">    <span>case</span> ConstrainedMethodEntrySlot:</td>
      </tr>
      <tr>
        <td id="L3302" data-line-number="3302"></td>
        <td id="LC3302">        <span><span>//</span> Encode constrained type token</span></td>
      </tr>
      <tr>
        <td id="L3303" data-line-number="3303"></td>
        <td id="LC3303">        <span>if</span> (pConstrainedResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3304" data-line-number="3304"></td>
        <td id="LC3304">        {</td>
      </tr>
      <tr>
        <td id="L3305" data-line-number="3305"></td>
        <td id="LC3305">            SigPointer <span>sigptr</span>(pConstrainedResolvedToken-&gt;<span>pTypeSpec</span>, pConstrainedResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L3306" data-line-number="3306"></td>
        <td id="LC3306">            sigptr.<span>ConvertToInternalExactlyOne</span>(pModule, <span>NULL</span>, &amp;sigBuilder);</td>
      </tr>
      <tr>
        <td id="L3307" data-line-number="3307"></td>
        <td id="LC3307">        }</td>
      </tr>
      <tr>
        <td id="L3308" data-line-number="3308"></td>
        <td id="LC3308">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L3309" data-line-number="3309"></td>
        <td id="LC3309">        {</td>
      </tr>
      <tr>
        <td id="L3310" data-line-number="3310"></td>
        <td id="LC3310">            sigBuilder.<span>AppendElementType</span>(ELEMENT_TYPE_INTERNAL);</td>
      </tr>
      <tr>
        <td id="L3311" data-line-number="3311"></td>
        <td id="LC3311">            sigBuilder.<span>AppendPointer</span>(pConstrainedResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L3312" data-line-number="3312"></td>
        <td id="LC3312">        }</td>
      </tr>
      <tr>
        <td id="L3313" data-line-number="3313"></td>
        <td id="LC3313">        <span><span>//</span> fall through</span></td>
      </tr>
      <tr>
        <td id="L3314" data-line-number="3314"></td>
        <td id="LC3314">
</td>
      </tr>
      <tr>
        <td id="L3315" data-line-number="3315"></td>
        <td id="LC3315">    <span>case</span> MethodDescSlot:</td>
      </tr>
      <tr>
        <td id="L3316" data-line-number="3316"></td>
        <td id="LC3316">    <span>case</span> MethodEntrySlot:</td>
      </tr>
      <tr>
        <td id="L3317" data-line-number="3317"></td>
        <td id="LC3317">    <span>case</span> DispatchStubAddrSlot:</td>
      </tr>
      <tr>
        <td id="L3318" data-line-number="3318"></td>
        <td id="LC3318">        {</td>
      </tr>
      <tr>
        <td id="L3319" data-line-number="3319"></td>
        <td id="LC3319">            <span><span>//</span> Encode containing type</span></td>
      </tr>
      <tr>
        <td id="L3320" data-line-number="3320"></td>
        <td id="LC3320">            <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3321" data-line-number="3321"></td>
        <td id="LC3321">            {</td>
      </tr>
      <tr>
        <td id="L3322" data-line-number="3322"></td>
        <td id="LC3322">                SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L3323" data-line-number="3323"></td>
        <td id="LC3323">                sigptr.<span>ConvertToInternalExactlyOne</span>(pModule, <span>NULL</span>, &amp;sigBuilder);</td>
      </tr>
      <tr>
        <td id="L3324" data-line-number="3324"></td>
        <td id="LC3324">            }</td>
      </tr>
      <tr>
        <td id="L3325" data-line-number="3325"></td>
        <td id="LC3325">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3326" data-line-number="3326"></td>
        <td id="LC3326">            {</td>
      </tr>
      <tr>
        <td id="L3327" data-line-number="3327"></td>
        <td id="LC3327">                sigBuilder.<span>AppendElementType</span>(ELEMENT_TYPE_INTERNAL);</td>
      </tr>
      <tr>
        <td id="L3328" data-line-number="3328"></td>
        <td id="LC3328">                sigBuilder.<span>AppendPointer</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L3329" data-line-number="3329"></td>
        <td id="LC3329">            }</td>
      </tr>
      <tr>
        <td id="L3330" data-line-number="3330"></td>
        <td id="LC3330">
</td>
      </tr>
      <tr>
        <td id="L3331" data-line-number="3331"></td>
        <td id="LC3331">            <span><span>//</span> Encode method</span></td>
      </tr>
      <tr>
        <td id="L3332" data-line-number="3332"></td>
        <td id="LC3332">            <span>_ASSERTE</span>(pTemplateMD != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L3333" data-line-number="3333"></td>
        <td id="LC3333">
</td>
      </tr>
      <tr>
        <td id="L3334" data-line-number="3334"></td>
        <td id="LC3334">            mdMethodDef methodToken               = pTemplateMD-&gt;<span>GetMemberDef_NoLogging</span>();</td>
      </tr>
      <tr>
        <td id="L3335" data-line-number="3335"></td>
        <td id="LC3335">            DWORD       methodFlags               = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3336" data-line-number="3336"></td>
        <td id="LC3336">
</td>
      </tr>
      <tr>
        <td id="L3337" data-line-number="3337"></td>
        <td id="LC3337">            <span><span>//</span> Check for non-NULL method spec first. We can encode the method instantiation only if we have one in method spec to start with. Note that there are weird cases</span></td>
      </tr>
      <tr>
        <td id="L3338" data-line-number="3338"></td>
        <td id="LC3338">            <span><span>//</span> like instantiating stub for generic method definition that do not have method spec but that won't be caught by the later conditions either.</span></td>
      </tr>
      <tr>
        <td id="L3339" data-line-number="3339"></td>
        <td id="LC3339">            BOOL <span>fMethodNeedsInstantiation</span> = (pResolvedToken-&gt;<span>pMethodSpec</span> != <span>NULL</span>) &amp;&amp; pTemplateMD-&gt;<span>HasMethodInstantiation</span>() &amp;&amp; !pTemplateMD-&gt;<span>IsGenericMethodDefinition</span>();</td>
      </tr>
      <tr>
        <td id="L3340" data-line-number="3340"></td>
        <td id="LC3340">
</td>
      </tr>
      <tr>
        <td id="L3341" data-line-number="3341"></td>
        <td id="LC3341">            <span>if</span> (pTemplateMD-&gt;<span>IsUnboxingStub</span>())</td>
      </tr>
      <tr>
        <td id="L3342" data-line-number="3342"></td>
        <td id="LC3342">                methodFlags |= ENCODE_METHOD_SIG_UnboxingStub;</td>
      </tr>
      <tr>
        <td id="L3343" data-line-number="3343"></td>
        <td id="LC3343">            <span><span>//</span> Always create instantiating stub for method entry points even if the template does not ask for it. It saves caller</span></td>
      </tr>
      <tr>
        <td id="L3344" data-line-number="3344"></td>
        <td id="LC3344">            <span><span>//</span> from creating throw-away instantiating stub.</span></td>
      </tr>
      <tr>
        <td id="L3345" data-line-number="3345"></td>
        <td id="LC3345">            <span>if</span> (pTemplateMD-&gt;<span>IsInstantiatingStub</span>() || (entryKind == MethodEntrySlot))</td>
      </tr>
      <tr>
        <td id="L3346" data-line-number="3346"></td>
        <td id="LC3346">                methodFlags |= ENCODE_METHOD_SIG_InstantiatingStub;</td>
      </tr>
      <tr>
        <td id="L3347" data-line-number="3347"></td>
        <td id="LC3347">            <span>if</span> (<span>fMethodNeedsInstantiation</span>)</td>
      </tr>
      <tr>
        <td id="L3348" data-line-number="3348"></td>
        <td id="LC3348">                methodFlags |= ENCODE_METHOD_SIG_MethodInstantiation;</td>
      </tr>
      <tr>
        <td id="L3349" data-line-number="3349"></td>
        <td id="LC3349">            <span>if</span> (<span>IsNilToken</span>(methodToken))</td>
      </tr>
      <tr>
        <td id="L3350" data-line-number="3350"></td>
        <td id="LC3350">            {</td>
      </tr>
      <tr>
        <td id="L3351" data-line-number="3351"></td>
        <td id="LC3351">                methodFlags |= ENCODE_METHOD_SIG_SlotInsteadOfToken;</td>
      </tr>
      <tr>
        <td id="L3352" data-line-number="3352"></td>
        <td id="LC3352">            }</td>
      </tr>
      <tr>
        <td id="L3353" data-line-number="3353"></td>
        <td id="LC3353">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3354" data-line-number="3354"></td>
        <td id="LC3354">            <span>if</span> (entryKind == DispatchStubAddrSlot &amp;&amp; pTemplateMD-&gt;<span>IsVtableMethod</span>())</td>
      </tr>
      <tr>
        <td id="L3355" data-line-number="3355"></td>
        <td id="LC3355">            {</td>
      </tr>
      <tr>
        <td id="L3356" data-line-number="3356"></td>
        <td id="LC3356">                <span><span>//</span> Encode the method for dispatch stub using slot to avoid touching the interface method MethodDesc at runtime</span></td>
      </tr>
      <tr>
        <td id="L3357" data-line-number="3357"></td>
        <td id="LC3357">
</td>
      </tr>
      <tr>
        <td id="L3358" data-line-number="3358"></td>
        <td id="LC3358">                <span><span>//</span> There should be no other flags set if we are encoding the method using slot for virtual stub dispatch</span></td>
      </tr>
      <tr>
        <td id="L3359" data-line-number="3359"></td>
        <td id="LC3359">                <span>_ASSERTE</span>(methodFlags == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L3360" data-line-number="3360"></td>
        <td id="LC3360">
</td>
      </tr>
      <tr>
        <td id="L3361" data-line-number="3361"></td>
        <td id="LC3361">                methodFlags |= ENCODE_METHOD_SIG_SlotInsteadOfToken;</td>
      </tr>
      <tr>
        <td id="L3362" data-line-number="3362"></td>
        <td id="LC3362">            }</td>
      </tr>
      <tr>
        <td id="L3363" data-line-number="3363"></td>
        <td id="LC3363">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3364" data-line-number="3364"></td>
        <td id="LC3364">            <span>if</span> (!pTemplateMD-&gt;<span>GetModule</span>()-&gt;<span>IsInCurrentVersionBubble</span>())</td>
      </tr>
      <tr>
        <td id="L3365" data-line-number="3365"></td>
        <td id="LC3365">            {</td>
      </tr>
      <tr>
        <td id="L3366" data-line-number="3366"></td>
        <td id="LC3366">                <span><span>//</span> Using a method defined in another version bubble. We can assume the slot number is stable only for real interface methods.</span></td>
      </tr>
      <tr>
        <td id="L3367" data-line-number="3367"></td>
        <td id="LC3367">                <span>if</span> (!pTemplateMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsInterface</span>() || pTemplateMD-&gt;<span>IsStatic</span>() || pTemplateMD-&gt;<span>HasMethodInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L3368" data-line-number="3368"></td>
        <td id="LC3368">                {</td>
      </tr>
      <tr>
        <td id="L3369" data-line-number="3369"></td>
        <td id="LC3369">                    <span>_ASSERTE</span>(!<span><span>"</span>References to non-interface methods not yet supported in version resilient images<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L3370" data-line-number="3370"></td>
        <td id="LC3370">                    <span>IfFailThrow</span>(E_FAIL);</td>
      </tr>
      <tr>
        <td id="L3371" data-line-number="3371"></td>
        <td id="LC3371">                }</td>
      </tr>
      <tr>
        <td id="L3372" data-line-number="3372"></td>
        <td id="LC3372">                methodFlags |= ENCODE_METHOD_SIG_SlotInsteadOfToken;</td>
      </tr>
      <tr>
        <td id="L3373" data-line-number="3373"></td>
        <td id="LC3373">            }</td>
      </tr>
      <tr>
        <td id="L3374" data-line-number="3374"></td>
        <td id="LC3374">
</td>
      </tr>
      <tr>
        <td id="L3375" data-line-number="3375"></td>
        <td id="LC3375">            sigBuilder.<span>AppendData</span>(methodFlags);</td>
      </tr>
      <tr>
        <td id="L3376" data-line-number="3376"></td>
        <td id="LC3376">
</td>
      </tr>
      <tr>
        <td id="L3377" data-line-number="3377"></td>
        <td id="LC3377">            <span>if</span> ((methodFlags &amp; ENCODE_METHOD_SIG_SlotInsteadOfToken) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L3378" data-line-number="3378"></td>
        <td id="LC3378">            {</td>
      </tr>
      <tr>
        <td id="L3379" data-line-number="3379"></td>
        <td id="LC3379">                <span><span>//</span> Encode method token and its module context (as method's type)</span></td>
      </tr>
      <tr>
        <td id="L3380" data-line-number="3380"></td>
        <td id="LC3380">                sigBuilder.<span>AppendElementType</span>(ELEMENT_TYPE_INTERNAL);</td>
      </tr>
      <tr>
        <td id="L3381" data-line-number="3381"></td>
        <td id="LC3381">                sigBuilder.<span>AppendPointer</span>(pTemplateMD-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L3382" data-line-number="3382"></td>
        <td id="LC3382">
</td>
      </tr>
      <tr>
        <td id="L3383" data-line-number="3383"></td>
        <td id="LC3383">                sigBuilder.<span>AppendData</span>(<span>RidFromToken</span>(methodToken));</td>
      </tr>
      <tr>
        <td id="L3384" data-line-number="3384"></td>
        <td id="LC3384">            }</td>
      </tr>
      <tr>
        <td id="L3385" data-line-number="3385"></td>
        <td id="LC3385">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3386" data-line-number="3386"></td>
        <td id="LC3386">            {</td>
      </tr>
      <tr>
        <td id="L3387" data-line-number="3387"></td>
        <td id="LC3387">                sigBuilder.<span>AppendData</span>(pTemplateMD-&gt;<span>GetSlot</span>());</td>
      </tr>
      <tr>
        <td id="L3388" data-line-number="3388"></td>
        <td id="LC3388">            }</td>
      </tr>
      <tr>
        <td id="L3389" data-line-number="3389"></td>
        <td id="LC3389">
</td>
      </tr>
      <tr>
        <td id="L3390" data-line-number="3390"></td>
        <td id="LC3390">            <span>if</span> (<span>fMethodNeedsInstantiation</span>)</td>
      </tr>
      <tr>
        <td id="L3391" data-line-number="3391"></td>
        <td id="LC3391">            {</td>
      </tr>
      <tr>
        <td id="L3392" data-line-number="3392"></td>
        <td id="LC3392">                SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pMethodSpec</span>, pResolvedToken-&gt;<span>cbMethodSpec</span>);</td>
      </tr>
      <tr>
        <td id="L3393" data-line-number="3393"></td>
        <td id="LC3393">
</td>
      </tr>
      <tr>
        <td id="L3394" data-line-number="3394"></td>
        <td id="LC3394">                BYTE etype;</td>
      </tr>
      <tr>
        <td id="L3395" data-line-number="3395"></td>
        <td id="LC3395">                <span>IfFailThrow</span>(sigptr.<span>GetByte</span>(&amp;etype));</td>
      </tr>
      <tr>
        <td id="L3396" data-line-number="3396"></td>
        <td id="LC3396">
</td>
      </tr>
      <tr>
        <td id="L3397" data-line-number="3397"></td>
        <td id="LC3397">                <span><span>//</span> Load the generic method instantiation</span></td>
      </tr>
      <tr>
        <td id="L3398" data-line-number="3398"></td>
        <td id="LC3398">                <span>THROW_BAD_FORMAT_MAYBE</span>(etype == (BYTE)IMAGE_CEE_CS_CALLCONV_GENERICINST, <span>0</span>, pModule);</td>
      </tr>
      <tr>
        <td id="L3399" data-line-number="3399"></td>
        <td id="LC3399">
</td>
      </tr>
      <tr>
        <td id="L3400" data-line-number="3400"></td>
        <td id="LC3400">                DWORD nGenericMethodArgs;</td>
      </tr>
      <tr>
        <td id="L3401" data-line-number="3401"></td>
        <td id="LC3401">                <span>IfFailThrow</span>(sigptr.<span>GetData</span>(&amp;nGenericMethodArgs));</td>
      </tr>
      <tr>
        <td id="L3402" data-line-number="3402"></td>
        <td id="LC3402">                sigBuilder.<span>AppendData</span>(nGenericMethodArgs);</td>
      </tr>
      <tr>
        <td id="L3403" data-line-number="3403"></td>
        <td id="LC3403">
</td>
      </tr>
      <tr>
        <td id="L3404" data-line-number="3404"></td>
        <td id="LC3404">                <span>_ASSERTE</span>(nGenericMethodArgs == pTemplateMD-&gt;<span>GetNumGenericMethodArgs</span>());</td>
      </tr>
      <tr>
        <td id="L3405" data-line-number="3405"></td>
        <td id="LC3405">
</td>
      </tr>
      <tr>
        <td id="L3406" data-line-number="3406"></td>
        <td id="LC3406">                <span>for</span> (DWORD i = <span>0</span>; i &lt; nGenericMethodArgs; i++)</td>
      </tr>
      <tr>
        <td id="L3407" data-line-number="3407"></td>
        <td id="LC3407">                {</td>
      </tr>
      <tr>
        <td id="L3408" data-line-number="3408"></td>
        <td id="LC3408">                    sigptr.<span>ConvertToInternalExactlyOne</span>(pModule, <span>NULL</span>, &amp;sigBuilder);</td>
      </tr>
      <tr>
        <td id="L3409" data-line-number="3409"></td>
        <td id="LC3409">                }</td>
      </tr>
      <tr>
        <td id="L3410" data-line-number="3410"></td>
        <td id="LC3410">            }</td>
      </tr>
      <tr>
        <td id="L3411" data-line-number="3411"></td>
        <td id="LC3411">        }</td>
      </tr>
      <tr>
        <td id="L3412" data-line-number="3412"></td>
        <td id="LC3412">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L3413" data-line-number="3413"></td>
        <td id="LC3413">
</td>
      </tr>
      <tr>
        <td id="L3414" data-line-number="3414"></td>
        <td id="LC3414">    <span>case</span> FieldDescSlot:</td>
      </tr>
      <tr>
        <td id="L3415" data-line-number="3415"></td>
        <td id="LC3415">        {</td>
      </tr>
      <tr>
        <td id="L3416" data-line-number="3416"></td>
        <td id="LC3416">            <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3417" data-line-number="3417"></td>
        <td id="LC3417">            {</td>
      </tr>
      <tr>
        <td id="L3418" data-line-number="3418"></td>
        <td id="LC3418">                 <span><span>//</span> Encode containing type</span></td>
      </tr>
      <tr>
        <td id="L3419" data-line-number="3419"></td>
        <td id="LC3419">                SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L3420" data-line-number="3420"></td>
        <td id="LC3420">                sigptr.<span>ConvertToInternalExactlyOne</span>(pModule, <span>NULL</span>, &amp;sigBuilder);</td>
      </tr>
      <tr>
        <td id="L3421" data-line-number="3421"></td>
        <td id="LC3421">            }</td>
      </tr>
      <tr>
        <td id="L3422" data-line-number="3422"></td>
        <td id="LC3422">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3423" data-line-number="3423"></td>
        <td id="LC3423">            {</td>
      </tr>
      <tr>
        <td id="L3424" data-line-number="3424"></td>
        <td id="LC3424">                sigBuilder.<span>AppendElementType</span>(ELEMENT_TYPE_INTERNAL);</td>
      </tr>
      <tr>
        <td id="L3425" data-line-number="3425"></td>
        <td id="LC3425">                sigBuilder.<span>AppendPointer</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L3426" data-line-number="3426"></td>
        <td id="LC3426">            }</td>
      </tr>
      <tr>
        <td id="L3427" data-line-number="3427"></td>
        <td id="LC3427">
</td>
      </tr>
      <tr>
        <td id="L3428" data-line-number="3428"></td>
        <td id="LC3428">            FieldDesc * pField = (FieldDesc *)pResolvedToken-&gt;<span>hField</span>;</td>
      </tr>
      <tr>
        <td id="L3429" data-line-number="3429"></td>
        <td id="LC3429">            <span>_ASSERTE</span>(pField != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L3430" data-line-number="3430"></td>
        <td id="LC3430">
</td>
      </tr>
      <tr>
        <td id="L3431" data-line-number="3431"></td>
        <td id="LC3431">            DWORD fieldIndex = pField-&gt;<span>GetApproxEnclosingMethodTable</span>()-&gt;<span>GetIndexForFieldDesc</span>(pField);</td>
      </tr>
      <tr>
        <td id="L3432" data-line-number="3432"></td>
        <td id="LC3432">            sigBuilder.<span>AppendData</span>(fieldIndex);</td>
      </tr>
      <tr>
        <td id="L3433" data-line-number="3433"></td>
        <td id="LC3433">        }</td>
      </tr>
      <tr>
        <td id="L3434" data-line-number="3434"></td>
        <td id="LC3434">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L3435" data-line-number="3435"></td>
        <td id="LC3435">
</td>
      </tr>
      <tr>
        <td id="L3436" data-line-number="3436"></td>
        <td id="LC3436">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L3437" data-line-number="3437"></td>
        <td id="LC3437">        <span>_ASSERTE</span>(<span>false</span>);</td>
      </tr>
      <tr>
        <td id="L3438" data-line-number="3438"></td>
        <td id="LC3438">    }</td>
      </tr>
      <tr>
        <td id="L3439" data-line-number="3439"></td>
        <td id="LC3439">
</td>
      </tr>
      <tr>
        <td id="L3440" data-line-number="3440"></td>
        <td id="LC3440">    DictionaryEntrySignatureSource signatureSource = (<span>IsCompilationProcess</span>() ? FromZapImage : FromJIT);</td>
      </tr>
      <tr>
        <td id="L3441" data-line-number="3441"></td>
        <td id="LC3441">
</td>
      </tr>
      <tr>
        <td id="L3442" data-line-number="3442"></td>
        <td id="LC3442">    <span><span>//</span> It's a method dictionary lookup</span></td>
      </tr>
      <tr>
        <td id="L3443" data-line-number="3443"></td>
        <td id="LC3443">    <span>if</span> (pResultLookup-&gt;<span>lookupKind</span>.<span>runtimeLookupKind</span> == CORINFO_LOOKUP_METHODPARAM)</td>
      </tr>
      <tr>
        <td id="L3444" data-line-number="3444"></td>
        <td id="LC3444">    {</td>
      </tr>
      <tr>
        <td id="L3445" data-line-number="3445"></td>
        <td id="LC3445">        <span>_ASSERTE</span>(pContextMD != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L3446" data-line-number="3446"></td>
        <td id="LC3446">        <span>_ASSERTE</span>(pContextMD-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L3447" data-line-number="3447"></td>
        <td id="LC3447">
</td>
      </tr>
      <tr>
        <td id="L3448" data-line-number="3448"></td>
        <td id="LC3448">        <span>if</span> (<span>DictionaryLayout::FindToken</span>(pContextMD-&gt;<span>GetLoaderAllocator</span>(), pContextMD-&gt;<span>GetNumGenericMethodArgs</span>(), pContextMD-&gt;<span>GetDictionaryLayout</span>(), pResult, &amp;sigBuilder, <span>1</span>, signatureSource))</td>
      </tr>
      <tr>
        <td id="L3449" data-line-number="3449"></td>
        <td id="LC3449">        {</td>
      </tr>
      <tr>
        <td id="L3450" data-line-number="3450"></td>
        <td id="LC3450">            pResult-&gt;<span>testForNull</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3451" data-line-number="3451"></td>
        <td id="LC3451">            pResult-&gt;<span>testForFixup</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3452" data-line-number="3452"></td>
        <td id="LC3452">
</td>
      </tr>
      <tr>
        <td id="L3453" data-line-number="3453"></td>
        <td id="LC3453">            <span><span>//</span> Indirect through dictionary table pointer in InstantiatedMethodDesc</span></td>
      </tr>
      <tr>
        <td id="L3454" data-line-number="3454"></td>
        <td id="LC3454">            pResult-&gt;<span>offsets</span>[<span>0</span>] = <span>offsetof</span>(InstantiatedMethodDesc, m_pPerInstInfo);</td>
      </tr>
      <tr>
        <td id="L3455" data-line-number="3455"></td>
        <td id="LC3455">
</td>
      </tr>
      <tr>
        <td id="L3456" data-line-number="3456"></td>
        <td id="LC3456">            <span>if</span> (<span>decltype</span>(InstantiatedMethodDesc::m_pPerInstInfo)::isRelative)</td>
      </tr>
      <tr>
        <td id="L3457" data-line-number="3457"></td>
        <td id="LC3457">            {</td>
      </tr>
      <tr>
        <td id="L3458" data-line-number="3458"></td>
        <td id="LC3458">                pResult-&gt;<span>indirectFirstOffset</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3459" data-line-number="3459"></td>
        <td id="LC3459">            }</td>
      </tr>
      <tr>
        <td id="L3460" data-line-number="3460"></td>
        <td id="LC3460">        }</td>
      </tr>
      <tr>
        <td id="L3461" data-line-number="3461"></td>
        <td id="LC3461">    }</td>
      </tr>
      <tr>
        <td id="L3462" data-line-number="3462"></td>
        <td id="LC3462">
</td>
      </tr>
      <tr>
        <td id="L3463" data-line-number="3463"></td>
        <td id="LC3463">    <span><span>//</span> It's a class dictionary lookup (CORINFO_LOOKUP_CLASSPARAM or CORINFO_LOOKUP_THISOBJ)</span></td>
      </tr>
      <tr>
        <td id="L3464" data-line-number="3464"></td>
        <td id="LC3464">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L3465" data-line-number="3465"></td>
        <td id="LC3465">    {</td>
      </tr>
      <tr>
        <td id="L3466" data-line-number="3466"></td>
        <td id="LC3466">        <span>if</span> (<span>DictionaryLayout::FindToken</span>(pContextMT-&gt;<span>GetLoaderAllocator</span>(), pContextMT-&gt;<span>GetNumGenericArgs</span>(), pContextMT-&gt;<span>GetClass</span>()-&gt;<span>GetDictionaryLayout</span>(), pResult, &amp;sigBuilder, <span>2</span>, signatureSource))</td>
      </tr>
      <tr>
        <td id="L3467" data-line-number="3467"></td>
        <td id="LC3467">        {</td>
      </tr>
      <tr>
        <td id="L3468" data-line-number="3468"></td>
        <td id="LC3468">            pResult-&gt;<span>testForNull</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3469" data-line-number="3469"></td>
        <td id="LC3469">            pResult-&gt;<span>testForFixup</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3470" data-line-number="3470"></td>
        <td id="LC3470">
</td>
      </tr>
      <tr>
        <td id="L3471" data-line-number="3471"></td>
        <td id="LC3471">            <span><span>//</span> Indirect through dictionary table pointer in vtable</span></td>
      </tr>
      <tr>
        <td id="L3472" data-line-number="3472"></td>
        <td id="LC3472">            pResult-&gt;<span>offsets</span>[<span>0</span>] = <span>MethodTable::GetOffsetOfPerInstInfo</span>();</td>
      </tr>
      <tr>
        <td id="L3473" data-line-number="3473"></td>
        <td id="LC3473">
</td>
      </tr>
      <tr>
        <td id="L3474" data-line-number="3474"></td>
        <td id="LC3474">            <span><span>//</span> Next indirect through the dictionary appropriate to this instantiated type</span></td>
      </tr>
      <tr>
        <td id="L3475" data-line-number="3475"></td>
        <td id="LC3475">            pResult-&gt;<span>offsets</span>[<span>1</span>] = <span>sizeof</span>(TypeHandle*) * (pContextMT-&gt;<span>GetNumDicts</span>() - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L3476" data-line-number="3476"></td>
        <td id="LC3476">
</td>
      </tr>
      <tr>
        <td id="L3477" data-line-number="3477"></td>
        <td id="LC3477">            <span>if</span> (<span>MethodTable::IsPerInstInfoRelative</span>())</td>
      </tr>
      <tr>
        <td id="L3478" data-line-number="3478"></td>
        <td id="LC3478">            {</td>
      </tr>
      <tr>
        <td id="L3479" data-line-number="3479"></td>
        <td id="LC3479">                pResult-&gt;<span>indirectFirstOffset</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3480" data-line-number="3480"></td>
        <td id="LC3480">                pResult-&gt;<span>indirectSecondOffset</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L3481" data-line-number="3481"></td>
        <td id="LC3481">            }</td>
      </tr>
      <tr>
        <td id="L3482" data-line-number="3482"></td>
        <td id="LC3482">        }</td>
      </tr>
      <tr>
        <td id="L3483" data-line-number="3483"></td>
        <td id="LC3483">    }</td>
      </tr>
      <tr>
        <td id="L3484" data-line-number="3484"></td>
        <td id="LC3484">}</td>
      </tr>
      <tr>
        <td id="L3485" data-line-number="3485"></td>
        <td id="LC3485">
</td>
      </tr>
      <tr>
        <td id="L3486" data-line-number="3486"></td>
        <td id="LC3486">
</td>
      </tr>
      <tr>
        <td id="L3487" data-line-number="3487"></td>
        <td id="LC3487">
</td>
      </tr>
      <tr>
        <td id="L3488" data-line-number="3488"></td>
        <td id="LC3488"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3489" data-line-number="3489"></td>
        <td id="LC3489"><span>const</span> <span>char</span>* <span>CEEInfo::getClassName</span> (CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L3490" data-line-number="3490"></td>
        <td id="LC3490">{</td>
      </tr>
      <tr>
        <td id="L3491" data-line-number="3491"></td>
        <td id="LC3491">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3492" data-line-number="3492"></td>
        <td id="LC3492">        THROWS;</td>
      </tr>
      <tr>
        <td id="L3493" data-line-number="3493"></td>
        <td id="LC3493">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L3494" data-line-number="3494"></td>
        <td id="LC3494">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3495" data-line-number="3495"></td>
        <td id="LC3495">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3496" data-line-number="3496"></td>
        <td id="LC3496">
</td>
      </tr>
      <tr>
        <td id="L3497" data-line-number="3497"></td>
        <td id="LC3497">    <span>const</span> <span>char</span>* result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3498" data-line-number="3498"></td>
        <td id="LC3498">
</td>
      </tr>
      <tr>
        <td id="L3499" data-line-number="3499"></td>
        <td id="LC3499">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3500" data-line-number="3500"></td>
        <td id="LC3500">
</td>
      </tr>
      <tr>
        <td id="L3501" data-line-number="3501"></td>
        <td id="LC3501">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3502" data-line-number="3502"></td>
        <td id="LC3502">    MethodTable* pMT = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L3503" data-line-number="3503"></td>
        <td id="LC3503">    <span>if</span> (pMT == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3504" data-line-number="3504"></td>
        <td id="LC3504">    {</td>
      </tr>
      <tr>
        <td id="L3505" data-line-number="3505"></td>
        <td id="LC3505">        result = <span><span>"</span><span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L3506" data-line-number="3506"></td>
        <td id="LC3506">    }</td>
      </tr>
      <tr>
        <td id="L3507" data-line-number="3507"></td>
        <td id="LC3507">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L3508" data-line-number="3508"></td>
        <td id="LC3508">    {</td>
      </tr>
      <tr>
        <td id="L3509" data-line-number="3509"></td>
        <td id="LC3509">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L3510" data-line-number="3510"></td>
        <td id="LC3510">        result = pMT-&gt;<span>GetDebugClassName</span>();</td>
      </tr>
      <tr>
        <td id="L3511" data-line-number="3511"></td>
        <td id="LC3511">#<span>else</span> <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L3512" data-line-number="3512"></td>
        <td id="LC3512">        <span><span>//</span> since this is for diagnostic purposes only,</span></td>
      </tr>
      <tr>
        <td id="L3513" data-line-number="3513"></td>
        <td id="LC3513">        <span><span>//</span> give up on the namespace, as we don't have a buffer to concat it</span></td>
      </tr>
      <tr>
        <td id="L3514" data-line-number="3514"></td>
        <td id="LC3514">        <span><span>//</span> also note this won't show array class names.</span></td>
      </tr>
      <tr>
        <td id="L3515" data-line-number="3515"></td>
        <td id="LC3515">        LPCUTF8 nameSpace;</td>
      </tr>
      <tr>
        <td id="L3516" data-line-number="3516"></td>
        <td id="LC3516">        result = pMT-&gt;<span>GetFullyQualifiedNameInfo</span>(&amp;nameSpace);</td>
      </tr>
      <tr>
        <td id="L3517" data-line-number="3517"></td>
        <td id="LC3517">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L3518" data-line-number="3518"></td>
        <td id="LC3518">    }</td>
      </tr>
      <tr>
        <td id="L3519" data-line-number="3519"></td>
        <td id="LC3519">
</td>
      </tr>
      <tr>
        <td id="L3520" data-line-number="3520"></td>
        <td id="LC3520">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3521" data-line-number="3521"></td>
        <td id="LC3521">
</td>
      </tr>
      <tr>
        <td id="L3522" data-line-number="3522"></td>
        <td id="LC3522">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L3523" data-line-number="3523"></td>
        <td id="LC3523">}</td>
      </tr>
      <tr>
        <td id="L3524" data-line-number="3524"></td>
        <td id="LC3524">
</td>
      </tr>
      <tr>
        <td id="L3525" data-line-number="3525"></td>
        <td id="LC3525"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3526" data-line-number="3526"></td>
        <td id="LC3526"><span>const</span> <span>char</span>* <span>CEEInfo::getHelperName</span> (CorInfoHelpFunc ftnNum)</td>
      </tr>
      <tr>
        <td id="L3527" data-line-number="3527"></td>
        <td id="LC3527">{</td>
      </tr>
      <tr>
        <td id="L3528" data-line-number="3528"></td>
        <td id="LC3528">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3529" data-line-number="3529"></td>
        <td id="LC3529">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L3530" data-line-number="3530"></td>
        <td id="LC3530">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L3531" data-line-number="3531"></td>
        <td id="LC3531">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3532" data-line-number="3532"></td>
        <td id="LC3532">        <span>PRECONDITION</span>(ftnNum &gt;= <span>0</span> &amp;&amp; ftnNum &lt; CORINFO_HELP_COUNT);</td>
      </tr>
      <tr>
        <td id="L3533" data-line-number="3533"></td>
        <td id="LC3533">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3534" data-line-number="3534"></td>
        <td id="LC3534">
</td>
      </tr>
      <tr>
        <td id="L3535" data-line-number="3535"></td>
        <td id="LC3535">    <span>const</span> <span>char</span>* result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3536" data-line-number="3536"></td>
        <td id="LC3536">
</td>
      </tr>
      <tr>
        <td id="L3537" data-line-number="3537"></td>
        <td id="LC3537">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3538" data-line-number="3538"></td>
        <td id="LC3538">
</td>
      </tr>
      <tr>
        <td id="L3539" data-line-number="3539"></td>
        <td id="LC3539">#<span>ifdef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L3540" data-line-number="3540"></td>
        <td id="LC3540">    result = hlpNameTable[ftnNum];</td>
      </tr>
      <tr>
        <td id="L3541" data-line-number="3541"></td>
        <td id="LC3541">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L3542" data-line-number="3542"></td>
        <td id="LC3542">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L3543" data-line-number="3543"></td>
        <td id="LC3543">    result = hlpFuncTable[ftnNum].<span>name</span>;</td>
      </tr>
      <tr>
        <td id="L3544" data-line-number="3544"></td>
        <td id="LC3544">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L3545" data-line-number="3545"></td>
        <td id="LC3545">    result = <span><span>"</span>AnyJITHelper<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L3546" data-line-number="3546"></td>
        <td id="LC3546">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L3547" data-line-number="3547"></td>
        <td id="LC3547">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L3548" data-line-number="3548"></td>
        <td id="LC3548">
</td>
      </tr>
      <tr>
        <td id="L3549" data-line-number="3549"></td>
        <td id="LC3549">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3550" data-line-number="3550"></td>
        <td id="LC3550">
</td>
      </tr>
      <tr>
        <td id="L3551" data-line-number="3551"></td>
        <td id="LC3551">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L3552" data-line-number="3552"></td>
        <td id="LC3552">}</td>
      </tr>
      <tr>
        <td id="L3553" data-line-number="3553"></td>
        <td id="LC3553">
</td>
      </tr>
      <tr>
        <td id="L3554" data-line-number="3554"></td>
        <td id="LC3554">
</td>
      </tr>
      <tr>
        <td id="L3555" data-line-number="3555"></td>
        <td id="LC3555"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3556" data-line-number="3556"></td>
        <td id="LC3556"><span>int</span> <span>CEEInfo::appendClassName</span>(__deref_inout_ecount(*pnBufLen) WCHAR** ppBuf,</td>
      </tr>
      <tr>
        <td id="L3557" data-line-number="3557"></td>
        <td id="LC3557">                             int* pnBufLen,</td>
      </tr>
      <tr>
        <td id="L3558" data-line-number="3558"></td>
        <td id="LC3558">                             CORINFO_CLASS_HANDLE    clsHnd,</td>
      </tr>
      <tr>
        <td id="L3559" data-line-number="3559"></td>
        <td id="LC3559">                             BOOL fNamespace,</td>
      </tr>
      <tr>
        <td id="L3560" data-line-number="3560"></td>
        <td id="LC3560">                             BOOL fFullInst,</td>
      </tr>
      <tr>
        <td id="L3561" data-line-number="3561"></td>
        <td id="LC3561">                             BOOL fAssembly)</td>
      </tr>
      <tr>
        <td id="L3562" data-line-number="3562"></td>
        <td id="LC3562">{</td>
      </tr>
      <tr>
        <td id="L3563" data-line-number="3563"></td>
        <td id="LC3563">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3564" data-line-number="3564"></td>
        <td id="LC3564">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3565" data-line-number="3565"></td>
        <td id="LC3565">        THROWS;</td>
      </tr>
      <tr>
        <td id="L3566" data-line-number="3566"></td>
        <td id="LC3566">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L3567" data-line-number="3567"></td>
        <td id="LC3567">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3568" data-line-number="3568"></td>
        <td id="LC3568">
</td>
      </tr>
      <tr>
        <td id="L3569" data-line-number="3569"></td>
        <td id="LC3569">    <span>int</span> nLen = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3570" data-line-number="3570"></td>
        <td id="LC3570">
</td>
      </tr>
      <tr>
        <td id="L3571" data-line-number="3571"></td>
        <td id="LC3571">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3572" data-line-number="3572"></td>
        <td id="LC3572">
</td>
      </tr>
      <tr>
        <td id="L3573" data-line-number="3573"></td>
        <td id="LC3573">    TypeHandle <span>th</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3574" data-line-number="3574"></td>
        <td id="LC3574">    StackSString ss;</td>
      </tr>
      <tr>
        <td id="L3575" data-line-number="3575"></td>
        <td id="LC3575">    <span>TypeString::AppendType</span>(ss,th,</td>
      </tr>
      <tr>
        <td id="L3576" data-line-number="3576"></td>
        <td id="LC3576">                           (<span>fNamespace</span> ? TypeString::FormatNamespace : <span>0</span>) |</td>
      </tr>
      <tr>
        <td id="L3577" data-line-number="3577"></td>
        <td id="LC3577">                           (<span>fFullInst</span> ? TypeString::FormatFullInst : <span>0</span>) |</td>
      </tr>
      <tr>
        <td id="L3578" data-line-number="3578"></td>
        <td id="LC3578">                           (<span>fAssembly</span> ? TypeString::FormatAssembly : <span>0</span>));</td>
      </tr>
      <tr>
        <td id="L3579" data-line-number="3579"></td>
        <td id="LC3579">    <span>const</span> WCHAR* szString = ss.<span>GetUnicode</span>();</td>
      </tr>
      <tr>
        <td id="L3580" data-line-number="3580"></td>
        <td id="LC3580">    nLen = (<span>int</span>)<span>wcslen</span>(szString);</td>
      </tr>
      <tr>
        <td id="L3581" data-line-number="3581"></td>
        <td id="LC3581">    <span>if</span> (*pnBufLen &gt; <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L3582" data-line-number="3582"></td>
        <td id="LC3582">    {</td>
      </tr>
      <tr>
        <td id="L3583" data-line-number="3583"></td>
        <td id="LC3583">    <span>wcscpy_s</span>(*ppBuf, *pnBufLen, szString );</td>
      </tr>
      <tr>
        <td id="L3584" data-line-number="3584"></td>
        <td id="LC3584">    (*ppBuf)[(*pnBufLen) - <span>1</span>] = <span>W</span>(<span><span>'</span><span>\0</span><span>'</span></span>);</td>
      </tr>
      <tr>
        <td id="L3585" data-line-number="3585"></td>
        <td id="LC3585">    (*ppBuf) += nLen;</td>
      </tr>
      <tr>
        <td id="L3586" data-line-number="3586"></td>
        <td id="LC3586">    (*pnBufLen) -= nLen;</td>
      </tr>
      <tr>
        <td id="L3587" data-line-number="3587"></td>
        <td id="LC3587">    }</td>
      </tr>
      <tr>
        <td id="L3588" data-line-number="3588"></td>
        <td id="LC3588">
</td>
      </tr>
      <tr>
        <td id="L3589" data-line-number="3589"></td>
        <td id="LC3589">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3590" data-line-number="3590"></td>
        <td id="LC3590">
</td>
      </tr>
      <tr>
        <td id="L3591" data-line-number="3591"></td>
        <td id="LC3591">    <span>return</span> nLen;</td>
      </tr>
      <tr>
        <td id="L3592" data-line-number="3592"></td>
        <td id="LC3592">}</td>
      </tr>
      <tr>
        <td id="L3593" data-line-number="3593"></td>
        <td id="LC3593">
</td>
      </tr>
      <tr>
        <td id="L3594" data-line-number="3594"></td>
        <td id="LC3594"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3595" data-line-number="3595"></td>
        <td id="LC3595">CORINFO_MODULE_HANDLE <span>CEEInfo::getClassModule</span>(CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L3596" data-line-number="3596"></td>
        <td id="LC3596">{</td>
      </tr>
      <tr>
        <td id="L3597" data-line-number="3597"></td>
        <td id="LC3597">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3598" data-line-number="3598"></td>
        <td id="LC3598">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L3599" data-line-number="3599"></td>
        <td id="LC3599">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L3600" data-line-number="3600"></td>
        <td id="LC3600">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3601" data-line-number="3601"></td>
        <td id="LC3601">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3602" data-line-number="3602"></td>
        <td id="LC3602">
</td>
      </tr>
      <tr>
        <td id="L3603" data-line-number="3603"></td>
        <td id="LC3603">    CORINFO_MODULE_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3604" data-line-number="3604"></td>
        <td id="LC3604">
</td>
      </tr>
      <tr>
        <td id="L3605" data-line-number="3605"></td>
        <td id="LC3605">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3606" data-line-number="3606"></td>
        <td id="LC3606">
</td>
      </tr>
      <tr>
        <td id="L3607" data-line-number="3607"></td>
        <td id="LC3607">    TypeHandle     <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3608" data-line-number="3608"></td>
        <td id="LC3608">
</td>
      </tr>
      <tr>
        <td id="L3609" data-line-number="3609"></td>
        <td id="LC3609">    result = <span>CORINFO_MODULE_HANDLE</span>(VMClsHnd.<span>GetModule</span>());</td>
      </tr>
      <tr>
        <td id="L3610" data-line-number="3610"></td>
        <td id="LC3610">
</td>
      </tr>
      <tr>
        <td id="L3611" data-line-number="3611"></td>
        <td id="LC3611">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3612" data-line-number="3612"></td>
        <td id="LC3612">
</td>
      </tr>
      <tr>
        <td id="L3613" data-line-number="3613"></td>
        <td id="LC3613">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L3614" data-line-number="3614"></td>
        <td id="LC3614">}</td>
      </tr>
      <tr>
        <td id="L3615" data-line-number="3615"></td>
        <td id="LC3615">
</td>
      </tr>
      <tr>
        <td id="L3616" data-line-number="3616"></td>
        <td id="LC3616"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3617" data-line-number="3617"></td>
        <td id="LC3617">CORINFO_ASSEMBLY_HANDLE <span>CEEInfo::getModuleAssembly</span>(CORINFO_MODULE_HANDLE modHnd)</td>
      </tr>
      <tr>
        <td id="L3618" data-line-number="3618"></td>
        <td id="LC3618">{</td>
      </tr>
      <tr>
        <td id="L3619" data-line-number="3619"></td>
        <td id="LC3619">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3620" data-line-number="3620"></td>
        <td id="LC3620">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L3621" data-line-number="3621"></td>
        <td id="LC3621">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L3622" data-line-number="3622"></td>
        <td id="LC3622">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3623" data-line-number="3623"></td>
        <td id="LC3623">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3624" data-line-number="3624"></td>
        <td id="LC3624">
</td>
      </tr>
      <tr>
        <td id="L3625" data-line-number="3625"></td>
        <td id="LC3625">    CORINFO_ASSEMBLY_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3626" data-line-number="3626"></td>
        <td id="LC3626">
</td>
      </tr>
      <tr>
        <td id="L3627" data-line-number="3627"></td>
        <td id="LC3627">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3628" data-line-number="3628"></td>
        <td id="LC3628">
</td>
      </tr>
      <tr>
        <td id="L3629" data-line-number="3629"></td>
        <td id="LC3629">    result = <span>CORINFO_ASSEMBLY_HANDLE</span>(<span>GetModule</span>(modHnd)-&gt;<span>GetAssembly</span>());</td>
      </tr>
      <tr>
        <td id="L3630" data-line-number="3630"></td>
        <td id="LC3630">
</td>
      </tr>
      <tr>
        <td id="L3631" data-line-number="3631"></td>
        <td id="LC3631">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3632" data-line-number="3632"></td>
        <td id="LC3632">
</td>
      </tr>
      <tr>
        <td id="L3633" data-line-number="3633"></td>
        <td id="LC3633">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L3634" data-line-number="3634"></td>
        <td id="LC3634">}</td>
      </tr>
      <tr>
        <td id="L3635" data-line-number="3635"></td>
        <td id="LC3635">
</td>
      </tr>
      <tr>
        <td id="L3636" data-line-number="3636"></td>
        <td id="LC3636"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3637" data-line-number="3637"></td>
        <td id="LC3637"><span>const</span> <span>char</span>* <span>CEEInfo::getAssemblyName</span>(CORINFO_ASSEMBLY_HANDLE asmHnd)</td>
      </tr>
      <tr>
        <td id="L3638" data-line-number="3638"></td>
        <td id="LC3638">{</td>
      </tr>
      <tr>
        <td id="L3639" data-line-number="3639"></td>
        <td id="LC3639">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3640" data-line-number="3640"></td>
        <td id="LC3640">        THROWS;</td>
      </tr>
      <tr>
        <td id="L3641" data-line-number="3641"></td>
        <td id="LC3641">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L3642" data-line-number="3642"></td>
        <td id="LC3642">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3643" data-line-number="3643"></td>
        <td id="LC3643">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3644" data-line-number="3644"></td>
        <td id="LC3644">
</td>
      </tr>
      <tr>
        <td id="L3645" data-line-number="3645"></td>
        <td id="LC3645">    <span>const</span> <span>char</span>*  result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3646" data-line-number="3646"></td>
        <td id="LC3646">
</td>
      </tr>
      <tr>
        <td id="L3647" data-line-number="3647"></td>
        <td id="LC3647">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3648" data-line-number="3648"></td>
        <td id="LC3648">    result = ((Assembly*)asmHnd)-&gt;<span>GetSimpleName</span>();</td>
      </tr>
      <tr>
        <td id="L3649" data-line-number="3649"></td>
        <td id="LC3649">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3650" data-line-number="3650"></td>
        <td id="LC3650">
</td>
      </tr>
      <tr>
        <td id="L3651" data-line-number="3651"></td>
        <td id="LC3651">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L3652" data-line-number="3652"></td>
        <td id="LC3652">}</td>
      </tr>
      <tr>
        <td id="L3653" data-line-number="3653"></td>
        <td id="LC3653">
</td>
      </tr>
      <tr>
        <td id="L3654" data-line-number="3654"></td>
        <td id="LC3654"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3655" data-line-number="3655"></td>
        <td id="LC3655"><span>void</span>* <span>CEEInfo::LongLifetimeMalloc</span>(<span>size_t</span> sz)</td>
      </tr>
      <tr>
        <td id="L3656" data-line-number="3656"></td>
        <td id="LC3656">{</td>
      </tr>
      <tr>
        <td id="L3657" data-line-number="3657"></td>
        <td id="LC3657">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3658" data-line-number="3658"></td>
        <td id="LC3658">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L3659" data-line-number="3659"></td>
        <td id="LC3659">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L3660" data-line-number="3660"></td>
        <td id="LC3660">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3661" data-line-number="3661"></td>
        <td id="LC3661">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3662" data-line-number="3662"></td>
        <td id="LC3662">
</td>
      </tr>
      <tr>
        <td id="L3663" data-line-number="3663"></td>
        <td id="LC3663">    <span>void</span>*  result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3664" data-line-number="3664"></td>
        <td id="LC3664">
</td>
      </tr>
      <tr>
        <td id="L3665" data-line-number="3665"></td>
        <td id="LC3665">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3666" data-line-number="3666"></td>
        <td id="LC3666">    result = <span>new</span> (nothrow) <span>char</span>[sz];</td>
      </tr>
      <tr>
        <td id="L3667" data-line-number="3667"></td>
        <td id="LC3667">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3668" data-line-number="3668"></td>
        <td id="LC3668">
</td>
      </tr>
      <tr>
        <td id="L3669" data-line-number="3669"></td>
        <td id="LC3669">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L3670" data-line-number="3670"></td>
        <td id="LC3670">}</td>
      </tr>
      <tr>
        <td id="L3671" data-line-number="3671"></td>
        <td id="LC3671">
</td>
      </tr>
      <tr>
        <td id="L3672" data-line-number="3672"></td>
        <td id="LC3672"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3673" data-line-number="3673"></td>
        <td id="LC3673"><span>void</span> <span>CEEInfo::LongLifetimeFree</span>(<span>void</span>* obj)</td>
      </tr>
      <tr>
        <td id="L3674" data-line-number="3674"></td>
        <td id="LC3674">{</td>
      </tr>
      <tr>
        <td id="L3675" data-line-number="3675"></td>
        <td id="LC3675">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3676" data-line-number="3676"></td>
        <td id="LC3676">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L3677" data-line-number="3677"></td>
        <td id="LC3677">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L3678" data-line-number="3678"></td>
        <td id="LC3678">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3679" data-line-number="3679"></td>
        <td id="LC3679">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3680" data-line-number="3680"></td>
        <td id="LC3680">
</td>
      </tr>
      <tr>
        <td id="L3681" data-line-number="3681"></td>
        <td id="LC3681">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3682" data-line-number="3682"></td>
        <td id="LC3682">    (<span>operator</span> <span>delete</span>)(obj);</td>
      </tr>
      <tr>
        <td id="L3683" data-line-number="3683"></td>
        <td id="LC3683">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3684" data-line-number="3684"></td>
        <td id="LC3684">}</td>
      </tr>
      <tr>
        <td id="L3685" data-line-number="3685"></td>
        <td id="LC3685">
</td>
      </tr>
      <tr>
        <td id="L3686" data-line-number="3686"></td>
        <td id="LC3686"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3687" data-line-number="3687"></td>
        <td id="LC3687"><span>size_t</span> <span>CEEInfo::getClassModuleIdForStatics</span>(CORINFO_CLASS_HANDLE clsHnd, CORINFO_MODULE_HANDLE *pModuleHandle, <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L3688" data-line-number="3688"></td>
        <td id="LC3688">{</td>
      </tr>
      <tr>
        <td id="L3689" data-line-number="3689"></td>
        <td id="LC3689">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3690" data-line-number="3690"></td>
        <td id="LC3690">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L3691" data-line-number="3691"></td>
        <td id="LC3691">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L3692" data-line-number="3692"></td>
        <td id="LC3692">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3693" data-line-number="3693"></td>
        <td id="LC3693">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3694" data-line-number="3694"></td>
        <td id="LC3694">
</td>
      </tr>
      <tr>
        <td id="L3695" data-line-number="3695"></td>
        <td id="LC3695">    <span>size_t</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3696" data-line-number="3696"></td>
        <td id="LC3696">
</td>
      </tr>
      <tr>
        <td id="L3697" data-line-number="3697"></td>
        <td id="LC3697">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3698" data-line-number="3698"></td>
        <td id="LC3698">
</td>
      </tr>
      <tr>
        <td id="L3699" data-line-number="3699"></td>
        <td id="LC3699">    TypeHandle     <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3700" data-line-number="3700"></td>
        <td id="LC3700">    Module *pModule = VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>GetModuleForStatics</span>();</td>
      </tr>
      <tr>
        <td id="L3701" data-line-number="3701"></td>
        <td id="LC3701">
</td>
      </tr>
      <tr>
        <td id="L3702" data-line-number="3702"></td>
        <td id="LC3702">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3703" data-line-number="3703"></td>
        <td id="LC3703">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L3704" data-line-number="3704"></td>
        <td id="LC3704">
</td>
      </tr>
      <tr>
        <td id="L3705" data-line-number="3705"></td>
        <td id="LC3705">    <span><span>//</span> The zapper needs the module handle. The jit should not use it at all.</span></td>
      </tr>
      <tr>
        <td id="L3706" data-line-number="3706"></td>
        <td id="LC3706">    <span>if</span> (pModuleHandle)</td>
      </tr>
      <tr>
        <td id="L3707" data-line-number="3707"></td>
        <td id="LC3707">        *pModuleHandle = <span>CORINFO_MODULE_HANDLE</span>(pModule);</td>
      </tr>
      <tr>
        <td id="L3708" data-line-number="3708"></td>
        <td id="LC3708">
</td>
      </tr>
      <tr>
        <td id="L3709" data-line-number="3709"></td>
        <td id="LC3709">    result = pModule-&gt;<span>GetModuleID</span>();</td>
      </tr>
      <tr>
        <td id="L3710" data-line-number="3710"></td>
        <td id="LC3710">
</td>
      </tr>
      <tr>
        <td id="L3711" data-line-number="3711"></td>
        <td id="LC3711">    <span>_ASSERTE</span>(result);</td>
      </tr>
      <tr>
        <td id="L3712" data-line-number="3712"></td>
        <td id="LC3712">
</td>
      </tr>
      <tr>
        <td id="L3713" data-line-number="3713"></td>
        <td id="LC3713">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3714" data-line-number="3714"></td>
        <td id="LC3714">
</td>
      </tr>
      <tr>
        <td id="L3715" data-line-number="3715"></td>
        <td id="LC3715">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L3716" data-line-number="3716"></td>
        <td id="LC3716">}</td>
      </tr>
      <tr>
        <td id="L3717" data-line-number="3717"></td>
        <td id="LC3717">
</td>
      </tr>
      <tr>
        <td id="L3718" data-line-number="3718"></td>
        <td id="LC3718"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3719" data-line-number="3719"></td>
        <td id="LC3719">BOOL <span>CEEInfo::isValueClass</span>(CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L3720" data-line-number="3720"></td>
        <td id="LC3720">{</td>
      </tr>
      <tr>
        <td id="L3721" data-line-number="3721"></td>
        <td id="LC3721">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3722" data-line-number="3722"></td>
        <td id="LC3722">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L3723" data-line-number="3723"></td>
        <td id="LC3723">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L3724" data-line-number="3724"></td>
        <td id="LC3724">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3725" data-line-number="3725"></td>
        <td id="LC3725">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3726" data-line-number="3726"></td>
        <td id="LC3726">
</td>
      </tr>
      <tr>
        <td id="L3727" data-line-number="3727"></td>
        <td id="LC3727">    BOOL ret = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L3728" data-line-number="3728"></td>
        <td id="LC3728">
</td>
      </tr>
      <tr>
        <td id="L3729" data-line-number="3729"></td>
        <td id="LC3729">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3730" data-line-number="3730"></td>
        <td id="LC3730">
</td>
      </tr>
      <tr>
        <td id="L3731" data-line-number="3731"></td>
        <td id="LC3731">    <span>_ASSERTE</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3732" data-line-number="3732"></td>
        <td id="LC3732">
</td>
      </tr>
      <tr>
        <td id="L3733" data-line-number="3733"></td>
        <td id="LC3733">    <span><span>//</span> Note that clsHnd.IsValueType() would not return what the JIT expects</span></td>
      </tr>
      <tr>
        <td id="L3734" data-line-number="3734"></td>
        <td id="LC3734">    <span><span>//</span> for corner cases like ELEMENT_TYPE_FNPTR</span></td>
      </tr>
      <tr>
        <td id="L3735" data-line-number="3735"></td>
        <td id="LC3735">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3736" data-line-number="3736"></td>
        <td id="LC3736">    MethodTable * pMT = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L3737" data-line-number="3737"></td>
        <td id="LC3737">    ret = (pMT != <span>NULL</span>) ? pMT-&gt;<span>IsValueType</span>() : <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3738" data-line-number="3738"></td>
        <td id="LC3738">
</td>
      </tr>
      <tr>
        <td id="L3739" data-line-number="3739"></td>
        <td id="LC3739">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3740" data-line-number="3740"></td>
        <td id="LC3740">
</td>
      </tr>
      <tr>
        <td id="L3741" data-line-number="3741"></td>
        <td id="LC3741">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L3742" data-line-number="3742"></td>
        <td id="LC3742">}</td>
      </tr>
      <tr>
        <td id="L3743" data-line-number="3743"></td>
        <td id="LC3743">
</td>
      </tr>
      <tr>
        <td id="L3744" data-line-number="3744"></td>
        <td id="LC3744"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3745" data-line-number="3745"></td>
        <td id="LC3745"><span><span>//</span> Decides how the JIT should do the optimization to inline the check for</span></td>
      </tr>
      <tr>
        <td id="L3746" data-line-number="3746"></td>
        <td id="LC3746"><span><span>//</span>     GetTypeFromHandle(handle) == obj.GetType()</span></td>
      </tr>
      <tr>
        <td id="L3747" data-line-number="3747"></td>
        <td id="LC3747"><span><span>//</span>     GetTypeFromHandle(X) == GetTypeFromHandle(Y)</span></td>
      </tr>
      <tr>
        <td id="L3748" data-line-number="3748"></td>
        <td id="LC3748"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L3749" data-line-number="3749"></td>
        <td id="LC3749"><span><span>//</span> This will enable to use directly the typehandle instead of going through getClassByHandle</span></td>
      </tr>
      <tr>
        <td id="L3750" data-line-number="3750"></td>
        <td id="LC3750">CorInfoInlineTypeCheck <span>CEEInfo::canInlineTypeCheck</span>(CORINFO_CLASS_HANDLE clsHnd, CorInfoInlineTypeCheckSource source)</td>
      </tr>
      <tr>
        <td id="L3751" data-line-number="3751"></td>
        <td id="LC3751">{</td>
      </tr>
      <tr>
        <td id="L3752" data-line-number="3752"></td>
        <td id="LC3752">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L3753" data-line-number="3753"></td>
        <td id="LC3753">    <span>return</span> CORINFO_INLINE_TYPECHECK_PASS;</td>
      </tr>
      <tr>
        <td id="L3754" data-line-number="3754"></td>
        <td id="LC3754">}</td>
      </tr>
      <tr>
        <td id="L3755" data-line-number="3755"></td>
        <td id="LC3755">
</td>
      </tr>
      <tr>
        <td id="L3756" data-line-number="3756"></td>
        <td id="LC3756"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3757" data-line-number="3757"></td>
        <td id="LC3757"><span><span>//</span> If this method returns true, JIT will do optimization to inline the check for</span></td>
      </tr>
      <tr>
        <td id="L3758" data-line-number="3758"></td>
        <td id="LC3758"><span><span>//</span>     GetTypeFromHandle(handle) == obj.GetType()</span></td>
      </tr>
      <tr>
        <td id="L3759" data-line-number="3759"></td>
        <td id="LC3759"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L3760" data-line-number="3760"></td>
        <td id="LC3760"><span><span>//</span> This will enable to use directly the typehandle instead of going through getClassByHandle</span></td>
      </tr>
      <tr>
        <td id="L3761" data-line-number="3761"></td>
        <td id="LC3761">BOOL <span>CEEInfo::canInlineTypeCheckWithObjectVTable</span> (CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L3762" data-line-number="3762"></td>
        <td id="LC3762">{</td>
      </tr>
      <tr>
        <td id="L3763" data-line-number="3763"></td>
        <td id="LC3763">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L3764" data-line-number="3764"></td>
        <td id="LC3764">    <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L3765" data-line-number="3765"></td>
        <td id="LC3765">}</td>
      </tr>
      <tr>
        <td id="L3766" data-line-number="3766"></td>
        <td id="LC3766">
</td>
      </tr>
      <tr>
        <td id="L3767" data-line-number="3767"></td>
        <td id="LC3767"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3768" data-line-number="3768"></td>
        <td id="LC3768">DWORD <span>CEEInfo::getClassAttribs</span> (CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L3769" data-line-number="3769"></td>
        <td id="LC3769">{</td>
      </tr>
      <tr>
        <td id="L3770" data-line-number="3770"></td>
        <td id="LC3770">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3771" data-line-number="3771"></td>
        <td id="LC3771">        THROWS;</td>
      </tr>
      <tr>
        <td id="L3772" data-line-number="3772"></td>
        <td id="LC3772">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L3773" data-line-number="3773"></td>
        <td id="LC3773">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3774" data-line-number="3774"></td>
        <td id="LC3774">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3775" data-line-number="3775"></td>
        <td id="LC3775">
</td>
      </tr>
      <tr>
        <td id="L3776" data-line-number="3776"></td>
        <td id="LC3776">    <span><span>//</span> &lt;REVISIT_TODO&gt;@todo FIX need to really fetch the class atributes.  at present</span></td>
      </tr>
      <tr>
        <td id="L3777" data-line-number="3777"></td>
        <td id="LC3777">    <span><span>//</span> we don't need to because the JIT only cares in the case of COM classes&lt;/REVISIT_TODO&gt;</span></td>
      </tr>
      <tr>
        <td id="L3778" data-line-number="3778"></td>
        <td id="LC3778">    DWORD ret = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3779" data-line-number="3779"></td>
        <td id="LC3779">
</td>
      </tr>
      <tr>
        <td id="L3780" data-line-number="3780"></td>
        <td id="LC3780">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3781" data-line-number="3781"></td>
        <td id="LC3781">
</td>
      </tr>
      <tr>
        <td id="L3782" data-line-number="3782"></td>
        <td id="LC3782">    ret = <span>getClassAttribsInternal</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3783" data-line-number="3783"></td>
        <td id="LC3783">
</td>
      </tr>
      <tr>
        <td id="L3784" data-line-number="3784"></td>
        <td id="LC3784">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3785" data-line-number="3785"></td>
        <td id="LC3785">
</td>
      </tr>
      <tr>
        <td id="L3786" data-line-number="3786"></td>
        <td id="LC3786">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L3787" data-line-number="3787"></td>
        <td id="LC3787">}</td>
      </tr>
      <tr>
        <td id="L3788" data-line-number="3788"></td>
        <td id="LC3788">
</td>
      </tr>
      <tr>
        <td id="L3789" data-line-number="3789"></td>
        <td id="LC3789">
</td>
      </tr>
      <tr>
        <td id="L3790" data-line-number="3790"></td>
        <td id="LC3790"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3791" data-line-number="3791"></td>
        <td id="LC3791">BOOL <span>CEEInfo::isStructRequiringStackAllocRetBuf</span>(CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L3792" data-line-number="3792"></td>
        <td id="LC3792">{</td>
      </tr>
      <tr>
        <td id="L3793" data-line-number="3793"></td>
        <td id="LC3793">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3794" data-line-number="3794"></td>
        <td id="LC3794">        THROWS;</td>
      </tr>
      <tr>
        <td id="L3795" data-line-number="3795"></td>
        <td id="LC3795">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L3796" data-line-number="3796"></td>
        <td id="LC3796">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3797" data-line-number="3797"></td>
        <td id="LC3797">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3798" data-line-number="3798"></td>
        <td id="LC3798">
</td>
      </tr>
      <tr>
        <td id="L3799" data-line-number="3799"></td>
        <td id="LC3799">    BOOL ret = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3800" data-line-number="3800"></td>
        <td id="LC3800">
</td>
      </tr>
      <tr>
        <td id="L3801" data-line-number="3801"></td>
        <td id="LC3801">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3802" data-line-number="3802"></td>
        <td id="LC3802">
</td>
      </tr>
      <tr>
        <td id="L3803" data-line-number="3803"></td>
        <td id="LC3803">    TypeHandle     <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3804" data-line-number="3804"></td>
        <td id="LC3804">    MethodTable * pMT = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L3805" data-line-number="3805"></td>
        <td id="LC3805">    ret = (pMT != <span>NULL</span> &amp;&amp; pMT-&gt;<span>IsStructRequiringStackAllocRetBuf</span>());</td>
      </tr>
      <tr>
        <td id="L3806" data-line-number="3806"></td>
        <td id="LC3806">
</td>
      </tr>
      <tr>
        <td id="L3807" data-line-number="3807"></td>
        <td id="LC3807">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L3808" data-line-number="3808"></td>
        <td id="LC3808">
</td>
      </tr>
      <tr>
        <td id="L3809" data-line-number="3809"></td>
        <td id="LC3809">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L3810" data-line-number="3810"></td>
        <td id="LC3810">}</td>
      </tr>
      <tr>
        <td id="L3811" data-line-number="3811"></td>
        <td id="LC3811">
</td>
      </tr>
      <tr>
        <td id="L3812" data-line-number="3812"></td>
        <td id="LC3812"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3813" data-line-number="3813"></td>
        <td id="LC3813">DWORD <span>CEEInfo::getClassAttribsInternal</span> (CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L3814" data-line-number="3814"></td>
        <td id="LC3814">{</td>
      </tr>
      <tr>
        <td id="L3815" data-line-number="3815"></td>
        <td id="LC3815">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L3816" data-line-number="3816"></td>
        <td id="LC3816">
</td>
      </tr>
      <tr>
        <td id="L3817" data-line-number="3817"></td>
        <td id="LC3817">    DWORD ret = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L3818" data-line-number="3818"></td>
        <td id="LC3818">
</td>
      </tr>
      <tr>
        <td id="L3819" data-line-number="3819"></td>
        <td id="LC3819">    <span>_ASSERTE</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3820" data-line-number="3820"></td>
        <td id="LC3820">
</td>
      </tr>
      <tr>
        <td id="L3821" data-line-number="3821"></td>
        <td id="LC3821">    TypeHandle     <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L3822" data-line-number="3822"></td>
        <td id="LC3822">
</td>
      </tr>
      <tr>
        <td id="L3823" data-line-number="3823"></td>
        <td id="LC3823">    <span><span>//</span> Byrefs should only occur in method and local signatures, which are accessed</span></td>
      </tr>
      <tr>
        <td id="L3824" data-line-number="3824"></td>
        <td id="LC3824">    <span><span>//</span> using ICorClassInfo and ICorClassInfo.getChildType.</span></td>
      </tr>
      <tr>
        <td id="L3825" data-line-number="3825"></td>
        <td id="LC3825">    <span><span>//</span> So getClassAttribs() should not be called for byrefs</span></td>
      </tr>
      <tr>
        <td id="L3826" data-line-number="3826"></td>
        <td id="LC3826">
</td>
      </tr>
      <tr>
        <td id="L3827" data-line-number="3827"></td>
        <td id="LC3827">    <span>if</span> (VMClsHnd.<span>IsByRef</span>())</td>
      </tr>
      <tr>
        <td id="L3828" data-line-number="3828"></td>
        <td id="LC3828">    {</td>
      </tr>
      <tr>
        <td id="L3829" data-line-number="3829"></td>
        <td id="LC3829">        <span>_ASSERTE</span>(!<span><span>"</span>Did findClass() return a Byref?<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L3830" data-line-number="3830"></td>
        <td id="LC3830">        <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L3831" data-line-number="3831"></td>
        <td id="LC3831">    }</td>
      </tr>
      <tr>
        <td id="L3832" data-line-number="3832"></td>
        <td id="LC3832">    <span>else</span> <span>if</span> (VMClsHnd.<span>IsGenericVariable</span>())</td>
      </tr>
      <tr>
        <td id="L3833" data-line-number="3833"></td>
        <td id="LC3833">    {</td>
      </tr>
      <tr>
        <td id="L3834" data-line-number="3834"></td>
        <td id="LC3834">        <span><span>//</span>@GENERICSVER: for now, type variables simply report "variable".</span></td>
      </tr>
      <tr>
        <td id="L3835" data-line-number="3835"></td>
        <td id="LC3835">        ret |= CORINFO_FLG_GENERIC_TYPE_VARIABLE;</td>
      </tr>
      <tr>
        <td id="L3836" data-line-number="3836"></td>
        <td id="LC3836">    }</td>
      </tr>
      <tr>
        <td id="L3837" data-line-number="3837"></td>
        <td id="LC3837">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L3838" data-line-number="3838"></td>
        <td id="LC3838">    {</td>
      </tr>
      <tr>
        <td id="L3839" data-line-number="3839"></td>
        <td id="LC3839">        MethodTable *pMT = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L3840" data-line-number="3840"></td>
        <td id="LC3840">
</td>
      </tr>
      <tr>
        <td id="L3841" data-line-number="3841"></td>
        <td id="LC3841">        <span>if</span> (!pMT)</td>
      </tr>
      <tr>
        <td id="L3842" data-line-number="3842"></td>
        <td id="LC3842">        {</td>
      </tr>
      <tr>
        <td id="L3843" data-line-number="3843"></td>
        <td id="LC3843">            <span>_ASSERTE</span>(!<span><span>"</span>Did findClass() return a Byref?<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L3844" data-line-number="3844"></td>
        <td id="LC3844">            <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L3845" data-line-number="3845"></td>
        <td id="LC3845">        }</td>
      </tr>
      <tr>
        <td id="L3846" data-line-number="3846"></td>
        <td id="LC3846">
</td>
      </tr>
      <tr>
        <td id="L3847" data-line-number="3847"></td>
        <td id="LC3847">        EEClass * pClass = pMT-&gt;<span>GetClass</span>();</td>
      </tr>
      <tr>
        <td id="L3848" data-line-number="3848"></td>
        <td id="LC3848">
</td>
      </tr>
      <tr>
        <td id="L3849" data-line-number="3849"></td>
        <td id="LC3849">        <span><span>//</span> The array flag is used to identify the faked-up methods on</span></td>
      </tr>
      <tr>
        <td id="L3850" data-line-number="3850"></td>
        <td id="LC3850">        <span><span>//</span> array types, i.e. .ctor, Get, Set and Address</span></td>
      </tr>
      <tr>
        <td id="L3851" data-line-number="3851"></td>
        <td id="LC3851">        <span>if</span> (pMT-&gt;<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L3852" data-line-number="3852"></td>
        <td id="LC3852">            ret |= CORINFO_FLG_ARRAY;</td>
      </tr>
      <tr>
        <td id="L3853" data-line-number="3853"></td>
        <td id="LC3853">
</td>
      </tr>
      <tr>
        <td id="L3854" data-line-number="3854"></td>
        <td id="LC3854">        <span>if</span> (pMT-&gt;<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L3855" data-line-number="3855"></td>
        <td id="LC3855">            ret |= CORINFO_FLG_INTERFACE;</td>
      </tr>
      <tr>
        <td id="L3856" data-line-number="3856"></td>
        <td id="LC3856">
</td>
      </tr>
      <tr>
        <td id="L3857" data-line-number="3857"></td>
        <td id="LC3857">        <span>if</span> (pMT-&gt;<span>HasComponentSize</span>())</td>
      </tr>
      <tr>
        <td id="L3858" data-line-number="3858"></td>
        <td id="LC3858">            ret |= CORINFO_FLG_VAROBJSIZE;</td>
      </tr>
      <tr>
        <td id="L3859" data-line-number="3859"></td>
        <td id="LC3859">
</td>
      </tr>
      <tr>
        <td id="L3860" data-line-number="3860"></td>
        <td id="LC3860">        <span>if</span> (pMT-&gt;<span>IsValueType</span>())</td>
      </tr>
      <tr>
        <td id="L3861" data-line-number="3861"></td>
        <td id="LC3861">        {</td>
      </tr>
      <tr>
        <td id="L3862" data-line-number="3862"></td>
        <td id="LC3862">            ret |= CORINFO_FLG_VALUECLASS;</td>
      </tr>
      <tr>
        <td id="L3863" data-line-number="3863"></td>
        <td id="LC3863">
</td>
      </tr>
      <tr>
        <td id="L3864" data-line-number="3864"></td>
        <td id="LC3864">            <span>if</span> (pMT-&gt;<span>IsByRefLike</span>())</td>
      </tr>
      <tr>
        <td id="L3865" data-line-number="3865"></td>
        <td id="LC3865">                ret |= CORINFO_FLG_CONTAINS_STACK_PTR;</td>
      </tr>
      <tr>
        <td id="L3866" data-line-number="3866"></td>
        <td id="LC3866">
</td>
      </tr>
      <tr>
        <td id="L3867" data-line-number="3867"></td>
        <td id="LC3867">            <span>if</span> ((pClass-&gt;<span>IsNotTightlyPacked</span>() &amp;&amp; (!pClass-&gt;<span>IsManagedSequential</span>() || pClass-&gt;<span>HasExplicitSize</span>())) ||</td>
      </tr>
      <tr>
        <td id="L3868" data-line-number="3868"></td>
        <td id="LC3868">                pMT == g_TypedReferenceMT ||</td>
      </tr>
      <tr>
        <td id="L3869" data-line-number="3869"></td>
        <td id="LC3869">                VMClsHnd.<span>IsNativeValueType</span>())</td>
      </tr>
      <tr>
        <td id="L3870" data-line-number="3870"></td>
        <td id="LC3870">            {</td>
      </tr>
      <tr>
        <td id="L3871" data-line-number="3871"></td>
        <td id="LC3871">                ret |= CORINFO_FLG_CUSTOMLAYOUT;</td>
      </tr>
      <tr>
        <td id="L3872" data-line-number="3872"></td>
        <td id="LC3872">            }</td>
      </tr>
      <tr>
        <td id="L3873" data-line-number="3873"></td>
        <td id="LC3873">
</td>
      </tr>
      <tr>
        <td id="L3874" data-line-number="3874"></td>
        <td id="LC3874">            <span>if</span> (pClass-&gt;<span>IsUnsafeValueClass</span>())</td>
      </tr>
      <tr>
        <td id="L3875" data-line-number="3875"></td>
        <td id="LC3875">                ret |= CORINFO_FLG_UNSAFE_VALUECLASS;</td>
      </tr>
      <tr>
        <td id="L3876" data-line-number="3876"></td>
        <td id="LC3876">        }</td>
      </tr>
      <tr>
        <td id="L3877" data-line-number="3877"></td>
        <td id="LC3877">        <span>if</span> (pClass-&gt;<span>HasExplicitFieldOffsetLayout</span>() &amp;&amp; pClass-&gt;<span>HasOverLayedField</span>())</td>
      </tr>
      <tr>
        <td id="L3878" data-line-number="3878"></td>
        <td id="LC3878">            ret |= CORINFO_FLG_OVERLAPPING_FIELDS;</td>
      </tr>
      <tr>
        <td id="L3879" data-line-number="3879"></td>
        <td id="LC3879">        <span>if</span> (VMClsHnd.<span>IsCanonicalSubtype</span>())</td>
      </tr>
      <tr>
        <td id="L3880" data-line-number="3880"></td>
        <td id="LC3880">            ret |= CORINFO_FLG_SHAREDINST;</td>
      </tr>
      <tr>
        <td id="L3881" data-line-number="3881"></td>
        <td id="LC3881">
</td>
      </tr>
      <tr>
        <td id="L3882" data-line-number="3882"></td>
        <td id="LC3882">        <span>if</span> (pMT-&gt;<span>HasVariance</span>())</td>
      </tr>
      <tr>
        <td id="L3883" data-line-number="3883"></td>
        <td id="LC3883">            ret |= CORINFO_FLG_VARIANCE;</td>
      </tr>
      <tr>
        <td id="L3884" data-line-number="3884"></td>
        <td id="LC3884">
</td>
      </tr>
      <tr>
        <td id="L3885" data-line-number="3885"></td>
        <td id="LC3885">        <span>if</span> (pMT-&gt;<span>ContainsPointers</span>() || pMT == g_TypedReferenceMT)</td>
      </tr>
      <tr>
        <td id="L3886" data-line-number="3886"></td>
        <td id="LC3886">            ret |= CORINFO_FLG_CONTAINS_GC_PTR;</td>
      </tr>
      <tr>
        <td id="L3887" data-line-number="3887"></td>
        <td id="LC3887">
</td>
      </tr>
      <tr>
        <td id="L3888" data-line-number="3888"></td>
        <td id="LC3888">        <span>if</span> (pMT-&gt;<span>IsDelegate</span>())</td>
      </tr>
      <tr>
        <td id="L3889" data-line-number="3889"></td>
        <td id="LC3889">            ret |= CORINFO_FLG_DELEGATE;</td>
      </tr>
      <tr>
        <td id="L3890" data-line-number="3890"></td>
        <td id="LC3890">
</td>
      </tr>
      <tr>
        <td id="L3891" data-line-number="3891"></td>
        <td id="LC3891">        <span>if</span> (pClass-&gt;<span>IsBeforeFieldInit</span>())</td>
      </tr>
      <tr>
        <td id="L3892" data-line-number="3892"></td>
        <td id="LC3892">        {</td>
      </tr>
      <tr>
        <td id="L3893" data-line-number="3893"></td>
        <td id="LC3893">            <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp; !pMT-&gt;<span>GetModule</span>()-&gt;<span>IsInCurrentVersionBubble</span>())</td>
      </tr>
      <tr>
        <td id="L3894" data-line-number="3894"></td>
        <td id="LC3894">            {</td>
      </tr>
      <tr>
        <td id="L3895" data-line-number="3895"></td>
        <td id="LC3895">                <span><span>//</span> For version resiliency do not allow hoisting static constructors out of loops</span></td>
      </tr>
      <tr>
        <td id="L3896" data-line-number="3896"></td>
        <td id="LC3896">            }</td>
      </tr>
      <tr>
        <td id="L3897" data-line-number="3897"></td>
        <td id="LC3897">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L3898" data-line-number="3898"></td>
        <td id="LC3898">            {</td>
      </tr>
      <tr>
        <td id="L3899" data-line-number="3899"></td>
        <td id="LC3899">                ret |= CORINFO_FLG_BEFOREFIELDINIT;</td>
      </tr>
      <tr>
        <td id="L3900" data-line-number="3900"></td>
        <td id="LC3900">            }</td>
      </tr>
      <tr>
        <td id="L3901" data-line-number="3901"></td>
        <td id="LC3901">        }</td>
      </tr>
      <tr>
        <td id="L3902" data-line-number="3902"></td>
        <td id="LC3902">
</td>
      </tr>
      <tr>
        <td id="L3903" data-line-number="3903"></td>
        <td id="LC3903">        <span>if</span> (pClass-&gt;<span>IsAbstract</span>())</td>
      </tr>
      <tr>
        <td id="L3904" data-line-number="3904"></td>
        <td id="LC3904">            ret |= CORINFO_FLG_ABSTRACT;</td>
      </tr>
      <tr>
        <td id="L3905" data-line-number="3905"></td>
        <td id="LC3905">
</td>
      </tr>
      <tr>
        <td id="L3906" data-line-number="3906"></td>
        <td id="LC3906">        <span>if</span> (pClass-&gt;<span>IsSealed</span>())</td>
      </tr>
      <tr>
        <td id="L3907" data-line-number="3907"></td>
        <td id="LC3907">            ret |= CORINFO_FLG_FINAL;</td>
      </tr>
      <tr>
        <td id="L3908" data-line-number="3908"></td>
        <td id="LC3908">
</td>
      </tr>
      <tr>
        <td id="L3909" data-line-number="3909"></td>
        <td id="LC3909">        <span>if</span> (pMT-&gt;<span>IsIntrinsicType</span>())</td>
      </tr>
      <tr>
        <td id="L3910" data-line-number="3910"></td>
        <td id="LC3910">            ret |= CORINFO_FLG_INTRINSIC_TYPE;</td>
      </tr>
      <tr>
        <td id="L3911" data-line-number="3911"></td>
        <td id="LC3911">    }</td>
      </tr>
      <tr>
        <td id="L3912" data-line-number="3912"></td>
        <td id="LC3912">
</td>
      </tr>
      <tr>
        <td id="L3913" data-line-number="3913"></td>
        <td id="LC3913">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L3914" data-line-number="3914"></td>
        <td id="LC3914">}</td>
      </tr>
      <tr>
        <td id="L3915" data-line-number="3915"></td>
        <td id="LC3915">
</td>
      </tr>
      <tr>
        <td id="L3916" data-line-number="3916"></td>
        <td id="LC3916"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L3917" data-line-number="3917"></td>
        <td id="LC3917"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L3918" data-line-number="3918"></td>
        <td id="LC3918"><span><span>//</span> See code:CorInfoFlag#ClassConstructionFlags  for details.</span></td>
      </tr>
      <tr>
        <td id="L3919" data-line-number="3919"></td>
        <td id="LC3919"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L3920" data-line-number="3920"></td>
        <td id="LC3920">CorInfoInitClassResult <span>CEEInfo::initClass</span>(</td>
      </tr>
      <tr>
        <td id="L3921" data-line-number="3921"></td>
        <td id="LC3921">            CORINFO_FIELD_HANDLE    field,</td>
      </tr>
      <tr>
        <td id="L3922" data-line-number="3922"></td>
        <td id="LC3922">            CORINFO_METHOD_HANDLE   method,</td>
      </tr>
      <tr>
        <td id="L3923" data-line-number="3923"></td>
        <td id="LC3923">            CORINFO_CONTEXT_HANDLE  context,</td>
      </tr>
      <tr>
        <td id="L3924" data-line-number="3924"></td>
        <td id="LC3924">            BOOL                    speculative)</td>
      </tr>
      <tr>
        <td id="L3925" data-line-number="3925"></td>
        <td id="LC3925">{</td>
      </tr>
      <tr>
        <td id="L3926" data-line-number="3926"></td>
        <td id="LC3926">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L3927" data-line-number="3927"></td>
        <td id="LC3927">        THROWS;</td>
      </tr>
      <tr>
        <td id="L3928" data-line-number="3928"></td>
        <td id="LC3928">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L3929" data-line-number="3929"></td>
        <td id="LC3929">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L3930" data-line-number="3930"></td>
        <td id="LC3930">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L3931" data-line-number="3931"></td>
        <td id="LC3931">
</td>
      </tr>
      <tr>
        <td id="L3932" data-line-number="3932"></td>
        <td id="LC3932">    DWORD result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L3933" data-line-number="3933"></td>
        <td id="LC3933">
</td>
      </tr>
      <tr>
        <td id="L3934" data-line-number="3934"></td>
        <td id="LC3934">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L3935" data-line-number="3935"></td>
        <td id="LC3935">    {</td>
      </tr>
      <tr>
        <td id="L3936" data-line-number="3936"></td>
        <td id="LC3936">
</td>
      </tr>
      <tr>
        <td id="L3937" data-line-number="3937"></td>
        <td id="LC3937">    <span><span>//</span> Do not bother figuring out the initialization if we are only verifying the method.</span></td>
      </tr>
      <tr>
        <td id="L3938" data-line-number="3938"></td>
        <td id="LC3938">    <span>if</span> (<span>isVerifyOnly</span>())</td>
      </tr>
      <tr>
        <td id="L3939" data-line-number="3939"></td>
        <td id="LC3939">    {</td>
      </tr>
      <tr>
        <td id="L3940" data-line-number="3940"></td>
        <td id="LC3940">        result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L3941" data-line-number="3941"></td>
        <td id="LC3941">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L3942" data-line-number="3942"></td>
        <td id="LC3942">    }</td>
      </tr>
      <tr>
        <td id="L3943" data-line-number="3943"></td>
        <td id="LC3943">
</td>
      </tr>
      <tr>
        <td id="L3944" data-line-number="3944"></td>
        <td id="LC3944">    FieldDesc * pFD = (FieldDesc *)field;</td>
      </tr>
      <tr>
        <td id="L3945" data-line-number="3945"></td>
        <td id="LC3945">    <span>_ASSERTE</span>(pFD == <span>NULL</span> || pFD-&gt;<span>IsStatic</span>());</td>
      </tr>
      <tr>
        <td id="L3946" data-line-number="3946"></td>
        <td id="LC3946">
</td>
      </tr>
      <tr>
        <td id="L3947" data-line-number="3947"></td>
        <td id="LC3947">    MethodDesc * pMD = (MethodDesc *)method;</td>
      </tr>
      <tr>
        <td id="L3948" data-line-number="3948"></td>
        <td id="LC3948">
</td>
      </tr>
      <tr>
        <td id="L3949" data-line-number="3949"></td>
        <td id="LC3949">    TypeHandle typeToInitTH = (pFD != <span>NULL</span>) ? pFD-&gt;<span>GetEnclosingMethodTable</span>() : <span>GetTypeFromContext</span>(context);</td>
      </tr>
      <tr>
        <td id="L3950" data-line-number="3950"></td>
        <td id="LC3950">
</td>
      </tr>
      <tr>
        <td id="L3951" data-line-number="3951"></td>
        <td id="LC3951">    MethodDesc *methodBeingCompiled = m_pMethodBeingCompiled;</td>
      </tr>
      <tr>
        <td id="L3952" data-line-number="3952"></td>
        <td id="LC3952">
</td>
      </tr>
      <tr>
        <td id="L3953" data-line-number="3953"></td>
        <td id="LC3953">    BOOL <span>fMethodZappedOrNGen</span> = methodBeingCompiled-&gt;<span>IsZapped</span>() || <span>IsCompilingForNGen</span>();</td>
      </tr>
      <tr>
        <td id="L3954" data-line-number="3954"></td>
        <td id="LC3954">
</td>
      </tr>
      <tr>
        <td id="L3955" data-line-number="3955"></td>
        <td id="LC3955">    MethodTable *pTypeToInitMT = typeToInitTH.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L3956" data-line-number="3956"></td>
        <td id="LC3956">
</td>
      </tr>
      <tr>
        <td id="L3957" data-line-number="3957"></td>
        <td id="LC3957">    <span><span>//</span> This should be the most common early-out case.</span></td>
      </tr>
      <tr>
        <td id="L3958" data-line-number="3958"></td>
        <td id="LC3958">    <span>if</span> (<span>fMethodZappedOrNGen</span>)</td>
      </tr>
      <tr>
        <td id="L3959" data-line-number="3959"></td>
        <td id="LC3959">    {</td>
      </tr>
      <tr>
        <td id="L3960" data-line-number="3960"></td>
        <td id="LC3960">        <span>if</span> (pTypeToInitMT-&gt;<span>IsClassPreInited</span>())</td>
      </tr>
      <tr>
        <td id="L3961" data-line-number="3961"></td>
        <td id="LC3961">        {</td>
      </tr>
      <tr>
        <td id="L3962" data-line-number="3962"></td>
        <td id="LC3962">            result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L3963" data-line-number="3963"></td>
        <td id="LC3963">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L3964" data-line-number="3964"></td>
        <td id="LC3964">        }</td>
      </tr>
      <tr>
        <td id="L3965" data-line-number="3965"></td>
        <td id="LC3965">    }</td>
      </tr>
      <tr>
        <td id="L3966" data-line-number="3966"></td>
        <td id="LC3966">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L3967" data-line-number="3967"></td>
        <td id="LC3967">    {</td>
      </tr>
      <tr>
        <td id="L3968" data-line-number="3968"></td>
        <td id="LC3968">#<span>ifdef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L3969" data-line-number="3969"></td>
        <td id="LC3969">        <span>_ASSERTE</span>(<span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L3970" data-line-number="3970"></td>
        <td id="LC3970">#<span>else</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L3971" data-line-number="3971"></td>
        <td id="LC3971">        <span>if</span> (pTypeToInitMT-&gt;<span>IsClassInited</span>())</td>
      </tr>
      <tr>
        <td id="L3972" data-line-number="3972"></td>
        <td id="LC3972">        {</td>
      </tr>
      <tr>
        <td id="L3973" data-line-number="3973"></td>
        <td id="LC3973">            <span><span>//</span> If the type is initialized there really is nothing to do.</span></td>
      </tr>
      <tr>
        <td id="L3974" data-line-number="3974"></td>
        <td id="LC3974">            result = CORINFO_INITCLASS_INITIALIZED;</td>
      </tr>
      <tr>
        <td id="L3975" data-line-number="3975"></td>
        <td id="LC3975">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L3976" data-line-number="3976"></td>
        <td id="LC3976">        }</td>
      </tr>
      <tr>
        <td id="L3977" data-line-number="3977"></td>
        <td id="LC3977">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L3978" data-line-number="3978"></td>
        <td id="LC3978">    }</td>
      </tr>
      <tr>
        <td id="L3979" data-line-number="3979"></td>
        <td id="LC3979">
</td>
      </tr>
      <tr>
        <td id="L3980" data-line-number="3980"></td>
        <td id="LC3980">    <span>if</span> (pTypeToInitMT-&gt;<span>IsGlobalClass</span>())</td>
      </tr>
      <tr>
        <td id="L3981" data-line-number="3981"></td>
        <td id="LC3981">    {</td>
      </tr>
      <tr>
        <td id="L3982" data-line-number="3982"></td>
        <td id="LC3982">        <span><span>//</span> For both jitted and ngen code the global class is always considered initialized</span></td>
      </tr>
      <tr>
        <td id="L3983" data-line-number="3983"></td>
        <td id="LC3983">        result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L3984" data-line-number="3984"></td>
        <td id="LC3984">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L3985" data-line-number="3985"></td>
        <td id="LC3985">    }</td>
      </tr>
      <tr>
        <td id="L3986" data-line-number="3986"></td>
        <td id="LC3986">
</td>
      </tr>
      <tr>
        <td id="L3987" data-line-number="3987"></td>
        <td id="LC3987">    <span>bool</span> <span>fIgnoreBeforeFieldInit</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L3988" data-line-number="3988"></td>
        <td id="LC3988">
</td>
      </tr>
      <tr>
        <td id="L3989" data-line-number="3989"></td>
        <td id="LC3989">    <span>if</span> (pFD == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L3990" data-line-number="3990"></td>
        <td id="LC3990">    {</td>
      </tr>
      <tr>
        <td id="L3991" data-line-number="3991"></td>
        <td id="LC3991">        <span>if</span> (!<span>fIgnoreBeforeFieldInit</span> &amp;&amp; pTypeToInitMT-&gt;<span>GetClass</span>()-&gt;<span>IsBeforeFieldInit</span>())</td>
      </tr>
      <tr>
        <td id="L3992" data-line-number="3992"></td>
        <td id="LC3992">        {</td>
      </tr>
      <tr>
        <td id="L3993" data-line-number="3993"></td>
        <td id="LC3993">            <span><span>//</span> We can wait for field accesses to run .cctor</span></td>
      </tr>
      <tr>
        <td id="L3994" data-line-number="3994"></td>
        <td id="LC3994">            result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L3995" data-line-number="3995"></td>
        <td id="LC3995">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L3996" data-line-number="3996"></td>
        <td id="LC3996">        }</td>
      </tr>
      <tr>
        <td id="L3997" data-line-number="3997"></td>
        <td id="LC3997">
</td>
      </tr>
      <tr>
        <td id="L3998" data-line-number="3998"></td>
        <td id="LC3998">        <span><span>//</span> Run .cctor on statics &amp; constructors</span></td>
      </tr>
      <tr>
        <td id="L3999" data-line-number="3999"></td>
        <td id="LC3999">        <span>if</span> (pMD-&gt;<span>IsStatic</span>())</td>
      </tr>
      <tr>
        <td id="L4000" data-line-number="4000"></td>
        <td id="LC4000">        {</td>
      </tr>
      <tr>
        <td id="L4001" data-line-number="4001"></td>
        <td id="LC4001">            <span><span>//</span> Except don't class construct on .cctor - it would be circular</span></td>
      </tr>
      <tr>
        <td id="L4002" data-line-number="4002"></td>
        <td id="LC4002">            <span>if</span> (pMD-&gt;<span>IsClassConstructor</span>())</td>
      </tr>
      <tr>
        <td id="L4003" data-line-number="4003"></td>
        <td id="LC4003">            {</td>
      </tr>
      <tr>
        <td id="L4004" data-line-number="4004"></td>
        <td id="LC4004">                result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L4005" data-line-number="4005"></td>
        <td id="LC4005">                <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4006" data-line-number="4006"></td>
        <td id="LC4006">            }</td>
      </tr>
      <tr>
        <td id="L4007" data-line-number="4007"></td>
        <td id="LC4007">        }</td>
      </tr>
      <tr>
        <td id="L4008" data-line-number="4008"></td>
        <td id="LC4008">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L4009" data-line-number="4009"></td>
        <td id="LC4009">        <span><span>//</span> According to the spec, we should be able to do this optimization for both reference and valuetypes.</span></td>
      </tr>
      <tr>
        <td id="L4010" data-line-number="4010"></td>
        <td id="LC4010">        <span><span>//</span> To maintain backward compatibility, we are doing it for reference types only.</span></td>
      </tr>
      <tr>
        <td id="L4011" data-line-number="4011"></td>
        <td id="LC4011">        <span><span>//</span> We don't do this for interfaces though, as those don't have instance constructors.</span></td>
      </tr>
      <tr>
        <td id="L4012" data-line-number="4012"></td>
        <td id="LC4012">        <span>if</span> (!pMD-&gt;<span>IsCtor</span>() &amp;&amp; !pTypeToInitMT-&gt;<span>IsValueType</span>() &amp;&amp; !pTypeToInitMT-&gt;<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L4013" data-line-number="4013"></td>
        <td id="LC4013">        {</td>
      </tr>
      <tr>
        <td id="L4014" data-line-number="4014"></td>
        <td id="LC4014">            <span><span>//</span> For instance methods of types with precise-initialization</span></td>
      </tr>
      <tr>
        <td id="L4015" data-line-number="4015"></td>
        <td id="LC4015">            <span><span>//</span> semantics, we can assume that the .ctor triggerred the</span></td>
      </tr>
      <tr>
        <td id="L4016" data-line-number="4016"></td>
        <td id="LC4016">            <span><span>//</span> type initialization.</span></td>
      </tr>
      <tr>
        <td id="L4017" data-line-number="4017"></td>
        <td id="LC4017">            <span><span>//</span> This does not hold for NULL "this" object. However, the spec does</span></td>
      </tr>
      <tr>
        <td id="L4018" data-line-number="4018"></td>
        <td id="LC4018">            <span><span>//</span> not require that case to work.</span></td>
      </tr>
      <tr>
        <td id="L4019" data-line-number="4019"></td>
        <td id="LC4019">            result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L4020" data-line-number="4020"></td>
        <td id="LC4020">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4021" data-line-number="4021"></td>
        <td id="LC4021">        }</td>
      </tr>
      <tr>
        <td id="L4022" data-line-number="4022"></td>
        <td id="LC4022">    }</td>
      </tr>
      <tr>
        <td id="L4023" data-line-number="4023"></td>
        <td id="LC4023">
</td>
      </tr>
      <tr>
        <td id="L4024" data-line-number="4024"></td>
        <td id="LC4024">    <span>if</span> (pTypeToInitMT-&gt;<span>IsSharedByGenericInstantiations</span>())</td>
      </tr>
      <tr>
        <td id="L4025" data-line-number="4025"></td>
        <td id="LC4025">    {</td>
      </tr>
      <tr>
        <td id="L4026" data-line-number="4026"></td>
        <td id="LC4026">        <span><span>//</span> Shared generic code has to use helper. Moreover, tell JIT not to inline since</span></td>
      </tr>
      <tr>
        <td id="L4027" data-line-number="4027"></td>
        <td id="LC4027">        <span><span>//</span> inlining of generic dictionary lookups is not supported.</span></td>
      </tr>
      <tr>
        <td id="L4028" data-line-number="4028"></td>
        <td id="LC4028">        result = CORINFO_INITCLASS_USE_HELPER | CORINFO_INITCLASS_DONT_INLINE;</td>
      </tr>
      <tr>
        <td id="L4029" data-line-number="4029"></td>
        <td id="LC4029">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4030" data-line-number="4030"></td>
        <td id="LC4030">    }</td>
      </tr>
      <tr>
        <td id="L4031" data-line-number="4031"></td>
        <td id="LC4031">
</td>
      </tr>
      <tr>
        <td id="L4032" data-line-number="4032"></td>
        <td id="LC4032">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L4033" data-line-number="4033"></td>
        <td id="LC4033">    <span><span>//</span> Try to prove that the initialization is not necessary because of nesting</span></td>
      </tr>
      <tr>
        <td id="L4034" data-line-number="4034"></td>
        <td id="LC4034">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L4035" data-line-number="4035"></td>
        <td id="LC4035">
</td>
      </tr>
      <tr>
        <td id="L4036" data-line-number="4036"></td>
        <td id="LC4036">    <span>if</span> (pFD == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L4037" data-line-number="4037"></td>
        <td id="LC4037">    {</td>
      </tr>
      <tr>
        <td id="L4038" data-line-number="4038"></td>
        <td id="LC4038">        <span><span>//</span> Handled above</span></td>
      </tr>
      <tr>
        <td id="L4039" data-line-number="4039"></td>
        <td id="LC4039">        <span>_ASSERTE</span>(<span>fIgnoreBeforeFieldInit</span> || !pTypeToInitMT-&gt;<span>GetClass</span>()-&gt;<span>IsBeforeFieldInit</span>());</td>
      </tr>
      <tr>
        <td id="L4040" data-line-number="4040"></td>
        <td id="LC4040">
</td>
      </tr>
      <tr>
        <td id="L4041" data-line-number="4041"></td>
        <td id="LC4041">        <span><span>//</span> Note that jit has both methods the same if asking whether to emit cctor</span></td>
      </tr>
      <tr>
        <td id="L4042" data-line-number="4042"></td>
        <td id="LC4042">        <span><span>//</span> for a given method's code (as opposed to inlining codegen).</span></td>
      </tr>
      <tr>
        <td id="L4043" data-line-number="4043"></td>
        <td id="LC4043">        <span>if</span> (context != <span>MAKE_METHODCONTEXT</span>(methodBeingCompiled) &amp;&amp; pTypeToInitMT == methodBeingCompiled-&gt;<span>GetMethodTable</span>())</td>
      </tr>
      <tr>
        <td id="L4044" data-line-number="4044"></td>
        <td id="LC4044">        {</td>
      </tr>
      <tr>
        <td id="L4045" data-line-number="4045"></td>
        <td id="LC4045">            <span><span>//</span> If we're inling a call to a method in our own type, then we should already</span></td>
      </tr>
      <tr>
        <td id="L4046" data-line-number="4046"></td>
        <td id="LC4046">            <span><span>//</span> have triggered the .cctor when caller was itself called.</span></td>
      </tr>
      <tr>
        <td id="L4047" data-line-number="4047"></td>
        <td id="LC4047">            result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L4048" data-line-number="4048"></td>
        <td id="LC4048">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4049" data-line-number="4049"></td>
        <td id="LC4049">        }</td>
      </tr>
      <tr>
        <td id="L4050" data-line-number="4050"></td>
        <td id="LC4050">    }</td>
      </tr>
      <tr>
        <td id="L4051" data-line-number="4051"></td>
        <td id="LC4051">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L4052" data-line-number="4052"></td>
        <td id="LC4052">    {</td>
      </tr>
      <tr>
        <td id="L4053" data-line-number="4053"></td>
        <td id="LC4053">        <span><span>//</span> This optimization may cause static fields in reference types to be accessed without cctor being triggered</span></td>
      </tr>
      <tr>
        <td id="L4054" data-line-number="4054"></td>
        <td id="LC4054">        <span><span>//</span> for NULL "this" object. It does not conform with what the spec says. However, we have been historically</span></td>
      </tr>
      <tr>
        <td id="L4055" data-line-number="4055"></td>
        <td id="LC4055">        <span><span>//</span> doing it for perf reasons.</span></td>
      </tr>
      <tr>
        <td id="L4056" data-line-number="4056"></td>
        <td id="LC4056">        <span>if</span> (!pTypeToInitMT-&gt;<span>IsValueType</span>() &amp;&amp; !pTypeToInitMT-&gt;<span>IsInterface</span>() &amp;&amp; !pTypeToInitMT-&gt;<span>GetClass</span>()-&gt;<span>IsBeforeFieldInit</span>())</td>
      </tr>
      <tr>
        <td id="L4057" data-line-number="4057"></td>
        <td id="LC4057">        {</td>
      </tr>
      <tr>
        <td id="L4058" data-line-number="4058"></td>
        <td id="LC4058">            <span>if</span> (pTypeToInitMT == <span>GetTypeFromContext</span>(context).<span>AsMethodTable</span>() || pTypeToInitMT == methodBeingCompiled-&gt;<span>GetMethodTable</span>())</td>
      </tr>
      <tr>
        <td id="L4059" data-line-number="4059"></td>
        <td id="LC4059">            {</td>
      </tr>
      <tr>
        <td id="L4060" data-line-number="4060"></td>
        <td id="LC4060">                <span><span>//</span> The class will be initialized by the time we access the field.</span></td>
      </tr>
      <tr>
        <td id="L4061" data-line-number="4061"></td>
        <td id="LC4061">                result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L4062" data-line-number="4062"></td>
        <td id="LC4062">                <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4063" data-line-number="4063"></td>
        <td id="LC4063">            }</td>
      </tr>
      <tr>
        <td id="L4064" data-line-number="4064"></td>
        <td id="LC4064">        }</td>
      </tr>
      <tr>
        <td id="L4065" data-line-number="4065"></td>
        <td id="LC4065">
</td>
      </tr>
      <tr>
        <td id="L4066" data-line-number="4066"></td>
        <td id="LC4066">        <span><span>//</span> If we are currently compiling the class constructor for this static field access then we can skip the initClass</span></td>
      </tr>
      <tr>
        <td id="L4067" data-line-number="4067"></td>
        <td id="LC4067">        <span>if</span> (methodBeingCompiled-&gt;<span>GetMethodTable</span>() == pTypeToInitMT &amp;&amp; methodBeingCompiled-&gt;<span>IsStatic</span>() &amp;&amp; methodBeingCompiled-&gt;<span>IsClassConstructor</span>())</td>
      </tr>
      <tr>
        <td id="L4068" data-line-number="4068"></td>
        <td id="LC4068">        {</td>
      </tr>
      <tr>
        <td id="L4069" data-line-number="4069"></td>
        <td id="LC4069">            <span><span>//</span> The class will be initialized by the time we access the field.</span></td>
      </tr>
      <tr>
        <td id="L4070" data-line-number="4070"></td>
        <td id="LC4070">            result = CORINFO_INITCLASS_NOT_REQUIRED;</td>
      </tr>
      <tr>
        <td id="L4071" data-line-number="4071"></td>
        <td id="LC4071">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4072" data-line-number="4072"></td>
        <td id="LC4072">        }</td>
      </tr>
      <tr>
        <td id="L4073" data-line-number="4073"></td>
        <td id="LC4073">    }</td>
      </tr>
      <tr>
        <td id="L4074" data-line-number="4074"></td>
        <td id="LC4074">
</td>
      </tr>
      <tr>
        <td id="L4075" data-line-number="4075"></td>
        <td id="LC4075">    <span>if</span> (<span>fMethodZappedOrNGen</span>)</td>
      </tr>
      <tr>
        <td id="L4076" data-line-number="4076"></td>
        <td id="LC4076">    {</td>
      </tr>
      <tr>
        <td id="L4077" data-line-number="4077"></td>
        <td id="LC4077">        <span><span>//</span> Well, because of code sharing we can't do anything at coge generation time.</span></td>
      </tr>
      <tr>
        <td id="L4078" data-line-number="4078"></td>
        <td id="LC4078">        <span><span>//</span> We have to do it at runtime.</span></td>
      </tr>
      <tr>
        <td id="L4079" data-line-number="4079"></td>
        <td id="LC4079">        result = CORINFO_INITCLASS_USE_HELPER;</td>
      </tr>
      <tr>
        <td id="L4080" data-line-number="4080"></td>
        <td id="LC4080">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4081" data-line-number="4081"></td>
        <td id="LC4081">    }</td>
      </tr>
      <tr>
        <td id="L4082" data-line-number="4082"></td>
        <td id="LC4082">
</td>
      </tr>
      <tr>
        <td id="L4083" data-line-number="4083"></td>
        <td id="LC4083">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L4084" data-line-number="4084"></td>
        <td id="LC4084">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L4085" data-line-number="4085"></td>
        <td id="LC4085">    <span><span>//</span> Optimizations for domain specific code</span></td>
      </tr>
      <tr>
        <td id="L4086" data-line-number="4086"></td>
        <td id="LC4086">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L4087" data-line-number="4087"></td>
        <td id="LC4087">
</td>
      </tr>
      <tr>
        <td id="L4088" data-line-number="4088"></td>
        <td id="LC4088">    <span><span>//</span> Allocate space for the local class if necessary, but don't trigger</span></td>
      </tr>
      <tr>
        <td id="L4089" data-line-number="4089"></td>
        <td id="LC4089">    <span><span>//</span> class construction.</span></td>
      </tr>
      <tr>
        <td id="L4090" data-line-number="4090"></td>
        <td id="LC4090">    DomainLocalModule *pModule = pTypeToInitMT-&gt;<span>GetDomainLocalModule</span>();</td>
      </tr>
      <tr>
        <td id="L4091" data-line-number="4091"></td>
        <td id="LC4091">    pModule-&gt;<span>PopulateClass</span>(pTypeToInitMT);</td>
      </tr>
      <tr>
        <td id="L4092" data-line-number="4092"></td>
        <td id="LC4092">
</td>
      </tr>
      <tr>
        <td id="L4093" data-line-number="4093"></td>
        <td id="LC4093">    <span>if</span> (pTypeToInitMT-&gt;<span>IsClassInited</span>())</td>
      </tr>
      <tr>
        <td id="L4094" data-line-number="4094"></td>
        <td id="LC4094">    {</td>
      </tr>
      <tr>
        <td id="L4095" data-line-number="4095"></td>
        <td id="LC4095">        result = CORINFO_INITCLASS_INITIALIZED;</td>
      </tr>
      <tr>
        <td id="L4096" data-line-number="4096"></td>
        <td id="LC4096">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L4097" data-line-number="4097"></td>
        <td id="LC4097">    }</td>
      </tr>
      <tr>
        <td id="L4098" data-line-number="4098"></td>
        <td id="LC4098">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L4099" data-line-number="4099"></td>
        <td id="LC4099">
</td>
      </tr>
      <tr>
        <td id="L4100" data-line-number="4100"></td>
        <td id="LC4100">    result = CORINFO_INITCLASS_USE_HELPER;</td>
      </tr>
      <tr>
        <td id="L4101" data-line-number="4101"></td>
        <td id="LC4101">    }</td>
      </tr>
      <tr>
        <td id="L4102" data-line-number="4102"></td>
        <td id="LC4102"><span>exit</span>: ;</td>
      </tr>
      <tr>
        <td id="L4103" data-line-number="4103"></td>
        <td id="LC4103">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4104" data-line-number="4104"></td>
        <td id="LC4104">
</td>
      </tr>
      <tr>
        <td id="L4105" data-line-number="4105"></td>
        <td id="LC4105">    <span>return</span> (CorInfoInitClassResult)result;</td>
      </tr>
      <tr>
        <td id="L4106" data-line-number="4106"></td>
        <td id="LC4106">}</td>
      </tr>
      <tr>
        <td id="L4107" data-line-number="4107"></td>
        <td id="LC4107">
</td>
      </tr>
      <tr>
        <td id="L4108" data-line-number="4108"></td>
        <td id="LC4108">
</td>
      </tr>
      <tr>
        <td id="L4109" data-line-number="4109"></td>
        <td id="LC4109">
</td>
      </tr>
      <tr>
        <td id="L4110" data-line-number="4110"></td>
        <td id="LC4110"><span>void</span> <span>CEEInfo::classMustBeLoadedBeforeCodeIsRun</span> (CORINFO_CLASS_HANDLE typeToLoadHnd)</td>
      </tr>
      <tr>
        <td id="L4111" data-line-number="4111"></td>
        <td id="LC4111">{</td>
      </tr>
      <tr>
        <td id="L4112" data-line-number="4112"></td>
        <td id="LC4112">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4113" data-line-number="4113"></td>
        <td id="LC4113">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L4114" data-line-number="4114"></td>
        <td id="LC4114">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L4115" data-line-number="4115"></td>
        <td id="LC4115">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4116" data-line-number="4116"></td>
        <td id="LC4116">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4117" data-line-number="4117"></td>
        <td id="LC4117">
</td>
      </tr>
      <tr>
        <td id="L4118" data-line-number="4118"></td>
        <td id="LC4118">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L4119" data-line-number="4119"></td>
        <td id="LC4119">
</td>
      </tr>
      <tr>
        <td id="L4120" data-line-number="4120"></td>
        <td id="LC4120">    TypeHandle th = <span>TypeHandle</span>(typeToLoadHnd);</td>
      </tr>
      <tr>
        <td id="L4121" data-line-number="4121"></td>
        <td id="LC4121">
</td>
      </tr>
      <tr>
        <td id="L4122" data-line-number="4122"></td>
        <td id="LC4122">    <span><span>//</span> Type handles returned to JIT at runtime are always fully loaded. Verify that it is the case.</span></td>
      </tr>
      <tr>
        <td id="L4123" data-line-number="4123"></td>
        <td id="LC4123">    <span>_ASSERTE</span>(th.<span>IsFullyLoaded</span>());</td>
      </tr>
      <tr>
        <td id="L4124" data-line-number="4124"></td>
        <td id="LC4124">
</td>
      </tr>
      <tr>
        <td id="L4125" data-line-number="4125"></td>
        <td id="LC4125">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L4126" data-line-number="4126"></td>
        <td id="LC4126">}</td>
      </tr>
      <tr>
        <td id="L4127" data-line-number="4127"></td>
        <td id="LC4127">
</td>
      </tr>
      <tr>
        <td id="L4128" data-line-number="4128"></td>
        <td id="LC4128"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4129" data-line-number="4129"></td>
        <td id="LC4129"><span>void</span> <span>CEEInfo::methodMustBeLoadedBeforeCodeIsRun</span> (CORINFO_METHOD_HANDLE methHnd)</td>
      </tr>
      <tr>
        <td id="L4130" data-line-number="4130"></td>
        <td id="LC4130">{</td>
      </tr>
      <tr>
        <td id="L4131" data-line-number="4131"></td>
        <td id="LC4131">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4132" data-line-number="4132"></td>
        <td id="LC4132">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L4133" data-line-number="4133"></td>
        <td id="LC4133">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L4134" data-line-number="4134"></td>
        <td id="LC4134">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4135" data-line-number="4135"></td>
        <td id="LC4135">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4136" data-line-number="4136"></td>
        <td id="LC4136">
</td>
      </tr>
      <tr>
        <td id="L4137" data-line-number="4137"></td>
        <td id="LC4137">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L4138" data-line-number="4138"></td>
        <td id="LC4138">
</td>
      </tr>
      <tr>
        <td id="L4139" data-line-number="4139"></td>
        <td id="LC4139">    MethodDesc *pMD = (MethodDesc*) methHnd;</td>
      </tr>
      <tr>
        <td id="L4140" data-line-number="4140"></td>
        <td id="LC4140">
</td>
      </tr>
      <tr>
        <td id="L4141" data-line-number="4141"></td>
        <td id="LC4141">    <span><span>//</span> MethodDescs returned to JIT at runtime are always fully loaded. Verify that it is the case.</span></td>
      </tr>
      <tr>
        <td id="L4142" data-line-number="4142"></td>
        <td id="LC4142">    <span>_ASSERTE</span>(pMD-&gt;<span>IsRestored</span>() &amp;&amp; pMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsFullyLoaded</span>());</td>
      </tr>
      <tr>
        <td id="L4143" data-line-number="4143"></td>
        <td id="LC4143">
</td>
      </tr>
      <tr>
        <td id="L4144" data-line-number="4144"></td>
        <td id="LC4144">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L4145" data-line-number="4145"></td>
        <td id="LC4145">}</td>
      </tr>
      <tr>
        <td id="L4146" data-line-number="4146"></td>
        <td id="LC4146">
</td>
      </tr>
      <tr>
        <td id="L4147" data-line-number="4147"></td>
        <td id="LC4147"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4148" data-line-number="4148"></td>
        <td id="LC4148">CORINFO_METHOD_HANDLE <span>CEEInfo::mapMethodDeclToMethodImpl</span>(CORINFO_METHOD_HANDLE methHnd)</td>
      </tr>
      <tr>
        <td id="L4149" data-line-number="4149"></td>
        <td id="LC4149">{</td>
      </tr>
      <tr>
        <td id="L4150" data-line-number="4150"></td>
        <td id="LC4150">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4151" data-line-number="4151"></td>
        <td id="LC4151">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4152" data-line-number="4152"></td>
        <td id="LC4152">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4153" data-line-number="4153"></td>
        <td id="LC4153">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4154" data-line-number="4154"></td>
        <td id="LC4154">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4155" data-line-number="4155"></td>
        <td id="LC4155">
</td>
      </tr>
      <tr>
        <td id="L4156" data-line-number="4156"></td>
        <td id="LC4156">    CORINFO_METHOD_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L4157" data-line-number="4157"></td>
        <td id="LC4157">
</td>
      </tr>
      <tr>
        <td id="L4158" data-line-number="4158"></td>
        <td id="LC4158">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4159" data-line-number="4159"></td>
        <td id="LC4159">
</td>
      </tr>
      <tr>
        <td id="L4160" data-line-number="4160"></td>
        <td id="LC4160">    MethodDesc *pMD = <span>GetMethod</span>(methHnd);</td>
      </tr>
      <tr>
        <td id="L4161" data-line-number="4161"></td>
        <td id="LC4161">    pMD = <span>MethodTable::MapMethodDeclToMethodImpl</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L4162" data-line-number="4162"></td>
        <td id="LC4162">    result = (CORINFO_METHOD_HANDLE) pMD;</td>
      </tr>
      <tr>
        <td id="L4163" data-line-number="4163"></td>
        <td id="LC4163">
</td>
      </tr>
      <tr>
        <td id="L4164" data-line-number="4164"></td>
        <td id="LC4164">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4165" data-line-number="4165"></td>
        <td id="LC4165">
</td>
      </tr>
      <tr>
        <td id="L4166" data-line-number="4166"></td>
        <td id="LC4166">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4167" data-line-number="4167"></td>
        <td id="LC4167">}</td>
      </tr>
      <tr>
        <td id="L4168" data-line-number="4168"></td>
        <td id="LC4168">
</td>
      </tr>
      <tr>
        <td id="L4169" data-line-number="4169"></td>
        <td id="LC4169"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4170" data-line-number="4170"></td>
        <td id="LC4170">CORINFO_CLASS_HANDLE <span>CEEInfo::getBuiltinClass</span>(CorInfoClassId classId)</td>
      </tr>
      <tr>
        <td id="L4171" data-line-number="4171"></td>
        <td id="LC4171">{</td>
      </tr>
      <tr>
        <td id="L4172" data-line-number="4172"></td>
        <td id="LC4172">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4173" data-line-number="4173"></td>
        <td id="LC4173">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4174" data-line-number="4174"></td>
        <td id="LC4174">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4175" data-line-number="4175"></td>
        <td id="LC4175">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4176" data-line-number="4176"></td>
        <td id="LC4176">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4177" data-line-number="4177"></td>
        <td id="LC4177">
</td>
      </tr>
      <tr>
        <td id="L4178" data-line-number="4178"></td>
        <td id="LC4178">    CORINFO_CLASS_HANDLE result = (CORINFO_CLASS_HANDLE) <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L4179" data-line-number="4179"></td>
        <td id="LC4179">
</td>
      </tr>
      <tr>
        <td id="L4180" data-line-number="4180"></td>
        <td id="LC4180">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4181" data-line-number="4181"></td>
        <td id="LC4181">
</td>
      </tr>
      <tr>
        <td id="L4182" data-line-number="4182"></td>
        <td id="LC4182">    <span>switch</span> (classId)</td>
      </tr>
      <tr>
        <td id="L4183" data-line-number="4183"></td>
        <td id="LC4183">    {</td>
      </tr>
      <tr>
        <td id="L4184" data-line-number="4184"></td>
        <td id="LC4184">    <span>case</span> CLASSID_SYSTEM_OBJECT:</td>
      </tr>
      <tr>
        <td id="L4185" data-line-number="4185"></td>
        <td id="LC4185">        result = <span>CORINFO_CLASS_HANDLE</span>(g_pObjectClass);</td>
      </tr>
      <tr>
        <td id="L4186" data-line-number="4186"></td>
        <td id="LC4186">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4187" data-line-number="4187"></td>
        <td id="LC4187">    <span>case</span> CLASSID_TYPED_BYREF:</td>
      </tr>
      <tr>
        <td id="L4188" data-line-number="4188"></td>
        <td id="LC4188">        result = <span>CORINFO_CLASS_HANDLE</span>(g_TypedReferenceMT);</td>
      </tr>
      <tr>
        <td id="L4189" data-line-number="4189"></td>
        <td id="LC4189">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4190" data-line-number="4190"></td>
        <td id="LC4190">    <span>case</span> CLASSID_TYPE_HANDLE:</td>
      </tr>
      <tr>
        <td id="L4191" data-line-number="4191"></td>
        <td id="LC4191">        result = <span>CORINFO_CLASS_HANDLE</span>(<span>MscorlibBinder::GetClass</span>(CLASS__TYPE_HANDLE));</td>
      </tr>
      <tr>
        <td id="L4192" data-line-number="4192"></td>
        <td id="LC4192">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4193" data-line-number="4193"></td>
        <td id="LC4193">    <span>case</span> CLASSID_FIELD_HANDLE:</td>
      </tr>
      <tr>
        <td id="L4194" data-line-number="4194"></td>
        <td id="LC4194">        result = <span>CORINFO_CLASS_HANDLE</span>(<span>MscorlibBinder::GetClass</span>(CLASS__FIELD_HANDLE));</td>
      </tr>
      <tr>
        <td id="L4195" data-line-number="4195"></td>
        <td id="LC4195">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4196" data-line-number="4196"></td>
        <td id="LC4196">    <span>case</span> CLASSID_METHOD_HANDLE:</td>
      </tr>
      <tr>
        <td id="L4197" data-line-number="4197"></td>
        <td id="LC4197">        result = <span>CORINFO_CLASS_HANDLE</span>(<span>MscorlibBinder::GetClass</span>(CLASS__METHOD_HANDLE));</td>
      </tr>
      <tr>
        <td id="L4198" data-line-number="4198"></td>
        <td id="LC4198">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4199" data-line-number="4199"></td>
        <td id="LC4199">    <span>case</span> CLASSID_ARGUMENT_HANDLE:</td>
      </tr>
      <tr>
        <td id="L4200" data-line-number="4200"></td>
        <td id="LC4200">        result = <span>CORINFO_CLASS_HANDLE</span>(<span>MscorlibBinder::GetClass</span>(CLASS__ARGUMENT_HANDLE));</td>
      </tr>
      <tr>
        <td id="L4201" data-line-number="4201"></td>
        <td id="LC4201">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4202" data-line-number="4202"></td>
        <td id="LC4202">    <span>case</span> CLASSID_STRING:</td>
      </tr>
      <tr>
        <td id="L4203" data-line-number="4203"></td>
        <td id="LC4203">        result = <span>CORINFO_CLASS_HANDLE</span>(g_pStringClass);</td>
      </tr>
      <tr>
        <td id="L4204" data-line-number="4204"></td>
        <td id="LC4204">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4205" data-line-number="4205"></td>
        <td id="LC4205">    <span>case</span> CLASSID_RUNTIME_TYPE:</td>
      </tr>
      <tr>
        <td id="L4206" data-line-number="4206"></td>
        <td id="LC4206">        result = <span>CORINFO_CLASS_HANDLE</span>(g_pRuntimeTypeClass);</td>
      </tr>
      <tr>
        <td id="L4207" data-line-number="4207"></td>
        <td id="LC4207">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4208" data-line-number="4208"></td>
        <td id="LC4208">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L4209" data-line-number="4209"></td>
        <td id="LC4209">        <span>_ASSERTE</span>(!<span><span>"</span>NYI: unknown classId<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L4210" data-line-number="4210"></td>
        <td id="LC4210">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4211" data-line-number="4211"></td>
        <td id="LC4211">    }</td>
      </tr>
      <tr>
        <td id="L4212" data-line-number="4212"></td>
        <td id="LC4212">
</td>
      </tr>
      <tr>
        <td id="L4213" data-line-number="4213"></td>
        <td id="LC4213">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4214" data-line-number="4214"></td>
        <td id="LC4214">
</td>
      </tr>
      <tr>
        <td id="L4215" data-line-number="4215"></td>
        <td id="LC4215">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4216" data-line-number="4216"></td>
        <td id="LC4216">}</td>
      </tr>
      <tr>
        <td id="L4217" data-line-number="4217"></td>
        <td id="LC4217">
</td>
      </tr>
      <tr>
        <td id="L4218" data-line-number="4218"></td>
        <td id="LC4218">
</td>
      </tr>
      <tr>
        <td id="L4219" data-line-number="4219"></td>
        <td id="LC4219">
</td>
      </tr>
      <tr>
        <td id="L4220" data-line-number="4220"></td>
        <td id="LC4220"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4221" data-line-number="4221"></td>
        <td id="LC4221">CorInfoType <span>CEEInfo::getTypeForPrimitiveValueClass</span>(</td>
      </tr>
      <tr>
        <td id="L4222" data-line-number="4222"></td>
        <td id="LC4222">        CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L4223" data-line-number="4223"></td>
        <td id="LC4223">{</td>
      </tr>
      <tr>
        <td id="L4224" data-line-number="4224"></td>
        <td id="LC4224">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4225" data-line-number="4225"></td>
        <td id="LC4225">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4226" data-line-number="4226"></td>
        <td id="LC4226">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4227" data-line-number="4227"></td>
        <td id="LC4227">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4228" data-line-number="4228"></td>
        <td id="LC4228">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4229" data-line-number="4229"></td>
        <td id="LC4229">
</td>
      </tr>
      <tr>
        <td id="L4230" data-line-number="4230"></td>
        <td id="LC4230">    CorInfoType result = CORINFO_TYPE_UNDEF;</td>
      </tr>
      <tr>
        <td id="L4231" data-line-number="4231"></td>
        <td id="LC4231">
</td>
      </tr>
      <tr>
        <td id="L4232" data-line-number="4232"></td>
        <td id="LC4232">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4233" data-line-number="4233"></td>
        <td id="LC4233">
</td>
      </tr>
      <tr>
        <td id="L4234" data-line-number="4234"></td>
        <td id="LC4234">    TypeHandle <span>th</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L4235" data-line-number="4235"></td>
        <td id="LC4235">    <span>_ASSERTE</span> (!th.<span>IsGenericVariable</span>());</td>
      </tr>
      <tr>
        <td id="L4236" data-line-number="4236"></td>
        <td id="LC4236">
</td>
      </tr>
      <tr>
        <td id="L4237" data-line-number="4237"></td>
        <td id="LC4237">    MethodTable    *pMT = th.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L4238" data-line-number="4238"></td>
        <td id="LC4238">    <span>PREFIX_ASSUME</span>(pMT != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L4239" data-line-number="4239"></td>
        <td id="LC4239">
</td>
      </tr>
      <tr>
        <td id="L4240" data-line-number="4240"></td>
        <td id="LC4240">    <span><span>//</span> Is it a non primitive struct such as</span></td>
      </tr>
      <tr>
        <td id="L4241" data-line-number="4241"></td>
        <td id="LC4241">    <span><span>//</span> RuntimeTypeHandle, RuntimeMethodHandle, RuntimeArgHandle?</span></td>
      </tr>
      <tr>
        <td id="L4242" data-line-number="4242"></td>
        <td id="LC4242">    <span>if</span> (pMT-&gt;<span>IsValueType</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L4243" data-line-number="4243"></td>
        <td id="LC4243">        !pMT-&gt;<span>IsTruePrimitive</span>()  &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L4244" data-line-number="4244"></td>
        <td id="LC4244">        !pMT-&gt;<span>IsEnum</span>())</td>
      </tr>
      <tr>
        <td id="L4245" data-line-number="4245"></td>
        <td id="LC4245">    {</td>
      </tr>
      <tr>
        <td id="L4246" data-line-number="4246"></td>
        <td id="LC4246">        <span><span>//</span> default value CORINFO_TYPE_UNDEF is what we want</span></td>
      </tr>
      <tr>
        <td id="L4247" data-line-number="4247"></td>
        <td id="LC4247">    }</td>
      </tr>
      <tr>
        <td id="L4248" data-line-number="4248"></td>
        <td id="LC4248">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L4249" data-line-number="4249"></td>
        <td id="LC4249">    {</td>
      </tr>
      <tr>
        <td id="L4250" data-line-number="4250"></td>
        <td id="LC4250">        <span>switch</span> (th.<span>GetInternalCorElementType</span>())</td>
      </tr>
      <tr>
        <td id="L4251" data-line-number="4251"></td>
        <td id="LC4251">        {</td>
      </tr>
      <tr>
        <td id="L4252" data-line-number="4252"></td>
        <td id="LC4252">        <span>case</span> ELEMENT_TYPE_I1:</td>
      </tr>
      <tr>
        <td id="L4253" data-line-number="4253"></td>
        <td id="LC4253">        <span>case</span> ELEMENT_TYPE_U1:</td>
      </tr>
      <tr>
        <td id="L4254" data-line-number="4254"></td>
        <td id="LC4254">        <span>case</span> ELEMENT_TYPE_BOOLEAN:</td>
      </tr>
      <tr>
        <td id="L4255" data-line-number="4255"></td>
        <td id="LC4255">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_I1);</td>
      </tr>
      <tr>
        <td id="L4256" data-line-number="4256"></td>
        <td id="LC4256">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4257" data-line-number="4257"></td>
        <td id="LC4257">
</td>
      </tr>
      <tr>
        <td id="L4258" data-line-number="4258"></td>
        <td id="LC4258">        <span>case</span> ELEMENT_TYPE_I2:</td>
      </tr>
      <tr>
        <td id="L4259" data-line-number="4259"></td>
        <td id="LC4259">        <span>case</span> ELEMENT_TYPE_U2:</td>
      </tr>
      <tr>
        <td id="L4260" data-line-number="4260"></td>
        <td id="LC4260">        <span>case</span> ELEMENT_TYPE_CHAR:</td>
      </tr>
      <tr>
        <td id="L4261" data-line-number="4261"></td>
        <td id="LC4261">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_I2);</td>
      </tr>
      <tr>
        <td id="L4262" data-line-number="4262"></td>
        <td id="LC4262">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4263" data-line-number="4263"></td>
        <td id="LC4263">
</td>
      </tr>
      <tr>
        <td id="L4264" data-line-number="4264"></td>
        <td id="LC4264">        <span>case</span> ELEMENT_TYPE_I4:</td>
      </tr>
      <tr>
        <td id="L4265" data-line-number="4265"></td>
        <td id="LC4265">        <span>case</span> ELEMENT_TYPE_U4:</td>
      </tr>
      <tr>
        <td id="L4266" data-line-number="4266"></td>
        <td id="LC4266">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_I4);</td>
      </tr>
      <tr>
        <td id="L4267" data-line-number="4267"></td>
        <td id="LC4267">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4268" data-line-number="4268"></td>
        <td id="LC4268">
</td>
      </tr>
      <tr>
        <td id="L4269" data-line-number="4269"></td>
        <td id="LC4269">        <span>case</span> ELEMENT_TYPE_I8:</td>
      </tr>
      <tr>
        <td id="L4270" data-line-number="4270"></td>
        <td id="LC4270">        <span>case</span> ELEMENT_TYPE_U8:</td>
      </tr>
      <tr>
        <td id="L4271" data-line-number="4271"></td>
        <td id="LC4271">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_I8);</td>
      </tr>
      <tr>
        <td id="L4272" data-line-number="4272"></td>
        <td id="LC4272">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4273" data-line-number="4273"></td>
        <td id="LC4273">
</td>
      </tr>
      <tr>
        <td id="L4274" data-line-number="4274"></td>
        <td id="LC4274">        <span>case</span> ELEMENT_TYPE_I:</td>
      </tr>
      <tr>
        <td id="L4275" data-line-number="4275"></td>
        <td id="LC4275">        <span>case</span> ELEMENT_TYPE_U:</td>
      </tr>
      <tr>
        <td id="L4276" data-line-number="4276"></td>
        <td id="LC4276">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_I);</td>
      </tr>
      <tr>
        <td id="L4277" data-line-number="4277"></td>
        <td id="LC4277">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4278" data-line-number="4278"></td>
        <td id="LC4278">
</td>
      </tr>
      <tr>
        <td id="L4279" data-line-number="4279"></td>
        <td id="LC4279">        <span>case</span> ELEMENT_TYPE_R4:</td>
      </tr>
      <tr>
        <td id="L4280" data-line-number="4280"></td>
        <td id="LC4280">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_R4);</td>
      </tr>
      <tr>
        <td id="L4281" data-line-number="4281"></td>
        <td id="LC4281">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4282" data-line-number="4282"></td>
        <td id="LC4282">
</td>
      </tr>
      <tr>
        <td id="L4283" data-line-number="4283"></td>
        <td id="LC4283">        <span>case</span> ELEMENT_TYPE_R8:</td>
      </tr>
      <tr>
        <td id="L4284" data-line-number="4284"></td>
        <td id="LC4284">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_R8);</td>
      </tr>
      <tr>
        <td id="L4285" data-line-number="4285"></td>
        <td id="LC4285">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4286" data-line-number="4286"></td>
        <td id="LC4286">
</td>
      </tr>
      <tr>
        <td id="L4287" data-line-number="4287"></td>
        <td id="LC4287">        <span>case</span> ELEMENT_TYPE_VOID:</td>
      </tr>
      <tr>
        <td id="L4288" data-line-number="4288"></td>
        <td id="LC4288">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_VOID);</td>
      </tr>
      <tr>
        <td id="L4289" data-line-number="4289"></td>
        <td id="LC4289">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4290" data-line-number="4290"></td>
        <td id="LC4290">
</td>
      </tr>
      <tr>
        <td id="L4291" data-line-number="4291"></td>
        <td id="LC4291">        <span>case</span> ELEMENT_TYPE_PTR:</td>
      </tr>
      <tr>
        <td id="L4292" data-line-number="4292"></td>
        <td id="LC4292">        <span>case</span> ELEMENT_TYPE_FNPTR:</td>
      </tr>
      <tr>
        <td id="L4293" data-line-number="4293"></td>
        <td id="LC4293">            result = <span>asCorInfoType</span>(ELEMENT_TYPE_PTR);</td>
      </tr>
      <tr>
        <td id="L4294" data-line-number="4294"></td>
        <td id="LC4294">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4295" data-line-number="4295"></td>
        <td id="LC4295">
</td>
      </tr>
      <tr>
        <td id="L4296" data-line-number="4296"></td>
        <td id="LC4296">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L4297" data-line-number="4297"></td>
        <td id="LC4297">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4298" data-line-number="4298"></td>
        <td id="LC4298">        }</td>
      </tr>
      <tr>
        <td id="L4299" data-line-number="4299"></td>
        <td id="LC4299">    }</td>
      </tr>
      <tr>
        <td id="L4300" data-line-number="4300"></td>
        <td id="LC4300">
</td>
      </tr>
      <tr>
        <td id="L4301" data-line-number="4301"></td>
        <td id="LC4301">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4302" data-line-number="4302"></td>
        <td id="LC4302">
</td>
      </tr>
      <tr>
        <td id="L4303" data-line-number="4303"></td>
        <td id="LC4303">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4304" data-line-number="4304"></td>
        <td id="LC4304">}</td>
      </tr>
      <tr>
        <td id="L4305" data-line-number="4305"></td>
        <td id="LC4305">
</td>
      </tr>
      <tr>
        <td id="L4306" data-line-number="4306"></td>
        <td id="LC4306"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4307" data-line-number="4307"></td>
        <td id="LC4307">CorInfoType <span>CEEInfo::getTypeForPrimitiveNumericClass</span>(</td>
      </tr>
      <tr>
        <td id="L4308" data-line-number="4308"></td>
        <td id="LC4308">        CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L4309" data-line-number="4309"></td>
        <td id="LC4309">{</td>
      </tr>
      <tr>
        <td id="L4310" data-line-number="4310"></td>
        <td id="LC4310">    CONTRACTL{</td>
      </tr>
      <tr>
        <td id="L4311" data-line-number="4311"></td>
        <td id="LC4311">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L4312" data-line-number="4312"></td>
        <td id="LC4312">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L4313" data-line-number="4313"></td>
        <td id="LC4313">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4314" data-line-number="4314"></td>
        <td id="LC4314">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4315" data-line-number="4315"></td>
        <td id="LC4315">
</td>
      </tr>
      <tr>
        <td id="L4316" data-line-number="4316"></td>
        <td id="LC4316">    CorInfoType result = CORINFO_TYPE_UNDEF;</td>
      </tr>
      <tr>
        <td id="L4317" data-line-number="4317"></td>
        <td id="LC4317">
</td>
      </tr>
      <tr>
        <td id="L4318" data-line-number="4318"></td>
        <td id="LC4318">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L4319" data-line-number="4319"></td>
        <td id="LC4319">
</td>
      </tr>
      <tr>
        <td id="L4320" data-line-number="4320"></td>
        <td id="LC4320">    TypeHandle <span>th</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L4321" data-line-number="4321"></td>
        <td id="LC4321">    <span>_ASSERTE</span> (!th.<span>IsGenericVariable</span>());</td>
      </tr>
      <tr>
        <td id="L4322" data-line-number="4322"></td>
        <td id="LC4322">
</td>
      </tr>
      <tr>
        <td id="L4323" data-line-number="4323"></td>
        <td id="LC4323">    CorElementType ty = th.<span>GetSignatureCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L4324" data-line-number="4324"></td>
        <td id="LC4324">    <span>switch</span> (ty)</td>
      </tr>
      <tr>
        <td id="L4325" data-line-number="4325"></td>
        <td id="LC4325">    {</td>
      </tr>
      <tr>
        <td id="L4326" data-line-number="4326"></td>
        <td id="LC4326">    <span>case</span> ELEMENT_TYPE_I1:</td>
      </tr>
      <tr>
        <td id="L4327" data-line-number="4327"></td>
        <td id="LC4327">        result = CORINFO_TYPE_BYTE;</td>
      </tr>
      <tr>
        <td id="L4328" data-line-number="4328"></td>
        <td id="LC4328">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4329" data-line-number="4329"></td>
        <td id="LC4329">    <span>case</span> ELEMENT_TYPE_U1:</td>
      </tr>
      <tr>
        <td id="L4330" data-line-number="4330"></td>
        <td id="LC4330">        result = CORINFO_TYPE_UBYTE;</td>
      </tr>
      <tr>
        <td id="L4331" data-line-number="4331"></td>
        <td id="LC4331">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4332" data-line-number="4332"></td>
        <td id="LC4332">    <span>case</span> ELEMENT_TYPE_I2:</td>
      </tr>
      <tr>
        <td id="L4333" data-line-number="4333"></td>
        <td id="LC4333">        result = CORINFO_TYPE_SHORT;</td>
      </tr>
      <tr>
        <td id="L4334" data-line-number="4334"></td>
        <td id="LC4334">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4335" data-line-number="4335"></td>
        <td id="LC4335">    <span>case</span> ELEMENT_TYPE_U2:</td>
      </tr>
      <tr>
        <td id="L4336" data-line-number="4336"></td>
        <td id="LC4336">        result = CORINFO_TYPE_USHORT;</td>
      </tr>
      <tr>
        <td id="L4337" data-line-number="4337"></td>
        <td id="LC4337">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4338" data-line-number="4338"></td>
        <td id="LC4338">    <span>case</span> ELEMENT_TYPE_I4:</td>
      </tr>
      <tr>
        <td id="L4339" data-line-number="4339"></td>
        <td id="LC4339">        result = CORINFO_TYPE_INT;</td>
      </tr>
      <tr>
        <td id="L4340" data-line-number="4340"></td>
        <td id="LC4340">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4341" data-line-number="4341"></td>
        <td id="LC4341">    <span>case</span> ELEMENT_TYPE_U4:</td>
      </tr>
      <tr>
        <td id="L4342" data-line-number="4342"></td>
        <td id="LC4342">        result = CORINFO_TYPE_UINT;</td>
      </tr>
      <tr>
        <td id="L4343" data-line-number="4343"></td>
        <td id="LC4343">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4344" data-line-number="4344"></td>
        <td id="LC4344">    <span>case</span> ELEMENT_TYPE_I8:</td>
      </tr>
      <tr>
        <td id="L4345" data-line-number="4345"></td>
        <td id="LC4345">        result = CORINFO_TYPE_LONG;</td>
      </tr>
      <tr>
        <td id="L4346" data-line-number="4346"></td>
        <td id="LC4346">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4347" data-line-number="4347"></td>
        <td id="LC4347">    <span>case</span> ELEMENT_TYPE_U8:</td>
      </tr>
      <tr>
        <td id="L4348" data-line-number="4348"></td>
        <td id="LC4348">        result = CORINFO_TYPE_ULONG;</td>
      </tr>
      <tr>
        <td id="L4349" data-line-number="4349"></td>
        <td id="LC4349">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4350" data-line-number="4350"></td>
        <td id="LC4350">    <span>case</span> ELEMENT_TYPE_R4:</td>
      </tr>
      <tr>
        <td id="L4351" data-line-number="4351"></td>
        <td id="LC4351">        result = CORINFO_TYPE_FLOAT;</td>
      </tr>
      <tr>
        <td id="L4352" data-line-number="4352"></td>
        <td id="LC4352">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4353" data-line-number="4353"></td>
        <td id="LC4353">    <span>case</span> ELEMENT_TYPE_R8:</td>
      </tr>
      <tr>
        <td id="L4354" data-line-number="4354"></td>
        <td id="LC4354">        result = CORINFO_TYPE_DOUBLE;</td>
      </tr>
      <tr>
        <td id="L4355" data-line-number="4355"></td>
        <td id="LC4355">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4356" data-line-number="4356"></td>
        <td id="LC4356">
</td>
      </tr>
      <tr>
        <td id="L4357" data-line-number="4357"></td>
        <td id="LC4357">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L4358" data-line-number="4358"></td>
        <td id="LC4358">        <span><span>//</span> Error case, we will return CORINFO_TYPE_UNDEF</span></td>
      </tr>
      <tr>
        <td id="L4359" data-line-number="4359"></td>
        <td id="LC4359">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L4360" data-line-number="4360"></td>
        <td id="LC4360">    }</td>
      </tr>
      <tr>
        <td id="L4361" data-line-number="4361"></td>
        <td id="LC4361">
</td>
      </tr>
      <tr>
        <td id="L4362" data-line-number="4362"></td>
        <td id="LC4362">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L4363" data-line-number="4363"></td>
        <td id="LC4363">
</td>
      </tr>
      <tr>
        <td id="L4364" data-line-number="4364"></td>
        <td id="LC4364">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4365" data-line-number="4365"></td>
        <td id="LC4365">}</td>
      </tr>
      <tr>
        <td id="L4366" data-line-number="4366"></td>
        <td id="LC4366">
</td>
      </tr>
      <tr>
        <td id="L4367" data-line-number="4367"></td>
        <td id="LC4367">
</td>
      </tr>
      <tr>
        <td id="L4368" data-line-number="4368"></td>
        <td id="LC4368"><span>void</span> <span>CEEInfo::getGSCookie</span>(GSCookie * pCookieVal, GSCookie ** ppCookieVal)</td>
      </tr>
      <tr>
        <td id="L4369" data-line-number="4369"></td>
        <td id="LC4369">{</td>
      </tr>
      <tr>
        <td id="L4370" data-line-number="4370"></td>
        <td id="LC4370">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4371" data-line-number="4371"></td>
        <td id="LC4371">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4372" data-line-number="4372"></td>
        <td id="LC4372">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4373" data-line-number="4373"></td>
        <td id="LC4373">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4374" data-line-number="4374"></td>
        <td id="LC4374">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4375" data-line-number="4375"></td>
        <td id="LC4375">
</td>
      </tr>
      <tr>
        <td id="L4376" data-line-number="4376"></td>
        <td id="LC4376">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4377" data-line-number="4377"></td>
        <td id="LC4377">
</td>
      </tr>
      <tr>
        <td id="L4378" data-line-number="4378"></td>
        <td id="LC4378">    <span>if</span> (pCookieVal)</td>
      </tr>
      <tr>
        <td id="L4379" data-line-number="4379"></td>
        <td id="LC4379">    {</td>
      </tr>
      <tr>
        <td id="L4380" data-line-number="4380"></td>
        <td id="LC4380">        *pCookieVal = <span>GetProcessGSCookie</span>();</td>
      </tr>
      <tr>
        <td id="L4381" data-line-number="4381"></td>
        <td id="LC4381">        *ppCookieVal = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L4382" data-line-number="4382"></td>
        <td id="LC4382">    }</td>
      </tr>
      <tr>
        <td id="L4383" data-line-number="4383"></td>
        <td id="LC4383">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L4384" data-line-number="4384"></td>
        <td id="LC4384">    {</td>
      </tr>
      <tr>
        <td id="L4385" data-line-number="4385"></td>
        <td id="LC4385">        *ppCookieVal = <span>GetProcessGSCookiePtr</span>();</td>
      </tr>
      <tr>
        <td id="L4386" data-line-number="4386"></td>
        <td id="LC4386">    }</td>
      </tr>
      <tr>
        <td id="L4387" data-line-number="4387"></td>
        <td id="LC4387">
</td>
      </tr>
      <tr>
        <td id="L4388" data-line-number="4388"></td>
        <td id="LC4388">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4389" data-line-number="4389"></td>
        <td id="LC4389">}</td>
      </tr>
      <tr>
        <td id="L4390" data-line-number="4390"></td>
        <td id="LC4390">
</td>
      </tr>
      <tr>
        <td id="L4391" data-line-number="4391"></td>
        <td id="LC4391">
</td>
      </tr>
      <tr>
        <td id="L4392" data-line-number="4392"></td>
        <td id="LC4392"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4393" data-line-number="4393"></td>
        <td id="LC4393"><span><span>//</span> TRUE if child is a subtype of parent</span></td>
      </tr>
      <tr>
        <td id="L4394" data-line-number="4394"></td>
        <td id="LC4394"><span><span>//</span> if parent is an interface, then does child implement / extend parent</span></td>
      </tr>
      <tr>
        <td id="L4395" data-line-number="4395"></td>
        <td id="LC4395">BOOL <span>CEEInfo::canCast</span>(</td>
      </tr>
      <tr>
        <td id="L4396" data-line-number="4396"></td>
        <td id="LC4396">        CORINFO_CLASS_HANDLE        child,</td>
      </tr>
      <tr>
        <td id="L4397" data-line-number="4397"></td>
        <td id="LC4397">        CORINFO_CLASS_HANDLE        parent)</td>
      </tr>
      <tr>
        <td id="L4398" data-line-number="4398"></td>
        <td id="LC4398">{</td>
      </tr>
      <tr>
        <td id="L4399" data-line-number="4399"></td>
        <td id="LC4399">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4400" data-line-number="4400"></td>
        <td id="LC4400">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4401" data-line-number="4401"></td>
        <td id="LC4401">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4402" data-line-number="4402"></td>
        <td id="LC4402">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4403" data-line-number="4403"></td>
        <td id="LC4403">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4404" data-line-number="4404"></td>
        <td id="LC4404">
</td>
      </tr>
      <tr>
        <td id="L4405" data-line-number="4405"></td>
        <td id="LC4405">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L4406" data-line-number="4406"></td>
        <td id="LC4406">
</td>
      </tr>
      <tr>
        <td id="L4407" data-line-number="4407"></td>
        <td id="LC4407">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4408" data-line-number="4408"></td>
        <td id="LC4408">
</td>
      </tr>
      <tr>
        <td id="L4409" data-line-number="4409"></td>
        <td id="LC4409">    result = ((TypeHandle)child).<span>CanCastTo</span>((TypeHandle)parent);</td>
      </tr>
      <tr>
        <td id="L4410" data-line-number="4410"></td>
        <td id="LC4410">
</td>
      </tr>
      <tr>
        <td id="L4411" data-line-number="4411"></td>
        <td id="LC4411">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4412" data-line-number="4412"></td>
        <td id="LC4412">
</td>
      </tr>
      <tr>
        <td id="L4413" data-line-number="4413"></td>
        <td id="LC4413">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4414" data-line-number="4414"></td>
        <td id="LC4414">}</td>
      </tr>
      <tr>
        <td id="L4415" data-line-number="4415"></td>
        <td id="LC4415">
</td>
      </tr>
      <tr>
        <td id="L4416" data-line-number="4416"></td>
        <td id="LC4416"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4417" data-line-number="4417"></td>
        <td id="LC4417"><span><span>//</span> TRUE if cls1 and cls2 are considered equivalent types.</span></td>
      </tr>
      <tr>
        <td id="L4418" data-line-number="4418"></td>
        <td id="LC4418">BOOL <span>CEEInfo::areTypesEquivalent</span>(</td>
      </tr>
      <tr>
        <td id="L4419" data-line-number="4419"></td>
        <td id="LC4419">        CORINFO_CLASS_HANDLE        cls1,</td>
      </tr>
      <tr>
        <td id="L4420" data-line-number="4420"></td>
        <td id="LC4420">        CORINFO_CLASS_HANDLE        cls2)</td>
      </tr>
      <tr>
        <td id="L4421" data-line-number="4421"></td>
        <td id="LC4421">{</td>
      </tr>
      <tr>
        <td id="L4422" data-line-number="4422"></td>
        <td id="LC4422">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4423" data-line-number="4423"></td>
        <td id="LC4423">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4424" data-line-number="4424"></td>
        <td id="LC4424">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4425" data-line-number="4425"></td>
        <td id="LC4425">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4426" data-line-number="4426"></td>
        <td id="LC4426">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4427" data-line-number="4427"></td>
        <td id="LC4427">
</td>
      </tr>
      <tr>
        <td id="L4428" data-line-number="4428"></td>
        <td id="LC4428">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L4429" data-line-number="4429"></td>
        <td id="LC4429">
</td>
      </tr>
      <tr>
        <td id="L4430" data-line-number="4430"></td>
        <td id="LC4430">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4431" data-line-number="4431"></td>
        <td id="LC4431">
</td>
      </tr>
      <tr>
        <td id="L4432" data-line-number="4432"></td>
        <td id="LC4432">    result = ((TypeHandle)cls1).<span>IsEquivalentTo</span>((TypeHandle)cls2);</td>
      </tr>
      <tr>
        <td id="L4433" data-line-number="4433"></td>
        <td id="LC4433">
</td>
      </tr>
      <tr>
        <td id="L4434" data-line-number="4434"></td>
        <td id="LC4434">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4435" data-line-number="4435"></td>
        <td id="LC4435">
</td>
      </tr>
      <tr>
        <td id="L4436" data-line-number="4436"></td>
        <td id="LC4436">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4437" data-line-number="4437"></td>
        <td id="LC4437">}</td>
      </tr>
      <tr>
        <td id="L4438" data-line-number="4438"></td>
        <td id="LC4438">
</td>
      </tr>
      <tr>
        <td id="L4439" data-line-number="4439"></td>
        <td id="LC4439"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4440" data-line-number="4440"></td>
        <td id="LC4440"><span><span>//</span> See if a cast from fromClass to toClass will succeed, fail, or needs</span></td>
      </tr>
      <tr>
        <td id="L4441" data-line-number="4441"></td>
        <td id="LC4441"><span><span>//</span> to be resolved at runtime.</span></td>
      </tr>
      <tr>
        <td id="L4442" data-line-number="4442"></td>
        <td id="LC4442">TypeCompareState <span>CEEInfo::compareTypesForCast</span>(</td>
      </tr>
      <tr>
        <td id="L4443" data-line-number="4443"></td>
        <td id="LC4443">        CORINFO_CLASS_HANDLE        fromClass,</td>
      </tr>
      <tr>
        <td id="L4444" data-line-number="4444"></td>
        <td id="LC4444">        CORINFO_CLASS_HANDLE        toClass)</td>
      </tr>
      <tr>
        <td id="L4445" data-line-number="4445"></td>
        <td id="LC4445">{</td>
      </tr>
      <tr>
        <td id="L4446" data-line-number="4446"></td>
        <td id="LC4446">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4447" data-line-number="4447"></td>
        <td id="LC4447">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4448" data-line-number="4448"></td>
        <td id="LC4448">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4449" data-line-number="4449"></td>
        <td id="LC4449">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4450" data-line-number="4450"></td>
        <td id="LC4450">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4451" data-line-number="4451"></td>
        <td id="LC4451">
</td>
      </tr>
      <tr>
        <td id="L4452" data-line-number="4452"></td>
        <td id="LC4452">    TypeCompareState result = TypeCompareState::May;</td>
      </tr>
      <tr>
        <td id="L4453" data-line-number="4453"></td>
        <td id="LC4453">
</td>
      </tr>
      <tr>
        <td id="L4454" data-line-number="4454"></td>
        <td id="LC4454">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4455" data-line-number="4455"></td>
        <td id="LC4455">
</td>
      </tr>
      <tr>
        <td id="L4456" data-line-number="4456"></td>
        <td id="LC4456">    TypeHandle fromHnd = (TypeHandle) fromClass;</td>
      </tr>
      <tr>
        <td id="L4457" data-line-number="4457"></td>
        <td id="LC4457">    TypeHandle toHnd = (TypeHandle) toClass;</td>
      </tr>
      <tr>
        <td id="L4458" data-line-number="4458"></td>
        <td id="LC4458">
</td>
      </tr>
      <tr>
        <td id="L4459" data-line-number="4459"></td>
        <td id="LC4459">#<span>ifdef</span> FEATURE_COMINTEROP</td>
      </tr>
      <tr>
        <td id="L4460" data-line-number="4460"></td>
        <td id="LC4460">    <span><span>//</span> If casting from a com object class, don't try to optimize.</span></td>
      </tr>
      <tr>
        <td id="L4461" data-line-number="4461"></td>
        <td id="LC4461">    <span>if</span> (fromHnd.<span>IsComObjectType</span>())</td>
      </tr>
      <tr>
        <td id="L4462" data-line-number="4462"></td>
        <td id="LC4462">    {</td>
      </tr>
      <tr>
        <td id="L4463" data-line-number="4463"></td>
        <td id="LC4463">        result = TypeCompareState::May;</td>
      </tr>
      <tr>
        <td id="L4464" data-line-number="4464"></td>
        <td id="LC4464">    }</td>
      </tr>
      <tr>
        <td id="L4465" data-line-number="4465"></td>
        <td id="LC4465">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L4466" data-line-number="4466"></td>
        <td id="LC4466">#<span>endif</span> <span><span>//</span> FEATURE_COMINTEROP</span></td>
      </tr>
      <tr>
        <td id="L4467" data-line-number="4467"></td>
        <td id="LC4467">
</td>
      </tr>
      <tr>
        <td id="L4468" data-line-number="4468"></td>
        <td id="LC4468">    <span><span>//</span> If casting from ICastable, don't try to optimize</span></td>
      </tr>
      <tr>
        <td id="L4469" data-line-number="4469"></td>
        <td id="LC4469">    <span>if</span> (fromHnd.<span>GetMethodTable</span>()-&gt;<span>IsICastable</span>())</td>
      </tr>
      <tr>
        <td id="L4470" data-line-number="4470"></td>
        <td id="LC4470">    {</td>
      </tr>
      <tr>
        <td id="L4471" data-line-number="4471"></td>
        <td id="LC4471">        result = TypeCompareState::May;</td>
      </tr>
      <tr>
        <td id="L4472" data-line-number="4472"></td>
        <td id="LC4472">    }</td>
      </tr>
      <tr>
        <td id="L4473" data-line-number="4473"></td>
        <td id="LC4473">    <span><span>//</span> If casting to Nullable&lt;T&gt;, don't try to optimize</span></td>
      </tr>
      <tr>
        <td id="L4474" data-line-number="4474"></td>
        <td id="LC4474">    <span>else</span> <span>if</span> (<span>Nullable::IsNullableType</span>(toHnd))</td>
      </tr>
      <tr>
        <td id="L4475" data-line-number="4475"></td>
        <td id="LC4475">    {</td>
      </tr>
      <tr>
        <td id="L4476" data-line-number="4476"></td>
        <td id="LC4476">        result = TypeCompareState::May;</td>
      </tr>
      <tr>
        <td id="L4477" data-line-number="4477"></td>
        <td id="LC4477">    }</td>
      </tr>
      <tr>
        <td id="L4478" data-line-number="4478"></td>
        <td id="LC4478">    <span><span>//</span> If the types are not shared, we can check directly.</span></td>
      </tr>
      <tr>
        <td id="L4479" data-line-number="4479"></td>
        <td id="LC4479">    <span>else</span> <span>if</span> (!fromHnd.<span>IsCanonicalSubtype</span>() &amp;&amp; !toHnd.<span>IsCanonicalSubtype</span>())</td>
      </tr>
      <tr>
        <td id="L4480" data-line-number="4480"></td>
        <td id="LC4480">    {</td>
      </tr>
      <tr>
        <td id="L4481" data-line-number="4481"></td>
        <td id="LC4481">        result = fromHnd.<span>CanCastTo</span>(toHnd) ? TypeCompareState::Must : TypeCompareState::MustNot;</td>
      </tr>
      <tr>
        <td id="L4482" data-line-number="4482"></td>
        <td id="LC4482">    }</td>
      </tr>
      <tr>
        <td id="L4483" data-line-number="4483"></td>
        <td id="LC4483">    <span><span>//</span> Casting from a shared type to an unshared type.</span></td>
      </tr>
      <tr>
        <td id="L4484" data-line-number="4484"></td>
        <td id="LC4484">    <span>else</span> <span>if</span> (fromHnd.<span>IsCanonicalSubtype</span>() &amp;&amp; !toHnd.<span>IsCanonicalSubtype</span>())</td>
      </tr>
      <tr>
        <td id="L4485" data-line-number="4485"></td>
        <td id="LC4485">    {</td>
      </tr>
      <tr>
        <td id="L4486" data-line-number="4486"></td>
        <td id="LC4486">        <span><span>//</span> Only handle casts to interface types for now</span></td>
      </tr>
      <tr>
        <td id="L4487" data-line-number="4487"></td>
        <td id="LC4487">        <span>if</span> (toHnd.<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L4488" data-line-number="4488"></td>
        <td id="LC4488">        {</td>
      </tr>
      <tr>
        <td id="L4489" data-line-number="4489"></td>
        <td id="LC4489">            <span><span>//</span> Do a preliminary check.</span></td>
      </tr>
      <tr>
        <td id="L4490" data-line-number="4490"></td>
        <td id="LC4490">            BOOL canCast = fromHnd.<span>CanCastTo</span>(toHnd);</td>
      </tr>
      <tr>
        <td id="L4491" data-line-number="4491"></td>
        <td id="LC4491">
</td>
      </tr>
      <tr>
        <td id="L4492" data-line-number="4492"></td>
        <td id="LC4492">            <span><span>//</span> Pass back positive results unfiltered. The unknown type</span></td>
      </tr>
      <tr>
        <td id="L4493" data-line-number="4493"></td>
        <td id="LC4493">            <span><span>//</span> parameters in fromClass did not come into play.</span></td>
      </tr>
      <tr>
        <td id="L4494" data-line-number="4494"></td>
        <td id="LC4494">            <span>if</span> (canCast)</td>
      </tr>
      <tr>
        <td id="L4495" data-line-number="4495"></td>
        <td id="LC4495">            {</td>
      </tr>
      <tr>
        <td id="L4496" data-line-number="4496"></td>
        <td id="LC4496">                result = TypeCompareState::Must;</td>
      </tr>
      <tr>
        <td id="L4497" data-line-number="4497"></td>
        <td id="LC4497">            }</td>
      </tr>
      <tr>
        <td id="L4498" data-line-number="4498"></td>
        <td id="LC4498">            <span><span>//</span> For negative results, the unknown type parameter in</span></td>
      </tr>
      <tr>
        <td id="L4499" data-line-number="4499"></td>
        <td id="LC4499">            <span><span>//</span> fromClass might match some instantiated interface,</span></td>
      </tr>
      <tr>
        <td id="L4500" data-line-number="4500"></td>
        <td id="LC4500">            <span><span>//</span> either directly or via variance.</span></td>
      </tr>
      <tr>
        <td id="L4501" data-line-number="4501"></td>
        <td id="LC4501">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L4502" data-line-number="4502"></td>
        <td id="LC4502">            <span><span>//</span> However, CanCastTo will report failure in such cases since</span></td>
      </tr>
      <tr>
        <td id="L4503" data-line-number="4503"></td>
        <td id="LC4503">            <span><span>//</span> __Canon won't match the instantiated type on the</span></td>
      </tr>
      <tr>
        <td id="L4504" data-line-number="4504"></td>
        <td id="LC4504">            <span><span>//</span> interface (which can't be __Canon since we screened out</span></td>
      </tr>
      <tr>
        <td id="L4505" data-line-number="4505"></td>
        <td id="LC4505">            <span><span>//</span> canonical subtypes for toClass above). So only report</span></td>
      </tr>
      <tr>
        <td id="L4506" data-line-number="4506"></td>
        <td id="LC4506">            <span><span>//</span> failure if the interface is not instantiated.</span></td>
      </tr>
      <tr>
        <td id="L4507" data-line-number="4507"></td>
        <td id="LC4507">            <span>else</span> <span>if</span> (!toHnd.<span>HasInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L4508" data-line-number="4508"></td>
        <td id="LC4508">            {</td>
      </tr>
      <tr>
        <td id="L4509" data-line-number="4509"></td>
        <td id="LC4509">                result = TypeCompareState::MustNot;</td>
      </tr>
      <tr>
        <td id="L4510" data-line-number="4510"></td>
        <td id="LC4510">            }</td>
      </tr>
      <tr>
        <td id="L4511" data-line-number="4511"></td>
        <td id="LC4511">        }</td>
      </tr>
      <tr>
        <td id="L4512" data-line-number="4512"></td>
        <td id="LC4512">    }</td>
      </tr>
      <tr>
        <td id="L4513" data-line-number="4513"></td>
        <td id="LC4513">
</td>
      </tr>
      <tr>
        <td id="L4514" data-line-number="4514"></td>
        <td id="LC4514">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L4515" data-line-number="4515"></td>
        <td id="LC4515">    <span><span>//</span> In R2R it is a breaking change for a previously positive</span></td>
      </tr>
      <tr>
        <td id="L4516" data-line-number="4516"></td>
        <td id="LC4516">    <span><span>//</span> cast to become negative, but not for a previously negative</span></td>
      </tr>
      <tr>
        <td id="L4517" data-line-number="4517"></td>
        <td id="LC4517">    <span><span>//</span> cast to become positive. So in R2R a negative result is</span></td>
      </tr>
      <tr>
        <td id="L4518" data-line-number="4518"></td>
        <td id="LC4518">    <span><span>//</span> always reported back as May, except for CoreLib version bubble.</span></td>
      </tr>
      <tr>
        <td id="L4519" data-line-number="4519"></td>
        <td id="LC4519">    <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp; (result == TypeCompareState::MustNot)</td>
      </tr>
      <tr>
        <td id="L4520" data-line-number="4520"></td>
        <td id="LC4520">        &amp;&amp; !<span>GetAppDomain</span>()-&gt;<span>ToCompilationDomain</span>()-&gt;<span>GetTargetModule</span>()-&gt;<span>IsSystem</span>()</td>
      </tr>
      <tr>
        <td id="L4521" data-line-number="4521"></td>
        <td id="LC4521">        &amp;&amp; !<span>IsLargeVersionBubbleEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L4522" data-line-number="4522"></td>
        <td id="LC4522">    {</td>
      </tr>
      <tr>
        <td id="L4523" data-line-number="4523"></td>
        <td id="LC4523">        result = TypeCompareState::May;</td>
      </tr>
      <tr>
        <td id="L4524" data-line-number="4524"></td>
        <td id="LC4524">    }</td>
      </tr>
      <tr>
        <td id="L4525" data-line-number="4525"></td>
        <td id="LC4525">#<span>endif</span> <span><span>//</span> FEATURE_READYTORUN_COMPILER</span></td>
      </tr>
      <tr>
        <td id="L4526" data-line-number="4526"></td>
        <td id="LC4526">
</td>
      </tr>
      <tr>
        <td id="L4527" data-line-number="4527"></td>
        <td id="LC4527">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4528" data-line-number="4528"></td>
        <td id="LC4528">
</td>
      </tr>
      <tr>
        <td id="L4529" data-line-number="4529"></td>
        <td id="LC4529">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4530" data-line-number="4530"></td>
        <td id="LC4530">}</td>
      </tr>
      <tr>
        <td id="L4531" data-line-number="4531"></td>
        <td id="LC4531">
</td>
      </tr>
      <tr>
        <td id="L4532" data-line-number="4532"></td>
        <td id="LC4532"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4533" data-line-number="4533"></td>
        <td id="LC4533"><span><span>//</span> See if types represented by cls1 and cls2 compare equal, not</span></td>
      </tr>
      <tr>
        <td id="L4534" data-line-number="4534"></td>
        <td id="LC4534"><span><span>//</span> equal, or the comparison needs to be resolved at runtime.</span></td>
      </tr>
      <tr>
        <td id="L4535" data-line-number="4535"></td>
        <td id="LC4535">TypeCompareState <span>CEEInfo::compareTypesForEquality</span>(</td>
      </tr>
      <tr>
        <td id="L4536" data-line-number="4536"></td>
        <td id="LC4536">        CORINFO_CLASS_HANDLE        cls1,</td>
      </tr>
      <tr>
        <td id="L4537" data-line-number="4537"></td>
        <td id="LC4537">        CORINFO_CLASS_HANDLE        cls2)</td>
      </tr>
      <tr>
        <td id="L4538" data-line-number="4538"></td>
        <td id="LC4538">{</td>
      </tr>
      <tr>
        <td id="L4539" data-line-number="4539"></td>
        <td id="LC4539">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4540" data-line-number="4540"></td>
        <td id="LC4540">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4541" data-line-number="4541"></td>
        <td id="LC4541">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4542" data-line-number="4542"></td>
        <td id="LC4542">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4543" data-line-number="4543"></td>
        <td id="LC4543">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4544" data-line-number="4544"></td>
        <td id="LC4544">
</td>
      </tr>
      <tr>
        <td id="L4545" data-line-number="4545"></td>
        <td id="LC4545">    TypeCompareState result = TypeCompareState::May;</td>
      </tr>
      <tr>
        <td id="L4546" data-line-number="4546"></td>
        <td id="LC4546">
</td>
      </tr>
      <tr>
        <td id="L4547" data-line-number="4547"></td>
        <td id="LC4547">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4548" data-line-number="4548"></td>
        <td id="LC4548">
</td>
      </tr>
      <tr>
        <td id="L4549" data-line-number="4549"></td>
        <td id="LC4549">    TypeHandle hnd1 = (TypeHandle) cls1;</td>
      </tr>
      <tr>
        <td id="L4550" data-line-number="4550"></td>
        <td id="LC4550">    TypeHandle hnd2 = (TypeHandle) cls2;</td>
      </tr>
      <tr>
        <td id="L4551" data-line-number="4551"></td>
        <td id="LC4551">
</td>
      </tr>
      <tr>
        <td id="L4552" data-line-number="4552"></td>
        <td id="LC4552">    <span><span>//</span> If neither type is a canonical subtype, type handle comparison suffices</span></td>
      </tr>
      <tr>
        <td id="L4553" data-line-number="4553"></td>
        <td id="LC4553">    <span>if</span> (!hnd1.<span>IsCanonicalSubtype</span>() &amp;&amp; !hnd2.<span>IsCanonicalSubtype</span>())</td>
      </tr>
      <tr>
        <td id="L4554" data-line-number="4554"></td>
        <td id="LC4554">    {</td>
      </tr>
      <tr>
        <td id="L4555" data-line-number="4555"></td>
        <td id="LC4555">        result = (hnd1 == hnd2 ? TypeCompareState::Must : TypeCompareState::MustNot);</td>
      </tr>
      <tr>
        <td id="L4556" data-line-number="4556"></td>
        <td id="LC4556">    }</td>
      </tr>
      <tr>
        <td id="L4557" data-line-number="4557"></td>
        <td id="LC4557">    <span><span>//</span> If either or both types are canonical subtypes, we can sometimes prove inequality.</span></td>
      </tr>
      <tr>
        <td id="L4558" data-line-number="4558"></td>
        <td id="LC4558">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L4559" data-line-number="4559"></td>
        <td id="LC4559">    {</td>
      </tr>
      <tr>
        <td id="L4560" data-line-number="4560"></td>
        <td id="LC4560">        <span><span>//</span> If either is a value type then the types cannot</span></td>
      </tr>
      <tr>
        <td id="L4561" data-line-number="4561"></td>
        <td id="LC4561">        <span><span>//</span> be equal unless the type defs are the same.</span></td>
      </tr>
      <tr>
        <td id="L4562" data-line-number="4562"></td>
        <td id="LC4562">        <span>if</span> (hnd1.<span>IsValueType</span>() || hnd2.<span>IsValueType</span>())</td>
      </tr>
      <tr>
        <td id="L4563" data-line-number="4563"></td>
        <td id="LC4563">        {</td>
      </tr>
      <tr>
        <td id="L4564" data-line-number="4564"></td>
        <td id="LC4564">            <span>if</span> (!hnd1.<span>GetMethodTable</span>()-&gt;<span>HasSameTypeDefAs</span>(hnd2.<span>GetMethodTable</span>()))</td>
      </tr>
      <tr>
        <td id="L4565" data-line-number="4565"></td>
        <td id="LC4565">            {</td>
      </tr>
      <tr>
        <td id="L4566" data-line-number="4566"></td>
        <td id="LC4566">                result = TypeCompareState::MustNot;</td>
      </tr>
      <tr>
        <td id="L4567" data-line-number="4567"></td>
        <td id="LC4567">            }</td>
      </tr>
      <tr>
        <td id="L4568" data-line-number="4568"></td>
        <td id="LC4568">        }</td>
      </tr>
      <tr>
        <td id="L4569" data-line-number="4569"></td>
        <td id="LC4569">        <span><span>//</span> If we have two ref types that are not __Canon, then the</span></td>
      </tr>
      <tr>
        <td id="L4570" data-line-number="4570"></td>
        <td id="LC4570">        <span><span>//</span> types cannot be equal unless the type defs are the same.</span></td>
      </tr>
      <tr>
        <td id="L4571" data-line-number="4571"></td>
        <td id="LC4571">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L4572" data-line-number="4572"></td>
        <td id="LC4572">        {</td>
      </tr>
      <tr>
        <td id="L4573" data-line-number="4573"></td>
        <td id="LC4573">            TypeHandle canonHnd = <span>TypeHandle</span>(g_pCanonMethodTableClass);</td>
      </tr>
      <tr>
        <td id="L4574" data-line-number="4574"></td>
        <td id="LC4574">            <span>if</span> ((hnd1 != canonHnd) &amp;&amp; (hnd2 != canonHnd))</td>
      </tr>
      <tr>
        <td id="L4575" data-line-number="4575"></td>
        <td id="LC4575">            {</td>
      </tr>
      <tr>
        <td id="L4576" data-line-number="4576"></td>
        <td id="LC4576">                <span>if</span> (!hnd1.<span>GetMethodTable</span>()-&gt;<span>HasSameTypeDefAs</span>(hnd2.<span>GetMethodTable</span>()))</td>
      </tr>
      <tr>
        <td id="L4577" data-line-number="4577"></td>
        <td id="LC4577">                {</td>
      </tr>
      <tr>
        <td id="L4578" data-line-number="4578"></td>
        <td id="LC4578">                    result = TypeCompareState::MustNot;</td>
      </tr>
      <tr>
        <td id="L4579" data-line-number="4579"></td>
        <td id="LC4579">                }</td>
      </tr>
      <tr>
        <td id="L4580" data-line-number="4580"></td>
        <td id="LC4580">            }</td>
      </tr>
      <tr>
        <td id="L4581" data-line-number="4581"></td>
        <td id="LC4581">        }</td>
      </tr>
      <tr>
        <td id="L4582" data-line-number="4582"></td>
        <td id="LC4582">    }</td>
      </tr>
      <tr>
        <td id="L4583" data-line-number="4583"></td>
        <td id="LC4583">
</td>
      </tr>
      <tr>
        <td id="L4584" data-line-number="4584"></td>
        <td id="LC4584">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4585" data-line-number="4585"></td>
        <td id="LC4585">
</td>
      </tr>
      <tr>
        <td id="L4586" data-line-number="4586"></td>
        <td id="LC4586">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4587" data-line-number="4587"></td>
        <td id="LC4587">}</td>
      </tr>
      <tr>
        <td id="L4588" data-line-number="4588"></td>
        <td id="LC4588">
</td>
      </tr>
      <tr>
        <td id="L4589" data-line-number="4589"></td>
        <td id="LC4589"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4590" data-line-number="4590"></td>
        <td id="LC4590"><span><span>//</span> returns the intersection of cls1 and cls2.</span></td>
      </tr>
      <tr>
        <td id="L4591" data-line-number="4591"></td>
        <td id="LC4591">CORINFO_CLASS_HANDLE <span>CEEInfo::mergeClasses</span>(</td>
      </tr>
      <tr>
        <td id="L4592" data-line-number="4592"></td>
        <td id="LC4592">        CORINFO_CLASS_HANDLE        cls1,</td>
      </tr>
      <tr>
        <td id="L4593" data-line-number="4593"></td>
        <td id="LC4593">        CORINFO_CLASS_HANDLE        cls2)</td>
      </tr>
      <tr>
        <td id="L4594" data-line-number="4594"></td>
        <td id="LC4594">{</td>
      </tr>
      <tr>
        <td id="L4595" data-line-number="4595"></td>
        <td id="LC4595">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4596" data-line-number="4596"></td>
        <td id="LC4596">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4597" data-line-number="4597"></td>
        <td id="LC4597">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4598" data-line-number="4598"></td>
        <td id="LC4598">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4599" data-line-number="4599"></td>
        <td id="LC4599">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4600" data-line-number="4600"></td>
        <td id="LC4600">
</td>
      </tr>
      <tr>
        <td id="L4601" data-line-number="4601"></td>
        <td id="LC4601">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L4602" data-line-number="4602"></td>
        <td id="LC4602">
</td>
      </tr>
      <tr>
        <td id="L4603" data-line-number="4603"></td>
        <td id="LC4603">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4604" data-line-number="4604"></td>
        <td id="LC4604">
</td>
      </tr>
      <tr>
        <td id="L4605" data-line-number="4605"></td>
        <td id="LC4605">    TypeHandle merged = <span>TypeHandle::MergeTypeHandlesToCommonParent</span>(<span>TypeHandle</span>(cls1), <span>TypeHandle</span>(cls2));</td>
      </tr>
      <tr>
        <td id="L4606" data-line-number="4606"></td>
        <td id="LC4606">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L4607" data-line-number="4607"></td>
        <td id="LC4607">    {</td>
      </tr>
      <tr>
        <td id="L4608" data-line-number="4608"></td>
        <td id="LC4608">        <span><span>//</span>Make sure the merge is reflexive in the cases we "support".</span></td>
      </tr>
      <tr>
        <td id="L4609" data-line-number="4609"></td>
        <td id="LC4609">        TypeHandle hnd1 = <span>TypeHandle</span>(cls1);</td>
      </tr>
      <tr>
        <td id="L4610" data-line-number="4610"></td>
        <td id="LC4610">        TypeHandle hnd2 = <span>TypeHandle</span>(cls2);</td>
      </tr>
      <tr>
        <td id="L4611" data-line-number="4611"></td>
        <td id="LC4611">        TypeHandle reflexive = <span>TypeHandle::MergeTypeHandlesToCommonParent</span>(hnd2, hnd1);</td>
      </tr>
      <tr>
        <td id="L4612" data-line-number="4612"></td>
        <td id="LC4612">
</td>
      </tr>
      <tr>
        <td id="L4613" data-line-number="4613"></td>
        <td id="LC4613">        <span><span>//</span>If both sides are classes than either they have a common non-interface parent (in which case it is</span></td>
      </tr>
      <tr>
        <td id="L4614" data-line-number="4614"></td>
        <td id="LC4614">        <span><span>//</span>reflexive)</span></td>
      </tr>
      <tr>
        <td id="L4615" data-line-number="4615"></td>
        <td id="LC4615">        <span><span>//</span>OR they share a common interface, and it can be order dependent (if they share multiple interfaces</span></td>
      </tr>
      <tr>
        <td id="L4616" data-line-number="4616"></td>
        <td id="LC4616">        <span><span>//</span>in common)</span></td>
      </tr>
      <tr>
        <td id="L4617" data-line-number="4617"></td>
        <td id="LC4617">        <span>if</span> (!hnd1.<span>IsInterface</span>() &amp;&amp; !hnd2.<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L4618" data-line-number="4618"></td>
        <td id="LC4618">        {</td>
      </tr>
      <tr>
        <td id="L4619" data-line-number="4619"></td>
        <td id="LC4619">            <span>if</span> (merged.<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L4620" data-line-number="4620"></td>
        <td id="LC4620">            {</td>
      </tr>
      <tr>
        <td id="L4621" data-line-number="4621"></td>
        <td id="LC4621">                <span>_ASSERTE</span>(reflexive.<span>IsInterface</span>());</td>
      </tr>
      <tr>
        <td id="L4622" data-line-number="4622"></td>
        <td id="LC4622">            }</td>
      </tr>
      <tr>
        <td id="L4623" data-line-number="4623"></td>
        <td id="LC4623">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L4624" data-line-number="4624"></td>
        <td id="LC4624">            {</td>
      </tr>
      <tr>
        <td id="L4625" data-line-number="4625"></td>
        <td id="LC4625">                <span>_ASSERTE</span>(merged == reflexive);</td>
      </tr>
      <tr>
        <td id="L4626" data-line-number="4626"></td>
        <td id="LC4626">            }</td>
      </tr>
      <tr>
        <td id="L4627" data-line-number="4627"></td>
        <td id="LC4627">        }</td>
      </tr>
      <tr>
        <td id="L4628" data-line-number="4628"></td>
        <td id="LC4628">        <span><span>//</span>Both results must either be interfaces or classes.  They cannot be mixed.</span></td>
      </tr>
      <tr>
        <td id="L4629" data-line-number="4629"></td>
        <td id="LC4629">        <span>_ASSERTE</span>((!!merged.<span>IsInterface</span>()) == (!!reflexive.<span>IsInterface</span>()));</td>
      </tr>
      <tr>
        <td id="L4630" data-line-number="4630"></td>
        <td id="LC4630">
</td>
      </tr>
      <tr>
        <td id="L4631" data-line-number="4631"></td>
        <td id="LC4631">        <span><span>//</span>If the result of the merge was a class, then the result of the reflexive merge was the same class.</span></td>
      </tr>
      <tr>
        <td id="L4632" data-line-number="4632"></td>
        <td id="LC4632">        <span>if</span> (!merged.<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L4633" data-line-number="4633"></td>
        <td id="LC4633">        {</td>
      </tr>
      <tr>
        <td id="L4634" data-line-number="4634"></td>
        <td id="LC4634">            <span>_ASSERTE</span>(merged == reflexive);</td>
      </tr>
      <tr>
        <td id="L4635" data-line-number="4635"></td>
        <td id="LC4635">        }</td>
      </tr>
      <tr>
        <td id="L4636" data-line-number="4636"></td>
        <td id="LC4636">
</td>
      </tr>
      <tr>
        <td id="L4637" data-line-number="4637"></td>
        <td id="LC4637">        <span><span>//</span>If both sides are arrays, then the result is either an array or g_pArrayClass.  The above is</span></td>
      </tr>
      <tr>
        <td id="L4638" data-line-number="4638"></td>
        <td id="LC4638">        <span><span>//</span>actually true about the element type for references types, but I think that that is a little</span></td>
      </tr>
      <tr>
        <td id="L4639" data-line-number="4639"></td>
        <td id="LC4639">        <span><span>//</span>excessive for sanity.</span></td>
      </tr>
      <tr>
        <td id="L4640" data-line-number="4640"></td>
        <td id="LC4640">        <span>if</span> (hnd1.<span>IsArray</span>() &amp;&amp; hnd2.<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L4641" data-line-number="4641"></td>
        <td id="LC4641">        {</td>
      </tr>
      <tr>
        <td id="L4642" data-line-number="4642"></td>
        <td id="LC4642">            <span>_ASSERTE</span>((merged.<span>IsArray</span>() &amp;&amp; reflexive.<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L4643" data-line-number="4643"></td>
        <td id="LC4643">                     || ((merged == g_pArrayClass) &amp;&amp; (reflexive == g_pArrayClass)));</td>
      </tr>
      <tr>
        <td id="L4644" data-line-number="4644"></td>
        <td id="LC4644">        }</td>
      </tr>
      <tr>
        <td id="L4645" data-line-number="4645"></td>
        <td id="LC4645">
</td>
      </tr>
      <tr>
        <td id="L4646" data-line-number="4646"></td>
        <td id="LC4646">        <span><span>//</span>Can I assert anything about generic variables?</span></td>
      </tr>
      <tr>
        <td id="L4647" data-line-number="4647"></td>
        <td id="LC4647">
</td>
      </tr>
      <tr>
        <td id="L4648" data-line-number="4648"></td>
        <td id="LC4648">        <span><span>//</span>The results must always be assignable</span></td>
      </tr>
      <tr>
        <td id="L4649" data-line-number="4649"></td>
        <td id="LC4649">        <span>_ASSERTE</span>(hnd1.<span>CanCastTo</span>(merged) &amp;&amp; hnd2.<span>CanCastTo</span>(merged) &amp;&amp; hnd1.<span>CanCastTo</span>(reflexive)</td>
      </tr>
      <tr>
        <td id="L4650" data-line-number="4650"></td>
        <td id="LC4650">                 &amp;&amp; hnd2.<span>CanCastTo</span>(reflexive));</td>
      </tr>
      <tr>
        <td id="L4651" data-line-number="4651"></td>
        <td id="LC4651">    }</td>
      </tr>
      <tr>
        <td id="L4652" data-line-number="4652"></td>
        <td id="LC4652">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L4653" data-line-number="4653"></td>
        <td id="LC4653">    result = <span>CORINFO_CLASS_HANDLE</span>(merged.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L4654" data-line-number="4654"></td>
        <td id="LC4654">
</td>
      </tr>
      <tr>
        <td id="L4655" data-line-number="4655"></td>
        <td id="LC4655">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4656" data-line-number="4656"></td>
        <td id="LC4656">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4657" data-line-number="4657"></td>
        <td id="LC4657">}</td>
      </tr>
      <tr>
        <td id="L4658" data-line-number="4658"></td>
        <td id="LC4658">
</td>
      </tr>
      <tr>
        <td id="L4659" data-line-number="4659"></td>
        <td id="LC4659"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4660" data-line-number="4660"></td>
        <td id="LC4660"><span>static</span> BOOL <span>isMoreSpecificTypeHelper</span>(</td>
      </tr>
      <tr>
        <td id="L4661" data-line-number="4661"></td>
        <td id="LC4661">       CORINFO_CLASS_HANDLE        cls1,</td>
      </tr>
      <tr>
        <td id="L4662" data-line-number="4662"></td>
        <td id="LC4662">       CORINFO_CLASS_HANDLE        cls2)</td>
      </tr>
      <tr>
        <td id="L4663" data-line-number="4663"></td>
        <td id="LC4663">{</td>
      </tr>
      <tr>
        <td id="L4664" data-line-number="4664"></td>
        <td id="LC4664">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4665" data-line-number="4665"></td>
        <td id="LC4665">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4666" data-line-number="4666"></td>
        <td id="LC4666">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4667" data-line-number="4667"></td>
        <td id="LC4667">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4668" data-line-number="4668"></td>
        <td id="LC4668">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4669" data-line-number="4669"></td>
        <td id="LC4669">
</td>
      </tr>
      <tr>
        <td id="L4670" data-line-number="4670"></td>
        <td id="LC4670">    TypeHandle hnd1 = <span>TypeHandle</span>(cls1);</td>
      </tr>
      <tr>
        <td id="L4671" data-line-number="4671"></td>
        <td id="LC4671">    TypeHandle hnd2 = <span>TypeHandle</span>(cls2);</td>
      </tr>
      <tr>
        <td id="L4672" data-line-number="4672"></td>
        <td id="LC4672">
</td>
      </tr>
      <tr>
        <td id="L4673" data-line-number="4673"></td>
        <td id="LC4673">    <span><span>//</span> We can't really reason about equivalent types. Just</span></td>
      </tr>
      <tr>
        <td id="L4674" data-line-number="4674"></td>
        <td id="LC4674">    <span><span>//</span> assume the new type is not more specific.</span></td>
      </tr>
      <tr>
        <td id="L4675" data-line-number="4675"></td>
        <td id="LC4675">    <span>if</span> (hnd1.<span>HasTypeEquivalence</span>() || hnd2.<span>HasTypeEquivalence</span>())</td>
      </tr>
      <tr>
        <td id="L4676" data-line-number="4676"></td>
        <td id="LC4676">    {</td>
      </tr>
      <tr>
        <td id="L4677" data-line-number="4677"></td>
        <td id="LC4677">        <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L4678" data-line-number="4678"></td>
        <td id="LC4678">    }</td>
      </tr>
      <tr>
        <td id="L4679" data-line-number="4679"></td>
        <td id="LC4679">
</td>
      </tr>
      <tr>
        <td id="L4680" data-line-number="4680"></td>
        <td id="LC4680">    <span><span>//</span> If we have a mixture of shared and unshared types,</span></td>
      </tr>
      <tr>
        <td id="L4681" data-line-number="4681"></td>
        <td id="LC4681">    <span><span>//</span> consider the unshared type as more specific.</span></td>
      </tr>
      <tr>
        <td id="L4682" data-line-number="4682"></td>
        <td id="LC4682">    BOOL isHnd1CanonSubtype = hnd1.<span>IsCanonicalSubtype</span>();</td>
      </tr>
      <tr>
        <td id="L4683" data-line-number="4683"></td>
        <td id="LC4683">    BOOL isHnd2CanonSubtype = hnd2.<span>IsCanonicalSubtype</span>();</td>
      </tr>
      <tr>
        <td id="L4684" data-line-number="4684"></td>
        <td id="LC4684">    <span>if</span> (isHnd1CanonSubtype != isHnd2CanonSubtype)</td>
      </tr>
      <tr>
        <td id="L4685" data-line-number="4685"></td>
        <td id="LC4685">    {</td>
      </tr>
      <tr>
        <td id="L4686" data-line-number="4686"></td>
        <td id="LC4686">        <span><span>//</span> Only one of hnd1 and hnd2 is shared.</span></td>
      </tr>
      <tr>
        <td id="L4687" data-line-number="4687"></td>
        <td id="LC4687">        <span><span>//</span> hdn2 is more specific if hnd1 is the shared type.</span></td>
      </tr>
      <tr>
        <td id="L4688" data-line-number="4688"></td>
        <td id="LC4688">        <span>return</span> isHnd1CanonSubtype;</td>
      </tr>
      <tr>
        <td id="L4689" data-line-number="4689"></td>
        <td id="LC4689">    }</td>
      </tr>
      <tr>
        <td id="L4690" data-line-number="4690"></td>
        <td id="LC4690">
</td>
      </tr>
      <tr>
        <td id="L4691" data-line-number="4691"></td>
        <td id="LC4691">    <span><span>//</span> Otherwise both types are either shared or not shared.</span></td>
      </tr>
      <tr>
        <td id="L4692" data-line-number="4692"></td>
        <td id="LC4692">    <span><span>//</span> Look for a common parent type.</span></td>
      </tr>
      <tr>
        <td id="L4693" data-line-number="4693"></td>
        <td id="LC4693">    TypeHandle merged = <span>TypeHandle::MergeTypeHandlesToCommonParent</span>(hnd1, hnd2);</td>
      </tr>
      <tr>
        <td id="L4694" data-line-number="4694"></td>
        <td id="LC4694">
</td>
      </tr>
      <tr>
        <td id="L4695" data-line-number="4695"></td>
        <td id="LC4695">    <span><span>//</span> If the common parent is hnd1, then hnd2 is more specific.</span></td>
      </tr>
      <tr>
        <td id="L4696" data-line-number="4696"></td>
        <td id="LC4696">    <span>return</span> merged == hnd1;</td>
      </tr>
      <tr>
        <td id="L4697" data-line-number="4697"></td>
        <td id="LC4697">}</td>
      </tr>
      <tr>
        <td id="L4698" data-line-number="4698"></td>
        <td id="LC4698">
</td>
      </tr>
      <tr>
        <td id="L4699" data-line-number="4699"></td>
        <td id="LC4699"><span><span>//</span> Returns true if cls2 is known to be a more specific type</span></td>
      </tr>
      <tr>
        <td id="L4700" data-line-number="4700"></td>
        <td id="LC4700"><span><span>//</span> than cls1 (a subtype or more restrictive shared type).</span></td>
      </tr>
      <tr>
        <td id="L4701" data-line-number="4701"></td>
        <td id="LC4701">BOOL <span>CEEInfo::isMoreSpecificType</span>(</td>
      </tr>
      <tr>
        <td id="L4702" data-line-number="4702"></td>
        <td id="LC4702">        CORINFO_CLASS_HANDLE        cls1,</td>
      </tr>
      <tr>
        <td id="L4703" data-line-number="4703"></td>
        <td id="LC4703">        CORINFO_CLASS_HANDLE        cls2)</td>
      </tr>
      <tr>
        <td id="L4704" data-line-number="4704"></td>
        <td id="LC4704">{</td>
      </tr>
      <tr>
        <td id="L4705" data-line-number="4705"></td>
        <td id="LC4705">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4706" data-line-number="4706"></td>
        <td id="LC4706">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4707" data-line-number="4707"></td>
        <td id="LC4707">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4708" data-line-number="4708"></td>
        <td id="LC4708">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4709" data-line-number="4709"></td>
        <td id="LC4709">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4710" data-line-number="4710"></td>
        <td id="LC4710">
</td>
      </tr>
      <tr>
        <td id="L4711" data-line-number="4711"></td>
        <td id="LC4711">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L4712" data-line-number="4712"></td>
        <td id="LC4712">
</td>
      </tr>
      <tr>
        <td id="L4713" data-line-number="4713"></td>
        <td id="LC4713">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4714" data-line-number="4714"></td>
        <td id="LC4714">
</td>
      </tr>
      <tr>
        <td id="L4715" data-line-number="4715"></td>
        <td id="LC4715">    result = <span>isMoreSpecificTypeHelper</span>(cls1, cls2);</td>
      </tr>
      <tr>
        <td id="L4716" data-line-number="4716"></td>
        <td id="LC4716">
</td>
      </tr>
      <tr>
        <td id="L4717" data-line-number="4717"></td>
        <td id="LC4717">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4718" data-line-number="4718"></td>
        <td id="LC4718">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4719" data-line-number="4719"></td>
        <td id="LC4719">}</td>
      </tr>
      <tr>
        <td id="L4720" data-line-number="4720"></td>
        <td id="LC4720">
</td>
      </tr>
      <tr>
        <td id="L4721" data-line-number="4721"></td>
        <td id="LC4721"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4722" data-line-number="4722"></td>
        <td id="LC4722"><span><span>//</span> Given a class handle, returns the Parent type.</span></td>
      </tr>
      <tr>
        <td id="L4723" data-line-number="4723"></td>
        <td id="LC4723"><span><span>//</span> For COMObjectType, it returns Class Handle of System.Object.</span></td>
      </tr>
      <tr>
        <td id="L4724" data-line-number="4724"></td>
        <td id="LC4724"><span><span>//</span> Returns 0 if System.Object is passed in.</span></td>
      </tr>
      <tr>
        <td id="L4725" data-line-number="4725"></td>
        <td id="LC4725">CORINFO_CLASS_HANDLE <span>CEEInfo::getParentType</span>(</td>
      </tr>
      <tr>
        <td id="L4726" data-line-number="4726"></td>
        <td id="LC4726">            CORINFO_CLASS_HANDLE    cls)</td>
      </tr>
      <tr>
        <td id="L4727" data-line-number="4727"></td>
        <td id="LC4727">{</td>
      </tr>
      <tr>
        <td id="L4728" data-line-number="4728"></td>
        <td id="LC4728">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4729" data-line-number="4729"></td>
        <td id="LC4729">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4730" data-line-number="4730"></td>
        <td id="LC4730">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4731" data-line-number="4731"></td>
        <td id="LC4731">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4732" data-line-number="4732"></td>
        <td id="LC4732">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4733" data-line-number="4733"></td>
        <td id="LC4733">
</td>
      </tr>
      <tr>
        <td id="L4734" data-line-number="4734"></td>
        <td id="LC4734">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L4735" data-line-number="4735"></td>
        <td id="LC4735">
</td>
      </tr>
      <tr>
        <td id="L4736" data-line-number="4736"></td>
        <td id="LC4736">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4737" data-line-number="4737"></td>
        <td id="LC4737">
</td>
      </tr>
      <tr>
        <td id="L4738" data-line-number="4738"></td>
        <td id="LC4738">    TypeHandle <span>th</span>(cls);</td>
      </tr>
      <tr>
        <td id="L4739" data-line-number="4739"></td>
        <td id="LC4739">
</td>
      </tr>
      <tr>
        <td id="L4740" data-line-number="4740"></td>
        <td id="LC4740">    <span>_ASSERTE</span>(!th.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L4741" data-line-number="4741"></td>
        <td id="LC4741">    <span>_ASSERTE</span>(!th.<span>IsGenericVariable</span>());</td>
      </tr>
      <tr>
        <td id="L4742" data-line-number="4742"></td>
        <td id="LC4742">
</td>
      </tr>
      <tr>
        <td id="L4743" data-line-number="4743"></td>
        <td id="LC4743">    TypeHandle thParent = th.<span>GetParent</span>();</td>
      </tr>
      <tr>
        <td id="L4744" data-line-number="4744"></td>
        <td id="LC4744">
</td>
      </tr>
      <tr>
        <td id="L4745" data-line-number="4745"></td>
        <td id="LC4745">#<span>ifdef</span> FEATURE_COMINTEROP</td>
      </tr>
      <tr>
        <td id="L4746" data-line-number="4746"></td>
        <td id="LC4746">    <span><span>//</span> If we encounter __ComObject in the hierarchy, we need to skip it</span></td>
      </tr>
      <tr>
        <td id="L4747" data-line-number="4747"></td>
        <td id="LC4747">    <span><span>//</span> since this hierarchy is introduced by the EE, but won't be present</span></td>
      </tr>
      <tr>
        <td id="L4748" data-line-number="4748"></td>
        <td id="LC4748">    <span><span>//</span> in the metadata.</span></td>
      </tr>
      <tr>
        <td id="L4749" data-line-number="4749"></td>
        <td id="LC4749">    <span>if</span> (!thParent.<span>IsNull</span>() &amp;&amp; <span>IsComObjectClass</span>(thParent))</td>
      </tr>
      <tr>
        <td id="L4750" data-line-number="4750"></td>
        <td id="LC4750">    {</td>
      </tr>
      <tr>
        <td id="L4751" data-line-number="4751"></td>
        <td id="LC4751">        result = (CORINFO_CLASS_HANDLE) g_pObjectClass;</td>
      </tr>
      <tr>
        <td id="L4752" data-line-number="4752"></td>
        <td id="LC4752">    }</td>
      </tr>
      <tr>
        <td id="L4753" data-line-number="4753"></td>
        <td id="LC4753">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L4754" data-line-number="4754"></td>
        <td id="LC4754">#<span>endif</span> <span><span>//</span> FEATURE_COMINTEROP</span></td>
      </tr>
      <tr>
        <td id="L4755" data-line-number="4755"></td>
        <td id="LC4755">    {</td>
      </tr>
      <tr>
        <td id="L4756" data-line-number="4756"></td>
        <td id="LC4756">        result = <span>CORINFO_CLASS_HANDLE</span>(thParent.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L4757" data-line-number="4757"></td>
        <td id="LC4757">    }</td>
      </tr>
      <tr>
        <td id="L4758" data-line-number="4758"></td>
        <td id="LC4758">
</td>
      </tr>
      <tr>
        <td id="L4759" data-line-number="4759"></td>
        <td id="LC4759">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4760" data-line-number="4760"></td>
        <td id="LC4760">
</td>
      </tr>
      <tr>
        <td id="L4761" data-line-number="4761"></td>
        <td id="LC4761">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4762" data-line-number="4762"></td>
        <td id="LC4762">}</td>
      </tr>
      <tr>
        <td id="L4763" data-line-number="4763"></td>
        <td id="LC4763">
</td>
      </tr>
      <tr>
        <td id="L4764" data-line-number="4764"></td>
        <td id="LC4764">
</td>
      </tr>
      <tr>
        <td id="L4765" data-line-number="4765"></td>
        <td id="LC4765"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4766" data-line-number="4766"></td>
        <td id="LC4766"><span><span>//</span> Returns the CorInfoType of the "child type". If the child type is</span></td>
      </tr>
      <tr>
        <td id="L4767" data-line-number="4767"></td>
        <td id="LC4767"><span><span>//</span> not a primitive type, *clsRet will be set.</span></td>
      </tr>
      <tr>
        <td id="L4768" data-line-number="4768"></td>
        <td id="LC4768"><span><span>//</span> Given an Array of Type Foo, returns Foo.</span></td>
      </tr>
      <tr>
        <td id="L4769" data-line-number="4769"></td>
        <td id="LC4769"><span><span>//</span> Given BYREF Foo, returns Foo</span></td>
      </tr>
      <tr>
        <td id="L4770" data-line-number="4770"></td>
        <td id="LC4770">CorInfoType <span>CEEInfo::getChildType</span> (</td>
      </tr>
      <tr>
        <td id="L4771" data-line-number="4771"></td>
        <td id="LC4771">        CORINFO_CLASS_HANDLE       clsHnd,</td>
      </tr>
      <tr>
        <td id="L4772" data-line-number="4772"></td>
        <td id="LC4772">        CORINFO_CLASS_HANDLE       *clsRet</td>
      </tr>
      <tr>
        <td id="L4773" data-line-number="4773"></td>
        <td id="LC4773">        )</td>
      </tr>
      <tr>
        <td id="L4774" data-line-number="4774"></td>
        <td id="LC4774">{</td>
      </tr>
      <tr>
        <td id="L4775" data-line-number="4775"></td>
        <td id="LC4775">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4776" data-line-number="4776"></td>
        <td id="LC4776">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4777" data-line-number="4777"></td>
        <td id="LC4777">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4778" data-line-number="4778"></td>
        <td id="LC4778">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4779" data-line-number="4779"></td>
        <td id="LC4779">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4780" data-line-number="4780"></td>
        <td id="LC4780">
</td>
      </tr>
      <tr>
        <td id="L4781" data-line-number="4781"></td>
        <td id="LC4781">    CorInfoType ret = CORINFO_TYPE_UNDEF;</td>
      </tr>
      <tr>
        <td id="L4782" data-line-number="4782"></td>
        <td id="LC4782">    *clsRet = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L4783" data-line-number="4783"></td>
        <td id="LC4783">    TypeHandle  retType = <span>TypeHandle</span>();</td>
      </tr>
      <tr>
        <td id="L4784" data-line-number="4784"></td>
        <td id="LC4784">
</td>
      </tr>
      <tr>
        <td id="L4785" data-line-number="4785"></td>
        <td id="LC4785">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4786" data-line-number="4786"></td>
        <td id="LC4786">
</td>
      </tr>
      <tr>
        <td id="L4787" data-line-number="4787"></td>
        <td id="LC4787">    TypeHandle <span>th</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L4788" data-line-number="4788"></td>
        <td id="LC4788">
</td>
      </tr>
      <tr>
        <td id="L4789" data-line-number="4789"></td>
        <td id="LC4789">    <span>_ASSERTE</span>(!th.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L4790" data-line-number="4790"></td>
        <td id="LC4790">
</td>
      </tr>
      <tr>
        <td id="L4791" data-line-number="4791"></td>
        <td id="LC4791">    <span><span>//</span> BYREF, pointer types</span></td>
      </tr>
      <tr>
        <td id="L4792" data-line-number="4792"></td>
        <td id="LC4792">    <span>if</span> (th.<span>HasTypeParam</span>())</td>
      </tr>
      <tr>
        <td id="L4793" data-line-number="4793"></td>
        <td id="LC4793">    {</td>
      </tr>
      <tr>
        <td id="L4794" data-line-number="4794"></td>
        <td id="LC4794">        retType = th.<span>GetTypeParam</span>();</td>
      </tr>
      <tr>
        <td id="L4795" data-line-number="4795"></td>
        <td id="LC4795">    }</td>
      </tr>
      <tr>
        <td id="L4796" data-line-number="4796"></td>
        <td id="LC4796">
</td>
      </tr>
      <tr>
        <td id="L4797" data-line-number="4797"></td>
        <td id="LC4797">    <span>if</span> (!retType.<span>IsNull</span>()) {</td>
      </tr>
      <tr>
        <td id="L4798" data-line-number="4798"></td>
        <td id="LC4798">        CorElementType type = retType.<span>GetInternalCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L4799" data-line-number="4799"></td>
        <td id="LC4799">        ret = <span>CEEInfo::asCorInfoType</span>(type,retType, clsRet);</td>
      </tr>
      <tr>
        <td id="L4800" data-line-number="4800"></td>
        <td id="LC4800">
</td>
      </tr>
      <tr>
        <td id="L4801" data-line-number="4801"></td>
        <td id="LC4801">        <span><span>//</span> &lt;REVISIT_TODO&gt;What if this one is a value array ?&lt;/REVISIT_TODO&gt;</span></td>
      </tr>
      <tr>
        <td id="L4802" data-line-number="4802"></td>
        <td id="LC4802">    }</td>
      </tr>
      <tr>
        <td id="L4803" data-line-number="4803"></td>
        <td id="LC4803">
</td>
      </tr>
      <tr>
        <td id="L4804" data-line-number="4804"></td>
        <td id="LC4804">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4805" data-line-number="4805"></td>
        <td id="LC4805">
</td>
      </tr>
      <tr>
        <td id="L4806" data-line-number="4806"></td>
        <td id="LC4806">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L4807" data-line-number="4807"></td>
        <td id="LC4807">}</td>
      </tr>
      <tr>
        <td id="L4808" data-line-number="4808"></td>
        <td id="LC4808">
</td>
      </tr>
      <tr>
        <td id="L4809" data-line-number="4809"></td>
        <td id="LC4809"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4810" data-line-number="4810"></td>
        <td id="LC4810"><span><span>//</span> Check any constraints on class type arguments</span></td>
      </tr>
      <tr>
        <td id="L4811" data-line-number="4811"></td>
        <td id="LC4811">BOOL <span>CEEInfo::satisfiesClassConstraints</span>(CORINFO_CLASS_HANDLE cls)</td>
      </tr>
      <tr>
        <td id="L4812" data-line-number="4812"></td>
        <td id="LC4812">{</td>
      </tr>
      <tr>
        <td id="L4813" data-line-number="4813"></td>
        <td id="LC4813">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4814" data-line-number="4814"></td>
        <td id="LC4814">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4815" data-line-number="4815"></td>
        <td id="LC4815">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4816" data-line-number="4816"></td>
        <td id="LC4816">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4817" data-line-number="4817"></td>
        <td id="LC4817">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4818" data-line-number="4818"></td>
        <td id="LC4818">
</td>
      </tr>
      <tr>
        <td id="L4819" data-line-number="4819"></td>
        <td id="LC4819">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L4820" data-line-number="4820"></td>
        <td id="LC4820">
</td>
      </tr>
      <tr>
        <td id="L4821" data-line-number="4821"></td>
        <td id="LC4821">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4822" data-line-number="4822"></td>
        <td id="LC4822">
</td>
      </tr>
      <tr>
        <td id="L4823" data-line-number="4823"></td>
        <td id="LC4823">    <span>_ASSERTE</span>(cls != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L4824" data-line-number="4824"></td>
        <td id="LC4824">    result = <span>TypeHandle</span>(cls).<span>SatisfiesClassConstraints</span>();</td>
      </tr>
      <tr>
        <td id="L4825" data-line-number="4825"></td>
        <td id="LC4825">
</td>
      </tr>
      <tr>
        <td id="L4826" data-line-number="4826"></td>
        <td id="LC4826">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4827" data-line-number="4827"></td>
        <td id="LC4827">
</td>
      </tr>
      <tr>
        <td id="L4828" data-line-number="4828"></td>
        <td id="LC4828">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4829" data-line-number="4829"></td>
        <td id="LC4829">}</td>
      </tr>
      <tr>
        <td id="L4830" data-line-number="4830"></td>
        <td id="LC4830">
</td>
      </tr>
      <tr>
        <td id="L4831" data-line-number="4831"></td>
        <td id="LC4831"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4832" data-line-number="4832"></td>
        <td id="LC4832"><span><span>//</span> Check if this is a single dimensional array type</span></td>
      </tr>
      <tr>
        <td id="L4833" data-line-number="4833"></td>
        <td id="LC4833">BOOL <span>CEEInfo::isSDArray</span>(CORINFO_CLASS_HANDLE  cls)</td>
      </tr>
      <tr>
        <td id="L4834" data-line-number="4834"></td>
        <td id="LC4834">{</td>
      </tr>
      <tr>
        <td id="L4835" data-line-number="4835"></td>
        <td id="LC4835">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4836" data-line-number="4836"></td>
        <td id="LC4836">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4837" data-line-number="4837"></td>
        <td id="LC4837">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4838" data-line-number="4838"></td>
        <td id="LC4838">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4839" data-line-number="4839"></td>
        <td id="LC4839">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4840" data-line-number="4840"></td>
        <td id="LC4840">
</td>
      </tr>
      <tr>
        <td id="L4841" data-line-number="4841"></td>
        <td id="LC4841">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L4842" data-line-number="4842"></td>
        <td id="LC4842">
</td>
      </tr>
      <tr>
        <td id="L4843" data-line-number="4843"></td>
        <td id="LC4843">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4844" data-line-number="4844"></td>
        <td id="LC4844">
</td>
      </tr>
      <tr>
        <td id="L4845" data-line-number="4845"></td>
        <td id="LC4845">    TypeHandle <span>th</span>(cls);</td>
      </tr>
      <tr>
        <td id="L4846" data-line-number="4846"></td>
        <td id="LC4846">
</td>
      </tr>
      <tr>
        <td id="L4847" data-line-number="4847"></td>
        <td id="LC4847">    <span>_ASSERTE</span>(!th.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L4848" data-line-number="4848"></td>
        <td id="LC4848">
</td>
      </tr>
      <tr>
        <td id="L4849" data-line-number="4849"></td>
        <td id="LC4849">    <span>if</span> (th.<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L4850" data-line-number="4850"></td>
        <td id="LC4850">    {</td>
      </tr>
      <tr>
        <td id="L4851" data-line-number="4851"></td>
        <td id="LC4851">        <span><span>//</span> Lots of code used to think that System.Array's methodtable returns TRUE for IsArray(). It doesn't.</span></td>
      </tr>
      <tr>
        <td id="L4852" data-line-number="4852"></td>
        <td id="LC4852">        <span>_ASSERTE</span>(th != <span>TypeHandle</span>(g_pArrayClass));</td>
      </tr>
      <tr>
        <td id="L4853" data-line-number="4853"></td>
        <td id="LC4853">
</td>
      </tr>
      <tr>
        <td id="L4854" data-line-number="4854"></td>
        <td id="LC4854">        result = (th.<span>GetInternalCorElementType</span>() == ELEMENT_TYPE_SZARRAY);</td>
      </tr>
      <tr>
        <td id="L4855" data-line-number="4855"></td>
        <td id="LC4855">    }</td>
      </tr>
      <tr>
        <td id="L4856" data-line-number="4856"></td>
        <td id="LC4856">
</td>
      </tr>
      <tr>
        <td id="L4857" data-line-number="4857"></td>
        <td id="LC4857">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4858" data-line-number="4858"></td>
        <td id="LC4858">
</td>
      </tr>
      <tr>
        <td id="L4859" data-line-number="4859"></td>
        <td id="LC4859">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4860" data-line-number="4860"></td>
        <td id="LC4860">}</td>
      </tr>
      <tr>
        <td id="L4861" data-line-number="4861"></td>
        <td id="LC4861">
</td>
      </tr>
      <tr>
        <td id="L4862" data-line-number="4862"></td>
        <td id="LC4862"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4863" data-line-number="4863"></td>
        <td id="LC4863"><span><span>//</span> Get the number of dimensions in an array</span></td>
      </tr>
      <tr>
        <td id="L4864" data-line-number="4864"></td>
        <td id="LC4864"><span>unsigned</span> <span>CEEInfo::getArrayRank</span>(CORINFO_CLASS_HANDLE  cls)</td>
      </tr>
      <tr>
        <td id="L4865" data-line-number="4865"></td>
        <td id="LC4865">{</td>
      </tr>
      <tr>
        <td id="L4866" data-line-number="4866"></td>
        <td id="LC4866">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4867" data-line-number="4867"></td>
        <td id="LC4867">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4868" data-line-number="4868"></td>
        <td id="LC4868">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4869" data-line-number="4869"></td>
        <td id="LC4869">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4870" data-line-number="4870"></td>
        <td id="LC4870">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4871" data-line-number="4871"></td>
        <td id="LC4871">
</td>
      </tr>
      <tr>
        <td id="L4872" data-line-number="4872"></td>
        <td id="LC4872">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L4873" data-line-number="4873"></td>
        <td id="LC4873">
</td>
      </tr>
      <tr>
        <td id="L4874" data-line-number="4874"></td>
        <td id="LC4874">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4875" data-line-number="4875"></td>
        <td id="LC4875">
</td>
      </tr>
      <tr>
        <td id="L4876" data-line-number="4876"></td>
        <td id="LC4876">    TypeHandle <span>th</span>(cls);</td>
      </tr>
      <tr>
        <td id="L4877" data-line-number="4877"></td>
        <td id="LC4877">
</td>
      </tr>
      <tr>
        <td id="L4878" data-line-number="4878"></td>
        <td id="LC4878">    <span>_ASSERTE</span>(!th.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L4879" data-line-number="4879"></td>
        <td id="LC4879">
</td>
      </tr>
      <tr>
        <td id="L4880" data-line-number="4880"></td>
        <td id="LC4880">    <span>if</span> (th.<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L4881" data-line-number="4881"></td>
        <td id="LC4881">    {</td>
      </tr>
      <tr>
        <td id="L4882" data-line-number="4882"></td>
        <td id="LC4882">        <span><span>//</span> Lots of code used to think that System.Array's methodtable returns TRUE for IsArray(). It doesn't.</span></td>
      </tr>
      <tr>
        <td id="L4883" data-line-number="4883"></td>
        <td id="LC4883">        <span>_ASSERTE</span>(th != <span>TypeHandle</span>(g_pArrayClass));</td>
      </tr>
      <tr>
        <td id="L4884" data-line-number="4884"></td>
        <td id="LC4884">
</td>
      </tr>
      <tr>
        <td id="L4885" data-line-number="4885"></td>
        <td id="LC4885">        result = th.<span>GetRank</span>();</td>
      </tr>
      <tr>
        <td id="L4886" data-line-number="4886"></td>
        <td id="LC4886">    }</td>
      </tr>
      <tr>
        <td id="L4887" data-line-number="4887"></td>
        <td id="LC4887">
</td>
      </tr>
      <tr>
        <td id="L4888" data-line-number="4888"></td>
        <td id="LC4888">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4889" data-line-number="4889"></td>
        <td id="LC4889">
</td>
      </tr>
      <tr>
        <td id="L4890" data-line-number="4890"></td>
        <td id="LC4890">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4891" data-line-number="4891"></td>
        <td id="LC4891">}</td>
      </tr>
      <tr>
        <td id="L4892" data-line-number="4892"></td>
        <td id="LC4892">
</td>
      </tr>
      <tr>
        <td id="L4893" data-line-number="4893"></td>
        <td id="LC4893"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L4894" data-line-number="4894"></td>
        <td id="LC4894"><span><span>//</span> Get static field data for an array</span></td>
      </tr>
      <tr>
        <td id="L4895" data-line-number="4895"></td>
        <td id="LC4895"><span><span>//</span> Note that it's OK to return NULL from this method.  This will cause</span></td>
      </tr>
      <tr>
        <td id="L4896" data-line-number="4896"></td>
        <td id="LC4896"><span><span>//</span> the JIT to make a runtime call to InitializeArray instead of doing</span></td>
      </tr>
      <tr>
        <td id="L4897" data-line-number="4897"></td>
        <td id="LC4897"><span><span>//</span> the inline optimization (thus preserving the original behavior).</span></td>
      </tr>
      <tr>
        <td id="L4898" data-line-number="4898"></td>
        <td id="LC4898"><span>void</span> * <span>CEEInfo::getArrayInitializationData</span>(</td>
      </tr>
      <tr>
        <td id="L4899" data-line-number="4899"></td>
        <td id="LC4899">            CORINFO_FIELD_HANDLE        field,</td>
      </tr>
      <tr>
        <td id="L4900" data-line-number="4900"></td>
        <td id="LC4900">            DWORD                       size</td>
      </tr>
      <tr>
        <td id="L4901" data-line-number="4901"></td>
        <td id="LC4901">            )</td>
      </tr>
      <tr>
        <td id="L4902" data-line-number="4902"></td>
        <td id="LC4902">{</td>
      </tr>
      <tr>
        <td id="L4903" data-line-number="4903"></td>
        <td id="LC4903">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4904" data-line-number="4904"></td>
        <td id="LC4904">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4905" data-line-number="4905"></td>
        <td id="LC4905">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4906" data-line-number="4906"></td>
        <td id="LC4906">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4907" data-line-number="4907"></td>
        <td id="LC4907">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4908" data-line-number="4908"></td>
        <td id="LC4908">
</td>
      </tr>
      <tr>
        <td id="L4909" data-line-number="4909"></td>
        <td id="LC4909">    <span>void</span> * result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L4910" data-line-number="4910"></td>
        <td id="LC4910">
</td>
      </tr>
      <tr>
        <td id="L4911" data-line-number="4911"></td>
        <td id="LC4911">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4912" data-line-number="4912"></td>
        <td id="LC4912">
</td>
      </tr>
      <tr>
        <td id="L4913" data-line-number="4913"></td>
        <td id="LC4913">    FieldDesc* pField = (FieldDesc*) field;</td>
      </tr>
      <tr>
        <td id="L4914" data-line-number="4914"></td>
        <td id="LC4914">
</td>
      </tr>
      <tr>
        <td id="L4915" data-line-number="4915"></td>
        <td id="LC4915">    <span>if</span> (!pField                    ||</td>
      </tr>
      <tr>
        <td id="L4916" data-line-number="4916"></td>
        <td id="LC4916">        !pField-&gt;<span>IsRVA</span>()           ||</td>
      </tr>
      <tr>
        <td id="L4917" data-line-number="4917"></td>
        <td id="LC4917">        (pField-&gt;<span>LoadSize</span>() &lt; size)</td>
      </tr>
      <tr>
        <td id="L4918" data-line-number="4918"></td>
        <td id="LC4918">#<span>ifdef</span> FEATURE_NATIVE_IMAGE_GENERATION</td>
      </tr>
      <tr>
        <td id="L4919" data-line-number="4919"></td>
        <td id="LC4919">        <span><span>//</span> This will make sure that when IBC logging is on, the array initialization happens thru</span></td>
      </tr>
      <tr>
        <td id="L4920" data-line-number="4920"></td>
        <td id="LC4920">        <span><span>//</span> COMArrayInfo::InitializeArray. This gives a place to put the IBC probe that can help</span></td>
      </tr>
      <tr>
        <td id="L4921" data-line-number="4921"></td>
        <td id="LC4921">        <span><span>//</span> separate hold and cold RVA blobs.</span></td>
      </tr>
      <tr>
        <td id="L4922" data-line-number="4922"></td>
        <td id="LC4922">        || (<span>IsCompilingForNGen</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L4923" data-line-number="4923"></td>
        <td id="LC4923">            <span>GetAppDomain</span>()-&gt;<span>ToCompilationDomain</span>()-&gt;<span>m_fForceInstrument</span>)</td>
      </tr>
      <tr>
        <td id="L4924" data-line-number="4924"></td>
        <td id="LC4924">#<span>endif</span> <span><span>//</span> FEATURE_NATIVE_IMAGE_GENERATION</span></td>
      </tr>
      <tr>
        <td id="L4925" data-line-number="4925"></td>
        <td id="LC4925">        )</td>
      </tr>
      <tr>
        <td id="L4926" data-line-number="4926"></td>
        <td id="LC4926">    {</td>
      </tr>
      <tr>
        <td id="L4927" data-line-number="4927"></td>
        <td id="LC4927">        result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L4928" data-line-number="4928"></td>
        <td id="LC4928">    }</td>
      </tr>
      <tr>
        <td id="L4929" data-line-number="4929"></td>
        <td id="LC4929">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L4930" data-line-number="4930"></td>
        <td id="LC4930">    {</td>
      </tr>
      <tr>
        <td id="L4931" data-line-number="4931"></td>
        <td id="LC4931">        result = pField-&gt;<span>GetStaticAddressHandle</span>(<span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L4932" data-line-number="4932"></td>
        <td id="LC4932">    }</td>
      </tr>
      <tr>
        <td id="L4933" data-line-number="4933"></td>
        <td id="LC4933">
</td>
      </tr>
      <tr>
        <td id="L4934" data-line-number="4934"></td>
        <td id="LC4934">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4935" data-line-number="4935"></td>
        <td id="LC4935">
</td>
      </tr>
      <tr>
        <td id="L4936" data-line-number="4936"></td>
        <td id="LC4936">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L4937" data-line-number="4937"></td>
        <td id="LC4937">}</td>
      </tr>
      <tr>
        <td id="L4938" data-line-number="4938"></td>
        <td id="LC4938">
</td>
      </tr>
      <tr>
        <td id="L4939" data-line-number="4939"></td>
        <td id="LC4939">CorInfoIsAccessAllowedResult <span>CEEInfo::canAccessClass</span>(</td>
      </tr>
      <tr>
        <td id="L4940" data-line-number="4940"></td>
        <td id="LC4940">            CORINFO_RESOLVED_TOKEN * pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L4941" data-line-number="4941"></td>
        <td id="LC4941">            CORINFO_METHOD_HANDLE   callerHandle,</td>
      </tr>
      <tr>
        <td id="L4942" data-line-number="4942"></td>
        <td id="LC4942">            CORINFO_HELPER_DESC    *pAccessHelper</td>
      </tr>
      <tr>
        <td id="L4943" data-line-number="4943"></td>
        <td id="LC4943">            )</td>
      </tr>
      <tr>
        <td id="L4944" data-line-number="4944"></td>
        <td id="LC4944">{</td>
      </tr>
      <tr>
        <td id="L4945" data-line-number="4945"></td>
        <td id="LC4945">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L4946" data-line-number="4946"></td>
        <td id="LC4946">        THROWS;</td>
      </tr>
      <tr>
        <td id="L4947" data-line-number="4947"></td>
        <td id="LC4947">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L4948" data-line-number="4948"></td>
        <td id="LC4948">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L4949" data-line-number="4949"></td>
        <td id="LC4949">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L4950" data-line-number="4950"></td>
        <td id="LC4950">
</td>
      </tr>
      <tr>
        <td id="L4951" data-line-number="4951"></td>
        <td id="LC4951">    CorInfoIsAccessAllowedResult isAccessAllowed = CORINFO_ACCESS_ALLOWED;</td>
      </tr>
      <tr>
        <td id="L4952" data-line-number="4952"></td>
        <td id="LC4952">
</td>
      </tr>
      <tr>
        <td id="L4953" data-line-number="4953"></td>
        <td id="LC4953">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L4954" data-line-number="4954"></td>
        <td id="LC4954">
</td>
      </tr>
      <tr>
        <td id="L4955" data-line-number="4955"></td>
        <td id="LC4955">    <span>INDEBUG</span>(<span>memset</span>(pAccessHelper, <span>0xCC</span>, <span>sizeof</span>(*pAccessHelper)));</td>
      </tr>
      <tr>
        <td id="L4956" data-line-number="4956"></td>
        <td id="LC4956">
</td>
      </tr>
      <tr>
        <td id="L4957" data-line-number="4957"></td>
        <td id="LC4957">    BOOL doAccessCheck = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L4958" data-line-number="4958"></td>
        <td id="LC4958">    AccessCheckOptions::AccessCheckType accessCheckType = AccessCheckOptions::<span>kNormalAccessibilityChecks</span>;</td>
      </tr>
      <tr>
        <td id="L4959" data-line-number="4959"></td>
        <td id="LC4959">    DynamicResolver * pAccessContext = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L4960" data-line-number="4960"></td>
        <td id="LC4960">
</td>
      </tr>
      <tr>
        <td id="L4961" data-line-number="4961"></td>
        <td id="LC4961">    <span><span>//</span>All access checks must be done on the open instantiation.</span></td>
      </tr>
      <tr>
        <td id="L4962" data-line-number="4962"></td>
        <td id="LC4962">    MethodDesc * pCallerForSecurity = <span>GetMethodForSecurity</span>(callerHandle);</td>
      </tr>
      <tr>
        <td id="L4963" data-line-number="4963"></td>
        <td id="LC4963">    TypeHandle callerTypeForSecurity = <span>TypeHandle</span>(pCallerForSecurity-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L4964" data-line-number="4964"></td>
        <td id="LC4964">
</td>
      </tr>
      <tr>
        <td id="L4965" data-line-number="4965"></td>
        <td id="LC4965">    TypeHandle pCalleeForSecurity = <span>TypeHandle</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L4966" data-line-number="4966"></td>
        <td id="LC4966">    <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L4967" data-line-number="4967"></td>
        <td id="LC4967">    {</td>
      </tr>
      <tr>
        <td id="L4968" data-line-number="4968"></td>
        <td id="LC4968">        SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L4969" data-line-number="4969"></td>
        <td id="LC4969">        <span>SigTypeContext::InitTypeContext</span>(pCallerForSecurity, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L4970" data-line-number="4970"></td>
        <td id="LC4970">
</td>
      </tr>
      <tr>
        <td id="L4971" data-line-number="4971"></td>
        <td id="LC4971">        SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L4972" data-line-number="4972"></td>
        <td id="LC4972">        pCalleeForSecurity = sigptr.<span>GetTypeHandleThrowing</span>((Module *)pResolvedToken-&gt;<span>tokenScope</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L4973" data-line-number="4973"></td>
        <td id="LC4973">    }</td>
      </tr>
      <tr>
        <td id="L4974" data-line-number="4974"></td>
        <td id="LC4974">
</td>
      </tr>
      <tr>
        <td id="L4975" data-line-number="4975"></td>
        <td id="LC4975">    <span>while</span> (pCalleeForSecurity.<span>HasTypeParam</span>())</td>
      </tr>
      <tr>
        <td id="L4976" data-line-number="4976"></td>
        <td id="LC4976">    {</td>
      </tr>
      <tr>
        <td id="L4977" data-line-number="4977"></td>
        <td id="LC4977">        pCalleeForSecurity = pCalleeForSecurity.<span>GetTypeParam</span>();</td>
      </tr>
      <tr>
        <td id="L4978" data-line-number="4978"></td>
        <td id="LC4978">    }</td>
      </tr>
      <tr>
        <td id="L4979" data-line-number="4979"></td>
        <td id="LC4979">
</td>
      </tr>
      <tr>
        <td id="L4980" data-line-number="4980"></td>
        <td id="LC4980">    <span>if</span> (<span>IsDynamicScope</span>(pResolvedToken-&gt;<span>tokenScope</span>))</td>
      </tr>
      <tr>
        <td id="L4981" data-line-number="4981"></td>
        <td id="LC4981">    {</td>
      </tr>
      <tr>
        <td id="L4982" data-line-number="4982"></td>
        <td id="LC4982">        doAccessCheck = <span>ModifyCheckForDynamicMethod</span>(<span>GetDynamicResolver</span>(pResolvedToken-&gt;<span>tokenScope</span>),</td>
      </tr>
      <tr>
        <td id="L4983" data-line-number="4983"></td>
        <td id="LC4983">                                                    &amp;callerTypeForSecurity, &amp;accessCheckType,</td>
      </tr>
      <tr>
        <td id="L4984" data-line-number="4984"></td>
        <td id="LC4984">                                                    &amp;pAccessContext);</td>
      </tr>
      <tr>
        <td id="L4985" data-line-number="4985"></td>
        <td id="LC4985">    }</td>
      </tr>
      <tr>
        <td id="L4986" data-line-number="4986"></td>
        <td id="LC4986">
</td>
      </tr>
      <tr>
        <td id="L4987" data-line-number="4987"></td>
        <td id="LC4987">    <span><span>//</span>Since this is a check against a TypeHandle, there are some things we can stick in a TypeHandle that</span></td>
      </tr>
      <tr>
        <td id="L4988" data-line-number="4988"></td>
        <td id="LC4988">    <span><span>//</span>don't require access checks.</span></td>
      </tr>
      <tr>
        <td id="L4989" data-line-number="4989"></td>
        <td id="LC4989">    <span>if</span> (pCalleeForSecurity.<span>IsGenericVariable</span>())</td>
      </tr>
      <tr>
        <td id="L4990" data-line-number="4990"></td>
        <td id="LC4990">    {</td>
      </tr>
      <tr>
        <td id="L4991" data-line-number="4991"></td>
        <td id="LC4991">        <span><span>//</span>I don't need to check for access against !!0.</span></td>
      </tr>
      <tr>
        <td id="L4992" data-line-number="4992"></td>
        <td id="LC4992">        doAccessCheck = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L4993" data-line-number="4993"></td>
        <td id="LC4993">    }</td>
      </tr>
      <tr>
        <td id="L4994" data-line-number="4994"></td>
        <td id="LC4994">
</td>
      </tr>
      <tr>
        <td id="L4995" data-line-number="4995"></td>
        <td id="LC4995">    <span><span>//</span>Now do the visibility checks</span></td>
      </tr>
      <tr>
        <td id="L4996" data-line-number="4996"></td>
        <td id="LC4996">    <span>if</span> (doAccessCheck)</td>
      </tr>
      <tr>
        <td id="L4997" data-line-number="4997"></td>
        <td id="LC4997">    {</td>
      </tr>
      <tr>
        <td id="L4998" data-line-number="4998"></td>
        <td id="LC4998">        AccessCheckOptions <span>accessCheckOptions</span>(accessCheckType,</td>
      </tr>
      <tr>
        <td id="L4999" data-line-number="4999"></td>
        <td id="LC4999">                                              pAccessContext,</td>
      </tr>
      <tr>
        <td id="L5000" data-line-number="5000"></td>
        <td id="LC5000">                                              <span>FALSE</span> <span><span>/*</span>throw on error<span>*/</span></span>,</td>
      </tr>
      <tr>
        <td id="L5001" data-line-number="5001"></td>
        <td id="LC5001">                                              pCalleeForSecurity.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5002" data-line-number="5002"></td>
        <td id="LC5002">
</td>
      </tr>
      <tr>
        <td id="L5003" data-line-number="5003"></td>
        <td id="LC5003">        <span>_ASSERTE</span>(pCallerForSecurity != <span>NULL</span> &amp;&amp; callerTypeForSecurity != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L5004" data-line-number="5004"></td>
        <td id="LC5004">        AccessCheckContext <span>accessContext</span>(pCallerForSecurity, callerTypeForSecurity.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5005" data-line-number="5005"></td>
        <td id="LC5005">
</td>
      </tr>
      <tr>
        <td id="L5006" data-line-number="5006"></td>
        <td id="LC5006">        BOOL canAccessType = <span>ClassLoader::CanAccessClass</span>(&amp;accessContext,</td>
      </tr>
      <tr>
        <td id="L5007" data-line-number="5007"></td>
        <td id="LC5007">                                                         pCalleeForSecurity.<span>GetMethodTable</span>(),</td>
      </tr>
      <tr>
        <td id="L5008" data-line-number="5008"></td>
        <td id="LC5008">                                                         pCalleeForSecurity.<span>GetAssembly</span>(),</td>
      </tr>
      <tr>
        <td id="L5009" data-line-number="5009"></td>
        <td id="LC5009">                                                         accessCheckOptions);</td>
      </tr>
      <tr>
        <td id="L5010" data-line-number="5010"></td>
        <td id="LC5010">
</td>
      </tr>
      <tr>
        <td id="L5011" data-line-number="5011"></td>
        <td id="LC5011">        isAccessAllowed = canAccessType ? CORINFO_ACCESS_ALLOWED : CORINFO_ACCESS_ILLEGAL;</td>
      </tr>
      <tr>
        <td id="L5012" data-line-number="5012"></td>
        <td id="LC5012">    }</td>
      </tr>
      <tr>
        <td id="L5013" data-line-number="5013"></td>
        <td id="LC5013">
</td>
      </tr>
      <tr>
        <td id="L5014" data-line-number="5014"></td>
        <td id="LC5014">
</td>
      </tr>
      <tr>
        <td id="L5015" data-line-number="5015"></td>
        <td id="LC5015">    <span>if</span> (isAccessAllowed != CORINFO_ACCESS_ALLOWED)</td>
      </tr>
      <tr>
        <td id="L5016" data-line-number="5016"></td>
        <td id="LC5016">    {</td>
      </tr>
      <tr>
        <td id="L5017" data-line-number="5017"></td>
        <td id="LC5017">        <span><span>//</span>These all get the throw helper</span></td>
      </tr>
      <tr>
        <td id="L5018" data-line-number="5018"></td>
        <td id="LC5018">        pAccessHelper-&gt;<span>helperNum</span> = CORINFO_HELP_CLASS_ACCESS_EXCEPTION;</td>
      </tr>
      <tr>
        <td id="L5019" data-line-number="5019"></td>
        <td id="LC5019">        pAccessHelper-&gt;<span>numArgs</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L5020" data-line-number="5020"></td>
        <td id="LC5020">
</td>
      </tr>
      <tr>
        <td id="L5021" data-line-number="5021"></td>
        <td id="LC5021">        pAccessHelper-&gt;<span>args</span>[<span>0</span>].<span>Set</span>(<span>CORINFO_METHOD_HANDLE</span>(pCallerForSecurity));</td>
      </tr>
      <tr>
        <td id="L5022" data-line-number="5022"></td>
        <td id="LC5022">        pAccessHelper-&gt;<span>args</span>[<span>1</span>].<span>Set</span>(<span>CORINFO_CLASS_HANDLE</span>(pCalleeForSecurity.<span>AsPtr</span>()));</td>
      </tr>
      <tr>
        <td id="L5023" data-line-number="5023"></td>
        <td id="LC5023">
</td>
      </tr>
      <tr>
        <td id="L5024" data-line-number="5024"></td>
        <td id="LC5024">        <span>if</span> (<span>IsCompilingForNGen</span>())</td>
      </tr>
      <tr>
        <td id="L5025" data-line-number="5025"></td>
        <td id="LC5025">        {</td>
      </tr>
      <tr>
        <td id="L5026" data-line-number="5026"></td>
        <td id="LC5026">            <span><span>//</span>see code:CEEInfo::getCallInfo for more information.</span></td>
      </tr>
      <tr>
        <td id="L5027" data-line-number="5027"></td>
        <td id="LC5027">            <span>if</span> (pCallerForSecurity-&gt;<span>ContainsGenericVariables</span>() || pCalleeForSecurity.<span>ContainsGenericVariables</span>())</td>
      </tr>
      <tr>
        <td id="L5028" data-line-number="5028"></td>
        <td id="LC5028">                <span>COMPlusThrowNonLocalized</span>(<span>kNotSupportedException</span>, <span>W</span>(<span><span>"</span>Cannot embed generic TypeHandle<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L5029" data-line-number="5029"></td>
        <td id="LC5029">        }</td>
      </tr>
      <tr>
        <td id="L5030" data-line-number="5030"></td>
        <td id="LC5030">    }</td>
      </tr>
      <tr>
        <td id="L5031" data-line-number="5031"></td>
        <td id="LC5031">
</td>
      </tr>
      <tr>
        <td id="L5032" data-line-number="5032"></td>
        <td id="LC5032">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5033" data-line-number="5033"></td>
        <td id="LC5033">    <span>return</span> isAccessAllowed;</td>
      </tr>
      <tr>
        <td id="L5034" data-line-number="5034"></td>
        <td id="LC5034">}</td>
      </tr>
      <tr>
        <td id="L5035" data-line-number="5035"></td>
        <td id="LC5035">
</td>
      </tr>
      <tr>
        <td id="L5036" data-line-number="5036"></td>
        <td id="LC5036"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L5037" data-line-number="5037"></td>
        <td id="LC5037"><span><span>//</span> return the address of a pointer to a callable stub that will do the</span></td>
      </tr>
      <tr>
        <td id="L5038" data-line-number="5038"></td>
        <td id="LC5038"><span><span>//</span> virtual or interface call</span></td>
      </tr>
      <tr>
        <td id="L5039" data-line-number="5039"></td>
        <td id="LC5039"><span>void</span> <span>CEEInfo::getCallInfo</span>(</td>
      </tr>
      <tr>
        <td id="L5040" data-line-number="5040"></td>
        <td id="LC5040">            CORINFO_RESOLVED_TOKEN * pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L5041" data-line-number="5041"></td>
        <td id="LC5041">            CORINFO_RESOLVED_TOKEN * pConstrainedResolvedToken,</td>
      </tr>
      <tr>
        <td id="L5042" data-line-number="5042"></td>
        <td id="LC5042">            CORINFO_METHOD_HANDLE   callerHandle,</td>
      </tr>
      <tr>
        <td id="L5043" data-line-number="5043"></td>
        <td id="LC5043">            CORINFO_CALLINFO_FLAGS  flags,</td>
      </tr>
      <tr>
        <td id="L5044" data-line-number="5044"></td>
        <td id="LC5044">            CORINFO_CALL_INFO      *pResult <span><span>/*</span>out <span>*/</span></span>)</td>
      </tr>
      <tr>
        <td id="L5045" data-line-number="5045"></td>
        <td id="LC5045">{</td>
      </tr>
      <tr>
        <td id="L5046" data-line-number="5046"></td>
        <td id="LC5046">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L5047" data-line-number="5047"></td>
        <td id="LC5047">        THROWS;</td>
      </tr>
      <tr>
        <td id="L5048" data-line-number="5048"></td>
        <td id="LC5048">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L5049" data-line-number="5049"></td>
        <td id="LC5049">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L5050" data-line-number="5050"></td>
        <td id="LC5050">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L5051" data-line-number="5051"></td>
        <td id="LC5051">
</td>
      </tr>
      <tr>
        <td id="L5052" data-line-number="5052"></td>
        <td id="LC5052">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5053" data-line-number="5053"></td>
        <td id="LC5053">
</td>
      </tr>
      <tr>
        <td id="L5054" data-line-number="5054"></td>
        <td id="LC5054">    <span>_ASSERTE</span>(<span>CheckPointer</span>(pResult));</td>
      </tr>
      <tr>
        <td id="L5055" data-line-number="5055"></td>
        <td id="LC5055">
</td>
      </tr>
      <tr>
        <td id="L5056" data-line-number="5056"></td>
        <td id="LC5056">    <span>INDEBUG</span>(<span>memset</span>(pResult, <span>0xCC</span>, <span>sizeof</span>(*pResult)));</td>
      </tr>
      <tr>
        <td id="L5057" data-line-number="5057"></td>
        <td id="LC5057">
</td>
      </tr>
      <tr>
        <td id="L5058" data-line-number="5058"></td>
        <td id="LC5058">    pResult-&gt;<span>stubLookup</span>.<span>lookupKind</span>.<span>needsRuntimeLookup</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L5059" data-line-number="5059"></td>
        <td id="LC5059">
</td>
      </tr>
      <tr>
        <td id="L5060" data-line-number="5060"></td>
        <td id="LC5060">    MethodDesc* pMD = (MethodDesc *)pResolvedToken-&gt;<span>hMethod</span>;</td>
      </tr>
      <tr>
        <td id="L5061" data-line-number="5061"></td>
        <td id="LC5061">    TypeHandle <span>th</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L5062" data-line-number="5062"></td>
        <td id="LC5062">
</td>
      </tr>
      <tr>
        <td id="L5063" data-line-number="5063"></td>
        <td id="LC5063">    <span>_ASSERTE</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L5064" data-line-number="5064"></td>
        <td id="LC5064">    <span>_ASSERTE</span>((<span>size_t</span>(pMD) &amp; <span>0x1</span>) == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L5065" data-line-number="5065"></td>
        <td id="LC5065">
</td>
      </tr>
      <tr>
        <td id="L5066" data-line-number="5066"></td>
        <td id="LC5066">    <span><span>//</span> Spec says that a callvirt lookup ignores static methods. Since static methods</span></td>
      </tr>
      <tr>
        <td id="L5067" data-line-number="5067"></td>
        <td id="LC5067">    <span><span>//</span> can't have the exact same signature as instance methods, a lookup that found</span></td>
      </tr>
      <tr>
        <td id="L5068" data-line-number="5068"></td>
        <td id="LC5068">    <span><span>//</span> a static method would have never found an instance method.</span></td>
      </tr>
      <tr>
        <td id="L5069" data-line-number="5069"></td>
        <td id="LC5069">    <span>if</span> (pMD-&gt;<span>IsStatic</span>() &amp;&amp; (flags &amp; CORINFO_CALLINFO_CALLVIRT))</td>
      </tr>
      <tr>
        <td id="L5070" data-line-number="5070"></td>
        <td id="LC5070">    {</td>
      </tr>
      <tr>
        <td id="L5071" data-line-number="5071"></td>
        <td id="LC5071">        <span>EX_THROW</span>(EEMessageException, (<span>kMissingMethodException</span>, IDS_EE_MISSING_METHOD, <span>W</span>(<span><span>"</span>?<span>"</span></span>)));</td>
      </tr>
      <tr>
        <td id="L5072" data-line-number="5072"></td>
        <td id="LC5072">    }</td>
      </tr>
      <tr>
        <td id="L5073" data-line-number="5073"></td>
        <td id="LC5073">
</td>
      </tr>
      <tr>
        <td id="L5074" data-line-number="5074"></td>
        <td id="LC5074">    TypeHandle exactType = <span>TypeHandle</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L5075" data-line-number="5075"></td>
        <td id="LC5075">
</td>
      </tr>
      <tr>
        <td id="L5076" data-line-number="5076"></td>
        <td id="LC5076">    TypeHandle constrainedType;</td>
      </tr>
      <tr>
        <td id="L5077" data-line-number="5077"></td>
        <td id="LC5077">    <span>if</span> ((flags &amp; CORINFO_CALLINFO_CALLVIRT) &amp;&amp; (pConstrainedResolvedToken != <span>NULL</span>))</td>
      </tr>
      <tr>
        <td id="L5078" data-line-number="5078"></td>
        <td id="LC5078">    {</td>
      </tr>
      <tr>
        <td id="L5079" data-line-number="5079"></td>
        <td id="LC5079">        constrainedType = <span>TypeHandle</span>(pConstrainedResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L5080" data-line-number="5080"></td>
        <td id="LC5080">    }</td>
      </tr>
      <tr>
        <td id="L5081" data-line-number="5081"></td>
        <td id="LC5081">
</td>
      </tr>
      <tr>
        <td id="L5082" data-line-number="5082"></td>
        <td id="LC5082">    BOOL <span>fResolvedConstraint</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L5083" data-line-number="5083"></td>
        <td id="LC5083">    BOOL <span>fForceUseRuntimeLookup</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L5084" data-line-number="5084"></td>
        <td id="LC5084">
</td>
      </tr>
      <tr>
        <td id="L5085" data-line-number="5085"></td>
        <td id="LC5085">    MethodDesc * pMDAfterConstraintResolution = pMD;</td>
      </tr>
      <tr>
        <td id="L5086" data-line-number="5086"></td>
        <td id="LC5086">    <span>if</span> (constrainedType.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L5087" data-line-number="5087"></td>
        <td id="LC5087">    {</td>
      </tr>
      <tr>
        <td id="L5088" data-line-number="5088"></td>
        <td id="LC5088">        pResult-&gt;<span>thisTransform</span> = CORINFO_NO_THIS_TRANSFORM;</td>
      </tr>
      <tr>
        <td id="L5089" data-line-number="5089"></td>
        <td id="LC5089">    }</td>
      </tr>
      <tr>
        <td id="L5090" data-line-number="5090"></td>
        <td id="LC5090">    <span><span>//</span> &lt;NICE&gt; Things go wrong when this code path is used when verifying generic code.</span></td>
      </tr>
      <tr>
        <td id="L5091" data-line-number="5091"></td>
        <td id="LC5091">    <span><span>//</span> It would be nice if we didn't go down this sort of code path when verifying but</span></td>
      </tr>
      <tr>
        <td id="L5092" data-line-number="5092"></td>
        <td id="LC5092">    <span><span>//</span> not generating code. &lt;/NICE&gt;</span></td>
      </tr>
      <tr>
        <td id="L5093" data-line-number="5093"></td>
        <td id="LC5093">    <span>else</span> <span>if</span> (constrainedType.<span>ContainsGenericVariables</span>() || exactType.<span>ContainsGenericVariables</span>())</td>
      </tr>
      <tr>
        <td id="L5094" data-line-number="5094"></td>
        <td id="LC5094">    {</td>
      </tr>
      <tr>
        <td id="L5095" data-line-number="5095"></td>
        <td id="LC5095">        <span><span>//</span> &lt;NICE&gt; It shouldn't really matter what we do here - but the x86 JIT is annoyingly sensitive</span></td>
      </tr>
      <tr>
        <td id="L5096" data-line-number="5096"></td>
        <td id="LC5096">        <span><span>//</span> about what we do, since it pretend generic variables are reference types and generates</span></td>
      </tr>
      <tr>
        <td id="L5097" data-line-number="5097"></td>
        <td id="LC5097">        <span><span>//</span> an internal JIT tree even when just verifying generic code. &lt;/NICE&gt;</span></td>
      </tr>
      <tr>
        <td id="L5098" data-line-number="5098"></td>
        <td id="LC5098">        <span>if</span> (constrainedType.<span>IsGenericVariable</span>())</td>
      </tr>
      <tr>
        <td id="L5099" data-line-number="5099"></td>
        <td id="LC5099">        {</td>
      </tr>
      <tr>
        <td id="L5100" data-line-number="5100"></td>
        <td id="LC5100">            pResult-&gt;<span>thisTransform</span> = CORINFO_DEREF_THIS; <span><span>//</span> convert 'this' of type &amp;T --&gt; T</span></td>
      </tr>
      <tr>
        <td id="L5101" data-line-number="5101"></td>
        <td id="LC5101">        }</td>
      </tr>
      <tr>
        <td id="L5102" data-line-number="5102"></td>
        <td id="LC5102">        <span>else</span> <span>if</span> (constrainedType.<span>IsValueType</span>())</td>
      </tr>
      <tr>
        <td id="L5103" data-line-number="5103"></td>
        <td id="LC5103">        {</td>
      </tr>
      <tr>
        <td id="L5104" data-line-number="5104"></td>
        <td id="LC5104">            pResult-&gt;<span>thisTransform</span> = CORINFO_BOX_THIS; <span><span>//</span> convert 'this' of type &amp;VC&lt;T&gt; --&gt; boxed(VC&lt;T&gt;)</span></td>
      </tr>
      <tr>
        <td id="L5105" data-line-number="5105"></td>
        <td id="LC5105">        }</td>
      </tr>
      <tr>
        <td id="L5106" data-line-number="5106"></td>
        <td id="LC5106">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5107" data-line-number="5107"></td>
        <td id="LC5107">        {</td>
      </tr>
      <tr>
        <td id="L5108" data-line-number="5108"></td>
        <td id="LC5108">            pResult-&gt;<span>thisTransform</span> = CORINFO_DEREF_THIS; <span><span>//</span> convert 'this' of type &amp;C&lt;T&gt; --&gt; C&lt;T&gt;</span></td>
      </tr>
      <tr>
        <td id="L5109" data-line-number="5109"></td>
        <td id="LC5109">        }</td>
      </tr>
      <tr>
        <td id="L5110" data-line-number="5110"></td>
        <td id="LC5110">    }</td>
      </tr>
      <tr>
        <td id="L5111" data-line-number="5111"></td>
        <td id="LC5111">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5112" data-line-number="5112"></td>
        <td id="LC5112">    {</td>
      </tr>
      <tr>
        <td id="L5113" data-line-number="5113"></td>
        <td id="LC5113">        <span><span>//</span> We have a "constrained." call.  Try a partial resolve of the constraint call.  Note that this</span></td>
      </tr>
      <tr>
        <td id="L5114" data-line-number="5114"></td>
        <td id="LC5114">        <span><span>//</span> will not necessarily resolve the call exactly, since we might be compiling</span></td>
      </tr>
      <tr>
        <td id="L5115" data-line-number="5115"></td>
        <td id="LC5115">        <span><span>//</span> shared generic code - it may just resolve it to a candidate suitable for</span></td>
      </tr>
      <tr>
        <td id="L5116" data-line-number="5116"></td>
        <td id="LC5116">        <span><span>//</span> JIT compilation, and require a runtime lookup for the actual code pointer</span></td>
      </tr>
      <tr>
        <td id="L5117" data-line-number="5117"></td>
        <td id="LC5117">        <span><span>//</span> to call.</span></td>
      </tr>
      <tr>
        <td id="L5118" data-line-number="5118"></td>
        <td id="LC5118">        <span>if</span> (constrainedType.<span>IsEnum</span>())</td>
      </tr>
      <tr>
        <td id="L5119" data-line-number="5119"></td>
        <td id="LC5119">        {</td>
      </tr>
      <tr>
        <td id="L5120" data-line-number="5120"></td>
        <td id="LC5120">            <span><span>//</span> Optimize constrained calls to enum's GetHashCode method. TryResolveConstraintMethodApprox would return</span></td>
      </tr>
      <tr>
        <td id="L5121" data-line-number="5121"></td>
        <td id="LC5121">            <span><span>//</span> null since the virtual method resolves to System.Enum's implementation and that's a reference type.</span></td>
      </tr>
      <tr>
        <td id="L5122" data-line-number="5122"></td>
        <td id="LC5122">            <span><span>//</span> We can't do this for any other method since ToString and Equals have different semantics for enums</span></td>
      </tr>
      <tr>
        <td id="L5123" data-line-number="5123"></td>
        <td id="LC5123">            <span><span>//</span> and their underlying type.</span></td>
      </tr>
      <tr>
        <td id="L5124" data-line-number="5124"></td>
        <td id="LC5124">            <span>if</span> (pMD-&gt;<span>GetSlot</span>() == <span>MscorlibBinder::GetMethod</span>(METHOD__OBJECT__GET_HASH_CODE)-&gt;<span>GetSlot</span>())</td>
      </tr>
      <tr>
        <td id="L5125" data-line-number="5125"></td>
        <td id="LC5125">            {</td>
      </tr>
      <tr>
        <td id="L5126" data-line-number="5126"></td>
        <td id="LC5126">                <span><span>//</span> Pretend this was a "constrained. UnderlyingType" instruction prefix</span></td>
      </tr>
      <tr>
        <td id="L5127" data-line-number="5127"></td>
        <td id="LC5127">                constrainedType = <span>TypeHandle</span>(<span>MscorlibBinder::GetElementType</span>(constrainedType.<span>GetVerifierCorElementType</span>()));</td>
      </tr>
      <tr>
        <td id="L5128" data-line-number="5128"></td>
        <td id="LC5128">
</td>
      </tr>
      <tr>
        <td id="L5129" data-line-number="5129"></td>
        <td id="LC5129">                <span><span>//</span> Native image signature encoder will use this field. It needs to match that pretended type, a bogus signature</span></td>
      </tr>
      <tr>
        <td id="L5130" data-line-number="5130"></td>
        <td id="LC5130">                <span><span>//</span> would be produced otherwise.</span></td>
      </tr>
      <tr>
        <td id="L5131" data-line-number="5131"></td>
        <td id="LC5131">                pConstrainedResolvedToken-&gt;<span>hClass</span> = (CORINFO_CLASS_HANDLE)constrainedType.<span>AsPtr</span>();</td>
      </tr>
      <tr>
        <td id="L5132" data-line-number="5132"></td>
        <td id="LC5132">
</td>
      </tr>
      <tr>
        <td id="L5133" data-line-number="5133"></td>
        <td id="LC5133">                <span><span>//</span> Clear the token and typespec because of they do not match hClass anymore.</span></td>
      </tr>
      <tr>
        <td id="L5134" data-line-number="5134"></td>
        <td id="LC5134">                pConstrainedResolvedToken-&gt;<span>token</span> = mdTokenNil;</td>
      </tr>
      <tr>
        <td id="L5135" data-line-number="5135"></td>
        <td id="LC5135">                pConstrainedResolvedToken-&gt;<span>pTypeSpec</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L5136" data-line-number="5136"></td>
        <td id="LC5136">            }</td>
      </tr>
      <tr>
        <td id="L5137" data-line-number="5137"></td>
        <td id="LC5137">        }</td>
      </tr>
      <tr>
        <td id="L5138" data-line-number="5138"></td>
        <td id="LC5138">
</td>
      </tr>
      <tr>
        <td id="L5139" data-line-number="5139"></td>
        <td id="LC5139">        MethodDesc * directMethod = constrainedType.<span>GetMethodTable</span>()-&gt;<span>TryResolveConstraintMethodApprox</span>(</td>
      </tr>
      <tr>
        <td id="L5140" data-line-number="5140"></td>
        <td id="LC5140">            exactType,</td>
      </tr>
      <tr>
        <td id="L5141" data-line-number="5141"></td>
        <td id="LC5141">            pMD,</td>
      </tr>
      <tr>
        <td id="L5142" data-line-number="5142"></td>
        <td id="LC5142">            &amp;<span>fForceUseRuntimeLookup</span>);</td>
      </tr>
      <tr>
        <td id="L5143" data-line-number="5143"></td>
        <td id="LC5143">        <span>if</span> (directMethod</td>
      </tr>
      <tr>
        <td id="L5144" data-line-number="5144"></td>
        <td id="LC5144">#<span>ifdef</span> FEATURE_DEFAULT_INTERFACES</td>
      </tr>
      <tr>
        <td id="L5145" data-line-number="5145"></td>
        <td id="LC5145">            &amp;&amp; !directMethod-&gt;<span>IsInterface</span>() <span><span>/*</span> Could be a default interface method implementation <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L5146" data-line-number="5146"></td>
        <td id="LC5146">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L5147" data-line-number="5147"></td>
        <td id="LC5147">            )</td>
      </tr>
      <tr>
        <td id="L5148" data-line-number="5148"></td>
        <td id="LC5148">        {</td>
      </tr>
      <tr>
        <td id="L5149" data-line-number="5149"></td>
        <td id="LC5149">            <span><span>//</span> Either</span></td>
      </tr>
      <tr>
        <td id="L5150" data-line-number="5150"></td>
        <td id="LC5150">            <span><span>//</span>    1. no constraint resolution at compile time (!directMethod)</span></td>
      </tr>
      <tr>
        <td id="L5151" data-line-number="5151"></td>
        <td id="LC5151">            <span><span>//</span> OR 2. no code sharing lookup in call</span></td>
      </tr>
      <tr>
        <td id="L5152" data-line-number="5152"></td>
        <td id="LC5152">            <span><span>//</span> OR 3. we have have resolved to an instantiating stub</span></td>
      </tr>
      <tr>
        <td id="L5153" data-line-number="5153"></td>
        <td id="LC5153">
</td>
      </tr>
      <tr>
        <td id="L5154" data-line-number="5154"></td>
        <td id="LC5154">            pMDAfterConstraintResolution = directMethod;</td>
      </tr>
      <tr>
        <td id="L5155" data-line-number="5155"></td>
        <td id="LC5155">            <span>_ASSERTE</span>(!pMDAfterConstraintResolution-&gt;<span>IsInterface</span>());</td>
      </tr>
      <tr>
        <td id="L5156" data-line-number="5156"></td>
        <td id="LC5156">            <span>fResolvedConstraint</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5157" data-line-number="5157"></td>
        <td id="LC5157">            pResult-&gt;<span>thisTransform</span> = CORINFO_NO_THIS_TRANSFORM;</td>
      </tr>
      <tr>
        <td id="L5158" data-line-number="5158"></td>
        <td id="LC5158">
</td>
      </tr>
      <tr>
        <td id="L5159" data-line-number="5159"></td>
        <td id="LC5159">            exactType = constrainedType;</td>
      </tr>
      <tr>
        <td id="L5160" data-line-number="5160"></td>
        <td id="LC5160">        }</td>
      </tr>
      <tr>
        <td id="L5161" data-line-number="5161"></td>
        <td id="LC5161">        <span>else</span>  <span>if</span> (constrainedType.<span>IsValueType</span>())</td>
      </tr>
      <tr>
        <td id="L5162" data-line-number="5162"></td>
        <td id="LC5162">        {</td>
      </tr>
      <tr>
        <td id="L5163" data-line-number="5163"></td>
        <td id="LC5163">            pResult-&gt;<span>thisTransform</span> = CORINFO_BOX_THIS;</td>
      </tr>
      <tr>
        <td id="L5164" data-line-number="5164"></td>
        <td id="LC5164">        }</td>
      </tr>
      <tr>
        <td id="L5165" data-line-number="5165"></td>
        <td id="LC5165">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5166" data-line-number="5166"></td>
        <td id="LC5166">        {</td>
      </tr>
      <tr>
        <td id="L5167" data-line-number="5167"></td>
        <td id="LC5167">            pResult-&gt;<span>thisTransform</span> = CORINFO_DEREF_THIS;</td>
      </tr>
      <tr>
        <td id="L5168" data-line-number="5168"></td>
        <td id="LC5168">        }</td>
      </tr>
      <tr>
        <td id="L5169" data-line-number="5169"></td>
        <td id="LC5169">    }</td>
      </tr>
      <tr>
        <td id="L5170" data-line-number="5170"></td>
        <td id="LC5170">
</td>
      </tr>
      <tr>
        <td id="L5171" data-line-number="5171"></td>
        <td id="LC5171">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5172" data-line-number="5172"></td>
        <td id="LC5172">    <span><span>//</span> Initialize callee context used for inlining and instantiation arguments</span></td>
      </tr>
      <tr>
        <td id="L5173" data-line-number="5173"></td>
        <td id="LC5173">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5174" data-line-number="5174"></td>
        <td id="LC5174">
</td>
      </tr>
      <tr>
        <td id="L5175" data-line-number="5175"></td>
        <td id="LC5175">    MethodDesc * pTargetMD = pMDAfterConstraintResolution;</td>
      </tr>
      <tr>
        <td id="L5176" data-line-number="5176"></td>
        <td id="LC5176">    DWORD dwTargetMethodAttrs = pTargetMD-&gt;<span>GetAttrs</span>();</td>
      </tr>
      <tr>
        <td id="L5177" data-line-number="5177"></td>
        <td id="LC5177">
</td>
      </tr>
      <tr>
        <td id="L5178" data-line-number="5178"></td>
        <td id="LC5178">    <span>if</span> (pTargetMD-&gt;<span>HasMethodInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L5179" data-line-number="5179"></td>
        <td id="LC5179">    {</td>
      </tr>
      <tr>
        <td id="L5180" data-line-number="5180"></td>
        <td id="LC5180">        pResult-&gt;<span>contextHandle</span> = <span>MAKE_METHODCONTEXT</span>(pTargetMD);</td>
      </tr>
      <tr>
        <td id="L5181" data-line-number="5181"></td>
        <td id="LC5181">        pResult-&gt;<span>exactContextNeedsRuntimeLookup</span> = pTargetMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsSharedByGenericInstantiations</span>() || <span>TypeHandle::IsCanonicalSubtypeInstantiation</span>(pTargetMD-&gt;<span>GetMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L5182" data-line-number="5182"></td>
        <td id="LC5182">    }</td>
      </tr>
      <tr>
        <td id="L5183" data-line-number="5183"></td>
        <td id="LC5183">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5184" data-line-number="5184"></td>
        <td id="LC5184">    {</td>
      </tr>
      <tr>
        <td id="L5185" data-line-number="5185"></td>
        <td id="LC5185">        <span>if</span> (!exactType.<span>IsTypeDesc</span>() &amp;&amp; !pTargetMD-&gt;<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L5186" data-line-number="5186"></td>
        <td id="LC5186">        {</td>
      </tr>
      <tr>
        <td id="L5187" data-line-number="5187"></td>
        <td id="LC5187">            <span><span>//</span> Because of .NET's notion of base calls, exactType may point to a sub-class</span></td>
      </tr>
      <tr>
        <td id="L5188" data-line-number="5188"></td>
        <td id="LC5188">            <span><span>//</span> of the actual class that defines pTargetMD.  If the JIT decides to inline, it is</span></td>
      </tr>
      <tr>
        <td id="L5189" data-line-number="5189"></td>
        <td id="LC5189">            <span><span>//</span> important that they 'match', so we fix exactType here.</span></td>
      </tr>
      <tr>
        <td id="L5190" data-line-number="5190"></td>
        <td id="LC5190">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L5191" data-line-number="5191"></td>
        <td id="LC5191">            <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L5192" data-line-number="5192"></td>
        <td id="LC5192">                !<span>isVerifyOnly</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L5193" data-line-number="5193"></td>
        <td id="LC5193">                !<span>IsInSameVersionBubble</span>((MethodDesc*)callerHandle, pTargetMD))</td>
      </tr>
      <tr>
        <td id="L5194" data-line-number="5194"></td>
        <td id="LC5194">            {</td>
      </tr>
      <tr>
        <td id="L5195" data-line-number="5195"></td>
        <td id="LC5195">                <span><span>//</span> For version resilient code we can only inline within the same version bubble;</span></td>
      </tr>
      <tr>
        <td id="L5196" data-line-number="5196"></td>
        <td id="LC5196">                <span><span>//</span> we "repair" the precise types only for those callees.</span></td>
      </tr>
      <tr>
        <td id="L5197" data-line-number="5197"></td>
        <td id="LC5197">                <span><span>//</span> The above condition needs to stay in sync with CEEInfo::canInline</span></td>
      </tr>
      <tr>
        <td id="L5198" data-line-number="5198"></td>
        <td id="LC5198">            }</td>
      </tr>
      <tr>
        <td id="L5199" data-line-number="5199"></td>
        <td id="LC5199">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L5200" data-line-number="5200"></td>
        <td id="LC5200">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L5201" data-line-number="5201"></td>
        <td id="LC5201">            {</td>
      </tr>
      <tr>
        <td id="L5202" data-line-number="5202"></td>
        <td id="LC5202">                exactType = pTargetMD-&gt;<span>GetExactDeclaringType</span>(exactType.<span>AsMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5203" data-line-number="5203"></td>
        <td id="LC5203">                <span>_ASSERTE</span>(!exactType.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L5204" data-line-number="5204"></td>
        <td id="LC5204">            }</td>
      </tr>
      <tr>
        <td id="L5205" data-line-number="5205"></td>
        <td id="LC5205">        }</td>
      </tr>
      <tr>
        <td id="L5206" data-line-number="5206"></td>
        <td id="LC5206">
</td>
      </tr>
      <tr>
        <td id="L5207" data-line-number="5207"></td>
        <td id="LC5207">        pResult-&gt;<span>contextHandle</span> = <span>MAKE_CLASSCONTEXT</span>(exactType.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L5208" data-line-number="5208"></td>
        <td id="LC5208">        pResult-&gt;<span>exactContextNeedsRuntimeLookup</span> = exactType.<span>IsSharedByGenericInstantiations</span>();</td>
      </tr>
      <tr>
        <td id="L5209" data-line-number="5209"></td>
        <td id="LC5209">    }</td>
      </tr>
      <tr>
        <td id="L5210" data-line-number="5210"></td>
        <td id="LC5210">
</td>
      </tr>
      <tr>
        <td id="L5211" data-line-number="5211"></td>
        <td id="LC5211">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5212" data-line-number="5212"></td>
        <td id="LC5212">    <span><span>//</span> Determine whether to perform direct call</span></td>
      </tr>
      <tr>
        <td id="L5213" data-line-number="5213"></td>
        <td id="LC5213">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5214" data-line-number="5214"></td>
        <td id="LC5214">
</td>
      </tr>
      <tr>
        <td id="L5215" data-line-number="5215"></td>
        <td id="LC5215">    <span>bool</span> directCall = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L5216" data-line-number="5216"></td>
        <td id="LC5216">    <span>bool</span> resolvedCallVirt = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L5217" data-line-number="5217"></td>
        <td id="LC5217">    <span>bool</span> callVirtCrossingVersionBubble = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L5218" data-line-number="5218"></td>
        <td id="LC5218">
</td>
      </tr>
      <tr>
        <td id="L5219" data-line-number="5219"></td>
        <td id="LC5219">    <span><span>//</span> Delegate targets are always treated as direct calls here. (It would be nice to clean it up...).</span></td>
      </tr>
      <tr>
        <td id="L5220" data-line-number="5220"></td>
        <td id="LC5220">    <span>if</span> (flags &amp; CORINFO_CALLINFO_LDFTN)</td>
      </tr>
      <tr>
        <td id="L5221" data-line-number="5221"></td>
        <td id="LC5221">    {</td>
      </tr>
      <tr>
        <td id="L5222" data-line-number="5222"></td>
        <td id="LC5222">        <span>if</span> (m_pOverride != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L5223" data-line-number="5223"></td>
        <td id="LC5223">            <span>TypeEquivalenceFixupSpecificationHelper</span>(m_pOverride, pTargetMD);</td>
      </tr>
      <tr>
        <td id="L5224" data-line-number="5224"></td>
        <td id="LC5224">        directCall = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L5225" data-line-number="5225"></td>
        <td id="LC5225">    }</td>
      </tr>
      <tr>
        <td id="L5226" data-line-number="5226"></td>
        <td id="LC5226">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5227" data-line-number="5227"></td>
        <td id="LC5227">    <span><span>//</span> Static methods are always direct calls</span></td>
      </tr>
      <tr>
        <td id="L5228" data-line-number="5228"></td>
        <td id="LC5228">    <span>if</span> (pTargetMD-&gt;<span>IsStatic</span>())</td>
      </tr>
      <tr>
        <td id="L5229" data-line-number="5229"></td>
        <td id="LC5229">    {</td>
      </tr>
      <tr>
        <td id="L5230" data-line-number="5230"></td>
        <td id="LC5230">        directCall = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L5231" data-line-number="5231"></td>
        <td id="LC5231">    }</td>
      </tr>
      <tr>
        <td id="L5232" data-line-number="5232"></td>
        <td id="LC5232">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5233" data-line-number="5233"></td>
        <td id="LC5233">    <span>if</span> (!(flags &amp; CORINFO_CALLINFO_CALLVIRT) || <span>fResolvedConstraint</span>)</td>
      </tr>
      <tr>
        <td id="L5234" data-line-number="5234"></td>
        <td id="LC5234">    {</td>
      </tr>
      <tr>
        <td id="L5235" data-line-number="5235"></td>
        <td id="LC5235">        directCall = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L5236" data-line-number="5236"></td>
        <td id="LC5236">    }</td>
      </tr>
      <tr>
        <td id="L5237" data-line-number="5237"></td>
        <td id="LC5237">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5238" data-line-number="5238"></td>
        <td id="LC5238">    {</td>
      </tr>
      <tr>
        <td id="L5239" data-line-number="5239"></td>
        <td id="LC5239">        <span>bool</span> devirt;</td>
      </tr>
      <tr>
        <td id="L5240" data-line-number="5240"></td>
        <td id="LC5240">
</td>
      </tr>
      <tr>
        <td id="L5241" data-line-number="5241"></td>
        <td id="LC5241">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L5242" data-line-number="5242"></td>
        <td id="LC5242">
</td>
      </tr>
      <tr>
        <td id="L5243" data-line-number="5243"></td>
        <td id="LC5243">        <span><span>//</span> if we are generating version resilient code</span></td>
      </tr>
      <tr>
        <td id="L5244" data-line-number="5244"></td>
        <td id="LC5244">        <span><span>//</span> AND</span></td>
      </tr>
      <tr>
        <td id="L5245" data-line-number="5245"></td>
        <td id="LC5245">        <span><span>//</span>    caller/callee are in different version bubbles</span></td>
      </tr>
      <tr>
        <td id="L5246" data-line-number="5246"></td>
        <td id="LC5246">        <span><span>//</span> we have to apply more restrictive rules</span></td>
      </tr>
      <tr>
        <td id="L5247" data-line-number="5247"></td>
        <td id="LC5247">        <span><span>//</span> These rules are related to the "inlining rules" as far as the</span></td>
      </tr>
      <tr>
        <td id="L5248" data-line-number="5248"></td>
        <td id="LC5248">        <span><span>//</span> boundaries of a version bubble are concerned.</span></td>
      </tr>
      <tr>
        <td id="L5249" data-line-number="5249"></td>
        <td id="LC5249">
</td>
      </tr>
      <tr>
        <td id="L5250" data-line-number="5250"></td>
        <td id="LC5250">        <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L5251" data-line-number="5251"></td>
        <td id="LC5251">            !<span>isVerifyOnly</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L5252" data-line-number="5252"></td>
        <td id="LC5252">            !<span>IsInSameVersionBubble</span>((MethodDesc*)callerHandle, pTargetMD)</td>
      </tr>
      <tr>
        <td id="L5253" data-line-number="5253"></td>
        <td id="LC5253">           )</td>
      </tr>
      <tr>
        <td id="L5254" data-line-number="5254"></td>
        <td id="LC5254">        {</td>
      </tr>
      <tr>
        <td id="L5255" data-line-number="5255"></td>
        <td id="LC5255">            <span><span>//</span> For version resiliency we won't de-virtualize all final/sealed method calls.  Because during a</span></td>
      </tr>
      <tr>
        <td id="L5256" data-line-number="5256"></td>
        <td id="LC5256">            <span><span>//</span> servicing event it is legal to unseal a method or type.</span></td>
      </tr>
      <tr>
        <td id="L5257" data-line-number="5257"></td>
        <td id="LC5257">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5258" data-line-number="5258"></td>
        <td id="LC5258">            <span><span>//</span> Note that it is safe to devirtualize in the following cases, since a servicing event cannot later modify it</span></td>
      </tr>
      <tr>
        <td id="L5259" data-line-number="5259"></td>
        <td id="LC5259">            <span><span>//</span>  1) Callvirt on a virtual final method of a value type - since value types are sealed types as per ECMA spec</span></td>
      </tr>
      <tr>
        <td id="L5260" data-line-number="5260"></td>
        <td id="LC5260">            <span><span>//</span>  2) Delegate.Invoke() - since a Delegate is a sealed class as per ECMA spec</span></td>
      </tr>
      <tr>
        <td id="L5261" data-line-number="5261"></td>
        <td id="LC5261">            <span><span>//</span>  3) JIT intrinsics - since they have pre-defined behavior</span></td>
      </tr>
      <tr>
        <td id="L5262" data-line-number="5262"></td>
        <td id="LC5262">            devirt = pTargetMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsValueType</span>() ||</td>
      </tr>
      <tr>
        <td id="L5263" data-line-number="5263"></td>
        <td id="LC5263">                     (pTargetMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsDelegate</span>() &amp;&amp; ((DelegateEEClass*)(pTargetMD-&gt;<span>GetMethodTable</span>()-&gt;<span>GetClass</span>()))-&gt;<span>GetInvokeMethod</span>() == pMD) ||</td>
      </tr>
      <tr>
        <td id="L5264" data-line-number="5264"></td>
        <td id="LC5264">                     (pTargetMD-&gt;<span>IsFCall</span>() &amp;&amp; <span>ECall::GetIntrinsicID</span>(pTargetMD) != CORINFO_INTRINSIC_Illegal);</td>
      </tr>
      <tr>
        <td id="L5265" data-line-number="5265"></td>
        <td id="LC5265">
</td>
      </tr>
      <tr>
        <td id="L5266" data-line-number="5266"></td>
        <td id="LC5266">            callVirtCrossingVersionBubble = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L5267" data-line-number="5267"></td>
        <td id="LC5267">        }</td>
      </tr>
      <tr>
        <td id="L5268" data-line-number="5268"></td>
        <td id="LC5268">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5269" data-line-number="5269"></td>
        <td id="LC5269">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L5270" data-line-number="5270"></td>
        <td id="LC5270">        <span>if</span> (pTargetMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L5271" data-line-number="5271"></td>
        <td id="LC5271">        {</td>
      </tr>
      <tr>
        <td id="L5272" data-line-number="5272"></td>
        <td id="LC5272">            <span><span>//</span> Handle interface methods specially because the Sealed bit has no meaning on interfaces.</span></td>
      </tr>
      <tr>
        <td id="L5273" data-line-number="5273"></td>
        <td id="LC5273">            devirt = !<span>IsMdVirtual</span>(dwTargetMethodAttrs);</td>
      </tr>
      <tr>
        <td id="L5274" data-line-number="5274"></td>
        <td id="LC5274">        }</td>
      </tr>
      <tr>
        <td id="L5275" data-line-number="5275"></td>
        <td id="LC5275">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5276" data-line-number="5276"></td>
        <td id="LC5276">        {</td>
      </tr>
      <tr>
        <td id="L5277" data-line-number="5277"></td>
        <td id="LC5277">            devirt = !<span>IsMdVirtual</span>(dwTargetMethodAttrs) || <span>IsMdFinal</span>(dwTargetMethodAttrs) || pTargetMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsSealed</span>();</td>
      </tr>
      <tr>
        <td id="L5278" data-line-number="5278"></td>
        <td id="LC5278">        }</td>
      </tr>
      <tr>
        <td id="L5279" data-line-number="5279"></td>
        <td id="LC5279">
</td>
      </tr>
      <tr>
        <td id="L5280" data-line-number="5280"></td>
        <td id="LC5280">        <span>if</span> (devirt)</td>
      </tr>
      <tr>
        <td id="L5281" data-line-number="5281"></td>
        <td id="LC5281">        {</td>
      </tr>
      <tr>
        <td id="L5282" data-line-number="5282"></td>
        <td id="LC5282">            resolvedCallVirt = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L5283" data-line-number="5283"></td>
        <td id="LC5283">            directCall = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L5284" data-line-number="5284"></td>
        <td id="LC5284">        }</td>
      </tr>
      <tr>
        <td id="L5285" data-line-number="5285"></td>
        <td id="LC5285">    }</td>
      </tr>
      <tr>
        <td id="L5286" data-line-number="5286"></td>
        <td id="LC5286">
</td>
      </tr>
      <tr>
        <td id="L5287" data-line-number="5287"></td>
        <td id="LC5287">    <span>if</span> (directCall)</td>
      </tr>
      <tr>
        <td id="L5288" data-line-number="5288"></td>
        <td id="LC5288">    {</td>
      </tr>
      <tr>
        <td id="L5289" data-line-number="5289"></td>
        <td id="LC5289">        <span><span>//</span> Direct calls to abstract methods are not allowed</span></td>
      </tr>
      <tr>
        <td id="L5290" data-line-number="5290"></td>
        <td id="LC5290">        <span>if</span> (<span>IsMdAbstract</span>(dwTargetMethodAttrs) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L5291" data-line-number="5291"></td>
        <td id="LC5291">            <span><span>//</span> Compensate for always treating delegates as direct calls above</span></td>
      </tr>
      <tr>
        <td id="L5292" data-line-number="5292"></td>
        <td id="LC5292">            !(((flags &amp; CORINFO_CALLINFO_LDFTN) &amp;&amp; (flags &amp; CORINFO_CALLINFO_CALLVIRT) &amp;&amp; !resolvedCallVirt)))</td>
      </tr>
      <tr>
        <td id="L5293" data-line-number="5293"></td>
        <td id="LC5293">        {</td>
      </tr>
      <tr>
        <td id="L5294" data-line-number="5294"></td>
        <td id="LC5294">            <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT, BFA_BAD_IL);</td>
      </tr>
      <tr>
        <td id="L5295" data-line-number="5295"></td>
        <td id="LC5295">        }</td>
      </tr>
      <tr>
        <td id="L5296" data-line-number="5296"></td>
        <td id="LC5296">
</td>
      </tr>
      <tr>
        <td id="L5297" data-line-number="5297"></td>
        <td id="LC5297">        <span>bool</span> allowInstParam = (flags &amp; CORINFO_CALLINFO_ALLOWINSTPARAM);</td>
      </tr>
      <tr>
        <td id="L5298" data-line-number="5298"></td>
        <td id="LC5298">
</td>
      </tr>
      <tr>
        <td id="L5299" data-line-number="5299"></td>
        <td id="LC5299">        <span><span>//</span> Create instantiating stub if necesary</span></td>
      </tr>
      <tr>
        <td id="L5300" data-line-number="5300"></td>
        <td id="LC5300">        <span>if</span> (!allowInstParam &amp;&amp; pTargetMD-&gt;<span>RequiresInstArg</span>())</td>
      </tr>
      <tr>
        <td id="L5301" data-line-number="5301"></td>
        <td id="LC5301">        {</td>
      </tr>
      <tr>
        <td id="L5302" data-line-number="5302"></td>
        <td id="LC5302">            pTargetMD = <span>MethodDesc::FindOrCreateAssociatedMethodDesc</span>(pTargetMD,</td>
      </tr>
      <tr>
        <td id="L5303" data-line-number="5303"></td>
        <td id="LC5303">                exactType.<span>AsMethodTable</span>(),</td>
      </tr>
      <tr>
        <td id="L5304" data-line-number="5304"></td>
        <td id="LC5304">                <span>FALSE</span> <span><span>/*</span> forceBoxedEntryPoint <span>*/</span></span>,</td>
      </tr>
      <tr>
        <td id="L5305" data-line-number="5305"></td>
        <td id="LC5305">                pTargetMD-&gt;<span>GetMethodInstantiation</span>(),</td>
      </tr>
      <tr>
        <td id="L5306" data-line-number="5306"></td>
        <td id="LC5306">                <span>FALSE</span> <span><span>/*</span> allowInstParam <span>*/</span></span>);</td>
      </tr>
      <tr>
        <td id="L5307" data-line-number="5307"></td>
        <td id="LC5307">        }</td>
      </tr>
      <tr>
        <td id="L5308" data-line-number="5308"></td>
        <td id="LC5308">
</td>
      </tr>
      <tr>
        <td id="L5309" data-line-number="5309"></td>
        <td id="LC5309">        <span><span>//</span> We don't allow a JIT to call the code directly if a runtime lookup is</span></td>
      </tr>
      <tr>
        <td id="L5310" data-line-number="5310"></td>
        <td id="LC5310">        <span><span>//</span> needed. This is the case if</span></td>
      </tr>
      <tr>
        <td id="L5311" data-line-number="5311"></td>
        <td id="LC5311">        <span><span>//</span>     1. the scan of the call token indicated that it involves code sharing</span></td>
      </tr>
      <tr>
        <td id="L5312" data-line-number="5312"></td>
        <td id="LC5312">        <span><span>//</span> AND 2. the method is an instantiating stub</span></td>
      </tr>
      <tr>
        <td id="L5313" data-line-number="5313"></td>
        <td id="LC5313">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5314" data-line-number="5314"></td>
        <td id="LC5314">        <span><span>//</span> In these cases the correct instantiating stub is only found via a runtime lookup.</span></td>
      </tr>
      <tr>
        <td id="L5315" data-line-number="5315"></td>
        <td id="LC5315">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5316" data-line-number="5316"></td>
        <td id="LC5316">        <span><span>//</span> Note that most JITs don't call instantiating stubs directly if they can help it -</span></td>
      </tr>
      <tr>
        <td id="L5317" data-line-number="5317"></td>
        <td id="LC5317">        <span><span>//</span> they call the underlying shared code and provide the type context parameter</span></td>
      </tr>
      <tr>
        <td id="L5318" data-line-number="5318"></td>
        <td id="LC5318">        <span><span>//</span> explicitly. However</span></td>
      </tr>
      <tr>
        <td id="L5319" data-line-number="5319"></td>
        <td id="LC5319">        <span><span>//</span>    (a) some JITs may call instantiating stubs (it makes the JIT simpler) and</span></td>
      </tr>
      <tr>
        <td id="L5320" data-line-number="5320"></td>
        <td id="LC5320">        <span><span>//</span>    (b) if the method is a remote stub then the EE will force the</span></td>
      </tr>
      <tr>
        <td id="L5321" data-line-number="5321"></td>
        <td id="LC5321">        <span><span>//</span>        call through an instantiating stub and</span></td>
      </tr>
      <tr>
        <td id="L5322" data-line-number="5322"></td>
        <td id="LC5322">        <span><span>//</span>    (c) constraint calls that require runtime context lookup are never resolved</span></td>
      </tr>
      <tr>
        <td id="L5323" data-line-number="5323"></td>
        <td id="LC5323">        <span><span>//</span>        to underlying shared generic code</span></td>
      </tr>
      <tr>
        <td id="L5324" data-line-number="5324"></td>
        <td id="LC5324">
</td>
      </tr>
      <tr>
        <td id="L5325" data-line-number="5325"></td>
        <td id="LC5325">        <span>bool</span> unresolvedLdVirtFtn = (flags &amp; CORINFO_CALLINFO_LDFTN) &amp;&amp; (flags &amp; CORINFO_CALLINFO_CALLVIRT) &amp;&amp; !resolvedCallVirt;</td>
      </tr>
      <tr>
        <td id="L5326" data-line-number="5326"></td>
        <td id="LC5326">
</td>
      </tr>
      <tr>
        <td id="L5327" data-line-number="5327"></td>
        <td id="LC5327">        <span>if</span> (((pResult-&gt;<span>exactContextNeedsRuntimeLookup</span> &amp;&amp; pTargetMD-&gt;<span>IsInstantiatingStub</span>() &amp;&amp; (!allowInstParam || <span>fResolvedConstraint</span>)) || <span>fForceUseRuntimeLookup</span>)</td>
      </tr>
      <tr>
        <td id="L5328" data-line-number="5328"></td>
        <td id="LC5328">                <span><span>//</span> Handle invalid IL - see comment in code:CEEInfo::ComputeRuntimeLookupForSharedGenericToken</span></td>
      </tr>
      <tr>
        <td id="L5329" data-line-number="5329"></td>
        <td id="LC5329">                &amp;&amp; <span>ContextIsShared</span>(pResolvedToken-&gt;<span>tokenContext</span>))</td>
      </tr>
      <tr>
        <td id="L5330" data-line-number="5330"></td>
        <td id="LC5330">        {</td>
      </tr>
      <tr>
        <td id="L5331" data-line-number="5331"></td>
        <td id="LC5331">            <span>_ASSERTE</span>(!m_pMethodBeingCompiled-&gt;<span>IsDynamicMethod</span>());</td>
      </tr>
      <tr>
        <td id="L5332" data-line-number="5332"></td>
        <td id="LC5332">
</td>
      </tr>
      <tr>
        <td id="L5333" data-line-number="5333"></td>
        <td id="LC5333">            <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp; unresolvedLdVirtFtn)</td>
      </tr>
      <tr>
        <td id="L5334" data-line-number="5334"></td>
        <td id="LC5334">            {</td>
      </tr>
      <tr>
        <td id="L5335" data-line-number="5335"></td>
        <td id="LC5335">                <span><span>//</span> Compensate for always treating delegates as direct calls above.</span></td>
      </tr>
      <tr>
        <td id="L5336" data-line-number="5336"></td>
        <td id="LC5336">                <span><span>//</span> Dictionary lookup is computed in embedGenericHandle as part of the LDVIRTFTN code sequence</span></td>
      </tr>
      <tr>
        <td id="L5337" data-line-number="5337"></td>
        <td id="LC5337">                pResult-&gt;<span>kind</span> = CORINFO_VIRTUALCALL_LDVIRTFTN;</td>
      </tr>
      <tr>
        <td id="L5338" data-line-number="5338"></td>
        <td id="LC5338">            }</td>
      </tr>
      <tr>
        <td id="L5339" data-line-number="5339"></td>
        <td id="LC5339">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L5340" data-line-number="5340"></td>
        <td id="LC5340">            {</td>
      </tr>
      <tr>
        <td id="L5341" data-line-number="5341"></td>
        <td id="LC5341">                pResult-&gt;<span>kind</span> = CORINFO_CALL_CODE_POINTER;</td>
      </tr>
      <tr>
        <td id="L5342" data-line-number="5342"></td>
        <td id="LC5342">
</td>
      </tr>
      <tr>
        <td id="L5343" data-line-number="5343"></td>
        <td id="LC5343">                <span><span>//</span> For reference types, the constrained type does not affect method resolution</span></td>
      </tr>
      <tr>
        <td id="L5344" data-line-number="5344"></td>
        <td id="LC5344">                DictionaryEntryKind entryKind = (!constrainedType.<span>IsNull</span>() &amp;&amp; constrainedType.<span>IsValueType</span>()) ? ConstrainedMethodEntrySlot : MethodEntrySlot;</td>
      </tr>
      <tr>
        <td id="L5345" data-line-number="5345"></td>
        <td id="LC5345">
</td>
      </tr>
      <tr>
        <td id="L5346" data-line-number="5346"></td>
        <td id="LC5346">                <span>ComputeRuntimeLookupForSharedGenericToken</span>(entryKind,</td>
      </tr>
      <tr>
        <td id="L5347" data-line-number="5347"></td>
        <td id="LC5347">                                                            pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L5348" data-line-number="5348"></td>
        <td id="LC5348">                                                            pConstrainedResolvedToken,</td>
      </tr>
      <tr>
        <td id="L5349" data-line-number="5349"></td>
        <td id="LC5349">                                                            pMD,</td>
      </tr>
      <tr>
        <td id="L5350" data-line-number="5350"></td>
        <td id="LC5350">                                                            &amp;pResult-&gt;<span>codePointerLookup</span>);</td>
      </tr>
      <tr>
        <td id="L5351" data-line-number="5351"></td>
        <td id="LC5351">            }</td>
      </tr>
      <tr>
        <td id="L5352" data-line-number="5352"></td>
        <td id="LC5352">        }</td>
      </tr>
      <tr>
        <td id="L5353" data-line-number="5353"></td>
        <td id="LC5353">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5354" data-line-number="5354"></td>
        <td id="LC5354">        {</td>
      </tr>
      <tr>
        <td id="L5355" data-line-number="5355"></td>
        <td id="LC5355">            <span>if</span> (allowInstParam &amp;&amp; pTargetMD-&gt;<span>IsInstantiatingStub</span>())</td>
      </tr>
      <tr>
        <td id="L5356" data-line-number="5356"></td>
        <td id="LC5356">            {</td>
      </tr>
      <tr>
        <td id="L5357" data-line-number="5357"></td>
        <td id="LC5357">                pTargetMD = pTargetMD-&gt;<span>GetWrappedMethodDesc</span>();</td>
      </tr>
      <tr>
        <td id="L5358" data-line-number="5358"></td>
        <td id="LC5358">            }</td>
      </tr>
      <tr>
        <td id="L5359" data-line-number="5359"></td>
        <td id="LC5359">
</td>
      </tr>
      <tr>
        <td id="L5360" data-line-number="5360"></td>
        <td id="LC5360">            pResult-&gt;<span>kind</span> = CORINFO_CALL;</td>
      </tr>
      <tr>
        <td id="L5361" data-line-number="5361"></td>
        <td id="LC5361">
</td>
      </tr>
      <tr>
        <td id="L5362" data-line-number="5362"></td>
        <td id="LC5362">            <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp; unresolvedLdVirtFtn)</td>
      </tr>
      <tr>
        <td id="L5363" data-line-number="5363"></td>
        <td id="LC5363">            {</td>
      </tr>
      <tr>
        <td id="L5364" data-line-number="5364"></td>
        <td id="LC5364">                <span><span>//</span> Compensate for always treating delegates as direct calls above</span></td>
      </tr>
      <tr>
        <td id="L5365" data-line-number="5365"></td>
        <td id="LC5365">                pResult-&gt;<span>kind</span> = CORINFO_VIRTUALCALL_LDVIRTFTN;</td>
      </tr>
      <tr>
        <td id="L5366" data-line-number="5366"></td>
        <td id="LC5366">            }</td>
      </tr>
      <tr>
        <td id="L5367" data-line-number="5367"></td>
        <td id="LC5367">        }</td>
      </tr>
      <tr>
        <td id="L5368" data-line-number="5368"></td>
        <td id="LC5368">        pResult-&gt;<span>nullInstanceCheck</span> = resolvedCallVirt;</td>
      </tr>
      <tr>
        <td id="L5369" data-line-number="5369"></td>
        <td id="LC5369">    }</td>
      </tr>
      <tr>
        <td id="L5370" data-line-number="5370"></td>
        <td id="LC5370">    <span><span>//</span> All virtual calls which take method instantiations must</span></td>
      </tr>
      <tr>
        <td id="L5371" data-line-number="5371"></td>
        <td id="LC5371">    <span><span>//</span> currently be implemented by an indirect call via a runtime-lookup</span></td>
      </tr>
      <tr>
        <td id="L5372" data-line-number="5372"></td>
        <td id="LC5372">    <span><span>//</span> function pointer</span></td>
      </tr>
      <tr>
        <td id="L5373" data-line-number="5373"></td>
        <td id="LC5373">    <span>else</span> <span>if</span> (pTargetMD-&gt;<span>HasMethodInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L5374" data-line-number="5374"></td>
        <td id="LC5374">    {</td>
      </tr>
      <tr>
        <td id="L5375" data-line-number="5375"></td>
        <td id="LC5375">        pResult-&gt;<span>kind</span> = CORINFO_VIRTUALCALL_LDVIRTFTN;  <span><span>//</span> stub dispatch can't handle generic method calls yet</span></td>
      </tr>
      <tr>
        <td id="L5376" data-line-number="5376"></td>
        <td id="LC5376">        pResult-&gt;<span>nullInstanceCheck</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5377" data-line-number="5377"></td>
        <td id="LC5377">    }</td>
      </tr>
      <tr>
        <td id="L5378" data-line-number="5378"></td>
        <td id="LC5378">    <span><span>//</span> Non-interface dispatches go through the vtable.</span></td>
      </tr>
      <tr>
        <td id="L5379" data-line-number="5379"></td>
        <td id="LC5379">    <span>else</span> <span>if</span> (!pTargetMD-&gt;<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L5380" data-line-number="5380"></td>
        <td id="LC5380">    {</td>
      </tr>
      <tr>
        <td id="L5381" data-line-number="5381"></td>
        <td id="LC5381">        pResult-&gt;<span>kind</span> = CORINFO_VIRTUALCALL_VTABLE;</td>
      </tr>
      <tr>
        <td id="L5382" data-line-number="5382"></td>
        <td id="LC5382">        pResult-&gt;<span>nullInstanceCheck</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5383" data-line-number="5383"></td>
        <td id="LC5383">
</td>
      </tr>
      <tr>
        <td id="L5384" data-line-number="5384"></td>
        <td id="LC5384">        <span><span>//</span> We'll special virtual calls to target methods in the corelib assembly when compiling in R2R mode, and generate fragile-NI-like callsites for improved performance. We</span></td>
      </tr>
      <tr>
        <td id="L5385" data-line-number="5385"></td>
        <td id="LC5385">        <span><span>//</span> can do that because today we'll always service the corelib assembly and the runtime in one bundle. Any caller in the corelib version bubble can benefit from this</span></td>
      </tr>
      <tr>
        <td id="L5386" data-line-number="5386"></td>
        <td id="LC5386">        <span><span>//</span> performance optimization.</span></td>
      </tr>
      <tr>
        <td id="L5387" data-line-number="5387"></td>
        <td id="LC5387">        <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp; !<span>CallerAndCalleeInSystemVersionBubble</span>((MethodDesc*)callerHandle, pTargetMD))</td>
      </tr>
      <tr>
        <td id="L5388" data-line-number="5388"></td>
        <td id="LC5388">        {</td>
      </tr>
      <tr>
        <td id="L5389" data-line-number="5389"></td>
        <td id="LC5389">            pResult-&gt;<span>kind</span> = CORINFO_VIRTUALCALL_STUB;</td>
      </tr>
      <tr>
        <td id="L5390" data-line-number="5390"></td>
        <td id="LC5390">        }</td>
      </tr>
      <tr>
        <td id="L5391" data-line-number="5391"></td>
        <td id="LC5391">    }</td>
      </tr>
      <tr>
        <td id="L5392" data-line-number="5392"></td>
        <td id="LC5392">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5393" data-line-number="5393"></td>
        <td id="LC5393">    {</td>
      </tr>
      <tr>
        <td id="L5394" data-line-number="5394"></td>
        <td id="LC5394">        <span>if</span> (<span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L5395" data-line-number="5395"></td>
        <td id="LC5395">        {</td>
      </tr>
      <tr>
        <td id="L5396" data-line-number="5396"></td>
        <td id="LC5396">            <span><span>//</span> Insert explicit null checks for cross-version bubble non-interface calls.</span></td>
      </tr>
      <tr>
        <td id="L5397" data-line-number="5397"></td>
        <td id="LC5397">            <span><span>//</span> It is required to handle null checks properly for non-virtual &lt;-&gt; virtual change between versions</span></td>
      </tr>
      <tr>
        <td id="L5398" data-line-number="5398"></td>
        <td id="LC5398">            pResult-&gt;<span>nullInstanceCheck</span> = !!(callVirtCrossingVersionBubble &amp;&amp; !pTargetMD-&gt;<span>IsInterface</span>());</td>
      </tr>
      <tr>
        <td id="L5399" data-line-number="5399"></td>
        <td id="LC5399">        }</td>
      </tr>
      <tr>
        <td id="L5400" data-line-number="5400"></td>
        <td id="LC5400">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5401" data-line-number="5401"></td>
        <td id="LC5401">        {</td>
      </tr>
      <tr>
        <td id="L5402" data-line-number="5402"></td>
        <td id="LC5402">            <span><span>//</span> No need to null check - the dispatch code will deal with null this.</span></td>
      </tr>
      <tr>
        <td id="L5403" data-line-number="5403"></td>
        <td id="LC5403">            pResult-&gt;<span>nullInstanceCheck</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L5404" data-line-number="5404"></td>
        <td id="LC5404">        }</td>
      </tr>
      <tr>
        <td id="L5405" data-line-number="5405"></td>
        <td id="LC5405">#<span>ifdef</span> STUB_DISPATCH_PORTABLE</td>
      </tr>
      <tr>
        <td id="L5406" data-line-number="5406"></td>
        <td id="LC5406">        pResult-&gt;<span>kind</span> = CORINFO_VIRTUALCALL_LDVIRTFTN;</td>
      </tr>
      <tr>
        <td id="L5407" data-line-number="5407"></td>
        <td id="LC5407">#<span>else</span> <span><span>//</span> STUB_DISPATCH_PORTABLE</span></td>
      </tr>
      <tr>
        <td id="L5408" data-line-number="5408"></td>
        <td id="LC5408">        pResult-&gt;<span>kind</span> = CORINFO_VIRTUALCALL_STUB;</td>
      </tr>
      <tr>
        <td id="L5409" data-line-number="5409"></td>
        <td id="LC5409">
</td>
      </tr>
      <tr>
        <td id="L5410" data-line-number="5410"></td>
        <td id="LC5410">        <span><span>//</span> We can't make stub calls when we need exact information</span></td>
      </tr>
      <tr>
        <td id="L5411" data-line-number="5411"></td>
        <td id="LC5411">        <span><span>//</span> for interface calls from shared code.</span></td>
      </tr>
      <tr>
        <td id="L5412" data-line-number="5412"></td>
        <td id="LC5412">
</td>
      </tr>
      <tr>
        <td id="L5413" data-line-number="5413"></td>
        <td id="LC5413">        <span>if</span> (<span><span>//</span> If the token is not shared then we don't need a runtime lookup</span></td>
      </tr>
      <tr>
        <td id="L5414" data-line-number="5414"></td>
        <td id="LC5414">            pResult-&gt;<span>exactContextNeedsRuntimeLookup</span></td>
      </tr>
      <tr>
        <td id="L5415" data-line-number="5415"></td>
        <td id="LC5415">            <span><span>//</span> Handle invalid IL - see comment in code:CEEInfo::ComputeRuntimeLookupForSharedGenericToken</span></td>
      </tr>
      <tr>
        <td id="L5416" data-line-number="5416"></td>
        <td id="LC5416">            &amp;&amp; <span>ContextIsShared</span>(pResolvedToken-&gt;<span>tokenContext</span>))</td>
      </tr>
      <tr>
        <td id="L5417" data-line-number="5417"></td>
        <td id="LC5417">        {</td>
      </tr>
      <tr>
        <td id="L5418" data-line-number="5418"></td>
        <td id="LC5418">            <span>_ASSERTE</span>(!m_pMethodBeingCompiled-&gt;<span>IsDynamicMethod</span>());</td>
      </tr>
      <tr>
        <td id="L5419" data-line-number="5419"></td>
        <td id="LC5419">
</td>
      </tr>
      <tr>
        <td id="L5420" data-line-number="5420"></td>
        <td id="LC5420">            <span>ComputeRuntimeLookupForSharedGenericToken</span>(DispatchStubAddrSlot,</td>
      </tr>
      <tr>
        <td id="L5421" data-line-number="5421"></td>
        <td id="LC5421">                                                        pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L5422" data-line-number="5422"></td>
        <td id="LC5422">                                                        <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L5423" data-line-number="5423"></td>
        <td id="LC5423">                                                        pMD,</td>
      </tr>
      <tr>
        <td id="L5424" data-line-number="5424"></td>
        <td id="LC5424">                                                        &amp;pResult-&gt;<span>stubLookup</span>);</td>
      </tr>
      <tr>
        <td id="L5425" data-line-number="5425"></td>
        <td id="LC5425">        }</td>
      </tr>
      <tr>
        <td id="L5426" data-line-number="5426"></td>
        <td id="LC5426">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5427" data-line-number="5427"></td>
        <td id="LC5427">        {</td>
      </tr>
      <tr>
        <td id="L5428" data-line-number="5428"></td>
        <td id="LC5428">            BYTE * indcell = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L5429" data-line-number="5429"></td>
        <td id="LC5429">
</td>
      </tr>
      <tr>
        <td id="L5430" data-line-number="5430"></td>
        <td id="LC5430">            <span>if</span> (!(flags &amp; CORINFO_CALLINFO_KINDONLY) &amp;&amp; !<span>isVerifyOnly</span>())</td>
      </tr>
      <tr>
        <td id="L5431" data-line-number="5431"></td>
        <td id="LC5431">            {</td>
      </tr>
      <tr>
        <td id="L5432" data-line-number="5432"></td>
        <td id="LC5432">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L5433" data-line-number="5433"></td>
        <td id="LC5433">                <span><span>//</span> We shouldn't be using GetLoaderAllocator here because for LCG, we need to get the</span></td>
      </tr>
      <tr>
        <td id="L5434" data-line-number="5434"></td>
        <td id="LC5434">                <span><span>//</span> VirtualCallStubManager from where the stub will be used.</span></td>
      </tr>
      <tr>
        <td id="L5435" data-line-number="5435"></td>
        <td id="LC5435">                <span><span>//</span> For normal methods there is no difference.</span></td>
      </tr>
      <tr>
        <td id="L5436" data-line-number="5436"></td>
        <td id="LC5436">                LoaderAllocator *pLoaderAllocator = m_pMethodBeingCompiled-&gt;<span>GetLoaderAllocator</span>();</td>
      </tr>
      <tr>
        <td id="L5437" data-line-number="5437"></td>
        <td id="LC5437">                VirtualCallStubManager *pMgr = pLoaderAllocator-&gt;<span>GetVirtualCallStubManager</span>();</td>
      </tr>
      <tr>
        <td id="L5438" data-line-number="5438"></td>
        <td id="LC5438">
</td>
      </tr>
      <tr>
        <td id="L5439" data-line-number="5439"></td>
        <td id="LC5439">                PCODE addr = pMgr-&gt;<span>GetCallStub</span>(exactType, pTargetMD);</td>
      </tr>
      <tr>
        <td id="L5440" data-line-number="5440"></td>
        <td id="LC5440">                <span>_ASSERTE</span>(pMgr-&gt;<span>isStub</span>(addr));</td>
      </tr>
      <tr>
        <td id="L5441" data-line-number="5441"></td>
        <td id="LC5441">
</td>
      </tr>
      <tr>
        <td id="L5442" data-line-number="5442"></td>
        <td id="LC5442">                <span><span>//</span> Now we want to indirect through a cell so that updates can take place atomically.</span></td>
      </tr>
      <tr>
        <td id="L5443" data-line-number="5443"></td>
        <td id="LC5443">                <span>if</span> (m_pMethodBeingCompiled-&gt;<span>IsLCGMethod</span>())</td>
      </tr>
      <tr>
        <td id="L5444" data-line-number="5444"></td>
        <td id="LC5444">                {</td>
      </tr>
      <tr>
        <td id="L5445" data-line-number="5445"></td>
        <td id="LC5445">                    <span><span>//</span> LCG methods should use recycled indcells to prevent leaks.</span></td>
      </tr>
      <tr>
        <td id="L5446" data-line-number="5446"></td>
        <td id="LC5446">                    indcell = pMgr-&gt;<span>GenerateStubIndirection</span>(addr, <span>TRUE</span>);</td>
      </tr>
      <tr>
        <td id="L5447" data-line-number="5447"></td>
        <td id="LC5447">
</td>
      </tr>
      <tr>
        <td id="L5448" data-line-number="5448"></td>
        <td id="LC5448">                    <span><span>//</span> Add it to the per DM list so that we can recycle them when the resolver is finalized</span></td>
      </tr>
      <tr>
        <td id="L5449" data-line-number="5449"></td>
        <td id="LC5449">                    LCGMethodResolver *pResolver = m_pMethodBeingCompiled-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetLCGMethodResolver</span>();</td>
      </tr>
      <tr>
        <td id="L5450" data-line-number="5450"></td>
        <td id="LC5450">                    pResolver-&gt;<span>AddToUsedIndCellList</span>(indcell);</td>
      </tr>
      <tr>
        <td id="L5451" data-line-number="5451"></td>
        <td id="LC5451">                }</td>
      </tr>
      <tr>
        <td id="L5452" data-line-number="5452"></td>
        <td id="LC5452">                <span>else</span></td>
      </tr>
      <tr>
        <td id="L5453" data-line-number="5453"></td>
        <td id="LC5453">                {</td>
      </tr>
      <tr>
        <td id="L5454" data-line-number="5454"></td>
        <td id="LC5454">                    <span><span>//</span> Normal methods should avoid recycled cells to preserve the locality of all indcells</span></td>
      </tr>
      <tr>
        <td id="L5455" data-line-number="5455"></td>
        <td id="LC5455">                    <span><span>//</span> used by one method.</span></td>
      </tr>
      <tr>
        <td id="L5456" data-line-number="5456"></td>
        <td id="LC5456">                    indcell = pMgr-&gt;<span>GenerateStubIndirection</span>(addr, <span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L5457" data-line-number="5457"></td>
        <td id="LC5457">                }</td>
      </tr>
      <tr>
        <td id="L5458" data-line-number="5458"></td>
        <td id="LC5458">#<span>else</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L5459" data-line-number="5459"></td>
        <td id="LC5459">                <span><span>//</span> This path should be unreachable during crossgen</span></td>
      </tr>
      <tr>
        <td id="L5460" data-line-number="5460"></td>
        <td id="LC5460">                <span>_ASSERTE</span>(<span>false</span>);</td>
      </tr>
      <tr>
        <td id="L5461" data-line-number="5461"></td>
        <td id="LC5461">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L5462" data-line-number="5462"></td>
        <td id="LC5462">            }</td>
      </tr>
      <tr>
        <td id="L5463" data-line-number="5463"></td>
        <td id="LC5463">
</td>
      </tr>
      <tr>
        <td id="L5464" data-line-number="5464"></td>
        <td id="LC5464">            <span><span>//</span> We use an indirect call</span></td>
      </tr>
      <tr>
        <td id="L5465" data-line-number="5465"></td>
        <td id="LC5465">            pResult-&gt;<span>stubLookup</span>.<span>constLookup</span>.<span>accessType</span> = IAT_PVALUE;</td>
      </tr>
      <tr>
        <td id="L5466" data-line-number="5466"></td>
        <td id="LC5466">            pResult-&gt;<span>stubLookup</span>.<span>constLookup</span>.<span>addr</span> = indcell;</td>
      </tr>
      <tr>
        <td id="L5467" data-line-number="5467"></td>
        <td id="LC5467">        }</td>
      </tr>
      <tr>
        <td id="L5468" data-line-number="5468"></td>
        <td id="LC5468">#<span>endif</span> <span><span>//</span> STUB_DISPATCH_PORTABLE</span></td>
      </tr>
      <tr>
        <td id="L5469" data-line-number="5469"></td>
        <td id="LC5469">    }</td>
      </tr>
      <tr>
        <td id="L5470" data-line-number="5470"></td>
        <td id="LC5470">
</td>
      </tr>
      <tr>
        <td id="L5471" data-line-number="5471"></td>
        <td id="LC5471">    pResult-&gt;<span>hMethod</span> = <span>CORINFO_METHOD_HANDLE</span>(pTargetMD);</td>
      </tr>
      <tr>
        <td id="L5472" data-line-number="5472"></td>
        <td id="LC5472">
</td>
      </tr>
      <tr>
        <td id="L5473" data-line-number="5473"></td>
        <td id="LC5473">    pResult-&gt;<span>accessAllowed</span> = CORINFO_ACCESS_ALLOWED;</td>
      </tr>
      <tr>
        <td id="L5474" data-line-number="5474"></td>
        <td id="LC5474">    <span>if</span> ((flags &amp; CORINFO_CALLINFO_SECURITYCHECKS) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L5475" data-line-number="5475"></td>
        <td id="LC5475">        !((MethodDesc *)callerHandle)-&gt;<span>IsILStub</span>()) <span><span>//</span> IL stubs can access everything, don't bother doing access checks</span></td>
      </tr>
      <tr>
        <td id="L5476" data-line-number="5476"></td>
        <td id="LC5476">    {</td>
      </tr>
      <tr>
        <td id="L5477" data-line-number="5477"></td>
        <td id="LC5477">        <span><span>//</span>Our type system doesn't always represent the target exactly with the MethodDesc.  In all cases,</span></td>
      </tr>
      <tr>
        <td id="L5478" data-line-number="5478"></td>
        <td id="LC5478">        <span><span>//</span>carry around the parent MethodTable for both Caller and Callee.</span></td>
      </tr>
      <tr>
        <td id="L5479" data-line-number="5479"></td>
        <td id="LC5479">        TypeHandle calleeTypeForSecurity = <span>TypeHandle</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L5480" data-line-number="5480"></td>
        <td id="LC5480">        MethodDesc * pCalleeForSecurity = pMD;</td>
      </tr>
      <tr>
        <td id="L5481" data-line-number="5481"></td>
        <td id="LC5481">
</td>
      </tr>
      <tr>
        <td id="L5482" data-line-number="5482"></td>
        <td id="LC5482">        MethodDesc * pCallerForSecurity = <span>GetMethodForSecurity</span>(callerHandle); <span><span>//</span>Should this be the open MD?</span></td>
      </tr>
      <tr>
        <td id="L5483" data-line-number="5483"></td>
        <td id="LC5483">
</td>
      </tr>
      <tr>
        <td id="L5484" data-line-number="5484"></td>
        <td id="LC5484">        <span>if</span> (pCallerForSecurity-&gt;<span>HasClassOrMethodInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L5485" data-line-number="5485"></td>
        <td id="LC5485">        {</td>
      </tr>
      <tr>
        <td id="L5486" data-line-number="5486"></td>
        <td id="LC5486">            <span>_ASSERTE</span>(!<span>IsDynamicScope</span>(pResolvedToken-&gt;<span>tokenScope</span>));</td>
      </tr>
      <tr>
        <td id="L5487" data-line-number="5487"></td>
        <td id="LC5487">
</td>
      </tr>
      <tr>
        <td id="L5488" data-line-number="5488"></td>
        <td id="LC5488">            SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L5489" data-line-number="5489"></td>
        <td id="LC5489">            <span>SigTypeContext::InitTypeContext</span>(pCallerForSecurity, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L5490" data-line-number="5490"></td>
        <td id="LC5490">            <span>_ASSERTE</span>(!typeContext.<span>IsEmpty</span>());</td>
      </tr>
      <tr>
        <td id="L5491" data-line-number="5491"></td>
        <td id="LC5491">
</td>
      </tr>
      <tr>
        <td id="L5492" data-line-number="5492"></td>
        <td id="LC5492">            <span><span>//</span>If the caller is generic, load the open type and resolve the token again.  Use that for the access</span></td>
      </tr>
      <tr>
        <td id="L5493" data-line-number="5493"></td>
        <td id="LC5493">            <span><span>//</span>checks.  If we don't do this then we can't tell the difference between:</span></td>
      </tr>
      <tr>
        <td id="L5494" data-line-number="5494"></td>
        <td id="LC5494">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5495" data-line-number="5495"></td>
        <td id="LC5495">            <span><span>//</span>BadGeneric&lt;T&gt; containing a methodspec for InaccessibleType::member (illegal)</span></td>
      </tr>
      <tr>
        <td id="L5496" data-line-number="5496"></td>
        <td id="LC5496">            <span><span>//</span>and</span></td>
      </tr>
      <tr>
        <td id="L5497" data-line-number="5497"></td>
        <td id="LC5497">            <span><span>//</span>BadGeneric&lt;T&gt; containing a methodspec for !!0::member instantiated over InaccessibleType (legal)</span></td>
      </tr>
      <tr>
        <td id="L5498" data-line-number="5498"></td>
        <td id="LC5498">
</td>
      </tr>
      <tr>
        <td id="L5499" data-line-number="5499"></td>
        <td id="LC5499">            <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L5500" data-line-number="5500"></td>
        <td id="LC5500">            {</td>
      </tr>
      <tr>
        <td id="L5501" data-line-number="5501"></td>
        <td id="LC5501">                SigPointer <span>sigptr</span>(pResolvedToken-&gt;<span>pTypeSpec</span>, pResolvedToken-&gt;<span>cbTypeSpec</span>);</td>
      </tr>
      <tr>
        <td id="L5502" data-line-number="5502"></td>
        <td id="LC5502">                calleeTypeForSecurity = sigptr.<span>GetTypeHandleThrowing</span>((Module *)pResolvedToken-&gt;<span>tokenScope</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L5503" data-line-number="5503"></td>
        <td id="LC5503">
</td>
      </tr>
      <tr>
        <td id="L5504" data-line-number="5504"></td>
        <td id="LC5504">                <span><span>//</span> typeHnd can be a variable type</span></td>
      </tr>
      <tr>
        <td id="L5505" data-line-number="5505"></td>
        <td id="LC5505">                <span>if</span> (calleeTypeForSecurity.<span>GetMethodTable</span>() == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L5506" data-line-number="5506"></td>
        <td id="LC5506">                {</td>
      </tr>
      <tr>
        <td id="L5507" data-line-number="5507"></td>
        <td id="LC5507">                    <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT, BFA_METHODDEF_PARENT_NO_MEMBERS);</td>
      </tr>
      <tr>
        <td id="L5508" data-line-number="5508"></td>
        <td id="LC5508">                }</td>
      </tr>
      <tr>
        <td id="L5509" data-line-number="5509"></td>
        <td id="LC5509">            }</td>
      </tr>
      <tr>
        <td id="L5510" data-line-number="5510"></td>
        <td id="LC5510">
</td>
      </tr>
      <tr>
        <td id="L5511" data-line-number="5511"></td>
        <td id="LC5511">            <span>if</span> (pCalleeForSecurity-&gt;<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L5512" data-line-number="5512"></td>
        <td id="LC5512">            {</td>
      </tr>
      <tr>
        <td id="L5513" data-line-number="5513"></td>
        <td id="LC5513">                <span><span>//</span> FindOrCreateAssociatedMethodDesc won't remap array method desc because of array base type</span></td>
      </tr>
      <tr>
        <td id="L5514" data-line-number="5514"></td>
        <td id="LC5514">                <span><span>//</span> is not part of instantiation. We have to special case it.</span></td>
      </tr>
      <tr>
        <td id="L5515" data-line-number="5515"></td>
        <td id="LC5515">                pCalleeForSecurity = calleeTypeForSecurity.<span>GetMethodTable</span>()-&gt;<span>GetParallelMethodDesc</span>(pCalleeForSecurity);</td>
      </tr>
      <tr>
        <td id="L5516" data-line-number="5516"></td>
        <td id="LC5516">            }</td>
      </tr>
      <tr>
        <td id="L5517" data-line-number="5517"></td>
        <td id="LC5517">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L5518" data-line-number="5518"></td>
        <td id="LC5518">            <span>if</span> (pResolvedToken-&gt;<span>pMethodSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L5519" data-line-number="5519"></td>
        <td id="LC5519">            {</td>
      </tr>
      <tr>
        <td id="L5520" data-line-number="5520"></td>
        <td id="LC5520">                DWORD nGenericMethodArgs = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L5521" data-line-number="5521"></td>
        <td id="LC5521">                CQuickBytes qbGenericMethodArgs;</td>
      </tr>
      <tr>
        <td id="L5522" data-line-number="5522"></td>
        <td id="LC5522">                TypeHandle *genericMethodArgs = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L5523" data-line-number="5523"></td>
        <td id="LC5523">
</td>
      </tr>
      <tr>
        <td id="L5524" data-line-number="5524"></td>
        <td id="LC5524">                SigPointer <span>sp</span>(pResolvedToken-&gt;<span>pMethodSpec</span>, pResolvedToken-&gt;<span>cbMethodSpec</span>);</td>
      </tr>
      <tr>
        <td id="L5525" data-line-number="5525"></td>
        <td id="LC5525">
</td>
      </tr>
      <tr>
        <td id="L5526" data-line-number="5526"></td>
        <td id="LC5526">                BYTE etype;</td>
      </tr>
      <tr>
        <td id="L5527" data-line-number="5527"></td>
        <td id="LC5527">                <span>IfFailThrow</span>(sp.<span>GetByte</span>(&amp;etype));</td>
      </tr>
      <tr>
        <td id="L5528" data-line-number="5528"></td>
        <td id="LC5528">
</td>
      </tr>
      <tr>
        <td id="L5529" data-line-number="5529"></td>
        <td id="LC5529">                <span><span>//</span> Load the generic method instantiation</span></td>
      </tr>
      <tr>
        <td id="L5530" data-line-number="5530"></td>
        <td id="LC5530">                <span>THROW_BAD_FORMAT_MAYBE</span>(etype == (BYTE)IMAGE_CEE_CS_CALLCONV_GENERICINST, <span>0</span>, (Module *)pResolvedToken-&gt;<span>tokenScope</span>);</td>
      </tr>
      <tr>
        <td id="L5531" data-line-number="5531"></td>
        <td id="LC5531">
</td>
      </tr>
      <tr>
        <td id="L5532" data-line-number="5532"></td>
        <td id="LC5532">                <span>IfFailThrow</span>(sp.<span>GetData</span>(&amp;nGenericMethodArgs));</td>
      </tr>
      <tr>
        <td id="L5533" data-line-number="5533"></td>
        <td id="LC5533">
</td>
      </tr>
      <tr>
        <td id="L5534" data-line-number="5534"></td>
        <td id="LC5534">                DWORD cbAllocSize = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L5535" data-line-number="5535"></td>
        <td id="LC5535">                <span>if</span> (!ClrSafeInt&lt;DWORD&gt;::<span>multiply</span>(nGenericMethodArgs, <span>sizeof</span>(TypeHandle), cbAllocSize))</td>
      </tr>
      <tr>
        <td id="L5536" data-line-number="5536"></td>
        <td id="LC5536">                {</td>
      </tr>
      <tr>
        <td id="L5537" data-line-number="5537"></td>
        <td id="LC5537">                    <span>COMPlusThrowHR</span>(COR_E_OVERFLOW);</td>
      </tr>
      <tr>
        <td id="L5538" data-line-number="5538"></td>
        <td id="LC5538">                }</td>
      </tr>
      <tr>
        <td id="L5539" data-line-number="5539"></td>
        <td id="LC5539">
</td>
      </tr>
      <tr>
        <td id="L5540" data-line-number="5540"></td>
        <td id="LC5540">                genericMethodArgs = <span>reinterpret_cast</span>&lt;TypeHandle *&gt;(qbGenericMethodArgs.<span>AllocThrows</span>(cbAllocSize));</td>
      </tr>
      <tr>
        <td id="L5541" data-line-number="5541"></td>
        <td id="LC5541">
</td>
      </tr>
      <tr>
        <td id="L5542" data-line-number="5542"></td>
        <td id="LC5542">                <span>for</span> (DWORD i = <span>0</span>; i &lt; nGenericMethodArgs; i++)</td>
      </tr>
      <tr>
        <td id="L5543" data-line-number="5543"></td>
        <td id="LC5543">                {</td>
      </tr>
      <tr>
        <td id="L5544" data-line-number="5544"></td>
        <td id="LC5544">                    genericMethodArgs[i] = sp.<span>GetTypeHandleThrowing</span>((Module *)pResolvedToken-&gt;<span>tokenScope</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L5545" data-line-number="5545"></td>
        <td id="LC5545">                    <span>_ASSERTE</span> (!genericMethodArgs[i].<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L5546" data-line-number="5546"></td>
        <td id="LC5546">                    <span>IfFailThrow</span>(sp.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L5547" data-line-number="5547"></td>
        <td id="LC5547">                }</td>
      </tr>
      <tr>
        <td id="L5548" data-line-number="5548"></td>
        <td id="LC5548">
</td>
      </tr>
      <tr>
        <td id="L5549" data-line-number="5549"></td>
        <td id="LC5549">                pCalleeForSecurity = <span>MethodDesc::FindOrCreateAssociatedMethodDesc</span>(pMD, calleeTypeForSecurity.<span>GetMethodTable</span>(), <span>FALSE</span>, <span>Instantiation</span>(genericMethodArgs, nGenericMethodArgs), <span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L5550" data-line-number="5550"></td>
        <td id="LC5550">            }</td>
      </tr>
      <tr>
        <td id="L5551" data-line-number="5551"></td>
        <td id="LC5551">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L5552" data-line-number="5552"></td>
        <td id="LC5552">            <span>if</span> (pResolvedToken-&gt;<span>pTypeSpec</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L5553" data-line-number="5553"></td>
        <td id="LC5553">            {</td>
      </tr>
      <tr>
        <td id="L5554" data-line-number="5554"></td>
        <td id="LC5554">                pCalleeForSecurity = <span>MethodDesc::FindOrCreateAssociatedMethodDesc</span>(pMD, calleeTypeForSecurity.<span>GetMethodTable</span>(), <span>FALSE</span>, <span>Instantiation</span>(), <span>TRUE</span>);</td>
      </tr>
      <tr>
        <td id="L5555" data-line-number="5555"></td>
        <td id="LC5555">            }</td>
      </tr>
      <tr>
        <td id="L5556" data-line-number="5556"></td>
        <td id="LC5556">        }</td>
      </tr>
      <tr>
        <td id="L5557" data-line-number="5557"></td>
        <td id="LC5557">
</td>
      </tr>
      <tr>
        <td id="L5558" data-line-number="5558"></td>
        <td id="LC5558">        TypeHandle callerTypeForSecurity = <span>TypeHandle</span>(pCallerForSecurity-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5559" data-line-number="5559"></td>
        <td id="LC5559">
</td>
      </tr>
      <tr>
        <td id="L5560" data-line-number="5560"></td>
        <td id="LC5560">        <span><span>//</span>Passed various link-time checks.  Now do access checks.</span></td>
      </tr>
      <tr>
        <td id="L5561" data-line-number="5561"></td>
        <td id="LC5561">
</td>
      </tr>
      <tr>
        <td id="L5562" data-line-number="5562"></td>
        <td id="LC5562">        BOOL doAccessCheck = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5563" data-line-number="5563"></td>
        <td id="LC5563">        BOOL canAccessMethod = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5564" data-line-number="5564"></td>
        <td id="LC5564">        AccessCheckOptions::AccessCheckType accessCheckType = AccessCheckOptions::<span>kNormalAccessibilityChecks</span>;</td>
      </tr>
      <tr>
        <td id="L5565" data-line-number="5565"></td>
        <td id="LC5565">        DynamicResolver * pAccessContext = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L5566" data-line-number="5566"></td>
        <td id="LC5566">
</td>
      </tr>
      <tr>
        <td id="L5567" data-line-number="5567"></td>
        <td id="LC5567">        callerTypeForSecurity = <span>TypeHandle</span>(pCallerForSecurity-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5568" data-line-number="5568"></td>
        <td id="LC5568">        <span>if</span> (pCallerForSecurity-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L5569" data-line-number="5569"></td>
        <td id="LC5569">        {</td>
      </tr>
      <tr>
        <td id="L5570" data-line-number="5570"></td>
        <td id="LC5570">            doAccessCheck = <span>ModifyCheckForDynamicMethod</span>(pCallerForSecurity-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>(),</td>
      </tr>
      <tr>
        <td id="L5571" data-line-number="5571"></td>
        <td id="LC5571">                                                        &amp;callerTypeForSecurity,</td>
      </tr>
      <tr>
        <td id="L5572" data-line-number="5572"></td>
        <td id="LC5572">                                                        &amp;accessCheckType, &amp;pAccessContext);</td>
      </tr>
      <tr>
        <td id="L5573" data-line-number="5573"></td>
        <td id="LC5573">        }</td>
      </tr>
      <tr>
        <td id="L5574" data-line-number="5574"></td>
        <td id="LC5574">
</td>
      </tr>
      <tr>
        <td id="L5575" data-line-number="5575"></td>
        <td id="LC5575">        pResult-&gt;<span>accessAllowed</span> = CORINFO_ACCESS_ALLOWED;</td>
      </tr>
      <tr>
        <td id="L5576" data-line-number="5576"></td>
        <td id="LC5576">
</td>
      </tr>
      <tr>
        <td id="L5577" data-line-number="5577"></td>
        <td id="LC5577">        <span>if</span> (doAccessCheck)</td>
      </tr>
      <tr>
        <td id="L5578" data-line-number="5578"></td>
        <td id="LC5578">        {</td>
      </tr>
      <tr>
        <td id="L5579" data-line-number="5579"></td>
        <td id="LC5579">            AccessCheckOptions <span>accessCheckOptions</span>(accessCheckType,</td>
      </tr>
      <tr>
        <td id="L5580" data-line-number="5580"></td>
        <td id="LC5580">                                                  pAccessContext,</td>
      </tr>
      <tr>
        <td id="L5581" data-line-number="5581"></td>
        <td id="LC5581">                                                  <span>FALSE</span>,</td>
      </tr>
      <tr>
        <td id="L5582" data-line-number="5582"></td>
        <td id="LC5582">                                                  pCalleeForSecurity);</td>
      </tr>
      <tr>
        <td id="L5583" data-line-number="5583"></td>
        <td id="LC5583">
</td>
      </tr>
      <tr>
        <td id="L5584" data-line-number="5584"></td>
        <td id="LC5584">            <span>_ASSERTE</span>(pCallerForSecurity != <span>NULL</span> &amp;&amp; callerTypeForSecurity != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L5585" data-line-number="5585"></td>
        <td id="LC5585">            AccessCheckContext <span>accessContext</span>(pCallerForSecurity, callerTypeForSecurity.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5586" data-line-number="5586"></td>
        <td id="LC5586">
</td>
      </tr>
      <tr>
        <td id="L5587" data-line-number="5587"></td>
        <td id="LC5587">            canAccessMethod = <span>ClassLoader::CanAccess</span>(&amp;accessContext,</td>
      </tr>
      <tr>
        <td id="L5588" data-line-number="5588"></td>
        <td id="LC5588">                                                     calleeTypeForSecurity.<span>GetMethodTable</span>(),</td>
      </tr>
      <tr>
        <td id="L5589" data-line-number="5589"></td>
        <td id="LC5589">                                                     calleeTypeForSecurity.<span>GetAssembly</span>(),</td>
      </tr>
      <tr>
        <td id="L5590" data-line-number="5590"></td>
        <td id="LC5590">                                                     pCalleeForSecurity-&gt;<span>GetAttrs</span>(),</td>
      </tr>
      <tr>
        <td id="L5591" data-line-number="5591"></td>
        <td id="LC5591">                                                     pCalleeForSecurity,</td>
      </tr>
      <tr>
        <td id="L5592" data-line-number="5592"></td>
        <td id="LC5592">                                                     <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L5593" data-line-number="5593"></td>
        <td id="LC5593">                                                     accessCheckOptions</td>
      </tr>
      <tr>
        <td id="L5594" data-line-number="5594"></td>
        <td id="LC5594">                                                    );</td>
      </tr>
      <tr>
        <td id="L5595" data-line-number="5595"></td>
        <td id="LC5595">
</td>
      </tr>
      <tr>
        <td id="L5596" data-line-number="5596"></td>
        <td id="LC5596">            <span><span>//</span> If we were allowed access to the exact method, but it is on a type that has a type parameter</span></td>
      </tr>
      <tr>
        <td id="L5597" data-line-number="5597"></td>
        <td id="LC5597">            <span><span>//</span> (for instance an array), we need to ensure that we also have access to the type parameter.</span></td>
      </tr>
      <tr>
        <td id="L5598" data-line-number="5598"></td>
        <td id="LC5598">            <span>if</span> (canAccessMethod &amp;&amp; calleeTypeForSecurity.<span>HasTypeParam</span>())</td>
      </tr>
      <tr>
        <td id="L5599" data-line-number="5599"></td>
        <td id="LC5599">            {</td>
      </tr>
      <tr>
        <td id="L5600" data-line-number="5600"></td>
        <td id="LC5600">                TypeHandle typeParam = calleeTypeForSecurity.<span>GetTypeParam</span>();</td>
      </tr>
      <tr>
        <td id="L5601" data-line-number="5601"></td>
        <td id="LC5601">                <span>while</span> (typeParam.<span>HasTypeParam</span>())</td>
      </tr>
      <tr>
        <td id="L5602" data-line-number="5602"></td>
        <td id="LC5602">                {</td>
      </tr>
      <tr>
        <td id="L5603" data-line-number="5603"></td>
        <td id="LC5603">                    typeParam = typeParam.<span>GetTypeParam</span>();</td>
      </tr>
      <tr>
        <td id="L5604" data-line-number="5604"></td>
        <td id="LC5604">                }</td>
      </tr>
      <tr>
        <td id="L5605" data-line-number="5605"></td>
        <td id="LC5605">
</td>
      </tr>
      <tr>
        <td id="L5606" data-line-number="5606"></td>
        <td id="LC5606">                <span>_ASSERTE</span>(pCallerForSecurity != <span>NULL</span> &amp;&amp; callerTypeForSecurity != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L5607" data-line-number="5607"></td>
        <td id="LC5607">                AccessCheckContext <span>accessContext</span>(pCallerForSecurity, callerTypeForSecurity.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5608" data-line-number="5608"></td>
        <td id="LC5608">
</td>
      </tr>
      <tr>
        <td id="L5609" data-line-number="5609"></td>
        <td id="LC5609">                MethodTable* pTypeParamMT = typeParam.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L5610" data-line-number="5610"></td>
        <td id="LC5610">
</td>
      </tr>
      <tr>
        <td id="L5611" data-line-number="5611"></td>
        <td id="LC5611">                <span><span>//</span> No access check is need for Var, MVar, or FnPtr.</span></td>
      </tr>
      <tr>
        <td id="L5612" data-line-number="5612"></td>
        <td id="LC5612">                <span>if</span> (pTypeParamMT != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L5613" data-line-number="5613"></td>
        <td id="LC5613">                    canAccessMethod = <span>ClassLoader::CanAccessClass</span>(&amp;accessContext,</td>
      </tr>
      <tr>
        <td id="L5614" data-line-number="5614"></td>
        <td id="LC5614">                                                                  pTypeParamMT,</td>
      </tr>
      <tr>
        <td id="L5615" data-line-number="5615"></td>
        <td id="LC5615">                                                                  typeParam.<span>GetAssembly</span>(),</td>
      </tr>
      <tr>
        <td id="L5616" data-line-number="5616"></td>
        <td id="LC5616">                                                                  accessCheckOptions);</td>
      </tr>
      <tr>
        <td id="L5617" data-line-number="5617"></td>
        <td id="LC5617">            }</td>
      </tr>
      <tr>
        <td id="L5618" data-line-number="5618"></td>
        <td id="LC5618">
</td>
      </tr>
      <tr>
        <td id="L5619" data-line-number="5619"></td>
        <td id="LC5619">            pResult-&gt;<span>accessAllowed</span> = canAccessMethod ? CORINFO_ACCESS_ALLOWED : CORINFO_ACCESS_ILLEGAL;</td>
      </tr>
      <tr>
        <td id="L5620" data-line-number="5620"></td>
        <td id="LC5620">            <span>if</span> (!canAccessMethod)</td>
      </tr>
      <tr>
        <td id="L5621" data-line-number="5621"></td>
        <td id="LC5621">            {</td>
      </tr>
      <tr>
        <td id="L5622" data-line-number="5622"></td>
        <td id="LC5622">                <span><span>//</span>Check failed, fill in the throw exception helper.</span></td>
      </tr>
      <tr>
        <td id="L5623" data-line-number="5623"></td>
        <td id="LC5623">                pResult-&gt;<span>callsiteCalloutHelper</span>.<span>helperNum</span> = CORINFO_HELP_METHOD_ACCESS_EXCEPTION;</td>
      </tr>
      <tr>
        <td id="L5624" data-line-number="5624"></td>
        <td id="LC5624">                pResult-&gt;<span>callsiteCalloutHelper</span>.<span>numArgs</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L5625" data-line-number="5625"></td>
        <td id="LC5625">
</td>
      </tr>
      <tr>
        <td id="L5626" data-line-number="5626"></td>
        <td id="LC5626">                pResult-&gt;<span>callsiteCalloutHelper</span>.<span>args</span>[<span>0</span>].<span>Set</span>(<span>CORINFO_METHOD_HANDLE</span>(pCallerForSecurity));</td>
      </tr>
      <tr>
        <td id="L5627" data-line-number="5627"></td>
        <td id="LC5627">                pResult-&gt;<span>callsiteCalloutHelper</span>.<span>args</span>[<span>1</span>].<span>Set</span>(<span>CORINFO_METHOD_HANDLE</span>(pCalleeForSecurity));</td>
      </tr>
      <tr>
        <td id="L5628" data-line-number="5628"></td>
        <td id="LC5628">
</td>
      </tr>
      <tr>
        <td id="L5629" data-line-number="5629"></td>
        <td id="LC5629">                <span><span>//</span>We now embed open instantiations in a few places for security callouts (since you can only</span></td>
      </tr>
      <tr>
        <td id="L5630" data-line-number="5630"></td>
        <td id="LC5630">                <span><span>//</span>do the security check on the open instantiation).  We throw these methods out in</span></td>
      </tr>
      <tr>
        <td id="L5631" data-line-number="5631"></td>
        <td id="LC5631">                <span><span>//</span>TriageMethodForZap.  In addition, NGen has problems referencing them properly.  Just throw out the whole</span></td>
      </tr>
      <tr>
        <td id="L5632" data-line-number="5632"></td>
        <td id="LC5632">                <span><span>//</span>method and rejit at runtime.</span></td>
      </tr>
      <tr>
        <td id="L5633" data-line-number="5633"></td>
        <td id="LC5633">                <span>if</span> (<span>IsCompilingForNGen</span>())</td>
      </tr>
      <tr>
        <td id="L5634" data-line-number="5634"></td>
        <td id="LC5634">                {</td>
      </tr>
      <tr>
        <td id="L5635" data-line-number="5635"></td>
        <td id="LC5635">                    <span>if</span> (pCallerForSecurity-&gt;<span>ContainsGenericVariables</span>()</td>
      </tr>
      <tr>
        <td id="L5636" data-line-number="5636"></td>
        <td id="LC5636">                        || pCalleeForSecurity-&gt;<span>ContainsGenericVariables</span>())</td>
      </tr>
      <tr>
        <td id="L5637" data-line-number="5637"></td>
        <td id="LC5637">                    {</td>
      </tr>
      <tr>
        <td id="L5638" data-line-number="5638"></td>
        <td id="LC5638">                        <span>COMPlusThrowNonLocalized</span>(<span>kNotSupportedException</span>, <span>W</span>(<span><span>"</span>Cannot embed generic MethodDesc<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L5639" data-line-number="5639"></td>
        <td id="LC5639">                    }</td>
      </tr>
      <tr>
        <td id="L5640" data-line-number="5640"></td>
        <td id="LC5640">                }</td>
      </tr>
      <tr>
        <td id="L5641" data-line-number="5641"></td>
        <td id="LC5641">            }</td>
      </tr>
      <tr>
        <td id="L5642" data-line-number="5642"></td>
        <td id="LC5642">        }</td>
      </tr>
      <tr>
        <td id="L5643" data-line-number="5643"></td>
        <td id="LC5643">    }</td>
      </tr>
      <tr>
        <td id="L5644" data-line-number="5644"></td>
        <td id="LC5644">
</td>
      </tr>
      <tr>
        <td id="L5645" data-line-number="5645"></td>
        <td id="LC5645">    <span><span>//</span>We're pretty much done at this point.  Let's grab the rest of the information that the jit is going to</span></td>
      </tr>
      <tr>
        <td id="L5646" data-line-number="5646"></td>
        <td id="LC5646">    <span><span>//</span>need.</span></td>
      </tr>
      <tr>
        <td id="L5647" data-line-number="5647"></td>
        <td id="LC5647">    pResult-&gt;<span>classFlags</span> = <span>getClassAttribsInternal</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L5648" data-line-number="5648"></td>
        <td id="LC5648">
</td>
      </tr>
      <tr>
        <td id="L5649" data-line-number="5649"></td>
        <td id="LC5649">    pResult-&gt;<span>methodFlags</span> = <span>getMethodAttribsInternal</span>(pResult-&gt;<span>hMethod</span>);</td>
      </tr>
      <tr>
        <td id="L5650" data-line-number="5650"></td>
        <td id="LC5650">
</td>
      </tr>
      <tr>
        <td id="L5651" data-line-number="5651"></td>
        <td id="LC5651">    SignatureKind signatureKind = flags &amp; CORINFO_CALLINFO_CALLVIRT &amp;&amp; !(pResult-&gt;<span>kind</span> == CORINFO_CALL) ? SK_VIRTUAL_CALLSITE : SK_CALLSITE;</td>
      </tr>
      <tr>
        <td id="L5652" data-line-number="5652"></td>
        <td id="LC5652">    <span>getMethodSigInternal</span>(pResult-&gt;<span>hMethod</span>, &amp;pResult-&gt;<span>sig</span>, (pResult-&gt;<span>hMethod</span> == pResolvedToken-&gt;<span>hMethod</span>) ? pResolvedToken-&gt;<span>hClass</span> : <span>NULL</span>, signatureKind);</td>
      </tr>
      <tr>
        <td id="L5653" data-line-number="5653"></td>
        <td id="LC5653">
</td>
      </tr>
      <tr>
        <td id="L5654" data-line-number="5654"></td>
        <td id="LC5654">    <span>if</span> (flags &amp; CORINFO_CALLINFO_VERIFICATION)</td>
      </tr>
      <tr>
        <td id="L5655" data-line-number="5655"></td>
        <td id="LC5655">    {</td>
      </tr>
      <tr>
        <td id="L5656" data-line-number="5656"></td>
        <td id="LC5656">        <span>if</span> (pResult-&gt;<span>hMethod</span> != pResolvedToken-&gt;<span>hMethod</span>)</td>
      </tr>
      <tr>
        <td id="L5657" data-line-number="5657"></td>
        <td id="LC5657">        {</td>
      </tr>
      <tr>
        <td id="L5658" data-line-number="5658"></td>
        <td id="LC5658">            pResult-&gt;<span>verMethodFlags</span> = <span>getMethodAttribsInternal</span>(pResolvedToken-&gt;<span>hMethod</span>);</td>
      </tr>
      <tr>
        <td id="L5659" data-line-number="5659"></td>
        <td id="LC5659">            <span>getMethodSigInternal</span>(pResolvedToken-&gt;<span>hMethod</span>, &amp;pResult-&gt;<span>verSig</span>, pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L5660" data-line-number="5660"></td>
        <td id="LC5660">        }</td>
      </tr>
      <tr>
        <td id="L5661" data-line-number="5661"></td>
        <td id="LC5661">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5662" data-line-number="5662"></td>
        <td id="LC5662">        {</td>
      </tr>
      <tr>
        <td id="L5663" data-line-number="5663"></td>
        <td id="LC5663">            pResult-&gt;<span>verMethodFlags</span> = pResult-&gt;<span>methodFlags</span>;</td>
      </tr>
      <tr>
        <td id="L5664" data-line-number="5664"></td>
        <td id="LC5664">            pResult-&gt;<span>verSig</span> = pResult-&gt;<span>sig</span>;</td>
      </tr>
      <tr>
        <td id="L5665" data-line-number="5665"></td>
        <td id="LC5665">        }</td>
      </tr>
      <tr>
        <td id="L5666" data-line-number="5666"></td>
        <td id="LC5666">    }</td>
      </tr>
      <tr>
        <td id="L5667" data-line-number="5667"></td>
        <td id="LC5667">
</td>
      </tr>
      <tr>
        <td id="L5668" data-line-number="5668"></td>
        <td id="LC5668">    pResult-&gt;<span>wrapperDelegateInvoke</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L5669" data-line-number="5669"></td>
        <td id="LC5669">
</td>
      </tr>
      <tr>
        <td id="L5670" data-line-number="5670"></td>
        <td id="LC5670">    <span>if</span> (m_pMethodBeingCompiled-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L5671" data-line-number="5671"></td>
        <td id="LC5671">    {</td>
      </tr>
      <tr>
        <td id="L5672" data-line-number="5672"></td>
        <td id="LC5672">        <span>auto</span> pMD = m_pMethodBeingCompiled-&gt;<span>AsDynamicMethodDesc</span>();</td>
      </tr>
      <tr>
        <td id="L5673" data-line-number="5673"></td>
        <td id="LC5673">        <span>if</span> (pMD-&gt;<span>IsILStub</span>() &amp;&amp; pMD-&gt;<span>IsWrapperDelegateStub</span>())</td>
      </tr>
      <tr>
        <td id="L5674" data-line-number="5674"></td>
        <td id="LC5674">        {</td>
      </tr>
      <tr>
        <td id="L5675" data-line-number="5675"></td>
        <td id="LC5675">            pResult-&gt;<span>wrapperDelegateInvoke</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5676" data-line-number="5676"></td>
        <td id="LC5676">        }</td>
      </tr>
      <tr>
        <td id="L5677" data-line-number="5677"></td>
        <td id="LC5677">    }</td>
      </tr>
      <tr>
        <td id="L5678" data-line-number="5678"></td>
        <td id="LC5678">
</td>
      </tr>
      <tr>
        <td id="L5679" data-line-number="5679"></td>
        <td id="LC5679">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5680" data-line-number="5680"></td>
        <td id="LC5680">}</td>
      </tr>
      <tr>
        <td id="L5681" data-line-number="5681"></td>
        <td id="LC5681">
</td>
      </tr>
      <tr>
        <td id="L5682" data-line-number="5682"></td>
        <td id="LC5682">BOOL <span>CEEInfo::canAccessFamily</span>(CORINFO_METHOD_HANDLE hCaller,</td>
      </tr>
      <tr>
        <td id="L5683" data-line-number="5683"></td>
        <td id="LC5683">                              CORINFO_CLASS_HANDLE hInstanceType)</td>
      </tr>
      <tr>
        <td id="L5684" data-line-number="5684"></td>
        <td id="LC5684">{</td>
      </tr>
      <tr>
        <td id="L5685" data-line-number="5685"></td>
        <td id="LC5685">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L5686" data-line-number="5686"></td>
        <td id="LC5686">
</td>
      </tr>
      <tr>
        <td id="L5687" data-line-number="5687"></td>
        <td id="LC5687">    BOOL ret = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L5688" data-line-number="5688"></td>
        <td id="LC5688">
</td>
      </tr>
      <tr>
        <td id="L5689" data-line-number="5689"></td>
        <td id="LC5689">    <span><span>//</span>Since this is only for verification, I don't need to do the demand.</span></td>
      </tr>
      <tr>
        <td id="L5690" data-line-number="5690"></td>
        <td id="LC5690">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5691" data-line-number="5691"></td>
        <td id="LC5691">
</td>
      </tr>
      <tr>
        <td id="L5692" data-line-number="5692"></td>
        <td id="LC5692">    TypeHandle targetType = <span>TypeHandle</span>(hInstanceType);</td>
      </tr>
      <tr>
        <td id="L5693" data-line-number="5693"></td>
        <td id="LC5693">    TypeHandle accessingType = <span>TypeHandle</span>(<span>GetMethod</span>(hCaller)-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5694" data-line-number="5694"></td>
        <td id="LC5694">    AccessCheckOptions::AccessCheckType accessCheckOptions = AccessCheckOptions::<span>kNormalAccessibilityChecks</span>;</td>
      </tr>
      <tr>
        <td id="L5695" data-line-number="5695"></td>
        <td id="LC5695">    DynamicResolver* pIgnored;</td>
      </tr>
      <tr>
        <td id="L5696" data-line-number="5696"></td>
        <td id="LC5696">    BOOL doCheck = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5697" data-line-number="5697"></td>
        <td id="LC5697">    <span>if</span> (<span>GetMethod</span>(hCaller)-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L5698" data-line-number="5698"></td>
        <td id="LC5698">    {</td>
      </tr>
      <tr>
        <td id="L5699" data-line-number="5699"></td>
        <td id="LC5699">        <span><span>//</span>If this is a DynamicMethod, perform the check from the type to which the DynamicMethod was</span></td>
      </tr>
      <tr>
        <td id="L5700" data-line-number="5700"></td>
        <td id="LC5700">        <span><span>//</span>attached.</span></td>
      </tr>
      <tr>
        <td id="L5701" data-line-number="5701"></td>
        <td id="LC5701">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5702" data-line-number="5702"></td>
        <td id="LC5702">        <span><span>//</span>If this is a dynamic method, don't do this check.  If they specified SkipVisibilityChecks</span></td>
      </tr>
      <tr>
        <td id="L5703" data-line-number="5703"></td>
        <td id="LC5703">        <span><span>//</span>(ModifyCheckForDynamicMethod returned false), we should obviously skip the check for the C++</span></td>
      </tr>
      <tr>
        <td id="L5704" data-line-number="5704"></td>
        <td id="LC5704">        <span><span>//</span>protected rule (since we skipped all the other visibility checks).  If they specified</span></td>
      </tr>
      <tr>
        <td id="L5705" data-line-number="5705"></td>
        <td id="LC5705">        <span><span>//</span>RestrictedSkipVisibilityChecks, then they're a "free" DynamicMethod.  This check is meaningless</span></td>
      </tr>
      <tr>
        <td id="L5706" data-line-number="5706"></td>
        <td id="LC5706">        <span><span>//</span>(i.e.  it would always fail).  We've already done a demand for access to the member.  Let that be</span></td>
      </tr>
      <tr>
        <td id="L5707" data-line-number="5707"></td>
        <td id="LC5707">        <span><span>//</span>enough.</span></td>
      </tr>
      <tr>
        <td id="L5708" data-line-number="5708"></td>
        <td id="LC5708">        doCheck = <span>ModifyCheckForDynamicMethod</span>(<span>GetMethod</span>(hCaller)-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>(),</td>
      </tr>
      <tr>
        <td id="L5709" data-line-number="5709"></td>
        <td id="LC5709">                                              &amp;accessingType, &amp;accessCheckOptions, &amp;pIgnored);</td>
      </tr>
      <tr>
        <td id="L5710" data-line-number="5710"></td>
        <td id="LC5710">        <span>if</span> (accessCheckOptions == AccessCheckOptions::<span>kRestrictedMemberAccess</span></td>
      </tr>
      <tr>
        <td id="L5711" data-line-number="5711"></td>
        <td id="LC5711">            || accessCheckOptions == AccessCheckOptions::<span>kRestrictedMemberAccessNoTransparency</span></td>
      </tr>
      <tr>
        <td id="L5712" data-line-number="5712"></td>
        <td id="LC5712">            )</td>
      </tr>
      <tr>
        <td id="L5713" data-line-number="5713"></td>
        <td id="LC5713">            doCheck = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L5714" data-line-number="5714"></td>
        <td id="LC5714">    }</td>
      </tr>
      <tr>
        <td id="L5715" data-line-number="5715"></td>
        <td id="LC5715">
</td>
      </tr>
      <tr>
        <td id="L5716" data-line-number="5716"></td>
        <td id="LC5716">    <span>if</span> (doCheck)</td>
      </tr>
      <tr>
        <td id="L5717" data-line-number="5717"></td>
        <td id="LC5717">    {</td>
      </tr>
      <tr>
        <td id="L5718" data-line-number="5718"></td>
        <td id="LC5718">        ret = <span>ClassLoader::CanAccessFamilyVerification</span>(accessingType, targetType);</td>
      </tr>
      <tr>
        <td id="L5719" data-line-number="5719"></td>
        <td id="LC5719">    }</td>
      </tr>
      <tr>
        <td id="L5720" data-line-number="5720"></td>
        <td id="LC5720">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5721" data-line-number="5721"></td>
        <td id="LC5721">    {</td>
      </tr>
      <tr>
        <td id="L5722" data-line-number="5722"></td>
        <td id="LC5722">        ret = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L5723" data-line-number="5723"></td>
        <td id="LC5723">    }</td>
      </tr>
      <tr>
        <td id="L5724" data-line-number="5724"></td>
        <td id="LC5724">
</td>
      </tr>
      <tr>
        <td id="L5725" data-line-number="5725"></td>
        <td id="LC5725">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5726" data-line-number="5726"></td>
        <td id="LC5726">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L5727" data-line-number="5727"></td>
        <td id="LC5727">}</td>
      </tr>
      <tr>
        <td id="L5728" data-line-number="5728"></td>
        <td id="LC5728"><span>void</span> <span>CEEInfo::ThrowExceptionForHelper</span>(<span>const</span> CORINFO_HELPER_DESC * throwHelper)</td>
      </tr>
      <tr>
        <td id="L5729" data-line-number="5729"></td>
        <td id="LC5729">{</td>
      </tr>
      <tr>
        <td id="L5730" data-line-number="5730"></td>
        <td id="LC5730">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L5731" data-line-number="5731"></td>
        <td id="LC5731">        THROWS;</td>
      </tr>
      <tr>
        <td id="L5732" data-line-number="5732"></td>
        <td id="LC5732">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L5733" data-line-number="5733"></td>
        <td id="LC5733">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L5734" data-line-number="5734"></td>
        <td id="LC5734">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L5735" data-line-number="5735"></td>
        <td id="LC5735">
</td>
      </tr>
      <tr>
        <td id="L5736" data-line-number="5736"></td>
        <td id="LC5736">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5737" data-line-number="5737"></td>
        <td id="LC5737">
</td>
      </tr>
      <tr>
        <td id="L5738" data-line-number="5738"></td>
        <td id="LC5738">    <span>_ASSERTE</span>(throwHelper-&gt;<span>args</span>[<span>0</span>].<span>argType</span> == CORINFO_HELPER_ARG_TYPE_Method);</td>
      </tr>
      <tr>
        <td id="L5739" data-line-number="5739"></td>
        <td id="LC5739">    MethodDesc *pCallerMD = <span>GetMethod</span>(throwHelper-&gt;<span>args</span>[<span>0</span>].<span>methodHandle</span>);</td>
      </tr>
      <tr>
        <td id="L5740" data-line-number="5740"></td>
        <td id="LC5740">
</td>
      </tr>
      <tr>
        <td id="L5741" data-line-number="5741"></td>
        <td id="LC5741">    AccessCheckContext <span>accessContext</span>(pCallerMD);</td>
      </tr>
      <tr>
        <td id="L5742" data-line-number="5742"></td>
        <td id="LC5742">
</td>
      </tr>
      <tr>
        <td id="L5743" data-line-number="5743"></td>
        <td id="LC5743">    <span>switch</span> (throwHelper-&gt;<span>helperNum</span>)</td>
      </tr>
      <tr>
        <td id="L5744" data-line-number="5744"></td>
        <td id="LC5744">    {</td>
      </tr>
      <tr>
        <td id="L5745" data-line-number="5745"></td>
        <td id="LC5745">    <span>case</span> CORINFO_HELP_METHOD_ACCESS_EXCEPTION:</td>
      </tr>
      <tr>
        <td id="L5746" data-line-number="5746"></td>
        <td id="LC5746">        {</td>
      </tr>
      <tr>
        <td id="L5747" data-line-number="5747"></td>
        <td id="LC5747">            <span>_ASSERTE</span>(throwHelper-&gt;<span>args</span>[<span>1</span>].<span>argType</span> == CORINFO_HELPER_ARG_TYPE_Method);</td>
      </tr>
      <tr>
        <td id="L5748" data-line-number="5748"></td>
        <td id="LC5748">            <span>ThrowMethodAccessException</span>(&amp;accessContext, <span>GetMethod</span>(throwHelper-&gt;<span>args</span>[<span>1</span>].<span>methodHandle</span>));</td>
      </tr>
      <tr>
        <td id="L5749" data-line-number="5749"></td>
        <td id="LC5749">        }</td>
      </tr>
      <tr>
        <td id="L5750" data-line-number="5750"></td>
        <td id="LC5750">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L5751" data-line-number="5751"></td>
        <td id="LC5751">    <span>case</span> CORINFO_HELP_FIELD_ACCESS_EXCEPTION:</td>
      </tr>
      <tr>
        <td id="L5752" data-line-number="5752"></td>
        <td id="LC5752">        {</td>
      </tr>
      <tr>
        <td id="L5753" data-line-number="5753"></td>
        <td id="LC5753">            <span>_ASSERTE</span>(throwHelper-&gt;<span>args</span>[<span>1</span>].<span>argType</span> == CORINFO_HELPER_ARG_TYPE_Field);</td>
      </tr>
      <tr>
        <td id="L5754" data-line-number="5754"></td>
        <td id="LC5754">            <span>ThrowFieldAccessException</span>(&amp;accessContext, <span>reinterpret_cast</span>&lt;FieldDesc *&gt;(throwHelper-&gt;<span>args</span>[<span>1</span>].<span>fieldHandle</span>));</td>
      </tr>
      <tr>
        <td id="L5755" data-line-number="5755"></td>
        <td id="LC5755">        }</td>
      </tr>
      <tr>
        <td id="L5756" data-line-number="5756"></td>
        <td id="LC5756">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L5757" data-line-number="5757"></td>
        <td id="LC5757">    <span>case</span> CORINFO_HELP_CLASS_ACCESS_EXCEPTION:</td>
      </tr>
      <tr>
        <td id="L5758" data-line-number="5758"></td>
        <td id="LC5758">        {</td>
      </tr>
      <tr>
        <td id="L5759" data-line-number="5759"></td>
        <td id="LC5759">            <span>_ASSERTE</span>(throwHelper-&gt;<span>args</span>[<span>1</span>].<span>argType</span> == CORINFO_HELPER_ARG_TYPE_Class);</td>
      </tr>
      <tr>
        <td id="L5760" data-line-number="5760"></td>
        <td id="LC5760">            TypeHandle <span>typeHnd</span>(throwHelper-&gt;<span>args</span>[<span>1</span>].<span>classHandle</span>);</td>
      </tr>
      <tr>
        <td id="L5761" data-line-number="5761"></td>
        <td id="LC5761">            <span>ThrowTypeAccessException</span>(&amp;accessContext, typeHnd.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L5762" data-line-number="5762"></td>
        <td id="LC5762">        }</td>
      </tr>
      <tr>
        <td id="L5763" data-line-number="5763"></td>
        <td id="LC5763">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L5764" data-line-number="5764"></td>
        <td id="LC5764">
</td>
      </tr>
      <tr>
        <td id="L5765" data-line-number="5765"></td>
        <td id="LC5765">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L5766" data-line-number="5766"></td>
        <td id="LC5766">        <span>_ASSERTE</span>(!<span><span>"</span>Unknown access exception type<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L5767" data-line-number="5767"></td>
        <td id="LC5767">    }</td>
      </tr>
      <tr>
        <td id="L5768" data-line-number="5768"></td>
        <td id="LC5768">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5769" data-line-number="5769"></td>
        <td id="LC5769">}</td>
      </tr>
      <tr>
        <td id="L5770" data-line-number="5770"></td>
        <td id="LC5770">
</td>
      </tr>
      <tr>
        <td id="L5771" data-line-number="5771"></td>
        <td id="LC5771">
</td>
      </tr>
      <tr>
        <td id="L5772" data-line-number="5772"></td>
        <td id="LC5772">BOOL <span>CEEInfo::isRIDClassDomainID</span>(CORINFO_CLASS_HANDLE cls)</td>
      </tr>
      <tr>
        <td id="L5773" data-line-number="5773"></td>
        <td id="LC5773">{</td>
      </tr>
      <tr>
        <td id="L5774" data-line-number="5774"></td>
        <td id="LC5774">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L5775" data-line-number="5775"></td>
        <td id="LC5775">        THROWS;</td>
      </tr>
      <tr>
        <td id="L5776" data-line-number="5776"></td>
        <td id="LC5776">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L5777" data-line-number="5777"></td>
        <td id="LC5777">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L5778" data-line-number="5778"></td>
        <td id="LC5778">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L5779" data-line-number="5779"></td>
        <td id="LC5779">
</td>
      </tr>
      <tr>
        <td id="L5780" data-line-number="5780"></td>
        <td id="LC5780">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L5781" data-line-number="5781"></td>
        <td id="LC5781">
</td>
      </tr>
      <tr>
        <td id="L5782" data-line-number="5782"></td>
        <td id="LC5782">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5783" data-line-number="5783"></td>
        <td id="LC5783">
</td>
      </tr>
      <tr>
        <td id="L5784" data-line-number="5784"></td>
        <td id="LC5784">    TypeHandle  <span>VMClsHnd</span>(cls);</td>
      </tr>
      <tr>
        <td id="L5785" data-line-number="5785"></td>
        <td id="LC5785">
</td>
      </tr>
      <tr>
        <td id="L5786" data-line-number="5786"></td>
        <td id="LC5786">    result = !VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>IsDynamicStatics</span>();</td>
      </tr>
      <tr>
        <td id="L5787" data-line-number="5787"></td>
        <td id="LC5787">
</td>
      </tr>
      <tr>
        <td id="L5788" data-line-number="5788"></td>
        <td id="LC5788">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5789" data-line-number="5789"></td>
        <td id="LC5789">
</td>
      </tr>
      <tr>
        <td id="L5790" data-line-number="5790"></td>
        <td id="LC5790">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L5791" data-line-number="5791"></td>
        <td id="LC5791">}</td>
      </tr>
      <tr>
        <td id="L5792" data-line-number="5792"></td>
        <td id="LC5792">
</td>
      </tr>
      <tr>
        <td id="L5793" data-line-number="5793"></td>
        <td id="LC5793">
</td>
      </tr>
      <tr>
        <td id="L5794" data-line-number="5794"></td>
        <td id="LC5794"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L5795" data-line-number="5795"></td>
        <td id="LC5795"><span>unsigned</span> <span>CEEInfo::getClassDomainID</span> (CORINFO_CLASS_HANDLE clsHnd,</td>
      </tr>
      <tr>
        <td id="L5796" data-line-number="5796"></td>
        <td id="LC5796">                                    <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L5797" data-line-number="5797"></td>
        <td id="LC5797">{</td>
      </tr>
      <tr>
        <td id="L5798" data-line-number="5798"></td>
        <td id="LC5798">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L5799" data-line-number="5799"></td>
        <td id="LC5799">        THROWS;</td>
      </tr>
      <tr>
        <td id="L5800" data-line-number="5800"></td>
        <td id="LC5800">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L5801" data-line-number="5801"></td>
        <td id="LC5801">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L5802" data-line-number="5802"></td>
        <td id="LC5802">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L5803" data-line-number="5803"></td>
        <td id="LC5803">
</td>
      </tr>
      <tr>
        <td id="L5804" data-line-number="5804"></td>
        <td id="LC5804">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L5805" data-line-number="5805"></td>
        <td id="LC5805">
</td>
      </tr>
      <tr>
        <td id="L5806" data-line-number="5806"></td>
        <td id="LC5806">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L5807" data-line-number="5807"></td>
        <td id="LC5807">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L5808" data-line-number="5808"></td>
        <td id="LC5808">
</td>
      </tr>
      <tr>
        <td id="L5809" data-line-number="5809"></td>
        <td id="LC5809">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5810" data-line-number="5810"></td>
        <td id="LC5810">
</td>
      </tr>
      <tr>
        <td id="L5811" data-line-number="5811"></td>
        <td id="LC5811">    TypeHandle  <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L5812" data-line-number="5812"></td>
        <td id="LC5812">
</td>
      </tr>
      <tr>
        <td id="L5813" data-line-number="5813"></td>
        <td id="LC5813">    <span>if</span> (VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>IsDynamicStatics</span>())</td>
      </tr>
      <tr>
        <td id="L5814" data-line-number="5814"></td>
        <td id="LC5814">    {</td>
      </tr>
      <tr>
        <td id="L5815" data-line-number="5815"></td>
        <td id="LC5815">        result = (<span>unsigned</span>)VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>GetModuleDynamicEntryID</span>();</td>
      </tr>
      <tr>
        <td id="L5816" data-line-number="5816"></td>
        <td id="LC5816">    }</td>
      </tr>
      <tr>
        <td id="L5817" data-line-number="5817"></td>
        <td id="LC5817">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5818" data-line-number="5818"></td>
        <td id="LC5818">    {</td>
      </tr>
      <tr>
        <td id="L5819" data-line-number="5819"></td>
        <td id="LC5819">        result = (<span>unsigned</span>)VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>GetClassIndex</span>();</td>
      </tr>
      <tr>
        <td id="L5820" data-line-number="5820"></td>
        <td id="LC5820">    }</td>
      </tr>
      <tr>
        <td id="L5821" data-line-number="5821"></td>
        <td id="LC5821">
</td>
      </tr>
      <tr>
        <td id="L5822" data-line-number="5822"></td>
        <td id="LC5822">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5823" data-line-number="5823"></td>
        <td id="LC5823">
</td>
      </tr>
      <tr>
        <td id="L5824" data-line-number="5824"></td>
        <td id="LC5824">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L5825" data-line-number="5825"></td>
        <td id="LC5825">}</td>
      </tr>
      <tr>
        <td id="L5826" data-line-number="5826"></td>
        <td id="LC5826">
</td>
      </tr>
      <tr>
        <td id="L5827" data-line-number="5827"></td>
        <td id="LC5827"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L5828" data-line-number="5828"></td>
        <td id="LC5828"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5829" data-line-number="5829"></td>
        <td id="LC5829"><span><span>//</span> Used by the JIT to determine whether the profiler or IBC is tracking object</span></td>
      </tr>
      <tr>
        <td id="L5830" data-line-number="5830"></td>
        <td id="LC5830"><span><span>//</span> allocations</span></td>
      </tr>
      <tr>
        <td id="L5831" data-line-number="5831"></td>
        <td id="LC5831"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5832" data-line-number="5832"></td>
        <td id="LC5832"><span><span>//</span> Return Value:</span></td>
      </tr>
      <tr>
        <td id="L5833" data-line-number="5833"></td>
        <td id="LC5833"><span><span>//</span>    bool indicating whether the profiler or IBC is tracking object allocations</span></td>
      </tr>
      <tr>
        <td id="L5834" data-line-number="5834"></td>
        <td id="LC5834"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5835" data-line-number="5835"></td>
        <td id="LC5835"><span><span>//</span> Notes:</span></td>
      </tr>
      <tr>
        <td id="L5836" data-line-number="5836"></td>
        <td id="LC5836"><span><span>//</span>    Normally, a profiler would just directly call the inline helper to determine</span></td>
      </tr>
      <tr>
        <td id="L5837" data-line-number="5837"></td>
        <td id="LC5837"><span><span>//</span>    whether the profiler set the relevant event flag (e.g.,</span></td>
      </tr>
      <tr>
        <td id="L5838" data-line-number="5838"></td>
        <td id="LC5838"><span><span>//</span>    CORProfilerTrackAllocationsEnabled). However, this wrapper also asks whether we're</span></td>
      </tr>
      <tr>
        <td id="L5839" data-line-number="5839"></td>
        <td id="LC5839"><span><span>//</span>    running for IBC instrumentation or enabling the object allocated ETW event. If so,</span></td>
      </tr>
      <tr>
        <td id="L5840" data-line-number="5840"></td>
        <td id="LC5840"><span><span>//</span>    we treat that the same as if the profiler requested allocation information, so that</span></td>
      </tr>
      <tr>
        <td id="L5841" data-line-number="5841"></td>
        <td id="LC5841"><span><span>//</span>    the JIT will still use the profiling-friendly object allocation jit helper, so the</span></td>
      </tr>
      <tr>
        <td id="L5842" data-line-number="5842"></td>
        <td id="LC5842"><span><span>//</span>    allocations can be tracked.</span></td>
      </tr>
      <tr>
        <td id="L5843" data-line-number="5843"></td>
        <td id="LC5843"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L5844" data-line-number="5844"></td>
        <td id="LC5844">
</td>
      </tr>
      <tr>
        <td id="L5845" data-line-number="5845"></td>
        <td id="LC5845"><span>bool</span> __stdcall <span>TrackAllocationsEnabled</span>()</td>
      </tr>
      <tr>
        <td id="L5846" data-line-number="5846"></td>
        <td id="LC5846">{</td>
      </tr>
      <tr>
        <td id="L5847" data-line-number="5847"></td>
        <td id="LC5847">    CONTRACTL</td>
      </tr>
      <tr>
        <td id="L5848" data-line-number="5848"></td>
        <td id="LC5848">    {</td>
      </tr>
      <tr>
        <td id="L5849" data-line-number="5849"></td>
        <td id="LC5849">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L5850" data-line-number="5850"></td>
        <td id="LC5850">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L5851" data-line-number="5851"></td>
        <td id="LC5851">        MODE_ANY;</td>
      </tr>
      <tr>
        <td id="L5852" data-line-number="5852"></td>
        <td id="LC5852">    }</td>
      </tr>
      <tr>
        <td id="L5853" data-line-number="5853"></td>
        <td id="LC5853">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L5854" data-line-number="5854"></td>
        <td id="LC5854">
</td>
      </tr>
      <tr>
        <td id="L5855" data-line-number="5855"></td>
        <td id="LC5855">    <span>return</span> (</td>
      </tr>
      <tr>
        <td id="L5856" data-line-number="5856"></td>
        <td id="LC5856">        (g_IBCLogger.<span>InstrEnabled</span>() != <span>FALSE</span>)</td>
      </tr>
      <tr>
        <td id="L5857" data-line-number="5857"></td>
        <td id="LC5857">#<span>ifdef</span> PROFILING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L5858" data-line-number="5858"></td>
        <td id="LC5858">        || <span>CORProfilerTrackAllocationsEnabled</span>()</td>
      </tr>
      <tr>
        <td id="L5859" data-line-number="5859"></td>
        <td id="LC5859">#<span>endif</span> <span><span>//</span> PROFILING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L5860" data-line-number="5860"></td>
        <td id="LC5860">#<span>ifdef</span> FEATURE_EVENT_TRACE</td>
      </tr>
      <tr>
        <td id="L5861" data-line-number="5861"></td>
        <td id="LC5861">        || <span>ETW::TypeSystemLog::IsHeapAllocEventEnabled</span>()</td>
      </tr>
      <tr>
        <td id="L5862" data-line-number="5862"></td>
        <td id="LC5862">#<span>endif</span> <span><span>//</span> FEATURE_EVENT_TRACE</span></td>
      </tr>
      <tr>
        <td id="L5863" data-line-number="5863"></td>
        <td id="LC5863">        );</td>
      </tr>
      <tr>
        <td id="L5864" data-line-number="5864"></td>
        <td id="LC5864">}</td>
      </tr>
      <tr>
        <td id="L5865" data-line-number="5865"></td>
        <td id="LC5865">
</td>
      </tr>
      <tr>
        <td id="L5866" data-line-number="5866"></td>
        <td id="LC5866"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L5867" data-line-number="5867"></td>
        <td id="LC5867">CorInfoHelpFunc <span>CEEInfo::getNewHelper</span>(CORINFO_RESOLVED_TOKEN * pResolvedToken, CORINFO_METHOD_HANDLE callerHandle, <span>bool</span> * pHasSideEffects)</td>
      </tr>
      <tr>
        <td id="L5868" data-line-number="5868"></td>
        <td id="LC5868">{</td>
      </tr>
      <tr>
        <td id="L5869" data-line-number="5869"></td>
        <td id="LC5869">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L5870" data-line-number="5870"></td>
        <td id="LC5870">        THROWS;</td>
      </tr>
      <tr>
        <td id="L5871" data-line-number="5871"></td>
        <td id="LC5871">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L5872" data-line-number="5872"></td>
        <td id="LC5872">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L5873" data-line-number="5873"></td>
        <td id="LC5873">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L5874" data-line-number="5874"></td>
        <td id="LC5874">
</td>
      </tr>
      <tr>
        <td id="L5875" data-line-number="5875"></td>
        <td id="LC5875">    CorInfoHelpFunc result = CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L5876" data-line-number="5876"></td>
        <td id="LC5876">
</td>
      </tr>
      <tr>
        <td id="L5877" data-line-number="5877"></td>
        <td id="LC5877">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5878" data-line-number="5878"></td>
        <td id="LC5878">
</td>
      </tr>
      <tr>
        <td id="L5879" data-line-number="5879"></td>
        <td id="LC5879">    TypeHandle  <span>VMClsHnd</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L5880" data-line-number="5880"></td>
        <td id="LC5880">
</td>
      </tr>
      <tr>
        <td id="L5881" data-line-number="5881"></td>
        <td id="LC5881">    <span>if</span>(VMClsHnd.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L5882" data-line-number="5882"></td>
        <td id="LC5882">    {</td>
      </tr>
      <tr>
        <td id="L5883" data-line-number="5883"></td>
        <td id="LC5883">        <span>COMPlusThrow</span>(<span>kInvalidOperationException</span>,<span>W</span>(<span><span>"</span>InvalidOperation_CantInstantiateFunctionPointer<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L5884" data-line-number="5884"></td>
        <td id="LC5884">    }</td>
      </tr>
      <tr>
        <td id="L5885" data-line-number="5885"></td>
        <td id="LC5885">
</td>
      </tr>
      <tr>
        <td id="L5886" data-line-number="5886"></td>
        <td id="LC5886">    <span>if</span>(VMClsHnd.<span>IsAbstract</span>())</td>
      </tr>
      <tr>
        <td id="L5887" data-line-number="5887"></td>
        <td id="LC5887">    {</td>
      </tr>
      <tr>
        <td id="L5888" data-line-number="5888"></td>
        <td id="LC5888">        <span>COMPlusThrow</span>(<span>kInvalidOperationException</span>,<span>W</span>(<span><span>"</span>InvalidOperation_CantInstantiateAbstractClass<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L5889" data-line-number="5889"></td>
        <td id="LC5889">    }</td>
      </tr>
      <tr>
        <td id="L5890" data-line-number="5890"></td>
        <td id="LC5890">
</td>
      </tr>
      <tr>
        <td id="L5891" data-line-number="5891"></td>
        <td id="LC5891">    MethodTable* pMT = VMClsHnd.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L5892" data-line-number="5892"></td>
        <td id="LC5892">    result = <span>getNewHelperStatic</span>(pMT, pHasSideEffects);</td>
      </tr>
      <tr>
        <td id="L5893" data-line-number="5893"></td>
        <td id="LC5893">
</td>
      </tr>
      <tr>
        <td id="L5894" data-line-number="5894"></td>
        <td id="LC5894">    <span>_ASSERTE</span>(result != CORINFO_HELP_UNDEF);</td>
      </tr>
      <tr>
        <td id="L5895" data-line-number="5895"></td>
        <td id="LC5895">
</td>
      </tr>
      <tr>
        <td id="L5896" data-line-number="5896"></td>
        <td id="LC5896">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L5897" data-line-number="5897"></td>
        <td id="LC5897">
</td>
      </tr>
      <tr>
        <td id="L5898" data-line-number="5898"></td>
        <td id="LC5898">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L5899" data-line-number="5899"></td>
        <td id="LC5899">}</td>
      </tr>
      <tr>
        <td id="L5900" data-line-number="5900"></td>
        <td id="LC5900">
</td>
      </tr>
      <tr>
        <td id="L5901" data-line-number="5901"></td>
        <td id="LC5901"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L5902" data-line-number="5902"></td>
        <td id="LC5902">CorInfoHelpFunc <span>CEEInfo::getNewHelperStatic</span>(MethodTable * pMT, <span>bool</span> * pHasSideEffects)</td>
      </tr>
      <tr>
        <td id="L5903" data-line-number="5903"></td>
        <td id="LC5903">{</td>
      </tr>
      <tr>
        <td id="L5904" data-line-number="5904"></td>
        <td id="LC5904">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L5905" data-line-number="5905"></td>
        <td id="LC5905">
</td>
      </tr>
      <tr>
        <td id="L5906" data-line-number="5906"></td>
        <td id="LC5906">
</td>
      </tr>
      <tr>
        <td id="L5907" data-line-number="5907"></td>
        <td id="LC5907">    <span><span>//</span> Slow helper is the default</span></td>
      </tr>
      <tr>
        <td id="L5908" data-line-number="5908"></td>
        <td id="LC5908">    CorInfoHelpFunc helper = CORINFO_HELP_NEWFAST;</td>
      </tr>
      <tr>
        <td id="L5909" data-line-number="5909"></td>
        <td id="LC5909">    BOOL hasFinalizer = pMT-&gt;<span>HasFinalizer</span>();</td>
      </tr>
      <tr>
        <td id="L5910" data-line-number="5910"></td>
        <td id="LC5910">    BOOL isComObjectType = pMT-&gt;<span>IsComObjectType</span>();</td>
      </tr>
      <tr>
        <td id="L5911" data-line-number="5911"></td>
        <td id="LC5911">
</td>
      </tr>
      <tr>
        <td id="L5912" data-line-number="5912"></td>
        <td id="LC5912">    <span>if</span> (pHasSideEffects != <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L5913" data-line-number="5913"></td>
        <td id="LC5913">    {</td>
      </tr>
      <tr>
        <td id="L5914" data-line-number="5914"></td>
        <td id="LC5914">        <span>if</span> (isComObjectType)</td>
      </tr>
      <tr>
        <td id="L5915" data-line-number="5915"></td>
        <td id="LC5915">        {</td>
      </tr>
      <tr>
        <td id="L5916" data-line-number="5916"></td>
        <td id="LC5916">            *pHasSideEffects = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L5917" data-line-number="5917"></td>
        <td id="LC5917">        }</td>
      </tr>
      <tr>
        <td id="L5918" data-line-number="5918"></td>
        <td id="LC5918">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5919" data-line-number="5919"></td>
        <td id="LC5919">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L5920" data-line-number="5920"></td>
        <td id="LC5920">        <span>if</span> (<span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L5921" data-line-number="5921"></td>
        <td id="LC5921">        {</td>
      </tr>
      <tr>
        <td id="L5922" data-line-number="5922"></td>
        <td id="LC5922">            *pHasSideEffects = hasFinalizer || !pMT-&gt;<span>IsInheritanceChainFixedInCurrentVersionBubble</span>();</td>
      </tr>
      <tr>
        <td id="L5923" data-line-number="5923"></td>
        <td id="LC5923">        }</td>
      </tr>
      <tr>
        <td id="L5924" data-line-number="5924"></td>
        <td id="LC5924">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L5925" data-line-number="5925"></td>
        <td id="LC5925">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L5926" data-line-number="5926"></td>
        <td id="LC5926">        {</td>
      </tr>
      <tr>
        <td id="L5927" data-line-number="5927"></td>
        <td id="LC5927">            *pHasSideEffects = !!hasFinalizer;</td>
      </tr>
      <tr>
        <td id="L5928" data-line-number="5928"></td>
        <td id="LC5928">        }</td>
      </tr>
      <tr>
        <td id="L5929" data-line-number="5929"></td>
        <td id="LC5929">    }</td>
      </tr>
      <tr>
        <td id="L5930" data-line-number="5930"></td>
        <td id="LC5930">
</td>
      </tr>
      <tr>
        <td id="L5931" data-line-number="5931"></td>
        <td id="LC5931">    <span>if</span> (isComObjectType)</td>
      </tr>
      <tr>
        <td id="L5932" data-line-number="5932"></td>
        <td id="LC5932">    {</td>
      </tr>
      <tr>
        <td id="L5933" data-line-number="5933"></td>
        <td id="LC5933">        <span><span>//</span> Use slow helper</span></td>
      </tr>
      <tr>
        <td id="L5934" data-line-number="5934"></td>
        <td id="LC5934">        <span>_ASSERTE</span>(helper == CORINFO_HELP_NEWFAST);</td>
      </tr>
      <tr>
        <td id="L5935" data-line-number="5935"></td>
        <td id="LC5935">    }</td>
      </tr>
      <tr>
        <td id="L5936" data-line-number="5936"></td>
        <td id="LC5936">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5937" data-line-number="5937"></td>
        <td id="LC5937">    <span>if</span> ((pMT-&gt;<span>GetBaseSize</span>() &gt;= LARGE_OBJECT_SIZE) ||</td>
      </tr>
      <tr>
        <td id="L5938" data-line-number="5938"></td>
        <td id="LC5938">        hasFinalizer)</td>
      </tr>
      <tr>
        <td id="L5939" data-line-number="5939"></td>
        <td id="LC5939">    {</td>
      </tr>
      <tr>
        <td id="L5940" data-line-number="5940"></td>
        <td id="LC5940">        <span><span>//</span> Use slow helper</span></td>
      </tr>
      <tr>
        <td id="L5941" data-line-number="5941"></td>
        <td id="LC5941">        <span>_ASSERTE</span>(helper == CORINFO_HELP_NEWFAST);</td>
      </tr>
      <tr>
        <td id="L5942" data-line-number="5942"></td>
        <td id="LC5942">    }</td>
      </tr>
      <tr>
        <td id="L5943" data-line-number="5943"></td>
        <td id="LC5943">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5944" data-line-number="5944"></td>
        <td id="LC5944">    <span><span>//</span> don't call the super-optimized one since that does not check</span></td>
      </tr>
      <tr>
        <td id="L5945" data-line-number="5945"></td>
        <td id="LC5945">    <span><span>//</span> for GCStress</span></td>
      </tr>
      <tr>
        <td id="L5946" data-line-number="5946"></td>
        <td id="LC5946">    <span>if</span> (GCStress&lt;cfg_alloc&gt;::<span>IsEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L5947" data-line-number="5947"></td>
        <td id="LC5947">    {</td>
      </tr>
      <tr>
        <td id="L5948" data-line-number="5948"></td>
        <td id="LC5948">        <span><span>//</span> Use slow helper</span></td>
      </tr>
      <tr>
        <td id="L5949" data-line-number="5949"></td>
        <td id="LC5949">        <span>_ASSERTE</span>(helper == CORINFO_HELP_NEWFAST);</td>
      </tr>
      <tr>
        <td id="L5950" data-line-number="5950"></td>
        <td id="LC5950">    }</td>
      </tr>
      <tr>
        <td id="L5951" data-line-number="5951"></td>
        <td id="LC5951">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5952" data-line-number="5952"></td>
        <td id="LC5952">#<span>ifdef</span> _LOGALLOC</td>
      </tr>
      <tr>
        <td id="L5953" data-line-number="5953"></td>
        <td id="LC5953">#<span>ifdef</span> LOGGING</td>
      </tr>
      <tr>
        <td id="L5954" data-line-number="5954"></td>
        <td id="LC5954">    <span><span>//</span> Super fast version doesn't do logging</span></td>
      </tr>
      <tr>
        <td id="L5955" data-line-number="5955"></td>
        <td id="LC5955">    <span>if</span> (<span>LoggingOn</span>(LF_GCALLOC, LL_INFO10))</td>
      </tr>
      <tr>
        <td id="L5956" data-line-number="5956"></td>
        <td id="LC5956">    {</td>
      </tr>
      <tr>
        <td id="L5957" data-line-number="5957"></td>
        <td id="LC5957">        <span><span>//</span> Use slow helper</span></td>
      </tr>
      <tr>
        <td id="L5958" data-line-number="5958"></td>
        <td id="LC5958">        <span>_ASSERTE</span>(helper == CORINFO_HELP_NEWFAST);</td>
      </tr>
      <tr>
        <td id="L5959" data-line-number="5959"></td>
        <td id="LC5959">    }</td>
      </tr>
      <tr>
        <td id="L5960" data-line-number="5960"></td>
        <td id="LC5960">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5961" data-line-number="5961"></td>
        <td id="LC5961">#<span>endif</span> <span><span>//</span> LOGGING</span></td>
      </tr>
      <tr>
        <td id="L5962" data-line-number="5962"></td>
        <td id="LC5962">#<span>endif</span> <span><span>//</span> _LOGALLOC</span></td>
      </tr>
      <tr>
        <td id="L5963" data-line-number="5963"></td>
        <td id="LC5963">    <span><span>//</span> Don't use the SFAST allocator when tracking object allocations,</span></td>
      </tr>
      <tr>
        <td id="L5964" data-line-number="5964"></td>
        <td id="LC5964">    <span><span>//</span> so we don't have to instrument it.</span></td>
      </tr>
      <tr>
        <td id="L5965" data-line-number="5965"></td>
        <td id="LC5965">    <span>if</span> (<span>TrackAllocationsEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L5966" data-line-number="5966"></td>
        <td id="LC5966">    {</td>
      </tr>
      <tr>
        <td id="L5967" data-line-number="5967"></td>
        <td id="LC5967">        <span><span>//</span> Use slow helper</span></td>
      </tr>
      <tr>
        <td id="L5968" data-line-number="5968"></td>
        <td id="LC5968">        <span>_ASSERTE</span>(helper == CORINFO_HELP_NEWFAST);</td>
      </tr>
      <tr>
        <td id="L5969" data-line-number="5969"></td>
        <td id="LC5969">    }</td>
      </tr>
      <tr>
        <td id="L5970" data-line-number="5970"></td>
        <td id="LC5970">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5971" data-line-number="5971"></td>
        <td id="LC5971">#<span>ifdef</span> FEATURE_64BIT_ALIGNMENT</td>
      </tr>
      <tr>
        <td id="L5972" data-line-number="5972"></td>
        <td id="LC5972">    <span><span>//</span> @ARMTODO: Force all 8-byte alignment requiring allocations down one slow path. As performance</span></td>
      </tr>
      <tr>
        <td id="L5973" data-line-number="5973"></td>
        <td id="LC5973">    <span><span>//</span> measurements dictate we can spread these out to faster, more specialized helpers later.</span></td>
      </tr>
      <tr>
        <td id="L5974" data-line-number="5974"></td>
        <td id="LC5974">    <span>if</span> (pMT-&gt;<span>RequiresAlign8</span>())</td>
      </tr>
      <tr>
        <td id="L5975" data-line-number="5975"></td>
        <td id="LC5975">    {</td>
      </tr>
      <tr>
        <td id="L5976" data-line-number="5976"></td>
        <td id="LC5976">        <span><span>//</span> Use slow helper</span></td>
      </tr>
      <tr>
        <td id="L5977" data-line-number="5977"></td>
        <td id="LC5977">        <span>_ASSERTE</span>(helper == CORINFO_HELP_NEWFAST);</td>
      </tr>
      <tr>
        <td id="L5978" data-line-number="5978"></td>
        <td id="LC5978">    }</td>
      </tr>
      <tr>
        <td id="L5979" data-line-number="5979"></td>
        <td id="LC5979">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L5980" data-line-number="5980"></td>
        <td id="LC5980">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L5981" data-line-number="5981"></td>
        <td id="LC5981">    {</td>
      </tr>
      <tr>
        <td id="L5982" data-line-number="5982"></td>
        <td id="LC5982">        <span><span>//</span> Use the fast helper when all conditions are met</span></td>
      </tr>
      <tr>
        <td id="L5983" data-line-number="5983"></td>
        <td id="LC5983">        helper = CORINFO_HELP_NEWSFAST;</td>
      </tr>
      <tr>
        <td id="L5984" data-line-number="5984"></td>
        <td id="LC5984">    }</td>
      </tr>
      <tr>
        <td id="L5985" data-line-number="5985"></td>
        <td id="LC5985">
</td>
      </tr>
      <tr>
        <td id="L5986" data-line-number="5986"></td>
        <td id="LC5986">#<span>ifdef</span> FEATURE_DOUBLE_ALIGNMENT_HINT</td>
      </tr>
      <tr>
        <td id="L5987" data-line-number="5987"></td>
        <td id="LC5987">    <span><span>//</span> If we are use the the fast allocator we also may need the</span></td>
      </tr>
      <tr>
        <td id="L5988" data-line-number="5988"></td>
        <td id="LC5988">    <span><span>//</span> specialized varion for align8</span></td>
      </tr>
      <tr>
        <td id="L5989" data-line-number="5989"></td>
        <td id="LC5989">    <span>if</span> (pMT-&gt;<span>GetClass</span>()-&gt;<span>IsAlign8Candidate</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L5990" data-line-number="5990"></td>
        <td id="LC5990">        (helper == CORINFO_HELP_NEWSFAST))</td>
      </tr>
      <tr>
        <td id="L5991" data-line-number="5991"></td>
        <td id="LC5991">    {</td>
      </tr>
      <tr>
        <td id="L5992" data-line-number="5992"></td>
        <td id="LC5992">        helper = CORINFO_HELP_NEWSFAST_ALIGN8;</td>
      </tr>
      <tr>
        <td id="L5993" data-line-number="5993"></td>
        <td id="LC5993">    }</td>
      </tr>
      <tr>
        <td id="L5994" data-line-number="5994"></td>
        <td id="LC5994">#<span>endif</span> <span><span>//</span> FEATURE_DOUBLE_ALIGNMENT_HINT</span></td>
      </tr>
      <tr>
        <td id="L5995" data-line-number="5995"></td>
        <td id="LC5995">
</td>
      </tr>
      <tr>
        <td id="L5996" data-line-number="5996"></td>
        <td id="LC5996">    <span>return</span> helper;</td>
      </tr>
      <tr>
        <td id="L5997" data-line-number="5997"></td>
        <td id="LC5997">}</td>
      </tr>
      <tr>
        <td id="L5998" data-line-number="5998"></td>
        <td id="LC5998">
</td>
      </tr>
      <tr>
        <td id="L5999" data-line-number="5999"></td>
        <td id="LC5999"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6000" data-line-number="6000"></td>
        <td id="LC6000"><span><span>//</span> &lt;REVIEW&gt; this only works for shared generic code because all the</span></td>
      </tr>
      <tr>
        <td id="L6001" data-line-number="6001"></td>
        <td id="LC6001"><span><span>//</span> helpers are actually the same. If they were different then things might</span></td>
      </tr>
      <tr>
        <td id="L6002" data-line-number="6002"></td>
        <td id="LC6002"><span><span>//</span> break because the same helper would end up getting used for different but</span></td>
      </tr>
      <tr>
        <td id="L6003" data-line-number="6003"></td>
        <td id="LC6003"><span><span>//</span> representation-compatible arrays (e.g. one with a default constructor</span></td>
      </tr>
      <tr>
        <td id="L6004" data-line-number="6004"></td>
        <td id="LC6004"><span><span>//</span> and one without) &lt;/REVIEW&gt;</span></td>
      </tr>
      <tr>
        <td id="L6005" data-line-number="6005"></td>
        <td id="LC6005">CorInfoHelpFunc <span>CEEInfo::getNewArrHelper</span> (CORINFO_CLASS_HANDLE arrayClsHnd)</td>
      </tr>
      <tr>
        <td id="L6006" data-line-number="6006"></td>
        <td id="LC6006">{</td>
      </tr>
      <tr>
        <td id="L6007" data-line-number="6007"></td>
        <td id="LC6007">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6008" data-line-number="6008"></td>
        <td id="LC6008">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6009" data-line-number="6009"></td>
        <td id="LC6009">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6010" data-line-number="6010"></td>
        <td id="LC6010">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6011" data-line-number="6011"></td>
        <td id="LC6011">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6012" data-line-number="6012"></td>
        <td id="LC6012">
</td>
      </tr>
      <tr>
        <td id="L6013" data-line-number="6013"></td>
        <td id="LC6013">    CorInfoHelpFunc result = CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L6014" data-line-number="6014"></td>
        <td id="LC6014">
</td>
      </tr>
      <tr>
        <td id="L6015" data-line-number="6015"></td>
        <td id="LC6015">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6016" data-line-number="6016"></td>
        <td id="LC6016">
</td>
      </tr>
      <tr>
        <td id="L6017" data-line-number="6017"></td>
        <td id="LC6017">    TypeHandle <span>arrayType</span>(arrayClsHnd);</td>
      </tr>
      <tr>
        <td id="L6018" data-line-number="6018"></td>
        <td id="LC6018">
</td>
      </tr>
      <tr>
        <td id="L6019" data-line-number="6019"></td>
        <td id="LC6019">    result = <span>getNewArrHelperStatic</span>(arrayType);</td>
      </tr>
      <tr>
        <td id="L6020" data-line-number="6020"></td>
        <td id="LC6020">
</td>
      </tr>
      <tr>
        <td id="L6021" data-line-number="6021"></td>
        <td id="LC6021">    <span>_ASSERTE</span>(result != CORINFO_HELP_UNDEF);</td>
      </tr>
      <tr>
        <td id="L6022" data-line-number="6022"></td>
        <td id="LC6022">
</td>
      </tr>
      <tr>
        <td id="L6023" data-line-number="6023"></td>
        <td id="LC6023">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6024" data-line-number="6024"></td>
        <td id="LC6024">
</td>
      </tr>
      <tr>
        <td id="L6025" data-line-number="6025"></td>
        <td id="LC6025">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6026" data-line-number="6026"></td>
        <td id="LC6026">}</td>
      </tr>
      <tr>
        <td id="L6027" data-line-number="6027"></td>
        <td id="LC6027">
</td>
      </tr>
      <tr>
        <td id="L6028" data-line-number="6028"></td>
        <td id="LC6028"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6029" data-line-number="6029"></td>
        <td id="LC6029">CorInfoHelpFunc <span>CEEInfo::getNewArrHelperStatic</span>(TypeHandle clsHnd)</td>
      </tr>
      <tr>
        <td id="L6030" data-line-number="6030"></td>
        <td id="LC6030">{</td>
      </tr>
      <tr>
        <td id="L6031" data-line-number="6031"></td>
        <td id="LC6031">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6032" data-line-number="6032"></td>
        <td id="LC6032">
</td>
      </tr>
      <tr>
        <td id="L6033" data-line-number="6033"></td>
        <td id="LC6033">    <span>_ASSERTE</span>(clsHnd.<span>GetInternalCorElementType</span>() == ELEMENT_TYPE_SZARRAY);</td>
      </tr>
      <tr>
        <td id="L6034" data-line-number="6034"></td>
        <td id="LC6034">
</td>
      </tr>
      <tr>
        <td id="L6035" data-line-number="6035"></td>
        <td id="LC6035">    <span>if</span> (GCStress&lt;cfg_alloc&gt;::<span>IsEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L6036" data-line-number="6036"></td>
        <td id="LC6036">    {</td>
      </tr>
      <tr>
        <td id="L6037" data-line-number="6037"></td>
        <td id="LC6037">        <span>return</span> CORINFO_HELP_NEWARR_1_DIRECT;</td>
      </tr>
      <tr>
        <td id="L6038" data-line-number="6038"></td>
        <td id="LC6038">    }</td>
      </tr>
      <tr>
        <td id="L6039" data-line-number="6039"></td>
        <td id="LC6039">
</td>
      </tr>
      <tr>
        <td id="L6040" data-line-number="6040"></td>
        <td id="LC6040">    CorInfoHelpFunc result = CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L6041" data-line-number="6041"></td>
        <td id="LC6041">
</td>
      </tr>
      <tr>
        <td id="L6042" data-line-number="6042"></td>
        <td id="LC6042">    TypeHandle thElemType = clsHnd.<span>GetArrayElementTypeHandle</span>();</td>
      </tr>
      <tr>
        <td id="L6043" data-line-number="6043"></td>
        <td id="LC6043">    CorElementType elemType = thElemType.<span>GetInternalCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L6044" data-line-number="6044"></td>
        <td id="LC6044">
</td>
      </tr>
      <tr>
        <td id="L6045" data-line-number="6045"></td>
        <td id="LC6045">    <span><span>//</span> This is if we're asked for newarr !0 when verifying generic code</span></td>
      </tr>
      <tr>
        <td id="L6046" data-line-number="6046"></td>
        <td id="LC6046">    <span><span>//</span> Of course ideally you wouldn't even be generating code when</span></td>
      </tr>
      <tr>
        <td id="L6047" data-line-number="6047"></td>
        <td id="LC6047">    <span><span>//</span> simply doing verification (we run the JIT importer in import-only</span></td>
      </tr>
      <tr>
        <td id="L6048" data-line-number="6048"></td>
        <td id="LC6048">    <span><span>//</span> mode), but importing does more than one would like so we try to be</span></td>
      </tr>
      <tr>
        <td id="L6049" data-line-number="6049"></td>
        <td id="LC6049">    <span><span>//</span> tolerant when asked for non-sensical helpers.</span></td>
      </tr>
      <tr>
        <td id="L6050" data-line-number="6050"></td>
        <td id="LC6050">    <span>if</span> (<span>CorTypeInfo::IsGenericVariable</span>(elemType))</td>
      </tr>
      <tr>
        <td id="L6051" data-line-number="6051"></td>
        <td id="LC6051">    {</td>
      </tr>
      <tr>
        <td id="L6052" data-line-number="6052"></td>
        <td id="LC6052">        result = CORINFO_HELP_NEWARR_1_OBJ;</td>
      </tr>
      <tr>
        <td id="L6053" data-line-number="6053"></td>
        <td id="LC6053">    }</td>
      </tr>
      <tr>
        <td id="L6054" data-line-number="6054"></td>
        <td id="LC6054">    <span>else</span> <span>if</span> (<span>CorTypeInfo::IsObjRef</span>(elemType))</td>
      </tr>
      <tr>
        <td id="L6055" data-line-number="6055"></td>
        <td id="LC6055">    {</td>
      </tr>
      <tr>
        <td id="L6056" data-line-number="6056"></td>
        <td id="LC6056">        <span><span>//</span> It is an array of object refs</span></td>
      </tr>
      <tr>
        <td id="L6057" data-line-number="6057"></td>
        <td id="LC6057">        result = CORINFO_HELP_NEWARR_1_OBJ;</td>
      </tr>
      <tr>
        <td id="L6058" data-line-number="6058"></td>
        <td id="LC6058">    }</td>
      </tr>
      <tr>
        <td id="L6059" data-line-number="6059"></td>
        <td id="LC6059">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6060" data-line-number="6060"></td>
        <td id="LC6060">    {</td>
      </tr>
      <tr>
        <td id="L6061" data-line-number="6061"></td>
        <td id="LC6061">        <span><span>//</span> These cases always must use the slow helper</span></td>
      </tr>
      <tr>
        <td id="L6062" data-line-number="6062"></td>
        <td id="LC6062">        <span>if</span> (</td>
      </tr>
      <tr>
        <td id="L6063" data-line-number="6063"></td>
        <td id="LC6063">#<span>ifdef</span> FEATURE_64BIT_ALIGNMENT</td>
      </tr>
      <tr>
        <td id="L6064" data-line-number="6064"></td>
        <td id="LC6064">            thElemType.<span>RequiresAlign8</span>() ||</td>
      </tr>
      <tr>
        <td id="L6065" data-line-number="6065"></td>
        <td id="LC6065">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L6066" data-line-number="6066"></td>
        <td id="LC6066">            (elemType == ELEMENT_TYPE_VOID) ||</td>
      </tr>
      <tr>
        <td id="L6067" data-line-number="6067"></td>
        <td id="LC6067">            <span>LoggingOn</span>(LF_GCALLOC, LL_INFO10) ||</td>
      </tr>
      <tr>
        <td id="L6068" data-line-number="6068"></td>
        <td id="LC6068">            <span>TrackAllocationsEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L6069" data-line-number="6069"></td>
        <td id="LC6069">        {</td>
      </tr>
      <tr>
        <td id="L6070" data-line-number="6070"></td>
        <td id="LC6070">            <span><span>//</span> Use the slow helper</span></td>
      </tr>
      <tr>
        <td id="L6071" data-line-number="6071"></td>
        <td id="LC6071">            result = CORINFO_HELP_NEWARR_1_DIRECT;</td>
      </tr>
      <tr>
        <td id="L6072" data-line-number="6072"></td>
        <td id="LC6072">        }</td>
      </tr>
      <tr>
        <td id="L6073" data-line-number="6073"></td>
        <td id="LC6073">#<span>ifdef</span> FEATURE_DOUBLE_ALIGNMENT_HINT</td>
      </tr>
      <tr>
        <td id="L6074" data-line-number="6074"></td>
        <td id="LC6074">        <span>else</span> <span>if</span> (elemType == ELEMENT_TYPE_R8)</td>
      </tr>
      <tr>
        <td id="L6075" data-line-number="6075"></td>
        <td id="LC6075">        {</td>
      </tr>
      <tr>
        <td id="L6076" data-line-number="6076"></td>
        <td id="LC6076">            <span><span>//</span> Use the Align8 fast helper</span></td>
      </tr>
      <tr>
        <td id="L6077" data-line-number="6077"></td>
        <td id="LC6077">            result = CORINFO_HELP_NEWARR_1_ALIGN8;</td>
      </tr>
      <tr>
        <td id="L6078" data-line-number="6078"></td>
        <td id="LC6078">        }</td>
      </tr>
      <tr>
        <td id="L6079" data-line-number="6079"></td>
        <td id="LC6079">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L6080" data-line-number="6080"></td>
        <td id="LC6080">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L6081" data-line-number="6081"></td>
        <td id="LC6081">        {</td>
      </tr>
      <tr>
        <td id="L6082" data-line-number="6082"></td>
        <td id="LC6082">            <span><span>//</span> Yea, we can do it the fast way!</span></td>
      </tr>
      <tr>
        <td id="L6083" data-line-number="6083"></td>
        <td id="LC6083">            result = CORINFO_HELP_NEWARR_1_VC;</td>
      </tr>
      <tr>
        <td id="L6084" data-line-number="6084"></td>
        <td id="LC6084">        }</td>
      </tr>
      <tr>
        <td id="L6085" data-line-number="6085"></td>
        <td id="LC6085">    }</td>
      </tr>
      <tr>
        <td id="L6086" data-line-number="6086"></td>
        <td id="LC6086">
</td>
      </tr>
      <tr>
        <td id="L6087" data-line-number="6087"></td>
        <td id="LC6087">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6088" data-line-number="6088"></td>
        <td id="LC6088">}</td>
      </tr>
      <tr>
        <td id="L6089" data-line-number="6089"></td>
        <td id="LC6089">
</td>
      </tr>
      <tr>
        <td id="L6090" data-line-number="6090"></td>
        <td id="LC6090"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6091" data-line-number="6091"></td>
        <td id="LC6091">CorInfoHelpFunc <span>CEEInfo::getCastingHelper</span>(CORINFO_RESOLVED_TOKEN * pResolvedToken, <span>bool</span> <span>fThrowing</span>)</td>
      </tr>
      <tr>
        <td id="L6092" data-line-number="6092"></td>
        <td id="LC6092">{</td>
      </tr>
      <tr>
        <td id="L6093" data-line-number="6093"></td>
        <td id="LC6093">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6094" data-line-number="6094"></td>
        <td id="LC6094">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6095" data-line-number="6095"></td>
        <td id="LC6095">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6096" data-line-number="6096"></td>
        <td id="LC6096">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6097" data-line-number="6097"></td>
        <td id="LC6097">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6098" data-line-number="6098"></td>
        <td id="LC6098">
</td>
      </tr>
      <tr>
        <td id="L6099" data-line-number="6099"></td>
        <td id="LC6099">    <span>if</span> (<span>isVerifyOnly</span>())</td>
      </tr>
      <tr>
        <td id="L6100" data-line-number="6100"></td>
        <td id="LC6100">        <span>return</span> <span>fThrowing</span> ? CORINFO_HELP_CHKCASTANY : CORINFO_HELP_ISINSTANCEOFANY;</td>
      </tr>
      <tr>
        <td id="L6101" data-line-number="6101"></td>
        <td id="LC6101">
</td>
      </tr>
      <tr>
        <td id="L6102" data-line-number="6102"></td>
        <td id="LC6102">    CorInfoHelpFunc result = CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L6103" data-line-number="6103"></td>
        <td id="LC6103">
</td>
      </tr>
      <tr>
        <td id="L6104" data-line-number="6104"></td>
        <td id="LC6104">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6105" data-line-number="6105"></td>
        <td id="LC6105">
</td>
      </tr>
      <tr>
        <td id="L6106" data-line-number="6106"></td>
        <td id="LC6106">    <span>bool</span> <span>fClassMustBeRestored</span>;</td>
      </tr>
      <tr>
        <td id="L6107" data-line-number="6107"></td>
        <td id="LC6107">    result = <span>getCastingHelperStatic</span>(<span>TypeHandle</span>(pResolvedToken-&gt;<span>hClass</span>), <span>fThrowing</span>, &amp;<span>fClassMustBeRestored</span>);</td>
      </tr>
      <tr>
        <td id="L6108" data-line-number="6108"></td>
        <td id="LC6108">    <span>if</span> (<span>fClassMustBeRestored</span> &amp;&amp; m_pOverride != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L6109" data-line-number="6109"></td>
        <td id="LC6109">        m_pOverride-&gt;<span>classMustBeLoadedBeforeCodeIsRun</span>(pResolvedToken-&gt;<span>hClass</span>);</td>
      </tr>
      <tr>
        <td id="L6110" data-line-number="6110"></td>
        <td id="LC6110">
</td>
      </tr>
      <tr>
        <td id="L6111" data-line-number="6111"></td>
        <td id="LC6111">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6112" data-line-number="6112"></td>
        <td id="LC6112">
</td>
      </tr>
      <tr>
        <td id="L6113" data-line-number="6113"></td>
        <td id="LC6113">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6114" data-line-number="6114"></td>
        <td id="LC6114">}</td>
      </tr>
      <tr>
        <td id="L6115" data-line-number="6115"></td>
        <td id="LC6115">
</td>
      </tr>
      <tr>
        <td id="L6116" data-line-number="6116"></td>
        <td id="LC6116"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6117" data-line-number="6117"></td>
        <td id="LC6117">CorInfoHelpFunc <span>CEEInfo::getCastingHelperStatic</span>(TypeHandle clsHnd, <span>bool</span> <span>fThrowing</span>, <span>bool</span> * pfClassMustBeRestored)</td>
      </tr>
      <tr>
        <td id="L6118" data-line-number="6118"></td>
        <td id="LC6118">{</td>
      </tr>
      <tr>
        <td id="L6119" data-line-number="6119"></td>
        <td id="LC6119">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6120" data-line-number="6120"></td>
        <td id="LC6120">
</td>
      </tr>
      <tr>
        <td id="L6121" data-line-number="6121"></td>
        <td id="LC6121">    <span><span>//</span> Slow helper is the default</span></td>
      </tr>
      <tr>
        <td id="L6122" data-line-number="6122"></td>
        <td id="LC6122">    <span>int</span> helper = CORINFO_HELP_ISINSTANCEOFANY;</td>
      </tr>
      <tr>
        <td id="L6123" data-line-number="6123"></td>
        <td id="LC6123">
</td>
      </tr>
      <tr>
        <td id="L6124" data-line-number="6124"></td>
        <td id="LC6124">    *pfClassMustBeRestored = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L6125" data-line-number="6125"></td>
        <td id="LC6125">
</td>
      </tr>
      <tr>
        <td id="L6126" data-line-number="6126"></td>
        <td id="LC6126">    <span>if</span> (clsHnd == <span>TypeHandle</span>(g_pCanonMethodTableClass))</td>
      </tr>
      <tr>
        <td id="L6127" data-line-number="6127"></td>
        <td id="LC6127">    {</td>
      </tr>
      <tr>
        <td id="L6128" data-line-number="6128"></td>
        <td id="LC6128">        <span><span>//</span> In shared code just use the catch-all helper for type variables, as the same</span></td>
      </tr>
      <tr>
        <td id="L6129" data-line-number="6129"></td>
        <td id="LC6129">        <span><span>//</span> code may be used for interface/array/class instantiations</span></td>
      </tr>
      <tr>
        <td id="L6130" data-line-number="6130"></td>
        <td id="LC6130">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L6131" data-line-number="6131"></td>
        <td id="LC6131">        <span><span>//</span> We may be able to take advantage of constraints to select a specialized helper.</span></td>
      </tr>
      <tr>
        <td id="L6132" data-line-number="6132"></td>
        <td id="LC6132">        <span><span>//</span> This optimizations does not seem to be warranted at the moment.</span></td>
      </tr>
      <tr>
        <td id="L6133" data-line-number="6133"></td>
        <td id="LC6133">        <span>_ASSERTE</span>(helper == CORINFO_HELP_ISINSTANCEOFANY);</td>
      </tr>
      <tr>
        <td id="L6134" data-line-number="6134"></td>
        <td id="LC6134">    }</td>
      </tr>
      <tr>
        <td id="L6135" data-line-number="6135"></td>
        <td id="LC6135">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6136" data-line-number="6136"></td>
        <td id="LC6136">    <span>if</span> (!clsHnd.<span>IsTypeDesc</span>() &amp;&amp; clsHnd.<span>AsMethodTable</span>()-&gt;<span>HasVariance</span>())</td>
      </tr>
      <tr>
        <td id="L6137" data-line-number="6137"></td>
        <td id="LC6137">    {</td>
      </tr>
      <tr>
        <td id="L6138" data-line-number="6138"></td>
        <td id="LC6138">        <span><span>//</span> Casting to variant type requires the type to be fully loaded</span></td>
      </tr>
      <tr>
        <td id="L6139" data-line-number="6139"></td>
        <td id="LC6139">        *pfClassMustBeRestored = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6140" data-line-number="6140"></td>
        <td id="LC6140">
</td>
      </tr>
      <tr>
        <td id="L6141" data-line-number="6141"></td>
        <td id="LC6141">        <span>_ASSERTE</span>(helper == CORINFO_HELP_ISINSTANCEOFANY);</td>
      </tr>
      <tr>
        <td id="L6142" data-line-number="6142"></td>
        <td id="LC6142">    }</td>
      </tr>
      <tr>
        <td id="L6143" data-line-number="6143"></td>
        <td id="LC6143">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6144" data-line-number="6144"></td>
        <td id="LC6144">    <span>if</span> (!clsHnd.<span>IsTypeDesc</span>() &amp;&amp; clsHnd.<span>AsMethodTable</span>()-&gt;<span>HasTypeEquivalence</span>())</td>
      </tr>
      <tr>
        <td id="L6145" data-line-number="6145"></td>
        <td id="LC6145">    {</td>
      </tr>
      <tr>
        <td id="L6146" data-line-number="6146"></td>
        <td id="LC6146">        <span><span>//</span> If the type can be equivalent with something, use the slow helper</span></td>
      </tr>
      <tr>
        <td id="L6147" data-line-number="6147"></td>
        <td id="LC6147">        <span><span>//</span> Note: if the type of the instance is the one marked as equivalent, it will be</span></td>
      </tr>
      <tr>
        <td id="L6148" data-line-number="6148"></td>
        <td id="LC6148">        <span><span>//</span> caught by the fast helpers in the same way as they catch transparent proxies.</span></td>
      </tr>
      <tr>
        <td id="L6149" data-line-number="6149"></td>
        <td id="LC6149">        <span>_ASSERTE</span>(helper == CORINFO_HELP_ISINSTANCEOFANY);</td>
      </tr>
      <tr>
        <td id="L6150" data-line-number="6150"></td>
        <td id="LC6150">    }</td>
      </tr>
      <tr>
        <td id="L6151" data-line-number="6151"></td>
        <td id="LC6151">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6152" data-line-number="6152"></td>
        <td id="LC6152">    <span>if</span> (clsHnd.<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L6153" data-line-number="6153"></td>
        <td id="LC6153">    {</td>
      </tr>
      <tr>
        <td id="L6154" data-line-number="6154"></td>
        <td id="LC6154">        <span><span>//</span> If it is a non-variant interface, use the fast interface helper</span></td>
      </tr>
      <tr>
        <td id="L6155" data-line-number="6155"></td>
        <td id="LC6155">        helper = CORINFO_HELP_ISINSTANCEOFINTERFACE;</td>
      </tr>
      <tr>
        <td id="L6156" data-line-number="6156"></td>
        <td id="LC6156">    }</td>
      </tr>
      <tr>
        <td id="L6157" data-line-number="6157"></td>
        <td id="LC6157">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6158" data-line-number="6158"></td>
        <td id="LC6158">    <span>if</span> (clsHnd.<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L6159" data-line-number="6159"></td>
        <td id="LC6159">    {</td>
      </tr>
      <tr>
        <td id="L6160" data-line-number="6160"></td>
        <td id="LC6160">        <span>if</span> (clsHnd.<span>GetInternalCorElementType</span>() != ELEMENT_TYPE_SZARRAY)</td>
      </tr>
      <tr>
        <td id="L6161" data-line-number="6161"></td>
        <td id="LC6161">        {</td>
      </tr>
      <tr>
        <td id="L6162" data-line-number="6162"></td>
        <td id="LC6162">            <span><span>//</span> Casting to multidimensional array type requires restored pointer to EEClass to fetch rank</span></td>
      </tr>
      <tr>
        <td id="L6163" data-line-number="6163"></td>
        <td id="LC6163">            *pfClassMustBeRestored = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6164" data-line-number="6164"></td>
        <td id="LC6164">        }</td>
      </tr>
      <tr>
        <td id="L6165" data-line-number="6165"></td>
        <td id="LC6165">
</td>
      </tr>
      <tr>
        <td id="L6166" data-line-number="6166"></td>
        <td id="LC6166">        <span><span>//</span> If it is an array, use the fast array helper</span></td>
      </tr>
      <tr>
        <td id="L6167" data-line-number="6167"></td>
        <td id="LC6167">        helper = CORINFO_HELP_ISINSTANCEOFARRAY;</td>
      </tr>
      <tr>
        <td id="L6168" data-line-number="6168"></td>
        <td id="LC6168">    }</td>
      </tr>
      <tr>
        <td id="L6169" data-line-number="6169"></td>
        <td id="LC6169">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6170" data-line-number="6170"></td>
        <td id="LC6170">    <span>if</span> (!clsHnd.<span>IsTypeDesc</span>() &amp;&amp; !<span>Nullable::IsNullableType</span>(clsHnd))</td>
      </tr>
      <tr>
        <td id="L6171" data-line-number="6171"></td>
        <td id="LC6171">    {</td>
      </tr>
      <tr>
        <td id="L6172" data-line-number="6172"></td>
        <td id="LC6172">        <span><span>//</span> If it is a non-variant class, use the fast class helper</span></td>
      </tr>
      <tr>
        <td id="L6173" data-line-number="6173"></td>
        <td id="LC6173">        helper = CORINFO_HELP_ISINSTANCEOFCLASS;</td>
      </tr>
      <tr>
        <td id="L6174" data-line-number="6174"></td>
        <td id="LC6174">    }</td>
      </tr>
      <tr>
        <td id="L6175" data-line-number="6175"></td>
        <td id="LC6175">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6176" data-line-number="6176"></td>
        <td id="LC6176">    {</td>
      </tr>
      <tr>
        <td id="L6177" data-line-number="6177"></td>
        <td id="LC6177">        <span><span>//</span> Otherwise, use the slow helper</span></td>
      </tr>
      <tr>
        <td id="L6178" data-line-number="6178"></td>
        <td id="LC6178">        <span>_ASSERTE</span>(helper == CORINFO_HELP_ISINSTANCEOFANY);</td>
      </tr>
      <tr>
        <td id="L6179" data-line-number="6179"></td>
        <td id="LC6179">    }</td>
      </tr>
      <tr>
        <td id="L6180" data-line-number="6180"></td>
        <td id="LC6180">
</td>
      </tr>
      <tr>
        <td id="L6181" data-line-number="6181"></td>
        <td id="LC6181">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L6182" data-line-number="6182"></td>
        <td id="LC6182">    BOOL t1, t2, forceInstr;</td>
      </tr>
      <tr>
        <td id="L6183" data-line-number="6183"></td>
        <td id="LC6183">    <span>SystemDomain::GetCompilationOverrides</span>(&amp;t1, &amp;t2, &amp;forceInstr);</td>
      </tr>
      <tr>
        <td id="L6184" data-line-number="6184"></td>
        <td id="LC6184">    <span>if</span> (forceInstr)</td>
      </tr>
      <tr>
        <td id="L6185" data-line-number="6185"></td>
        <td id="LC6185">    {</td>
      </tr>
      <tr>
        <td id="L6186" data-line-number="6186"></td>
        <td id="LC6186">        <span><span>//</span> If we're compiling for instrumentation, use the slowest but instrumented cast helper</span></td>
      </tr>
      <tr>
        <td id="L6187" data-line-number="6187"></td>
        <td id="LC6187">        helper = CORINFO_HELP_ISINSTANCEOFANY;</td>
      </tr>
      <tr>
        <td id="L6188" data-line-number="6188"></td>
        <td id="LC6188">    }</td>
      </tr>
      <tr>
        <td id="L6189" data-line-number="6189"></td>
        <td id="LC6189">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L6190" data-line-number="6190"></td>
        <td id="LC6190">
</td>
      </tr>
      <tr>
        <td id="L6191" data-line-number="6191"></td>
        <td id="LC6191">    <span>if</span> (<span>fThrowing</span>)</td>
      </tr>
      <tr>
        <td id="L6192" data-line-number="6192"></td>
        <td id="LC6192">    {</td>
      </tr>
      <tr>
        <td id="L6193" data-line-number="6193"></td>
        <td id="LC6193">        <span>const</span> <span>int</span> delta = CORINFO_HELP_CHKCASTANY - CORINFO_HELP_ISINSTANCEOFANY;</td>
      </tr>
      <tr>
        <td id="L6194" data-line-number="6194"></td>
        <td id="LC6194">
</td>
      </tr>
      <tr>
        <td id="L6195" data-line-number="6195"></td>
        <td id="LC6195">        <span>static_assert_no_msg</span>(CORINFO_HELP_CHKCASTINTERFACE</td>
      </tr>
      <tr>
        <td id="L6196" data-line-number="6196"></td>
        <td id="LC6196">            == CORINFO_HELP_ISINSTANCEOFINTERFACE + delta);</td>
      </tr>
      <tr>
        <td id="L6197" data-line-number="6197"></td>
        <td id="LC6197">        <span>static_assert_no_msg</span>(CORINFO_HELP_CHKCASTARRAY</td>
      </tr>
      <tr>
        <td id="L6198" data-line-number="6198"></td>
        <td id="LC6198">            == CORINFO_HELP_ISINSTANCEOFARRAY + delta);</td>
      </tr>
      <tr>
        <td id="L6199" data-line-number="6199"></td>
        <td id="LC6199">        <span>static_assert_no_msg</span>(CORINFO_HELP_CHKCASTCLASS</td>
      </tr>
      <tr>
        <td id="L6200" data-line-number="6200"></td>
        <td id="LC6200">            == CORINFO_HELP_ISINSTANCEOFCLASS + delta);</td>
      </tr>
      <tr>
        <td id="L6201" data-line-number="6201"></td>
        <td id="LC6201">
</td>
      </tr>
      <tr>
        <td id="L6202" data-line-number="6202"></td>
        <td id="LC6202">        helper += delta;</td>
      </tr>
      <tr>
        <td id="L6203" data-line-number="6203"></td>
        <td id="LC6203">    }</td>
      </tr>
      <tr>
        <td id="L6204" data-line-number="6204"></td>
        <td id="LC6204">
</td>
      </tr>
      <tr>
        <td id="L6205" data-line-number="6205"></td>
        <td id="LC6205">    <span>return</span> (CorInfoHelpFunc)helper;</td>
      </tr>
      <tr>
        <td id="L6206" data-line-number="6206"></td>
        <td id="LC6206">}</td>
      </tr>
      <tr>
        <td id="L6207" data-line-number="6207"></td>
        <td id="LC6207">
</td>
      </tr>
      <tr>
        <td id="L6208" data-line-number="6208"></td>
        <td id="LC6208"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6209" data-line-number="6209"></td>
        <td id="LC6209">CorInfoHelpFunc <span>CEEInfo::getSharedCCtorHelper</span>(CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L6210" data-line-number="6210"></td>
        <td id="LC6210">{</td>
      </tr>
      <tr>
        <td id="L6211" data-line-number="6211"></td>
        <td id="LC6211">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6212" data-line-number="6212"></td>
        <td id="LC6212">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L6213" data-line-number="6213"></td>
        <td id="LC6213">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L6214" data-line-number="6214"></td>
        <td id="LC6214">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6215" data-line-number="6215"></td>
        <td id="LC6215">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6216" data-line-number="6216"></td>
        <td id="LC6216">
</td>
      </tr>
      <tr>
        <td id="L6217" data-line-number="6217"></td>
        <td id="LC6217">    CorInfoHelpFunc result = CORINFO_HELP_GETSHARED_NONGCSTATIC_BASE;</td>
      </tr>
      <tr>
        <td id="L6218" data-line-number="6218"></td>
        <td id="LC6218">
</td>
      </tr>
      <tr>
        <td id="L6219" data-line-number="6219"></td>
        <td id="LC6219">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L6220" data-line-number="6220"></td>
        <td id="LC6220">
</td>
      </tr>
      <tr>
        <td id="L6221" data-line-number="6221"></td>
        <td id="LC6221">    TypeHandle <span>cls</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L6222" data-line-number="6222"></td>
        <td id="LC6222">    MethodTable* pMT = cls.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L6223" data-line-number="6223"></td>
        <td id="LC6223">
</td>
      </tr>
      <tr>
        <td id="L6224" data-line-number="6224"></td>
        <td id="LC6224">    <span>if</span> (pMT-&gt;<span>IsDynamicStatics</span>())</td>
      </tr>
      <tr>
        <td id="L6225" data-line-number="6225"></td>
        <td id="LC6225">    {</td>
      </tr>
      <tr>
        <td id="L6226" data-line-number="6226"></td>
        <td id="LC6226">        <span>_ASSERTE</span>(!cls.<span>ContainsGenericVariables</span>());</td>
      </tr>
      <tr>
        <td id="L6227" data-line-number="6227"></td>
        <td id="LC6227">        <span>_ASSERTE</span>(pMT-&gt;<span>GetModuleDynamicEntryID</span>() != (<span>unsigned</span>) -<span>1</span>);</td>
      </tr>
      <tr>
        <td id="L6228" data-line-number="6228"></td>
        <td id="LC6228">
</td>
      </tr>
      <tr>
        <td id="L6229" data-line-number="6229"></td>
        <td id="LC6229">        result = CORINFO_HELP_CLASSINIT_SHARED_DYNAMICCLASS;</td>
      </tr>
      <tr>
        <td id="L6230" data-line-number="6230"></td>
        <td id="LC6230">    }</td>
      </tr>
      <tr>
        <td id="L6231" data-line-number="6231"></td>
        <td id="LC6231">
</td>
      </tr>
      <tr>
        <td id="L6232" data-line-number="6232"></td>
        <td id="LC6232">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L6233" data-line-number="6233"></td>
        <td id="LC6233">
</td>
      </tr>
      <tr>
        <td id="L6234" data-line-number="6234"></td>
        <td id="LC6234">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6235" data-line-number="6235"></td>
        <td id="LC6235">}</td>
      </tr>
      <tr>
        <td id="L6236" data-line-number="6236"></td>
        <td id="LC6236">
</td>
      </tr>
      <tr>
        <td id="L6237" data-line-number="6237"></td>
        <td id="LC6237"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6238" data-line-number="6238"></td>
        <td id="LC6238">CorInfoHelpFunc <span>CEEInfo::getUnBoxHelper</span>(CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L6239" data-line-number="6239"></td>
        <td id="LC6239">{</td>
      </tr>
      <tr>
        <td id="L6240" data-line-number="6240"></td>
        <td id="LC6240">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6241" data-line-number="6241"></td>
        <td id="LC6241">
</td>
      </tr>
      <tr>
        <td id="L6242" data-line-number="6242"></td>
        <td id="LC6242">    <span>if</span> (m_pOverride != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L6243" data-line-number="6243"></td>
        <td id="LC6243">        m_pOverride-&gt;<span>classMustBeLoadedBeforeCodeIsRun</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L6244" data-line-number="6244"></td>
        <td id="LC6244">
</td>
      </tr>
      <tr>
        <td id="L6245" data-line-number="6245"></td>
        <td id="LC6245">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L6246" data-line-number="6246"></td>
        <td id="LC6246">    <span>if</span> (<span>Nullable::IsNullableType</span>(VMClsHnd))</td>
      </tr>
      <tr>
        <td id="L6247" data-line-number="6247"></td>
        <td id="LC6247">        <span>return</span> CORINFO_HELP_UNBOX_NULLABLE;</td>
      </tr>
      <tr>
        <td id="L6248" data-line-number="6248"></td>
        <td id="LC6248">
</td>
      </tr>
      <tr>
        <td id="L6249" data-line-number="6249"></td>
        <td id="LC6249">    <span>return</span> CORINFO_HELP_UNBOX;</td>
      </tr>
      <tr>
        <td id="L6250" data-line-number="6250"></td>
        <td id="LC6250">}</td>
      </tr>
      <tr>
        <td id="L6251" data-line-number="6251"></td>
        <td id="LC6251">
</td>
      </tr>
      <tr>
        <td id="L6252" data-line-number="6252"></td>
        <td id="LC6252"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6253" data-line-number="6253"></td>
        <td id="LC6253"><span>bool</span> <span>CEEInfo::getReadyToRunHelper</span>(</td>
      </tr>
      <tr>
        <td id="L6254" data-line-number="6254"></td>
        <td id="LC6254">        CORINFO_RESOLVED_TOKEN *        pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L6255" data-line-number="6255"></td>
        <td id="LC6255">        CORINFO_LOOKUP_KIND *           pGenericLookupKind,</td>
      </tr>
      <tr>
        <td id="L6256" data-line-number="6256"></td>
        <td id="LC6256">        CorInfoHelpFunc                 id,</td>
      </tr>
      <tr>
        <td id="L6257" data-line-number="6257"></td>
        <td id="LC6257">        CORINFO_CONST_LOOKUP *          pLookup</td>
      </tr>
      <tr>
        <td id="L6258" data-line-number="6258"></td>
        <td id="LC6258">        )</td>
      </tr>
      <tr>
        <td id="L6259" data-line-number="6259"></td>
        <td id="LC6259">{</td>
      </tr>
      <tr>
        <td id="L6260" data-line-number="6260"></td>
        <td id="LC6260">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6261" data-line-number="6261"></td>
        <td id="LC6261">    <span>UNREACHABLE</span>();      <span><span>//</span> only called during NGen</span></td>
      </tr>
      <tr>
        <td id="L6262" data-line-number="6262"></td>
        <td id="LC6262">}</td>
      </tr>
      <tr>
        <td id="L6263" data-line-number="6263"></td>
        <td id="LC6263">
</td>
      </tr>
      <tr>
        <td id="L6264" data-line-number="6264"></td>
        <td id="LC6264"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6265" data-line-number="6265"></td>
        <td id="LC6265"><span>void</span> <span>CEEInfo::getReadyToRunDelegateCtorHelper</span>(</td>
      </tr>
      <tr>
        <td id="L6266" data-line-number="6266"></td>
        <td id="LC6266">        CORINFO_RESOLVED_TOKEN * pTargetMethod,</td>
      </tr>
      <tr>
        <td id="L6267" data-line-number="6267"></td>
        <td id="LC6267">        CORINFO_CLASS_HANDLE     delegateType,</td>
      </tr>
      <tr>
        <td id="L6268" data-line-number="6268"></td>
        <td id="LC6268">        CORINFO_LOOKUP *   pLookup</td>
      </tr>
      <tr>
        <td id="L6269" data-line-number="6269"></td>
        <td id="LC6269">        )</td>
      </tr>
      <tr>
        <td id="L6270" data-line-number="6270"></td>
        <td id="LC6270">{</td>
      </tr>
      <tr>
        <td id="L6271" data-line-number="6271"></td>
        <td id="LC6271">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6272" data-line-number="6272"></td>
        <td id="LC6272">    <span>UNREACHABLE</span>();      <span><span>//</span> only called during NGen</span></td>
      </tr>
      <tr>
        <td id="L6273" data-line-number="6273"></td>
        <td id="LC6273">}</td>
      </tr>
      <tr>
        <td id="L6274" data-line-number="6274"></td>
        <td id="LC6274">
</td>
      </tr>
      <tr>
        <td id="L6275" data-line-number="6275"></td>
        <td id="LC6275"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6276" data-line-number="6276"></td>
        <td id="LC6276"><span><span>//</span> see code:Nullable#NullableVerification</span></td>
      </tr>
      <tr>
        <td id="L6277" data-line-number="6277"></td>
        <td id="LC6277">
</td>
      </tr>
      <tr>
        <td id="L6278" data-line-number="6278"></td>
        <td id="LC6278">CORINFO_CLASS_HANDLE  <span>CEEInfo::getTypeForBox</span>(CORINFO_CLASS_HANDLE  cls)</td>
      </tr>
      <tr>
        <td id="L6279" data-line-number="6279"></td>
        <td id="LC6279">{</td>
      </tr>
      <tr>
        <td id="L6280" data-line-number="6280"></td>
        <td id="LC6280">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6281" data-line-number="6281"></td>
        <td id="LC6281">
</td>
      </tr>
      <tr>
        <td id="L6282" data-line-number="6282"></td>
        <td id="LC6282">    TypeHandle <span>VMClsHnd</span>(cls);</td>
      </tr>
      <tr>
        <td id="L6283" data-line-number="6283"></td>
        <td id="LC6283">    <span>if</span> (<span>Nullable::IsNullableType</span>(VMClsHnd)) {</td>
      </tr>
      <tr>
        <td id="L6284" data-line-number="6284"></td>
        <td id="LC6284">        VMClsHnd = VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>GetInstantiation</span>()[<span>0</span>];</td>
      </tr>
      <tr>
        <td id="L6285" data-line-number="6285"></td>
        <td id="LC6285">    }</td>
      </tr>
      <tr>
        <td id="L6286" data-line-number="6286"></td>
        <td id="LC6286">    <span>return</span> <span>static_cast</span>&lt;CORINFO_CLASS_HANDLE&gt;(VMClsHnd.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L6287" data-line-number="6287"></td>
        <td id="LC6287">}</td>
      </tr>
      <tr>
        <td id="L6288" data-line-number="6288"></td>
        <td id="LC6288">
</td>
      </tr>
      <tr>
        <td id="L6289" data-line-number="6289"></td>
        <td id="LC6289"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6290" data-line-number="6290"></td>
        <td id="LC6290"><span><span>//</span> see code:Nullable#NullableVerification</span></td>
      </tr>
      <tr>
        <td id="L6291" data-line-number="6291"></td>
        <td id="LC6291">CorInfoHelpFunc <span>CEEInfo::getBoxHelper</span>(CORINFO_CLASS_HANDLE clsHnd)</td>
      </tr>
      <tr>
        <td id="L6292" data-line-number="6292"></td>
        <td id="LC6292">{</td>
      </tr>
      <tr>
        <td id="L6293" data-line-number="6293"></td>
        <td id="LC6293">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6294" data-line-number="6294"></td>
        <td id="LC6294">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6295" data-line-number="6295"></td>
        <td id="LC6295">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6296" data-line-number="6296"></td>
        <td id="LC6296">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6297" data-line-number="6297"></td>
        <td id="LC6297">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6298" data-line-number="6298"></td>
        <td id="LC6298">
</td>
      </tr>
      <tr>
        <td id="L6299" data-line-number="6299"></td>
        <td id="LC6299">    CorInfoHelpFunc result = CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L6300" data-line-number="6300"></td>
        <td id="LC6300">
</td>
      </tr>
      <tr>
        <td id="L6301" data-line-number="6301"></td>
        <td id="LC6301">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6302" data-line-number="6302"></td>
        <td id="LC6302">
</td>
      </tr>
      <tr>
        <td id="L6303" data-line-number="6303"></td>
        <td id="LC6303">    TypeHandle <span>VMClsHnd</span>(clsHnd);</td>
      </tr>
      <tr>
        <td id="L6304" data-line-number="6304"></td>
        <td id="LC6304">    <span>if</span> (<span>Nullable::IsNullableType</span>(VMClsHnd))</td>
      </tr>
      <tr>
        <td id="L6305" data-line-number="6305"></td>
        <td id="LC6305">    {</td>
      </tr>
      <tr>
        <td id="L6306" data-line-number="6306"></td>
        <td id="LC6306">        result = CORINFO_HELP_BOX_NULLABLE;</td>
      </tr>
      <tr>
        <td id="L6307" data-line-number="6307"></td>
        <td id="LC6307">    }</td>
      </tr>
      <tr>
        <td id="L6308" data-line-number="6308"></td>
        <td id="LC6308">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L6309" data-line-number="6309"></td>
        <td id="LC6309">    {</td>
      </tr>
      <tr>
        <td id="L6310" data-line-number="6310"></td>
        <td id="LC6310">        <span>if</span>(VMClsHnd.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L6311" data-line-number="6311"></td>
        <td id="LC6311">            <span>COMPlusThrow</span>(<span>kInvalidOperationException</span>,<span>W</span>(<span><span>"</span>InvalidOperation_TypeCannotBeBoxed<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L6312" data-line-number="6312"></td>
        <td id="LC6312">
</td>
      </tr>
      <tr>
        <td id="L6313" data-line-number="6313"></td>
        <td id="LC6313">        <span><span>//</span> we shouldn't allow boxing of types that contains stack pointers</span></td>
      </tr>
      <tr>
        <td id="L6314" data-line-number="6314"></td>
        <td id="LC6314">        <span><span>//</span> csc and vbc already disallow it.</span></td>
      </tr>
      <tr>
        <td id="L6315" data-line-number="6315"></td>
        <td id="LC6315">        <span>if</span> (VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>IsByRefLike</span>())</td>
      </tr>
      <tr>
        <td id="L6316" data-line-number="6316"></td>
        <td id="LC6316">            <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>,<span>W</span>(<span><span>"</span>NotSupported_ByRefLike<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L6317" data-line-number="6317"></td>
        <td id="LC6317">
</td>
      </tr>
      <tr>
        <td id="L6318" data-line-number="6318"></td>
        <td id="LC6318">        result = CORINFO_HELP_BOX;</td>
      </tr>
      <tr>
        <td id="L6319" data-line-number="6319"></td>
        <td id="LC6319">    }</td>
      </tr>
      <tr>
        <td id="L6320" data-line-number="6320"></td>
        <td id="LC6320">
</td>
      </tr>
      <tr>
        <td id="L6321" data-line-number="6321"></td>
        <td id="LC6321">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6322" data-line-number="6322"></td>
        <td id="LC6322">
</td>
      </tr>
      <tr>
        <td id="L6323" data-line-number="6323"></td>
        <td id="LC6323">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6324" data-line-number="6324"></td>
        <td id="LC6324">}</td>
      </tr>
      <tr>
        <td id="L6325" data-line-number="6325"></td>
        <td id="LC6325">
</td>
      </tr>
      <tr>
        <td id="L6326" data-line-number="6326"></td>
        <td id="LC6326"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6327" data-line-number="6327"></td>
        <td id="LC6327">CorInfoHelpFunc <span>CEEInfo::getSecurityPrologHelper</span>(CORINFO_METHOD_HANDLE ftn)</td>
      </tr>
      <tr>
        <td id="L6328" data-line-number="6328"></td>
        <td id="LC6328">{</td>
      </tr>
      <tr>
        <td id="L6329" data-line-number="6329"></td>
        <td id="LC6329">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6330" data-line-number="6330"></td>
        <td id="LC6330">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6331" data-line-number="6331"></td>
        <td id="LC6331">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6332" data-line-number="6332"></td>
        <td id="LC6332">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6333" data-line-number="6333"></td>
        <td id="LC6333">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6334" data-line-number="6334"></td>
        <td id="LC6334">
</td>
      </tr>
      <tr>
        <td id="L6335" data-line-number="6335"></td>
        <td id="LC6335">    CorInfoHelpFunc result = CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L6336" data-line-number="6336"></td>
        <td id="LC6336">
</td>
      </tr>
      <tr>
        <td id="L6337" data-line-number="6337"></td>
        <td id="LC6337">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6338" data-line-number="6338"></td>
        <td id="LC6338">
</td>
      </tr>
      <tr>
        <td id="L6339" data-line-number="6339"></td>
        <td id="LC6339">#<span>ifdef</span> FEATURE_NATIVE_IMAGE_GENERATION</td>
      </tr>
      <tr>
        <td id="L6340" data-line-number="6340"></td>
        <td id="LC6340">    <span><span>//</span> This will make sure that when IBC logging is on, we call the slow helper with IBC probe</span></td>
      </tr>
      <tr>
        <td id="L6341" data-line-number="6341"></td>
        <td id="LC6341">    <span>if</span> (<span>IsCompilingForNGen</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L6342" data-line-number="6342"></td>
        <td id="LC6342">        <span>GetAppDomain</span>()-&gt;<span>ToCompilationDomain</span>()-&gt;<span>m_fForceInstrument</span>)</td>
      </tr>
      <tr>
        <td id="L6343" data-line-number="6343"></td>
        <td id="LC6343">    {</td>
      </tr>
      <tr>
        <td id="L6344" data-line-number="6344"></td>
        <td id="LC6344">        result = CORINFO_HELP_SECURITY_PROLOG_FRAMED;</td>
      </tr>
      <tr>
        <td id="L6345" data-line-number="6345"></td>
        <td id="LC6345">    }</td>
      </tr>
      <tr>
        <td id="L6346" data-line-number="6346"></td>
        <td id="LC6346">#<span>endif</span> <span><span>//</span> FEATURE_NATIVE_IMAGE_GENERATION</span></td>
      </tr>
      <tr>
        <td id="L6347" data-line-number="6347"></td>
        <td id="LC6347">
</td>
      </tr>
      <tr>
        <td id="L6348" data-line-number="6348"></td>
        <td id="LC6348">    <span>if</span> (result == CORINFO_HELP_UNDEF)</td>
      </tr>
      <tr>
        <td id="L6349" data-line-number="6349"></td>
        <td id="LC6349">    {</td>
      </tr>
      <tr>
        <td id="L6350" data-line-number="6350"></td>
        <td id="LC6350">        result = CORINFO_HELP_SECURITY_PROLOG;</td>
      </tr>
      <tr>
        <td id="L6351" data-line-number="6351"></td>
        <td id="LC6351">    }</td>
      </tr>
      <tr>
        <td id="L6352" data-line-number="6352"></td>
        <td id="LC6352">
</td>
      </tr>
      <tr>
        <td id="L6353" data-line-number="6353"></td>
        <td id="LC6353">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6354" data-line-number="6354"></td>
        <td id="LC6354">
</td>
      </tr>
      <tr>
        <td id="L6355" data-line-number="6355"></td>
        <td id="LC6355">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6356" data-line-number="6356"></td>
        <td id="LC6356">}</td>
      </tr>
      <tr>
        <td id="L6357" data-line-number="6357"></td>
        <td id="LC6357">
</td>
      </tr>
      <tr>
        <td id="L6358" data-line-number="6358"></td>
        <td id="LC6358"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6359" data-line-number="6359"></td>
        <td id="LC6359"><span><span>//</span> registers a vararg sig &amp; returns a class-specific cookie for it.</span></td>
      </tr>
      <tr>
        <td id="L6360" data-line-number="6360"></td>
        <td id="LC6360">
</td>
      </tr>
      <tr>
        <td id="L6361" data-line-number="6361"></td>
        <td id="LC6361">CORINFO_VARARGS_HANDLE <span>CEEInfo::getVarArgsHandle</span>(CORINFO_SIG_INFO *sig,</td>
      </tr>
      <tr>
        <td id="L6362" data-line-number="6362"></td>
        <td id="LC6362">                                                 <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L6363" data-line-number="6363"></td>
        <td id="LC6363">{</td>
      </tr>
      <tr>
        <td id="L6364" data-line-number="6364"></td>
        <td id="LC6364">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6365" data-line-number="6365"></td>
        <td id="LC6365">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6366" data-line-number="6366"></td>
        <td id="LC6366">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6367" data-line-number="6367"></td>
        <td id="LC6367">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6368" data-line-number="6368"></td>
        <td id="LC6368">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6369" data-line-number="6369"></td>
        <td id="LC6369">
</td>
      </tr>
      <tr>
        <td id="L6370" data-line-number="6370"></td>
        <td id="LC6370">    CORINFO_VARARGS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6371" data-line-number="6371"></td>
        <td id="LC6371">
</td>
      </tr>
      <tr>
        <td id="L6372" data-line-number="6372"></td>
        <td id="LC6372">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L6373" data-line-number="6373"></td>
        <td id="LC6373">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6374" data-line-number="6374"></td>
        <td id="LC6374">
</td>
      </tr>
      <tr>
        <td id="L6375" data-line-number="6375"></td>
        <td id="LC6375">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6376" data-line-number="6376"></td>
        <td id="LC6376">
</td>
      </tr>
      <tr>
        <td id="L6377" data-line-number="6377"></td>
        <td id="LC6377">    Module* module = <span>GetModule</span>(sig-&gt;<span>scope</span>);</td>
      </tr>
      <tr>
        <td id="L6378" data-line-number="6378"></td>
        <td id="LC6378">
</td>
      </tr>
      <tr>
        <td id="L6379" data-line-number="6379"></td>
        <td id="LC6379">    result = <span>CORINFO_VARARGS_HANDLE</span>(module-&gt;<span>GetVASigCookie</span>(<span>Signature</span>(sig-&gt;<span>pSig</span>, sig-&gt;<span>cbSig</span>)));</td>
      </tr>
      <tr>
        <td id="L6380" data-line-number="6380"></td>
        <td id="LC6380">
</td>
      </tr>
      <tr>
        <td id="L6381" data-line-number="6381"></td>
        <td id="LC6381">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6382" data-line-number="6382"></td>
        <td id="LC6382">
</td>
      </tr>
      <tr>
        <td id="L6383" data-line-number="6383"></td>
        <td id="LC6383">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6384" data-line-number="6384"></td>
        <td id="LC6384">}</td>
      </tr>
      <tr>
        <td id="L6385" data-line-number="6385"></td>
        <td id="LC6385">
</td>
      </tr>
      <tr>
        <td id="L6386" data-line-number="6386"></td>
        <td id="LC6386"><span>bool</span> <span>CEEInfo::canGetVarArgsHandle</span>(CORINFO_SIG_INFO *sig)</td>
      </tr>
      <tr>
        <td id="L6387" data-line-number="6387"></td>
        <td id="LC6387">{</td>
      </tr>
      <tr>
        <td id="L6388" data-line-number="6388"></td>
        <td id="LC6388">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6389" data-line-number="6389"></td>
        <td id="LC6389">    <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6390" data-line-number="6390"></td>
        <td id="LC6390">}</td>
      </tr>
      <tr>
        <td id="L6391" data-line-number="6391"></td>
        <td id="LC6391">
</td>
      </tr>
      <tr>
        <td id="L6392" data-line-number="6392"></td>
        <td id="LC6392"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6393" data-line-number="6393"></td>
        <td id="LC6393"><span>unsigned</span> <span>CEEInfo::getMethodHash</span> (CORINFO_METHOD_HANDLE ftnHnd)</td>
      </tr>
      <tr>
        <td id="L6394" data-line-number="6394"></td>
        <td id="LC6394">{</td>
      </tr>
      <tr>
        <td id="L6395" data-line-number="6395"></td>
        <td id="LC6395">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6396" data-line-number="6396"></td>
        <td id="LC6396">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6397" data-line-number="6397"></td>
        <td id="LC6397">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6398" data-line-number="6398"></td>
        <td id="LC6398">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6399" data-line-number="6399"></td>
        <td id="LC6399">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6400" data-line-number="6400"></td>
        <td id="LC6400">
</td>
      </tr>
      <tr>
        <td id="L6401" data-line-number="6401"></td>
        <td id="LC6401">    <span>unsigned</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6402" data-line-number="6402"></td>
        <td id="LC6402">
</td>
      </tr>
      <tr>
        <td id="L6403" data-line-number="6403"></td>
        <td id="LC6403">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6404" data-line-number="6404"></td>
        <td id="LC6404">
</td>
      </tr>
      <tr>
        <td id="L6405" data-line-number="6405"></td>
        <td id="LC6405">    MethodDesc* ftn = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L6406" data-line-number="6406"></td>
        <td id="LC6406">
</td>
      </tr>
      <tr>
        <td id="L6407" data-line-number="6407"></td>
        <td id="LC6407">    result = (<span>unsigned</span>) ftn-&gt;<span>GetStableHash</span>();</td>
      </tr>
      <tr>
        <td id="L6408" data-line-number="6408"></td>
        <td id="LC6408">
</td>
      </tr>
      <tr>
        <td id="L6409" data-line-number="6409"></td>
        <td id="LC6409">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6410" data-line-number="6410"></td>
        <td id="LC6410">
</td>
      </tr>
      <tr>
        <td id="L6411" data-line-number="6411"></td>
        <td id="LC6411">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6412" data-line-number="6412"></td>
        <td id="LC6412">}</td>
      </tr>
      <tr>
        <td id="L6413" data-line-number="6413"></td>
        <td id="LC6413">
</td>
      </tr>
      <tr>
        <td id="L6414" data-line-number="6414"></td>
        <td id="LC6414"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6415" data-line-number="6415"></td>
        <td id="LC6415"><span>const</span> <span>char</span>* <span>CEEInfo::getMethodName</span> (CORINFO_METHOD_HANDLE ftnHnd, <span>const</span> <span>char</span>** scopeName)</td>
      </tr>
      <tr>
        <td id="L6416" data-line-number="6416"></td>
        <td id="LC6416">{</td>
      </tr>
      <tr>
        <td id="L6417" data-line-number="6417"></td>
        <td id="LC6417">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6418" data-line-number="6418"></td>
        <td id="LC6418">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6419" data-line-number="6419"></td>
        <td id="LC6419">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6420" data-line-number="6420"></td>
        <td id="LC6420">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6421" data-line-number="6421"></td>
        <td id="LC6421">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6422" data-line-number="6422"></td>
        <td id="LC6422">
</td>
      </tr>
      <tr>
        <td id="L6423" data-line-number="6423"></td>
        <td id="LC6423">    <span>const</span> <span>char</span>* result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6424" data-line-number="6424"></td>
        <td id="LC6424">
</td>
      </tr>
      <tr>
        <td id="L6425" data-line-number="6425"></td>
        <td id="LC6425">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6426" data-line-number="6426"></td>
        <td id="LC6426">
</td>
      </tr>
      <tr>
        <td id="L6427" data-line-number="6427"></td>
        <td id="LC6427">    MethodDesc *ftn;</td>
      </tr>
      <tr>
        <td id="L6428" data-line-number="6428"></td>
        <td id="LC6428">
</td>
      </tr>
      <tr>
        <td id="L6429" data-line-number="6429"></td>
        <td id="LC6429">    ftn = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L6430" data-line-number="6430"></td>
        <td id="LC6430">
</td>
      </tr>
      <tr>
        <td id="L6431" data-line-number="6431"></td>
        <td id="LC6431">    <span>if</span> (scopeName != <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L6432" data-line-number="6432"></td>
        <td id="LC6432">    {</td>
      </tr>
      <tr>
        <td id="L6433" data-line-number="6433"></td>
        <td id="LC6433">        <span>if</span> (ftn-&gt;<span>IsLCGMethod</span>())</td>
      </tr>
      <tr>
        <td id="L6434" data-line-number="6434"></td>
        <td id="LC6434">        {</td>
      </tr>
      <tr>
        <td id="L6435" data-line-number="6435"></td>
        <td id="LC6435">            *scopeName = <span><span>"</span>DynamicClass<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L6436" data-line-number="6436"></td>
        <td id="LC6436">        }</td>
      </tr>
      <tr>
        <td id="L6437" data-line-number="6437"></td>
        <td id="LC6437">        <span>else</span> <span>if</span> (ftn-&gt;<span>IsILStub</span>())</td>
      </tr>
      <tr>
        <td id="L6438" data-line-number="6438"></td>
        <td id="LC6438">        {</td>
      </tr>
      <tr>
        <td id="L6439" data-line-number="6439"></td>
        <td id="LC6439">            *scopeName = <span>ILStubResolver::GetStubClassName</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L6440" data-line-number="6440"></td>
        <td id="LC6440">        }</td>
      </tr>
      <tr>
        <td id="L6441" data-line-number="6441"></td>
        <td id="LC6441">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L6442" data-line-number="6442"></td>
        <td id="LC6442">        {</td>
      </tr>
      <tr>
        <td id="L6443" data-line-number="6443"></td>
        <td id="LC6443">            MethodTable * pMT = ftn-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L6444" data-line-number="6444"></td>
        <td id="LC6444">#<span>if</span> defined(_DEBUG)</td>
      </tr>
      <tr>
        <td id="L6445" data-line-number="6445"></td>
        <td id="LC6445">#<span>ifdef</span> FEATURE_SYMDIFF</td>
      </tr>
      <tr>
        <td id="L6446" data-line-number="6446"></td>
        <td id="LC6446">            <span>if</span> (<span>CLRConfig::GetConfigValue</span>(CLRConfig::INTERNAL_SymDiffDump))</td>
      </tr>
      <tr>
        <td id="L6447" data-line-number="6447"></td>
        <td id="LC6447">            {</td>
      </tr>
      <tr>
        <td id="L6448" data-line-number="6448"></td>
        <td id="LC6448">                <span>if</span> (pMT-&gt;<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L6449" data-line-number="6449"></td>
        <td id="LC6449">                {</td>
      </tr>
      <tr>
        <td id="L6450" data-line-number="6450"></td>
        <td id="LC6450">                    ssClsNameBuff.<span>Clear</span>();</td>
      </tr>
      <tr>
        <td id="L6451" data-line-number="6451"></td>
        <td id="LC6451">                    ssClsNameBuff.<span>SetUTF8</span>(pMT-&gt;<span>GetDebugClassName</span>());</td>
      </tr>
      <tr>
        <td id="L6452" data-line-number="6452"></td>
        <td id="LC6452">                }</td>
      </tr>
      <tr>
        <td id="L6453" data-line-number="6453"></td>
        <td id="LC6453">                <span>else</span></td>
      </tr>
      <tr>
        <td id="L6454" data-line-number="6454"></td>
        <td id="LC6454">                    pMT-&gt;<span>_GetFullyQualifiedNameForClassNestedAware</span>(ssClsNameBuff);</td>
      </tr>
      <tr>
        <td id="L6455" data-line-number="6455"></td>
        <td id="LC6455">            }</td>
      </tr>
      <tr>
        <td id="L6456" data-line-number="6456"></td>
        <td id="LC6456">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L6457" data-line-number="6457"></td>
        <td id="LC6457">            {</td>
      </tr>
      <tr>
        <td id="L6458" data-line-number="6458"></td>
        <td id="LC6458">#endif</td>
      </tr>
      <tr>
        <td id="L6459" data-line-number="6459"></td>
        <td id="LC6459">                <span><span>//</span> Calling _GetFullyQualifiedNameForClass in chk build is very expensive</span></td>
      </tr>
      <tr>
        <td id="L6460" data-line-number="6460"></td>
        <td id="LC6460">                <span><span>//</span> since it construct the class name everytime we call this method. In chk</span></td>
      </tr>
      <tr>
        <td id="L6461" data-line-number="6461"></td>
        <td id="LC6461">                <span><span>//</span> builds we already have a cheaper way to get the class name -</span></td>
      </tr>
      <tr>
        <td id="L6462" data-line-number="6462"></td>
        <td id="LC6462">                <span><span>//</span> GetDebugClassName - which doesn't calculate the class name everytime.</span></td>
      </tr>
      <tr>
        <td id="L6463" data-line-number="6463"></td>
        <td id="LC6463">                <span><span>//</span> This results in huge saving in Ngen time for checked builds.</span></td>
      </tr>
      <tr>
        <td id="L6464" data-line-number="6464"></td>
        <td id="LC6464">                ssClsNameBuff.<span>Clear</span>();</td>
      </tr>
      <tr>
        <td id="L6465" data-line-number="6465"></td>
        <td id="LC6465">                ssClsNameBuff.<span>SetUTF8</span>(pMT-&gt;<span>GetDebugClassName</span>());</td>
      </tr>
      <tr>
        <td id="L6466" data-line-number="6466"></td>
        <td id="LC6466">
</td>
      </tr>
      <tr>
        <td id="L6467" data-line-number="6467"></td>
        <td id="LC6467">#<span>ifdef</span> FEATURE_SYMDIFF</td>
      </tr>
      <tr>
        <td id="L6468" data-line-number="6468"></td>
        <td id="LC6468">            }</td>
      </tr>
      <tr>
        <td id="L6469" data-line-number="6469"></td>
        <td id="LC6469">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L6470" data-line-number="6470"></td>
        <td id="LC6470">            <span><span>//</span> Append generic instantiation at the end</span></td>
      </tr>
      <tr>
        <td id="L6471" data-line-number="6471"></td>
        <td id="LC6471">            Instantiation inst = pMT-&gt;<span>GetInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L6472" data-line-number="6472"></td>
        <td id="LC6472">            <span>if</span> (!inst.<span>IsEmpty</span>())</td>
      </tr>
      <tr>
        <td id="L6473" data-line-number="6473"></td>
        <td id="LC6473">                <span>TypeString::AppendInst</span>(ssClsNameBuff, inst);</td>
      </tr>
      <tr>
        <td id="L6474" data-line-number="6474"></td>
        <td id="LC6474">
</td>
      </tr>
      <tr>
        <td id="L6475" data-line-number="6475"></td>
        <td id="LC6475">            *scopeName = ssClsNameBuff.<span>GetUTF8</span>(ssClsNameBuffScratch);</td>
      </tr>
      <tr>
        <td id="L6476" data-line-number="6476"></td>
        <td id="LC6476">#<span>else</span> <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L6477" data-line-number="6477"></td>
        <td id="LC6477">            <span><span>//</span> since this is for diagnostic purposes only,</span></td>
      </tr>
      <tr>
        <td id="L6478" data-line-number="6478"></td>
        <td id="LC6478">            <span><span>//</span> give up on the namespace, as we don't have a buffer to concat it</span></td>
      </tr>
      <tr>
        <td id="L6479" data-line-number="6479"></td>
        <td id="LC6479">            <span><span>//</span> also note this won't show array class names.</span></td>
      </tr>
      <tr>
        <td id="L6480" data-line-number="6480"></td>
        <td id="LC6480">            LPCUTF8 nameSpace;</td>
      </tr>
      <tr>
        <td id="L6481" data-line-number="6481"></td>
        <td id="LC6481">            *scopeName= pMT-&gt;<span>GetFullyQualifiedNameInfo</span>(&amp;nameSpace);</td>
      </tr>
      <tr>
        <td id="L6482" data-line-number="6482"></td>
        <td id="LC6482">#endif <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L6483" data-line-number="6483"></td>
        <td id="LC6483">        }</td>
      </tr>
      <tr>
        <td id="L6484" data-line-number="6484"></td>
        <td id="LC6484">    }</td>
      </tr>
      <tr>
        <td id="L6485" data-line-number="6485"></td>
        <td id="LC6485">
</td>
      </tr>
      <tr>
        <td id="L6486" data-line-number="6486"></td>
        <td id="LC6486">    result = ftn-&gt;<span>GetName</span>();</td>
      </tr>
      <tr>
        <td id="L6487" data-line-number="6487"></td>
        <td id="LC6487">
</td>
      </tr>
      <tr>
        <td id="L6488" data-line-number="6488"></td>
        <td id="LC6488">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6489" data-line-number="6489"></td>
        <td id="LC6489">
</td>
      </tr>
      <tr>
        <td id="L6490" data-line-number="6490"></td>
        <td id="LC6490">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6491" data-line-number="6491"></td>
        <td id="LC6491">}</td>
      </tr>
      <tr>
        <td id="L6492" data-line-number="6492"></td>
        <td id="LC6492">
</td>
      </tr>
      <tr>
        <td id="L6493" data-line-number="6493"></td>
        <td id="LC6493"><span>const</span> <span>char</span>* <span>CEEInfo::getMethodNameFromMetadata</span>(CORINFO_METHOD_HANDLE ftnHnd, <span>const</span> <span>char</span>** className, <span>const</span> <span>char</span>** namespaceName, <span>const</span> <span>char</span> **enclosingClassName)</td>
      </tr>
      <tr>
        <td id="L6494" data-line-number="6494"></td>
        <td id="LC6494">{</td>
      </tr>
      <tr>
        <td id="L6495" data-line-number="6495"></td>
        <td id="LC6495">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6496" data-line-number="6496"></td>
        <td id="LC6496">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6497" data-line-number="6497"></td>
        <td id="LC6497">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6498" data-line-number="6498"></td>
        <td id="LC6498">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6499" data-line-number="6499"></td>
        <td id="LC6499">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6500" data-line-number="6500"></td>
        <td id="LC6500">
</td>
      </tr>
      <tr>
        <td id="L6501" data-line-number="6501"></td>
        <td id="LC6501">    <span>const</span> <span>char</span>* result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6502" data-line-number="6502"></td>
        <td id="LC6502">    <span>const</span> <span>char</span>* classResult = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6503" data-line-number="6503"></td>
        <td id="LC6503">    <span>const</span> <span>char</span>* namespaceResult = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6504" data-line-number="6504"></td>
        <td id="LC6504">    <span>const</span> <span>char</span>* enclosingResult = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6505" data-line-number="6505"></td>
        <td id="LC6505">
</td>
      </tr>
      <tr>
        <td id="L6506" data-line-number="6506"></td>
        <td id="LC6506">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6507" data-line-number="6507"></td>
        <td id="LC6507">
</td>
      </tr>
      <tr>
        <td id="L6508" data-line-number="6508"></td>
        <td id="LC6508">    MethodDesc *ftn = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L6509" data-line-number="6509"></td>
        <td id="LC6509">    mdMethodDef token = ftn-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L6510" data-line-number="6510"></td>
        <td id="LC6510">
</td>
      </tr>
      <tr>
        <td id="L6511" data-line-number="6511"></td>
        <td id="LC6511">    <span>if</span> (!<span>IsNilToken</span>(token))</td>
      </tr>
      <tr>
        <td id="L6512" data-line-number="6512"></td>
        <td id="LC6512">    {</td>
      </tr>
      <tr>
        <td id="L6513" data-line-number="6513"></td>
        <td id="LC6513">        MethodTable* pMT = ftn-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L6514" data-line-number="6514"></td>
        <td id="LC6514">        IMDInternalImport* pMDImport = pMT-&gt;<span>GetMDImport</span>();</td>
      </tr>
      <tr>
        <td id="L6515" data-line-number="6515"></td>
        <td id="LC6515">
</td>
      </tr>
      <tr>
        <td id="L6516" data-line-number="6516"></td>
        <td id="LC6516">        <span>IfFailThrow</span>(pMDImport-&gt;<span>GetNameOfMethodDef</span>(token, &amp;result));</td>
      </tr>
      <tr>
        <td id="L6517" data-line-number="6517"></td>
        <td id="LC6517">        <span>IfFailThrow</span>(pMDImport-&gt;<span>GetNameOfTypeDef</span>(pMT-&gt;<span>GetCl</span>(), &amp;classResult, &amp;namespaceResult));</td>
      </tr>
      <tr>
        <td id="L6518" data-line-number="6518"></td>
        <td id="LC6518">        <span><span>//</span> Query enclosingClassName when the method is in a nested class</span></td>
      </tr>
      <tr>
        <td id="L6519" data-line-number="6519"></td>
        <td id="LC6519">        <span><span>//</span> and get the namespace of enclosing classes (nested class's namespace is empty)</span></td>
      </tr>
      <tr>
        <td id="L6520" data-line-number="6520"></td>
        <td id="LC6520">        <span>if</span> (pMT-&gt;<span>GetClass</span>()-&gt;<span>IsNested</span>())</td>
      </tr>
      <tr>
        <td id="L6521" data-line-number="6521"></td>
        <td id="LC6521">        {</td>
      </tr>
      <tr>
        <td id="L6522" data-line-number="6522"></td>
        <td id="LC6522">            <span>IfFailThrow</span>(pMDImport-&gt;<span>GetNameOfTypeDef</span>(pMT-&gt;<span>GetEnclosingCl</span>(), &amp;enclosingResult, &amp;namespaceResult));</td>
      </tr>
      <tr>
        <td id="L6523" data-line-number="6523"></td>
        <td id="LC6523">        }</td>
      </tr>
      <tr>
        <td id="L6524" data-line-number="6524"></td>
        <td id="LC6524">    }</td>
      </tr>
      <tr>
        <td id="L6525" data-line-number="6525"></td>
        <td id="LC6525">
</td>
      </tr>
      <tr>
        <td id="L6526" data-line-number="6526"></td>
        <td id="LC6526">    <span>if</span> (className != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L6527" data-line-number="6527"></td>
        <td id="LC6527">    {</td>
      </tr>
      <tr>
        <td id="L6528" data-line-number="6528"></td>
        <td id="LC6528">        *className = classResult;</td>
      </tr>
      <tr>
        <td id="L6529" data-line-number="6529"></td>
        <td id="LC6529">    }</td>
      </tr>
      <tr>
        <td id="L6530" data-line-number="6530"></td>
        <td id="LC6530">
</td>
      </tr>
      <tr>
        <td id="L6531" data-line-number="6531"></td>
        <td id="LC6531">    <span>if</span> (namespaceName != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L6532" data-line-number="6532"></td>
        <td id="LC6532">    {</td>
      </tr>
      <tr>
        <td id="L6533" data-line-number="6533"></td>
        <td id="LC6533">        *namespaceName = namespaceResult;</td>
      </tr>
      <tr>
        <td id="L6534" data-line-number="6534"></td>
        <td id="LC6534">    }</td>
      </tr>
      <tr>
        <td id="L6535" data-line-number="6535"></td>
        <td id="LC6535">
</td>
      </tr>
      <tr>
        <td id="L6536" data-line-number="6536"></td>
        <td id="LC6536">    <span>if</span> (enclosingClassName != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L6537" data-line-number="6537"></td>
        <td id="LC6537">    {</td>
      </tr>
      <tr>
        <td id="L6538" data-line-number="6538"></td>
        <td id="LC6538">        *enclosingClassName = enclosingResult;</td>
      </tr>
      <tr>
        <td id="L6539" data-line-number="6539"></td>
        <td id="LC6539">    }</td>
      </tr>
      <tr>
        <td id="L6540" data-line-number="6540"></td>
        <td id="LC6540">
</td>
      </tr>
      <tr>
        <td id="L6541" data-line-number="6541"></td>
        <td id="LC6541">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6542" data-line-number="6542"></td>
        <td id="LC6542">
</td>
      </tr>
      <tr>
        <td id="L6543" data-line-number="6543"></td>
        <td id="LC6543">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6544" data-line-number="6544"></td>
        <td id="LC6544">}</td>
      </tr>
      <tr>
        <td id="L6545" data-line-number="6545"></td>
        <td id="LC6545">
</td>
      </tr>
      <tr>
        <td id="L6546" data-line-number="6546"></td>
        <td id="LC6546"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6547" data-line-number="6547"></td>
        <td id="LC6547"><span>const</span> <span>char</span>* <span>CEEInfo::getClassNameFromMetadata</span>(CORINFO_CLASS_HANDLE cls, <span>const</span> <span>char</span>** namespaceName)</td>
      </tr>
      <tr>
        <td id="L6548" data-line-number="6548"></td>
        <td id="LC6548">{</td>
      </tr>
      <tr>
        <td id="L6549" data-line-number="6549"></td>
        <td id="LC6549">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6550" data-line-number="6550"></td>
        <td id="LC6550">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6551" data-line-number="6551"></td>
        <td id="LC6551">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6552" data-line-number="6552"></td>
        <td id="LC6552">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6553" data-line-number="6553"></td>
        <td id="LC6553">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6554" data-line-number="6554"></td>
        <td id="LC6554">
</td>
      </tr>
      <tr>
        <td id="L6555" data-line-number="6555"></td>
        <td id="LC6555">    <span>const</span> <span>char</span>* result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6556" data-line-number="6556"></td>
        <td id="LC6556">    <span>const</span> <span>char</span>* namespaceResult = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6557" data-line-number="6557"></td>
        <td id="LC6557">
</td>
      </tr>
      <tr>
        <td id="L6558" data-line-number="6558"></td>
        <td id="LC6558">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6559" data-line-number="6559"></td>
        <td id="LC6559">    TypeHandle <span>VMClsHnd</span>(cls);</td>
      </tr>
      <tr>
        <td id="L6560" data-line-number="6560"></td>
        <td id="LC6560">
</td>
      </tr>
      <tr>
        <td id="L6561" data-line-number="6561"></td>
        <td id="LC6561">    <span>if</span> (!VMClsHnd.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L6562" data-line-number="6562"></td>
        <td id="LC6562">    {</td>
      </tr>
      <tr>
        <td id="L6563" data-line-number="6563"></td>
        <td id="LC6563">        result = VMClsHnd.<span>AsMethodTable</span>()-&gt;<span>GetFullyQualifiedNameInfo</span>(&amp;namespaceResult);</td>
      </tr>
      <tr>
        <td id="L6564" data-line-number="6564"></td>
        <td id="LC6564">    }</td>
      </tr>
      <tr>
        <td id="L6565" data-line-number="6565"></td>
        <td id="LC6565">
</td>
      </tr>
      <tr>
        <td id="L6566" data-line-number="6566"></td>
        <td id="LC6566">    <span>if</span> (namespaceName != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L6567" data-line-number="6567"></td>
        <td id="LC6567">    {</td>
      </tr>
      <tr>
        <td id="L6568" data-line-number="6568"></td>
        <td id="LC6568">        *namespaceName = namespaceResult;</td>
      </tr>
      <tr>
        <td id="L6569" data-line-number="6569"></td>
        <td id="LC6569">    }</td>
      </tr>
      <tr>
        <td id="L6570" data-line-number="6570"></td>
        <td id="LC6570">
</td>
      </tr>
      <tr>
        <td id="L6571" data-line-number="6571"></td>
        <td id="LC6571">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6572" data-line-number="6572"></td>
        <td id="LC6572">
</td>
      </tr>
      <tr>
        <td id="L6573" data-line-number="6573"></td>
        <td id="LC6573">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6574" data-line-number="6574"></td>
        <td id="LC6574">}</td>
      </tr>
      <tr>
        <td id="L6575" data-line-number="6575"></td>
        <td id="LC6575">
</td>
      </tr>
      <tr>
        <td id="L6576" data-line-number="6576"></td>
        <td id="LC6576"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6577" data-line-number="6577"></td>
        <td id="LC6577">CORINFO_CLASS_HANDLE <span>CEEInfo::getTypeInstantiationArgument</span>(CORINFO_CLASS_HANDLE cls, <span>unsigned</span> <span>index</span>)</td>
      </tr>
      <tr>
        <td id="L6578" data-line-number="6578"></td>
        <td id="LC6578">{</td>
      </tr>
      <tr>
        <td id="L6579" data-line-number="6579"></td>
        <td id="LC6579">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6580" data-line-number="6580"></td>
        <td id="LC6580">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6581" data-line-number="6581"></td>
        <td id="LC6581">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6582" data-line-number="6582"></td>
        <td id="LC6582">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6583" data-line-number="6583"></td>
        <td id="LC6583">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6584" data-line-number="6584"></td>
        <td id="LC6584">
</td>
      </tr>
      <tr>
        <td id="L6585" data-line-number="6585"></td>
        <td id="LC6585">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6586" data-line-number="6586"></td>
        <td id="LC6586">
</td>
      </tr>
      <tr>
        <td id="L6587" data-line-number="6587"></td>
        <td id="LC6587">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L6588" data-line-number="6588"></td>
        <td id="LC6588">
</td>
      </tr>
      <tr>
        <td id="L6589" data-line-number="6589"></td>
        <td id="LC6589">    TypeHandle <span>VMClsHnd</span>(cls);</td>
      </tr>
      <tr>
        <td id="L6590" data-line-number="6590"></td>
        <td id="LC6590">    Instantiation inst = VMClsHnd.<span>GetInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L6591" data-line-number="6591"></td>
        <td id="LC6591">    TypeHandle typeArg = <span>index</span> &lt; inst.<span>GetNumArgs</span>() ? inst[<span>index</span>] : <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L6592" data-line-number="6592"></td>
        <td id="LC6592">    result = <span>CORINFO_CLASS_HANDLE</span>(typeArg.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L6593" data-line-number="6593"></td>
        <td id="LC6593">
</td>
      </tr>
      <tr>
        <td id="L6594" data-line-number="6594"></td>
        <td id="LC6594">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L6595" data-line-number="6595"></td>
        <td id="LC6595">
</td>
      </tr>
      <tr>
        <td id="L6596" data-line-number="6596"></td>
        <td id="LC6596">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6597" data-line-number="6597"></td>
        <td id="LC6597">}</td>
      </tr>
      <tr>
        <td id="L6598" data-line-number="6598"></td>
        <td id="LC6598">
</td>
      </tr>
      <tr>
        <td id="L6599" data-line-number="6599"></td>
        <td id="LC6599"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6600" data-line-number="6600"></td>
        <td id="LC6600">DWORD <span>CEEInfo::getMethodAttribs</span> (CORINFO_METHOD_HANDLE ftn)</td>
      </tr>
      <tr>
        <td id="L6601" data-line-number="6601"></td>
        <td id="LC6601">{</td>
      </tr>
      <tr>
        <td id="L6602" data-line-number="6602"></td>
        <td id="LC6602">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6603" data-line-number="6603"></td>
        <td id="LC6603">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6604" data-line-number="6604"></td>
        <td id="LC6604">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6605" data-line-number="6605"></td>
        <td id="LC6605">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6606" data-line-number="6606"></td>
        <td id="LC6606">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6607" data-line-number="6607"></td>
        <td id="LC6607">
</td>
      </tr>
      <tr>
        <td id="L6608" data-line-number="6608"></td>
        <td id="LC6608">    DWORD result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6609" data-line-number="6609"></td>
        <td id="LC6609">
</td>
      </tr>
      <tr>
        <td id="L6610" data-line-number="6610"></td>
        <td id="LC6610">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6611" data-line-number="6611"></td>
        <td id="LC6611">
</td>
      </tr>
      <tr>
        <td id="L6612" data-line-number="6612"></td>
        <td id="LC6612">    result = <span>getMethodAttribsInternal</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L6613" data-line-number="6613"></td>
        <td id="LC6613">
</td>
      </tr>
      <tr>
        <td id="L6614" data-line-number="6614"></td>
        <td id="LC6614">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6615" data-line-number="6615"></td>
        <td id="LC6615">
</td>
      </tr>
      <tr>
        <td id="L6616" data-line-number="6616"></td>
        <td id="LC6616">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6617" data-line-number="6617"></td>
        <td id="LC6617">}</td>
      </tr>
      <tr>
        <td id="L6618" data-line-number="6618"></td>
        <td id="LC6618">
</td>
      </tr>
      <tr>
        <td id="L6619" data-line-number="6619"></td>
        <td id="LC6619"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6620" data-line-number="6620"></td>
        <td id="LC6620">DWORD <span>CEEInfo::getMethodAttribsInternal</span> (CORINFO_METHOD_HANDLE ftn)</td>
      </tr>
      <tr>
        <td id="L6621" data-line-number="6621"></td>
        <td id="LC6621">{</td>
      </tr>
      <tr>
        <td id="L6622" data-line-number="6622"></td>
        <td id="LC6622">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6623" data-line-number="6623"></td>
        <td id="LC6623">
</td>
      </tr>
      <tr>
        <td id="L6624" data-line-number="6624"></td>
        <td id="LC6624"><span><span>/*</span></span></td>
      </tr>
      <tr>
        <td id="L6625" data-line-number="6625"></td>
        <td id="LC6625"><span>    returns method attribute flags (defined in corhdr.h)</span></td>
      </tr>
      <tr>
        <td id="L6626" data-line-number="6626"></td>
        <td id="LC6626"><span></span></td>
      </tr>
      <tr>
        <td id="L6627" data-line-number="6627"></td>
        <td id="LC6627"><span>    NOTE: This doesn't return certain method flags</span></td>
      </tr>
      <tr>
        <td id="L6628" data-line-number="6628"></td>
        <td id="LC6628"><span>    (mdAssem, mdFamANDAssem, mdFamORAssem, mdPrivateScope)</span></td>
      </tr>
      <tr>
        <td id="L6629" data-line-number="6629"></td>
        <td id="LC6629"><span><span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6630" data-line-number="6630"></td>
        <td id="LC6630">
</td>
      </tr>
      <tr>
        <td id="L6631" data-line-number="6631"></td>
        <td id="LC6631">    MethodDesc* pMD = <span>GetMethod</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L6632" data-line-number="6632"></td>
        <td id="LC6632">
</td>
      </tr>
      <tr>
        <td id="L6633" data-line-number="6633"></td>
        <td id="LC6633">    <span>if</span> (pMD-&gt;<span>IsLCGMethod</span>())</td>
      </tr>
      <tr>
        <td id="L6634" data-line-number="6634"></td>
        <td id="LC6634">    {</td>
      </tr>
      <tr>
        <td id="L6635" data-line-number="6635"></td>
        <td id="LC6635">        <span>return</span> CORINFO_FLG_STATIC | CORINFO_FLG_DONT_INLINE | CORINFO_FLG_NOSECURITYWRAP;</td>
      </tr>
      <tr>
        <td id="L6636" data-line-number="6636"></td>
        <td id="LC6636">    }</td>
      </tr>
      <tr>
        <td id="L6637" data-line-number="6637"></td>
        <td id="LC6637">
</td>
      </tr>
      <tr>
        <td id="L6638" data-line-number="6638"></td>
        <td id="LC6638">    DWORD result = CORINFO_FLG_NOSECURITYWRAP;</td>
      </tr>
      <tr>
        <td id="L6639" data-line-number="6639"></td>
        <td id="LC6639">
</td>
      </tr>
      <tr>
        <td id="L6640" data-line-number="6640"></td>
        <td id="LC6640">    DWORD attribs = pMD-&gt;<span>GetAttrs</span>();</td>
      </tr>
      <tr>
        <td id="L6641" data-line-number="6641"></td>
        <td id="LC6641">
</td>
      </tr>
      <tr>
        <td id="L6642" data-line-number="6642"></td>
        <td id="LC6642">    <span>if</span> (<span>IsMdFamily</span>(attribs))</td>
      </tr>
      <tr>
        <td id="L6643" data-line-number="6643"></td>
        <td id="LC6643">        result |= CORINFO_FLG_PROTECTED;</td>
      </tr>
      <tr>
        <td id="L6644" data-line-number="6644"></td>
        <td id="LC6644">    <span>if</span> (<span>IsMdStatic</span>(attribs))</td>
      </tr>
      <tr>
        <td id="L6645" data-line-number="6645"></td>
        <td id="LC6645">        result |= CORINFO_FLG_STATIC;</td>
      </tr>
      <tr>
        <td id="L6646" data-line-number="6646"></td>
        <td id="LC6646">    <span>if</span> (pMD-&gt;<span>IsSynchronized</span>())</td>
      </tr>
      <tr>
        <td id="L6647" data-line-number="6647"></td>
        <td id="LC6647">        result |= CORINFO_FLG_SYNCH;</td>
      </tr>
      <tr>
        <td id="L6648" data-line-number="6648"></td>
        <td id="LC6648">    <span>if</span> (pMD-&gt;<span>IsFCallOrIntrinsic</span>())</td>
      </tr>
      <tr>
        <td id="L6649" data-line-number="6649"></td>
        <td id="LC6649">        result |= CORINFO_FLG_NOGCCHECK | CORINFO_FLG_INTRINSIC;</td>
      </tr>
      <tr>
        <td id="L6650" data-line-number="6650"></td>
        <td id="LC6650">    <span>if</span> (pMD-&gt;<span>IsJitIntrinsic</span>())</td>
      </tr>
      <tr>
        <td id="L6651" data-line-number="6651"></td>
        <td id="LC6651">        result |= CORINFO_FLG_JIT_INTRINSIC;</td>
      </tr>
      <tr>
        <td id="L6652" data-line-number="6652"></td>
        <td id="LC6652">    <span>if</span> (<span>IsMdVirtual</span>(attribs))</td>
      </tr>
      <tr>
        <td id="L6653" data-line-number="6653"></td>
        <td id="LC6653">        result |= CORINFO_FLG_VIRTUAL;</td>
      </tr>
      <tr>
        <td id="L6654" data-line-number="6654"></td>
        <td id="LC6654">    <span>if</span> (<span>IsMdAbstract</span>(attribs))</td>
      </tr>
      <tr>
        <td id="L6655" data-line-number="6655"></td>
        <td id="LC6655">        result |= CORINFO_FLG_ABSTRACT;</td>
      </tr>
      <tr>
        <td id="L6656" data-line-number="6656"></td>
        <td id="LC6656">    <span>if</span> (<span>IsMdRTSpecialName</span>(attribs))</td>
      </tr>
      <tr>
        <td id="L6657" data-line-number="6657"></td>
        <td id="LC6657">    {</td>
      </tr>
      <tr>
        <td id="L6658" data-line-number="6658"></td>
        <td id="LC6658">        LPCUTF8 pName = pMD-&gt;<span>GetName</span>();</td>
      </tr>
      <tr>
        <td id="L6659" data-line-number="6659"></td>
        <td id="LC6659">        <span>if</span> (<span>IsMdInstanceInitializer</span>(attribs, pName) ||</td>
      </tr>
      <tr>
        <td id="L6660" data-line-number="6660"></td>
        <td id="LC6660">            <span>IsMdClassConstructor</span>(attribs, pName))</td>
      </tr>
      <tr>
        <td id="L6661" data-line-number="6661"></td>
        <td id="LC6661">            result |= CORINFO_FLG_CONSTRUCTOR;</td>
      </tr>
      <tr>
        <td id="L6662" data-line-number="6662"></td>
        <td id="LC6662">    }</td>
      </tr>
      <tr>
        <td id="L6663" data-line-number="6663"></td>
        <td id="LC6663">
</td>
      </tr>
      <tr>
        <td id="L6664" data-line-number="6664"></td>
        <td id="LC6664">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L6665" data-line-number="6665"></td>
        <td id="LC6665">    <span><span>//</span> See if we need to embed a .cctor call at the head of the</span></td>
      </tr>
      <tr>
        <td id="L6666" data-line-number="6666"></td>
        <td id="LC6666">    <span><span>//</span> method body.</span></td>
      </tr>
      <tr>
        <td id="L6667" data-line-number="6667"></td>
        <td id="LC6667">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L6668" data-line-number="6668"></td>
        <td id="LC6668">
</td>
      </tr>
      <tr>
        <td id="L6669" data-line-number="6669"></td>
        <td id="LC6669">    MethodTable* pMT = pMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L6670" data-line-number="6670"></td>
        <td id="LC6670">
</td>
      </tr>
      <tr>
        <td id="L6671" data-line-number="6671"></td>
        <td id="LC6671">    <span><span>//</span> method or class might have the final bit</span></td>
      </tr>
      <tr>
        <td id="L6672" data-line-number="6672"></td>
        <td id="LC6672">    <span>if</span> (<span>IsMdFinal</span>(attribs) || pMT-&gt;<span>IsSealed</span>())</td>
      </tr>
      <tr>
        <td id="L6673" data-line-number="6673"></td>
        <td id="LC6673">    {</td>
      </tr>
      <tr>
        <td id="L6674" data-line-number="6674"></td>
        <td id="LC6674">        result |= CORINFO_FLG_FINAL;</td>
      </tr>
      <tr>
        <td id="L6675" data-line-number="6675"></td>
        <td id="LC6675">    }</td>
      </tr>
      <tr>
        <td id="L6676" data-line-number="6676"></td>
        <td id="LC6676">
</td>
      </tr>
      <tr>
        <td id="L6677" data-line-number="6677"></td>
        <td id="LC6677">    <span>if</span> (pMD-&gt;<span>IsEnCAddedMethod</span>())</td>
      </tr>
      <tr>
        <td id="L6678" data-line-number="6678"></td>
        <td id="LC6678">    {</td>
      </tr>
      <tr>
        <td id="L6679" data-line-number="6679"></td>
        <td id="LC6679">        result |= CORINFO_FLG_EnC;</td>
      </tr>
      <tr>
        <td id="L6680" data-line-number="6680"></td>
        <td id="LC6680">    }</td>
      </tr>
      <tr>
        <td id="L6681" data-line-number="6681"></td>
        <td id="LC6681">
</td>
      </tr>
      <tr>
        <td id="L6682" data-line-number="6682"></td>
        <td id="LC6682">    <span>if</span> (pMD-&gt;<span>IsSharedByGenericInstantiations</span>())</td>
      </tr>
      <tr>
        <td id="L6683" data-line-number="6683"></td>
        <td id="LC6683">    {</td>
      </tr>
      <tr>
        <td id="L6684" data-line-number="6684"></td>
        <td id="LC6684">        result |= CORINFO_FLG_SHAREDINST;</td>
      </tr>
      <tr>
        <td id="L6685" data-line-number="6685"></td>
        <td id="LC6685">    }</td>
      </tr>
      <tr>
        <td id="L6686" data-line-number="6686"></td>
        <td id="LC6686">
</td>
      </tr>
      <tr>
        <td id="L6687" data-line-number="6687"></td>
        <td id="LC6687">    <span>if</span> (pMD-&gt;<span>IsNDirect</span>())</td>
      </tr>
      <tr>
        <td id="L6688" data-line-number="6688"></td>
        <td id="LC6688">    {</td>
      </tr>
      <tr>
        <td id="L6689" data-line-number="6689"></td>
        <td id="LC6689">        result |= CORINFO_FLG_PINVOKE;</td>
      </tr>
      <tr>
        <td id="L6690" data-line-number="6690"></td>
        <td id="LC6690">    }</td>
      </tr>
      <tr>
        <td id="L6691" data-line-number="6691"></td>
        <td id="LC6691">
</td>
      </tr>
      <tr>
        <td id="L6692" data-line-number="6692"></td>
        <td id="LC6692">    <span>if</span> (<span>IsMdRequireSecObject</span>(attribs))</td>
      </tr>
      <tr>
        <td id="L6693" data-line-number="6693"></td>
        <td id="LC6693">    {</td>
      </tr>
      <tr>
        <td id="L6694" data-line-number="6694"></td>
        <td id="LC6694">        <span><span>//</span> Assume all methods marked as DynamicSecurity are</span></td>
      </tr>
      <tr>
        <td id="L6695" data-line-number="6695"></td>
        <td id="LC6695">        <span><span>//</span> marked that way because they use StackCrawlMark to identify</span></td>
      </tr>
      <tr>
        <td id="L6696" data-line-number="6696"></td>
        <td id="LC6696">        <span><span>//</span> the caller.</span></td>
      </tr>
      <tr>
        <td id="L6697" data-line-number="6697"></td>
        <td id="LC6697">        <span><span>//</span> See comments in canInline or canTailCall</span></td>
      </tr>
      <tr>
        <td id="L6698" data-line-number="6698"></td>
        <td id="LC6698">        result |= CORINFO_FLG_DONT_INLINE_CALLER;</td>
      </tr>
      <tr>
        <td id="L6699" data-line-number="6699"></td>
        <td id="LC6699">    }</td>
      </tr>
      <tr>
        <td id="L6700" data-line-number="6700"></td>
        <td id="LC6700">
</td>
      </tr>
      <tr>
        <td id="L6701" data-line-number="6701"></td>
        <td id="LC6701">    <span><span>//</span> Check for the aggressive optimization directive. AggressiveOptimization only makes sense for IL methods.</span></td>
      </tr>
      <tr>
        <td id="L6702" data-line-number="6702"></td>
        <td id="LC6702">    DWORD ilMethodImplAttribs = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6703" data-line-number="6703"></td>
        <td id="LC6703">    <span>if</span> (pMD-&gt;<span>IsIL</span>())</td>
      </tr>
      <tr>
        <td id="L6704" data-line-number="6704"></td>
        <td id="LC6704">    {</td>
      </tr>
      <tr>
        <td id="L6705" data-line-number="6705"></td>
        <td id="LC6705">        ilMethodImplAttribs = pMD-&gt;<span>GetImplAttrs</span>();</td>
      </tr>
      <tr>
        <td id="L6706" data-line-number="6706"></td>
        <td id="LC6706">        <span>if</span> (<span>IsMiAggressiveOptimization</span>(ilMethodImplAttribs))</td>
      </tr>
      <tr>
        <td id="L6707" data-line-number="6707"></td>
        <td id="LC6707">        {</td>
      </tr>
      <tr>
        <td id="L6708" data-line-number="6708"></td>
        <td id="LC6708">            result |= CORINFO_FLG_AGGRESSIVE_OPT;</td>
      </tr>
      <tr>
        <td id="L6709" data-line-number="6709"></td>
        <td id="LC6709">        }</td>
      </tr>
      <tr>
        <td id="L6710" data-line-number="6710"></td>
        <td id="LC6710">    }</td>
      </tr>
      <tr>
        <td id="L6711" data-line-number="6711"></td>
        <td id="LC6711">
</td>
      </tr>
      <tr>
        <td id="L6712" data-line-number="6712"></td>
        <td id="LC6712">    <span><span>//</span> Check for an inlining directive.</span></td>
      </tr>
      <tr>
        <td id="L6713" data-line-number="6713"></td>
        <td id="LC6713">    <span>if</span> (pMD-&gt;<span>IsNotInline</span>())</td>
      </tr>
      <tr>
        <td id="L6714" data-line-number="6714"></td>
        <td id="LC6714">    {</td>
      </tr>
      <tr>
        <td id="L6715" data-line-number="6715"></td>
        <td id="LC6715">        <span><span>/*</span> Function marked as not inlineable <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6716" data-line-number="6716"></td>
        <td id="LC6716">        result |= CORINFO_FLG_DONT_INLINE;</td>
      </tr>
      <tr>
        <td id="L6717" data-line-number="6717"></td>
        <td id="LC6717">    }</td>
      </tr>
      <tr>
        <td id="L6718" data-line-number="6718"></td>
        <td id="LC6718">    <span><span>//</span> AggressiveInlining only makes sense for IL methods.</span></td>
      </tr>
      <tr>
        <td id="L6719" data-line-number="6719"></td>
        <td id="LC6719">    <span>else</span> <span>if</span> (pMD-&gt;<span>IsIL</span>() &amp;&amp; <span>IsMiAggressiveInlining</span>(ilMethodImplAttribs))</td>
      </tr>
      <tr>
        <td id="L6720" data-line-number="6720"></td>
        <td id="LC6720">    {</td>
      </tr>
      <tr>
        <td id="L6721" data-line-number="6721"></td>
        <td id="LC6721">        result |= CORINFO_FLG_FORCEINLINE;</td>
      </tr>
      <tr>
        <td id="L6722" data-line-number="6722"></td>
        <td id="LC6722">    }</td>
      </tr>
      <tr>
        <td id="L6723" data-line-number="6723"></td>
        <td id="LC6723">
</td>
      </tr>
      <tr>
        <td id="L6724" data-line-number="6724"></td>
        <td id="LC6724">    <span>if</span> (pMT-&gt;<span>IsDelegate</span>() &amp;&amp; ((DelegateEEClass*)(pMT-&gt;<span>GetClass</span>()))-&gt;<span>GetInvokeMethod</span>() == pMD)</td>
      </tr>
      <tr>
        <td id="L6725" data-line-number="6725"></td>
        <td id="LC6725">    {</td>
      </tr>
      <tr>
        <td id="L6726" data-line-number="6726"></td>
        <td id="LC6726">        <span><span>//</span> This is now used to emit efficient invoke code for any delegate invoke,</span></td>
      </tr>
      <tr>
        <td id="L6727" data-line-number="6727"></td>
        <td id="LC6727">        <span><span>//</span> including multicast.</span></td>
      </tr>
      <tr>
        <td id="L6728" data-line-number="6728"></td>
        <td id="LC6728">        result |= CORINFO_FLG_DELEGATE_INVOKE;</td>
      </tr>
      <tr>
        <td id="L6729" data-line-number="6729"></td>
        <td id="LC6729">    }</td>
      </tr>
      <tr>
        <td id="L6730" data-line-number="6730"></td>
        <td id="LC6730">
</td>
      </tr>
      <tr>
        <td id="L6731" data-line-number="6731"></td>
        <td id="LC6731">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L6732" data-line-number="6732"></td>
        <td id="LC6732">    <span>if</span> (!g_pConfig-&gt;<span>TieredCompilation_QuickJitForLoops</span>())</td>
      </tr>
      <tr>
        <td id="L6733" data-line-number="6733"></td>
        <td id="LC6733">    {</td>
      </tr>
      <tr>
        <td id="L6734" data-line-number="6734"></td>
        <td id="LC6734">        result |= CORINFO_FLG_DISABLE_TIER0_FOR_LOOPS;</td>
      </tr>
      <tr>
        <td id="L6735" data-line-number="6735"></td>
        <td id="LC6735">    }</td>
      </tr>
      <tr>
        <td id="L6736" data-line-number="6736"></td>
        <td id="LC6736">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L6737" data-line-number="6737"></td>
        <td id="LC6737">
</td>
      </tr>
      <tr>
        <td id="L6738" data-line-number="6738"></td>
        <td id="LC6738">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L6739" data-line-number="6739"></td>
        <td id="LC6739">}</td>
      </tr>
      <tr>
        <td id="L6740" data-line-number="6740"></td>
        <td id="LC6740">
</td>
      </tr>
      <tr>
        <td id="L6741" data-line-number="6741"></td>
        <td id="LC6741"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6742" data-line-number="6742"></td>
        <td id="LC6742"><span>void</span> <span>CEEInfo::setMethodAttribs</span> (</td>
      </tr>
      <tr>
        <td id="L6743" data-line-number="6743"></td>
        <td id="LC6743">        CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L6744" data-line-number="6744"></td>
        <td id="LC6744">        CorInfoMethodRuntimeFlags attribs)</td>
      </tr>
      <tr>
        <td id="L6745" data-line-number="6745"></td>
        <td id="LC6745">{</td>
      </tr>
      <tr>
        <td id="L6746" data-line-number="6746"></td>
        <td id="LC6746">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L6747" data-line-number="6747"></td>
        <td id="LC6747">        THROWS;</td>
      </tr>
      <tr>
        <td id="L6748" data-line-number="6748"></td>
        <td id="LC6748">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L6749" data-line-number="6749"></td>
        <td id="LC6749">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L6750" data-line-number="6750"></td>
        <td id="LC6750">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L6751" data-line-number="6751"></td>
        <td id="LC6751">
</td>
      </tr>
      <tr>
        <td id="L6752" data-line-number="6752"></td>
        <td id="LC6752">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6753" data-line-number="6753"></td>
        <td id="LC6753">
</td>
      </tr>
      <tr>
        <td id="L6754" data-line-number="6754"></td>
        <td id="LC6754">    MethodDesc* ftn = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L6755" data-line-number="6755"></td>
        <td id="LC6755">
</td>
      </tr>
      <tr>
        <td id="L6756" data-line-number="6756"></td>
        <td id="LC6756">    <span>if</span> (attribs &amp; CORINFO_FLG_BAD_INLINEE)</td>
      </tr>
      <tr>
        <td id="L6757" data-line-number="6757"></td>
        <td id="LC6757">    {</td>
      </tr>
      <tr>
        <td id="L6758" data-line-number="6758"></td>
        <td id="LC6758">        BOOL <span>fCacheInliningHint</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L6759" data-line-number="6759"></td>
        <td id="LC6759">
</td>
      </tr>
      <tr>
        <td id="L6760" data-line-number="6760"></td>
        <td id="LC6760">#<span>ifdef</span> FEATURE_NATIVE_IMAGE_GENERATION</td>
      </tr>
      <tr>
        <td id="L6761" data-line-number="6761"></td>
        <td id="LC6761">        <span>if</span> (<span>IsCompilationProcess</span>())</td>
      </tr>
      <tr>
        <td id="L6762" data-line-number="6762"></td>
        <td id="LC6762">        {</td>
      </tr>
      <tr>
        <td id="L6763" data-line-number="6763"></td>
        <td id="LC6763">            <span><span>//</span> Since we are running managed code during NGen the inlining hint may be</span></td>
      </tr>
      <tr>
        <td id="L6764" data-line-number="6764"></td>
        <td id="LC6764">            <span><span>//</span> changing underneeth us as the code is JITed. We need to prevent the inlining</span></td>
      </tr>
      <tr>
        <td id="L6765" data-line-number="6765"></td>
        <td id="LC6765">            <span><span>//</span> hints from changing once we start to use them to place IL in the image.</span></td>
      </tr>
      <tr>
        <td id="L6766" data-line-number="6766"></td>
        <td id="LC6766">            <span>if</span> (!g_pCEECompileInfo-&gt;<span>IsCachingOfInliningHintsEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L6767" data-line-number="6767"></td>
        <td id="LC6767">            {</td>
      </tr>
      <tr>
        <td id="L6768" data-line-number="6768"></td>
        <td id="LC6768">                <span>fCacheInliningHint</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L6769" data-line-number="6769"></td>
        <td id="LC6769">            }</td>
      </tr>
      <tr>
        <td id="L6770" data-line-number="6770"></td>
        <td id="LC6770">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L6771" data-line-number="6771"></td>
        <td id="LC6771">            {</td>
      </tr>
      <tr>
        <td id="L6772" data-line-number="6772"></td>
        <td id="LC6772">                <span><span>//</span> Don't cache inlining hints inside mscorlib during NGen of other assemblies,</span></td>
      </tr>
      <tr>
        <td id="L6773" data-line-number="6773"></td>
        <td id="LC6773">                <span><span>//</span> since mscorlib is loaded domain neutral and will survive worker process recycling,</span></td>
      </tr>
      <tr>
        <td id="L6774" data-line-number="6774"></td>
        <td id="LC6774">                <span><span>//</span> causing determinism problems.</span></td>
      </tr>
      <tr>
        <td id="L6775" data-line-number="6775"></td>
        <td id="LC6775">                Module * pModule = ftn-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L6776" data-line-number="6776"></td>
        <td id="LC6776">                <span>if</span> (pModule-&gt;<span>IsSystem</span>() &amp;&amp; pModule-&gt;<span>HasNativeImage</span>())</td>
      </tr>
      <tr>
        <td id="L6777" data-line-number="6777"></td>
        <td id="LC6777">                {</td>
      </tr>
      <tr>
        <td id="L6778" data-line-number="6778"></td>
        <td id="LC6778">                    <span>fCacheInliningHint</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L6779" data-line-number="6779"></td>
        <td id="LC6779">                }</td>
      </tr>
      <tr>
        <td id="L6780" data-line-number="6780"></td>
        <td id="LC6780">            }</td>
      </tr>
      <tr>
        <td id="L6781" data-line-number="6781"></td>
        <td id="LC6781">        }</td>
      </tr>
      <tr>
        <td id="L6782" data-line-number="6782"></td>
        <td id="LC6782">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L6783" data-line-number="6783"></td>
        <td id="LC6783">
</td>
      </tr>
      <tr>
        <td id="L6784" data-line-number="6784"></td>
        <td id="LC6784">        <span>if</span> (<span>fCacheInliningHint</span>)</td>
      </tr>
      <tr>
        <td id="L6785" data-line-number="6785"></td>
        <td id="LC6785">        {</td>
      </tr>
      <tr>
        <td id="L6786" data-line-number="6786"></td>
        <td id="LC6786">            ftn-&gt;<span>SetNotInline</span>(<span>true</span>);</td>
      </tr>
      <tr>
        <td id="L6787" data-line-number="6787"></td>
        <td id="LC6787">        }</td>
      </tr>
      <tr>
        <td id="L6788" data-line-number="6788"></td>
        <td id="LC6788">    }</td>
      </tr>
      <tr>
        <td id="L6789" data-line-number="6789"></td>
        <td id="LC6789">
</td>
      </tr>
      <tr>
        <td id="L6790" data-line-number="6790"></td>
        <td id="LC6790">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L6791" data-line-number="6791"></td>
        <td id="LC6791">    <span>if</span> (attribs &amp; (CORINFO_FLG_SWITCHED_TO_OPTIMIZED | CORINFO_FLG_SWITCHED_TO_MIN_OPT))</td>
      </tr>
      <tr>
        <td id="L6792" data-line-number="6792"></td>
        <td id="LC6792">    {</td>
      </tr>
      <tr>
        <td id="L6793" data-line-number="6793"></td>
        <td id="LC6793">        PrepareCodeConfig *config = <span>GetThread</span>()-&gt;<span>GetCurrentPrepareCodeConfig</span>();</td>
      </tr>
      <tr>
        <td id="L6794" data-line-number="6794"></td>
        <td id="LC6794">        <span>if</span> (config != <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L6795" data-line-number="6795"></td>
        <td id="LC6795">        {</td>
      </tr>
      <tr>
        <td id="L6796" data-line-number="6796"></td>
        <td id="LC6796">            <span>if</span> (attribs &amp; CORINFO_FLG_SWITCHED_TO_MIN_OPT)</td>
      </tr>
      <tr>
        <td id="L6797" data-line-number="6797"></td>
        <td id="LC6797">            {</td>
      </tr>
      <tr>
        <td id="L6798" data-line-number="6798"></td>
        <td id="LC6798">                <span>_ASSERTE</span>(!ftn-&gt;<span>IsJitOptimizationDisabled</span>());</td>
      </tr>
      <tr>
        <td id="L6799" data-line-number="6799"></td>
        <td id="LC6799">                config-&gt;<span>SetJitSwitchedToMinOpt</span>();</td>
      </tr>
      <tr>
        <td id="L6800" data-line-number="6800"></td>
        <td id="LC6800">            }</td>
      </tr>
      <tr>
        <td id="L6801" data-line-number="6801"></td>
        <td id="LC6801">#<span>ifdef</span> FEATURE_TIERED_COMPILATION</td>
      </tr>
      <tr>
        <td id="L6802" data-line-number="6802"></td>
        <td id="LC6802">            <span>else</span> <span>if</span> (attribs &amp; CORINFO_FLG_SWITCHED_TO_OPTIMIZED)</td>
      </tr>
      <tr>
        <td id="L6803" data-line-number="6803"></td>
        <td id="LC6803">            {</td>
      </tr>
      <tr>
        <td id="L6804" data-line-number="6804"></td>
        <td id="LC6804">                <span>_ASSERTE</span>(ftn-&gt;<span>IsEligibleForTieredCompilation</span>());</td>
      </tr>
      <tr>
        <td id="L6805" data-line-number="6805"></td>
        <td id="LC6805">                config-&gt;<span>SetJitSwitchedToOptimized</span>();</td>
      </tr>
      <tr>
        <td id="L6806" data-line-number="6806"></td>
        <td id="LC6806">            }</td>
      </tr>
      <tr>
        <td id="L6807" data-line-number="6807"></td>
        <td id="LC6807">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L6808" data-line-number="6808"></td>
        <td id="LC6808">        }</td>
      </tr>
      <tr>
        <td id="L6809" data-line-number="6809"></td>
        <td id="LC6809">    }</td>
      </tr>
      <tr>
        <td id="L6810" data-line-number="6810"></td>
        <td id="LC6810">#<span>endif</span> <span><span>//</span> !CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L6811" data-line-number="6811"></td>
        <td id="LC6811">
</td>
      </tr>
      <tr>
        <td id="L6812" data-line-number="6812"></td>
        <td id="LC6812">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L6813" data-line-number="6813"></td>
        <td id="LC6813">}</td>
      </tr>
      <tr>
        <td id="L6814" data-line-number="6814"></td>
        <td id="LC6814">
</td>
      </tr>
      <tr>
        <td id="L6815" data-line-number="6815"></td>
        <td id="LC6815"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6816" data-line-number="6816"></td>
        <td id="LC6816">
</td>
      </tr>
      <tr>
        <td id="L6817" data-line-number="6817"></td>
        <td id="LC6817"><span>void</span> <span>getMethodInfoILMethodHeaderHelper</span>(</td>
      </tr>
      <tr>
        <td id="L6818" data-line-number="6818"></td>
        <td id="LC6818">    COR_ILMETHOD_DECODER* header,</td>
      </tr>
      <tr>
        <td id="L6819" data-line-number="6819"></td>
        <td id="LC6819">    CORINFO_METHOD_INFO* methInfo</td>
      </tr>
      <tr>
        <td id="L6820" data-line-number="6820"></td>
        <td id="LC6820">    )</td>
      </tr>
      <tr>
        <td id="L6821" data-line-number="6821"></td>
        <td id="LC6821">{</td>
      </tr>
      <tr>
        <td id="L6822" data-line-number="6822"></td>
        <td id="LC6822">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6823" data-line-number="6823"></td>
        <td id="LC6823">
</td>
      </tr>
      <tr>
        <td id="L6824" data-line-number="6824"></td>
        <td id="LC6824">    methInfo-&gt;<span>ILCode</span>          = <span>const_cast</span>&lt;BYTE*&gt;(header-&gt;<span>Code</span>);</td>
      </tr>
      <tr>
        <td id="L6825" data-line-number="6825"></td>
        <td id="LC6825">    methInfo-&gt;<span>ILCodeSize</span>      = header-&gt;<span>GetCodeSize</span>();</td>
      </tr>
      <tr>
        <td id="L6826" data-line-number="6826"></td>
        <td id="LC6826">    methInfo-&gt;<span>maxStack</span>        = <span>static_cast</span>&lt;<span>unsigned</span> <span>short</span>&gt;(header-&gt;<span>GetMaxStack</span>());</td>
      </tr>
      <tr>
        <td id="L6827" data-line-number="6827"></td>
        <td id="LC6827">    methInfo-&gt;<span>EHcount</span>         = <span>static_cast</span>&lt;<span>unsigned</span> <span>short</span>&gt;(header-&gt;<span>EHCount</span>());</td>
      </tr>
      <tr>
        <td id="L6828" data-line-number="6828"></td>
        <td id="LC6828">
</td>
      </tr>
      <tr>
        <td id="L6829" data-line-number="6829"></td>
        <td id="LC6829">    methInfo-&gt;<span>options</span>         =</td>
      </tr>
      <tr>
        <td id="L6830" data-line-number="6830"></td>
        <td id="LC6830">        (CorInfoOptions)((header-&gt;<span>GetFlags</span>() &amp; CorILMethod_InitLocals) ? CORINFO_OPT_INIT_LOCALS : <span>0</span>) ;</td>
      </tr>
      <tr>
        <td id="L6831" data-line-number="6831"></td>
        <td id="LC6831">}</td>
      </tr>
      <tr>
        <td id="L6832" data-line-number="6832"></td>
        <td id="LC6832">
</td>
      </tr>
      <tr>
        <td id="L6833" data-line-number="6833"></td>
        <td id="LC6833">mdToken <span>FindGenericMethodArgTypeSpec</span>(IMDInternalImport* pInternalImport)</td>
      </tr>
      <tr>
        <td id="L6834" data-line-number="6834"></td>
        <td id="LC6834">{</td>
      </tr>
      <tr>
        <td id="L6835" data-line-number="6835"></td>
        <td id="LC6835">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6836" data-line-number="6836"></td>
        <td id="LC6836">
</td>
      </tr>
      <tr>
        <td id="L6837" data-line-number="6837"></td>
        <td id="LC6837">    HENUMInternalHolder <span>hEnumTypeSpecs</span>(pInternalImport);</td>
      </tr>
      <tr>
        <td id="L6838" data-line-number="6838"></td>
        <td id="LC6838">    mdToken token;</td>
      </tr>
      <tr>
        <td id="L6839" data-line-number="6839"></td>
        <td id="LC6839">
</td>
      </tr>
      <tr>
        <td id="L6840" data-line-number="6840"></td>
        <td id="LC6840">    <span>static</span> <span>const</span> BYTE signature[] = { ELEMENT_TYPE_MVAR, <span>0</span> };</td>
      </tr>
      <tr>
        <td id="L6841" data-line-number="6841"></td>
        <td id="LC6841">
</td>
      </tr>
      <tr>
        <td id="L6842" data-line-number="6842"></td>
        <td id="LC6842">    hEnumTypeSpecs.<span>EnumAllInit</span>(mdtTypeSpec);</td>
      </tr>
      <tr>
        <td id="L6843" data-line-number="6843"></td>
        <td id="LC6843">    <span>while</span> (hEnumTypeSpecs.<span>EnumNext</span>(&amp;token))</td>
      </tr>
      <tr>
        <td id="L6844" data-line-number="6844"></td>
        <td id="LC6844">    {</td>
      </tr>
      <tr>
        <td id="L6845" data-line-number="6845"></td>
        <td id="LC6845">        PCCOR_SIGNATURE pSig;</td>
      </tr>
      <tr>
        <td id="L6846" data-line-number="6846"></td>
        <td id="LC6846">        ULONG cbSig;</td>
      </tr>
      <tr>
        <td id="L6847" data-line-number="6847"></td>
        <td id="LC6847">        <span>IfFailThrow</span>(pInternalImport-&gt;<span>GetTypeSpecFromToken</span>(token, &amp;pSig, &amp;cbSig));</td>
      </tr>
      <tr>
        <td id="L6848" data-line-number="6848"></td>
        <td id="LC6848">        <span>if</span> (cbSig == <span>sizeof</span>(signature) &amp;&amp; <span>memcmp</span>(pSig, signature, cbSig) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L6849" data-line-number="6849"></td>
        <td id="LC6849">            <span>return</span> token;</td>
      </tr>
      <tr>
        <td id="L6850" data-line-number="6850"></td>
        <td id="LC6850">    }</td>
      </tr>
      <tr>
        <td id="L6851" data-line-number="6851"></td>
        <td id="LC6851">
</td>
      </tr>
      <tr>
        <td id="L6852" data-line-number="6852"></td>
        <td id="LC6852">    <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L6853" data-line-number="6853"></td>
        <td id="LC6853">}</td>
      </tr>
      <tr>
        <td id="L6854" data-line-number="6854"></td>
        <td id="LC6854">
</td>
      </tr>
      <tr>
        <td id="L6855" data-line-number="6855"></td>
        <td id="LC6855"><span><span>/*</span>********************************************************************</span></td>
      </tr>
      <tr>
        <td id="L6856" data-line-number="6856"></td>
        <td id="LC6856"><span></span></td>
      </tr>
      <tr>
        <td id="L6857" data-line-number="6857"></td>
        <td id="LC6857"><span>IL is the most efficient and portable way to implement certain low level methods</span></td>
      </tr>
      <tr>
        <td id="L6858" data-line-number="6858"></td>
        <td id="LC6858"><span>in mscorlib.dll. Unfortunately, there is no good way to link IL into mscorlib.dll today.</span></td>
      </tr>
      <tr>
        <td id="L6859" data-line-number="6859"></td>
        <td id="LC6859"><span>Until we find a good way to link IL into mscorlib.dll, we will provide the IL implementation here.</span></td>
      </tr>
      <tr>
        <td id="L6860" data-line-number="6860"></td>
        <td id="LC6860"><span></span></td>
      </tr>
      <tr>
        <td id="L6861" data-line-number="6861"></td>
        <td id="LC6861"><span>- All IL intrinsincs are members of System.Runtime.CompilerServices.JitHelpers class</span></td>
      </tr>
      <tr>
        <td id="L6862" data-line-number="6862"></td>
        <td id="LC6862"><span>- All IL intrinsincs should be kept very simple. Implement the minimal reusable version of</span></td>
      </tr>
      <tr>
        <td id="L6863" data-line-number="6863"></td>
        <td id="LC6863"><span>unsafe construct and depend on inlining to do the rest.</span></td>
      </tr>
      <tr>
        <td id="L6864" data-line-number="6864"></td>
        <td id="LC6864"><span>- The C# implementation of the IL intrinsic should be good enough for functionalily. Everything should work</span></td>
      </tr>
      <tr>
        <td id="L6865" data-line-number="6865"></td>
        <td id="LC6865"><span>correctly (but slower) if the IL intrinsics are removed.</span></td>
      </tr>
      <tr>
        <td id="L6866" data-line-number="6866"></td>
        <td id="LC6866"><span></span></td>
      </tr>
      <tr>
        <td id="L6867" data-line-number="6867"></td>
        <td id="LC6867"><span>********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L6868" data-line-number="6868"></td>
        <td id="LC6868">
</td>
      </tr>
      <tr>
        <td id="L6869" data-line-number="6869"></td>
        <td id="LC6869"><span>bool</span> <span>getILIntrinsicImplementationForUnsafe</span>(MethodDesc * ftn,</td>
      </tr>
      <tr>
        <td id="L6870" data-line-number="6870"></td>
        <td id="LC6870">                                           CORINFO_METHOD_INFO * methInfo)</td>
      </tr>
      <tr>
        <td id="L6871" data-line-number="6871"></td>
        <td id="LC6871">{</td>
      </tr>
      <tr>
        <td id="L6872" data-line-number="6872"></td>
        <td id="LC6872">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L6873" data-line-number="6873"></td>
        <td id="LC6873">
</td>
      </tr>
      <tr>
        <td id="L6874" data-line-number="6874"></td>
        <td id="LC6874">    <span>_ASSERTE</span>(<span>MscorlibBinder::IsClass</span>(ftn-&gt;<span>GetMethodTable</span>(), CLASS__UNSAFE));</td>
      </tr>
      <tr>
        <td id="L6875" data-line-number="6875"></td>
        <td id="LC6875">
</td>
      </tr>
      <tr>
        <td id="L6876" data-line-number="6876"></td>
        <td id="LC6876">    mdMethodDef tk = ftn-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L6877" data-line-number="6877"></td>
        <td id="LC6877">
</td>
      </tr>
      <tr>
        <td id="L6878" data-line-number="6878"></td>
        <td id="LC6878">    <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__AS_POINTER)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6879" data-line-number="6879"></td>
        <td id="LC6879">    {</td>
      </tr>
      <tr>
        <td id="L6880" data-line-number="6880"></td>
        <td id="LC6880">        <span><span>//</span> Return the argument that was passed in.</span></td>
      </tr>
      <tr>
        <td id="L6881" data-line-number="6881"></td>
        <td id="LC6881">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_CONV_U, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6882" data-line-number="6882"></td>
        <td id="LC6882">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L6883" data-line-number="6883"></td>
        <td id="LC6883">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L6884" data-line-number="6884"></td>
        <td id="LC6884">        methInfo-&gt;<span>maxStack</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L6885" data-line-number="6885"></td>
        <td id="LC6885">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6886" data-line-number="6886"></td>
        <td id="LC6886">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6887" data-line-number="6887"></td>
        <td id="LC6887">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6888" data-line-number="6888"></td>
        <td id="LC6888">    }</td>
      </tr>
      <tr>
        <td id="L6889" data-line-number="6889"></td>
        <td id="LC6889">    <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__SIZEOF)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6890" data-line-number="6890"></td>
        <td id="LC6890">    {</td>
      </tr>
      <tr>
        <td id="L6891" data-line-number="6891"></td>
        <td id="LC6891">        <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L6892" data-line-number="6892"></td>
        <td id="LC6892">        Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L6893" data-line-number="6893"></td>
        <td id="LC6893">
</td>
      </tr>
      <tr>
        <td id="L6894" data-line-number="6894"></td>
        <td id="LC6894">        <span>_ASSERTE</span>(ftn-&gt;<span>GetNumGenericMethodArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L6895" data-line-number="6895"></td>
        <td id="LC6895">        mdToken tokGenericArg = <span>FindGenericMethodArgTypeSpec</span>(<span>MscorlibBinder::GetModule</span>()-&gt;<span>GetMDImport</span>());</td>
      </tr>
      <tr>
        <td id="L6896" data-line-number="6896"></td>
        <td id="LC6896">
</td>
      </tr>
      <tr>
        <td id="L6897" data-line-number="6897"></td>
        <td id="LC6897">        <span>static</span> BYTE ilcode[] = { CEE_PREFIX1, (CEE_SIZEOF &amp; <span>0xFF</span>), <span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6898" data-line-number="6898"></td>
        <td id="LC6898">
</td>
      </tr>
      <tr>
        <td id="L6899" data-line-number="6899"></td>
        <td id="LC6899">        ilcode[<span>2</span>] = (BYTE)(tokGenericArg);</td>
      </tr>
      <tr>
        <td id="L6900" data-line-number="6900"></td>
        <td id="LC6900">        ilcode[<span>3</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>8</span>);</td>
      </tr>
      <tr>
        <td id="L6901" data-line-number="6901"></td>
        <td id="LC6901">        ilcode[<span>4</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L6902" data-line-number="6902"></td>
        <td id="LC6902">        ilcode[<span>5</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>24</span>);</td>
      </tr>
      <tr>
        <td id="L6903" data-line-number="6903"></td>
        <td id="LC6903">
</td>
      </tr>
      <tr>
        <td id="L6904" data-line-number="6904"></td>
        <td id="LC6904">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L6905" data-line-number="6905"></td>
        <td id="LC6905">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L6906" data-line-number="6906"></td>
        <td id="LC6906">        methInfo-&gt;<span>maxStack</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L6907" data-line-number="6907"></td>
        <td id="LC6907">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6908" data-line-number="6908"></td>
        <td id="LC6908">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6909" data-line-number="6909"></td>
        <td id="LC6909">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6910" data-line-number="6910"></td>
        <td id="LC6910">    }</td>
      </tr>
      <tr>
        <td id="L6911" data-line-number="6911"></td>
        <td id="LC6911">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_AS)-&gt;<span>GetMemberDef</span>() ||</td>
      </tr>
      <tr>
        <td id="L6912" data-line-number="6912"></td>
        <td id="LC6912">             tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__OBJECT_AS)-&gt;<span>GetMemberDef</span>() ||</td>
      </tr>
      <tr>
        <td id="L6913" data-line-number="6913"></td>
        <td id="LC6913">             tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__AS_REF_POINTER)-&gt;<span>GetMemberDef</span>() ||</td>
      </tr>
      <tr>
        <td id="L6914" data-line-number="6914"></td>
        <td id="LC6914">             tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__AS_REF_IN)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6915" data-line-number="6915"></td>
        <td id="LC6915">    {</td>
      </tr>
      <tr>
        <td id="L6916" data-line-number="6916"></td>
        <td id="LC6916">        <span><span>//</span> Return the argument that was passed in.</span></td>
      </tr>
      <tr>
        <td id="L6917" data-line-number="6917"></td>
        <td id="LC6917">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6918" data-line-number="6918"></td>
        <td id="LC6918">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L6919" data-line-number="6919"></td>
        <td id="LC6919">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L6920" data-line-number="6920"></td>
        <td id="LC6920">        methInfo-&gt;<span>maxStack</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L6921" data-line-number="6921"></td>
        <td id="LC6921">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6922" data-line-number="6922"></td>
        <td id="LC6922">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6923" data-line-number="6923"></td>
        <td id="LC6923">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6924" data-line-number="6924"></td>
        <td id="LC6924">    }</td>
      </tr>
      <tr>
        <td id="L6925" data-line-number="6925"></td>
        <td id="LC6925">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_ADD)-&gt;<span>GetMemberDef</span>() ||</td>
      </tr>
      <tr>
        <td id="L6926" data-line-number="6926"></td>
        <td id="LC6926">             tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__PTR_ADD)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6927" data-line-number="6927"></td>
        <td id="LC6927">    {</td>
      </tr>
      <tr>
        <td id="L6928" data-line-number="6928"></td>
        <td id="LC6928">        mdToken tokGenericArg = <span>FindGenericMethodArgTypeSpec</span>(<span>MscorlibBinder::GetModule</span>()-&gt;<span>GetMDImport</span>());</td>
      </tr>
      <tr>
        <td id="L6929" data-line-number="6929"></td>
        <td id="LC6929">
</td>
      </tr>
      <tr>
        <td id="L6930" data-line-number="6930"></td>
        <td id="LC6930">        <span>static</span> BYTE ilcode[] = { CEE_LDARG_1,</td>
      </tr>
      <tr>
        <td id="L6931" data-line-number="6931"></td>
        <td id="LC6931">            CEE_PREFIX1, (CEE_SIZEOF &amp; <span>0xFF</span>), <span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>,</td>
      </tr>
      <tr>
        <td id="L6932" data-line-number="6932"></td>
        <td id="LC6932">            CEE_CONV_I,</td>
      </tr>
      <tr>
        <td id="L6933" data-line-number="6933"></td>
        <td id="LC6933">            CEE_MUL,</td>
      </tr>
      <tr>
        <td id="L6934" data-line-number="6934"></td>
        <td id="LC6934">            CEE_LDARG_0,</td>
      </tr>
      <tr>
        <td id="L6935" data-line-number="6935"></td>
        <td id="LC6935">            CEE_ADD,</td>
      </tr>
      <tr>
        <td id="L6936" data-line-number="6936"></td>
        <td id="LC6936">            CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6937" data-line-number="6937"></td>
        <td id="LC6937">
</td>
      </tr>
      <tr>
        <td id="L6938" data-line-number="6938"></td>
        <td id="LC6938">        ilcode[<span>3</span>] = (BYTE)(tokGenericArg);</td>
      </tr>
      <tr>
        <td id="L6939" data-line-number="6939"></td>
        <td id="LC6939">        ilcode[<span>4</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>8</span>);</td>
      </tr>
      <tr>
        <td id="L6940" data-line-number="6940"></td>
        <td id="LC6940">        ilcode[<span>5</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L6941" data-line-number="6941"></td>
        <td id="LC6941">        ilcode[<span>6</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>24</span>);</td>
      </tr>
      <tr>
        <td id="L6942" data-line-number="6942"></td>
        <td id="LC6942">
</td>
      </tr>
      <tr>
        <td id="L6943" data-line-number="6943"></td>
        <td id="LC6943">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L6944" data-line-number="6944"></td>
        <td id="LC6944">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L6945" data-line-number="6945"></td>
        <td id="LC6945">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L6946" data-line-number="6946"></td>
        <td id="LC6946">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6947" data-line-number="6947"></td>
        <td id="LC6947">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6948" data-line-number="6948"></td>
        <td id="LC6948">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6949" data-line-number="6949"></td>
        <td id="LC6949">    }</td>
      </tr>
      <tr>
        <td id="L6950" data-line-number="6950"></td>
        <td id="LC6950">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_INTPTR_ADD)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6951" data-line-number="6951"></td>
        <td id="LC6951">    {</td>
      </tr>
      <tr>
        <td id="L6952" data-line-number="6952"></td>
        <td id="LC6952">        mdToken tokGenericArg = <span>FindGenericMethodArgTypeSpec</span>(<span>MscorlibBinder::GetModule</span>()-&gt;<span>GetMDImport</span>());</td>
      </tr>
      <tr>
        <td id="L6953" data-line-number="6953"></td>
        <td id="LC6953">
</td>
      </tr>
      <tr>
        <td id="L6954" data-line-number="6954"></td>
        <td id="LC6954">        <span>static</span> BYTE ilcode[] = { CEE_LDARG_1,</td>
      </tr>
      <tr>
        <td id="L6955" data-line-number="6955"></td>
        <td id="LC6955">            CEE_PREFIX1, (CEE_SIZEOF &amp; <span>0xFF</span>), <span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>,</td>
      </tr>
      <tr>
        <td id="L6956" data-line-number="6956"></td>
        <td id="LC6956">            CEE_MUL,</td>
      </tr>
      <tr>
        <td id="L6957" data-line-number="6957"></td>
        <td id="LC6957">            CEE_LDARG_0,</td>
      </tr>
      <tr>
        <td id="L6958" data-line-number="6958"></td>
        <td id="LC6958">            CEE_ADD,</td>
      </tr>
      <tr>
        <td id="L6959" data-line-number="6959"></td>
        <td id="LC6959">            CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6960" data-line-number="6960"></td>
        <td id="LC6960">
</td>
      </tr>
      <tr>
        <td id="L6961" data-line-number="6961"></td>
        <td id="LC6961">        ilcode[<span>3</span>] = (BYTE)(tokGenericArg);</td>
      </tr>
      <tr>
        <td id="L6962" data-line-number="6962"></td>
        <td id="LC6962">        ilcode[<span>4</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>8</span>);</td>
      </tr>
      <tr>
        <td id="L6963" data-line-number="6963"></td>
        <td id="LC6963">        ilcode[<span>5</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L6964" data-line-number="6964"></td>
        <td id="LC6964">        ilcode[<span>6</span>] = (BYTE)(tokGenericArg &gt;&gt; <span>24</span>);</td>
      </tr>
      <tr>
        <td id="L6965" data-line-number="6965"></td>
        <td id="LC6965">
</td>
      </tr>
      <tr>
        <td id="L6966" data-line-number="6966"></td>
        <td id="LC6966">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L6967" data-line-number="6967"></td>
        <td id="LC6967">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L6968" data-line-number="6968"></td>
        <td id="LC6968">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L6969" data-line-number="6969"></td>
        <td id="LC6969">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6970" data-line-number="6970"></td>
        <td id="LC6970">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6971" data-line-number="6971"></td>
        <td id="LC6971">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6972" data-line-number="6972"></td>
        <td id="LC6972">    }</td>
      </tr>
      <tr>
        <td id="L6973" data-line-number="6973"></td>
        <td id="LC6973">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_ADD_BYTE_OFFSET)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6974" data-line-number="6974"></td>
        <td id="LC6974">    {</td>
      </tr>
      <tr>
        <td id="L6975" data-line-number="6975"></td>
        <td id="LC6975">        <span>static</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_LDARG_1, CEE_ADD, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6976" data-line-number="6976"></td>
        <td id="LC6976">
</td>
      </tr>
      <tr>
        <td id="L6977" data-line-number="6977"></td>
        <td id="LC6977">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L6978" data-line-number="6978"></td>
        <td id="LC6978">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L6979" data-line-number="6979"></td>
        <td id="LC6979">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L6980" data-line-number="6980"></td>
        <td id="LC6980">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6981" data-line-number="6981"></td>
        <td id="LC6981">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6982" data-line-number="6982"></td>
        <td id="LC6982">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6983" data-line-number="6983"></td>
        <td id="LC6983">    }</td>
      </tr>
      <tr>
        <td id="L6984" data-line-number="6984"></td>
        <td id="LC6984">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_ARE_SAME)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6985" data-line-number="6985"></td>
        <td id="LC6985">    {</td>
      </tr>
      <tr>
        <td id="L6986" data-line-number="6986"></td>
        <td id="LC6986">        <span><span>//</span> Compare the two arguments</span></td>
      </tr>
      <tr>
        <td id="L6987" data-line-number="6987"></td>
        <td id="LC6987">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_LDARG_1, CEE_PREFIX1, (CEE_CEQ &amp; <span>0xFF</span>), CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6988" data-line-number="6988"></td>
        <td id="LC6988">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L6989" data-line-number="6989"></td>
        <td id="LC6989">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L6990" data-line-number="6990"></td>
        <td id="LC6990">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L6991" data-line-number="6991"></td>
        <td id="LC6991">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6992" data-line-number="6992"></td>
        <td id="LC6992">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L6993" data-line-number="6993"></td>
        <td id="LC6993">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L6994" data-line-number="6994"></td>
        <td id="LC6994">    }</td>
      </tr>
      <tr>
        <td id="L6995" data-line-number="6995"></td>
        <td id="LC6995">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_IS_ADDRESS_GREATER_THAN)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L6996" data-line-number="6996"></td>
        <td id="LC6996">    {</td>
      </tr>
      <tr>
        <td id="L6997" data-line-number="6997"></td>
        <td id="LC6997">        <span><span>//</span> Compare the two arguments</span></td>
      </tr>
      <tr>
        <td id="L6998" data-line-number="6998"></td>
        <td id="LC6998">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_LDARG_1, CEE_PREFIX1, (CEE_CGT_UN &amp; <span>0xFF</span>), CEE_RET };</td>
      </tr>
      <tr>
        <td id="L6999" data-line-number="6999"></td>
        <td id="LC6999">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7000" data-line-number="7000"></td>
        <td id="LC7000">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7001" data-line-number="7001"></td>
        <td id="LC7001">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7002" data-line-number="7002"></td>
        <td id="LC7002">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7003" data-line-number="7003"></td>
        <td id="LC7003">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7004" data-line-number="7004"></td>
        <td id="LC7004">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7005" data-line-number="7005"></td>
        <td id="LC7005">    }</td>
      </tr>
      <tr>
        <td id="L7006" data-line-number="7006"></td>
        <td id="LC7006">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_IS_ADDRESS_LESS_THAN)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7007" data-line-number="7007"></td>
        <td id="LC7007">    {</td>
      </tr>
      <tr>
        <td id="L7008" data-line-number="7008"></td>
        <td id="LC7008">        <span><span>//</span> Compare the two arguments</span></td>
      </tr>
      <tr>
        <td id="L7009" data-line-number="7009"></td>
        <td id="LC7009">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_LDARG_1, CEE_PREFIX1, (CEE_CLT_UN &amp; <span>0xFF</span>), CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7010" data-line-number="7010"></td>
        <td id="LC7010">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7011" data-line-number="7011"></td>
        <td id="LC7011">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7012" data-line-number="7012"></td>
        <td id="LC7012">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7013" data-line-number="7013"></td>
        <td id="LC7013">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7014" data-line-number="7014"></td>
        <td id="LC7014">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7015" data-line-number="7015"></td>
        <td id="LC7015">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7016" data-line-number="7016"></td>
        <td id="LC7016">    }</td>
      </tr>
      <tr>
        <td id="L7017" data-line-number="7017"></td>
        <td id="LC7017">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_NULLREF)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7018" data-line-number="7018"></td>
        <td id="LC7018">    {</td>
      </tr>
      <tr>
        <td id="L7019" data-line-number="7019"></td>
        <td id="LC7019">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDC_I4_0, CEE_CONV_U, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7020" data-line-number="7020"></td>
        <td id="LC7020">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7021" data-line-number="7021"></td>
        <td id="LC7021">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7022" data-line-number="7022"></td>
        <td id="LC7022">        methInfo-&gt;<span>maxStack</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L7023" data-line-number="7023"></td>
        <td id="LC7023">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7024" data-line-number="7024"></td>
        <td id="LC7024">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7025" data-line-number="7025"></td>
        <td id="LC7025">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7026" data-line-number="7026"></td>
        <td id="LC7026">    }</td>
      </tr>
      <tr>
        <td id="L7027" data-line-number="7027"></td>
        <td id="LC7027">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_IS_NULL)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7028" data-line-number="7028"></td>
        <td id="LC7028">    {</td>
      </tr>
      <tr>
        <td id="L7029" data-line-number="7029"></td>
        <td id="LC7029">        <span><span>//</span> 'ldnull' opcode would produce type o, and we can't compare &amp; against o (ECMA-335, Table III.4).</span></td>
      </tr>
      <tr>
        <td id="L7030" data-line-number="7030"></td>
        <td id="LC7030">        <span><span>//</span> However, we can compare &amp; against native int, so we'll use that instead.</span></td>
      </tr>
      <tr>
        <td id="L7031" data-line-number="7031"></td>
        <td id="LC7031">
</td>
      </tr>
      <tr>
        <td id="L7032" data-line-number="7032"></td>
        <td id="LC7032">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_LDC_I4_0, CEE_CONV_U, CEE_PREFIX1, (CEE_CEQ &amp; <span>0xFF</span>), CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7033" data-line-number="7033"></td>
        <td id="LC7033">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7034" data-line-number="7034"></td>
        <td id="LC7034">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7035" data-line-number="7035"></td>
        <td id="LC7035">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7036" data-line-number="7036"></td>
        <td id="LC7036">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7037" data-line-number="7037"></td>
        <td id="LC7037">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7038" data-line-number="7038"></td>
        <td id="LC7038">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7039" data-line-number="7039"></td>
        <td id="LC7039">    }</td>
      </tr>
      <tr>
        <td id="L7040" data-line-number="7040"></td>
        <td id="LC7040">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_INIT_BLOCK_UNALIGNED)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7041" data-line-number="7041"></td>
        <td id="LC7041">    {</td>
      </tr>
      <tr>
        <td id="L7042" data-line-number="7042"></td>
        <td id="LC7042">        <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_LDARG_1, CEE_LDARG_2, CEE_PREFIX1, (CEE_UNALIGNED &amp; <span>0xFF</span>), <span>0x01</span>, CEE_PREFIX1, (CEE_INITBLK &amp; <span>0xFF</span>), CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7043" data-line-number="7043"></td>
        <td id="LC7043">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7044" data-line-number="7044"></td>
        <td id="LC7044">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7045" data-line-number="7045"></td>
        <td id="LC7045">        methInfo-&gt;<span>maxStack</span> = <span>3</span>;</td>
      </tr>
      <tr>
        <td id="L7046" data-line-number="7046"></td>
        <td id="LC7046">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7047" data-line-number="7047"></td>
        <td id="LC7047">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7048" data-line-number="7048"></td>
        <td id="LC7048">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7049" data-line-number="7049"></td>
        <td id="LC7049">    }</td>
      </tr>
      <tr>
        <td id="L7050" data-line-number="7050"></td>
        <td id="LC7050">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_BYTE_OFFSET)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7051" data-line-number="7051"></td>
        <td id="LC7051">    {</td>
      </tr>
      <tr>
        <td id="L7052" data-line-number="7052"></td>
        <td id="LC7052">        <span>static</span> <span>const</span> BYTE ilcode[] =</td>
      </tr>
      <tr>
        <td id="L7053" data-line-number="7053"></td>
        <td id="LC7053">        {</td>
      </tr>
      <tr>
        <td id="L7054" data-line-number="7054"></td>
        <td id="LC7054">            CEE_LDARG_1,</td>
      </tr>
      <tr>
        <td id="L7055" data-line-number="7055"></td>
        <td id="LC7055">            CEE_LDARG_0,</td>
      </tr>
      <tr>
        <td id="L7056" data-line-number="7056"></td>
        <td id="LC7056">            CEE_SUB,</td>
      </tr>
      <tr>
        <td id="L7057" data-line-number="7057"></td>
        <td id="LC7057">            CEE_RET</td>
      </tr>
      <tr>
        <td id="L7058" data-line-number="7058"></td>
        <td id="LC7058">        };</td>
      </tr>
      <tr>
        <td id="L7059" data-line-number="7059"></td>
        <td id="LC7059">
</td>
      </tr>
      <tr>
        <td id="L7060" data-line-number="7060"></td>
        <td id="LC7060">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7061" data-line-number="7061"></td>
        <td id="LC7061">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7062" data-line-number="7062"></td>
        <td id="LC7062">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7063" data-line-number="7063"></td>
        <td id="LC7063">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7064" data-line-number="7064"></td>
        <td id="LC7064">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7065" data-line-number="7065"></td>
        <td id="LC7065">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7066" data-line-number="7066"></td>
        <td id="LC7066">    }</td>
      </tr>
      <tr>
        <td id="L7067" data-line-number="7067"></td>
        <td id="LC7067">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_READ_UNALIGNED)-&gt;<span>GetMemberDef</span>() ||</td>
      </tr>
      <tr>
        <td id="L7068" data-line-number="7068"></td>
        <td id="LC7068">             tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__PTR_READ_UNALIGNED)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7069" data-line-number="7069"></td>
        <td id="LC7069">    {</td>
      </tr>
      <tr>
        <td id="L7070" data-line-number="7070"></td>
        <td id="LC7070">        <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L7071" data-line-number="7071"></td>
        <td id="LC7071">        Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L7072" data-line-number="7072"></td>
        <td id="LC7072">        <span>_ASSERTE</span>(ftn-&gt;<span>GetNumGenericMethodArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L7073" data-line-number="7073"></td>
        <td id="LC7073">        mdToken tokGenericArg = <span>FindGenericMethodArgTypeSpec</span>(<span>MscorlibBinder::GetModule</span>()-&gt;<span>GetMDImport</span>());</td>
      </tr>
      <tr>
        <td id="L7074" data-line-number="7074"></td>
        <td id="LC7074">
</td>
      </tr>
      <tr>
        <td id="L7075" data-line-number="7075"></td>
        <td id="LC7075">        <span>static</span> <span>const</span> BYTE ilcode[]</td>
      </tr>
      <tr>
        <td id="L7076" data-line-number="7076"></td>
        <td id="LC7076">        {</td>
      </tr>
      <tr>
        <td id="L7077" data-line-number="7077"></td>
        <td id="LC7077">            CEE_LDARG_0,</td>
      </tr>
      <tr>
        <td id="L7078" data-line-number="7078"></td>
        <td id="LC7078">            CEE_PREFIX1, (CEE_UNALIGNED &amp; <span>0xFF</span>), <span>1</span>,</td>
      </tr>
      <tr>
        <td id="L7079" data-line-number="7079"></td>
        <td id="LC7079">            CEE_LDOBJ, (BYTE)(tokGenericArg), (BYTE)(tokGenericArg &gt;&gt; <span>8</span>), (BYTE)(tokGenericArg &gt;&gt; <span>16</span>), (BYTE)(tokGenericArg &gt;&gt; <span>24</span>),</td>
      </tr>
      <tr>
        <td id="L7080" data-line-number="7080"></td>
        <td id="LC7080">            CEE_RET</td>
      </tr>
      <tr>
        <td id="L7081" data-line-number="7081"></td>
        <td id="LC7081">        };</td>
      </tr>
      <tr>
        <td id="L7082" data-line-number="7082"></td>
        <td id="LC7082">
</td>
      </tr>
      <tr>
        <td id="L7083" data-line-number="7083"></td>
        <td id="LC7083">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7084" data-line-number="7084"></td>
        <td id="LC7084">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7085" data-line-number="7085"></td>
        <td id="LC7085">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7086" data-line-number="7086"></td>
        <td id="LC7086">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7087" data-line-number="7087"></td>
        <td id="LC7087">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7088" data-line-number="7088"></td>
        <td id="LC7088">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7089" data-line-number="7089"></td>
        <td id="LC7089">    }</td>
      </tr>
      <tr>
        <td id="L7090" data-line-number="7090"></td>
        <td id="LC7090">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__BYREF_WRITE_UNALIGNED)-&gt;<span>GetMemberDef</span>() ||</td>
      </tr>
      <tr>
        <td id="L7091" data-line-number="7091"></td>
        <td id="LC7091">             tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__PTR_WRITE_UNALIGNED)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7092" data-line-number="7092"></td>
        <td id="LC7092">    {</td>
      </tr>
      <tr>
        <td id="L7093" data-line-number="7093"></td>
        <td id="LC7093">        <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L7094" data-line-number="7094"></td>
        <td id="LC7094">        Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L7095" data-line-number="7095"></td>
        <td id="LC7095">        <span>_ASSERTE</span>(ftn-&gt;<span>GetNumGenericMethodArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L7096" data-line-number="7096"></td>
        <td id="LC7096">        mdToken tokGenericArg = <span>FindGenericMethodArgTypeSpec</span>(<span>MscorlibBinder::GetModule</span>()-&gt;<span>GetMDImport</span>());</td>
      </tr>
      <tr>
        <td id="L7097" data-line-number="7097"></td>
        <td id="LC7097">
</td>
      </tr>
      <tr>
        <td id="L7098" data-line-number="7098"></td>
        <td id="LC7098">        <span>static</span> <span>const</span> BYTE ilcode[]</td>
      </tr>
      <tr>
        <td id="L7099" data-line-number="7099"></td>
        <td id="LC7099">        {</td>
      </tr>
      <tr>
        <td id="L7100" data-line-number="7100"></td>
        <td id="LC7100">            CEE_LDARG_0,</td>
      </tr>
      <tr>
        <td id="L7101" data-line-number="7101"></td>
        <td id="LC7101">            CEE_LDARG_1,</td>
      </tr>
      <tr>
        <td id="L7102" data-line-number="7102"></td>
        <td id="LC7102">            CEE_PREFIX1, (CEE_UNALIGNED &amp; <span>0xFF</span>), <span>1</span>,</td>
      </tr>
      <tr>
        <td id="L7103" data-line-number="7103"></td>
        <td id="LC7103">            CEE_STOBJ, (BYTE)(tokGenericArg), (BYTE)(tokGenericArg &gt;&gt; <span>8</span>), (BYTE)(tokGenericArg &gt;&gt; <span>16</span>), (BYTE)(tokGenericArg &gt;&gt; <span>24</span>),</td>
      </tr>
      <tr>
        <td id="L7104" data-line-number="7104"></td>
        <td id="LC7104">            CEE_RET</td>
      </tr>
      <tr>
        <td id="L7105" data-line-number="7105"></td>
        <td id="LC7105">        };</td>
      </tr>
      <tr>
        <td id="L7106" data-line-number="7106"></td>
        <td id="LC7106">
</td>
      </tr>
      <tr>
        <td id="L7107" data-line-number="7107"></td>
        <td id="LC7107">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7108" data-line-number="7108"></td>
        <td id="LC7108">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7109" data-line-number="7109"></td>
        <td id="LC7109">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7110" data-line-number="7110"></td>
        <td id="LC7110">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7111" data-line-number="7111"></td>
        <td id="LC7111">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7112" data-line-number="7112"></td>
        <td id="LC7112">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7113" data-line-number="7113"></td>
        <td id="LC7113">    }</td>
      </tr>
      <tr>
        <td id="L7114" data-line-number="7114"></td>
        <td id="LC7114">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__UNSAFE__SKIPINIT)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7115" data-line-number="7115"></td>
        <td id="LC7115">    {</td>
      </tr>
      <tr>
        <td id="L7116" data-line-number="7116"></td>
        <td id="LC7116">        <span>static</span> BYTE ilcode[] = { CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7117" data-line-number="7117"></td>
        <td id="LC7117">
</td>
      </tr>
      <tr>
        <td id="L7118" data-line-number="7118"></td>
        <td id="LC7118">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7119" data-line-number="7119"></td>
        <td id="LC7119">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7120" data-line-number="7120"></td>
        <td id="LC7120">        methInfo-&gt;<span>maxStack</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7121" data-line-number="7121"></td>
        <td id="LC7121">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7122" data-line-number="7122"></td>
        <td id="LC7122">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7123" data-line-number="7123"></td>
        <td id="LC7123">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7124" data-line-number="7124"></td>
        <td id="LC7124">    }</td>
      </tr>
      <tr>
        <td id="L7125" data-line-number="7125"></td>
        <td id="LC7125">
</td>
      </tr>
      <tr>
        <td id="L7126" data-line-number="7126"></td>
        <td id="LC7126">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7127" data-line-number="7127"></td>
        <td id="LC7127">}</td>
      </tr>
      <tr>
        <td id="L7128" data-line-number="7128"></td>
        <td id="LC7128">
</td>
      </tr>
      <tr>
        <td id="L7129" data-line-number="7129"></td>
        <td id="LC7129"><span>bool</span> <span>getILIntrinsicImplementationForMemoryMarshal</span>(MethodDesc * ftn,</td>
      </tr>
      <tr>
        <td id="L7130" data-line-number="7130"></td>
        <td id="LC7130">                                                  CORINFO_METHOD_INFO * methInfo)</td>
      </tr>
      <tr>
        <td id="L7131" data-line-number="7131"></td>
        <td id="LC7131">{</td>
      </tr>
      <tr>
        <td id="L7132" data-line-number="7132"></td>
        <td id="LC7132">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L7133" data-line-number="7133"></td>
        <td id="LC7133">
</td>
      </tr>
      <tr>
        <td id="L7134" data-line-number="7134"></td>
        <td id="LC7134">    <span>_ASSERTE</span>(<span>MscorlibBinder::IsClass</span>(ftn-&gt;<span>GetMethodTable</span>(), CLASS__MEMORY_MARSHAL));</td>
      </tr>
      <tr>
        <td id="L7135" data-line-number="7135"></td>
        <td id="LC7135">
</td>
      </tr>
      <tr>
        <td id="L7136" data-line-number="7136"></td>
        <td id="LC7136">    mdMethodDef tk = ftn-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L7137" data-line-number="7137"></td>
        <td id="LC7137">
</td>
      </tr>
      <tr>
        <td id="L7138" data-line-number="7138"></td>
        <td id="LC7138">    <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__MEMORY_MARSHAL__GET_ARRAY_DATA_REFERENCE)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7139" data-line-number="7139"></td>
        <td id="LC7139">    {</td>
      </tr>
      <tr>
        <td id="L7140" data-line-number="7140"></td>
        <td id="LC7140">        mdToken tokRawSzArrayData = <span>MscorlibBinder::GetField</span>(FIELD__RAW_ARRAY_DATA__DATA)-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L7141" data-line-number="7141"></td>
        <td id="LC7141">
</td>
      </tr>
      <tr>
        <td id="L7142" data-line-number="7142"></td>
        <td id="LC7142">        <span>static</span> BYTE ilcode[] = { CEE_LDARG_0,</td>
      </tr>
      <tr>
        <td id="L7143" data-line-number="7143"></td>
        <td id="LC7143">                                 CEE_LDFLDA,<span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>,</td>
      </tr>
      <tr>
        <td id="L7144" data-line-number="7144"></td>
        <td id="LC7144">                                 CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7145" data-line-number="7145"></td>
        <td id="LC7145">
</td>
      </tr>
      <tr>
        <td id="L7146" data-line-number="7146"></td>
        <td id="LC7146">        ilcode[<span>2</span>] = (BYTE)(tokRawSzArrayData);</td>
      </tr>
      <tr>
        <td id="L7147" data-line-number="7147"></td>
        <td id="LC7147">        ilcode[<span>3</span>] = (BYTE)(tokRawSzArrayData &gt;&gt; <span>8</span>);</td>
      </tr>
      <tr>
        <td id="L7148" data-line-number="7148"></td>
        <td id="LC7148">        ilcode[<span>4</span>] = (BYTE)(tokRawSzArrayData &gt;&gt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L7149" data-line-number="7149"></td>
        <td id="LC7149">        ilcode[<span>5</span>] = (BYTE)(tokRawSzArrayData &gt;&gt; <span>24</span>);</td>
      </tr>
      <tr>
        <td id="L7150" data-line-number="7150"></td>
        <td id="LC7150">
</td>
      </tr>
      <tr>
        <td id="L7151" data-line-number="7151"></td>
        <td id="LC7151">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7152" data-line-number="7152"></td>
        <td id="LC7152">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7153" data-line-number="7153"></td>
        <td id="LC7153">        methInfo-&gt;<span>maxStack</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L7154" data-line-number="7154"></td>
        <td id="LC7154">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7155" data-line-number="7155"></td>
        <td id="LC7155">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7156" data-line-number="7156"></td>
        <td id="LC7156">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7157" data-line-number="7157"></td>
        <td id="LC7157">    }</td>
      </tr>
      <tr>
        <td id="L7158" data-line-number="7158"></td>
        <td id="LC7158">
</td>
      </tr>
      <tr>
        <td id="L7159" data-line-number="7159"></td>
        <td id="LC7159">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7160" data-line-number="7160"></td>
        <td id="LC7160">}</td>
      </tr>
      <tr>
        <td id="L7161" data-line-number="7161"></td>
        <td id="LC7161">
</td>
      </tr>
      <tr>
        <td id="L7162" data-line-number="7162"></td>
        <td id="LC7162"><span>bool</span> <span>getILIntrinsicImplementationForVolatile</span>(MethodDesc * ftn,</td>
      </tr>
      <tr>
        <td id="L7163" data-line-number="7163"></td>
        <td id="LC7163">                                             CORINFO_METHOD_INFO * methInfo)</td>
      </tr>
      <tr>
        <td id="L7164" data-line-number="7164"></td>
        <td id="LC7164">{</td>
      </tr>
      <tr>
        <td id="L7165" data-line-number="7165"></td>
        <td id="LC7165">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L7166" data-line-number="7166"></td>
        <td id="LC7166">
</td>
      </tr>
      <tr>
        <td id="L7167" data-line-number="7167"></td>
        <td id="LC7167">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7168" data-line-number="7168"></td>
        <td id="LC7168">    <span><span>//</span> This replaces the implementations of Volatile.* in mscorlib with more efficient ones.</span></td>
      </tr>
      <tr>
        <td id="L7169" data-line-number="7169"></td>
        <td id="LC7169">    <span><span>//</span> We do this because we cannot otherwise express these in C#.  What we *want* to do is</span></td>
      </tr>
      <tr>
        <td id="L7170" data-line-number="7170"></td>
        <td id="LC7170">    <span><span>//</span> to treat the byref args to these methods as "volatile."  In pseudo-C#, this would look</span></td>
      </tr>
      <tr>
        <td id="L7171" data-line-number="7171"></td>
        <td id="LC7171">    <span><span>//</span> like:</span></td>
      </tr>
      <tr>
        <td id="L7172" data-line-number="7172"></td>
        <td id="LC7172">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7173" data-line-number="7173"></td>
        <td id="LC7173">    <span><span>//</span>   int Read(ref volatile int location)</span></td>
      </tr>
      <tr>
        <td id="L7174" data-line-number="7174"></td>
        <td id="LC7174">    <span><span>//</span>   {</span></td>
      </tr>
      <tr>
        <td id="L7175" data-line-number="7175"></td>
        <td id="LC7175">    <span><span>//</span>       return location;</span></td>
      </tr>
      <tr>
        <td id="L7176" data-line-number="7176"></td>
        <td id="LC7176">    <span><span>//</span>   }</span></td>
      </tr>
      <tr>
        <td id="L7177" data-line-number="7177"></td>
        <td id="LC7177">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7178" data-line-number="7178"></td>
        <td id="LC7178">    <span><span>//</span> However, C# does not yet provide a way to declare a byref as "volatile."  So instead,</span></td>
      </tr>
      <tr>
        <td id="L7179" data-line-number="7179"></td>
        <td id="LC7179">    <span><span>//</span> we substitute raw IL bodies for these methods that use the correct volatile instructions.</span></td>
      </tr>
      <tr>
        <td id="L7180" data-line-number="7180"></td>
        <td id="LC7180">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7181" data-line-number="7181"></td>
        <td id="LC7181">
</td>
      </tr>
      <tr>
        <td id="L7182" data-line-number="7182"></td>
        <td id="LC7182">    <span>_ASSERTE</span>(<span>MscorlibBinder::IsClass</span>(ftn-&gt;<span>GetMethodTable</span>(), CLASS__VOLATILE));</td>
      </tr>
      <tr>
        <td id="L7183" data-line-number="7183"></td>
        <td id="LC7183">
</td>
      </tr>
      <tr>
        <td id="L7184" data-line-number="7184"></td>
        <td id="LC7184">    <span>const</span> <span>size_t</span> VolatileMethodBodySize = <span>6</span>;</td>
      </tr>
      <tr>
        <td id="L7185" data-line-number="7185"></td>
        <td id="LC7185">
</td>
      </tr>
      <tr>
        <td id="L7186" data-line-number="7186"></td>
        <td id="LC7186">    <span>struct</span> <span>VolatileMethodImpl</span></td>
      </tr>
      <tr>
        <td id="L7187" data-line-number="7187"></td>
        <td id="LC7187">    {</td>
      </tr>
      <tr>
        <td id="L7188" data-line-number="7188"></td>
        <td id="LC7188">        BinderMethodID methodId;</td>
      </tr>
      <tr>
        <td id="L7189" data-line-number="7189"></td>
        <td id="LC7189">        BYTE body[VolatileMethodBodySize];</td>
      </tr>
      <tr>
        <td id="L7190" data-line-number="7190"></td>
        <td id="LC7190">    };</td>
      </tr>
      <tr>
        <td id="L7191" data-line-number="7191"></td>
        <td id="LC7191">
</td>
      </tr>
      <tr>
        <td id="L7192" data-line-number="7192"></td>
        <td id="LC7192">#<span>define</span> <span>VOLATILE_IMPL</span>(<span>type, loadinst, storeinst</span>) \</td>
      </tr>
      <tr>
        <td id="L7193" data-line-number="7193"></td>
        <td id="LC7193">    { \</td>
      </tr>
      <tr>
        <td id="L7194" data-line-number="7194"></td>
        <td id="LC7194">        METHOD__VOLATILE__READ_##type, \</td>
      </tr>
      <tr>
        <td id="L7195" data-line-number="7195"></td>
        <td id="LC7195">        { \</td>
      </tr>
      <tr>
        <td id="L7196" data-line-number="7196"></td>
        <td id="LC7196">            CEE_LDARG_0, \</td>
      </tr>
      <tr>
        <td id="L7197" data-line-number="7197"></td>
        <td id="LC7197">            CEE_PREFIX1, (CEE_VOLATILE &amp; <span>0xFF</span>), \</td>
      </tr>
      <tr>
        <td id="L7198" data-line-number="7198"></td>
        <td id="LC7198">            loadinst, \</td>
      </tr>
      <tr>
        <td id="L7199" data-line-number="7199"></td>
        <td id="LC7199">            CEE_NOP, <span><span>/*</span>pad to VolatileMethodBodySize bytes<span>*/</span></span> \</td>
      </tr>
      <tr>
        <td id="L7200" data-line-number="7200"></td>
        <td id="LC7200">            CEE_RET \</td>
      </tr>
      <tr>
        <td id="L7201" data-line-number="7201"></td>
        <td id="LC7201">        } \</td>
      </tr>
      <tr>
        <td id="L7202" data-line-number="7202"></td>
        <td id="LC7202">    }, \</td>
      </tr>
      <tr>
        <td id="L7203" data-line-number="7203"></td>
        <td id="LC7203">    { \</td>
      </tr>
      <tr>
        <td id="L7204" data-line-number="7204"></td>
        <td id="LC7204">        METHOD__VOLATILE__WRITE_##type, \</td>
      </tr>
      <tr>
        <td id="L7205" data-line-number="7205"></td>
        <td id="LC7205">        { \</td>
      </tr>
      <tr>
        <td id="L7206" data-line-number="7206"></td>
        <td id="LC7206">            CEE_LDARG_0, \</td>
      </tr>
      <tr>
        <td id="L7207" data-line-number="7207"></td>
        <td id="LC7207">            CEE_LDARG_1, \</td>
      </tr>
      <tr>
        <td id="L7208" data-line-number="7208"></td>
        <td id="LC7208">            CEE_PREFIX1, (CEE_VOLATILE &amp; <span>0xFF</span>), \</td>
      </tr>
      <tr>
        <td id="L7209" data-line-number="7209"></td>
        <td id="LC7209">            storeinst, \</td>
      </tr>
      <tr>
        <td id="L7210" data-line-number="7210"></td>
        <td id="LC7210">            CEE_RET \</td>
      </tr>
      <tr>
        <td id="L7211" data-line-number="7211"></td>
        <td id="LC7211">        } \</td>
      </tr>
      <tr>
        <td id="L7212" data-line-number="7212"></td>
        <td id="LC7212">    },</td>
      </tr>
      <tr>
        <td id="L7213" data-line-number="7213"></td>
        <td id="LC7213">
</td>
      </tr>
      <tr>
        <td id="L7214" data-line-number="7214"></td>
        <td id="LC7214">    <span>static</span> <span>const</span> VolatileMethodImpl volatileImpls[] =</td>
      </tr>
      <tr>
        <td id="L7215" data-line-number="7215"></td>
        <td id="LC7215">    {</td>
      </tr>
      <tr>
        <td id="L7216" data-line-number="7216"></td>
        <td id="LC7216">        <span>VOLATILE_IMPL</span>(T,       CEE_LDIND_REF, CEE_STIND_REF)</td>
      </tr>
      <tr>
        <td id="L7217" data-line-number="7217"></td>
        <td id="LC7217">        <span>VOLATILE_IMPL</span>(Bool,    CEE_LDIND_I1,  CEE_STIND_I1)</td>
      </tr>
      <tr>
        <td id="L7218" data-line-number="7218"></td>
        <td id="LC7218">        <span>VOLATILE_IMPL</span>(Int,     CEE_LDIND_I4,  CEE_STIND_I4)</td>
      </tr>
      <tr>
        <td id="L7219" data-line-number="7219"></td>
        <td id="LC7219">        <span>VOLATILE_IMPL</span>(IntPtr,  CEE_LDIND_I,   CEE_STIND_I)</td>
      </tr>
      <tr>
        <td id="L7220" data-line-number="7220"></td>
        <td id="LC7220">        <span>VOLATILE_IMPL</span>(UInt,    CEE_LDIND_U4,  CEE_STIND_I4)</td>
      </tr>
      <tr>
        <td id="L7221" data-line-number="7221"></td>
        <td id="LC7221">        <span>VOLATILE_IMPL</span>(UIntPtr, CEE_LDIND_I,   CEE_STIND_I)</td>
      </tr>
      <tr>
        <td id="L7222" data-line-number="7222"></td>
        <td id="LC7222">        <span>VOLATILE_IMPL</span>(SByt,    CEE_LDIND_I1,  CEE_STIND_I1)</td>
      </tr>
      <tr>
        <td id="L7223" data-line-number="7223"></td>
        <td id="LC7223">        <span>VOLATILE_IMPL</span>(<span>Byte</span>,    CEE_LDIND_U1,  CEE_STIND_I1)</td>
      </tr>
      <tr>
        <td id="L7224" data-line-number="7224"></td>
        <td id="LC7224">        <span>VOLATILE_IMPL</span>(Shrt,    CEE_LDIND_I2,  CEE_STIND_I2)</td>
      </tr>
      <tr>
        <td id="L7225" data-line-number="7225"></td>
        <td id="LC7225">        <span>VOLATILE_IMPL</span>(UShrt,   CEE_LDIND_U2,  CEE_STIND_I2)</td>
      </tr>
      <tr>
        <td id="L7226" data-line-number="7226"></td>
        <td id="LC7226">        <span>VOLATILE_IMPL</span>(Flt,     CEE_LDIND_R4,  CEE_STIND_R4)</td>
      </tr>
      <tr>
        <td id="L7227" data-line-number="7227"></td>
        <td id="LC7227">
</td>
      </tr>
      <tr>
        <td id="L7228" data-line-number="7228"></td>
        <td id="LC7228">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7229" data-line-number="7229"></td>
        <td id="LC7229">        <span><span>//</span> Ordinary volatile loads and stores only guarantee atomicity for pointer-sized (or smaller) data.</span></td>
      </tr>
      <tr>
        <td id="L7230" data-line-number="7230"></td>
        <td id="LC7230">        <span><span>//</span> So, on 32-bit platforms we must use Interlocked operations instead for the 64-bit types.</span></td>
      </tr>
      <tr>
        <td id="L7231" data-line-number="7231"></td>
        <td id="LC7231">        <span><span>//</span> The implementation in mscorlib already does this, so we will only substitute a new</span></td>
      </tr>
      <tr>
        <td id="L7232" data-line-number="7232"></td>
        <td id="LC7232">        <span><span>//</span> IL body if we're running on a 64-bit platform.</span></td>
      </tr>
      <tr>
        <td id="L7233" data-line-number="7233"></td>
        <td id="LC7233">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7234" data-line-number="7234"></td>
        <td id="LC7234">        <span>IN_TARGET_64BIT</span>(<span>VOLATILE_IMPL</span>(Long,  CEE_LDIND_I8, CEE_STIND_I8))</td>
      </tr>
      <tr>
        <td id="L7235" data-line-number="7235"></td>
        <td id="LC7235">        <span>IN_TARGET_64BIT</span>(<span>VOLATILE_IMPL</span>(ULong, CEE_LDIND_I8, CEE_STIND_I8))</td>
      </tr>
      <tr>
        <td id="L7236" data-line-number="7236"></td>
        <td id="LC7236">        <span>IN_TARGET_64BIT</span>(<span>VOLATILE_IMPL</span>(Dbl,   CEE_LDIND_R8, CEE_STIND_R8))</td>
      </tr>
      <tr>
        <td id="L7237" data-line-number="7237"></td>
        <td id="LC7237">    };</td>
      </tr>
      <tr>
        <td id="L7238" data-line-number="7238"></td>
        <td id="LC7238">
</td>
      </tr>
      <tr>
        <td id="L7239" data-line-number="7239"></td>
        <td id="LC7239">    mdMethodDef md = ftn-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L7240" data-line-number="7240"></td>
        <td id="LC7240">    <span>for</span> (<span>unsigned</span> i = <span>0</span>; i &lt; <span>NumItems</span>(volatileImpls); i++)</td>
      </tr>
      <tr>
        <td id="L7241" data-line-number="7241"></td>
        <td id="LC7241">    {</td>
      </tr>
      <tr>
        <td id="L7242" data-line-number="7242"></td>
        <td id="LC7242">        <span>if</span> (md == <span>MscorlibBinder::GetMethod</span>(volatileImpls[i].<span>methodId</span>)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7243" data-line-number="7243"></td>
        <td id="LC7243">        {</td>
      </tr>
      <tr>
        <td id="L7244" data-line-number="7244"></td>
        <td id="LC7244">            methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(volatileImpls[i].<span>body</span>);</td>
      </tr>
      <tr>
        <td id="L7245" data-line-number="7245"></td>
        <td id="LC7245">            methInfo-&gt;<span>ILCodeSize</span> = VolatileMethodBodySize;</td>
      </tr>
      <tr>
        <td id="L7246" data-line-number="7246"></td>
        <td id="LC7246">            methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7247" data-line-number="7247"></td>
        <td id="LC7247">            methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7248" data-line-number="7248"></td>
        <td id="LC7248">            methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7249" data-line-number="7249"></td>
        <td id="LC7249">            <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7250" data-line-number="7250"></td>
        <td id="LC7250">        }</td>
      </tr>
      <tr>
        <td id="L7251" data-line-number="7251"></td>
        <td id="LC7251">    }</td>
      </tr>
      <tr>
        <td id="L7252" data-line-number="7252"></td>
        <td id="LC7252">
</td>
      </tr>
      <tr>
        <td id="L7253" data-line-number="7253"></td>
        <td id="LC7253">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7254" data-line-number="7254"></td>
        <td id="LC7254">}</td>
      </tr>
      <tr>
        <td id="L7255" data-line-number="7255"></td>
        <td id="LC7255">
</td>
      </tr>
      <tr>
        <td id="L7256" data-line-number="7256"></td>
        <td id="LC7256"><span>bool</span> <span>getILIntrinsicImplementationForInterlocked</span>(MethodDesc * ftn,</td>
      </tr>
      <tr>
        <td id="L7257" data-line-number="7257"></td>
        <td id="LC7257">                                                CORINFO_METHOD_INFO * methInfo)</td>
      </tr>
      <tr>
        <td id="L7258" data-line-number="7258"></td>
        <td id="LC7258">{</td>
      </tr>
      <tr>
        <td id="L7259" data-line-number="7259"></td>
        <td id="LC7259">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L7260" data-line-number="7260"></td>
        <td id="LC7260">
</td>
      </tr>
      <tr>
        <td id="L7261" data-line-number="7261"></td>
        <td id="LC7261">    <span>_ASSERTE</span>(<span>MscorlibBinder::IsClass</span>(ftn-&gt;<span>GetMethodTable</span>(), CLASS__INTERLOCKED));</td>
      </tr>
      <tr>
        <td id="L7262" data-line-number="7262"></td>
        <td id="LC7262">
</td>
      </tr>
      <tr>
        <td id="L7263" data-line-number="7263"></td>
        <td id="LC7263">    <span><span>//</span> We are only interested if ftn's token and CompareExchange&lt;T&gt; token match</span></td>
      </tr>
      <tr>
        <td id="L7264" data-line-number="7264"></td>
        <td id="LC7264">    <span>if</span> (ftn-&gt;<span>GetMemberDef</span>() != <span>MscorlibBinder::GetMethod</span>(METHOD__INTERLOCKED__COMPARE_EXCHANGE_T)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7265" data-line-number="7265"></td>
        <td id="LC7265">        <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7266" data-line-number="7266"></td>
        <td id="LC7266">
</td>
      </tr>
      <tr>
        <td id="L7267" data-line-number="7267"></td>
        <td id="LC7267">    <span><span>//</span> Get MethodDesc for non-generic System.Threading.Interlocked.CompareExchange()</span></td>
      </tr>
      <tr>
        <td id="L7268" data-line-number="7268"></td>
        <td id="LC7268">    MethodDesc* cmpxchgObject = <span>MscorlibBinder::GetMethod</span>(METHOD__INTERLOCKED__COMPARE_EXCHANGE_OBJECT);</td>
      </tr>
      <tr>
        <td id="L7269" data-line-number="7269"></td>
        <td id="LC7269">
</td>
      </tr>
      <tr>
        <td id="L7270" data-line-number="7270"></td>
        <td id="LC7270">    <span><span>//</span> Setup up the body of the method</span></td>
      </tr>
      <tr>
        <td id="L7271" data-line-number="7271"></td>
        <td id="LC7271">    <span>static</span> BYTE il[] = {</td>
      </tr>
      <tr>
        <td id="L7272" data-line-number="7272"></td>
        <td id="LC7272">                          CEE_LDARG_0,</td>
      </tr>
      <tr>
        <td id="L7273" data-line-number="7273"></td>
        <td id="LC7273">                          CEE_LDARG_1,</td>
      </tr>
      <tr>
        <td id="L7274" data-line-number="7274"></td>
        <td id="LC7274">                          CEE_LDARG_2,</td>
      </tr>
      <tr>
        <td id="L7275" data-line-number="7275"></td>
        <td id="LC7275">                          CEE_CALL,<span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>,</td>
      </tr>
      <tr>
        <td id="L7276" data-line-number="7276"></td>
        <td id="LC7276">                          CEE_RET</td>
      </tr>
      <tr>
        <td id="L7277" data-line-number="7277"></td>
        <td id="LC7277">                        };</td>
      </tr>
      <tr>
        <td id="L7278" data-line-number="7278"></td>
        <td id="LC7278">
</td>
      </tr>
      <tr>
        <td id="L7279" data-line-number="7279"></td>
        <td id="LC7279">    <span><span>//</span> Get the token for non-generic System.Threading.Interlocked.CompareExchange(), and patch [target]</span></td>
      </tr>
      <tr>
        <td id="L7280" data-line-number="7280"></td>
        <td id="LC7280">    mdMethodDef cmpxchgObjectToken = cmpxchgObject-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L7281" data-line-number="7281"></td>
        <td id="LC7281">    il[<span>4</span>] = (BYTE)((<span>int</span>)cmpxchgObjectToken &gt;&gt; <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L7282" data-line-number="7282"></td>
        <td id="LC7282">    il[<span>5</span>] = (BYTE)((<span>int</span>)cmpxchgObjectToken &gt;&gt; <span>8</span>);</td>
      </tr>
      <tr>
        <td id="L7283" data-line-number="7283"></td>
        <td id="LC7283">    il[<span>6</span>] = (BYTE)((<span>int</span>)cmpxchgObjectToken &gt;&gt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L7284" data-line-number="7284"></td>
        <td id="LC7284">    il[<span>7</span>] = (BYTE)((<span>int</span>)cmpxchgObjectToken &gt;&gt; <span>24</span>);</td>
      </tr>
      <tr>
        <td id="L7285" data-line-number="7285"></td>
        <td id="LC7285">
</td>
      </tr>
      <tr>
        <td id="L7286" data-line-number="7286"></td>
        <td id="LC7286">    <span><span>//</span> Initialize methInfo</span></td>
      </tr>
      <tr>
        <td id="L7287" data-line-number="7287"></td>
        <td id="LC7287">    methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(il);</td>
      </tr>
      <tr>
        <td id="L7288" data-line-number="7288"></td>
        <td id="LC7288">    methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(il);</td>
      </tr>
      <tr>
        <td id="L7289" data-line-number="7289"></td>
        <td id="LC7289">    methInfo-&gt;<span>maxStack</span> = <span>3</span>;</td>
      </tr>
      <tr>
        <td id="L7290" data-line-number="7290"></td>
        <td id="LC7290">    methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7291" data-line-number="7291"></td>
        <td id="LC7291">    methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7292" data-line-number="7292"></td>
        <td id="LC7292">
</td>
      </tr>
      <tr>
        <td id="L7293" data-line-number="7293"></td>
        <td id="LC7293">    <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7294" data-line-number="7294"></td>
        <td id="LC7294">}</td>
      </tr>
      <tr>
        <td id="L7295" data-line-number="7295"></td>
        <td id="LC7295">
</td>
      </tr>
      <tr>
        <td id="L7296" data-line-number="7296"></td>
        <td id="LC7296"><span>bool</span> <span>getILIntrinsicImplementationForRuntimeHelpers</span>(MethodDesc * ftn,</td>
      </tr>
      <tr>
        <td id="L7297" data-line-number="7297"></td>
        <td id="LC7297">    CORINFO_METHOD_INFO * methInfo)</td>
      </tr>
      <tr>
        <td id="L7298" data-line-number="7298"></td>
        <td id="LC7298">{</td>
      </tr>
      <tr>
        <td id="L7299" data-line-number="7299"></td>
        <td id="LC7299">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L7300" data-line-number="7300"></td>
        <td id="LC7300">
</td>
      </tr>
      <tr>
        <td id="L7301" data-line-number="7301"></td>
        <td id="LC7301">    <span>_ASSERTE</span>(<span>MscorlibBinder::IsClass</span>(ftn-&gt;<span>GetMethodTable</span>(), CLASS__RUNTIME_HELPERS));</td>
      </tr>
      <tr>
        <td id="L7302" data-line-number="7302"></td>
        <td id="LC7302">
</td>
      </tr>
      <tr>
        <td id="L7303" data-line-number="7303"></td>
        <td id="LC7303">    mdMethodDef tk = ftn-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L7304" data-line-number="7304"></td>
        <td id="LC7304">
</td>
      </tr>
      <tr>
        <td id="L7305" data-line-number="7305"></td>
        <td id="LC7305">    <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__RUNTIME_HELPERS__IS_REFERENCE_OR_CONTAINS_REFERENCES)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7306" data-line-number="7306"></td>
        <td id="LC7306">    {</td>
      </tr>
      <tr>
        <td id="L7307" data-line-number="7307"></td>
        <td id="LC7307">        <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L7308" data-line-number="7308"></td>
        <td id="LC7308">        Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L7309" data-line-number="7309"></td>
        <td id="LC7309">
</td>
      </tr>
      <tr>
        <td id="L7310" data-line-number="7310"></td>
        <td id="LC7310">        <span>_ASSERTE</span>(ftn-&gt;<span>GetNumGenericMethodArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L7311" data-line-number="7311"></td>
        <td id="LC7311">        TypeHandle typeHandle = inst[<span>0</span>];</td>
      </tr>
      <tr>
        <td id="L7312" data-line-number="7312"></td>
        <td id="LC7312">        MethodTable * methodTable = typeHandle.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L7313" data-line-number="7313"></td>
        <td id="LC7313">
</td>
      </tr>
      <tr>
        <td id="L7314" data-line-number="7314"></td>
        <td id="LC7314">        <span>static</span> <span>const</span> BYTE returnTrue[] = { CEE_LDC_I4_1, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7315" data-line-number="7315"></td>
        <td id="LC7315">        <span>static</span> <span>const</span> BYTE returnFalse[] = { CEE_LDC_I4_0, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7316" data-line-number="7316"></td>
        <td id="LC7316">
</td>
      </tr>
      <tr>
        <td id="L7317" data-line-number="7317"></td>
        <td id="LC7317">        <span>if</span> (!methodTable-&gt;<span>IsValueType</span>() || methodTable-&gt;<span>ContainsPointers</span>())</td>
      </tr>
      <tr>
        <td id="L7318" data-line-number="7318"></td>
        <td id="LC7318">        {</td>
      </tr>
      <tr>
        <td id="L7319" data-line-number="7319"></td>
        <td id="LC7319">            methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(returnTrue);</td>
      </tr>
      <tr>
        <td id="L7320" data-line-number="7320"></td>
        <td id="LC7320">        }</td>
      </tr>
      <tr>
        <td id="L7321" data-line-number="7321"></td>
        <td id="LC7321">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L7322" data-line-number="7322"></td>
        <td id="LC7322">        {</td>
      </tr>
      <tr>
        <td id="L7323" data-line-number="7323"></td>
        <td id="LC7323">            methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(returnFalse);</td>
      </tr>
      <tr>
        <td id="L7324" data-line-number="7324"></td>
        <td id="LC7324">        }</td>
      </tr>
      <tr>
        <td id="L7325" data-line-number="7325"></td>
        <td id="LC7325">
</td>
      </tr>
      <tr>
        <td id="L7326" data-line-number="7326"></td>
        <td id="LC7326">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(returnTrue);</td>
      </tr>
      <tr>
        <td id="L7327" data-line-number="7327"></td>
        <td id="LC7327">        methInfo-&gt;<span>maxStack</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L7328" data-line-number="7328"></td>
        <td id="LC7328">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7329" data-line-number="7329"></td>
        <td id="LC7329">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7330" data-line-number="7330"></td>
        <td id="LC7330">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7331" data-line-number="7331"></td>
        <td id="LC7331">    }</td>
      </tr>
      <tr>
        <td id="L7332" data-line-number="7332"></td>
        <td id="LC7332">
</td>
      </tr>
      <tr>
        <td id="L7333" data-line-number="7333"></td>
        <td id="LC7333">    <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__RUNTIME_HELPERS__IS_BITWISE_EQUATABLE)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7334" data-line-number="7334"></td>
        <td id="LC7334">    {</td>
      </tr>
      <tr>
        <td id="L7335" data-line-number="7335"></td>
        <td id="LC7335">        <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L7336" data-line-number="7336"></td>
        <td id="LC7336">        Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L7337" data-line-number="7337"></td>
        <td id="LC7337">
</td>
      </tr>
      <tr>
        <td id="L7338" data-line-number="7338"></td>
        <td id="LC7338">        <span>_ASSERTE</span>(ftn-&gt;<span>GetNumGenericMethodArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L7339" data-line-number="7339"></td>
        <td id="LC7339">        TypeHandle typeHandle = inst[<span>0</span>];</td>
      </tr>
      <tr>
        <td id="L7340" data-line-number="7340"></td>
        <td id="LC7340">        MethodTable * methodTable = typeHandle.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L7341" data-line-number="7341"></td>
        <td id="LC7341">
</td>
      </tr>
      <tr>
        <td id="L7342" data-line-number="7342"></td>
        <td id="LC7342">        <span>static</span> <span>const</span> BYTE returnTrue[] = { CEE_LDC_I4_1, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7343" data-line-number="7343"></td>
        <td id="LC7343">        <span>static</span> <span>const</span> BYTE returnFalse[] = { CEE_LDC_I4_0, CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7344" data-line-number="7344"></td>
        <td id="LC7344">
</td>
      </tr>
      <tr>
        <td id="L7345" data-line-number="7345"></td>
        <td id="LC7345">        <span><span>//</span> Ideally we could detect automatically whether a type is trivially equatable</span></td>
      </tr>
      <tr>
        <td id="L7346" data-line-number="7346"></td>
        <td id="LC7346">        <span><span>//</span> (i.e., its operator == could be implemented via memcmp). But for now we'll</span></td>
      </tr>
      <tr>
        <td id="L7347" data-line-number="7347"></td>
        <td id="LC7347">        <span><span>//</span> do the simple thing and hardcode the list of types we know fulfill this contract.</span></td>
      </tr>
      <tr>
        <td id="L7348" data-line-number="7348"></td>
        <td id="LC7348">        <span><span>//</span> n.b. This doesn't imply that the type's CompareTo method can be memcmp-implemented,</span></td>
      </tr>
      <tr>
        <td id="L7349" data-line-number="7349"></td>
        <td id="LC7349">        <span><span>//</span> as a method like CompareTo may need to take a type's signedness into account.</span></td>
      </tr>
      <tr>
        <td id="L7350" data-line-number="7350"></td>
        <td id="LC7350">
</td>
      </tr>
      <tr>
        <td id="L7351" data-line-number="7351"></td>
        <td id="LC7351">        <span>if</span> (methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__BOOLEAN)</td>
      </tr>
      <tr>
        <td id="L7352" data-line-number="7352"></td>
        <td id="LC7352">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__BYTE)</td>
      </tr>
      <tr>
        <td id="L7353" data-line-number="7353"></td>
        <td id="LC7353">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__SBYTE)</td>
      </tr>
      <tr>
        <td id="L7354" data-line-number="7354"></td>
        <td id="LC7354">#<span>ifdef</span> FEATURE_UTF8STRING</td>
      </tr>
      <tr>
        <td id="L7355" data-line-number="7355"></td>
        <td id="LC7355">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__CHAR8)</td>
      </tr>
      <tr>
        <td id="L7356" data-line-number="7356"></td>
        <td id="LC7356">#<span>endif</span> <span><span>//</span> FEATURE_UTF8STRING</span></td>
      </tr>
      <tr>
        <td id="L7357" data-line-number="7357"></td>
        <td id="LC7357">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__CHAR)</td>
      </tr>
      <tr>
        <td id="L7358" data-line-number="7358"></td>
        <td id="LC7358">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__INT16)</td>
      </tr>
      <tr>
        <td id="L7359" data-line-number="7359"></td>
        <td id="LC7359">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__UINT16)</td>
      </tr>
      <tr>
        <td id="L7360" data-line-number="7360"></td>
        <td id="LC7360">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__INT32)</td>
      </tr>
      <tr>
        <td id="L7361" data-line-number="7361"></td>
        <td id="LC7361">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__UINT32)</td>
      </tr>
      <tr>
        <td id="L7362" data-line-number="7362"></td>
        <td id="LC7362">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__INT64)</td>
      </tr>
      <tr>
        <td id="L7363" data-line-number="7363"></td>
        <td id="LC7363">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__UINT64)</td>
      </tr>
      <tr>
        <td id="L7364" data-line-number="7364"></td>
        <td id="LC7364">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__INTPTR)</td>
      </tr>
      <tr>
        <td id="L7365" data-line-number="7365"></td>
        <td id="LC7365">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__UINTPTR)</td>
      </tr>
      <tr>
        <td id="L7366" data-line-number="7366"></td>
        <td id="LC7366">            || methodTable == <span>MscorlibBinder::GetClass</span>(CLASS__RUNE)</td>
      </tr>
      <tr>
        <td id="L7367" data-line-number="7367"></td>
        <td id="LC7367">            || methodTable-&gt;<span>IsEnum</span>())</td>
      </tr>
      <tr>
        <td id="L7368" data-line-number="7368"></td>
        <td id="LC7368">        {</td>
      </tr>
      <tr>
        <td id="L7369" data-line-number="7369"></td>
        <td id="LC7369">            methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(returnTrue);</td>
      </tr>
      <tr>
        <td id="L7370" data-line-number="7370"></td>
        <td id="LC7370">        }</td>
      </tr>
      <tr>
        <td id="L7371" data-line-number="7371"></td>
        <td id="LC7371">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L7372" data-line-number="7372"></td>
        <td id="LC7372">        {</td>
      </tr>
      <tr>
        <td id="L7373" data-line-number="7373"></td>
        <td id="LC7373">            methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(returnFalse);</td>
      </tr>
      <tr>
        <td id="L7374" data-line-number="7374"></td>
        <td id="LC7374">        }</td>
      </tr>
      <tr>
        <td id="L7375" data-line-number="7375"></td>
        <td id="LC7375">
</td>
      </tr>
      <tr>
        <td id="L7376" data-line-number="7376"></td>
        <td id="LC7376">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(returnTrue);</td>
      </tr>
      <tr>
        <td id="L7377" data-line-number="7377"></td>
        <td id="LC7377">        methInfo-&gt;<span>maxStack</span> = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L7378" data-line-number="7378"></td>
        <td id="LC7378">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7379" data-line-number="7379"></td>
        <td id="LC7379">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7380" data-line-number="7380"></td>
        <td id="LC7380">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7381" data-line-number="7381"></td>
        <td id="LC7381">    }</td>
      </tr>
      <tr>
        <td id="L7382" data-line-number="7382"></td>
        <td id="LC7382">
</td>
      </tr>
      <tr>
        <td id="L7383" data-line-number="7383"></td>
        <td id="LC7383">    <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__RUNTIME_HELPERS__GET_METHOD_TABLE)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7384" data-line-number="7384"></td>
        <td id="LC7384">    {</td>
      </tr>
      <tr>
        <td id="L7385" data-line-number="7385"></td>
        <td id="LC7385">        mdToken tokRawData = <span>MscorlibBinder::GetField</span>(FIELD__RAW_DATA__DATA)-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L7386" data-line-number="7386"></td>
        <td id="LC7386">
</td>
      </tr>
      <tr>
        <td id="L7387" data-line-number="7387"></td>
        <td id="LC7387">        <span><span>//</span> In the CLR, an object is laid out as follows.</span></td>
      </tr>
      <tr>
        <td id="L7388" data-line-number="7388"></td>
        <td id="LC7388">        <span><span>//</span> [ object_header || MethodTable* (64-bit pointer) || instance_data ]</span></td>
      </tr>
      <tr>
        <td id="L7389" data-line-number="7389"></td>
        <td id="LC7389">        <span><span>//</span>                    ^                                ^-- ref &lt;theObj&gt;.firstField points here</span></td>
      </tr>
      <tr>
        <td id="L7390" data-line-number="7390"></td>
        <td id="LC7390">        <span><span>//</span>                    `-- &lt;theObj&gt; reference (type O) points here</span></td>
      </tr>
      <tr>
        <td id="L7391" data-line-number="7391"></td>
        <td id="LC7391">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7392" data-line-number="7392"></td>
        <td id="LC7392">        <span><span>//</span> So essentially what we want to do is to turn an object reference (type O) into a</span></td>
      </tr>
      <tr>
        <td id="L7393" data-line-number="7393"></td>
        <td id="LC7393">        <span><span>//</span> native int&amp;, then dereference it to get the MethodTable*. (Essentially, an object</span></td>
      </tr>
      <tr>
        <td id="L7394" data-line-number="7394"></td>
        <td id="LC7394">        <span><span>//</span> reference is a MethodTable**.) Per ECMA-335, Sec. III.1.5, we can add</span></td>
      </tr>
      <tr>
        <td id="L7395" data-line-number="7395"></td>
        <td id="LC7395">        <span><span>//</span> (but not subtract) a &amp; and an int32 to produce a &amp;. So we'll get a reference to</span></td>
      </tr>
      <tr>
        <td id="L7396" data-line-number="7396"></td>
        <td id="LC7396">        <span><span>//</span> &lt;theObj&gt;.firstField (type &amp;), then back up one pointer length to get a value of</span></td>
      </tr>
      <tr>
        <td id="L7397" data-line-number="7397"></td>
        <td id="LC7397">        <span><span>//</span> essentially type (MethodTable*)&amp;. Both of these are legal GC-trackable references</span></td>
      </tr>
      <tr>
        <td id="L7398" data-line-number="7398"></td>
        <td id="LC7398">        <span><span>//</span> to &lt;theObj&gt;, regardless of &lt;theObj&gt;'s actual length.</span></td>
      </tr>
      <tr>
        <td id="L7399" data-line-number="7399"></td>
        <td id="LC7399">
</td>
      </tr>
      <tr>
        <td id="L7400" data-line-number="7400"></td>
        <td id="LC7400">        <span>static</span> BYTE ilcode[] = { CEE_LDARG_0,         <span><span>//</span> stack contains [ O ] = &lt;theObj&gt;</span></td>
      </tr>
      <tr>
        <td id="L7401" data-line-number="7401"></td>
        <td id="LC7401">                                 CEE_LDFLDA,<span>0</span>,<span>0</span>,<span>0</span>,<span>0</span>,  <span><span>//</span> stack contains [ &amp; ] = ref &lt;theObj&gt;.firstField</span></td>
      </tr>
      <tr>
        <td id="L7402" data-line-number="7402"></td>
        <td id="LC7402">                                 CEE_LDC_I4_S,(BYTE)(-TARGET_POINTER_SIZE), <span><span>//</span> stack contains [ &amp;, int32 ] = -IntPtr.Size</span></td>
      </tr>
      <tr>
        <td id="L7403" data-line-number="7403"></td>
        <td id="LC7403">                                 CEE_ADD,             <span><span>//</span> stack contains [ &amp; ] = ref &lt;theObj&gt;.methodTablePtr</span></td>
      </tr>
      <tr>
        <td id="L7404" data-line-number="7404"></td>
        <td id="LC7404">                                 CEE_LDIND_I,         <span><span>//</span> stack contains [ native int ] = &lt;theObj&gt;.methodTablePtr</span></td>
      </tr>
      <tr>
        <td id="L7405" data-line-number="7405"></td>
        <td id="LC7405">                                 CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7406" data-line-number="7406"></td>
        <td id="LC7406">
</td>
      </tr>
      <tr>
        <td id="L7407" data-line-number="7407"></td>
        <td id="LC7407">        ilcode[<span>2</span>] = (BYTE)(tokRawData);</td>
      </tr>
      <tr>
        <td id="L7408" data-line-number="7408"></td>
        <td id="LC7408">        ilcode[<span>3</span>] = (BYTE)(tokRawData &gt;&gt; <span>8</span>);</td>
      </tr>
      <tr>
        <td id="L7409" data-line-number="7409"></td>
        <td id="LC7409">        ilcode[<span>4</span>] = (BYTE)(tokRawData &gt;&gt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L7410" data-line-number="7410"></td>
        <td id="LC7410">        ilcode[<span>5</span>] = (BYTE)(tokRawData &gt;&gt; <span>24</span>);</td>
      </tr>
      <tr>
        <td id="L7411" data-line-number="7411"></td>
        <td id="LC7411">
</td>
      </tr>
      <tr>
        <td id="L7412" data-line-number="7412"></td>
        <td id="LC7412">        methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7413" data-line-number="7413"></td>
        <td id="LC7413">        methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7414" data-line-number="7414"></td>
        <td id="LC7414">        methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7415" data-line-number="7415"></td>
        <td id="LC7415">        methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7416" data-line-number="7416"></td>
        <td id="LC7416">        methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7417" data-line-number="7417"></td>
        <td id="LC7417">        <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7418" data-line-number="7418"></td>
        <td id="LC7418">    }</td>
      </tr>
      <tr>
        <td id="L7419" data-line-number="7419"></td>
        <td id="LC7419">
</td>
      </tr>
      <tr>
        <td id="L7420" data-line-number="7420"></td>
        <td id="LC7420">    <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__RUNTIME_HELPERS__ENUM_EQUALS)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7421" data-line-number="7421"></td>
        <td id="LC7421">    {</td>
      </tr>
      <tr>
        <td id="L7422" data-line-number="7422"></td>
        <td id="LC7422">        <span><span>//</span> Normally we would follow the above pattern and unconditionally replace the IL,</span></td>
      </tr>
      <tr>
        <td id="L7423" data-line-number="7423"></td>
        <td id="LC7423">        <span><span>//</span> relying on generic type constraints to guarantee that it will only ever be instantiated</span></td>
      </tr>
      <tr>
        <td id="L7424" data-line-number="7424"></td>
        <td id="LC7424">        <span><span>//</span> on the type/size of argument we expect.</span></td>
      </tr>
      <tr>
        <td id="L7425" data-line-number="7425"></td>
        <td id="LC7425">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7426" data-line-number="7426"></td>
        <td id="LC7426">        <span><span>//</span> However C#/CLR does not support restricting a generic type to be an Enum, so the best</span></td>
      </tr>
      <tr>
        <td id="L7427" data-line-number="7427"></td>
        <td id="LC7427">        <span><span>//</span> we can do is constrain it to be a value type.  This is fine for run time, since we only</span></td>
      </tr>
      <tr>
        <td id="L7428" data-line-number="7428"></td>
        <td id="LC7428">        <span><span>//</span> ever create instantiations on 4 byte or less Enums. But during NGen we may compile instantiations</span></td>
      </tr>
      <tr>
        <td id="L7429" data-line-number="7429"></td>
        <td id="LC7429">        <span><span>//</span> on other value types (to be specific, every value type instatiation of EqualityComparer</span></td>
      </tr>
      <tr>
        <td id="L7430" data-line-number="7430"></td>
        <td id="LC7430">        <span><span>//</span> because of its TypeDependencyAttribute; here again we would like to restrict this to</span></td>
      </tr>
      <tr>
        <td id="L7431" data-line-number="7431"></td>
        <td id="LC7431">        <span><span>//</span> 4 byte or less Enums but cannot).</span></td>
      </tr>
      <tr>
        <td id="L7432" data-line-number="7432"></td>
        <td id="LC7432">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7433" data-line-number="7433"></td>
        <td id="LC7433">        <span><span>//</span> This IL is invalid for those instantiations, and replacing it would lead to all sorts of</span></td>
      </tr>
      <tr>
        <td id="L7434" data-line-number="7434"></td>
        <td id="LC7434">        <span><span>//</span> errors at NGen time.  So we only replace it for instantiations where it would be valid,</span></td>
      </tr>
      <tr>
        <td id="L7435" data-line-number="7435"></td>
        <td id="LC7435">        <span><span>//</span> leaving the others, which we should never execute, with the C# implementation of throwing.</span></td>
      </tr>
      <tr>
        <td id="L7436" data-line-number="7436"></td>
        <td id="LC7436">
</td>
      </tr>
      <tr>
        <td id="L7437" data-line-number="7437"></td>
        <td id="LC7437">        <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L7438" data-line-number="7438"></td>
        <td id="LC7438">        Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L7439" data-line-number="7439"></td>
        <td id="LC7439">
</td>
      </tr>
      <tr>
        <td id="L7440" data-line-number="7440"></td>
        <td id="LC7440">        <span>_ASSERTE</span>(inst.<span>GetNumArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L7441" data-line-number="7441"></td>
        <td id="LC7441">        CorElementType et = inst[<span>0</span>].<span>GetVerifierCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L7442" data-line-number="7442"></td>
        <td id="LC7442">        <span>if</span> (et == ELEMENT_TYPE_I4 ||</td>
      </tr>
      <tr>
        <td id="L7443" data-line-number="7443"></td>
        <td id="LC7443">            et == ELEMENT_TYPE_U4 ||</td>
      </tr>
      <tr>
        <td id="L7444" data-line-number="7444"></td>
        <td id="LC7444">            et == ELEMENT_TYPE_I2 ||</td>
      </tr>
      <tr>
        <td id="L7445" data-line-number="7445"></td>
        <td id="LC7445">            et == ELEMENT_TYPE_U2 ||</td>
      </tr>
      <tr>
        <td id="L7446" data-line-number="7446"></td>
        <td id="LC7446">            et == ELEMENT_TYPE_I1 ||</td>
      </tr>
      <tr>
        <td id="L7447" data-line-number="7447"></td>
        <td id="LC7447">            et == ELEMENT_TYPE_U1 ||</td>
      </tr>
      <tr>
        <td id="L7448" data-line-number="7448"></td>
        <td id="LC7448">            et == ELEMENT_TYPE_I8 ||</td>
      </tr>
      <tr>
        <td id="L7449" data-line-number="7449"></td>
        <td id="LC7449">            et == ELEMENT_TYPE_U8)</td>
      </tr>
      <tr>
        <td id="L7450" data-line-number="7450"></td>
        <td id="LC7450">        {</td>
      </tr>
      <tr>
        <td id="L7451" data-line-number="7451"></td>
        <td id="LC7451">            <span>static</span> <span>const</span> BYTE ilcode[] = { CEE_LDARG_0, CEE_LDARG_1, CEE_PREFIX1, (CEE_CEQ &amp; <span>0xFF</span>), CEE_RET };</td>
      </tr>
      <tr>
        <td id="L7452" data-line-number="7452"></td>
        <td id="LC7452">            methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode);</td>
      </tr>
      <tr>
        <td id="L7453" data-line-number="7453"></td>
        <td id="LC7453">            methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode);</td>
      </tr>
      <tr>
        <td id="L7454" data-line-number="7454"></td>
        <td id="LC7454">            methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7455" data-line-number="7455"></td>
        <td id="LC7455">            methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7456" data-line-number="7456"></td>
        <td id="LC7456">            methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7457" data-line-number="7457"></td>
        <td id="LC7457">            <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7458" data-line-number="7458"></td>
        <td id="LC7458">        }</td>
      </tr>
      <tr>
        <td id="L7459" data-line-number="7459"></td>
        <td id="LC7459">    }</td>
      </tr>
      <tr>
        <td id="L7460" data-line-number="7460"></td>
        <td id="LC7460">    <span>else</span> <span>if</span> (tk == <span>MscorlibBinder::GetMethod</span>(METHOD__RUNTIME_HELPERS__ENUM_COMPARE_TO)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7461" data-line-number="7461"></td>
        <td id="LC7461">    {</td>
      </tr>
      <tr>
        <td id="L7462" data-line-number="7462"></td>
        <td id="LC7462">        <span><span>//</span> The the comment above on why this is is not an unconditional replacement.  This case handles</span></td>
      </tr>
      <tr>
        <td id="L7463" data-line-number="7463"></td>
        <td id="LC7463">        <span><span>//</span> Enums backed by 8 byte values.</span></td>
      </tr>
      <tr>
        <td id="L7464" data-line-number="7464"></td>
        <td id="LC7464">
</td>
      </tr>
      <tr>
        <td id="L7465" data-line-number="7465"></td>
        <td id="LC7465">        <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L7466" data-line-number="7466"></td>
        <td id="LC7466">        Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L7467" data-line-number="7467"></td>
        <td id="LC7467">
</td>
      </tr>
      <tr>
        <td id="L7468" data-line-number="7468"></td>
        <td id="LC7468">        <span>_ASSERTE</span>(inst.<span>GetNumArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L7469" data-line-number="7469"></td>
        <td id="LC7469">        CorElementType et = inst[<span>0</span>].<span>GetVerifierCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L7470" data-line-number="7470"></td>
        <td id="LC7470">        <span>if</span> (et == ELEMENT_TYPE_I4 ||</td>
      </tr>
      <tr>
        <td id="L7471" data-line-number="7471"></td>
        <td id="LC7471">            et == ELEMENT_TYPE_U4 ||</td>
      </tr>
      <tr>
        <td id="L7472" data-line-number="7472"></td>
        <td id="LC7472">            et == ELEMENT_TYPE_I2 ||</td>
      </tr>
      <tr>
        <td id="L7473" data-line-number="7473"></td>
        <td id="LC7473">            et == ELEMENT_TYPE_U2 ||</td>
      </tr>
      <tr>
        <td id="L7474" data-line-number="7474"></td>
        <td id="LC7474">            et == ELEMENT_TYPE_I1 ||</td>
      </tr>
      <tr>
        <td id="L7475" data-line-number="7475"></td>
        <td id="LC7475">            et == ELEMENT_TYPE_U1 ||</td>
      </tr>
      <tr>
        <td id="L7476" data-line-number="7476"></td>
        <td id="LC7476">            et == ELEMENT_TYPE_I8 ||</td>
      </tr>
      <tr>
        <td id="L7477" data-line-number="7477"></td>
        <td id="LC7477">            et == ELEMENT_TYPE_U8)</td>
      </tr>
      <tr>
        <td id="L7478" data-line-number="7478"></td>
        <td id="LC7478">        {</td>
      </tr>
      <tr>
        <td id="L7479" data-line-number="7479"></td>
        <td id="LC7479">            <span>static</span> BYTE ilcode[<span>8</span>][<span>9</span>];</td>
      </tr>
      <tr>
        <td id="L7480" data-line-number="7480"></td>
        <td id="LC7480">
</td>
      </tr>
      <tr>
        <td id="L7481" data-line-number="7481"></td>
        <td id="LC7481">            TypeHandle thUnderlyingType = <span>MscorlibBinder::GetElementType</span>(et);</td>
      </tr>
      <tr>
        <td id="L7482" data-line-number="7482"></td>
        <td id="LC7482">
</td>
      </tr>
      <tr>
        <td id="L7483" data-line-number="7483"></td>
        <td id="LC7483">            TypeHandle thIComparable = <span>TypeHandle</span>(<span>MscorlibBinder::GetClass</span>(CLASS__ICOMPARABLEGENERIC)).<span>Instantiate</span>(<span>Instantiation</span>(&amp;thUnderlyingType, <span>1</span>));</td>
      </tr>
      <tr>
        <td id="L7484" data-line-number="7484"></td>
        <td id="LC7484">
</td>
      </tr>
      <tr>
        <td id="L7485" data-line-number="7485"></td>
        <td id="LC7485">            MethodDesc* pCompareToMD = thUnderlyingType.<span>AsMethodTable</span>()-&gt;<span>GetMethodDescForInterfaceMethod</span>(</td>
      </tr>
      <tr>
        <td id="L7486" data-line-number="7486"></td>
        <td id="LC7486">                thIComparable, <span>MscorlibBinder::GetMethod</span>(METHOD__ICOMPARABLEGENERIC__COMPARE_TO), <span>TRUE</span> <span><span>/*</span> throwOnConflict <span>*/</span></span>);</td>
      </tr>
      <tr>
        <td id="L7487" data-line-number="7487"></td>
        <td id="LC7487">
</td>
      </tr>
      <tr>
        <td id="L7488" data-line-number="7488"></td>
        <td id="LC7488">            <span><span>//</span> Call CompareTo method on the primitive type</span></td>
      </tr>
      <tr>
        <td id="L7489" data-line-number="7489"></td>
        <td id="LC7489">            <span>int</span> tokCompareTo = pCompareToMD-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L7490" data-line-number="7490"></td>
        <td id="LC7490">
</td>
      </tr>
      <tr>
        <td id="L7491" data-line-number="7491"></td>
        <td id="LC7491">            <span>unsigned</span> <span>int</span> <span>index</span> = (et - ELEMENT_TYPE_I1);</td>
      </tr>
      <tr>
        <td id="L7492" data-line-number="7492"></td>
        <td id="LC7492">            <span>_ASSERTE</span>(<span>index</span> &lt; <span>_countof</span>(ilcode));</td>
      </tr>
      <tr>
        <td id="L7493" data-line-number="7493"></td>
        <td id="LC7493">
</td>
      </tr>
      <tr>
        <td id="L7494" data-line-number="7494"></td>
        <td id="LC7494">            ilcode[<span>index</span>][<span>0</span>] = CEE_LDARGA_S;</td>
      </tr>
      <tr>
        <td id="L7495" data-line-number="7495"></td>
        <td id="LC7495">            ilcode[<span>index</span>][<span>1</span>] = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7496" data-line-number="7496"></td>
        <td id="LC7496">            ilcode[<span>index</span>][<span>2</span>] = CEE_LDARG_1;</td>
      </tr>
      <tr>
        <td id="L7497" data-line-number="7497"></td>
        <td id="LC7497">            ilcode[<span>index</span>][<span>3</span>] = CEE_CALL;</td>
      </tr>
      <tr>
        <td id="L7498" data-line-number="7498"></td>
        <td id="LC7498">            ilcode[<span>index</span>][<span>4</span>] = (BYTE)(tokCompareTo);</td>
      </tr>
      <tr>
        <td id="L7499" data-line-number="7499"></td>
        <td id="LC7499">            ilcode[<span>index</span>][<span>5</span>] = (BYTE)(tokCompareTo &gt;&gt; <span>8</span>);</td>
      </tr>
      <tr>
        <td id="L7500" data-line-number="7500"></td>
        <td id="LC7500">            ilcode[<span>index</span>][<span>6</span>] = (BYTE)(tokCompareTo &gt;&gt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L7501" data-line-number="7501"></td>
        <td id="LC7501">            ilcode[<span>index</span>][<span>7</span>] = (BYTE)(tokCompareTo &gt;&gt; <span>24</span>);</td>
      </tr>
      <tr>
        <td id="L7502" data-line-number="7502"></td>
        <td id="LC7502">            ilcode[<span>index</span>][<span>8</span>] = CEE_RET;</td>
      </tr>
      <tr>
        <td id="L7503" data-line-number="7503"></td>
        <td id="LC7503">
</td>
      </tr>
      <tr>
        <td id="L7504" data-line-number="7504"></td>
        <td id="LC7504">            methInfo-&gt;<span>ILCode</span> = <span>const_cast</span>&lt;BYTE*&gt;(ilcode[<span>index</span>]);</td>
      </tr>
      <tr>
        <td id="L7505" data-line-number="7505"></td>
        <td id="LC7505">            methInfo-&gt;<span>ILCodeSize</span> = <span>sizeof</span>(ilcode[<span>index</span>]);</td>
      </tr>
      <tr>
        <td id="L7506" data-line-number="7506"></td>
        <td id="LC7506">            methInfo-&gt;<span>maxStack</span> = <span>2</span>;</td>
      </tr>
      <tr>
        <td id="L7507" data-line-number="7507"></td>
        <td id="LC7507">            methInfo-&gt;<span>EHcount</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7508" data-line-number="7508"></td>
        <td id="LC7508">            methInfo-&gt;<span>options</span> = (CorInfoOptions)<span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7509" data-line-number="7509"></td>
        <td id="LC7509">            <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7510" data-line-number="7510"></td>
        <td id="LC7510">        }</td>
      </tr>
      <tr>
        <td id="L7511" data-line-number="7511"></td>
        <td id="LC7511">    }</td>
      </tr>
      <tr>
        <td id="L7512" data-line-number="7512"></td>
        <td id="LC7512">
</td>
      </tr>
      <tr>
        <td id="L7513" data-line-number="7513"></td>
        <td id="LC7513">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7514" data-line-number="7514"></td>
        <td id="LC7514">}</td>
      </tr>
      <tr>
        <td id="L7515" data-line-number="7515"></td>
        <td id="LC7515">
</td>
      </tr>
      <tr>
        <td id="L7516" data-line-number="7516"></td>
        <td id="LC7516"><span>bool</span> <span>getILIntrinsicImplementationForActivator</span>(MethodDesc* ftn,</td>
      </tr>
      <tr>
        <td id="L7517" data-line-number="7517"></td>
        <td id="LC7517">    CORINFO_METHOD_INFO* methInfo,</td>
      </tr>
      <tr>
        <td id="L7518" data-line-number="7518"></td>
        <td id="LC7518">    SigPointer* pSig)</td>
      </tr>
      <tr>
        <td id="L7519" data-line-number="7519"></td>
        <td id="LC7519">{</td>
      </tr>
      <tr>
        <td id="L7520" data-line-number="7520"></td>
        <td id="LC7520">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L7521" data-line-number="7521"></td>
        <td id="LC7521">
</td>
      </tr>
      <tr>
        <td id="L7522" data-line-number="7522"></td>
        <td id="LC7522">    <span>_ASSERTE</span>(<span>MscorlibBinder::IsClass</span>(ftn-&gt;<span>GetMethodTable</span>(), CLASS__ACTIVATOR));</td>
      </tr>
      <tr>
        <td id="L7523" data-line-number="7523"></td>
        <td id="LC7523">
</td>
      </tr>
      <tr>
        <td id="L7524" data-line-number="7524"></td>
        <td id="LC7524">    <span><span>//</span> We are only interested if ftn's token and CreateInstance&lt;T&gt; token match</span></td>
      </tr>
      <tr>
        <td id="L7525" data-line-number="7525"></td>
        <td id="LC7525">    <span>if</span> (ftn-&gt;<span>GetMemberDef</span>() != <span>MscorlibBinder::GetMethod</span>(METHOD__ACTIVATOR__CREATE_INSTANCE_OF_T)-&gt;<span>GetMemberDef</span>())</td>
      </tr>
      <tr>
        <td id="L7526" data-line-number="7526"></td>
        <td id="LC7526">        <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7527" data-line-number="7527"></td>
        <td id="LC7527">
</td>
      </tr>
      <tr>
        <td id="L7528" data-line-number="7528"></td>
        <td id="LC7528">    <span>_ASSERTE</span>(ftn-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L7529" data-line-number="7529"></td>
        <td id="LC7529">    Instantiation inst = ftn-&gt;<span>GetMethodInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L7530" data-line-number="7530"></td>
        <td id="LC7530">
</td>
      </tr>
      <tr>
        <td id="L7531" data-line-number="7531"></td>
        <td id="LC7531">    <span>_ASSERTE</span>(ftn-&gt;<span>GetNumGenericMethodArgs</span>() == <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L7532" data-line-number="7532"></td>
        <td id="LC7532">    TypeHandle typeHandle = inst[<span>0</span>];</td>
      </tr>
      <tr>
        <td id="L7533" data-line-number="7533"></td>
        <td id="LC7533">    MethodTable* methodTable = typeHandle.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L7534" data-line-number="7534"></td>
        <td id="LC7534">
</td>
      </tr>
      <tr>
        <td id="L7535" data-line-number="7535"></td>
        <td id="LC7535">    <span>if</span> (!methodTable-&gt;<span>IsValueType</span>() || methodTable-&gt;<span>HasDefaultConstructor</span>())</td>
      </tr>
      <tr>
        <td id="L7536" data-line-number="7536"></td>
        <td id="LC7536">        <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7537" data-line-number="7537"></td>
        <td id="LC7537">
</td>
      </tr>
      <tr>
        <td id="L7538" data-line-number="7538"></td>
        <td id="LC7538">    <span><span>//</span> Replace the body with implementation that just returns "default"</span></td>
      </tr>
      <tr>
        <td id="L7539" data-line-number="7539"></td>
        <td id="LC7539">    MethodDesc* createDefaultInstance = <span>MscorlibBinder::GetMethod</span>(METHOD__ACTIVATOR__CREATE_DEFAULT_INSTANCE_OF_T);</td>
      </tr>
      <tr>
        <td id="L7540" data-line-number="7540"></td>
        <td id="LC7540">    COR_ILMETHOD_DECODER <span>header</span>(createDefaultInstance-&gt;<span>GetILHeader</span>(<span>FALSE</span>), createDefaultInstance-&gt;<span>GetMDImport</span>(), <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L7541" data-line-number="7541"></td>
        <td id="LC7541">    <span>getMethodInfoILMethodHeaderHelper</span>(&amp;header, methInfo);</td>
      </tr>
      <tr>
        <td id="L7542" data-line-number="7542"></td>
        <td id="LC7542">    *pSig = <span>SigPointer</span>(header.<span>LocalVarSig</span>, header.<span>cbLocalVarSig</span>);</td>
      </tr>
      <tr>
        <td id="L7543" data-line-number="7543"></td>
        <td id="LC7543">
</td>
      </tr>
      <tr>
        <td id="L7544" data-line-number="7544"></td>
        <td id="LC7544">    <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7545" data-line-number="7545"></td>
        <td id="LC7545">}</td>
      </tr>
      <tr>
        <td id="L7546" data-line-number="7546"></td>
        <td id="LC7546">
</td>
      </tr>
      <tr>
        <td id="L7547" data-line-number="7547"></td>
        <td id="LC7547"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L7548" data-line-number="7548"></td>
        <td id="LC7548"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7549" data-line-number="7549"></td>
        <td id="LC7549"><span><span>//</span>static</span></td>
      </tr>
      <tr>
        <td id="L7550" data-line-number="7550"></td>
        <td id="LC7550"><span>void</span></td>
      </tr>
      <tr>
        <td id="L7551" data-line-number="7551"></td>
        <td id="LC7551"><span>getMethodInfoHelper</span>(</td>
      </tr>
      <tr>
        <td id="L7552" data-line-number="7552"></td>
        <td id="LC7552">    MethodDesc *           ftn,</td>
      </tr>
      <tr>
        <td id="L7553" data-line-number="7553"></td>
        <td id="LC7553">    CORINFO_METHOD_HANDLE  ftnHnd,</td>
      </tr>
      <tr>
        <td id="L7554" data-line-number="7554"></td>
        <td id="LC7554">    COR_ILMETHOD_DECODER * header,</td>
      </tr>
      <tr>
        <td id="L7555" data-line-number="7555"></td>
        <td id="LC7555">    CORINFO_METHOD_INFO *  methInfo)</td>
      </tr>
      <tr>
        <td id="L7556" data-line-number="7556"></td>
        <td id="LC7556">{</td>
      </tr>
      <tr>
        <td id="L7557" data-line-number="7557"></td>
        <td id="LC7557">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L7558" data-line-number="7558"></td>
        <td id="LC7558">
</td>
      </tr>
      <tr>
        <td id="L7559" data-line-number="7559"></td>
        <td id="LC7559">    <span>_ASSERTE</span>(ftn == <span>GetMethod</span>(ftnHnd));</td>
      </tr>
      <tr>
        <td id="L7560" data-line-number="7560"></td>
        <td id="LC7560">
</td>
      </tr>
      <tr>
        <td id="L7561" data-line-number="7561"></td>
        <td id="LC7561">    methInfo-&gt;<span>ftn</span>             = ftnHnd;</td>
      </tr>
      <tr>
        <td id="L7562" data-line-number="7562"></td>
        <td id="LC7562">    methInfo-&gt;<span>scope</span>           = <span>GetScopeHandle</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L7563" data-line-number="7563"></td>
        <td id="LC7563">    methInfo-&gt;<span>regionKind</span>      = CORINFO_REGION_JIT;</td>
      </tr>
      <tr>
        <td id="L7564" data-line-number="7564"></td>
        <td id="LC7564">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7565" data-line-number="7565"></td>
        <td id="LC7565">    <span><span>//</span> For Jitted code the regionKind is JIT;</span></td>
      </tr>
      <tr>
        <td id="L7566" data-line-number="7566"></td>
        <td id="LC7566">    <span><span>//</span> For Ngen-ed code the zapper will set this to HOT or COLD, if we</span></td>
      </tr>
      <tr>
        <td id="L7567" data-line-number="7567"></td>
        <td id="LC7567">    <span><span>//</span> are using IBC data to partition methods into Hot/Cold regions</span></td>
      </tr>
      <tr>
        <td id="L7568" data-line-number="7568"></td>
        <td id="LC7568">
</td>
      </tr>
      <tr>
        <td id="L7569" data-line-number="7569"></td>
        <td id="LC7569">    <span><span>/*</span> Grab information from the IL header <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L7570" data-line-number="7570"></td>
        <td id="LC7570">
</td>
      </tr>
      <tr>
        <td id="L7571" data-line-number="7571"></td>
        <td id="LC7571">    PCCOR_SIGNATURE pLocalSig = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L7572" data-line-number="7572"></td>
        <td id="LC7572">    DWORD           cbLocalSig = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7573" data-line-number="7573"></td>
        <td id="LC7573">
</td>
      </tr>
      <tr>
        <td id="L7574" data-line-number="7574"></td>
        <td id="LC7574">    <span>if</span> (<span>NULL</span> != header)</td>
      </tr>
      <tr>
        <td id="L7575" data-line-number="7575"></td>
        <td id="LC7575">    {</td>
      </tr>
      <tr>
        <td id="L7576" data-line-number="7576"></td>
        <td id="LC7576">        <span>bool</span> <span>fILIntrinsic</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7577" data-line-number="7577"></td>
        <td id="LC7577">
</td>
      </tr>
      <tr>
        <td id="L7578" data-line-number="7578"></td>
        <td id="LC7578">        MethodTable * pMT  = ftn-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L7579" data-line-number="7579"></td>
        <td id="LC7579">
</td>
      </tr>
      <tr>
        <td id="L7580" data-line-number="7580"></td>
        <td id="LC7580">        <span>if</span> (ftn-&gt;<span>IsJitIntrinsic</span>())</td>
      </tr>
      <tr>
        <td id="L7581" data-line-number="7581"></td>
        <td id="LC7581">        {</td>
      </tr>
      <tr>
        <td id="L7582" data-line-number="7582"></td>
        <td id="LC7582">            <span>if</span> (<span>MscorlibBinder::IsClass</span>(pMT, CLASS__UNSAFE))</td>
      </tr>
      <tr>
        <td id="L7583" data-line-number="7583"></td>
        <td id="LC7583">            {</td>
      </tr>
      <tr>
        <td id="L7584" data-line-number="7584"></td>
        <td id="LC7584">                <span>fILIntrinsic</span> = <span>getILIntrinsicImplementationForUnsafe</span>(ftn, methInfo);</td>
      </tr>
      <tr>
        <td id="L7585" data-line-number="7585"></td>
        <td id="LC7585">            }</td>
      </tr>
      <tr>
        <td id="L7586" data-line-number="7586"></td>
        <td id="LC7586">            <span>else</span> <span>if</span> (<span>MscorlibBinder::IsClass</span>(pMT, CLASS__MEMORY_MARSHAL))</td>
      </tr>
      <tr>
        <td id="L7587" data-line-number="7587"></td>
        <td id="LC7587">            {</td>
      </tr>
      <tr>
        <td id="L7588" data-line-number="7588"></td>
        <td id="LC7588">                <span>fILIntrinsic</span> = <span>getILIntrinsicImplementationForMemoryMarshal</span>(ftn, methInfo);</td>
      </tr>
      <tr>
        <td id="L7589" data-line-number="7589"></td>
        <td id="LC7589">            }</td>
      </tr>
      <tr>
        <td id="L7590" data-line-number="7590"></td>
        <td id="LC7590">            <span>else</span> <span>if</span> (<span>MscorlibBinder::IsClass</span>(pMT, CLASS__INTERLOCKED))</td>
      </tr>
      <tr>
        <td id="L7591" data-line-number="7591"></td>
        <td id="LC7591">            {</td>
      </tr>
      <tr>
        <td id="L7592" data-line-number="7592"></td>
        <td id="LC7592">                <span>fILIntrinsic</span> = <span>getILIntrinsicImplementationForInterlocked</span>(ftn, methInfo);</td>
      </tr>
      <tr>
        <td id="L7593" data-line-number="7593"></td>
        <td id="LC7593">            }</td>
      </tr>
      <tr>
        <td id="L7594" data-line-number="7594"></td>
        <td id="LC7594">            <span>else</span> <span>if</span> (<span>MscorlibBinder::IsClass</span>(pMT, CLASS__VOLATILE))</td>
      </tr>
      <tr>
        <td id="L7595" data-line-number="7595"></td>
        <td id="LC7595">            {</td>
      </tr>
      <tr>
        <td id="L7596" data-line-number="7596"></td>
        <td id="LC7596">                <span>fILIntrinsic</span> = <span>getILIntrinsicImplementationForVolatile</span>(ftn, methInfo);</td>
      </tr>
      <tr>
        <td id="L7597" data-line-number="7597"></td>
        <td id="LC7597">            }</td>
      </tr>
      <tr>
        <td id="L7598" data-line-number="7598"></td>
        <td id="LC7598">            <span>else</span> <span>if</span> (<span>MscorlibBinder::IsClass</span>(pMT, CLASS__RUNTIME_HELPERS))</td>
      </tr>
      <tr>
        <td id="L7599" data-line-number="7599"></td>
        <td id="LC7599">            {</td>
      </tr>
      <tr>
        <td id="L7600" data-line-number="7600"></td>
        <td id="LC7600">                <span>fILIntrinsic</span> = <span>getILIntrinsicImplementationForRuntimeHelpers</span>(ftn, methInfo);</td>
      </tr>
      <tr>
        <td id="L7601" data-line-number="7601"></td>
        <td id="LC7601">            }</td>
      </tr>
      <tr>
        <td id="L7602" data-line-number="7602"></td>
        <td id="LC7602">            <span>else</span> <span>if</span> (<span>MscorlibBinder::IsClass</span>(pMT, CLASS__ACTIVATOR))</td>
      </tr>
      <tr>
        <td id="L7603" data-line-number="7603"></td>
        <td id="LC7603">            {</td>
      </tr>
      <tr>
        <td id="L7604" data-line-number="7604"></td>
        <td id="LC7604">                SigPointer localSig;</td>
      </tr>
      <tr>
        <td id="L7605" data-line-number="7605"></td>
        <td id="LC7605">                <span>fILIntrinsic</span> = <span>getILIntrinsicImplementationForActivator</span>(ftn, methInfo, &amp;localSig);</td>
      </tr>
      <tr>
        <td id="L7606" data-line-number="7606"></td>
        <td id="LC7606">                <span>if</span> (<span>fILIntrinsic</span>)</td>
      </tr>
      <tr>
        <td id="L7607" data-line-number="7607"></td>
        <td id="LC7607">                {</td>
      </tr>
      <tr>
        <td id="L7608" data-line-number="7608"></td>
        <td id="LC7608">                    localSig.<span>GetSignature</span>(&amp;pLocalSig, &amp;cbLocalSig);</td>
      </tr>
      <tr>
        <td id="L7609" data-line-number="7609"></td>
        <td id="LC7609">                }</td>
      </tr>
      <tr>
        <td id="L7610" data-line-number="7610"></td>
        <td id="LC7610">            }</td>
      </tr>
      <tr>
        <td id="L7611" data-line-number="7611"></td>
        <td id="LC7611">        }</td>
      </tr>
      <tr>
        <td id="L7612" data-line-number="7612"></td>
        <td id="LC7612">
</td>
      </tr>
      <tr>
        <td id="L7613" data-line-number="7613"></td>
        <td id="LC7613">        <span>if</span> (!<span>fILIntrinsic</span>)</td>
      </tr>
      <tr>
        <td id="L7614" data-line-number="7614"></td>
        <td id="LC7614">        {</td>
      </tr>
      <tr>
        <td id="L7615" data-line-number="7615"></td>
        <td id="LC7615">            <span>getMethodInfoILMethodHeaderHelper</span>(header, methInfo);</td>
      </tr>
      <tr>
        <td id="L7616" data-line-number="7616"></td>
        <td id="LC7616">            pLocalSig = header-&gt;<span>LocalVarSig</span>;</td>
      </tr>
      <tr>
        <td id="L7617" data-line-number="7617"></td>
        <td id="LC7617">            cbLocalSig = header-&gt;<span>cbLocalVarSig</span>;</td>
      </tr>
      <tr>
        <td id="L7618" data-line-number="7618"></td>
        <td id="LC7618">        }</td>
      </tr>
      <tr>
        <td id="L7619" data-line-number="7619"></td>
        <td id="LC7619">    }</td>
      </tr>
      <tr>
        <td id="L7620" data-line-number="7620"></td>
        <td id="LC7620">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L7621" data-line-number="7621"></td>
        <td id="LC7621">    {</td>
      </tr>
      <tr>
        <td id="L7622" data-line-number="7622"></td>
        <td id="LC7622">        <span>_ASSERTE</span>(ftn-&gt;<span>IsDynamicMethod</span>());</td>
      </tr>
      <tr>
        <td id="L7623" data-line-number="7623"></td>
        <td id="LC7623">
</td>
      </tr>
      <tr>
        <td id="L7624" data-line-number="7624"></td>
        <td id="LC7624">        DynamicResolver * pResolver = ftn-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>();</td>
      </tr>
      <tr>
        <td id="L7625" data-line-number="7625"></td>
        <td id="LC7625">        <span>unsigned</span> <span>int</span> EHCount;</td>
      </tr>
      <tr>
        <td id="L7626" data-line-number="7626"></td>
        <td id="LC7626">        methInfo-&gt;<span>ILCode</span> = pResolver-&gt;<span>GetCodeInfo</span>(&amp;methInfo-&gt;<span>ILCodeSize</span>,</td>
      </tr>
      <tr>
        <td id="L7627" data-line-number="7627"></td>
        <td id="LC7627">                                                  &amp;methInfo-&gt;<span>maxStack</span>,</td>
      </tr>
      <tr>
        <td id="L7628" data-line-number="7628"></td>
        <td id="LC7628">                                                  &amp;methInfo-&gt;<span>options</span>,</td>
      </tr>
      <tr>
        <td id="L7629" data-line-number="7629"></td>
        <td id="LC7629">                                                  &amp;EHCount);</td>
      </tr>
      <tr>
        <td id="L7630" data-line-number="7630"></td>
        <td id="LC7630">        methInfo-&gt;<span>EHcount</span> = (<span>unsigned</span> <span>short</span>)EHCount;</td>
      </tr>
      <tr>
        <td id="L7631" data-line-number="7631"></td>
        <td id="LC7631">        SigPointer localSig = pResolver-&gt;<span>GetLocalSig</span>();</td>
      </tr>
      <tr>
        <td id="L7632" data-line-number="7632"></td>
        <td id="LC7632">        localSig.<span>GetSignature</span>(&amp;pLocalSig, &amp;cbLocalSig);</td>
      </tr>
      <tr>
        <td id="L7633" data-line-number="7633"></td>
        <td id="LC7633">    }</td>
      </tr>
      <tr>
        <td id="L7634" data-line-number="7634"></td>
        <td id="LC7634">
</td>
      </tr>
      <tr>
        <td id="L7635" data-line-number="7635"></td>
        <td id="LC7635">    methInfo-&gt;<span>options</span> = (CorInfoOptions)(((UINT32)methInfo-&gt;<span>options</span>) |</td>
      </tr>
      <tr>
        <td id="L7636" data-line-number="7636"></td>
        <td id="LC7636">                            ((ftn-&gt;<span>AcquiresInstMethodTableFromThis</span>() ? CORINFO_GENERICS_CTXT_FROM_THIS : <span>0</span>) |</td>
      </tr>
      <tr>
        <td id="L7637" data-line-number="7637"></td>
        <td id="LC7637">                             (ftn-&gt;<span>RequiresInstMethodTableArg</span>() ? CORINFO_GENERICS_CTXT_FROM_METHODTABLE : <span>0</span>) |</td>
      </tr>
      <tr>
        <td id="L7638" data-line-number="7638"></td>
        <td id="LC7638">                             (ftn-&gt;<span>RequiresInstMethodDescArg</span>() ? CORINFO_GENERICS_CTXT_FROM_METHODDESC : <span>0</span>)));</td>
      </tr>
      <tr>
        <td id="L7639" data-line-number="7639"></td>
        <td id="LC7639">
</td>
      </tr>
      <tr>
        <td id="L7640" data-line-number="7640"></td>
        <td id="LC7640">    <span><span>//</span> EEJitManager::ResolveEHClause and CrawlFrame::GetExactGenericInstantiations</span></td>
      </tr>
      <tr>
        <td id="L7641" data-line-number="7641"></td>
        <td id="LC7641">    <span><span>//</span> need to be able to get to CORINFO_GENERICS_CTXT_MASK if there are any</span></td>
      </tr>
      <tr>
        <td id="L7642" data-line-number="7642"></td>
        <td id="LC7642">    <span><span>//</span> catch clauses like "try {} catch(MyException&lt;T&gt; e) {}".</span></td>
      </tr>
      <tr>
        <td id="L7643" data-line-number="7643"></td>
        <td id="LC7643">    <span><span>//</span> Such constructs are rare, and having to extend the lifetime of variable</span></td>
      </tr>
      <tr>
        <td id="L7644" data-line-number="7644"></td>
        <td id="LC7644">    <span><span>//</span> for such cases is reasonable</span></td>
      </tr>
      <tr>
        <td id="L7645" data-line-number="7645"></td>
        <td id="LC7645">
</td>
      </tr>
      <tr>
        <td id="L7646" data-line-number="7646"></td>
        <td id="LC7646">    <span>if</span> (methInfo-&gt;<span>options</span> &amp; CORINFO_GENERICS_CTXT_MASK)</td>
      </tr>
      <tr>
        <td id="L7647" data-line-number="7647"></td>
        <td id="LC7647">    {</td>
      </tr>
      <tr>
        <td id="L7648" data-line-number="7648"></td>
        <td id="LC7648">#<span>if</span> defined(PROFILING_SUPPORTED)</td>
      </tr>
      <tr>
        <td id="L7649" data-line-number="7649"></td>
        <td id="LC7649">        BOOL <span>fProfilerRequiresGenericsContextForEnterLeave</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L7650" data-line-number="7650"></td>
        <td id="LC7650">        {</td>
      </tr>
      <tr>
        <td id="L7651" data-line-number="7651"></td>
        <td id="LC7651">            <span>BEGIN_PIN_PROFILER</span>(<span>CORProfilerPresent</span>());</td>
      </tr>
      <tr>
        <td id="L7652" data-line-number="7652"></td>
        <td id="LC7652">            <span>if</span> (g_profControlBlock.<span>pProfInterface</span>-&gt;<span>RequiresGenericsContextForEnterLeave</span>())</td>
      </tr>
      <tr>
        <td id="L7653" data-line-number="7653"></td>
        <td id="LC7653">            {</td>
      </tr>
      <tr>
        <td id="L7654" data-line-number="7654"></td>
        <td id="LC7654">                <span>fProfilerRequiresGenericsContextForEnterLeave</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L7655" data-line-number="7655"></td>
        <td id="LC7655">            }</td>
      </tr>
      <tr>
        <td id="L7656" data-line-number="7656"></td>
        <td id="LC7656">            <span>END_PIN_PROFILER</span>();</td>
      </tr>
      <tr>
        <td id="L7657" data-line-number="7657"></td>
        <td id="LC7657">        }</td>
      </tr>
      <tr>
        <td id="L7658" data-line-number="7658"></td>
        <td id="LC7658">        <span>if</span> (<span>fProfilerRequiresGenericsContextForEnterLeave</span>)</td>
      </tr>
      <tr>
        <td id="L7659" data-line-number="7659"></td>
        <td id="LC7659">        {</td>
      </tr>
      <tr>
        <td id="L7660" data-line-number="7660"></td>
        <td id="LC7660">            methInfo-&gt;<span>options</span> = <span>CorInfoOptions</span>(methInfo-&gt;<span>options</span>|CORINFO_GENERICS_CTXT_KEEP_ALIVE);</td>
      </tr>
      <tr>
        <td id="L7661" data-line-number="7661"></td>
        <td id="LC7661">        }</td>
      </tr>
      <tr>
        <td id="L7662" data-line-number="7662"></td>
        <td id="LC7662">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L7663" data-line-number="7663"></td>
        <td id="LC7663">#<span>endif</span> <span><span>//</span> defined(PROFILING_SUPPORTED)</span></td>
      </tr>
      <tr>
        <td id="L7664" data-line-number="7664"></td>
        <td id="LC7664">        {</td>
      </tr>
      <tr>
        <td id="L7665" data-line-number="7665"></td>
        <td id="LC7665">            <span><span>//</span> Check all the exception clauses</span></td>
      </tr>
      <tr>
        <td id="L7666" data-line-number="7666"></td>
        <td id="LC7666">
</td>
      </tr>
      <tr>
        <td id="L7667" data-line-number="7667"></td>
        <td id="LC7667">            <span>if</span> (ftn-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L7668" data-line-number="7668"></td>
        <td id="LC7668">            {</td>
      </tr>
      <tr>
        <td id="L7669" data-line-number="7669"></td>
        <td id="LC7669">                <span><span>//</span> @TODO: how do we detect the need to mark this flag?</span></td>
      </tr>
      <tr>
        <td id="L7670" data-line-number="7670"></td>
        <td id="LC7670">            }</td>
      </tr>
      <tr>
        <td id="L7671" data-line-number="7671"></td>
        <td id="LC7671">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L7672" data-line-number="7672"></td>
        <td id="LC7672">            {</td>
      </tr>
      <tr>
        <td id="L7673" data-line-number="7673"></td>
        <td id="LC7673">                COR_ILMETHOD_SECT_EH_CLAUSE_FAT ehClause;</td>
      </tr>
      <tr>
        <td id="L7674" data-line-number="7674"></td>
        <td id="LC7674">
</td>
      </tr>
      <tr>
        <td id="L7675" data-line-number="7675"></td>
        <td id="LC7675">                <span>for</span> (<span>unsigned</span> i = <span>0</span>; i &lt; methInfo-&gt;<span>EHcount</span>; i++)</td>
      </tr>
      <tr>
        <td id="L7676" data-line-number="7676"></td>
        <td id="LC7676">                {</td>
      </tr>
      <tr>
        <td id="L7677" data-line-number="7677"></td>
        <td id="LC7677">                    <span>const</span> COR_ILMETHOD_SECT_EH_CLAUSE_FAT* ehInfo =</td>
      </tr>
      <tr>
        <td id="L7678" data-line-number="7678"></td>
        <td id="LC7678">                            (COR_ILMETHOD_SECT_EH_CLAUSE_FAT*)header-&gt;<span>EH</span>-&gt;<span>EHClause</span>(i, &amp;ehClause);</td>
      </tr>
      <tr>
        <td id="L7679" data-line-number="7679"></td>
        <td id="LC7679">
</td>
      </tr>
      <tr>
        <td id="L7680" data-line-number="7680"></td>
        <td id="LC7680">                    <span><span>//</span> Is it a typed catch clause?</span></td>
      </tr>
      <tr>
        <td id="L7681" data-line-number="7681"></td>
        <td id="LC7681">                    <span>if</span> (ehInfo-&gt;<span>GetFlags</span>() != COR_ILEXCEPTION_CLAUSE_NONE)</td>
      </tr>
      <tr>
        <td id="L7682" data-line-number="7682"></td>
        <td id="LC7682">                        <span>continue</span>;</td>
      </tr>
      <tr>
        <td id="L7683" data-line-number="7683"></td>
        <td id="LC7683">
</td>
      </tr>
      <tr>
        <td id="L7684" data-line-number="7684"></td>
        <td id="LC7684">                    <span><span>//</span> Check if we catch "C&lt;T&gt;" ?</span></td>
      </tr>
      <tr>
        <td id="L7685" data-line-number="7685"></td>
        <td id="LC7685">
</td>
      </tr>
      <tr>
        <td id="L7686" data-line-number="7686"></td>
        <td id="LC7686">                    DWORD catchTypeToken = ehInfo-&gt;<span>GetClassToken</span>();</td>
      </tr>
      <tr>
        <td id="L7687" data-line-number="7687"></td>
        <td id="LC7687">                    <span>if</span> (<span>TypeFromToken</span>(catchTypeToken) != mdtTypeSpec)</td>
      </tr>
      <tr>
        <td id="L7688" data-line-number="7688"></td>
        <td id="LC7688">                        <span>continue</span>;</td>
      </tr>
      <tr>
        <td id="L7689" data-line-number="7689"></td>
        <td id="LC7689">
</td>
      </tr>
      <tr>
        <td id="L7690" data-line-number="7690"></td>
        <td id="LC7690">                    PCCOR_SIGNATURE pSig;</td>
      </tr>
      <tr>
        <td id="L7691" data-line-number="7691"></td>
        <td id="LC7691">                    ULONG cSig;</td>
      </tr>
      <tr>
        <td id="L7692" data-line-number="7692"></td>
        <td id="LC7692">                    <span>IfFailThrow</span>(ftn-&gt;<span>GetMDImport</span>()-&gt;<span>GetTypeSpecFromToken</span>(catchTypeToken, &amp;pSig, &amp;cSig));</td>
      </tr>
      <tr>
        <td id="L7693" data-line-number="7693"></td>
        <td id="LC7693">
</td>
      </tr>
      <tr>
        <td id="L7694" data-line-number="7694"></td>
        <td id="LC7694">                    SigPointer <span>psig</span>(pSig, cSig);</td>
      </tr>
      <tr>
        <td id="L7695" data-line-number="7695"></td>
        <td id="LC7695">
</td>
      </tr>
      <tr>
        <td id="L7696" data-line-number="7696"></td>
        <td id="LC7696">                    SigTypeContext <span>sigTypeContext</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L7697" data-line-number="7697"></td>
        <td id="LC7697">                    <span>if</span> (psig.<span>IsPolyType</span>(&amp;sigTypeContext) &amp; hasSharableVarsMask)</td>
      </tr>
      <tr>
        <td id="L7698" data-line-number="7698"></td>
        <td id="LC7698">                    {</td>
      </tr>
      <tr>
        <td id="L7699" data-line-number="7699"></td>
        <td id="LC7699">                        methInfo-&gt;<span>options</span> = <span>CorInfoOptions</span>(methInfo-&gt;<span>options</span>|CORINFO_GENERICS_CTXT_KEEP_ALIVE);</td>
      </tr>
      <tr>
        <td id="L7700" data-line-number="7700"></td>
        <td id="LC7700">                        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L7701" data-line-number="7701"></td>
        <td id="LC7701">                    }</td>
      </tr>
      <tr>
        <td id="L7702" data-line-number="7702"></td>
        <td id="LC7702">                }</td>
      </tr>
      <tr>
        <td id="L7703" data-line-number="7703"></td>
        <td id="LC7703">            }</td>
      </tr>
      <tr>
        <td id="L7704" data-line-number="7704"></td>
        <td id="LC7704">        }</td>
      </tr>
      <tr>
        <td id="L7705" data-line-number="7705"></td>
        <td id="LC7705">    }</td>
      </tr>
      <tr>
        <td id="L7706" data-line-number="7706"></td>
        <td id="LC7706">
</td>
      </tr>
      <tr>
        <td id="L7707" data-line-number="7707"></td>
        <td id="LC7707">    PCCOR_SIGNATURE pSig = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L7708" data-line-number="7708"></td>
        <td id="LC7708">    DWORD           cbSig = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L7709" data-line-number="7709"></td>
        <td id="LC7709">    ftn-&gt;<span>GetSig</span>(&amp;pSig, &amp;cbSig);</td>
      </tr>
      <tr>
        <td id="L7710" data-line-number="7710"></td>
        <td id="LC7710">
</td>
      </tr>
      <tr>
        <td id="L7711" data-line-number="7711"></td>
        <td id="LC7711">    <span><span>/*</span> Fetch the method signature <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L7712" data-line-number="7712"></td>
        <td id="LC7712">    <span><span>//</span> Type parameters in the signature should be instantiated according to the</span></td>
      </tr>
      <tr>
        <td id="L7713" data-line-number="7713"></td>
        <td id="LC7713">    <span><span>//</span> class/method/array instantiation of ftnHnd</span></td>
      </tr>
      <tr>
        <td id="L7714" data-line-number="7714"></td>
        <td id="LC7714">    <span>CEEInfo::ConvToJitSig</span>(</td>
      </tr>
      <tr>
        <td id="L7715" data-line-number="7715"></td>
        <td id="LC7715">        pSig,</td>
      </tr>
      <tr>
        <td id="L7716" data-line-number="7716"></td>
        <td id="LC7716">        cbSig,</td>
      </tr>
      <tr>
        <td id="L7717" data-line-number="7717"></td>
        <td id="LC7717">        <span>GetScopeHandle</span>(ftn),</td>
      </tr>
      <tr>
        <td id="L7718" data-line-number="7718"></td>
        <td id="LC7718">        mdTokenNil,</td>
      </tr>
      <tr>
        <td id="L7719" data-line-number="7719"></td>
        <td id="LC7719">        &amp;methInfo-&gt;<span>args</span>,</td>
      </tr>
      <tr>
        <td id="L7720" data-line-number="7720"></td>
        <td id="LC7720">        ftn,</td>
      </tr>
      <tr>
        <td id="L7721" data-line-number="7721"></td>
        <td id="LC7721">        <span>false</span>);</td>
      </tr>
      <tr>
        <td id="L7722" data-line-number="7722"></td>
        <td id="LC7722">
</td>
      </tr>
      <tr>
        <td id="L7723" data-line-number="7723"></td>
        <td id="LC7723">    <span><span>//</span> Shared generic or static per-inst methods and shared methods on generic structs</span></td>
      </tr>
      <tr>
        <td id="L7724" data-line-number="7724"></td>
        <td id="LC7724">    <span><span>//</span> take an extra argument representing their instantiation</span></td>
      </tr>
      <tr>
        <td id="L7725" data-line-number="7725"></td>
        <td id="LC7725">    <span>if</span> (ftn-&gt;<span>RequiresInstArg</span>())</td>
      </tr>
      <tr>
        <td id="L7726" data-line-number="7726"></td>
        <td id="LC7726">        methInfo-&gt;<span>args</span>.<span>callConv</span> = (CorInfoCallConv)(methInfo-&gt;<span>args</span>.<span>callConv</span> | CORINFO_CALLCONV_PARAMTYPE);</td>
      </tr>
      <tr>
        <td id="L7727" data-line-number="7727"></td>
        <td id="LC7727">
</td>
      </tr>
      <tr>
        <td id="L7728" data-line-number="7728"></td>
        <td id="LC7728">    <span>_ASSERTE</span>((<span>IsMdStatic</span>(ftn-&gt;<span>GetAttrs</span>()) == <span>0</span>) == ((methInfo-&gt;<span>args</span>.<span>callConv</span> &amp; CORINFO_CALLCONV_HASTHIS) != <span>0</span>));</td>
      </tr>
      <tr>
        <td id="L7729" data-line-number="7729"></td>
        <td id="LC7729">
</td>
      </tr>
      <tr>
        <td id="L7730" data-line-number="7730"></td>
        <td id="LC7730">    <span><span>/*</span> And its local variables <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L7731" data-line-number="7731"></td>
        <td id="LC7731">    <span><span>//</span> Type parameters in the signature should be instantiated according to the</span></td>
      </tr>
      <tr>
        <td id="L7732" data-line-number="7732"></td>
        <td id="LC7732">    <span><span>//</span> class/method/array instantiation of ftnHnd</span></td>
      </tr>
      <tr>
        <td id="L7733" data-line-number="7733"></td>
        <td id="LC7733">    <span>CEEInfo::ConvToJitSig</span>(</td>
      </tr>
      <tr>
        <td id="L7734" data-line-number="7734"></td>
        <td id="LC7734">        pLocalSig,</td>
      </tr>
      <tr>
        <td id="L7735" data-line-number="7735"></td>
        <td id="LC7735">        cbLocalSig,</td>
      </tr>
      <tr>
        <td id="L7736" data-line-number="7736"></td>
        <td id="LC7736">        <span>GetScopeHandle</span>(ftn),</td>
      </tr>
      <tr>
        <td id="L7737" data-line-number="7737"></td>
        <td id="LC7737">        mdTokenNil,</td>
      </tr>
      <tr>
        <td id="L7738" data-line-number="7738"></td>
        <td id="LC7738">        &amp;methInfo-&gt;<span>locals</span>,</td>
      </tr>
      <tr>
        <td id="L7739" data-line-number="7739"></td>
        <td id="LC7739">        ftn,</td>
      </tr>
      <tr>
        <td id="L7740" data-line-number="7740"></td>
        <td id="LC7740">        <span>true</span>);</td>
      </tr>
      <tr>
        <td id="L7741" data-line-number="7741"></td>
        <td id="LC7741">} <span><span>//</span> getMethodInfoHelper</span></td>
      </tr>
      <tr>
        <td id="L7742" data-line-number="7742"></td>
        <td id="LC7742">
</td>
      </tr>
      <tr>
        <td id="L7743" data-line-number="7743"></td>
        <td id="LC7743"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L7744" data-line-number="7744"></td>
        <td id="LC7744"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7745" data-line-number="7745"></td>
        <td id="LC7745"><span>bool</span></td>
      </tr>
      <tr>
        <td id="L7746" data-line-number="7746"></td>
        <td id="LC7746"><span>CEEInfo::getMethodInfo</span>(</td>
      </tr>
      <tr>
        <td id="L7747" data-line-number="7747"></td>
        <td id="LC7747">    CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L7748" data-line-number="7748"></td>
        <td id="LC7748">    CORINFO_METHOD_INFO * methInfo)</td>
      </tr>
      <tr>
        <td id="L7749" data-line-number="7749"></td>
        <td id="LC7749">{</td>
      </tr>
      <tr>
        <td id="L7750" data-line-number="7750"></td>
        <td id="LC7750">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L7751" data-line-number="7751"></td>
        <td id="LC7751">        THROWS;</td>
      </tr>
      <tr>
        <td id="L7752" data-line-number="7752"></td>
        <td id="LC7752">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L7753" data-line-number="7753"></td>
        <td id="LC7753">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L7754" data-line-number="7754"></td>
        <td id="LC7754">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L7755" data-line-number="7755"></td>
        <td id="LC7755">
</td>
      </tr>
      <tr>
        <td id="L7756" data-line-number="7756"></td>
        <td id="LC7756">    <span>bool</span> result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7757" data-line-number="7757"></td>
        <td id="LC7757">
</td>
      </tr>
      <tr>
        <td id="L7758" data-line-number="7758"></td>
        <td id="LC7758">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L7759" data-line-number="7759"></td>
        <td id="LC7759">
</td>
      </tr>
      <tr>
        <td id="L7760" data-line-number="7760"></td>
        <td id="LC7760">    MethodDesc * ftn = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L7761" data-line-number="7761"></td>
        <td id="LC7761">
</td>
      </tr>
      <tr>
        <td id="L7762" data-line-number="7762"></td>
        <td id="LC7762">    <span>if</span> (!ftn-&gt;<span>IsDynamicMethod</span>() &amp;&amp; (!ftn-&gt;<span>IsIL</span>() || !ftn-&gt;<span>GetRVA</span>() || ftn-&gt;<span>IsWrapperStub</span>()))</td>
      </tr>
      <tr>
        <td id="L7763" data-line-number="7763"></td>
        <td id="LC7763">    {</td>
      </tr>
      <tr>
        <td id="L7764" data-line-number="7764"></td>
        <td id="LC7764">    <span><span>/*</span> Return false if not IL or has no code <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L7765" data-line-number="7765"></td>
        <td id="LC7765">        result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L7766" data-line-number="7766"></td>
        <td id="LC7766">    }</td>
      </tr>
      <tr>
        <td id="L7767" data-line-number="7767"></td>
        <td id="LC7767">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L7768" data-line-number="7768"></td>
        <td id="LC7768">    {</td>
      </tr>
      <tr>
        <td id="L7769" data-line-number="7769"></td>
        <td id="LC7769">        <span><span>/*</span> Get the IL header <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L7770" data-line-number="7770"></td>
        <td id="LC7770">
</td>
      </tr>
      <tr>
        <td id="L7771" data-line-number="7771"></td>
        <td id="LC7771">        <span>if</span> (ftn-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L7772" data-line-number="7772"></td>
        <td id="LC7772">        {</td>
      </tr>
      <tr>
        <td id="L7773" data-line-number="7773"></td>
        <td id="LC7773">            <span>getMethodInfoHelper</span>(ftn, ftnHnd, <span>NULL</span>, methInfo);</td>
      </tr>
      <tr>
        <td id="L7774" data-line-number="7774"></td>
        <td id="LC7774">        }</td>
      </tr>
      <tr>
        <td id="L7775" data-line-number="7775"></td>
        <td id="LC7775">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L7776" data-line-number="7776"></td>
        <td id="LC7776">        {</td>
      </tr>
      <tr>
        <td id="L7777" data-line-number="7777"></td>
        <td id="LC7777">            COR_ILMETHOD_DECODER <span>header</span>(ftn-&gt;<span>GetILHeader</span>(<span>TRUE</span>), ftn-&gt;<span>GetMDImport</span>(), <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L7778" data-line-number="7778"></td>
        <td id="LC7778">
</td>
      </tr>
      <tr>
        <td id="L7779" data-line-number="7779"></td>
        <td id="LC7779">            <span>getMethodInfoHelper</span>(ftn, ftnHnd, &amp;header, methInfo);</td>
      </tr>
      <tr>
        <td id="L7780" data-line-number="7780"></td>
        <td id="LC7780">        }</td>
      </tr>
      <tr>
        <td id="L7781" data-line-number="7781"></td>
        <td id="LC7781">
</td>
      </tr>
      <tr>
        <td id="L7782" data-line-number="7782"></td>
        <td id="LC7782">        <span>LOG</span>((LF_JIT, LL_INFO100000, <span><span>"</span>Getting method info (possible inline) %s::%s%s<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L7783" data-line-number="7783"></td>
        <td id="LC7783">            ftn-&gt;<span>m_pszDebugClassName</span>, ftn-&gt;<span>m_pszDebugMethodName</span>, ftn-&gt;<span>m_pszDebugMethodSignature</span>));</td>
      </tr>
      <tr>
        <td id="L7784" data-line-number="7784"></td>
        <td id="LC7784">
</td>
      </tr>
      <tr>
        <td id="L7785" data-line-number="7785"></td>
        <td id="LC7785">        result = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L7786" data-line-number="7786"></td>
        <td id="LC7786">    }</td>
      </tr>
      <tr>
        <td id="L7787" data-line-number="7787"></td>
        <td id="LC7787">
</td>
      </tr>
      <tr>
        <td id="L7788" data-line-number="7788"></td>
        <td id="LC7788">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L7789" data-line-number="7789"></td>
        <td id="LC7789">
</td>
      </tr>
      <tr>
        <td id="L7790" data-line-number="7790"></td>
        <td id="LC7790">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L7791" data-line-number="7791"></td>
        <td id="LC7791">}</td>
      </tr>
      <tr>
        <td id="L7792" data-line-number="7792"></td>
        <td id="LC7792">
</td>
      </tr>
      <tr>
        <td id="L7793" data-line-number="7793"></td>
        <td id="LC7793">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L7794" data-line-number="7794"></td>
        <td id="LC7794">
</td>
      </tr>
      <tr>
        <td id="L7795" data-line-number="7795"></td>
        <td id="LC7795"><span><span>/*</span>***********************************************************************</span></td>
      </tr>
      <tr>
        <td id="L7796" data-line-number="7796"></td>
        <td id="LC7796"><span>    Return true when ftn contains a local of type CLASS__STACKCRAWMARK</span></td>
      </tr>
      <tr>
        <td id="L7797" data-line-number="7797"></td>
        <td id="LC7797"><span><span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L7798" data-line-number="7798"></td>
        <td id="LC7798">
</td>
      </tr>
      <tr>
        <td id="L7799" data-line-number="7799"></td>
        <td id="LC7799"><span>bool</span> <span>containsStackCrawlMarkLocal</span>(MethodDesc* ftn)</td>
      </tr>
      <tr>
        <td id="L7800" data-line-number="7800"></td>
        <td id="LC7800">{</td>
      </tr>
      <tr>
        <td id="L7801" data-line-number="7801"></td>
        <td id="LC7801">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L7802" data-line-number="7802"></td>
        <td id="LC7802">
</td>
      </tr>
      <tr>
        <td id="L7803" data-line-number="7803"></td>
        <td id="LC7803">    COR_ILMETHOD* ilHeader = ftn-&gt;<span>GetILHeader</span>();</td>
      </tr>
      <tr>
        <td id="L7804" data-line-number="7804"></td>
        <td id="LC7804">    <span>_ASSERTE</span>(ilHeader);</td>
      </tr>
      <tr>
        <td id="L7805" data-line-number="7805"></td>
        <td id="LC7805">
</td>
      </tr>
      <tr>
        <td id="L7806" data-line-number="7806"></td>
        <td id="LC7806">    COR_ILMETHOD_DECODER <span>header</span>(ilHeader, ftn-&gt;<span>GetMDImport</span>(), <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L7807" data-line-number="7807"></td>
        <td id="LC7807">
</td>
      </tr>
      <tr>
        <td id="L7808" data-line-number="7808"></td>
        <td id="LC7808">    <span>if</span> (header.<span>LocalVarSig</span> == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L7809" data-line-number="7809"></td>
        <td id="LC7809">        <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L7810" data-line-number="7810"></td>
        <td id="LC7810">
</td>
      </tr>
      <tr>
        <td id="L7811" data-line-number="7811"></td>
        <td id="LC7811">    SigPointer <span>ptr</span>(header.<span>LocalVarSig</span>, header.<span>cbLocalVarSig</span>);</td>
      </tr>
      <tr>
        <td id="L7812" data-line-number="7812"></td>
        <td id="LC7812">
</td>
      </tr>
      <tr>
        <td id="L7813" data-line-number="7813"></td>
        <td id="LC7813">    <span>IfFailThrow</span>(ptr.<span>GetData</span>(<span>NULL</span>)); <span><span>//</span> IMAGE_CEE_CS_CALLCONV_LOCAL_SIG</span></td>
      </tr>
      <tr>
        <td id="L7814" data-line-number="7814"></td>
        <td id="LC7814">
</td>
      </tr>
      <tr>
        <td id="L7815" data-line-number="7815"></td>
        <td id="LC7815">    ULONG numLocals;</td>
      </tr>
      <tr>
        <td id="L7816" data-line-number="7816"></td>
        <td id="LC7816">    <span>IfFailThrow</span>(ptr.<span>GetData</span>(&amp;numLocals));</td>
      </tr>
      <tr>
        <td id="L7817" data-line-number="7817"></td>
        <td id="LC7817">
</td>
      </tr>
      <tr>
        <td id="L7818" data-line-number="7818"></td>
        <td id="LC7818">    <span>for</span>(ULONG i = <span>0</span>; i &lt; numLocals; i++)</td>
      </tr>
      <tr>
        <td id="L7819" data-line-number="7819"></td>
        <td id="LC7819">    {</td>
      </tr>
      <tr>
        <td id="L7820" data-line-number="7820"></td>
        <td id="LC7820">        CorElementType eType;</td>
      </tr>
      <tr>
        <td id="L7821" data-line-number="7821"></td>
        <td id="LC7821">        <span>IfFailThrow</span>(ptr.<span>PeekElemType</span>(&amp;eType));</td>
      </tr>
      <tr>
        <td id="L7822" data-line-number="7822"></td>
        <td id="LC7822">        <span>if</span> (eType != ELEMENT_TYPE_VALUETYPE)</td>
      </tr>
      <tr>
        <td id="L7823" data-line-number="7823"></td>
        <td id="LC7823">        {</td>
      </tr>
      <tr>
        <td id="L7824" data-line-number="7824"></td>
        <td id="LC7824">            <span>IfFailThrow</span>(ptr.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L7825" data-line-number="7825"></td>
        <td id="LC7825">            <span>continue</span>;</td>
      </tr>
      <tr>
        <td id="L7826" data-line-number="7826"></td>
        <td id="LC7826">        }</td>
      </tr>
      <tr>
        <td id="L7827" data-line-number="7827"></td>
        <td id="LC7827">
</td>
      </tr>
      <tr>
        <td id="L7828" data-line-number="7828"></td>
        <td id="LC7828">        <span>IfFailThrow</span>(ptr.<span>GetElemType</span>(<span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L7829" data-line-number="7829"></td>
        <td id="LC7829">
</td>
      </tr>
      <tr>
        <td id="L7830" data-line-number="7830"></td>
        <td id="LC7830">        mdToken token;</td>
      </tr>
      <tr>
        <td id="L7831" data-line-number="7831"></td>
        <td id="LC7831">        <span>IfFailThrow</span>(ptr.<span>GetToken</span>(&amp;token));</td>
      </tr>
      <tr>
        <td id="L7832" data-line-number="7832"></td>
        <td id="LC7832">
</td>
      </tr>
      <tr>
        <td id="L7833" data-line-number="7833"></td>
        <td id="LC7833">        <span><span>//</span> We are inside mscorlib - simple token match is sufficient</span></td>
      </tr>
      <tr>
        <td id="L7834" data-line-number="7834"></td>
        <td id="LC7834">        <span>if</span> (token == <span>MscorlibBinder::GetClass</span>(CLASS__STACKCRAWMARK)-&gt;<span>GetCl</span>())</td>
      </tr>
      <tr>
        <td id="L7835" data-line-number="7835"></td>
        <td id="LC7835">            <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L7836" data-line-number="7836"></td>
        <td id="LC7836">    }</td>
      </tr>
      <tr>
        <td id="L7837" data-line-number="7837"></td>
        <td id="LC7837">
</td>
      </tr>
      <tr>
        <td id="L7838" data-line-number="7838"></td>
        <td id="LC7838">    <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L7839" data-line-number="7839"></td>
        <td id="LC7839">}</td>
      </tr>
      <tr>
        <td id="L7840" data-line-number="7840"></td>
        <td id="LC7840">
</td>
      </tr>
      <tr>
        <td id="L7841" data-line-number="7841"></td>
        <td id="LC7841">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L7842" data-line-number="7842"></td>
        <td id="LC7842">
</td>
      </tr>
      <tr>
        <td id="L7843" data-line-number="7843"></td>
        <td id="LC7843"><span><span>/*</span>************************************************************</span></td>
      </tr>
      <tr>
        <td id="L7844" data-line-number="7844"></td>
        <td id="LC7844"><span> * Check if the caller and calle are in the same assembly</span></td>
      </tr>
      <tr>
        <td id="L7845" data-line-number="7845"></td>
        <td id="LC7845"><span> * i.e. do not inline across assemblies</span></td>
      </tr>
      <tr>
        <td id="L7846" data-line-number="7846"></td>
        <td id="LC7846"><span> ************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L7847" data-line-number="7847"></td>
        <td id="LC7847">
</td>
      </tr>
      <tr>
        <td id="L7848" data-line-number="7848"></td>
        <td id="LC7848">CorInfoInline <span>CEEInfo::canInline</span> (CORINFO_METHOD_HANDLE hCaller,</td>
      </tr>
      <tr>
        <td id="L7849" data-line-number="7849"></td>
        <td id="LC7849">                                  CORINFO_METHOD_HANDLE hCallee,</td>
      </tr>
      <tr>
        <td id="L7850" data-line-number="7850"></td>
        <td id="LC7850">                                  DWORD*                pRestrictions)</td>
      </tr>
      <tr>
        <td id="L7851" data-line-number="7851"></td>
        <td id="LC7851">{</td>
      </tr>
      <tr>
        <td id="L7852" data-line-number="7852"></td>
        <td id="LC7852">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L7853" data-line-number="7853"></td>
        <td id="LC7853">        THROWS;</td>
      </tr>
      <tr>
        <td id="L7854" data-line-number="7854"></td>
        <td id="LC7854">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L7855" data-line-number="7855"></td>
        <td id="LC7855">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L7856" data-line-number="7856"></td>
        <td id="LC7856">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L7857" data-line-number="7857"></td>
        <td id="LC7857">
</td>
      </tr>
      <tr>
        <td id="L7858" data-line-number="7858"></td>
        <td id="LC7858">    CorInfoInline result = INLINE_PASS;  <span><span>//</span> By default we pass.</span></td>
      </tr>
      <tr>
        <td id="L7859" data-line-number="7859"></td>
        <td id="LC7859">                                         <span><span>//</span> Do not set pass in the rest of the method.</span></td>
      </tr>
      <tr>
        <td id="L7860" data-line-number="7860"></td>
        <td id="LC7860">    DWORD         dwRestrictions = <span>0</span>;    <span><span>//</span> By default, no restrictions</span></td>
      </tr>
      <tr>
        <td id="L7861" data-line-number="7861"></td>
        <td id="LC7861">    <span>const</span> <span>char</span> *  szFailReason = <span>NULL</span>;   <span><span>//</span> for reportInlineDecision</span></td>
      </tr>
      <tr>
        <td id="L7862" data-line-number="7862"></td>
        <td id="LC7862">
</td>
      </tr>
      <tr>
        <td id="L7863" data-line-number="7863"></td>
        <td id="LC7863">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L7864" data-line-number="7864"></td>
        <td id="LC7864">
</td>
      </tr>
      <tr>
        <td id="L7865" data-line-number="7865"></td>
        <td id="LC7865">    <span><span>//</span> This does not work in the multi-threaded case</span></td>
      </tr>
      <tr>
        <td id="L7866" data-line-number="7866"></td>
        <td id="LC7866">#<span>if</span> <span>0</span></td>
      </tr>
      <tr>
        <td id="L7867" data-line-number="7867"></td>
        <td id="LC7867">    // Caller should check this condition first</td>
      </tr>
      <tr>
        <td id="L7868" data-line-number="7868"></td>
        <td id="LC7868">    _ASSERTE(!(CORINFO_FLG_DONT_INLINE &amp; getMethodAttribsInternal(hCallee)));</td>
      </tr>
      <tr>
        <td id="L7869" data-line-number="7869"></td>
        <td id="LC7869">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L7870" data-line-number="7870"></td>
        <td id="LC7870">
</td>
      </tr>
      <tr>
        <td id="L7871" data-line-number="7871"></td>
        <td id="LC7871">    MethodDesc* pCaller = <span>GetMethod</span>(hCaller);</td>
      </tr>
      <tr>
        <td id="L7872" data-line-number="7872"></td>
        <td id="LC7872">    MethodDesc* pCallee = <span>GetMethod</span>(hCallee);</td>
      </tr>
      <tr>
        <td id="L7873" data-line-number="7873"></td>
        <td id="LC7873">
</td>
      </tr>
      <tr>
        <td id="L7874" data-line-number="7874"></td>
        <td id="LC7874">    <span>if</span> (pCallee-&gt;<span>IsNoMetadata</span>())</td>
      </tr>
      <tr>
        <td id="L7875" data-line-number="7875"></td>
        <td id="LC7875">    {</td>
      </tr>
      <tr>
        <td id="L7876" data-line-number="7876"></td>
        <td id="LC7876">        result = INLINE_FAIL;</td>
      </tr>
      <tr>
        <td id="L7877" data-line-number="7877"></td>
        <td id="LC7877">        szFailReason = <span><span>"</span>Inlinee is NoMetadata<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L7878" data-line-number="7878"></td>
        <td id="LC7878">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L7879" data-line-number="7879"></td>
        <td id="LC7879">    }</td>
      </tr>
      <tr>
        <td id="L7880" data-line-number="7880"></td>
        <td id="LC7880">
</td>
      </tr>
      <tr>
        <td id="L7881" data-line-number="7881"></td>
        <td id="LC7881">#<span>ifdef</span> DEBUGGING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L7882" data-line-number="7882"></td>
        <td id="LC7882">
</td>
      </tr>
      <tr>
        <td id="L7883" data-line-number="7883"></td>
        <td id="LC7883">    <span><span>//</span> If the callee wants debuggable code, don't allow it to be inlined</span></td>
      </tr>
      <tr>
        <td id="L7884" data-line-number="7884"></td>
        <td id="LC7884">
</td>
      </tr>
      <tr>
        <td id="L7885" data-line-number="7885"></td>
        <td id="LC7885">    {</td>
      </tr>
      <tr>
        <td id="L7886" data-line-number="7886"></td>
        <td id="LC7886">        <span><span>//</span> Combining the next two lines, and eliminating jitDebuggerFlags, leads to bad codegen in x86 Release builds using Visual C++ 19.00.24215.1.</span></td>
      </tr>
      <tr>
        <td id="L7887" data-line-number="7887"></td>
        <td id="LC7887">        CORJIT_FLAGS jitDebuggerFlags = <span>GetDebuggerCompileFlags</span>(pCallee-&gt;<span>GetModule</span>(), <span>CORJIT_FLAGS</span>());</td>
      </tr>
      <tr>
        <td id="L7888" data-line-number="7888"></td>
        <td id="LC7888">        <span>if</span> (jitDebuggerFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_CODE))</td>
      </tr>
      <tr>
        <td id="L7889" data-line-number="7889"></td>
        <td id="LC7889">        {</td>
      </tr>
      <tr>
        <td id="L7890" data-line-number="7890"></td>
        <td id="LC7890">            result = INLINE_NEVER;</td>
      </tr>
      <tr>
        <td id="L7891" data-line-number="7891"></td>
        <td id="LC7891">            szFailReason = <span><span>"</span>Inlinee is debuggable<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L7892" data-line-number="7892"></td>
        <td id="LC7892">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L7893" data-line-number="7893"></td>
        <td id="LC7893">        }</td>
      </tr>
      <tr>
        <td id="L7894" data-line-number="7894"></td>
        <td id="LC7894">    }</td>
      </tr>
      <tr>
        <td id="L7895" data-line-number="7895"></td>
        <td id="LC7895">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L7896" data-line-number="7896"></td>
        <td id="LC7896">
</td>
      </tr>
      <tr>
        <td id="L7897" data-line-number="7897"></td>
        <td id="LC7897">    <span><span>//</span> The orginal caller is the current method</span></td>
      </tr>
      <tr>
        <td id="L7898" data-line-number="7898"></td>
        <td id="LC7898">    MethodDesc *  pOrigCaller;</td>
      </tr>
      <tr>
        <td id="L7899" data-line-number="7899"></td>
        <td id="LC7899">    pOrigCaller = m_pMethodBeingCompiled;</td>
      </tr>
      <tr>
        <td id="L7900" data-line-number="7900"></td>
        <td id="LC7900">    Module *      pOrigCallerModule;</td>
      </tr>
      <tr>
        <td id="L7901" data-line-number="7901"></td>
        <td id="LC7901">    pOrigCallerModule = pOrigCaller-&gt;<span>GetLoaderModule</span>();</td>
      </tr>
      <tr>
        <td id="L7902" data-line-number="7902"></td>
        <td id="LC7902">
</td>
      </tr>
      <tr>
        <td id="L7903" data-line-number="7903"></td>
        <td id="LC7903">    <span>if</span> (pCallee-&gt;<span>IsNotInline</span>())</td>
      </tr>
      <tr>
        <td id="L7904" data-line-number="7904"></td>
        <td id="LC7904">    {</td>
      </tr>
      <tr>
        <td id="L7905" data-line-number="7905"></td>
        <td id="LC7905">        result = INLINE_NEVER;</td>
      </tr>
      <tr>
        <td id="L7906" data-line-number="7906"></td>
        <td id="LC7906">        szFailReason = <span><span>"</span>Inlinee is marked as no inline<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L7907" data-line-number="7907"></td>
        <td id="LC7907">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L7908" data-line-number="7908"></td>
        <td id="LC7908">    }</td>
      </tr>
      <tr>
        <td id="L7909" data-line-number="7909"></td>
        <td id="LC7909">
</td>
      </tr>
      <tr>
        <td id="L7910" data-line-number="7910"></td>
        <td id="LC7910">    <span><span>//</span> Also check to see if the method requires a security object.  This means they call demand and</span></td>
      </tr>
      <tr>
        <td id="L7911" data-line-number="7911"></td>
        <td id="LC7911">    <span><span>//</span> shouldn't be inlined.</span></td>
      </tr>
      <tr>
        <td id="L7912" data-line-number="7912"></td>
        <td id="LC7912">    <span>if</span> (<span>IsMdRequireSecObject</span>(pCallee-&gt;<span>GetAttrs</span>()))</td>
      </tr>
      <tr>
        <td id="L7913" data-line-number="7913"></td>
        <td id="LC7913">    {</td>
      </tr>
      <tr>
        <td id="L7914" data-line-number="7914"></td>
        <td id="LC7914">        result = INLINE_NEVER;</td>
      </tr>
      <tr>
        <td id="L7915" data-line-number="7915"></td>
        <td id="LC7915">        szFailReason = <span><span>"</span>Inlinee requires a security object (or contains StackCrawlMark)<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L7916" data-line-number="7916"></td>
        <td id="LC7916">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L7917" data-line-number="7917"></td>
        <td id="LC7917">    }</td>
      </tr>
      <tr>
        <td id="L7918" data-line-number="7918"></td>
        <td id="LC7918">
</td>
      </tr>
      <tr>
        <td id="L7919" data-line-number="7919"></td>
        <td id="LC7919">    <span><span>//</span> If the method is MethodImpl'd by another method within the same type, then we have</span></td>
      </tr>
      <tr>
        <td id="L7920" data-line-number="7920"></td>
        <td id="LC7920">    <span><span>//</span> an issue that the importer will import the wrong body. In this case, we'll just</span></td>
      </tr>
      <tr>
        <td id="L7921" data-line-number="7921"></td>
        <td id="LC7921">    <span><span>//</span> disallow inlining because getFunctionEntryPoint will do the right thing.</span></td>
      </tr>
      <tr>
        <td id="L7922" data-line-number="7922"></td>
        <td id="LC7922">    {</td>
      </tr>
      <tr>
        <td id="L7923" data-line-number="7923"></td>
        <td id="LC7923">        MethodDesc  *pMDDecl = pCallee;</td>
      </tr>
      <tr>
        <td id="L7924" data-line-number="7924"></td>
        <td id="LC7924">        MethodTable *pMT     = pMDDecl-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L7925" data-line-number="7925"></td>
        <td id="LC7925">        MethodDesc  *pMDImpl = pMT-&gt;<span>MapMethodDeclToMethodImpl</span>(pMDDecl);</td>
      </tr>
      <tr>
        <td id="L7926" data-line-number="7926"></td>
        <td id="LC7926">
</td>
      </tr>
      <tr>
        <td id="L7927" data-line-number="7927"></td>
        <td id="LC7927">        <span>if</span> (pMDDecl != pMDImpl)</td>
      </tr>
      <tr>
        <td id="L7928" data-line-number="7928"></td>
        <td id="LC7928">        {</td>
      </tr>
      <tr>
        <td id="L7929" data-line-number="7929"></td>
        <td id="LC7929">            result = INLINE_NEVER;</td>
      </tr>
      <tr>
        <td id="L7930" data-line-number="7930"></td>
        <td id="LC7930">            szFailReason = <span><span>"</span>Inlinee is MethodImpl'd by another method within the same type<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L7931" data-line-number="7931"></td>
        <td id="LC7931">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L7932" data-line-number="7932"></td>
        <td id="LC7932">        }</td>
      </tr>
      <tr>
        <td id="L7933" data-line-number="7933"></td>
        <td id="LC7933">    }</td>
      </tr>
      <tr>
        <td id="L7934" data-line-number="7934"></td>
        <td id="LC7934">
</td>
      </tr>
      <tr>
        <td id="L7935" data-line-number="7935"></td>
        <td id="LC7935">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7936" data-line-number="7936"></td>
        <td id="LC7936">    <span><span>//</span> Perform the Cross-Assembly inlining checks</span></td>
      </tr>
      <tr>
        <td id="L7937" data-line-number="7937"></td>
        <td id="LC7937">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7938" data-line-number="7938"></td>
        <td id="LC7938">    {</td>
      </tr>
      <tr>
        <td id="L7939" data-line-number="7939"></td>
        <td id="LC7939">        Module *    pCalleeModule   = pCallee-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L7940" data-line-number="7940"></td>
        <td id="LC7940">
</td>
      </tr>
      <tr>
        <td id="L7941" data-line-number="7941"></td>
        <td id="LC7941">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L7942" data-line-number="7942"></td>
        <td id="LC7942">        Assembly *  pCalleeAssembly = pCalleeModule-&gt;<span>GetAssembly</span>();</td>
      </tr>
      <tr>
        <td id="L7943" data-line-number="7943"></td>
        <td id="LC7943">
</td>
      </tr>
      <tr>
        <td id="L7944" data-line-number="7944"></td>
        <td id="LC7944">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L7945" data-line-number="7945"></td>
        <td id="LC7945">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7946" data-line-number="7946"></td>
        <td id="LC7946">        <span><span>//</span> Make sure that all methods with StackCrawlMark are marked as IsMdRequireSecObject</span></td>
      </tr>
      <tr>
        <td id="L7947" data-line-number="7947"></td>
        <td id="LC7947">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7948" data-line-number="7948"></td>
        <td id="LC7948">        <span>if</span> (pCalleeAssembly-&gt;<span>IsSystem</span>())</td>
      </tr>
      <tr>
        <td id="L7949" data-line-number="7949"></td>
        <td id="LC7949">        {</td>
      </tr>
      <tr>
        <td id="L7950" data-line-number="7950"></td>
        <td id="LC7950">            <span>_ASSERTE</span>(!<span>containsStackCrawlMarkLocal</span>(pCallee));</td>
      </tr>
      <tr>
        <td id="L7951" data-line-number="7951"></td>
        <td id="LC7951">        }</td>
      </tr>
      <tr>
        <td id="L7952" data-line-number="7952"></td>
        <td id="LC7952">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L7953" data-line-number="7953"></td>
        <td id="LC7953">
</td>
      </tr>
      <tr>
        <td id="L7954" data-line-number="7954"></td>
        <td id="LC7954">        <span><span>//</span> To allow for servicing of Ngen images we want to disable most</span></td>
      </tr>
      <tr>
        <td id="L7955" data-line-number="7955"></td>
        <td id="LC7955">        <span><span>//</span> Cross-Assembly inlining except for the cases that we explicitly allow.</span></td>
      </tr>
      <tr>
        <td id="L7956" data-line-number="7956"></td>
        <td id="LC7956">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7957" data-line-number="7957"></td>
        <td id="LC7957">        <span>if</span> (<span>IsCompilingForNGen</span>())</td>
      </tr>
      <tr>
        <td id="L7958" data-line-number="7958"></td>
        <td id="LC7958">        {</td>
      </tr>
      <tr>
        <td id="L7959" data-line-number="7959"></td>
        <td id="LC7959">            <span><span>//</span> This is an canInline call at Ngen time</span></td>
      </tr>
      <tr>
        <td id="L7960" data-line-number="7960"></td>
        <td id="LC7960">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7961" data-line-number="7961"></td>
        <td id="LC7961">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L7962" data-line-number="7962"></td>
        <td id="LC7962">            Assembly *  pOrigCallerAssembly = pOrigCallerModule-&gt;<span>GetAssembly</span>();</td>
      </tr>
      <tr>
        <td id="L7963" data-line-number="7963"></td>
        <td id="LC7963">
</td>
      </tr>
      <tr>
        <td id="L7964" data-line-number="7964"></td>
        <td id="LC7964">            <span>if</span> (pCalleeAssembly == pOrigCallerAssembly)</td>
      </tr>
      <tr>
        <td id="L7965" data-line-number="7965"></td>
        <td id="LC7965">            {</td>
      </tr>
      <tr>
        <td id="L7966" data-line-number="7966"></td>
        <td id="LC7966">                <span><span>//</span> Within the same assembly</span></td>
      </tr>
      <tr>
        <td id="L7967" data-line-number="7967"></td>
        <td id="LC7967">                <span><span>//</span> we can freely inline with no restrictions</span></td>
      </tr>
      <tr>
        <td id="L7968" data-line-number="7968"></td>
        <td id="LC7968">            }</td>
      </tr>
      <tr>
        <td id="L7969" data-line-number="7969"></td>
        <td id="LC7969">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L7970" data-line-number="7970"></td>
        <td id="LC7970">            {</td>
      </tr>
      <tr>
        <td id="L7971" data-line-number="7971"></td>
        <td id="LC7971">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L7972" data-line-number="7972"></td>
        <td id="LC7972">                <span><span>//</span> No inlinining for version resilient code except if in the same version bubble</span></td>
      </tr>
      <tr>
        <td id="L7973" data-line-number="7973"></td>
        <td id="LC7973">                <span><span>//</span> If this condition changes, please make the corresponding change</span></td>
      </tr>
      <tr>
        <td id="L7974" data-line-number="7974"></td>
        <td id="LC7974">                <span><span>//</span> in getCallInfo, too.</span></td>
      </tr>
      <tr>
        <td id="L7975" data-line-number="7975"></td>
        <td id="LC7975">                <span>if</span> (<span>IsReadyToRunCompilation</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L7976" data-line-number="7976"></td>
        <td id="LC7976">                    !<span>isVerifyOnly</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L7977" data-line-number="7977"></td>
        <td id="LC7977">                    !<span>IsInSameVersionBubble</span>(pCaller, pCallee)</td>
      </tr>
      <tr>
        <td id="L7978" data-line-number="7978"></td>
        <td id="LC7978">                   )</td>
      </tr>
      <tr>
        <td id="L7979" data-line-number="7979"></td>
        <td id="LC7979">                {</td>
      </tr>
      <tr>
        <td id="L7980" data-line-number="7980"></td>
        <td id="LC7980">                    result = INLINE_NEVER;</td>
      </tr>
      <tr>
        <td id="L7981" data-line-number="7981"></td>
        <td id="LC7981">                    szFailReason = <span><span>"</span>Cross-module inlining in version resilient code<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L7982" data-line-number="7982"></td>
        <td id="LC7982">                    <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L7983" data-line-number="7983"></td>
        <td id="LC7983">                }</td>
      </tr>
      <tr>
        <td id="L7984" data-line-number="7984"></td>
        <td id="LC7984">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L7985" data-line-number="7985"></td>
        <td id="LC7985">            }</td>
      </tr>
      <tr>
        <td id="L7986" data-line-number="7986"></td>
        <td id="LC7986">        }</td>
      </tr>
      <tr>
        <td id="L7987" data-line-number="7987"></td>
        <td id="LC7987">#<span>endif</span>  <span><span>//</span> FEATURE_PREJIT</span></td>
      </tr>
      <tr>
        <td id="L7988" data-line-number="7988"></td>
        <td id="LC7988">
</td>
      </tr>
      <tr>
        <td id="L7989" data-line-number="7989"></td>
        <td id="LC7989">        <span><span>//</span> TODO: We can probably be smarter here if the caller is jitted, as we will</span></td>
      </tr>
      <tr>
        <td id="L7990" data-line-number="7990"></td>
        <td id="LC7990">        <span><span>//</span> know for sure if the inlinee has really no string interning active (currently</span></td>
      </tr>
      <tr>
        <td id="L7991" data-line-number="7991"></td>
        <td id="LC7991">        <span><span>//</span> it's only on in the ngen case (besides requiring the attribute)), but this is getting</span></td>
      </tr>
      <tr>
        <td id="L7992" data-line-number="7992"></td>
        <td id="LC7992">        <span><span>//</span> too subtle. Will only do if somebody screams about it, as bugs here are going to</span></td>
      </tr>
      <tr>
        <td id="L7993" data-line-number="7993"></td>
        <td id="LC7993">        <span><span>//</span> be tough to find</span></td>
      </tr>
      <tr>
        <td id="L7994" data-line-number="7994"></td>
        <td id="LC7994">        <span>if</span> ((pOrigCallerModule != pCalleeModule) &amp;&amp;  pCalleeModule-&gt;<span>IsNoStringInterning</span>())</td>
      </tr>
      <tr>
        <td id="L7995" data-line-number="7995"></td>
        <td id="LC7995">        {</td>
      </tr>
      <tr>
        <td id="L7996" data-line-number="7996"></td>
        <td id="LC7996">            dwRestrictions |= INLINE_NO_CALLEE_LDSTR;</td>
      </tr>
      <tr>
        <td id="L7997" data-line-number="7997"></td>
        <td id="LC7997">        }</td>
      </tr>
      <tr>
        <td id="L7998" data-line-number="7998"></td>
        <td id="LC7998">    }</td>
      </tr>
      <tr>
        <td id="L7999" data-line-number="7999"></td>
        <td id="LC7999">
</td>
      </tr>
      <tr>
        <td id="L8000" data-line-number="8000"></td>
        <td id="LC8000">#<span>ifdef</span> PROFILING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L8001" data-line-number="8001"></td>
        <td id="LC8001">    <span>if</span> (<span>CORProfilerPresent</span>())</td>
      </tr>
      <tr>
        <td id="L8002" data-line-number="8002"></td>
        <td id="LC8002">    {</td>
      </tr>
      <tr>
        <td id="L8003" data-line-number="8003"></td>
        <td id="LC8003">        <span><span>//</span> #rejit</span></td>
      </tr>
      <tr>
        <td id="L8004" data-line-number="8004"></td>
        <td id="LC8004">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8005" data-line-number="8005"></td>
        <td id="LC8005">        <span><span>//</span> Currently the rejit path is the only path which sets this.</span></td>
      </tr>
      <tr>
        <td id="L8006" data-line-number="8006"></td>
        <td id="LC8006">        <span><span>//</span> If we get more reasons to set this then we may need to change</span></td>
      </tr>
      <tr>
        <td id="L8007" data-line-number="8007"></td>
        <td id="LC8007">        <span><span>//</span> the failure reason message or disambiguate them.</span></td>
      </tr>
      <tr>
        <td id="L8008" data-line-number="8008"></td>
        <td id="LC8008">        <span>if</span> (!m_allowInlining)</td>
      </tr>
      <tr>
        <td id="L8009" data-line-number="8009"></td>
        <td id="LC8009">        {</td>
      </tr>
      <tr>
        <td id="L8010" data-line-number="8010"></td>
        <td id="LC8010">            result = INLINE_FAIL;</td>
      </tr>
      <tr>
        <td id="L8011" data-line-number="8011"></td>
        <td id="LC8011">            szFailReason = <span><span>"</span>ReJIT request disabled inlining from caller<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8012" data-line-number="8012"></td>
        <td id="LC8012">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8013" data-line-number="8013"></td>
        <td id="LC8013">        }</td>
      </tr>
      <tr>
        <td id="L8014" data-line-number="8014"></td>
        <td id="LC8014">
</td>
      </tr>
      <tr>
        <td id="L8015" data-line-number="8015"></td>
        <td id="LC8015">        <span><span>//</span> If the profiler has set a mask preventing inlining, always return</span></td>
      </tr>
      <tr>
        <td id="L8016" data-line-number="8016"></td>
        <td id="LC8016">        <span><span>//</span> false to the jit.</span></td>
      </tr>
      <tr>
        <td id="L8017" data-line-number="8017"></td>
        <td id="LC8017">        <span>if</span> (<span>CORProfilerDisableInlining</span>())</td>
      </tr>
      <tr>
        <td id="L8018" data-line-number="8018"></td>
        <td id="LC8018">        {</td>
      </tr>
      <tr>
        <td id="L8019" data-line-number="8019"></td>
        <td id="LC8019">            result = INLINE_FAIL;</td>
      </tr>
      <tr>
        <td id="L8020" data-line-number="8020"></td>
        <td id="LC8020">            szFailReason = <span><span>"</span>Profiler disabled inlining globally<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8021" data-line-number="8021"></td>
        <td id="LC8021">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8022" data-line-number="8022"></td>
        <td id="LC8022">        }</td>
      </tr>
      <tr>
        <td id="L8023" data-line-number="8023"></td>
        <td id="LC8023">
</td>
      </tr>
      <tr>
        <td id="L8024" data-line-number="8024"></td>
        <td id="LC8024">#<span>if</span> defined(FEATURE_REJIT) &amp;&amp; !defined(DACCESS_COMPILE) &amp;&amp; !defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L8025" data-line-number="8025"></td>
        <td id="LC8025">        <span>if</span> (<span>CORProfilerEnableRejit</span>())</td>
      </tr>
      <tr>
        <td id="L8026" data-line-number="8026"></td>
        <td id="LC8026">        {</td>
      </tr>
      <tr>
        <td id="L8027" data-line-number="8027"></td>
        <td id="LC8027">            CodeVersionManager* pCodeVersionManager = pCallee-&gt;<span>GetCodeVersionManager</span>();</td>
      </tr>
      <tr>
        <td id="L8028" data-line-number="8028"></td>
        <td id="LC8028">            CodeVersionManager::LockHolder codeVersioningLockHolder;</td>
      </tr>
      <tr>
        <td id="L8029" data-line-number="8029"></td>
        <td id="LC8029">            ILCodeVersion ilVersion = pCodeVersionManager-&gt;<span>GetActiveILCodeVersion</span>(pCallee);</td>
      </tr>
      <tr>
        <td id="L8030" data-line-number="8030"></td>
        <td id="LC8030">            <span>if</span> (ilVersion.<span>GetRejitState</span>() != ILCodeVersion::<span>kStateActive</span> || !ilVersion.<span>HasDefaultIL</span>())</td>
      </tr>
      <tr>
        <td id="L8031" data-line-number="8031"></td>
        <td id="LC8031">            {</td>
      </tr>
      <tr>
        <td id="L8032" data-line-number="8032"></td>
        <td id="LC8032">                result = INLINE_FAIL;</td>
      </tr>
      <tr>
        <td id="L8033" data-line-number="8033"></td>
        <td id="LC8033">                szFailReason = <span><span>"</span>ReJIT methods cannot be inlined.<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8034" data-line-number="8034"></td>
        <td id="LC8034">                <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8035" data-line-number="8035"></td>
        <td id="LC8035">            }</td>
      </tr>
      <tr>
        <td id="L8036" data-line-number="8036"></td>
        <td id="LC8036">        }</td>
      </tr>
      <tr>
        <td id="L8037" data-line-number="8037"></td>
        <td id="LC8037">#<span>endif</span> <span><span>//</span> defined(FEATURE_REJIT) &amp;&amp; !defined(DACCESS_COMPILE) &amp;&amp; !defined(CROSSGEN_COMPILE)</span></td>
      </tr>
      <tr>
        <td id="L8038" data-line-number="8038"></td>
        <td id="LC8038">
</td>
      </tr>
      <tr>
        <td id="L8039" data-line-number="8039"></td>
        <td id="LC8039">        <span><span>//</span> If the profiler wishes to be notified of JIT events and the result from</span></td>
      </tr>
      <tr>
        <td id="L8040" data-line-number="8040"></td>
        <td id="LC8040">        <span><span>//</span> the above tests will cause a function to be inlined, we need to tell the</span></td>
      </tr>
      <tr>
        <td id="L8041" data-line-number="8041"></td>
        <td id="LC8041">        <span><span>//</span> profiler that this inlining is going to take place, and give them a</span></td>
      </tr>
      <tr>
        <td id="L8042" data-line-number="8042"></td>
        <td id="LC8042">        <span><span>//</span> chance to prevent it.</span></td>
      </tr>
      <tr>
        <td id="L8043" data-line-number="8043"></td>
        <td id="LC8043">        {</td>
      </tr>
      <tr>
        <td id="L8044" data-line-number="8044"></td>
        <td id="LC8044">            <span>BEGIN_PIN_PROFILER</span>(<span>CORProfilerTrackJITInfo</span>());</td>
      </tr>
      <tr>
        <td id="L8045" data-line-number="8045"></td>
        <td id="LC8045">            <span>if</span> (pCaller-&gt;<span>IsILStub</span>() || pCallee-&gt;<span>IsILStub</span>())</td>
      </tr>
      <tr>
        <td id="L8046" data-line-number="8046"></td>
        <td id="LC8046">            {</td>
      </tr>
      <tr>
        <td id="L8047" data-line-number="8047"></td>
        <td id="LC8047">                <span><span>//</span> do nothing</span></td>
      </tr>
      <tr>
        <td id="L8048" data-line-number="8048"></td>
        <td id="LC8048">            }</td>
      </tr>
      <tr>
        <td id="L8049" data-line-number="8049"></td>
        <td id="LC8049">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L8050" data-line-number="8050"></td>
        <td id="LC8050">            {</td>
      </tr>
      <tr>
        <td id="L8051" data-line-number="8051"></td>
        <td id="LC8051">                BOOL <span>fShouldInline</span>;</td>
      </tr>
      <tr>
        <td id="L8052" data-line-number="8052"></td>
        <td id="LC8052">                HRESULT hr = g_profControlBlock.<span>pProfInterface</span>-&gt;<span>JITInlining</span>(</td>
      </tr>
      <tr>
        <td id="L8053" data-line-number="8053"></td>
        <td id="LC8053">                    (FunctionID)pCaller,</td>
      </tr>
      <tr>
        <td id="L8054" data-line-number="8054"></td>
        <td id="LC8054">                    (FunctionID)pCallee,</td>
      </tr>
      <tr>
        <td id="L8055" data-line-number="8055"></td>
        <td id="LC8055">                    &amp;<span>fShouldInline</span>);</td>
      </tr>
      <tr>
        <td id="L8056" data-line-number="8056"></td>
        <td id="LC8056">
</td>
      </tr>
      <tr>
        <td id="L8057" data-line-number="8057"></td>
        <td id="LC8057">                <span>if</span> (<span>SUCCEEDED</span>(hr) &amp;&amp; !<span>fShouldInline</span>)</td>
      </tr>
      <tr>
        <td id="L8058" data-line-number="8058"></td>
        <td id="LC8058">                {</td>
      </tr>
      <tr>
        <td id="L8059" data-line-number="8059"></td>
        <td id="LC8059">                    result = INLINE_FAIL;</td>
      </tr>
      <tr>
        <td id="L8060" data-line-number="8060"></td>
        <td id="LC8060">                    szFailReason = <span><span>"</span>Profiler disabled inlining locally<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8061" data-line-number="8061"></td>
        <td id="LC8061">                    <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8062" data-line-number="8062"></td>
        <td id="LC8062">                }</td>
      </tr>
      <tr>
        <td id="L8063" data-line-number="8063"></td>
        <td id="LC8063">            }</td>
      </tr>
      <tr>
        <td id="L8064" data-line-number="8064"></td>
        <td id="LC8064">            <span>END_PIN_PROFILER</span>();</td>
      </tr>
      <tr>
        <td id="L8065" data-line-number="8065"></td>
        <td id="LC8065">        }</td>
      </tr>
      <tr>
        <td id="L8066" data-line-number="8066"></td>
        <td id="LC8066">    }</td>
      </tr>
      <tr>
        <td id="L8067" data-line-number="8067"></td>
        <td id="LC8067">#<span>endif</span> <span><span>//</span> PROFILING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L8068" data-line-number="8068"></td>
        <td id="LC8068">
</td>
      </tr>
      <tr>
        <td id="L8069" data-line-number="8069"></td>
        <td id="LC8069"><span>exit</span>: ;</td>
      </tr>
      <tr>
        <td id="L8070" data-line-number="8070"></td>
        <td id="LC8070">
</td>
      </tr>
      <tr>
        <td id="L8071" data-line-number="8071"></td>
        <td id="LC8071">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8072" data-line-number="8072"></td>
        <td id="LC8072">
</td>
      </tr>
      <tr>
        <td id="L8073" data-line-number="8073"></td>
        <td id="LC8073">    <span>if</span> (result == INLINE_PASS &amp;&amp; dwRestrictions)</td>
      </tr>
      <tr>
        <td id="L8074" data-line-number="8074"></td>
        <td id="LC8074">    {</td>
      </tr>
      <tr>
        <td id="L8075" data-line-number="8075"></td>
        <td id="LC8075">        <span>if</span> (pRestrictions)</td>
      </tr>
      <tr>
        <td id="L8076" data-line-number="8076"></td>
        <td id="LC8076">        {</td>
      </tr>
      <tr>
        <td id="L8077" data-line-number="8077"></td>
        <td id="LC8077">            *pRestrictions = dwRestrictions;</td>
      </tr>
      <tr>
        <td id="L8078" data-line-number="8078"></td>
        <td id="LC8078">        }</td>
      </tr>
      <tr>
        <td id="L8079" data-line-number="8079"></td>
        <td id="LC8079">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8080" data-line-number="8080"></td>
        <td id="LC8080">        {</td>
      </tr>
      <tr>
        <td id="L8081" data-line-number="8081"></td>
        <td id="LC8081">            <span><span>//</span> If the jitter didn't want to know about restrictions, it shouldn't be inlining</span></td>
      </tr>
      <tr>
        <td id="L8082" data-line-number="8082"></td>
        <td id="LC8082">            result = INLINE_FAIL;</td>
      </tr>
      <tr>
        <td id="L8083" data-line-number="8083"></td>
        <td id="LC8083">            szFailReason = <span><span>"</span>Inlinee has restrictions the JIT doesn't want<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8084" data-line-number="8084"></td>
        <td id="LC8084">        }</td>
      </tr>
      <tr>
        <td id="L8085" data-line-number="8085"></td>
        <td id="LC8085">    }</td>
      </tr>
      <tr>
        <td id="L8086" data-line-number="8086"></td>
        <td id="LC8086">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L8087" data-line-number="8087"></td>
        <td id="LC8087">    {</td>
      </tr>
      <tr>
        <td id="L8088" data-line-number="8088"></td>
        <td id="LC8088">        <span>if</span> (pRestrictions)</td>
      </tr>
      <tr>
        <td id="L8089" data-line-number="8089"></td>
        <td id="LC8089">        {</td>
      </tr>
      <tr>
        <td id="L8090" data-line-number="8090"></td>
        <td id="LC8090">            <span><span>//</span> Denied inlining, makes no sense to pass out restrictions,</span></td>
      </tr>
      <tr>
        <td id="L8091" data-line-number="8091"></td>
        <td id="LC8091">            *pRestrictions = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L8092" data-line-number="8092"></td>
        <td id="LC8092">        }</td>
      </tr>
      <tr>
        <td id="L8093" data-line-number="8093"></td>
        <td id="LC8093">    }</td>
      </tr>
      <tr>
        <td id="L8094" data-line-number="8094"></td>
        <td id="LC8094">
</td>
      </tr>
      <tr>
        <td id="L8095" data-line-number="8095"></td>
        <td id="LC8095">    <span>if</span> (<span>dontInline</span>(result))</td>
      </tr>
      <tr>
        <td id="L8096" data-line-number="8096"></td>
        <td id="LC8096">    {</td>
      </tr>
      <tr>
        <td id="L8097" data-line-number="8097"></td>
        <td id="LC8097">        <span><span>//</span> If you hit this assert, it means you added a new way to prevent inlining</span></td>
      </tr>
      <tr>
        <td id="L8098" data-line-number="8098"></td>
        <td id="LC8098">        <span><span>//</span> without documenting it for ETW!</span></td>
      </tr>
      <tr>
        <td id="L8099" data-line-number="8099"></td>
        <td id="LC8099">        <span>_ASSERTE</span>(szFailReason != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L8100" data-line-number="8100"></td>
        <td id="LC8100">        <span>reportInliningDecision</span>(hCaller, hCallee, result, szFailReason);</td>
      </tr>
      <tr>
        <td id="L8101" data-line-number="8101"></td>
        <td id="LC8101">    }</td>
      </tr>
      <tr>
        <td id="L8102" data-line-number="8102"></td>
        <td id="LC8102">
</td>
      </tr>
      <tr>
        <td id="L8103" data-line-number="8103"></td>
        <td id="LC8103">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L8104" data-line-number="8104"></td>
        <td id="LC8104">}</td>
      </tr>
      <tr>
        <td id="L8105" data-line-number="8105"></td>
        <td id="LC8105">
</td>
      </tr>
      <tr>
        <td id="L8106" data-line-number="8106"></td>
        <td id="LC8106"><span>void</span> <span>CEEInfo::reportInliningDecision</span> (CORINFO_METHOD_HANDLE inlinerHnd,</td>
      </tr>
      <tr>
        <td id="L8107" data-line-number="8107"></td>
        <td id="LC8107">                                      CORINFO_METHOD_HANDLE inlineeHnd,</td>
      </tr>
      <tr>
        <td id="L8108" data-line-number="8108"></td>
        <td id="LC8108">                                      CorInfoInline inlineResult,</td>
      </tr>
      <tr>
        <td id="L8109" data-line-number="8109"></td>
        <td id="LC8109">                                      <span>const</span> <span>char</span> * reason)</td>
      </tr>
      <tr>
        <td id="L8110" data-line-number="8110"></td>
        <td id="LC8110">{</td>
      </tr>
      <tr>
        <td id="L8111" data-line-number="8111"></td>
        <td id="LC8111">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L8112" data-line-number="8112"></td>
        <td id="LC8112">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8113" data-line-number="8113"></td>
        <td id="LC8113">
</td>
      </tr>
      <tr>
        <td id="L8114" data-line-number="8114"></td>
        <td id="LC8114">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8115" data-line-number="8115"></td>
        <td id="LC8115">
</td>
      </tr>
      <tr>
        <td id="L8116" data-line-number="8116"></td>
        <td id="LC8116">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L8117" data-line-number="8117"></td>
        <td id="LC8117">    <span>if</span> (<span>LoggingOn</span>(LF_JIT, LL_INFO100000))</td>
      </tr>
      <tr>
        <td id="L8118" data-line-number="8118"></td>
        <td id="LC8118">    {</td>
      </tr>
      <tr>
        <td id="L8119" data-line-number="8119"></td>
        <td id="LC8119">        SString currentMethodName;</td>
      </tr>
      <tr>
        <td id="L8120" data-line-number="8120"></td>
        <td id="LC8120">        currentMethodName.<span>AppendUTF8</span>(m_pMethodBeingCompiled-&gt;<span>GetModule_NoLogging</span>()-&gt;<span>GetFile</span>()-&gt;<span>GetSimpleName</span>());</td>
      </tr>
      <tr>
        <td id="L8121" data-line-number="8121"></td>
        <td id="LC8121">        currentMethodName.<span>Append</span>(L<span><span>'</span>/<span>'</span></span>);</td>
      </tr>
      <tr>
        <td id="L8122" data-line-number="8122"></td>
        <td id="LC8122">        <span>TypeString::AppendMethodInternal</span>(currentMethodName, m_pMethodBeingCompiled, TypeString::FormatBasic);</td>
      </tr>
      <tr>
        <td id="L8123" data-line-number="8123"></td>
        <td id="LC8123">
</td>
      </tr>
      <tr>
        <td id="L8124" data-line-number="8124"></td>
        <td id="LC8124">        SString inlineeMethodName;</td>
      </tr>
      <tr>
        <td id="L8125" data-line-number="8125"></td>
        <td id="LC8125">        <span>if</span> (<span>GetMethod</span>(inlineeHnd))</td>
      </tr>
      <tr>
        <td id="L8126" data-line-number="8126"></td>
        <td id="LC8126">        {</td>
      </tr>
      <tr>
        <td id="L8127" data-line-number="8127"></td>
        <td id="LC8127">            inlineeMethodName.<span>AppendUTF8</span>(<span>GetMethod</span>(inlineeHnd)-&gt;<span>GetModule_NoLogging</span>()-&gt;<span>GetFile</span>()-&gt;<span>GetSimpleName</span>());</td>
      </tr>
      <tr>
        <td id="L8128" data-line-number="8128"></td>
        <td id="LC8128">            inlineeMethodName.<span>Append</span>(L<span><span>'</span>/<span>'</span></span>);</td>
      </tr>
      <tr>
        <td id="L8129" data-line-number="8129"></td>
        <td id="LC8129">            <span>TypeString::AppendMethodInternal</span>(inlineeMethodName, <span>GetMethod</span>(inlineeHnd), TypeString::FormatBasic);</td>
      </tr>
      <tr>
        <td id="L8130" data-line-number="8130"></td>
        <td id="LC8130">        }</td>
      </tr>
      <tr>
        <td id="L8131" data-line-number="8131"></td>
        <td id="LC8131">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8132" data-line-number="8132"></td>
        <td id="LC8132">        {</td>
      </tr>
      <tr>
        <td id="L8133" data-line-number="8133"></td>
        <td id="LC8133">            inlineeMethodName.<span>AppendASCII</span>( <span><span>"</span>&lt;null&gt;<span>"</span></span> );</td>
      </tr>
      <tr>
        <td id="L8134" data-line-number="8134"></td>
        <td id="LC8134">        }</td>
      </tr>
      <tr>
        <td id="L8135" data-line-number="8135"></td>
        <td id="LC8135">
</td>
      </tr>
      <tr>
        <td id="L8136" data-line-number="8136"></td>
        <td id="LC8136">        SString inlinerMethodName;</td>
      </tr>
      <tr>
        <td id="L8137" data-line-number="8137"></td>
        <td id="LC8137">        <span>if</span> (<span>GetMethod</span>(inlinerHnd))</td>
      </tr>
      <tr>
        <td id="L8138" data-line-number="8138"></td>
        <td id="LC8138">        {</td>
      </tr>
      <tr>
        <td id="L8139" data-line-number="8139"></td>
        <td id="LC8139">            inlinerMethodName.<span>AppendUTF8</span>(<span>GetMethod</span>(inlinerHnd)-&gt;<span>GetModule_NoLogging</span>()-&gt;<span>GetFile</span>()-&gt;<span>GetSimpleName</span>());</td>
      </tr>
      <tr>
        <td id="L8140" data-line-number="8140"></td>
        <td id="LC8140">            inlinerMethodName.<span>Append</span>(L<span><span>'</span>/<span>'</span></span>);</td>
      </tr>
      <tr>
        <td id="L8141" data-line-number="8141"></td>
        <td id="LC8141">            <span>TypeString::AppendMethodInternal</span>(inlinerMethodName, <span>GetMethod</span>(inlinerHnd), TypeString::FormatBasic);</td>
      </tr>
      <tr>
        <td id="L8142" data-line-number="8142"></td>
        <td id="LC8142">        }</td>
      </tr>
      <tr>
        <td id="L8143" data-line-number="8143"></td>
        <td id="LC8143">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8144" data-line-number="8144"></td>
        <td id="LC8144">        {</td>
      </tr>
      <tr>
        <td id="L8145" data-line-number="8145"></td>
        <td id="LC8145">            inlinerMethodName.<span>AppendASCII</span>(<span><span>"</span>&lt;null&gt;<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L8146" data-line-number="8146"></td>
        <td id="LC8146">        }</td>
      </tr>
      <tr>
        <td id="L8147" data-line-number="8147"></td>
        <td id="LC8147">
</td>
      </tr>
      <tr>
        <td id="L8148" data-line-number="8148"></td>
        <td id="LC8148">        <span>if</span> (<span>dontInline</span>(inlineResult))</td>
      </tr>
      <tr>
        <td id="L8149" data-line-number="8149"></td>
        <td id="LC8149">        {</td>
      </tr>
      <tr>
        <td id="L8150" data-line-number="8150"></td>
        <td id="LC8150">            <span>LOG</span>((LF_JIT, LL_INFO100000,</td>
      </tr>
      <tr>
        <td id="L8151" data-line-number="8151"></td>
        <td id="LC8151">                 <span><span>"</span>While compiling '%S', inline of '%S' into '%S' failed because: '%s'.<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L8152" data-line-number="8152"></td>
        <td id="LC8152">                 currentMethodName.<span>GetUnicode</span>(), inlineeMethodName.<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8153" data-line-number="8153"></td>
        <td id="LC8153">                 inlinerMethodName.<span>GetUnicode</span>(), reason));</td>
      </tr>
      <tr>
        <td id="L8154" data-line-number="8154"></td>
        <td id="LC8154">        }</td>
      </tr>
      <tr>
        <td id="L8155" data-line-number="8155"></td>
        <td id="LC8155">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8156" data-line-number="8156"></td>
        <td id="LC8156">        {</td>
      </tr>
      <tr>
        <td id="L8157" data-line-number="8157"></td>
        <td id="LC8157">            <span>LOG</span>((LF_JIT, LL_INFO100000, <span><span>"</span>While compiling '%S', inline of '%S' into '%S' succeeded.<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L8158" data-line-number="8158"></td>
        <td id="LC8158">                 currentMethodName.<span>GetUnicode</span>(), inlineeMethodName.<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8159" data-line-number="8159"></td>
        <td id="LC8159">                 inlinerMethodName.<span>GetUnicode</span>()));</td>
      </tr>
      <tr>
        <td id="L8160" data-line-number="8160"></td>
        <td id="LC8160">
</td>
      </tr>
      <tr>
        <td id="L8161" data-line-number="8161"></td>
        <td id="LC8161">        }</td>
      </tr>
      <tr>
        <td id="L8162" data-line-number="8162"></td>
        <td id="LC8162">    }</td>
      </tr>
      <tr>
        <td id="L8163" data-line-number="8163"></td>
        <td id="LC8163">#<span>endif</span> <span><span>//</span>_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L8164" data-line-number="8164"></td>
        <td id="LC8164">
</td>
      </tr>
      <tr>
        <td id="L8165" data-line-number="8165"></td>
        <td id="LC8165">    <span><span>//</span>I'm gonna duplicate this code because the format is slightly different.  And LoggingOn is debug only.</span></td>
      </tr>
      <tr>
        <td id="L8166" data-line-number="8166"></td>
        <td id="LC8166">    <span>if</span> (<span>ETW_TRACING_CATEGORY_ENABLED</span>(MICROSOFT_WINDOWS_DOTNETRUNTIME_PROVIDER_DOTNET_Context,</td>
      </tr>
      <tr>
        <td id="L8167" data-line-number="8167"></td>
        <td id="LC8167">                                     TRACE_LEVEL_VERBOSE,</td>
      </tr>
      <tr>
        <td id="L8168" data-line-number="8168"></td>
        <td id="LC8168">                                     CLR_JITTRACING_KEYWORD))</td>
      </tr>
      <tr>
        <td id="L8169" data-line-number="8169"></td>
        <td id="LC8169">    {</td>
      </tr>
      <tr>
        <td id="L8170" data-line-number="8170"></td>
        <td id="LC8170">        SString methodBeingCompiledNames[<span>3</span>];</td>
      </tr>
      <tr>
        <td id="L8171" data-line-number="8171"></td>
        <td id="LC8171">        SString inlinerNames[<span>3</span>];</td>
      </tr>
      <tr>
        <td id="L8172" data-line-number="8172"></td>
        <td id="LC8172">        SString inlineeNames[<span>3</span>];</td>
      </tr>
      <tr>
        <td id="L8173" data-line-number="8173"></td>
        <td id="LC8173">        MethodDesc * methodBeingCompiled = m_pMethodBeingCompiled;</td>
      </tr>
      <tr>
        <td id="L8174" data-line-number="8174"></td>
        <td id="LC8174">#<span>define</span> <span>GMI</span>(<span>pMD, strArray</span>) \</td>
      </tr>
      <tr>
        <td id="L8175" data-line-number="8175"></td>
        <td id="LC8175">        <span>do</span> { \</td>
      </tr>
      <tr>
        <td id="L8176" data-line-number="8176"></td>
        <td id="LC8176">            <span>if</span> (pMD) { \</td>
      </tr>
      <tr>
        <td id="L8177" data-line-number="8177"></td>
        <td id="LC8177">                (pMD)-&gt;<span>GetMethodInfo</span>((strArray)[<span>0</span>], (strArray)[<span>1</span>], (strArray)[<span>2</span>]); \</td>
      </tr>
      <tr>
        <td id="L8178" data-line-number="8178"></td>
        <td id="LC8178">            } <span>else</span> {  \</td>
      </tr>
      <tr>
        <td id="L8179" data-line-number="8179"></td>
        <td id="LC8179">                (strArray)[<span>0</span>].<span>Set</span>(<span>W</span>(<span><span>"</span>&lt;null&gt;<span>"</span></span>)); \</td>
      </tr>
      <tr>
        <td id="L8180" data-line-number="8180"></td>
        <td id="LC8180">                (strArray)[<span>1</span>].<span>Set</span>(<span>W</span>(<span><span>"</span>&lt;null&gt;<span>"</span></span>)); \</td>
      </tr>
      <tr>
        <td id="L8181" data-line-number="8181"></td>
        <td id="LC8181">                (strArray)[<span>2</span>].<span>Set</span>(<span>W</span>(<span><span>"</span>&lt;null&gt;<span>"</span></span>)); \</td>
      </tr>
      <tr>
        <td id="L8182" data-line-number="8182"></td>
        <td id="LC8182">            } } <span>while</span> (<span>0</span>)</td>
      </tr>
      <tr>
        <td id="L8183" data-line-number="8183"></td>
        <td id="LC8183">
</td>
      </tr>
      <tr>
        <td id="L8184" data-line-number="8184"></td>
        <td id="LC8184">        <span>GMI</span>(methodBeingCompiled, methodBeingCompiledNames);</td>
      </tr>
      <tr>
        <td id="L8185" data-line-number="8185"></td>
        <td id="LC8185">        <span>GMI</span>(<span>GetMethod</span>(inlinerHnd), inlinerNames);</td>
      </tr>
      <tr>
        <td id="L8186" data-line-number="8186"></td>
        <td id="LC8186">        <span>GMI</span>(<span>GetMethod</span>(inlineeHnd), inlineeNames);</td>
      </tr>
      <tr>
        <td id="L8187" data-line-number="8187"></td>
        <td id="LC8187">#<span>undef</span> GMI</td>
      </tr>
      <tr>
        <td id="L8188" data-line-number="8188"></td>
        <td id="LC8188">        <span>if</span> (<span>dontInline</span>(inlineResult))</td>
      </tr>
      <tr>
        <td id="L8189" data-line-number="8189"></td>
        <td id="LC8189">        {</td>
      </tr>
      <tr>
        <td id="L8190" data-line-number="8190"></td>
        <td id="LC8190">            <span>const</span> <span>char</span> * str = (reason ? reason : <span><span>"</span><span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L8191" data-line-number="8191"></td>
        <td id="LC8191">            SString strReason;</td>
      </tr>
      <tr>
        <td id="L8192" data-line-number="8192"></td>
        <td id="LC8192">            strReason.<span>SetANSI</span>(str);</td>
      </tr>
      <tr>
        <td id="L8193" data-line-number="8193"></td>
        <td id="LC8193">
</td>
      </tr>
      <tr>
        <td id="L8194" data-line-number="8194"></td>
        <td id="LC8194">
</td>
      </tr>
      <tr>
        <td id="L8195" data-line-number="8195"></td>
        <td id="LC8195">            <span>FireEtwMethodJitInliningFailed</span>(methodBeingCompiledNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8196" data-line-number="8196"></td>
        <td id="LC8196">                                           methodBeingCompiledNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8197" data-line-number="8197"></td>
        <td id="LC8197">                                           methodBeingCompiledNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8198" data-line-number="8198"></td>
        <td id="LC8198">                                           inlinerNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8199" data-line-number="8199"></td>
        <td id="LC8199">                                           inlinerNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8200" data-line-number="8200"></td>
        <td id="LC8200">                                           inlinerNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8201" data-line-number="8201"></td>
        <td id="LC8201">                                           inlineeNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8202" data-line-number="8202"></td>
        <td id="LC8202">                                           inlineeNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8203" data-line-number="8203"></td>
        <td id="LC8203">                                           inlineeNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8204" data-line-number="8204"></td>
        <td id="LC8204">                                           inlineResult == INLINE_NEVER,</td>
      </tr>
      <tr>
        <td id="L8205" data-line-number="8205"></td>
        <td id="LC8205">                                           strReason.<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8206" data-line-number="8206"></td>
        <td id="LC8206">                                           <span>GetClrInstanceId</span>());</td>
      </tr>
      <tr>
        <td id="L8207" data-line-number="8207"></td>
        <td id="LC8207">        }</td>
      </tr>
      <tr>
        <td id="L8208" data-line-number="8208"></td>
        <td id="LC8208">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8209" data-line-number="8209"></td>
        <td id="LC8209">        {</td>
      </tr>
      <tr>
        <td id="L8210" data-line-number="8210"></td>
        <td id="LC8210">            <span>FireEtwMethodJitInliningSucceeded</span>(methodBeingCompiledNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8211" data-line-number="8211"></td>
        <td id="LC8211">                                              methodBeingCompiledNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8212" data-line-number="8212"></td>
        <td id="LC8212">                                              methodBeingCompiledNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8213" data-line-number="8213"></td>
        <td id="LC8213">                                              inlinerNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8214" data-line-number="8214"></td>
        <td id="LC8214">                                              inlinerNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8215" data-line-number="8215"></td>
        <td id="LC8215">                                              inlinerNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8216" data-line-number="8216"></td>
        <td id="LC8216">                                              inlineeNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8217" data-line-number="8217"></td>
        <td id="LC8217">                                              inlineeNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8218" data-line-number="8218"></td>
        <td id="LC8218">                                              inlineeNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8219" data-line-number="8219"></td>
        <td id="LC8219">                                              <span>GetClrInstanceId</span>());</td>
      </tr>
      <tr>
        <td id="L8220" data-line-number="8220"></td>
        <td id="LC8220">        }</td>
      </tr>
      <tr>
        <td id="L8221" data-line-number="8221"></td>
        <td id="LC8221">
</td>
      </tr>
      <tr>
        <td id="L8222" data-line-number="8222"></td>
        <td id="LC8222">    }</td>
      </tr>
      <tr>
        <td id="L8223" data-line-number="8223"></td>
        <td id="LC8223">
</td>
      </tr>
      <tr>
        <td id="L8224" data-line-number="8224"></td>
        <td id="LC8224">
</td>
      </tr>
      <tr>
        <td id="L8225" data-line-number="8225"></td>
        <td id="LC8225">#<span>if</span> defined FEATURE_REJIT &amp;&amp; !defined(DACCESS_COMPILE) &amp;&amp; !defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L8226" data-line-number="8226"></td>
        <td id="LC8226">    <span>if</span>(inlineResult == INLINE_PASS)</td>
      </tr>
      <tr>
        <td id="L8227" data-line-number="8227"></td>
        <td id="LC8227">    {</td>
      </tr>
      <tr>
        <td id="L8228" data-line-number="8228"></td>
        <td id="LC8228">        <span><span>//</span> We don't want to track the chain of methods, so intentionally use m_pMethodBeingCompiled</span></td>
      </tr>
      <tr>
        <td id="L8229" data-line-number="8229"></td>
        <td id="LC8229">        <span><span>//</span> to just track the methods that pCallee is eventually inlined in</span></td>
      </tr>
      <tr>
        <td id="L8230" data-line-number="8230"></td>
        <td id="LC8230">        MethodDesc *pCallee = <span>GetMethod</span>(inlineeHnd);</td>
      </tr>
      <tr>
        <td id="L8231" data-line-number="8231"></td>
        <td id="LC8231">        MethodDesc *pCaller = m_pMethodBeingCompiled;</td>
      </tr>
      <tr>
        <td id="L8232" data-line-number="8232"></td>
        <td id="LC8232">        pCallee-&gt;<span>GetModule</span>()-&gt;<span>AddInlining</span>(pCaller, pCallee);</td>
      </tr>
      <tr>
        <td id="L8233" data-line-number="8233"></td>
        <td id="LC8233">
</td>
      </tr>
      <tr>
        <td id="L8234" data-line-number="8234"></td>
        <td id="LC8234">        <span>if</span> (<span>CORProfilerEnableRejit</span>())</td>
      </tr>
      <tr>
        <td id="L8235" data-line-number="8235"></td>
        <td id="LC8235">        {</td>
      </tr>
      <tr>
        <td id="L8236" data-line-number="8236"></td>
        <td id="LC8236">            <span><span>//</span> If ReJIT is enabled, there is a chance that a race happened where the profiler</span></td>
      </tr>
      <tr>
        <td id="L8237" data-line-number="8237"></td>
        <td id="LC8237">            <span><span>//</span> requested a ReJIT on a method, but before the ReJIT occurred an inlining happened.</span></td>
      </tr>
      <tr>
        <td id="L8238" data-line-number="8238"></td>
        <td id="LC8238">            <span><span>//</span> If we end up reporting an inlining on a method with non-default IL it means the race</span></td>
      </tr>
      <tr>
        <td id="L8239" data-line-number="8239"></td>
        <td id="LC8239">            <span><span>//</span> happened and we need to manually request ReJIT for it since it was missed.</span></td>
      </tr>
      <tr>
        <td id="L8240" data-line-number="8240"></td>
        <td id="LC8240">            CodeVersionManager* pCodeVersionManager = pCallee-&gt;<span>GetCodeVersionManager</span>();</td>
      </tr>
      <tr>
        <td id="L8241" data-line-number="8241"></td>
        <td id="LC8241">            CodeVersionManager::LockHolder codeVersioningLockHolder;</td>
      </tr>
      <tr>
        <td id="L8242" data-line-number="8242"></td>
        <td id="LC8242">            ILCodeVersion ilVersion = pCodeVersionManager-&gt;<span>GetActiveILCodeVersion</span>(pCallee);</td>
      </tr>
      <tr>
        <td id="L8243" data-line-number="8243"></td>
        <td id="LC8243">            <span>if</span> (ilVersion.<span>GetRejitState</span>() != ILCodeVersion::<span>kStateActive</span> || !ilVersion.<span>HasDefaultIL</span>())</td>
      </tr>
      <tr>
        <td id="L8244" data-line-number="8244"></td>
        <td id="LC8244">            {</td>
      </tr>
      <tr>
        <td id="L8245" data-line-number="8245"></td>
        <td id="LC8245">                ModuleID modId = pCaller-&gt;<span>GetModule</span>()-&gt;<span>GetModuleID</span>();</td>
      </tr>
      <tr>
        <td id="L8246" data-line-number="8246"></td>
        <td id="LC8246">                mdMethodDef methodDef = pCaller-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L8247" data-line-number="8247"></td>
        <td id="LC8247">                <span>ReJitManager::RequestReJIT</span>(<span>1</span>, &amp;modId, &amp;methodDef, <span>static_cast</span>&lt;COR_PRF_REJIT_FLAGS&gt;(<span>0</span>));</td>
      </tr>
      <tr>
        <td id="L8248" data-line-number="8248"></td>
        <td id="LC8248">            }</td>
      </tr>
      <tr>
        <td id="L8249" data-line-number="8249"></td>
        <td id="LC8249">        }</td>
      </tr>
      <tr>
        <td id="L8250" data-line-number="8250"></td>
        <td id="LC8250">    }</td>
      </tr>
      <tr>
        <td id="L8251" data-line-number="8251"></td>
        <td id="LC8251">#<span>endif</span> <span><span>//</span> defined FEATURE_REJIT &amp;&amp; !defined(DACCESS_COMPILE) &amp;&amp; !defined(CROSSGEN_COMPILE)</span></td>
      </tr>
      <tr>
        <td id="L8252" data-line-number="8252"></td>
        <td id="LC8252">
</td>
      </tr>
      <tr>
        <td id="L8253" data-line-number="8253"></td>
        <td id="LC8253">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8254" data-line-number="8254"></td>
        <td id="LC8254">}</td>
      </tr>
      <tr>
        <td id="L8255" data-line-number="8255"></td>
        <td id="LC8255">
</td>
      </tr>
      <tr>
        <td id="L8256" data-line-number="8256"></td>
        <td id="LC8256">
</td>
      </tr>
      <tr>
        <td id="L8257" data-line-number="8257"></td>
        <td id="LC8257"><span><span>/*</span>************************************************************</span></td>
      </tr>
      <tr>
        <td id="L8258" data-line-number="8258"></td>
        <td id="LC8258"><span>This loads the (formal) declared constraints on the class and method type parameters,</span></td>
      </tr>
      <tr>
        <td id="L8259" data-line-number="8259"></td>
        <td id="LC8259"><span>and detects (but does not itself reject) circularities among the class type parameters</span></td>
      </tr>
      <tr>
        <td id="L8260" data-line-number="8260"></td>
        <td id="LC8260"><span>and (separately) method type parameters.</span></td>
      </tr>
      <tr>
        <td id="L8261" data-line-number="8261"></td>
        <td id="LC8261"><span></span></td>
      </tr>
      <tr>
        <td id="L8262" data-line-number="8262"></td>
        <td id="LC8262"><span>It must be called whenever we verify a typical method, ie any method (generic or</span></td>
      </tr>
      <tr>
        <td id="L8263" data-line-number="8263"></td>
        <td id="LC8263"><span>nongeneric) in a typical class. It must be called for non-generic methods too,</span></td>
      </tr>
      <tr>
        <td id="L8264" data-line-number="8264"></td>
        <td id="LC8264"><span>because their bodies may still mention class type parameters which will need to</span></td>
      </tr>
      <tr>
        <td id="L8265" data-line-number="8265"></td>
        <td id="LC8265"><span>have their formal constraints loaded in order to perform type compatibility tests.</span></td>
      </tr>
      <tr>
        <td id="L8266" data-line-number="8266"></td>
        <td id="LC8266"><span></span></td>
      </tr>
      <tr>
        <td id="L8267" data-line-number="8267"></td>
        <td id="LC8267"><span>We have to rule out cycles like "C&lt;U,T&gt; where T:U, U:T" only to avoid looping</span></td>
      </tr>
      <tr>
        <td id="L8268" data-line-number="8268"></td>
        <td id="LC8268"><span>in the verifier (ie the T.CanCast(A) would loop calling U.CanCast(A) then</span></td>
      </tr>
      <tr>
        <td id="L8269" data-line-number="8269"></td>
        <td id="LC8269"><span>T.CanCastTo(A) etc.). Since the JIT only tries to walk the hierarchy from a type</span></td>
      </tr>
      <tr>
        <td id="L8270" data-line-number="8270"></td>
        <td id="LC8270"><span>a parameter when verifying, it should be safe to JIT unverified, but trusted,</span></td>
      </tr>
      <tr>
        <td id="L8271" data-line-number="8271"></td>
        <td id="LC8271"><span>instantiations even in the presence of cycle constraints.</span></td>
      </tr>
      <tr>
        <td id="L8272" data-line-number="8272"></td>
        <td id="LC8272"><span>@TODO: It should be possible (and easy) to detect cycles much earlier on by</span></td>
      </tr>
      <tr>
        <td id="L8273" data-line-number="8273"></td>
        <td id="LC8273"><span>directly inspecting the metadata. All you have to do is check that, for each</span></td>
      </tr>
      <tr>
        <td id="L8274" data-line-number="8274"></td>
        <td id="LC8274"><span>of the n type parameters to a class or method there is no path of length n</span></td>
      </tr>
      <tr>
        <td id="L8275" data-line-number="8275"></td>
        <td id="LC8275"><span>obtained by following naked type parameter constraints of the same kind.</span></td>
      </tr>
      <tr>
        <td id="L8276" data-line-number="8276"></td>
        <td id="LC8276"><span>This can be detected by looking directly at metadata, without actually loading</span></td>
      </tr>
      <tr>
        <td id="L8277" data-line-number="8277"></td>
        <td id="LC8277"><span>the typehandles for the naked type parameters.</span></td>
      </tr>
      <tr>
        <td id="L8278" data-line-number="8278"></td>
        <td id="LC8278"><span> ************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8279" data-line-number="8279"></td>
        <td id="LC8279">
</td>
      </tr>
      <tr>
        <td id="L8280" data-line-number="8280"></td>
        <td id="LC8280"><span>void</span> <span>CEEInfo::initConstraintsForVerification</span>(CORINFO_METHOD_HANDLE hMethod,</td>
      </tr>
      <tr>
        <td id="L8281" data-line-number="8281"></td>
        <td id="LC8281">                                             BOOL *pfHasCircularClassConstraints,</td>
      </tr>
      <tr>
        <td id="L8282" data-line-number="8282"></td>
        <td id="LC8282">                                             BOOL *pfHasCircularMethodConstraints)</td>
      </tr>
      <tr>
        <td id="L8283" data-line-number="8283"></td>
        <td id="LC8283">{</td>
      </tr>
      <tr>
        <td id="L8284" data-line-number="8284"></td>
        <td id="LC8284">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8285" data-line-number="8285"></td>
        <td id="LC8285">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8286" data-line-number="8286"></td>
        <td id="LC8286">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8287" data-line-number="8287"></td>
        <td id="LC8287">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8288" data-line-number="8288"></td>
        <td id="LC8288">        <span>PRECONDITION</span>(<span>CheckPointer</span>(pfHasCircularClassConstraints));</td>
      </tr>
      <tr>
        <td id="L8289" data-line-number="8289"></td>
        <td id="LC8289">        <span>PRECONDITION</span>(<span>CheckPointer</span>(pfHasCircularMethodConstraints));</td>
      </tr>
      <tr>
        <td id="L8290" data-line-number="8290"></td>
        <td id="LC8290">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8291" data-line-number="8291"></td>
        <td id="LC8291">
</td>
      </tr>
      <tr>
        <td id="L8292" data-line-number="8292"></td>
        <td id="LC8292">    *pfHasCircularClassConstraints  = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L8293" data-line-number="8293"></td>
        <td id="LC8293">    *pfHasCircularMethodConstraints = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L8294" data-line-number="8294"></td>
        <td id="LC8294">
</td>
      </tr>
      <tr>
        <td id="L8295" data-line-number="8295"></td>
        <td id="LC8295">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8296" data-line-number="8296"></td>
        <td id="LC8296">
</td>
      </tr>
      <tr>
        <td id="L8297" data-line-number="8297"></td>
        <td id="LC8297">    MethodDesc* pMethod = <span>GetMethod</span>(hMethod);</td>
      </tr>
      <tr>
        <td id="L8298" data-line-number="8298"></td>
        <td id="LC8298">    <span>if</span> (pMethod-&gt;<span>IsTypicalMethodDefinition</span>())</td>
      </tr>
      <tr>
        <td id="L8299" data-line-number="8299"></td>
        <td id="LC8299">    {</td>
      </tr>
      <tr>
        <td id="L8300" data-line-number="8300"></td>
        <td id="LC8300">        <span><span>//</span> Force a load of the constraints on the type parameters, detecting cyclic bounds</span></td>
      </tr>
      <tr>
        <td id="L8301" data-line-number="8301"></td>
        <td id="LC8301">        pMethod-&gt;<span>LoadConstraintsForTypicalMethodDefinition</span>(pfHasCircularClassConstraints,pfHasCircularMethodConstraints);</td>
      </tr>
      <tr>
        <td id="L8302" data-line-number="8302"></td>
        <td id="LC8302">    }</td>
      </tr>
      <tr>
        <td id="L8303" data-line-number="8303"></td>
        <td id="LC8303">
</td>
      </tr>
      <tr>
        <td id="L8304" data-line-number="8304"></td>
        <td id="LC8304">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8305" data-line-number="8305"></td>
        <td id="LC8305">}</td>
      </tr>
      <tr>
        <td id="L8306" data-line-number="8306"></td>
        <td id="LC8306">
</td>
      </tr>
      <tr>
        <td id="L8307" data-line-number="8307"></td>
        <td id="LC8307"><span><span>/*</span>************************************************************</span></td>
      </tr>
      <tr>
        <td id="L8308" data-line-number="8308"></td>
        <td id="LC8308"><span> * Check if a method to be compiled is an instantiation</span></td>
      </tr>
      <tr>
        <td id="L8309" data-line-number="8309"></td>
        <td id="LC8309"><span> * of generic code that has already been verified.</span></td>
      </tr>
      <tr>
        <td id="L8310" data-line-number="8310"></td>
        <td id="LC8310"><span> * Three possible return values (see corinfo.h)</span></td>
      </tr>
      <tr>
        <td id="L8311" data-line-number="8311"></td>
        <td id="LC8311"><span> ************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8312" data-line-number="8312"></td>
        <td id="LC8312">
</td>
      </tr>
      <tr>
        <td id="L8313" data-line-number="8313"></td>
        <td id="LC8313">CorInfoInstantiationVerification</td>
      </tr>
      <tr>
        <td id="L8314" data-line-number="8314"></td>
        <td id="LC8314">    <span>CEEInfo::isInstantiationOfVerifiedGeneric</span>(CORINFO_METHOD_HANDLE hMethod)</td>
      </tr>
      <tr>
        <td id="L8315" data-line-number="8315"></td>
        <td id="LC8315">{</td>
      </tr>
      <tr>
        <td id="L8316" data-line-number="8316"></td>
        <td id="LC8316">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8317" data-line-number="8317"></td>
        <td id="LC8317">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8318" data-line-number="8318"></td>
        <td id="LC8318">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8319" data-line-number="8319"></td>
        <td id="LC8319">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8320" data-line-number="8320"></td>
        <td id="LC8320">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8321" data-line-number="8321"></td>
        <td id="LC8321">
</td>
      </tr>
      <tr>
        <td id="L8322" data-line-number="8322"></td>
        <td id="LC8322">    CorInfoInstantiationVerification result = INSTVER_NOT_INSTANTIATION;</td>
      </tr>
      <tr>
        <td id="L8323" data-line-number="8323"></td>
        <td id="LC8323">
</td>
      </tr>
      <tr>
        <td id="L8324" data-line-number="8324"></td>
        <td id="LC8324">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8325" data-line-number="8325"></td>
        <td id="LC8325">
</td>
      </tr>
      <tr>
        <td id="L8326" data-line-number="8326"></td>
        <td id="LC8326">    MethodDesc * pMethod = <span>GetMethod</span>(hMethod);</td>
      </tr>
      <tr>
        <td id="L8327" data-line-number="8327"></td>
        <td id="LC8327">
</td>
      </tr>
      <tr>
        <td id="L8328" data-line-number="8328"></td>
        <td id="LC8328">    <span>if</span> (!(pMethod-&gt;<span>HasClassOrMethodInstantiation</span>()))</td>
      </tr>
      <tr>
        <td id="L8329" data-line-number="8329"></td>
        <td id="LC8329">    {</td>
      </tr>
      <tr>
        <td id="L8330" data-line-number="8330"></td>
        <td id="LC8330">        result = INSTVER_NOT_INSTANTIATION;</td>
      </tr>
      <tr>
        <td id="L8331" data-line-number="8331"></td>
        <td id="LC8331">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8332" data-line-number="8332"></td>
        <td id="LC8332">    }</td>
      </tr>
      <tr>
        <td id="L8333" data-line-number="8333"></td>
        <td id="LC8333">
</td>
      </tr>
      <tr>
        <td id="L8334" data-line-number="8334"></td>
        <td id="LC8334">    <span>if</span> (pMethod-&gt;<span>IsTypicalMethodDefinition</span>())</td>
      </tr>
      <tr>
        <td id="L8335" data-line-number="8335"></td>
        <td id="LC8335">    {</td>
      </tr>
      <tr>
        <td id="L8336" data-line-number="8336"></td>
        <td id="LC8336">        result = INSTVER_NOT_INSTANTIATION;</td>
      </tr>
      <tr>
        <td id="L8337" data-line-number="8337"></td>
        <td id="LC8337">        <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8338" data-line-number="8338"></td>
        <td id="LC8338">    }</td>
      </tr>
      <tr>
        <td id="L8339" data-line-number="8339"></td>
        <td id="LC8339">
</td>
      </tr>
      <tr>
        <td id="L8340" data-line-number="8340"></td>
        <td id="LC8340">    result = INSTVER_GENERIC_PASSED_VERIFICATION;</td>
      </tr>
      <tr>
        <td id="L8341" data-line-number="8341"></td>
        <td id="LC8341">
</td>
      </tr>
      <tr>
        <td id="L8342" data-line-number="8342"></td>
        <td id="LC8342"> <span>exit</span>: ;</td>
      </tr>
      <tr>
        <td id="L8343" data-line-number="8343"></td>
        <td id="LC8343">
</td>
      </tr>
      <tr>
        <td id="L8344" data-line-number="8344"></td>
        <td id="LC8344">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8345" data-line-number="8345"></td>
        <td id="LC8345">
</td>
      </tr>
      <tr>
        <td id="L8346" data-line-number="8346"></td>
        <td id="LC8346">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L8347" data-line-number="8347"></td>
        <td id="LC8347">}</td>
      </tr>
      <tr>
        <td id="L8348" data-line-number="8348"></td>
        <td id="LC8348">
</td>
      </tr>
      <tr>
        <td id="L8349" data-line-number="8349"></td>
        <td id="LC8349"><span><span>/*</span>************************************************************</span></td>
      </tr>
      <tr>
        <td id="L8350" data-line-number="8350"></td>
        <td id="LC8350"><span> * Similar to above, but perform check for tail call</span></td>
      </tr>
      <tr>
        <td id="L8351" data-line-number="8351"></td>
        <td id="LC8351"><span> * eligibility. The callee can be passed as NULL if not known</span></td>
      </tr>
      <tr>
        <td id="L8352" data-line-number="8352"></td>
        <td id="LC8352"><span> * (calli and callvirt).</span></td>
      </tr>
      <tr>
        <td id="L8353" data-line-number="8353"></td>
        <td id="LC8353"><span> ************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8354" data-line-number="8354"></td>
        <td id="LC8354">
</td>
      </tr>
      <tr>
        <td id="L8355" data-line-number="8355"></td>
        <td id="LC8355"><span>bool</span> <span>CEEInfo::canTailCall</span> (CORINFO_METHOD_HANDLE hCaller,</td>
      </tr>
      <tr>
        <td id="L8356" data-line-number="8356"></td>
        <td id="LC8356">                           CORINFO_METHOD_HANDLE hDeclaredCallee,</td>
      </tr>
      <tr>
        <td id="L8357" data-line-number="8357"></td>
        <td id="LC8357">                           CORINFO_METHOD_HANDLE hExactCallee,</td>
      </tr>
      <tr>
        <td id="L8358" data-line-number="8358"></td>
        <td id="LC8358">                           <span>bool</span> <span>fIsTailPrefix</span>)</td>
      </tr>
      <tr>
        <td id="L8359" data-line-number="8359"></td>
        <td id="LC8359">{</td>
      </tr>
      <tr>
        <td id="L8360" data-line-number="8360"></td>
        <td id="LC8360">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8361" data-line-number="8361"></td>
        <td id="LC8361">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8362" data-line-number="8362"></td>
        <td id="LC8362">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8363" data-line-number="8363"></td>
        <td id="LC8363">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8364" data-line-number="8364"></td>
        <td id="LC8364">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8365" data-line-number="8365"></td>
        <td id="LC8365">
</td>
      </tr>
      <tr>
        <td id="L8366" data-line-number="8366"></td>
        <td id="LC8366">    <span>bool</span> result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L8367" data-line-number="8367"></td>
        <td id="LC8367">    <span>const</span> <span>char</span> * szFailReason = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L8368" data-line-number="8368"></td>
        <td id="LC8368">
</td>
      </tr>
      <tr>
        <td id="L8369" data-line-number="8369"></td>
        <td id="LC8369">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8370" data-line-number="8370"></td>
        <td id="LC8370">
</td>
      </tr>
      <tr>
        <td id="L8371" data-line-number="8371"></td>
        <td id="LC8371">    <span><span>//</span> See comments in canInline above.</span></td>
      </tr>
      <tr>
        <td id="L8372" data-line-number="8372"></td>
        <td id="LC8372">
</td>
      </tr>
      <tr>
        <td id="L8373" data-line-number="8373"></td>
        <td id="LC8373">    MethodDesc* pCaller = <span>GetMethod</span>(hCaller);</td>
      </tr>
      <tr>
        <td id="L8374" data-line-number="8374"></td>
        <td id="LC8374">    MethodDesc* pDeclaredCallee = <span>GetMethod</span>(hDeclaredCallee);</td>
      </tr>
      <tr>
        <td id="L8375" data-line-number="8375"></td>
        <td id="LC8375">    MethodDesc* pExactCallee = <span>GetMethod</span>(hExactCallee);</td>
      </tr>
      <tr>
        <td id="L8376" data-line-number="8376"></td>
        <td id="LC8376">
</td>
      </tr>
      <tr>
        <td id="L8377" data-line-number="8377"></td>
        <td id="LC8377">    <span>_ASSERTE</span>(pCaller-&gt;<span>GetModule</span>());</td>
      </tr>
      <tr>
        <td id="L8378" data-line-number="8378"></td>
        <td id="LC8378">    <span>_ASSERTE</span>(pCaller-&gt;<span>GetModule</span>()-&gt;<span>GetClassLoader</span>());</td>
      </tr>
      <tr>
        <td id="L8379" data-line-number="8379"></td>
        <td id="LC8379">
</td>
      </tr>
      <tr>
        <td id="L8380" data-line-number="8380"></td>
        <td id="LC8380">    <span>_ASSERTE</span>((pExactCallee == <span>NULL</span>) || pExactCallee-&gt;<span>GetModule</span>());</td>
      </tr>
      <tr>
        <td id="L8381" data-line-number="8381"></td>
        <td id="LC8381">    <span>_ASSERTE</span>((pExactCallee == <span>NULL</span>) || pExactCallee-&gt;<span>GetModule</span>()-&gt;<span>GetClassLoader</span>());</td>
      </tr>
      <tr>
        <td id="L8382" data-line-number="8382"></td>
        <td id="LC8382">
</td>
      </tr>
      <tr>
        <td id="L8383" data-line-number="8383"></td>
        <td id="LC8383">    <span>if</span> (!<span>fIsTailPrefix</span>)</td>
      </tr>
      <tr>
        <td id="L8384" data-line-number="8384"></td>
        <td id="LC8384">    {</td>
      </tr>
      <tr>
        <td id="L8385" data-line-number="8385"></td>
        <td id="LC8385">        mdMethodDef callerToken = pCaller-&gt;<span>GetMemberDef</span>();</td>
      </tr>
      <tr>
        <td id="L8386" data-line-number="8386"></td>
        <td id="LC8386">
</td>
      </tr>
      <tr>
        <td id="L8387" data-line-number="8387"></td>
        <td id="LC8387">        <span><span>//</span> We don't want to tailcall the entrypoint for an application; JIT64 will sometimes</span></td>
      </tr>
      <tr>
        <td id="L8388" data-line-number="8388"></td>
        <td id="LC8388">        <span><span>//</span> do this for simple entrypoints and it results in a rather confusing debugging</span></td>
      </tr>
      <tr>
        <td id="L8389" data-line-number="8389"></td>
        <td id="LC8389">        <span><span>//</span> experience.</span></td>
      </tr>
      <tr>
        <td id="L8390" data-line-number="8390"></td>
        <td id="LC8390">        <span>if</span> (callerToken == pCaller-&gt;<span>GetModule</span>()-&gt;<span>GetEntryPointToken</span>())</td>
      </tr>
      <tr>
        <td id="L8391" data-line-number="8391"></td>
        <td id="LC8391">        {</td>
      </tr>
      <tr>
        <td id="L8392" data-line-number="8392"></td>
        <td id="LC8392">            result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L8393" data-line-number="8393"></td>
        <td id="LC8393">            szFailReason = <span><span>"</span>Caller is the entry point<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8394" data-line-number="8394"></td>
        <td id="LC8394">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8395" data-line-number="8395"></td>
        <td id="LC8395">        }</td>
      </tr>
      <tr>
        <td id="L8396" data-line-number="8396"></td>
        <td id="LC8396">
</td>
      </tr>
      <tr>
        <td id="L8397" data-line-number="8397"></td>
        <td id="LC8397">        <span>if</span> (!pCaller-&gt;<span>IsNoMetadata</span>())</td>
      </tr>
      <tr>
        <td id="L8398" data-line-number="8398"></td>
        <td id="LC8398">        {</td>
      </tr>
      <tr>
        <td id="L8399" data-line-number="8399"></td>
        <td id="LC8399">            <span><span>//</span> Do not tailcall from methods that are marked as noinline (people often use no-inline</span></td>
      </tr>
      <tr>
        <td id="L8400" data-line-number="8400"></td>
        <td id="LC8400">            <span><span>//</span> to mean "I want to always see this method in stacktrace")</span></td>
      </tr>
      <tr>
        <td id="L8401" data-line-number="8401"></td>
        <td id="LC8401">            DWORD dwImplFlags = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L8402" data-line-number="8402"></td>
        <td id="LC8402">            <span>IfFailThrow</span>(pCaller-&gt;<span>GetMDImport</span>()-&gt;<span>GetMethodImplProps</span>(callerToken, <span>NULL</span>, &amp;dwImplFlags));</td>
      </tr>
      <tr>
        <td id="L8403" data-line-number="8403"></td>
        <td id="LC8403">
</td>
      </tr>
      <tr>
        <td id="L8404" data-line-number="8404"></td>
        <td id="LC8404">            <span>if</span> (<span>IsMiNoInlining</span>(dwImplFlags))</td>
      </tr>
      <tr>
        <td id="L8405" data-line-number="8405"></td>
        <td id="LC8405">            {</td>
      </tr>
      <tr>
        <td id="L8406" data-line-number="8406"></td>
        <td id="LC8406">                result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L8407" data-line-number="8407"></td>
        <td id="LC8407">                szFailReason = <span><span>"</span>Caller is marked as no inline<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8408" data-line-number="8408"></td>
        <td id="LC8408">                <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8409" data-line-number="8409"></td>
        <td id="LC8409">            }</td>
      </tr>
      <tr>
        <td id="L8410" data-line-number="8410"></td>
        <td id="LC8410">        }</td>
      </tr>
      <tr>
        <td id="L8411" data-line-number="8411"></td>
        <td id="LC8411">
</td>
      </tr>
      <tr>
        <td id="L8412" data-line-number="8412"></td>
        <td id="LC8412">        <span><span>//</span> Methods with StackCrawlMark depend on finding their caller on the stack.</span></td>
      </tr>
      <tr>
        <td id="L8413" data-line-number="8413"></td>
        <td id="LC8413">        <span><span>//</span> If we tail call one of these guys, they get confused.  For lack of</span></td>
      </tr>
      <tr>
        <td id="L8414" data-line-number="8414"></td>
        <td id="LC8414">        <span><span>//</span> a better way of identifying them, we use DynamicSecurity attribute to identify</span></td>
      </tr>
      <tr>
        <td id="L8415" data-line-number="8415"></td>
        <td id="LC8415">        <span><span>//</span> them. We have an assert in canInline that ensures all StackCrawlMark</span></td>
      </tr>
      <tr>
        <td id="L8416" data-line-number="8416"></td>
        <td id="LC8416">        <span><span>//</span> methods are appropriately marked.</span></td>
      </tr>
      <tr>
        <td id="L8417" data-line-number="8417"></td>
        <td id="LC8417">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8418" data-line-number="8418"></td>
        <td id="LC8418">        <span>if</span> ((pExactCallee != <span>NULL</span>) &amp;&amp; <span>IsMdRequireSecObject</span>(pExactCallee-&gt;<span>GetAttrs</span>()))</td>
      </tr>
      <tr>
        <td id="L8419" data-line-number="8419"></td>
        <td id="LC8419">        {</td>
      </tr>
      <tr>
        <td id="L8420" data-line-number="8420"></td>
        <td id="LC8420">            result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L8421" data-line-number="8421"></td>
        <td id="LC8421">            szFailReason = <span><span>"</span>Callee might have a StackCrawlMark.LookForMyCaller<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L8422" data-line-number="8422"></td>
        <td id="LC8422">            <span>goto</span> <span>exit</span>;</td>
      </tr>
      <tr>
        <td id="L8423" data-line-number="8423"></td>
        <td id="LC8423">        }</td>
      </tr>
      <tr>
        <td id="L8424" data-line-number="8424"></td>
        <td id="LC8424">    }</td>
      </tr>
      <tr>
        <td id="L8425" data-line-number="8425"></td>
        <td id="LC8425">
</td>
      </tr>
      <tr>
        <td id="L8426" data-line-number="8426"></td>
        <td id="LC8426">
</td>
      </tr>
      <tr>
        <td id="L8427" data-line-number="8427"></td>
        <td id="LC8427">    result = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L8428" data-line-number="8428"></td>
        <td id="LC8428">
</td>
      </tr>
      <tr>
        <td id="L8429" data-line-number="8429"></td>
        <td id="LC8429"><span>exit</span>: ;</td>
      </tr>
      <tr>
        <td id="L8430" data-line-number="8430"></td>
        <td id="LC8430">
</td>
      </tr>
      <tr>
        <td id="L8431" data-line-number="8431"></td>
        <td id="LC8431">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8432" data-line-number="8432"></td>
        <td id="LC8432">
</td>
      </tr>
      <tr>
        <td id="L8433" data-line-number="8433"></td>
        <td id="LC8433">    <span>if</span> (!result)</td>
      </tr>
      <tr>
        <td id="L8434" data-line-number="8434"></td>
        <td id="LC8434">    {</td>
      </tr>
      <tr>
        <td id="L8435" data-line-number="8435"></td>
        <td id="LC8435">        <span><span>//</span> If you hit this assert, it means you added a new way to prevent tail calls</span></td>
      </tr>
      <tr>
        <td id="L8436" data-line-number="8436"></td>
        <td id="LC8436">        <span><span>//</span> without documenting it for ETW!</span></td>
      </tr>
      <tr>
        <td id="L8437" data-line-number="8437"></td>
        <td id="LC8437">        <span>_ASSERTE</span>(szFailReason != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L8438" data-line-number="8438"></td>
        <td id="LC8438">        <span>reportTailCallDecision</span>(hCaller, hExactCallee, <span>fIsTailPrefix</span>, TAILCALL_FAIL, szFailReason);</td>
      </tr>
      <tr>
        <td id="L8439" data-line-number="8439"></td>
        <td id="LC8439">    }</td>
      </tr>
      <tr>
        <td id="L8440" data-line-number="8440"></td>
        <td id="LC8440">
</td>
      </tr>
      <tr>
        <td id="L8441" data-line-number="8441"></td>
        <td id="LC8441">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L8442" data-line-number="8442"></td>
        <td id="LC8442">}</td>
      </tr>
      <tr>
        <td id="L8443" data-line-number="8443"></td>
        <td id="LC8443">
</td>
      </tr>
      <tr>
        <td id="L8444" data-line-number="8444"></td>
        <td id="LC8444"><span>void</span> <span>CEEInfo::reportTailCallDecision</span> (CORINFO_METHOD_HANDLE callerHnd,</td>
      </tr>
      <tr>
        <td id="L8445" data-line-number="8445"></td>
        <td id="LC8445">                                     CORINFO_METHOD_HANDLE calleeHnd,</td>
      </tr>
      <tr>
        <td id="L8446" data-line-number="8446"></td>
        <td id="LC8446">                                     <span>bool</span> <span>fIsTailPrefix</span>,</td>
      </tr>
      <tr>
        <td id="L8447" data-line-number="8447"></td>
        <td id="LC8447">                                     CorInfoTailCall tailCallResult,</td>
      </tr>
      <tr>
        <td id="L8448" data-line-number="8448"></td>
        <td id="LC8448">                                     <span>const</span> <span>char</span> * reason)</td>
      </tr>
      <tr>
        <td id="L8449" data-line-number="8449"></td>
        <td id="LC8449">{</td>
      </tr>
      <tr>
        <td id="L8450" data-line-number="8450"></td>
        <td id="LC8450">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L8451" data-line-number="8451"></td>
        <td id="LC8451">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8452" data-line-number="8452"></td>
        <td id="LC8452">
</td>
      </tr>
      <tr>
        <td id="L8453" data-line-number="8453"></td>
        <td id="LC8453">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8454" data-line-number="8454"></td>
        <td id="LC8454">
</td>
      </tr>
      <tr>
        <td id="L8455" data-line-number="8455"></td>
        <td id="LC8455">    <span><span>//</span>put code here.  Make sure to report the method being compiled in addition to inliner and inlinee.</span></td>
      </tr>
      <tr>
        <td id="L8456" data-line-number="8456"></td>
        <td id="LC8456">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L8457" data-line-number="8457"></td>
        <td id="LC8457">    <span>if</span> (<span>LoggingOn</span>(LF_JIT, LL_INFO100000))</td>
      </tr>
      <tr>
        <td id="L8458" data-line-number="8458"></td>
        <td id="LC8458">    {</td>
      </tr>
      <tr>
        <td id="L8459" data-line-number="8459"></td>
        <td id="LC8459">        SString currentMethodName;</td>
      </tr>
      <tr>
        <td id="L8460" data-line-number="8460"></td>
        <td id="LC8460">        <span>TypeString::AppendMethodInternal</span>(currentMethodName, m_pMethodBeingCompiled,</td>
      </tr>
      <tr>
        <td id="L8461" data-line-number="8461"></td>
        <td id="LC8461">                                         TypeString::FormatBasic);</td>
      </tr>
      <tr>
        <td id="L8462" data-line-number="8462"></td>
        <td id="LC8462">
</td>
      </tr>
      <tr>
        <td id="L8463" data-line-number="8463"></td>
        <td id="LC8463">        SString calleeMethodName;</td>
      </tr>
      <tr>
        <td id="L8464" data-line-number="8464"></td>
        <td id="LC8464">        <span>if</span> (<span>GetMethod</span>(calleeHnd))</td>
      </tr>
      <tr>
        <td id="L8465" data-line-number="8465"></td>
        <td id="LC8465">        {</td>
      </tr>
      <tr>
        <td id="L8466" data-line-number="8466"></td>
        <td id="LC8466">            <span>TypeString::AppendMethodInternal</span>(calleeMethodName, <span>GetMethod</span>(calleeHnd),</td>
      </tr>
      <tr>
        <td id="L8467" data-line-number="8467"></td>
        <td id="LC8467">                                             TypeString::FormatBasic);</td>
      </tr>
      <tr>
        <td id="L8468" data-line-number="8468"></td>
        <td id="LC8468">        }</td>
      </tr>
      <tr>
        <td id="L8469" data-line-number="8469"></td>
        <td id="LC8469">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8470" data-line-number="8470"></td>
        <td id="LC8470">        {</td>
      </tr>
      <tr>
        <td id="L8471" data-line-number="8471"></td>
        <td id="LC8471">            calleeMethodName.<span>AppendASCII</span>( <span><span>"</span>&lt;null&gt;<span>"</span></span> );</td>
      </tr>
      <tr>
        <td id="L8472" data-line-number="8472"></td>
        <td id="LC8472">        }</td>
      </tr>
      <tr>
        <td id="L8473" data-line-number="8473"></td>
        <td id="LC8473">
</td>
      </tr>
      <tr>
        <td id="L8474" data-line-number="8474"></td>
        <td id="LC8474">        SString callerMethodName;</td>
      </tr>
      <tr>
        <td id="L8475" data-line-number="8475"></td>
        <td id="LC8475">        <span>if</span> (<span>GetMethod</span>(callerHnd))</td>
      </tr>
      <tr>
        <td id="L8476" data-line-number="8476"></td>
        <td id="LC8476">        {</td>
      </tr>
      <tr>
        <td id="L8477" data-line-number="8477"></td>
        <td id="LC8477">            <span>TypeString::AppendMethodInternal</span>(callerMethodName, <span>GetMethod</span>(callerHnd),</td>
      </tr>
      <tr>
        <td id="L8478" data-line-number="8478"></td>
        <td id="LC8478">                                             TypeString::FormatBasic);</td>
      </tr>
      <tr>
        <td id="L8479" data-line-number="8479"></td>
        <td id="LC8479">        }</td>
      </tr>
      <tr>
        <td id="L8480" data-line-number="8480"></td>
        <td id="LC8480">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8481" data-line-number="8481"></td>
        <td id="LC8481">        {</td>
      </tr>
      <tr>
        <td id="L8482" data-line-number="8482"></td>
        <td id="LC8482">            callerMethodName.<span>AppendASCII</span>( <span><span>"</span>&lt;null&gt;<span>"</span></span> );</td>
      </tr>
      <tr>
        <td id="L8483" data-line-number="8483"></td>
        <td id="LC8483">        }</td>
      </tr>
      <tr>
        <td id="L8484" data-line-number="8484"></td>
        <td id="LC8484">        <span>if</span> (tailCallResult == TAILCALL_FAIL)</td>
      </tr>
      <tr>
        <td id="L8485" data-line-number="8485"></td>
        <td id="LC8485">        {</td>
      </tr>
      <tr>
        <td id="L8486" data-line-number="8486"></td>
        <td id="LC8486">            <span>LOG</span>((LF_JIT, LL_INFO100000,</td>
      </tr>
      <tr>
        <td id="L8487" data-line-number="8487"></td>
        <td id="LC8487">                 <span><span>"</span>While compiling '%S', %Splicit tail call from '%S' to '%S' failed because: '%s'.<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L8488" data-line-number="8488"></td>
        <td id="LC8488">                 currentMethodName.<span>GetUnicode</span>(), <span>fIsTailPrefix</span> ? <span>W</span>(<span><span>"</span>ex<span>"</span></span>) : <span>W</span>(<span><span>"</span>im<span>"</span></span>),</td>
      </tr>
      <tr>
        <td id="L8489" data-line-number="8489"></td>
        <td id="LC8489">                 callerMethodName.<span>GetUnicode</span>(), calleeMethodName.<span>GetUnicode</span>(), reason));</td>
      </tr>
      <tr>
        <td id="L8490" data-line-number="8490"></td>
        <td id="LC8490">        }</td>
      </tr>
      <tr>
        <td id="L8491" data-line-number="8491"></td>
        <td id="LC8491">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8492" data-line-number="8492"></td>
        <td id="LC8492">        {</td>
      </tr>
      <tr>
        <td id="L8493" data-line-number="8493"></td>
        <td id="LC8493">            <span>static</span> <span>const</span> <span>char</span> * <span>const</span> tailCallType[] = {</td>
      </tr>
      <tr>
        <td id="L8494" data-line-number="8494"></td>
        <td id="LC8494">                <span><span>"</span>optimized tail call<span>"</span></span>, <span><span>"</span>recursive loop<span>"</span></span>, <span><span>"</span>helper assisted tailcall<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L8495" data-line-number="8495"></td>
        <td id="LC8495">            };</td>
      </tr>
      <tr>
        <td id="L8496" data-line-number="8496"></td>
        <td id="LC8496">            <span>_ASSERTE</span>(tailCallResult &gt;= <span>0</span> &amp;&amp; (<span>size_t</span>)tailCallResult &lt; <span>_countof</span>(tailCallType));</td>
      </tr>
      <tr>
        <td id="L8497" data-line-number="8497"></td>
        <td id="LC8497">            <span>LOG</span>((LF_JIT, LL_INFO100000,</td>
      </tr>
      <tr>
        <td id="L8498" data-line-number="8498"></td>
        <td id="LC8498">                 <span><span>"</span>While compiling '%S', %Splicit tail call from '%S' to '%S' generated as a %s.<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L8499" data-line-number="8499"></td>
        <td id="LC8499">                 currentMethodName.<span>GetUnicode</span>(), <span>fIsTailPrefix</span> ? <span>W</span>(<span><span>"</span>ex<span>"</span></span>) : <span>W</span>(<span><span>"</span>im<span>"</span></span>),</td>
      </tr>
      <tr>
        <td id="L8500" data-line-number="8500"></td>
        <td id="LC8500">                 callerMethodName.<span>GetUnicode</span>(), calleeMethodName.<span>GetUnicode</span>(), tailCallType[tailCallResult]));</td>
      </tr>
      <tr>
        <td id="L8501" data-line-number="8501"></td>
        <td id="LC8501">
</td>
      </tr>
      <tr>
        <td id="L8502" data-line-number="8502"></td>
        <td id="LC8502">        }</td>
      </tr>
      <tr>
        <td id="L8503" data-line-number="8503"></td>
        <td id="LC8503">    }</td>
      </tr>
      <tr>
        <td id="L8504" data-line-number="8504"></td>
        <td id="LC8504">#<span>endif</span> <span><span>//</span>_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L8505" data-line-number="8505"></td>
        <td id="LC8505">
</td>
      </tr>
      <tr>
        <td id="L8506" data-line-number="8506"></td>
        <td id="LC8506">    <span><span>//</span> I'm gonna duplicate this code because the format is slightly different.  And LoggingOn is debug only.</span></td>
      </tr>
      <tr>
        <td id="L8507" data-line-number="8507"></td>
        <td id="LC8507">    <span>if</span> (<span>ETW_TRACING_CATEGORY_ENABLED</span>(MICROSOFT_WINDOWS_DOTNETRUNTIME_PROVIDER_DOTNET_Context,</td>
      </tr>
      <tr>
        <td id="L8508" data-line-number="8508"></td>
        <td id="LC8508">                                     TRACE_LEVEL_VERBOSE,</td>
      </tr>
      <tr>
        <td id="L8509" data-line-number="8509"></td>
        <td id="LC8509">                                     CLR_JITTRACING_KEYWORD))</td>
      </tr>
      <tr>
        <td id="L8510" data-line-number="8510"></td>
        <td id="LC8510">    {</td>
      </tr>
      <tr>
        <td id="L8511" data-line-number="8511"></td>
        <td id="LC8511">        SString methodBeingCompiledNames[<span>3</span>];</td>
      </tr>
      <tr>
        <td id="L8512" data-line-number="8512"></td>
        <td id="LC8512">        SString callerNames[<span>3</span>];</td>
      </tr>
      <tr>
        <td id="L8513" data-line-number="8513"></td>
        <td id="LC8513">        SString calleeNames[<span>3</span>];</td>
      </tr>
      <tr>
        <td id="L8514" data-line-number="8514"></td>
        <td id="LC8514">        MethodDesc * methodBeingCompiled = m_pMethodBeingCompiled;</td>
      </tr>
      <tr>
        <td id="L8515" data-line-number="8515"></td>
        <td id="LC8515">#<span>define</span> <span>GMI</span>(<span>pMD, strArray</span>) \</td>
      </tr>
      <tr>
        <td id="L8516" data-line-number="8516"></td>
        <td id="LC8516">        <span>do</span> { \</td>
      </tr>
      <tr>
        <td id="L8517" data-line-number="8517"></td>
        <td id="LC8517">            <span>if</span> (pMD) { \</td>
      </tr>
      <tr>
        <td id="L8518" data-line-number="8518"></td>
        <td id="LC8518">                (pMD)-&gt;<span>GetMethodInfo</span>((strArray)[<span>0</span>], (strArray)[<span>1</span>], (strArray)[<span>2</span>]); \</td>
      </tr>
      <tr>
        <td id="L8519" data-line-number="8519"></td>
        <td id="LC8519">            } <span>else</span> {  \</td>
      </tr>
      <tr>
        <td id="L8520" data-line-number="8520"></td>
        <td id="LC8520">                (strArray)[<span>0</span>].<span>Set</span>(<span>W</span>(<span><span>"</span>&lt;null&gt;<span>"</span></span>)); \</td>
      </tr>
      <tr>
        <td id="L8521" data-line-number="8521"></td>
        <td id="LC8521">                (strArray)[<span>1</span>].<span>Set</span>(<span>W</span>(<span><span>"</span>&lt;null&gt;<span>"</span></span>)); \</td>
      </tr>
      <tr>
        <td id="L8522" data-line-number="8522"></td>
        <td id="LC8522">                (strArray)[<span>2</span>].<span>Set</span>(<span>W</span>(<span><span>"</span>&lt;null&gt;<span>"</span></span>)); \</td>
      </tr>
      <tr>
        <td id="L8523" data-line-number="8523"></td>
        <td id="LC8523">            } } <span>while</span> (<span>0</span>)</td>
      </tr>
      <tr>
        <td id="L8524" data-line-number="8524"></td>
        <td id="LC8524">
</td>
      </tr>
      <tr>
        <td id="L8525" data-line-number="8525"></td>
        <td id="LC8525">        <span>GMI</span>(methodBeingCompiled, methodBeingCompiledNames);</td>
      </tr>
      <tr>
        <td id="L8526" data-line-number="8526"></td>
        <td id="LC8526">        <span>GMI</span>(<span>GetMethod</span>(callerHnd), callerNames);</td>
      </tr>
      <tr>
        <td id="L8527" data-line-number="8527"></td>
        <td id="LC8527">        <span>GMI</span>(<span>GetMethod</span>(calleeHnd), calleeNames);</td>
      </tr>
      <tr>
        <td id="L8528" data-line-number="8528"></td>
        <td id="LC8528">#<span>undef</span> GMI</td>
      </tr>
      <tr>
        <td id="L8529" data-line-number="8529"></td>
        <td id="LC8529">        <span>if</span> (tailCallResult == TAILCALL_FAIL)</td>
      </tr>
      <tr>
        <td id="L8530" data-line-number="8530"></td>
        <td id="LC8530">        {</td>
      </tr>
      <tr>
        <td id="L8531" data-line-number="8531"></td>
        <td id="LC8531">            <span>const</span> <span>char</span> * str = (reason ? reason : <span><span>"</span><span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L8532" data-line-number="8532"></td>
        <td id="LC8532">            SString strReason;</td>
      </tr>
      <tr>
        <td id="L8533" data-line-number="8533"></td>
        <td id="LC8533">            strReason.<span>SetANSI</span>(str);</td>
      </tr>
      <tr>
        <td id="L8534" data-line-number="8534"></td>
        <td id="LC8534">
</td>
      </tr>
      <tr>
        <td id="L8535" data-line-number="8535"></td>
        <td id="LC8535">            <span>FireEtwMethodJitTailCallFailed</span>(methodBeingCompiledNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8536" data-line-number="8536"></td>
        <td id="LC8536">                                           methodBeingCompiledNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8537" data-line-number="8537"></td>
        <td id="LC8537">                                           methodBeingCompiledNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8538" data-line-number="8538"></td>
        <td id="LC8538">                                           callerNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8539" data-line-number="8539"></td>
        <td id="LC8539">                                           callerNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8540" data-line-number="8540"></td>
        <td id="LC8540">                                           callerNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8541" data-line-number="8541"></td>
        <td id="LC8541">                                           calleeNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8542" data-line-number="8542"></td>
        <td id="LC8542">                                           calleeNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8543" data-line-number="8543"></td>
        <td id="LC8543">                                           calleeNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8544" data-line-number="8544"></td>
        <td id="LC8544">                                           <span>fIsTailPrefix</span>,</td>
      </tr>
      <tr>
        <td id="L8545" data-line-number="8545"></td>
        <td id="LC8545">                                           strReason.<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8546" data-line-number="8546"></td>
        <td id="LC8546">                                           <span>GetClrInstanceId</span>());</td>
      </tr>
      <tr>
        <td id="L8547" data-line-number="8547"></td>
        <td id="LC8547">        }</td>
      </tr>
      <tr>
        <td id="L8548" data-line-number="8548"></td>
        <td id="LC8548">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L8549" data-line-number="8549"></td>
        <td id="LC8549">        {</td>
      </tr>
      <tr>
        <td id="L8550" data-line-number="8550"></td>
        <td id="LC8550">            <span>FireEtwMethodJitTailCallSucceeded</span>(methodBeingCompiledNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8551" data-line-number="8551"></td>
        <td id="LC8551">                                              methodBeingCompiledNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8552" data-line-number="8552"></td>
        <td id="LC8552">                                              methodBeingCompiledNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8553" data-line-number="8553"></td>
        <td id="LC8553">                                              callerNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8554" data-line-number="8554"></td>
        <td id="LC8554">                                              callerNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8555" data-line-number="8555"></td>
        <td id="LC8555">                                              callerNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8556" data-line-number="8556"></td>
        <td id="LC8556">                                              calleeNames[<span>0</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8557" data-line-number="8557"></td>
        <td id="LC8557">                                              calleeNames[<span>1</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8558" data-line-number="8558"></td>
        <td id="LC8558">                                              calleeNames[<span>2</span>].<span>GetUnicode</span>(),</td>
      </tr>
      <tr>
        <td id="L8559" data-line-number="8559"></td>
        <td id="LC8559">                                              <span>fIsTailPrefix</span>,</td>
      </tr>
      <tr>
        <td id="L8560" data-line-number="8560"></td>
        <td id="LC8560">                                              tailCallResult,</td>
      </tr>
      <tr>
        <td id="L8561" data-line-number="8561"></td>
        <td id="LC8561">                                              <span>GetClrInstanceId</span>());</td>
      </tr>
      <tr>
        <td id="L8562" data-line-number="8562"></td>
        <td id="LC8562">        }</td>
      </tr>
      <tr>
        <td id="L8563" data-line-number="8563"></td>
        <td id="LC8563">
</td>
      </tr>
      <tr>
        <td id="L8564" data-line-number="8564"></td>
        <td id="LC8564">    }</td>
      </tr>
      <tr>
        <td id="L8565" data-line-number="8565"></td>
        <td id="LC8565">
</td>
      </tr>
      <tr>
        <td id="L8566" data-line-number="8566"></td>
        <td id="LC8566">
</td>
      </tr>
      <tr>
        <td id="L8567" data-line-number="8567"></td>
        <td id="LC8567">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8568" data-line-number="8568"></td>
        <td id="LC8568">}</td>
      </tr>
      <tr>
        <td id="L8569" data-line-number="8569"></td>
        <td id="LC8569">
</td>
      </tr>
      <tr>
        <td id="L8570" data-line-number="8570"></td>
        <td id="LC8570"><span>void</span> <span>CEEInfo::getEHinfoHelper</span>(</td>
      </tr>
      <tr>
        <td id="L8571" data-line-number="8571"></td>
        <td id="LC8571">    CORINFO_METHOD_HANDLE   ftnHnd,</td>
      </tr>
      <tr>
        <td id="L8572" data-line-number="8572"></td>
        <td id="LC8572">    <span>unsigned</span>                EHnumber,</td>
      </tr>
      <tr>
        <td id="L8573" data-line-number="8573"></td>
        <td id="LC8573">    CORINFO_EH_CLAUSE*      clause,</td>
      </tr>
      <tr>
        <td id="L8574" data-line-number="8574"></td>
        <td id="LC8574">    COR_ILMETHOD_DECODER*   pILHeader)</td>
      </tr>
      <tr>
        <td id="L8575" data-line-number="8575"></td>
        <td id="LC8575">{</td>
      </tr>
      <tr>
        <td id="L8576" data-line-number="8576"></td>
        <td id="LC8576">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L8577" data-line-number="8577"></td>
        <td id="LC8577">
</td>
      </tr>
      <tr>
        <td id="L8578" data-line-number="8578"></td>
        <td id="LC8578">    <span>_ASSERTE</span>(<span>CheckPointer</span>(pILHeader-&gt;<span>EH</span>));</td>
      </tr>
      <tr>
        <td id="L8579" data-line-number="8579"></td>
        <td id="LC8579">    <span>_ASSERTE</span>(EHnumber &lt; pILHeader-&gt;<span>EH</span>-&gt;<span>EHCount</span>());</td>
      </tr>
      <tr>
        <td id="L8580" data-line-number="8580"></td>
        <td id="LC8580">
</td>
      </tr>
      <tr>
        <td id="L8581" data-line-number="8581"></td>
        <td id="LC8581">    COR_ILMETHOD_SECT_EH_CLAUSE_FAT ehClause;</td>
      </tr>
      <tr>
        <td id="L8582" data-line-number="8582"></td>
        <td id="LC8582">    <span>const</span> COR_ILMETHOD_SECT_EH_CLAUSE_FAT* ehInfo;</td>
      </tr>
      <tr>
        <td id="L8583" data-line-number="8583"></td>
        <td id="LC8583">    ehInfo = (COR_ILMETHOD_SECT_EH_CLAUSE_FAT*)pILHeader-&gt;<span>EH</span>-&gt;<span>EHClause</span>(EHnumber, &amp;ehClause);</td>
      </tr>
      <tr>
        <td id="L8584" data-line-number="8584"></td>
        <td id="LC8584">
</td>
      </tr>
      <tr>
        <td id="L8585" data-line-number="8585"></td>
        <td id="LC8585">    clause-&gt;<span>Flags</span> = (CORINFO_EH_CLAUSE_FLAGS)ehInfo-&gt;<span>GetFlags</span>();</td>
      </tr>
      <tr>
        <td id="L8586" data-line-number="8586"></td>
        <td id="LC8586">    clause-&gt;<span>TryOffset</span> = ehInfo-&gt;<span>GetTryOffset</span>();</td>
      </tr>
      <tr>
        <td id="L8587" data-line-number="8587"></td>
        <td id="LC8587">    clause-&gt;<span>TryLength</span> = ehInfo-&gt;<span>GetTryLength</span>();</td>
      </tr>
      <tr>
        <td id="L8588" data-line-number="8588"></td>
        <td id="LC8588">    clause-&gt;<span>HandlerOffset</span> = ehInfo-&gt;<span>GetHandlerOffset</span>();</td>
      </tr>
      <tr>
        <td id="L8589" data-line-number="8589"></td>
        <td id="LC8589">    clause-&gt;<span>HandlerLength</span> = ehInfo-&gt;<span>GetHandlerLength</span>();</td>
      </tr>
      <tr>
        <td id="L8590" data-line-number="8590"></td>
        <td id="LC8590">    <span>if</span> ((clause-&gt;<span>Flags</span> &amp; CORINFO_EH_CLAUSE_FILTER) == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L8591" data-line-number="8591"></td>
        <td id="LC8591">        clause-&gt;<span>ClassToken</span> = ehInfo-&gt;<span>GetClassToken</span>();</td>
      </tr>
      <tr>
        <td id="L8592" data-line-number="8592"></td>
        <td id="LC8592">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L8593" data-line-number="8593"></td>
        <td id="LC8593">        clause-&gt;<span>FilterOffset</span> = ehInfo-&gt;<span>GetFilterOffset</span>();</td>
      </tr>
      <tr>
        <td id="L8594" data-line-number="8594"></td>
        <td id="LC8594">}</td>
      </tr>
      <tr>
        <td id="L8595" data-line-number="8595"></td>
        <td id="LC8595">
</td>
      </tr>
      <tr>
        <td id="L8596" data-line-number="8596"></td>
        <td id="LC8596"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8597" data-line-number="8597"></td>
        <td id="LC8597"><span><span>//</span> get individual exception handler</span></td>
      </tr>
      <tr>
        <td id="L8598" data-line-number="8598"></td>
        <td id="LC8598"><span>void</span> <span>CEEInfo::getEHinfo</span>(</td>
      </tr>
      <tr>
        <td id="L8599" data-line-number="8599"></td>
        <td id="LC8599">            CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L8600" data-line-number="8600"></td>
        <td id="LC8600">            <span>unsigned</span>      EHnumber,</td>
      </tr>
      <tr>
        <td id="L8601" data-line-number="8601"></td>
        <td id="LC8601">            CORINFO_EH_CLAUSE* clause)</td>
      </tr>
      <tr>
        <td id="L8602" data-line-number="8602"></td>
        <td id="LC8602">{</td>
      </tr>
      <tr>
        <td id="L8603" data-line-number="8603"></td>
        <td id="LC8603">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8604" data-line-number="8604"></td>
        <td id="LC8604">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8605" data-line-number="8605"></td>
        <td id="LC8605">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8606" data-line-number="8606"></td>
        <td id="LC8606">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8607" data-line-number="8607"></td>
        <td id="LC8607">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8608" data-line-number="8608"></td>
        <td id="LC8608">
</td>
      </tr>
      <tr>
        <td id="L8609" data-line-number="8609"></td>
        <td id="LC8609">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8610" data-line-number="8610"></td>
        <td id="LC8610">
</td>
      </tr>
      <tr>
        <td id="L8611" data-line-number="8611"></td>
        <td id="LC8611">    MethodDesc * ftn          = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L8612" data-line-number="8612"></td>
        <td id="LC8612">
</td>
      </tr>
      <tr>
        <td id="L8613" data-line-number="8613"></td>
        <td id="LC8613">    <span>if</span> (<span>IsDynamicMethodHandle</span>(ftnHnd))</td>
      </tr>
      <tr>
        <td id="L8614" data-line-number="8614"></td>
        <td id="LC8614">    {</td>
      </tr>
      <tr>
        <td id="L8615" data-line-number="8615"></td>
        <td id="LC8615">        <span>GetMethod</span>(ftnHnd)-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>()-&gt;<span>GetEHInfo</span>(EHnumber, clause);</td>
      </tr>
      <tr>
        <td id="L8616" data-line-number="8616"></td>
        <td id="LC8616">    }</td>
      </tr>
      <tr>
        <td id="L8617" data-line-number="8617"></td>
        <td id="LC8617">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L8618" data-line-number="8618"></td>
        <td id="LC8618">    {</td>
      </tr>
      <tr>
        <td id="L8619" data-line-number="8619"></td>
        <td id="LC8619">        COR_ILMETHOD_DECODER <span>header</span>(ftn-&gt;<span>GetILHeader</span>(<span>TRUE</span>), ftn-&gt;<span>GetMDImport</span>(), <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L8620" data-line-number="8620"></td>
        <td id="LC8620">        <span>getEHinfoHelper</span>(ftnHnd, EHnumber, clause, &amp;header);</td>
      </tr>
      <tr>
        <td id="L8621" data-line-number="8621"></td>
        <td id="LC8621">    }</td>
      </tr>
      <tr>
        <td id="L8622" data-line-number="8622"></td>
        <td id="LC8622">
</td>
      </tr>
      <tr>
        <td id="L8623" data-line-number="8623"></td>
        <td id="LC8623">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8624" data-line-number="8624"></td>
        <td id="LC8624">}</td>
      </tr>
      <tr>
        <td id="L8625" data-line-number="8625"></td>
        <td id="LC8625">
</td>
      </tr>
      <tr>
        <td id="L8626" data-line-number="8626"></td>
        <td id="LC8626"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L8627" data-line-number="8627"></td>
        <td id="LC8627"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8628" data-line-number="8628"></td>
        <td id="LC8628"><span>void</span></td>
      </tr>
      <tr>
        <td id="L8629" data-line-number="8629"></td>
        <td id="LC8629"><span>CEEInfo::getMethodSig</span>(</td>
      </tr>
      <tr>
        <td id="L8630" data-line-number="8630"></td>
        <td id="LC8630">    CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L8631" data-line-number="8631"></td>
        <td id="LC8631">    CORINFO_SIG_INFO *    sigRet,</td>
      </tr>
      <tr>
        <td id="L8632" data-line-number="8632"></td>
        <td id="LC8632">    CORINFO_CLASS_HANDLE  owner)</td>
      </tr>
      <tr>
        <td id="L8633" data-line-number="8633"></td>
        <td id="LC8633">{</td>
      </tr>
      <tr>
        <td id="L8634" data-line-number="8634"></td>
        <td id="LC8634">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8635" data-line-number="8635"></td>
        <td id="LC8635">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8636" data-line-number="8636"></td>
        <td id="LC8636">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8637" data-line-number="8637"></td>
        <td id="LC8637">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8638" data-line-number="8638"></td>
        <td id="LC8638">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8639" data-line-number="8639"></td>
        <td id="LC8639">
</td>
      </tr>
      <tr>
        <td id="L8640" data-line-number="8640"></td>
        <td id="LC8640">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8641" data-line-number="8641"></td>
        <td id="LC8641">
</td>
      </tr>
      <tr>
        <td id="L8642" data-line-number="8642"></td>
        <td id="LC8642">    <span>getMethodSigInternal</span>(ftnHnd, sigRet, owner);</td>
      </tr>
      <tr>
        <td id="L8643" data-line-number="8643"></td>
        <td id="LC8643">
</td>
      </tr>
      <tr>
        <td id="L8644" data-line-number="8644"></td>
        <td id="LC8644">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8645" data-line-number="8645"></td>
        <td id="LC8645">}</td>
      </tr>
      <tr>
        <td id="L8646" data-line-number="8646"></td>
        <td id="LC8646">
</td>
      </tr>
      <tr>
        <td id="L8647" data-line-number="8647"></td>
        <td id="LC8647"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L8648" data-line-number="8648"></td>
        <td id="LC8648"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8649" data-line-number="8649"></td>
        <td id="LC8649"><span>void</span></td>
      </tr>
      <tr>
        <td id="L8650" data-line-number="8650"></td>
        <td id="LC8650"><span>CEEInfo::getMethodSigInternal</span>(</td>
      </tr>
      <tr>
        <td id="L8651" data-line-number="8651"></td>
        <td id="LC8651">    CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L8652" data-line-number="8652"></td>
        <td id="LC8652">    CORINFO_SIG_INFO *    sigRet,</td>
      </tr>
      <tr>
        <td id="L8653" data-line-number="8653"></td>
        <td id="LC8653">    CORINFO_CLASS_HANDLE  owner,</td>
      </tr>
      <tr>
        <td id="L8654" data-line-number="8654"></td>
        <td id="LC8654">    SignatureKind signatureKind)</td>
      </tr>
      <tr>
        <td id="L8655" data-line-number="8655"></td>
        <td id="LC8655">{</td>
      </tr>
      <tr>
        <td id="L8656" data-line-number="8656"></td>
        <td id="LC8656">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L8657" data-line-number="8657"></td>
        <td id="LC8657">
</td>
      </tr>
      <tr>
        <td id="L8658" data-line-number="8658"></td>
        <td id="LC8658">    MethodDesc * ftn = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L8659" data-line-number="8659"></td>
        <td id="LC8659">
</td>
      </tr>
      <tr>
        <td id="L8660" data-line-number="8660"></td>
        <td id="LC8660">    PCCOR_SIGNATURE pSig = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L8661" data-line-number="8661"></td>
        <td id="LC8661">    DWORD           cbSig = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L8662" data-line-number="8662"></td>
        <td id="LC8662">    ftn-&gt;<span>GetSig</span>(&amp;pSig, &amp;cbSig);</td>
      </tr>
      <tr>
        <td id="L8663" data-line-number="8663"></td>
        <td id="LC8663">
</td>
      </tr>
      <tr>
        <td id="L8664" data-line-number="8664"></td>
        <td id="LC8664">    <span><span>//</span> Type parameters in the signature are instantiated</span></td>
      </tr>
      <tr>
        <td id="L8665" data-line-number="8665"></td>
        <td id="LC8665">    <span><span>//</span> according to the class/method/array instantiation of ftnHnd and owner</span></td>
      </tr>
      <tr>
        <td id="L8666" data-line-number="8666"></td>
        <td id="LC8666">    <span>CEEInfo::ConvToJitSig</span>(</td>
      </tr>
      <tr>
        <td id="L8667" data-line-number="8667"></td>
        <td id="LC8667">        pSig,</td>
      </tr>
      <tr>
        <td id="L8668" data-line-number="8668"></td>
        <td id="LC8668">        cbSig,</td>
      </tr>
      <tr>
        <td id="L8669" data-line-number="8669"></td>
        <td id="LC8669">        <span>GetScopeHandle</span>(ftn),</td>
      </tr>
      <tr>
        <td id="L8670" data-line-number="8670"></td>
        <td id="LC8670">        mdTokenNil,</td>
      </tr>
      <tr>
        <td id="L8671" data-line-number="8671"></td>
        <td id="LC8671">        sigRet,</td>
      </tr>
      <tr>
        <td id="L8672" data-line-number="8672"></td>
        <td id="LC8672">        ftn,</td>
      </tr>
      <tr>
        <td id="L8673" data-line-number="8673"></td>
        <td id="LC8673">        <span>false</span>,</td>
      </tr>
      <tr>
        <td id="L8674" data-line-number="8674"></td>
        <td id="LC8674">        (TypeHandle)owner);</td>
      </tr>
      <tr>
        <td id="L8675" data-line-number="8675"></td>
        <td id="LC8675">
</td>
      </tr>
      <tr>
        <td id="L8676" data-line-number="8676"></td>
        <td id="LC8676">    <span><span>//</span>@GENERICS:</span></td>
      </tr>
      <tr>
        <td id="L8677" data-line-number="8677"></td>
        <td id="LC8677">    <span><span>//</span> Shared generic methods and shared methods on generic structs take an extra argument representing their instantiation</span></td>
      </tr>
      <tr>
        <td id="L8678" data-line-number="8678"></td>
        <td id="LC8678">    <span>if</span> (ftn-&gt;<span>RequiresInstArg</span>())</td>
      </tr>
      <tr>
        <td id="L8679" data-line-number="8679"></td>
        <td id="LC8679">    {</td>
      </tr>
      <tr>
        <td id="L8680" data-line-number="8680"></td>
        <td id="LC8680">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8681" data-line-number="8681"></td>
        <td id="LC8681">        <span><span>//</span> If we are making a virtual call to an instance method on an interface, we need to lie to the JIT.</span></td>
      </tr>
      <tr>
        <td id="L8682" data-line-number="8682"></td>
        <td id="LC8682">        <span><span>//</span> The reason being that we already made sure target is always directly callable (through instantiation stubs),</span></td>
      </tr>
      <tr>
        <td id="L8683" data-line-number="8683"></td>
        <td id="LC8683">        <span><span>//</span> JIT should not generate shared generics aware call code and insert the secret argument again at the callsite.</span></td>
      </tr>
      <tr>
        <td id="L8684" data-line-number="8684"></td>
        <td id="LC8684">        <span><span>//</span> Otherwise we would end up with two secret generic dictionary arguments (since the stub also provides one).</span></td>
      </tr>
      <tr>
        <td id="L8685" data-line-number="8685"></td>
        <td id="LC8685">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8686" data-line-number="8686"></td>
        <td id="LC8686">        BOOL isCallSiteThatGoesThroughInstantiatingStub =</td>
      </tr>
      <tr>
        <td id="L8687" data-line-number="8687"></td>
        <td id="LC8687">            signatureKind == SK_VIRTUAL_CALLSITE &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L8688" data-line-number="8688"></td>
        <td id="LC8688">            !ftn-&gt;<span>IsStatic</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L8689" data-line-number="8689"></td>
        <td id="LC8689">            ftn-&gt;<span>GetMethodTable</span>()-&gt;<span>IsInterface</span>();</td>
      </tr>
      <tr>
        <td id="L8690" data-line-number="8690"></td>
        <td id="LC8690">        <span>if</span> (!isCallSiteThatGoesThroughInstantiatingStub)</td>
      </tr>
      <tr>
        <td id="L8691" data-line-number="8691"></td>
        <td id="LC8691">            sigRet-&gt;<span>callConv</span> = (CorInfoCallConv) (sigRet-&gt;<span>callConv</span> | CORINFO_CALLCONV_PARAMTYPE);</td>
      </tr>
      <tr>
        <td id="L8692" data-line-number="8692"></td>
        <td id="LC8692">    }</td>
      </tr>
      <tr>
        <td id="L8693" data-line-number="8693"></td>
        <td id="LC8693">
</td>
      </tr>
      <tr>
        <td id="L8694" data-line-number="8694"></td>
        <td id="LC8694">    <span><span>//</span> We want the calling convention bit to be consistant with the method attribute bit</span></td>
      </tr>
      <tr>
        <td id="L8695" data-line-number="8695"></td>
        <td id="LC8695">    <span>_ASSERTE</span>( (<span>IsMdStatic</span>(ftn-&gt;<span>GetAttrs</span>()) == <span>0</span>) == ((sigRet-&gt;<span>callConv</span> &amp; CORINFO_CALLCONV_HASTHIS) != <span>0</span>) );</td>
      </tr>
      <tr>
        <td id="L8696" data-line-number="8696"></td>
        <td id="LC8696">}</td>
      </tr>
      <tr>
        <td id="L8697" data-line-number="8697"></td>
        <td id="LC8697">
</td>
      </tr>
      <tr>
        <td id="L8698" data-line-number="8698"></td>
        <td id="LC8698"><span><span>//</span>---------------------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L8699" data-line-number="8699"></td>
        <td id="LC8699"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8700" data-line-number="8700"></td>
        <td id="LC8700"><span><span>//</span>@GENERICSVER: for a method desc in a typical instantiation of a generic class,</span></td>
      </tr>
      <tr>
        <td id="L8701" data-line-number="8701"></td>
        <td id="LC8701"><span><span>//</span> this will return the typical instantiation of the generic class,</span></td>
      </tr>
      <tr>
        <td id="L8702" data-line-number="8702"></td>
        <td id="LC8702"><span><span>//</span> but only provided type variables are never shared.</span></td>
      </tr>
      <tr>
        <td id="L8703" data-line-number="8703"></td>
        <td id="LC8703"><span><span>//</span> The JIT verifier relies on this behaviour to extract the typical class from an instantiated method's typical method handle.</span></td>
      </tr>
      <tr>
        <td id="L8704" data-line-number="8704"></td>
        <td id="LC8704"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8705" data-line-number="8705"></td>
        <td id="LC8705">CORINFO_CLASS_HANDLE</td>
      </tr>
      <tr>
        <td id="L8706" data-line-number="8706"></td>
        <td id="LC8706"><span>CEEInfo::getMethodClass</span>(</td>
      </tr>
      <tr>
        <td id="L8707" data-line-number="8707"></td>
        <td id="LC8707">    CORINFO_METHOD_HANDLE methodHnd)</td>
      </tr>
      <tr>
        <td id="L8708" data-line-number="8708"></td>
        <td id="LC8708">{</td>
      </tr>
      <tr>
        <td id="L8709" data-line-number="8709"></td>
        <td id="LC8709">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8710" data-line-number="8710"></td>
        <td id="LC8710">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8711" data-line-number="8711"></td>
        <td id="LC8711">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8712" data-line-number="8712"></td>
        <td id="LC8712">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8713" data-line-number="8713"></td>
        <td id="LC8713">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8714" data-line-number="8714"></td>
        <td id="LC8714">
</td>
      </tr>
      <tr>
        <td id="L8715" data-line-number="8715"></td>
        <td id="LC8715">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L8716" data-line-number="8716"></td>
        <td id="LC8716">
</td>
      </tr>
      <tr>
        <td id="L8717" data-line-number="8717"></td>
        <td id="LC8717">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8718" data-line-number="8718"></td>
        <td id="LC8718">
</td>
      </tr>
      <tr>
        <td id="L8719" data-line-number="8719"></td>
        <td id="LC8719">    MethodDesc* method = <span>GetMethod</span>(methodHnd);</td>
      </tr>
      <tr>
        <td id="L8720" data-line-number="8720"></td>
        <td id="LC8720">
</td>
      </tr>
      <tr>
        <td id="L8721" data-line-number="8721"></td>
        <td id="LC8721">    <span>if</span> (method-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L8722" data-line-number="8722"></td>
        <td id="LC8722">    {</td>
      </tr>
      <tr>
        <td id="L8723" data-line-number="8723"></td>
        <td id="LC8723">        DynamicResolver::SecurityControlFlags securityControlFlags = DynamicResolver::Default;</td>
      </tr>
      <tr>
        <td id="L8724" data-line-number="8724"></td>
        <td id="LC8724">        TypeHandle typeOwner;</td>
      </tr>
      <tr>
        <td id="L8725" data-line-number="8725"></td>
        <td id="LC8725">
</td>
      </tr>
      <tr>
        <td id="L8726" data-line-number="8726"></td>
        <td id="LC8726">        DynamicResolver* pResolver = method-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>();</td>
      </tr>
      <tr>
        <td id="L8727" data-line-number="8727"></td>
        <td id="LC8727">        pResolver-&gt;<span>GetJitContext</span>(&amp;securityControlFlags, &amp;typeOwner);</td>
      </tr>
      <tr>
        <td id="L8728" data-line-number="8728"></td>
        <td id="LC8728">
</td>
      </tr>
      <tr>
        <td id="L8729" data-line-number="8729"></td>
        <td id="LC8729">        <span>if</span> (!typeOwner.<span>IsNull</span>() &amp;&amp; (method == pResolver-&gt;<span>GetDynamicMethod</span>()))</td>
      </tr>
      <tr>
        <td id="L8730" data-line-number="8730"></td>
        <td id="LC8730">        {</td>
      </tr>
      <tr>
        <td id="L8731" data-line-number="8731"></td>
        <td id="LC8731">            result = <span>CORINFO_CLASS_HANDLE</span>(typeOwner.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L8732" data-line-number="8732"></td>
        <td id="LC8732">        }</td>
      </tr>
      <tr>
        <td id="L8733" data-line-number="8733"></td>
        <td id="LC8733">    }</td>
      </tr>
      <tr>
        <td id="L8734" data-line-number="8734"></td>
        <td id="LC8734">
</td>
      </tr>
      <tr>
        <td id="L8735" data-line-number="8735"></td>
        <td id="LC8735">    <span>if</span> (result == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L8736" data-line-number="8736"></td>
        <td id="LC8736">    {</td>
      </tr>
      <tr>
        <td id="L8737" data-line-number="8737"></td>
        <td id="LC8737">        TypeHandle th = <span>TypeHandle</span>(method-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L8738" data-line-number="8738"></td>
        <td id="LC8738">
</td>
      </tr>
      <tr>
        <td id="L8739" data-line-number="8739"></td>
        <td id="LC8739">        result = <span>CORINFO_CLASS_HANDLE</span>(th.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L8740" data-line-number="8740"></td>
        <td id="LC8740">    }</td>
      </tr>
      <tr>
        <td id="L8741" data-line-number="8741"></td>
        <td id="LC8741">
</td>
      </tr>
      <tr>
        <td id="L8742" data-line-number="8742"></td>
        <td id="LC8742">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8743" data-line-number="8743"></td>
        <td id="LC8743">
</td>
      </tr>
      <tr>
        <td id="L8744" data-line-number="8744"></td>
        <td id="LC8744">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L8745" data-line-number="8745"></td>
        <td id="LC8745">}</td>
      </tr>
      <tr>
        <td id="L8746" data-line-number="8746"></td>
        <td id="LC8746">
</td>
      </tr>
      <tr>
        <td id="L8747" data-line-number="8747"></td>
        <td id="LC8747"><span><span>/*</span>*********************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8748" data-line-number="8748"></td>
        <td id="LC8748">CORINFO_MODULE_HANDLE <span>CEEInfo::getMethodModule</span> (CORINFO_METHOD_HANDLE methodHnd)</td>
      </tr>
      <tr>
        <td id="L8749" data-line-number="8749"></td>
        <td id="LC8749">{</td>
      </tr>
      <tr>
        <td id="L8750" data-line-number="8750"></td>
        <td id="LC8750">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8751" data-line-number="8751"></td>
        <td id="LC8751">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L8752" data-line-number="8752"></td>
        <td id="LC8752">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L8753" data-line-number="8753"></td>
        <td id="LC8753">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8754" data-line-number="8754"></td>
        <td id="LC8754">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8755" data-line-number="8755"></td>
        <td id="LC8755">
</td>
      </tr>
      <tr>
        <td id="L8756" data-line-number="8756"></td>
        <td id="LC8756">    CORINFO_MODULE_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L8757" data-line-number="8757"></td>
        <td id="LC8757">
</td>
      </tr>
      <tr>
        <td id="L8758" data-line-number="8758"></td>
        <td id="LC8758">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L8759" data-line-number="8759"></td>
        <td id="LC8759">
</td>
      </tr>
      <tr>
        <td id="L8760" data-line-number="8760"></td>
        <td id="LC8760">    MethodDesc* method = <span>GetMethod</span>(methodHnd);</td>
      </tr>
      <tr>
        <td id="L8761" data-line-number="8761"></td>
        <td id="LC8761">
</td>
      </tr>
      <tr>
        <td id="L8762" data-line-number="8762"></td>
        <td id="LC8762">    <span>if</span> (method-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L8763" data-line-number="8763"></td>
        <td id="LC8763">    {</td>
      </tr>
      <tr>
        <td id="L8764" data-line-number="8764"></td>
        <td id="LC8764">        <span><span>//</span> this should never be called, thus the assert, I don't know if the (non existent) caller</span></td>
      </tr>
      <tr>
        <td id="L8765" data-line-number="8765"></td>
        <td id="LC8765">        <span><span>//</span> expects the Module or the scope</span></td>
      </tr>
      <tr>
        <td id="L8766" data-line-number="8766"></td>
        <td id="LC8766">        <span>UNREACHABLE</span>();</td>
      </tr>
      <tr>
        <td id="L8767" data-line-number="8767"></td>
        <td id="LC8767">    }</td>
      </tr>
      <tr>
        <td id="L8768" data-line-number="8768"></td>
        <td id="LC8768">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L8769" data-line-number="8769"></td>
        <td id="LC8769">    {</td>
      </tr>
      <tr>
        <td id="L8770" data-line-number="8770"></td>
        <td id="LC8770">        result = (CORINFO_MODULE_HANDLE) method-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L8771" data-line-number="8771"></td>
        <td id="LC8771">    }</td>
      </tr>
      <tr>
        <td id="L8772" data-line-number="8772"></td>
        <td id="LC8772">
</td>
      </tr>
      <tr>
        <td id="L8773" data-line-number="8773"></td>
        <td id="LC8773">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L8774" data-line-number="8774"></td>
        <td id="LC8774">
</td>
      </tr>
      <tr>
        <td id="L8775" data-line-number="8775"></td>
        <td id="LC8775">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L8776" data-line-number="8776"></td>
        <td id="LC8776">}</td>
      </tr>
      <tr>
        <td id="L8777" data-line-number="8777"></td>
        <td id="LC8777">
</td>
      </tr>
      <tr>
        <td id="L8778" data-line-number="8778"></td>
        <td id="LC8778"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8779" data-line-number="8779"></td>
        <td id="LC8779">CorInfoIntrinsics <span>CEEInfo::getIntrinsicID</span>(CORINFO_METHOD_HANDLE methodHnd,</td>
      </tr>
      <tr>
        <td id="L8780" data-line-number="8780"></td>
        <td id="LC8780">                                          <span>bool</span> * pMustExpand)</td>
      </tr>
      <tr>
        <td id="L8781" data-line-number="8781"></td>
        <td id="LC8781">{</td>
      </tr>
      <tr>
        <td id="L8782" data-line-number="8782"></td>
        <td id="LC8782">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8783" data-line-number="8783"></td>
        <td id="LC8783">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8784" data-line-number="8784"></td>
        <td id="LC8784">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8785" data-line-number="8785"></td>
        <td id="LC8785">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8786" data-line-number="8786"></td>
        <td id="LC8786">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8787" data-line-number="8787"></td>
        <td id="LC8787">
</td>
      </tr>
      <tr>
        <td id="L8788" data-line-number="8788"></td>
        <td id="LC8788">    CorInfoIntrinsics result = CORINFO_INTRINSIC_Illegal;</td>
      </tr>
      <tr>
        <td id="L8789" data-line-number="8789"></td>
        <td id="LC8789">
</td>
      </tr>
      <tr>
        <td id="L8790" data-line-number="8790"></td>
        <td id="LC8790">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8791" data-line-number="8791"></td>
        <td id="LC8791">
</td>
      </tr>
      <tr>
        <td id="L8792" data-line-number="8792"></td>
        <td id="LC8792">    <span>if</span> (pMustExpand != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L8793" data-line-number="8793"></td>
        <td id="LC8793">    {</td>
      </tr>
      <tr>
        <td id="L8794" data-line-number="8794"></td>
        <td id="LC8794">        *pMustExpand = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L8795" data-line-number="8795"></td>
        <td id="LC8795">    }</td>
      </tr>
      <tr>
        <td id="L8796" data-line-number="8796"></td>
        <td id="LC8796">
</td>
      </tr>
      <tr>
        <td id="L8797" data-line-number="8797"></td>
        <td id="LC8797">    MethodDesc* method = <span>GetMethod</span>(methodHnd);</td>
      </tr>
      <tr>
        <td id="L8798" data-line-number="8798"></td>
        <td id="LC8798">
</td>
      </tr>
      <tr>
        <td id="L8799" data-line-number="8799"></td>
        <td id="LC8799">    <span>if</span> (method-&gt;<span>IsArray</span>())</td>
      </tr>
      <tr>
        <td id="L8800" data-line-number="8800"></td>
        <td id="LC8800">    {</td>
      </tr>
      <tr>
        <td id="L8801" data-line-number="8801"></td>
        <td id="LC8801">        ArrayMethodDesc * arrMethod = (ArrayMethodDesc *)method;</td>
      </tr>
      <tr>
        <td id="L8802" data-line-number="8802"></td>
        <td id="LC8802">        result = arrMethod-&gt;<span>GetIntrinsicID</span>();</td>
      </tr>
      <tr>
        <td id="L8803" data-line-number="8803"></td>
        <td id="LC8803">    }</td>
      </tr>
      <tr>
        <td id="L8804" data-line-number="8804"></td>
        <td id="LC8804">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L8805" data-line-number="8805"></td>
        <td id="LC8805">    <span>if</span> (method-&gt;<span>IsFCall</span>())</td>
      </tr>
      <tr>
        <td id="L8806" data-line-number="8806"></td>
        <td id="LC8806">    {</td>
      </tr>
      <tr>
        <td id="L8807" data-line-number="8807"></td>
        <td id="LC8807">        result = <span>ECall::GetIntrinsicID</span>(method);</td>
      </tr>
      <tr>
        <td id="L8808" data-line-number="8808"></td>
        <td id="LC8808">    }</td>
      </tr>
      <tr>
        <td id="L8809" data-line-number="8809"></td>
        <td id="LC8809">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L8810" data-line-number="8810"></td>
        <td id="LC8810">    {</td>
      </tr>
      <tr>
        <td id="L8811" data-line-number="8811"></td>
        <td id="LC8811">        MethodTable * pMT = method-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L8812" data-line-number="8812"></td>
        <td id="LC8812">        <span>if</span> (pMT-&gt;<span>GetModule</span>()-&gt;<span>IsSystem</span>() &amp;&amp; pMT-&gt;<span>IsByRefLike</span>())</td>
      </tr>
      <tr>
        <td id="L8813" data-line-number="8813"></td>
        <td id="LC8813">        {</td>
      </tr>
      <tr>
        <td id="L8814" data-line-number="8814"></td>
        <td id="LC8814">            <span>if</span> (pMT-&gt;<span>HasSameTypeDefAs</span>(g_pByReferenceClass))</td>
      </tr>
      <tr>
        <td id="L8815" data-line-number="8815"></td>
        <td id="LC8815">            {</td>
      </tr>
      <tr>
        <td id="L8816" data-line-number="8816"></td>
        <td id="LC8816">                <span><span>//</span> ByReference&lt;T&gt; has just two methods: constructor and Value property</span></td>
      </tr>
      <tr>
        <td id="L8817" data-line-number="8817"></td>
        <td id="LC8817">                <span>if</span> (method-&gt;<span>IsCtor</span>())</td>
      </tr>
      <tr>
        <td id="L8818" data-line-number="8818"></td>
        <td id="LC8818">                {</td>
      </tr>
      <tr>
        <td id="L8819" data-line-number="8819"></td>
        <td id="LC8819">                    result = CORINFO_INTRINSIC_ByReference_Ctor;</td>
      </tr>
      <tr>
        <td id="L8820" data-line-number="8820"></td>
        <td id="LC8820">                }</td>
      </tr>
      <tr>
        <td id="L8821" data-line-number="8821"></td>
        <td id="LC8821">                <span>else</span></td>
      </tr>
      <tr>
        <td id="L8822" data-line-number="8822"></td>
        <td id="LC8822">                {</td>
      </tr>
      <tr>
        <td id="L8823" data-line-number="8823"></td>
        <td id="LC8823">                    <span>_ASSERTE</span>(<span>strcmp</span>(method-&gt;<span>GetName</span>(), <span><span>"</span>get_Value<span>"</span></span>) == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L8824" data-line-number="8824"></td>
        <td id="LC8824">                    result = CORINFO_INTRINSIC_ByReference_Value;</td>
      </tr>
      <tr>
        <td id="L8825" data-line-number="8825"></td>
        <td id="LC8825">                }</td>
      </tr>
      <tr>
        <td id="L8826" data-line-number="8826"></td>
        <td id="LC8826">                <span>if</span> (pMustExpand != <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L8827" data-line-number="8827"></td>
        <td id="LC8827">                {</td>
      </tr>
      <tr>
        <td id="L8828" data-line-number="8828"></td>
        <td id="LC8828">                    *pMustExpand = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L8829" data-line-number="8829"></td>
        <td id="LC8829">                }</td>
      </tr>
      <tr>
        <td id="L8830" data-line-number="8830"></td>
        <td id="LC8830">            }</td>
      </tr>
      <tr>
        <td id="L8831" data-line-number="8831"></td>
        <td id="LC8831">            <span>else</span> <span>if</span> (pMT-&gt;<span>HasSameTypeDefAs</span>(<span>MscorlibBinder::GetClass</span>(CLASS__SPAN)))</td>
      </tr>
      <tr>
        <td id="L8832" data-line-number="8832"></td>
        <td id="LC8832">            {</td>
      </tr>
      <tr>
        <td id="L8833" data-line-number="8833"></td>
        <td id="LC8833">                <span>if</span> (method-&gt;<span>HasSameMethodDefAs</span>(<span>MscorlibBinder::GetMethod</span>(METHOD__SPAN__GET_ITEM)))</td>
      </tr>
      <tr>
        <td id="L8834" data-line-number="8834"></td>
        <td id="LC8834">                {</td>
      </tr>
      <tr>
        <td id="L8835" data-line-number="8835"></td>
        <td id="LC8835">                    result = CORINFO_INTRINSIC_Span_GetItem;</td>
      </tr>
      <tr>
        <td id="L8836" data-line-number="8836"></td>
        <td id="LC8836">                }</td>
      </tr>
      <tr>
        <td id="L8837" data-line-number="8837"></td>
        <td id="LC8837">            }</td>
      </tr>
      <tr>
        <td id="L8838" data-line-number="8838"></td>
        <td id="LC8838">            <span>else</span> <span>if</span> (pMT-&gt;<span>HasSameTypeDefAs</span>(<span>MscorlibBinder::GetClass</span>(CLASS__READONLY_SPAN)))</td>
      </tr>
      <tr>
        <td id="L8839" data-line-number="8839"></td>
        <td id="LC8839">            {</td>
      </tr>
      <tr>
        <td id="L8840" data-line-number="8840"></td>
        <td id="LC8840">                <span>if</span> (method-&gt;<span>HasSameMethodDefAs</span>(<span>MscorlibBinder::GetMethod</span>(METHOD__READONLY_SPAN__GET_ITEM)))</td>
      </tr>
      <tr>
        <td id="L8841" data-line-number="8841"></td>
        <td id="LC8841">                {</td>
      </tr>
      <tr>
        <td id="L8842" data-line-number="8842"></td>
        <td id="LC8842">                    result = CORINFO_INTRINSIC_ReadOnlySpan_GetItem;</td>
      </tr>
      <tr>
        <td id="L8843" data-line-number="8843"></td>
        <td id="LC8843">                }</td>
      </tr>
      <tr>
        <td id="L8844" data-line-number="8844"></td>
        <td id="LC8844">            }</td>
      </tr>
      <tr>
        <td id="L8845" data-line-number="8845"></td>
        <td id="LC8845">        }</td>
      </tr>
      <tr>
        <td id="L8846" data-line-number="8846"></td>
        <td id="LC8846">    }</td>
      </tr>
      <tr>
        <td id="L8847" data-line-number="8847"></td>
        <td id="LC8847">
</td>
      </tr>
      <tr>
        <td id="L8848" data-line-number="8848"></td>
        <td id="LC8848">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L8849" data-line-number="8849"></td>
        <td id="LC8849">
</td>
      </tr>
      <tr>
        <td id="L8850" data-line-number="8850"></td>
        <td id="LC8850">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L8851" data-line-number="8851"></td>
        <td id="LC8851">}</td>
      </tr>
      <tr>
        <td id="L8852" data-line-number="8852"></td>
        <td id="LC8852">
</td>
      </tr>
      <tr>
        <td id="L8853" data-line-number="8853"></td>
        <td id="LC8853"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8854" data-line-number="8854"></td>
        <td id="LC8854"><span>bool</span> <span>CEEInfo::isIntrinsicType</span>(CORINFO_CLASS_HANDLE classHnd)</td>
      </tr>
      <tr>
        <td id="L8855" data-line-number="8855"></td>
        <td id="LC8855">{</td>
      </tr>
      <tr>
        <td id="L8856" data-line-number="8856"></td>
        <td id="LC8856">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8857" data-line-number="8857"></td>
        <td id="LC8857">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L8858" data-line-number="8858"></td>
        <td id="LC8858">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L8859" data-line-number="8859"></td>
        <td id="LC8859">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8860" data-line-number="8860"></td>
        <td id="LC8860">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8861" data-line-number="8861"></td>
        <td id="LC8861">
</td>
      </tr>
      <tr>
        <td id="L8862" data-line-number="8862"></td>
        <td id="LC8862">    <span>bool</span> result = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L8863" data-line-number="8863"></td>
        <td id="LC8863">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L8864" data-line-number="8864"></td>
        <td id="LC8864">
</td>
      </tr>
      <tr>
        <td id="L8865" data-line-number="8865"></td>
        <td id="LC8865">    TypeHandle <span>VMClsHnd</span>(classHnd);</td>
      </tr>
      <tr>
        <td id="L8866" data-line-number="8866"></td>
        <td id="LC8866">    PTR_MethodTable methodTable = VMClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L8867" data-line-number="8867"></td>
        <td id="LC8867">    result = methodTable-&gt;<span>IsIntrinsicType</span>();</td>
      </tr>
      <tr>
        <td id="L8868" data-line-number="8868"></td>
        <td id="LC8868">
</td>
      </tr>
      <tr>
        <td id="L8869" data-line-number="8869"></td>
        <td id="LC8869">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L8870" data-line-number="8870"></td>
        <td id="LC8870">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L8871" data-line-number="8871"></td>
        <td id="LC8871">}</td>
      </tr>
      <tr>
        <td id="L8872" data-line-number="8872"></td>
        <td id="LC8872">
</td>
      </tr>
      <tr>
        <td id="L8873" data-line-number="8873"></td>
        <td id="LC8873"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8874" data-line-number="8874"></td>
        <td id="LC8874"><span>void</span> <span>CEEInfo::getMethodVTableOffset</span> (CORINFO_METHOD_HANDLE methodHnd,</td>
      </tr>
      <tr>
        <td id="L8875" data-line-number="8875"></td>
        <td id="LC8875">                                     <span>unsigned</span> * pOffsetOfIndirection,</td>
      </tr>
      <tr>
        <td id="L8876" data-line-number="8876"></td>
        <td id="LC8876">                                     <span>unsigned</span> * pOffsetAfterIndirection,</td>
      </tr>
      <tr>
        <td id="L8877" data-line-number="8877"></td>
        <td id="LC8877">                                     <span>bool</span> * isRelative)</td>
      </tr>
      <tr>
        <td id="L8878" data-line-number="8878"></td>
        <td id="LC8878">{</td>
      </tr>
      <tr>
        <td id="L8879" data-line-number="8879"></td>
        <td id="LC8879">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8880" data-line-number="8880"></td>
        <td id="LC8880">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L8881" data-line-number="8881"></td>
        <td id="LC8881">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L8882" data-line-number="8882"></td>
        <td id="LC8882">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8883" data-line-number="8883"></td>
        <td id="LC8883">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8884" data-line-number="8884"></td>
        <td id="LC8884">
</td>
      </tr>
      <tr>
        <td id="L8885" data-line-number="8885"></td>
        <td id="LC8885">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L8886" data-line-number="8886"></td>
        <td id="LC8886">
</td>
      </tr>
      <tr>
        <td id="L8887" data-line-number="8887"></td>
        <td id="LC8887">    MethodDesc* method = <span>GetMethod</span>(methodHnd);</td>
      </tr>
      <tr>
        <td id="L8888" data-line-number="8888"></td>
        <td id="LC8888">
</td>
      </tr>
      <tr>
        <td id="L8889" data-line-number="8889"></td>
        <td id="LC8889">    <span><span>//</span>@GENERICS: shouldn't be doing this for instantiated methods as they live elsewhere</span></td>
      </tr>
      <tr>
        <td id="L8890" data-line-number="8890"></td>
        <td id="LC8890">    <span>_ASSERTE</span>(!method-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L8891" data-line-number="8891"></td>
        <td id="LC8891">
</td>
      </tr>
      <tr>
        <td id="L8892" data-line-number="8892"></td>
        <td id="LC8892">    <span>_ASSERTE</span>(<span>MethodTable::GetVtableOffset</span>() &lt; <span>256</span>);  <span><span>//</span> a rough sanity check</span></td>
      </tr>
      <tr>
        <td id="L8893" data-line-number="8893"></td>
        <td id="LC8893">
</td>
      </tr>
      <tr>
        <td id="L8894" data-line-number="8894"></td>
        <td id="LC8894">    <span><span>//</span> better be in the vtable</span></td>
      </tr>
      <tr>
        <td id="L8895" data-line-number="8895"></td>
        <td id="LC8895">    <span>_ASSERTE</span>(method-&gt;<span>GetSlot</span>() &lt; method-&gt;<span>GetMethodTable</span>()-&gt;<span>GetNumVirtuals</span>());</td>
      </tr>
      <tr>
        <td id="L8896" data-line-number="8896"></td>
        <td id="LC8896">
</td>
      </tr>
      <tr>
        <td id="L8897" data-line-number="8897"></td>
        <td id="LC8897">    *pOffsetOfIndirection = <span>MethodTable::GetVtableOffset</span>() + <span>MethodTable::GetIndexOfVtableIndirection</span>(method-&gt;<span>GetSlot</span>()) * TARGET_POINTER_SIZE <span><span>/*</span> sizeof(MethodTable::VTableIndir_t) <span>*/</span></span>;</td>
      </tr>
      <tr>
        <td id="L8898" data-line-number="8898"></td>
        <td id="LC8898">    *pOffsetAfterIndirection = <span>MethodTable::GetIndexAfterVtableIndirection</span>(method-&gt;<span>GetSlot</span>()) * TARGET_POINTER_SIZE <span><span>/*</span> sizeof(MethodTable::VTableIndir2_t) <span>*/</span></span>;</td>
      </tr>
      <tr>
        <td id="L8899" data-line-number="8899"></td>
        <td id="LC8899">    *isRelative = MethodTable::VTableIndir_t::isRelative ? <span>1</span> : <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L8900" data-line-number="8900"></td>
        <td id="LC8900">    <span>_ASSERTE</span>(MethodTable::VTableIndir_t::isRelative == MethodTable::VTableIndir2_t::isRelative);</td>
      </tr>
      <tr>
        <td id="L8901" data-line-number="8901"></td>
        <td id="LC8901">
</td>
      </tr>
      <tr>
        <td id="L8902" data-line-number="8902"></td>
        <td id="LC8902">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L8903" data-line-number="8903"></td>
        <td id="LC8903">}</td>
      </tr>
      <tr>
        <td id="L8904" data-line-number="8904"></td>
        <td id="LC8904">
</td>
      </tr>
      <tr>
        <td id="L8905" data-line-number="8905"></td>
        <td id="LC8905"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L8906" data-line-number="8906"></td>
        <td id="LC8906">CORINFO_METHOD_HANDLE <span>CEEInfo::resolveVirtualMethodHelper</span>(CORINFO_METHOD_HANDLE baseMethod,</td>
      </tr>
      <tr>
        <td id="L8907" data-line-number="8907"></td>
        <td id="LC8907">                                                          CORINFO_CLASS_HANDLE derivedClass,</td>
      </tr>
      <tr>
        <td id="L8908" data-line-number="8908"></td>
        <td id="LC8908">                                                          CORINFO_CONTEXT_HANDLE ownerType)</td>
      </tr>
      <tr>
        <td id="L8909" data-line-number="8909"></td>
        <td id="LC8909">{</td>
      </tr>
      <tr>
        <td id="L8910" data-line-number="8910"></td>
        <td id="LC8910">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L8911" data-line-number="8911"></td>
        <td id="LC8911">        THROWS;</td>
      </tr>
      <tr>
        <td id="L8912" data-line-number="8912"></td>
        <td id="LC8912">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L8913" data-line-number="8913"></td>
        <td id="LC8913">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L8914" data-line-number="8914"></td>
        <td id="LC8914">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L8915" data-line-number="8915"></td>
        <td id="LC8915">
</td>
      </tr>
      <tr>
        <td id="L8916" data-line-number="8916"></td>
        <td id="LC8916">    MethodDesc* pBaseMD = <span>GetMethod</span>(baseMethod);</td>
      </tr>
      <tr>
        <td id="L8917" data-line-number="8917"></td>
        <td id="LC8917">    MethodTable* pBaseMT = pBaseMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L8918" data-line-number="8918"></td>
        <td id="LC8918">
</td>
      </tr>
      <tr>
        <td id="L8919" data-line-number="8919"></td>
        <td id="LC8919">    <span><span>//</span> Method better be from a fully loaded class</span></td>
      </tr>
      <tr>
        <td id="L8920" data-line-number="8920"></td>
        <td id="LC8920">    <span>_ASSERTE</span>(pBaseMD-&gt;<span>IsRestored</span>() &amp;&amp; pBaseMT-&gt;<span>IsFullyLoaded</span>());</td>
      </tr>
      <tr>
        <td id="L8921" data-line-number="8921"></td>
        <td id="LC8921">
</td>
      </tr>
      <tr>
        <td id="L8922" data-line-number="8922"></td>
        <td id="LC8922">    <span><span>//</span>@GENERICS: shouldn't be doing this for instantiated methods as they live elsewhere</span></td>
      </tr>
      <tr>
        <td id="L8923" data-line-number="8923"></td>
        <td id="LC8923">    <span>_ASSERTE</span>(!pBaseMD-&gt;<span>HasMethodInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L8924" data-line-number="8924"></td>
        <td id="LC8924">
</td>
      </tr>
      <tr>
        <td id="L8925" data-line-number="8925"></td>
        <td id="LC8925">    <span><span>//</span> Method better be virtual</span></td>
      </tr>
      <tr>
        <td id="L8926" data-line-number="8926"></td>
        <td id="LC8926">    <span>_ASSERTE</span>(pBaseMD-&gt;<span>IsVirtual</span>());</td>
      </tr>
      <tr>
        <td id="L8927" data-line-number="8927"></td>
        <td id="LC8927">
</td>
      </tr>
      <tr>
        <td id="L8928" data-line-number="8928"></td>
        <td id="LC8928">    MethodDesc* pDevirtMD = <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L8929" data-line-number="8929"></td>
        <td id="LC8929">
</td>
      </tr>
      <tr>
        <td id="L8930" data-line-number="8930"></td>
        <td id="LC8930">    TypeHandle <span>DerivedClsHnd</span>(derivedClass);</td>
      </tr>
      <tr>
        <td id="L8931" data-line-number="8931"></td>
        <td id="LC8931">    MethodTable* pDerivedMT = DerivedClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L8932" data-line-number="8932"></td>
        <td id="LC8932">    <span>_ASSERTE</span>(pDerivedMT-&gt;<span>IsRestored</span>() &amp;&amp; pDerivedMT-&gt;<span>IsFullyLoaded</span>());</td>
      </tr>
      <tr>
        <td id="L8933" data-line-number="8933"></td>
        <td id="LC8933">
</td>
      </tr>
      <tr>
        <td id="L8934" data-line-number="8934"></td>
        <td id="LC8934">    <span><span>//</span> Can't devirtualize from __Canon.</span></td>
      </tr>
      <tr>
        <td id="L8935" data-line-number="8935"></td>
        <td id="LC8935">    <span>if</span> (DerivedClsHnd == <span>TypeHandle</span>(g_pCanonMethodTableClass))</td>
      </tr>
      <tr>
        <td id="L8936" data-line-number="8936"></td>
        <td id="LC8936">    {</td>
      </tr>
      <tr>
        <td id="L8937" data-line-number="8937"></td>
        <td id="LC8937">        <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L8938" data-line-number="8938"></td>
        <td id="LC8938">    }</td>
      </tr>
      <tr>
        <td id="L8939" data-line-number="8939"></td>
        <td id="LC8939">
</td>
      </tr>
      <tr>
        <td id="L8940" data-line-number="8940"></td>
        <td id="LC8940">    <span>if</span> (pBaseMT-&gt;<span>IsInterface</span>())</td>
      </tr>
      <tr>
        <td id="L8941" data-line-number="8941"></td>
        <td id="LC8941">    {</td>
      </tr>
      <tr>
        <td id="L8942" data-line-number="8942"></td>
        <td id="LC8942">
</td>
      </tr>
      <tr>
        <td id="L8943" data-line-number="8943"></td>
        <td id="LC8943">#<span>ifdef</span> FEATURE_COMINTEROP</td>
      </tr>
      <tr>
        <td id="L8944" data-line-number="8944"></td>
        <td id="LC8944">        <span><span>//</span> Don't try and devirtualize com interface calls.</span></td>
      </tr>
      <tr>
        <td id="L8945" data-line-number="8945"></td>
        <td id="LC8945">        <span>if</span> (pDerivedMT-&gt;<span>IsComObjectType</span>())</td>
      </tr>
      <tr>
        <td id="L8946" data-line-number="8946"></td>
        <td id="LC8946">        {</td>
      </tr>
      <tr>
        <td id="L8947" data-line-number="8947"></td>
        <td id="LC8947">            <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L8948" data-line-number="8948"></td>
        <td id="LC8948">        }</td>
      </tr>
      <tr>
        <td id="L8949" data-line-number="8949"></td>
        <td id="LC8949">#<span>endif</span> <span><span>//</span> FEATURE_COMINTEROP</span></td>
      </tr>
      <tr>
        <td id="L8950" data-line-number="8950"></td>
        <td id="LC8950">
</td>
      </tr>
      <tr>
        <td id="L8951" data-line-number="8951"></td>
        <td id="LC8951">        <span><span>//</span> Interface call devirtualization.</span></td>
      </tr>
      <tr>
        <td id="L8952" data-line-number="8952"></td>
        <td id="LC8952">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8953" data-line-number="8953"></td>
        <td id="LC8953">        <span><span>//</span> We must ensure that pDerivedMT actually implements the</span></td>
      </tr>
      <tr>
        <td id="L8954" data-line-number="8954"></td>
        <td id="LC8954">        <span><span>//</span> interface corresponding to pBaseMD.</span></td>
      </tr>
      <tr>
        <td id="L8955" data-line-number="8955"></td>
        <td id="LC8955">        <span>if</span> (!pDerivedMT-&gt;<span>CanCastToInterface</span>(pBaseMT))</td>
      </tr>
      <tr>
        <td id="L8956" data-line-number="8956"></td>
        <td id="LC8956">        {</td>
      </tr>
      <tr>
        <td id="L8957" data-line-number="8957"></td>
        <td id="LC8957">            <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L8958" data-line-number="8958"></td>
        <td id="LC8958">        }</td>
      </tr>
      <tr>
        <td id="L8959" data-line-number="8959"></td>
        <td id="LC8959">
</td>
      </tr>
      <tr>
        <td id="L8960" data-line-number="8960"></td>
        <td id="LC8960">        <span><span>//</span> For generic interface methods we must have an ownerType to</span></td>
      </tr>
      <tr>
        <td id="L8961" data-line-number="8961"></td>
        <td id="LC8961">        <span><span>//</span> safely devirtualize.</span></td>
      </tr>
      <tr>
        <td id="L8962" data-line-number="8962"></td>
        <td id="LC8962">        <span>if</span> (ownerType != <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L8963" data-line-number="8963"></td>
        <td id="LC8963">        {</td>
      </tr>
      <tr>
        <td id="L8964" data-line-number="8964"></td>
        <td id="LC8964">            TypeHandle OwnerClsHnd = <span>GetTypeFromContext</span>(ownerType);</td>
      </tr>
      <tr>
        <td id="L8965" data-line-number="8965"></td>
        <td id="LC8965">            MethodTable* pOwnerMT = OwnerClsHnd.<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L8966" data-line-number="8966"></td>
        <td id="LC8966">
</td>
      </tr>
      <tr>
        <td id="L8967" data-line-number="8967"></td>
        <td id="LC8967">            <span><span>//</span> If the derived class is a shared class, make sure the</span></td>
      </tr>
      <tr>
        <td id="L8968" data-line-number="8968"></td>
        <td id="LC8968">            <span><span>//</span> owner class is too.</span></td>
      </tr>
      <tr>
        <td id="L8969" data-line-number="8969"></td>
        <td id="LC8969">            <span>if</span> (pDerivedMT-&gt;<span>IsSharedByGenericInstantiations</span>())</td>
      </tr>
      <tr>
        <td id="L8970" data-line-number="8970"></td>
        <td id="LC8970">            {</td>
      </tr>
      <tr>
        <td id="L8971" data-line-number="8971"></td>
        <td id="LC8971">                pOwnerMT = pOwnerMT-&gt;<span>GetCanonicalMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L8972" data-line-number="8972"></td>
        <td id="LC8972">            }</td>
      </tr>
      <tr>
        <td id="L8973" data-line-number="8973"></td>
        <td id="LC8973">
</td>
      </tr>
      <tr>
        <td id="L8974" data-line-number="8974"></td>
        <td id="LC8974">            pDevirtMD = pDerivedMT-&gt;<span>GetMethodDescForInterfaceMethod</span>(<span>TypeHandle</span>(pOwnerMT), pBaseMD, <span>FALSE</span> <span><span>/*</span> throwOnConflict <span>*/</span></span>);</td>
      </tr>
      <tr>
        <td id="L8975" data-line-number="8975"></td>
        <td id="LC8975">        }</td>
      </tr>
      <tr>
        <td id="L8976" data-line-number="8976"></td>
        <td id="LC8976">        <span>else</span> <span>if</span> (!pBaseMD-&gt;<span>HasClassOrMethodInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L8977" data-line-number="8977"></td>
        <td id="LC8977">        {</td>
      </tr>
      <tr>
        <td id="L8978" data-line-number="8978"></td>
        <td id="LC8978">            pDevirtMD = pDerivedMT-&gt;<span>GetMethodDescForInterfaceMethod</span>(pBaseMD, <span>FALSE</span> <span><span>/*</span> throwOnConflict <span>*/</span></span>);</td>
      </tr>
      <tr>
        <td id="L8979" data-line-number="8979"></td>
        <td id="LC8979">        }</td>
      </tr>
      <tr>
        <td id="L8980" data-line-number="8980"></td>
        <td id="LC8980">
</td>
      </tr>
      <tr>
        <td id="L8981" data-line-number="8981"></td>
        <td id="LC8981">        <span>if</span> (pDevirtMD == <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L8982" data-line-number="8982"></td>
        <td id="LC8982">        {</td>
      </tr>
      <tr>
        <td id="L8983" data-line-number="8983"></td>
        <td id="LC8983">            <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L8984" data-line-number="8984"></td>
        <td id="LC8984">        }</td>
      </tr>
      <tr>
        <td id="L8985" data-line-number="8985"></td>
        <td id="LC8985">
</td>
      </tr>
      <tr>
        <td id="L8986" data-line-number="8986"></td>
        <td id="LC8986">        <span><span>//</span> If we devirtualized into a default interface method on a generic type, we should actually return an</span></td>
      </tr>
      <tr>
        <td id="L8987" data-line-number="8987"></td>
        <td id="LC8987">        <span><span>//</span> instantiating stub but this is not happening.</span></td>
      </tr>
      <tr>
        <td id="L8988" data-line-number="8988"></td>
        <td id="LC8988">        <span><span>//</span> Making this work is tracked by https://github.com/dotnet/coreclr/issues/15977</span></td>
      </tr>
      <tr>
        <td id="L8989" data-line-number="8989"></td>
        <td id="LC8989">        <span>if</span> (pDevirtMD-&gt;<span>GetMethodTable</span>()-&gt;<span>IsInterface</span>() &amp;&amp; pDevirtMD-&gt;<span>HasClassInstantiation</span>())</td>
      </tr>
      <tr>
        <td id="L8990" data-line-number="8990"></td>
        <td id="LC8990">        {</td>
      </tr>
      <tr>
        <td id="L8991" data-line-number="8991"></td>
        <td id="LC8991">            <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L8992" data-line-number="8992"></td>
        <td id="LC8992">        }</td>
      </tr>
      <tr>
        <td id="L8993" data-line-number="8993"></td>
        <td id="LC8993">    }</td>
      </tr>
      <tr>
        <td id="L8994" data-line-number="8994"></td>
        <td id="LC8994">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L8995" data-line-number="8995"></td>
        <td id="LC8995">    {</td>
      </tr>
      <tr>
        <td id="L8996" data-line-number="8996"></td>
        <td id="LC8996">        <span><span>//</span> Virtual call devirtualization.</span></td>
      </tr>
      <tr>
        <td id="L8997" data-line-number="8997"></td>
        <td id="LC8997">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L8998" data-line-number="8998"></td>
        <td id="LC8998">        <span><span>//</span> The derived class should be a subclass of the the base class.</span></td>
      </tr>
      <tr>
        <td id="L8999" data-line-number="8999"></td>
        <td id="LC8999">        MethodTable* pCheckMT = pDerivedMT;</td>
      </tr>
      <tr>
        <td id="L9000" data-line-number="9000"></td>
        <td id="LC9000">
</td>
      </tr>
      <tr>
        <td id="L9001" data-line-number="9001"></td>
        <td id="LC9001">        <span>while</span> (pCheckMT != <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L9002" data-line-number="9002"></td>
        <td id="LC9002">        {</td>
      </tr>
      <tr>
        <td id="L9003" data-line-number="9003"></td>
        <td id="LC9003">            <span>if</span> (pCheckMT-&gt;<span>HasSameTypeDefAs</span>(pBaseMT))</td>
      </tr>
      <tr>
        <td id="L9004" data-line-number="9004"></td>
        <td id="LC9004">            {</td>
      </tr>
      <tr>
        <td id="L9005" data-line-number="9005"></td>
        <td id="LC9005">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9006" data-line-number="9006"></td>
        <td id="LC9006">            }</td>
      </tr>
      <tr>
        <td id="L9007" data-line-number="9007"></td>
        <td id="LC9007">
</td>
      </tr>
      <tr>
        <td id="L9008" data-line-number="9008"></td>
        <td id="LC9008">            pCheckMT = pCheckMT-&gt;<span>GetParentMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L9009" data-line-number="9009"></td>
        <td id="LC9009">        }</td>
      </tr>
      <tr>
        <td id="L9010" data-line-number="9010"></td>
        <td id="LC9010">
</td>
      </tr>
      <tr>
        <td id="L9011" data-line-number="9011"></td>
        <td id="LC9011">        <span>if</span> (pCheckMT == <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L9012" data-line-number="9012"></td>
        <td id="LC9012">        {</td>
      </tr>
      <tr>
        <td id="L9013" data-line-number="9013"></td>
        <td id="LC9013">            <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L9014" data-line-number="9014"></td>
        <td id="LC9014">        }</td>
      </tr>
      <tr>
        <td id="L9015" data-line-number="9015"></td>
        <td id="LC9015">
</td>
      </tr>
      <tr>
        <td id="L9016" data-line-number="9016"></td>
        <td id="LC9016">        <span><span>//</span> The base method should be in the base vtable</span></td>
      </tr>
      <tr>
        <td id="L9017" data-line-number="9017"></td>
        <td id="LC9017">        WORD slot = pBaseMD-&gt;<span>GetSlot</span>();</td>
      </tr>
      <tr>
        <td id="L9018" data-line-number="9018"></td>
        <td id="LC9018">        <span>_ASSERTE</span>(slot &lt; pBaseMT-&gt;<span>GetNumVirtuals</span>());</td>
      </tr>
      <tr>
        <td id="L9019" data-line-number="9019"></td>
        <td id="LC9019">
</td>
      </tr>
      <tr>
        <td id="L9020" data-line-number="9020"></td>
        <td id="LC9020">        <span><span>//</span> Fetch the method that would be invoked if the class were</span></td>
      </tr>
      <tr>
        <td id="L9021" data-line-number="9021"></td>
        <td id="LC9021">        <span><span>//</span> exactly derived class. It is up to the jit to determine whether</span></td>
      </tr>
      <tr>
        <td id="L9022" data-line-number="9022"></td>
        <td id="LC9022">        <span><span>//</span> directly calling this method is correct.</span></td>
      </tr>
      <tr>
        <td id="L9023" data-line-number="9023"></td>
        <td id="LC9023">        pDevirtMD = pDerivedMT-&gt;<span>GetMethodDescForSlot</span>(slot);</td>
      </tr>
      <tr>
        <td id="L9024" data-line-number="9024"></td>
        <td id="LC9024">
</td>
      </tr>
      <tr>
        <td id="L9025" data-line-number="9025"></td>
        <td id="LC9025">        <span><span>//</span> If the derived method's slot does not match the vtable slot,</span></td>
      </tr>
      <tr>
        <td id="L9026" data-line-number="9026"></td>
        <td id="LC9026">        <span><span>//</span> bail on devirtualization, as the method was installed into</span></td>
      </tr>
      <tr>
        <td id="L9027" data-line-number="9027"></td>
        <td id="LC9027">        <span><span>//</span> the vtable slot via an explicit override and even if the</span></td>
      </tr>
      <tr>
        <td id="L9028" data-line-number="9028"></td>
        <td id="LC9028">        <span><span>//</span> method is final, the slot may not be.</span></td>
      </tr>
      <tr>
        <td id="L9029" data-line-number="9029"></td>
        <td id="LC9029">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L9030" data-line-number="9030"></td>
        <td id="LC9030">        <span><span>//</span> Note the jit could still safely devirtualize if it had an exact</span></td>
      </tr>
      <tr>
        <td id="L9031" data-line-number="9031"></td>
        <td id="LC9031">        <span><span>//</span> class, but such cases are likely rare.</span></td>
      </tr>
      <tr>
        <td id="L9032" data-line-number="9032"></td>
        <td id="LC9032">        WORD dslot = pDevirtMD-&gt;<span>GetSlot</span>();</td>
      </tr>
      <tr>
        <td id="L9033" data-line-number="9033"></td>
        <td id="LC9033">
</td>
      </tr>
      <tr>
        <td id="L9034" data-line-number="9034"></td>
        <td id="LC9034">        <span>if</span> (dslot != slot)</td>
      </tr>
      <tr>
        <td id="L9035" data-line-number="9035"></td>
        <td id="LC9035">        {</td>
      </tr>
      <tr>
        <td id="L9036" data-line-number="9036"></td>
        <td id="LC9036">            <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L9037" data-line-number="9037"></td>
        <td id="LC9037">        }</td>
      </tr>
      <tr>
        <td id="L9038" data-line-number="9038"></td>
        <td id="LC9038">    }</td>
      </tr>
      <tr>
        <td id="L9039" data-line-number="9039"></td>
        <td id="LC9039">
</td>
      </tr>
      <tr>
        <td id="L9040" data-line-number="9040"></td>
        <td id="LC9040">    <span>_ASSERTE</span>(pDevirtMD-&gt;<span>IsRestored</span>());</td>
      </tr>
      <tr>
        <td id="L9041" data-line-number="9041"></td>
        <td id="LC9041">
</td>
      </tr>
      <tr>
        <td id="L9042" data-line-number="9042"></td>
        <td id="LC9042">#<span>ifdef</span> FEATURE_READYTORUN_COMPILER</td>
      </tr>
      <tr>
        <td id="L9043" data-line-number="9043"></td>
        <td id="LC9043">    <span><span>//</span> Check if devirtualization is dependent upon cross-version</span></td>
      </tr>
      <tr>
        <td id="L9044" data-line-number="9044"></td>
        <td id="LC9044">    <span><span>//</span> bubble information and if so, disallow it.</span></td>
      </tr>
      <tr>
        <td id="L9045" data-line-number="9045"></td>
        <td id="LC9045">    <span>if</span> (<span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L9046" data-line-number="9046"></td>
        <td id="LC9046">    {</td>
      </tr>
      <tr>
        <td id="L9047" data-line-number="9047"></td>
        <td id="LC9047">        MethodDesc* callerMethod = m_pMethodBeingCompiled;</td>
      </tr>
      <tr>
        <td id="L9048" data-line-number="9048"></td>
        <td id="LC9048">        Assembly* pCallerAssembly = callerMethod-&gt;<span>GetModule</span>()-&gt;<span>GetAssembly</span>();</td>
      </tr>
      <tr>
        <td id="L9049" data-line-number="9049"></td>
        <td id="LC9049">        <span>bool</span> allowDevirt =</td>
      </tr>
      <tr>
        <td id="L9050" data-line-number="9050"></td>
        <td id="LC9050">            <span>IsInSameVersionBubble</span>(pCallerAssembly , pDevirtMD-&gt;<span>GetModule</span>()-&gt;<span>GetAssembly</span>())</td>
      </tr>
      <tr>
        <td id="L9051" data-line-number="9051"></td>
        <td id="LC9051">            &amp;&amp; <span>IsInSameVersionBubble</span>(pCallerAssembly , pDerivedMT-&gt;<span>GetAssembly</span>());</td>
      </tr>
      <tr>
        <td id="L9052" data-line-number="9052"></td>
        <td id="LC9052">
</td>
      </tr>
      <tr>
        <td id="L9053" data-line-number="9053"></td>
        <td id="LC9053">        <span>if</span> (!allowDevirt)</td>
      </tr>
      <tr>
        <td id="L9054" data-line-number="9054"></td>
        <td id="LC9054">        {</td>
      </tr>
      <tr>
        <td id="L9055" data-line-number="9055"></td>
        <td id="LC9055">            <span>return</span> <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L9056" data-line-number="9056"></td>
        <td id="LC9056">        }</td>
      </tr>
      <tr>
        <td id="L9057" data-line-number="9057"></td>
        <td id="LC9057">    }</td>
      </tr>
      <tr>
        <td id="L9058" data-line-number="9058"></td>
        <td id="LC9058">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L9059" data-line-number="9059"></td>
        <td id="LC9059">
</td>
      </tr>
      <tr>
        <td id="L9060" data-line-number="9060"></td>
        <td id="LC9060">    <span>return</span> (CORINFO_METHOD_HANDLE) pDevirtMD;</td>
      </tr>
      <tr>
        <td id="L9061" data-line-number="9061"></td>
        <td id="LC9061">}</td>
      </tr>
      <tr>
        <td id="L9062" data-line-number="9062"></td>
        <td id="LC9062">
</td>
      </tr>
      <tr>
        <td id="L9063" data-line-number="9063"></td>
        <td id="LC9063">CORINFO_METHOD_HANDLE <span>CEEInfo::resolveVirtualMethod</span>(CORINFO_METHOD_HANDLE methodHnd,</td>
      </tr>
      <tr>
        <td id="L9064" data-line-number="9064"></td>
        <td id="LC9064">                                                    CORINFO_CLASS_HANDLE derivedClass,</td>
      </tr>
      <tr>
        <td id="L9065" data-line-number="9065"></td>
        <td id="LC9065">                                                    CORINFO_CONTEXT_HANDLE ownerType)</td>
      </tr>
      <tr>
        <td id="L9066" data-line-number="9066"></td>
        <td id="LC9066">{</td>
      </tr>
      <tr>
        <td id="L9067" data-line-number="9067"></td>
        <td id="LC9067">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9068" data-line-number="9068"></td>
        <td id="LC9068">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9069" data-line-number="9069"></td>
        <td id="LC9069">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9070" data-line-number="9070"></td>
        <td id="LC9070">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9071" data-line-number="9071"></td>
        <td id="LC9071">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9072" data-line-number="9072"></td>
        <td id="LC9072">
</td>
      </tr>
      <tr>
        <td id="L9073" data-line-number="9073"></td>
        <td id="LC9073">    CORINFO_METHOD_HANDLE result = <span>nullptr</span>;</td>
      </tr>
      <tr>
        <td id="L9074" data-line-number="9074"></td>
        <td id="LC9074">
</td>
      </tr>
      <tr>
        <td id="L9075" data-line-number="9075"></td>
        <td id="LC9075">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9076" data-line-number="9076"></td>
        <td id="LC9076">
</td>
      </tr>
      <tr>
        <td id="L9077" data-line-number="9077"></td>
        <td id="LC9077">    result = <span>resolveVirtualMethodHelper</span>(methodHnd, derivedClass, ownerType);</td>
      </tr>
      <tr>
        <td id="L9078" data-line-number="9078"></td>
        <td id="LC9078">
</td>
      </tr>
      <tr>
        <td id="L9079" data-line-number="9079"></td>
        <td id="LC9079">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9080" data-line-number="9080"></td>
        <td id="LC9080">
</td>
      </tr>
      <tr>
        <td id="L9081" data-line-number="9081"></td>
        <td id="LC9081">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9082" data-line-number="9082"></td>
        <td id="LC9082">}</td>
      </tr>
      <tr>
        <td id="L9083" data-line-number="9083"></td>
        <td id="LC9083">
</td>
      </tr>
      <tr>
        <td id="L9084" data-line-number="9084"></td>
        <td id="LC9084"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9085" data-line-number="9085"></td>
        <td id="LC9085">CORINFO_METHOD_HANDLE <span>CEEInfo::getUnboxedEntry</span>(</td>
      </tr>
      <tr>
        <td id="L9086" data-line-number="9086"></td>
        <td id="LC9086">    CORINFO_METHOD_HANDLE ftn,</td>
      </tr>
      <tr>
        <td id="L9087" data-line-number="9087"></td>
        <td id="LC9087">    <span>bool</span>* requiresInstMethodTableArg)</td>
      </tr>
      <tr>
        <td id="L9088" data-line-number="9088"></td>
        <td id="LC9088">{</td>
      </tr>
      <tr>
        <td id="L9089" data-line-number="9089"></td>
        <td id="LC9089">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9090" data-line-number="9090"></td>
        <td id="LC9090">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9091" data-line-number="9091"></td>
        <td id="LC9091">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9092" data-line-number="9092"></td>
        <td id="LC9092">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9093" data-line-number="9093"></td>
        <td id="LC9093">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9094" data-line-number="9094"></td>
        <td id="LC9094">
</td>
      </tr>
      <tr>
        <td id="L9095" data-line-number="9095"></td>
        <td id="LC9095">    CORINFO_METHOD_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9096" data-line-number="9096"></td>
        <td id="LC9096">
</td>
      </tr>
      <tr>
        <td id="L9097" data-line-number="9097"></td>
        <td id="LC9097">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9098" data-line-number="9098"></td>
        <td id="LC9098">
</td>
      </tr>
      <tr>
        <td id="L9099" data-line-number="9099"></td>
        <td id="LC9099">    MethodDesc* pMD = <span>GetMethod</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L9100" data-line-number="9100"></td>
        <td id="LC9100">    <span>bool</span> requiresInstMTArg = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L9101" data-line-number="9101"></td>
        <td id="LC9101">
</td>
      </tr>
      <tr>
        <td id="L9102" data-line-number="9102"></td>
        <td id="LC9102">    <span>if</span> (pMD-&gt;<span>IsUnboxingStub</span>())</td>
      </tr>
      <tr>
        <td id="L9103" data-line-number="9103"></td>
        <td id="LC9103">    {</td>
      </tr>
      <tr>
        <td id="L9104" data-line-number="9104"></td>
        <td id="LC9104">        MethodTable* pMT = pMD-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L9105" data-line-number="9105"></td>
        <td id="LC9105">        MethodDesc* pUnboxedMD = pMT-&gt;<span>GetUnboxedEntryPointMD</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L9106" data-line-number="9106"></td>
        <td id="LC9106">
</td>
      </tr>
      <tr>
        <td id="L9107" data-line-number="9107"></td>
        <td id="LC9107">        result = (CORINFO_METHOD_HANDLE)pUnboxedMD;</td>
      </tr>
      <tr>
        <td id="L9108" data-line-number="9108"></td>
        <td id="LC9108">        requiresInstMTArg = !!pUnboxedMD-&gt;<span>RequiresInstMethodTableArg</span>();</td>
      </tr>
      <tr>
        <td id="L9109" data-line-number="9109"></td>
        <td id="LC9109">    }</td>
      </tr>
      <tr>
        <td id="L9110" data-line-number="9110"></td>
        <td id="LC9110">
</td>
      </tr>
      <tr>
        <td id="L9111" data-line-number="9111"></td>
        <td id="LC9111">    <span>if</span> (requiresInstMethodTableArg != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L9112" data-line-number="9112"></td>
        <td id="LC9112">    {</td>
      </tr>
      <tr>
        <td id="L9113" data-line-number="9113"></td>
        <td id="LC9113">        *requiresInstMethodTableArg = requiresInstMTArg;</td>
      </tr>
      <tr>
        <td id="L9114" data-line-number="9114"></td>
        <td id="LC9114">    }</td>
      </tr>
      <tr>
        <td id="L9115" data-line-number="9115"></td>
        <td id="LC9115">
</td>
      </tr>
      <tr>
        <td id="L9116" data-line-number="9116"></td>
        <td id="LC9116">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9117" data-line-number="9117"></td>
        <td id="LC9117">
</td>
      </tr>
      <tr>
        <td id="L9118" data-line-number="9118"></td>
        <td id="LC9118">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9119" data-line-number="9119"></td>
        <td id="LC9119">}</td>
      </tr>
      <tr>
        <td id="L9120" data-line-number="9120"></td>
        <td id="LC9120">
</td>
      </tr>
      <tr>
        <td id="L9121" data-line-number="9121"></td>
        <td id="LC9121"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9122" data-line-number="9122"></td>
        <td id="LC9122"><span>void</span> <span>CEEInfo::expandRawHandleIntrinsic</span>(</td>
      </tr>
      <tr>
        <td id="L9123" data-line-number="9123"></td>
        <td id="LC9123">    CORINFO_RESOLVED_TOKEN *        pResolvedToken,</td>
      </tr>
      <tr>
        <td id="L9124" data-line-number="9124"></td>
        <td id="LC9124">    CORINFO_GENERICHANDLE_RESULT *  pResult)</td>
      </tr>
      <tr>
        <td id="L9125" data-line-number="9125"></td>
        <td id="LC9125">{</td>
      </tr>
      <tr>
        <td id="L9126" data-line-number="9126"></td>
        <td id="LC9126">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L9127" data-line-number="9127"></td>
        <td id="LC9127">    <span>UNREACHABLE</span>();      <span><span>//</span> only called with CoreRT.</span></td>
      </tr>
      <tr>
        <td id="L9128" data-line-number="9128"></td>
        <td id="LC9128">}</td>
      </tr>
      <tr>
        <td id="L9129" data-line-number="9129"></td>
        <td id="LC9129">
</td>
      </tr>
      <tr>
        <td id="L9130" data-line-number="9130"></td>
        <td id="LC9130"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9131" data-line-number="9131"></td>
        <td id="LC9131">CORINFO_CLASS_HANDLE <span>CEEInfo::getDefaultEqualityComparerClass</span>(CORINFO_CLASS_HANDLE elemType)</td>
      </tr>
      <tr>
        <td id="L9132" data-line-number="9132"></td>
        <td id="LC9132">{</td>
      </tr>
      <tr>
        <td id="L9133" data-line-number="9133"></td>
        <td id="LC9133">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9134" data-line-number="9134"></td>
        <td id="LC9134">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9135" data-line-number="9135"></td>
        <td id="LC9135">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9136" data-line-number="9136"></td>
        <td id="LC9136">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9137" data-line-number="9137"></td>
        <td id="LC9137">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9138" data-line-number="9138"></td>
        <td id="LC9138">
</td>
      </tr>
      <tr>
        <td id="L9139" data-line-number="9139"></td>
        <td id="LC9139">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9140" data-line-number="9140"></td>
        <td id="LC9140">
</td>
      </tr>
      <tr>
        <td id="L9141" data-line-number="9141"></td>
        <td id="LC9141">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9142" data-line-number="9142"></td>
        <td id="LC9142">
</td>
      </tr>
      <tr>
        <td id="L9143" data-line-number="9143"></td>
        <td id="LC9143">    result = <span>getDefaultEqualityComparerClassHelper</span>(elemType);</td>
      </tr>
      <tr>
        <td id="L9144" data-line-number="9144"></td>
        <td id="LC9144">
</td>
      </tr>
      <tr>
        <td id="L9145" data-line-number="9145"></td>
        <td id="LC9145">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9146" data-line-number="9146"></td>
        <td id="LC9146">
</td>
      </tr>
      <tr>
        <td id="L9147" data-line-number="9147"></td>
        <td id="LC9147">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9148" data-line-number="9148"></td>
        <td id="LC9148">}</td>
      </tr>
      <tr>
        <td id="L9149" data-line-number="9149"></td>
        <td id="LC9149">
</td>
      </tr>
      <tr>
        <td id="L9150" data-line-number="9150"></td>
        <td id="LC9150">CORINFO_CLASS_HANDLE <span>CEEInfo::getDefaultEqualityComparerClassHelper</span>(CORINFO_CLASS_HANDLE elemType)</td>
      </tr>
      <tr>
        <td id="L9151" data-line-number="9151"></td>
        <td id="LC9151">{</td>
      </tr>
      <tr>
        <td id="L9152" data-line-number="9152"></td>
        <td id="LC9152">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9153" data-line-number="9153"></td>
        <td id="LC9153">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9154" data-line-number="9154"></td>
        <td id="LC9154">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9155" data-line-number="9155"></td>
        <td id="LC9155">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9156" data-line-number="9156"></td>
        <td id="LC9156">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9157" data-line-number="9157"></td>
        <td id="LC9157">
</td>
      </tr>
      <tr>
        <td id="L9158" data-line-number="9158"></td>
        <td id="LC9158">    <span><span>//</span> Mirrors the logic in BCL's CompareHelpers.CreateDefaultEqualityComparer</span></td>
      </tr>
      <tr>
        <td id="L9159" data-line-number="9159"></td>
        <td id="LC9159">    <span><span>//</span> And in compile.cpp's SpecializeEqualityComparer</span></td>
      </tr>
      <tr>
        <td id="L9160" data-line-number="9160"></td>
        <td id="LC9160">    TypeHandle <span>elemTypeHnd</span>(elemType);</td>
      </tr>
      <tr>
        <td id="L9161" data-line-number="9161"></td>
        <td id="LC9161">
</td>
      </tr>
      <tr>
        <td id="L9162" data-line-number="9162"></td>
        <td id="LC9162">    <span><span>//</span> Special case for byte</span></td>
      </tr>
      <tr>
        <td id="L9163" data-line-number="9163"></td>
        <td id="LC9163">    <span>if</span> (elemTypeHnd.<span>AsMethodTable</span>()-&gt;<span>HasSameTypeDefAs</span>(<span>MscorlibBinder::GetClass</span>(CLASS__ELEMENT_TYPE_U1)))</td>
      </tr>
      <tr>
        <td id="L9164" data-line-number="9164"></td>
        <td id="LC9164">    {</td>
      </tr>
      <tr>
        <td id="L9165" data-line-number="9165"></td>
        <td id="LC9165">        <span>return</span> <span>CORINFO_CLASS_HANDLE</span>(<span>MscorlibBinder::GetClass</span>(CLASS__BYTE_EQUALITYCOMPARER));</td>
      </tr>
      <tr>
        <td id="L9166" data-line-number="9166"></td>
        <td id="LC9166">    }</td>
      </tr>
      <tr>
        <td id="L9167" data-line-number="9167"></td>
        <td id="LC9167">
</td>
      </tr>
      <tr>
        <td id="L9168" data-line-number="9168"></td>
        <td id="LC9168">    <span><span>//</span> Else we'll need to find the appropriate instantation</span></td>
      </tr>
      <tr>
        <td id="L9169" data-line-number="9169"></td>
        <td id="LC9169">    Instantiation <span>inst</span>(&amp;elemTypeHnd, <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L9170" data-line-number="9170"></td>
        <td id="LC9170">
</td>
      </tr>
      <tr>
        <td id="L9171" data-line-number="9171"></td>
        <td id="LC9171">    <span><span>//</span> If T implements IEquatable&lt;T&gt;</span></td>
      </tr>
      <tr>
        <td id="L9172" data-line-number="9172"></td>
        <td id="LC9172">    <span>if</span> (elemTypeHnd.<span>CanCastTo</span>(<span>TypeHandle</span>(<span>MscorlibBinder::GetClass</span>(CLASS__IEQUATABLEGENERIC)).<span>Instantiate</span>(inst)))</td>
      </tr>
      <tr>
        <td id="L9173" data-line-number="9173"></td>
        <td id="LC9173">    {</td>
      </tr>
      <tr>
        <td id="L9174" data-line-number="9174"></td>
        <td id="LC9174">        TypeHandle resultTh = ((TypeHandle)<span>MscorlibBinder::GetClass</span>(CLASS__GENERIC_EQUALITYCOMPARER)).<span>Instantiate</span>(inst);</td>
      </tr>
      <tr>
        <td id="L9175" data-line-number="9175"></td>
        <td id="LC9175">        <span>return</span> <span>CORINFO_CLASS_HANDLE</span>(resultTh.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L9176" data-line-number="9176"></td>
        <td id="LC9176">    }</td>
      </tr>
      <tr>
        <td id="L9177" data-line-number="9177"></td>
        <td id="LC9177">
</td>
      </tr>
      <tr>
        <td id="L9178" data-line-number="9178"></td>
        <td id="LC9178">    <span><span>//</span> Nullable&lt;T&gt;</span></td>
      </tr>
      <tr>
        <td id="L9179" data-line-number="9179"></td>
        <td id="LC9179">    <span>if</span> (<span>Nullable::IsNullableType</span>(elemTypeHnd))</td>
      </tr>
      <tr>
        <td id="L9180" data-line-number="9180"></td>
        <td id="LC9180">    {</td>
      </tr>
      <tr>
        <td id="L9181" data-line-number="9181"></td>
        <td id="LC9181">        Instantiation nullableInst = elemTypeHnd.<span>AsMethodTable</span>()-&gt;<span>GetInstantiation</span>();</td>
      </tr>
      <tr>
        <td id="L9182" data-line-number="9182"></td>
        <td id="LC9182">        TypeHandle nullableComparer = <span>TypeHandle</span>(<span>MscorlibBinder::GetClass</span>(CLASS__IEQUATABLEGENERIC)).<span>Instantiate</span>(nullableInst);</td>
      </tr>
      <tr>
        <td id="L9183" data-line-number="9183"></td>
        <td id="LC9183">        <span>if</span> (nullableInst[<span>0</span>].<span>CanCastTo</span>(nullableComparer))</td>
      </tr>
      <tr>
        <td id="L9184" data-line-number="9184"></td>
        <td id="LC9184">        {</td>
      </tr>
      <tr>
        <td id="L9185" data-line-number="9185"></td>
        <td id="LC9185">            <span>return</span> <span>CORINFO_CLASS_HANDLE</span>(nullableComparer.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L9186" data-line-number="9186"></td>
        <td id="LC9186">        }</td>
      </tr>
      <tr>
        <td id="L9187" data-line-number="9187"></td>
        <td id="LC9187">    }</td>
      </tr>
      <tr>
        <td id="L9188" data-line-number="9188"></td>
        <td id="LC9188">
</td>
      </tr>
      <tr>
        <td id="L9189" data-line-number="9189"></td>
        <td id="LC9189">    <span><span>//</span> Enum</span></td>
      </tr>
      <tr>
        <td id="L9190" data-line-number="9190"></td>
        <td id="LC9190">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L9191" data-line-number="9191"></td>
        <td id="LC9191">    <span><span>//</span> We need to special case the Enum comparers based on their underlying type,</span></td>
      </tr>
      <tr>
        <td id="L9192" data-line-number="9192"></td>
        <td id="LC9192">    <span><span>//</span> to avoid boxing and call the correct versions of GetHashCode.</span></td>
      </tr>
      <tr>
        <td id="L9193" data-line-number="9193"></td>
        <td id="LC9193">    <span>if</span> (elemTypeHnd.<span>IsEnum</span>())</td>
      </tr>
      <tr>
        <td id="L9194" data-line-number="9194"></td>
        <td id="LC9194">    {</td>
      </tr>
      <tr>
        <td id="L9195" data-line-number="9195"></td>
        <td id="LC9195">        MethodTable* targetClass = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9196" data-line-number="9196"></td>
        <td id="LC9196">        CorElementType normType = elemTypeHnd.<span>GetVerifierCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L9197" data-line-number="9197"></td>
        <td id="LC9197">
</td>
      </tr>
      <tr>
        <td id="L9198" data-line-number="9198"></td>
        <td id="LC9198">        <span>switch</span>(normType)</td>
      </tr>
      <tr>
        <td id="L9199" data-line-number="9199"></td>
        <td id="LC9199">        {</td>
      </tr>
      <tr>
        <td id="L9200" data-line-number="9200"></td>
        <td id="LC9200">            <span>case</span> ELEMENT_TYPE_I1:</td>
      </tr>
      <tr>
        <td id="L9201" data-line-number="9201"></td>
        <td id="LC9201">            <span>case</span> ELEMENT_TYPE_I2:</td>
      </tr>
      <tr>
        <td id="L9202" data-line-number="9202"></td>
        <td id="LC9202">            <span>case</span> ELEMENT_TYPE_U1:</td>
      </tr>
      <tr>
        <td id="L9203" data-line-number="9203"></td>
        <td id="LC9203">            <span>case</span> ELEMENT_TYPE_U2:</td>
      </tr>
      <tr>
        <td id="L9204" data-line-number="9204"></td>
        <td id="LC9204">            <span>case</span> ELEMENT_TYPE_I4:</td>
      </tr>
      <tr>
        <td id="L9205" data-line-number="9205"></td>
        <td id="LC9205">            <span>case</span> ELEMENT_TYPE_U4:</td>
      </tr>
      <tr>
        <td id="L9206" data-line-number="9206"></td>
        <td id="LC9206">            <span>case</span> ELEMENT_TYPE_I8:</td>
      </tr>
      <tr>
        <td id="L9207" data-line-number="9207"></td>
        <td id="LC9207">            <span>case</span> ELEMENT_TYPE_U8:</td>
      </tr>
      <tr>
        <td id="L9208" data-line-number="9208"></td>
        <td id="LC9208">            {</td>
      </tr>
      <tr>
        <td id="L9209" data-line-number="9209"></td>
        <td id="LC9209">                targetClass = <span>MscorlibBinder::GetClass</span>(CLASS__ENUM_EQUALITYCOMPARER);</td>
      </tr>
      <tr>
        <td id="L9210" data-line-number="9210"></td>
        <td id="LC9210">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9211" data-line-number="9211"></td>
        <td id="LC9211">            }</td>
      </tr>
      <tr>
        <td id="L9212" data-line-number="9212"></td>
        <td id="LC9212">
</td>
      </tr>
      <tr>
        <td id="L9213" data-line-number="9213"></td>
        <td id="LC9213">            <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L9214" data-line-number="9214"></td>
        <td id="LC9214">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9215" data-line-number="9215"></td>
        <td id="LC9215">        }</td>
      </tr>
      <tr>
        <td id="L9216" data-line-number="9216"></td>
        <td id="LC9216">
</td>
      </tr>
      <tr>
        <td id="L9217" data-line-number="9217"></td>
        <td id="LC9217">        <span>if</span> (targetClass != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L9218" data-line-number="9218"></td>
        <td id="LC9218">        {</td>
      </tr>
      <tr>
        <td id="L9219" data-line-number="9219"></td>
        <td id="LC9219">            TypeHandle resultTh = ((TypeHandle)targetClass-&gt;<span>GetCanonicalMethodTable</span>()).<span>Instantiate</span>(inst);</td>
      </tr>
      <tr>
        <td id="L9220" data-line-number="9220"></td>
        <td id="LC9220">            <span>return</span> <span>CORINFO_CLASS_HANDLE</span>(resultTh.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L9221" data-line-number="9221"></td>
        <td id="LC9221">        }</td>
      </tr>
      <tr>
        <td id="L9222" data-line-number="9222"></td>
        <td id="LC9222">    }</td>
      </tr>
      <tr>
        <td id="L9223" data-line-number="9223"></td>
        <td id="LC9223">
</td>
      </tr>
      <tr>
        <td id="L9224" data-line-number="9224"></td>
        <td id="LC9224">    <span><span>//</span> Default case</span></td>
      </tr>
      <tr>
        <td id="L9225" data-line-number="9225"></td>
        <td id="LC9225">    TypeHandle resultTh = ((TypeHandle)<span>MscorlibBinder::GetClass</span>(CLASS__OBJECT_EQUALITYCOMPARER)).<span>Instantiate</span>(inst);</td>
      </tr>
      <tr>
        <td id="L9226" data-line-number="9226"></td>
        <td id="LC9226">
</td>
      </tr>
      <tr>
        <td id="L9227" data-line-number="9227"></td>
        <td id="LC9227">    <span>return</span> <span>CORINFO_CLASS_HANDLE</span>(resultTh.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L9228" data-line-number="9228"></td>
        <td id="LC9228">}</td>
      </tr>
      <tr>
        <td id="L9229" data-line-number="9229"></td>
        <td id="LC9229">
</td>
      </tr>
      <tr>
        <td id="L9230" data-line-number="9230"></td>
        <td id="LC9230"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9231" data-line-number="9231"></td>
        <td id="LC9231"><span>void</span> <span>CEEInfo::getFunctionEntryPoint</span>(CORINFO_METHOD_HANDLE  ftnHnd,</td>
      </tr>
      <tr>
        <td id="L9232" data-line-number="9232"></td>
        <td id="LC9232">                                    CORINFO_CONST_LOOKUP * pResult,</td>
      </tr>
      <tr>
        <td id="L9233" data-line-number="9233"></td>
        <td id="LC9233">                                    CORINFO_ACCESS_FLAGS   accessFlags)</td>
      </tr>
      <tr>
        <td id="L9234" data-line-number="9234"></td>
        <td id="LC9234">{</td>
      </tr>
      <tr>
        <td id="L9235" data-line-number="9235"></td>
        <td id="LC9235">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9236" data-line-number="9236"></td>
        <td id="LC9236">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9237" data-line-number="9237"></td>
        <td id="LC9237">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9238" data-line-number="9238"></td>
        <td id="LC9238">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9239" data-line-number="9239"></td>
        <td id="LC9239">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9240" data-line-number="9240"></td>
        <td id="LC9240">
</td>
      </tr>
      <tr>
        <td id="L9241" data-line-number="9241"></td>
        <td id="LC9241">    <span>void</span>* ret = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9242" data-line-number="9242"></td>
        <td id="LC9242">    InfoAccessType accessType = IAT_VALUE;</td>
      </tr>
      <tr>
        <td id="L9243" data-line-number="9243"></td>
        <td id="LC9243">
</td>
      </tr>
      <tr>
        <td id="L9244" data-line-number="9244"></td>
        <td id="LC9244">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9245" data-line-number="9245"></td>
        <td id="LC9245">
</td>
      </tr>
      <tr>
        <td id="L9246" data-line-number="9246"></td>
        <td id="LC9246">    MethodDesc * ftn = <span>GetMethod</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L9247" data-line-number="9247"></td>
        <td id="LC9247">#<span>if</span> defined(FEATURE_GDBJIT)</td>
      </tr>
      <tr>
        <td id="L9248" data-line-number="9248"></td>
        <td id="LC9248">    MethodDesc * orig_ftn = ftn;</td>
      </tr>
      <tr>
        <td id="L9249" data-line-number="9249"></td>
        <td id="LC9249">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L9250" data-line-number="9250"></td>
        <td id="LC9250">
</td>
      </tr>
      <tr>
        <td id="L9251" data-line-number="9251"></td>
        <td id="LC9251">    <span><span>//</span> Resolve methodImpl.</span></td>
      </tr>
      <tr>
        <td id="L9252" data-line-number="9252"></td>
        <td id="LC9252">    ftn = ftn-&gt;<span>GetMethodTable</span>()-&gt;<span>MapMethodDeclToMethodImpl</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L9253" data-line-number="9253"></td>
        <td id="LC9253">
</td>
      </tr>
      <tr>
        <td id="L9254" data-line-number="9254"></td>
        <td id="LC9254">    ret = (<span>void</span> *)ftn-&gt;<span>TryGetMultiCallableAddrOfCode</span>(accessFlags);</td>
      </tr>
      <tr>
        <td id="L9255" data-line-number="9255"></td>
        <td id="LC9255">
</td>
      </tr>
      <tr>
        <td id="L9256" data-line-number="9256"></td>
        <td id="LC9256">    <span><span>//</span> TryGetMultiCallableAddrOfCode returns NULL if indirect access is desired</span></td>
      </tr>
      <tr>
        <td id="L9257" data-line-number="9257"></td>
        <td id="LC9257">    <span>if</span> (ret == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L9258" data-line-number="9258"></td>
        <td id="LC9258">    {</td>
      </tr>
      <tr>
        <td id="L9259" data-line-number="9259"></td>
        <td id="LC9259">        <span><span>//</span> should never get here for EnC methods or if interception via remoting stub is required</span></td>
      </tr>
      <tr>
        <td id="L9260" data-line-number="9260"></td>
        <td id="LC9260">        <span>_ASSERTE</span>(!ftn-&gt;<span>IsEnCMethod</span>());</td>
      </tr>
      <tr>
        <td id="L9261" data-line-number="9261"></td>
        <td id="LC9261">
</td>
      </tr>
      <tr>
        <td id="L9262" data-line-number="9262"></td>
        <td id="LC9262">        ret = (<span>void</span> *)ftn-&gt;<span>GetAddrOfSlot</span>();</td>
      </tr>
      <tr>
        <td id="L9263" data-line-number="9263"></td>
        <td id="LC9263">
</td>
      </tr>
      <tr>
        <td id="L9264" data-line-number="9264"></td>
        <td id="LC9264">        <span>if</span> (MethodTable::VTableIndir2_t::isRelative</td>
      </tr>
      <tr>
        <td id="L9265" data-line-number="9265"></td>
        <td id="LC9265">            &amp;&amp; ftn-&gt;<span>IsVtableSlot</span>())</td>
      </tr>
      <tr>
        <td id="L9266" data-line-number="9266"></td>
        <td id="LC9266">        {</td>
      </tr>
      <tr>
        <td id="L9267" data-line-number="9267"></td>
        <td id="LC9267">            accessType = IAT_RELPVALUE;</td>
      </tr>
      <tr>
        <td id="L9268" data-line-number="9268"></td>
        <td id="LC9268">        }</td>
      </tr>
      <tr>
        <td id="L9269" data-line-number="9269"></td>
        <td id="LC9269">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L9270" data-line-number="9270"></td>
        <td id="LC9270">        {</td>
      </tr>
      <tr>
        <td id="L9271" data-line-number="9271"></td>
        <td id="LC9271">            accessType = IAT_PVALUE;</td>
      </tr>
      <tr>
        <td id="L9272" data-line-number="9272"></td>
        <td id="LC9272">        }</td>
      </tr>
      <tr>
        <td id="L9273" data-line-number="9273"></td>
        <td id="LC9273">    }</td>
      </tr>
      <tr>
        <td id="L9274" data-line-number="9274"></td>
        <td id="LC9274">
</td>
      </tr>
      <tr>
        <td id="L9275" data-line-number="9275"></td>
        <td id="LC9275">
</td>
      </tr>
      <tr>
        <td id="L9276" data-line-number="9276"></td>
        <td id="LC9276">#<span>if</span> defined(FEATURE_GDBJIT)</td>
      </tr>
      <tr>
        <td id="L9277" data-line-number="9277"></td>
        <td id="LC9277">    CalledMethod * pCM = <span>new</span> <span>CalledMethod</span>(orig_ftn, ret, m_pCalledMethods);</td>
      </tr>
      <tr>
        <td id="L9278" data-line-number="9278"></td>
        <td id="LC9278">    m_pCalledMethods = pCM;</td>
      </tr>
      <tr>
        <td id="L9279" data-line-number="9279"></td>
        <td id="LC9279">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L9280" data-line-number="9280"></td>
        <td id="LC9280">
</td>
      </tr>
      <tr>
        <td id="L9281" data-line-number="9281"></td>
        <td id="LC9281">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9282" data-line-number="9282"></td>
        <td id="LC9282">
</td>
      </tr>
      <tr>
        <td id="L9283" data-line-number="9283"></td>
        <td id="LC9283">    <span>_ASSERTE</span>(ret != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L9284" data-line-number="9284"></td>
        <td id="LC9284">
</td>
      </tr>
      <tr>
        <td id="L9285" data-line-number="9285"></td>
        <td id="LC9285">    pResult-&gt;<span>accessType</span> = accessType;</td>
      </tr>
      <tr>
        <td id="L9286" data-line-number="9286"></td>
        <td id="LC9286">    pResult-&gt;<span>addr</span> = ret;</td>
      </tr>
      <tr>
        <td id="L9287" data-line-number="9287"></td>
        <td id="LC9287">}</td>
      </tr>
      <tr>
        <td id="L9288" data-line-number="9288"></td>
        <td id="LC9288">
</td>
      </tr>
      <tr>
        <td id="L9289" data-line-number="9289"></td>
        <td id="LC9289"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9290" data-line-number="9290"></td>
        <td id="LC9290"><span>void</span> <span>CEEInfo::getFunctionFixedEntryPoint</span>(CORINFO_METHOD_HANDLE   ftn,</td>
      </tr>
      <tr>
        <td id="L9291" data-line-number="9291"></td>
        <td id="LC9291">                                         CORINFO_CONST_LOOKUP *  pResult)</td>
      </tr>
      <tr>
        <td id="L9292" data-line-number="9292"></td>
        <td id="LC9292">{</td>
      </tr>
      <tr>
        <td id="L9293" data-line-number="9293"></td>
        <td id="LC9293">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9294" data-line-number="9294"></td>
        <td id="LC9294">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9295" data-line-number="9295"></td>
        <td id="LC9295">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9296" data-line-number="9296"></td>
        <td id="LC9296">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9297" data-line-number="9297"></td>
        <td id="LC9297">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9298" data-line-number="9298"></td>
        <td id="LC9298">
</td>
      </tr>
      <tr>
        <td id="L9299" data-line-number="9299"></td>
        <td id="LC9299">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9300" data-line-number="9300"></td>
        <td id="LC9300">
</td>
      </tr>
      <tr>
        <td id="L9301" data-line-number="9301"></td>
        <td id="LC9301">    MethodDesc * pMD = <span>GetMethod</span>(ftn);</td>
      </tr>
      <tr>
        <td id="L9302" data-line-number="9302"></td>
        <td id="LC9302">
</td>
      </tr>
      <tr>
        <td id="L9303" data-line-number="9303"></td>
        <td id="LC9303">    pResult-&gt;<span>accessType</span> = IAT_VALUE;</td>
      </tr>
      <tr>
        <td id="L9304" data-line-number="9304"></td>
        <td id="LC9304">
</td>
      </tr>
      <tr>
        <td id="L9305" data-line-number="9305"></td>
        <td id="LC9305">
</td>
      </tr>
      <tr>
        <td id="L9306" data-line-number="9306"></td>
        <td id="LC9306">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L9307" data-line-number="9307"></td>
        <td id="LC9307">    <span><span>//</span> If LDFTN target has [NativeCallable] attribute , then create a UMEntryThunk.</span></td>
      </tr>
      <tr>
        <td id="L9308" data-line-number="9308"></td>
        <td id="LC9308">    <span>if</span> (pMD-&gt;<span>HasNativeCallableAttribute</span>())</td>
      </tr>
      <tr>
        <td id="L9309" data-line-number="9309"></td>
        <td id="LC9309">    {</td>
      </tr>
      <tr>
        <td id="L9310" data-line-number="9310"></td>
        <td id="LC9310">        pResult-&gt;<span>addr</span> = (<span>void</span>*)<span>COMDelegate::ConvertToCallback</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L9311" data-line-number="9311"></td>
        <td id="LC9311">    }</td>
      </tr>
      <tr>
        <td id="L9312" data-line-number="9312"></td>
        <td id="LC9312">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L9313" data-line-number="9313"></td>
        <td id="LC9313">#<span>endif</span> <span><span>//</span>CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L9314" data-line-number="9314"></td>
        <td id="LC9314">    {</td>
      </tr>
      <tr>
        <td id="L9315" data-line-number="9315"></td>
        <td id="LC9315">        pResult-&gt;<span>addr</span> = (<span>void</span> *)pMD-&gt;<span>GetMultiCallableAddrOfCode</span>();</td>
      </tr>
      <tr>
        <td id="L9316" data-line-number="9316"></td>
        <td id="LC9316">    }</td>
      </tr>
      <tr>
        <td id="L9317" data-line-number="9317"></td>
        <td id="LC9317">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9318" data-line-number="9318"></td>
        <td id="LC9318">}</td>
      </tr>
      <tr>
        <td id="L9319" data-line-number="9319"></td>
        <td id="LC9319">
</td>
      </tr>
      <tr>
        <td id="L9320" data-line-number="9320"></td>
        <td id="LC9320"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9321" data-line-number="9321"></td>
        <td id="LC9321"><span>const</span> <span>char</span>* <span>CEEInfo::getFieldName</span> (CORINFO_FIELD_HANDLE fieldHnd, <span>const</span> <span>char</span>** scopeName)</td>
      </tr>
      <tr>
        <td id="L9322" data-line-number="9322"></td>
        <td id="LC9322">{</td>
      </tr>
      <tr>
        <td id="L9323" data-line-number="9323"></td>
        <td id="LC9323">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9324" data-line-number="9324"></td>
        <td id="LC9324">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9325" data-line-number="9325"></td>
        <td id="LC9325">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9326" data-line-number="9326"></td>
        <td id="LC9326">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9327" data-line-number="9327"></td>
        <td id="LC9327">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9328" data-line-number="9328"></td>
        <td id="LC9328">
</td>
      </tr>
      <tr>
        <td id="L9329" data-line-number="9329"></td>
        <td id="LC9329">    <span>const</span> <span>char</span>* result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9330" data-line-number="9330"></td>
        <td id="LC9330">
</td>
      </tr>
      <tr>
        <td id="L9331" data-line-number="9331"></td>
        <td id="LC9331">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9332" data-line-number="9332"></td>
        <td id="LC9332">
</td>
      </tr>
      <tr>
        <td id="L9333" data-line-number="9333"></td>
        <td id="LC9333">    FieldDesc* field = (FieldDesc*) fieldHnd;</td>
      </tr>
      <tr>
        <td id="L9334" data-line-number="9334"></td>
        <td id="LC9334">    <span>if</span> (scopeName != <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L9335" data-line-number="9335"></td>
        <td id="LC9335">    {</td>
      </tr>
      <tr>
        <td id="L9336" data-line-number="9336"></td>
        <td id="LC9336">        TypeHandle t = <span>TypeHandle</span>(field-&gt;<span>GetApproxEnclosingMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L9337" data-line-number="9337"></td>
        <td id="LC9337">        *scopeName = <span><span>"</span><span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L9338" data-line-number="9338"></td>
        <td id="LC9338">        <span>if</span> (!t.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L9339" data-line-number="9339"></td>
        <td id="LC9339">        {</td>
      </tr>
      <tr>
        <td id="L9340" data-line-number="9340"></td>
        <td id="LC9340">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L9341" data-line-number="9341"></td>
        <td id="LC9341">            t.<span>GetName</span>(ssClsNameBuff);</td>
      </tr>
      <tr>
        <td id="L9342" data-line-number="9342"></td>
        <td id="LC9342">            *scopeName = ssClsNameBuff.<span>GetUTF8</span>(ssClsNameBuffScratch);</td>
      </tr>
      <tr>
        <td id="L9343" data-line-number="9343"></td>
        <td id="LC9343">#<span>else</span> <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L9344" data-line-number="9344"></td>
        <td id="LC9344">            <span><span>//</span> since this is for diagnostic purposes only,</span></td>
      </tr>
      <tr>
        <td id="L9345" data-line-number="9345"></td>
        <td id="LC9345">            <span><span>//</span> give up on the namespace, as we don't have a buffer to concat it</span></td>
      </tr>
      <tr>
        <td id="L9346" data-line-number="9346"></td>
        <td id="LC9346">            <span><span>//</span> also note this won't show array class names.</span></td>
      </tr>
      <tr>
        <td id="L9347" data-line-number="9347"></td>
        <td id="LC9347">            LPCUTF8 nameSpace;</td>
      </tr>
      <tr>
        <td id="L9348" data-line-number="9348"></td>
        <td id="LC9348">            *scopeName= t.<span>GetMethodTable</span>()-&gt;<span>GetFullyQualifiedNameInfo</span>(&amp;nameSpace);</td>
      </tr>
      <tr>
        <td id="L9349" data-line-number="9349"></td>
        <td id="LC9349">#<span>endif</span> <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L9350" data-line-number="9350"></td>
        <td id="LC9350">        }</td>
      </tr>
      <tr>
        <td id="L9351" data-line-number="9351"></td>
        <td id="LC9351">    }</td>
      </tr>
      <tr>
        <td id="L9352" data-line-number="9352"></td>
        <td id="LC9352">
</td>
      </tr>
      <tr>
        <td id="L9353" data-line-number="9353"></td>
        <td id="LC9353">    result = field-&gt;<span>GetName</span>();</td>
      </tr>
      <tr>
        <td id="L9354" data-line-number="9354"></td>
        <td id="LC9354">
</td>
      </tr>
      <tr>
        <td id="L9355" data-line-number="9355"></td>
        <td id="LC9355">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9356" data-line-number="9356"></td>
        <td id="LC9356">
</td>
      </tr>
      <tr>
        <td id="L9357" data-line-number="9357"></td>
        <td id="LC9357">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9358" data-line-number="9358"></td>
        <td id="LC9358">}</td>
      </tr>
      <tr>
        <td id="L9359" data-line-number="9359"></td>
        <td id="LC9359">
</td>
      </tr>
      <tr>
        <td id="L9360" data-line-number="9360"></td>
        <td id="LC9360"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9361" data-line-number="9361"></td>
        <td id="LC9361"><span><span>//</span> Get the type that declares the field</span></td>
      </tr>
      <tr>
        <td id="L9362" data-line-number="9362"></td>
        <td id="LC9362">CORINFO_CLASS_HANDLE <span>CEEInfo::getFieldClass</span> (CORINFO_FIELD_HANDLE fieldHnd)</td>
      </tr>
      <tr>
        <td id="L9363" data-line-number="9363"></td>
        <td id="LC9363">{</td>
      </tr>
      <tr>
        <td id="L9364" data-line-number="9364"></td>
        <td id="LC9364">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9365" data-line-number="9365"></td>
        <td id="LC9365">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L9366" data-line-number="9366"></td>
        <td id="LC9366">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L9367" data-line-number="9367"></td>
        <td id="LC9367">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9368" data-line-number="9368"></td>
        <td id="LC9368">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9369" data-line-number="9369"></td>
        <td id="LC9369">
</td>
      </tr>
      <tr>
        <td id="L9370" data-line-number="9370"></td>
        <td id="LC9370">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9371" data-line-number="9371"></td>
        <td id="LC9371">
</td>
      </tr>
      <tr>
        <td id="L9372" data-line-number="9372"></td>
        <td id="LC9372">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L9373" data-line-number="9373"></td>
        <td id="LC9373">
</td>
      </tr>
      <tr>
        <td id="L9374" data-line-number="9374"></td>
        <td id="LC9374">    FieldDesc* field = (FieldDesc*) fieldHnd;</td>
      </tr>
      <tr>
        <td id="L9375" data-line-number="9375"></td>
        <td id="LC9375">    result = <span>CORINFO_CLASS_HANDLE</span>(field-&gt;<span>GetApproxEnclosingMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L9376" data-line-number="9376"></td>
        <td id="LC9376">
</td>
      </tr>
      <tr>
        <td id="L9377" data-line-number="9377"></td>
        <td id="LC9377">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L9378" data-line-number="9378"></td>
        <td id="LC9378">
</td>
      </tr>
      <tr>
        <td id="L9379" data-line-number="9379"></td>
        <td id="LC9379">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9380" data-line-number="9380"></td>
        <td id="LC9380">}</td>
      </tr>
      <tr>
        <td id="L9381" data-line-number="9381"></td>
        <td id="LC9381">
</td>
      </tr>
      <tr>
        <td id="L9382" data-line-number="9382"></td>
        <td id="LC9382"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9383" data-line-number="9383"></td>
        <td id="LC9383"><span><span>//</span> Returns the basic type of the field (not the the type that declares the field)</span></td>
      </tr>
      <tr>
        <td id="L9384" data-line-number="9384"></td>
        <td id="LC9384"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L9385" data-line-number="9385"></td>
        <td id="LC9385"><span><span>//</span> pTypeHnd - Optional. If not null then on return, for reference and value types,</span></td>
      </tr>
      <tr>
        <td id="L9386" data-line-number="9386"></td>
        <td id="LC9386"><span><span>//</span>            *pTypeHnd will contain the normalized type of the field.</span></td>
      </tr>
      <tr>
        <td id="L9387" data-line-number="9387"></td>
        <td id="LC9387"><span><span>//</span> owner - Optional. For resolving in a generic context</span></td>
      </tr>
      <tr>
        <td id="L9388" data-line-number="9388"></td>
        <td id="LC9388">
</td>
      </tr>
      <tr>
        <td id="L9389" data-line-number="9389"></td>
        <td id="LC9389">CorInfoType <span>CEEInfo::getFieldType</span> (CORINFO_FIELD_HANDLE fieldHnd,</td>
      </tr>
      <tr>
        <td id="L9390" data-line-number="9390"></td>
        <td id="LC9390">                                   CORINFO_CLASS_HANDLE* pTypeHnd,</td>
      </tr>
      <tr>
        <td id="L9391" data-line-number="9391"></td>
        <td id="LC9391">                                   CORINFO_CLASS_HANDLE owner)</td>
      </tr>
      <tr>
        <td id="L9392" data-line-number="9392"></td>
        <td id="LC9392">{</td>
      </tr>
      <tr>
        <td id="L9393" data-line-number="9393"></td>
        <td id="LC9393">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9394" data-line-number="9394"></td>
        <td id="LC9394">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9395" data-line-number="9395"></td>
        <td id="LC9395">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9396" data-line-number="9396"></td>
        <td id="LC9396">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9397" data-line-number="9397"></td>
        <td id="LC9397">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9398" data-line-number="9398"></td>
        <td id="LC9398">
</td>
      </tr>
      <tr>
        <td id="L9399" data-line-number="9399"></td>
        <td id="LC9399">    CorInfoType result = CORINFO_TYPE_UNDEF;</td>
      </tr>
      <tr>
        <td id="L9400" data-line-number="9400"></td>
        <td id="LC9400">
</td>
      </tr>
      <tr>
        <td id="L9401" data-line-number="9401"></td>
        <td id="LC9401">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9402" data-line-number="9402"></td>
        <td id="LC9402">
</td>
      </tr>
      <tr>
        <td id="L9403" data-line-number="9403"></td>
        <td id="LC9403">    result = <span>getFieldTypeInternal</span>(fieldHnd, pTypeHnd, owner);</td>
      </tr>
      <tr>
        <td id="L9404" data-line-number="9404"></td>
        <td id="LC9404">
</td>
      </tr>
      <tr>
        <td id="L9405" data-line-number="9405"></td>
        <td id="LC9405">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9406" data-line-number="9406"></td>
        <td id="LC9406">
</td>
      </tr>
      <tr>
        <td id="L9407" data-line-number="9407"></td>
        <td id="LC9407">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9408" data-line-number="9408"></td>
        <td id="LC9408">}</td>
      </tr>
      <tr>
        <td id="L9409" data-line-number="9409"></td>
        <td id="LC9409">
</td>
      </tr>
      <tr>
        <td id="L9410" data-line-number="9410"></td>
        <td id="LC9410"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9411" data-line-number="9411"></td>
        <td id="LC9411">CorInfoType <span>CEEInfo::getFieldTypeInternal</span> (CORINFO_FIELD_HANDLE fieldHnd,</td>
      </tr>
      <tr>
        <td id="L9412" data-line-number="9412"></td>
        <td id="LC9412">                                           CORINFO_CLASS_HANDLE* pTypeHnd,</td>
      </tr>
      <tr>
        <td id="L9413" data-line-number="9413"></td>
        <td id="LC9413">                                           CORINFO_CLASS_HANDLE owner)</td>
      </tr>
      <tr>
        <td id="L9414" data-line-number="9414"></td>
        <td id="LC9414">{</td>
      </tr>
      <tr>
        <td id="L9415" data-line-number="9415"></td>
        <td id="LC9415">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L9416" data-line-number="9416"></td>
        <td id="LC9416">
</td>
      </tr>
      <tr>
        <td id="L9417" data-line-number="9417"></td>
        <td id="LC9417">    <span>if</span> (pTypeHnd != <span>nullptr</span>)</td>
      </tr>
      <tr>
        <td id="L9418" data-line-number="9418"></td>
        <td id="LC9418">    {</td>
      </tr>
      <tr>
        <td id="L9419" data-line-number="9419"></td>
        <td id="LC9419">        *pTypeHnd = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L9420" data-line-number="9420"></td>
        <td id="LC9420">    }</td>
      </tr>
      <tr>
        <td id="L9421" data-line-number="9421"></td>
        <td id="LC9421">
</td>
      </tr>
      <tr>
        <td id="L9422" data-line-number="9422"></td>
        <td id="LC9422">    TypeHandle clsHnd = <span>TypeHandle</span>();</td>
      </tr>
      <tr>
        <td id="L9423" data-line-number="9423"></td>
        <td id="LC9423">    FieldDesc* field = (FieldDesc*) fieldHnd;</td>
      </tr>
      <tr>
        <td id="L9424" data-line-number="9424"></td>
        <td id="LC9424">    CorElementType type   = field-&gt;<span>GetFieldType</span>();</td>
      </tr>
      <tr>
        <td id="L9425" data-line-number="9425"></td>
        <td id="LC9425">
</td>
      </tr>
      <tr>
        <td id="L9426" data-line-number="9426"></td>
        <td id="LC9426">    <span><span>//</span> &lt;REVISIT_TODO&gt;TODO should not burn the time to do this for anything but Value Classes&lt;/REVISIT_TODO&gt;</span></td>
      </tr>
      <tr>
        <td id="L9427" data-line-number="9427"></td>
        <td id="LC9427">    <span>_ASSERTE</span>(type != ELEMENT_TYPE_BYREF);</td>
      </tr>
      <tr>
        <td id="L9428" data-line-number="9428"></td>
        <td id="LC9428">
</td>
      </tr>
      <tr>
        <td id="L9429" data-line-number="9429"></td>
        <td id="LC9429">    <span>if</span> (type == ELEMENT_TYPE_I)</td>
      </tr>
      <tr>
        <td id="L9430" data-line-number="9430"></td>
        <td id="LC9430">    {</td>
      </tr>
      <tr>
        <td id="L9431" data-line-number="9431"></td>
        <td id="LC9431">        PTR_MethodTable enclosingMethodTable = field-&gt;<span>GetApproxEnclosingMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L9432" data-line-number="9432"></td>
        <td id="LC9432">        <span>if</span> (enclosingMethodTable-&gt;<span>IsByRefLike</span>() &amp;&amp; enclosingMethodTable-&gt;<span>HasSameTypeDefAs</span>(g_pByReferenceClass))</td>
      </tr>
      <tr>
        <td id="L9433" data-line-number="9433"></td>
        <td id="LC9433">        {</td>
      </tr>
      <tr>
        <td id="L9434" data-line-number="9434"></td>
        <td id="LC9434">            <span>_ASSERTE</span>(field-&gt;<span>GetOffset</span>() == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L9435" data-line-number="9435"></td>
        <td id="LC9435">            <span>return</span> CORINFO_TYPE_BYREF;</td>
      </tr>
      <tr>
        <td id="L9436" data-line-number="9436"></td>
        <td id="LC9436">        }</td>
      </tr>
      <tr>
        <td id="L9437" data-line-number="9437"></td>
        <td id="LC9437">    }</td>
      </tr>
      <tr>
        <td id="L9438" data-line-number="9438"></td>
        <td id="LC9438">
</td>
      </tr>
      <tr>
        <td id="L9439" data-line-number="9439"></td>
        <td id="LC9439">    <span>if</span> (!<span>CorTypeInfo::IsPrimitiveType</span>(type))</td>
      </tr>
      <tr>
        <td id="L9440" data-line-number="9440"></td>
        <td id="LC9440">    {</td>
      </tr>
      <tr>
        <td id="L9441" data-line-number="9441"></td>
        <td id="LC9441">        PCCOR_SIGNATURE sig;</td>
      </tr>
      <tr>
        <td id="L9442" data-line-number="9442"></td>
        <td id="LC9442">        DWORD sigCount;</td>
      </tr>
      <tr>
        <td id="L9443" data-line-number="9443"></td>
        <td id="LC9443">        CorCallingConvention conv;</td>
      </tr>
      <tr>
        <td id="L9444" data-line-number="9444"></td>
        <td id="LC9444">
</td>
      </tr>
      <tr>
        <td id="L9445" data-line-number="9445"></td>
        <td id="LC9445">        field-&gt;<span>GetSig</span>(&amp;sig, &amp;sigCount);</td>
      </tr>
      <tr>
        <td id="L9446" data-line-number="9446"></td>
        <td id="LC9446">
</td>
      </tr>
      <tr>
        <td id="L9447" data-line-number="9447"></td>
        <td id="LC9447">        conv = (CorCallingConvention)<span>CorSigUncompressCallingConv</span>(sig);</td>
      </tr>
      <tr>
        <td id="L9448" data-line-number="9448"></td>
        <td id="LC9448">        <span>_ASSERTE</span>(<span>isCallConv</span>(conv, IMAGE_CEE_CS_CALLCONV_FIELD));</td>
      </tr>
      <tr>
        <td id="L9449" data-line-number="9449"></td>
        <td id="LC9449">
</td>
      </tr>
      <tr>
        <td id="L9450" data-line-number="9450"></td>
        <td id="LC9450">        SigPointer <span>ptr</span>(sig, sigCount);</td>
      </tr>
      <tr>
        <td id="L9451" data-line-number="9451"></td>
        <td id="LC9451">
</td>
      </tr>
      <tr>
        <td id="L9452" data-line-number="9452"></td>
        <td id="LC9452">        <span><span>//</span> For verifying code involving generics, use the class instantiation</span></td>
      </tr>
      <tr>
        <td id="L9453" data-line-number="9453"></td>
        <td id="LC9453">        <span><span>//</span> of the optional owner (to provide exact, not representative,</span></td>
      </tr>
      <tr>
        <td id="L9454" data-line-number="9454"></td>
        <td id="LC9454">        <span><span>//</span> type information)</span></td>
      </tr>
      <tr>
        <td id="L9455" data-line-number="9455"></td>
        <td id="LC9455">        SigTypeContext <span>typeContext</span>(field, (TypeHandle)owner);</td>
      </tr>
      <tr>
        <td id="L9456" data-line-number="9456"></td>
        <td id="LC9456">
</td>
      </tr>
      <tr>
        <td id="L9457" data-line-number="9457"></td>
        <td id="LC9457">        clsHnd = ptr.<span>GetTypeHandleThrowing</span>(field-&gt;<span>GetModule</span>(), &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9458" data-line-number="9458"></td>
        <td id="LC9458">        <span>_ASSERTE</span>(!clsHnd.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L9459" data-line-number="9459"></td>
        <td id="LC9459">
</td>
      </tr>
      <tr>
        <td id="L9460" data-line-number="9460"></td>
        <td id="LC9460">        <span><span>//</span> I believe it doesn't make any diff. if this is GetInternalCorElementType</span></td>
      </tr>
      <tr>
        <td id="L9461" data-line-number="9461"></td>
        <td id="LC9461">        <span><span>//</span> or GetSignatureCorElementType.</span></td>
      </tr>
      <tr>
        <td id="L9462" data-line-number="9462"></td>
        <td id="LC9462">        type = clsHnd.<span>GetSignatureCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L9463" data-line-number="9463"></td>
        <td id="LC9463">    }</td>
      </tr>
      <tr>
        <td id="L9464" data-line-number="9464"></td>
        <td id="LC9464">
</td>
      </tr>
      <tr>
        <td id="L9465" data-line-number="9465"></td>
        <td id="LC9465">    <span>return</span> <span>CEEInfo::asCorInfoType</span>(type, clsHnd, pTypeHnd);</td>
      </tr>
      <tr>
        <td id="L9466" data-line-number="9466"></td>
        <td id="LC9466">}</td>
      </tr>
      <tr>
        <td id="L9467" data-line-number="9467"></td>
        <td id="LC9467">
</td>
      </tr>
      <tr>
        <td id="L9468" data-line-number="9468"></td>
        <td id="LC9468"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9469" data-line-number="9469"></td>
        <td id="LC9469"><span>unsigned</span> <span>CEEInfo::getFieldOffset</span> (CORINFO_FIELD_HANDLE fieldHnd)</td>
      </tr>
      <tr>
        <td id="L9470" data-line-number="9470"></td>
        <td id="LC9470">{</td>
      </tr>
      <tr>
        <td id="L9471" data-line-number="9471"></td>
        <td id="LC9471">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9472" data-line-number="9472"></td>
        <td id="LC9472">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9473" data-line-number="9473"></td>
        <td id="LC9473">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9474" data-line-number="9474"></td>
        <td id="LC9474">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9475" data-line-number="9475"></td>
        <td id="LC9475">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9476" data-line-number="9476"></td>
        <td id="LC9476">
</td>
      </tr>
      <tr>
        <td id="L9477" data-line-number="9477"></td>
        <td id="LC9477">    <span>unsigned</span> result = (<span>unsigned</span>) -<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L9478" data-line-number="9478"></td>
        <td id="LC9478">
</td>
      </tr>
      <tr>
        <td id="L9479" data-line-number="9479"></td>
        <td id="LC9479">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9480" data-line-number="9480"></td>
        <td id="LC9480">
</td>
      </tr>
      <tr>
        <td id="L9481" data-line-number="9481"></td>
        <td id="LC9481">    FieldDesc* field = (FieldDesc*) fieldHnd;</td>
      </tr>
      <tr>
        <td id="L9482" data-line-number="9482"></td>
        <td id="LC9482">
</td>
      </tr>
      <tr>
        <td id="L9483" data-line-number="9483"></td>
        <td id="LC9483">    <span><span>//</span> GetOffset() does not include the size of Object</span></td>
      </tr>
      <tr>
        <td id="L9484" data-line-number="9484"></td>
        <td id="LC9484">    result = field-&gt;<span>GetOffset</span>();</td>
      </tr>
      <tr>
        <td id="L9485" data-line-number="9485"></td>
        <td id="LC9485">
</td>
      </tr>
      <tr>
        <td id="L9486" data-line-number="9486"></td>
        <td id="LC9486">    <span><span>//</span> So if it is not a value class, add the Object into it</span></td>
      </tr>
      <tr>
        <td id="L9487" data-line-number="9487"></td>
        <td id="LC9487">    <span>if</span> (field-&gt;<span>IsStatic</span>())</td>
      </tr>
      <tr>
        <td id="L9488" data-line-number="9488"></td>
        <td id="LC9488">    {</td>
      </tr>
      <tr>
        <td id="L9489" data-line-number="9489"></td>
        <td id="LC9489">        Module* pModule = field-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L9490" data-line-number="9490"></td>
        <td id="LC9490">        <span>if</span> (field-&gt;<span>IsRVA</span>() &amp;&amp; pModule-&gt;<span>IsRvaFieldTls</span>(field-&gt;<span>GetOffset</span>()))</td>
      </tr>
      <tr>
        <td id="L9491" data-line-number="9491"></td>
        <td id="LC9491">        {</td>
      </tr>
      <tr>
        <td id="L9492" data-line-number="9492"></td>
        <td id="LC9492">            result = pModule-&gt;<span>GetFieldTlsOffset</span>(field-&gt;<span>GetOffset</span>());</td>
      </tr>
      <tr>
        <td id="L9493" data-line-number="9493"></td>
        <td id="LC9493">        }</td>
      </tr>
      <tr>
        <td id="L9494" data-line-number="9494"></td>
        <td id="LC9494">    }</td>
      </tr>
      <tr>
        <td id="L9495" data-line-number="9495"></td>
        <td id="LC9495">    <span>else</span> <span>if</span> (!field-&gt;<span>GetApproxEnclosingMethodTable</span>()-&gt;<span>IsValueType</span>())</td>
      </tr>
      <tr>
        <td id="L9496" data-line-number="9496"></td>
        <td id="LC9496">    {</td>
      </tr>
      <tr>
        <td id="L9497" data-line-number="9497"></td>
        <td id="LC9497">        result += OBJECT_SIZE;</td>
      </tr>
      <tr>
        <td id="L9498" data-line-number="9498"></td>
        <td id="LC9498">    }</td>
      </tr>
      <tr>
        <td id="L9499" data-line-number="9499"></td>
        <td id="LC9499">
</td>
      </tr>
      <tr>
        <td id="L9500" data-line-number="9500"></td>
        <td id="LC9500">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9501" data-line-number="9501"></td>
        <td id="LC9501">
</td>
      </tr>
      <tr>
        <td id="L9502" data-line-number="9502"></td>
        <td id="LC9502">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9503" data-line-number="9503"></td>
        <td id="LC9503">}</td>
      </tr>
      <tr>
        <td id="L9504" data-line-number="9504"></td>
        <td id="LC9504">
</td>
      </tr>
      <tr>
        <td id="L9505" data-line-number="9505"></td>
        <td id="LC9505"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9506" data-line-number="9506"></td>
        <td id="LC9506"><span>bool</span> <span>CEEInfo::isWriteBarrierHelperRequired</span>(CORINFO_FIELD_HANDLE field)</td>
      </tr>
      <tr>
        <td id="L9507" data-line-number="9507"></td>
        <td id="LC9507">{</td>
      </tr>
      <tr>
        <td id="L9508" data-line-number="9508"></td>
        <td id="LC9508">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9509" data-line-number="9509"></td>
        <td id="LC9509">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9510" data-line-number="9510"></td>
        <td id="LC9510">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9511" data-line-number="9511"></td>
        <td id="LC9511">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9512" data-line-number="9512"></td>
        <td id="LC9512">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9513" data-line-number="9513"></td>
        <td id="LC9513">
</td>
      </tr>
      <tr>
        <td id="L9514" data-line-number="9514"></td>
        <td id="LC9514">    <span>bool</span> <span>fHelperRequired</span> = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L9515" data-line-number="9515"></td>
        <td id="LC9515">
</td>
      </tr>
      <tr>
        <td id="L9516" data-line-number="9516"></td>
        <td id="LC9516">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9517" data-line-number="9517"></td>
        <td id="LC9517">
</td>
      </tr>
      <tr>
        <td id="L9518" data-line-number="9518"></td>
        <td id="LC9518">    FieldDesc * pField = (FieldDesc *)field;</td>
      </tr>
      <tr>
        <td id="L9519" data-line-number="9519"></td>
        <td id="LC9519">
</td>
      </tr>
      <tr>
        <td id="L9520" data-line-number="9520"></td>
        <td id="LC9520">    <span><span>//</span> TODO: jit64 should be switched to the same plan as the i386 jits - use</span></td>
      </tr>
      <tr>
        <td id="L9521" data-line-number="9521"></td>
        <td id="LC9521">    <span><span>//</span> getClassGClayout to figure out the need for writebarrier helper, and inline the copying.</span></td>
      </tr>
      <tr>
        <td id="L9522" data-line-number="9522"></td>
        <td id="LC9522">    <span><span>//</span> Once this happens, USE_WRITE_BARRIER_HELPERS and CORINFO_FLG_WRITE_BARRIER_HELPER can be removed.</span></td>
      </tr>
      <tr>
        <td id="L9523" data-line-number="9523"></td>
        <td id="LC9523">    CorElementType type = pField-&gt;<span>GetFieldType</span>();</td>
      </tr>
      <tr>
        <td id="L9524" data-line-number="9524"></td>
        <td id="LC9524">
</td>
      </tr>
      <tr>
        <td id="L9525" data-line-number="9525"></td>
        <td id="LC9525">    <span>if</span>(<span>CorTypeInfo::IsObjRef</span>(type))</td>
      </tr>
      <tr>
        <td id="L9526" data-line-number="9526"></td>
        <td id="LC9526">        <span>fHelperRequired</span> = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L9527" data-line-number="9527"></td>
        <td id="LC9527">    <span>else</span> <span>if</span> (type == ELEMENT_TYPE_VALUETYPE)</td>
      </tr>
      <tr>
        <td id="L9528" data-line-number="9528"></td>
        <td id="LC9528">    {</td>
      </tr>
      <tr>
        <td id="L9529" data-line-number="9529"></td>
        <td id="LC9529">        TypeHandle th = pField-&gt;<span>GetFieldTypeHandleThrowing</span>();</td>
      </tr>
      <tr>
        <td id="L9530" data-line-number="9530"></td>
        <td id="LC9530">        <span>_ASSERTE</span>(!th.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L9531" data-line-number="9531"></td>
        <td id="LC9531">        <span>if</span>(th.<span>GetMethodTable</span>()-&gt;<span>ContainsPointers</span>())</td>
      </tr>
      <tr>
        <td id="L9532" data-line-number="9532"></td>
        <td id="LC9532">            <span>fHelperRequired</span> = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L9533" data-line-number="9533"></td>
        <td id="LC9533">    }</td>
      </tr>
      <tr>
        <td id="L9534" data-line-number="9534"></td>
        <td id="LC9534">
</td>
      </tr>
      <tr>
        <td id="L9535" data-line-number="9535"></td>
        <td id="LC9535">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9536" data-line-number="9536"></td>
        <td id="LC9536">
</td>
      </tr>
      <tr>
        <td id="L9537" data-line-number="9537"></td>
        <td id="LC9537">    <span>return</span> <span>fHelperRequired</span>;</td>
      </tr>
      <tr>
        <td id="L9538" data-line-number="9538"></td>
        <td id="LC9538">}</td>
      </tr>
      <tr>
        <td id="L9539" data-line-number="9539"></td>
        <td id="LC9539">
</td>
      </tr>
      <tr>
        <td id="L9540" data-line-number="9540"></td>
        <td id="LC9540"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9541" data-line-number="9541"></td>
        <td id="LC9541">DWORD <span>CEEInfo::getFieldThreadLocalStoreID</span>(CORINFO_FIELD_HANDLE fieldHnd, <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L9542" data-line-number="9542"></td>
        <td id="LC9542">{</td>
      </tr>
      <tr>
        <td id="L9543" data-line-number="9543"></td>
        <td id="LC9543">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9544" data-line-number="9544"></td>
        <td id="LC9544">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9545" data-line-number="9545"></td>
        <td id="LC9545">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9546" data-line-number="9546"></td>
        <td id="LC9546">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9547" data-line-number="9547"></td>
        <td id="LC9547">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9548" data-line-number="9548"></td>
        <td id="LC9548">
</td>
      </tr>
      <tr>
        <td id="L9549" data-line-number="9549"></td>
        <td id="LC9549">    DWORD result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L9550" data-line-number="9550"></td>
        <td id="LC9550">
</td>
      </tr>
      <tr>
        <td id="L9551" data-line-number="9551"></td>
        <td id="LC9551">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L9552" data-line-number="9552"></td>
        <td id="LC9552">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9553" data-line-number="9553"></td>
        <td id="LC9553">
</td>
      </tr>
      <tr>
        <td id="L9554" data-line-number="9554"></td>
        <td id="LC9554">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9555" data-line-number="9555"></td>
        <td id="LC9555">
</td>
      </tr>
      <tr>
        <td id="L9556" data-line-number="9556"></td>
        <td id="LC9556">    FieldDesc* field = (FieldDesc*) fieldHnd;</td>
      </tr>
      <tr>
        <td id="L9557" data-line-number="9557"></td>
        <td id="LC9557">    Module* module = field-&gt;<span>GetModule</span>();</td>
      </tr>
      <tr>
        <td id="L9558" data-line-number="9558"></td>
        <td id="LC9558">
</td>
      </tr>
      <tr>
        <td id="L9559" data-line-number="9559"></td>
        <td id="LC9559">    <span>_ASSERTE</span>(field-&gt;<span>IsRVA</span>());       <span><span>//</span> Only RVA statics can be thread local</span></td>
      </tr>
      <tr>
        <td id="L9560" data-line-number="9560"></td>
        <td id="LC9560">    <span>_ASSERTE</span>(module-&gt;<span>IsRvaFieldTls</span>(field-&gt;<span>GetOffset</span>()));</td>
      </tr>
      <tr>
        <td id="L9561" data-line-number="9561"></td>
        <td id="LC9561">
</td>
      </tr>
      <tr>
        <td id="L9562" data-line-number="9562"></td>
        <td id="LC9562">    result = module-&gt;<span>GetTlsIndex</span>();</td>
      </tr>
      <tr>
        <td id="L9563" data-line-number="9563"></td>
        <td id="LC9563">
</td>
      </tr>
      <tr>
        <td id="L9564" data-line-number="9564"></td>
        <td id="LC9564">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9565" data-line-number="9565"></td>
        <td id="LC9565">
</td>
      </tr>
      <tr>
        <td id="L9566" data-line-number="9566"></td>
        <td id="LC9566">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9567" data-line-number="9567"></td>
        <td id="LC9567">}</td>
      </tr>
      <tr>
        <td id="L9568" data-line-number="9568"></td>
        <td id="LC9568">
</td>
      </tr>
      <tr>
        <td id="L9569" data-line-number="9569"></td>
        <td id="LC9569"><span>void</span> *<span>CEEInfo::allocateArray</span>(ULONG cBytes)</td>
      </tr>
      <tr>
        <td id="L9570" data-line-number="9570"></td>
        <td id="LC9570">{</td>
      </tr>
      <tr>
        <td id="L9571" data-line-number="9571"></td>
        <td id="LC9571">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9572" data-line-number="9572"></td>
        <td id="LC9572">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9573" data-line-number="9573"></td>
        <td id="LC9573">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9574" data-line-number="9574"></td>
        <td id="LC9574">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9575" data-line-number="9575"></td>
        <td id="LC9575">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9576" data-line-number="9576"></td>
        <td id="LC9576">
</td>
      </tr>
      <tr>
        <td id="L9577" data-line-number="9577"></td>
        <td id="LC9577">    <span>void</span> * result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9578" data-line-number="9578"></td>
        <td id="LC9578">
</td>
      </tr>
      <tr>
        <td id="L9579" data-line-number="9579"></td>
        <td id="LC9579">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9580" data-line-number="9580"></td>
        <td id="LC9580">
</td>
      </tr>
      <tr>
        <td id="L9581" data-line-number="9581"></td>
        <td id="LC9581">    result = <span>new</span> BYTE [cBytes];</td>
      </tr>
      <tr>
        <td id="L9582" data-line-number="9582"></td>
        <td id="LC9582">
</td>
      </tr>
      <tr>
        <td id="L9583" data-line-number="9583"></td>
        <td id="LC9583">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9584" data-line-number="9584"></td>
        <td id="LC9584">
</td>
      </tr>
      <tr>
        <td id="L9585" data-line-number="9585"></td>
        <td id="LC9585">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9586" data-line-number="9586"></td>
        <td id="LC9586">}</td>
      </tr>
      <tr>
        <td id="L9587" data-line-number="9587"></td>
        <td id="LC9587">
</td>
      </tr>
      <tr>
        <td id="L9588" data-line-number="9588"></td>
        <td id="LC9588"><span>void</span> <span>CEEInfo::freeArray</span>(<span>void</span> *array)</td>
      </tr>
      <tr>
        <td id="L9589" data-line-number="9589"></td>
        <td id="LC9589">{</td>
      </tr>
      <tr>
        <td id="L9590" data-line-number="9590"></td>
        <td id="LC9590">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9591" data-line-number="9591"></td>
        <td id="LC9591">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9592" data-line-number="9592"></td>
        <td id="LC9592">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9593" data-line-number="9593"></td>
        <td id="LC9593">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9594" data-line-number="9594"></td>
        <td id="LC9594">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9595" data-line-number="9595"></td>
        <td id="LC9595">
</td>
      </tr>
      <tr>
        <td id="L9596" data-line-number="9596"></td>
        <td id="LC9596">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9597" data-line-number="9597"></td>
        <td id="LC9597">
</td>
      </tr>
      <tr>
        <td id="L9598" data-line-number="9598"></td>
        <td id="LC9598">    <span>delete []</span> ((BYTE*) array);</td>
      </tr>
      <tr>
        <td id="L9599" data-line-number="9599"></td>
        <td id="LC9599">
</td>
      </tr>
      <tr>
        <td id="L9600" data-line-number="9600"></td>
        <td id="LC9600">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9601" data-line-number="9601"></td>
        <td id="LC9601">}</td>
      </tr>
      <tr>
        <td id="L9602" data-line-number="9602"></td>
        <td id="LC9602">
</td>
      </tr>
      <tr>
        <td id="L9603" data-line-number="9603"></td>
        <td id="LC9603"><span>void</span> <span>CEEInfo::getBoundaries</span>(CORINFO_METHOD_HANDLE ftn,</td>
      </tr>
      <tr>
        <td id="L9604" data-line-number="9604"></td>
        <td id="LC9604">                               <span>unsigned</span> <span>int</span> *cILOffsets, DWORD **pILOffsets,</td>
      </tr>
      <tr>
        <td id="L9605" data-line-number="9605"></td>
        <td id="LC9605">                               ICorDebugInfo::BoundaryTypes *implicitBoundaries)</td>
      </tr>
      <tr>
        <td id="L9606" data-line-number="9606"></td>
        <td id="LC9606">{</td>
      </tr>
      <tr>
        <td id="L9607" data-line-number="9607"></td>
        <td id="LC9607">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9608" data-line-number="9608"></td>
        <td id="LC9608">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9609" data-line-number="9609"></td>
        <td id="LC9609">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9610" data-line-number="9610"></td>
        <td id="LC9610">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9611" data-line-number="9611"></td>
        <td id="LC9611">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9612" data-line-number="9612"></td>
        <td id="LC9612">
</td>
      </tr>
      <tr>
        <td id="L9613" data-line-number="9613"></td>
        <td id="LC9613">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9614" data-line-number="9614"></td>
        <td id="LC9614">
</td>
      </tr>
      <tr>
        <td id="L9615" data-line-number="9615"></td>
        <td id="LC9615">#<span>ifdef</span> DEBUGGING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L9616" data-line-number="9616"></td>
        <td id="LC9616">    <span>if</span> (g_pDebugInterface &amp;&amp; !<span>IsCompilationProcess</span>())</td>
      </tr>
      <tr>
        <td id="L9617" data-line-number="9617"></td>
        <td id="LC9617">    {</td>
      </tr>
      <tr>
        <td id="L9618" data-line-number="9618"></td>
        <td id="LC9618">        g_pDebugInterface-&gt;<span>getBoundaries</span>(<span>GetMethod</span>(ftn), cILOffsets, pILOffsets,</td>
      </tr>
      <tr>
        <td id="L9619" data-line-number="9619"></td>
        <td id="LC9619">                                     implicitBoundaries);</td>
      </tr>
      <tr>
        <td id="L9620" data-line-number="9620"></td>
        <td id="LC9620">    }</td>
      </tr>
      <tr>
        <td id="L9621" data-line-number="9621"></td>
        <td id="LC9621">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L9622" data-line-number="9622"></td>
        <td id="LC9622">    {</td>
      </tr>
      <tr>
        <td id="L9623" data-line-number="9623"></td>
        <td id="LC9623">        *cILOffsets = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L9624" data-line-number="9624"></td>
        <td id="LC9624">        *pILOffsets = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9625" data-line-number="9625"></td>
        <td id="LC9625">        *implicitBoundaries = ICorDebugInfo::DEFAULT_BOUNDARIES;</td>
      </tr>
      <tr>
        <td id="L9626" data-line-number="9626"></td>
        <td id="LC9626">    }</td>
      </tr>
      <tr>
        <td id="L9627" data-line-number="9627"></td>
        <td id="LC9627">#<span>endif</span> <span><span>//</span> DEBUGGING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L9628" data-line-number="9628"></td>
        <td id="LC9628">
</td>
      </tr>
      <tr>
        <td id="L9629" data-line-number="9629"></td>
        <td id="LC9629">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9630" data-line-number="9630"></td>
        <td id="LC9630">}</td>
      </tr>
      <tr>
        <td id="L9631" data-line-number="9631"></td>
        <td id="LC9631">
</td>
      </tr>
      <tr>
        <td id="L9632" data-line-number="9632"></td>
        <td id="LC9632"><span>void</span> <span>CEEInfo::getVars</span>(CORINFO_METHOD_HANDLE ftn, ULONG32 *cVars, ICorDebugInfo::ILVarInfo **vars,</td>
      </tr>
      <tr>
        <td id="L9633" data-line-number="9633"></td>
        <td id="LC9633">                         <span>bool</span> *extendOthers)</td>
      </tr>
      <tr>
        <td id="L9634" data-line-number="9634"></td>
        <td id="LC9634">{</td>
      </tr>
      <tr>
        <td id="L9635" data-line-number="9635"></td>
        <td id="LC9635">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9636" data-line-number="9636"></td>
        <td id="LC9636">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9637" data-line-number="9637"></td>
        <td id="LC9637">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9638" data-line-number="9638"></td>
        <td id="LC9638">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9639" data-line-number="9639"></td>
        <td id="LC9639">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9640" data-line-number="9640"></td>
        <td id="LC9640">
</td>
      </tr>
      <tr>
        <td id="L9641" data-line-number="9641"></td>
        <td id="LC9641">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9642" data-line-number="9642"></td>
        <td id="LC9642">
</td>
      </tr>
      <tr>
        <td id="L9643" data-line-number="9643"></td>
        <td id="LC9643">#<span>ifdef</span> DEBUGGING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L9644" data-line-number="9644"></td>
        <td id="LC9644">    <span>if</span> (g_pDebugInterface &amp;&amp; !<span>IsCompilationProcess</span>())</td>
      </tr>
      <tr>
        <td id="L9645" data-line-number="9645"></td>
        <td id="LC9645">    {</td>
      </tr>
      <tr>
        <td id="L9646" data-line-number="9646"></td>
        <td id="LC9646">        g_pDebugInterface-&gt;<span>getVars</span>(<span>GetMethod</span>(ftn), cVars, vars, extendOthers);</td>
      </tr>
      <tr>
        <td id="L9647" data-line-number="9647"></td>
        <td id="LC9647">    }</td>
      </tr>
      <tr>
        <td id="L9648" data-line-number="9648"></td>
        <td id="LC9648">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L9649" data-line-number="9649"></td>
        <td id="LC9649">    {</td>
      </tr>
      <tr>
        <td id="L9650" data-line-number="9650"></td>
        <td id="LC9650">        *cVars = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L9651" data-line-number="9651"></td>
        <td id="LC9651">        *vars = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9652" data-line-number="9652"></td>
        <td id="LC9652">
</td>
      </tr>
      <tr>
        <td id="L9653" data-line-number="9653"></td>
        <td id="LC9653">        <span><span>//</span> Just tell the JIT to extend everything.</span></td>
      </tr>
      <tr>
        <td id="L9654" data-line-number="9654"></td>
        <td id="LC9654">        *extendOthers = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L9655" data-line-number="9655"></td>
        <td id="LC9655">    }</td>
      </tr>
      <tr>
        <td id="L9656" data-line-number="9656"></td>
        <td id="LC9656">#<span>endif</span> <span><span>//</span> DEBUGGING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L9657" data-line-number="9657"></td>
        <td id="LC9657">
</td>
      </tr>
      <tr>
        <td id="L9658" data-line-number="9658"></td>
        <td id="LC9658">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9659" data-line-number="9659"></td>
        <td id="LC9659">}</td>
      </tr>
      <tr>
        <td id="L9660" data-line-number="9660"></td>
        <td id="LC9660">
</td>
      </tr>
      <tr>
        <td id="L9661" data-line-number="9661"></td>
        <td id="LC9661"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9662" data-line-number="9662"></td>
        <td id="LC9662">CORINFO_ARG_LIST_HANDLE <span>CEEInfo::getArgNext</span>(CORINFO_ARG_LIST_HANDLE args)</td>
      </tr>
      <tr>
        <td id="L9663" data-line-number="9663"></td>
        <td id="LC9663">{</td>
      </tr>
      <tr>
        <td id="L9664" data-line-number="9664"></td>
        <td id="LC9664">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9665" data-line-number="9665"></td>
        <td id="LC9665">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9666" data-line-number="9666"></td>
        <td id="LC9666">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9667" data-line-number="9667"></td>
        <td id="LC9667">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9668" data-line-number="9668"></td>
        <td id="LC9668">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9669" data-line-number="9669"></td>
        <td id="LC9669">
</td>
      </tr>
      <tr>
        <td id="L9670" data-line-number="9670"></td>
        <td id="LC9670">    CORINFO_ARG_LIST_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9671" data-line-number="9671"></td>
        <td id="LC9671">
</td>
      </tr>
      <tr>
        <td id="L9672" data-line-number="9672"></td>
        <td id="LC9672">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9673" data-line-number="9673"></td>
        <td id="LC9673">
</td>
      </tr>
      <tr>
        <td id="L9674" data-line-number="9674"></td>
        <td id="LC9674">    SigPointer <span>ptr</span>((<span>unsigned</span> __int8*) args);</td>
      </tr>
      <tr>
        <td id="L9675" data-line-number="9675"></td>
        <td id="LC9675">    <span>IfFailThrow</span>(ptr.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L9676" data-line-number="9676"></td>
        <td id="LC9676">
</td>
      </tr>
      <tr>
        <td id="L9677" data-line-number="9677"></td>
        <td id="LC9677">    result = (CORINFO_ARG_LIST_HANDLE) ptr.<span>GetPtr</span>();</td>
      </tr>
      <tr>
        <td id="L9678" data-line-number="9678"></td>
        <td id="LC9678">
</td>
      </tr>
      <tr>
        <td id="L9679" data-line-number="9679"></td>
        <td id="LC9679">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9680" data-line-number="9680"></td>
        <td id="LC9680">
</td>
      </tr>
      <tr>
        <td id="L9681" data-line-number="9681"></td>
        <td id="LC9681">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9682" data-line-number="9682"></td>
        <td id="LC9682">}</td>
      </tr>
      <tr>
        <td id="L9683" data-line-number="9683"></td>
        <td id="LC9683">
</td>
      </tr>
      <tr>
        <td id="L9684" data-line-number="9684"></td>
        <td id="LC9684">
</td>
      </tr>
      <tr>
        <td id="L9685" data-line-number="9685"></td>
        <td id="LC9685"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9686" data-line-number="9686"></td>
        <td id="LC9686">
</td>
      </tr>
      <tr>
        <td id="L9687" data-line-number="9687"></td>
        <td id="LC9687">CorInfoTypeWithMod <span>CEEInfo::getArgType</span> (</td>
      </tr>
      <tr>
        <td id="L9688" data-line-number="9688"></td>
        <td id="LC9688">        CORINFO_SIG_INFO*       sig,</td>
      </tr>
      <tr>
        <td id="L9689" data-line-number="9689"></td>
        <td id="LC9689">        CORINFO_ARG_LIST_HANDLE args,</td>
      </tr>
      <tr>
        <td id="L9690" data-line-number="9690"></td>
        <td id="LC9690">        CORINFO_CLASS_HANDLE*   vcTypeRet</td>
      </tr>
      <tr>
        <td id="L9691" data-line-number="9691"></td>
        <td id="LC9691">        )</td>
      </tr>
      <tr>
        <td id="L9692" data-line-number="9692"></td>
        <td id="LC9692">{</td>
      </tr>
      <tr>
        <td id="L9693" data-line-number="9693"></td>
        <td id="LC9693">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9694" data-line-number="9694"></td>
        <td id="LC9694">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9695" data-line-number="9695"></td>
        <td id="LC9695">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9696" data-line-number="9696"></td>
        <td id="LC9696">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9697" data-line-number="9697"></td>
        <td id="LC9697">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9698" data-line-number="9698"></td>
        <td id="LC9698">
</td>
      </tr>
      <tr>
        <td id="L9699" data-line-number="9699"></td>
        <td id="LC9699">    CorInfoTypeWithMod result = <span>CorInfoTypeWithMod</span>(CORINFO_TYPE_UNDEF);</td>
      </tr>
      <tr>
        <td id="L9700" data-line-number="9700"></td>
        <td id="LC9700">
</td>
      </tr>
      <tr>
        <td id="L9701" data-line-number="9701"></td>
        <td id="LC9701">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9702" data-line-number="9702"></td>
        <td id="LC9702">
</td>
      </tr>
      <tr>
        <td id="L9703" data-line-number="9703"></td>
        <td id="LC9703">   <span>_ASSERTE</span>((BYTE*) sig-&gt;<span>pSig</span> &lt;= (BYTE*) sig-&gt;<span>args</span> &amp;&amp; (BYTE*) args &lt; (BYTE*) sig-&gt;<span>pSig</span> + sig-&gt;<span>cbSig</span>);</td>
      </tr>
      <tr>
        <td id="L9704" data-line-number="9704"></td>
        <td id="LC9704">   <span>_ASSERTE</span>((BYTE*) sig-&gt;<span>args</span> &lt;= (BYTE*) args);</td>
      </tr>
      <tr>
        <td id="L9705" data-line-number="9705"></td>
        <td id="LC9705">    <span>INDEBUG</span>(*vcTypeRet = <span>CORINFO_CLASS_HANDLE</span>((<span>size_t</span>)INVALID_POINTER_CC));</td>
      </tr>
      <tr>
        <td id="L9706" data-line-number="9706"></td>
        <td id="LC9706">
</td>
      </tr>
      <tr>
        <td id="L9707" data-line-number="9707"></td>
        <td id="LC9707">    SigPointer <span>ptr</span>((<span>unsigned</span> __int8*) args);</td>
      </tr>
      <tr>
        <td id="L9708" data-line-number="9708"></td>
        <td id="LC9708">    CorElementType eType;</td>
      </tr>
      <tr>
        <td id="L9709" data-line-number="9709"></td>
        <td id="LC9709">    <span>IfFailThrow</span>(ptr.<span>PeekElemType</span>(&amp;eType));</td>
      </tr>
      <tr>
        <td id="L9710" data-line-number="9710"></td>
        <td id="LC9710">    <span>while</span> (eType == ELEMENT_TYPE_PINNED)</td>
      </tr>
      <tr>
        <td id="L9711" data-line-number="9711"></td>
        <td id="LC9711">    {</td>
      </tr>
      <tr>
        <td id="L9712" data-line-number="9712"></td>
        <td id="LC9712">        result = CORINFO_TYPE_MOD_PINNED;</td>
      </tr>
      <tr>
        <td id="L9713" data-line-number="9713"></td>
        <td id="LC9713">        <span>IfFailThrow</span>(ptr.<span>GetElemType</span>(<span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L9714" data-line-number="9714"></td>
        <td id="LC9714">        <span>IfFailThrow</span>(ptr.<span>PeekElemType</span>(&amp;eType));</td>
      </tr>
      <tr>
        <td id="L9715" data-line-number="9715"></td>
        <td id="LC9715">    }</td>
      </tr>
      <tr>
        <td id="L9716" data-line-number="9716"></td>
        <td id="LC9716">
</td>
      </tr>
      <tr>
        <td id="L9717" data-line-number="9717"></td>
        <td id="LC9717">    <span><span>//</span> Now read off the "real" element type after taking any instantiations into consideration</span></td>
      </tr>
      <tr>
        <td id="L9718" data-line-number="9718"></td>
        <td id="LC9718">    SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L9719" data-line-number="9719"></td>
        <td id="LC9719">    <span>GetTypeContext</span>(&amp;sig-&gt;<span>sigInst</span>,&amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9720" data-line-number="9720"></td>
        <td id="LC9720">
</td>
      </tr>
      <tr>
        <td id="L9721" data-line-number="9721"></td>
        <td id="LC9721">    Module* pModule = <span>GetModule</span>(sig-&gt;<span>scope</span>);</td>
      </tr>
      <tr>
        <td id="L9722" data-line-number="9722"></td>
        <td id="LC9722">
</td>
      </tr>
      <tr>
        <td id="L9723" data-line-number="9723"></td>
        <td id="LC9723">    CorElementType type = ptr.<span>PeekElemTypeClosed</span>(pModule, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9724" data-line-number="9724"></td>
        <td id="LC9724">
</td>
      </tr>
      <tr>
        <td id="L9725" data-line-number="9725"></td>
        <td id="LC9725">    TypeHandle typeHnd = <span>TypeHandle</span>();</td>
      </tr>
      <tr>
        <td id="L9726" data-line-number="9726"></td>
        <td id="LC9726">    <span>switch</span> (type) {</td>
      </tr>
      <tr>
        <td id="L9727" data-line-number="9727"></td>
        <td id="LC9727">      <span>case</span> ELEMENT_TYPE_VAR :</td>
      </tr>
      <tr>
        <td id="L9728" data-line-number="9728"></td>
        <td id="LC9728">      <span>case</span> ELEMENT_TYPE_MVAR :</td>
      </tr>
      <tr>
        <td id="L9729" data-line-number="9729"></td>
        <td id="LC9729">      <span>case</span> ELEMENT_TYPE_VALUETYPE :</td>
      </tr>
      <tr>
        <td id="L9730" data-line-number="9730"></td>
        <td id="LC9730">      <span>case</span> ELEMENT_TYPE_TYPEDBYREF :</td>
      </tr>
      <tr>
        <td id="L9731" data-line-number="9731"></td>
        <td id="LC9731">      <span>case</span> ELEMENT_TYPE_INTERNAL :</td>
      </tr>
      <tr>
        <td id="L9732" data-line-number="9732"></td>
        <td id="LC9732">      {</td>
      </tr>
      <tr>
        <td id="L9733" data-line-number="9733"></td>
        <td id="LC9733">            typeHnd = ptr.<span>GetTypeHandleThrowing</span>(pModule, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9734" data-line-number="9734"></td>
        <td id="LC9734">            <span>_ASSERTE</span>(!typeHnd.<span>IsNull</span>());</td>
      </tr>
      <tr>
        <td id="L9735" data-line-number="9735"></td>
        <td id="LC9735">
</td>
      </tr>
      <tr>
        <td id="L9736" data-line-number="9736"></td>
        <td id="LC9736">            CorElementType normType = typeHnd.<span>GetInternalCorElementType</span>();</td>
      </tr>
      <tr>
        <td id="L9737" data-line-number="9737"></td>
        <td id="LC9737">
</td>
      </tr>
      <tr>
        <td id="L9738" data-line-number="9738"></td>
        <td id="LC9738">            <span><span>//</span> if we are looking up a value class, don't morph it to a refernece type</span></td>
      </tr>
      <tr>
        <td id="L9739" data-line-number="9739"></td>
        <td id="LC9739">            <span><span>//</span> (This can only happen in illegal IL)</span></td>
      </tr>
      <tr>
        <td id="L9740" data-line-number="9740"></td>
        <td id="LC9740">            <span>if</span> (!<span>CorTypeInfo::IsObjRef</span>(normType) || type != ELEMENT_TYPE_VALUETYPE)</td>
      </tr>
      <tr>
        <td id="L9741" data-line-number="9741"></td>
        <td id="LC9741">            {</td>
      </tr>
      <tr>
        <td id="L9742" data-line-number="9742"></td>
        <td id="LC9742">                type = normType;</td>
      </tr>
      <tr>
        <td id="L9743" data-line-number="9743"></td>
        <td id="LC9743">            }</td>
      </tr>
      <tr>
        <td id="L9744" data-line-number="9744"></td>
        <td id="LC9744">        }</td>
      </tr>
      <tr>
        <td id="L9745" data-line-number="9745"></td>
        <td id="LC9745">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9746" data-line-number="9746"></td>
        <td id="LC9746">
</td>
      </tr>
      <tr>
        <td id="L9747" data-line-number="9747"></td>
        <td id="LC9747">    <span>case</span> ELEMENT_TYPE_PTR:</td>
      </tr>
      <tr>
        <td id="L9748" data-line-number="9748"></td>
        <td id="LC9748">        <span><span>//</span> Load the type eagerly under debugger to make the eval work</span></td>
      </tr>
      <tr>
        <td id="L9749" data-line-number="9749"></td>
        <td id="LC9749">        <span>if</span> (!<span>isVerifyOnly</span>() &amp;&amp; <span>CORDisableJITOptimizations</span>(pModule-&gt;<span>GetDebuggerInfoBits</span>()))</td>
      </tr>
      <tr>
        <td id="L9750" data-line-number="9750"></td>
        <td id="LC9750">        {</td>
      </tr>
      <tr>
        <td id="L9751" data-line-number="9751"></td>
        <td id="LC9751">            <span><span>//</span> NOTE: in some IJW cases, when the type pointed at is unmanaged,</span></td>
      </tr>
      <tr>
        <td id="L9752" data-line-number="9752"></td>
        <td id="LC9752">            <span><span>//</span> the GetTypeHandle may fail, because there is no TypeDef for such type.</span></td>
      </tr>
      <tr>
        <td id="L9753" data-line-number="9753"></td>
        <td id="LC9753">            <span><span>//</span> Usage of GetTypeHandleThrowing would lead to class load exception</span></td>
      </tr>
      <tr>
        <td id="L9754" data-line-number="9754"></td>
        <td id="LC9754">            TypeHandle thPtr = ptr.<span>GetTypeHandleNT</span>(pModule, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9755" data-line-number="9755"></td>
        <td id="LC9755">            <span>if</span>(!thPtr.<span>IsNull</span>())</td>
      </tr>
      <tr>
        <td id="L9756" data-line-number="9756"></td>
        <td id="LC9756">            {</td>
      </tr>
      <tr>
        <td id="L9757" data-line-number="9757"></td>
        <td id="LC9757">                m_pOverride-&gt;<span>classMustBeLoadedBeforeCodeIsRun</span>(<span>CORINFO_CLASS_HANDLE</span>(thPtr.<span>AsPtr</span>()));</td>
      </tr>
      <tr>
        <td id="L9758" data-line-number="9758"></td>
        <td id="LC9758">            }</td>
      </tr>
      <tr>
        <td id="L9759" data-line-number="9759"></td>
        <td id="LC9759">        }</td>
      </tr>
      <tr>
        <td id="L9760" data-line-number="9760"></td>
        <td id="LC9760">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9761" data-line-number="9761"></td>
        <td id="LC9761">
</td>
      </tr>
      <tr>
        <td id="L9762" data-line-number="9762"></td>
        <td id="LC9762">    <span>case</span> ELEMENT_TYPE_VOID:</td>
      </tr>
      <tr>
        <td id="L9763" data-line-number="9763"></td>
        <td id="LC9763">        <span><span>//</span> void is not valid in local sigs</span></td>
      </tr>
      <tr>
        <td id="L9764" data-line-number="9764"></td>
        <td id="LC9764">        <span>if</span> (sig-&gt;<span>flags</span> &amp; CORINFO_SIGFLAG_IS_LOCAL_SIG)</td>
      </tr>
      <tr>
        <td id="L9765" data-line-number="9765"></td>
        <td id="LC9765">            <span>COMPlusThrowHR</span>(COR_E_INVALIDPROGRAM);</td>
      </tr>
      <tr>
        <td id="L9766" data-line-number="9766"></td>
        <td id="LC9766">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9767" data-line-number="9767"></td>
        <td id="LC9767">
</td>
      </tr>
      <tr>
        <td id="L9768" data-line-number="9768"></td>
        <td id="LC9768">    <span>case</span> ELEMENT_TYPE_END:</td>
      </tr>
      <tr>
        <td id="L9769" data-line-number="9769"></td>
        <td id="LC9769">           <span>COMPlusThrowHR</span>(COR_E_BADIMAGEFORMAT);</td>
      </tr>
      <tr>
        <td id="L9770" data-line-number="9770"></td>
        <td id="LC9770">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9771" data-line-number="9771"></td>
        <td id="LC9771">
</td>
      </tr>
      <tr>
        <td id="L9772" data-line-number="9772"></td>
        <td id="LC9772">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L9773" data-line-number="9773"></td>
        <td id="LC9773">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9774" data-line-number="9774"></td>
        <td id="LC9774">    }</td>
      </tr>
      <tr>
        <td id="L9775" data-line-number="9775"></td>
        <td id="LC9775">
</td>
      </tr>
      <tr>
        <td id="L9776" data-line-number="9776"></td>
        <td id="LC9776">    result = <span>CorInfoTypeWithMod</span>(result | <span>CEEInfo::asCorInfoType</span>(type, typeHnd, vcTypeRet));</td>
      </tr>
      <tr>
        <td id="L9777" data-line-number="9777"></td>
        <td id="LC9777">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9778" data-line-number="9778"></td>
        <td id="LC9778">
</td>
      </tr>
      <tr>
        <td id="L9779" data-line-number="9779"></td>
        <td id="LC9779">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9780" data-line-number="9780"></td>
        <td id="LC9780">}</td>
      </tr>
      <tr>
        <td id="L9781" data-line-number="9781"></td>
        <td id="LC9781">
</td>
      </tr>
      <tr>
        <td id="L9782" data-line-number="9782"></td>
        <td id="LC9782"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9783" data-line-number="9783"></td>
        <td id="LC9783">
</td>
      </tr>
      <tr>
        <td id="L9784" data-line-number="9784"></td>
        <td id="LC9784">CORINFO_CLASS_HANDLE <span>CEEInfo::getArgClass</span> (</td>
      </tr>
      <tr>
        <td id="L9785" data-line-number="9785"></td>
        <td id="LC9785">    CORINFO_SIG_INFO*       sig,</td>
      </tr>
      <tr>
        <td id="L9786" data-line-number="9786"></td>
        <td id="LC9786">    CORINFO_ARG_LIST_HANDLE args</td>
      </tr>
      <tr>
        <td id="L9787" data-line-number="9787"></td>
        <td id="LC9787">    )</td>
      </tr>
      <tr>
        <td id="L9788" data-line-number="9788"></td>
        <td id="LC9788">{</td>
      </tr>
      <tr>
        <td id="L9789" data-line-number="9789"></td>
        <td id="LC9789">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9790" data-line-number="9790"></td>
        <td id="LC9790">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9791" data-line-number="9791"></td>
        <td id="LC9791">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9792" data-line-number="9792"></td>
        <td id="LC9792">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9793" data-line-number="9793"></td>
        <td id="LC9793">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9794" data-line-number="9794"></td>
        <td id="LC9794">
</td>
      </tr>
      <tr>
        <td id="L9795" data-line-number="9795"></td>
        <td id="LC9795">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9796" data-line-number="9796"></td>
        <td id="LC9796">
</td>
      </tr>
      <tr>
        <td id="L9797" data-line-number="9797"></td>
        <td id="LC9797">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9798" data-line-number="9798"></td>
        <td id="LC9798">
</td>
      </tr>
      <tr>
        <td id="L9799" data-line-number="9799"></td>
        <td id="LC9799">    <span><span>//</span> make certain we dont have a completely wacked out sig pointer</span></td>
      </tr>
      <tr>
        <td id="L9800" data-line-number="9800"></td>
        <td id="LC9800">    <span>_ASSERTE</span>((BYTE*) sig-&gt;<span>pSig</span> &lt;= (BYTE*) sig-&gt;<span>args</span>);</td>
      </tr>
      <tr>
        <td id="L9801" data-line-number="9801"></td>
        <td id="LC9801">    <span>_ASSERTE</span>((BYTE*) sig-&gt;<span>args</span> &lt;= (BYTE*) args &amp;&amp; (BYTE*) args &lt; &amp;((BYTE*) sig-&gt;<span>args</span>)[<span>0x10000</span>*<span>5</span>]);</td>
      </tr>
      <tr>
        <td id="L9802" data-line-number="9802"></td>
        <td id="LC9802">
</td>
      </tr>
      <tr>
        <td id="L9803" data-line-number="9803"></td>
        <td id="LC9803">    Module* pModule = <span>GetModule</span>(sig-&gt;<span>scope</span>);</td>
      </tr>
      <tr>
        <td id="L9804" data-line-number="9804"></td>
        <td id="LC9804">
</td>
      </tr>
      <tr>
        <td id="L9805" data-line-number="9805"></td>
        <td id="LC9805">    SigPointer <span>ptr</span>((<span>unsigned</span> __int8*) args);</td>
      </tr>
      <tr>
        <td id="L9806" data-line-number="9806"></td>
        <td id="LC9806">
</td>
      </tr>
      <tr>
        <td id="L9807" data-line-number="9807"></td>
        <td id="LC9807">    CorElementType eType;</td>
      </tr>
      <tr>
        <td id="L9808" data-line-number="9808"></td>
        <td id="LC9808">    <span>IfFailThrow</span>(ptr.<span>PeekElemType</span>(&amp;eType));</td>
      </tr>
      <tr>
        <td id="L9809" data-line-number="9809"></td>
        <td id="LC9809">
</td>
      </tr>
      <tr>
        <td id="L9810" data-line-number="9810"></td>
        <td id="LC9810">    <span>while</span> (eType == ELEMENT_TYPE_PINNED)</td>
      </tr>
      <tr>
        <td id="L9811" data-line-number="9811"></td>
        <td id="LC9811">    {</td>
      </tr>
      <tr>
        <td id="L9812" data-line-number="9812"></td>
        <td id="LC9812">        <span>IfFailThrow</span>(ptr.<span>GetElemType</span>(<span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L9813" data-line-number="9813"></td>
        <td id="LC9813">        <span>IfFailThrow</span>(ptr.<span>PeekElemType</span>(&amp;eType));</td>
      </tr>
      <tr>
        <td id="L9814" data-line-number="9814"></td>
        <td id="LC9814">    }</td>
      </tr>
      <tr>
        <td id="L9815" data-line-number="9815"></td>
        <td id="LC9815">    <span><span>//</span> Now read off the "real" element type after taking any instantiations into consideration</span></td>
      </tr>
      <tr>
        <td id="L9816" data-line-number="9816"></td>
        <td id="LC9816">    SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L9817" data-line-number="9817"></td>
        <td id="LC9817">    <span>GetTypeContext</span>(&amp;sig-&gt;<span>sigInst</span>, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9818" data-line-number="9818"></td>
        <td id="LC9818">    CorElementType type = ptr.<span>PeekElemTypeClosed</span>(pModule, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9819" data-line-number="9819"></td>
        <td id="LC9819">
</td>
      </tr>
      <tr>
        <td id="L9820" data-line-number="9820"></td>
        <td id="LC9820">    <span>if</span> (!<span>CorTypeInfo::IsPrimitiveType</span>(type)) {</td>
      </tr>
      <tr>
        <td id="L9821" data-line-number="9821"></td>
        <td id="LC9821">        TypeHandle th = ptr.<span>GetTypeHandleThrowing</span>(pModule, &amp;typeContext);</td>
      </tr>
      <tr>
        <td id="L9822" data-line-number="9822"></td>
        <td id="LC9822">        result = <span>CORINFO_CLASS_HANDLE</span>(th.<span>AsPtr</span>());</td>
      </tr>
      <tr>
        <td id="L9823" data-line-number="9823"></td>
        <td id="LC9823">    }</td>
      </tr>
      <tr>
        <td id="L9824" data-line-number="9824"></td>
        <td id="LC9824">
</td>
      </tr>
      <tr>
        <td id="L9825" data-line-number="9825"></td>
        <td id="LC9825">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9826" data-line-number="9826"></td>
        <td id="LC9826">
</td>
      </tr>
      <tr>
        <td id="L9827" data-line-number="9827"></td>
        <td id="LC9827">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9828" data-line-number="9828"></td>
        <td id="LC9828">}</td>
      </tr>
      <tr>
        <td id="L9829" data-line-number="9829"></td>
        <td id="LC9829">
</td>
      </tr>
      <tr>
        <td id="L9830" data-line-number="9830"></td>
        <td id="LC9830"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9831" data-line-number="9831"></td>
        <td id="LC9831">
</td>
      </tr>
      <tr>
        <td id="L9832" data-line-number="9832"></td>
        <td id="LC9832">CorInfoType <span>CEEInfo::getHFAType</span>(CORINFO_CLASS_HANDLE hClass)</td>
      </tr>
      <tr>
        <td id="L9833" data-line-number="9833"></td>
        <td id="LC9833">{</td>
      </tr>
      <tr>
        <td id="L9834" data-line-number="9834"></td>
        <td id="LC9834">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9835" data-line-number="9835"></td>
        <td id="LC9835">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9836" data-line-number="9836"></td>
        <td id="LC9836">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9837" data-line-number="9837"></td>
        <td id="LC9837">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9838" data-line-number="9838"></td>
        <td id="LC9838">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9839" data-line-number="9839"></td>
        <td id="LC9839">
</td>
      </tr>
      <tr>
        <td id="L9840" data-line-number="9840"></td>
        <td id="LC9840">    CorInfoType result = CORINFO_TYPE_UNDEF;</td>
      </tr>
      <tr>
        <td id="L9841" data-line-number="9841"></td>
        <td id="LC9841">
</td>
      </tr>
      <tr>
        <td id="L9842" data-line-number="9842"></td>
        <td id="LC9842">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9843" data-line-number="9843"></td>
        <td id="LC9843">
</td>
      </tr>
      <tr>
        <td id="L9844" data-line-number="9844"></td>
        <td id="LC9844">    TypeHandle <span>VMClsHnd</span>(hClass);</td>
      </tr>
      <tr>
        <td id="L9845" data-line-number="9845"></td>
        <td id="LC9845">
</td>
      </tr>
      <tr>
        <td id="L9846" data-line-number="9846"></td>
        <td id="LC9846">    result = <span>asCorInfoType</span>(VMClsHnd.<span>GetHFAType</span>());</td>
      </tr>
      <tr>
        <td id="L9847" data-line-number="9847"></td>
        <td id="LC9847">
</td>
      </tr>
      <tr>
        <td id="L9848" data-line-number="9848"></td>
        <td id="LC9848">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9849" data-line-number="9849"></td>
        <td id="LC9849">
</td>
      </tr>
      <tr>
        <td id="L9850" data-line-number="9850"></td>
        <td id="LC9850">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9851" data-line-number="9851"></td>
        <td id="LC9851">}</td>
      </tr>
      <tr>
        <td id="L9852" data-line-number="9852"></td>
        <td id="LC9852">
</td>
      </tr>
      <tr>
        <td id="L9853" data-line-number="9853"></td>
        <td id="LC9853"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9854" data-line-number="9854"></td>
        <td id="LC9854">
</td>
      </tr>
      <tr>
        <td id="L9855" data-line-number="9855"></td>
        <td id="LC9855">    <span><span>//</span> return the unmanaged calling convention for a PInvoke</span></td>
      </tr>
      <tr>
        <td id="L9856" data-line-number="9856"></td>
        <td id="LC9856">CorInfoUnmanagedCallConv <span>CEEInfo::getUnmanagedCallConv</span>(CORINFO_METHOD_HANDLE method)</td>
      </tr>
      <tr>
        <td id="L9857" data-line-number="9857"></td>
        <td id="LC9857">{</td>
      </tr>
      <tr>
        <td id="L9858" data-line-number="9858"></td>
        <td id="LC9858">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9859" data-line-number="9859"></td>
        <td id="LC9859">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9860" data-line-number="9860"></td>
        <td id="LC9860">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9861" data-line-number="9861"></td>
        <td id="LC9861">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9862" data-line-number="9862"></td>
        <td id="LC9862">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9863" data-line-number="9863"></td>
        <td id="LC9863">
</td>
      </tr>
      <tr>
        <td id="L9864" data-line-number="9864"></td>
        <td id="LC9864">    CorInfoUnmanagedCallConv result = CORINFO_UNMANAGED_CALLCONV_UNKNOWN;</td>
      </tr>
      <tr>
        <td id="L9865" data-line-number="9865"></td>
        <td id="LC9865">
</td>
      </tr>
      <tr>
        <td id="L9866" data-line-number="9866"></td>
        <td id="LC9866">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9867" data-line-number="9867"></td>
        <td id="LC9867">
</td>
      </tr>
      <tr>
        <td id="L9868" data-line-number="9868"></td>
        <td id="LC9868">    MethodDesc* pMD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L9869" data-line-number="9869"></td>
        <td id="LC9869">    pMD = <span>GetMethod</span>(method);</td>
      </tr>
      <tr>
        <td id="L9870" data-line-number="9870"></td>
        <td id="LC9870">    <span>_ASSERTE</span>(pMD-&gt;<span>IsNDirect</span>());</td>
      </tr>
      <tr>
        <td id="L9871" data-line-number="9871"></td>
        <td id="LC9871">
</td>
      </tr>
      <tr>
        <td id="L9872" data-line-number="9872"></td>
        <td id="LC9872">#<span>ifdef</span> TARGET_X86</td>
      </tr>
      <tr>
        <td id="L9873" data-line-number="9873"></td>
        <td id="LC9873">    EX_TRY</td>
      </tr>
      <tr>
        <td id="L9874" data-line-number="9874"></td>
        <td id="LC9874">    {</td>
      </tr>
      <tr>
        <td id="L9875" data-line-number="9875"></td>
        <td id="LC9875">        PInvokeStaticSigInfo <span>sigInfo</span>(pMD, PInvokeStaticSigInfo::NO_THROW_ON_ERROR);</td>
      </tr>
      <tr>
        <td id="L9876" data-line-number="9876"></td>
        <td id="LC9876">
</td>
      </tr>
      <tr>
        <td id="L9877" data-line-number="9877"></td>
        <td id="LC9877">        <span>switch</span> (sigInfo.<span>GetCallConv</span>()) {</td>
      </tr>
      <tr>
        <td id="L9878" data-line-number="9878"></td>
        <td id="LC9878">            <span>case</span> pmCallConvCdecl:</td>
      </tr>
      <tr>
        <td id="L9879" data-line-number="9879"></td>
        <td id="LC9879">                result = CORINFO_UNMANAGED_CALLCONV_C;</td>
      </tr>
      <tr>
        <td id="L9880" data-line-number="9880"></td>
        <td id="LC9880">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9881" data-line-number="9881"></td>
        <td id="LC9881">            <span>case</span> pmCallConvStdcall:</td>
      </tr>
      <tr>
        <td id="L9882" data-line-number="9882"></td>
        <td id="LC9882">                result = CORINFO_UNMANAGED_CALLCONV_STDCALL;</td>
      </tr>
      <tr>
        <td id="L9883" data-line-number="9883"></td>
        <td id="LC9883">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9884" data-line-number="9884"></td>
        <td id="LC9884">            <span>case</span> pmCallConvThiscall:</td>
      </tr>
      <tr>
        <td id="L9885" data-line-number="9885"></td>
        <td id="LC9885">                result = CORINFO_UNMANAGED_CALLCONV_THISCALL;</td>
      </tr>
      <tr>
        <td id="L9886" data-line-number="9886"></td>
        <td id="LC9886">                <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L9887" data-line-number="9887"></td>
        <td id="LC9887">            <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L9888" data-line-number="9888"></td>
        <td id="LC9888">                result = CORINFO_UNMANAGED_CALLCONV_UNKNOWN;</td>
      </tr>
      <tr>
        <td id="L9889" data-line-number="9889"></td>
        <td id="LC9889">        }</td>
      </tr>
      <tr>
        <td id="L9890" data-line-number="9890"></td>
        <td id="LC9890">    }</td>
      </tr>
      <tr>
        <td id="L9891" data-line-number="9891"></td>
        <td id="LC9891">    EX_CATCH</td>
      </tr>
      <tr>
        <td id="L9892" data-line-number="9892"></td>
        <td id="LC9892">    {</td>
      </tr>
      <tr>
        <td id="L9893" data-line-number="9893"></td>
        <td id="LC9893">        result = CORINFO_UNMANAGED_CALLCONV_UNKNOWN;</td>
      </tr>
      <tr>
        <td id="L9894" data-line-number="9894"></td>
        <td id="LC9894">    }</td>
      </tr>
      <tr>
        <td id="L9895" data-line-number="9895"></td>
        <td id="LC9895">    <span>EX_END_CATCH</span>(SwallowAllExceptions)</td>
      </tr>
      <tr>
        <td id="L9896" data-line-number="9896"></td>
        <td id="LC9896">#<span>else</span> <span><span>//</span> !TARGET_X86</span></td>
      </tr>
      <tr>
        <td id="L9897" data-line-number="9897"></td>
        <td id="LC9897">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L9898" data-line-number="9898"></td>
        <td id="LC9898">    <span><span>//</span> we have only one calling convention</span></td>
      </tr>
      <tr>
        <td id="L9899" data-line-number="9899"></td>
        <td id="LC9899">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L9900" data-line-number="9900"></td>
        <td id="LC9900">    result = CORINFO_UNMANAGED_CALLCONV_STDCALL;</td>
      </tr>
      <tr>
        <td id="L9901" data-line-number="9901"></td>
        <td id="LC9901">#<span>endif</span> <span><span>//</span> !TARGET_X86</span></td>
      </tr>
      <tr>
        <td id="L9902" data-line-number="9902"></td>
        <td id="LC9902">
</td>
      </tr>
      <tr>
        <td id="L9903" data-line-number="9903"></td>
        <td id="LC9903">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9904" data-line-number="9904"></td>
        <td id="LC9904">
</td>
      </tr>
      <tr>
        <td id="L9905" data-line-number="9905"></td>
        <td id="LC9905">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9906" data-line-number="9906"></td>
        <td id="LC9906">}</td>
      </tr>
      <tr>
        <td id="L9907" data-line-number="9907"></td>
        <td id="LC9907">
</td>
      </tr>
      <tr>
        <td id="L9908" data-line-number="9908"></td>
        <td id="LC9908"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9909" data-line-number="9909"></td>
        <td id="LC9909">BOOL <span>CEEInfo::pInvokeMarshalingRequired</span>(CORINFO_METHOD_HANDLE method, CORINFO_SIG_INFO* callSiteSig)</td>
      </tr>
      <tr>
        <td id="L9910" data-line-number="9910"></td>
        <td id="LC9910">{</td>
      </tr>
      <tr>
        <td id="L9911" data-line-number="9911"></td>
        <td id="LC9911">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9912" data-line-number="9912"></td>
        <td id="LC9912">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9913" data-line-number="9913"></td>
        <td id="LC9913">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9914" data-line-number="9914"></td>
        <td id="LC9914">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9915" data-line-number="9915"></td>
        <td id="LC9915">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9916" data-line-number="9916"></td>
        <td id="LC9916">
</td>
      </tr>
      <tr>
        <td id="L9917" data-line-number="9917"></td>
        <td id="LC9917">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L9918" data-line-number="9918"></td>
        <td id="LC9918">
</td>
      </tr>
      <tr>
        <td id="L9919" data-line-number="9919"></td>
        <td id="LC9919">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9920" data-line-number="9920"></td>
        <td id="LC9920">
</td>
      </tr>
      <tr>
        <td id="L9921" data-line-number="9921"></td>
        <td id="LC9921">    <span>if</span> (method != <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L9922" data-line-number="9922"></td>
        <td id="LC9922">    {</td>
      </tr>
      <tr>
        <td id="L9923" data-line-number="9923"></td>
        <td id="LC9923">        MethodDesc* ftn = <span>GetMethod</span>(method);</td>
      </tr>
      <tr>
        <td id="L9924" data-line-number="9924"></td>
        <td id="LC9924">        <span>_ASSERTE</span>(ftn-&gt;<span>IsNDirect</span>());</td>
      </tr>
      <tr>
        <td id="L9925" data-line-number="9925"></td>
        <td id="LC9925">        NDirectMethodDesc *pMD = (NDirectMethodDesc*)ftn;</td>
      </tr>
      <tr>
        <td id="L9926" data-line-number="9926"></td>
        <td id="LC9926">
</td>
      </tr>
      <tr>
        <td id="L9927" data-line-number="9927"></td>
        <td id="LC9927">#<span>if</span> defined(HAS_NDIRECT_IMPORT_PRECODE)</td>
      </tr>
      <tr>
        <td id="L9928" data-line-number="9928"></td>
        <td id="LC9928">        <span>if</span> (pMD-&gt;<span>IsVarArg</span>())</td>
      </tr>
      <tr>
        <td id="L9929" data-line-number="9929"></td>
        <td id="LC9929">        {</td>
      </tr>
      <tr>
        <td id="L9930" data-line-number="9930"></td>
        <td id="LC9930">            <span><span>//</span> Varag P/Invoke must not be inlined because its NDirectMethodDesc</span></td>
      </tr>
      <tr>
        <td id="L9931" data-line-number="9931"></td>
        <td id="LC9931">            <span><span>//</span> does not contain a meaningful stack size (it is call site specific).</span></td>
      </tr>
      <tr>
        <td id="L9932" data-line-number="9932"></td>
        <td id="LC9932">            <span><span>//</span> See code:InlinedCallFrame.UpdateRegDisplay where this is needed.</span></td>
      </tr>
      <tr>
        <td id="L9933" data-line-number="9933"></td>
        <td id="LC9933">            result = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L9934" data-line-number="9934"></td>
        <td id="LC9934">        }</td>
      </tr>
      <tr>
        <td id="L9935" data-line-number="9935"></td>
        <td id="LC9935">        <span>else</span> <span>if</span> (pMD-&gt;<span>MarshalingRequired</span>())</td>
      </tr>
      <tr>
        <td id="L9936" data-line-number="9936"></td>
        <td id="LC9936">        {</td>
      </tr>
      <tr>
        <td id="L9937" data-line-number="9937"></td>
        <td id="LC9937">            <span><span>//</span> This is not a no-marshal signature.</span></td>
      </tr>
      <tr>
        <td id="L9938" data-line-number="9938"></td>
        <td id="LC9938">            result = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L9939" data-line-number="9939"></td>
        <td id="LC9939">        }</td>
      </tr>
      <tr>
        <td id="L9940" data-line-number="9940"></td>
        <td id="LC9940">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L9941" data-line-number="9941"></td>
        <td id="LC9941">        {</td>
      </tr>
      <tr>
        <td id="L9942" data-line-number="9942"></td>
        <td id="LC9942">            <span><span>//</span> This is a no-marshal non-vararg signature.</span></td>
      </tr>
      <tr>
        <td id="L9943" data-line-number="9943"></td>
        <td id="LC9943">            result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L9944" data-line-number="9944"></td>
        <td id="LC9944">        }</td>
      </tr>
      <tr>
        <td id="L9945" data-line-number="9945"></td>
        <td id="LC9945">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L9946" data-line-number="9946"></td>
        <td id="LC9946">        <span><span>//</span> Marshalling is required to lazy initialize the indirection cell</span></td>
      </tr>
      <tr>
        <td id="L9947" data-line-number="9947"></td>
        <td id="LC9947">        <span><span>//</span> without NDirectImportPrecode.</span></td>
      </tr>
      <tr>
        <td id="L9948" data-line-number="9948"></td>
        <td id="LC9948">        result = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L9949" data-line-number="9949"></td>
        <td id="LC9949">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L9950" data-line-number="9950"></td>
        <td id="LC9950">    }</td>
      </tr>
      <tr>
        <td id="L9951" data-line-number="9951"></td>
        <td id="LC9951">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L9952" data-line-number="9952"></td>
        <td id="LC9952">    {</td>
      </tr>
      <tr>
        <td id="L9953" data-line-number="9953"></td>
        <td id="LC9953">        <span><span>//</span> check the call site signature</span></td>
      </tr>
      <tr>
        <td id="L9954" data-line-number="9954"></td>
        <td id="LC9954">        result = <span>NDirect::MarshalingRequired</span>(</td>
      </tr>
      <tr>
        <td id="L9955" data-line-number="9955"></td>
        <td id="LC9955">                    <span>GetMethod</span>(method),</td>
      </tr>
      <tr>
        <td id="L9956" data-line-number="9956"></td>
        <td id="LC9956">                    callSiteSig-&gt;<span>pSig</span>,</td>
      </tr>
      <tr>
        <td id="L9957" data-line-number="9957"></td>
        <td id="LC9957">                    <span>GetModule</span>(callSiteSig-&gt;<span>scope</span>));</td>
      </tr>
      <tr>
        <td id="L9958" data-line-number="9958"></td>
        <td id="LC9958">    }</td>
      </tr>
      <tr>
        <td id="L9959" data-line-number="9959"></td>
        <td id="LC9959">
</td>
      </tr>
      <tr>
        <td id="L9960" data-line-number="9960"></td>
        <td id="LC9960">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9961" data-line-number="9961"></td>
        <td id="LC9961">
</td>
      </tr>
      <tr>
        <td id="L9962" data-line-number="9962"></td>
        <td id="LC9962">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L9963" data-line-number="9963"></td>
        <td id="LC9963">}</td>
      </tr>
      <tr>
        <td id="L9964" data-line-number="9964"></td>
        <td id="LC9964">
</td>
      </tr>
      <tr>
        <td id="L9965" data-line-number="9965"></td>
        <td id="LC9965"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L9966" data-line-number="9966"></td>
        <td id="LC9966"><span><span>//</span> Generate a cookie based on the signature that would needs to be passed</span></td>
      </tr>
      <tr>
        <td id="L9967" data-line-number="9967"></td>
        <td id="LC9967"><span><span>//</span> to CORINFO_HELP_PINVOKE_CALLI</span></td>
      </tr>
      <tr>
        <td id="L9968" data-line-number="9968"></td>
        <td id="LC9968">LPVOID <span>CEEInfo::GetCookieForPInvokeCalliSig</span>(CORINFO_SIG_INFO* szMetaSig,</td>
      </tr>
      <tr>
        <td id="L9969" data-line-number="9969"></td>
        <td id="LC9969">                                            <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L9970" data-line-number="9970"></td>
        <td id="LC9970">{</td>
      </tr>
      <tr>
        <td id="L9971" data-line-number="9971"></td>
        <td id="LC9971">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L9972" data-line-number="9972"></td>
        <td id="LC9972">
</td>
      </tr>
      <tr>
        <td id="L9973" data-line-number="9973"></td>
        <td id="LC9973">    <span>return</span> <span>getVarArgsHandle</span>(szMetaSig, ppIndirection);</td>
      </tr>
      <tr>
        <td id="L9974" data-line-number="9974"></td>
        <td id="LC9974">}</td>
      </tr>
      <tr>
        <td id="L9975" data-line-number="9975"></td>
        <td id="LC9975">
</td>
      </tr>
      <tr>
        <td id="L9976" data-line-number="9976"></td>
        <td id="LC9976"><span>bool</span> <span>CEEInfo::canGetCookieForPInvokeCalliSig</span>(CORINFO_SIG_INFO* szMetaSig)</td>
      </tr>
      <tr>
        <td id="L9977" data-line-number="9977"></td>
        <td id="LC9977">{</td>
      </tr>
      <tr>
        <td id="L9978" data-line-number="9978"></td>
        <td id="LC9978">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L9979" data-line-number="9979"></td>
        <td id="LC9979">    <span>return</span> <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L9980" data-line-number="9980"></td>
        <td id="LC9980">}</td>
      </tr>
      <tr>
        <td id="L9981" data-line-number="9981"></td>
        <td id="LC9981">
</td>
      </tr>
      <tr>
        <td id="L9982" data-line-number="9982"></td>
        <td id="LC9982">
</td>
      </tr>
      <tr>
        <td id="L9983" data-line-number="9983"></td>
        <td id="LC9983"><span><span>//</span> Check any constraints on method type arguments</span></td>
      </tr>
      <tr>
        <td id="L9984" data-line-number="9984"></td>
        <td id="LC9984">BOOL <span>CEEInfo::satisfiesMethodConstraints</span>(</td>
      </tr>
      <tr>
        <td id="L9985" data-line-number="9985"></td>
        <td id="LC9985">    CORINFO_CLASS_HANDLE        parent,</td>
      </tr>
      <tr>
        <td id="L9986" data-line-number="9986"></td>
        <td id="LC9986">    CORINFO_METHOD_HANDLE       method)</td>
      </tr>
      <tr>
        <td id="L9987" data-line-number="9987"></td>
        <td id="LC9987">{</td>
      </tr>
      <tr>
        <td id="L9988" data-line-number="9988"></td>
        <td id="LC9988">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L9989" data-line-number="9989"></td>
        <td id="LC9989">        THROWS;</td>
      </tr>
      <tr>
        <td id="L9990" data-line-number="9990"></td>
        <td id="LC9990">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L9991" data-line-number="9991"></td>
        <td id="LC9991">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L9992" data-line-number="9992"></td>
        <td id="LC9992">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L9993" data-line-number="9993"></td>
        <td id="LC9993">
</td>
      </tr>
      <tr>
        <td id="L9994" data-line-number="9994"></td>
        <td id="LC9994">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L9995" data-line-number="9995"></td>
        <td id="LC9995">
</td>
      </tr>
      <tr>
        <td id="L9996" data-line-number="9996"></td>
        <td id="LC9996">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L9997" data-line-number="9997"></td>
        <td id="LC9997">
</td>
      </tr>
      <tr>
        <td id="L9998" data-line-number="9998"></td>
        <td id="LC9998">    <span>_ASSERTE</span>(parent != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L9999" data-line-number="9999"></td>
        <td id="LC9999">    <span>_ASSERTE</span>(method != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L10000" data-line-number="10000"></td>
        <td id="LC10000">    result = <span>GetMethod</span>(method)-&gt;<span>SatisfiesMethodConstraints</span>(<span>TypeHandle</span>(parent));</td>
      </tr>
      <tr>
        <td id="L10001" data-line-number="10001"></td>
        <td id="LC10001">
</td>
      </tr>
      <tr>
        <td id="L10002" data-line-number="10002"></td>
        <td id="LC10002">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10003" data-line-number="10003"></td>
        <td id="LC10003">
</td>
      </tr>
      <tr>
        <td id="L10004" data-line-number="10004"></td>
        <td id="LC10004">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10005" data-line-number="10005"></td>
        <td id="LC10005">}</td>
      </tr>
      <tr>
        <td id="L10006" data-line-number="10006"></td>
        <td id="LC10006">
</td>
      </tr>
      <tr>
        <td id="L10007" data-line-number="10007"></td>
        <td id="LC10007">
</td>
      </tr>
      <tr>
        <td id="L10008" data-line-number="10008"></td>
        <td id="LC10008">
</td>
      </tr>
      <tr>
        <td id="L10009" data-line-number="10009"></td>
        <td id="LC10009"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10010" data-line-number="10010"></td>
        <td id="LC10010"><span><span>//</span> Given a delegate target class, a target method parent class,  a  target method,</span></td>
      </tr>
      <tr>
        <td id="L10011" data-line-number="10011"></td>
        <td id="LC10011"><span><span>//</span> a delegate class, check if the method signature is compatible with the Invoke method of the delegate</span></td>
      </tr>
      <tr>
        <td id="L10012" data-line-number="10012"></td>
        <td id="LC10012"><span><span>//</span> (under the typical instantiation of any free type variables in the memberref signatures).</span></td>
      </tr>
      <tr>
        <td id="L10013" data-line-number="10013"></td>
        <td id="LC10013"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10014" data-line-number="10014"></td>
        <td id="LC10014"><span><span>//</span> objCls should be NULL if the target object is NULL</span></td>
      </tr>
      <tr>
        <td id="L10015" data-line-number="10015"></td>
        <td id="LC10015"><span><span>//</span>@GENERICSVER: new (suitable for generics)</span></td>
      </tr>
      <tr>
        <td id="L10016" data-line-number="10016"></td>
        <td id="LC10016">BOOL <span>CEEInfo::isCompatibleDelegate</span>(</td>
      </tr>
      <tr>
        <td id="L10017" data-line-number="10017"></td>
        <td id="LC10017">            CORINFO_CLASS_HANDLE        objCls,</td>
      </tr>
      <tr>
        <td id="L10018" data-line-number="10018"></td>
        <td id="LC10018">            CORINFO_CLASS_HANDLE        methodParentCls,</td>
      </tr>
      <tr>
        <td id="L10019" data-line-number="10019"></td>
        <td id="LC10019">            CORINFO_METHOD_HANDLE       method,</td>
      </tr>
      <tr>
        <td id="L10020" data-line-number="10020"></td>
        <td id="LC10020">            CORINFO_CLASS_HANDLE        delegateCls,</td>
      </tr>
      <tr>
        <td id="L10021" data-line-number="10021"></td>
        <td id="LC10021">            BOOL*                       pfIsOpenDelegate)</td>
      </tr>
      <tr>
        <td id="L10022" data-line-number="10022"></td>
        <td id="LC10022">{</td>
      </tr>
      <tr>
        <td id="L10023" data-line-number="10023"></td>
        <td id="LC10023">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10024" data-line-number="10024"></td>
        <td id="LC10024">        THROWS;</td>
      </tr>
      <tr>
        <td id="L10025" data-line-number="10025"></td>
        <td id="LC10025">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10026" data-line-number="10026"></td>
        <td id="LC10026">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10027" data-line-number="10027"></td>
        <td id="LC10027">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10028" data-line-number="10028"></td>
        <td id="LC10028">
</td>
      </tr>
      <tr>
        <td id="L10029" data-line-number="10029"></td>
        <td id="LC10029">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L10030" data-line-number="10030"></td>
        <td id="LC10030">
</td>
      </tr>
      <tr>
        <td id="L10031" data-line-number="10031"></td>
        <td id="LC10031">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10032" data-line-number="10032"></td>
        <td id="LC10032">
</td>
      </tr>
      <tr>
        <td id="L10033" data-line-number="10033"></td>
        <td id="LC10033">    <span>_ASSERTE</span>(method != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L10034" data-line-number="10034"></td>
        <td id="LC10034">    <span>_ASSERTE</span>(delegateCls != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L10035" data-line-number="10035"></td>
        <td id="LC10035">
</td>
      </tr>
      <tr>
        <td id="L10036" data-line-number="10036"></td>
        <td id="LC10036">    TypeHandle delegateClsHnd = (TypeHandle) delegateCls;</td>
      </tr>
      <tr>
        <td id="L10037" data-line-number="10037"></td>
        <td id="LC10037">
</td>
      </tr>
      <tr>
        <td id="L10038" data-line-number="10038"></td>
        <td id="LC10038">    <span>_ASSERTE</span>(delegateClsHnd.<span>GetMethodTable</span>()-&gt;<span>IsDelegate</span>());</td>
      </tr>
      <tr>
        <td id="L10039" data-line-number="10039"></td>
        <td id="LC10039">
</td>
      </tr>
      <tr>
        <td id="L10040" data-line-number="10040"></td>
        <td id="LC10040">    TypeHandle methodParentHnd = (TypeHandle) (methodParentCls);</td>
      </tr>
      <tr>
        <td id="L10041" data-line-number="10041"></td>
        <td id="LC10041">    MethodDesc* pMDFtn = <span>GetMethod</span>(method);</td>
      </tr>
      <tr>
        <td id="L10042" data-line-number="10042"></td>
        <td id="LC10042">    TypeHandle <span>objClsHnd</span>(objCls);</td>
      </tr>
      <tr>
        <td id="L10043" data-line-number="10043"></td>
        <td id="LC10043">
</td>
      </tr>
      <tr>
        <td id="L10044" data-line-number="10044"></td>
        <td id="LC10044">    EX_TRY</td>
      </tr>
      <tr>
        <td id="L10045" data-line-number="10045"></td>
        <td id="LC10045">    {</td>
      </tr>
      <tr>
        <td id="L10046" data-line-number="10046"></td>
        <td id="LC10046">      result = <span>COMDelegate::ValidateCtor</span>(objClsHnd, methodParentHnd, pMDFtn, delegateClsHnd, pfIsOpenDelegate);</td>
      </tr>
      <tr>
        <td id="L10047" data-line-number="10047"></td>
        <td id="LC10047">    }</td>
      </tr>
      <tr>
        <td id="L10048" data-line-number="10048"></td>
        <td id="LC10048">    EX_CATCH</td>
      </tr>
      <tr>
        <td id="L10049" data-line-number="10049"></td>
        <td id="LC10049">    {</td>
      </tr>
      <tr>
        <td id="L10050" data-line-number="10050"></td>
        <td id="LC10050">    }</td>
      </tr>
      <tr>
        <td id="L10051" data-line-number="10051"></td>
        <td id="LC10051">    <span>EX_END_CATCH</span>(SwallowAllExceptions)</td>
      </tr>
      <tr>
        <td id="L10052" data-line-number="10052"></td>
        <td id="LC10052">
</td>
      </tr>
      <tr>
        <td id="L10053" data-line-number="10053"></td>
        <td id="LC10053">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10054" data-line-number="10054"></td>
        <td id="LC10054">
</td>
      </tr>
      <tr>
        <td id="L10055" data-line-number="10055"></td>
        <td id="LC10055">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10056" data-line-number="10056"></td>
        <td id="LC10056">}</td>
      </tr>
      <tr>
        <td id="L10057" data-line-number="10057"></td>
        <td id="LC10057">
</td>
      </tr>
      <tr>
        <td id="L10058" data-line-number="10058"></td>
        <td id="LC10058"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10059" data-line-number="10059"></td>
        <td id="LC10059">    <span><span>//</span> return the unmanaged target *if method has already been prelinked.*</span></td>
      </tr>
      <tr>
        <td id="L10060" data-line-number="10060"></td>
        <td id="LC10060"><span>void</span>* <span>CEEInfo::getPInvokeUnmanagedTarget</span>(CORINFO_METHOD_HANDLE method,</td>
      </tr>
      <tr>
        <td id="L10061" data-line-number="10061"></td>
        <td id="LC10061">                                                    <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10062" data-line-number="10062"></td>
        <td id="LC10062">{</td>
      </tr>
      <tr>
        <td id="L10063" data-line-number="10063"></td>
        <td id="LC10063">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10064" data-line-number="10064"></td>
        <td id="LC10064">        THROWS;</td>
      </tr>
      <tr>
        <td id="L10065" data-line-number="10065"></td>
        <td id="LC10065">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10066" data-line-number="10066"></td>
        <td id="LC10066">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10067" data-line-number="10067"></td>
        <td id="LC10067">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10068" data-line-number="10068"></td>
        <td id="LC10068">
</td>
      </tr>
      <tr>
        <td id="L10069" data-line-number="10069"></td>
        <td id="LC10069">    <span><span>//</span> Not expected to work due to multicore and tiered JIT potentially needing</span></td>
      </tr>
      <tr>
        <td id="L10070" data-line-number="10070"></td>
        <td id="LC10070">    <span><span>//</span> to call managed cctors</span></td>
      </tr>
      <tr>
        <td id="L10071" data-line-number="10071"></td>
        <td id="LC10071">    <span>_ASSERTE</span>(<span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L10072" data-line-number="10072"></td>
        <td id="LC10072">
</td>
      </tr>
      <tr>
        <td id="L10073" data-line-number="10073"></td>
        <td id="LC10073">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10074" data-line-number="10074"></td>
        <td id="LC10074">    {</td>
      </tr>
      <tr>
        <td id="L10075" data-line-number="10075"></td>
        <td id="LC10075">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10076" data-line-number="10076"></td>
        <td id="LC10076">    }</td>
      </tr>
      <tr>
        <td id="L10077" data-line-number="10077"></td>
        <td id="LC10077">
</td>
      </tr>
      <tr>
        <td id="L10078" data-line-number="10078"></td>
        <td id="LC10078">    <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10079" data-line-number="10079"></td>
        <td id="LC10079">}</td>
      </tr>
      <tr>
        <td id="L10080" data-line-number="10080"></td>
        <td id="LC10080">
</td>
      </tr>
      <tr>
        <td id="L10081" data-line-number="10081"></td>
        <td id="LC10081"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10082" data-line-number="10082"></td>
        <td id="LC10082">    <span><span>//</span> return address of fixup area for late-bound N/Direct calls.</span></td>
      </tr>
      <tr>
        <td id="L10083" data-line-number="10083"></td>
        <td id="LC10083"><span>void</span>* <span>CEEInfo::getAddressOfPInvokeFixup</span>(CORINFO_METHOD_HANDLE method,</td>
      </tr>
      <tr>
        <td id="L10084" data-line-number="10084"></td>
        <td id="LC10084">                                        <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10085" data-line-number="10085"></td>
        <td id="LC10085">{</td>
      </tr>
      <tr>
        <td id="L10086" data-line-number="10086"></td>
        <td id="LC10086">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10087" data-line-number="10087"></td>
        <td id="LC10087">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10088" data-line-number="10088"></td>
        <td id="LC10088">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10089" data-line-number="10089"></td>
        <td id="LC10089">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10090" data-line-number="10090"></td>
        <td id="LC10090">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10091" data-line-number="10091"></td>
        <td id="LC10091">
</td>
      </tr>
      <tr>
        <td id="L10092" data-line-number="10092"></td>
        <td id="LC10092">    <span>void</span> * result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10093" data-line-number="10093"></td>
        <td id="LC10093">
</td>
      </tr>
      <tr>
        <td id="L10094" data-line-number="10094"></td>
        <td id="LC10094">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10095" data-line-number="10095"></td>
        <td id="LC10095">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10096" data-line-number="10096"></td>
        <td id="LC10096">
</td>
      </tr>
      <tr>
        <td id="L10097" data-line-number="10097"></td>
        <td id="LC10097">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10098" data-line-number="10098"></td>
        <td id="LC10098">
</td>
      </tr>
      <tr>
        <td id="L10099" data-line-number="10099"></td>
        <td id="LC10099">    MethodDesc* ftn = <span>GetMethod</span>(method);</td>
      </tr>
      <tr>
        <td id="L10100" data-line-number="10100"></td>
        <td id="LC10100">    <span>_ASSERTE</span>(ftn-&gt;<span>IsNDirect</span>());</td>
      </tr>
      <tr>
        <td id="L10101" data-line-number="10101"></td>
        <td id="LC10101">    NDirectMethodDesc *pMD = (NDirectMethodDesc*)ftn;</td>
      </tr>
      <tr>
        <td id="L10102" data-line-number="10102"></td>
        <td id="LC10102">
</td>
      </tr>
      <tr>
        <td id="L10103" data-line-number="10103"></td>
        <td id="LC10103">    result = (LPVOID)&amp;(pMD-&gt;<span>GetWriteableData</span>()-&gt;<span>m_pNDirectTarget</span>);</td>
      </tr>
      <tr>
        <td id="L10104" data-line-number="10104"></td>
        <td id="LC10104">
</td>
      </tr>
      <tr>
        <td id="L10105" data-line-number="10105"></td>
        <td id="LC10105">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10106" data-line-number="10106"></td>
        <td id="LC10106">
</td>
      </tr>
      <tr>
        <td id="L10107" data-line-number="10107"></td>
        <td id="LC10107">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10108" data-line-number="10108"></td>
        <td id="LC10108">}</td>
      </tr>
      <tr>
        <td id="L10109" data-line-number="10109"></td>
        <td id="LC10109">
</td>
      </tr>
      <tr>
        <td id="L10110" data-line-number="10110"></td>
        <td id="LC10110"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10111" data-line-number="10111"></td>
        <td id="LC10111"><span><span>//</span> return address of fixup area for late-bound N/Direct calls.</span></td>
      </tr>
      <tr>
        <td id="L10112" data-line-number="10112"></td>
        <td id="LC10112"><span>void</span> <span>CEEInfo::getAddressOfPInvokeTarget</span>(CORINFO_METHOD_HANDLE method,</td>
      </tr>
      <tr>
        <td id="L10113" data-line-number="10113"></td>
        <td id="LC10113">                                        CORINFO_CONST_LOOKUP *pLookup)</td>
      </tr>
      <tr>
        <td id="L10114" data-line-number="10114"></td>
        <td id="LC10114">{</td>
      </tr>
      <tr>
        <td id="L10115" data-line-number="10115"></td>
        <td id="LC10115">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L10116" data-line-number="10116"></td>
        <td id="LC10116">
</td>
      </tr>
      <tr>
        <td id="L10117" data-line-number="10117"></td>
        <td id="LC10117">    <span>void</span>* pIndirection;</td>
      </tr>
      <tr>
        <td id="L10118" data-line-number="10118"></td>
        <td id="LC10118">    {</td>
      </tr>
      <tr>
        <td id="L10119" data-line-number="10119"></td>
        <td id="LC10119">        <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10120" data-line-number="10120"></td>
        <td id="LC10120">
</td>
      </tr>
      <tr>
        <td id="L10121" data-line-number="10121"></td>
        <td id="LC10121">        MethodDesc* pMD = <span>GetMethod</span>(method);</td>
      </tr>
      <tr>
        <td id="L10122" data-line-number="10122"></td>
        <td id="LC10122">        <span>if</span> (<span>NDirectMethodDesc::TryResolveNDirectTargetForNoGCTransition</span>(pMD, &amp;pIndirection))</td>
      </tr>
      <tr>
        <td id="L10123" data-line-number="10123"></td>
        <td id="LC10123">        {</td>
      </tr>
      <tr>
        <td id="L10124" data-line-number="10124"></td>
        <td id="LC10124">            pLookup-&gt;<span>accessType</span> = IAT_VALUE;</td>
      </tr>
      <tr>
        <td id="L10125" data-line-number="10125"></td>
        <td id="LC10125">            pLookup-&gt;<span>addr</span> = pIndirection;</td>
      </tr>
      <tr>
        <td id="L10126" data-line-number="10126"></td>
        <td id="LC10126">            <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L10127" data-line-number="10127"></td>
        <td id="LC10127">        }</td>
      </tr>
      <tr>
        <td id="L10128" data-line-number="10128"></td>
        <td id="LC10128">
</td>
      </tr>
      <tr>
        <td id="L10129" data-line-number="10129"></td>
        <td id="LC10129">        <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10130" data-line-number="10130"></td>
        <td id="LC10130">    }</td>
      </tr>
      <tr>
        <td id="L10131" data-line-number="10131"></td>
        <td id="LC10131">
</td>
      </tr>
      <tr>
        <td id="L10132" data-line-number="10132"></td>
        <td id="LC10132">    pLookup-&gt;<span>accessType</span> = IAT_PVALUE;</td>
      </tr>
      <tr>
        <td id="L10133" data-line-number="10133"></td>
        <td id="LC10133">    pLookup-&gt;<span>addr</span> = <span>getAddressOfPInvokeFixup</span>(method, &amp;pIndirection);</td>
      </tr>
      <tr>
        <td id="L10134" data-line-number="10134"></td>
        <td id="LC10134">    <span>_ASSERTE</span>(pIndirection == <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L10135" data-line-number="10135"></td>
        <td id="LC10135">}</td>
      </tr>
      <tr>
        <td id="L10136" data-line-number="10136"></td>
        <td id="LC10136">
</td>
      </tr>
      <tr>
        <td id="L10137" data-line-number="10137"></td>
        <td id="LC10137"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10138" data-line-number="10138"></td>
        <td id="LC10138">CORINFO_JUST_MY_CODE_HANDLE <span>CEEInfo::getJustMyCodeHandle</span>(</td>
      </tr>
      <tr>
        <td id="L10139" data-line-number="10139"></td>
        <td id="LC10139">                CORINFO_METHOD_HANDLE       method,</td>
      </tr>
      <tr>
        <td id="L10140" data-line-number="10140"></td>
        <td id="LC10140">                CORINFO_JUST_MY_CODE_HANDLE**ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10141" data-line-number="10141"></td>
        <td id="LC10141">{</td>
      </tr>
      <tr>
        <td id="L10142" data-line-number="10142"></td>
        <td id="LC10142">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10143" data-line-number="10143"></td>
        <td id="LC10143">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10144" data-line-number="10144"></td>
        <td id="LC10144">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10145" data-line-number="10145"></td>
        <td id="LC10145">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10146" data-line-number="10146"></td>
        <td id="LC10146">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10147" data-line-number="10147"></td>
        <td id="LC10147">
</td>
      </tr>
      <tr>
        <td id="L10148" data-line-number="10148"></td>
        <td id="LC10148">    CORINFO_JUST_MY_CODE_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10149" data-line-number="10149"></td>
        <td id="LC10149">
</td>
      </tr>
      <tr>
        <td id="L10150" data-line-number="10150"></td>
        <td id="LC10150">    <span>if</span> (ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10151" data-line-number="10151"></td>
        <td id="LC10151">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10152" data-line-number="10152"></td>
        <td id="LC10152">
</td>
      </tr>
      <tr>
        <td id="L10153" data-line-number="10153"></td>
        <td id="LC10153">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10154" data-line-number="10154"></td>
        <td id="LC10154">
</td>
      </tr>
      <tr>
        <td id="L10155" data-line-number="10155"></td>
        <td id="LC10155">    <span><span>//</span> Get the flag from the debugger.</span></td>
      </tr>
      <tr>
        <td id="L10156" data-line-number="10156"></td>
        <td id="LC10156">    MethodDesc* ftn = <span>GetMethod</span>(method);</td>
      </tr>
      <tr>
        <td id="L10157" data-line-number="10157"></td>
        <td id="LC10157">    DWORD * pFlagAddr = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10158" data-line-number="10158"></td>
        <td id="LC10158">
</td>
      </tr>
      <tr>
        <td id="L10159" data-line-number="10159"></td>
        <td id="LC10159">    <span>if</span> (g_pDebugInterface)</td>
      </tr>
      <tr>
        <td id="L10160" data-line-number="10160"></td>
        <td id="LC10160">    {</td>
      </tr>
      <tr>
        <td id="L10161" data-line-number="10161"></td>
        <td id="LC10161">        pFlagAddr = g_pDebugInterface-&gt;<span>GetJMCFlagAddr</span>(ftn-&gt;<span>GetModule</span>());</td>
      </tr>
      <tr>
        <td id="L10162" data-line-number="10162"></td>
        <td id="LC10162">    }</td>
      </tr>
      <tr>
        <td id="L10163" data-line-number="10163"></td>
        <td id="LC10163">
</td>
      </tr>
      <tr>
        <td id="L10164" data-line-number="10164"></td>
        <td id="LC10164">    result = (CORINFO_JUST_MY_CODE_HANDLE) pFlagAddr;</td>
      </tr>
      <tr>
        <td id="L10165" data-line-number="10165"></td>
        <td id="LC10165">
</td>
      </tr>
      <tr>
        <td id="L10166" data-line-number="10166"></td>
        <td id="LC10166">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10167" data-line-number="10167"></td>
        <td id="LC10167">
</td>
      </tr>
      <tr>
        <td id="L10168" data-line-number="10168"></td>
        <td id="LC10168">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10169" data-line-number="10169"></td>
        <td id="LC10169">}</td>
      </tr>
      <tr>
        <td id="L10170" data-line-number="10170"></td>
        <td id="LC10170">
</td>
      </tr>
      <tr>
        <td id="L10171" data-line-number="10171"></td>
        <td id="LC10171"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10172" data-line-number="10172"></td>
        <td id="LC10172"><span>void</span> <span>InlinedCallFrame::GetEEInfo</span>(CORINFO_EE_INFO::InlinedCallFrameInfo *pInfo)</td>
      </tr>
      <tr>
        <td id="L10173" data-line-number="10173"></td>
        <td id="LC10173">{</td>
      </tr>
      <tr>
        <td id="L10174" data-line-number="10174"></td>
        <td id="LC10174">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L10175" data-line-number="10175"></td>
        <td id="LC10175">
</td>
      </tr>
      <tr>
        <td id="L10176" data-line-number="10176"></td>
        <td id="LC10176">    pInfo-&gt;<span>size</span>                          = <span>sizeof</span>(GSCookie) + <span>sizeof</span>(InlinedCallFrame);</td>
      </tr>
      <tr>
        <td id="L10177" data-line-number="10177"></td>
        <td id="LC10177">
</td>
      </tr>
      <tr>
        <td id="L10178" data-line-number="10178"></td>
        <td id="LC10178">    pInfo-&gt;<span>offsetOfGSCookie</span>              = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10179" data-line-number="10179"></td>
        <td id="LC10179">    pInfo-&gt;<span>offsetOfFrameVptr</span>             = <span>sizeof</span>(GSCookie);</td>
      </tr>
      <tr>
        <td id="L10180" data-line-number="10180"></td>
        <td id="LC10180">    pInfo-&gt;<span>offsetOfFrameLink</span>             = <span>sizeof</span>(GSCookie) + <span>Frame::GetOffsetOfNextLink</span>();</td>
      </tr>
      <tr>
        <td id="L10181" data-line-number="10181"></td>
        <td id="LC10181">    pInfo-&gt;<span>offsetOfCallSiteSP</span>            = <span>sizeof</span>(GSCookie) + <span>offsetof</span>(InlinedCallFrame, m_pCallSiteSP);</td>
      </tr>
      <tr>
        <td id="L10182" data-line-number="10182"></td>
        <td id="LC10182">    pInfo-&gt;<span>offsetOfCalleeSavedFP</span>         = <span>sizeof</span>(GSCookie) + <span>offsetof</span>(InlinedCallFrame, m_pCalleeSavedFP);</td>
      </tr>
      <tr>
        <td id="L10183" data-line-number="10183"></td>
        <td id="LC10183">    pInfo-&gt;<span>offsetOfCallTarget</span>            = <span>sizeof</span>(GSCookie) + <span>offsetof</span>(InlinedCallFrame, m_Datum);</td>
      </tr>
      <tr>
        <td id="L10184" data-line-number="10184"></td>
        <td id="LC10184">    pInfo-&gt;<span>offsetOfReturnAddress</span>         = <span>sizeof</span>(GSCookie) + <span>offsetof</span>(InlinedCallFrame, m_pCallerReturnAddress);</td>
      </tr>
      <tr>
        <td id="L10185" data-line-number="10185"></td>
        <td id="LC10185">#<span>ifdef</span> TARGET_ARM</td>
      </tr>
      <tr>
        <td id="L10186" data-line-number="10186"></td>
        <td id="LC10186">    pInfo-&gt;<span>offsetOfSPAfterProlog</span>         = <span>sizeof</span>(GSCookie) + <span>offsetof</span>(InlinedCallFrame, m_pSPAfterProlog);</td>
      </tr>
      <tr>
        <td id="L10187" data-line-number="10187"></td>
        <td id="LC10187">#<span>endif</span> <span><span>//</span> TARGET_ARM</span></td>
      </tr>
      <tr>
        <td id="L10188" data-line-number="10188"></td>
        <td id="LC10188">}</td>
      </tr>
      <tr>
        <td id="L10189" data-line-number="10189"></td>
        <td id="LC10189">
</td>
      </tr>
      <tr>
        <td id="L10190" data-line-number="10190"></td>
        <td id="LC10190"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10191" data-line-number="10191"></td>
        <td id="LC10191"><span><span>//</span> Return details about EE internal data structures</span></td>
      </tr>
      <tr>
        <td id="L10192" data-line-number="10192"></td>
        <td id="LC10192"><span>void</span> <span>CEEInfo::getEEInfo</span>(CORINFO_EE_INFO *pEEInfoOut)</td>
      </tr>
      <tr>
        <td id="L10193" data-line-number="10193"></td>
        <td id="LC10193">{</td>
      </tr>
      <tr>
        <td id="L10194" data-line-number="10194"></td>
        <td id="LC10194">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10195" data-line-number="10195"></td>
        <td id="LC10195">        THROWS;</td>
      </tr>
      <tr>
        <td id="L10196" data-line-number="10196"></td>
        <td id="LC10196">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10197" data-line-number="10197"></td>
        <td id="LC10197">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10198" data-line-number="10198"></td>
        <td id="LC10198">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10199" data-line-number="10199"></td>
        <td id="LC10199">
</td>
      </tr>
      <tr>
        <td id="L10200" data-line-number="10200"></td>
        <td id="LC10200">    <span>INDEBUG</span>(<span>memset</span>(pEEInfoOut, <span>0xCC</span>, <span>sizeof</span>(*pEEInfoOut)));</td>
      </tr>
      <tr>
        <td id="L10201" data-line-number="10201"></td>
        <td id="LC10201">
</td>
      </tr>
      <tr>
        <td id="L10202" data-line-number="10202"></td>
        <td id="LC10202">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10203" data-line-number="10203"></td>
        <td id="LC10203">
</td>
      </tr>
      <tr>
        <td id="L10204" data-line-number="10204"></td>
        <td id="LC10204">    <span>if</span> (!<span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L10205" data-line-number="10205"></td>
        <td id="LC10205">    {</td>
      </tr>
      <tr>
        <td id="L10206" data-line-number="10206"></td>
        <td id="LC10206">        <span>InlinedCallFrame::GetEEInfo</span>(&amp;pEEInfoOut-&gt;<span>inlinedCallFrameInfo</span>);</td>
      </tr>
      <tr>
        <td id="L10207" data-line-number="10207"></td>
        <td id="LC10207">
</td>
      </tr>
      <tr>
        <td id="L10208" data-line-number="10208"></td>
        <td id="LC10208">        <span><span>//</span> Offsets into the Thread structure</span></td>
      </tr>
      <tr>
        <td id="L10209" data-line-number="10209"></td>
        <td id="LC10209">        pEEInfoOut-&gt;<span>offsetOfThreadFrame</span> = <span>Thread::GetOffsetOfCurrentFrame</span>();</td>
      </tr>
      <tr>
        <td id="L10210" data-line-number="10210"></td>
        <td id="LC10210">        pEEInfoOut-&gt;<span>offsetOfGCState</span>     = <span>Thread::GetOffsetOfGCFlag</span>();</td>
      </tr>
      <tr>
        <td id="L10211" data-line-number="10211"></td>
        <td id="LC10211">    }</td>
      </tr>
      <tr>
        <td id="L10212" data-line-number="10212"></td>
        <td id="LC10212">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L10213" data-line-number="10213"></td>
        <td id="LC10213">    {</td>
      </tr>
      <tr>
        <td id="L10214" data-line-number="10214"></td>
        <td id="LC10214">        <span><span>//</span> We'll declare a fixed size to use for the inlined call frame for R2R here. The size we declare</span></td>
      </tr>
      <tr>
        <td id="L10215" data-line-number="10215"></td>
        <td id="LC10215">        <span><span>//</span> is currently slightly larger that the actual size of the struct, just in case we decide to add</span></td>
      </tr>
      <tr>
        <td id="L10216" data-line-number="10216"></td>
        <td id="LC10216">        <span><span>//</span> more fields to the struct in the future, in an effort to not completely invalidate existing R2R images.</span></td>
      </tr>
      <tr>
        <td id="L10217" data-line-number="10217"></td>
        <td id="LC10217">        <span><span>//</span> The assert below ensures that this fixed size is at least large enough to hold the data structures</span></td>
      </tr>
      <tr>
        <td id="L10218" data-line-number="10218"></td>
        <td id="LC10218">        <span><span>//</span> used at runtime.</span></td>
      </tr>
      <tr>
        <td id="L10219" data-line-number="10219"></td>
        <td id="LC10219">        <span><span>//</span> ** IMPORTANT ** If you ever need to change the value of this fixed size, make sure to change the R2R</span></td>
      </tr>
      <tr>
        <td id="L10220" data-line-number="10220"></td>
        <td id="LC10220">        <span><span>//</span> version number, otherwise older R2R images will probably crash when used.</span></td>
      </tr>
      <tr>
        <td id="L10221" data-line-number="10221"></td>
        <td id="LC10221">
</td>
      </tr>
      <tr>
        <td id="L10222" data-line-number="10222"></td>
        <td id="LC10222">        <span>const</span> <span>int</span> r2rInlinedCallFrameSize = TARGET_POINTER_SIZE * READYTORUN_PInvokeTransitionFrameSizeInPointerUnits;</td>
      </tr>
      <tr>
        <td id="L10223" data-line-number="10223"></td>
        <td id="LC10223">
</td>
      </tr>
      <tr>
        <td id="L10224" data-line-number="10224"></td>
        <td id="LC10224">#<span>if</span> defined(_DEBUG) &amp;&amp; !defined(CROSSBITNESS_COMPILE)</td>
      </tr>
      <tr>
        <td id="L10225" data-line-number="10225"></td>
        <td id="LC10225">        <span>InlinedCallFrame::GetEEInfo</span>(&amp;pEEInfoOut-&gt;<span>inlinedCallFrameInfo</span>);</td>
      </tr>
      <tr>
        <td id="L10226" data-line-number="10226"></td>
        <td id="LC10226">        <span>_ASSERTE</span>(pEEInfoOut-&gt;<span>inlinedCallFrameInfo</span>.<span>size</span> &lt;= r2rInlinedCallFrameSize);</td>
      </tr>
      <tr>
        <td id="L10227" data-line-number="10227"></td>
        <td id="LC10227">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10228" data-line-number="10228"></td>
        <td id="LC10228">
</td>
      </tr>
      <tr>
        <td id="L10229" data-line-number="10229"></td>
        <td id="LC10229">        <span><span>//</span> inlinedCallFrameInfo is mostly not used for R2R compilation (only the size field is used)</span></td>
      </tr>
      <tr>
        <td id="L10230" data-line-number="10230"></td>
        <td id="LC10230">        <span>ZeroMemory</span>(&amp;pEEInfoOut-&gt;<span>inlinedCallFrameInfo</span>, <span>sizeof</span>(pEEInfoOut-&gt;<span>inlinedCallFrameInfo</span>));</td>
      </tr>
      <tr>
        <td id="L10231" data-line-number="10231"></td>
        <td id="LC10231">
</td>
      </tr>
      <tr>
        <td id="L10232" data-line-number="10232"></td>
        <td id="LC10232">        pEEInfoOut-&gt;<span>offsetOfThreadFrame</span>         = (DWORD)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L10233" data-line-number="10233"></td>
        <td id="LC10233">        pEEInfoOut-&gt;<span>offsetOfGCState</span>             = (DWORD)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L10234" data-line-number="10234"></td>
        <td id="LC10234">        pEEInfoOut-&gt;<span>inlinedCallFrameInfo</span>.<span>size</span>   = r2rInlinedCallFrameSize;</td>
      </tr>
      <tr>
        <td id="L10235" data-line-number="10235"></td>
        <td id="LC10235">    }</td>
      </tr>
      <tr>
        <td id="L10236" data-line-number="10236"></td>
        <td id="LC10236">
</td>
      </tr>
      <tr>
        <td id="L10237" data-line-number="10237"></td>
        <td id="LC10237">#<span>ifndef</span> CROSSBITNESS_COMPILE</td>
      </tr>
      <tr>
        <td id="L10238" data-line-number="10238"></td>
        <td id="LC10238">    <span><span>//</span> The assertions must hold in every non-crossbitness scenario</span></td>
      </tr>
      <tr>
        <td id="L10239" data-line-number="10239"></td>
        <td id="LC10239">    <span>_ASSERTE</span>(OFFSETOF__DelegateObject__target       == <span>DelegateObject::GetOffsetOfTarget</span>());</td>
      </tr>
      <tr>
        <td id="L10240" data-line-number="10240"></td>
        <td id="LC10240">    <span>_ASSERTE</span>(OFFSETOF__DelegateObject__methodPtr    == <span>DelegateObject::GetOffsetOfMethodPtr</span>());</td>
      </tr>
      <tr>
        <td id="L10241" data-line-number="10241"></td>
        <td id="LC10241">    <span>_ASSERTE</span>(OFFSETOF__DelegateObject__methodPtrAux == <span>DelegateObject::GetOffsetOfMethodPtrAux</span>());</td>
      </tr>
      <tr>
        <td id="L10242" data-line-number="10242"></td>
        <td id="LC10242">    <span>_ASSERTE</span>(OFFSETOF__PtrArray__m_Array_           == <span>PtrArray::GetDataOffset</span>());</td>
      </tr>
      <tr>
        <td id="L10243" data-line-number="10243"></td>
        <td id="LC10243">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10244" data-line-number="10244"></td>
        <td id="LC10244">
</td>
      </tr>
      <tr>
        <td id="L10245" data-line-number="10245"></td>
        <td id="LC10245">    <span><span>//</span> Delegate offsets</span></td>
      </tr>
      <tr>
        <td id="L10246" data-line-number="10246"></td>
        <td id="LC10246">    pEEInfoOut-&gt;<span>offsetOfDelegateInstance</span>    = OFFSETOF__DelegateObject__target;</td>
      </tr>
      <tr>
        <td id="L10247" data-line-number="10247"></td>
        <td id="LC10247">    pEEInfoOut-&gt;<span>offsetOfDelegateFirstTarget</span> = OFFSETOF__DelegateObject__methodPtr;</td>
      </tr>
      <tr>
        <td id="L10248" data-line-number="10248"></td>
        <td id="LC10248">
</td>
      </tr>
      <tr>
        <td id="L10249" data-line-number="10249"></td>
        <td id="LC10249">    <span><span>//</span> Wrapper delegate offsets</span></td>
      </tr>
      <tr>
        <td id="L10250" data-line-number="10250"></td>
        <td id="LC10250">    pEEInfoOut-&gt;<span>offsetOfWrapperDelegateIndirectCell</span> = OFFSETOF__DelegateObject__methodPtrAux;</td>
      </tr>
      <tr>
        <td id="L10251" data-line-number="10251"></td>
        <td id="LC10251">
</td>
      </tr>
      <tr>
        <td id="L10252" data-line-number="10252"></td>
        <td id="LC10252">    <span><span>//</span> Remoting offsets</span></td>
      </tr>
      <tr>
        <td id="L10253" data-line-number="10253"></td>
        <td id="LC10253">    pEEInfoOut-&gt;<span>offsetOfTransparentProxyRP</span> = (DWORD)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L10254" data-line-number="10254"></td>
        <td id="LC10254">    pEEInfoOut-&gt;<span>offsetOfRealProxyServer</span>    = (DWORD)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L10255" data-line-number="10255"></td>
        <td id="LC10255">
</td>
      </tr>
      <tr>
        <td id="L10256" data-line-number="10256"></td>
        <td id="LC10256">    pEEInfoOut-&gt;<span>offsetOfObjArrayData</span>       = OFFSETOF__PtrArray__m_Array_;</td>
      </tr>
      <tr>
        <td id="L10257" data-line-number="10257"></td>
        <td id="LC10257">
</td>
      </tr>
      <tr>
        <td id="L10258" data-line-number="10258"></td>
        <td id="LC10258">    pEEInfoOut-&gt;<span>sizeOfReversePInvokeFrame</span>  = (DWORD)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L10259" data-line-number="10259"></td>
        <td id="LC10259">
</td>
      </tr>
      <tr>
        <td id="L10260" data-line-number="10260"></td>
        <td id="LC10260">    pEEInfoOut-&gt;<span>osPageSize</span> = <span>GetOsPageSize</span>();</td>
      </tr>
      <tr>
        <td id="L10261" data-line-number="10261"></td>
        <td id="LC10261">    pEEInfoOut-&gt;<span>maxUncheckedOffsetForNullObject</span> = MAX_UNCHECKED_OFFSET_FOR_NULL_OBJECT;</td>
      </tr>
      <tr>
        <td id="L10262" data-line-number="10262"></td>
        <td id="LC10262">    pEEInfoOut-&gt;<span>targetAbi</span> = CORINFO_CORECLR_ABI;</td>
      </tr>
      <tr>
        <td id="L10263" data-line-number="10263"></td>
        <td id="LC10263">
</td>
      </tr>
      <tr>
        <td id="L10264" data-line-number="10264"></td>
        <td id="LC10264">#<span>ifdef</span> TARGET_UNIX</td>
      </tr>
      <tr>
        <td id="L10265" data-line-number="10265"></td>
        <td id="LC10265">    pEEInfoOut-&gt;<span>osType</span> = CORINFO_UNIX;</td>
      </tr>
      <tr>
        <td id="L10266" data-line-number="10266"></td>
        <td id="LC10266">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L10267" data-line-number="10267"></td>
        <td id="LC10267">    pEEInfoOut-&gt;<span>osType</span> = CORINFO_WINNT;</td>
      </tr>
      <tr>
        <td id="L10268" data-line-number="10268"></td>
        <td id="LC10268">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10269" data-line-number="10269"></td>
        <td id="LC10269">
</td>
      </tr>
      <tr>
        <td id="L10270" data-line-number="10270"></td>
        <td id="LC10270">    <span><span>//</span> hardcode OS version to 0.0.0. These fields can be removed from JITEE interface</span></td>
      </tr>
      <tr>
        <td id="L10271" data-line-number="10271"></td>
        <td id="LC10271">    pEEInfoOut-&gt;<span>osMajor</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10272" data-line-number="10272"></td>
        <td id="LC10272">    pEEInfoOut-&gt;<span>osMinor</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10273" data-line-number="10273"></td>
        <td id="LC10273">    pEEInfoOut-&gt;<span>osBuild</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10274" data-line-number="10274"></td>
        <td id="LC10274">
</td>
      </tr>
      <tr>
        <td id="L10275" data-line-number="10275"></td>
        <td id="LC10275">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10276" data-line-number="10276"></td>
        <td id="LC10276">}</td>
      </tr>
      <tr>
        <td id="L10277" data-line-number="10277"></td>
        <td id="LC10277">
</td>
      </tr>
      <tr>
        <td id="L10278" data-line-number="10278"></td>
        <td id="LC10278">LPCWSTR <span>CEEInfo::getJitTimeLogFilename</span>()</td>
      </tr>
      <tr>
        <td id="L10279" data-line-number="10279"></td>
        <td id="LC10279">{</td>
      </tr>
      <tr>
        <td id="L10280" data-line-number="10280"></td>
        <td id="LC10280">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10281" data-line-number="10281"></td>
        <td id="LC10281">        THROWS;</td>
      </tr>
      <tr>
        <td id="L10282" data-line-number="10282"></td>
        <td id="LC10282">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10283" data-line-number="10283"></td>
        <td id="LC10283">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10284" data-line-number="10284"></td>
        <td id="LC10284">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10285" data-line-number="10285"></td>
        <td id="LC10285">
</td>
      </tr>
      <tr>
        <td id="L10286" data-line-number="10286"></td>
        <td id="LC10286">    LPCWSTR result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10287" data-line-number="10287"></td>
        <td id="LC10287">
</td>
      </tr>
      <tr>
        <td id="L10288" data-line-number="10288"></td>
        <td id="LC10288">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10289" data-line-number="10289"></td>
        <td id="LC10289">    result = <span>CLRConfig::GetConfigValue</span>(CLRConfig::INTERNAL_JitTimeLogFile);</td>
      </tr>
      <tr>
        <td id="L10290" data-line-number="10290"></td>
        <td id="LC10290">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10291" data-line-number="10291"></td>
        <td id="LC10291">
</td>
      </tr>
      <tr>
        <td id="L10292" data-line-number="10292"></td>
        <td id="LC10292">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10293" data-line-number="10293"></td>
        <td id="LC10293">}</td>
      </tr>
      <tr>
        <td id="L10294" data-line-number="10294"></td>
        <td id="LC10294">
</td>
      </tr>
      <tr>
        <td id="L10295" data-line-number="10295"></td>
        <td id="LC10295">
</td>
      </tr>
      <tr>
        <td id="L10296" data-line-number="10296"></td>
        <td id="LC10296">
</td>
      </tr>
      <tr>
        <td id="L10297" data-line-number="10297"></td>
        <td id="LC10297">    <span><span>//</span> Return details about EE internal data structures</span></td>
      </tr>
      <tr>
        <td id="L10298" data-line-number="10298"></td>
        <td id="LC10298">DWORD <span>CEEInfo::getThreadTLSIndex</span>(<span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10299" data-line-number="10299"></td>
        <td id="LC10299">{</td>
      </tr>
      <tr>
        <td id="L10300" data-line-number="10300"></td>
        <td id="LC10300">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10301" data-line-number="10301"></td>
        <td id="LC10301">        THROWS;</td>
      </tr>
      <tr>
        <td id="L10302" data-line-number="10302"></td>
        <td id="LC10302">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10303" data-line-number="10303"></td>
        <td id="LC10303">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10304" data-line-number="10304"></td>
        <td id="LC10304">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10305" data-line-number="10305"></td>
        <td id="LC10305">
</td>
      </tr>
      <tr>
        <td id="L10306" data-line-number="10306"></td>
        <td id="LC10306">    DWORD result = (DWORD)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L10307" data-line-number="10307"></td>
        <td id="LC10307">
</td>
      </tr>
      <tr>
        <td id="L10308" data-line-number="10308"></td>
        <td id="LC10308">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10309" data-line-number="10309"></td>
        <td id="LC10309">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10310" data-line-number="10310"></td>
        <td id="LC10310">
</td>
      </tr>
      <tr>
        <td id="L10311" data-line-number="10311"></td>
        <td id="LC10311">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10312" data-line-number="10312"></td>
        <td id="LC10312">}</td>
      </tr>
      <tr>
        <td id="L10313" data-line-number="10313"></td>
        <td id="LC10313">
</td>
      </tr>
      <tr>
        <td id="L10314" data-line-number="10314"></td>
        <td id="LC10314"><span>const</span> <span>void</span> * <span>CEEInfo::getInlinedCallFrameVptr</span>(<span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10315" data-line-number="10315"></td>
        <td id="LC10315">{</td>
      </tr>
      <tr>
        <td id="L10316" data-line-number="10316"></td>
        <td id="LC10316">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10317" data-line-number="10317"></td>
        <td id="LC10317">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10318" data-line-number="10318"></td>
        <td id="LC10318">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10319" data-line-number="10319"></td>
        <td id="LC10319">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10320" data-line-number="10320"></td>
        <td id="LC10320">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10321" data-line-number="10321"></td>
        <td id="LC10321">
</td>
      </tr>
      <tr>
        <td id="L10322" data-line-number="10322"></td>
        <td id="LC10322">    <span>void</span> * result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10323" data-line-number="10323"></td>
        <td id="LC10323">
</td>
      </tr>
      <tr>
        <td id="L10324" data-line-number="10324"></td>
        <td id="LC10324">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10325" data-line-number="10325"></td>
        <td id="LC10325">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10326" data-line-number="10326"></td>
        <td id="LC10326">
</td>
      </tr>
      <tr>
        <td id="L10327" data-line-number="10327"></td>
        <td id="LC10327">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10328" data-line-number="10328"></td>
        <td id="LC10328">
</td>
      </tr>
      <tr>
        <td id="L10329" data-line-number="10329"></td>
        <td id="LC10329">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L10330" data-line-number="10330"></td>
        <td id="LC10330">    result = (<span>void</span>*)<span>InlinedCallFrame::GetMethodFrameVPtr</span>();</td>
      </tr>
      <tr>
        <td id="L10331" data-line-number="10331"></td>
        <td id="LC10331">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L10332" data-line-number="10332"></td>
        <td id="LC10332">    result = (<span>void</span>*)<span>0x43210</span>;</td>
      </tr>
      <tr>
        <td id="L10333" data-line-number="10333"></td>
        <td id="LC10333">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10334" data-line-number="10334"></td>
        <td id="LC10334">
</td>
      </tr>
      <tr>
        <td id="L10335" data-line-number="10335"></td>
        <td id="LC10335">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10336" data-line-number="10336"></td>
        <td id="LC10336">
</td>
      </tr>
      <tr>
        <td id="L10337" data-line-number="10337"></td>
        <td id="LC10337">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10338" data-line-number="10338"></td>
        <td id="LC10338">}</td>
      </tr>
      <tr>
        <td id="L10339" data-line-number="10339"></td>
        <td id="LC10339">
</td>
      </tr>
      <tr>
        <td id="L10340" data-line-number="10340"></td>
        <td id="LC10340">LONG * <span>CEEInfo::getAddrOfCaptureThreadGlobal</span>(<span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10341" data-line-number="10341"></td>
        <td id="LC10341">{</td>
      </tr>
      <tr>
        <td id="L10342" data-line-number="10342"></td>
        <td id="LC10342">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10343" data-line-number="10343"></td>
        <td id="LC10343">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10344" data-line-number="10344"></td>
        <td id="LC10344">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10345" data-line-number="10345"></td>
        <td id="LC10345">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10346" data-line-number="10346"></td>
        <td id="LC10346">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10347" data-line-number="10347"></td>
        <td id="LC10347">
</td>
      </tr>
      <tr>
        <td id="L10348" data-line-number="10348"></td>
        <td id="LC10348">    LONG * result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10349" data-line-number="10349"></td>
        <td id="LC10349">
</td>
      </tr>
      <tr>
        <td id="L10350" data-line-number="10350"></td>
        <td id="LC10350">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10351" data-line-number="10351"></td>
        <td id="LC10351">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10352" data-line-number="10352"></td>
        <td id="LC10352">
</td>
      </tr>
      <tr>
        <td id="L10353" data-line-number="10353"></td>
        <td id="LC10353">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10354" data-line-number="10354"></td>
        <td id="LC10354">
</td>
      </tr>
      <tr>
        <td id="L10355" data-line-number="10355"></td>
        <td id="LC10355">    result = (LONG *)&amp;g_TrapReturningThreads;</td>
      </tr>
      <tr>
        <td id="L10356" data-line-number="10356"></td>
        <td id="LC10356">
</td>
      </tr>
      <tr>
        <td id="L10357" data-line-number="10357"></td>
        <td id="LC10357">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10358" data-line-number="10358"></td>
        <td id="LC10358">
</td>
      </tr>
      <tr>
        <td id="L10359" data-line-number="10359"></td>
        <td id="LC10359">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10360" data-line-number="10360"></td>
        <td id="LC10360">}</td>
      </tr>
      <tr>
        <td id="L10361" data-line-number="10361"></td>
        <td id="LC10361">
</td>
      </tr>
      <tr>
        <td id="L10362" data-line-number="10362"></td>
        <td id="LC10362">
</td>
      </tr>
      <tr>
        <td id="L10363" data-line-number="10363"></td>
        <td id="LC10363">
</td>
      </tr>
      <tr>
        <td id="L10364" data-line-number="10364"></td>
        <td id="LC10364">HRESULT <span>CEEInfo::GetErrorHRESULT</span>(<span>struct</span> <span>_EXCEPTION_POINTERS</span> *pExceptionPointers)</td>
      </tr>
      <tr>
        <td id="L10365" data-line-number="10365"></td>
        <td id="LC10365">{</td>
      </tr>
      <tr>
        <td id="L10366" data-line-number="10366"></td>
        <td id="LC10366">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10367" data-line-number="10367"></td>
        <td id="LC10367">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10368" data-line-number="10368"></td>
        <td id="LC10368">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10369" data-line-number="10369"></td>
        <td id="LC10369">        MODE_ANY;</td>
      </tr>
      <tr>
        <td id="L10370" data-line-number="10370"></td>
        <td id="LC10370">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10371" data-line-number="10371"></td>
        <td id="LC10371">
</td>
      </tr>
      <tr>
        <td id="L10372" data-line-number="10372"></td>
        <td id="LC10372">    HRESULT hr = S_OK;</td>
      </tr>
      <tr>
        <td id="L10373" data-line-number="10373"></td>
        <td id="LC10373">
</td>
      </tr>
      <tr>
        <td id="L10374" data-line-number="10374"></td>
        <td id="LC10374">    <span><span>//</span>This function is called from the JIT64 exception filter during PEVerify.  Because it is a filter, it</span></td>
      </tr>
      <tr>
        <td id="L10375" data-line-number="10375"></td>
        <td id="LC10375">    <span><span>//</span>can be "called" from a NOTHROW region in the case of StackOverflow.  Security::MapToHR throws</span></td>
      </tr>
      <tr>
        <td id="L10376" data-line-number="10376"></td>
        <td id="LC10376">    <span><span>//</span>internally, but it catches all exceptions.  Therefore, none of the children can cause an exception to</span></td>
      </tr>
      <tr>
        <td id="L10377" data-line-number="10377"></td>
        <td id="LC10377">    <span><span>//</span>percolate out of this function (except for Stack Overflow).  Obviously I can't explain most of this to</span></td>
      </tr>
      <tr>
        <td id="L10378" data-line-number="10378"></td>
        <td id="LC10378">    <span><span>//</span>the Contracts system, and I can't add this CONTRACT_VIOLATION to the filter in Jit64.</span></td>
      </tr>
      <tr>
        <td id="L10379" data-line-number="10379"></td>
        <td id="LC10379">    <span>CONTRACT_VIOLATION</span>(ThrowsViolation);</td>
      </tr>
      <tr>
        <td id="L10380" data-line-number="10380"></td>
        <td id="LC10380">
</td>
      </tr>
      <tr>
        <td id="L10381" data-line-number="10381"></td>
        <td id="LC10381">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10382" data-line-number="10382"></td>
        <td id="LC10382">
</td>
      </tr>
      <tr>
        <td id="L10383" data-line-number="10383"></td>
        <td id="LC10383">    <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L10384" data-line-number="10384"></td>
        <td id="LC10384">
</td>
      </tr>
      <tr>
        <td id="L10385" data-line-number="10385"></td>
        <td id="LC10385">    OBJECTREF throwable = <span>GetThread</span>()-&gt;<span>LastThrownObject</span>();</td>
      </tr>
      <tr>
        <td id="L10386" data-line-number="10386"></td>
        <td id="LC10386">    hr = <span>GetExceptionHResult</span>(throwable);</td>
      </tr>
      <tr>
        <td id="L10387" data-line-number="10387"></td>
        <td id="LC10387">
</td>
      </tr>
      <tr>
        <td id="L10388" data-line-number="10388"></td>
        <td id="LC10388">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10389" data-line-number="10389"></td>
        <td id="LC10389">
</td>
      </tr>
      <tr>
        <td id="L10390" data-line-number="10390"></td>
        <td id="LC10390">    <span>return</span> hr;</td>
      </tr>
      <tr>
        <td id="L10391" data-line-number="10391"></td>
        <td id="LC10391">}</td>
      </tr>
      <tr>
        <td id="L10392" data-line-number="10392"></td>
        <td id="LC10392">
</td>
      </tr>
      <tr>
        <td id="L10393" data-line-number="10393"></td>
        <td id="LC10393">
</td>
      </tr>
      <tr>
        <td id="L10394" data-line-number="10394"></td>
        <td id="LC10394">ULONG <span>CEEInfo::GetErrorMessage</span>(<span>__inout_ecount</span>(bufferLength) LPWSTR buffer, ULONG bufferLength)</td>
      </tr>
      <tr>
        <td id="L10395" data-line-number="10395"></td>
        <td id="LC10395">{</td>
      </tr>
      <tr>
        <td id="L10396" data-line-number="10396"></td>
        <td id="LC10396">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10397" data-line-number="10397"></td>
        <td id="LC10397">        THROWS;</td>
      </tr>
      <tr>
        <td id="L10398" data-line-number="10398"></td>
        <td id="LC10398">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10399" data-line-number="10399"></td>
        <td id="LC10399">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10400" data-line-number="10400"></td>
        <td id="LC10400">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10401" data-line-number="10401"></td>
        <td id="LC10401">
</td>
      </tr>
      <tr>
        <td id="L10402" data-line-number="10402"></td>
        <td id="LC10402">    ULONG result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10403" data-line-number="10403"></td>
        <td id="LC10403">
</td>
      </tr>
      <tr>
        <td id="L10404" data-line-number="10404"></td>
        <td id="LC10404">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L10405" data-line-number="10405"></td>
        <td id="LC10405">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10406" data-line-number="10406"></td>
        <td id="LC10406">
</td>
      </tr>
      <tr>
        <td id="L10407" data-line-number="10407"></td>
        <td id="LC10407">    <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L10408" data-line-number="10408"></td>
        <td id="LC10408">
</td>
      </tr>
      <tr>
        <td id="L10409" data-line-number="10409"></td>
        <td id="LC10409">    OBJECTREF throwable = <span>GetThread</span>()-&gt;<span>LastThrownObject</span>();</td>
      </tr>
      <tr>
        <td id="L10410" data-line-number="10410"></td>
        <td id="LC10410">
</td>
      </tr>
      <tr>
        <td id="L10411" data-line-number="10411"></td>
        <td id="LC10411">    <span>if</span> (throwable != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10412" data-line-number="10412"></td>
        <td id="LC10412">    {</td>
      </tr>
      <tr>
        <td id="L10413" data-line-number="10413"></td>
        <td id="LC10413">        EX_TRY</td>
      </tr>
      <tr>
        <td id="L10414" data-line-number="10414"></td>
        <td id="LC10414">        {</td>
      </tr>
      <tr>
        <td id="L10415" data-line-number="10415"></td>
        <td id="LC10415">            result = <span>GetExceptionMessage</span>(throwable, buffer, bufferLength);</td>
      </tr>
      <tr>
        <td id="L10416" data-line-number="10416"></td>
        <td id="LC10416">        }</td>
      </tr>
      <tr>
        <td id="L10417" data-line-number="10417"></td>
        <td id="LC10417">        EX_CATCH</td>
      </tr>
      <tr>
        <td id="L10418" data-line-number="10418"></td>
        <td id="LC10418">        {</td>
      </tr>
      <tr>
        <td id="L10419" data-line-number="10419"></td>
        <td id="LC10419">        }</td>
      </tr>
      <tr>
        <td id="L10420" data-line-number="10420"></td>
        <td id="LC10420">        <span>EX_END_CATCH</span>(SwallowAllExceptions)</td>
      </tr>
      <tr>
        <td id="L10421" data-line-number="10421"></td>
        <td id="LC10421">    }</td>
      </tr>
      <tr>
        <td id="L10422" data-line-number="10422"></td>
        <td id="LC10422">
</td>
      </tr>
      <tr>
        <td id="L10423" data-line-number="10423"></td>
        <td id="LC10423">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10424" data-line-number="10424"></td>
        <td id="LC10424">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10425" data-line-number="10425"></td>
        <td id="LC10425">
</td>
      </tr>
      <tr>
        <td id="L10426" data-line-number="10426"></td>
        <td id="LC10426">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10427" data-line-number="10427"></td>
        <td id="LC10427">}</td>
      </tr>
      <tr>
        <td id="L10428" data-line-number="10428"></td>
        <td id="LC10428">
</td>
      </tr>
      <tr>
        <td id="L10429" data-line-number="10429"></td>
        <td id="LC10429"><span><span>//</span> This method is called from CEEInfo::FilterException which</span></td>
      </tr>
      <tr>
        <td id="L10430" data-line-number="10430"></td>
        <td id="LC10430"><span><span>//</span> is run as part of the SEH filter clause for the JIT.</span></td>
      </tr>
      <tr>
        <td id="L10431" data-line-number="10431"></td>
        <td id="LC10431"><span><span>//</span> It is fatal to throw an exception while running a SEH filter clause</span></td>
      </tr>
      <tr>
        <td id="L10432" data-line-number="10432"></td>
        <td id="LC10432"><span><span>//</span> so our contract is NOTHROW, NOTRIGGER.</span></td>
      </tr>
      <tr>
        <td id="L10433" data-line-number="10433"></td>
        <td id="LC10433"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10434" data-line-number="10434"></td>
        <td id="LC10434">LONG <span>EEFilterException</span>(<span>struct</span> <span>_EXCEPTION_POINTERS</span> *pExceptionPointers, <span>void</span> *unused)</td>
      </tr>
      <tr>
        <td id="L10435" data-line-number="10435"></td>
        <td id="LC10435">{</td>
      </tr>
      <tr>
        <td id="L10436" data-line-number="10436"></td>
        <td id="LC10436">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10437" data-line-number="10437"></td>
        <td id="LC10437">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10438" data-line-number="10438"></td>
        <td id="LC10438">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10439" data-line-number="10439"></td>
        <td id="LC10439">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10440" data-line-number="10440"></td>
        <td id="LC10440">
</td>
      </tr>
      <tr>
        <td id="L10441" data-line-number="10441"></td>
        <td id="LC10441">    <span>int</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10442" data-line-number="10442"></td>
        <td id="LC10442">
</td>
      </tr>
      <tr>
        <td id="L10443" data-line-number="10443"></td>
        <td id="LC10443">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10444" data-line-number="10444"></td>
        <td id="LC10444">
</td>
      </tr>
      <tr>
        <td id="L10445" data-line-number="10445"></td>
        <td id="LC10445">    <span>unsigned</span> code = pExceptionPointers-&gt;<span>ExceptionRecord</span>-&gt;<span>ExceptionCode</span>;</td>
      </tr>
      <tr>
        <td id="L10446" data-line-number="10446"></td>
        <td id="LC10446">
</td>
      </tr>
      <tr>
        <td id="L10447" data-line-number="10447"></td>
        <td id="LC10447">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L10448" data-line-number="10448"></td>
        <td id="LC10448">    <span>if</span> (code == EXCEPTION_ACCESS_VIOLATION)</td>
      </tr>
      <tr>
        <td id="L10449" data-line-number="10449"></td>
        <td id="LC10449">    {</td>
      </tr>
      <tr>
        <td id="L10450" data-line-number="10450"></td>
        <td id="LC10450">        <span>static</span> <span>int</span> hit = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10451" data-line-number="10451"></td>
        <td id="LC10451">        <span>if</span> (hit++ == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L10452" data-line-number="10452"></td>
        <td id="LC10452">        {</td>
      </tr>
      <tr>
        <td id="L10453" data-line-number="10453"></td>
        <td id="LC10453">            <span>_ASSERTE</span>(!<span><span>"</span>Access violation while Jitting!<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L10454" data-line-number="10454"></td>
        <td id="LC10454">            <span><span>//</span> If you set the debugger to catch access violations and 'go'</span></td>
      </tr>
      <tr>
        <td id="L10455" data-line-number="10455"></td>
        <td id="LC10455">            <span><span>//</span> you will get back to the point at which the access violation occurred</span></td>
      </tr>
      <tr>
        <td id="L10456" data-line-number="10456"></td>
        <td id="LC10456">            result = EXCEPTION_CONTINUE_EXECUTION;</td>
      </tr>
      <tr>
        <td id="L10457" data-line-number="10457"></td>
        <td id="LC10457">        }</td>
      </tr>
      <tr>
        <td id="L10458" data-line-number="10458"></td>
        <td id="LC10458">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L10459" data-line-number="10459"></td>
        <td id="LC10459">        {</td>
      </tr>
      <tr>
        <td id="L10460" data-line-number="10460"></td>
        <td id="LC10460">            result = EXCEPTION_CONTINUE_SEARCH;</td>
      </tr>
      <tr>
        <td id="L10461" data-line-number="10461"></td>
        <td id="LC10461">        }</td>
      </tr>
      <tr>
        <td id="L10462" data-line-number="10462"></td>
        <td id="LC10462">    }</td>
      </tr>
      <tr>
        <td id="L10463" data-line-number="10463"></td>
        <td id="LC10463">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L10464" data-line-number="10464"></td>
        <td id="LC10464">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L10465" data-line-number="10465"></td>
        <td id="LC10465">    <span><span>//</span> No one should be catching breakpoint</span></td>
      </tr>
      <tr>
        <td id="L10466" data-line-number="10466"></td>
        <td id="LC10466">    <span><span>//</span> Similarly the JIT doesn't know how to reset the guard page, so it shouldn't</span></td>
      </tr>
      <tr>
        <td id="L10467" data-line-number="10467"></td>
        <td id="LC10467">    <span><span>//</span> be catching a hard stack overflow</span></td>
      </tr>
      <tr>
        <td id="L10468" data-line-number="10468"></td>
        <td id="LC10468">    <span>if</span> (code == EXCEPTION_BREAKPOINT || code == EXCEPTION_SINGLE_STEP || code == EXCEPTION_STACK_OVERFLOW)</td>
      </tr>
      <tr>
        <td id="L10469" data-line-number="10469"></td>
        <td id="LC10469">    {</td>
      </tr>
      <tr>
        <td id="L10470" data-line-number="10470"></td>
        <td id="LC10470">        result = EXCEPTION_CONTINUE_SEARCH;</td>
      </tr>
      <tr>
        <td id="L10471" data-line-number="10471"></td>
        <td id="LC10471">    }</td>
      </tr>
      <tr>
        <td id="L10472" data-line-number="10472"></td>
        <td id="LC10472">#<span>ifdef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L10473" data-line-number="10473"></td>
        <td id="LC10473">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L10474" data-line-number="10474"></td>
        <td id="LC10474">    {</td>
      </tr>
      <tr>
        <td id="L10475" data-line-number="10475"></td>
        <td id="LC10475">        result = EXCEPTION_EXECUTE_HANDLER;</td>
      </tr>
      <tr>
        <td id="L10476" data-line-number="10476"></td>
        <td id="LC10476">    }</td>
      </tr>
      <tr>
        <td id="L10477" data-line-number="10477"></td>
        <td id="LC10477">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L10478" data-line-number="10478"></td>
        <td id="LC10478">    <span>else</span> <span>if</span> (!<span>IsComPlusException</span>(pExceptionPointers-&gt;<span>ExceptionRecord</span>))</td>
      </tr>
      <tr>
        <td id="L10479" data-line-number="10479"></td>
        <td id="LC10479">    {</td>
      </tr>
      <tr>
        <td id="L10480" data-line-number="10480"></td>
        <td id="LC10480">        result = EXCEPTION_EXECUTE_HANDLER;</td>
      </tr>
      <tr>
        <td id="L10481" data-line-number="10481"></td>
        <td id="LC10481">    }</td>
      </tr>
      <tr>
        <td id="L10482" data-line-number="10482"></td>
        <td id="LC10482">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L10483" data-line-number="10483"></td>
        <td id="LC10483">    {</td>
      </tr>
      <tr>
        <td id="L10484" data-line-number="10484"></td>
        <td id="LC10484">        <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L10485" data-line-number="10485"></td>
        <td id="LC10485">
</td>
      </tr>
      <tr>
        <td id="L10486" data-line-number="10486"></td>
        <td id="LC10486">        <span><span>//</span> This is actually the LastThrown exception object.</span></td>
      </tr>
      <tr>
        <td id="L10487" data-line-number="10487"></td>
        <td id="LC10487">        OBJECTREF throwable = <span>CLRException::GetThrowableFromExceptionRecord</span>(pExceptionPointers-&gt;<span>ExceptionRecord</span>);</td>
      </tr>
      <tr>
        <td id="L10488" data-line-number="10488"></td>
        <td id="LC10488">
</td>
      </tr>
      <tr>
        <td id="L10489" data-line-number="10489"></td>
        <td id="LC10489">        <span>if</span> (throwable != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10490" data-line-number="10490"></td>
        <td id="LC10490">        {</td>
      </tr>
      <tr>
        <td id="L10491" data-line-number="10491"></td>
        <td id="LC10491">            <span>struct</span></td>
      </tr>
      <tr>
        <td id="L10492" data-line-number="10492"></td>
        <td id="LC10492">            {</td>
      </tr>
      <tr>
        <td id="L10493" data-line-number="10493"></td>
        <td id="LC10493">                OBJECTREF oLastThrownObject;</td>
      </tr>
      <tr>
        <td id="L10494" data-line-number="10494"></td>
        <td id="LC10494">            } _gc;</td>
      </tr>
      <tr>
        <td id="L10495" data-line-number="10495"></td>
        <td id="LC10495">
</td>
      </tr>
      <tr>
        <td id="L10496" data-line-number="10496"></td>
        <td id="LC10496">            <span>ZeroMemory</span>(&amp;_gc, <span>sizeof</span>(_gc));</td>
      </tr>
      <tr>
        <td id="L10497" data-line-number="10497"></td>
        <td id="LC10497">
</td>
      </tr>
      <tr>
        <td id="L10498" data-line-number="10498"></td>
        <td id="LC10498">            <span><span>//</span> Setup the throwables</span></td>
      </tr>
      <tr>
        <td id="L10499" data-line-number="10499"></td>
        <td id="LC10499">            _gc.<span>oLastThrownObject</span> = throwable;</td>
      </tr>
      <tr>
        <td id="L10500" data-line-number="10500"></td>
        <td id="LC10500">
</td>
      </tr>
      <tr>
        <td id="L10501" data-line-number="10501"></td>
        <td id="LC10501">            <span>GCPROTECT_BEGIN</span>(_gc);</td>
      </tr>
      <tr>
        <td id="L10502" data-line-number="10502"></td>
        <td id="LC10502">
</td>
      </tr>
      <tr>
        <td id="L10503" data-line-number="10503"></td>
        <td id="LC10503">            <span><span>//</span> Don't catch ThreadAbort and other uncatchable exceptions</span></td>
      </tr>
      <tr>
        <td id="L10504" data-line-number="10504"></td>
        <td id="LC10504">            <span>if</span> (<span>IsUncatchable</span>(&amp;_gc.<span>oLastThrownObject</span>))</td>
      </tr>
      <tr>
        <td id="L10505" data-line-number="10505"></td>
        <td id="LC10505">                result = EXCEPTION_CONTINUE_SEARCH;</td>
      </tr>
      <tr>
        <td id="L10506" data-line-number="10506"></td>
        <td id="LC10506">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L10507" data-line-number="10507"></td>
        <td id="LC10507">                result = EXCEPTION_EXECUTE_HANDLER;</td>
      </tr>
      <tr>
        <td id="L10508" data-line-number="10508"></td>
        <td id="LC10508">
</td>
      </tr>
      <tr>
        <td id="L10509" data-line-number="10509"></td>
        <td id="LC10509">            <span>GCPROTECT_END</span>();</td>
      </tr>
      <tr>
        <td id="L10510" data-line-number="10510"></td>
        <td id="LC10510">        }</td>
      </tr>
      <tr>
        <td id="L10511" data-line-number="10511"></td>
        <td id="LC10511">    }</td>
      </tr>
      <tr>
        <td id="L10512" data-line-number="10512"></td>
        <td id="LC10512">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10513" data-line-number="10513"></td>
        <td id="LC10513">
</td>
      </tr>
      <tr>
        <td id="L10514" data-line-number="10514"></td>
        <td id="LC10514">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10515" data-line-number="10515"></td>
        <td id="LC10515">
</td>
      </tr>
      <tr>
        <td id="L10516" data-line-number="10516"></td>
        <td id="LC10516">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10517" data-line-number="10517"></td>
        <td id="LC10517">}</td>
      </tr>
      <tr>
        <td id="L10518" data-line-number="10518"></td>
        <td id="LC10518">
</td>
      </tr>
      <tr>
        <td id="L10519" data-line-number="10519"></td>
        <td id="LC10519"><span>int</span> <span>CEEInfo::FilterException</span>(<span>struct</span> <span>_EXCEPTION_POINTERS</span> *pExceptionPointers)</td>
      </tr>
      <tr>
        <td id="L10520" data-line-number="10520"></td>
        <td id="LC10520">{</td>
      </tr>
      <tr>
        <td id="L10521" data-line-number="10521"></td>
        <td id="LC10521">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L10522" data-line-number="10522"></td>
        <td id="LC10522">    <span>return</span> <span>EEFilterException</span>(pExceptionPointers, <span>nullptr</span>);</td>
      </tr>
      <tr>
        <td id="L10523" data-line-number="10523"></td>
        <td id="LC10523">}</td>
      </tr>
      <tr>
        <td id="L10524" data-line-number="10524"></td>
        <td id="LC10524">
</td>
      </tr>
      <tr>
        <td id="L10525" data-line-number="10525"></td>
        <td id="LC10525"><span><span>//</span> This code is called if FilterException chose to handle the exception.</span></td>
      </tr>
      <tr>
        <td id="L10526" data-line-number="10526"></td>
        <td id="LC10526"><span>void</span> <span>CEEInfo::HandleException</span>(<span>struct</span> <span>_EXCEPTION_POINTERS</span> *pExceptionPointers)</td>
      </tr>
      <tr>
        <td id="L10527" data-line-number="10527"></td>
        <td id="LC10527">{</td>
      </tr>
      <tr>
        <td id="L10528" data-line-number="10528"></td>
        <td id="LC10528">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10529" data-line-number="10529"></td>
        <td id="LC10529">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10530" data-line-number="10530"></td>
        <td id="LC10530">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10531" data-line-number="10531"></td>
        <td id="LC10531">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10532" data-line-number="10532"></td>
        <td id="LC10532">
</td>
      </tr>
      <tr>
        <td id="L10533" data-line-number="10533"></td>
        <td id="LC10533">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10534" data-line-number="10534"></td>
        <td id="LC10534">
</td>
      </tr>
      <tr>
        <td id="L10535" data-line-number="10535"></td>
        <td id="LC10535">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L10536" data-line-number="10536"></td>
        <td id="LC10536">    <span>if</span> (<span>IsComPlusException</span>(pExceptionPointers-&gt;<span>ExceptionRecord</span>))</td>
      </tr>
      <tr>
        <td id="L10537" data-line-number="10537"></td>
        <td id="LC10537">    {</td>
      </tr>
      <tr>
        <td id="L10538" data-line-number="10538"></td>
        <td id="LC10538">        <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L10539" data-line-number="10539"></td>
        <td id="LC10539">
</td>
      </tr>
      <tr>
        <td id="L10540" data-line-number="10540"></td>
        <td id="LC10540">        <span><span>//</span> This is actually the LastThrown exception object.</span></td>
      </tr>
      <tr>
        <td id="L10541" data-line-number="10541"></td>
        <td id="LC10541">        OBJECTREF throwable = <span>CLRException::GetThrowableFromExceptionRecord</span>(pExceptionPointers-&gt;<span>ExceptionRecord</span>);</td>
      </tr>
      <tr>
        <td id="L10542" data-line-number="10542"></td>
        <td id="LC10542">
</td>
      </tr>
      <tr>
        <td id="L10543" data-line-number="10543"></td>
        <td id="LC10543">        <span>if</span> (throwable != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10544" data-line-number="10544"></td>
        <td id="LC10544">        {</td>
      </tr>
      <tr>
        <td id="L10545" data-line-number="10545"></td>
        <td id="LC10545">            <span>struct</span></td>
      </tr>
      <tr>
        <td id="L10546" data-line-number="10546"></td>
        <td id="LC10546">            {</td>
      </tr>
      <tr>
        <td id="L10547" data-line-number="10547"></td>
        <td id="LC10547">                OBJECTREF oLastThrownObject;</td>
      </tr>
      <tr>
        <td id="L10548" data-line-number="10548"></td>
        <td id="LC10548">                OBJECTREF oCurrentThrowable;</td>
      </tr>
      <tr>
        <td id="L10549" data-line-number="10549"></td>
        <td id="LC10549">            } _gc;</td>
      </tr>
      <tr>
        <td id="L10550" data-line-number="10550"></td>
        <td id="LC10550">
</td>
      </tr>
      <tr>
        <td id="L10551" data-line-number="10551"></td>
        <td id="LC10551">            <span>ZeroMemory</span>(&amp;_gc, <span>sizeof</span>(_gc));</td>
      </tr>
      <tr>
        <td id="L10552" data-line-number="10552"></td>
        <td id="LC10552">
</td>
      </tr>
      <tr>
        <td id="L10553" data-line-number="10553"></td>
        <td id="LC10553">            PTR_Thread pCurThread = <span>GetThread</span>();</td>
      </tr>
      <tr>
        <td id="L10554" data-line-number="10554"></td>
        <td id="LC10554">
</td>
      </tr>
      <tr>
        <td id="L10555" data-line-number="10555"></td>
        <td id="LC10555">            <span><span>//</span> Setup the throwables</span></td>
      </tr>
      <tr>
        <td id="L10556" data-line-number="10556"></td>
        <td id="LC10556">            _gc.<span>oLastThrownObject</span> = throwable;</td>
      </tr>
      <tr>
        <td id="L10557" data-line-number="10557"></td>
        <td id="LC10557">
</td>
      </tr>
      <tr>
        <td id="L10558" data-line-number="10558"></td>
        <td id="LC10558">            <span><span>//</span> This will be NULL if no managed exception is active. Otherwise,</span></td>
      </tr>
      <tr>
        <td id="L10559" data-line-number="10559"></td>
        <td id="LC10559">            <span><span>//</span> it will reference the active throwable.</span></td>
      </tr>
      <tr>
        <td id="L10560" data-line-number="10560"></td>
        <td id="LC10560">            _gc.<span>oCurrentThrowable</span> = pCurThread-&gt;<span>GetThrowable</span>();</td>
      </tr>
      <tr>
        <td id="L10561" data-line-number="10561"></td>
        <td id="LC10561">
</td>
      </tr>
      <tr>
        <td id="L10562" data-line-number="10562"></td>
        <td id="LC10562">            <span>GCPROTECT_BEGIN</span>(_gc);</td>
      </tr>
      <tr>
        <td id="L10563" data-line-number="10563"></td>
        <td id="LC10563">
</td>
      </tr>
      <tr>
        <td id="L10564" data-line-number="10564"></td>
        <td id="LC10564">            <span><span>//</span> JIT does not use or reference managed exceptions at all and simply swallows them,</span></td>
      </tr>
      <tr>
        <td id="L10565" data-line-number="10565"></td>
        <td id="LC10565">            <span><span>//</span> or lets them fly through so that they will either get caught in managed code, the VM</span></td>
      </tr>
      <tr>
        <td id="L10566" data-line-number="10566"></td>
        <td id="LC10566">            <span><span>//</span> or will go unhandled.</span></td>
      </tr>
      <tr>
        <td id="L10567" data-line-number="10567"></td>
        <td id="LC10567">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10568" data-line-number="10568"></td>
        <td id="LC10568">            <span><span>//</span> Blind swallowing of managed exceptions can break the semantic of "which exception handler"</span></td>
      </tr>
      <tr>
        <td id="L10569" data-line-number="10569"></td>
        <td id="LC10569">            <span><span>//</span> gets to process the managed exception first. The expected handler is managed code exception</span></td>
      </tr>
      <tr>
        <td id="L10570" data-line-number="10570"></td>
        <td id="LC10570">            <span><span>//</span> handler (e.g. COMPlusFrameHandler on x86 and ProcessCLRException on 64bit) which will setup</span></td>
      </tr>
      <tr>
        <td id="L10571" data-line-number="10571"></td>
        <td id="LC10571">            <span><span>//</span> the exception tracker for the exception that will enable the expected sync between the</span></td>
      </tr>
      <tr>
        <td id="L10572" data-line-number="10572"></td>
        <td id="LC10572">            <span><span>//</span> LastThrownObject (LTO), setup in RaiseTheExceptionInternalOnly, and the exception tracker.</span></td>
      </tr>
      <tr>
        <td id="L10573" data-line-number="10573"></td>
        <td id="LC10573">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10574" data-line-number="10574"></td>
        <td id="LC10574">            <span><span>//</span> However, JIT can break this by swallowing the managed exception before managed code exception</span></td>
      </tr>
      <tr>
        <td id="L10575" data-line-number="10575"></td>
        <td id="LC10575">            <span><span>//</span> handler gets a chance to setup an exception tracker for it. Since there is no cleanup</span></td>
      </tr>
      <tr>
        <td id="L10576" data-line-number="10576"></td>
        <td id="LC10576">            <span><span>//</span> done for the swallowed exception as part of the unwind (because no exception tracker may have been setup),</span></td>
      </tr>
      <tr>
        <td id="L10577" data-line-number="10577"></td>
        <td id="LC10577">            <span><span>//</span> we need to reset the LTO, if it is out of sync from the active throwable.</span></td>
      </tr>
      <tr>
        <td id="L10578" data-line-number="10578"></td>
        <td id="LC10578">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10579" data-line-number="10579"></td>
        <td id="LC10579">            <span><span>//</span> Hence, check if the LastThrownObject and active-exception throwable are in sync or not.</span></td>
      </tr>
      <tr>
        <td id="L10580" data-line-number="10580"></td>
        <td id="LC10580">            <span><span>//</span> If not, bring them in sync.</span></td>
      </tr>
      <tr>
        <td id="L10581" data-line-number="10581"></td>
        <td id="LC10581">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10582" data-line-number="10582"></td>
        <td id="LC10582">            <span><span>//</span> Example</span></td>
      </tr>
      <tr>
        <td id="L10583" data-line-number="10583"></td>
        <td id="LC10583">            <span><span>//</span> -------</span></td>
      </tr>
      <tr>
        <td id="L10584" data-line-number="10584"></td>
        <td id="LC10584">            <span><span>//</span> It is possible that an exception was already in progress and while processing it (e.g.</span></td>
      </tr>
      <tr>
        <td id="L10585" data-line-number="10585"></td>
        <td id="LC10585">            <span><span>//</span> invoking finally block), we invoked JIT that had another managed exception @ JIT-EE transition boundary</span></td>
      </tr>
      <tr>
        <td id="L10586" data-line-number="10586"></td>
        <td id="LC10586">            <span><span>//</span> that is swallowed by the JIT before managed code exception handler sees it. This breaks the sync between</span></td>
      </tr>
      <tr>
        <td id="L10587" data-line-number="10587"></td>
        <td id="LC10587">            <span><span>//</span> LTO and the active exception in the exception tracker.</span></td>
      </tr>
      <tr>
        <td id="L10588" data-line-number="10588"></td>
        <td id="LC10588">            <span>if</span> (_gc.<span>oCurrentThrowable</span> != _gc.<span>oLastThrownObject</span>)</td>
      </tr>
      <tr>
        <td id="L10589" data-line-number="10589"></td>
        <td id="LC10589">            {</td>
      </tr>
      <tr>
        <td id="L10590" data-line-number="10590"></td>
        <td id="LC10590">                <span><span>//</span> Update the LTO.</span></td>
      </tr>
      <tr>
        <td id="L10591" data-line-number="10591"></td>
        <td id="LC10591">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10592" data-line-number="10592"></td>
        <td id="LC10592">                <span><span>//</span> Note: Incase of OOM, this will get set to OOM instance.</span></td>
      </tr>
      <tr>
        <td id="L10593" data-line-number="10593"></td>
        <td id="LC10593">                pCurThread-&gt;<span>SafeSetLastThrownObject</span>(_gc.<span>oCurrentThrowable</span>);</td>
      </tr>
      <tr>
        <td id="L10594" data-line-number="10594"></td>
        <td id="LC10594">            }</td>
      </tr>
      <tr>
        <td id="L10595" data-line-number="10595"></td>
        <td id="LC10595">
</td>
      </tr>
      <tr>
        <td id="L10596" data-line-number="10596"></td>
        <td id="LC10596">            <span>GCPROTECT_END</span>();</td>
      </tr>
      <tr>
        <td id="L10597" data-line-number="10597"></td>
        <td id="LC10597">        }</td>
      </tr>
      <tr>
        <td id="L10598" data-line-number="10598"></td>
        <td id="LC10598">    }</td>
      </tr>
      <tr>
        <td id="L10599" data-line-number="10599"></td>
        <td id="LC10599">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10600" data-line-number="10600"></td>
        <td id="LC10600">
</td>
      </tr>
      <tr>
        <td id="L10601" data-line-number="10601"></td>
        <td id="LC10601">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10602" data-line-number="10602"></td>
        <td id="LC10602">}</td>
      </tr>
      <tr>
        <td id="L10603" data-line-number="10603"></td>
        <td id="LC10603">
</td>
      </tr>
      <tr>
        <td id="L10604" data-line-number="10604"></td>
        <td id="LC10604"><span>void</span> <span>ThrowExceptionForJit</span>(HRESULT res);</td>
      </tr>
      <tr>
        <td id="L10605" data-line-number="10605"></td>
        <td id="LC10605">
</td>
      </tr>
      <tr>
        <td id="L10606" data-line-number="10606"></td>
        <td id="LC10606"><span>void</span> <span>CEEInfo::ThrowExceptionForJitResult</span>(</td>
      </tr>
      <tr>
        <td id="L10607" data-line-number="10607"></td>
        <td id="LC10607">        HRESULT result)</td>
      </tr>
      <tr>
        <td id="L10608" data-line-number="10608"></td>
        <td id="LC10608">{</td>
      </tr>
      <tr>
        <td id="L10609" data-line-number="10609"></td>
        <td id="LC10609">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10610" data-line-number="10610"></td>
        <td id="LC10610">        THROWS;</td>
      </tr>
      <tr>
        <td id="L10611" data-line-number="10611"></td>
        <td id="LC10611">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10612" data-line-number="10612"></td>
        <td id="LC10612">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10613" data-line-number="10613"></td>
        <td id="LC10613">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10614" data-line-number="10614"></td>
        <td id="LC10614">
</td>
      </tr>
      <tr>
        <td id="L10615" data-line-number="10615"></td>
        <td id="LC10615">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10616" data-line-number="10616"></td>
        <td id="LC10616">
</td>
      </tr>
      <tr>
        <td id="L10617" data-line-number="10617"></td>
        <td id="LC10617">    <span>if</span> (!<span>SUCCEEDED</span>(result))</td>
      </tr>
      <tr>
        <td id="L10618" data-line-number="10618"></td>
        <td id="LC10618">        <span>ThrowExceptionForJit</span>(result);</td>
      </tr>
      <tr>
        <td id="L10619" data-line-number="10619"></td>
        <td id="LC10619">
</td>
      </tr>
      <tr>
        <td id="L10620" data-line-number="10620"></td>
        <td id="LC10620">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10621" data-line-number="10621"></td>
        <td id="LC10621">}</td>
      </tr>
      <tr>
        <td id="L10622" data-line-number="10622"></td>
        <td id="LC10622">
</td>
      </tr>
      <tr>
        <td id="L10623" data-line-number="10623"></td>
        <td id="LC10623">
</td>
      </tr>
      <tr>
        <td id="L10624" data-line-number="10624"></td>
        <td id="LC10624">CORINFO_MODULE_HANDLE <span>CEEInfo::embedModuleHandle</span>(CORINFO_MODULE_HANDLE handle,</td>
      </tr>
      <tr>
        <td id="L10625" data-line-number="10625"></td>
        <td id="LC10625">                                                 <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10626" data-line-number="10626"></td>
        <td id="LC10626">{</td>
      </tr>
      <tr>
        <td id="L10627" data-line-number="10627"></td>
        <td id="LC10627">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10628" data-line-number="10628"></td>
        <td id="LC10628">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10629" data-line-number="10629"></td>
        <td id="LC10629">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10630" data-line-number="10630"></td>
        <td id="LC10630">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10631" data-line-number="10631"></td>
        <td id="LC10631">        <span>PRECONDITION</span>(!<span>IsDynamicScope</span>(handle));</td>
      </tr>
      <tr>
        <td id="L10632" data-line-number="10632"></td>
        <td id="LC10632">    }</td>
      </tr>
      <tr>
        <td id="L10633" data-line-number="10633"></td>
        <td id="LC10633">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10634" data-line-number="10634"></td>
        <td id="LC10634">
</td>
      </tr>
      <tr>
        <td id="L10635" data-line-number="10635"></td>
        <td id="LC10635">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10636" data-line-number="10636"></td>
        <td id="LC10636">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10637" data-line-number="10637"></td>
        <td id="LC10637">
</td>
      </tr>
      <tr>
        <td id="L10638" data-line-number="10638"></td>
        <td id="LC10638">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10639" data-line-number="10639"></td>
        <td id="LC10639">
</td>
      </tr>
      <tr>
        <td id="L10640" data-line-number="10640"></td>
        <td id="LC10640">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10641" data-line-number="10641"></td>
        <td id="LC10641">
</td>
      </tr>
      <tr>
        <td id="L10642" data-line-number="10642"></td>
        <td id="LC10642">    <span>return</span> handle;</td>
      </tr>
      <tr>
        <td id="L10643" data-line-number="10643"></td>
        <td id="LC10643">}</td>
      </tr>
      <tr>
        <td id="L10644" data-line-number="10644"></td>
        <td id="LC10644">
</td>
      </tr>
      <tr>
        <td id="L10645" data-line-number="10645"></td>
        <td id="LC10645">CORINFO_CLASS_HANDLE <span>CEEInfo::embedClassHandle</span>(CORINFO_CLASS_HANDLE handle,</td>
      </tr>
      <tr>
        <td id="L10646" data-line-number="10646"></td>
        <td id="LC10646">                                               <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10647" data-line-number="10647"></td>
        <td id="LC10647">{</td>
      </tr>
      <tr>
        <td id="L10648" data-line-number="10648"></td>
        <td id="LC10648">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10649" data-line-number="10649"></td>
        <td id="LC10649">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10650" data-line-number="10650"></td>
        <td id="LC10650">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10651" data-line-number="10651"></td>
        <td id="LC10651">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10652" data-line-number="10652"></td>
        <td id="LC10652">    }</td>
      </tr>
      <tr>
        <td id="L10653" data-line-number="10653"></td>
        <td id="LC10653">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10654" data-line-number="10654"></td>
        <td id="LC10654">
</td>
      </tr>
      <tr>
        <td id="L10655" data-line-number="10655"></td>
        <td id="LC10655">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10656" data-line-number="10656"></td>
        <td id="LC10656">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10657" data-line-number="10657"></td>
        <td id="LC10657">
</td>
      </tr>
      <tr>
        <td id="L10658" data-line-number="10658"></td>
        <td id="LC10658">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10659" data-line-number="10659"></td>
        <td id="LC10659">
</td>
      </tr>
      <tr>
        <td id="L10660" data-line-number="10660"></td>
        <td id="LC10660">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10661" data-line-number="10661"></td>
        <td id="LC10661">
</td>
      </tr>
      <tr>
        <td id="L10662" data-line-number="10662"></td>
        <td id="LC10662">    <span>return</span> handle;</td>
      </tr>
      <tr>
        <td id="L10663" data-line-number="10663"></td>
        <td id="LC10663">}</td>
      </tr>
      <tr>
        <td id="L10664" data-line-number="10664"></td>
        <td id="LC10664">
</td>
      </tr>
      <tr>
        <td id="L10665" data-line-number="10665"></td>
        <td id="LC10665">CORINFO_FIELD_HANDLE <span>CEEInfo::embedFieldHandle</span>(CORINFO_FIELD_HANDLE handle,</td>
      </tr>
      <tr>
        <td id="L10666" data-line-number="10666"></td>
        <td id="LC10666">                                               <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10667" data-line-number="10667"></td>
        <td id="LC10667">{</td>
      </tr>
      <tr>
        <td id="L10668" data-line-number="10668"></td>
        <td id="LC10668">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10669" data-line-number="10669"></td>
        <td id="LC10669">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10670" data-line-number="10670"></td>
        <td id="LC10670">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10671" data-line-number="10671"></td>
        <td id="LC10671">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10672" data-line-number="10672"></td>
        <td id="LC10672">    }</td>
      </tr>
      <tr>
        <td id="L10673" data-line-number="10673"></td>
        <td id="LC10673">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10674" data-line-number="10674"></td>
        <td id="LC10674">
</td>
      </tr>
      <tr>
        <td id="L10675" data-line-number="10675"></td>
        <td id="LC10675">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10676" data-line-number="10676"></td>
        <td id="LC10676">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10677" data-line-number="10677"></td>
        <td id="LC10677">
</td>
      </tr>
      <tr>
        <td id="L10678" data-line-number="10678"></td>
        <td id="LC10678">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10679" data-line-number="10679"></td>
        <td id="LC10679">
</td>
      </tr>
      <tr>
        <td id="L10680" data-line-number="10680"></td>
        <td id="LC10680">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10681" data-line-number="10681"></td>
        <td id="LC10681">
</td>
      </tr>
      <tr>
        <td id="L10682" data-line-number="10682"></td>
        <td id="LC10682">    <span>return</span> handle;</td>
      </tr>
      <tr>
        <td id="L10683" data-line-number="10683"></td>
        <td id="LC10683">}</td>
      </tr>
      <tr>
        <td id="L10684" data-line-number="10684"></td>
        <td id="LC10684">
</td>
      </tr>
      <tr>
        <td id="L10685" data-line-number="10685"></td>
        <td id="LC10685">CORINFO_METHOD_HANDLE <span>CEEInfo::embedMethodHandle</span>(CORINFO_METHOD_HANDLE handle,</td>
      </tr>
      <tr>
        <td id="L10686" data-line-number="10686"></td>
        <td id="LC10686">                                                 <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L10687" data-line-number="10687"></td>
        <td id="LC10687">{</td>
      </tr>
      <tr>
        <td id="L10688" data-line-number="10688"></td>
        <td id="LC10688">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10689" data-line-number="10689"></td>
        <td id="LC10689">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10690" data-line-number="10690"></td>
        <td id="LC10690">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10691" data-line-number="10691"></td>
        <td id="LC10691">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10692" data-line-number="10692"></td>
        <td id="LC10692">    }</td>
      </tr>
      <tr>
        <td id="L10693" data-line-number="10693"></td>
        <td id="LC10693">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10694" data-line-number="10694"></td>
        <td id="LC10694">
</td>
      </tr>
      <tr>
        <td id="L10695" data-line-number="10695"></td>
        <td id="LC10695">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10696" data-line-number="10696"></td>
        <td id="LC10696">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10697" data-line-number="10697"></td>
        <td id="LC10697">
</td>
      </tr>
      <tr>
        <td id="L10698" data-line-number="10698"></td>
        <td id="LC10698">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10699" data-line-number="10699"></td>
        <td id="LC10699">
</td>
      </tr>
      <tr>
        <td id="L10700" data-line-number="10700"></td>
        <td id="LC10700">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10701" data-line-number="10701"></td>
        <td id="LC10701">
</td>
      </tr>
      <tr>
        <td id="L10702" data-line-number="10702"></td>
        <td id="LC10702">    <span>return</span> handle;</td>
      </tr>
      <tr>
        <td id="L10703" data-line-number="10703"></td>
        <td id="LC10703">}</td>
      </tr>
      <tr>
        <td id="L10704" data-line-number="10704"></td>
        <td id="LC10704">
</td>
      </tr>
      <tr>
        <td id="L10705" data-line-number="10705"></td>
        <td id="LC10705"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10706" data-line-number="10706"></td>
        <td id="LC10706"><span>void</span> <span>CEEInfo::setJitFlags</span>(<span>const</span> CORJIT_FLAGS&amp; jitFlags)</td>
      </tr>
      <tr>
        <td id="L10707" data-line-number="10707"></td>
        <td id="LC10707">{</td>
      </tr>
      <tr>
        <td id="L10708" data-line-number="10708"></td>
        <td id="LC10708">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L10709" data-line-number="10709"></td>
        <td id="LC10709">
</td>
      </tr>
      <tr>
        <td id="L10710" data-line-number="10710"></td>
        <td id="LC10710">    m_jitFlags = jitFlags;</td>
      </tr>
      <tr>
        <td id="L10711" data-line-number="10711"></td>
        <td id="LC10711">}</td>
      </tr>
      <tr>
        <td id="L10712" data-line-number="10712"></td>
        <td id="LC10712">
</td>
      </tr>
      <tr>
        <td id="L10713" data-line-number="10713"></td>
        <td id="LC10713"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10714" data-line-number="10714"></td>
        <td id="LC10714">DWORD <span>CEEInfo::getJitFlags</span>(CORJIT_FLAGS* jitFlags, DWORD sizeInBytes)</td>
      </tr>
      <tr>
        <td id="L10715" data-line-number="10715"></td>
        <td id="LC10715">{</td>
      </tr>
      <tr>
        <td id="L10716" data-line-number="10716"></td>
        <td id="LC10716">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10717" data-line-number="10717"></td>
        <td id="LC10717">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10718" data-line-number="10718"></td>
        <td id="LC10718">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10719" data-line-number="10719"></td>
        <td id="LC10719">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10720" data-line-number="10720"></td>
        <td id="LC10720">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10721" data-line-number="10721"></td>
        <td id="LC10721">
</td>
      </tr>
      <tr>
        <td id="L10722" data-line-number="10722"></td>
        <td id="LC10722">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10723" data-line-number="10723"></td>
        <td id="LC10723">
</td>
      </tr>
      <tr>
        <td id="L10724" data-line-number="10724"></td>
        <td id="LC10724">    <span>_ASSERTE</span>(sizeInBytes &gt;= <span>sizeof</span>(m_jitFlags));</td>
      </tr>
      <tr>
        <td id="L10725" data-line-number="10725"></td>
        <td id="LC10725">    *jitFlags = m_jitFlags;</td>
      </tr>
      <tr>
        <td id="L10726" data-line-number="10726"></td>
        <td id="LC10726">
</td>
      </tr>
      <tr>
        <td id="L10727" data-line-number="10727"></td>
        <td id="LC10727">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10728" data-line-number="10728"></td>
        <td id="LC10728">
</td>
      </tr>
      <tr>
        <td id="L10729" data-line-number="10729"></td>
        <td id="LC10729">    <span>return</span> <span>sizeof</span>(m_jitFlags);</td>
      </tr>
      <tr>
        <td id="L10730" data-line-number="10730"></td>
        <td id="LC10730">}</td>
      </tr>
      <tr>
        <td id="L10731" data-line-number="10731"></td>
        <td id="LC10731">
</td>
      </tr>
      <tr>
        <td id="L10732" data-line-number="10732"></td>
        <td id="LC10732"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10733" data-line-number="10733"></td>
        <td id="LC10733">#<span>if</span> !defined(TARGET_UNIX)</td>
      </tr>
      <tr>
        <td id="L10734" data-line-number="10734"></td>
        <td id="LC10734">
</td>
      </tr>
      <tr>
        <td id="L10735" data-line-number="10735"></td>
        <td id="LC10735"><span>struct</span> <span>RunWithErrorTrapFilterParam</span></td>
      </tr>
      <tr>
        <td id="L10736" data-line-number="10736"></td>
        <td id="LC10736">{</td>
      </tr>
      <tr>
        <td id="L10737" data-line-number="10737"></td>
        <td id="LC10737">    ICorDynamicInfo* m_corInfo;</td>
      </tr>
      <tr>
        <td id="L10738" data-line-number="10738"></td>
        <td id="LC10738">    <span>void</span> (*m_function)(<span>void</span>*);</td>
      </tr>
      <tr>
        <td id="L10739" data-line-number="10739"></td>
        <td id="LC10739">    <span>void</span>* m_param;</td>
      </tr>
      <tr>
        <td id="L10740" data-line-number="10740"></td>
        <td id="LC10740">    EXCEPTION_POINTERS m_exceptionPointers;</td>
      </tr>
      <tr>
        <td id="L10741" data-line-number="10741"></td>
        <td id="LC10741">};</td>
      </tr>
      <tr>
        <td id="L10742" data-line-number="10742"></td>
        <td id="LC10742">
</td>
      </tr>
      <tr>
        <td id="L10743" data-line-number="10743"></td>
        <td id="LC10743"><span>static</span> LONG <span>RunWithErrorTrapFilter</span>(<span>struct</span> <span>_EXCEPTION_POINTERS</span>* exceptionPointers, <span>void</span>* theParam)</td>
      </tr>
      <tr>
        <td id="L10744" data-line-number="10744"></td>
        <td id="LC10744">{</td>
      </tr>
      <tr>
        <td id="L10745" data-line-number="10745"></td>
        <td id="LC10745">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L10746" data-line-number="10746"></td>
        <td id="LC10746">
</td>
      </tr>
      <tr>
        <td id="L10747" data-line-number="10747"></td>
        <td id="LC10747">    <span>auto</span>* param = <span>reinterpret_cast</span>&lt;RunWithErrorTrapFilterParam*&gt;(theParam);</td>
      </tr>
      <tr>
        <td id="L10748" data-line-number="10748"></td>
        <td id="LC10748">    param-&gt;<span>m_exceptionPointers</span> = *exceptionPointers;</td>
      </tr>
      <tr>
        <td id="L10749" data-line-number="10749"></td>
        <td id="LC10749">    <span>return</span> param-&gt;<span>m_corInfo</span>-&gt;<span>FilterException</span>(exceptionPointers);</td>
      </tr>
      <tr>
        <td id="L10750" data-line-number="10750"></td>
        <td id="LC10750">}</td>
      </tr>
      <tr>
        <td id="L10751" data-line-number="10751"></td>
        <td id="LC10751">
</td>
      </tr>
      <tr>
        <td id="L10752" data-line-number="10752"></td>
        <td id="LC10752">#<span>endif</span> <span><span>//</span> !defined(TARGET_UNIX)</span></td>
      </tr>
      <tr>
        <td id="L10753" data-line-number="10753"></td>
        <td id="LC10753">
</td>
      </tr>
      <tr>
        <td id="L10754" data-line-number="10754"></td>
        <td id="LC10754"><span>bool</span> <span>CEEInfo::runWithErrorTrap</span>(<span>void</span> (*function)(<span>void</span>*), <span>void</span>* param)</td>
      </tr>
      <tr>
        <td id="L10755" data-line-number="10755"></td>
        <td id="LC10755">{</td>
      </tr>
      <tr>
        <td id="L10756" data-line-number="10756"></td>
        <td id="LC10756">    <span><span>//</span> No dynamic contract here because SEH is used</span></td>
      </tr>
      <tr>
        <td id="L10757" data-line-number="10757"></td>
        <td id="LC10757">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L10758" data-line-number="10758"></td>
        <td id="LC10758">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10759" data-line-number="10759"></td>
        <td id="LC10759">    STATIC_CONTRACT_MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10760" data-line-number="10760"></td>
        <td id="LC10760">
</td>
      </tr>
      <tr>
        <td id="L10761" data-line-number="10761"></td>
        <td id="LC10761">    <span><span>//</span> NOTE: the lack of JIT/EE transition markers in this method is intentional. Any</span></td>
      </tr>
      <tr>
        <td id="L10762" data-line-number="10762"></td>
        <td id="LC10762">    <span><span>//</span>       transitions into the EE proper should occur either via the call to</span></td>
      </tr>
      <tr>
        <td id="L10763" data-line-number="10763"></td>
        <td id="LC10763">    <span><span>//</span>       `EEFilterException` (which is appropriately marked) or via JIT/EE</span></td>
      </tr>
      <tr>
        <td id="L10764" data-line-number="10764"></td>
        <td id="LC10764">    <span><span>//</span>       interface calls made by `function`.</span></td>
      </tr>
      <tr>
        <td id="L10765" data-line-number="10765"></td>
        <td id="LC10765">
</td>
      </tr>
      <tr>
        <td id="L10766" data-line-number="10766"></td>
        <td id="LC10766">    <span>bool</span> success = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L10767" data-line-number="10767"></td>
        <td id="LC10767">
</td>
      </tr>
      <tr>
        <td id="L10768" data-line-number="10768"></td>
        <td id="LC10768">#<span>if</span> !defined(TARGET_UNIX)</td>
      </tr>
      <tr>
        <td id="L10769" data-line-number="10769"></td>
        <td id="LC10769">
</td>
      </tr>
      <tr>
        <td id="L10770" data-line-number="10770"></td>
        <td id="LC10770">    RunWithErrorTrapFilterParam trapParam;</td>
      </tr>
      <tr>
        <td id="L10771" data-line-number="10771"></td>
        <td id="LC10771">    trapParam.<span>m_corInfo</span> = m_pOverride == <span>nullptr</span> ? <span>this</span> : m_pOverride;</td>
      </tr>
      <tr>
        <td id="L10772" data-line-number="10772"></td>
        <td id="LC10772">    trapParam.<span>m_function</span> = function;</td>
      </tr>
      <tr>
        <td id="L10773" data-line-number="10773"></td>
        <td id="LC10773">    trapParam.<span>m_param</span> = param;</td>
      </tr>
      <tr>
        <td id="L10774" data-line-number="10774"></td>
        <td id="LC10774">
</td>
      </tr>
      <tr>
        <td id="L10775" data-line-number="10775"></td>
        <td id="LC10775">    <span>PAL_TRY</span>(RunWithErrorTrapFilterParam*, pTrapParam, &amp;trapParam)</td>
      </tr>
      <tr>
        <td id="L10776" data-line-number="10776"></td>
        <td id="LC10776">    {</td>
      </tr>
      <tr>
        <td id="L10777" data-line-number="10777"></td>
        <td id="LC10777">        pTrapParam-&gt;<span>m_function</span>(pTrapParam-&gt;<span>m_param</span>);</td>
      </tr>
      <tr>
        <td id="L10778" data-line-number="10778"></td>
        <td id="LC10778">    }</td>
      </tr>
      <tr>
        <td id="L10779" data-line-number="10779"></td>
        <td id="LC10779">    <span>PAL_EXCEPT_FILTER</span>(RunWithErrorTrapFilter)</td>
      </tr>
      <tr>
        <td id="L10780" data-line-number="10780"></td>
        <td id="LC10780">    {</td>
      </tr>
      <tr>
        <td id="L10781" data-line-number="10781"></td>
        <td id="LC10781">        <span>HandleException</span>(&amp;trapParam.<span>m_exceptionPointers</span>);</td>
      </tr>
      <tr>
        <td id="L10782" data-line-number="10782"></td>
        <td id="LC10782">        success = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L10783" data-line-number="10783"></td>
        <td id="LC10783">    }</td>
      </tr>
      <tr>
        <td id="L10784" data-line-number="10784"></td>
        <td id="LC10784">    PAL_ENDTRY</td>
      </tr>
      <tr>
        <td id="L10785" data-line-number="10785"></td>
        <td id="LC10785">
</td>
      </tr>
      <tr>
        <td id="L10786" data-line-number="10786"></td>
        <td id="LC10786">#<span>else</span> <span><span>//</span> !defined(TARGET_UNIX)</span></td>
      </tr>
      <tr>
        <td id="L10787" data-line-number="10787"></td>
        <td id="LC10787">
</td>
      </tr>
      <tr>
        <td id="L10788" data-line-number="10788"></td>
        <td id="LC10788">    <span><span>//</span> We shouldn't need PAL_TRY on *nix: any exceptions that we are able to catch</span></td>
      </tr>
      <tr>
        <td id="L10789" data-line-number="10789"></td>
        <td id="LC10789">    <span><span>//</span> ought to originate from the runtime itself and should be catchable inside of</span></td>
      </tr>
      <tr>
        <td id="L10790" data-line-number="10790"></td>
        <td id="LC10790">    <span><span>//</span> EX_TRY/EX_CATCH, including emulated SEH exceptions.</span></td>
      </tr>
      <tr>
        <td id="L10791" data-line-number="10791"></td>
        <td id="LC10791">    EX_TRY</td>
      </tr>
      <tr>
        <td id="L10792" data-line-number="10792"></td>
        <td id="LC10792">    {</td>
      </tr>
      <tr>
        <td id="L10793" data-line-number="10793"></td>
        <td id="LC10793">        <span>function</span>(param);</td>
      </tr>
      <tr>
        <td id="L10794" data-line-number="10794"></td>
        <td id="LC10794">    }</td>
      </tr>
      <tr>
        <td id="L10795" data-line-number="10795"></td>
        <td id="LC10795">    EX_CATCH</td>
      </tr>
      <tr>
        <td id="L10796" data-line-number="10796"></td>
        <td id="LC10796">    {</td>
      </tr>
      <tr>
        <td id="L10797" data-line-number="10797"></td>
        <td id="LC10797">        success = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L10798" data-line-number="10798"></td>
        <td id="LC10798">    }</td>
      </tr>
      <tr>
        <td id="L10799" data-line-number="10799"></td>
        <td id="LC10799">    <span>EX_END_CATCH</span>(RethrowTerminalExceptions);</td>
      </tr>
      <tr>
        <td id="L10800" data-line-number="10800"></td>
        <td id="LC10800">
</td>
      </tr>
      <tr>
        <td id="L10801" data-line-number="10801"></td>
        <td id="LC10801">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10802" data-line-number="10802"></td>
        <td id="LC10802">
</td>
      </tr>
      <tr>
        <td id="L10803" data-line-number="10803"></td>
        <td id="LC10803">    <span>return</span> success;</td>
      </tr>
      <tr>
        <td id="L10804" data-line-number="10804"></td>
        <td id="LC10804">}</td>
      </tr>
      <tr>
        <td id="L10805" data-line-number="10805"></td>
        <td id="LC10805">
</td>
      </tr>
      <tr>
        <td id="L10806" data-line-number="10806"></td>
        <td id="LC10806"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10807" data-line-number="10807"></td>
        <td id="LC10807">IEEMemoryManager* <span>CEEInfo::getMemoryManager</span>()</td>
      </tr>
      <tr>
        <td id="L10808" data-line-number="10808"></td>
        <td id="LC10808">{</td>
      </tr>
      <tr>
        <td id="L10809" data-line-number="10809"></td>
        <td id="LC10809">    <span>UNREACHABLE</span>(); <span><span>//</span> OBSOLETE</span></td>
      </tr>
      <tr>
        <td id="L10810" data-line-number="10810"></td>
        <td id="LC10810">    <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10811" data-line-number="10811"></td>
        <td id="LC10811">}</td>
      </tr>
      <tr>
        <td id="L10812" data-line-number="10812"></td>
        <td id="LC10812">
</td>
      </tr>
      <tr>
        <td id="L10813" data-line-number="10813"></td>
        <td id="LC10813"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10814" data-line-number="10814"></td>
        <td id="LC10814"><span>int</span> <span>CEEInfo::doAssert</span>(<span>const</span> <span>char</span>* szFile, <span>int</span> iLine, <span>const</span> <span>char</span>* szExpr)</td>
      </tr>
      <tr>
        <td id="L10815" data-line-number="10815"></td>
        <td id="LC10815">{</td>
      </tr>
      <tr>
        <td id="L10816" data-line-number="10816"></td>
        <td id="LC10816">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L10817" data-line-number="10817"></td>
        <td id="LC10817">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10818" data-line-number="10818"></td>
        <td id="LC10818">    STATIC_CONTRACT_MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10819" data-line-number="10819"></td>
        <td id="LC10819">    STATIC_CONTRACT_DEBUG_ONLY;</td>
      </tr>
      <tr>
        <td id="L10820" data-line-number="10820"></td>
        <td id="LC10820">
</td>
      </tr>
      <tr>
        <td id="L10821" data-line-number="10821"></td>
        <td id="LC10821">    <span>int</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L10822" data-line-number="10822"></td>
        <td id="LC10822">
</td>
      </tr>
      <tr>
        <td id="L10823" data-line-number="10823"></td>
        <td id="LC10823">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10824" data-line-number="10824"></td>
        <td id="LC10824">
</td>
      </tr>
      <tr>
        <td id="L10825" data-line-number="10825"></td>
        <td id="LC10825">#<span>ifdef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L10826" data-line-number="10826"></td>
        <td id="LC10826">    <span>ThrowHR</span>(COR_E_INVALIDPROGRAM);</td>
      </tr>
      <tr>
        <td id="L10827" data-line-number="10827"></td>
        <td id="LC10827">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L10828" data-line-number="10828"></td>
        <td id="LC10828">
</td>
      </tr>
      <tr>
        <td id="L10829" data-line-number="10829"></td>
        <td id="LC10829">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L10830" data-line-number="10830"></td>
        <td id="LC10830">    BEGIN_DEBUG_ONLY_CODE;</td>
      </tr>
      <tr>
        <td id="L10831" data-line-number="10831"></td>
        <td id="LC10831">    result = <span>_DbgBreakCheck</span>(szFile, iLine, szExpr);</td>
      </tr>
      <tr>
        <td id="L10832" data-line-number="10832"></td>
        <td id="LC10832">    END_DEBUG_ONLY_CODE;</td>
      </tr>
      <tr>
        <td id="L10833" data-line-number="10833"></td>
        <td id="LC10833">#<span>else</span> <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L10834" data-line-number="10834"></td>
        <td id="LC10834">    result = <span>1</span>;   <span><span>//</span> break into debugger</span></td>
      </tr>
      <tr>
        <td id="L10835" data-line-number="10835"></td>
        <td id="LC10835">#<span>endif</span> <span><span>//</span> !_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L10836" data-line-number="10836"></td>
        <td id="LC10836">
</td>
      </tr>
      <tr>
        <td id="L10837" data-line-number="10837"></td>
        <td id="LC10837">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10838" data-line-number="10838"></td>
        <td id="LC10838">
</td>
      </tr>
      <tr>
        <td id="L10839" data-line-number="10839"></td>
        <td id="LC10839">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L10840" data-line-number="10840"></td>
        <td id="LC10840">
</td>
      </tr>
      <tr>
        <td id="L10841" data-line-number="10841"></td>
        <td id="LC10841">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10842" data-line-number="10842"></td>
        <td id="LC10842">}</td>
      </tr>
      <tr>
        <td id="L10843" data-line-number="10843"></td>
        <td id="LC10843">
</td>
      </tr>
      <tr>
        <td id="L10844" data-line-number="10844"></td>
        <td id="LC10844"><span>void</span> <span>CEEInfo::reportFatalError</span>(CorJitResult result)</td>
      </tr>
      <tr>
        <td id="L10845" data-line-number="10845"></td>
        <td id="LC10845">{</td>
      </tr>
      <tr>
        <td id="L10846" data-line-number="10846"></td>
        <td id="LC10846">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L10847" data-line-number="10847"></td>
        <td id="LC10847">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10848" data-line-number="10848"></td>
        <td id="LC10848">    STATIC_CONTRACT_MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10849" data-line-number="10849"></td>
        <td id="LC10849">
</td>
      </tr>
      <tr>
        <td id="L10850" data-line-number="10850"></td>
        <td id="LC10850">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10851" data-line-number="10851"></td>
        <td id="LC10851">
</td>
      </tr>
      <tr>
        <td id="L10852" data-line-number="10852"></td>
        <td id="LC10852">    <span>STRESS_LOG2</span>(LF_JIT,LL_ERROR, <span><span>"</span>Jit reported error 0x%x while compiling 0x%p<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L10853" data-line-number="10853"></td>
        <td id="LC10853">                (<span>int</span>)result, (INT_PTR)<span>getMethodBeingCompiled</span>());</td>
      </tr>
      <tr>
        <td id="L10854" data-line-number="10854"></td>
        <td id="LC10854">
</td>
      </tr>
      <tr>
        <td id="L10855" data-line-number="10855"></td>
        <td id="LC10855">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10856" data-line-number="10856"></td>
        <td id="LC10856">}</td>
      </tr>
      <tr>
        <td id="L10857" data-line-number="10857"></td>
        <td id="LC10857">
</td>
      </tr>
      <tr>
        <td id="L10858" data-line-number="10858"></td>
        <td id="LC10858">BOOL <span>CEEInfo::logMsg</span>(<span>unsigned</span> level, <span>const</span> <span>char</span>* fmt, <span>va_list</span> args)</td>
      </tr>
      <tr>
        <td id="L10859" data-line-number="10859"></td>
        <td id="LC10859">{</td>
      </tr>
      <tr>
        <td id="L10860" data-line-number="10860"></td>
        <td id="LC10860">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L10861" data-line-number="10861"></td>
        <td id="LC10861">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L10862" data-line-number="10862"></td>
        <td id="LC10862">    STATIC_CONTRACT_MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10863" data-line-number="10863"></td>
        <td id="LC10863">    STATIC_CONTRACT_DEBUG_ONLY;</td>
      </tr>
      <tr>
        <td id="L10864" data-line-number="10864"></td>
        <td id="LC10864">
</td>
      </tr>
      <tr>
        <td id="L10865" data-line-number="10865"></td>
        <td id="LC10865">    BOOL result = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L10866" data-line-number="10866"></td>
        <td id="LC10866">
</td>
      </tr>
      <tr>
        <td id="L10867" data-line-number="10867"></td>
        <td id="LC10867">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10868" data-line-number="10868"></td>
        <td id="LC10868">
</td>
      </tr>
      <tr>
        <td id="L10869" data-line-number="10869"></td>
        <td id="LC10869">#<span>ifdef</span> LOGGING</td>
      </tr>
      <tr>
        <td id="L10870" data-line-number="10870"></td>
        <td id="LC10870">    <span>if</span> (<span>LoggingOn</span>(LF_JIT, level))</td>
      </tr>
      <tr>
        <td id="L10871" data-line-number="10871"></td>
        <td id="LC10871">    {</td>
      </tr>
      <tr>
        <td id="L10872" data-line-number="10872"></td>
        <td id="LC10872">        <span>LogSpewValist</span>(LF_JIT, level, (<span>char</span>*) fmt, args);</td>
      </tr>
      <tr>
        <td id="L10873" data-line-number="10873"></td>
        <td id="LC10873">        result = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L10874" data-line-number="10874"></td>
        <td id="LC10874">    }</td>
      </tr>
      <tr>
        <td id="L10875" data-line-number="10875"></td>
        <td id="LC10875">#<span>endif</span> <span><span>//</span> LOGGING</span></td>
      </tr>
      <tr>
        <td id="L10876" data-line-number="10876"></td>
        <td id="LC10876">
</td>
      </tr>
      <tr>
        <td id="L10877" data-line-number="10877"></td>
        <td id="LC10877">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10878" data-line-number="10878"></td>
        <td id="LC10878">
</td>
      </tr>
      <tr>
        <td id="L10879" data-line-number="10879"></td>
        <td id="LC10879">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10880" data-line-number="10880"></td>
        <td id="LC10880">}</td>
      </tr>
      <tr>
        <td id="L10881" data-line-number="10881"></td>
        <td id="LC10881">
</td>
      </tr>
      <tr>
        <td id="L10882" data-line-number="10882"></td>
        <td id="LC10882"><span>void</span> <span>CEEInfo::yieldExecution</span>()</td>
      </tr>
      <tr>
        <td id="L10883" data-line-number="10883"></td>
        <td id="LC10883">{</td>
      </tr>
      <tr>
        <td id="L10884" data-line-number="10884"></td>
        <td id="LC10884">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L10885" data-line-number="10885"></td>
        <td id="LC10885">}</td>
      </tr>
      <tr>
        <td id="L10886" data-line-number="10886"></td>
        <td id="LC10886">
</td>
      </tr>
      <tr>
        <td id="L10887" data-line-number="10887"></td>
        <td id="LC10887">
</td>
      </tr>
      <tr>
        <td id="L10888" data-line-number="10888"></td>
        <td id="LC10888">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L10889" data-line-number="10889"></td>
        <td id="LC10889">
</td>
      </tr>
      <tr>
        <td id="L10890" data-line-number="10890"></td>
        <td id="LC10890"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10891" data-line-number="10891"></td>
        <td id="LC10891">
</td>
      </tr>
      <tr>
        <td id="L10892" data-line-number="10892"></td>
        <td id="LC10892"><span>void</span>* <span>CEEJitInfo::getHelperFtn</span>(CorInfoHelpFunc    ftnNum,         <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10893" data-line-number="10893"></td>
        <td id="LC10893">                               <span>void</span> **            ppIndirection)  <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10894" data-line-number="10894"></td>
        <td id="LC10894">{</td>
      </tr>
      <tr>
        <td id="L10895" data-line-number="10895"></td>
        <td id="LC10895">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L10896" data-line-number="10896"></td>
        <td id="LC10896">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L10897" data-line-number="10897"></td>
        <td id="LC10897">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L10898" data-line-number="10898"></td>
        <td id="LC10898">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L10899" data-line-number="10899"></td>
        <td id="LC10899">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10900" data-line-number="10900"></td>
        <td id="LC10900">
</td>
      </tr>
      <tr>
        <td id="L10901" data-line-number="10901"></td>
        <td id="LC10901">    <span>void</span>* result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10902" data-line-number="10902"></td>
        <td id="LC10902">
</td>
      </tr>
      <tr>
        <td id="L10903" data-line-number="10903"></td>
        <td id="LC10903">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L10904" data-line-number="10904"></td>
        <td id="LC10904">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10905" data-line-number="10905"></td>
        <td id="LC10905">
</td>
      </tr>
      <tr>
        <td id="L10906" data-line-number="10906"></td>
        <td id="LC10906">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10907" data-line-number="10907"></td>
        <td id="LC10907">
</td>
      </tr>
      <tr>
        <td id="L10908" data-line-number="10908"></td>
        <td id="LC10908">    <span>_ASSERTE</span>(ftnNum &lt; CORINFO_HELP_COUNT);</td>
      </tr>
      <tr>
        <td id="L10909" data-line-number="10909"></td>
        <td id="LC10909">
</td>
      </tr>
      <tr>
        <td id="L10910" data-line-number="10910"></td>
        <td id="LC10910">    <span>void</span>* pfnHelper = hlpFuncTable[ftnNum].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L10911" data-line-number="10911"></td>
        <td id="LC10911">
</td>
      </tr>
      <tr>
        <td id="L10912" data-line-number="10912"></td>
        <td id="LC10912">    <span>size_t</span> dynamicFtnNum = ((<span>size_t</span>)pfnHelper - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L10913" data-line-number="10913"></td>
        <td id="LC10913">    <span>if</span> (dynamicFtnNum &lt; DYNAMIC_CORINFO_HELP_COUNT)</td>
      </tr>
      <tr>
        <td id="L10914" data-line-number="10914"></td>
        <td id="LC10914">    {</td>
      </tr>
      <tr>
        <td id="L10915" data-line-number="10915"></td>
        <td id="LC10915">#<span>ifdef</span> _PREFAST_</td>
      </tr>
      <tr>
        <td id="L10916" data-line-number="10916"></td>
        <td id="LC10916">#<span>pragma</span> warning(push)</td>
      </tr>
      <tr>
        <td id="L10917" data-line-number="10917"></td>
        <td id="LC10917">#<span>pragma</span> warning(disable:26001) <span><span>//</span> "Bounds checked above using the underflow trick"</span></td>
      </tr>
      <tr>
        <td id="L10918" data-line-number="10918"></td>
        <td id="LC10918">#<span>endif</span> <span><span>/*</span>_PREFAST_ <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10919" data-line-number="10919"></td>
        <td id="LC10919">
</td>
      </tr>
      <tr>
        <td id="L10920" data-line-number="10920"></td>
        <td id="LC10920">#<span>if</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L10921" data-line-number="10921"></td>
        <td id="LC10921">        <span><span>//</span> To avoid using a jump stub we always call certain helpers using an indirect call.</span></td>
      </tr>
      <tr>
        <td id="L10922" data-line-number="10922"></td>
        <td id="LC10922">        <span><span>//</span> Because when using a direct call and the target is father away than 2^31 bytes,</span></td>
      </tr>
      <tr>
        <td id="L10923" data-line-number="10923"></td>
        <td id="LC10923">        <span><span>//</span> the direct call instead goes to a jump stub which jumps to the jit helper.</span></td>
      </tr>
      <tr>
        <td id="L10924" data-line-number="10924"></td>
        <td id="LC10924">        <span><span>//</span> However in this process the jump stub will corrupt RAX.</span></td>
      </tr>
      <tr>
        <td id="L10925" data-line-number="10925"></td>
        <td id="LC10925">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10926" data-line-number="10926"></td>
        <td id="LC10926">        <span><span>//</span> The set of helpers for which RAX must be preserved are the profiler probes</span></td>
      </tr>
      <tr>
        <td id="L10927" data-line-number="10927"></td>
        <td id="LC10927">        <span><span>//</span> and the STOP_FOR_GC helper which maps to JIT_RareDisableHelper.</span></td>
      </tr>
      <tr>
        <td id="L10928" data-line-number="10928"></td>
        <td id="LC10928">        <span><span>//</span> In the case of the STOP_FOR_GC helper RAX can be holding a function return value.</span></td>
      </tr>
      <tr>
        <td id="L10929" data-line-number="10929"></td>
        <td id="LC10929">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L10930" data-line-number="10930"></td>
        <td id="LC10930">        <span>if</span> (dynamicFtnNum == DYNAMIC_CORINFO_HELP_STOP_FOR_GC    ||</td>
      </tr>
      <tr>
        <td id="L10931" data-line-number="10931"></td>
        <td id="LC10931">            dynamicFtnNum == DYNAMIC_CORINFO_HELP_PROF_FCN_ENTER ||</td>
      </tr>
      <tr>
        <td id="L10932" data-line-number="10932"></td>
        <td id="LC10932">            dynamicFtnNum == DYNAMIC_CORINFO_HELP_PROF_FCN_LEAVE ||</td>
      </tr>
      <tr>
        <td id="L10933" data-line-number="10933"></td>
        <td id="LC10933">            dynamicFtnNum == DYNAMIC_CORINFO_HELP_PROF_FCN_TAILCALL)</td>
      </tr>
      <tr>
        <td id="L10934" data-line-number="10934"></td>
        <td id="LC10934">        {</td>
      </tr>
      <tr>
        <td id="L10935" data-line-number="10935"></td>
        <td id="LC10935">            <span>_ASSERTE</span>(ppIndirection != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L10936" data-line-number="10936"></td>
        <td id="LC10936">            *ppIndirection = &amp;hlpDynamicFuncTable[dynamicFtnNum].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L10937" data-line-number="10937"></td>
        <td id="LC10937">            <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10938" data-line-number="10938"></td>
        <td id="LC10938">        }</td>
      </tr>
      <tr>
        <td id="L10939" data-line-number="10939"></td>
        <td id="LC10939">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10940" data-line-number="10940"></td>
        <td id="LC10940">
</td>
      </tr>
      <tr>
        <td id="L10941" data-line-number="10941"></td>
        <td id="LC10941">#<span>if</span> defined(ENABLE_FAST_GCPOLL_HELPER)</td>
      </tr>
      <tr>
        <td id="L10942" data-line-number="10942"></td>
        <td id="LC10942">        <span><span>//</span>always call this indirectly so that we can swap GC Poll helpers.</span></td>
      </tr>
      <tr>
        <td id="L10943" data-line-number="10943"></td>
        <td id="LC10943">        <span>if</span> (dynamicFtnNum == DYNAMIC_CORINFO_HELP_POLL_GC)</td>
      </tr>
      <tr>
        <td id="L10944" data-line-number="10944"></td>
        <td id="LC10944">        {</td>
      </tr>
      <tr>
        <td id="L10945" data-line-number="10945"></td>
        <td id="LC10945">            <span>_ASSERTE</span>(ppIndirection != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L10946" data-line-number="10946"></td>
        <td id="LC10946">            *ppIndirection = &amp;hlpDynamicFuncTable[dynamicFtnNum].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L10947" data-line-number="10947"></td>
        <td id="LC10947">            <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L10948" data-line-number="10948"></td>
        <td id="LC10948">        }</td>
      </tr>
      <tr>
        <td id="L10949" data-line-number="10949"></td>
        <td id="LC10949">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L10950" data-line-number="10950"></td>
        <td id="LC10950">
</td>
      </tr>
      <tr>
        <td id="L10951" data-line-number="10951"></td>
        <td id="LC10951">        pfnHelper = hlpDynamicFuncTable[dynamicFtnNum].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L10952" data-line-number="10952"></td>
        <td id="LC10952">
</td>
      </tr>
      <tr>
        <td id="L10953" data-line-number="10953"></td>
        <td id="LC10953">#<span>ifdef</span> _PREFAST_</td>
      </tr>
      <tr>
        <td id="L10954" data-line-number="10954"></td>
        <td id="LC10954">#<span>pragma</span> warning(pop)</td>
      </tr>
      <tr>
        <td id="L10955" data-line-number="10955"></td>
        <td id="LC10955">#<span>endif</span> <span><span>/*</span>_PREFAST_<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L10956" data-line-number="10956"></td>
        <td id="LC10956">    }</td>
      </tr>
      <tr>
        <td id="L10957" data-line-number="10957"></td>
        <td id="LC10957">
</td>
      </tr>
      <tr>
        <td id="L10958" data-line-number="10958"></td>
        <td id="LC10958">    <span>_ASSERTE</span>(pfnHelper);</td>
      </tr>
      <tr>
        <td id="L10959" data-line-number="10959"></td>
        <td id="LC10959">
</td>
      </tr>
      <tr>
        <td id="L10960" data-line-number="10960"></td>
        <td id="LC10960">    result = (LPVOID)<span>GetEEFuncEntryPoint</span>(pfnHelper);</td>
      </tr>
      <tr>
        <td id="L10961" data-line-number="10961"></td>
        <td id="LC10961">
</td>
      </tr>
      <tr>
        <td id="L10962" data-line-number="10962"></td>
        <td id="LC10962">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L10963" data-line-number="10963"></td>
        <td id="LC10963">
</td>
      </tr>
      <tr>
        <td id="L10964" data-line-number="10964"></td>
        <td id="LC10964">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L10965" data-line-number="10965"></td>
        <td id="LC10965">}</td>
      </tr>
      <tr>
        <td id="L10966" data-line-number="10966"></td>
        <td id="LC10966">
</td>
      </tr>
      <tr>
        <td id="L10967" data-line-number="10967"></td>
        <td id="LC10967">PCODE <span>CEEJitInfo::getHelperFtnStatic</span>(CorInfoHelpFunc ftnNum)</td>
      </tr>
      <tr>
        <td id="L10968" data-line-number="10968"></td>
        <td id="LC10968">{</td>
      </tr>
      <tr>
        <td id="L10969" data-line-number="10969"></td>
        <td id="LC10969">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L10970" data-line-number="10970"></td>
        <td id="LC10970">
</td>
      </tr>
      <tr>
        <td id="L10971" data-line-number="10971"></td>
        <td id="LC10971">    <span>void</span>* pfnHelper = hlpFuncTable[ftnNum].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L10972" data-line-number="10972"></td>
        <td id="LC10972">
</td>
      </tr>
      <tr>
        <td id="L10973" data-line-number="10973"></td>
        <td id="LC10973">    <span><span>//</span> If pfnHelper is an index into the dynamic helper table, it should be less</span></td>
      </tr>
      <tr>
        <td id="L10974" data-line-number="10974"></td>
        <td id="LC10974">    <span><span>//</span> than DYNAMIC_CORINFO_HELP_COUNT.  In this case we need to find the actual pfnHelper</span></td>
      </tr>
      <tr>
        <td id="L10975" data-line-number="10975"></td>
        <td id="LC10975">    <span><span>//</span> using an extra indirection.  Note the special case</span></td>
      </tr>
      <tr>
        <td id="L10976" data-line-number="10976"></td>
        <td id="LC10976">    <span><span>//</span> where pfnHelper==0 where pfnHelper-1 will underflow and we will avoid the indirection.</span></td>
      </tr>
      <tr>
        <td id="L10977" data-line-number="10977"></td>
        <td id="LC10977">    <span>if</span> (((<span>size_t</span>)pfnHelper - <span>1</span>) &lt; DYNAMIC_CORINFO_HELP_COUNT)</td>
      </tr>
      <tr>
        <td id="L10978" data-line-number="10978"></td>
        <td id="LC10978">    {</td>
      </tr>
      <tr>
        <td id="L10979" data-line-number="10979"></td>
        <td id="LC10979">        pfnHelper = hlpDynamicFuncTable[((<span>size_t</span>)pfnHelper - <span>1</span>)].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L10980" data-line-number="10980"></td>
        <td id="LC10980">    }</td>
      </tr>
      <tr>
        <td id="L10981" data-line-number="10981"></td>
        <td id="LC10981">
</td>
      </tr>
      <tr>
        <td id="L10982" data-line-number="10982"></td>
        <td id="LC10982">    <span>_ASSERTE</span>(pfnHelper != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L10983" data-line-number="10983"></td>
        <td id="LC10983">
</td>
      </tr>
      <tr>
        <td id="L10984" data-line-number="10984"></td>
        <td id="LC10984">    <span>return</span> <span>GetEEFuncEntryPoint</span>(pfnHelper);</td>
      </tr>
      <tr>
        <td id="L10985" data-line-number="10985"></td>
        <td id="LC10985">}</td>
      </tr>
      <tr>
        <td id="L10986" data-line-number="10986"></td>
        <td id="LC10986">
</td>
      </tr>
      <tr>
        <td id="L10987" data-line-number="10987"></td>
        <td id="LC10987"><span>void</span> <span>CEEJitInfo::addActiveDependency</span>(CORINFO_MODULE_HANDLE moduleFrom,CORINFO_MODULE_HANDLE moduleTo)</td>
      </tr>
      <tr>
        <td id="L10988" data-line-number="10988"></td>
        <td id="LC10988">{</td>
      </tr>
      <tr>
        <td id="L10989" data-line-number="10989"></td>
        <td id="LC10989">    CONTRACTL</td>
      </tr>
      <tr>
        <td id="L10990" data-line-number="10990"></td>
        <td id="LC10990">    {</td>
      </tr>
      <tr>
        <td id="L10991" data-line-number="10991"></td>
        <td id="LC10991">        STANDARD_VM_CHECK;</td>
      </tr>
      <tr>
        <td id="L10992" data-line-number="10992"></td>
        <td id="LC10992">        <span>PRECONDITION</span>(<span>CheckPointer</span>(moduleFrom));</td>
      </tr>
      <tr>
        <td id="L10993" data-line-number="10993"></td>
        <td id="LC10993">        <span>PRECONDITION</span>(!<span>IsDynamicScope</span>(moduleFrom));</td>
      </tr>
      <tr>
        <td id="L10994" data-line-number="10994"></td>
        <td id="LC10994">        <span>PRECONDITION</span>(<span>CheckPointer</span>(moduleTo));</td>
      </tr>
      <tr>
        <td id="L10995" data-line-number="10995"></td>
        <td id="LC10995">        <span>PRECONDITION</span>(!<span>IsDynamicScope</span>(moduleTo));</td>
      </tr>
      <tr>
        <td id="L10996" data-line-number="10996"></td>
        <td id="LC10996">        <span>PRECONDITION</span>(moduleFrom != moduleTo);</td>
      </tr>
      <tr>
        <td id="L10997" data-line-number="10997"></td>
        <td id="LC10997">    }</td>
      </tr>
      <tr>
        <td id="L10998" data-line-number="10998"></td>
        <td id="LC10998">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L10999" data-line-number="10999"></td>
        <td id="LC10999">
</td>
      </tr>
      <tr>
        <td id="L11000" data-line-number="11000"></td>
        <td id="LC11000">    <span><span>//</span> This is only called internaly. JIT-EE transition is not needed.</span></td>
      </tr>
      <tr>
        <td id="L11001" data-line-number="11001"></td>
        <td id="LC11001">    <span><span>//</span> JIT_TO_EE_TRANSITION();</span></td>
      </tr>
      <tr>
        <td id="L11002" data-line-number="11002"></td>
        <td id="LC11002">
</td>
      </tr>
      <tr>
        <td id="L11003" data-line-number="11003"></td>
        <td id="LC11003">    Module *dependency = (Module *)moduleTo;</td>
      </tr>
      <tr>
        <td id="L11004" data-line-number="11004"></td>
        <td id="LC11004">    <span>_ASSERTE</span>(!dependency-&gt;<span>IsSystem</span>());</td>
      </tr>
      <tr>
        <td id="L11005" data-line-number="11005"></td>
        <td id="LC11005">
</td>
      </tr>
      <tr>
        <td id="L11006" data-line-number="11006"></td>
        <td id="LC11006">    dependency-&gt;<span>EnsureActive</span>();</td>
      </tr>
      <tr>
        <td id="L11007" data-line-number="11007"></td>
        <td id="LC11007">
</td>
      </tr>
      <tr>
        <td id="L11008" data-line-number="11008"></td>
        <td id="LC11008">    <span><span>//</span> EE_TO_JIT_TRANSITION();</span></td>
      </tr>
      <tr>
        <td id="L11009" data-line-number="11009"></td>
        <td id="LC11009">}</td>
      </tr>
      <tr>
        <td id="L11010" data-line-number="11010"></td>
        <td id="LC11010">
</td>
      </tr>
      <tr>
        <td id="L11011" data-line-number="11011"></td>
        <td id="LC11011">
</td>
      </tr>
      <tr>
        <td id="L11012" data-line-number="11012"></td>
        <td id="LC11012"><span><span>//</span> Wrapper around CEEInfo::GetProfilingHandle.  The first time this is called for a</span></td>
      </tr>
      <tr>
        <td id="L11013" data-line-number="11013"></td>
        <td id="LC11013"><span><span>//</span> method desc, it calls through to EEToProfInterfaceImpl::EEFunctionIDMappe and caches the</span></td>
      </tr>
      <tr>
        <td id="L11014" data-line-number="11014"></td>
        <td id="LC11014"><span><span>//</span> result in CEEJitInfo::GetProfilingHandleCache.  Thereafter, this wrapper regurgitates the cached values</span></td>
      </tr>
      <tr>
        <td id="L11015" data-line-number="11015"></td>
        <td id="LC11015"><span><span>//</span> rather than calling into CEEInfo::GetProfilingHandle each time.  This avoids</span></td>
      </tr>
      <tr>
        <td id="L11016" data-line-number="11016"></td>
        <td id="LC11016"><span><span>//</span> making duplicate calls into the profiler's FunctionIDMapper callback.</span></td>
      </tr>
      <tr>
        <td id="L11017" data-line-number="11017"></td>
        <td id="LC11017"><span>void</span> <span>CEEJitInfo::GetProfilingHandle</span>(BOOL                      *pbHookFunction,</td>
      </tr>
      <tr>
        <td id="L11018" data-line-number="11018"></td>
        <td id="LC11018">                                    <span>void</span>                     **pProfilerHandle,</td>
      </tr>
      <tr>
        <td id="L11019" data-line-number="11019"></td>
        <td id="LC11019">                                    BOOL                      *pbIndirectedHandles)</td>
      </tr>
      <tr>
        <td id="L11020" data-line-number="11020"></td>
        <td id="LC11020">{</td>
      </tr>
      <tr>
        <td id="L11021" data-line-number="11021"></td>
        <td id="LC11021">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11022" data-line-number="11022"></td>
        <td id="LC11022">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11023" data-line-number="11023"></td>
        <td id="LC11023">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11024" data-line-number="11024"></td>
        <td id="LC11024">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11025" data-line-number="11025"></td>
        <td id="LC11025">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11026" data-line-number="11026"></td>
        <td id="LC11026">
</td>
      </tr>
      <tr>
        <td id="L11027" data-line-number="11027"></td>
        <td id="LC11027">    <span>_ASSERTE</span>(pbHookFunction != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L11028" data-line-number="11028"></td>
        <td id="LC11028">    <span>_ASSERTE</span>(pProfilerHandle != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L11029" data-line-number="11029"></td>
        <td id="LC11029">    <span>_ASSERTE</span>(pbIndirectedHandles != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L11030" data-line-number="11030"></td>
        <td id="LC11030">
</td>
      </tr>
      <tr>
        <td id="L11031" data-line-number="11031"></td>
        <td id="LC11031">    <span>if</span> (!m_gphCache.<span>m_bGphIsCacheValid</span>)</td>
      </tr>
      <tr>
        <td id="L11032" data-line-number="11032"></td>
        <td id="LC11032">    {</td>
      </tr>
      <tr>
        <td id="L11033" data-line-number="11033"></td>
        <td id="LC11033">#<span>ifdef</span> PROFILING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L11034" data-line-number="11034"></td>
        <td id="LC11034">        <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11035" data-line-number="11035"></td>
        <td id="LC11035">
</td>
      </tr>
      <tr>
        <td id="L11036" data-line-number="11036"></td>
        <td id="LC11036">        <span><span>//</span> Cache not filled in, so make our first and only call to CEEInfo::GetProfilingHandle here</span></td>
      </tr>
      <tr>
        <td id="L11037" data-line-number="11037"></td>
        <td id="LC11037">
</td>
      </tr>
      <tr>
        <td id="L11038" data-line-number="11038"></td>
        <td id="LC11038">        <span><span>//</span> methods with no metadata behind cannot be exposed to tools expecting metadata (profiler, debugger...)</span></td>
      </tr>
      <tr>
        <td id="L11039" data-line-number="11039"></td>
        <td id="LC11039">        <span><span>//</span> they shouldnever come here as they are called out in GetCompileFlag</span></td>
      </tr>
      <tr>
        <td id="L11040" data-line-number="11040"></td>
        <td id="LC11040">        <span>_ASSERTE</span>(!m_pMethodBeingCompiled-&gt;<span>IsNoMetadata</span>());</td>
      </tr>
      <tr>
        <td id="L11041" data-line-number="11041"></td>
        <td id="LC11041">
</td>
      </tr>
      <tr>
        <td id="L11042" data-line-number="11042"></td>
        <td id="LC11042">        <span><span>//</span> We pass in the typical method definition to the function mapper because in</span></td>
      </tr>
      <tr>
        <td id="L11043" data-line-number="11043"></td>
        <td id="LC11043">        <span><span>//</span> Whidbey all the profiling API transactions are done in terms of typical</span></td>
      </tr>
      <tr>
        <td id="L11044" data-line-number="11044"></td>
        <td id="LC11044">        <span><span>//</span> method definitions not instantiations.</span></td>
      </tr>
      <tr>
        <td id="L11045" data-line-number="11045"></td>
        <td id="LC11045">        BOOL bHookFunction = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L11046" data-line-number="11046"></td>
        <td id="LC11046">        <span>void</span> * profilerHandle = m_pMethodBeingCompiled;</td>
      </tr>
      <tr>
        <td id="L11047" data-line-number="11047"></td>
        <td id="LC11047">
</td>
      </tr>
      <tr>
        <td id="L11048" data-line-number="11048"></td>
        <td id="LC11048">        {</td>
      </tr>
      <tr>
        <td id="L11049" data-line-number="11049"></td>
        <td id="LC11049">            <span>BEGIN_PIN_PROFILER</span>(<span>CORProfilerFunctionIDMapperEnabled</span>());</td>
      </tr>
      <tr>
        <td id="L11050" data-line-number="11050"></td>
        <td id="LC11050">            profilerHandle = (<span>void</span> *)g_profControlBlock.<span>pProfInterface</span>-&gt;<span>EEFunctionIDMapper</span>((FunctionID) m_pMethodBeingCompiled, &amp;bHookFunction);</td>
      </tr>
      <tr>
        <td id="L11051" data-line-number="11051"></td>
        <td id="LC11051">            <span>END_PIN_PROFILER</span>();</td>
      </tr>
      <tr>
        <td id="L11052" data-line-number="11052"></td>
        <td id="LC11052">        }</td>
      </tr>
      <tr>
        <td id="L11053" data-line-number="11053"></td>
        <td id="LC11053">
</td>
      </tr>
      <tr>
        <td id="L11054" data-line-number="11054"></td>
        <td id="LC11054">        m_gphCache.<span>m_pvGphProfilerHandle</span> = profilerHandle;</td>
      </tr>
      <tr>
        <td id="L11055" data-line-number="11055"></td>
        <td id="LC11055">        m_gphCache.<span>m_bGphHookFunction</span> = (bHookFunction != <span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L11056" data-line-number="11056"></td>
        <td id="LC11056">        m_gphCache.<span>m_bGphIsCacheValid</span> = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L11057" data-line-number="11057"></td>
        <td id="LC11057">
</td>
      </tr>
      <tr>
        <td id="L11058" data-line-number="11058"></td>
        <td id="LC11058">        <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11059" data-line-number="11059"></td>
        <td id="LC11059">#<span>endif</span> <span><span>//</span>PROFILING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L11060" data-line-number="11060"></td>
        <td id="LC11060">    }</td>
      </tr>
      <tr>
        <td id="L11061" data-line-number="11061"></td>
        <td id="LC11061">
</td>
      </tr>
      <tr>
        <td id="L11062" data-line-number="11062"></td>
        <td id="LC11062">    <span><span>//</span> Our cache of these values are bitfield bools, but the interface requires</span></td>
      </tr>
      <tr>
        <td id="L11063" data-line-number="11063"></td>
        <td id="LC11063">    <span><span>//</span> BOOL.  So to avoid setting aside a staging area on the stack for these</span></td>
      </tr>
      <tr>
        <td id="L11064" data-line-number="11064"></td>
        <td id="LC11064">    <span><span>//</span> values, we filled them in directly in the if (not cached yet) case.</span></td>
      </tr>
      <tr>
        <td id="L11065" data-line-number="11065"></td>
        <td id="LC11065">    *pbHookFunction = (m_gphCache.<span>m_bGphHookFunction</span> != <span>false</span>);</td>
      </tr>
      <tr>
        <td id="L11066" data-line-number="11066"></td>
        <td id="LC11066">
</td>
      </tr>
      <tr>
        <td id="L11067" data-line-number="11067"></td>
        <td id="LC11067">    <span><span>//</span> At this point, the remaining values must be in the cache by now, so use them</span></td>
      </tr>
      <tr>
        <td id="L11068" data-line-number="11068"></td>
        <td id="LC11068">    *pProfilerHandle = m_gphCache.<span>m_pvGphProfilerHandle</span>;</td>
      </tr>
      <tr>
        <td id="L11069" data-line-number="11069"></td>
        <td id="LC11069">
</td>
      </tr>
      <tr>
        <td id="L11070" data-line-number="11070"></td>
        <td id="LC11070">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11071" data-line-number="11071"></td>
        <td id="LC11071">    <span><span>//</span> This is the JIT case, which is never indirected.</span></td>
      </tr>
      <tr>
        <td id="L11072" data-line-number="11072"></td>
        <td id="LC11072">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11073" data-line-number="11073"></td>
        <td id="LC11073">    *pbIndirectedHandles = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L11074" data-line-number="11074"></td>
        <td id="LC11074">}</td>
      </tr>
      <tr>
        <td id="L11075" data-line-number="11075"></td>
        <td id="LC11075">
</td>
      </tr>
      <tr>
        <td id="L11076" data-line-number="11076"></td>
        <td id="LC11076"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11077" data-line-number="11077"></td>
        <td id="LC11077"><span>void</span> <span>CEEJitInfo::BackoutJitData</span>(EEJitManager * jitMgr)</td>
      </tr>
      <tr>
        <td id="L11078" data-line-number="11078"></td>
        <td id="LC11078">{</td>
      </tr>
      <tr>
        <td id="L11079" data-line-number="11079"></td>
        <td id="LC11079">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11080" data-line-number="11080"></td>
        <td id="LC11080">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L11081" data-line-number="11081"></td>
        <td id="LC11081">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11082" data-line-number="11082"></td>
        <td id="LC11082">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11083" data-line-number="11083"></td>
        <td id="LC11083">
</td>
      </tr>
      <tr>
        <td id="L11084" data-line-number="11084"></td>
        <td id="LC11084">    CodeHeader* pCodeHeader = <span>GetCodeHeader</span>();</td>
      </tr>
      <tr>
        <td id="L11085" data-line-number="11085"></td>
        <td id="LC11085">    <span>if</span> (pCodeHeader)</td>
      </tr>
      <tr>
        <td id="L11086" data-line-number="11086"></td>
        <td id="LC11086">        jitMgr-&gt;<span>RemoveJitData</span>(pCodeHeader, m_GCinfo_len, m_EHinfo_len);</td>
      </tr>
      <tr>
        <td id="L11087" data-line-number="11087"></td>
        <td id="LC11087">}</td>
      </tr>
      <tr>
        <td id="L11088" data-line-number="11088"></td>
        <td id="LC11088">
</td>
      </tr>
      <tr>
        <td id="L11089" data-line-number="11089"></td>
        <td id="LC11089"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11090" data-line-number="11090"></td>
        <td id="LC11090"><span><span>//</span> Route jit information to the Jit Debug store.</span></td>
      </tr>
      <tr>
        <td id="L11091" data-line-number="11091"></td>
        <td id="LC11091"><span>void</span> <span>CEEJitInfo::setBoundaries</span>(CORINFO_METHOD_HANDLE ftn, ULONG32 cMap,</td>
      </tr>
      <tr>
        <td id="L11092" data-line-number="11092"></td>
        <td id="LC11092">                               ICorDebugInfo::OffsetMapping *pMap)</td>
      </tr>
      <tr>
        <td id="L11093" data-line-number="11093"></td>
        <td id="LC11093">{</td>
      </tr>
      <tr>
        <td id="L11094" data-line-number="11094"></td>
        <td id="LC11094">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11095" data-line-number="11095"></td>
        <td id="LC11095">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11096" data-line-number="11096"></td>
        <td id="LC11096">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11097" data-line-number="11097"></td>
        <td id="LC11097">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11098" data-line-number="11098"></td>
        <td id="LC11098">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11099" data-line-number="11099"></td>
        <td id="LC11099">
</td>
      </tr>
      <tr>
        <td id="L11100" data-line-number="11100"></td>
        <td id="LC11100">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11101" data-line-number="11101"></td>
        <td id="LC11101">
</td>
      </tr>
      <tr>
        <td id="L11102" data-line-number="11102"></td>
        <td id="LC11102">    <span><span>//</span> We receive ownership of the array</span></td>
      </tr>
      <tr>
        <td id="L11103" data-line-number="11103"></td>
        <td id="LC11103">    <span>_ASSERTE</span>(m_pOffsetMapping == <span>NULL</span> &amp;&amp; m_iOffsetMapping == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11104" data-line-number="11104"></td>
        <td id="LC11104">    m_iOffsetMapping = cMap;</td>
      </tr>
      <tr>
        <td id="L11105" data-line-number="11105"></td>
        <td id="LC11105">    m_pOffsetMapping = pMap;</td>
      </tr>
      <tr>
        <td id="L11106" data-line-number="11106"></td>
        <td id="LC11106">
</td>
      </tr>
      <tr>
        <td id="L11107" data-line-number="11107"></td>
        <td id="LC11107">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11108" data-line-number="11108"></td>
        <td id="LC11108">}</td>
      </tr>
      <tr>
        <td id="L11109" data-line-number="11109"></td>
        <td id="LC11109">
</td>
      </tr>
      <tr>
        <td id="L11110" data-line-number="11110"></td>
        <td id="LC11110"><span>void</span> <span>CEEJitInfo::setVars</span>(CORINFO_METHOD_HANDLE ftn, ULONG32 cVars, ICorDebugInfo::NativeVarInfo *vars)</td>
      </tr>
      <tr>
        <td id="L11111" data-line-number="11111"></td>
        <td id="LC11111">{</td>
      </tr>
      <tr>
        <td id="L11112" data-line-number="11112"></td>
        <td id="LC11112">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11113" data-line-number="11113"></td>
        <td id="LC11113">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11114" data-line-number="11114"></td>
        <td id="LC11114">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11115" data-line-number="11115"></td>
        <td id="LC11115">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11116" data-line-number="11116"></td>
        <td id="LC11116">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11117" data-line-number="11117"></td>
        <td id="LC11117">
</td>
      </tr>
      <tr>
        <td id="L11118" data-line-number="11118"></td>
        <td id="LC11118">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11119" data-line-number="11119"></td>
        <td id="LC11119">
</td>
      </tr>
      <tr>
        <td id="L11120" data-line-number="11120"></td>
        <td id="LC11120">    <span><span>//</span> We receive ownership of the array</span></td>
      </tr>
      <tr>
        <td id="L11121" data-line-number="11121"></td>
        <td id="LC11121">    <span>_ASSERTE</span>(m_pNativeVarInfo == <span>NULL</span> &amp;&amp; m_iNativeVarInfo == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11122" data-line-number="11122"></td>
        <td id="LC11122">    m_iNativeVarInfo = cVars;</td>
      </tr>
      <tr>
        <td id="L11123" data-line-number="11123"></td>
        <td id="LC11123">    m_pNativeVarInfo = vars;</td>
      </tr>
      <tr>
        <td id="L11124" data-line-number="11124"></td>
        <td id="LC11124">
</td>
      </tr>
      <tr>
        <td id="L11125" data-line-number="11125"></td>
        <td id="LC11125">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11126" data-line-number="11126"></td>
        <td id="LC11126">}</td>
      </tr>
      <tr>
        <td id="L11127" data-line-number="11127"></td>
        <td id="LC11127">
</td>
      </tr>
      <tr>
        <td id="L11128" data-line-number="11128"></td>
        <td id="LC11128"><span>void</span> <span>CEEJitInfo::CompressDebugInfo</span>()</td>
      </tr>
      <tr>
        <td id="L11129" data-line-number="11129"></td>
        <td id="LC11129">{</td>
      </tr>
      <tr>
        <td id="L11130" data-line-number="11130"></td>
        <td id="LC11130">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11131" data-line-number="11131"></td>
        <td id="LC11131">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11132" data-line-number="11132"></td>
        <td id="LC11132">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11133" data-line-number="11133"></td>
        <td id="LC11133">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11134" data-line-number="11134"></td>
        <td id="LC11134">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11135" data-line-number="11135"></td>
        <td id="LC11135">
</td>
      </tr>
      <tr>
        <td id="L11136" data-line-number="11136"></td>
        <td id="LC11136">    <span><span>//</span> Don't track JIT info for DynamicMethods.</span></td>
      </tr>
      <tr>
        <td id="L11137" data-line-number="11137"></td>
        <td id="LC11137">    <span>if</span> (m_pMethodBeingCompiled-&gt;<span>IsDynamicMethod</span>() &amp;&amp; !g_pConfig-&gt;<span>GetTrackDynamicMethodDebugInfo</span>())</td>
      </tr>
      <tr>
        <td id="L11138" data-line-number="11138"></td>
        <td id="LC11138">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L11139" data-line-number="11139"></td>
        <td id="LC11139">
</td>
      </tr>
      <tr>
        <td id="L11140" data-line-number="11140"></td>
        <td id="LC11140">    <span>if</span> (m_iOffsetMapping == <span>0</span> &amp;&amp; m_iNativeVarInfo == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L11141" data-line-number="11141"></td>
        <td id="LC11141">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L11142" data-line-number="11142"></td>
        <td id="LC11142">
</td>
      </tr>
      <tr>
        <td id="L11143" data-line-number="11143"></td>
        <td id="LC11143">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11144" data-line-number="11144"></td>
        <td id="LC11144">
</td>
      </tr>
      <tr>
        <td id="L11145" data-line-number="11145"></td>
        <td id="LC11145">    EX_TRY</td>
      </tr>
      <tr>
        <td id="L11146" data-line-number="11146"></td>
        <td id="LC11146">    {</td>
      </tr>
      <tr>
        <td id="L11147" data-line-number="11147"></td>
        <td id="LC11147">        PTR_BYTE pDebugInfo = <span>CompressDebugInfo::CompressBoundariesAndVars</span>(</td>
      </tr>
      <tr>
        <td id="L11148" data-line-number="11148"></td>
        <td id="LC11148">            m_pOffsetMapping, m_iOffsetMapping,</td>
      </tr>
      <tr>
        <td id="L11149" data-line-number="11149"></td>
        <td id="LC11149">            m_pNativeVarInfo, m_iNativeVarInfo,</td>
      </tr>
      <tr>
        <td id="L11150" data-line-number="11150"></td>
        <td id="LC11150">            <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L11151" data-line-number="11151"></td>
        <td id="LC11151">            m_pMethodBeingCompiled-&gt;<span>GetLoaderAllocator</span>()-&gt;<span>GetLowFrequencyHeap</span>());</td>
      </tr>
      <tr>
        <td id="L11152" data-line-number="11152"></td>
        <td id="LC11152">
</td>
      </tr>
      <tr>
        <td id="L11153" data-line-number="11153"></td>
        <td id="LC11153">        <span>GetCodeHeader</span>()-&gt;<span>SetDebugInfo</span>(pDebugInfo);</td>
      </tr>
      <tr>
        <td id="L11154" data-line-number="11154"></td>
        <td id="LC11154">    }</td>
      </tr>
      <tr>
        <td id="L11155" data-line-number="11155"></td>
        <td id="LC11155">    EX_CATCH</td>
      </tr>
      <tr>
        <td id="L11156" data-line-number="11156"></td>
        <td id="LC11156">    {</td>
      </tr>
      <tr>
        <td id="L11157" data-line-number="11157"></td>
        <td id="LC11157">        <span><span>//</span> Just ignore exceptions here. The debugger's structures will still be in a consistent state.</span></td>
      </tr>
      <tr>
        <td id="L11158" data-line-number="11158"></td>
        <td id="LC11158">    }</td>
      </tr>
      <tr>
        <td id="L11159" data-line-number="11159"></td>
        <td id="LC11159">    <span>EX_END_CATCH</span>(SwallowAllExceptions)</td>
      </tr>
      <tr>
        <td id="L11160" data-line-number="11160"></td>
        <td id="LC11160">
</td>
      </tr>
      <tr>
        <td id="L11161" data-line-number="11161"></td>
        <td id="LC11161">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11162" data-line-number="11162"></td>
        <td id="LC11162">}</td>
      </tr>
      <tr>
        <td id="L11163" data-line-number="11163"></td>
        <td id="LC11163">
</td>
      </tr>
      <tr>
        <td id="L11164" data-line-number="11164"></td>
        <td id="LC11164"><span>void</span> <span>reservePersonalityRoutineSpace</span>(ULONG &amp;unwindSize)</td>
      </tr>
      <tr>
        <td id="L11165" data-line-number="11165"></td>
        <td id="LC11165">{</td>
      </tr>
      <tr>
        <td id="L11166" data-line-number="11166"></td>
        <td id="LC11166">#<span>if</span> defined(TARGET_X86)</td>
      </tr>
      <tr>
        <td id="L11167" data-line-number="11167"></td>
        <td id="LC11167">    <span><span>//</span> Do nothing</span></td>
      </tr>
      <tr>
        <td id="L11168" data-line-number="11168"></td>
        <td id="LC11168">#<span>elif</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L11169" data-line-number="11169"></td>
        <td id="LC11169">    <span><span>//</span> Add space for personality routine, it must be 4-byte aligned.</span></td>
      </tr>
      <tr>
        <td id="L11170" data-line-number="11170"></td>
        <td id="LC11170">    <span><span>//</span> Everything in the UNWIND_INFO up to the variable-sized UnwindCodes</span></td>
      </tr>
      <tr>
        <td id="L11171" data-line-number="11171"></td>
        <td id="LC11171">    <span><span>//</span> array has already had its size included in unwindSize by the caller.</span></td>
      </tr>
      <tr>
        <td id="L11172" data-line-number="11172"></td>
        <td id="LC11172">    unwindSize += <span>sizeof</span>(ULONG);</td>
      </tr>
      <tr>
        <td id="L11173" data-line-number="11173"></td>
        <td id="LC11173">
</td>
      </tr>
      <tr>
        <td id="L11174" data-line-number="11174"></td>
        <td id="LC11174">    <span><span>//</span> Note that the count of unwind codes (2 bytes each) is stored as a UBYTE</span></td>
      </tr>
      <tr>
        <td id="L11175" data-line-number="11175"></td>
        <td id="LC11175">    <span><span>//</span> So the largest size could be 510 bytes, plus the header and language</span></td>
      </tr>
      <tr>
        <td id="L11176" data-line-number="11176"></td>
        <td id="LC11176">    <span><span>//</span> specific stuff.  This can't overflow.</span></td>
      </tr>
      <tr>
        <td id="L11177" data-line-number="11177"></td>
        <td id="LC11177">
</td>
      </tr>
      <tr>
        <td id="L11178" data-line-number="11178"></td>
        <td id="LC11178">    <span>_ASSERTE</span>(<span>FitsInU4</span>(unwindSize + <span>sizeof</span>(ULONG)));</td>
      </tr>
      <tr>
        <td id="L11179" data-line-number="11179"></td>
        <td id="LC11179">    unwindSize = (ULONG)(<span>ALIGN_UP</span>(unwindSize, <span>sizeof</span>(ULONG)));</td>
      </tr>
      <tr>
        <td id="L11180" data-line-number="11180"></td>
        <td id="LC11180">#<span>elif</span> defined(TARGET_ARM) || defined(TARGET_ARM64)</td>
      </tr>
      <tr>
        <td id="L11181" data-line-number="11181"></td>
        <td id="LC11181">    <span><span>//</span> The JIT passes in a 4-byte aligned block of unwind data.</span></td>
      </tr>
      <tr>
        <td id="L11182" data-line-number="11182"></td>
        <td id="LC11182">    <span>_ASSERTE</span>(<span>IS_ALIGNED</span>(unwindSize, <span>sizeof</span>(ULONG)));</td>
      </tr>
      <tr>
        <td id="L11183" data-line-number="11183"></td>
        <td id="LC11183">
</td>
      </tr>
      <tr>
        <td id="L11184" data-line-number="11184"></td>
        <td id="LC11184">    <span><span>//</span> Add space for personality routine, it must be 4-byte aligned.</span></td>
      </tr>
      <tr>
        <td id="L11185" data-line-number="11185"></td>
        <td id="LC11185">    unwindSize += <span>sizeof</span>(ULONG);</td>
      </tr>
      <tr>
        <td id="L11186" data-line-number="11186"></td>
        <td id="LC11186">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L11187" data-line-number="11187"></td>
        <td id="LC11187">    <span>PORTABILITY_ASSERT</span>(<span><span>"</span>reservePersonalityRoutineSpace<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11188" data-line-number="11188"></td>
        <td id="LC11188">#<span>endif</span> <span><span>//</span> !defined(TARGET_AMD64)</span></td>
      </tr>
      <tr>
        <td id="L11189" data-line-number="11189"></td>
        <td id="LC11189">
</td>
      </tr>
      <tr>
        <td id="L11190" data-line-number="11190"></td>
        <td id="LC11190">}</td>
      </tr>
      <tr>
        <td id="L11191" data-line-number="11191"></td>
        <td id="LC11191"><span><span>//</span> Reserve memory for the method/funclet's unwind information.</span></td>
      </tr>
      <tr>
        <td id="L11192" data-line-number="11192"></td>
        <td id="LC11192"><span><span>//</span> Note that this must be called before allocMem. It should be</span></td>
      </tr>
      <tr>
        <td id="L11193" data-line-number="11193"></td>
        <td id="LC11193"><span><span>//</span> called once for the main method, once for every funclet, and</span></td>
      </tr>
      <tr>
        <td id="L11194" data-line-number="11194"></td>
        <td id="LC11194"><span><span>//</span> once for every block of cold code for which allocUnwindInfo</span></td>
      </tr>
      <tr>
        <td id="L11195" data-line-number="11195"></td>
        <td id="LC11195"><span><span>//</span> will be called.</span></td>
      </tr>
      <tr>
        <td id="L11196" data-line-number="11196"></td>
        <td id="LC11196"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11197" data-line-number="11197"></td>
        <td id="LC11197"><span><span>//</span> This is necessary because jitted code must allocate all the</span></td>
      </tr>
      <tr>
        <td id="L11198" data-line-number="11198"></td>
        <td id="LC11198"><span><span>//</span> memory needed for the unwindInfo at the allocMem call.</span></td>
      </tr>
      <tr>
        <td id="L11199" data-line-number="11199"></td>
        <td id="LC11199"><span><span>//</span> For prejitted code we split up the unwinding information into</span></td>
      </tr>
      <tr>
        <td id="L11200" data-line-number="11200"></td>
        <td id="LC11200"><span><span>//</span> separate sections .rdata and .pdata.</span></td>
      </tr>
      <tr>
        <td id="L11201" data-line-number="11201"></td>
        <td id="LC11201"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11202" data-line-number="11202"></td>
        <td id="LC11202"><span>void</span> <span>CEEJitInfo::reserveUnwindInfo</span>(BOOL isFunclet, BOOL isColdCode, ULONG unwindSize)</td>
      </tr>
      <tr>
        <td id="L11203" data-line-number="11203"></td>
        <td id="LC11203">{</td>
      </tr>
      <tr>
        <td id="L11204" data-line-number="11204"></td>
        <td id="LC11204">#<span>ifdef</span> FEATURE_EH_FUNCLETS</td>
      </tr>
      <tr>
        <td id="L11205" data-line-number="11205"></td>
        <td id="LC11205">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11206" data-line-number="11206"></td>
        <td id="LC11206">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L11207" data-line-number="11207"></td>
        <td id="LC11207">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L11208" data-line-number="11208"></td>
        <td id="LC11208">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11209" data-line-number="11209"></td>
        <td id="LC11209">    }</td>
      </tr>
      <tr>
        <td id="L11210" data-line-number="11210"></td>
        <td id="LC11210">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11211" data-line-number="11211"></td>
        <td id="LC11211">
</td>
      </tr>
      <tr>
        <td id="L11212" data-line-number="11212"></td>
        <td id="LC11212">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L11213" data-line-number="11213"></td>
        <td id="LC11213">
</td>
      </tr>
      <tr>
        <td id="L11214" data-line-number="11214"></td>
        <td id="LC11214">    <span>CONSISTENCY_CHECK_MSG</span>(!isColdCode, <span><span>"</span>Hot/Cold splitting is not supported in jitted code<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11215" data-line-number="11215"></td>
        <td id="LC11215">    <span>_ASSERTE_MSG</span>(m_theUnwindBlock == <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L11216" data-line-number="11216"></td>
        <td id="LC11216">        <span><span>"</span>reserveUnwindInfo() can only be called before allocMem(), but allocMem() has already been called. <span>"</span></span></td>
      </tr>
      <tr>
        <td id="L11217" data-line-number="11217"></td>
        <td id="LC11217">        <span><span>"</span>This may indicate the JIT has hit a NO_WAY assert after calling allocMem(), and is re-JITting. <span>"</span></span></td>
      </tr>
      <tr>
        <td id="L11218" data-line-number="11218"></td>
        <td id="LC11218">        <span><span>"</span>Set COMPlus_JitBreakOnBadCode=1 and rerun to get the real error.<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11219" data-line-number="11219"></td>
        <td id="LC11219">
</td>
      </tr>
      <tr>
        <td id="L11220" data-line-number="11220"></td>
        <td id="LC11220">    ULONG currentSize  = unwindSize;</td>
      </tr>
      <tr>
        <td id="L11221" data-line-number="11221"></td>
        <td id="LC11221">
</td>
      </tr>
      <tr>
        <td id="L11222" data-line-number="11222"></td>
        <td id="LC11222">    <span>reservePersonalityRoutineSpace</span>(currentSize);</td>
      </tr>
      <tr>
        <td id="L11223" data-line-number="11223"></td>
        <td id="LC11223">
</td>
      </tr>
      <tr>
        <td id="L11224" data-line-number="11224"></td>
        <td id="LC11224">    m_totalUnwindSize += currentSize;</td>
      </tr>
      <tr>
        <td id="L11225" data-line-number="11225"></td>
        <td id="LC11225">
</td>
      </tr>
      <tr>
        <td id="L11226" data-line-number="11226"></td>
        <td id="LC11226">    m_totalUnwindInfos++;</td>
      </tr>
      <tr>
        <td id="L11227" data-line-number="11227"></td>
        <td id="LC11227">
</td>
      </tr>
      <tr>
        <td id="L11228" data-line-number="11228"></td>
        <td id="LC11228">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L11229" data-line-number="11229"></td>
        <td id="LC11229">#<span>else</span> <span><span>//</span> FEATURE_EH_FUNCLETS</span></td>
      </tr>
      <tr>
        <td id="L11230" data-line-number="11230"></td>
        <td id="LC11230">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L11231" data-line-number="11231"></td>
        <td id="LC11231">    <span><span>//</span> Dummy implementation to make cross-platform altjit work</span></td>
      </tr>
      <tr>
        <td id="L11232" data-line-number="11232"></td>
        <td id="LC11232">#<span>endif</span> <span><span>//</span> FEATURE_EH_FUNCLETS</span></td>
      </tr>
      <tr>
        <td id="L11233" data-line-number="11233"></td>
        <td id="LC11233">}</td>
      </tr>
      <tr>
        <td id="L11234" data-line-number="11234"></td>
        <td id="LC11234">
</td>
      </tr>
      <tr>
        <td id="L11235" data-line-number="11235"></td>
        <td id="LC11235"><span><span>//</span> Allocate and initialize the .rdata and .pdata for this method or</span></td>
      </tr>
      <tr>
        <td id="L11236" data-line-number="11236"></td>
        <td id="LC11236"><span><span>//</span> funclet and get the block of memory needed for the machine specific</span></td>
      </tr>
      <tr>
        <td id="L11237" data-line-number="11237"></td>
        <td id="LC11237"><span><span>//</span> unwind information (the info for crawling the stack frame).</span></td>
      </tr>
      <tr>
        <td id="L11238" data-line-number="11238"></td>
        <td id="LC11238"><span><span>//</span> Note that allocMem must be called first.</span></td>
      </tr>
      <tr>
        <td id="L11239" data-line-number="11239"></td>
        <td id="LC11239"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11240" data-line-number="11240"></td>
        <td id="LC11240"><span><span>//</span> The pHotCode parameter points at the first byte of the code of the method</span></td>
      </tr>
      <tr>
        <td id="L11241" data-line-number="11241"></td>
        <td id="LC11241"><span><span>//</span> The startOffset and endOffset are the region (main or funclet) that</span></td>
      </tr>
      <tr>
        <td id="L11242" data-line-number="11242"></td>
        <td id="LC11242"><span><span>//</span> we are to allocate and create .rdata and .pdata for.</span></td>
      </tr>
      <tr>
        <td id="L11243" data-line-number="11243"></td>
        <td id="LC11243"><span><span>//</span> The pUnwindBlock is copied and contains the .pdata unwind area</span></td>
      </tr>
      <tr>
        <td id="L11244" data-line-number="11244"></td>
        <td id="LC11244"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11245" data-line-number="11245"></td>
        <td id="LC11245"><span><span>//</span> Parameters:</span></td>
      </tr>
      <tr>
        <td id="L11246" data-line-number="11246"></td>
        <td id="LC11246"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11247" data-line-number="11247"></td>
        <td id="LC11247"><span><span>//</span>    pHotCode        main method code buffer, always filled in</span></td>
      </tr>
      <tr>
        <td id="L11248" data-line-number="11248"></td>
        <td id="LC11248"><span><span>//</span>    pColdCode       always NULL for jitted code</span></td>
      </tr>
      <tr>
        <td id="L11249" data-line-number="11249"></td>
        <td id="LC11249"><span><span>//</span>    startOffset     start of code block, relative to pHotCode</span></td>
      </tr>
      <tr>
        <td id="L11250" data-line-number="11250"></td>
        <td id="LC11250"><span><span>//</span>    endOffset       end of code block, relative to pHotCode</span></td>
      </tr>
      <tr>
        <td id="L11251" data-line-number="11251"></td>
        <td id="LC11251"><span><span>//</span>    unwindSize      size of unwind info pointed to by pUnwindBlock</span></td>
      </tr>
      <tr>
        <td id="L11252" data-line-number="11252"></td>
        <td id="LC11252"><span><span>//</span>    pUnwindBlock    pointer to unwind info</span></td>
      </tr>
      <tr>
        <td id="L11253" data-line-number="11253"></td>
        <td id="LC11253"><span><span>//</span>    funcKind        type of funclet (main method code, handler, filter)</span></td>
      </tr>
      <tr>
        <td id="L11254" data-line-number="11254"></td>
        <td id="LC11254"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11255" data-line-number="11255"></td>
        <td id="LC11255"><span>void</span> <span>CEEJitInfo::allocUnwindInfo</span> (</td>
      </tr>
      <tr>
        <td id="L11256" data-line-number="11256"></td>
        <td id="LC11256">        BYTE *              pHotCode,              <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11257" data-line-number="11257"></td>
        <td id="LC11257">        BYTE *              pColdCode,             <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11258" data-line-number="11258"></td>
        <td id="LC11258">        ULONG               startOffset,           <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11259" data-line-number="11259"></td>
        <td id="LC11259">        ULONG               endOffset,             <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11260" data-line-number="11260"></td>
        <td id="LC11260">        ULONG               unwindSize,            <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11261" data-line-number="11261"></td>
        <td id="LC11261">        BYTE *              pUnwindBlock,          <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11262" data-line-number="11262"></td>
        <td id="LC11262">        CorJitFuncKind      funcKind               <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11263" data-line-number="11263"></td>
        <td id="LC11263">        )</td>
      </tr>
      <tr>
        <td id="L11264" data-line-number="11264"></td>
        <td id="LC11264">{</td>
      </tr>
      <tr>
        <td id="L11265" data-line-number="11265"></td>
        <td id="LC11265">#<span>ifdef</span> FEATURE_EH_FUNCLETS</td>
      </tr>
      <tr>
        <td id="L11266" data-line-number="11266"></td>
        <td id="LC11266">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11267" data-line-number="11267"></td>
        <td id="LC11267">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11268" data-line-number="11268"></td>
        <td id="LC11268">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11269" data-line-number="11269"></td>
        <td id="LC11269">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11270" data-line-number="11270"></td>
        <td id="LC11270">        <span>PRECONDITION</span>(m_theUnwindBlock != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L11271" data-line-number="11271"></td>
        <td id="LC11271">        <span>PRECONDITION</span>(m_usedUnwindSize &lt; m_totalUnwindSize);</td>
      </tr>
      <tr>
        <td id="L11272" data-line-number="11272"></td>
        <td id="LC11272">        <span>PRECONDITION</span>(m_usedUnwindInfos &lt; m_totalUnwindInfos);</td>
      </tr>
      <tr>
        <td id="L11273" data-line-number="11273"></td>
        <td id="LC11273">        <span>PRECONDITION</span>(endOffset &lt;= m_codeSize);</td>
      </tr>
      <tr>
        <td id="L11274" data-line-number="11274"></td>
        <td id="LC11274">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11275" data-line-number="11275"></td>
        <td id="LC11275">
</td>
      </tr>
      <tr>
        <td id="L11276" data-line-number="11276"></td>
        <td id="LC11276">    <span>CONSISTENCY_CHECK_MSG</span>(pColdCode == <span>NULL</span>, <span><span>"</span>Hot/Cold code splitting not supported for jitted code<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11277" data-line-number="11277"></td>
        <td id="LC11277">
</td>
      </tr>
      <tr>
        <td id="L11278" data-line-number="11278"></td>
        <td id="LC11278">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11279" data-line-number="11279"></td>
        <td id="LC11279">
</td>
      </tr>
      <tr>
        <td id="L11280" data-line-number="11280"></td>
        <td id="LC11280">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11281" data-line-number="11281"></td>
        <td id="LC11281">    <span><span>//</span> We add one callback-type dynamic function table per range section.</span></td>
      </tr>
      <tr>
        <td id="L11282" data-line-number="11282"></td>
        <td id="LC11282">    <span><span>//</span> Therefore, the RUNTIME_FUNCTION info is always relative to the</span></td>
      </tr>
      <tr>
        <td id="L11283" data-line-number="11283"></td>
        <td id="LC11283">    <span><span>//</span> image base contained in the dynamic function table, which happens</span></td>
      </tr>
      <tr>
        <td id="L11284" data-line-number="11284"></td>
        <td id="LC11284">    <span><span>//</span> to be the LowAddress of the range section.  The JIT has no</span></td>
      </tr>
      <tr>
        <td id="L11285" data-line-number="11285"></td>
        <td id="LC11285">    <span><span>//</span> knowledge of the range section, so it gives us offsets that are</span></td>
      </tr>
      <tr>
        <td id="L11286" data-line-number="11286"></td>
        <td id="LC11286">    <span><span>//</span> relative to the beginning of the method (pHotCode) and we allocate</span></td>
      </tr>
      <tr>
        <td id="L11287" data-line-number="11287"></td>
        <td id="LC11287">    <span><span>//</span> and initialize the RUNTIME_FUNCTION data and record its location</span></td>
      </tr>
      <tr>
        <td id="L11288" data-line-number="11288"></td>
        <td id="LC11288">    <span><span>//</span> in this function.</span></td>
      </tr>
      <tr>
        <td id="L11289" data-line-number="11289"></td>
        <td id="LC11289">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11290" data-line-number="11290"></td>
        <td id="LC11290">
</td>
      </tr>
      <tr>
        <td id="L11291" data-line-number="11291"></td>
        <td id="LC11291">    <span>if</span> (funcKind != CORJIT_FUNC_ROOT)</td>
      </tr>
      <tr>
        <td id="L11292" data-line-number="11292"></td>
        <td id="LC11292">    {</td>
      </tr>
      <tr>
        <td id="L11293" data-line-number="11293"></td>
        <td id="LC11293">        <span><span>//</span> The main method should be emitted before funclets</span></td>
      </tr>
      <tr>
        <td id="L11294" data-line-number="11294"></td>
        <td id="LC11294">        <span>_ASSERTE</span>(m_usedUnwindInfos &gt; <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11295" data-line-number="11295"></td>
        <td id="LC11295">    }</td>
      </tr>
      <tr>
        <td id="L11296" data-line-number="11296"></td>
        <td id="LC11296">
</td>
      </tr>
      <tr>
        <td id="L11297" data-line-number="11297"></td>
        <td id="LC11297">    PT_RUNTIME_FUNCTION pRuntimeFunction = m_CodeHeader-&gt;<span>GetUnwindInfo</span>(m_usedUnwindInfos);</td>
      </tr>
      <tr>
        <td id="L11298" data-line-number="11298"></td>
        <td id="LC11298">    m_usedUnwindInfos++;</td>
      </tr>
      <tr>
        <td id="L11299" data-line-number="11299"></td>
        <td id="LC11299">
</td>
      </tr>
      <tr>
        <td id="L11300" data-line-number="11300"></td>
        <td id="LC11300">    <span><span>//</span> Make sure that the RUNTIME_FUNCTION is aligned on a DWORD sized boundary</span></td>
      </tr>
      <tr>
        <td id="L11301" data-line-number="11301"></td>
        <td id="LC11301">    <span>_ASSERTE</span>(<span>IS_ALIGNED</span>(pRuntimeFunction, <span>sizeof</span>(DWORD)));</td>
      </tr>
      <tr>
        <td id="L11302" data-line-number="11302"></td>
        <td id="LC11302">
</td>
      </tr>
      <tr>
        <td id="L11303" data-line-number="11303"></td>
        <td id="LC11303">    UNWIND_INFO * pUnwindInfo = (UNWIND_INFO *) &amp;(m_theUnwindBlock[m_usedUnwindSize]);</td>
      </tr>
      <tr>
        <td id="L11304" data-line-number="11304"></td>
        <td id="LC11304">    m_usedUnwindSize += unwindSize;</td>
      </tr>
      <tr>
        <td id="L11305" data-line-number="11305"></td>
        <td id="LC11305">
</td>
      </tr>
      <tr>
        <td id="L11306" data-line-number="11306"></td>
        <td id="LC11306">    <span>reservePersonalityRoutineSpace</span>(m_usedUnwindSize);</td>
      </tr>
      <tr>
        <td id="L11307" data-line-number="11307"></td>
        <td id="LC11307">
</td>
      </tr>
      <tr>
        <td id="L11308" data-line-number="11308"></td>
        <td id="LC11308">    <span>_ASSERTE</span>(m_usedUnwindSize &lt;= m_totalUnwindSize);</td>
      </tr>
      <tr>
        <td id="L11309" data-line-number="11309"></td>
        <td id="LC11309">
</td>
      </tr>
      <tr>
        <td id="L11310" data-line-number="11310"></td>
        <td id="LC11310">    <span><span>//</span> Make sure that the UnwindInfo is aligned</span></td>
      </tr>
      <tr>
        <td id="L11311" data-line-number="11311"></td>
        <td id="LC11311">    <span>_ASSERTE</span>(<span>IS_ALIGNED</span>(pUnwindInfo, <span>sizeof</span>(ULONG)));</td>
      </tr>
      <tr>
        <td id="L11312" data-line-number="11312"></td>
        <td id="LC11312">
</td>
      </tr>
      <tr>
        <td id="L11313" data-line-number="11313"></td>
        <td id="LC11313">    <span><span>/*</span> Calculate Image Relative offset to add to the jit generated unwind offsets <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11314" data-line-number="11314"></td>
        <td id="LC11314">
</td>
      </tr>
      <tr>
        <td id="L11315" data-line-number="11315"></td>
        <td id="LC11315">    TADDR baseAddress = m_moduleBase;</td>
      </tr>
      <tr>
        <td id="L11316" data-line-number="11316"></td>
        <td id="LC11316">
</td>
      </tr>
      <tr>
        <td id="L11317" data-line-number="11317"></td>
        <td id="LC11317">    <span>size_t</span> currentCodeSizeT = (<span>size_t</span>)pHotCode - baseAddress;</td>
      </tr>
      <tr>
        <td id="L11318" data-line-number="11318"></td>
        <td id="LC11318">
</td>
      </tr>
      <tr>
        <td id="L11319" data-line-number="11319"></td>
        <td id="LC11319">    <span><span>/*</span> Check if currentCodeSizeT offset fits in 32-bits <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11320" data-line-number="11320"></td>
        <td id="LC11320">    <span>if</span> (!<span>FitsInU4</span>(currentCodeSizeT))</td>
      </tr>
      <tr>
        <td id="L11321" data-line-number="11321"></td>
        <td id="LC11321">    {</td>
      </tr>
      <tr>
        <td id="L11322" data-line-number="11322"></td>
        <td id="LC11322">        <span>_ASSERTE</span>(!<span><span>"</span>Bad currentCodeSizeT<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11323" data-line-number="11323"></td>
        <td id="LC11323">        <span>COMPlusThrowHR</span>(E_FAIL);</td>
      </tr>
      <tr>
        <td id="L11324" data-line-number="11324"></td>
        <td id="LC11324">    }</td>
      </tr>
      <tr>
        <td id="L11325" data-line-number="11325"></td>
        <td id="LC11325">
</td>
      </tr>
      <tr>
        <td id="L11326" data-line-number="11326"></td>
        <td id="LC11326">    <span><span>/*</span> Check if EndAddress offset fits in 32-bit <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11327" data-line-number="11327"></td>
        <td id="LC11327">    <span>if</span> (!<span>FitsInU4</span>(currentCodeSizeT + endOffset))</td>
      </tr>
      <tr>
        <td id="L11328" data-line-number="11328"></td>
        <td id="LC11328">    {</td>
      </tr>
      <tr>
        <td id="L11329" data-line-number="11329"></td>
        <td id="LC11329">        <span>_ASSERTE</span>(!<span><span>"</span>Bad currentCodeSizeT<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11330" data-line-number="11330"></td>
        <td id="LC11330">        <span>COMPlusThrowHR</span>(E_FAIL);</td>
      </tr>
      <tr>
        <td id="L11331" data-line-number="11331"></td>
        <td id="LC11331">    }</td>
      </tr>
      <tr>
        <td id="L11332" data-line-number="11332"></td>
        <td id="LC11332">
</td>
      </tr>
      <tr>
        <td id="L11333" data-line-number="11333"></td>
        <td id="LC11333">    <span>unsigned</span> currentCodeOffset = (<span>unsigned</span>) currentCodeSizeT;</td>
      </tr>
      <tr>
        <td id="L11334" data-line-number="11334"></td>
        <td id="LC11334">
</td>
      </tr>
      <tr>
        <td id="L11335" data-line-number="11335"></td>
        <td id="LC11335">    <span><span>/*</span> Calculate Unwind Info delta <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11336" data-line-number="11336"></td>
        <td id="LC11336">    <span>size_t</span> unwindInfoDeltaT = (<span>size_t</span>) pUnwindInfo - baseAddress;</td>
      </tr>
      <tr>
        <td id="L11337" data-line-number="11337"></td>
        <td id="LC11337">
</td>
      </tr>
      <tr>
        <td id="L11338" data-line-number="11338"></td>
        <td id="LC11338">    <span><span>/*</span> Check if unwindDeltaT offset fits in 32-bits <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11339" data-line-number="11339"></td>
        <td id="LC11339">    <span>if</span> (!<span>FitsInU4</span>(unwindInfoDeltaT))</td>
      </tr>
      <tr>
        <td id="L11340" data-line-number="11340"></td>
        <td id="LC11340">    {</td>
      </tr>
      <tr>
        <td id="L11341" data-line-number="11341"></td>
        <td id="LC11341">        <span>_ASSERTE</span>(!<span><span>"</span>Bad unwindInfoDeltaT<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11342" data-line-number="11342"></td>
        <td id="LC11342">        <span>COMPlusThrowHR</span>(E_FAIL);</td>
      </tr>
      <tr>
        <td id="L11343" data-line-number="11343"></td>
        <td id="LC11343">    }</td>
      </tr>
      <tr>
        <td id="L11344" data-line-number="11344"></td>
        <td id="LC11344">
</td>
      </tr>
      <tr>
        <td id="L11345" data-line-number="11345"></td>
        <td id="LC11345">    <span>unsigned</span> unwindInfoDelta = (<span>unsigned</span>) unwindInfoDeltaT;</td>
      </tr>
      <tr>
        <td id="L11346" data-line-number="11346"></td>
        <td id="LC11346">
</td>
      </tr>
      <tr>
        <td id="L11347" data-line-number="11347"></td>
        <td id="LC11347">    <span>RUNTIME_FUNCTION__SetBeginAddress</span>(pRuntimeFunction, currentCodeOffset + startOffset);</td>
      </tr>
      <tr>
        <td id="L11348" data-line-number="11348"></td>
        <td id="LC11348">
</td>
      </tr>
      <tr>
        <td id="L11349" data-line-number="11349"></td>
        <td id="LC11349">#<span>ifdef</span> TARGET_AMD64</td>
      </tr>
      <tr>
        <td id="L11350" data-line-number="11350"></td>
        <td id="LC11350">    pRuntimeFunction-&gt;<span>EndAddress</span>        = currentCodeOffset + endOffset;</td>
      </tr>
      <tr>
        <td id="L11351" data-line-number="11351"></td>
        <td id="LC11351">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L11352" data-line-number="11352"></td>
        <td id="LC11352">
</td>
      </tr>
      <tr>
        <td id="L11353" data-line-number="11353"></td>
        <td id="LC11353">    <span>RUNTIME_FUNCTION__SetUnwindInfoAddress</span>(pRuntimeFunction, unwindInfoDelta);</td>
      </tr>
      <tr>
        <td id="L11354" data-line-number="11354"></td>
        <td id="LC11354">
</td>
      </tr>
      <tr>
        <td id="L11355" data-line-number="11355"></td>
        <td id="LC11355">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L11356" data-line-number="11356"></td>
        <td id="LC11356">    <span>if</span> (funcKind != CORJIT_FUNC_ROOT)</td>
      </tr>
      <tr>
        <td id="L11357" data-line-number="11357"></td>
        <td id="LC11357">    {</td>
      </tr>
      <tr>
        <td id="L11358" data-line-number="11358"></td>
        <td id="LC11358">        <span><span>//</span> Check the the new funclet doesn't overlap any existing funclet.</span></td>
      </tr>
      <tr>
        <td id="L11359" data-line-number="11359"></td>
        <td id="LC11359">
</td>
      </tr>
      <tr>
        <td id="L11360" data-line-number="11360"></td>
        <td id="LC11360">        <span>for</span> (ULONG iUnwindInfo = <span>0</span>; iUnwindInfo &lt; m_usedUnwindInfos - <span>1</span>; iUnwindInfo++)</td>
      </tr>
      <tr>
        <td id="L11361" data-line-number="11361"></td>
        <td id="LC11361">        {</td>
      </tr>
      <tr>
        <td id="L11362" data-line-number="11362"></td>
        <td id="LC11362">            PT_RUNTIME_FUNCTION pOtherFunction = m_CodeHeader-&gt;<span>GetUnwindInfo</span>(iUnwindInfo);</td>
      </tr>
      <tr>
        <td id="L11363" data-line-number="11363"></td>
        <td id="LC11363">            <span>_ASSERTE</span>((   <span>RUNTIME_FUNCTION__BeginAddress</span>(pOtherFunction) &gt;= <span>RUNTIME_FUNCTION__EndAddress</span>(pRuntimeFunction, baseAddress)</td>
      </tr>
      <tr>
        <td id="L11364" data-line-number="11364"></td>
        <td id="LC11364">                     || <span>RUNTIME_FUNCTION__EndAddress</span>(pOtherFunction, baseAddress) &lt;= <span>RUNTIME_FUNCTION__BeginAddress</span>(pRuntimeFunction)));</td>
      </tr>
      <tr>
        <td id="L11365" data-line-number="11365"></td>
        <td id="LC11365">        }</td>
      </tr>
      <tr>
        <td id="L11366" data-line-number="11366"></td>
        <td id="LC11366">    }</td>
      </tr>
      <tr>
        <td id="L11367" data-line-number="11367"></td>
        <td id="LC11367">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L11368" data-line-number="11368"></td>
        <td id="LC11368">
</td>
      </tr>
      <tr>
        <td id="L11369" data-line-number="11369"></td>
        <td id="LC11369">    <span><span>/*</span> Copy the UnwindBlock <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11370" data-line-number="11370"></td>
        <td id="LC11370">    <span>memcpy</span>(pUnwindInfo, pUnwindBlock, unwindSize);</td>
      </tr>
      <tr>
        <td id="L11371" data-line-number="11371"></td>
        <td id="LC11371">
</td>
      </tr>
      <tr>
        <td id="L11372" data-line-number="11372"></td>
        <td id="LC11372">#<span>if</span> defined(TARGET_X86)</td>
      </tr>
      <tr>
        <td id="L11373" data-line-number="11373"></td>
        <td id="LC11373">
</td>
      </tr>
      <tr>
        <td id="L11374" data-line-number="11374"></td>
        <td id="LC11374">    <span><span>//</span> Do NOTHING</span></td>
      </tr>
      <tr>
        <td id="L11375" data-line-number="11375"></td>
        <td id="LC11375">
</td>
      </tr>
      <tr>
        <td id="L11376" data-line-number="11376"></td>
        <td id="LC11376">#<span>elif</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L11377" data-line-number="11377"></td>
        <td id="LC11377">
</td>
      </tr>
      <tr>
        <td id="L11378" data-line-number="11378"></td>
        <td id="LC11378">    pUnwindInfo-&gt;<span>Flags</span> = UNW_FLAG_EHANDLER | UNW_FLAG_UHANDLER;</td>
      </tr>
      <tr>
        <td id="L11379" data-line-number="11379"></td>
        <td id="LC11379">
</td>
      </tr>
      <tr>
        <td id="L11380" data-line-number="11380"></td>
        <td id="LC11380">    ULONG * pPersonalityRoutine = (ULONG*)<span>ALIGN_UP</span>(&amp;(pUnwindInfo-&gt;<span>UnwindCode</span>[pUnwindInfo-&gt;<span>CountOfUnwindCodes</span>]), <span>sizeof</span>(ULONG));</td>
      </tr>
      <tr>
        <td id="L11381" data-line-number="11381"></td>
        <td id="LC11381">    *pPersonalityRoutine = <span>ExecutionManager::GetCLRPersonalityRoutineValue</span>();</td>
      </tr>
      <tr>
        <td id="L11382" data-line-number="11382"></td>
        <td id="LC11382">
</td>
      </tr>
      <tr>
        <td id="L11383" data-line-number="11383"></td>
        <td id="LC11383">#<span>elif</span> defined(TARGET_ARM64)</td>
      </tr>
      <tr>
        <td id="L11384" data-line-number="11384"></td>
        <td id="LC11384">
</td>
      </tr>
      <tr>
        <td id="L11385" data-line-number="11385"></td>
        <td id="LC11385">    *(LONG *)pUnwindInfo |= (<span>1</span> &lt;&lt; <span>20</span>); <span><span>//</span> X bit</span></td>
      </tr>
      <tr>
        <td id="L11386" data-line-number="11386"></td>
        <td id="LC11386">
</td>
      </tr>
      <tr>
        <td id="L11387" data-line-number="11387"></td>
        <td id="LC11387">    ULONG * pPersonalityRoutine = (ULONG*)((BYTE *)pUnwindInfo + <span>ALIGN_UP</span>(unwindSize, <span>sizeof</span>(ULONG)));</td>
      </tr>
      <tr>
        <td id="L11388" data-line-number="11388"></td>
        <td id="LC11388">    *pPersonalityRoutine = <span>ExecutionManager::GetCLRPersonalityRoutineValue</span>();</td>
      </tr>
      <tr>
        <td id="L11389" data-line-number="11389"></td>
        <td id="LC11389">
</td>
      </tr>
      <tr>
        <td id="L11390" data-line-number="11390"></td>
        <td id="LC11390">#<span>elif</span> defined(TARGET_ARM)</td>
      </tr>
      <tr>
        <td id="L11391" data-line-number="11391"></td>
        <td id="LC11391">
</td>
      </tr>
      <tr>
        <td id="L11392" data-line-number="11392"></td>
        <td id="LC11392">    *(LONG *)pUnwindInfo |= (<span>1</span> &lt;&lt; <span>20</span>); <span><span>//</span> X bit</span></td>
      </tr>
      <tr>
        <td id="L11393" data-line-number="11393"></td>
        <td id="LC11393">
</td>
      </tr>
      <tr>
        <td id="L11394" data-line-number="11394"></td>
        <td id="LC11394">    ULONG * pPersonalityRoutine = (ULONG*)((BYTE *)pUnwindInfo + <span>ALIGN_UP</span>(unwindSize, <span>sizeof</span>(ULONG)));</td>
      </tr>
      <tr>
        <td id="L11395" data-line-number="11395"></td>
        <td id="LC11395">    *pPersonalityRoutine = (TADDR)ProcessCLRException - baseAddress;</td>
      </tr>
      <tr>
        <td id="L11396" data-line-number="11396"></td>
        <td id="LC11396">
</td>
      </tr>
      <tr>
        <td id="L11397" data-line-number="11397"></td>
        <td id="LC11397">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L11398" data-line-number="11398"></td>
        <td id="LC11398">
</td>
      </tr>
      <tr>
        <td id="L11399" data-line-number="11399"></td>
        <td id="LC11399">#<span>if</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L11400" data-line-number="11400"></td>
        <td id="LC11400">    <span><span>//</span> Publish the new unwind information in a way that the ETW stack crawler can find</span></td>
      </tr>
      <tr>
        <td id="L11401" data-line-number="11401"></td>
        <td id="LC11401">    <span>if</span> (m_usedUnwindInfos == m_totalUnwindInfos)</td>
      </tr>
      <tr>
        <td id="L11402" data-line-number="11402"></td>
        <td id="LC11402">        <span>UnwindInfoTable::PublishUnwindInfoForMethod</span>(baseAddress, m_CodeHeader-&gt;<span>GetUnwindInfo</span>(<span>0</span>), m_totalUnwindInfos);</td>
      </tr>
      <tr>
        <td id="L11403" data-line-number="11403"></td>
        <td id="LC11403">#<span>endif</span> <span><span>//</span> defined(TARGET_AMD64)</span></td>
      </tr>
      <tr>
        <td id="L11404" data-line-number="11404"></td>
        <td id="LC11404">
</td>
      </tr>
      <tr>
        <td id="L11405" data-line-number="11405"></td>
        <td id="LC11405">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11406" data-line-number="11406"></td>
        <td id="LC11406">#<span>else</span> <span><span>//</span> FEATURE_EH_FUNCLETS</span></td>
      </tr>
      <tr>
        <td id="L11407" data-line-number="11407"></td>
        <td id="LC11407">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L11408" data-line-number="11408"></td>
        <td id="LC11408">    <span><span>//</span> Dummy implementation to make cross-platform altjit work</span></td>
      </tr>
      <tr>
        <td id="L11409" data-line-number="11409"></td>
        <td id="LC11409">#<span>endif</span> <span><span>//</span> FEATURE_EH_FUNCLETS</span></td>
      </tr>
      <tr>
        <td id="L11410" data-line-number="11410"></td>
        <td id="LC11410">}</td>
      </tr>
      <tr>
        <td id="L11411" data-line-number="11411"></td>
        <td id="LC11411">
</td>
      </tr>
      <tr>
        <td id="L11412" data-line-number="11412"></td>
        <td id="LC11412"><span>void</span> <span>CEEJitInfo::recordCallSite</span>(ULONG                 instrOffset,</td>
      </tr>
      <tr>
        <td id="L11413" data-line-number="11413"></td>
        <td id="LC11413">                                CORINFO_SIG_INFO *    callSig,</td>
      </tr>
      <tr>
        <td id="L11414" data-line-number="11414"></td>
        <td id="LC11414">                                CORINFO_METHOD_HANDLE methodHandle)</td>
      </tr>
      <tr>
        <td id="L11415" data-line-number="11415"></td>
        <td id="LC11415">{</td>
      </tr>
      <tr>
        <td id="L11416" data-line-number="11416"></td>
        <td id="LC11416">    <span><span>//</span> Currently, only testing tools use this method. The EE itself doesn't need record this information.</span></td>
      </tr>
      <tr>
        <td id="L11417" data-line-number="11417"></td>
        <td id="LC11417">    <span><span>//</span> N.B. The memory that callSig points to is managed by the JIT and isn't guaranteed to be around after</span></td>
      </tr>
      <tr>
        <td id="L11418" data-line-number="11418"></td>
        <td id="LC11418">    <span><span>//</span> this function returns, so future implementations should copy the sig info if they want it to persist.</span></td>
      </tr>
      <tr>
        <td id="L11419" data-line-number="11419"></td>
        <td id="LC11419">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L11420" data-line-number="11420"></td>
        <td id="LC11420">}</td>
      </tr>
      <tr>
        <td id="L11421" data-line-number="11421"></td>
        <td id="LC11421">
</td>
      </tr>
      <tr>
        <td id="L11422" data-line-number="11422"></td>
        <td id="LC11422"><span><span>//</span> This is a variant for AMD64 or other machines that</span></td>
      </tr>
      <tr>
        <td id="L11423" data-line-number="11423"></td>
        <td id="LC11423"><span><span>//</span> cannot always hold the destination address in a 32-bit location</span></td>
      </tr>
      <tr>
        <td id="L11424" data-line-number="11424"></td>
        <td id="LC11424"><span><span>//</span> A relocation is recorded if we are pre-jitting.</span></td>
      </tr>
      <tr>
        <td id="L11425" data-line-number="11425"></td>
        <td id="LC11425"><span><span>//</span> A jump thunk may be inserted if we are jitting</span></td>
      </tr>
      <tr>
        <td id="L11426" data-line-number="11426"></td>
        <td id="LC11426">
</td>
      </tr>
      <tr>
        <td id="L11427" data-line-number="11427"></td>
        <td id="LC11427"><span>void</span> <span>CEEJitInfo::recordRelocation</span>(<span>void</span> * location,</td>
      </tr>
      <tr>
        <td id="L11428" data-line-number="11428"></td>
        <td id="LC11428">                                  <span>void</span> * target,</td>
      </tr>
      <tr>
        <td id="L11429" data-line-number="11429"></td>
        <td id="LC11429">                                  WORD   <span>fRelocType</span>,</td>
      </tr>
      <tr>
        <td id="L11430" data-line-number="11430"></td>
        <td id="LC11430">                                  WORD   slot,</td>
      </tr>
      <tr>
        <td id="L11431" data-line-number="11431"></td>
        <td id="LC11431">                                  INT32  addlDelta)</td>
      </tr>
      <tr>
        <td id="L11432" data-line-number="11432"></td>
        <td id="LC11432">{</td>
      </tr>
      <tr>
        <td id="L11433" data-line-number="11433"></td>
        <td id="LC11433">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11434" data-line-number="11434"></td>
        <td id="LC11434">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11435" data-line-number="11435"></td>
        <td id="LC11435">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11436" data-line-number="11436"></td>
        <td id="LC11436">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11437" data-line-number="11437"></td>
        <td id="LC11437">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11438" data-line-number="11438"></td>
        <td id="LC11438">
</td>
      </tr>
      <tr>
        <td id="L11439" data-line-number="11439"></td>
        <td id="LC11439">#<span>ifdef</span> HOST_64BIT</td>
      </tr>
      <tr>
        <td id="L11440" data-line-number="11440"></td>
        <td id="LC11440">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11441" data-line-number="11441"></td>
        <td id="LC11441">
</td>
      </tr>
      <tr>
        <td id="L11442" data-line-number="11442"></td>
        <td id="LC11442">    INT64 delta;</td>
      </tr>
      <tr>
        <td id="L11443" data-line-number="11443"></td>
        <td id="LC11443">
</td>
      </tr>
      <tr>
        <td id="L11444" data-line-number="11444"></td>
        <td id="LC11444">    <span>switch</span> (<span>fRelocType</span>)</td>
      </tr>
      <tr>
        <td id="L11445" data-line-number="11445"></td>
        <td id="LC11445">    {</td>
      </tr>
      <tr>
        <td id="L11446" data-line-number="11446"></td>
        <td id="LC11446">    <span>case</span> IMAGE_REL_BASED_DIR64:</td>
      </tr>
      <tr>
        <td id="L11447" data-line-number="11447"></td>
        <td id="LC11447">        <span><span>//</span> Write 64-bits into location</span></td>
      </tr>
      <tr>
        <td id="L11448" data-line-number="11448"></td>
        <td id="LC11448">        *((UINT64 *) ((BYTE *) location + slot)) = (UINT64) target;</td>
      </tr>
      <tr>
        <td id="L11449" data-line-number="11449"></td>
        <td id="LC11449">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L11450" data-line-number="11450"></td>
        <td id="LC11450">
</td>
      </tr>
      <tr>
        <td id="L11451" data-line-number="11451"></td>
        <td id="LC11451">#<span>ifdef</span> TARGET_AMD64</td>
      </tr>
      <tr>
        <td id="L11452" data-line-number="11452"></td>
        <td id="LC11452">    <span>case</span> IMAGE_REL_BASED_REL32:</td>
      </tr>
      <tr>
        <td id="L11453" data-line-number="11453"></td>
        <td id="LC11453">        {</td>
      </tr>
      <tr>
        <td id="L11454" data-line-number="11454"></td>
        <td id="LC11454">            target = (BYTE *)target + addlDelta;</td>
      </tr>
      <tr>
        <td id="L11455" data-line-number="11455"></td>
        <td id="LC11455">
</td>
      </tr>
      <tr>
        <td id="L11456" data-line-number="11456"></td>
        <td id="LC11456">            INT32 * fixupLocation = (INT32 *) ((BYTE *) location + slot);</td>
      </tr>
      <tr>
        <td id="L11457" data-line-number="11457"></td>
        <td id="LC11457">            BYTE * baseAddr = (BYTE *)fixupLocation + <span>sizeof</span>(INT32);</td>
      </tr>
      <tr>
        <td id="L11458" data-line-number="11458"></td>
        <td id="LC11458">
</td>
      </tr>
      <tr>
        <td id="L11459" data-line-number="11459"></td>
        <td id="LC11459">            delta  = (INT64)((BYTE *)target - baseAddr);</td>
      </tr>
      <tr>
        <td id="L11460" data-line-number="11460"></td>
        <td id="LC11460">
</td>
      </tr>
      <tr>
        <td id="L11461" data-line-number="11461"></td>
        <td id="LC11461">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11462" data-line-number="11462"></td>
        <td id="LC11462">            <span><span>//</span> Do we need to insert a jump stub to make the source reach the target?</span></td>
      </tr>
      <tr>
        <td id="L11463" data-line-number="11463"></td>
        <td id="LC11463">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11464" data-line-number="11464"></td>
        <td id="LC11464">            <span><span>//</span> Note that we cannot stress insertion of jump stub by inserting it unconditionally. JIT records the relocations</span></td>
      </tr>
      <tr>
        <td id="L11465" data-line-number="11465"></td>
        <td id="LC11465">            <span><span>//</span> for intra-module jumps and calls. It does not expect the register used by the jump stub to be trashed.</span></td>
      </tr>
      <tr>
        <td id="L11466" data-line-number="11466"></td>
        <td id="LC11466">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11467" data-line-number="11467"></td>
        <td id="LC11467">            <span>if</span> (!<span>FitsInI4</span>(delta))</td>
      </tr>
      <tr>
        <td id="L11468" data-line-number="11468"></td>
        <td id="LC11468">            {</td>
      </tr>
      <tr>
        <td id="L11469" data-line-number="11469"></td>
        <td id="LC11469">                <span>if</span> (m_fAllowRel32)</td>
      </tr>
      <tr>
        <td id="L11470" data-line-number="11470"></td>
        <td id="LC11470">                {</td>
      </tr>
      <tr>
        <td id="L11471" data-line-number="11471"></td>
        <td id="LC11471">                    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11472" data-line-number="11472"></td>
        <td id="LC11472">                    <span><span>//</span> When m_fAllowRel32 == TRUE, the JIT will use REL32s for both data addresses and direct code targets.</span></td>
      </tr>
      <tr>
        <td id="L11473" data-line-number="11473"></td>
        <td id="LC11473">                    <span><span>//</span> Since we cannot tell what the relocation is for, we have to defensively retry.</span></td>
      </tr>
      <tr>
        <td id="L11474" data-line-number="11474"></td>
        <td id="LC11474">                    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11475" data-line-number="11475"></td>
        <td id="LC11475">                    m_fJumpStubOverflow = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L11476" data-line-number="11476"></td>
        <td id="LC11476">                    delta = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L11477" data-line-number="11477"></td>
        <td id="LC11477">                }</td>
      </tr>
      <tr>
        <td id="L11478" data-line-number="11478"></td>
        <td id="LC11478">                <span>else</span></td>
      </tr>
      <tr>
        <td id="L11479" data-line-number="11479"></td>
        <td id="LC11479">                {</td>
      </tr>
      <tr>
        <td id="L11480" data-line-number="11480"></td>
        <td id="LC11480">                    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11481" data-line-number="11481"></td>
        <td id="LC11481">                    <span><span>//</span> When m_fAllowRel32 == FALSE, the JIT will use a REL32s for direct code targets only.</span></td>
      </tr>
      <tr>
        <td id="L11482" data-line-number="11482"></td>
        <td id="LC11482">                    <span><span>//</span> Use jump stub.</span></td>
      </tr>
      <tr>
        <td id="L11483" data-line-number="11483"></td>
        <td id="LC11483">                    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11484" data-line-number="11484"></td>
        <td id="LC11484">                    delta = <span>rel32UsingJumpStub</span>(fixupLocation, (PCODE)target, m_pMethodBeingCompiled, <span>NULL</span>, <span>false</span> <span><span>/*</span> throwOnOutOfMemoryWithinRange <span>*/</span></span>);</td>
      </tr>
      <tr>
        <td id="L11485" data-line-number="11485"></td>
        <td id="LC11485">                    <span>if</span> (delta == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L11486" data-line-number="11486"></td>
        <td id="LC11486">                    {</td>
      </tr>
      <tr>
        <td id="L11487" data-line-number="11487"></td>
        <td id="LC11487">                        <span><span>//</span> This forces the JIT to retry the method, which allows us to reserve more space for jump stubs and have a higher chance that</span></td>
      </tr>
      <tr>
        <td id="L11488" data-line-number="11488"></td>
        <td id="LC11488">                        <span><span>//</span> we will find space for them.</span></td>
      </tr>
      <tr>
        <td id="L11489" data-line-number="11489"></td>
        <td id="LC11489">                        m_fJumpStubOverflow = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L11490" data-line-number="11490"></td>
        <td id="LC11490">                    }</td>
      </tr>
      <tr>
        <td id="L11491" data-line-number="11491"></td>
        <td id="LC11491">
</td>
      </tr>
      <tr>
        <td id="L11492" data-line-number="11492"></td>
        <td id="LC11492">                    <span><span>//</span> Keep track of conservative estimate of how much memory may be needed by jump stubs. We will use it to reserve extra memory</span></td>
      </tr>
      <tr>
        <td id="L11493" data-line-number="11493"></td>
        <td id="LC11493">                    <span><span>//</span> on retry to increase chances that the retry succeeds.</span></td>
      </tr>
      <tr>
        <td id="L11494" data-line-number="11494"></td>
        <td id="LC11494">                    m_reserveForJumpStubs = <span>max</span>(<span>0x400</span>, m_reserveForJumpStubs + <span>0x10</span>);</td>
      </tr>
      <tr>
        <td id="L11495" data-line-number="11495"></td>
        <td id="LC11495">                }</td>
      </tr>
      <tr>
        <td id="L11496" data-line-number="11496"></td>
        <td id="LC11496">            }</td>
      </tr>
      <tr>
        <td id="L11497" data-line-number="11497"></td>
        <td id="LC11497">
</td>
      </tr>
      <tr>
        <td id="L11498" data-line-number="11498"></td>
        <td id="LC11498">            <span>LOG</span>((LF_JIT, LL_INFO100000, <span><span>"</span>Encoded a PCREL32 at<span>"</span></span> FMT_ADDR <span><span>"</span>to<span>"</span></span> FMT_ADDR <span><span>"</span>+%d,  delta is 0x%04x<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L11499" data-line-number="11499"></td>
        <td id="LC11499">                 <span>DBG_ADDR</span>(fixupLocation), <span>DBG_ADDR</span>(target), addlDelta, delta));</td>
      </tr>
      <tr>
        <td id="L11500" data-line-number="11500"></td>
        <td id="LC11500">
</td>
      </tr>
      <tr>
        <td id="L11501" data-line-number="11501"></td>
        <td id="LC11501">            <span><span>//</span> Write the 32-bits pc-relative delta into location</span></td>
      </tr>
      <tr>
        <td id="L11502" data-line-number="11502"></td>
        <td id="LC11502">            *fixupLocation = (INT32) delta;</td>
      </tr>
      <tr>
        <td id="L11503" data-line-number="11503"></td>
        <td id="LC11503">        }</td>
      </tr>
      <tr>
        <td id="L11504" data-line-number="11504"></td>
        <td id="LC11504">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L11505" data-line-number="11505"></td>
        <td id="LC11505">#<span>endif</span> <span><span>//</span> TARGET_AMD64</span></td>
      </tr>
      <tr>
        <td id="L11506" data-line-number="11506"></td>
        <td id="LC11506">
</td>
      </tr>
      <tr>
        <td id="L11507" data-line-number="11507"></td>
        <td id="LC11507">#<span>ifdef</span> TARGET_ARM64</td>
      </tr>
      <tr>
        <td id="L11508" data-line-number="11508"></td>
        <td id="LC11508">    <span>case</span> IMAGE_REL_ARM64_BRANCH26:   <span><span>//</span> 26 bit offset &lt;&lt; 2 &amp; sign ext, for B and BL</span></td>
      </tr>
      <tr>
        <td id="L11509" data-line-number="11509"></td>
        <td id="LC11509">        {</td>
      </tr>
      <tr>
        <td id="L11510" data-line-number="11510"></td>
        <td id="LC11510">            <span>_ASSERTE</span>(slot == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11511" data-line-number="11511"></td>
        <td id="LC11511">            <span>_ASSERTE</span>(addlDelta == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11512" data-line-number="11512"></td>
        <td id="LC11512">
</td>
      </tr>
      <tr>
        <td id="L11513" data-line-number="11513"></td>
        <td id="LC11513">            PCODE branchTarget  = (PCODE) target;</td>
      </tr>
      <tr>
        <td id="L11514" data-line-number="11514"></td>
        <td id="LC11514">            <span>_ASSERTE</span>((branchTarget &amp; <span>0x3</span>) == <span>0</span>);   <span><span>//</span> the low two bits must be zero</span></td>
      </tr>
      <tr>
        <td id="L11515" data-line-number="11515"></td>
        <td id="LC11515">
</td>
      </tr>
      <tr>
        <td id="L11516" data-line-number="11516"></td>
        <td id="LC11516">            PCODE fixupLocation = (PCODE) location;</td>
      </tr>
      <tr>
        <td id="L11517" data-line-number="11517"></td>
        <td id="LC11517">            <span>_ASSERTE</span>((fixupLocation &amp; <span>0x3</span>) == <span>0</span>);  <span><span>//</span> the low two bits must be zero</span></td>
      </tr>
      <tr>
        <td id="L11518" data-line-number="11518"></td>
        <td id="LC11518">
</td>
      </tr>
      <tr>
        <td id="L11519" data-line-number="11519"></td>
        <td id="LC11519">            delta = (INT64)(branchTarget - fixupLocation);</td>
      </tr>
      <tr>
        <td id="L11520" data-line-number="11520"></td>
        <td id="LC11520">            <span>_ASSERTE</span>((delta &amp; <span>0x3</span>) == <span>0</span>);          <span><span>//</span> the low two bits must be zero</span></td>
      </tr>
      <tr>
        <td id="L11521" data-line-number="11521"></td>
        <td id="LC11521">
</td>
      </tr>
      <tr>
        <td id="L11522" data-line-number="11522"></td>
        <td id="LC11522">            UINT32 branchInstr = *((UINT32*) fixupLocation);</td>
      </tr>
      <tr>
        <td id="L11523" data-line-number="11523"></td>
        <td id="LC11523">            branchInstr &amp;= <span>0xFC000000</span>;  <span><span>//</span> keep bits 31-26</span></td>
      </tr>
      <tr>
        <td id="L11524" data-line-number="11524"></td>
        <td id="LC11524">            <span>_ASSERTE</span>((branchInstr &amp; <span>0x7FFFFFFF</span>) == <span>0x14000000</span>);  <span><span>//</span> Must be B or BL</span></td>
      </tr>
      <tr>
        <td id="L11525" data-line-number="11525"></td>
        <td id="LC11525">
</td>
      </tr>
      <tr>
        <td id="L11526" data-line-number="11526"></td>
        <td id="LC11526">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11527" data-line-number="11527"></td>
        <td id="LC11527">            <span><span>//</span> Do we need to insert a jump stub to make the source reach the target?</span></td>
      </tr>
      <tr>
        <td id="L11528" data-line-number="11528"></td>
        <td id="LC11528">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11529" data-line-number="11529"></td>
        <td id="LC11529">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11530" data-line-number="11530"></td>
        <td id="LC11530">            <span>if</span> (!<span>FitsInRel28</span>(delta))</td>
      </tr>
      <tr>
        <td id="L11531" data-line-number="11531"></td>
        <td id="LC11531">            {</td>
      </tr>
      <tr>
        <td id="L11532" data-line-number="11532"></td>
        <td id="LC11532">                <span><span>//</span> Use jump stub.</span></td>
      </tr>
      <tr>
        <td id="L11533" data-line-number="11533"></td>
        <td id="LC11533">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L11534" data-line-number="11534"></td>
        <td id="LC11534">                TADDR baseAddr = (TADDR)fixupLocation;</td>
      </tr>
      <tr>
        <td id="L11535" data-line-number="11535"></td>
        <td id="LC11535">                TADDR loAddr   = baseAddr - <span>0x08000000</span>;   <span><span>//</span> -2^27</span></td>
      </tr>
      <tr>
        <td id="L11536" data-line-number="11536"></td>
        <td id="LC11536">                TADDR hiAddr   = baseAddr + <span>0x07FFFFFF</span>;   <span><span>//</span> +2^27-1</span></td>
      </tr>
      <tr>
        <td id="L11537" data-line-number="11537"></td>
        <td id="LC11537">
</td>
      </tr>
      <tr>
        <td id="L11538" data-line-number="11538"></td>
        <td id="LC11538">                <span><span>//</span> Check for the wrap around cases</span></td>
      </tr>
      <tr>
        <td id="L11539" data-line-number="11539"></td>
        <td id="LC11539">                <span>if</span> (loAddr &gt; baseAddr)</td>
      </tr>
      <tr>
        <td id="L11540" data-line-number="11540"></td>
        <td id="LC11540">                    loAddr = UINT64_MIN; <span><span>//</span> overflow</span></td>
      </tr>
      <tr>
        <td id="L11541" data-line-number="11541"></td>
        <td id="LC11541">                <span>if</span> (hiAddr &lt; baseAddr)</td>
      </tr>
      <tr>
        <td id="L11542" data-line-number="11542"></td>
        <td id="LC11542">                    hiAddr = UINT64_MAX; <span><span>//</span> overflow</span></td>
      </tr>
      <tr>
        <td id="L11543" data-line-number="11543"></td>
        <td id="LC11543">
</td>
      </tr>
      <tr>
        <td id="L11544" data-line-number="11544"></td>
        <td id="LC11544">                PCODE jumpStubAddr = <span>ExecutionManager::jumpStub</span>(m_pMethodBeingCompiled,</td>
      </tr>
      <tr>
        <td id="L11545" data-line-number="11545"></td>
        <td id="LC11545">                                                                (PCODE)  target,</td>
      </tr>
      <tr>
        <td id="L11546" data-line-number="11546"></td>
        <td id="LC11546">                                                                (BYTE *) loAddr,</td>
      </tr>
      <tr>
        <td id="L11547" data-line-number="11547"></td>
        <td id="LC11547">                                                                (BYTE *) hiAddr,</td>
      </tr>
      <tr>
        <td id="L11548" data-line-number="11548"></td>
        <td id="LC11548">                                                                <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L11549" data-line-number="11549"></td>
        <td id="LC11549">                                                                <span>false</span>);</td>
      </tr>
      <tr>
        <td id="L11550" data-line-number="11550"></td>
        <td id="LC11550">
</td>
      </tr>
      <tr>
        <td id="L11551" data-line-number="11551"></td>
        <td id="LC11551">                <span><span>//</span> Keep track of conservative estimate of how much memory may be needed by jump stubs. We will use it to reserve extra memory</span></td>
      </tr>
      <tr>
        <td id="L11552" data-line-number="11552"></td>
        <td id="LC11552">                <span><span>//</span> on retry to increase chances that the retry succeeds.</span></td>
      </tr>
      <tr>
        <td id="L11553" data-line-number="11553"></td>
        <td id="LC11553">                m_reserveForJumpStubs = <span>max</span>(<span>0x400</span>, m_reserveForJumpStubs + <span>2</span>*BACK_TO_BACK_JUMP_ALLOCATE_SIZE);</td>
      </tr>
      <tr>
        <td id="L11554" data-line-number="11554"></td>
        <td id="LC11554">
</td>
      </tr>
      <tr>
        <td id="L11555" data-line-number="11555"></td>
        <td id="LC11555">                <span>if</span> (jumpStubAddr == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L11556" data-line-number="11556"></td>
        <td id="LC11556">                {</td>
      </tr>
      <tr>
        <td id="L11557" data-line-number="11557"></td>
        <td id="LC11557">                    <span><span>//</span> This forces the JIT to retry the method, which allows us to reserve more space for jump stubs and have a higher chance that</span></td>
      </tr>
      <tr>
        <td id="L11558" data-line-number="11558"></td>
        <td id="LC11558">                    <span><span>//</span> we will find space for them.</span></td>
      </tr>
      <tr>
        <td id="L11559" data-line-number="11559"></td>
        <td id="LC11559">                    m_fJumpStubOverflow = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L11560" data-line-number="11560"></td>
        <td id="LC11560">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L11561" data-line-number="11561"></td>
        <td id="LC11561">                }</td>
      </tr>
      <tr>
        <td id="L11562" data-line-number="11562"></td>
        <td id="LC11562">
</td>
      </tr>
      <tr>
        <td id="L11563" data-line-number="11563"></td>
        <td id="LC11563">                delta = (INT64)(jumpStubAddr - fixupLocation);</td>
      </tr>
      <tr>
        <td id="L11564" data-line-number="11564"></td>
        <td id="LC11564">
</td>
      </tr>
      <tr>
        <td id="L11565" data-line-number="11565"></td>
        <td id="LC11565">                <span>if</span> (!<span>FitsInRel28</span>(delta))</td>
      </tr>
      <tr>
        <td id="L11566" data-line-number="11566"></td>
        <td id="LC11566">                {</td>
      </tr>
      <tr>
        <td id="L11567" data-line-number="11567"></td>
        <td id="LC11567">                    <span>_ASSERTE</span>(!<span><span>"</span>jump stub was not in expected range<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11568" data-line-number="11568"></td>
        <td id="LC11568">                    <span>EEPOLICY_HANDLE_FATAL_ERROR</span>(COR_E_EXECUTIONENGINE);</td>
      </tr>
      <tr>
        <td id="L11569" data-line-number="11569"></td>
        <td id="LC11569">                }</td>
      </tr>
      <tr>
        <td id="L11570" data-line-number="11570"></td>
        <td id="LC11570">
</td>
      </tr>
      <tr>
        <td id="L11571" data-line-number="11571"></td>
        <td id="LC11571">                <span>LOG</span>((LF_JIT, LL_INFO100000, <span><span>"</span>Using JumpStub at<span>"</span></span> FMT_ADDR <span><span>"</span>that jumps to<span>"</span></span> FMT_ADDR <span><span>"</span><span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L11572" data-line-number="11572"></td>
        <td id="LC11572">                     <span>DBG_ADDR</span>(jumpStubAddr), <span>DBG_ADDR</span>(target)));</td>
      </tr>
      <tr>
        <td id="L11573" data-line-number="11573"></td>
        <td id="LC11573">            }</td>
      </tr>
      <tr>
        <td id="L11574" data-line-number="11574"></td>
        <td id="LC11574">
</td>
      </tr>
      <tr>
        <td id="L11575" data-line-number="11575"></td>
        <td id="LC11575">            <span>LOG</span>((LF_JIT, LL_INFO100000, <span><span>"</span>Encoded a BRANCH26 at<span>"</span></span> FMT_ADDR <span><span>"</span>to<span>"</span></span> FMT_ADDR <span><span>"</span>,  delta is 0x%04x<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L11576" data-line-number="11576"></td>
        <td id="LC11576">                 <span>DBG_ADDR</span>(fixupLocation), <span>DBG_ADDR</span>(target), delta));</td>
      </tr>
      <tr>
        <td id="L11577" data-line-number="11577"></td>
        <td id="LC11577">
</td>
      </tr>
      <tr>
        <td id="L11578" data-line-number="11578"></td>
        <td id="LC11578">            <span>_ASSERTE</span>(<span>FitsInRel28</span>(delta));</td>
      </tr>
      <tr>
        <td id="L11579" data-line-number="11579"></td>
        <td id="LC11579">
</td>
      </tr>
      <tr>
        <td id="L11580" data-line-number="11580"></td>
        <td id="LC11580">            <span>PutArm64Rel28</span>((UINT32*) fixupLocation, (INT32)delta);</td>
      </tr>
      <tr>
        <td id="L11581" data-line-number="11581"></td>
        <td id="LC11581">        }</td>
      </tr>
      <tr>
        <td id="L11582" data-line-number="11582"></td>
        <td id="LC11582">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L11583" data-line-number="11583"></td>
        <td id="LC11583">
</td>
      </tr>
      <tr>
        <td id="L11584" data-line-number="11584"></td>
        <td id="LC11584">    <span>case</span> IMAGE_REL_ARM64_PAGEBASE_REL21:</td>
      </tr>
      <tr>
        <td id="L11585" data-line-number="11585"></td>
        <td id="LC11585">        {</td>
      </tr>
      <tr>
        <td id="L11586" data-line-number="11586"></td>
        <td id="LC11586">            <span>_ASSERTE</span>(slot == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11587" data-line-number="11587"></td>
        <td id="LC11587">            <span>_ASSERTE</span>(addlDelta == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11588" data-line-number="11588"></td>
        <td id="LC11588">
</td>
      </tr>
      <tr>
        <td id="L11589" data-line-number="11589"></td>
        <td id="LC11589">            <span><span>//</span> Write the 21 bits pc-relative page address into location.</span></td>
      </tr>
      <tr>
        <td id="L11590" data-line-number="11590"></td>
        <td id="LC11590">            INT64 targetPage = (INT64)target &amp; <span>0xFFFFFFFFFFFFF000LL</span>;</td>
      </tr>
      <tr>
        <td id="L11591" data-line-number="11591"></td>
        <td id="LC11591">            INT64 locationPage = (INT64)location &amp; <span>0xFFFFFFFFFFFFF000LL</span>;</td>
      </tr>
      <tr>
        <td id="L11592" data-line-number="11592"></td>
        <td id="LC11592">            INT64 relPage = (INT64)(targetPage - locationPage);</td>
      </tr>
      <tr>
        <td id="L11593" data-line-number="11593"></td>
        <td id="LC11593">            INT32 imm21 = (INT32)(relPage &gt;&gt; <span>12</span>) &amp; <span>0x1FFFFF</span>;</td>
      </tr>
      <tr>
        <td id="L11594" data-line-number="11594"></td>
        <td id="LC11594">            <span>PutArm64Rel21</span>((UINT32 *)location, imm21);</td>
      </tr>
      <tr>
        <td id="L11595" data-line-number="11595"></td>
        <td id="LC11595">        }</td>
      </tr>
      <tr>
        <td id="L11596" data-line-number="11596"></td>
        <td id="LC11596">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L11597" data-line-number="11597"></td>
        <td id="LC11597">
</td>
      </tr>
      <tr>
        <td id="L11598" data-line-number="11598"></td>
        <td id="LC11598">    <span>case</span> IMAGE_REL_ARM64_PAGEOFFSET_12A:</td>
      </tr>
      <tr>
        <td id="L11599" data-line-number="11599"></td>
        <td id="LC11599">        {</td>
      </tr>
      <tr>
        <td id="L11600" data-line-number="11600"></td>
        <td id="LC11600">            <span>_ASSERTE</span>(slot == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11601" data-line-number="11601"></td>
        <td id="LC11601">            <span>_ASSERTE</span>(addlDelta == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L11602" data-line-number="11602"></td>
        <td id="LC11602">
</td>
      </tr>
      <tr>
        <td id="L11603" data-line-number="11603"></td>
        <td id="LC11603">            <span><span>//</span> Write the 12 bits page offset into location.</span></td>
      </tr>
      <tr>
        <td id="L11604" data-line-number="11604"></td>
        <td id="LC11604">            INT32 imm12 = (INT32)(SIZE_T)target &amp; <span>0xFFFLL</span>;</td>
      </tr>
      <tr>
        <td id="L11605" data-line-number="11605"></td>
        <td id="LC11605">            <span>PutArm64Rel12</span>((UINT32 *)location, imm12);</td>
      </tr>
      <tr>
        <td id="L11606" data-line-number="11606"></td>
        <td id="LC11606">        }</td>
      </tr>
      <tr>
        <td id="L11607" data-line-number="11607"></td>
        <td id="LC11607">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L11608" data-line-number="11608"></td>
        <td id="LC11608">
</td>
      </tr>
      <tr>
        <td id="L11609" data-line-number="11609"></td>
        <td id="LC11609">#<span>endif</span> <span><span>//</span> TARGET_ARM64</span></td>
      </tr>
      <tr>
        <td id="L11610" data-line-number="11610"></td>
        <td id="LC11610">
</td>
      </tr>
      <tr>
        <td id="L11611" data-line-number="11611"></td>
        <td id="LC11611">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L11612" data-line-number="11612"></td>
        <td id="LC11612">        <span>_ASSERTE</span>(!<span><span>"</span>Unknown reloc type<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11613" data-line-number="11613"></td>
        <td id="LC11613">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L11614" data-line-number="11614"></td>
        <td id="LC11614">    }</td>
      </tr>
      <tr>
        <td id="L11615" data-line-number="11615"></td>
        <td id="LC11615">
</td>
      </tr>
      <tr>
        <td id="L11616" data-line-number="11616"></td>
        <td id="LC11616">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11617" data-line-number="11617"></td>
        <td id="LC11617">#<span>else</span> <span><span>//</span> HOST_64BIT</span></td>
      </tr>
      <tr>
        <td id="L11618" data-line-number="11618"></td>
        <td id="LC11618">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L11619" data-line-number="11619"></td>
        <td id="LC11619">
</td>
      </tr>
      <tr>
        <td id="L11620" data-line-number="11620"></td>
        <td id="LC11620">    <span><span>//</span> Nothing to do on 32-bit</span></td>
      </tr>
      <tr>
        <td id="L11621" data-line-number="11621"></td>
        <td id="LC11621">
</td>
      </tr>
      <tr>
        <td id="L11622" data-line-number="11622"></td>
        <td id="LC11622">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L11623" data-line-number="11623"></td>
        <td id="LC11623">#<span>endif</span> <span><span>//</span> HOST_64BIT</span></td>
      </tr>
      <tr>
        <td id="L11624" data-line-number="11624"></td>
        <td id="LC11624">}</td>
      </tr>
      <tr>
        <td id="L11625" data-line-number="11625"></td>
        <td id="LC11625">
</td>
      </tr>
      <tr>
        <td id="L11626" data-line-number="11626"></td>
        <td id="LC11626">WORD <span>CEEJitInfo::getRelocTypeHint</span>(<span>void</span> * target)</td>
      </tr>
      <tr>
        <td id="L11627" data-line-number="11627"></td>
        <td id="LC11627">{</td>
      </tr>
      <tr>
        <td id="L11628" data-line-number="11628"></td>
        <td id="LC11628">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11629" data-line-number="11629"></td>
        <td id="LC11629">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11630" data-line-number="11630"></td>
        <td id="LC11630">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11631" data-line-number="11631"></td>
        <td id="LC11631">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11632" data-line-number="11632"></td>
        <td id="LC11632">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11633" data-line-number="11633"></td>
        <td id="LC11633">
</td>
      </tr>
      <tr>
        <td id="L11634" data-line-number="11634"></td>
        <td id="LC11634">#<span>ifdef</span> TARGET_AMD64</td>
      </tr>
      <tr>
        <td id="L11635" data-line-number="11635"></td>
        <td id="LC11635">    <span>if</span> (m_fAllowRel32)</td>
      </tr>
      <tr>
        <td id="L11636" data-line-number="11636"></td>
        <td id="LC11636">    {</td>
      </tr>
      <tr>
        <td id="L11637" data-line-number="11637"></td>
        <td id="LC11637">        <span><span>//</span> The JIT calls this method for data addresses only. It always uses REL32s for direct code targets.</span></td>
      </tr>
      <tr>
        <td id="L11638" data-line-number="11638"></td>
        <td id="LC11638">        <span>if</span> (<span>IsPreferredExecutableRange</span>(target))</td>
      </tr>
      <tr>
        <td id="L11639" data-line-number="11639"></td>
        <td id="LC11639">            <span>return</span> IMAGE_REL_BASED_REL32;</td>
      </tr>
      <tr>
        <td id="L11640" data-line-number="11640"></td>
        <td id="LC11640">    }</td>
      </tr>
      <tr>
        <td id="L11641" data-line-number="11641"></td>
        <td id="LC11641">#<span>endif</span> <span><span>//</span> TARGET_AMD64</span></td>
      </tr>
      <tr>
        <td id="L11642" data-line-number="11642"></td>
        <td id="LC11642">
</td>
      </tr>
      <tr>
        <td id="L11643" data-line-number="11643"></td>
        <td id="LC11643">    <span><span>//</span> No hints</span></td>
      </tr>
      <tr>
        <td id="L11644" data-line-number="11644"></td>
        <td id="LC11644">    <span>return</span> (WORD)-<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L11645" data-line-number="11645"></td>
        <td id="LC11645">}</td>
      </tr>
      <tr>
        <td id="L11646" data-line-number="11646"></td>
        <td id="LC11646">
</td>
      </tr>
      <tr>
        <td id="L11647" data-line-number="11647"></td>
        <td id="LC11647"><span>void</span> <span>CEEJitInfo::getModuleNativeEntryPointRange</span>(<span>void</span>** pStart, <span>void</span>** pEnd)</td>
      </tr>
      <tr>
        <td id="L11648" data-line-number="11648"></td>
        <td id="LC11648">{</td>
      </tr>
      <tr>
        <td id="L11649" data-line-number="11649"></td>
        <td id="LC11649">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11650" data-line-number="11650"></td>
        <td id="LC11650">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L11651" data-line-number="11651"></td>
        <td id="LC11651">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L11652" data-line-number="11652"></td>
        <td id="LC11652">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11653" data-line-number="11653"></td>
        <td id="LC11653">    }</td>
      </tr>
      <tr>
        <td id="L11654" data-line-number="11654"></td>
        <td id="LC11654">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11655" data-line-number="11655"></td>
        <td id="LC11655">
</td>
      </tr>
      <tr>
        <td id="L11656" data-line-number="11656"></td>
        <td id="LC11656">    <span>JIT_TO_EE_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L11657" data-line-number="11657"></td>
        <td id="LC11657">
</td>
      </tr>
      <tr>
        <td id="L11658" data-line-number="11658"></td>
        <td id="LC11658">    *pStart = *pEnd = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L11659" data-line-number="11659"></td>
        <td id="LC11659">
</td>
      </tr>
      <tr>
        <td id="L11660" data-line-number="11660"></td>
        <td id="LC11660">    <span>EE_TO_JIT_TRANSITION_LEAF</span>();</td>
      </tr>
      <tr>
        <td id="L11661" data-line-number="11661"></td>
        <td id="LC11661">}</td>
      </tr>
      <tr>
        <td id="L11662" data-line-number="11662"></td>
        <td id="LC11662">
</td>
      </tr>
      <tr>
        <td id="L11663" data-line-number="11663"></td>
        <td id="LC11663">DWORD <span>CEEJitInfo::getExpectedTargetArchitecture</span>()</td>
      </tr>
      <tr>
        <td id="L11664" data-line-number="11664"></td>
        <td id="LC11664">{</td>
      </tr>
      <tr>
        <td id="L11665" data-line-number="11665"></td>
        <td id="LC11665">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L11666" data-line-number="11666"></td>
        <td id="LC11666">
</td>
      </tr>
      <tr>
        <td id="L11667" data-line-number="11667"></td>
        <td id="LC11667">    <span>return</span> IMAGE_FILE_MACHINE_NATIVE;</td>
      </tr>
      <tr>
        <td id="L11668" data-line-number="11668"></td>
        <td id="LC11668">}</td>
      </tr>
      <tr>
        <td id="L11669" data-line-number="11669"></td>
        <td id="LC11669">
</td>
      </tr>
      <tr>
        <td id="L11670" data-line-number="11670"></td>
        <td id="LC11670"><span>void</span> <span>CEEInfo::JitProcessShutdownWork</span>()</td>
      </tr>
      <tr>
        <td id="L11671" data-line-number="11671"></td>
        <td id="LC11671">{</td>
      </tr>
      <tr>
        <td id="L11672" data-line-number="11672"></td>
        <td id="LC11672">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L11673" data-line-number="11673"></td>
        <td id="LC11673">
</td>
      </tr>
      <tr>
        <td id="L11674" data-line-number="11674"></td>
        <td id="LC11674">    EEJitManager* jitMgr = <span>ExecutionManager::GetEEJitManager</span>();</td>
      </tr>
      <tr>
        <td id="L11675" data-line-number="11675"></td>
        <td id="LC11675">
</td>
      </tr>
      <tr>
        <td id="L11676" data-line-number="11676"></td>
        <td id="LC11676">    <span><span>//</span> If we didn't load the JIT, there is no work to do.</span></td>
      </tr>
      <tr>
        <td id="L11677" data-line-number="11677"></td>
        <td id="LC11677">    <span>if</span> (jitMgr-&gt;<span>m_jit</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11678" data-line-number="11678"></td>
        <td id="LC11678">    {</td>
      </tr>
      <tr>
        <td id="L11679" data-line-number="11679"></td>
        <td id="LC11679">        <span><span>//</span> Do the shutdown work.</span></td>
      </tr>
      <tr>
        <td id="L11680" data-line-number="11680"></td>
        <td id="LC11680">        jitMgr-&gt;<span>m_jit</span>-&gt;<span>ProcessShutdownWork</span>(<span>this</span>);</td>
      </tr>
      <tr>
        <td id="L11681" data-line-number="11681"></td>
        <td id="LC11681">    }</td>
      </tr>
      <tr>
        <td id="L11682" data-line-number="11682"></td>
        <td id="LC11682">
</td>
      </tr>
      <tr>
        <td id="L11683" data-line-number="11683"></td>
        <td id="LC11683">#<span>ifdef</span> ALLOW_SXS_JIT</td>
      </tr>
      <tr>
        <td id="L11684" data-line-number="11684"></td>
        <td id="LC11684">    <span>if</span> (jitMgr-&gt;<span>m_alternateJit</span> != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11685" data-line-number="11685"></td>
        <td id="LC11685">    {</td>
      </tr>
      <tr>
        <td id="L11686" data-line-number="11686"></td>
        <td id="LC11686">        jitMgr-&gt;<span>m_alternateJit</span>-&gt;<span>ProcessShutdownWork</span>(<span>this</span>);</td>
      </tr>
      <tr>
        <td id="L11687" data-line-number="11687"></td>
        <td id="LC11687">    }</td>
      </tr>
      <tr>
        <td id="L11688" data-line-number="11688"></td>
        <td id="LC11688">#<span>endif</span> <span><span>//</span> ALLOW_SXS_JIT</span></td>
      </tr>
      <tr>
        <td id="L11689" data-line-number="11689"></td>
        <td id="LC11689">}</td>
      </tr>
      <tr>
        <td id="L11690" data-line-number="11690"></td>
        <td id="LC11690">
</td>
      </tr>
      <tr>
        <td id="L11691" data-line-number="11691"></td>
        <td id="LC11691"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11692" data-line-number="11692"></td>
        <td id="LC11692">InfoAccessType <span>CEEJitInfo::constructStringLiteral</span>(CORINFO_MODULE_HANDLE scopeHnd,</td>
      </tr>
      <tr>
        <td id="L11693" data-line-number="11693"></td>
        <td id="LC11693">                                                  mdToken metaTok,</td>
      </tr>
      <tr>
        <td id="L11694" data-line-number="11694"></td>
        <td id="LC11694">                                                  <span>void</span> **ppValue)</td>
      </tr>
      <tr>
        <td id="L11695" data-line-number="11695"></td>
        <td id="LC11695">{</td>
      </tr>
      <tr>
        <td id="L11696" data-line-number="11696"></td>
        <td id="LC11696">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11697" data-line-number="11697"></td>
        <td id="LC11697">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11698" data-line-number="11698"></td>
        <td id="LC11698">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11699" data-line-number="11699"></td>
        <td id="LC11699">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11700" data-line-number="11700"></td>
        <td id="LC11700">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11701" data-line-number="11701"></td>
        <td id="LC11701">
</td>
      </tr>
      <tr>
        <td id="L11702" data-line-number="11702"></td>
        <td id="LC11702">    InfoAccessType result = IAT_PVALUE;</td>
      </tr>
      <tr>
        <td id="L11703" data-line-number="11703"></td>
        <td id="LC11703">
</td>
      </tr>
      <tr>
        <td id="L11704" data-line-number="11704"></td>
        <td id="LC11704">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11705" data-line-number="11705"></td>
        <td id="LC11705">
</td>
      </tr>
      <tr>
        <td id="L11706" data-line-number="11706"></td>
        <td id="LC11706">    <span>_ASSERTE</span>(ppValue != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L11707" data-line-number="11707"></td>
        <td id="LC11707">
</td>
      </tr>
      <tr>
        <td id="L11708" data-line-number="11708"></td>
        <td id="LC11708">    <span>if</span> (<span>IsDynamicScope</span>(scopeHnd))</td>
      </tr>
      <tr>
        <td id="L11709" data-line-number="11709"></td>
        <td id="LC11709">    {</td>
      </tr>
      <tr>
        <td id="L11710" data-line-number="11710"></td>
        <td id="LC11710">        *ppValue = (LPVOID)<span>GetDynamicResolver</span>(scopeHnd)-&gt;<span>ConstructStringLiteral</span>(metaTok);</td>
      </tr>
      <tr>
        <td id="L11711" data-line-number="11711"></td>
        <td id="LC11711">    }</td>
      </tr>
      <tr>
        <td id="L11712" data-line-number="11712"></td>
        <td id="LC11712">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L11713" data-line-number="11713"></td>
        <td id="LC11713">    {</td>
      </tr>
      <tr>
        <td id="L11714" data-line-number="11714"></td>
        <td id="LC11714">        *ppValue = (LPVOID)<span>ConstructStringLiteral</span>(scopeHnd, metaTok); <span><span>//</span> throws</span></td>
      </tr>
      <tr>
        <td id="L11715" data-line-number="11715"></td>
        <td id="LC11715">    }</td>
      </tr>
      <tr>
        <td id="L11716" data-line-number="11716"></td>
        <td id="LC11716">
</td>
      </tr>
      <tr>
        <td id="L11717" data-line-number="11717"></td>
        <td id="LC11717">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11718" data-line-number="11718"></td>
        <td id="LC11718">
</td>
      </tr>
      <tr>
        <td id="L11719" data-line-number="11719"></td>
        <td id="LC11719">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L11720" data-line-number="11720"></td>
        <td id="LC11720">}</td>
      </tr>
      <tr>
        <td id="L11721" data-line-number="11721"></td>
        <td id="LC11721">
</td>
      </tr>
      <tr>
        <td id="L11722" data-line-number="11722"></td>
        <td id="LC11722"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11723" data-line-number="11723"></td>
        <td id="LC11723">InfoAccessType <span>CEEJitInfo::emptyStringLiteral</span>(<span>void</span> ** ppValue)</td>
      </tr>
      <tr>
        <td id="L11724" data-line-number="11724"></td>
        <td id="LC11724">{</td>
      </tr>
      <tr>
        <td id="L11725" data-line-number="11725"></td>
        <td id="LC11725">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11726" data-line-number="11726"></td>
        <td id="LC11726">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11727" data-line-number="11727"></td>
        <td id="LC11727">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11728" data-line-number="11728"></td>
        <td id="LC11728">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11729" data-line-number="11729"></td>
        <td id="LC11729">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11730" data-line-number="11730"></td>
        <td id="LC11730">
</td>
      </tr>
      <tr>
        <td id="L11731" data-line-number="11731"></td>
        <td id="LC11731">    InfoAccessType result = IAT_PVALUE;</td>
      </tr>
      <tr>
        <td id="L11732" data-line-number="11732"></td>
        <td id="LC11732">
</td>
      </tr>
      <tr>
        <td id="L11733" data-line-number="11733"></td>
        <td id="LC11733">    <span>if</span>(<span>NingenEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L11734" data-line-number="11734"></td>
        <td id="LC11734">    {</td>
      </tr>
      <tr>
        <td id="L11735" data-line-number="11735"></td>
        <td id="LC11735">        *ppValue = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11736" data-line-number="11736"></td>
        <td id="LC11736">        <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L11737" data-line-number="11737"></td>
        <td id="LC11737">    }</td>
      </tr>
      <tr>
        <td id="L11738" data-line-number="11738"></td>
        <td id="LC11738">
</td>
      </tr>
      <tr>
        <td id="L11739" data-line-number="11739"></td>
        <td id="LC11739">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11740" data-line-number="11740"></td>
        <td id="LC11740">    *ppValue = <span>StringObject::GetEmptyStringRefPtr</span>();</td>
      </tr>
      <tr>
        <td id="L11741" data-line-number="11741"></td>
        <td id="LC11741">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11742" data-line-number="11742"></td>
        <td id="LC11742">
</td>
      </tr>
      <tr>
        <td id="L11743" data-line-number="11743"></td>
        <td id="LC11743">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L11744" data-line-number="11744"></td>
        <td id="LC11744">}</td>
      </tr>
      <tr>
        <td id="L11745" data-line-number="11745"></td>
        <td id="LC11745">
</td>
      </tr>
      <tr>
        <td id="L11746" data-line-number="11746"></td>
        <td id="LC11746"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11747" data-line-number="11747"></td>
        <td id="LC11747"><span>void</span>* <span>CEEJitInfo::getFieldAddress</span>(CORINFO_FIELD_HANDLE fieldHnd,</td>
      </tr>
      <tr>
        <td id="L11748" data-line-number="11748"></td>
        <td id="LC11748">                                  <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L11749" data-line-number="11749"></td>
        <td id="LC11749">{</td>
      </tr>
      <tr>
        <td id="L11750" data-line-number="11750"></td>
        <td id="LC11750">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11751" data-line-number="11751"></td>
        <td id="LC11751">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11752" data-line-number="11752"></td>
        <td id="LC11752">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11753" data-line-number="11753"></td>
        <td id="LC11753">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11754" data-line-number="11754"></td>
        <td id="LC11754">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11755" data-line-number="11755"></td>
        <td id="LC11755">
</td>
      </tr>
      <tr>
        <td id="L11756" data-line-number="11756"></td>
        <td id="LC11756">    <span>void</span> *result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11757" data-line-number="11757"></td>
        <td id="LC11757">
</td>
      </tr>
      <tr>
        <td id="L11758" data-line-number="11758"></td>
        <td id="LC11758">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11759" data-line-number="11759"></td>
        <td id="LC11759">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11760" data-line-number="11760"></td>
        <td id="LC11760">
</td>
      </tr>
      <tr>
        <td id="L11761" data-line-number="11761"></td>
        <td id="LC11761">    <span><span>//</span> Do not bother with initialization if we are only verifying the method.</span></td>
      </tr>
      <tr>
        <td id="L11762" data-line-number="11762"></td>
        <td id="LC11762">    <span>if</span> (<span>isVerifyOnly</span>())</td>
      </tr>
      <tr>
        <td id="L11763" data-line-number="11763"></td>
        <td id="LC11763">    {</td>
      </tr>
      <tr>
        <td id="L11764" data-line-number="11764"></td>
        <td id="LC11764">        <span>return</span> (<span>void</span> *)<span>0x10</span>;</td>
      </tr>
      <tr>
        <td id="L11765" data-line-number="11765"></td>
        <td id="LC11765">    }</td>
      </tr>
      <tr>
        <td id="L11766" data-line-number="11766"></td>
        <td id="LC11766">
</td>
      </tr>
      <tr>
        <td id="L11767" data-line-number="11767"></td>
        <td id="LC11767">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11768" data-line-number="11768"></td>
        <td id="LC11768">
</td>
      </tr>
      <tr>
        <td id="L11769" data-line-number="11769"></td>
        <td id="LC11769">    FieldDesc* field = (FieldDesc*) fieldHnd;</td>
      </tr>
      <tr>
        <td id="L11770" data-line-number="11770"></td>
        <td id="LC11770">
</td>
      </tr>
      <tr>
        <td id="L11771" data-line-number="11771"></td>
        <td id="LC11771">    MethodTable* pMT = field-&gt;<span>GetEnclosingMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L11772" data-line-number="11772"></td>
        <td id="LC11772">
</td>
      </tr>
      <tr>
        <td id="L11773" data-line-number="11773"></td>
        <td id="LC11773">    <span>_ASSERTE</span>(!pMT-&gt;<span>ContainsGenericVariables</span>());</td>
      </tr>
      <tr>
        <td id="L11774" data-line-number="11774"></td>
        <td id="LC11774">
</td>
      </tr>
      <tr>
        <td id="L11775" data-line-number="11775"></td>
        <td id="LC11775">    <span>void</span> *base = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11776" data-line-number="11776"></td>
        <td id="LC11776">
</td>
      </tr>
      <tr>
        <td id="L11777" data-line-number="11777"></td>
        <td id="LC11777">    <span>if</span> (!field-&gt;<span>IsRVA</span>())</td>
      </tr>
      <tr>
        <td id="L11778" data-line-number="11778"></td>
        <td id="LC11778">    {</td>
      </tr>
      <tr>
        <td id="L11779" data-line-number="11779"></td>
        <td id="LC11779">        <span><span>//</span> &lt;REVISIT_TODO&gt;@todo: assert that the current method being compiled is unshared&lt;/REVISIT_TODO&gt;</span></td>
      </tr>
      <tr>
        <td id="L11780" data-line-number="11780"></td>
        <td id="LC11780">        <span><span>//</span> We must not call here for statics of collectible types.</span></td>
      </tr>
      <tr>
        <td id="L11781" data-line-number="11781"></td>
        <td id="LC11781">        <span>_ASSERTE</span>(!pMT-&gt;<span>Collectible</span>());</td>
      </tr>
      <tr>
        <td id="L11782" data-line-number="11782"></td>
        <td id="LC11782">
</td>
      </tr>
      <tr>
        <td id="L11783" data-line-number="11783"></td>
        <td id="LC11783">        <span><span>//</span> Allocate space for the local class if necessary, but don't trigger</span></td>
      </tr>
      <tr>
        <td id="L11784" data-line-number="11784"></td>
        <td id="LC11784">        <span><span>//</span> class construction.</span></td>
      </tr>
      <tr>
        <td id="L11785" data-line-number="11785"></td>
        <td id="LC11785">        DomainLocalModule *pLocalModule = pMT-&gt;<span>GetDomainLocalModule</span>();</td>
      </tr>
      <tr>
        <td id="L11786" data-line-number="11786"></td>
        <td id="LC11786">        pLocalModule-&gt;<span>PopulateClass</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L11787" data-line-number="11787"></td>
        <td id="LC11787">
</td>
      </tr>
      <tr>
        <td id="L11788" data-line-number="11788"></td>
        <td id="LC11788">        <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L11789" data-line-number="11789"></td>
        <td id="LC11789">
</td>
      </tr>
      <tr>
        <td id="L11790" data-line-number="11790"></td>
        <td id="LC11790">        base = (<span>void</span> *) field-&gt;<span>GetBase</span>();</td>
      </tr>
      <tr>
        <td id="L11791" data-line-number="11791"></td>
        <td id="LC11791">    }</td>
      </tr>
      <tr>
        <td id="L11792" data-line-number="11792"></td>
        <td id="LC11792">
</td>
      </tr>
      <tr>
        <td id="L11793" data-line-number="11793"></td>
        <td id="LC11793">    result = field-&gt;<span>GetStaticAddressHandle</span>(base);</td>
      </tr>
      <tr>
        <td id="L11794" data-line-number="11794"></td>
        <td id="LC11794">
</td>
      </tr>
      <tr>
        <td id="L11795" data-line-number="11795"></td>
        <td id="LC11795">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11796" data-line-number="11796"></td>
        <td id="LC11796">
</td>
      </tr>
      <tr>
        <td id="L11797" data-line-number="11797"></td>
        <td id="LC11797">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L11798" data-line-number="11798"></td>
        <td id="LC11798">}</td>
      </tr>
      <tr>
        <td id="L11799" data-line-number="11799"></td>
        <td id="LC11799">
</td>
      </tr>
      <tr>
        <td id="L11800" data-line-number="11800"></td>
        <td id="LC11800"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11801" data-line-number="11801"></td>
        <td id="LC11801">CORINFO_CLASS_HANDLE <span>CEEJitInfo::getStaticFieldCurrentClass</span>(CORINFO_FIELD_HANDLE fieldHnd,</td>
      </tr>
      <tr>
        <td id="L11802" data-line-number="11802"></td>
        <td id="LC11802">                                                            <span>bool</span>* pIsSpeculative)</td>
      </tr>
      <tr>
        <td id="L11803" data-line-number="11803"></td>
        <td id="LC11803">{</td>
      </tr>
      <tr>
        <td id="L11804" data-line-number="11804"></td>
        <td id="LC11804">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11805" data-line-number="11805"></td>
        <td id="LC11805">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11806" data-line-number="11806"></td>
        <td id="LC11806">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11807" data-line-number="11807"></td>
        <td id="LC11807">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11808" data-line-number="11808"></td>
        <td id="LC11808">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11809" data-line-number="11809"></td>
        <td id="LC11809">
</td>
      </tr>
      <tr>
        <td id="L11810" data-line-number="11810"></td>
        <td id="LC11810">    CORINFO_CLASS_HANDLE result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11811" data-line-number="11811"></td>
        <td id="LC11811">
</td>
      </tr>
      <tr>
        <td id="L11812" data-line-number="11812"></td>
        <td id="LC11812">    <span>if</span> (pIsSpeculative != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11813" data-line-number="11813"></td>
        <td id="LC11813">    {</td>
      </tr>
      <tr>
        <td id="L11814" data-line-number="11814"></td>
        <td id="LC11814">        *pIsSpeculative = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L11815" data-line-number="11815"></td>
        <td id="LC11815">    }</td>
      </tr>
      <tr>
        <td id="L11816" data-line-number="11816"></td>
        <td id="LC11816">
</td>
      </tr>
      <tr>
        <td id="L11817" data-line-number="11817"></td>
        <td id="LC11817">    <span><span>//</span> Only examine the field's value if we are producing jitted code.</span></td>
      </tr>
      <tr>
        <td id="L11818" data-line-number="11818"></td>
        <td id="LC11818">    <span>if</span> (<span>isVerifyOnly</span>() || <span>IsCompilingForNGen</span>() || <span>IsReadyToRunCompilation</span>())</td>
      </tr>
      <tr>
        <td id="L11819" data-line-number="11819"></td>
        <td id="LC11819">    {</td>
      </tr>
      <tr>
        <td id="L11820" data-line-number="11820"></td>
        <td id="LC11820">        <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L11821" data-line-number="11821"></td>
        <td id="LC11821">    }</td>
      </tr>
      <tr>
        <td id="L11822" data-line-number="11822"></td>
        <td id="LC11822">
</td>
      </tr>
      <tr>
        <td id="L11823" data-line-number="11823"></td>
        <td id="LC11823">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11824" data-line-number="11824"></td>
        <td id="LC11824">
</td>
      </tr>
      <tr>
        <td id="L11825" data-line-number="11825"></td>
        <td id="LC11825">    FieldDesc* field = (FieldDesc*) fieldHnd;</td>
      </tr>
      <tr>
        <td id="L11826" data-line-number="11826"></td>
        <td id="LC11826">    <span>bool</span> isClassInitialized = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L11827" data-line-number="11827"></td>
        <td id="LC11827">
</td>
      </tr>
      <tr>
        <td id="L11828" data-line-number="11828"></td>
        <td id="LC11828">    <span><span>//</span> We're only interested in ref class typed static fields</span></td>
      </tr>
      <tr>
        <td id="L11829" data-line-number="11829"></td>
        <td id="LC11829">    <span><span>//</span> where the field handle specifies a unique location.</span></td>
      </tr>
      <tr>
        <td id="L11830" data-line-number="11830"></td>
        <td id="LC11830">    <span>if</span> (field-&gt;<span>IsStatic</span>() &amp;&amp; field-&gt;<span>IsObjRef</span>() &amp;&amp; !field-&gt;<span>IsThreadStatic</span>())</td>
      </tr>
      <tr>
        <td id="L11831" data-line-number="11831"></td>
        <td id="LC11831">    {</td>
      </tr>
      <tr>
        <td id="L11832" data-line-number="11832"></td>
        <td id="LC11832">        MethodTable* pEnclosingMT = field-&gt;<span>GetEnclosingMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L11833" data-line-number="11833"></td>
        <td id="LC11833">
</td>
      </tr>
      <tr>
        <td id="L11834" data-line-number="11834"></td>
        <td id="LC11834">        <span>if</span> (!pEnclosingMT-&gt;<span>IsSharedByGenericInstantiations</span>())</td>
      </tr>
      <tr>
        <td id="L11835" data-line-number="11835"></td>
        <td id="LC11835">        {</td>
      </tr>
      <tr>
        <td id="L11836" data-line-number="11836"></td>
        <td id="LC11836">            <span><span>//</span> Allocate space for the local class if necessary, but don't trigger</span></td>
      </tr>
      <tr>
        <td id="L11837" data-line-number="11837"></td>
        <td id="LC11837">            <span><span>//</span> class construction.</span></td>
      </tr>
      <tr>
        <td id="L11838" data-line-number="11838"></td>
        <td id="LC11838">            DomainLocalModule *pLocalModule = pEnclosingMT-&gt;<span>GetDomainLocalModule</span>();</td>
      </tr>
      <tr>
        <td id="L11839" data-line-number="11839"></td>
        <td id="LC11839">            pLocalModule-&gt;<span>PopulateClass</span>(pEnclosingMT);</td>
      </tr>
      <tr>
        <td id="L11840" data-line-number="11840"></td>
        <td id="LC11840">
</td>
      </tr>
      <tr>
        <td id="L11841" data-line-number="11841"></td>
        <td id="LC11841">            <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L11842" data-line-number="11842"></td>
        <td id="LC11842">
</td>
      </tr>
      <tr>
        <td id="L11843" data-line-number="11843"></td>
        <td id="LC11843">            OBJECTREF fieldObj = field-&gt;<span>GetStaticOBJECTREF</span>();</td>
      </tr>
      <tr>
        <td id="L11844" data-line-number="11844"></td>
        <td id="LC11844">            <span>VALIDATEOBJECTREF</span>(fieldObj);</td>
      </tr>
      <tr>
        <td id="L11845" data-line-number="11845"></td>
        <td id="LC11845">
</td>
      </tr>
      <tr>
        <td id="L11846" data-line-number="11846"></td>
        <td id="LC11846">            <span><span>//</span> Check for initialization before looking at the value</span></td>
      </tr>
      <tr>
        <td id="L11847" data-line-number="11847"></td>
        <td id="LC11847">            isClassInitialized = !!pEnclosingMT-&gt;<span>IsClassInited</span>();</td>
      </tr>
      <tr>
        <td id="L11848" data-line-number="11848"></td>
        <td id="LC11848">
</td>
      </tr>
      <tr>
        <td id="L11849" data-line-number="11849"></td>
        <td id="LC11849">            <span>if</span> (fieldObj != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11850" data-line-number="11850"></td>
        <td id="LC11850">            {</td>
      </tr>
      <tr>
        <td id="L11851" data-line-number="11851"></td>
        <td id="LC11851">                MethodTable *pObjMT = fieldObj-&gt;<span>GetMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L11852" data-line-number="11852"></td>
        <td id="LC11852">
</td>
      </tr>
      <tr>
        <td id="L11853" data-line-number="11853"></td>
        <td id="LC11853">                <span><span>//</span> TODO: Check if the jit is allowed to embed this handle in jitted code.</span></td>
      </tr>
      <tr>
        <td id="L11854" data-line-number="11854"></td>
        <td id="LC11854">                <span><span>//</span> Note for the initonly cases it probably won't embed.</span></td>
      </tr>
      <tr>
        <td id="L11855" data-line-number="11855"></td>
        <td id="LC11855">                result = (CORINFO_CLASS_HANDLE) pObjMT;</td>
      </tr>
      <tr>
        <td id="L11856" data-line-number="11856"></td>
        <td id="LC11856">            }</td>
      </tr>
      <tr>
        <td id="L11857" data-line-number="11857"></td>
        <td id="LC11857">        }</td>
      </tr>
      <tr>
        <td id="L11858" data-line-number="11858"></td>
        <td id="LC11858">    }</td>
      </tr>
      <tr>
        <td id="L11859" data-line-number="11859"></td>
        <td id="LC11859">
</td>
      </tr>
      <tr>
        <td id="L11860" data-line-number="11860"></td>
        <td id="LC11860">    <span><span>//</span> Did we find a class?</span></td>
      </tr>
      <tr>
        <td id="L11861" data-line-number="11861"></td>
        <td id="LC11861">    <span>if</span> (result != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11862" data-line-number="11862"></td>
        <td id="LC11862">    {</td>
      </tr>
      <tr>
        <td id="L11863" data-line-number="11863"></td>
        <td id="LC11863">        <span><span>//</span> Figure out what to report back.</span></td>
      </tr>
      <tr>
        <td id="L11864" data-line-number="11864"></td>
        <td id="LC11864">        <span>bool</span> isResultImmutable = isClassInitialized &amp;&amp; <span>IsFdInitOnly</span>(field-&gt;<span>GetAttributes</span>());</td>
      </tr>
      <tr>
        <td id="L11865" data-line-number="11865"></td>
        <td id="LC11865">
</td>
      </tr>
      <tr>
        <td id="L11866" data-line-number="11866"></td>
        <td id="LC11866">        <span>if</span> (pIsSpeculative != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11867" data-line-number="11867"></td>
        <td id="LC11867">        {</td>
      </tr>
      <tr>
        <td id="L11868" data-line-number="11868"></td>
        <td id="LC11868">            <span><span>//</span> Caller is ok with potentially mutable results.</span></td>
      </tr>
      <tr>
        <td id="L11869" data-line-number="11869"></td>
        <td id="LC11869">            *pIsSpeculative = !isResultImmutable;</td>
      </tr>
      <tr>
        <td id="L11870" data-line-number="11870"></td>
        <td id="LC11870">        }</td>
      </tr>
      <tr>
        <td id="L11871" data-line-number="11871"></td>
        <td id="LC11871">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L11872" data-line-number="11872"></td>
        <td id="LC11872">        {</td>
      </tr>
      <tr>
        <td id="L11873" data-line-number="11873"></td>
        <td id="LC11873">            <span><span>//</span> Caller only wants to see immutable results.</span></td>
      </tr>
      <tr>
        <td id="L11874" data-line-number="11874"></td>
        <td id="LC11874">            <span>if</span> (!isResultImmutable)</td>
      </tr>
      <tr>
        <td id="L11875" data-line-number="11875"></td>
        <td id="LC11875">            {</td>
      </tr>
      <tr>
        <td id="L11876" data-line-number="11876"></td>
        <td id="LC11876">                result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11877" data-line-number="11877"></td>
        <td id="LC11877">            }</td>
      </tr>
      <tr>
        <td id="L11878" data-line-number="11878"></td>
        <td id="LC11878">        }</td>
      </tr>
      <tr>
        <td id="L11879" data-line-number="11879"></td>
        <td id="LC11879">    }</td>
      </tr>
      <tr>
        <td id="L11880" data-line-number="11880"></td>
        <td id="LC11880">
</td>
      </tr>
      <tr>
        <td id="L11881" data-line-number="11881"></td>
        <td id="LC11881">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11882" data-line-number="11882"></td>
        <td id="LC11882">
</td>
      </tr>
      <tr>
        <td id="L11883" data-line-number="11883"></td>
        <td id="LC11883">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L11884" data-line-number="11884"></td>
        <td id="LC11884">}</td>
      </tr>
      <tr>
        <td id="L11885" data-line-number="11885"></td>
        <td id="LC11885">
</td>
      </tr>
      <tr>
        <td id="L11886" data-line-number="11886"></td>
        <td id="LC11886"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11887" data-line-number="11887"></td>
        <td id="LC11887"><span>static</span> <span>void</span> *<span>GetClassSync</span>(MethodTable *pMT)</td>
      </tr>
      <tr>
        <td id="L11888" data-line-number="11888"></td>
        <td id="LC11888">{</td>
      </tr>
      <tr>
        <td id="L11889" data-line-number="11889"></td>
        <td id="LC11889">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L11890" data-line-number="11890"></td>
        <td id="LC11890">
</td>
      </tr>
      <tr>
        <td id="L11891" data-line-number="11891"></td>
        <td id="LC11891">    <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L11892" data-line-number="11892"></td>
        <td id="LC11892">
</td>
      </tr>
      <tr>
        <td id="L11893" data-line-number="11893"></td>
        <td id="LC11893">    OBJECTREF ref = pMT-&gt;<span>GetManagedClassObject</span>();</td>
      </tr>
      <tr>
        <td id="L11894" data-line-number="11894"></td>
        <td id="LC11894">    <span>return</span> (<span>void</span>*)ref-&gt;<span>GetSyncBlock</span>()-&gt;<span>GetMonitor</span>();</td>
      </tr>
      <tr>
        <td id="L11895" data-line-number="11895"></td>
        <td id="LC11895">}</td>
      </tr>
      <tr>
        <td id="L11896" data-line-number="11896"></td>
        <td id="LC11896">
</td>
      </tr>
      <tr>
        <td id="L11897" data-line-number="11897"></td>
        <td id="LC11897"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11898" data-line-number="11898"></td>
        <td id="LC11898"><span>void</span>* <span>CEEJitInfo::getMethodSync</span>(CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L11899" data-line-number="11899"></td>
        <td id="LC11899">                                <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L11900" data-line-number="11900"></td>
        <td id="LC11900">{</td>
      </tr>
      <tr>
        <td id="L11901" data-line-number="11901"></td>
        <td id="LC11901">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11902" data-line-number="11902"></td>
        <td id="LC11902">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11903" data-line-number="11903"></td>
        <td id="LC11903">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11904" data-line-number="11904"></td>
        <td id="LC11904">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11905" data-line-number="11905"></td>
        <td id="LC11905">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11906" data-line-number="11906"></td>
        <td id="LC11906">
</td>
      </tr>
      <tr>
        <td id="L11907" data-line-number="11907"></td>
        <td id="LC11907">    <span>void</span> * result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11908" data-line-number="11908"></td>
        <td id="LC11908">
</td>
      </tr>
      <tr>
        <td id="L11909" data-line-number="11909"></td>
        <td id="LC11909">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L11910" data-line-number="11910"></td>
        <td id="LC11910">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L11911" data-line-number="11911"></td>
        <td id="LC11911">
</td>
      </tr>
      <tr>
        <td id="L11912" data-line-number="11912"></td>
        <td id="LC11912">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11913" data-line-number="11913"></td>
        <td id="LC11913">
</td>
      </tr>
      <tr>
        <td id="L11914" data-line-number="11914"></td>
        <td id="LC11914">    result = <span>GetClassSync</span>((<span>GetMethod</span>(ftnHnd))-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L11915" data-line-number="11915"></td>
        <td id="LC11915">
</td>
      </tr>
      <tr>
        <td id="L11916" data-line-number="11916"></td>
        <td id="LC11916">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11917" data-line-number="11917"></td>
        <td id="LC11917">
</td>
      </tr>
      <tr>
        <td id="L11918" data-line-number="11918"></td>
        <td id="LC11918">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L11919" data-line-number="11919"></td>
        <td id="LC11919">}</td>
      </tr>
      <tr>
        <td id="L11920" data-line-number="11920"></td>
        <td id="LC11920">
</td>
      </tr>
      <tr>
        <td id="L11921" data-line-number="11921"></td>
        <td id="LC11921"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11922" data-line-number="11922"></td>
        <td id="LC11922">HRESULT <span>CEEJitInfo::allocMethodBlockCounts</span> (</td>
      </tr>
      <tr>
        <td id="L11923" data-line-number="11923"></td>
        <td id="LC11923">    UINT32                        count,           <span><span>//</span> count of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L11924" data-line-number="11924"></td>
        <td id="LC11924">    ICorJitInfo::BlockCounts **   pBlockCounts     <span><span>//</span> pointer to array of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L11925" data-line-number="11925"></td>
        <td id="LC11925">    )</td>
      </tr>
      <tr>
        <td id="L11926" data-line-number="11926"></td>
        <td id="LC11926">{</td>
      </tr>
      <tr>
        <td id="L11927" data-line-number="11927"></td>
        <td id="LC11927">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11928" data-line-number="11928"></td>
        <td id="LC11928">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11929" data-line-number="11929"></td>
        <td id="LC11929">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11930" data-line-number="11930"></td>
        <td id="LC11930">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11931" data-line-number="11931"></td>
        <td id="LC11931">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11932" data-line-number="11932"></td>
        <td id="LC11932">
</td>
      </tr>
      <tr>
        <td id="L11933" data-line-number="11933"></td>
        <td id="LC11933">    HRESULT hr = E_FAIL;</td>
      </tr>
      <tr>
        <td id="L11934" data-line-number="11934"></td>
        <td id="LC11934">
</td>
      </tr>
      <tr>
        <td id="L11935" data-line-number="11935"></td>
        <td id="LC11935">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11936" data-line-number="11936"></td>
        <td id="LC11936">
</td>
      </tr>
      <tr>
        <td id="L11937" data-line-number="11937"></td>
        <td id="LC11937">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L11938" data-line-number="11938"></td>
        <td id="LC11938">
</td>
      </tr>
      <tr>
        <td id="L11939" data-line-number="11939"></td>
        <td id="LC11939">    <span><span>//</span> We need to know the code size. Typically we can get the code size</span></td>
      </tr>
      <tr>
        <td id="L11940" data-line-number="11940"></td>
        <td id="LC11940">    <span><span>//</span> from m_ILHeader. For dynamic methods, m_ILHeader will be NULL, so</span></td>
      </tr>
      <tr>
        <td id="L11941" data-line-number="11941"></td>
        <td id="LC11941">    <span><span>//</span> for that case we need to use DynamicResolver to get the code size.</span></td>
      </tr>
      <tr>
        <td id="L11942" data-line-number="11942"></td>
        <td id="LC11942">
</td>
      </tr>
      <tr>
        <td id="L11943" data-line-number="11943"></td>
        <td id="LC11943">    <span>unsigned</span> codeSize = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L11944" data-line-number="11944"></td>
        <td id="LC11944">    <span>if</span> (m_pMethodBeingCompiled-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L11945" data-line-number="11945"></td>
        <td id="LC11945">    {</td>
      </tr>
      <tr>
        <td id="L11946" data-line-number="11946"></td>
        <td id="LC11946">        <span>unsigned</span> stackSize, ehSize;</td>
      </tr>
      <tr>
        <td id="L11947" data-line-number="11947"></td>
        <td id="LC11947">        CorInfoOptions options;</td>
      </tr>
      <tr>
        <td id="L11948" data-line-number="11948"></td>
        <td id="LC11948">        DynamicResolver * pResolver = m_pMethodBeingCompiled-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>();</td>
      </tr>
      <tr>
        <td id="L11949" data-line-number="11949"></td>
        <td id="LC11949">        pResolver-&gt;<span>GetCodeInfo</span>(&amp;codeSize, &amp;stackSize, &amp;options, &amp;ehSize);</td>
      </tr>
      <tr>
        <td id="L11950" data-line-number="11950"></td>
        <td id="LC11950">    }</td>
      </tr>
      <tr>
        <td id="L11951" data-line-number="11951"></td>
        <td id="LC11951">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L11952" data-line-number="11952"></td>
        <td id="LC11952">    {</td>
      </tr>
      <tr>
        <td id="L11953" data-line-number="11953"></td>
        <td id="LC11953">        codeSize = m_ILHeader-&gt;<span>GetCodeSize</span>();</td>
      </tr>
      <tr>
        <td id="L11954" data-line-number="11954"></td>
        <td id="LC11954">    }</td>
      </tr>
      <tr>
        <td id="L11955" data-line-number="11955"></td>
        <td id="LC11955">
</td>
      </tr>
      <tr>
        <td id="L11956" data-line-number="11956"></td>
        <td id="LC11956">    *pBlockCounts = m_pMethodBeingCompiled-&gt;<span>GetLoaderModule</span>()-&gt;<span>AllocateMethodBlockCounts</span>(m_pMethodBeingCompiled-&gt;<span>GetMemberDef</span>(), count, codeSize);</td>
      </tr>
      <tr>
        <td id="L11957" data-line-number="11957"></td>
        <td id="LC11957">    hr = (*pBlockCounts != <span>nullptr</span>) ? S_OK : E_OUTOFMEMORY;</td>
      </tr>
      <tr>
        <td id="L11958" data-line-number="11958"></td>
        <td id="LC11958">#<span>else</span> <span><span>//</span> FEATURE_PREJIT</span></td>
      </tr>
      <tr>
        <td id="L11959" data-line-number="11959"></td>
        <td id="LC11959">    <span>_ASSERTE</span>(!<span><span>"</span>allocMethodBlockCounts not implemented on CEEJitInfo!<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11960" data-line-number="11960"></td>
        <td id="LC11960">    hr = E_NOTIMPL;</td>
      </tr>
      <tr>
        <td id="L11961" data-line-number="11961"></td>
        <td id="LC11961">#<span>endif</span> <span><span>//</span> !FEATURE_PREJIT</span></td>
      </tr>
      <tr>
        <td id="L11962" data-line-number="11962"></td>
        <td id="LC11962">
</td>
      </tr>
      <tr>
        <td id="L11963" data-line-number="11963"></td>
        <td id="LC11963">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L11964" data-line-number="11964"></td>
        <td id="LC11964">
</td>
      </tr>
      <tr>
        <td id="L11965" data-line-number="11965"></td>
        <td id="LC11965">    <span>return</span> hr;</td>
      </tr>
      <tr>
        <td id="L11966" data-line-number="11966"></td>
        <td id="LC11966">}</td>
      </tr>
      <tr>
        <td id="L11967" data-line-number="11967"></td>
        <td id="LC11967">
</td>
      </tr>
      <tr>
        <td id="L11968" data-line-number="11968"></td>
        <td id="LC11968"><span><span>//</span> Consider implementing getBBProfileData on CEEJitInfo.  This will allow us</span></td>
      </tr>
      <tr>
        <td id="L11969" data-line-number="11969"></td>
        <td id="LC11969"><span><span>//</span> to use profile info in codegen for non zapped images.</span></td>
      </tr>
      <tr>
        <td id="L11970" data-line-number="11970"></td>
        <td id="LC11970">HRESULT <span>CEEJitInfo::getMethodBlockCounts</span> (</td>
      </tr>
      <tr>
        <td id="L11971" data-line-number="11971"></td>
        <td id="LC11971">    CORINFO_METHOD_HANDLE         ftnHnd,</td>
      </tr>
      <tr>
        <td id="L11972" data-line-number="11972"></td>
        <td id="LC11972">    UINT32 *                      pCount,          <span><span>//</span> pointer to the count of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L11973" data-line-number="11973"></td>
        <td id="LC11973">    ICorJitInfo::BlockCounts **   pBlockCounts,    <span><span>//</span> pointer to array of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L11974" data-line-number="11974"></td>
        <td id="LC11974">    UINT32 *                      pNumRuns</td>
      </tr>
      <tr>
        <td id="L11975" data-line-number="11975"></td>
        <td id="LC11975">    )</td>
      </tr>
      <tr>
        <td id="L11976" data-line-number="11976"></td>
        <td id="LC11976">{</td>
      </tr>
      <tr>
        <td id="L11977" data-line-number="11977"></td>
        <td id="LC11977">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L11978" data-line-number="11978"></td>
        <td id="LC11978">    <span>_ASSERTE</span>(!<span><span>"</span>getMethodBlockCounts not implemented on CEEJitInfo!<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L11979" data-line-number="11979"></td>
        <td id="LC11979">    <span>return</span> E_NOTIMPL;</td>
      </tr>
      <tr>
        <td id="L11980" data-line-number="11980"></td>
        <td id="LC11980">}</td>
      </tr>
      <tr>
        <td id="L11981" data-line-number="11981"></td>
        <td id="LC11981">
</td>
      </tr>
      <tr>
        <td id="L11982" data-line-number="11982"></td>
        <td id="LC11982"><span>void</span> <span>CEEJitInfo::allocMem</span> (</td>
      </tr>
      <tr>
        <td id="L11983" data-line-number="11983"></td>
        <td id="LC11983">    ULONG               hotCodeSize,    <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11984" data-line-number="11984"></td>
        <td id="LC11984">    ULONG               coldCodeSize,   <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11985" data-line-number="11985"></td>
        <td id="LC11985">    ULONG               roDataSize,     <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11986" data-line-number="11986"></td>
        <td id="LC11986">    ULONG               xcptnsCount,    <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11987" data-line-number="11987"></td>
        <td id="LC11987">    CorJitAllocMemFlag  flag,           <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11988" data-line-number="11988"></td>
        <td id="LC11988">    <span>void</span> **             hotCodeBlock,   <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11989" data-line-number="11989"></td>
        <td id="LC11989">    <span>void</span> **             coldCodeBlock,  <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11990" data-line-number="11990"></td>
        <td id="LC11990">    <span>void</span> **             roDataBlock     <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L11991" data-line-number="11991"></td>
        <td id="LC11991">            )</td>
      </tr>
      <tr>
        <td id="L11992" data-line-number="11992"></td>
        <td id="LC11992">{</td>
      </tr>
      <tr>
        <td id="L11993" data-line-number="11993"></td>
        <td id="LC11993">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L11994" data-line-number="11994"></td>
        <td id="LC11994">        THROWS;</td>
      </tr>
      <tr>
        <td id="L11995" data-line-number="11995"></td>
        <td id="LC11995">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L11996" data-line-number="11996"></td>
        <td id="LC11996">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L11997" data-line-number="11997"></td>
        <td id="LC11997">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L11998" data-line-number="11998"></td>
        <td id="LC11998">
</td>
      </tr>
      <tr>
        <td id="L11999" data-line-number="11999"></td>
        <td id="LC11999">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12000" data-line-number="12000"></td>
        <td id="LC12000">
</td>
      </tr>
      <tr>
        <td id="L12001" data-line-number="12001"></td>
        <td id="LC12001">    <span>_ASSERTE</span>(coldCodeSize == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12002" data-line-number="12002"></td>
        <td id="LC12002">    <span>if</span> (coldCodeBlock)</td>
      </tr>
      <tr>
        <td id="L12003" data-line-number="12003"></td>
        <td id="LC12003">    {</td>
      </tr>
      <tr>
        <td id="L12004" data-line-number="12004"></td>
        <td id="LC12004">        *coldCodeBlock = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L12005" data-line-number="12005"></td>
        <td id="LC12005">    }</td>
      </tr>
      <tr>
        <td id="L12006" data-line-number="12006"></td>
        <td id="LC12006">
</td>
      </tr>
      <tr>
        <td id="L12007" data-line-number="12007"></td>
        <td id="LC12007">    ULONG codeSize      = hotCodeSize;</td>
      </tr>
      <tr>
        <td id="L12008" data-line-number="12008"></td>
        <td id="LC12008">    <span>void</span> **codeBlock    = hotCodeBlock;</td>
      </tr>
      <tr>
        <td id="L12009" data-line-number="12009"></td>
        <td id="LC12009">
</td>
      </tr>
      <tr>
        <td id="L12010" data-line-number="12010"></td>
        <td id="LC12010">    S_SIZE_T totalSize = <span>S_SIZE_T</span>(codeSize);</td>
      </tr>
      <tr>
        <td id="L12011" data-line-number="12011"></td>
        <td id="LC12011">
</td>
      </tr>
      <tr>
        <td id="L12012" data-line-number="12012"></td>
        <td id="LC12012">    <span>size_t</span> roDataAlignment = <span>sizeof</span>(<span>void</span>*);</td>
      </tr>
      <tr>
        <td id="L12013" data-line-number="12013"></td>
        <td id="LC12013">    <span>if</span> ((flag &amp; CORJIT_ALLOCMEM_FLG_RODATA_16BYTE_ALIGN)!= <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L12014" data-line-number="12014"></td>
        <td id="LC12014">    {</td>
      </tr>
      <tr>
        <td id="L12015" data-line-number="12015"></td>
        <td id="LC12015">        roDataAlignment = <span>16</span>;</td>
      </tr>
      <tr>
        <td id="L12016" data-line-number="12016"></td>
        <td id="LC12016">    }</td>
      </tr>
      <tr>
        <td id="L12017" data-line-number="12017"></td>
        <td id="LC12017">    <span>else</span> <span>if</span> (roDataSize &gt;= <span>8</span>)</td>
      </tr>
      <tr>
        <td id="L12018" data-line-number="12018"></td>
        <td id="LC12018">    {</td>
      </tr>
      <tr>
        <td id="L12019" data-line-number="12019"></td>
        <td id="LC12019">        roDataAlignment = <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L12020" data-line-number="12020"></td>
        <td id="LC12020">    }</td>
      </tr>
      <tr>
        <td id="L12021" data-line-number="12021"></td>
        <td id="LC12021">    <span>if</span> (roDataSize &gt; <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L12022" data-line-number="12022"></td>
        <td id="LC12022">    {</td>
      </tr>
      <tr>
        <td id="L12023" data-line-number="12023"></td>
        <td id="LC12023">        <span>size_t</span> codeAlignment = ((flag &amp; CORJIT_ALLOCMEM_FLG_16BYTE_ALIGN)!= <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L12024" data-line-number="12024"></td>
        <td id="LC12024">                               ? <span>16</span> : <span>sizeof</span>(<span>void</span>*);</td>
      </tr>
      <tr>
        <td id="L12025" data-line-number="12025"></td>
        <td id="LC12025">        totalSize.<span>AlignUp</span>(codeAlignment);</td>
      </tr>
      <tr>
        <td id="L12026" data-line-number="12026"></td>
        <td id="LC12026">        <span>if</span> (roDataAlignment &gt; codeAlignment) {</td>
      </tr>
      <tr>
        <td id="L12027" data-line-number="12027"></td>
        <td id="LC12027">            <span><span>//</span> Add padding to align read-only data.</span></td>
      </tr>
      <tr>
        <td id="L12028" data-line-number="12028"></td>
        <td id="LC12028">            totalSize += (roDataAlignment - codeAlignment);</td>
      </tr>
      <tr>
        <td id="L12029" data-line-number="12029"></td>
        <td id="LC12029">        }</td>
      </tr>
      <tr>
        <td id="L12030" data-line-number="12030"></td>
        <td id="LC12030">        totalSize += roDataSize;</td>
      </tr>
      <tr>
        <td id="L12031" data-line-number="12031"></td>
        <td id="LC12031">    }</td>
      </tr>
      <tr>
        <td id="L12032" data-line-number="12032"></td>
        <td id="LC12032">
</td>
      </tr>
      <tr>
        <td id="L12033" data-line-number="12033"></td>
        <td id="LC12033">#<span>ifdef</span> FEATURE_EH_FUNCLETS</td>
      </tr>
      <tr>
        <td id="L12034" data-line-number="12034"></td>
        <td id="LC12034">    totalSize.<span>AlignUp</span>(<span>sizeof</span>(DWORD));</td>
      </tr>
      <tr>
        <td id="L12035" data-line-number="12035"></td>
        <td id="LC12035">    totalSize += m_totalUnwindSize;</td>
      </tr>
      <tr>
        <td id="L12036" data-line-number="12036"></td>
        <td id="LC12036">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12037" data-line-number="12037"></td>
        <td id="LC12037">
</td>
      </tr>
      <tr>
        <td id="L12038" data-line-number="12038"></td>
        <td id="LC12038">    <span>_ASSERTE</span>(m_CodeHeader == <span>0</span> &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12039" data-line-number="12039"></td>
        <td id="LC12039">            <span><span>//</span> The jit-compiler sometimes tries to compile a method a second time</span></td>
      </tr>
      <tr>
        <td id="L12040" data-line-number="12040"></td>
        <td id="LC12040">            <span><span>//</span> if it failed the first time. In such a situation, m_CodeHeader may</span></td>
      </tr>
      <tr>
        <td id="L12041" data-line-number="12041"></td>
        <td id="LC12041">            <span><span>//</span> have already been assigned. Its OK to ignore this assert in such a</span></td>
      </tr>
      <tr>
        <td id="L12042" data-line-number="12042"></td>
        <td id="LC12042">            <span><span>//</span> situation - we will leak some memory, but that is acceptable</span></td>
      </tr>
      <tr>
        <td id="L12043" data-line-number="12043"></td>
        <td id="LC12043">            <span><span>//</span> since this should happen very rarely.</span></td>
      </tr>
      <tr>
        <td id="L12044" data-line-number="12044"></td>
        <td id="LC12044">            <span><span>"</span>Note that this may fire if the JITCompiler tries to recompile a method<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L12045" data-line-number="12045"></td>
        <td id="LC12045">
</td>
      </tr>
      <tr>
        <td id="L12046" data-line-number="12046"></td>
        <td id="LC12046">    <span>if</span>( totalSize.<span>IsOverflow</span>() )</td>
      </tr>
      <tr>
        <td id="L12047" data-line-number="12047"></td>
        <td id="LC12047">    {</td>
      </tr>
      <tr>
        <td id="L12048" data-line-number="12048"></td>
        <td id="LC12048">        <span>COMPlusThrowHR</span>(CORJIT_OUTOFMEM);</td>
      </tr>
      <tr>
        <td id="L12049" data-line-number="12049"></td>
        <td id="LC12049">    }</td>
      </tr>
      <tr>
        <td id="L12050" data-line-number="12050"></td>
        <td id="LC12050">
</td>
      </tr>
      <tr>
        <td id="L12051" data-line-number="12051"></td>
        <td id="LC12051">    m_CodeHeader = m_jitManager-&gt;<span>allocCode</span>(m_pMethodBeingCompiled, totalSize.<span>Value</span>(), <span>GetReserveForJumpStubs</span>(), flag</td>
      </tr>
      <tr>
        <td id="L12052" data-line-number="12052"></td>
        <td id="LC12052">#<span>ifdef</span> FEATURE_EH_FUNCLETS</td>
      </tr>
      <tr>
        <td id="L12053" data-line-number="12053"></td>
        <td id="LC12053">                                           , m_totalUnwindInfos</td>
      </tr>
      <tr>
        <td id="L12054" data-line-number="12054"></td>
        <td id="LC12054">                                           , &amp;m_moduleBase</td>
      </tr>
      <tr>
        <td id="L12055" data-line-number="12055"></td>
        <td id="LC12055">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12056" data-line-number="12056"></td>
        <td id="LC12056">                                           );</td>
      </tr>
      <tr>
        <td id="L12057" data-line-number="12057"></td>
        <td id="LC12057">
</td>
      </tr>
      <tr>
        <td id="L12058" data-line-number="12058"></td>
        <td id="LC12058">    BYTE* current = (BYTE *)m_CodeHeader-&gt;<span>GetCodeStartAddress</span>();</td>
      </tr>
      <tr>
        <td id="L12059" data-line-number="12059"></td>
        <td id="LC12059">
</td>
      </tr>
      <tr>
        <td id="L12060" data-line-number="12060"></td>
        <td id="LC12060">    *codeBlock = current;</td>
      </tr>
      <tr>
        <td id="L12061" data-line-number="12061"></td>
        <td id="LC12061">    current += codeSize;</td>
      </tr>
      <tr>
        <td id="L12062" data-line-number="12062"></td>
        <td id="LC12062">
</td>
      </tr>
      <tr>
        <td id="L12063" data-line-number="12063"></td>
        <td id="LC12063">    <span>if</span> (roDataSize &gt; <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L12064" data-line-number="12064"></td>
        <td id="LC12064">    {</td>
      </tr>
      <tr>
        <td id="L12065" data-line-number="12065"></td>
        <td id="LC12065">        current = (BYTE *)<span>ALIGN_UP</span>(current, roDataAlignment);</td>
      </tr>
      <tr>
        <td id="L12066" data-line-number="12066"></td>
        <td id="LC12066">        *roDataBlock = current;</td>
      </tr>
      <tr>
        <td id="L12067" data-line-number="12067"></td>
        <td id="LC12067">        current += roDataSize;</td>
      </tr>
      <tr>
        <td id="L12068" data-line-number="12068"></td>
        <td id="LC12068">    }</td>
      </tr>
      <tr>
        <td id="L12069" data-line-number="12069"></td>
        <td id="LC12069">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L12070" data-line-number="12070"></td>
        <td id="LC12070">    {</td>
      </tr>
      <tr>
        <td id="L12071" data-line-number="12071"></td>
        <td id="LC12071">        *roDataBlock = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L12072" data-line-number="12072"></td>
        <td id="LC12072">    }</td>
      </tr>
      <tr>
        <td id="L12073" data-line-number="12073"></td>
        <td id="LC12073">
</td>
      </tr>
      <tr>
        <td id="L12074" data-line-number="12074"></td>
        <td id="LC12074">#<span>ifdef</span> FEATURE_EH_FUNCLETS</td>
      </tr>
      <tr>
        <td id="L12075" data-line-number="12075"></td>
        <td id="LC12075">    current = (BYTE *)<span>ALIGN_UP</span>(current, <span>sizeof</span>(DWORD));</td>
      </tr>
      <tr>
        <td id="L12076" data-line-number="12076"></td>
        <td id="LC12076">
</td>
      </tr>
      <tr>
        <td id="L12077" data-line-number="12077"></td>
        <td id="LC12077">    m_theUnwindBlock = current;</td>
      </tr>
      <tr>
        <td id="L12078" data-line-number="12078"></td>
        <td id="LC12078">    current += m_totalUnwindSize;</td>
      </tr>
      <tr>
        <td id="L12079" data-line-number="12079"></td>
        <td id="LC12079">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12080" data-line-number="12080"></td>
        <td id="LC12080">
</td>
      </tr>
      <tr>
        <td id="L12081" data-line-number="12081"></td>
        <td id="LC12081">    <span>_ASSERTE</span>((SIZE_T)(current - (BYTE *)m_CodeHeader-&gt;<span>GetCodeStartAddress</span>()) &lt;= totalSize.<span>Value</span>());</td>
      </tr>
      <tr>
        <td id="L12082" data-line-number="12082"></td>
        <td id="LC12082">
</td>
      </tr>
      <tr>
        <td id="L12083" data-line-number="12083"></td>
        <td id="LC12083">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L12084" data-line-number="12084"></td>
        <td id="LC12084">    m_codeSize = codeSize;</td>
      </tr>
      <tr>
        <td id="L12085" data-line-number="12085"></td>
        <td id="LC12085">#<span>endif</span>  <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L12086" data-line-number="12086"></td>
        <td id="LC12086">
</td>
      </tr>
      <tr>
        <td id="L12087" data-line-number="12087"></td>
        <td id="LC12087">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12088" data-line-number="12088"></td>
        <td id="LC12088">}</td>
      </tr>
      <tr>
        <td id="L12089" data-line-number="12089"></td>
        <td id="LC12089">
</td>
      </tr>
      <tr>
        <td id="L12090" data-line-number="12090"></td>
        <td id="LC12090"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12091" data-line-number="12091"></td>
        <td id="LC12091"><span>void</span> * <span>CEEJitInfo::allocGCInfo</span> (<span>size_t</span> size)</td>
      </tr>
      <tr>
        <td id="L12092" data-line-number="12092"></td>
        <td id="LC12092">{</td>
      </tr>
      <tr>
        <td id="L12093" data-line-number="12093"></td>
        <td id="LC12093">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L12094" data-line-number="12094"></td>
        <td id="LC12094">        THROWS;</td>
      </tr>
      <tr>
        <td id="L12095" data-line-number="12095"></td>
        <td id="LC12095">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12096" data-line-number="12096"></td>
        <td id="LC12096">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L12097" data-line-number="12097"></td>
        <td id="LC12097">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L12098" data-line-number="12098"></td>
        <td id="LC12098">
</td>
      </tr>
      <tr>
        <td id="L12099" data-line-number="12099"></td>
        <td id="LC12099">    <span>void</span> * block = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L12100" data-line-number="12100"></td>
        <td id="LC12100">
</td>
      </tr>
      <tr>
        <td id="L12101" data-line-number="12101"></td>
        <td id="LC12101">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12102" data-line-number="12102"></td>
        <td id="LC12102">
</td>
      </tr>
      <tr>
        <td id="L12103" data-line-number="12103"></td>
        <td id="LC12103">    <span>_ASSERTE</span>(m_CodeHeader != <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12104" data-line-number="12104"></td>
        <td id="LC12104">    <span>_ASSERTE</span>(m_CodeHeader-&gt;<span>GetGCInfo</span>() == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12105" data-line-number="12105"></td>
        <td id="LC12105">
</td>
      </tr>
      <tr>
        <td id="L12106" data-line-number="12106"></td>
        <td id="LC12106">#<span>ifdef</span> HOST_64BIT</td>
      </tr>
      <tr>
        <td id="L12107" data-line-number="12107"></td>
        <td id="LC12107">    <span>if</span> (size &amp; <span>0xFFFFFFFF80000000LL</span>)</td>
      </tr>
      <tr>
        <td id="L12108" data-line-number="12108"></td>
        <td id="LC12108">    {</td>
      </tr>
      <tr>
        <td id="L12109" data-line-number="12109"></td>
        <td id="LC12109">        <span>COMPlusThrowHR</span>(CORJIT_OUTOFMEM);</td>
      </tr>
      <tr>
        <td id="L12110" data-line-number="12110"></td>
        <td id="LC12110">    }</td>
      </tr>
      <tr>
        <td id="L12111" data-line-number="12111"></td>
        <td id="LC12111">#<span>endif</span> <span><span>//</span> HOST_64BIT</span></td>
      </tr>
      <tr>
        <td id="L12112" data-line-number="12112"></td>
        <td id="LC12112">
</td>
      </tr>
      <tr>
        <td id="L12113" data-line-number="12113"></td>
        <td id="LC12113">    block = m_jitManager-&gt;<span>allocGCInfo</span>(m_CodeHeader,(DWORD)size, &amp;m_GCinfo_len);</td>
      </tr>
      <tr>
        <td id="L12114" data-line-number="12114"></td>
        <td id="LC12114">    <span>if</span> (!block)</td>
      </tr>
      <tr>
        <td id="L12115" data-line-number="12115"></td>
        <td id="LC12115">    {</td>
      </tr>
      <tr>
        <td id="L12116" data-line-number="12116"></td>
        <td id="LC12116">        <span>COMPlusThrowHR</span>(CORJIT_OUTOFMEM);</td>
      </tr>
      <tr>
        <td id="L12117" data-line-number="12117"></td>
        <td id="LC12117">    }</td>
      </tr>
      <tr>
        <td id="L12118" data-line-number="12118"></td>
        <td id="LC12118">
</td>
      </tr>
      <tr>
        <td id="L12119" data-line-number="12119"></td>
        <td id="LC12119">    <span>_ASSERTE</span>(m_CodeHeader-&gt;<span>GetGCInfo</span>() != <span>0</span> &amp;&amp; block == m_CodeHeader-&gt;<span>GetGCInfo</span>());</td>
      </tr>
      <tr>
        <td id="L12120" data-line-number="12120"></td>
        <td id="LC12120">
</td>
      </tr>
      <tr>
        <td id="L12121" data-line-number="12121"></td>
        <td id="LC12121">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12122" data-line-number="12122"></td>
        <td id="LC12122">
</td>
      </tr>
      <tr>
        <td id="L12123" data-line-number="12123"></td>
        <td id="LC12123">    <span>return</span> block;</td>
      </tr>
      <tr>
        <td id="L12124" data-line-number="12124"></td>
        <td id="LC12124">}</td>
      </tr>
      <tr>
        <td id="L12125" data-line-number="12125"></td>
        <td id="LC12125">
</td>
      </tr>
      <tr>
        <td id="L12126" data-line-number="12126"></td>
        <td id="LC12126"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12127" data-line-number="12127"></td>
        <td id="LC12127"><span>void</span> <span>CEEJitInfo::setEHcount</span> (</td>
      </tr>
      <tr>
        <td id="L12128" data-line-number="12128"></td>
        <td id="LC12128">        <span>unsigned</span>      cEH)</td>
      </tr>
      <tr>
        <td id="L12129" data-line-number="12129"></td>
        <td id="LC12129">{</td>
      </tr>
      <tr>
        <td id="L12130" data-line-number="12130"></td>
        <td id="LC12130">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L12131" data-line-number="12131"></td>
        <td id="LC12131">        THROWS;</td>
      </tr>
      <tr>
        <td id="L12132" data-line-number="12132"></td>
        <td id="LC12132">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12133" data-line-number="12133"></td>
        <td id="LC12133">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L12134" data-line-number="12134"></td>
        <td id="LC12134">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L12135" data-line-number="12135"></td>
        <td id="LC12135">
</td>
      </tr>
      <tr>
        <td id="L12136" data-line-number="12136"></td>
        <td id="LC12136">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12137" data-line-number="12137"></td>
        <td id="LC12137">
</td>
      </tr>
      <tr>
        <td id="L12138" data-line-number="12138"></td>
        <td id="LC12138">    <span>_ASSERTE</span>(cEH != <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12139" data-line-number="12139"></td>
        <td id="LC12139">    <span>_ASSERTE</span>(m_CodeHeader != <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12140" data-line-number="12140"></td>
        <td id="LC12140">    <span>_ASSERTE</span>(m_CodeHeader-&gt;<span>GetEHInfo</span>() == <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12141" data-line-number="12141"></td>
        <td id="LC12141">
</td>
      </tr>
      <tr>
        <td id="L12142" data-line-number="12142"></td>
        <td id="LC12142">    EE_ILEXCEPTION* ret;</td>
      </tr>
      <tr>
        <td id="L12143" data-line-number="12143"></td>
        <td id="LC12143">    ret = m_jitManager-&gt;<span>allocEHInfo</span>(m_CodeHeader,cEH, &amp;m_EHinfo_len);</td>
      </tr>
      <tr>
        <td id="L12144" data-line-number="12144"></td>
        <td id="LC12144">    <span>_ASSERTE</span>(ret);      <span><span>//</span> allocEHInfo throws if there's not enough memory</span></td>
      </tr>
      <tr>
        <td id="L12145" data-line-number="12145"></td>
        <td id="LC12145">
</td>
      </tr>
      <tr>
        <td id="L12146" data-line-number="12146"></td>
        <td id="LC12146">    <span>_ASSERTE</span>(m_CodeHeader-&gt;<span>GetEHInfo</span>() != <span>0</span> &amp;&amp; m_CodeHeader-&gt;<span>GetEHInfo</span>()-&gt;<span>EHCount</span>() == cEH);</td>
      </tr>
      <tr>
        <td id="L12147" data-line-number="12147"></td>
        <td id="LC12147">
</td>
      </tr>
      <tr>
        <td id="L12148" data-line-number="12148"></td>
        <td id="LC12148">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12149" data-line-number="12149"></td>
        <td id="LC12149">}</td>
      </tr>
      <tr>
        <td id="L12150" data-line-number="12150"></td>
        <td id="LC12150">
</td>
      </tr>
      <tr>
        <td id="L12151" data-line-number="12151"></td>
        <td id="LC12151"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12152" data-line-number="12152"></td>
        <td id="LC12152"><span>void</span> <span>CEEJitInfo::setEHinfo</span> (</td>
      </tr>
      <tr>
        <td id="L12153" data-line-number="12153"></td>
        <td id="LC12153">        <span>unsigned</span>      EHnumber,</td>
      </tr>
      <tr>
        <td id="L12154" data-line-number="12154"></td>
        <td id="LC12154">        <span>const</span> CORINFO_EH_CLAUSE* clause)</td>
      </tr>
      <tr>
        <td id="L12155" data-line-number="12155"></td>
        <td id="LC12155">{</td>
      </tr>
      <tr>
        <td id="L12156" data-line-number="12156"></td>
        <td id="LC12156">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L12157" data-line-number="12157"></td>
        <td id="LC12157">        THROWS;</td>
      </tr>
      <tr>
        <td id="L12158" data-line-number="12158"></td>
        <td id="LC12158">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12159" data-line-number="12159"></td>
        <td id="LC12159">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L12160" data-line-number="12160"></td>
        <td id="LC12160">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L12161" data-line-number="12161"></td>
        <td id="LC12161">
</td>
      </tr>
      <tr>
        <td id="L12162" data-line-number="12162"></td>
        <td id="LC12162">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12163" data-line-number="12163"></td>
        <td id="LC12163">
</td>
      </tr>
      <tr>
        <td id="L12164" data-line-number="12164"></td>
        <td id="LC12164">    <span><span>//</span> &lt;REVISIT_TODO&gt; Fix make the Code Manager EH clauses EH_INFO+&lt;/REVISIT_TODO&gt;</span></td>
      </tr>
      <tr>
        <td id="L12165" data-line-number="12165"></td>
        <td id="LC12165">    <span>_ASSERTE</span>(m_CodeHeader-&gt;<span>GetEHInfo</span>() != <span>0</span> &amp;&amp; EHnumber &lt; m_CodeHeader-&gt;<span>GetEHInfo</span>()-&gt;<span>EHCount</span>());</td>
      </tr>
      <tr>
        <td id="L12166" data-line-number="12166"></td>
        <td id="LC12166">
</td>
      </tr>
      <tr>
        <td id="L12167" data-line-number="12167"></td>
        <td id="LC12167">    EE_ILEXCEPTION_CLAUSE* pEHClause = m_CodeHeader-&gt;<span>GetEHInfo</span>()-&gt;<span>EHClause</span>(EHnumber);</td>
      </tr>
      <tr>
        <td id="L12168" data-line-number="12168"></td>
        <td id="LC12168">
</td>
      </tr>
      <tr>
        <td id="L12169" data-line-number="12169"></td>
        <td id="LC12169">    pEHClause-&gt;<span>TryStartPC</span>     = clause-&gt;<span>TryOffset</span>;</td>
      </tr>
      <tr>
        <td id="L12170" data-line-number="12170"></td>
        <td id="LC12170">    pEHClause-&gt;<span>TryEndPC</span>       = clause-&gt;<span>TryLength</span>;</td>
      </tr>
      <tr>
        <td id="L12171" data-line-number="12171"></td>
        <td id="LC12171">    pEHClause-&gt;<span>HandlerStartPC</span> = clause-&gt;<span>HandlerOffset</span>;</td>
      </tr>
      <tr>
        <td id="L12172" data-line-number="12172"></td>
        <td id="LC12172">    pEHClause-&gt;<span>HandlerEndPC</span>   = clause-&gt;<span>HandlerLength</span>;</td>
      </tr>
      <tr>
        <td id="L12173" data-line-number="12173"></td>
        <td id="LC12173">    pEHClause-&gt;<span>ClassToken</span>     = clause-&gt;<span>ClassToken</span>;</td>
      </tr>
      <tr>
        <td id="L12174" data-line-number="12174"></td>
        <td id="LC12174">    pEHClause-&gt;<span>Flags</span>          = (CorExceptionFlag)clause-&gt;<span>Flags</span>;</td>
      </tr>
      <tr>
        <td id="L12175" data-line-number="12175"></td>
        <td id="LC12175">
</td>
      </tr>
      <tr>
        <td id="L12176" data-line-number="12176"></td>
        <td id="LC12176">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>Setting EH clause #%d for %s::%s<span>\n</span><span>"</span></span>, EHnumber, m_pMethodBeingCompiled-&gt;<span>m_pszDebugClassName</span>, m_pMethodBeingCompiled-&gt;<span>m_pszDebugMethodName</span>));</td>
      </tr>
      <tr>
        <td id="L12177" data-line-number="12177"></td>
        <td id="LC12177">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>    Flags         : 0x%08lx  -&gt;  0x%08lx<span>\n</span><span>"</span></span>,            clause-&gt;<span>Flags</span>,         pEHClause-&gt;<span>Flags</span>));</td>
      </tr>
      <tr>
        <td id="L12178" data-line-number="12178"></td>
        <td id="LC12178">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>    TryOffset     : 0x%08lx  -&gt;  0x%08lx (startpc)<span>\n</span><span>"</span></span>,  clause-&gt;<span>TryOffset</span>,     pEHClause-&gt;<span>TryStartPC</span>));</td>
      </tr>
      <tr>
        <td id="L12179" data-line-number="12179"></td>
        <td id="LC12179">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>    TryLength     : 0x%08lx  -&gt;  0x%08lx (endpc)<span>\n</span><span>"</span></span>,    clause-&gt;<span>TryLength</span>,     pEHClause-&gt;<span>TryEndPC</span>));</td>
      </tr>
      <tr>
        <td id="L12180" data-line-number="12180"></td>
        <td id="LC12180">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>    HandlerOffset : 0x%08lx  -&gt;  0x%08lx<span>\n</span><span>"</span></span>,            clause-&gt;<span>HandlerOffset</span>, pEHClause-&gt;<span>HandlerStartPC</span>));</td>
      </tr>
      <tr>
        <td id="L12181" data-line-number="12181"></td>
        <td id="LC12181">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>    HandlerLength : 0x%08lx  -&gt;  0x%08lx<span>\n</span><span>"</span></span>,            clause-&gt;<span>HandlerLength</span>, pEHClause-&gt;<span>HandlerEndPC</span>));</td>
      </tr>
      <tr>
        <td id="L12182" data-line-number="12182"></td>
        <td id="LC12182">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>    ClassToken    : 0x%08lx  -&gt;  0x%08lx<span>\n</span><span>"</span></span>,            clause-&gt;<span>ClassToken</span>,    pEHClause-&gt;<span>ClassToken</span>));</td>
      </tr>
      <tr>
        <td id="L12183" data-line-number="12183"></td>
        <td id="LC12183">    <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>    FilterOffset  : 0x%08lx  -&gt;  0x%08lx<span>\n</span><span>"</span></span>,            clause-&gt;<span>FilterOffset</span>,  pEHClause-&gt;<span>FilterOffset</span>));</td>
      </tr>
      <tr>
        <td id="L12184" data-line-number="12184"></td>
        <td id="LC12184">
</td>
      </tr>
      <tr>
        <td id="L12185" data-line-number="12185"></td>
        <td id="LC12185">    <span>if</span> (m_pMethodBeingCompiled-&gt;<span>IsDynamicMethod</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12186" data-line-number="12186"></td>
        <td id="LC12186">        ((pEHClause-&gt;<span>Flags</span> &amp; COR_ILEXCEPTION_CLAUSE_FILTER) == <span>0</span>) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12187" data-line-number="12187"></td>
        <td id="LC12187">        (clause-&gt;<span>ClassToken</span> != <span>NULL</span>))</td>
      </tr>
      <tr>
        <td id="L12188" data-line-number="12188"></td>
        <td id="LC12188">    {</td>
      </tr>
      <tr>
        <td id="L12189" data-line-number="12189"></td>
        <td id="LC12189">        MethodDesc * pMD; FieldDesc * pFD;</td>
      </tr>
      <tr>
        <td id="L12190" data-line-number="12190"></td>
        <td id="LC12190">        m_pMethodBeingCompiled-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>()-&gt;<span>ResolveToken</span>(clause-&gt;<span>ClassToken</span>, (TypeHandle *)&amp;pEHClause-&gt;<span>TypeHandle</span>, &amp;pMD, &amp;pFD);</td>
      </tr>
      <tr>
        <td id="L12191" data-line-number="12191"></td>
        <td id="LC12191">        <span>SetHasCachedTypeHandle</span>(pEHClause);</td>
      </tr>
      <tr>
        <td id="L12192" data-line-number="12192"></td>
        <td id="LC12192">        <span>LOG</span>((LF_EH, LL_INFO1000000, <span><span>"</span>  CachedTypeHandle: 0x%08lx  -&gt;  0x%08lx<span>\n</span><span>"</span></span>,        clause-&gt;<span>ClassToken</span>,    pEHClause-&gt;<span>TypeHandle</span>));</td>
      </tr>
      <tr>
        <td id="L12193" data-line-number="12193"></td>
        <td id="LC12193">    }</td>
      </tr>
      <tr>
        <td id="L12194" data-line-number="12194"></td>
        <td id="LC12194">
</td>
      </tr>
      <tr>
        <td id="L12195" data-line-number="12195"></td>
        <td id="LC12195">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12196" data-line-number="12196"></td>
        <td id="LC12196">}</td>
      </tr>
      <tr>
        <td id="L12197" data-line-number="12197"></td>
        <td id="LC12197">
</td>
      </tr>
      <tr>
        <td id="L12198" data-line-number="12198"></td>
        <td id="LC12198"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12199" data-line-number="12199"></td>
        <td id="LC12199"><span><span>//</span> get individual exception handler</span></td>
      </tr>
      <tr>
        <td id="L12200" data-line-number="12200"></td>
        <td id="LC12200"><span>void</span> <span>CEEJitInfo::getEHinfo</span>(</td>
      </tr>
      <tr>
        <td id="L12201" data-line-number="12201"></td>
        <td id="LC12201">                              CORINFO_METHOD_HANDLE  ftn,      <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12202" data-line-number="12202"></td>
        <td id="LC12202">                              <span>unsigned</span>               EHnumber, <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12203" data-line-number="12203"></td>
        <td id="LC12203">                              CORINFO_EH_CLAUSE*     clause)   <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12204" data-line-number="12204"></td>
        <td id="LC12204">{</td>
      </tr>
      <tr>
        <td id="L12205" data-line-number="12205"></td>
        <td id="LC12205">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L12206" data-line-number="12206"></td>
        <td id="LC12206">        THROWS;</td>
      </tr>
      <tr>
        <td id="L12207" data-line-number="12207"></td>
        <td id="LC12207">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12208" data-line-number="12208"></td>
        <td id="LC12208">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L12209" data-line-number="12209"></td>
        <td id="LC12209">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L12210" data-line-number="12210"></td>
        <td id="LC12210">
</td>
      </tr>
      <tr>
        <td id="L12211" data-line-number="12211"></td>
        <td id="LC12211">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12212" data-line-number="12212"></td>
        <td id="LC12212">
</td>
      </tr>
      <tr>
        <td id="L12213" data-line-number="12213"></td>
        <td id="LC12213">    <span>if</span> (<span>IsDynamicMethodHandle</span>(ftn))</td>
      </tr>
      <tr>
        <td id="L12214" data-line-number="12214"></td>
        <td id="LC12214">    {</td>
      </tr>
      <tr>
        <td id="L12215" data-line-number="12215"></td>
        <td id="LC12215">        <span>GetMethod</span>(ftn)-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>()-&gt;<span>GetEHInfo</span>(EHnumber, clause);</td>
      </tr>
      <tr>
        <td id="L12216" data-line-number="12216"></td>
        <td id="LC12216">    }</td>
      </tr>
      <tr>
        <td id="L12217" data-line-number="12217"></td>
        <td id="LC12217">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L12218" data-line-number="12218"></td>
        <td id="LC12218">    {</td>
      </tr>
      <tr>
        <td id="L12219" data-line-number="12219"></td>
        <td id="LC12219">        <span>_ASSERTE</span>(ftn == <span>CORINFO_METHOD_HANDLE</span>(m_pMethodBeingCompiled));  <span><span>//</span> For now only support if the method being jitted</span></td>
      </tr>
      <tr>
        <td id="L12220" data-line-number="12220"></td>
        <td id="LC12220">        <span>getEHinfoHelper</span>(ftn, EHnumber, clause, m_ILHeader);</td>
      </tr>
      <tr>
        <td id="L12221" data-line-number="12221"></td>
        <td id="LC12221">    }</td>
      </tr>
      <tr>
        <td id="L12222" data-line-number="12222"></td>
        <td id="LC12222">
</td>
      </tr>
      <tr>
        <td id="L12223" data-line-number="12223"></td>
        <td id="LC12223">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L12224" data-line-number="12224"></td>
        <td id="LC12224">}</td>
      </tr>
      <tr>
        <td id="L12225" data-line-number="12225"></td>
        <td id="LC12225">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L12226" data-line-number="12226"></td>
        <td id="LC12226">
</td>
      </tr>
      <tr>
        <td id="L12227" data-line-number="12227"></td>
        <td id="LC12227">#<span>if</span> defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L12228" data-line-number="12228"></td>
        <td id="LC12228">EXTERN_C ICorJitCompiler* __stdcall <span>getJit</span>();</td>
      </tr>
      <tr>
        <td id="L12229" data-line-number="12229"></td>
        <td id="LC12229">#<span>endif</span> <span><span>//</span> defined(CROSSGEN_COMPILE)</span></td>
      </tr>
      <tr>
        <td id="L12230" data-line-number="12230"></td>
        <td id="LC12230">
</td>
      </tr>
      <tr>
        <td id="L12231" data-line-number="12231"></td>
        <td id="LC12231">#<span>ifdef</span> FEATURE_INTERPRETER</td>
      </tr>
      <tr>
        <td id="L12232" data-line-number="12232"></td>
        <td id="LC12232"><span>static</span> CorJitResult <span>CompileMethodWithEtwWrapper</span>(EEJitManager *jitMgr,</td>
      </tr>
      <tr>
        <td id="L12233" data-line-number="12233"></td>
        <td id="LC12233">                                                      CEEInfo *comp,</td>
      </tr>
      <tr>
        <td id="L12234" data-line-number="12234"></td>
        <td id="LC12234">                                                      <span>struct</span> <span>CORINFO_METHOD_INFO</span> *info,</td>
      </tr>
      <tr>
        <td id="L12235" data-line-number="12235"></td>
        <td id="LC12235">                                                      <span>unsigned</span> flags,</td>
      </tr>
      <tr>
        <td id="L12236" data-line-number="12236"></td>
        <td id="LC12236">                                                      BYTE **nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12237" data-line-number="12237"></td>
        <td id="LC12237">                                                      ULONG *nativeSizeOfCode)</td>
      </tr>
      <tr>
        <td id="L12238" data-line-number="12238"></td>
        <td id="LC12238">{</td>
      </tr>
      <tr>
        <td id="L12239" data-line-number="12239"></td>
        <td id="LC12239">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L12240" data-line-number="12240"></td>
        <td id="LC12240">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12241" data-line-number="12241"></td>
        <td id="LC12241">    STATIC_CONTRACT_MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L12242" data-line-number="12242"></td>
        <td id="LC12242">
</td>
      </tr>
      <tr>
        <td id="L12243" data-line-number="12243"></td>
        <td id="LC12243">    SString namespaceOrClassName, methodName, methodSignature;</td>
      </tr>
      <tr>
        <td id="L12244" data-line-number="12244"></td>
        <td id="LC12244">    <span><span>//</span> Fire an ETW event to mark the beginning of JIT'ing</span></td>
      </tr>
      <tr>
        <td id="L12245" data-line-number="12245"></td>
        <td id="LC12245">    <span>ETW::MethodLog::MethodJitting</span>(<span>reinterpret_cast</span>&lt;MethodDesc*&gt;(info-&gt;<span>ftn</span>), &amp;namespaceOrClassName, &amp;methodName, &amp;methodSignature);</td>
      </tr>
      <tr>
        <td id="L12246" data-line-number="12246"></td>
        <td id="LC12246">
</td>
      </tr>
      <tr>
        <td id="L12247" data-line-number="12247"></td>
        <td id="LC12247">    CorJitResult ret = jitMgr-&gt;<span>m_jit</span>-&gt;<span>compileMethod</span>(comp, info, flags, nativeEntry, nativeSizeOfCode);</td>
      </tr>
      <tr>
        <td id="L12248" data-line-number="12248"></td>
        <td id="LC12248">
</td>
      </tr>
      <tr>
        <td id="L12249" data-line-number="12249"></td>
        <td id="LC12249">    <span><span>//</span> Logically, it would seem that the end-of-JITting ETW even should go here, but it must come after the native code has been</span></td>
      </tr>
      <tr>
        <td id="L12250" data-line-number="12250"></td>
        <td id="LC12250">    <span><span>//</span> set for the given method desc, which happens in a caller.</span></td>
      </tr>
      <tr>
        <td id="L12251" data-line-number="12251"></td>
        <td id="LC12251">
</td>
      </tr>
      <tr>
        <td id="L12252" data-line-number="12252"></td>
        <td id="LC12252">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L12253" data-line-number="12253"></td>
        <td id="LC12253">}</td>
      </tr>
      <tr>
        <td id="L12254" data-line-number="12254"></td>
        <td id="LC12254">#<span>endif</span> <span><span>//</span> FEATURE_INTERPRETER</span></td>
      </tr>
      <tr>
        <td id="L12255" data-line-number="12255"></td>
        <td id="LC12255">
</td>
      </tr>
      <tr>
        <td id="L12256" data-line-number="12256"></td>
        <td id="LC12256"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12257" data-line-number="12257"></td>
        <td id="LC12257"><span><span>//</span> Helper function because can't have dtors in BEGIN_SO_TOLERANT_CODE.</span></td>
      </tr>
      <tr>
        <td id="L12258" data-line-number="12258"></td>
        <td id="LC12258"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12259" data-line-number="12259"></td>
        <td id="LC12259">CorJitResult <span>invokeCompileMethodHelper</span>(EEJitManager *jitMgr,</td>
      </tr>
      <tr>
        <td id="L12260" data-line-number="12260"></td>
        <td id="LC12260">                                 CEEInfo *comp,</td>
      </tr>
      <tr>
        <td id="L12261" data-line-number="12261"></td>
        <td id="LC12261">                                 <span>struct</span> <span>CORINFO_METHOD_INFO</span> *info,</td>
      </tr>
      <tr>
        <td id="L12262" data-line-number="12262"></td>
        <td id="LC12262">                                 CORJIT_FLAGS jitFlags,</td>
      </tr>
      <tr>
        <td id="L12263" data-line-number="12263"></td>
        <td id="LC12263">                                 BYTE **nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12264" data-line-number="12264"></td>
        <td id="LC12264">                                 ULONG *nativeSizeOfCode)</td>
      </tr>
      <tr>
        <td id="L12265" data-line-number="12265"></td>
        <td id="LC12265">{</td>
      </tr>
      <tr>
        <td id="L12266" data-line-number="12266"></td>
        <td id="LC12266">    STATIC_CONTRACT_THROWS;</td>
      </tr>
      <tr>
        <td id="L12267" data-line-number="12267"></td>
        <td id="LC12267">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12268" data-line-number="12268"></td>
        <td id="LC12268">    STATIC_CONTRACT_MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L12269" data-line-number="12269"></td>
        <td id="LC12269">
</td>
      </tr>
      <tr>
        <td id="L12270" data-line-number="12270"></td>
        <td id="LC12270">    CorJitResult ret = CORJIT_SKIPPED;   <span><span>//</span> Note that CORJIT_SKIPPED is an error exit status code</span></td>
      </tr>
      <tr>
        <td id="L12271" data-line-number="12271"></td>
        <td id="LC12271">
</td>
      </tr>
      <tr>
        <td id="L12272" data-line-number="12272"></td>
        <td id="LC12272">    comp-&gt;<span>setJitFlags</span>(jitFlags);</td>
      </tr>
      <tr>
        <td id="L12273" data-line-number="12273"></td>
        <td id="LC12273">
</td>
      </tr>
      <tr>
        <td id="L12274" data-line-number="12274"></td>
        <td id="LC12274">#<span>ifdef</span> FEATURE_STACK_SAMPLING</td>
      </tr>
      <tr>
        <td id="L12275" data-line-number="12275"></td>
        <td id="LC12275">    <span>static</span> ConfigDWORD s_stackSamplingEnabled;</td>
      </tr>
      <tr>
        <td id="L12276" data-line-number="12276"></td>
        <td id="LC12276">    <span>bool</span> samplingEnabled = (s_stackSamplingEnabled.<span>val</span>(CLRConfig::UNSUPPORTED_StackSamplingEnabled) != <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12277" data-line-number="12277"></td>
        <td id="LC12277">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12278" data-line-number="12278"></td>
        <td id="LC12278">
</td>
      </tr>
      <tr>
        <td id="L12279" data-line-number="12279"></td>
        <td id="LC12279">#<span>if</span> defined(ALLOW_SXS_JIT) &amp;&amp; !defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L12280" data-line-number="12280"></td>
        <td id="LC12280">    <span>if</span> (<span>FAILED</span>(ret) &amp;&amp; jitMgr-&gt;<span>m_alternateJit</span></td>
      </tr>
      <tr>
        <td id="L12281" data-line-number="12281"></td>
        <td id="LC12281">#<span>ifdef</span> FEATURE_STACK_SAMPLING</td>
      </tr>
      <tr>
        <td id="L12282" data-line-number="12282"></td>
        <td id="LC12282">        &amp;&amp; (!samplingEnabled || (jitFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_SAMPLING_JIT_BACKGROUND)))</td>
      </tr>
      <tr>
        <td id="L12283" data-line-number="12283"></td>
        <td id="LC12283">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12284" data-line-number="12284"></td>
        <td id="LC12284">       )</td>
      </tr>
      <tr>
        <td id="L12285" data-line-number="12285"></td>
        <td id="LC12285">    {</td>
      </tr>
      <tr>
        <td id="L12286" data-line-number="12286"></td>
        <td id="LC12286">        ret = jitMgr-&gt;<span>m_alternateJit</span>-&gt;<span>compileMethod</span>( comp,</td>
      </tr>
      <tr>
        <td id="L12287" data-line-number="12287"></td>
        <td id="LC12287">                                                     info,</td>
      </tr>
      <tr>
        <td id="L12288" data-line-number="12288"></td>
        <td id="LC12288">                                                     CORJIT_FLAGS::CORJIT_FLAG_CALL_GETJITFLAGS,</td>
      </tr>
      <tr>
        <td id="L12289" data-line-number="12289"></td>
        <td id="LC12289">                                                     nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12290" data-line-number="12290"></td>
        <td id="LC12290">                                                     nativeSizeOfCode );</td>
      </tr>
      <tr>
        <td id="L12291" data-line-number="12291"></td>
        <td id="LC12291">
</td>
      </tr>
      <tr>
        <td id="L12292" data-line-number="12292"></td>
        <td id="LC12292">#<span>ifdef</span> FEATURE_STACK_SAMPLING</td>
      </tr>
      <tr>
        <td id="L12293" data-line-number="12293"></td>
        <td id="LC12293">        <span>if</span> (jitFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_SAMPLING_JIT_BACKGROUND))</td>
      </tr>
      <tr>
        <td id="L12294" data-line-number="12294"></td>
        <td id="LC12294">        {</td>
      </tr>
      <tr>
        <td id="L12295" data-line-number="12295"></td>
        <td id="LC12295">            <span><span>//</span> Don't bother with failures if we couldn't collect a trace.</span></td>
      </tr>
      <tr>
        <td id="L12296" data-line-number="12296"></td>
        <td id="LC12296">            ret = CORJIT_OK;</td>
      </tr>
      <tr>
        <td id="L12297" data-line-number="12297"></td>
        <td id="LC12297">        }</td>
      </tr>
      <tr>
        <td id="L12298" data-line-number="12298"></td>
        <td id="LC12298">#<span>endif</span> <span><span>//</span> FEATURE_STACK_SAMPLING</span></td>
      </tr>
      <tr>
        <td id="L12299" data-line-number="12299"></td>
        <td id="LC12299">
</td>
      </tr>
      <tr>
        <td id="L12300" data-line-number="12300"></td>
        <td id="LC12300">        <span><span>//</span> If we failed to jit, then fall back to the primary Jit.</span></td>
      </tr>
      <tr>
        <td id="L12301" data-line-number="12301"></td>
        <td id="LC12301">        <span>if</span> (<span>FAILED</span>(ret))</td>
      </tr>
      <tr>
        <td id="L12302" data-line-number="12302"></td>
        <td id="LC12302">        {</td>
      </tr>
      <tr>
        <td id="L12303" data-line-number="12303"></td>
        <td id="LC12303">            ((CEEJitInfo*)comp)-&gt;<span>BackoutJitData</span>(jitMgr);</td>
      </tr>
      <tr>
        <td id="L12304" data-line-number="12304"></td>
        <td id="LC12304">            ((CEEJitInfo*)comp)-&gt;<span>ResetForJitRetry</span>();</td>
      </tr>
      <tr>
        <td id="L12305" data-line-number="12305"></td>
        <td id="LC12305">            ret = CORJIT_SKIPPED;</td>
      </tr>
      <tr>
        <td id="L12306" data-line-number="12306"></td>
        <td id="LC12306">        }</td>
      </tr>
      <tr>
        <td id="L12307" data-line-number="12307"></td>
        <td id="LC12307">    }</td>
      </tr>
      <tr>
        <td id="L12308" data-line-number="12308"></td>
        <td id="LC12308">#<span>endif</span> <span><span>//</span> defined(ALLOW_SXS_JIT) &amp;&amp; !defined(CROSSGEN_COMPILE)</span></td>
      </tr>
      <tr>
        <td id="L12309" data-line-number="12309"></td>
        <td id="LC12309">
</td>
      </tr>
      <tr>
        <td id="L12310" data-line-number="12310"></td>
        <td id="LC12310">#<span>ifdef</span> FEATURE_INTERPRETER</td>
      </tr>
      <tr>
        <td id="L12311" data-line-number="12311"></td>
        <td id="LC12311">    <span>static</span> ConfigDWORD s_InterpreterFallback;</td>
      </tr>
      <tr>
        <td id="L12312" data-line-number="12312"></td>
        <td id="LC12312">
</td>
      </tr>
      <tr>
        <td id="L12313" data-line-number="12313"></td>
        <td id="LC12313">    <span>bool</span> isInterpreterStub   = <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L12314" data-line-number="12314"></td>
        <td id="LC12314">    <span>bool</span> interpreterFallback = (s_InterpreterFallback.<span>val</span>(CLRConfig::INTERNAL_InterpreterFallback) != <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L12315" data-line-number="12315"></td>
        <td id="LC12315">
</td>
      </tr>
      <tr>
        <td id="L12316" data-line-number="12316"></td>
        <td id="LC12316">    <span>if</span> (interpreterFallback == <span>false</span>)</td>
      </tr>
      <tr>
        <td id="L12317" data-line-number="12317"></td>
        <td id="LC12317">    {</td>
      </tr>
      <tr>
        <td id="L12318" data-line-number="12318"></td>
        <td id="LC12318">        <span><span>//</span> If we're doing an "import_only" compilation, it's for verification, so don't interpret.</span></td>
      </tr>
      <tr>
        <td id="L12319" data-line-number="12319"></td>
        <td id="LC12319">        <span><span>//</span> (We assume that importation is completely architecture-independent, or at least nearly so.)</span></td>
      </tr>
      <tr>
        <td id="L12320" data-line-number="12320"></td>
        <td id="LC12320">        <span>if</span> (<span>FAILED</span>(ret) &amp;&amp; !jitFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY) &amp;&amp; !jitFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_MAKEFINALCODE))</td>
      </tr>
      <tr>
        <td id="L12321" data-line-number="12321"></td>
        <td id="LC12321">        {</td>
      </tr>
      <tr>
        <td id="L12322" data-line-number="12322"></td>
        <td id="LC12322">            <span>if</span> (<span>SUCCEEDED</span>(ret = <span>Interpreter::GenerateInterpreterStub</span>(comp, info, nativeEntry, nativeSizeOfCode)))</td>
      </tr>
      <tr>
        <td id="L12323" data-line-number="12323"></td>
        <td id="LC12323">            {</td>
      </tr>
      <tr>
        <td id="L12324" data-line-number="12324"></td>
        <td id="LC12324">                isInterpreterStub = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L12325" data-line-number="12325"></td>
        <td id="LC12325">            }</td>
      </tr>
      <tr>
        <td id="L12326" data-line-number="12326"></td>
        <td id="LC12326">        }</td>
      </tr>
      <tr>
        <td id="L12327" data-line-number="12327"></td>
        <td id="LC12327">    }</td>
      </tr>
      <tr>
        <td id="L12328" data-line-number="12328"></td>
        <td id="LC12328">
</td>
      </tr>
      <tr>
        <td id="L12329" data-line-number="12329"></td>
        <td id="LC12329">    <span>if</span> (<span>FAILED</span>(ret) &amp;&amp; jitMgr-&gt;<span>m_jit</span>)</td>
      </tr>
      <tr>
        <td id="L12330" data-line-number="12330"></td>
        <td id="LC12330">    {</td>
      </tr>
      <tr>
        <td id="L12331" data-line-number="12331"></td>
        <td id="LC12331">        ret = <span>CompileMethodWithEtwWrapper</span>(jitMgr,</td>
      </tr>
      <tr>
        <td id="L12332" data-line-number="12332"></td>
        <td id="LC12332">                                          comp,</td>
      </tr>
      <tr>
        <td id="L12333" data-line-number="12333"></td>
        <td id="LC12333">                                          info,</td>
      </tr>
      <tr>
        <td id="L12334" data-line-number="12334"></td>
        <td id="LC12334">                                          CORJIT_FLAGS::CORJIT_FLAG_CALL_GETJITFLAGS,</td>
      </tr>
      <tr>
        <td id="L12335" data-line-number="12335"></td>
        <td id="LC12335">                                          nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12336" data-line-number="12336"></td>
        <td id="LC12336">                                          nativeSizeOfCode);</td>
      </tr>
      <tr>
        <td id="L12337" data-line-number="12337"></td>
        <td id="LC12337">    }</td>
      </tr>
      <tr>
        <td id="L12338" data-line-number="12338"></td>
        <td id="LC12338">
</td>
      </tr>
      <tr>
        <td id="L12339" data-line-number="12339"></td>
        <td id="LC12339">    <span>if</span> (interpreterFallback == <span>true</span>)</td>
      </tr>
      <tr>
        <td id="L12340" data-line-number="12340"></td>
        <td id="LC12340">    {</td>
      </tr>
      <tr>
        <td id="L12341" data-line-number="12341"></td>
        <td id="LC12341">        <span><span>//</span> If we're doing an "import_only" compilation, it's for verification, so don't interpret.</span></td>
      </tr>
      <tr>
        <td id="L12342" data-line-number="12342"></td>
        <td id="LC12342">        <span><span>//</span> (We assume that importation is completely architecture-independent, or at least nearly so.)</span></td>
      </tr>
      <tr>
        <td id="L12343" data-line-number="12343"></td>
        <td id="LC12343">        <span>if</span> (<span>FAILED</span>(ret) &amp;&amp; !jitFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY) &amp;&amp; !jitFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_MAKEFINALCODE))</td>
      </tr>
      <tr>
        <td id="L12344" data-line-number="12344"></td>
        <td id="LC12344">        {</td>
      </tr>
      <tr>
        <td id="L12345" data-line-number="12345"></td>
        <td id="LC12345">            <span>if</span> (<span>SUCCEEDED</span>(ret = <span>Interpreter::GenerateInterpreterStub</span>(comp, info, nativeEntry, nativeSizeOfCode)))</td>
      </tr>
      <tr>
        <td id="L12346" data-line-number="12346"></td>
        <td id="LC12346">            {</td>
      </tr>
      <tr>
        <td id="L12347" data-line-number="12347"></td>
        <td id="LC12347">                isInterpreterStub = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L12348" data-line-number="12348"></td>
        <td id="LC12348">            }</td>
      </tr>
      <tr>
        <td id="L12349" data-line-number="12349"></td>
        <td id="LC12349">        }</td>
      </tr>
      <tr>
        <td id="L12350" data-line-number="12350"></td>
        <td id="LC12350">    }</td>
      </tr>
      <tr>
        <td id="L12351" data-line-number="12351"></td>
        <td id="LC12351">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L12352" data-line-number="12352"></td>
        <td id="LC12352">    <span>if</span> (<span>FAILED</span>(ret))</td>
      </tr>
      <tr>
        <td id="L12353" data-line-number="12353"></td>
        <td id="LC12353">    {</td>
      </tr>
      <tr>
        <td id="L12354" data-line-number="12354"></td>
        <td id="LC12354">        ret = jitMgr-&gt;<span>m_jit</span>-&gt;<span>compileMethod</span>( comp,</td>
      </tr>
      <tr>
        <td id="L12355" data-line-number="12355"></td>
        <td id="LC12355">                                            info,</td>
      </tr>
      <tr>
        <td id="L12356" data-line-number="12356"></td>
        <td id="LC12356">                                            CORJIT_FLAGS::CORJIT_FLAG_CALL_GETJITFLAGS,</td>
      </tr>
      <tr>
        <td id="L12357" data-line-number="12357"></td>
        <td id="LC12357">                                            nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12358" data-line-number="12358"></td>
        <td id="LC12358">                                            nativeSizeOfCode);</td>
      </tr>
      <tr>
        <td id="L12359" data-line-number="12359"></td>
        <td id="LC12359">    }</td>
      </tr>
      <tr>
        <td id="L12360" data-line-number="12360"></td>
        <td id="LC12360">#<span>endif</span> <span><span>//</span> FEATURE_INTERPRETER</span></td>
      </tr>
      <tr>
        <td id="L12361" data-line-number="12361"></td>
        <td id="LC12361">
</td>
      </tr>
      <tr>
        <td id="L12362" data-line-number="12362"></td>
        <td id="LC12362">#<span>if</span> !defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L12363" data-line-number="12363"></td>
        <td id="LC12363">    <span><span>//</span> Cleanup any internal data structures allocated</span></td>
      </tr>
      <tr>
        <td id="L12364" data-line-number="12364"></td>
        <td id="LC12364">    <span><span>//</span> such as IL code after a successfull JIT compile</span></td>
      </tr>
      <tr>
        <td id="L12365" data-line-number="12365"></td>
        <td id="LC12365">    <span><span>//</span> If the JIT fails we keep the IL around and will</span></td>
      </tr>
      <tr>
        <td id="L12366" data-line-number="12366"></td>
        <td id="LC12366">    <span><span>//</span> try reJIT the same IL.  VSW 525059</span></td>
      </tr>
      <tr>
        <td id="L12367" data-line-number="12367"></td>
        <td id="LC12367">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12368" data-line-number="12368"></td>
        <td id="LC12368">    <span>if</span> (<span>SUCCEEDED</span>(ret) &amp;&amp; !jitFlags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY) &amp;&amp; !((CEEJitInfo*)comp)-&gt;<span>JitAgain</span>())</td>
      </tr>
      <tr>
        <td id="L12369" data-line-number="12369"></td>
        <td id="LC12369">    {</td>
      </tr>
      <tr>
        <td id="L12370" data-line-number="12370"></td>
        <td id="LC12370">        ((CEEJitInfo*)comp)-&gt;<span>CompressDebugInfo</span>();</td>
      </tr>
      <tr>
        <td id="L12371" data-line-number="12371"></td>
        <td id="LC12371">
</td>
      </tr>
      <tr>
        <td id="L12372" data-line-number="12372"></td>
        <td id="LC12372">#<span>ifdef</span> FEATURE_INTERPRETER</td>
      </tr>
      <tr>
        <td id="L12373" data-line-number="12373"></td>
        <td id="LC12373">        <span><span>//</span> We do this cleanup in the prestub, where we know whether the method</span></td>
      </tr>
      <tr>
        <td id="L12374" data-line-number="12374"></td>
        <td id="LC12374">        <span><span>//</span> has been interpreted.</span></td>
      </tr>
      <tr>
        <td id="L12375" data-line-number="12375"></td>
        <td id="LC12375">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L12376" data-line-number="12376"></td>
        <td id="LC12376">        comp-&gt;<span>MethodCompileComplete</span>(info-&gt;<span>ftn</span>);</td>
      </tr>
      <tr>
        <td id="L12377" data-line-number="12377"></td>
        <td id="LC12377">#<span>endif</span> <span><span>//</span> FEATURE_INTERPRETER</span></td>
      </tr>
      <tr>
        <td id="L12378" data-line-number="12378"></td>
        <td id="LC12378">    }</td>
      </tr>
      <tr>
        <td id="L12379" data-line-number="12379"></td>
        <td id="LC12379">#<span>endif</span> <span><span>//</span> !defined(CROSSGEN_COMPILE)</span></td>
      </tr>
      <tr>
        <td id="L12380" data-line-number="12380"></td>
        <td id="LC12380">
</td>
      </tr>
      <tr>
        <td id="L12381" data-line-number="12381"></td>
        <td id="LC12381">
</td>
      </tr>
      <tr>
        <td id="L12382" data-line-number="12382"></td>
        <td id="LC12382">#<span>if</span> defined(FEATURE_GDBJIT)</td>
      </tr>
      <tr>
        <td id="L12383" data-line-number="12383"></td>
        <td id="LC12383">    <span>bool</span> isJittedEntry = <span>SUCCEEDED</span>(ret) &amp;&amp; *nativeEntry != <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L12384" data-line-number="12384"></td>
        <td id="LC12384">
</td>
      </tr>
      <tr>
        <td id="L12385" data-line-number="12385"></td>
        <td id="LC12385">#<span>ifdef</span> FEATURE_INTERPRETER</td>
      </tr>
      <tr>
        <td id="L12386" data-line-number="12386"></td>
        <td id="LC12386">    isJittedEntry &amp;= !isInterpreterStub;</td>
      </tr>
      <tr>
        <td id="L12387" data-line-number="12387"></td>
        <td id="LC12387">#<span>endif</span> <span><span>//</span> FEATURE_INTERPRETER</span></td>
      </tr>
      <tr>
        <td id="L12388" data-line-number="12388"></td>
        <td id="LC12388">
</td>
      </tr>
      <tr>
        <td id="L12389" data-line-number="12389"></td>
        <td id="LC12389">    <span>if</span> (isJittedEntry)</td>
      </tr>
      <tr>
        <td id="L12390" data-line-number="12390"></td>
        <td id="LC12390">    {</td>
      </tr>
      <tr>
        <td id="L12391" data-line-number="12391"></td>
        <td id="LC12391">        CodeHeader* pCH = ((CodeHeader*)((PCODE)*nativeEntry &amp; ~<span>1</span>)) - <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L12392" data-line-number="12392"></td>
        <td id="LC12392">        pCH-&gt;<span>SetCalledMethods</span>((PTR_VOID)comp-&gt;<span>GetCalledMethods</span>());</td>
      </tr>
      <tr>
        <td id="L12393" data-line-number="12393"></td>
        <td id="LC12393">    }</td>
      </tr>
      <tr>
        <td id="L12394" data-line-number="12394"></td>
        <td id="LC12394">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12395" data-line-number="12395"></td>
        <td id="LC12395">
</td>
      </tr>
      <tr>
        <td id="L12396" data-line-number="12396"></td>
        <td id="LC12396">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L12397" data-line-number="12397"></td>
        <td id="LC12397">}</td>
      </tr>
      <tr>
        <td id="L12398" data-line-number="12398"></td>
        <td id="LC12398">
</td>
      </tr>
      <tr>
        <td id="L12399" data-line-number="12399"></td>
        <td id="LC12399">
</td>
      </tr>
      <tr>
        <td id="L12400" data-line-number="12400"></td>
        <td id="LC12400"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12401" data-line-number="12401"></td>
        <td id="LC12401">CorJitResult <span>invokeCompileMethod</span>(EEJitManager *jitMgr,</td>
      </tr>
      <tr>
        <td id="L12402" data-line-number="12402"></td>
        <td id="LC12402">                                 CEEInfo *comp,</td>
      </tr>
      <tr>
        <td id="L12403" data-line-number="12403"></td>
        <td id="LC12403">                                 <span>struct</span> <span>CORINFO_METHOD_INFO</span> *info,</td>
      </tr>
      <tr>
        <td id="L12404" data-line-number="12404"></td>
        <td id="LC12404">                                 CORJIT_FLAGS jitFlags,</td>
      </tr>
      <tr>
        <td id="L12405" data-line-number="12405"></td>
        <td id="LC12405">                                 BYTE **nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12406" data-line-number="12406"></td>
        <td id="LC12406">                                 ULONG *nativeSizeOfCode)</td>
      </tr>
      <tr>
        <td id="L12407" data-line-number="12407"></td>
        <td id="LC12407">{</td>
      </tr>
      <tr>
        <td id="L12408" data-line-number="12408"></td>
        <td id="LC12408">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L12409" data-line-number="12409"></td>
        <td id="LC12409">        THROWS;</td>
      </tr>
      <tr>
        <td id="L12410" data-line-number="12410"></td>
        <td id="LC12410">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12411" data-line-number="12411"></td>
        <td id="LC12411">        MODE_COOPERATIVE;</td>
      </tr>
      <tr>
        <td id="L12412" data-line-number="12412"></td>
        <td id="LC12412">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L12413" data-line-number="12413"></td>
        <td id="LC12413">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12414" data-line-number="12414"></td>
        <td id="LC12414">    <span><span>//</span> The JIT runs in preemptive mode</span></td>
      </tr>
      <tr>
        <td id="L12415" data-line-number="12415"></td>
        <td id="LC12415">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12416" data-line-number="12416"></td>
        <td id="LC12416">
</td>
      </tr>
      <tr>
        <td id="L12417" data-line-number="12417"></td>
        <td id="LC12417">    <span>GCX_PREEMP</span>();</td>
      </tr>
      <tr>
        <td id="L12418" data-line-number="12418"></td>
        <td id="LC12418">
</td>
      </tr>
      <tr>
        <td id="L12419" data-line-number="12419"></td>
        <td id="LC12419">    CorJitResult ret = <span>invokeCompileMethodHelper</span>(jitMgr, comp, info, jitFlags, nativeEntry, nativeSizeOfCode);</td>
      </tr>
      <tr>
        <td id="L12420" data-line-number="12420"></td>
        <td id="LC12420">
</td>
      </tr>
      <tr>
        <td id="L12421" data-line-number="12421"></td>
        <td id="LC12421">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12422" data-line-number="12422"></td>
        <td id="LC12422">    <span><span>//</span> Verify that we are still in preemptive mode when we return</span></td>
      </tr>
      <tr>
        <td id="L12423" data-line-number="12423"></td>
        <td id="LC12423">    <span><span>//</span> from the JIT</span></td>
      </tr>
      <tr>
        <td id="L12424" data-line-number="12424"></td>
        <td id="LC12424">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12425" data-line-number="12425"></td>
        <td id="LC12425">
</td>
      </tr>
      <tr>
        <td id="L12426" data-line-number="12426"></td>
        <td id="LC12426">    <span>_ASSERTE</span>(<span>GetThread</span>()-&gt;<span>PreemptiveGCDisabled</span>() == <span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L12427" data-line-number="12427"></td>
        <td id="LC12427">
</td>
      </tr>
      <tr>
        <td id="L12428" data-line-number="12428"></td>
        <td id="LC12428">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L12429" data-line-number="12429"></td>
        <td id="LC12429">}</td>
      </tr>
      <tr>
        <td id="L12430" data-line-number="12430"></td>
        <td id="LC12430">
</td>
      </tr>
      <tr>
        <td id="L12431" data-line-number="12431"></td>
        <td id="LC12431">CorJitResult <span>CallCompileMethodWithSEHWrapper</span>(EEJitManager *jitMgr,</td>
      </tr>
      <tr>
        <td id="L12432" data-line-number="12432"></td>
        <td id="LC12432">                                CEEInfo *comp,</td>
      </tr>
      <tr>
        <td id="L12433" data-line-number="12433"></td>
        <td id="LC12433">                                <span>struct</span> <span>CORINFO_METHOD_INFO</span> *info,</td>
      </tr>
      <tr>
        <td id="L12434" data-line-number="12434"></td>
        <td id="LC12434">                                CORJIT_FLAGS flags,</td>
      </tr>
      <tr>
        <td id="L12435" data-line-number="12435"></td>
        <td id="LC12435">                                BYTE **nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12436" data-line-number="12436"></td>
        <td id="LC12436">                                ULONG *nativeSizeOfCode,</td>
      </tr>
      <tr>
        <td id="L12437" data-line-number="12437"></td>
        <td id="LC12437">                                NativeCodeVersion nativeCodeVersion)</td>
      </tr>
      <tr>
        <td id="L12438" data-line-number="12438"></td>
        <td id="LC12438">{</td>
      </tr>
      <tr>
        <td id="L12439" data-line-number="12439"></td>
        <td id="LC12439">    <span><span>//</span> no dynamic contract here because SEH is used, with a finally clause</span></td>
      </tr>
      <tr>
        <td id="L12440" data-line-number="12440"></td>
        <td id="LC12440">    STATIC_CONTRACT_NOTHROW;</td>
      </tr>
      <tr>
        <td id="L12441" data-line-number="12441"></td>
        <td id="LC12441">    STATIC_CONTRACT_GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12442" data-line-number="12442"></td>
        <td id="LC12442">
</td>
      </tr>
      <tr>
        <td id="L12443" data-line-number="12443"></td>
        <td id="LC12443">    MethodDesc* ftn = nativeCodeVersion.<span>GetMethodDesc</span>();</td>
      </tr>
      <tr>
        <td id="L12444" data-line-number="12444"></td>
        <td id="LC12444">
</td>
      </tr>
      <tr>
        <td id="L12445" data-line-number="12445"></td>
        <td id="LC12445">    <span>LOG</span>((LF_CORDB, LL_EVERYTHING, <span><span>"</span>CallCompileMethodWithSEHWrapper called...<span>\n</span><span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L12446" data-line-number="12446"></td>
        <td id="LC12446">
</td>
      </tr>
      <tr>
        <td id="L12447" data-line-number="12447"></td>
        <td id="LC12447">    <span>struct</span> <span>Param</span></td>
      </tr>
      <tr>
        <td id="L12448" data-line-number="12448"></td>
        <td id="LC12448">    {</td>
      </tr>
      <tr>
        <td id="L12449" data-line-number="12449"></td>
        <td id="LC12449">        EEJitManager *jitMgr;</td>
      </tr>
      <tr>
        <td id="L12450" data-line-number="12450"></td>
        <td id="LC12450">        CEEInfo *comp;</td>
      </tr>
      <tr>
        <td id="L12451" data-line-number="12451"></td>
        <td id="LC12451">        <span>struct</span> <span>CORINFO_METHOD_INFO</span> *info;</td>
      </tr>
      <tr>
        <td id="L12452" data-line-number="12452"></td>
        <td id="LC12452">        CORJIT_FLAGS flags;</td>
      </tr>
      <tr>
        <td id="L12453" data-line-number="12453"></td>
        <td id="LC12453">        BYTE **nativeEntry;</td>
      </tr>
      <tr>
        <td id="L12454" data-line-number="12454"></td>
        <td id="LC12454">        ULONG *nativeSizeOfCode;</td>
      </tr>
      <tr>
        <td id="L12455" data-line-number="12455"></td>
        <td id="LC12455">        MethodDesc *ftn;</td>
      </tr>
      <tr>
        <td id="L12456" data-line-number="12456"></td>
        <td id="LC12456">        CorJitResult res;</td>
      </tr>
      <tr>
        <td id="L12457" data-line-number="12457"></td>
        <td id="LC12457">    }; Param param;</td>
      </tr>
      <tr>
        <td id="L12458" data-line-number="12458"></td>
        <td id="LC12458">    param.<span>jitMgr</span> = jitMgr;</td>
      </tr>
      <tr>
        <td id="L12459" data-line-number="12459"></td>
        <td id="LC12459">    param.<span>comp</span> = comp;</td>
      </tr>
      <tr>
        <td id="L12460" data-line-number="12460"></td>
        <td id="LC12460">    param.<span>info</span> = info;</td>
      </tr>
      <tr>
        <td id="L12461" data-line-number="12461"></td>
        <td id="LC12461">    param.<span>flags</span> = flags;</td>
      </tr>
      <tr>
        <td id="L12462" data-line-number="12462"></td>
        <td id="LC12462">    param.<span>nativeEntry</span> = nativeEntry;</td>
      </tr>
      <tr>
        <td id="L12463" data-line-number="12463"></td>
        <td id="LC12463">    param.<span>nativeSizeOfCode</span> = nativeSizeOfCode;</td>
      </tr>
      <tr>
        <td id="L12464" data-line-number="12464"></td>
        <td id="LC12464">    param.<span>ftn</span> = ftn;</td>
      </tr>
      <tr>
        <td id="L12465" data-line-number="12465"></td>
        <td id="LC12465">    param.<span>res</span> = CORJIT_INTERNALERROR;</td>
      </tr>
      <tr>
        <td id="L12466" data-line-number="12466"></td>
        <td id="LC12466">
</td>
      </tr>
      <tr>
        <td id="L12467" data-line-number="12467"></td>
        <td id="LC12467">    <span>PAL_TRY</span>(Param *, pParam, &amp;param)</td>
      </tr>
      <tr>
        <td id="L12468" data-line-number="12468"></td>
        <td id="LC12468">    {</td>
      </tr>
      <tr>
        <td id="L12469" data-line-number="12469"></td>
        <td id="LC12469">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12470" data-line-number="12470"></td>
        <td id="LC12470">        <span><span>//</span> Call out to the JIT-compiler</span></td>
      </tr>
      <tr>
        <td id="L12471" data-line-number="12471"></td>
        <td id="LC12471">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12472" data-line-number="12472"></td>
        <td id="LC12472">
</td>
      </tr>
      <tr>
        <td id="L12473" data-line-number="12473"></td>
        <td id="LC12473">        pParam-&gt;<span>res</span> = <span>invokeCompileMethod</span>( pParam-&gt;<span>jitMgr</span>,</td>
      </tr>
      <tr>
        <td id="L12474" data-line-number="12474"></td>
        <td id="LC12474">                                           pParam-&gt;<span>comp</span>,</td>
      </tr>
      <tr>
        <td id="L12475" data-line-number="12475"></td>
        <td id="LC12475">                                           pParam-&gt;<span>info</span>,</td>
      </tr>
      <tr>
        <td id="L12476" data-line-number="12476"></td>
        <td id="LC12476">                                           pParam-&gt;<span>flags</span>,</td>
      </tr>
      <tr>
        <td id="L12477" data-line-number="12477"></td>
        <td id="LC12477">                                           pParam-&gt;<span>nativeEntry</span>,</td>
      </tr>
      <tr>
        <td id="L12478" data-line-number="12478"></td>
        <td id="LC12478">                                           pParam-&gt;<span>nativeSizeOfCode</span>);</td>
      </tr>
      <tr>
        <td id="L12479" data-line-number="12479"></td>
        <td id="LC12479">    }</td>
      </tr>
      <tr>
        <td id="L12480" data-line-number="12480"></td>
        <td id="LC12480">    PAL_FINALLY</td>
      </tr>
      <tr>
        <td id="L12481" data-line-number="12481"></td>
        <td id="LC12481">    {</td>
      </tr>
      <tr>
        <td id="L12482" data-line-number="12482"></td>
        <td id="LC12482">#<span>if</span> defined(DEBUGGING_SUPPORTED) &amp;&amp; !defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L12483" data-line-number="12483"></td>
        <td id="LC12483">        <span>if</span> (!flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12484" data-line-number="12484"></td>
        <td id="LC12484">            !flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_MCJIT_BACKGROUND)</td>
      </tr>
      <tr>
        <td id="L12485" data-line-number="12485"></td>
        <td id="LC12485">#<span>ifdef</span> FEATURE_STACK_SAMPLING</td>
      </tr>
      <tr>
        <td id="L12486" data-line-number="12486"></td>
        <td id="LC12486">            &amp;&amp; !flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_SAMPLING_JIT_BACKGROUND)</td>
      </tr>
      <tr>
        <td id="L12487" data-line-number="12487"></td>
        <td id="LC12487">#<span>endif</span> <span><span>//</span> FEATURE_STACK_SAMPLING</span></td>
      </tr>
      <tr>
        <td id="L12488" data-line-number="12488"></td>
        <td id="LC12488">           )</td>
      </tr>
      <tr>
        <td id="L12489" data-line-number="12489"></td>
        <td id="LC12489">        {</td>
      </tr>
      <tr>
        <td id="L12490" data-line-number="12490"></td>
        <td id="LC12490">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12491" data-line-number="12491"></td>
        <td id="LC12491">            <span><span>//</span> Notify the debugger that we have successfully jitted the function</span></td>
      </tr>
      <tr>
        <td id="L12492" data-line-number="12492"></td>
        <td id="LC12492">            <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12493" data-line-number="12493"></td>
        <td id="LC12493">            <span>if</span> (g_pDebugInterface)</td>
      </tr>
      <tr>
        <td id="L12494" data-line-number="12494"></td>
        <td id="LC12494">            {</td>
      </tr>
      <tr>
        <td id="L12495" data-line-number="12495"></td>
        <td id="LC12495">                <span>if</span> (param.<span>res</span> == CORJIT_OK &amp;&amp; !((CEEJitInfo*)param.<span>comp</span>)-&gt;<span>JitAgain</span>())</td>
      </tr>
      <tr>
        <td id="L12496" data-line-number="12496"></td>
        <td id="LC12496">                {</td>
      </tr>
      <tr>
        <td id="L12497" data-line-number="12497"></td>
        <td id="LC12497">                    g_pDebugInterface-&gt;<span>JITComplete</span>(nativeCodeVersion, (TADDR)*nativeEntry);</td>
      </tr>
      <tr>
        <td id="L12498" data-line-number="12498"></td>
        <td id="LC12498">                }</td>
      </tr>
      <tr>
        <td id="L12499" data-line-number="12499"></td>
        <td id="LC12499">            }</td>
      </tr>
      <tr>
        <td id="L12500" data-line-number="12500"></td>
        <td id="LC12500">        }</td>
      </tr>
      <tr>
        <td id="L12501" data-line-number="12501"></td>
        <td id="LC12501">#<span>endif</span> <span><span>//</span> DEBUGGING_SUPPORTED &amp;&amp; !CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L12502" data-line-number="12502"></td>
        <td id="LC12502">    }</td>
      </tr>
      <tr>
        <td id="L12503" data-line-number="12503"></td>
        <td id="LC12503">    PAL_ENDTRY</td>
      </tr>
      <tr>
        <td id="L12504" data-line-number="12504"></td>
        <td id="LC12504">
</td>
      </tr>
      <tr>
        <td id="L12505" data-line-number="12505"></td>
        <td id="LC12505">    <span>return</span> param.<span>res</span>;</td>
      </tr>
      <tr>
        <td id="L12506" data-line-number="12506"></td>
        <td id="LC12506">}</td>
      </tr>
      <tr>
        <td id="L12507" data-line-number="12507"></td>
        <td id="LC12507">
</td>
      </tr>
      <tr>
        <td id="L12508" data-line-number="12508"></td>
        <td id="LC12508"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12509" data-line-number="12509"></td>
        <td id="LC12509"><span><span>//</span> Figures out the compile flags that are used by both JIT and NGen</span></td>
      </tr>
      <tr>
        <td id="L12510" data-line-number="12510"></td>
        <td id="LC12510">
</td>
      </tr>
      <tr>
        <td id="L12511" data-line-number="12511"></td>
        <td id="LC12511"><span><span>/*</span> static <span>*/</span></span> CORJIT_FLAGS <span>CEEInfo::GetBaseCompileFlags</span>(MethodDesc * ftn)</td>
      </tr>
      <tr>
        <td id="L12512" data-line-number="12512"></td>
        <td id="LC12512">{</td>
      </tr>
      <tr>
        <td id="L12513" data-line-number="12513"></td>
        <td id="LC12513">     CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L12514" data-line-number="12514"></td>
        <td id="LC12514">        THROWS;</td>
      </tr>
      <tr>
        <td id="L12515" data-line-number="12515"></td>
        <td id="LC12515">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L12516" data-line-number="12516"></td>
        <td id="LC12516">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L12517" data-line-number="12517"></td>
        <td id="LC12517">
</td>
      </tr>
      <tr>
        <td id="L12518" data-line-number="12518"></td>
        <td id="LC12518">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12519" data-line-number="12519"></td>
        <td id="LC12519">    <span><span>//</span> Figure out the code quality flags</span></td>
      </tr>
      <tr>
        <td id="L12520" data-line-number="12520"></td>
        <td id="LC12520">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12521" data-line-number="12521"></td>
        <td id="LC12521">
</td>
      </tr>
      <tr>
        <td id="L12522" data-line-number="12522"></td>
        <td id="LC12522">    CORJIT_FLAGS flags;</td>
      </tr>
      <tr>
        <td id="L12523" data-line-number="12523"></td>
        <td id="LC12523">    <span>if</span> (g_pConfig-&gt;<span>JitFramed</span>())</td>
      </tr>
      <tr>
        <td id="L12524" data-line-number="12524"></td>
        <td id="LC12524">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_FRAMED);</td>
      </tr>
      <tr>
        <td id="L12525" data-line-number="12525"></td>
        <td id="LC12525">    <span>if</span> (g_pConfig-&gt;<span>JitAlignLoops</span>())</td>
      </tr>
      <tr>
        <td id="L12526" data-line-number="12526"></td>
        <td id="LC12526">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_ALIGN_LOOPS);</td>
      </tr>
      <tr>
        <td id="L12527" data-line-number="12527"></td>
        <td id="LC12527">#<span>ifdef</span> TARGET_X86</td>
      </tr>
      <tr>
        <td id="L12528" data-line-number="12528"></td>
        <td id="LC12528">    <span>if</span> (g_pConfig-&gt;<span>PInvokeRestoreEsp</span>(ftn-&gt;<span>GetModule</span>()-&gt;<span>IsPreV4Assembly</span>()))</td>
      </tr>
      <tr>
        <td id="L12529" data-line-number="12529"></td>
        <td id="LC12529">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_PINVOKE_RESTORE_ESP);</td>
      </tr>
      <tr>
        <td id="L12530" data-line-number="12530"></td>
        <td id="LC12530">#<span>endif</span> <span><span>//</span> TARGET_X86</span></td>
      </tr>
      <tr>
        <td id="L12531" data-line-number="12531"></td>
        <td id="LC12531">
</td>
      </tr>
      <tr>
        <td id="L12532" data-line-number="12532"></td>
        <td id="LC12532">    <span><span>//</span>See if we should instruct the JIT to emit calls to JIT_PollGC for thread suspension.  If we have a</span></td>
      </tr>
      <tr>
        <td id="L12533" data-line-number="12533"></td>
        <td id="LC12533">    <span><span>//</span>non-default value in the EE Config, then use that.  Otherwise select the platform specific default.</span></td>
      </tr>
      <tr>
        <td id="L12534" data-line-number="12534"></td>
        <td id="LC12534">#<span>ifdef</span> FEATURE_ENABLE_GCPOLL</td>
      </tr>
      <tr>
        <td id="L12535" data-line-number="12535"></td>
        <td id="LC12535">    EEConfig::GCPollType pollType = g_pConfig-&gt;<span>GetGCPollType</span>();</td>
      </tr>
      <tr>
        <td id="L12536" data-line-number="12536"></td>
        <td id="LC12536">    <span>if</span> (EEConfig::GCPOLL_TYPE_POLL == pollType)</td>
      </tr>
      <tr>
        <td id="L12537" data-line-number="12537"></td>
        <td id="LC12537">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_GCPOLL_CALLS);</td>
      </tr>
      <tr>
        <td id="L12538" data-line-number="12538"></td>
        <td id="LC12538">    <span>else</span> <span>if</span> (EEConfig::GCPOLL_TYPE_INLINE == pollType)</td>
      </tr>
      <tr>
        <td id="L12539" data-line-number="12539"></td>
        <td id="LC12539">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_GCPOLL_INLINE);</td>
      </tr>
      <tr>
        <td id="L12540" data-line-number="12540"></td>
        <td id="LC12540">#<span>endif</span> <span><span>//</span>FEATURE_ENABLE_GCPOLL</span></td>
      </tr>
      <tr>
        <td id="L12541" data-line-number="12541"></td>
        <td id="LC12541">
</td>
      </tr>
      <tr>
        <td id="L12542" data-line-number="12542"></td>
        <td id="LC12542">    <span><span>//</span> Set flags based on method's ImplFlags.</span></td>
      </tr>
      <tr>
        <td id="L12543" data-line-number="12543"></td>
        <td id="LC12543">    <span>if</span> (!ftn-&gt;<span>IsNoMetadata</span>())</td>
      </tr>
      <tr>
        <td id="L12544" data-line-number="12544"></td>
        <td id="LC12544">    {</td>
      </tr>
      <tr>
        <td id="L12545" data-line-number="12545"></td>
        <td id="LC12545">         DWORD dwImplFlags = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L12546" data-line-number="12546"></td>
        <td id="LC12546">         <span>IfFailThrow</span>(ftn-&gt;<span>GetMDImport</span>()-&gt;<span>GetMethodImplProps</span>(ftn-&gt;<span>GetMemberDef</span>(), <span>NULL</span>, &amp;dwImplFlags));</td>
      </tr>
      <tr>
        <td id="L12547" data-line-number="12547"></td>
        <td id="LC12547">
</td>
      </tr>
      <tr>
        <td id="L12548" data-line-number="12548"></td>
        <td id="LC12548">         <span>if</span> (<span>IsMiNoOptimization</span>(dwImplFlags))</td>
      </tr>
      <tr>
        <td id="L12549" data-line-number="12549"></td>
        <td id="LC12549">         {</td>
      </tr>
      <tr>
        <td id="L12550" data-line-number="12550"></td>
        <td id="LC12550">             flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_MIN_OPT);</td>
      </tr>
      <tr>
        <td id="L12551" data-line-number="12551"></td>
        <td id="LC12551">         }</td>
      </tr>
      <tr>
        <td id="L12552" data-line-number="12552"></td>
        <td id="LC12552">
</td>
      </tr>
      <tr>
        <td id="L12553" data-line-number="12553"></td>
        <td id="LC12553">         <span><span>//</span> Always emit frames for methods marked no-inline (see #define ETW_EBP_FRAMED in the JIT)</span></td>
      </tr>
      <tr>
        <td id="L12554" data-line-number="12554"></td>
        <td id="LC12554">         <span>if</span> (<span>IsMiNoInlining</span>(dwImplFlags))</td>
      </tr>
      <tr>
        <td id="L12555" data-line-number="12555"></td>
        <td id="LC12555">         {</td>
      </tr>
      <tr>
        <td id="L12556" data-line-number="12556"></td>
        <td id="LC12556">             flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_FRAMED);</td>
      </tr>
      <tr>
        <td id="L12557" data-line-number="12557"></td>
        <td id="LC12557">         }</td>
      </tr>
      <tr>
        <td id="L12558" data-line-number="12558"></td>
        <td id="LC12558">    }</td>
      </tr>
      <tr>
        <td id="L12559" data-line-number="12559"></td>
        <td id="LC12559">
</td>
      </tr>
      <tr>
        <td id="L12560" data-line-number="12560"></td>
        <td id="LC12560">    <span>return</span> flags;</td>
      </tr>
      <tr>
        <td id="L12561" data-line-number="12561"></td>
        <td id="LC12561">}</td>
      </tr>
      <tr>
        <td id="L12562" data-line-number="12562"></td>
        <td id="LC12562">
</td>
      </tr>
      <tr>
        <td id="L12563" data-line-number="12563"></td>
        <td id="LC12563"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12564" data-line-number="12564"></td>
        <td id="LC12564"><span><span>//</span> Figures out (some of) the flags to use to compile the method</span></td>
      </tr>
      <tr>
        <td id="L12565" data-line-number="12565"></td>
        <td id="LC12565"><span><span>//</span> Returns the new set to use</span></td>
      </tr>
      <tr>
        <td id="L12566" data-line-number="12566"></td>
        <td id="LC12566">
</td>
      </tr>
      <tr>
        <td id="L12567" data-line-number="12567"></td>
        <td id="LC12567">CORJIT_FLAGS <span>GetDebuggerCompileFlags</span>(Module* pModule, CORJIT_FLAGS flags)</td>
      </tr>
      <tr>
        <td id="L12568" data-line-number="12568"></td>
        <td id="LC12568">{</td>
      </tr>
      <tr>
        <td id="L12569" data-line-number="12569"></td>
        <td id="LC12569">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L12570" data-line-number="12570"></td>
        <td id="LC12570">
</td>
      </tr>
      <tr>
        <td id="L12571" data-line-number="12571"></td>
        <td id="LC12571">    <span><span>//</span>Right now if we don't have a debug interface on CoreCLR, we can't generate debug info.  So, in those</span></td>
      </tr>
      <tr>
        <td id="L12572" data-line-number="12572"></td>
        <td id="LC12572">    <span><span>//</span>cases don't attempt it.</span></td>
      </tr>
      <tr>
        <td id="L12573" data-line-number="12573"></td>
        <td id="LC12573">    <span>if</span> (!g_pDebugInterface)</td>
      </tr>
      <tr>
        <td id="L12574" data-line-number="12574"></td>
        <td id="LC12574">        <span>return</span> flags;</td>
      </tr>
      <tr>
        <td id="L12575" data-line-number="12575"></td>
        <td id="LC12575">
</td>
      </tr>
      <tr>
        <td id="L12576" data-line-number="12576"></td>
        <td id="LC12576">#<span>ifdef</span> DEBUGGING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L12577" data-line-number="12577"></td>
        <td id="LC12577">
</td>
      </tr>
      <tr>
        <td id="L12578" data-line-number="12578"></td>
        <td id="LC12578">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L12579" data-line-number="12579"></td>
        <td id="LC12579">    <span>if</span> (g_pConfig-&gt;<span>GenDebuggableCode</span>())</td>
      </tr>
      <tr>
        <td id="L12580" data-line-number="12580"></td>
        <td id="LC12580">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_CODE);</td>
      </tr>
      <tr>
        <td id="L12581" data-line-number="12581"></td>
        <td id="LC12581">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L12582" data-line-number="12582"></td>
        <td id="LC12582">
</td>
      </tr>
      <tr>
        <td id="L12583" data-line-number="12583"></td>
        <td id="LC12583">#<span>ifdef</span> EnC_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L12584" data-line-number="12584"></td>
        <td id="LC12584">    <span>if</span> (pModule-&gt;<span>IsEditAndContinueEnabled</span>())</td>
      </tr>
      <tr>
        <td id="L12585" data-line-number="12585"></td>
        <td id="LC12585">    {</td>
      </tr>
      <tr>
        <td id="L12586" data-line-number="12586"></td>
        <td id="LC12586">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_EnC);</td>
      </tr>
      <tr>
        <td id="L12587" data-line-number="12587"></td>
        <td id="LC12587">    }</td>
      </tr>
      <tr>
        <td id="L12588" data-line-number="12588"></td>
        <td id="LC12588">#<span>endif</span> <span><span>//</span> EnC_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L12589" data-line-number="12589"></td>
        <td id="LC12589">
</td>
      </tr>
      <tr>
        <td id="L12590" data-line-number="12590"></td>
        <td id="LC12590">    <span><span>//</span> Debug info is always tracked</span></td>
      </tr>
      <tr>
        <td id="L12591" data-line-number="12591"></td>
        <td id="LC12591">    flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_INFO);</td>
      </tr>
      <tr>
        <td id="L12592" data-line-number="12592"></td>
        <td id="LC12592">#<span>endif</span> <span><span>//</span> DEBUGGING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L12593" data-line-number="12593"></td>
        <td id="LC12593">
</td>
      </tr>
      <tr>
        <td id="L12594" data-line-number="12594"></td>
        <td id="LC12594">    <span>if</span> (<span>CORDisableJITOptimizations</span>(pModule-&gt;<span>GetDebuggerInfoBits</span>()))</td>
      </tr>
      <tr>
        <td id="L12595" data-line-number="12595"></td>
        <td id="LC12595">    {</td>
      </tr>
      <tr>
        <td id="L12596" data-line-number="12596"></td>
        <td id="LC12596">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_CODE);</td>
      </tr>
      <tr>
        <td id="L12597" data-line-number="12597"></td>
        <td id="LC12597">    }</td>
      </tr>
      <tr>
        <td id="L12598" data-line-number="12598"></td>
        <td id="LC12598">
</td>
      </tr>
      <tr>
        <td id="L12599" data-line-number="12599"></td>
        <td id="LC12599">    <span>if</span> (flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY))</td>
      </tr>
      <tr>
        <td id="L12600" data-line-number="12600"></td>
        <td id="LC12600">    {</td>
      </tr>
      <tr>
        <td id="L12601" data-line-number="12601"></td>
        <td id="LC12601">        <span><span>//</span> If we are only verifying the method, dont need any debug info and this</span></td>
      </tr>
      <tr>
        <td id="L12602" data-line-number="12602"></td>
        <td id="LC12602">        <span><span>//</span> prevents getVars()/getBoundaries() from being called unnecessarily.</span></td>
      </tr>
      <tr>
        <td id="L12603" data-line-number="12603"></td>
        <td id="LC12603">        flags.<span>Clear</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_INFO);</td>
      </tr>
      <tr>
        <td id="L12604" data-line-number="12604"></td>
        <td id="LC12604">        flags.<span>Clear</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_CODE);</td>
      </tr>
      <tr>
        <td id="L12605" data-line-number="12605"></td>
        <td id="LC12605">    }</td>
      </tr>
      <tr>
        <td id="L12606" data-line-number="12606"></td>
        <td id="LC12606">
</td>
      </tr>
      <tr>
        <td id="L12607" data-line-number="12607"></td>
        <td id="LC12607">    <span>return</span> flags;</td>
      </tr>
      <tr>
        <td id="L12608" data-line-number="12608"></td>
        <td id="LC12608">}</td>
      </tr>
      <tr>
        <td id="L12609" data-line-number="12609"></td>
        <td id="LC12609">
</td>
      </tr>
      <tr>
        <td id="L12610" data-line-number="12610"></td>
        <td id="LC12610">CORJIT_FLAGS <span>GetCompileFlags</span>(MethodDesc * ftn, CORJIT_FLAGS flags, CORINFO_METHOD_INFO * methodInfo)</td>
      </tr>
      <tr>
        <td id="L12611" data-line-number="12611"></td>
        <td id="LC12611">{</td>
      </tr>
      <tr>
        <td id="L12612" data-line-number="12612"></td>
        <td id="LC12612">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L12613" data-line-number="12613"></td>
        <td id="LC12613">
</td>
      </tr>
      <tr>
        <td id="L12614" data-line-number="12614"></td>
        <td id="LC12614">    <span>_ASSERTE</span>(methodInfo-&gt;<span>regionKind</span> ==  CORINFO_REGION_JIT);</td>
      </tr>
      <tr>
        <td id="L12615" data-line-number="12615"></td>
        <td id="LC12615">
</td>
      </tr>
      <tr>
        <td id="L12616" data-line-number="12616"></td>
        <td id="LC12616">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12617" data-line-number="12617"></td>
        <td id="LC12617">    <span><span>//</span> Get the compile flags that are shared between JIT and NGen</span></td>
      </tr>
      <tr>
        <td id="L12618" data-line-number="12618"></td>
        <td id="LC12618">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12619" data-line-number="12619"></td>
        <td id="LC12619">    flags.<span>Add</span>(<span>CEEInfo::GetBaseCompileFlags</span>(ftn));</td>
      </tr>
      <tr>
        <td id="L12620" data-line-number="12620"></td>
        <td id="LC12620">
</td>
      </tr>
      <tr>
        <td id="L12621" data-line-number="12621"></td>
        <td id="LC12621">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12622" data-line-number="12622"></td>
        <td id="LC12622">    <span><span>//</span> Get CPU specific flags</span></td>
      </tr>
      <tr>
        <td id="L12623" data-line-number="12623"></td>
        <td id="LC12623">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12624" data-line-number="12624"></td>
        <td id="LC12624">    <span>if</span> (!flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY))</td>
      </tr>
      <tr>
        <td id="L12625" data-line-number="12625"></td>
        <td id="LC12625">    {</td>
      </tr>
      <tr>
        <td id="L12626" data-line-number="12626"></td>
        <td id="LC12626">        flags.<span>Add</span>(<span>ExecutionManager::GetEEJitManager</span>()-&gt;<span>GetCPUCompileFlags</span>());</td>
      </tr>
      <tr>
        <td id="L12627" data-line-number="12627"></td>
        <td id="LC12627">    }</td>
      </tr>
      <tr>
        <td id="L12628" data-line-number="12628"></td>
        <td id="LC12628">
</td>
      </tr>
      <tr>
        <td id="L12629" data-line-number="12629"></td>
        <td id="LC12629">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12630" data-line-number="12630"></td>
        <td id="LC12630">    <span><span>//</span> Find the debugger and profiler related flags</span></td>
      </tr>
      <tr>
        <td id="L12631" data-line-number="12631"></td>
        <td id="LC12631">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12632" data-line-number="12632"></td>
        <td id="LC12632">
</td>
      </tr>
      <tr>
        <td id="L12633" data-line-number="12633"></td>
        <td id="LC12633">#<span>ifdef</span> DEBUGGING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L12634" data-line-number="12634"></td>
        <td id="LC12634">    flags.<span>Add</span>(<span>GetDebuggerCompileFlags</span>(ftn-&gt;<span>GetModule</span>(), flags));</td>
      </tr>
      <tr>
        <td id="L12635" data-line-number="12635"></td>
        <td id="LC12635">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12636" data-line-number="12636"></td>
        <td id="LC12636">
</td>
      </tr>
      <tr>
        <td id="L12637" data-line-number="12637"></td>
        <td id="LC12637">#<span>ifdef</span> PROFILING_SUPPORTED</td>
      </tr>
      <tr>
        <td id="L12638" data-line-number="12638"></td>
        <td id="LC12638">    <span>if</span> (<span>CORProfilerTrackEnterLeave</span>() &amp;&amp; !ftn-&gt;<span>IsNoMetadata</span>())</td>
      </tr>
      <tr>
        <td id="L12639" data-line-number="12639"></td>
        <td id="LC12639">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_PROF_ENTERLEAVE);</td>
      </tr>
      <tr>
        <td id="L12640" data-line-number="12640"></td>
        <td id="LC12640">
</td>
      </tr>
      <tr>
        <td id="L12641" data-line-number="12641"></td>
        <td id="LC12641">    <span>if</span> (<span>CORProfilerTrackTransitions</span>())</td>
      </tr>
      <tr>
        <td id="L12642" data-line-number="12642"></td>
        <td id="LC12642">        flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_PROF_NO_PINVOKE_INLINE);</td>
      </tr>
      <tr>
        <td id="L12643" data-line-number="12643"></td>
        <td id="LC12643">#<span>endif</span> <span><span>//</span> PROFILING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L12644" data-line-number="12644"></td>
        <td id="LC12644">
</td>
      </tr>
      <tr>
        <td id="L12645" data-line-number="12645"></td>
        <td id="LC12645">    <span><span>//</span> Set optimization flags</span></td>
      </tr>
      <tr>
        <td id="L12646" data-line-number="12646"></td>
        <td id="LC12646">    <span>if</span> (!flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_MIN_OPT))</td>
      </tr>
      <tr>
        <td id="L12647" data-line-number="12647"></td>
        <td id="LC12647">    {</td>
      </tr>
      <tr>
        <td id="L12648" data-line-number="12648"></td>
        <td id="LC12648">        <span>unsigned</span> optType = g_pConfig-&gt;<span>GenOptimizeType</span>();</td>
      </tr>
      <tr>
        <td id="L12649" data-line-number="12649"></td>
        <td id="LC12649">        <span>_ASSERTE</span>(optType &lt;= OPT_RANDOM);</td>
      </tr>
      <tr>
        <td id="L12650" data-line-number="12650"></td>
        <td id="LC12650">
</td>
      </tr>
      <tr>
        <td id="L12651" data-line-number="12651"></td>
        <td id="LC12651">        <span>if</span> (optType == OPT_RANDOM)</td>
      </tr>
      <tr>
        <td id="L12652" data-line-number="12652"></td>
        <td id="LC12652">            optType = methodInfo-&gt;<span>ILCodeSize</span> % OPT_RANDOM;</td>
      </tr>
      <tr>
        <td id="L12653" data-line-number="12653"></td>
        <td id="LC12653">
</td>
      </tr>
      <tr>
        <td id="L12654" data-line-number="12654"></td>
        <td id="LC12654">        <span>if</span> (g_pConfig-&gt;<span>JitMinOpts</span>())</td>
      </tr>
      <tr>
        <td id="L12655" data-line-number="12655"></td>
        <td id="LC12655">            flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_MIN_OPT);</td>
      </tr>
      <tr>
        <td id="L12656" data-line-number="12656"></td>
        <td id="LC12656">
</td>
      </tr>
      <tr>
        <td id="L12657" data-line-number="12657"></td>
        <td id="LC12657">        <span>if</span> (optType == OPT_SIZE)</td>
      </tr>
      <tr>
        <td id="L12658" data-line-number="12658"></td>
        <td id="LC12658">        {</td>
      </tr>
      <tr>
        <td id="L12659" data-line-number="12659"></td>
        <td id="LC12659">            flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_SIZE_OPT);</td>
      </tr>
      <tr>
        <td id="L12660" data-line-number="12660"></td>
        <td id="LC12660">        }</td>
      </tr>
      <tr>
        <td id="L12661" data-line-number="12661"></td>
        <td id="LC12661">        <span>else</span> <span>if</span> (optType == OPT_SPEED)</td>
      </tr>
      <tr>
        <td id="L12662" data-line-number="12662"></td>
        <td id="LC12662">        {</td>
      </tr>
      <tr>
        <td id="L12663" data-line-number="12663"></td>
        <td id="LC12663">            flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_SPEED_OPT);</td>
      </tr>
      <tr>
        <td id="L12664" data-line-number="12664"></td>
        <td id="LC12664">        }</td>
      </tr>
      <tr>
        <td id="L12665" data-line-number="12665"></td>
        <td id="LC12665">    }</td>
      </tr>
      <tr>
        <td id="L12666" data-line-number="12666"></td>
        <td id="LC12666">
</td>
      </tr>
      <tr>
        <td id="L12667" data-line-number="12667"></td>
        <td id="LC12667">    flags.<span>Set</span>(CORJIT_FLAGS::CORJIT_FLAG_SKIP_VERIFICATION);</td>
      </tr>
      <tr>
        <td id="L12668" data-line-number="12668"></td>
        <td id="LC12668">
</td>
      </tr>
      <tr>
        <td id="L12669" data-line-number="12669"></td>
        <td id="LC12669">    <span>if</span> (ftn-&gt;<span>IsILStub</span>() &amp;&amp; !g_pConfig-&gt;<span>GetTrackDynamicMethodDebugInfo</span>())</td>
      </tr>
      <tr>
        <td id="L12670" data-line-number="12670"></td>
        <td id="LC12670">    {</td>
      </tr>
      <tr>
        <td id="L12671" data-line-number="12671"></td>
        <td id="LC12671">        <span><span>//</span> no debug info available for IL stubs</span></td>
      </tr>
      <tr>
        <td id="L12672" data-line-number="12672"></td>
        <td id="LC12672">        flags.<span>Clear</span>(CORJIT_FLAGS::CORJIT_FLAG_DEBUG_INFO);</td>
      </tr>
      <tr>
        <td id="L12673" data-line-number="12673"></td>
        <td id="LC12673">    }</td>
      </tr>
      <tr>
        <td id="L12674" data-line-number="12674"></td>
        <td id="LC12674">
</td>
      </tr>
      <tr>
        <td id="L12675" data-line-number="12675"></td>
        <td id="LC12675">    <span>return</span> flags;</td>
      </tr>
      <tr>
        <td id="L12676" data-line-number="12676"></td>
        <td id="LC12676">}</td>
      </tr>
      <tr>
        <td id="L12677" data-line-number="12677"></td>
        <td id="LC12677">
</td>
      </tr>
      <tr>
        <td id="L12678" data-line-number="12678"></td>
        <td id="LC12678"><span><span>//</span> ********************************************************************</span></td>
      </tr>
      <tr>
        <td id="L12679" data-line-number="12679"></td>
        <td id="LC12679">
</td>
      </tr>
      <tr>
        <td id="L12680" data-line-number="12680"></td>
        <td id="LC12680"><span><span>//</span> Throw the right type of exception for the given JIT result</span></td>
      </tr>
      <tr>
        <td id="L12681" data-line-number="12681"></td>
        <td id="LC12681">
</td>
      </tr>
      <tr>
        <td id="L12682" data-line-number="12682"></td>
        <td id="LC12682"><span>void</span> <span>ThrowExceptionForJit</span>(HRESULT res)</td>
      </tr>
      <tr>
        <td id="L12683" data-line-number="12683"></td>
        <td id="LC12683">{</td>
      </tr>
      <tr>
        <td id="L12684" data-line-number="12684"></td>
        <td id="LC12684">    CONTRACTL</td>
      </tr>
      <tr>
        <td id="L12685" data-line-number="12685"></td>
        <td id="LC12685">    {</td>
      </tr>
      <tr>
        <td id="L12686" data-line-number="12686"></td>
        <td id="LC12686">        THROWS;</td>
      </tr>
      <tr>
        <td id="L12687" data-line-number="12687"></td>
        <td id="LC12687">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L12688" data-line-number="12688"></td>
        <td id="LC12688">        MODE_ANY;</td>
      </tr>
      <tr>
        <td id="L12689" data-line-number="12689"></td>
        <td id="LC12689">    }</td>
      </tr>
      <tr>
        <td id="L12690" data-line-number="12690"></td>
        <td id="LC12690">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L12691" data-line-number="12691"></td>
        <td id="LC12691">    <span>switch</span> (res)</td>
      </tr>
      <tr>
        <td id="L12692" data-line-number="12692"></td>
        <td id="LC12692">    {</td>
      </tr>
      <tr>
        <td id="L12693" data-line-number="12693"></td>
        <td id="LC12693">        <span>case</span> CORJIT_OUTOFMEM:</td>
      </tr>
      <tr>
        <td id="L12694" data-line-number="12694"></td>
        <td id="LC12694">            <span>COMPlusThrowOM</span>();</td>
      </tr>
      <tr>
        <td id="L12695" data-line-number="12695"></td>
        <td id="LC12695">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L12696" data-line-number="12696"></td>
        <td id="LC12696">
</td>
      </tr>
      <tr>
        <td id="L12697" data-line-number="12697"></td>
        <td id="LC12697">        <span>case</span> CORJIT_INTERNALERROR:</td>
      </tr>
      <tr>
        <td id="L12698" data-line-number="12698"></td>
        <td id="LC12698">            <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>, (UINT) IDS_EE_JIT_COMPILER_ERROR);</td>
      </tr>
      <tr>
        <td id="L12699" data-line-number="12699"></td>
        <td id="LC12699">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L12700" data-line-number="12700"></td>
        <td id="LC12700">
</td>
      </tr>
      <tr>
        <td id="L12701" data-line-number="12701"></td>
        <td id="LC12701">        <span>case</span> CORJIT_BADCODE:</td>
      </tr>
      <tr>
        <td id="L12702" data-line-number="12702"></td>
        <td id="LC12702">        <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L12703" data-line-number="12703"></td>
        <td id="LC12703">            <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>);</td>
      </tr>
      <tr>
        <td id="L12704" data-line-number="12704"></td>
        <td id="LC12704">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L12705" data-line-number="12705"></td>
        <td id="LC12705">    }</td>
      </tr>
      <tr>
        <td id="L12706" data-line-number="12706"></td>
        <td id="LC12706"> }</td>
      </tr>
      <tr>
        <td id="L12707" data-line-number="12707"></td>
        <td id="LC12707">
</td>
      </tr>
      <tr>
        <td id="L12708" data-line-number="12708"></td>
        <td id="LC12708"><span><span>//</span> ********************************************************************</span></td>
      </tr>
      <tr>
        <td id="L12709" data-line-number="12709"></td>
        <td id="LC12709">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L12710" data-line-number="12710"></td>
        <td id="LC12710">LONG g_JitCount = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L12711" data-line-number="12711"></td>
        <td id="LC12711">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12712" data-line-number="12712"></td>
        <td id="LC12712">
</td>
      </tr>
      <tr>
        <td id="L12713" data-line-number="12713"></td>
        <td id="LC12713"><span><span>//</span>#define PERF_TRACK_METHOD_JITTIMES</span></td>
      </tr>
      <tr>
        <td id="L12714" data-line-number="12714"></td>
        <td id="LC12714">#<span>ifdef</span> TARGET_AMD64</td>
      </tr>
      <tr>
        <td id="L12715" data-line-number="12715"></td>
        <td id="LC12715">BOOL g_fAllowRel32 = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L12716" data-line-number="12716"></td>
        <td id="LC12716">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12717" data-line-number="12717"></td>
        <td id="LC12717">
</td>
      </tr>
      <tr>
        <td id="L12718" data-line-number="12718"></td>
        <td id="LC12718">
</td>
      </tr>
      <tr>
        <td id="L12719" data-line-number="12719"></td>
        <td id="LC12719"><span><span>//</span> ********************************************************************</span></td>
      </tr>
      <tr>
        <td id="L12720" data-line-number="12720"></td>
        <td id="LC12720"><span><span>//</span>                  README!!</span></td>
      </tr>
      <tr>
        <td id="L12721" data-line-number="12721"></td>
        <td id="LC12721"><span><span>//</span> ********************************************************************</span></td>
      </tr>
      <tr>
        <td id="L12722" data-line-number="12722"></td>
        <td id="LC12722">
</td>
      </tr>
      <tr>
        <td id="L12723" data-line-number="12723"></td>
        <td id="LC12723"><span><span>//</span> The reason that this is named UnsafeJitFunction is that this helper</span></td>
      </tr>
      <tr>
        <td id="L12724" data-line-number="12724"></td>
        <td id="LC12724"><span><span>//</span> method is not thread safe!  When multiple threads get in here for</span></td>
      </tr>
      <tr>
        <td id="L12725" data-line-number="12725"></td>
        <td id="LC12725"><span><span>//</span> the same pMD, ALL of them MUST return the SAME value.</span></td>
      </tr>
      <tr>
        <td id="L12726" data-line-number="12726"></td>
        <td id="LC12726"><span><span>//</span> To insure that this happens you must call MakeJitWorker.</span></td>
      </tr>
      <tr>
        <td id="L12727" data-line-number="12727"></td>
        <td id="LC12727"><span><span>//</span> It creates a DeadlockAware list of methods being jitted and prevents us</span></td>
      </tr>
      <tr>
        <td id="L12728" data-line-number="12728"></td>
        <td id="LC12728"><span><span>//</span> from trying to jit the same method more that once.</span></td>
      </tr>
      <tr>
        <td id="L12729" data-line-number="12729"></td>
        <td id="LC12729"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L12730" data-line-number="12730"></td>
        <td id="LC12730"><span><span>//</span> Calls to this method that occur to check if inlining can occur on x86,</span></td>
      </tr>
      <tr>
        <td id="L12731" data-line-number="12731"></td>
        <td id="LC12731"><span><span>//</span> are OK since they discard the return value of this method.</span></td>
      </tr>
      <tr>
        <td id="L12732" data-line-number="12732"></td>
        <td id="LC12732">
</td>
      </tr>
      <tr>
        <td id="L12733" data-line-number="12733"></td>
        <td id="LC12733">PCODE <span>UnsafeJitFunction</span>(NativeCodeVersion nativeCodeVersion, COR_ILMETHOD_DECODER* ILHeader, CORJIT_FLAGS flags,</td>
      </tr>
      <tr>
        <td id="L12734" data-line-number="12734"></td>
        <td id="LC12734">                        ULONG * pSizeOfCode)</td>
      </tr>
      <tr>
        <td id="L12735" data-line-number="12735"></td>
        <td id="LC12735">{</td>
      </tr>
      <tr>
        <td id="L12736" data-line-number="12736"></td>
        <td id="LC12736">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L12737" data-line-number="12737"></td>
        <td id="LC12737">
</td>
      </tr>
      <tr>
        <td id="L12738" data-line-number="12738"></td>
        <td id="LC12738">    MethodDesc* ftn = nativeCodeVersion.<span>GetMethodDesc</span>();</td>
      </tr>
      <tr>
        <td id="L12739" data-line-number="12739"></td>
        <td id="LC12739">
</td>
      </tr>
      <tr>
        <td id="L12740" data-line-number="12740"></td>
        <td id="LC12740">    PCODE ret = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L12741" data-line-number="12741"></td>
        <td id="LC12741">
</td>
      </tr>
      <tr>
        <td id="L12742" data-line-number="12742"></td>
        <td id="LC12742">    <span>COOPERATIVE_TRANSITION_BEGIN</span>();</td>
      </tr>
      <tr>
        <td id="L12743" data-line-number="12743"></td>
        <td id="LC12743">
</td>
      </tr>
      <tr>
        <td id="L12744" data-line-number="12744"></td>
        <td id="LC12744">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L12745" data-line-number="12745"></td>
        <td id="LC12745">
</td>
      </tr>
      <tr>
        <td id="L12746" data-line-number="12746"></td>
        <td id="LC12746">    <span>if</span> (g_pConfig-&gt;<span>RequireZaps</span>() == EEConfig::REQUIRE_ZAPS_ALL &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12747" data-line-number="12747"></td>
        <td id="LC12747">        ftn-&gt;<span>GetModule</span>()-&gt;<span>GetDomainFile</span>()-&gt;<span>IsZapRequired</span>() &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12748" data-line-number="12748"></td>
        <td id="LC12748">        <span>PartialNGenStressPercentage</span>() == <span>0</span> &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12749" data-line-number="12749"></td>
        <td id="LC12749">#<span>ifdef</span> FEATURE_STACK_SAMPLING</td>
      </tr>
      <tr>
        <td id="L12750" data-line-number="12750"></td>
        <td id="LC12750">        !flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_SAMPLING_JIT_BACKGROUND) &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12751" data-line-number="12751"></td>
        <td id="LC12751">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12752" data-line-number="12752"></td>
        <td id="LC12752">        !flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY))</td>
      </tr>
      <tr>
        <td id="L12753" data-line-number="12753"></td>
        <td id="LC12753">    {</td>
      </tr>
      <tr>
        <td id="L12754" data-line-number="12754"></td>
        <td id="LC12754">        StackSString <span>ss</span>(SString::Ascii, <span><span>"</span>ZapRequire: JIT compiler invoked for <span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L12755" data-line-number="12755"></td>
        <td id="LC12755">        <span>TypeString::AppendMethodInternal</span>(ss, ftn);</td>
      </tr>
      <tr>
        <td id="L12756" data-line-number="12756"></td>
        <td id="LC12756">
</td>
      </tr>
      <tr>
        <td id="L12757" data-line-number="12757"></td>
        <td id="LC12757">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L12758" data-line-number="12758"></td>
        <td id="LC12758">        <span><span>//</span> Assert as some test may not check their error codes well. So throwing an</span></td>
      </tr>
      <tr>
        <td id="L12759" data-line-number="12759"></td>
        <td id="LC12759">        <span><span>//</span> exception may not cause a test failure (as it should).</span></td>
      </tr>
      <tr>
        <td id="L12760" data-line-number="12760"></td>
        <td id="LC12760">        StackScratchBuffer scratch;</td>
      </tr>
      <tr>
        <td id="L12761" data-line-number="12761"></td>
        <td id="LC12761">        <span>DbgAssertDialog</span>(__FILE__, __LINE__, (<span>char</span>*)ss.<span>GetUTF8</span>(scratch));</td>
      </tr>
      <tr>
        <td id="L12762" data-line-number="12762"></td>
        <td id="LC12762">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L12763" data-line-number="12763"></td>
        <td id="LC12763">
</td>
      </tr>
      <tr>
        <td id="L12764" data-line-number="12764"></td>
        <td id="LC12764">        <span>COMPlusThrowNonLocalized</span>(<span>kFileNotFoundException</span>, ss.<span>GetUnicode</span>());</td>
      </tr>
      <tr>
        <td id="L12765" data-line-number="12765"></td>
        <td id="LC12765">    }</td>
      </tr>
      <tr>
        <td id="L12766" data-line-number="12766"></td>
        <td id="LC12766">
</td>
      </tr>
      <tr>
        <td id="L12767" data-line-number="12767"></td>
        <td id="LC12767">#<span>endif</span> <span><span>//</span> FEATURE_PREJIT</span></td>
      </tr>
      <tr>
        <td id="L12768" data-line-number="12768"></td>
        <td id="LC12768">
</td>
      </tr>
      <tr>
        <td id="L12769" data-line-number="12769"></td>
        <td id="LC12769">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L12770" data-line-number="12770"></td>
        <td id="LC12770">    EEJitManager *jitMgr = <span>ExecutionManager::GetEEJitManager</span>();</td>
      </tr>
      <tr>
        <td id="L12771" data-line-number="12771"></td>
        <td id="LC12771">    <span>if</span> (!jitMgr-&gt;<span>LoadJIT</span>())</td>
      </tr>
      <tr>
        <td id="L12772" data-line-number="12772"></td>
        <td id="LC12772">    {</td>
      </tr>
      <tr>
        <td id="L12773" data-line-number="12773"></td>
        <td id="LC12773">#<span>ifdef</span> ALLOW_SXS_JIT</td>
      </tr>
      <tr>
        <td id="L12774" data-line-number="12774"></td>
        <td id="LC12774">        <span>if</span> (!jitMgr-&gt;<span>IsMainJitLoaded</span>())</td>
      </tr>
      <tr>
        <td id="L12775" data-line-number="12775"></td>
        <td id="LC12775">        {</td>
      </tr>
      <tr>
        <td id="L12776" data-line-number="12776"></td>
        <td id="LC12776">            <span><span>//</span> Don't want to throw InvalidProgram from here.</span></td>
      </tr>
      <tr>
        <td id="L12777" data-line-number="12777"></td>
        <td id="LC12777">            <span>EEPOLICY_HANDLE_FATAL_ERROR_WITH_MESSAGE</span>(COR_E_EXECUTIONENGINE, <span>W</span>(<span><span>"</span>Failed to load JIT compiler<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L12778" data-line-number="12778"></td>
        <td id="LC12778">        }</td>
      </tr>
      <tr>
        <td id="L12779" data-line-number="12779"></td>
        <td id="LC12779">        <span>if</span> (!jitMgr-&gt;<span>IsAltJitLoaded</span>())</td>
      </tr>
      <tr>
        <td id="L12780" data-line-number="12780"></td>
        <td id="LC12780">        {</td>
      </tr>
      <tr>
        <td id="L12781" data-line-number="12781"></td>
        <td id="LC12781">            <span><span>//</span> Don't want to throw InvalidProgram from here.</span></td>
      </tr>
      <tr>
        <td id="L12782" data-line-number="12782"></td>
        <td id="LC12782">            <span>EEPOLICY_HANDLE_FATAL_ERROR_WITH_MESSAGE</span>(COR_E_EXECUTIONENGINE, <span>W</span>(<span><span>"</span>Failed to load alternative JIT compiler<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L12783" data-line-number="12783"></td>
        <td id="LC12783">        }</td>
      </tr>
      <tr>
        <td id="L12784" data-line-number="12784"></td>
        <td id="LC12784">#<span>else</span> <span><span>//</span> ALLOW_SXS_JIT</span></td>
      </tr>
      <tr>
        <td id="L12785" data-line-number="12785"></td>
        <td id="LC12785">        <span><span>//</span> Don't want to throw InvalidProgram from here.</span></td>
      </tr>
      <tr>
        <td id="L12786" data-line-number="12786"></td>
        <td id="LC12786">        <span>EEPOLICY_HANDLE_FATAL_ERROR_WITH_MESSAGE</span>(COR_E_EXECUTIONENGINE, <span>W</span>(<span><span>"</span>Failed to load JIT compiler<span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L12787" data-line-number="12787"></td>
        <td id="LC12787">#<span>endif</span> <span><span>//</span> ALLOW_SXS_JIT</span></td>
      </tr>
      <tr>
        <td id="L12788" data-line-number="12788"></td>
        <td id="LC12788">    }</td>
      </tr>
      <tr>
        <td id="L12789" data-line-number="12789"></td>
        <td id="LC12789">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L12790" data-line-number="12790"></td>
        <td id="LC12790">
</td>
      </tr>
      <tr>
        <td id="L12791" data-line-number="12791"></td>
        <td id="LC12791">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L12792" data-line-number="12792"></td>
        <td id="LC12792">    <span><span>//</span> This is here so we can see the name and class easily in the debugger</span></td>
      </tr>
      <tr>
        <td id="L12793" data-line-number="12793"></td>
        <td id="LC12793">
</td>
      </tr>
      <tr>
        <td id="L12794" data-line-number="12794"></td>
        <td id="LC12794">    LPCUTF8 cls  = ftn-&gt;<span>GetMethodTable</span>()-&gt;<span>GetDebugClassName</span>();</td>
      </tr>
      <tr>
        <td id="L12795" data-line-number="12795"></td>
        <td id="LC12795">    LPCUTF8 name = ftn-&gt;<span>GetName</span>();</td>
      </tr>
      <tr>
        <td id="L12796" data-line-number="12796"></td>
        <td id="LC12796">
</td>
      </tr>
      <tr>
        <td id="L12797" data-line-number="12797"></td>
        <td id="LC12797">    <span>if</span> (ftn-&gt;<span>IsNoMetadata</span>())</td>
      </tr>
      <tr>
        <td id="L12798" data-line-number="12798"></td>
        <td id="LC12798">    {</td>
      </tr>
      <tr>
        <td id="L12799" data-line-number="12799"></td>
        <td id="LC12799">        <span>if</span> (ftn-&gt;<span>IsILStub</span>())</td>
      </tr>
      <tr>
        <td id="L12800" data-line-number="12800"></td>
        <td id="LC12800">        {</td>
      </tr>
      <tr>
        <td id="L12801" data-line-number="12801"></td>
        <td id="LC12801">            <span>LOG</span>((LF_JIT, LL_INFO10000, <span><span>"</span>{ Jitting IL Stub }<span>\n</span><span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L12802" data-line-number="12802"></td>
        <td id="LC12802">        }</td>
      </tr>
      <tr>
        <td id="L12803" data-line-number="12803"></td>
        <td id="LC12803">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L12804" data-line-number="12804"></td>
        <td id="LC12804">        {</td>
      </tr>
      <tr>
        <td id="L12805" data-line-number="12805"></td>
        <td id="LC12805">            <span>LOG</span>((LF_JIT, LL_INFO10000, <span><span>"</span>{ Jitting dynamic method }<span>\n</span><span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L12806" data-line-number="12806"></td>
        <td id="LC12806">        }</td>
      </tr>
      <tr>
        <td id="L12807" data-line-number="12807"></td>
        <td id="LC12807">    }</td>
      </tr>
      <tr>
        <td id="L12808" data-line-number="12808"></td>
        <td id="LC12808">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L12809" data-line-number="12809"></td>
        <td id="LC12809">    {</td>
      </tr>
      <tr>
        <td id="L12810" data-line-number="12810"></td>
        <td id="LC12810">        SString methodString;</td>
      </tr>
      <tr>
        <td id="L12811" data-line-number="12811"></td>
        <td id="LC12811">        <span>if</span> (<span>LoggingOn</span>(LF_JIT, LL_INFO10000))</td>
      </tr>
      <tr>
        <td id="L12812" data-line-number="12812"></td>
        <td id="LC12812">            <span>TypeString::AppendMethodDebug</span>(methodString, ftn);</td>
      </tr>
      <tr>
        <td id="L12813" data-line-number="12813"></td>
        <td id="LC12813">
</td>
      </tr>
      <tr>
        <td id="L12814" data-line-number="12814"></td>
        <td id="LC12814">        <span>LOG</span>((LF_JIT, LL_INFO10000, <span><span>"</span>{ Jitting method (%p) %S %s<span>\n</span><span>"</span></span>, ftn, methodString.<span>GetUnicode</span>(), ftn-&gt;<span>m_pszDebugMethodSignature</span>));</td>
      </tr>
      <tr>
        <td id="L12815" data-line-number="12815"></td>
        <td id="LC12815">    }</td>
      </tr>
      <tr>
        <td id="L12816" data-line-number="12816"></td>
        <td id="LC12816">
</td>
      </tr>
      <tr>
        <td id="L12817" data-line-number="12817"></td>
        <td id="LC12817">#<span>if</span> <span>0</span></td>
      </tr>
      <tr>
        <td id="L12818" data-line-number="12818"></td>
        <td id="LC12818">    if (!SString::_stricmp(cls,"ENC") &amp;&amp;</td>
      </tr>
      <tr>
        <td id="L12819" data-line-number="12819"></td>
        <td id="LC12819">       (!SString::_stricmp(name,"G")))</td>
      </tr>
      <tr>
        <td id="L12820" data-line-number="12820"></td>
        <td id="LC12820">    {</td>
      </tr>
      <tr>
        <td id="L12821" data-line-number="12821"></td>
        <td id="LC12821">       static count = 0;</td>
      </tr>
      <tr>
        <td id="L12822" data-line-number="12822"></td>
        <td id="LC12822">       count++;</td>
      </tr>
      <tr>
        <td id="L12823" data-line-number="12823"></td>
        <td id="LC12823">       if (count &gt; 0)</td>
      </tr>
      <tr>
        <td id="L12824" data-line-number="12824"></td>
        <td id="LC12824">            DebugBreak();</td>
      </tr>
      <tr>
        <td id="L12825" data-line-number="12825"></td>
        <td id="LC12825">    }</td>
      </tr>
      <tr>
        <td id="L12826" data-line-number="12826"></td>
        <td id="LC12826">#<span>endif</span> <span><span>//</span> 0</span></td>
      </tr>
      <tr>
        <td id="L12827" data-line-number="12827"></td>
        <td id="LC12827">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L12828" data-line-number="12828"></td>
        <td id="LC12828">
</td>
      </tr>
      <tr>
        <td id="L12829" data-line-number="12829"></td>
        <td id="LC12829">    CORINFO_METHOD_HANDLE ftnHnd = (CORINFO_METHOD_HANDLE)ftn;</td>
      </tr>
      <tr>
        <td id="L12830" data-line-number="12830"></td>
        <td id="LC12830">    CORINFO_METHOD_INFO methodInfo;</td>
      </tr>
      <tr>
        <td id="L12831" data-line-number="12831"></td>
        <td id="LC12831">
</td>
      </tr>
      <tr>
        <td id="L12832" data-line-number="12832"></td>
        <td id="LC12832">    <span>getMethodInfoHelper</span>(ftn, ftnHnd, ILHeader, &amp;methodInfo);</td>
      </tr>
      <tr>
        <td id="L12833" data-line-number="12833"></td>
        <td id="LC12833">
</td>
      </tr>
      <tr>
        <td id="L12834" data-line-number="12834"></td>
        <td id="LC12834">    <span><span>//</span> If it's generic then we can only enter through an instantiated md (unless we're just verifying it)</span></td>
      </tr>
      <tr>
        <td id="L12835" data-line-number="12835"></td>
        <td id="LC12835">    <span>_ASSERTE</span>(flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY) || !ftn-&gt;<span>IsGenericMethodDefinition</span>());</td>
      </tr>
      <tr>
        <td id="L12836" data-line-number="12836"></td>
        <td id="LC12836">
</td>
      </tr>
      <tr>
        <td id="L12837" data-line-number="12837"></td>
        <td id="LC12837">    <span><span>//</span> If it's an instance method then it must not be entered from a generic class</span></td>
      </tr>
      <tr>
        <td id="L12838" data-line-number="12838"></td>
        <td id="LC12838">    <span>_ASSERTE</span>(flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY) || ftn-&gt;<span>IsStatic</span>() ||</td>
      </tr>
      <tr>
        <td id="L12839" data-line-number="12839"></td>
        <td id="LC12839">             ftn-&gt;<span>GetNumGenericClassArgs</span>() == <span>0</span> || ftn-&gt;<span>HasClassInstantiation</span>());</td>
      </tr>
      <tr>
        <td id="L12840" data-line-number="12840"></td>
        <td id="LC12840">
</td>
      </tr>
      <tr>
        <td id="L12841" data-line-number="12841"></td>
        <td id="LC12841">    <span><span>//</span> method attributes and signature are consistant</span></td>
      </tr>
      <tr>
        <td id="L12842" data-line-number="12842"></td>
        <td id="LC12842">    <span>_ASSERTE</span>(!!ftn-&gt;<span>IsStatic</span>() == ((methodInfo.<span>args</span>.<span>callConv</span> &amp; CORINFO_CALLCONV_HASTHIS) == <span>0</span>));</td>
      </tr>
      <tr>
        <td id="L12843" data-line-number="12843"></td>
        <td id="LC12843">
</td>
      </tr>
      <tr>
        <td id="L12844" data-line-number="12844"></td>
        <td id="LC12844">    flags = <span>GetCompileFlags</span>(ftn, flags, &amp;methodInfo);</td>
      </tr>
      <tr>
        <td id="L12845" data-line-number="12845"></td>
        <td id="LC12845">
</td>
      </tr>
      <tr>
        <td id="L12846" data-line-number="12846"></td>
        <td id="LC12846">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L12847" data-line-number="12847"></td>
        <td id="LC12847">    <span>if</span> (!flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_SKIP_VERIFICATION))</td>
      </tr>
      <tr>
        <td id="L12848" data-line-number="12848"></td>
        <td id="LC12848">    {</td>
      </tr>
      <tr>
        <td id="L12849" data-line-number="12849"></td>
        <td id="LC12849">        SString methodString;</td>
      </tr>
      <tr>
        <td id="L12850" data-line-number="12850"></td>
        <td id="LC12850">        <span>if</span> (<span>LoggingOn</span>(LF_VERIFIER, LL_INFO100))</td>
      </tr>
      <tr>
        <td id="L12851" data-line-number="12851"></td>
        <td id="LC12851">            <span>TypeString::AppendMethodDebug</span>(methodString, ftn);</td>
      </tr>
      <tr>
        <td id="L12852" data-line-number="12852"></td>
        <td id="LC12852">
</td>
      </tr>
      <tr>
        <td id="L12853" data-line-number="12853"></td>
        <td id="LC12853">        <span>LOG</span>((LF_VERIFIER, LL_INFO100, <span><span>"</span>{ Will verify method (%p) %S %s<span>\n</span><span>"</span></span>, ftn, methodString.<span>GetUnicode</span>(), ftn-&gt;<span>m_pszDebugMethodSignature</span>));</td>
      </tr>
      <tr>
        <td id="L12854" data-line-number="12854"></td>
        <td id="LC12854">    }</td>
      </tr>
      <tr>
        <td id="L12855" data-line-number="12855"></td>
        <td id="LC12855">#<span>endif</span> <span><span>//</span>_DEBUG</span></td>
      </tr>
      <tr>
        <td id="L12856" data-line-number="12856"></td>
        <td id="LC12856">
</td>
      </tr>
      <tr>
        <td id="L12857" data-line-number="12857"></td>
        <td id="LC12857">#<span>if</span> defined(TARGET_AMD64) || defined(TARGET_ARM64)</td>
      </tr>
      <tr>
        <td id="L12858" data-line-number="12858"></td>
        <td id="LC12858">    BOOL <span>fForceJumpStubOverflow</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L12859" data-line-number="12859"></td>
        <td id="LC12859">
</td>
      </tr>
      <tr>
        <td id="L12860" data-line-number="12860"></td>
        <td id="LC12860">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L12861" data-line-number="12861"></td>
        <td id="LC12861">    <span><span>//</span> Always exercise the overflow codepath with force relocs</span></td>
      </tr>
      <tr>
        <td id="L12862" data-line-number="12862"></td>
        <td id="LC12862">    <span>if</span> (<span>PEDecoder::GetForceRelocs</span>())</td>
      </tr>
      <tr>
        <td id="L12863" data-line-number="12863"></td>
        <td id="LC12863">        <span>fForceJumpStubOverflow</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L12864" data-line-number="12864"></td>
        <td id="LC12864">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12865" data-line-number="12865"></td>
        <td id="LC12865">
</td>
      </tr>
      <tr>
        <td id="L12866" data-line-number="12866"></td>
        <td id="LC12866">#<span>if</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L12867" data-line-number="12867"></td>
        <td id="LC12867">    BOOL <span>fAllowRel32</span> = (g_fAllowRel32 | <span>fForceJumpStubOverflow</span>);</td>
      </tr>
      <tr>
        <td id="L12868" data-line-number="12868"></td>
        <td id="LC12868">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12869" data-line-number="12869"></td>
        <td id="LC12869">
</td>
      </tr>
      <tr>
        <td id="L12870" data-line-number="12870"></td>
        <td id="LC12870">    <span>size_t</span> reserveForJumpStubs = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L12871" data-line-number="12871"></td>
        <td id="LC12871">
</td>
      </tr>
      <tr>
        <td id="L12872" data-line-number="12872"></td>
        <td id="LC12872">#<span>endif</span> <span><span>//</span> defined(TARGET_AMD64) || defined(TARGET_ARM64)</span></td>
      </tr>
      <tr>
        <td id="L12873" data-line-number="12873"></td>
        <td id="LC12873">
</td>
      </tr>
      <tr>
        <td id="L12874" data-line-number="12874"></td>
        <td id="LC12874">    <span>for</span> (;;)</td>
      </tr>
      <tr>
        <td id="L12875" data-line-number="12875"></td>
        <td id="LC12875">    {</td>
      </tr>
      <tr>
        <td id="L12876" data-line-number="12876"></td>
        <td id="LC12876">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L12877" data-line-number="12877"></td>
        <td id="LC12877">        CEEJitInfo <span>jitInfo</span>(ftn, ILHeader, jitMgr, flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY),</td>
      </tr>
      <tr>
        <td id="L12878" data-line-number="12878"></td>
        <td id="LC12878">            !flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_NO_INLINING));</td>
      </tr>
      <tr>
        <td id="L12879" data-line-number="12879"></td>
        <td id="LC12879">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L12880" data-line-number="12880"></td>
        <td id="LC12880">        <span><span>//</span> This path should be only ever used for verification in crossgen and so we should not need EEJitManager</span></td>
      </tr>
      <tr>
        <td id="L12881" data-line-number="12881"></td>
        <td id="LC12881">        <span>_ASSERTE</span>(flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY));</td>
      </tr>
      <tr>
        <td id="L12882" data-line-number="12882"></td>
        <td id="LC12882">        CEEInfo <span>jitInfo</span>(ftn, <span>true</span>);</td>
      </tr>
      <tr>
        <td id="L12883" data-line-number="12883"></td>
        <td id="LC12883">        EEJitManager *jitMgr = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L12884" data-line-number="12884"></td>
        <td id="LC12884">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12885" data-line-number="12885"></td>
        <td id="LC12885">
</td>
      </tr>
      <tr>
        <td id="L12886" data-line-number="12886"></td>
        <td id="LC12886">#<span>if</span> (defined(TARGET_AMD64) || defined(TARGET_ARM64)) &amp;&amp; !defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L12887" data-line-number="12887"></td>
        <td id="LC12887">#<span>ifdef</span> TARGET_AMD64</td>
      </tr>
      <tr>
        <td id="L12888" data-line-number="12888"></td>
        <td id="LC12888">        <span>if</span> (<span>fForceJumpStubOverflow</span>)</td>
      </tr>
      <tr>
        <td id="L12889" data-line-number="12889"></td>
        <td id="LC12889">            jitInfo.<span>SetJumpStubOverflow</span>(<span>fAllowRel32</span>);</td>
      </tr>
      <tr>
        <td id="L12890" data-line-number="12890"></td>
        <td id="LC12890">        jitInfo.<span>SetAllowRel32</span>(<span>fAllowRel32</span>);</td>
      </tr>
      <tr>
        <td id="L12891" data-line-number="12891"></td>
        <td id="LC12891">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L12892" data-line-number="12892"></td>
        <td id="LC12892">        <span>if</span> (<span>fForceJumpStubOverflow</span>)</td>
      </tr>
      <tr>
        <td id="L12893" data-line-number="12893"></td>
        <td id="LC12893">            jitInfo.<span>SetJumpStubOverflow</span>(<span>fForceJumpStubOverflow</span>);</td>
      </tr>
      <tr>
        <td id="L12894" data-line-number="12894"></td>
        <td id="LC12894">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12895" data-line-number="12895"></td>
        <td id="LC12895">        jitInfo.<span>SetReserveForJumpStubs</span>(reserveForJumpStubs);</td>
      </tr>
      <tr>
        <td id="L12896" data-line-number="12896"></td>
        <td id="LC12896">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12897" data-line-number="12897"></td>
        <td id="LC12897">
</td>
      </tr>
      <tr>
        <td id="L12898" data-line-number="12898"></td>
        <td id="LC12898">        MethodDesc * pMethodForSecurity = jitInfo.<span>GetMethodForSecurity</span>(ftnHnd);</td>
      </tr>
      <tr>
        <td id="L12899" data-line-number="12899"></td>
        <td id="LC12899">
</td>
      </tr>
      <tr>
        <td id="L12900" data-line-number="12900"></td>
        <td id="LC12900">        <span><span>//</span>Since the check could trigger a demand, we have to do this every time.</span></td>
      </tr>
      <tr>
        <td id="L12901" data-line-number="12901"></td>
        <td id="LC12901">        <span><span>//</span>This is actually an overly complicated way to make sure that a method can access all its arguments</span></td>
      </tr>
      <tr>
        <td id="L12902" data-line-number="12902"></td>
        <td id="LC12902">        <span><span>//</span>and its return type.</span></td>
      </tr>
      <tr>
        <td id="L12903" data-line-number="12903"></td>
        <td id="LC12903">        AccessCheckOptions::AccessCheckType accessCheckType = AccessCheckOptions::<span>kNormalAccessibilityChecks</span>;</td>
      </tr>
      <tr>
        <td id="L12904" data-line-number="12904"></td>
        <td id="LC12904">        TypeHandle ownerTypeForSecurity = <span>TypeHandle</span>(pMethodForSecurity-&gt;<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L12905" data-line-number="12905"></td>
        <td id="LC12905">        DynamicResolver *pAccessContext = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L12906" data-line-number="12906"></td>
        <td id="LC12906">        BOOL doAccessCheck = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L12907" data-line-number="12907"></td>
        <td id="LC12907">        <span>if</span> (pMethodForSecurity-&gt;<span>IsDynamicMethod</span>())</td>
      </tr>
      <tr>
        <td id="L12908" data-line-number="12908"></td>
        <td id="LC12908">        {</td>
      </tr>
      <tr>
        <td id="L12909" data-line-number="12909"></td>
        <td id="LC12909">            doAccessCheck = <span>ModifyCheckForDynamicMethod</span>(pMethodForSecurity-&gt;<span>AsDynamicMethodDesc</span>()-&gt;<span>GetResolver</span>(),</td>
      </tr>
      <tr>
        <td id="L12910" data-line-number="12910"></td>
        <td id="LC12910">                                                        &amp;ownerTypeForSecurity,</td>
      </tr>
      <tr>
        <td id="L12911" data-line-number="12911"></td>
        <td id="LC12911">                                                        &amp;accessCheckType, &amp;pAccessContext);</td>
      </tr>
      <tr>
        <td id="L12912" data-line-number="12912"></td>
        <td id="LC12912">        }</td>
      </tr>
      <tr>
        <td id="L12913" data-line-number="12913"></td>
        <td id="LC12913">        <span>if</span> (doAccessCheck)</td>
      </tr>
      <tr>
        <td id="L12914" data-line-number="12914"></td>
        <td id="LC12914">        {</td>
      </tr>
      <tr>
        <td id="L12915" data-line-number="12915"></td>
        <td id="LC12915">            AccessCheckOptions <span>accessCheckOptions</span>(accessCheckType,</td>
      </tr>
      <tr>
        <td id="L12916" data-line-number="12916"></td>
        <td id="LC12916">                                                  pAccessContext,</td>
      </tr>
      <tr>
        <td id="L12917" data-line-number="12917"></td>
        <td id="LC12917">                                                  <span>TRUE</span> <span><span>/*</span>Throw on error<span>*/</span></span>,</td>
      </tr>
      <tr>
        <td id="L12918" data-line-number="12918"></td>
        <td id="LC12918">                                                  pMethodForSecurity);</td>
      </tr>
      <tr>
        <td id="L12919" data-line-number="12919"></td>
        <td id="LC12919">
</td>
      </tr>
      <tr>
        <td id="L12920" data-line-number="12920"></td>
        <td id="LC12920">            AccessCheckContext <span>accessContext</span>(pMethodForSecurity, ownerTypeForSecurity.<span>GetMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L12921" data-line-number="12921"></td>
        <td id="LC12921">
</td>
      </tr>
      <tr>
        <td id="L12922" data-line-number="12922"></td>
        <td id="LC12922">            <span><span>//</span> We now do an access check from pMethodForSecurity to pMethodForSecurity, its sole purpose is to</span></td>
      </tr>
      <tr>
        <td id="L12923" data-line-number="12923"></td>
        <td id="LC12923">            <span><span>//</span> verify that pMethodForSecurity/ownerTypeForSecurity has access to all its parameters.</span></td>
      </tr>
      <tr>
        <td id="L12924" data-line-number="12924"></td>
        <td id="LC12924">
</td>
      </tr>
      <tr>
        <td id="L12925" data-line-number="12925"></td>
        <td id="LC12925">            <span><span>//</span> ownerTypeForSecurity.GetMethodTable() can be null if the pMethodForSecurity is a DynamicMethod</span></td>
      </tr>
      <tr>
        <td id="L12926" data-line-number="12926"></td>
        <td id="LC12926">            <span><span>//</span> associated with a TypeDesc (Array, Ptr, Ref, or FnPtr). That doesn't make any sense, but we will</span></td>
      </tr>
      <tr>
        <td id="L12927" data-line-number="12927"></td>
        <td id="LC12927">            <span><span>//</span> just do an access check from a NULL context which means only public types are accessible.</span></td>
      </tr>
      <tr>
        <td id="L12928" data-line-number="12928"></td>
        <td id="LC12928">            <span>if</span> (!<span>ClassLoader::CanAccess</span>(&amp;accessContext,</td>
      </tr>
      <tr>
        <td id="L12929" data-line-number="12929"></td>
        <td id="LC12929">                                        ownerTypeForSecurity.<span>GetMethodTable</span>(),</td>
      </tr>
      <tr>
        <td id="L12930" data-line-number="12930"></td>
        <td id="LC12930">                                        ownerTypeForSecurity.<span>GetAssembly</span>(),</td>
      </tr>
      <tr>
        <td id="L12931" data-line-number="12931"></td>
        <td id="LC12931">                                        pMethodForSecurity-&gt;<span>GetAttrs</span>(),</td>
      </tr>
      <tr>
        <td id="L12932" data-line-number="12932"></td>
        <td id="LC12932">                                        pMethodForSecurity,</td>
      </tr>
      <tr>
        <td id="L12933" data-line-number="12933"></td>
        <td id="LC12933">                                        <span>NULL</span>,</td>
      </tr>
      <tr>
        <td id="L12934" data-line-number="12934"></td>
        <td id="LC12934">                                        accessCheckOptions))</td>
      </tr>
      <tr>
        <td id="L12935" data-line-number="12935"></td>
        <td id="LC12935">            {</td>
      </tr>
      <tr>
        <td id="L12936" data-line-number="12936"></td>
        <td id="LC12936">                <span>EX_THROW</span>(EEMethodException, (pMethodForSecurity));</td>
      </tr>
      <tr>
        <td id="L12937" data-line-number="12937"></td>
        <td id="LC12937">            }</td>
      </tr>
      <tr>
        <td id="L12938" data-line-number="12938"></td>
        <td id="LC12938">        }</td>
      </tr>
      <tr>
        <td id="L12939" data-line-number="12939"></td>
        <td id="LC12939">
</td>
      </tr>
      <tr>
        <td id="L12940" data-line-number="12940"></td>
        <td id="LC12940">        CorJitResult res;</td>
      </tr>
      <tr>
        <td id="L12941" data-line-number="12941"></td>
        <td id="LC12941">        PBYTE nativeEntry;</td>
      </tr>
      <tr>
        <td id="L12942" data-line-number="12942"></td>
        <td id="LC12942">        ULONG sizeOfCode;</td>
      </tr>
      <tr>
        <td id="L12943" data-line-number="12943"></td>
        <td id="LC12943">
</td>
      </tr>
      <tr>
        <td id="L12944" data-line-number="12944"></td>
        <td id="LC12944">        {</td>
      </tr>
      <tr>
        <td id="L12945" data-line-number="12945"></td>
        <td id="LC12945">            <span>GCX_COOP</span>();</td>
      </tr>
      <tr>
        <td id="L12946" data-line-number="12946"></td>
        <td id="LC12946">
</td>
      </tr>
      <tr>
        <td id="L12947" data-line-number="12947"></td>
        <td id="LC12947">            <span><span>/*</span> There is a double indirection to call compileMethod  - can we</span></td>
      </tr>
      <tr>
        <td id="L12948" data-line-number="12948"></td>
        <td id="LC12948"><span>               improve this with the new structure? <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L12949" data-line-number="12949"></td>
        <td id="LC12949">
</td>
      </tr>
      <tr>
        <td id="L12950" data-line-number="12950"></td>
        <td id="LC12950">#<span>ifdef</span> PERF_TRACK_METHOD_JITTIMES</td>
      </tr>
      <tr>
        <td id="L12951" data-line-number="12951"></td>
        <td id="LC12951">            <span><span>//</span>Because we're not calling QPC enough.  I'm not going to track times if we're just importing.</span></td>
      </tr>
      <tr>
        <td id="L12952" data-line-number="12952"></td>
        <td id="LC12952">            LARGE_INTEGER methodJitTimeStart = {<span>0</span>};</td>
      </tr>
      <tr>
        <td id="L12953" data-line-number="12953"></td>
        <td id="LC12953">            <span>if</span> (!flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY))</td>
      </tr>
      <tr>
        <td id="L12954" data-line-number="12954"></td>
        <td id="LC12954">                <span>QueryPerformanceCounter</span> (&amp;methodJitTimeStart);</td>
      </tr>
      <tr>
        <td id="L12955" data-line-number="12955"></td>
        <td id="LC12955">
</td>
      </tr>
      <tr>
        <td id="L12956" data-line-number="12956"></td>
        <td id="LC12956">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12957" data-line-number="12957"></td>
        <td id="LC12957">            <span><span>//</span> Note on debuggerTrackInfo arg: if we're only importing (ie, verifying/</span></td>
      </tr>
      <tr>
        <td id="L12958" data-line-number="12958"></td>
        <td id="LC12958">            <span><span>//</span> checking to make sure we could JIT, but not actually generating code (</span></td>
      </tr>
      <tr>
        <td id="L12959" data-line-number="12959"></td>
        <td id="LC12959">            <span><span>//</span> eg, for inlining), then DON'T TELL THE DEBUGGER about this.</span></td>
      </tr>
      <tr>
        <td id="L12960" data-line-number="12960"></td>
        <td id="LC12960">            res = <span>CallCompileMethodWithSEHWrapper</span>(jitMgr,</td>
      </tr>
      <tr>
        <td id="L12961" data-line-number="12961"></td>
        <td id="LC12961">                                                  &amp;jitInfo,</td>
      </tr>
      <tr>
        <td id="L12962" data-line-number="12962"></td>
        <td id="LC12962">                                                  &amp;methodInfo,</td>
      </tr>
      <tr>
        <td id="L12963" data-line-number="12963"></td>
        <td id="LC12963">                                                  flags,</td>
      </tr>
      <tr>
        <td id="L12964" data-line-number="12964"></td>
        <td id="LC12964">                                                  &amp;nativeEntry,</td>
      </tr>
      <tr>
        <td id="L12965" data-line-number="12965"></td>
        <td id="LC12965">                                                  &amp;sizeOfCode,</td>
      </tr>
      <tr>
        <td id="L12966" data-line-number="12966"></td>
        <td id="LC12966">                                                  nativeCodeVersion);</td>
      </tr>
      <tr>
        <td id="L12967" data-line-number="12967"></td>
        <td id="LC12967">            <span>LOG</span>((LF_CORDB, LL_EVERYTHING, <span><span>"</span>Got through CallCompile MethodWithSEHWrapper<span>\n</span><span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L12968" data-line-number="12968"></td>
        <td id="LC12968">
</td>
      </tr>
      <tr>
        <td id="L12969" data-line-number="12969"></td>
        <td id="LC12969">#<span>if</span> FEATURE_PERFMAP</td>
      </tr>
      <tr>
        <td id="L12970" data-line-number="12970"></td>
        <td id="LC12970">            <span><span>//</span> Save the code size so that it can be reported to the perfmap.</span></td>
      </tr>
      <tr>
        <td id="L12971" data-line-number="12971"></td>
        <td id="LC12971">            <span>if</span> (pSizeOfCode != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L12972" data-line-number="12972"></td>
        <td id="LC12972">            {</td>
      </tr>
      <tr>
        <td id="L12973" data-line-number="12973"></td>
        <td id="LC12973">                *pSizeOfCode = sizeOfCode;</td>
      </tr>
      <tr>
        <td id="L12974" data-line-number="12974"></td>
        <td id="LC12974">            }</td>
      </tr>
      <tr>
        <td id="L12975" data-line-number="12975"></td>
        <td id="LC12975">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L12976" data-line-number="12976"></td>
        <td id="LC12976">
</td>
      </tr>
      <tr>
        <td id="L12977" data-line-number="12977"></td>
        <td id="LC12977">#<span>ifdef</span> PERF_TRACK_METHOD_JITTIMES</td>
      </tr>
      <tr>
        <td id="L12978" data-line-number="12978"></td>
        <td id="LC12978">            <span><span>//</span>store the time in the string buffer.  Module name and token are unique enough.  Also, do not</span></td>
      </tr>
      <tr>
        <td id="L12979" data-line-number="12979"></td>
        <td id="LC12979">            <span><span>//</span>capture importing time, just actual compilation time.</span></td>
      </tr>
      <tr>
        <td id="L12980" data-line-number="12980"></td>
        <td id="LC12980">            <span>if</span> (!flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY))</td>
      </tr>
      <tr>
        <td id="L12981" data-line-number="12981"></td>
        <td id="LC12981">            {</td>
      </tr>
      <tr>
        <td id="L12982" data-line-number="12982"></td>
        <td id="LC12982">                LARGE_INTEGER methodJitTimeStop;</td>
      </tr>
      <tr>
        <td id="L12983" data-line-number="12983"></td>
        <td id="LC12983">                <span>QueryPerformanceCounter</span>(&amp;methodJitTimeStop);</td>
      </tr>
      <tr>
        <td id="L12984" data-line-number="12984"></td>
        <td id="LC12984">                SString codeBase;</td>
      </tr>
      <tr>
        <td id="L12985" data-line-number="12985"></td>
        <td id="LC12985">                ftn-&gt;<span>GetModule</span>()-&gt;<span>GetDomainFile</span>()-&gt;<span>GetFile</span>()-&gt;<span>GetCodeBaseOrName</span>(codeBase);</td>
      </tr>
      <tr>
        <td id="L12986" data-line-number="12986"></td>
        <td id="LC12986">                codeBase.<span>AppendPrintf</span>(<span>W</span>(<span><span>"</span>,0x%x,%d,%d<span>\n</span><span>"</span></span>),</td>
      </tr>
      <tr>
        <td id="L12987" data-line-number="12987"></td>
        <td id="LC12987">                                 <span><span>//</span>(const WCHAR *)codeBase, //module name</span></td>
      </tr>
      <tr>
        <td id="L12988" data-line-number="12988"></td>
        <td id="LC12988">                                 ftn-&gt;<span>GetMemberDef</span>(), <span><span>//</span>method token</span></td>
      </tr>
      <tr>
        <td id="L12989" data-line-number="12989"></td>
        <td id="LC12989">                                 (<span>unsigned</span>)(methodJitTimeStop.<span>QuadPart</span> - methodJitTimeStart.<span>QuadPart</span>), <span><span>//</span>cycle count</span></td>
      </tr>
      <tr>
        <td id="L12990" data-line-number="12990"></td>
        <td id="LC12990">                                 methodInfo.<span>ILCodeSize</span> <span><span>//</span>il size</span></td>
      </tr>
      <tr>
        <td id="L12991" data-line-number="12991"></td>
        <td id="LC12991">                                );</td>
      </tr>
      <tr>
        <td id="L12992" data-line-number="12992"></td>
        <td id="LC12992">                <span>WszOutputDebugString</span>((<span>const</span> WCHAR*)codeBase);</td>
      </tr>
      <tr>
        <td id="L12993" data-line-number="12993"></td>
        <td id="LC12993">            }</td>
      </tr>
      <tr>
        <td id="L12994" data-line-number="12994"></td>
        <td id="LC12994">#<span>endif</span> <span><span>//</span> PERF_TRACK_METHOD_JITTIMES</span></td>
      </tr>
      <tr>
        <td id="L12995" data-line-number="12995"></td>
        <td id="LC12995">
</td>
      </tr>
      <tr>
        <td id="L12996" data-line-number="12996"></td>
        <td id="LC12996">        }</td>
      </tr>
      <tr>
        <td id="L12997" data-line-number="12997"></td>
        <td id="LC12997">
</td>
      </tr>
      <tr>
        <td id="L12998" data-line-number="12998"></td>
        <td id="LC12998">        <span>LOG</span>((LF_JIT, LL_INFO10000, <span><span>"</span>Done Jitting method %s::%s  %s }<span>\n</span><span>"</span></span>,cls,name, ftn-&gt;<span>m_pszDebugMethodSignature</span>));</td>
      </tr>
      <tr>
        <td id="L12999" data-line-number="12999"></td>
        <td id="LC12999">
</td>
      </tr>
      <tr>
        <td id="L13000" data-line-number="13000"></td>
        <td id="LC13000">        <span>if</span> (!<span>SUCCEEDED</span>(res))</td>
      </tr>
      <tr>
        <td id="L13001" data-line-number="13001"></td>
        <td id="LC13001">        {</td>
      </tr>
      <tr>
        <td id="L13002" data-line-number="13002"></td>
        <td id="LC13002">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L13003" data-line-number="13003"></td>
        <td id="LC13003">            jitInfo.<span>BackoutJitData</span>(jitMgr);</td>
      </tr>
      <tr>
        <td id="L13004" data-line-number="13004"></td>
        <td id="LC13004">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13005" data-line-number="13005"></td>
        <td id="LC13005">
</td>
      </tr>
      <tr>
        <td id="L13006" data-line-number="13006"></td>
        <td id="LC13006">            <span>ThrowExceptionForJit</span>(res);</td>
      </tr>
      <tr>
        <td id="L13007" data-line-number="13007"></td>
        <td id="LC13007">        }</td>
      </tr>
      <tr>
        <td id="L13008" data-line-number="13008"></td>
        <td id="LC13008">
</td>
      </tr>
      <tr>
        <td id="L13009" data-line-number="13009"></td>
        <td id="LC13009">        <span>if</span> (flags.<span>IsSet</span>(CORJIT_FLAGS::CORJIT_FLAG_IMPORT_ONLY))</td>
      </tr>
      <tr>
        <td id="L13010" data-line-number="13010"></td>
        <td id="LC13010">        {</td>
      </tr>
      <tr>
        <td id="L13011" data-line-number="13011"></td>
        <td id="LC13011">            <span><span>//</span> We are done</span></td>
      </tr>
      <tr>
        <td id="L13012" data-line-number="13012"></td>
        <td id="LC13012">            <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13013" data-line-number="13013"></td>
        <td id="LC13013">        }</td>
      </tr>
      <tr>
        <td id="L13014" data-line-number="13014"></td>
        <td id="LC13014">
</td>
      </tr>
      <tr>
        <td id="L13015" data-line-number="13015"></td>
        <td id="LC13015">        <span>if</span> (!nativeEntry)</td>
      </tr>
      <tr>
        <td id="L13016" data-line-number="13016"></td>
        <td id="LC13016">            <span>COMPlusThrow</span>(<span>kInvalidProgramException</span>);</td>
      </tr>
      <tr>
        <td id="L13017" data-line-number="13017"></td>
        <td id="LC13017">
</td>
      </tr>
      <tr>
        <td id="L13018" data-line-number="13018"></td>
        <td id="LC13018">#<span>if</span> (defined(TARGET_AMD64) || defined(TARGET_ARM64)) &amp;&amp; !defined(CROSSGEN_COMPILE)</td>
      </tr>
      <tr>
        <td id="L13019" data-line-number="13019"></td>
        <td id="LC13019">        <span>if</span> (jitInfo.<span>IsJumpStubOverflow</span>())</td>
      </tr>
      <tr>
        <td id="L13020" data-line-number="13020"></td>
        <td id="LC13020">        {</td>
      </tr>
      <tr>
        <td id="L13021" data-line-number="13021"></td>
        <td id="LC13021">            <span><span>//</span> Backout and try again with fAllowRel32 == FALSE.</span></td>
      </tr>
      <tr>
        <td id="L13022" data-line-number="13022"></td>
        <td id="LC13022">            jitInfo.<span>BackoutJitData</span>(jitMgr);</td>
      </tr>
      <tr>
        <td id="L13023" data-line-number="13023"></td>
        <td id="LC13023">
</td>
      </tr>
      <tr>
        <td id="L13024" data-line-number="13024"></td>
        <td id="LC13024">#<span>ifdef</span> TARGET_AMD64</td>
      </tr>
      <tr>
        <td id="L13025" data-line-number="13025"></td>
        <td id="LC13025">            <span><span>//</span> Disallow rel32 relocs in future.</span></td>
      </tr>
      <tr>
        <td id="L13026" data-line-number="13026"></td>
        <td id="LC13026">            g_fAllowRel32 = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13027" data-line-number="13027"></td>
        <td id="LC13027">
</td>
      </tr>
      <tr>
        <td id="L13028" data-line-number="13028"></td>
        <td id="LC13028">            <span>fAllowRel32</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13029" data-line-number="13029"></td>
        <td id="LC13029">#<span>endif</span> <span><span>//</span> TARGET_AMD64</span></td>
      </tr>
      <tr>
        <td id="L13030" data-line-number="13030"></td>
        <td id="LC13030">#<span>ifdef</span> TARGET_ARM64</td>
      </tr>
      <tr>
        <td id="L13031" data-line-number="13031"></td>
        <td id="LC13031">            <span>fForceJumpStubOverflow</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13032" data-line-number="13032"></td>
        <td id="LC13032">#<span>endif</span> <span><span>//</span> TARGET_ARM64</span></td>
      </tr>
      <tr>
        <td id="L13033" data-line-number="13033"></td>
        <td id="LC13033">
</td>
      </tr>
      <tr>
        <td id="L13034" data-line-number="13034"></td>
        <td id="LC13034">            reserveForJumpStubs = jitInfo.<span>GetReserveForJumpStubs</span>();</td>
      </tr>
      <tr>
        <td id="L13035" data-line-number="13035"></td>
        <td id="LC13035">            <span>continue</span>;</td>
      </tr>
      <tr>
        <td id="L13036" data-line-number="13036"></td>
        <td id="LC13036">        }</td>
      </tr>
      <tr>
        <td id="L13037" data-line-number="13037"></td>
        <td id="LC13037">#<span>endif</span> <span><span>//</span> (TARGET_AMD64 || TARGET_ARM64) &amp;&amp; !CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L13038" data-line-number="13038"></td>
        <td id="LC13038">
</td>
      </tr>
      <tr>
        <td id="L13039" data-line-number="13039"></td>
        <td id="LC13039">        <span>LOG</span>((LF_JIT, LL_INFO10000,</td>
      </tr>
      <tr>
        <td id="L13040" data-line-number="13040"></td>
        <td id="LC13040">            <span><span>"</span>Jitted Entry at<span>"</span></span> FMT_ADDR <span><span>"</span>method %s::%s %s<span>\n</span><span>"</span></span>, <span>DBG_ADDR</span>(nativeEntry),</td>
      </tr>
      <tr>
        <td id="L13041" data-line-number="13041"></td>
        <td id="LC13041">             ftn-&gt;<span>m_pszDebugClassName</span>, ftn-&gt;<span>m_pszDebugMethodName</span>, ftn-&gt;<span>m_pszDebugMethodSignature</span>));</td>
      </tr>
      <tr>
        <td id="L13042" data-line-number="13042"></td>
        <td id="LC13042">
</td>
      </tr>
      <tr>
        <td id="L13043" data-line-number="13043"></td>
        <td id="LC13043">#<span>if</span> defined(FEATURE_CORESYSTEM)</td>
      </tr>
      <tr>
        <td id="L13044" data-line-number="13044"></td>
        <td id="LC13044">
</td>
      </tr>
      <tr>
        <td id="L13045" data-line-number="13045"></td>
        <td id="LC13045">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L13046" data-line-number="13046"></td>
        <td id="LC13046">        LPCUTF8 pszDebugClassName = ftn-&gt;<span>m_pszDebugClassName</span>;</td>
      </tr>
      <tr>
        <td id="L13047" data-line-number="13047"></td>
        <td id="LC13047">        LPCUTF8 pszDebugMethodName = ftn-&gt;<span>m_pszDebugMethodName</span>;</td>
      </tr>
      <tr>
        <td id="L13048" data-line-number="13048"></td>
        <td id="LC13048">        LPCUTF8 pszDebugMethodSignature = ftn-&gt;<span>m_pszDebugMethodSignature</span>;</td>
      </tr>
      <tr>
        <td id="L13049" data-line-number="13049"></td>
        <td id="LC13049">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L13050" data-line-number="13050"></td>
        <td id="LC13050">        LPCUTF8 pszNamespace;</td>
      </tr>
      <tr>
        <td id="L13051" data-line-number="13051"></td>
        <td id="LC13051">        LPCUTF8 pszDebugClassName = ftn-&gt;<span>GetMethodTable</span>()-&gt;<span>GetFullyQualifiedNameInfo</span>(&amp;pszNamespace);</td>
      </tr>
      <tr>
        <td id="L13052" data-line-number="13052"></td>
        <td id="LC13052">        LPCUTF8 pszDebugMethodName = ftn-&gt;<span>GetName</span>();</td>
      </tr>
      <tr>
        <td id="L13053" data-line-number="13053"></td>
        <td id="LC13053">        LPCUTF8 pszDebugMethodSignature = <span><span>"</span><span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="L13054" data-line-number="13054"></td>
        <td id="LC13054">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13055" data-line-number="13055"></td>
        <td id="LC13055">
</td>
      </tr>
      <tr>
        <td id="L13056" data-line-number="13056"></td>
        <td id="LC13056">        <span><span>//</span>DbgPrintf("Jitted Entry at" FMT_ADDR "method %s::%s %s size %08x\n", DBG_ADDR(nativeEntry),</span></td>
      </tr>
      <tr>
        <td id="L13057" data-line-number="13057"></td>
        <td id="LC13057">        <span><span>//</span>          pszDebugClassName, pszDebugMethodName, pszDebugMethodSignature, sizeOfCode);</span></td>
      </tr>
      <tr>
        <td id="L13058" data-line-number="13058"></td>
        <td id="LC13058">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13059" data-line-number="13059"></td>
        <td id="LC13059">
</td>
      </tr>
      <tr>
        <td id="L13060" data-line-number="13060"></td>
        <td id="LC13060">        <span>ClrFlushInstructionCache</span>(nativeEntry, sizeOfCode);</td>
      </tr>
      <tr>
        <td id="L13061" data-line-number="13061"></td>
        <td id="LC13061">        ret = (PCODE)nativeEntry;</td>
      </tr>
      <tr>
        <td id="L13062" data-line-number="13062"></td>
        <td id="LC13062">
</td>
      </tr>
      <tr>
        <td id="L13063" data-line-number="13063"></td>
        <td id="LC13063">#<span>ifdef</span> TARGET_ARM</td>
      </tr>
      <tr>
        <td id="L13064" data-line-number="13064"></td>
        <td id="LC13064">        ret |= THUMB_CODE;</td>
      </tr>
      <tr>
        <td id="L13065" data-line-number="13065"></td>
        <td id="LC13065">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13066" data-line-number="13066"></td>
        <td id="LC13066">
</td>
      </tr>
      <tr>
        <td id="L13067" data-line-number="13067"></td>
        <td id="LC13067">        <span><span>//</span> We are done</span></td>
      </tr>
      <tr>
        <td id="L13068" data-line-number="13068"></td>
        <td id="LC13068">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13069" data-line-number="13069"></td>
        <td id="LC13069">    }</td>
      </tr>
      <tr>
        <td id="L13070" data-line-number="13070"></td>
        <td id="LC13070">
</td>
      </tr>
      <tr>
        <td id="L13071" data-line-number="13071"></td>
        <td id="LC13071">#<span>ifdef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L13072" data-line-number="13072"></td>
        <td id="LC13072">    <span>FastInterlockIncrement</span>(&amp;g_JitCount);</td>
      </tr>
      <tr>
        <td id="L13073" data-line-number="13073"></td>
        <td id="LC13073">    <span>static</span> BOOL <span>fHeartbeat</span> = -<span>1</span>;</td>
      </tr>
      <tr>
        <td id="L13074" data-line-number="13074"></td>
        <td id="LC13074">
</td>
      </tr>
      <tr>
        <td id="L13075" data-line-number="13075"></td>
        <td id="LC13075">    <span>if</span> (<span>fHeartbeat</span> == -<span>1</span>)</td>
      </tr>
      <tr>
        <td id="L13076" data-line-number="13076"></td>
        <td id="LC13076">        <span>fHeartbeat</span> = <span>CLRConfig::GetConfigValue</span>(CLRConfig::INTERNAL_JitHeartbeat);</td>
      </tr>
      <tr>
        <td id="L13077" data-line-number="13077"></td>
        <td id="LC13077">
</td>
      </tr>
      <tr>
        <td id="L13078" data-line-number="13078"></td>
        <td id="LC13078">    <span>if</span> (<span>fHeartbeat</span>)</td>
      </tr>
      <tr>
        <td id="L13079" data-line-number="13079"></td>
        <td id="LC13079">        <span>printf</span>(<span><span>"</span>.<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L13080" data-line-number="13080"></td>
        <td id="LC13080">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L13081" data-line-number="13081"></td>
        <td id="LC13081">
</td>
      </tr>
      <tr>
        <td id="L13082" data-line-number="13082"></td>
        <td id="LC13082">    <span>COOPERATIVE_TRANSITION_END</span>();</td>
      </tr>
      <tr>
        <td id="L13083" data-line-number="13083"></td>
        <td id="LC13083">    <span>return</span> ret;</td>
      </tr>
      <tr>
        <td id="L13084" data-line-number="13084"></td>
        <td id="LC13084">}</td>
      </tr>
      <tr>
        <td id="L13085" data-line-number="13085"></td>
        <td id="LC13085">
</td>
      </tr>
      <tr>
        <td id="L13086" data-line-number="13086"></td>
        <td id="LC13086"><span>extern</span> <span><span>"</span>C<span>"</span></span> <span>unsigned</span> __stdcall <span>PartialNGenStressPercentage</span>()</td>
      </tr>
      <tr>
        <td id="L13087" data-line-number="13087"></td>
        <td id="LC13087">{</td>
      </tr>
      <tr>
        <td id="L13088" data-line-number="13088"></td>
        <td id="LC13088">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13089" data-line-number="13089"></td>
        <td id="LC13089">#<span>ifndef</span> _DEBUG</td>
      </tr>
      <tr>
        <td id="L13090" data-line-number="13090"></td>
        <td id="LC13090">    <span>return</span> <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L13091" data-line-number="13091"></td>
        <td id="LC13091">#<span>else</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L13092" data-line-number="13092"></td>
        <td id="LC13092">    <span>static</span> ConfigDWORD partialNGenStress;</td>
      </tr>
      <tr>
        <td id="L13093" data-line-number="13093"></td>
        <td id="LC13093">    DWORD partialNGenStressVal = partialNGenStress.<span>val</span>(CLRConfig::INTERNAL_partialNGenStress);</td>
      </tr>
      <tr>
        <td id="L13094" data-line-number="13094"></td>
        <td id="LC13094">    <span>_ASSERTE</span>(partialNGenStressVal &lt;= <span>100</span>);</td>
      </tr>
      <tr>
        <td id="L13095" data-line-number="13095"></td>
        <td id="LC13095">    <span>return</span> partialNGenStressVal;</td>
      </tr>
      <tr>
        <td id="L13096" data-line-number="13096"></td>
        <td id="LC13096">#<span>endif</span> <span><span>//</span> _DEBUG</span></td>
      </tr>
      <tr>
        <td id="L13097" data-line-number="13097"></td>
        <td id="LC13097">}</td>
      </tr>
      <tr>
        <td id="L13098" data-line-number="13098"></td>
        <td id="LC13098">
</td>
      </tr>
      <tr>
        <td id="L13099" data-line-number="13099"></td>
        <td id="LC13099">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L13100" data-line-number="13100"></td>
        <td id="LC13100"><span><span>/*</span>*******************************************************************<span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13101" data-line-number="13101"></td>
        <td id="LC13101">
</td>
      </tr>
      <tr>
        <td id="L13102" data-line-number="13102"></td>
        <td id="LC13102"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13103" data-line-number="13103"></td>
        <td id="LC13103"><span><span>//</span> Table loading functions</span></td>
      </tr>
      <tr>
        <td id="L13104" data-line-number="13104"></td>
        <td id="LC13104"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13105" data-line-number="13105"></td>
        <td id="LC13105"><span>void</span> <span>Module::LoadHelperTable</span>()</td>
      </tr>
      <tr>
        <td id="L13106" data-line-number="13106"></td>
        <td id="LC13106">{</td>
      </tr>
      <tr>
        <td id="L13107" data-line-number="13107"></td>
        <td id="LC13107">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13108" data-line-number="13108"></td>
        <td id="LC13108">
</td>
      </tr>
      <tr>
        <td id="L13109" data-line-number="13109"></td>
        <td id="LC13109">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L13110" data-line-number="13110"></td>
        <td id="LC13110">    COUNT_T tableSize;</td>
      </tr>
      <tr>
        <td id="L13111" data-line-number="13111"></td>
        <td id="LC13111">    BYTE * table = (BYTE *) <span>GetNativeImage</span>()-&gt;<span>GetNativeHelperTable</span>(&amp;tableSize);</td>
      </tr>
      <tr>
        <td id="L13112" data-line-number="13112"></td>
        <td id="LC13112">
</td>
      </tr>
      <tr>
        <td id="L13113" data-line-number="13113"></td>
        <td id="LC13113">    <span>if</span> (tableSize == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L13114" data-line-number="13114"></td>
        <td id="LC13114">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L13115" data-line-number="13115"></td>
        <td id="LC13115">
</td>
      </tr>
      <tr>
        <td id="L13116" data-line-number="13116"></td>
        <td id="LC13116">    BYTE * curEntry   = table;</td>
      </tr>
      <tr>
        <td id="L13117" data-line-number="13117"></td>
        <td id="LC13117">    BYTE * tableEnd   = table + tableSize;</td>
      </tr>
      <tr>
        <td id="L13118" data-line-number="13118"></td>
        <td id="LC13118">
</td>
      </tr>
      <tr>
        <td id="L13119" data-line-number="13119"></td>
        <td id="LC13119">#<span>ifdef</span> FEATURE_PERFMAP</td>
      </tr>
      <tr>
        <td id="L13120" data-line-number="13120"></td>
        <td id="LC13120">    <span>PerfMap::LogStubs</span>(__FUNCTION__, <span>GetSimpleName</span>(), (PCODE)table, tableSize);</td>
      </tr>
      <tr>
        <td id="L13121" data-line-number="13121"></td>
        <td id="LC13121">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13122" data-line-number="13122"></td>
        <td id="LC13122">
</td>
      </tr>
      <tr>
        <td id="L13123" data-line-number="13123"></td>
        <td id="LC13123">#<span>ifdef</span> LOGGING</td>
      </tr>
      <tr>
        <td id="L13124" data-line-number="13124"></td>
        <td id="LC13124">    <span>int</span> iEntryNumber = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L13125" data-line-number="13125"></td>
        <td id="LC13125">#<span>endif</span> <span><span>//</span> LOGGING</span></td>
      </tr>
      <tr>
        <td id="L13126" data-line-number="13126"></td>
        <td id="LC13126">
</td>
      </tr>
      <tr>
        <td id="L13127" data-line-number="13127"></td>
        <td id="LC13127">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13128" data-line-number="13128"></td>
        <td id="LC13128">    <span><span>//</span> Fill in helpers</span></td>
      </tr>
      <tr>
        <td id="L13129" data-line-number="13129"></td>
        <td id="LC13129">    <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13130" data-line-number="13130"></td>
        <td id="LC13130">
</td>
      </tr>
      <tr>
        <td id="L13131" data-line-number="13131"></td>
        <td id="LC13131">    <span>while</span> (curEntry &lt; tableEnd)</td>
      </tr>
      <tr>
        <td id="L13132" data-line-number="13132"></td>
        <td id="LC13132">    {</td>
      </tr>
      <tr>
        <td id="L13133" data-line-number="13133"></td>
        <td id="LC13133">        DWORD dwHelper = *(DWORD *)curEntry;</td>
      </tr>
      <tr>
        <td id="L13134" data-line-number="13134"></td>
        <td id="LC13134">
</td>
      </tr>
      <tr>
        <td id="L13135" data-line-number="13135"></td>
        <td id="LC13135">        <span>int</span> iHelper = (USHORT)dwHelper;</td>
      </tr>
      <tr>
        <td id="L13136" data-line-number="13136"></td>
        <td id="LC13136">        <span>_ASSERTE</span>(iHelper &lt; CORINFO_HELP_COUNT);</td>
      </tr>
      <tr>
        <td id="L13137" data-line-number="13137"></td>
        <td id="LC13137">
</td>
      </tr>
      <tr>
        <td id="L13138" data-line-number="13138"></td>
        <td id="LC13138">        <span>LOG</span>((LF_JIT, LL_INFO1000000, <span><span>"</span>JIT helper %3d (%-40s: table @ %p, size 0x%x, entry %3d @ %p, pfnHelper %p)<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L13139" data-line-number="13139"></td>
        <td id="LC13139">            iHelper, hlpFuncTable[iHelper].<span>name</span>, table, tableSize, iEntryNumber, curEntry, hlpFuncTable[iHelper].<span>pfnHelper</span>));</td>
      </tr>
      <tr>
        <td id="L13140" data-line-number="13140"></td>
        <td id="LC13140">
</td>
      </tr>
      <tr>
        <td id="L13141" data-line-number="13141"></td>
        <td id="LC13141">#<span>if</span> defined(ENABLE_FAST_GCPOLL_HELPER)</td>
      </tr>
      <tr>
        <td id="L13142" data-line-number="13142"></td>
        <td id="LC13142">        <span><span>//</span> The fast GC poll helper works by calling indirect through a pointer that points to either</span></td>
      </tr>
      <tr>
        <td id="L13143" data-line-number="13143"></td>
        <td id="LC13143">        <span><span>//</span> JIT_PollGC or JIT_PollGC_Nop, based on whether we need to poll or not. The JIT_PollGC_Nop</span></td>
      </tr>
      <tr>
        <td id="L13144" data-line-number="13144"></td>
        <td id="LC13144">        <span><span>//</span> version is just a "ret". The pointer is stored in hlpDynamicFuncTable[DYNAMIC_CORINFO_HELP_POLL_GC].</span></td>
      </tr>
      <tr>
        <td id="L13145" data-line-number="13145"></td>
        <td id="LC13145">        <span><span>//</span> See EnableJitGCPoll() and DisableJitGCPoll().</span></td>
      </tr>
      <tr>
        <td id="L13146" data-line-number="13146"></td>
        <td id="LC13146">        <span><span>//</span> In NGEN images, we generate a direct call to the helper table. Here, we replace that with</span></td>
      </tr>
      <tr>
        <td id="L13147" data-line-number="13147"></td>
        <td id="LC13147">        <span><span>//</span> an indirect jump through the pointer in hlpDynamicFuncTable[DYNAMIC_CORINFO_HELP_POLL_GC].</span></td>
      </tr>
      <tr>
        <td id="L13148" data-line-number="13148"></td>
        <td id="LC13148">        <span>if</span> (iHelper == CORINFO_HELP_POLL_GC)</td>
      </tr>
      <tr>
        <td id="L13149" data-line-number="13149"></td>
        <td id="LC13149">        {</td>
      </tr>
      <tr>
        <td id="L13150" data-line-number="13150"></td>
        <td id="LC13150">            <span>LOG</span>((LF_JIT, LL_INFO1000000, <span><span>"</span>JIT helper CORINFO_HELP_POLL_GC (%d); emitting indirect jump to 0x%x<span>\n</span><span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="L13151" data-line-number="13151"></td>
        <td id="LC13151">                CORINFO_HELP_POLL_GC, &amp;hlpDynamicFuncTable[DYNAMIC_CORINFO_HELP_POLL_GC].<span>pfnHelper</span>));</td>
      </tr>
      <tr>
        <td id="L13152" data-line-number="13152"></td>
        <td id="LC13152">
</td>
      </tr>
      <tr>
        <td id="L13153" data-line-number="13153"></td>
        <td id="LC13153">            <span>emitJumpInd</span>(curEntry, &amp;hlpDynamicFuncTable[DYNAMIC_CORINFO_HELP_POLL_GC].<span>pfnHelper</span>);</td>
      </tr>
      <tr>
        <td id="L13154" data-line-number="13154"></td>
        <td id="LC13154">            curEntry = curEntry + HELPER_TABLE_ENTRY_LEN;</td>
      </tr>
      <tr>
        <td id="L13155" data-line-number="13155"></td>
        <td id="LC13155">        }</td>
      </tr>
      <tr>
        <td id="L13156" data-line-number="13156"></td>
        <td id="LC13156">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L13157" data-line-number="13157"></td>
        <td id="LC13157">#<span>endif</span> <span><span>//</span> ENABLE_FAST_GCPOLL_HELPER</span></td>
      </tr>
      <tr>
        <td id="L13158" data-line-number="13158"></td>
        <td id="LC13158">        {</td>
      </tr>
      <tr>
        <td id="L13159" data-line-number="13159"></td>
        <td id="LC13159">            PCODE pfnHelper = <span>CEEJitInfo::getHelperFtnStatic</span>((CorInfoHelpFunc)iHelper);</td>
      </tr>
      <tr>
        <td id="L13160" data-line-number="13160"></td>
        <td id="LC13160">
</td>
      </tr>
      <tr>
        <td id="L13161" data-line-number="13161"></td>
        <td id="LC13161">            <span>if</span> (dwHelper &amp; CORCOMPILE_HELPER_PTR)</td>
      </tr>
      <tr>
        <td id="L13162" data-line-number="13162"></td>
        <td id="LC13162">            {</td>
      </tr>
      <tr>
        <td id="L13163" data-line-number="13163"></td>
        <td id="LC13163">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13164" data-line-number="13164"></td>
        <td id="LC13164">                <span><span>//</span> Indirection cell</span></td>
      </tr>
      <tr>
        <td id="L13165" data-line-number="13165"></td>
        <td id="LC13165">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13166" data-line-number="13166"></td>
        <td id="LC13166">
</td>
      </tr>
      <tr>
        <td id="L13167" data-line-number="13167"></td>
        <td id="LC13167">                *(TADDR *)curEntry = pfnHelper;</td>
      </tr>
      <tr>
        <td id="L13168" data-line-number="13168"></td>
        <td id="LC13168">
</td>
      </tr>
      <tr>
        <td id="L13169" data-line-number="13169"></td>
        <td id="LC13169">                curEntry = curEntry + <span>sizeof</span>(TADDR);</td>
      </tr>
      <tr>
        <td id="L13170" data-line-number="13170"></td>
        <td id="LC13170">            }</td>
      </tr>
      <tr>
        <td id="L13171" data-line-number="13171"></td>
        <td id="LC13171">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L13172" data-line-number="13172"></td>
        <td id="LC13172">            {</td>
      </tr>
      <tr>
        <td id="L13173" data-line-number="13173"></td>
        <td id="LC13173">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13174" data-line-number="13174"></td>
        <td id="LC13174">                <span><span>//</span> Jump thunk</span></td>
      </tr>
      <tr>
        <td id="L13175" data-line-number="13175"></td>
        <td id="LC13175">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13176" data-line-number="13176"></td>
        <td id="LC13176">
</td>
      </tr>
      <tr>
        <td id="L13177" data-line-number="13177"></td>
        <td id="LC13177">#<span>if</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L13178" data-line-number="13178"></td>
        <td id="LC13178">                *curEntry = X86_INSTR_JMP_REL32;</td>
      </tr>
      <tr>
        <td id="L13179" data-line-number="13179"></td>
        <td id="LC13179">                *(INT32 *)(curEntry + <span>1</span>) = <span>rel32UsingJumpStub</span>((INT32 *)(curEntry + <span>1</span>), pfnHelper, <span>NULL</span>, <span>GetLoaderAllocator</span>());</td>
      </tr>
      <tr>
        <td id="L13180" data-line-number="13180"></td>
        <td id="LC13180">#<span>else</span> <span><span>//</span> all other platforms</span></td>
      </tr>
      <tr>
        <td id="L13181" data-line-number="13181"></td>
        <td id="LC13181">                <span>emitJump</span>(curEntry, (LPVOID)pfnHelper);</td>
      </tr>
      <tr>
        <td id="L13182" data-line-number="13182"></td>
        <td id="LC13182">                <span>_ASSERTE</span>(HELPER_TABLE_ENTRY_LEN &gt;= JUMP_ALLOCATE_SIZE);</td>
      </tr>
      <tr>
        <td id="L13183" data-line-number="13183"></td>
        <td id="LC13183">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13184" data-line-number="13184"></td>
        <td id="LC13184">
</td>
      </tr>
      <tr>
        <td id="L13185" data-line-number="13185"></td>
        <td id="LC13185">                curEntry = curEntry + HELPER_TABLE_ENTRY_LEN;</td>
      </tr>
      <tr>
        <td id="L13186" data-line-number="13186"></td>
        <td id="LC13186">            }</td>
      </tr>
      <tr>
        <td id="L13187" data-line-number="13187"></td>
        <td id="LC13187">        }</td>
      </tr>
      <tr>
        <td id="L13188" data-line-number="13188"></td>
        <td id="LC13188">#<span>ifdef</span> LOGGING</td>
      </tr>
      <tr>
        <td id="L13189" data-line-number="13189"></td>
        <td id="LC13189">        <span><span>//</span> Note that some table entries are sizeof(TADDR) in length, and some are HELPER_TABLE_ENTRY_LEN in length</span></td>
      </tr>
      <tr>
        <td id="L13190" data-line-number="13190"></td>
        <td id="LC13190">        ++iEntryNumber;</td>
      </tr>
      <tr>
        <td id="L13191" data-line-number="13191"></td>
        <td id="LC13191">#<span>endif</span> <span><span>//</span> LOGGING</span></td>
      </tr>
      <tr>
        <td id="L13192" data-line-number="13192"></td>
        <td id="LC13192">    }</td>
      </tr>
      <tr>
        <td id="L13193" data-line-number="13193"></td>
        <td id="LC13193">
</td>
      </tr>
      <tr>
        <td id="L13194" data-line-number="13194"></td>
        <td id="LC13194">    <span>ClrFlushInstructionCache</span>(table, tableSize);</td>
      </tr>
      <tr>
        <td id="L13195" data-line-number="13195"></td>
        <td id="LC13195">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L13196" data-line-number="13196"></td>
        <td id="LC13196">}</td>
      </tr>
      <tr>
        <td id="L13197" data-line-number="13197"></td>
        <td id="LC13197">#<span>endif</span> <span><span>//</span> FEATURE_PREJIT</span></td>
      </tr>
      <tr>
        <td id="L13198" data-line-number="13198"></td>
        <td id="LC13198">
</td>
      </tr>
      <tr>
        <td id="L13199" data-line-number="13199"></td>
        <td id="LC13199">#<span>ifdef</span> FEATURE_READYTORUN</td>
      </tr>
      <tr>
        <td id="L13200" data-line-number="13200"></td>
        <td id="LC13200">CorInfoHelpFunc <span>MapReadyToRunHelper</span>(ReadyToRunHelper helperNum)</td>
      </tr>
      <tr>
        <td id="L13201" data-line-number="13201"></td>
        <td id="LC13201">{</td>
      </tr>
      <tr>
        <td id="L13202" data-line-number="13202"></td>
        <td id="LC13202">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13203" data-line-number="13203"></td>
        <td id="LC13203">
</td>
      </tr>
      <tr>
        <td id="L13204" data-line-number="13204"></td>
        <td id="LC13204">    <span>switch</span> (helperNum)</td>
      </tr>
      <tr>
        <td id="L13205" data-line-number="13205"></td>
        <td id="LC13205">    {</td>
      </tr>
      <tr>
        <td id="L13206" data-line-number="13206"></td>
        <td id="LC13206">#<span>define</span> <span>HELPER</span>(<span>readyToRunHelper, corInfoHelpFunc, flags</span>) \</td>
      </tr>
      <tr>
        <td id="L13207" data-line-number="13207"></td>
        <td id="LC13207">    <span>case</span> readyToRunHelper:                                  <span>return</span> corInfoHelpFunc;</td>
      </tr>
      <tr>
        <td id="L13208" data-line-number="13208"></td>
        <td id="LC13208">#<span>include</span> <span><span>"</span>readytorunhelpers.h<span>"</span></span></td>
      </tr>
      <tr>
        <td id="L13209" data-line-number="13209"></td>
        <td id="LC13209">
</td>
      </tr>
      <tr>
        <td id="L13210" data-line-number="13210"></td>
        <td id="LC13210">    <span>case</span> READYTORUN_HELPER_GetString:                       <span>return</span> CORINFO_HELP_STRCNS;</td>
      </tr>
      <tr>
        <td id="L13211" data-line-number="13211"></td>
        <td id="LC13211">
</td>
      </tr>
      <tr>
        <td id="L13212" data-line-number="13212"></td>
        <td id="LC13212">    <span>default</span>:                                                <span>return</span> CORINFO_HELP_UNDEF;</td>
      </tr>
      <tr>
        <td id="L13213" data-line-number="13213"></td>
        <td id="LC13213">    }</td>
      </tr>
      <tr>
        <td id="L13214" data-line-number="13214"></td>
        <td id="LC13214">}</td>
      </tr>
      <tr>
        <td id="L13215" data-line-number="13215"></td>
        <td id="LC13215">
</td>
      </tr>
      <tr>
        <td id="L13216" data-line-number="13216"></td>
        <td id="LC13216"><span>void</span> <span>ComputeGCRefMap</span>(MethodTable * pMT, BYTE * pGCRefMap, <span>size_t</span> cbGCRefMap)</td>
      </tr>
      <tr>
        <td id="L13217" data-line-number="13217"></td>
        <td id="LC13217">{</td>
      </tr>
      <tr>
        <td id="L13218" data-line-number="13218"></td>
        <td id="LC13218">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13219" data-line-number="13219"></td>
        <td id="LC13219">
</td>
      </tr>
      <tr>
        <td id="L13220" data-line-number="13220"></td>
        <td id="LC13220">    <span>ZeroMemory</span>(pGCRefMap, cbGCRefMap);</td>
      </tr>
      <tr>
        <td id="L13221" data-line-number="13221"></td>
        <td id="LC13221">
</td>
      </tr>
      <tr>
        <td id="L13222" data-line-number="13222"></td>
        <td id="LC13222">    <span>if</span> (!pMT-&gt;<span>ContainsPointers</span>())</td>
      </tr>
      <tr>
        <td id="L13223" data-line-number="13223"></td>
        <td id="LC13223">        <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L13224" data-line-number="13224"></td>
        <td id="LC13224">
</td>
      </tr>
      <tr>
        <td id="L13225" data-line-number="13225"></td>
        <td id="LC13225">    CGCDesc* map = <span>CGCDesc::GetCGCDescFromMT</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L13226" data-line-number="13226"></td>
        <td id="LC13226">    CGCDescSeries* cur = map-&gt;<span>GetHighestSeries</span>();</td>
      </tr>
      <tr>
        <td id="L13227" data-line-number="13227"></td>
        <td id="LC13227">    CGCDescSeries* last = map-&gt;<span>GetLowestSeries</span>();</td>
      </tr>
      <tr>
        <td id="L13228" data-line-number="13228"></td>
        <td id="LC13228">    DWORD size = pMT-&gt;<span>GetBaseSize</span>();</td>
      </tr>
      <tr>
        <td id="L13229" data-line-number="13229"></td>
        <td id="LC13229">    <span>_ASSERTE</span>(cur &gt;= last);</td>
      </tr>
      <tr>
        <td id="L13230" data-line-number="13230"></td>
        <td id="LC13230">
</td>
      </tr>
      <tr>
        <td id="L13231" data-line-number="13231"></td>
        <td id="LC13231">    <span>do</span></td>
      </tr>
      <tr>
        <td id="L13232" data-line-number="13232"></td>
        <td id="LC13232">    {</td>
      </tr>
      <tr>
        <td id="L13233" data-line-number="13233"></td>
        <td id="LC13233">        <span><span>//</span> offset to embedded references in this series must be</span></td>
      </tr>
      <tr>
        <td id="L13234" data-line-number="13234"></td>
        <td id="LC13234">        <span><span>//</span> adjusted by the VTable pointer, when in the unboxed state.</span></td>
      </tr>
      <tr>
        <td id="L13235" data-line-number="13235"></td>
        <td id="LC13235">        <span>size_t</span> offset = cur-&gt;<span>GetSeriesOffset</span>() - TARGET_POINTER_SIZE;</td>
      </tr>
      <tr>
        <td id="L13236" data-line-number="13236"></td>
        <td id="LC13236">        <span>size_t</span> offsetStop = offset + cur-&gt;<span>GetSeriesSize</span>() + size;</td>
      </tr>
      <tr>
        <td id="L13237" data-line-number="13237"></td>
        <td id="LC13237">        <span>while</span> (offset &lt; offsetStop)</td>
      </tr>
      <tr>
        <td id="L13238" data-line-number="13238"></td>
        <td id="LC13238">        {</td>
      </tr>
      <tr>
        <td id="L13239" data-line-number="13239"></td>
        <td id="LC13239">            <span>size_t</span> bit = offset / TARGET_POINTER_SIZE;</td>
      </tr>
      <tr>
        <td id="L13240" data-line-number="13240"></td>
        <td id="LC13240">
</td>
      </tr>
      <tr>
        <td id="L13241" data-line-number="13241"></td>
        <td id="LC13241">            <span>size_t</span> <span>index</span> = bit / <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L13242" data-line-number="13242"></td>
        <td id="LC13242">            <span>_ASSERTE</span>(<span>index</span> &lt; cbGCRefMap);</td>
      </tr>
      <tr>
        <td id="L13243" data-line-number="13243"></td>
        <td id="LC13243">            pGCRefMap[<span>index</span>] |= (<span>1</span> &lt;&lt; (bit &amp; <span>7</span>));</td>
      </tr>
      <tr>
        <td id="L13244" data-line-number="13244"></td>
        <td id="LC13244">
</td>
      </tr>
      <tr>
        <td id="L13245" data-line-number="13245"></td>
        <td id="LC13245">            offset += TARGET_POINTER_SIZE;</td>
      </tr>
      <tr>
        <td id="L13246" data-line-number="13246"></td>
        <td id="LC13246">        }</td>
      </tr>
      <tr>
        <td id="L13247" data-line-number="13247"></td>
        <td id="LC13247">        cur--;</td>
      </tr>
      <tr>
        <td id="L13248" data-line-number="13248"></td>
        <td id="LC13248">    } <span>while</span> (cur &gt;= last);</td>
      </tr>
      <tr>
        <td id="L13249" data-line-number="13249"></td>
        <td id="LC13249">}</td>
      </tr>
      <tr>
        <td id="L13250" data-line-number="13250"></td>
        <td id="LC13250">
</td>
      </tr>
      <tr>
        <td id="L13251" data-line-number="13251"></td>
        <td id="LC13251"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13252" data-line-number="13252"></td>
        <td id="LC13252"><span><span>//</span> Type layout check verifies that there was no incompatible change in the value type layout.</span></td>
      </tr>
      <tr>
        <td id="L13253" data-line-number="13253"></td>
        <td id="LC13253"><span><span>//</span> If there was one, we will fall back to JIT instead of using the pre-generated code from the ready to run image.</span></td>
      </tr>
      <tr>
        <td id="L13254" data-line-number="13254"></td>
        <td id="LC13254"><span><span>//</span> This should be rare situation. Changes in value type layout not common.</span></td>
      </tr>
      <tr>
        <td id="L13255" data-line-number="13255"></td>
        <td id="LC13255"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13256" data-line-number="13256"></td>
        <td id="LC13256"><span><span>//</span> The following properties of the value type layout are checked:</span></td>
      </tr>
      <tr>
        <td id="L13257" data-line-number="13257"></td>
        <td id="LC13257"><span><span>//</span> - Size</span></td>
      </tr>
      <tr>
        <td id="L13258" data-line-number="13258"></td>
        <td id="LC13258"><span><span>//</span> - HFA-ness (on platform that support HFAs)</span></td>
      </tr>
      <tr>
        <td id="L13259" data-line-number="13259"></td>
        <td id="LC13259"><span><span>//</span> - Alignment</span></td>
      </tr>
      <tr>
        <td id="L13260" data-line-number="13260"></td>
        <td id="LC13260"><span><span>//</span> - Position of GC references</span></td>
      </tr>
      <tr>
        <td id="L13261" data-line-number="13261"></td>
        <td id="LC13261"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13262" data-line-number="13262"></td>
        <td id="LC13262">BOOL <span>TypeLayoutCheck</span>(MethodTable * pMT, PCCOR_SIGNATURE pBlob)</td>
      </tr>
      <tr>
        <td id="L13263" data-line-number="13263"></td>
        <td id="LC13263">{</td>
      </tr>
      <tr>
        <td id="L13264" data-line-number="13264"></td>
        <td id="LC13264">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13265" data-line-number="13265"></td>
        <td id="LC13265">
</td>
      </tr>
      <tr>
        <td id="L13266" data-line-number="13266"></td>
        <td id="LC13266">    SigPointer <span>p</span>(pBlob);</td>
      </tr>
      <tr>
        <td id="L13267" data-line-number="13267"></td>
        <td id="LC13267">    <span>IfFailThrow</span>(p.<span>SkipExactlyOne</span>());</td>
      </tr>
      <tr>
        <td id="L13268" data-line-number="13268"></td>
        <td id="LC13268">
</td>
      </tr>
      <tr>
        <td id="L13269" data-line-number="13269"></td>
        <td id="LC13269">    DWORD dwFlags;</td>
      </tr>
      <tr>
        <td id="L13270" data-line-number="13270"></td>
        <td id="LC13270">    <span>IfFailThrow</span>(p.<span>GetData</span>(&amp;dwFlags));</td>
      </tr>
      <tr>
        <td id="L13271" data-line-number="13271"></td>
        <td id="LC13271">
</td>
      </tr>
      <tr>
        <td id="L13272" data-line-number="13272"></td>
        <td id="LC13272">    <span><span>//</span> Size is checked unconditionally</span></td>
      </tr>
      <tr>
        <td id="L13273" data-line-number="13273"></td>
        <td id="LC13273">    DWORD dwExpectedSize;</td>
      </tr>
      <tr>
        <td id="L13274" data-line-number="13274"></td>
        <td id="LC13274">    <span>IfFailThrow</span>(p.<span>GetData</span>(&amp;dwExpectedSize));</td>
      </tr>
      <tr>
        <td id="L13275" data-line-number="13275"></td>
        <td id="LC13275">
</td>
      </tr>
      <tr>
        <td id="L13276" data-line-number="13276"></td>
        <td id="LC13276">    DWORD dwActualSize = pMT-&gt;<span>GetNumInstanceFieldBytes</span>();</td>
      </tr>
      <tr>
        <td id="L13277" data-line-number="13277"></td>
        <td id="LC13277">    <span>if</span> (dwExpectedSize != dwActualSize)</td>
      </tr>
      <tr>
        <td id="L13278" data-line-number="13278"></td>
        <td id="LC13278">        <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13279" data-line-number="13279"></td>
        <td id="LC13279">
</td>
      </tr>
      <tr>
        <td id="L13280" data-line-number="13280"></td>
        <td id="LC13280">#<span>ifdef</span> FEATURE_HFA</td>
      </tr>
      <tr>
        <td id="L13281" data-line-number="13281"></td>
        <td id="LC13281">    <span>if</span> (dwFlags &amp; READYTORUN_LAYOUT_HFA)</td>
      </tr>
      <tr>
        <td id="L13282" data-line-number="13282"></td>
        <td id="LC13282">    {</td>
      </tr>
      <tr>
        <td id="L13283" data-line-number="13283"></td>
        <td id="LC13283">        DWORD dwExpectedHFAType;</td>
      </tr>
      <tr>
        <td id="L13284" data-line-number="13284"></td>
        <td id="LC13284">        <span>IfFailThrow</span>(p.<span>GetData</span>(&amp;dwExpectedHFAType));</td>
      </tr>
      <tr>
        <td id="L13285" data-line-number="13285"></td>
        <td id="LC13285">
</td>
      </tr>
      <tr>
        <td id="L13286" data-line-number="13286"></td>
        <td id="LC13286">        DWORD dwActualHFAType = pMT-&gt;<span>GetHFAType</span>();</td>
      </tr>
      <tr>
        <td id="L13287" data-line-number="13287"></td>
        <td id="LC13287">        <span>if</span> (dwExpectedHFAType != dwActualHFAType)</td>
      </tr>
      <tr>
        <td id="L13288" data-line-number="13288"></td>
        <td id="LC13288">            <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13289" data-line-number="13289"></td>
        <td id="LC13289">    }</td>
      </tr>
      <tr>
        <td id="L13290" data-line-number="13290"></td>
        <td id="LC13290">    <span>else</span></td>
      </tr>
      <tr>
        <td id="L13291" data-line-number="13291"></td>
        <td id="LC13291">    {</td>
      </tr>
      <tr>
        <td id="L13292" data-line-number="13292"></td>
        <td id="LC13292">        <span>if</span> (pMT-&gt;<span>IsHFA</span>())</td>
      </tr>
      <tr>
        <td id="L13293" data-line-number="13293"></td>
        <td id="LC13293">            <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13294" data-line-number="13294"></td>
        <td id="LC13294">    }</td>
      </tr>
      <tr>
        <td id="L13295" data-line-number="13295"></td>
        <td id="LC13295">#<span>else</span></td>
      </tr>
      <tr>
        <td id="L13296" data-line-number="13296"></td>
        <td id="LC13296">    <span>_ASSERTE</span>(!(dwFlags &amp; READYTORUN_LAYOUT_HFA));</td>
      </tr>
      <tr>
        <td id="L13297" data-line-number="13297"></td>
        <td id="LC13297">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13298" data-line-number="13298"></td>
        <td id="LC13298">
</td>
      </tr>
      <tr>
        <td id="L13299" data-line-number="13299"></td>
        <td id="LC13299">    <span>if</span> (dwFlags &amp; READYTORUN_LAYOUT_Alignment)</td>
      </tr>
      <tr>
        <td id="L13300" data-line-number="13300"></td>
        <td id="LC13300">    {</td>
      </tr>
      <tr>
        <td id="L13301" data-line-number="13301"></td>
        <td id="LC13301">        DWORD dwExpectedAlignment = TARGET_POINTER_SIZE;</td>
      </tr>
      <tr>
        <td id="L13302" data-line-number="13302"></td>
        <td id="LC13302">        <span>if</span> (!(dwFlags &amp; READYTORUN_LAYOUT_Alignment_Native))</td>
      </tr>
      <tr>
        <td id="L13303" data-line-number="13303"></td>
        <td id="LC13303">        {</td>
      </tr>
      <tr>
        <td id="L13304" data-line-number="13304"></td>
        <td id="LC13304">            <span>IfFailThrow</span>(p.<span>GetData</span>(&amp;dwExpectedAlignment));</td>
      </tr>
      <tr>
        <td id="L13305" data-line-number="13305"></td>
        <td id="LC13305">        }</td>
      </tr>
      <tr>
        <td id="L13306" data-line-number="13306"></td>
        <td id="LC13306">
</td>
      </tr>
      <tr>
        <td id="L13307" data-line-number="13307"></td>
        <td id="LC13307">        DWORD dwActualAlignment = <span>CEEInfo::getClassAlignmentRequirementStatic</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L13308" data-line-number="13308"></td>
        <td id="LC13308">        <span>if</span> (dwExpectedAlignment != dwActualAlignment)</td>
      </tr>
      <tr>
        <td id="L13309" data-line-number="13309"></td>
        <td id="LC13309">            <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13310" data-line-number="13310"></td>
        <td id="LC13310">
</td>
      </tr>
      <tr>
        <td id="L13311" data-line-number="13311"></td>
        <td id="LC13311">    }</td>
      </tr>
      <tr>
        <td id="L13312" data-line-number="13312"></td>
        <td id="LC13312">
</td>
      </tr>
      <tr>
        <td id="L13313" data-line-number="13313"></td>
        <td id="LC13313">    <span>if</span> (dwFlags &amp; READYTORUN_LAYOUT_GCLayout)</td>
      </tr>
      <tr>
        <td id="L13314" data-line-number="13314"></td>
        <td id="LC13314">    {</td>
      </tr>
      <tr>
        <td id="L13315" data-line-number="13315"></td>
        <td id="LC13315">        <span>if</span> (dwFlags &amp; READYTORUN_LAYOUT_GCLayout_Empty)</td>
      </tr>
      <tr>
        <td id="L13316" data-line-number="13316"></td>
        <td id="LC13316">        {</td>
      </tr>
      <tr>
        <td id="L13317" data-line-number="13317"></td>
        <td id="LC13317">            <span>if</span> (pMT-&gt;<span>ContainsPointers</span>())</td>
      </tr>
      <tr>
        <td id="L13318" data-line-number="13318"></td>
        <td id="LC13318">                <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13319" data-line-number="13319"></td>
        <td id="LC13319">        }</td>
      </tr>
      <tr>
        <td id="L13320" data-line-number="13320"></td>
        <td id="LC13320">        <span>else</span></td>
      </tr>
      <tr>
        <td id="L13321" data-line-number="13321"></td>
        <td id="LC13321">        {</td>
      </tr>
      <tr>
        <td id="L13322" data-line-number="13322"></td>
        <td id="LC13322">            <span>size_t</span> cbGCRefMap = (dwActualSize / TARGET_POINTER_SIZE + <span>7</span>) / <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L13323" data-line-number="13323"></td>
        <td id="LC13323">            <span>_ASSERTE</span>(cbGCRefMap &gt; <span>0</span>);</td>
      </tr>
      <tr>
        <td id="L13324" data-line-number="13324"></td>
        <td id="LC13324">
</td>
      </tr>
      <tr>
        <td id="L13325" data-line-number="13325"></td>
        <td id="LC13325">            BYTE * pGCRefMap = (BYTE *)<span>_alloca</span>(cbGCRefMap);</td>
      </tr>
      <tr>
        <td id="L13326" data-line-number="13326"></td>
        <td id="LC13326">
</td>
      </tr>
      <tr>
        <td id="L13327" data-line-number="13327"></td>
        <td id="LC13327">            <span>ComputeGCRefMap</span>(pMT, pGCRefMap, cbGCRefMap);</td>
      </tr>
      <tr>
        <td id="L13328" data-line-number="13328"></td>
        <td id="LC13328">
</td>
      </tr>
      <tr>
        <td id="L13329" data-line-number="13329"></td>
        <td id="LC13329">            <span>if</span> (<span>memcmp</span>(pGCRefMap, p.<span>GetPtr</span>(), cbGCRefMap) != <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L13330" data-line-number="13330"></td>
        <td id="LC13330">                <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13331" data-line-number="13331"></td>
        <td id="LC13331">        }</td>
      </tr>
      <tr>
        <td id="L13332" data-line-number="13332"></td>
        <td id="LC13332">    }</td>
      </tr>
      <tr>
        <td id="L13333" data-line-number="13333"></td>
        <td id="LC13333">
</td>
      </tr>
      <tr>
        <td id="L13334" data-line-number="13334"></td>
        <td id="LC13334">    <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L13335" data-line-number="13335"></td>
        <td id="LC13335">}</td>
      </tr>
      <tr>
        <td id="L13336" data-line-number="13336"></td>
        <td id="LC13336">
</td>
      </tr>
      <tr>
        <td id="L13337" data-line-number="13337"></td>
        <td id="LC13337">#<span>endif</span> <span><span>//</span> FEATURE_READYTORUN</span></td>
      </tr>
      <tr>
        <td id="L13338" data-line-number="13338"></td>
        <td id="LC13338">
</td>
      </tr>
      <tr>
        <td id="L13339" data-line-number="13339"></td>
        <td id="LC13339">BOOL <span>LoadDynamicInfoEntry</span>(Module *currentModule,</td>
      </tr>
      <tr>
        <td id="L13340" data-line-number="13340"></td>
        <td id="LC13340">                          RVA fixupRva,</td>
      </tr>
      <tr>
        <td id="L13341" data-line-number="13341"></td>
        <td id="LC13341">                          SIZE_T *entry)</td>
      </tr>
      <tr>
        <td id="L13342" data-line-number="13342"></td>
        <td id="LC13342">{</td>
      </tr>
      <tr>
        <td id="L13343" data-line-number="13343"></td>
        <td id="LC13343">    STANDARD_VM_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13344" data-line-number="13344"></td>
        <td id="LC13344">
</td>
      </tr>
      <tr>
        <td id="L13345" data-line-number="13345"></td>
        <td id="LC13345">    PCCOR_SIGNATURE pBlob = currentModule-&gt;<span>GetNativeFixupBlobData</span>(fixupRva);</td>
      </tr>
      <tr>
        <td id="L13346" data-line-number="13346"></td>
        <td id="LC13346">
</td>
      </tr>
      <tr>
        <td id="L13347" data-line-number="13347"></td>
        <td id="LC13347">    BYTE kind = *pBlob++;</td>
      </tr>
      <tr>
        <td id="L13348" data-line-number="13348"></td>
        <td id="LC13348">
</td>
      </tr>
      <tr>
        <td id="L13349" data-line-number="13349"></td>
        <td id="LC13349">    Module * pInfoModule = currentModule;</td>
      </tr>
      <tr>
        <td id="L13350" data-line-number="13350"></td>
        <td id="LC13350">
</td>
      </tr>
      <tr>
        <td id="L13351" data-line-number="13351"></td>
        <td id="LC13351">    <span>if</span> (kind &amp; ENCODE_MODULE_OVERRIDE)</td>
      </tr>
      <tr>
        <td id="L13352" data-line-number="13352"></td>
        <td id="LC13352">    {</td>
      </tr>
      <tr>
        <td id="L13353" data-line-number="13353"></td>
        <td id="LC13353">        pInfoModule = currentModule-&gt;<span>GetModuleFromIndex</span>(<span>CorSigUncompressData</span>(pBlob));</td>
      </tr>
      <tr>
        <td id="L13354" data-line-number="13354"></td>
        <td id="LC13354">        kind &amp;= ~ENCODE_MODULE_OVERRIDE;</td>
      </tr>
      <tr>
        <td id="L13355" data-line-number="13355"></td>
        <td id="LC13355">    }</td>
      </tr>
      <tr>
        <td id="L13356" data-line-number="13356"></td>
        <td id="LC13356">
</td>
      </tr>
      <tr>
        <td id="L13357" data-line-number="13357"></td>
        <td id="LC13357">    MethodDesc * pMD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L13358" data-line-number="13358"></td>
        <td id="LC13358">
</td>
      </tr>
      <tr>
        <td id="L13359" data-line-number="13359"></td>
        <td id="LC13359">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L13360" data-line-number="13360"></td>
        <td id="LC13360">    PCCOR_SIGNATURE pSig;</td>
      </tr>
      <tr>
        <td id="L13361" data-line-number="13361"></td>
        <td id="LC13361">    DWORD cSig;</td>
      </tr>
      <tr>
        <td id="L13362" data-line-number="13362"></td>
        <td id="LC13362">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L13363" data-line-number="13363"></td>
        <td id="LC13363">
</td>
      </tr>
      <tr>
        <td id="L13364" data-line-number="13364"></td>
        <td id="LC13364">    <span>size_t</span> result = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L13365" data-line-number="13365"></td>
        <td id="LC13365">
</td>
      </tr>
      <tr>
        <td id="L13366" data-line-number="13366"></td>
        <td id="LC13366">    <span>switch</span> (kind)</td>
      </tr>
      <tr>
        <td id="L13367" data-line-number="13367"></td>
        <td id="LC13367">    {</td>
      </tr>
      <tr>
        <td id="L13368" data-line-number="13368"></td>
        <td id="LC13368">    <span>case</span> ENCODE_MODULE_HANDLE:</td>
      </tr>
      <tr>
        <td id="L13369" data-line-number="13369"></td>
        <td id="LC13369">        result = (<span>size_t</span>)pInfoModule;</td>
      </tr>
      <tr>
        <td id="L13370" data-line-number="13370"></td>
        <td id="LC13370">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13371" data-line-number="13371"></td>
        <td id="LC13371">
</td>
      </tr>
      <tr>
        <td id="L13372" data-line-number="13372"></td>
        <td id="LC13372">    <span>case</span> ENCODE_TYPE_HANDLE:</td>
      </tr>
      <tr>
        <td id="L13373" data-line-number="13373"></td>
        <td id="LC13373">    <span>case</span> ENCODE_TYPE_DICTIONARY:</td>
      </tr>
      <tr>
        <td id="L13374" data-line-number="13374"></td>
        <td id="LC13374">        {</td>
      </tr>
      <tr>
        <td id="L13375" data-line-number="13375"></td>
        <td id="LC13375">            TypeHandle th = <span>ZapSig::DecodeType</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13376" data-line-number="13376"></td>
        <td id="LC13376">
</td>
      </tr>
      <tr>
        <td id="L13377" data-line-number="13377"></td>
        <td id="LC13377">            <span>if</span> (!th.<span>IsTypeDesc</span>())</td>
      </tr>
      <tr>
        <td id="L13378" data-line-number="13378"></td>
        <td id="LC13378">            {</td>
      </tr>
      <tr>
        <td id="L13379" data-line-number="13379"></td>
        <td id="LC13379">                <span>if</span> (currentModule-&gt;<span>IsReadyToRun</span>())</td>
      </tr>
      <tr>
        <td id="L13380" data-line-number="13380"></td>
        <td id="LC13380">                {</td>
      </tr>
      <tr>
        <td id="L13381" data-line-number="13381"></td>
        <td id="LC13381">                    <span><span>//</span> We do not emit activation fixups for version resilient references. Activate the target explicitly.</span></td>
      </tr>
      <tr>
        <td id="L13382" data-line-number="13382"></td>
        <td id="LC13382">                    th.<span>AsMethodTable</span>()-&gt;<span>EnsureInstanceActive</span>();</td>
      </tr>
      <tr>
        <td id="L13383" data-line-number="13383"></td>
        <td id="LC13383">                }</td>
      </tr>
      <tr>
        <td id="L13384" data-line-number="13384"></td>
        <td id="LC13384">                <span>else</span></td>
      </tr>
      <tr>
        <td id="L13385" data-line-number="13385"></td>
        <td id="LC13385">                {</td>
      </tr>
      <tr>
        <td id="L13386" data-line-number="13386"></td>
        <td id="LC13386">#<span>ifdef</span> FEATURE_WINMD_RESILIENT</td>
      </tr>
      <tr>
        <td id="L13387" data-line-number="13387"></td>
        <td id="LC13387">                    <span><span>//</span> We do not emit activation fixups for version resilient references. Activate the target explicitly.</span></td>
      </tr>
      <tr>
        <td id="L13388" data-line-number="13388"></td>
        <td id="LC13388">                    th.<span>AsMethodTable</span>()-&gt;<span>EnsureInstanceActive</span>();</td>
      </tr>
      <tr>
        <td id="L13389" data-line-number="13389"></td>
        <td id="LC13389">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13390" data-line-number="13390"></td>
        <td id="LC13390">                }</td>
      </tr>
      <tr>
        <td id="L13391" data-line-number="13391"></td>
        <td id="LC13391">            }</td>
      </tr>
      <tr>
        <td id="L13392" data-line-number="13392"></td>
        <td id="LC13392">
</td>
      </tr>
      <tr>
        <td id="L13393" data-line-number="13393"></td>
        <td id="LC13393">            result = (<span>size_t</span>)th.<span>AsPtr</span>();</td>
      </tr>
      <tr>
        <td id="L13394" data-line-number="13394"></td>
        <td id="LC13394">        }</td>
      </tr>
      <tr>
        <td id="L13395" data-line-number="13395"></td>
        <td id="LC13395">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13396" data-line-number="13396"></td>
        <td id="LC13396">
</td>
      </tr>
      <tr>
        <td id="L13397" data-line-number="13397"></td>
        <td id="LC13397">    <span>case</span> ENCODE_METHOD_HANDLE:</td>
      </tr>
      <tr>
        <td id="L13398" data-line-number="13398"></td>
        <td id="LC13398">    <span>case</span> ENCODE_METHOD_DICTIONARY:</td>
      </tr>
      <tr>
        <td id="L13399" data-line-number="13399"></td>
        <td id="LC13399">        {</td>
      </tr>
      <tr>
        <td id="L13400" data-line-number="13400"></td>
        <td id="LC13400">            MethodDesc * pMD = <span>ZapSig::DecodeMethod</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13401" data-line-number="13401"></td>
        <td id="LC13401">
</td>
      </tr>
      <tr>
        <td id="L13402" data-line-number="13402"></td>
        <td id="LC13402">            <span>if</span> (currentModule-&gt;<span>IsReadyToRun</span>())</td>
      </tr>
      <tr>
        <td id="L13403" data-line-number="13403"></td>
        <td id="LC13403">            {</td>
      </tr>
      <tr>
        <td id="L13404" data-line-number="13404"></td>
        <td id="LC13404">                <span><span>//</span> We do not emit activation fixups for version resilient references. Activate the target explicitly.</span></td>
      </tr>
      <tr>
        <td id="L13405" data-line-number="13405"></td>
        <td id="LC13405">                pMD-&gt;<span>EnsureActive</span>();</td>
      </tr>
      <tr>
        <td id="L13406" data-line-number="13406"></td>
        <td id="LC13406">            }</td>
      </tr>
      <tr>
        <td id="L13407" data-line-number="13407"></td>
        <td id="LC13407">
</td>
      </tr>
      <tr>
        <td id="L13408" data-line-number="13408"></td>
        <td id="LC13408">            result = (<span>size_t</span>)pMD;</td>
      </tr>
      <tr>
        <td id="L13409" data-line-number="13409"></td>
        <td id="LC13409">        }</td>
      </tr>
      <tr>
        <td id="L13410" data-line-number="13410"></td>
        <td id="LC13410">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13411" data-line-number="13411"></td>
        <td id="LC13411">
</td>
      </tr>
      <tr>
        <td id="L13412" data-line-number="13412"></td>
        <td id="LC13412">    <span>case</span> ENCODE_FIELD_HANDLE:</td>
      </tr>
      <tr>
        <td id="L13413" data-line-number="13413"></td>
        <td id="LC13413">        result = (<span>size_t</span>) <span>ZapSig::DecodeField</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13414" data-line-number="13414"></td>
        <td id="LC13414">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13415" data-line-number="13415"></td>
        <td id="LC13415">
</td>
      </tr>
      <tr>
        <td id="L13416" data-line-number="13416"></td>
        <td id="LC13416">#<span>ifndef</span> CROSSGEN_COMPILE</td>
      </tr>
      <tr>
        <td id="L13417" data-line-number="13417"></td>
        <td id="LC13417">    <span>case</span> ENCODE_STRING_HANDLE:</td>
      </tr>
      <tr>
        <td id="L13418" data-line-number="13418"></td>
        <td id="LC13418">        {</td>
      </tr>
      <tr>
        <td id="L13419" data-line-number="13419"></td>
        <td id="LC13419">            <span><span>//</span> We need to update strings atomically (due to NoStringInterning attribute). Note</span></td>
      </tr>
      <tr>
        <td id="L13420" data-line-number="13420"></td>
        <td id="LC13420">            <span><span>//</span> that modules with string interning dont really need this, as the hash tables have</span></td>
      </tr>
      <tr>
        <td id="L13421" data-line-number="13421"></td>
        <td id="LC13421">            <span><span>//</span> their own locking, but dont add more complexity for what will be the non common</span></td>
      </tr>
      <tr>
        <td id="L13422" data-line-number="13422"></td>
        <td id="LC13422">            <span><span>//</span> case.</span></td>
      </tr>
      <tr>
        <td id="L13423" data-line-number="13423"></td>
        <td id="LC13423">
</td>
      </tr>
      <tr>
        <td id="L13424" data-line-number="13424"></td>
        <td id="LC13424">            <span><span>//</span> We will have to lock and update the entry. (this is really a double check, where</span></td>
      </tr>
      <tr>
        <td id="L13425" data-line-number="13425"></td>
        <td id="LC13425">            <span><span>//</span> the first check is done in the caller of this function)</span></td>
      </tr>
      <tr>
        <td id="L13426" data-line-number="13426"></td>
        <td id="LC13426">            DWORD rid = <span>CorSigUncompressData</span>(pBlob);</td>
      </tr>
      <tr>
        <td id="L13427" data-line-number="13427"></td>
        <td id="LC13427">            <span>if</span> (rid == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L13428" data-line-number="13428"></td>
        <td id="LC13428">            {</td>
      </tr>
      <tr>
        <td id="L13429" data-line-number="13429"></td>
        <td id="LC13429">                <span><span>//</span> Empty string</span></td>
      </tr>
      <tr>
        <td id="L13430" data-line-number="13430"></td>
        <td id="LC13430">                result = (<span>size_t</span>)<span>StringObject::GetEmptyStringRefPtr</span>();</td>
      </tr>
      <tr>
        <td id="L13431" data-line-number="13431"></td>
        <td id="LC13431">            }</td>
      </tr>
      <tr>
        <td id="L13432" data-line-number="13432"></td>
        <td id="LC13432">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L13433" data-line-number="13433"></td>
        <td id="LC13433">            {</td>
      </tr>
      <tr>
        <td id="L13434" data-line-number="13434"></td>
        <td id="LC13434">                CrstHolder <span>ch</span>(pInfoModule-&gt;<span>GetFixupCrst</span>());</td>
      </tr>
      <tr>
        <td id="L13435" data-line-number="13435"></td>
        <td id="LC13435">
</td>
      </tr>
      <tr>
        <td id="L13436" data-line-number="13436"></td>
        <td id="LC13436">                <span>if</span> (!<span>CORCOMPILE_IS_POINTER_TAGGED</span>(*entry) &amp;&amp; (*entry != <span>NULL</span>))</td>
      </tr>
      <tr>
        <td id="L13437" data-line-number="13437"></td>
        <td id="LC13437">                {</td>
      </tr>
      <tr>
        <td id="L13438" data-line-number="13438"></td>
        <td id="LC13438">                    <span><span>//</span> We lost the race, just return</span></td>
      </tr>
      <tr>
        <td id="L13439" data-line-number="13439"></td>
        <td id="LC13439">                    <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L13440" data-line-number="13440"></td>
        <td id="LC13440">                }</td>
      </tr>
      <tr>
        <td id="L13441" data-line-number="13441"></td>
        <td id="LC13441">
</td>
      </tr>
      <tr>
        <td id="L13442" data-line-number="13442"></td>
        <td id="LC13442">                <span><span>//</span> For generic instantiations compiled into the ngen image of some other</span></td>
      </tr>
      <tr>
        <td id="L13443" data-line-number="13443"></td>
        <td id="LC13443">                <span><span>//</span> client assembly, we need to ensure that we intern the string</span></td>
      </tr>
      <tr>
        <td id="L13444" data-line-number="13444"></td>
        <td id="LC13444">                <span><span>//</span> in the defining assembly.</span></td>
      </tr>
      <tr>
        <td id="L13445" data-line-number="13445"></td>
        <td id="LC13445">                <span>bool</span> mayNeedToSyncWithFixups = pInfoModule != currentModule;</td>
      </tr>
      <tr>
        <td id="L13446" data-line-number="13446"></td>
        <td id="LC13446">
</td>
      </tr>
      <tr>
        <td id="L13447" data-line-number="13447"></td>
        <td id="LC13447">                result = (<span>size_t</span>) pInfoModule-&gt;<span>ResolveStringRef</span>(<span>TokenFromRid</span>(rid, mdtString), currentModule-&gt;<span>GetDomain</span>(), mayNeedToSyncWithFixups);</td>
      </tr>
      <tr>
        <td id="L13448" data-line-number="13448"></td>
        <td id="LC13448">            }</td>
      </tr>
      <tr>
        <td id="L13449" data-line-number="13449"></td>
        <td id="LC13449">        }</td>
      </tr>
      <tr>
        <td id="L13450" data-line-number="13450"></td>
        <td id="LC13450">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13451" data-line-number="13451"></td>
        <td id="LC13451">
</td>
      </tr>
      <tr>
        <td id="L13452" data-line-number="13452"></td>
        <td id="LC13452">    <span>case</span> ENCODE_VARARGS_SIG:</td>
      </tr>
      <tr>
        <td id="L13453" data-line-number="13453"></td>
        <td id="LC13453">        {</td>
      </tr>
      <tr>
        <td id="L13454" data-line-number="13454"></td>
        <td id="LC13454">            mdSignature token = <span>TokenFromRid</span>(</td>
      </tr>
      <tr>
        <td id="L13455" data-line-number="13455"></td>
        <td id="LC13455">                                    <span>CorSigUncompressData</span>(pBlob),</td>
      </tr>
      <tr>
        <td id="L13456" data-line-number="13456"></td>
        <td id="LC13456">                                    mdtSignature);</td>
      </tr>
      <tr>
        <td id="L13457" data-line-number="13457"></td>
        <td id="LC13457">
</td>
      </tr>
      <tr>
        <td id="L13458" data-line-number="13458"></td>
        <td id="LC13458">            <span>IfFailThrow</span>(pInfoModule-&gt;<span>GetMDImport</span>()-&gt;<span>GetSigFromToken</span>(token, &amp;cSig, &amp;pSig));</td>
      </tr>
      <tr>
        <td id="L13459" data-line-number="13459"></td>
        <td id="LC13459">
</td>
      </tr>
      <tr>
        <td id="L13460" data-line-number="13460"></td>
        <td id="LC13460">            <span>goto</span> VarArgs;</td>
      </tr>
      <tr>
        <td id="L13461" data-line-number="13461"></td>
        <td id="LC13461">        }</td>
      </tr>
      <tr>
        <td id="L13462" data-line-number="13462"></td>
        <td id="LC13462">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13463" data-line-number="13463"></td>
        <td id="LC13463">
</td>
      </tr>
      <tr>
        <td id="L13464" data-line-number="13464"></td>
        <td id="LC13464">    <span>case</span> ENCODE_VARARGS_METHODREF:</td>
      </tr>
      <tr>
        <td id="L13465" data-line-number="13465"></td>
        <td id="LC13465">        {</td>
      </tr>
      <tr>
        <td id="L13466" data-line-number="13466"></td>
        <td id="LC13466">            mdSignature token = <span>TokenFromRid</span>(</td>
      </tr>
      <tr>
        <td id="L13467" data-line-number="13467"></td>
        <td id="LC13467">                                    <span>CorSigUncompressData</span>(pBlob),</td>
      </tr>
      <tr>
        <td id="L13468" data-line-number="13468"></td>
        <td id="LC13468">                                    mdtMemberRef);</td>
      </tr>
      <tr>
        <td id="L13469" data-line-number="13469"></td>
        <td id="LC13469">
</td>
      </tr>
      <tr>
        <td id="L13470" data-line-number="13470"></td>
        <td id="LC13470">            LPCSTR szName_Ignore;</td>
      </tr>
      <tr>
        <td id="L13471" data-line-number="13471"></td>
        <td id="LC13471">            <span>IfFailThrow</span>(pInfoModule-&gt;<span>GetMDImport</span>()-&gt;<span>GetNameAndSigOfMemberRef</span>(token, &amp;pSig, &amp;cSig, &amp;szName_Ignore));</td>
      </tr>
      <tr>
        <td id="L13472" data-line-number="13472"></td>
        <td id="LC13472">
</td>
      </tr>
      <tr>
        <td id="L13473" data-line-number="13473"></td>
        <td id="LC13473">            <span>goto</span> VarArgs;</td>
      </tr>
      <tr>
        <td id="L13474" data-line-number="13474"></td>
        <td id="LC13474">        }</td>
      </tr>
      <tr>
        <td id="L13475" data-line-number="13475"></td>
        <td id="LC13475">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13476" data-line-number="13476"></td>
        <td id="LC13476">
</td>
      </tr>
      <tr>
        <td id="L13477" data-line-number="13477"></td>
        <td id="LC13477">    <span>case</span> ENCODE_VARARGS_METHODDEF:</td>
      </tr>
      <tr>
        <td id="L13478" data-line-number="13478"></td>
        <td id="LC13478">        {</td>
      </tr>
      <tr>
        <td id="L13479" data-line-number="13479"></td>
        <td id="LC13479">            mdSignature token = <span>TokenFromRid</span>(</td>
      </tr>
      <tr>
        <td id="L13480" data-line-number="13480"></td>
        <td id="LC13480">                                    <span>CorSigUncompressData</span>(pBlob),</td>
      </tr>
      <tr>
        <td id="L13481" data-line-number="13481"></td>
        <td id="LC13481">                                    mdtMethodDef);</td>
      </tr>
      <tr>
        <td id="L13482" data-line-number="13482"></td>
        <td id="LC13482">
</td>
      </tr>
      <tr>
        <td id="L13483" data-line-number="13483"></td>
        <td id="LC13483">            <span>IfFailThrow</span>(pInfoModule-&gt;<span>GetMDImport</span>()-&gt;<span>GetSigOfMethodDef</span>(token, &amp;cSig, &amp;pSig));</td>
      </tr>
      <tr>
        <td id="L13484" data-line-number="13484"></td>
        <td id="LC13484">        }</td>
      </tr>
      <tr>
        <td id="L13485" data-line-number="13485"></td>
        <td id="LC13485">        {</td>
      </tr>
      <tr>
        <td id="L13486" data-line-number="13486"></td>
        <td id="LC13486">        VarArgs:</td>
      </tr>
      <tr>
        <td id="L13487" data-line-number="13487"></td>
        <td id="LC13487">            result = (<span>size_t</span>) <span>CORINFO_VARARGS_HANDLE</span>(currentModule-&gt;<span>GetVASigCookie</span>(<span>Signature</span>(pSig, cSig)));</td>
      </tr>
      <tr>
        <td id="L13488" data-line-number="13488"></td>
        <td id="LC13488">        }</td>
      </tr>
      <tr>
        <td id="L13489" data-line-number="13489"></td>
        <td id="LC13489">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13490" data-line-number="13490"></td>
        <td id="LC13490">
</td>
      </tr>
      <tr>
        <td id="L13491" data-line-number="13491"></td>
        <td id="LC13491">        <span><span>//</span> ENCODE_METHOD_NATIVECALLABLE_HANDLE is same as ENCODE_METHOD_ENTRY_DEF_TOKEN</span></td>
      </tr>
      <tr>
        <td id="L13492" data-line-number="13492"></td>
        <td id="LC13492">        <span><span>//</span> except for AddrOfCode</span></td>
      </tr>
      <tr>
        <td id="L13493" data-line-number="13493"></td>
        <td id="LC13493">    <span>case</span> ENCODE_METHOD_NATIVE_ENTRY:</td>
      </tr>
      <tr>
        <td id="L13494" data-line-number="13494"></td>
        <td id="LC13494">    <span>case</span> ENCODE_METHOD_ENTRY_DEF_TOKEN:</td>
      </tr>
      <tr>
        <td id="L13495" data-line-number="13495"></td>
        <td id="LC13495">        {</td>
      </tr>
      <tr>
        <td id="L13496" data-line-number="13496"></td>
        <td id="LC13496">            mdToken MethodDef = <span>TokenFromRid</span>(<span>CorSigUncompressData</span>(pBlob), mdtMethodDef);</td>
      </tr>
      <tr>
        <td id="L13497" data-line-number="13497"></td>
        <td id="LC13497">            pMD = <span>MemberLoader::GetMethodDescFromMethodDef</span>(pInfoModule, MethodDef, <span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L13498" data-line-number="13498"></td>
        <td id="LC13498">
</td>
      </tr>
      <tr>
        <td id="L13499" data-line-number="13499"></td>
        <td id="LC13499">            pMD-&gt;<span>PrepareForUseAsADependencyOfANativeImage</span>();</td>
      </tr>
      <tr>
        <td id="L13500" data-line-number="13500"></td>
        <td id="LC13500">
</td>
      </tr>
      <tr>
        <td id="L13501" data-line-number="13501"></td>
        <td id="LC13501">            <span>if</span> (currentModule-&gt;<span>IsReadyToRun</span>())</td>
      </tr>
      <tr>
        <td id="L13502" data-line-number="13502"></td>
        <td id="LC13502">            {</td>
      </tr>
      <tr>
        <td id="L13503" data-line-number="13503"></td>
        <td id="LC13503">                <span><span>//</span> We do not emit activation fixups for version resilient references. Activate the target explicitly.</span></td>
      </tr>
      <tr>
        <td id="L13504" data-line-number="13504"></td>
        <td id="LC13504">                pMD-&gt;<span>EnsureActive</span>();</td>
      </tr>
      <tr>
        <td id="L13505" data-line-number="13505"></td>
        <td id="LC13505">            }</td>
      </tr>
      <tr>
        <td id="L13506" data-line-number="13506"></td>
        <td id="LC13506">
</td>
      </tr>
      <tr>
        <td id="L13507" data-line-number="13507"></td>
        <td id="LC13507">            <span>goto</span> MethodEntry;</td>
      </tr>
      <tr>
        <td id="L13508" data-line-number="13508"></td>
        <td id="LC13508">        }</td>
      </tr>
      <tr>
        <td id="L13509" data-line-number="13509"></td>
        <td id="LC13509">
</td>
      </tr>
      <tr>
        <td id="L13510" data-line-number="13510"></td>
        <td id="LC13510">    <span>case</span> ENCODE_METHOD_ENTRY_REF_TOKEN:</td>
      </tr>
      <tr>
        <td id="L13511" data-line-number="13511"></td>
        <td id="LC13511">        {</td>
      </tr>
      <tr>
        <td id="L13512" data-line-number="13512"></td>
        <td id="LC13512">            SigTypeContext typeContext;</td>
      </tr>
      <tr>
        <td id="L13513" data-line-number="13513"></td>
        <td id="LC13513">            mdToken MemberRef = <span>TokenFromRid</span>(<span>CorSigUncompressData</span>(pBlob), mdtMemberRef);</td>
      </tr>
      <tr>
        <td id="L13514" data-line-number="13514"></td>
        <td id="LC13514">            FieldDesc * pFD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L13515" data-line-number="13515"></td>
        <td id="LC13515">            TypeHandle th;</td>
      </tr>
      <tr>
        <td id="L13516" data-line-number="13516"></td>
        <td id="LC13516">
</td>
      </tr>
      <tr>
        <td id="L13517" data-line-number="13517"></td>
        <td id="LC13517">            <span>MemberLoader::GetDescFromMemberRef</span>(pInfoModule, MemberRef, &amp;pMD, &amp;pFD, &amp;typeContext, <span>FALSE</span> <span><span>/*</span> strict metadata checks <span>*/</span></span>, &amp;th);</td>
      </tr>
      <tr>
        <td id="L13518" data-line-number="13518"></td>
        <td id="LC13518">            <span>_ASSERTE</span>(pMD != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L13519" data-line-number="13519"></td>
        <td id="LC13519">
</td>
      </tr>
      <tr>
        <td id="L13520" data-line-number="13520"></td>
        <td id="LC13520">            pMD-&gt;<span>PrepareForUseAsADependencyOfANativeImage</span>();</td>
      </tr>
      <tr>
        <td id="L13521" data-line-number="13521"></td>
        <td id="LC13521">
</td>
      </tr>
      <tr>
        <td id="L13522" data-line-number="13522"></td>
        <td id="LC13522">            <span>if</span> (currentModule-&gt;<span>IsReadyToRun</span>())</td>
      </tr>
      <tr>
        <td id="L13523" data-line-number="13523"></td>
        <td id="LC13523">            {</td>
      </tr>
      <tr>
        <td id="L13524" data-line-number="13524"></td>
        <td id="LC13524">                <span><span>//</span> We do not emit activation fixups for version resilient references. Activate the target explicitly.</span></td>
      </tr>
      <tr>
        <td id="L13525" data-line-number="13525"></td>
        <td id="LC13525">                pMD-&gt;<span>EnsureActive</span>();</td>
      </tr>
      <tr>
        <td id="L13526" data-line-number="13526"></td>
        <td id="LC13526">            }</td>
      </tr>
      <tr>
        <td id="L13527" data-line-number="13527"></td>
        <td id="LC13527">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L13528" data-line-number="13528"></td>
        <td id="LC13528">            {</td>
      </tr>
      <tr>
        <td id="L13529" data-line-number="13529"></td>
        <td id="LC13529">#<span>ifdef</span> FEATURE_WINMD_RESILIENT</td>
      </tr>
      <tr>
        <td id="L13530" data-line-number="13530"></td>
        <td id="LC13530">                <span><span>//</span> We do not emit activation fixups for version resilient references. Activate the target explicitly.</span></td>
      </tr>
      <tr>
        <td id="L13531" data-line-number="13531"></td>
        <td id="LC13531">                pMD-&gt;<span>EnsureActive</span>();</td>
      </tr>
      <tr>
        <td id="L13532" data-line-number="13532"></td>
        <td id="LC13532">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13533" data-line-number="13533"></td>
        <td id="LC13533">            }</td>
      </tr>
      <tr>
        <td id="L13534" data-line-number="13534"></td>
        <td id="LC13534">
</td>
      </tr>
      <tr>
        <td id="L13535" data-line-number="13535"></td>
        <td id="LC13535">            <span>goto</span> MethodEntry;</td>
      </tr>
      <tr>
        <td id="L13536" data-line-number="13536"></td>
        <td id="LC13536">        }</td>
      </tr>
      <tr>
        <td id="L13537" data-line-number="13537"></td>
        <td id="LC13537">
</td>
      </tr>
      <tr>
        <td id="L13538" data-line-number="13538"></td>
        <td id="LC13538">    <span>case</span> ENCODE_METHOD_ENTRY:</td>
      </tr>
      <tr>
        <td id="L13539" data-line-number="13539"></td>
        <td id="LC13539">        {</td>
      </tr>
      <tr>
        <td id="L13540" data-line-number="13540"></td>
        <td id="LC13540">            pMD = <span>ZapSig::DecodeMethod</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13541" data-line-number="13541"></td>
        <td id="LC13541">
</td>
      </tr>
      <tr>
        <td id="L13542" data-line-number="13542"></td>
        <td id="LC13542">            <span>if</span> (currentModule-&gt;<span>IsReadyToRun</span>())</td>
      </tr>
      <tr>
        <td id="L13543" data-line-number="13543"></td>
        <td id="LC13543">            {</td>
      </tr>
      <tr>
        <td id="L13544" data-line-number="13544"></td>
        <td id="LC13544">                <span><span>//</span> We do not emit activation fixups for version resilient references. Activate the target explicitly.</span></td>
      </tr>
      <tr>
        <td id="L13545" data-line-number="13545"></td>
        <td id="LC13545">                pMD-&gt;<span>EnsureActive</span>();</td>
      </tr>
      <tr>
        <td id="L13546" data-line-number="13546"></td>
        <td id="LC13546">            }</td>
      </tr>
      <tr>
        <td id="L13547" data-line-number="13547"></td>
        <td id="LC13547">
</td>
      </tr>
      <tr>
        <td id="L13548" data-line-number="13548"></td>
        <td id="LC13548">        MethodEntry:</td>
      </tr>
      <tr>
        <td id="L13549" data-line-number="13549"></td>
        <td id="LC13549">            <span>if</span> (kind == ENCODE_METHOD_NATIVE_ENTRY)</td>
      </tr>
      <tr>
        <td id="L13550" data-line-number="13550"></td>
        <td id="LC13550">            {</td>
      </tr>
      <tr>
        <td id="L13551" data-line-number="13551"></td>
        <td id="LC13551">                result = <span>COMDelegate::ConvertToCallback</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L13552" data-line-number="13552"></td>
        <td id="LC13552">            }</td>
      </tr>
      <tr>
        <td id="L13553" data-line-number="13553"></td>
        <td id="LC13553">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L13554" data-line-number="13554"></td>
        <td id="LC13554">            {</td>
      </tr>
      <tr>
        <td id="L13555" data-line-number="13555"></td>
        <td id="LC13555">                result = pMD-&gt;<span>GetMultiCallableAddrOfCode</span>(CORINFO_ACCESS_ANY);</td>
      </tr>
      <tr>
        <td id="L13556" data-line-number="13556"></td>
        <td id="LC13556">            }</td>
      </tr>
      <tr>
        <td id="L13557" data-line-number="13557"></td>
        <td id="LC13557">
</td>
      </tr>
      <tr>
        <td id="L13558" data-line-number="13558"></td>
        <td id="LC13558">        #<span>ifndef</span> TARGET_ARM</td>
      </tr>
      <tr>
        <td id="L13559" data-line-number="13559"></td>
        <td id="LC13559">            <span>if</span> (<span>CORCOMPILE_IS_PCODE_TAGGED</span>(result))</td>
      </tr>
      <tr>
        <td id="L13560" data-line-number="13560"></td>
        <td id="LC13560">            {</td>
      </tr>
      <tr>
        <td id="L13561" data-line-number="13561"></td>
        <td id="LC13561">                <span><span>//</span> There is a rare case where the function entrypoint may not be aligned. This could happen only for FCalls,</span></td>
      </tr>
      <tr>
        <td id="L13562" data-line-number="13562"></td>
        <td id="LC13562">                <span><span>//</span> only on x86 and only if we failed to hardbind the fcall (e.g. ngen image for mscorlib.dll does not exist</span></td>
      </tr>
      <tr>
        <td id="L13563" data-line-number="13563"></td>
        <td id="LC13563">                <span><span>//</span> and /nodependencies flag for ngen was used). The function entrypoints should be aligned in all other cases.</span></td>
      </tr>
      <tr>
        <td id="L13564" data-line-number="13564"></td>
        <td id="LC13564">                <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L13565" data-line-number="13565"></td>
        <td id="LC13565">                <span><span>//</span> We will wrap the unaligned method entrypoint by funcptr stub with aligned entrypoint.</span></td>
      </tr>
      <tr>
        <td id="L13566" data-line-number="13566"></td>
        <td id="LC13566">                <span>_ASSERTE</span>(pMD-&gt;<span>IsFCall</span>());</td>
      </tr>
      <tr>
        <td id="L13567" data-line-number="13567"></td>
        <td id="LC13567">                result = pMD-&gt;<span>GetLoaderAllocator</span>()-&gt;<span>GetFuncPtrStubs</span>()-&gt;<span>GetFuncPtrStub</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L13568" data-line-number="13568"></td>
        <td id="LC13568">            }</td>
      </tr>
      <tr>
        <td id="L13569" data-line-number="13569"></td>
        <td id="LC13569">        #<span>endif</span></td>
      </tr>
      <tr>
        <td id="L13570" data-line-number="13570"></td>
        <td id="LC13570">        }</td>
      </tr>
      <tr>
        <td id="L13571" data-line-number="13571"></td>
        <td id="LC13571">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13572" data-line-number="13572"></td>
        <td id="LC13572">
</td>
      </tr>
      <tr>
        <td id="L13573" data-line-number="13573"></td>
        <td id="LC13573">    <span>case</span> ENCODE_SYNC_LOCK:</td>
      </tr>
      <tr>
        <td id="L13574" data-line-number="13574"></td>
        <td id="LC13574">        {</td>
      </tr>
      <tr>
        <td id="L13575" data-line-number="13575"></td>
        <td id="LC13575">            TypeHandle th = <span>ZapSig::DecodeType</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13576" data-line-number="13576"></td>
        <td id="LC13576">
</td>
      </tr>
      <tr>
        <td id="L13577" data-line-number="13577"></td>
        <td id="LC13577">            result = (<span>size_t</span>) <span>GetClassSync</span>(th.<span>AsMethodTable</span>());</td>
      </tr>
      <tr>
        <td id="L13578" data-line-number="13578"></td>
        <td id="LC13578">        }</td>
      </tr>
      <tr>
        <td id="L13579" data-line-number="13579"></td>
        <td id="LC13579">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13580" data-line-number="13580"></td>
        <td id="LC13580">
</td>
      </tr>
      <tr>
        <td id="L13581" data-line-number="13581"></td>
        <td id="LC13581">    <span>case</span> ENCODE_INDIRECT_PINVOKE_TARGET:</td>
      </tr>
      <tr>
        <td id="L13582" data-line-number="13582"></td>
        <td id="LC13582">        {</td>
      </tr>
      <tr>
        <td id="L13583" data-line-number="13583"></td>
        <td id="LC13583">            MethodDesc *pMethod = <span>ZapSig::DecodeMethod</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13584" data-line-number="13584"></td>
        <td id="LC13584">
</td>
      </tr>
      <tr>
        <td id="L13585" data-line-number="13585"></td>
        <td id="LC13585">            <span>_ASSERTE</span>(pMethod-&gt;<span>IsNDirect</span>());</td>
      </tr>
      <tr>
        <td id="L13586" data-line-number="13586"></td>
        <td id="LC13586">            NDirectMethodDesc *pMD = (NDirectMethodDesc*)pMethod;</td>
      </tr>
      <tr>
        <td id="L13587" data-line-number="13587"></td>
        <td id="LC13587">            result = (<span>size_t</span>)(LPVOID)&amp;(pMD-&gt;<span>GetWriteableData</span>()-&gt;<span>m_pNDirectTarget</span>);</td>
      </tr>
      <tr>
        <td id="L13588" data-line-number="13588"></td>
        <td id="LC13588">        }</td>
      </tr>
      <tr>
        <td id="L13589" data-line-number="13589"></td>
        <td id="LC13589">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13590" data-line-number="13590"></td>
        <td id="LC13590">
</td>
      </tr>
      <tr>
        <td id="L13591" data-line-number="13591"></td>
        <td id="LC13591">    <span>case</span> ENCODE_PINVOKE_TARGET:</td>
      </tr>
      <tr>
        <td id="L13592" data-line-number="13592"></td>
        <td id="LC13592">        {</td>
      </tr>
      <tr>
        <td id="L13593" data-line-number="13593"></td>
        <td id="LC13593">            MethodDesc *pMethod = <span>ZapSig::DecodeMethod</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13594" data-line-number="13594"></td>
        <td id="LC13594">
</td>
      </tr>
      <tr>
        <td id="L13595" data-line-number="13595"></td>
        <td id="LC13595">            <span>_ASSERTE</span>(pMethod-&gt;<span>IsNDirect</span>());</td>
      </tr>
      <tr>
        <td id="L13596" data-line-number="13596"></td>
        <td id="LC13596">            result = (<span>size_t</span>)(LPVOID)<span>NDirectMethodDesc::ResolveAndSetNDirectTarget</span>((NDirectMethodDesc*)pMethod);</td>
      </tr>
      <tr>
        <td id="L13597" data-line-number="13597"></td>
        <td id="LC13597">        }</td>
      </tr>
      <tr>
        <td id="L13598" data-line-number="13598"></td>
        <td id="LC13598">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13599" data-line-number="13599"></td>
        <td id="LC13599">
</td>
      </tr>
      <tr>
        <td id="L13600" data-line-number="13600"></td>
        <td id="LC13600">#<span>if</span> defined(PROFILING_SUPPORTED)</td>
      </tr>
      <tr>
        <td id="L13601" data-line-number="13601"></td>
        <td id="LC13601">    <span>case</span> ENCODE_PROFILING_HANDLE:</td>
      </tr>
      <tr>
        <td id="L13602" data-line-number="13602"></td>
        <td id="LC13602">        {</td>
      </tr>
      <tr>
        <td id="L13603" data-line-number="13603"></td>
        <td id="LC13603">            MethodDesc *pMethod = <span>ZapSig::DecodeMethod</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13604" data-line-number="13604"></td>
        <td id="LC13604">
</td>
      </tr>
      <tr>
        <td id="L13605" data-line-number="13605"></td>
        <td id="LC13605">            <span><span>//</span> methods with no metadata behind cannot be exposed to tools expecting metadata (profiler, debugger...)</span></td>
      </tr>
      <tr>
        <td id="L13606" data-line-number="13606"></td>
        <td id="LC13606">            <span><span>//</span> they shouldnever come here as they are called out in GetCompileFlag</span></td>
      </tr>
      <tr>
        <td id="L13607" data-line-number="13607"></td>
        <td id="LC13607">            <span>_ASSERTE</span>(!pMethod-&gt;<span>IsNoMetadata</span>());</td>
      </tr>
      <tr>
        <td id="L13608" data-line-number="13608"></td>
        <td id="LC13608">
</td>
      </tr>
      <tr>
        <td id="L13609" data-line-number="13609"></td>
        <td id="LC13609">            FunctionID funId = (FunctionID)pMethod;</td>
      </tr>
      <tr>
        <td id="L13610" data-line-number="13610"></td>
        <td id="LC13610">
</td>
      </tr>
      <tr>
        <td id="L13611" data-line-number="13611"></td>
        <td id="LC13611">            BOOL bHookFunction = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L13612" data-line-number="13612"></td>
        <td id="LC13612">            CORINFO_PROFILING_HANDLE profilerHandle = (CORINFO_PROFILING_HANDLE)funId;</td>
      </tr>
      <tr>
        <td id="L13613" data-line-number="13613"></td>
        <td id="LC13613">
</td>
      </tr>
      <tr>
        <td id="L13614" data-line-number="13614"></td>
        <td id="LC13614">            {</td>
      </tr>
      <tr>
        <td id="L13615" data-line-number="13615"></td>
        <td id="LC13615">                <span>BEGIN_PIN_PROFILER</span>(<span>CORProfilerFunctionIDMapperEnabled</span>());</td>
      </tr>
      <tr>
        <td id="L13616" data-line-number="13616"></td>
        <td id="LC13616">                profilerHandle = (CORINFO_PROFILING_HANDLE) g_profControlBlock.<span>pProfInterface</span>-&gt;<span>EEFunctionIDMapper</span>(funId, &amp;bHookFunction);</td>
      </tr>
      <tr>
        <td id="L13617" data-line-number="13617"></td>
        <td id="LC13617">                <span>END_PIN_PROFILER</span>();</td>
      </tr>
      <tr>
        <td id="L13618" data-line-number="13618"></td>
        <td id="LC13618">            }</td>
      </tr>
      <tr>
        <td id="L13619" data-line-number="13619"></td>
        <td id="LC13619">
</td>
      </tr>
      <tr>
        <td id="L13620" data-line-number="13620"></td>
        <td id="LC13620">            <span><span>//</span> Profiling handle is opaque token. It does not have to be aligned thus we can not store it in the same location as token.</span></td>
      </tr>
      <tr>
        <td id="L13621" data-line-number="13621"></td>
        <td id="LC13621">            *(entry+<span>kZapProfilingHandleImportValueIndexClientData</span>) = (SIZE_T)profilerHandle;</td>
      </tr>
      <tr>
        <td id="L13622" data-line-number="13622"></td>
        <td id="LC13622">
</td>
      </tr>
      <tr>
        <td id="L13623" data-line-number="13623"></td>
        <td id="LC13623">            <span>if</span> (bHookFunction)</td>
      </tr>
      <tr>
        <td id="L13624" data-line-number="13624"></td>
        <td id="LC13624">            {</td>
      </tr>
      <tr>
        <td id="L13625" data-line-number="13625"></td>
        <td id="LC13625">                *(entry+<span>kZapProfilingHandleImportValueIndexEnterAddr</span>) = (SIZE_T)(<span>void</span> *)hlpDynamicFuncTable[DYNAMIC_CORINFO_HELP_PROF_FCN_ENTER].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L13626" data-line-number="13626"></td>
        <td id="LC13626">                *(entry+<span>kZapProfilingHandleImportValueIndexLeaveAddr</span>) = (SIZE_T)(<span>void</span> *)hlpDynamicFuncTable[DYNAMIC_CORINFO_HELP_PROF_FCN_LEAVE].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L13627" data-line-number="13627"></td>
        <td id="LC13627">                *(entry+<span>kZapProfilingHandleImportValueIndexTailcallAddr</span>) = (SIZE_T)(<span>void</span> *)hlpDynamicFuncTable[DYNAMIC_CORINFO_HELP_PROF_FCN_TAILCALL].<span>pfnHelper</span>;</td>
      </tr>
      <tr>
        <td id="L13628" data-line-number="13628"></td>
        <td id="LC13628">            }</td>
      </tr>
      <tr>
        <td id="L13629" data-line-number="13629"></td>
        <td id="LC13629">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L13630" data-line-number="13630"></td>
        <td id="LC13630">            {</td>
      </tr>
      <tr>
        <td id="L13631" data-line-number="13631"></td>
        <td id="LC13631">                *(entry+<span>kZapProfilingHandleImportValueIndexEnterAddr</span>) = (SIZE_T)(<span>void</span> *)JIT_ProfilerEnterLeaveTailcallStub;</td>
      </tr>
      <tr>
        <td id="L13632" data-line-number="13632"></td>
        <td id="LC13632">                *(entry+<span>kZapProfilingHandleImportValueIndexLeaveAddr</span>) = (SIZE_T)(<span>void</span> *)JIT_ProfilerEnterLeaveTailcallStub;</td>
      </tr>
      <tr>
        <td id="L13633" data-line-number="13633"></td>
        <td id="LC13633">                *(entry+<span>kZapProfilingHandleImportValueIndexTailcallAddr</span>) = (SIZE_T)(<span>void</span> *)JIT_ProfilerEnterLeaveTailcallStub;</td>
      </tr>
      <tr>
        <td id="L13634" data-line-number="13634"></td>
        <td id="LC13634">            }</td>
      </tr>
      <tr>
        <td id="L13635" data-line-number="13635"></td>
        <td id="LC13635">        }</td>
      </tr>
      <tr>
        <td id="L13636" data-line-number="13636"></td>
        <td id="LC13636">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13637" data-line-number="13637"></td>
        <td id="LC13637">#<span>endif</span> <span><span>//</span> PROFILING_SUPPORTED</span></td>
      </tr>
      <tr>
        <td id="L13638" data-line-number="13638"></td>
        <td id="LC13638">
</td>
      </tr>
      <tr>
        <td id="L13639" data-line-number="13639"></td>
        <td id="LC13639">    <span>case</span> ENCODE_STATIC_FIELD_ADDRESS:</td>
      </tr>
      <tr>
        <td id="L13640" data-line-number="13640"></td>
        <td id="LC13640">        {</td>
      </tr>
      <tr>
        <td id="L13641" data-line-number="13641"></td>
        <td id="LC13641">            FieldDesc *pField = <span>ZapSig::DecodeField</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13642" data-line-number="13642"></td>
        <td id="LC13642">
</td>
      </tr>
      <tr>
        <td id="L13643" data-line-number="13643"></td>
        <td id="LC13643">            pField-&gt;<span>GetEnclosingMethodTable</span>()-&gt;<span>CheckRestore</span>();</td>
      </tr>
      <tr>
        <td id="L13644" data-line-number="13644"></td>
        <td id="LC13644">
</td>
      </tr>
      <tr>
        <td id="L13645" data-line-number="13645"></td>
        <td id="LC13645">            <span><span>//</span> We can take address of RVA field only since ngened code is domain neutral</span></td>
      </tr>
      <tr>
        <td id="L13646" data-line-number="13646"></td>
        <td id="LC13646">            <span>_ASSERTE</span>(pField-&gt;<span>IsRVA</span>());</td>
      </tr>
      <tr>
        <td id="L13647" data-line-number="13647"></td>
        <td id="LC13647">
</td>
      </tr>
      <tr>
        <td id="L13648" data-line-number="13648"></td>
        <td id="LC13648">            <span><span>//</span> Field address is not aligned thus we can not store it in the same location as token.</span></td>
      </tr>
      <tr>
        <td id="L13649" data-line-number="13649"></td>
        <td id="LC13649">            *(entry+<span>1</span>) = (<span>size_t</span>)pField-&gt;<span>GetStaticAddressHandle</span>(<span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L13650" data-line-number="13650"></td>
        <td id="LC13650">        }</td>
      </tr>
      <tr>
        <td id="L13651" data-line-number="13651"></td>
        <td id="LC13651">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13652" data-line-number="13652"></td>
        <td id="LC13652">
</td>
      </tr>
      <tr>
        <td id="L13653" data-line-number="13653"></td>
        <td id="LC13653">    <span>case</span> ENCODE_VIRTUAL_ENTRY_SLOT:</td>
      </tr>
      <tr>
        <td id="L13654" data-line-number="13654"></td>
        <td id="LC13654">        {</td>
      </tr>
      <tr>
        <td id="L13655" data-line-number="13655"></td>
        <td id="LC13655">            DWORD slot = <span>CorSigUncompressData</span>(pBlob);</td>
      </tr>
      <tr>
        <td id="L13656" data-line-number="13656"></td>
        <td id="LC13656">
</td>
      </tr>
      <tr>
        <td id="L13657" data-line-number="13657"></td>
        <td id="LC13657">            TypeHandle ownerType = <span>ZapSig::DecodeType</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13658" data-line-number="13658"></td>
        <td id="LC13658">
</td>
      </tr>
      <tr>
        <td id="L13659" data-line-number="13659"></td>
        <td id="LC13659">            <span>LOG</span>((LF_ZAP, LL_INFO100000, <span><span>"</span>     Fixup stub dispatch<span>\n</span><span>"</span></span>));</td>
      </tr>
      <tr>
        <td id="L13660" data-line-number="13660"></td>
        <td id="LC13660">
</td>
      </tr>
      <tr>
        <td id="L13661" data-line-number="13661"></td>
        <td id="LC13661">            VirtualCallStubManager * pMgr = currentModule-&gt;<span>GetLoaderAllocator</span>()-&gt;<span>GetVirtualCallStubManager</span>();</td>
      </tr>
      <tr>
        <td id="L13662" data-line-number="13662"></td>
        <td id="LC13662">
</td>
      </tr>
      <tr>
        <td id="L13663" data-line-number="13663"></td>
        <td id="LC13663">            <span><span>//</span> &lt;REVISIT_TODO&gt;</span></td>
      </tr>
      <tr>
        <td id="L13664" data-line-number="13664"></td>
        <td id="LC13664">            <span><span>//</span> We should be generating a stub indirection here, but the zapper already uses one level</span></td>
      </tr>
      <tr>
        <td id="L13665" data-line-number="13665"></td>
        <td id="LC13665">            <span><span>//</span> of indirection, i.e. we would have to return IAT_PPVALUE to the JIT, and on the whole the JITs</span></td>
      </tr>
      <tr>
        <td id="L13666" data-line-number="13666"></td>
        <td id="LC13666">            <span><span>//</span> aren't quite set up to accept that. Furthermore the call sequences would be different - at</span></td>
      </tr>
      <tr>
        <td id="L13667" data-line-number="13667"></td>
        <td id="LC13667">            <span><span>//</span> the moment an indirection cell uses "call [cell-addr]" on x86, and instead we would want the</span></td>
      </tr>
      <tr>
        <td id="L13668" data-line-number="13668"></td>
        <td id="LC13668">            <span><span>//</span> euqivalent of "call [[call-addr]]".  This could perhaps be implemented as "call [eax]" &lt;/REVISIT_TODO&gt;</span></td>
      </tr>
      <tr>
        <td id="L13669" data-line-number="13669"></td>
        <td id="LC13669">            result = pMgr-&gt;<span>GetCallStub</span>(ownerType, slot);</td>
      </tr>
      <tr>
        <td id="L13670" data-line-number="13670"></td>
        <td id="LC13670">        }</td>
      </tr>
      <tr>
        <td id="L13671" data-line-number="13671"></td>
        <td id="LC13671">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13672" data-line-number="13672"></td>
        <td id="LC13672">
</td>
      </tr>
      <tr>
        <td id="L13673" data-line-number="13673"></td>
        <td id="LC13673">    <span>case</span> ENCODE_CLASS_ID_FOR_STATICS:</td>
      </tr>
      <tr>
        <td id="L13674" data-line-number="13674"></td>
        <td id="LC13674">        {</td>
      </tr>
      <tr>
        <td id="L13675" data-line-number="13675"></td>
        <td id="LC13675">            TypeHandle th = <span>ZapSig::DecodeType</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13676" data-line-number="13676"></td>
        <td id="LC13676">
</td>
      </tr>
      <tr>
        <td id="L13677" data-line-number="13677"></td>
        <td id="LC13677">            MethodTable * pMT = th.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L13678" data-line-number="13678"></td>
        <td id="LC13678">            <span>if</span> (pMT-&gt;<span>IsDynamicStatics</span>())</td>
      </tr>
      <tr>
        <td id="L13679" data-line-number="13679"></td>
        <td id="LC13679">            {</td>
      </tr>
      <tr>
        <td id="L13680" data-line-number="13680"></td>
        <td id="LC13680">                result = pMT-&gt;<span>GetModuleDynamicEntryID</span>();</td>
      </tr>
      <tr>
        <td id="L13681" data-line-number="13681"></td>
        <td id="LC13681">            }</td>
      </tr>
      <tr>
        <td id="L13682" data-line-number="13682"></td>
        <td id="LC13682">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L13683" data-line-number="13683"></td>
        <td id="LC13683">            {</td>
      </tr>
      <tr>
        <td id="L13684" data-line-number="13684"></td>
        <td id="LC13684">                result = pMT-&gt;<span>GetClassIndex</span>();</td>
      </tr>
      <tr>
        <td id="L13685" data-line-number="13685"></td>
        <td id="LC13685">            }</td>
      </tr>
      <tr>
        <td id="L13686" data-line-number="13686"></td>
        <td id="LC13686">        }</td>
      </tr>
      <tr>
        <td id="L13687" data-line-number="13687"></td>
        <td id="LC13687">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13688" data-line-number="13688"></td>
        <td id="LC13688">
</td>
      </tr>
      <tr>
        <td id="L13689" data-line-number="13689"></td>
        <td id="LC13689">    <span>case</span> ENCODE_MODULE_ID_FOR_STATICS:</td>
      </tr>
      <tr>
        <td id="L13690" data-line-number="13690"></td>
        <td id="LC13690">        {</td>
      </tr>
      <tr>
        <td id="L13691" data-line-number="13691"></td>
        <td id="LC13691">            result = pInfoModule-&gt;<span>GetModuleID</span>();</td>
      </tr>
      <tr>
        <td id="L13692" data-line-number="13692"></td>
        <td id="LC13692">        }</td>
      </tr>
      <tr>
        <td id="L13693" data-line-number="13693"></td>
        <td id="LC13693">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13694" data-line-number="13694"></td>
        <td id="LC13694">
</td>
      </tr>
      <tr>
        <td id="L13695" data-line-number="13695"></td>
        <td id="LC13695">    <span>case</span> ENCODE_MODULE_ID_FOR_GENERIC_STATICS:</td>
      </tr>
      <tr>
        <td id="L13696" data-line-number="13696"></td>
        <td id="LC13696">        {</td>
      </tr>
      <tr>
        <td id="L13697" data-line-number="13697"></td>
        <td id="LC13697">            TypeHandle th = <span>ZapSig::DecodeType</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13698" data-line-number="13698"></td>
        <td id="LC13698">
</td>
      </tr>
      <tr>
        <td id="L13699" data-line-number="13699"></td>
        <td id="LC13699">            MethodTable * pMT = th.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L13700" data-line-number="13700"></td>
        <td id="LC13700">
</td>
      </tr>
      <tr>
        <td id="L13701" data-line-number="13701"></td>
        <td id="LC13701">            result = pMT-&gt;<span>GetModuleForStatics</span>()-&gt;<span>GetModuleID</span>();</td>
      </tr>
      <tr>
        <td id="L13702" data-line-number="13702"></td>
        <td id="LC13702">        }</td>
      </tr>
      <tr>
        <td id="L13703" data-line-number="13703"></td>
        <td id="LC13703">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13704" data-line-number="13704"></td>
        <td id="LC13704">
</td>
      </tr>
      <tr>
        <td id="L13705" data-line-number="13705"></td>
        <td id="LC13705">    <span>case</span> ENCODE_ACTIVE_DEPENDENCY:</td>
      </tr>
      <tr>
        <td id="L13706" data-line-number="13706"></td>
        <td id="LC13706">        {</td>
      </tr>
      <tr>
        <td id="L13707" data-line-number="13707"></td>
        <td id="LC13707">            Module* pModule = currentModule-&gt;<span>GetModuleFromIndex</span>(<span>CorSigUncompressData</span>(pBlob));</td>
      </tr>
      <tr>
        <td id="L13708" data-line-number="13708"></td>
        <td id="LC13708">
</td>
      </tr>
      <tr>
        <td id="L13709" data-line-number="13709"></td>
        <td id="LC13709">            <span>STRESS_LOG3</span>(LF_ZAP,LL_INFO10000,<span><span>"</span>Modules are: %08x,%08x,%08x<span>"</span></span>,currentModule,pInfoModule,pModule);</td>
      </tr>
      <tr>
        <td id="L13710" data-line-number="13710"></td>
        <td id="LC13710">            pInfoModule-&gt;<span>AddActiveDependency</span>(pModule, <span>FALSE</span>);</td>
      </tr>
      <tr>
        <td id="L13711" data-line-number="13711"></td>
        <td id="LC13711">        }</td>
      </tr>
      <tr>
        <td id="L13712" data-line-number="13712"></td>
        <td id="LC13712">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13713" data-line-number="13713"></td>
        <td id="LC13713">
</td>
      </tr>
      <tr>
        <td id="L13714" data-line-number="13714"></td>
        <td id="LC13714">#<span>ifdef</span> FEATURE_READYTORUN</td>
      </tr>
      <tr>
        <td id="L13715" data-line-number="13715"></td>
        <td id="LC13715">    <span>case</span> ENCODE_READYTORUN_HELPER:</td>
      </tr>
      <tr>
        <td id="L13716" data-line-number="13716"></td>
        <td id="LC13716">        {</td>
      </tr>
      <tr>
        <td id="L13717" data-line-number="13717"></td>
        <td id="LC13717">            DWORD helperNum = <span>CorSigUncompressData</span>(pBlob);</td>
      </tr>
      <tr>
        <td id="L13718" data-line-number="13718"></td>
        <td id="LC13718">
</td>
      </tr>
      <tr>
        <td id="L13719" data-line-number="13719"></td>
        <td id="LC13719">            CorInfoHelpFunc corInfoHelpFunc = <span>MapReadyToRunHelper</span>((ReadyToRunHelper)helperNum);</td>
      </tr>
      <tr>
        <td id="L13720" data-line-number="13720"></td>
        <td id="LC13720">            <span>if</span> (corInfoHelpFunc != CORINFO_HELP_UNDEF)</td>
      </tr>
      <tr>
        <td id="L13721" data-line-number="13721"></td>
        <td id="LC13721">            {</td>
      </tr>
      <tr>
        <td id="L13722" data-line-number="13722"></td>
        <td id="LC13722">                result = (<span>size_t</span>)<span>CEEJitInfo::getHelperFtnStatic</span>(corInfoHelpFunc);</td>
      </tr>
      <tr>
        <td id="L13723" data-line-number="13723"></td>
        <td id="LC13723">            }</td>
      </tr>
      <tr>
        <td id="L13724" data-line-number="13724"></td>
        <td id="LC13724">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L13725" data-line-number="13725"></td>
        <td id="LC13725">            {</td>
      </tr>
      <tr>
        <td id="L13726" data-line-number="13726"></td>
        <td id="LC13726">                <span>switch</span> (helperNum)</td>
      </tr>
      <tr>
        <td id="L13727" data-line-number="13727"></td>
        <td id="LC13727">                {</td>
      </tr>
      <tr>
        <td id="L13728" data-line-number="13728"></td>
        <td id="LC13728">                <span>case</span> READYTORUN_HELPER_Module:</td>
      </tr>
      <tr>
        <td id="L13729" data-line-number="13729"></td>
        <td id="LC13729">                    {</td>
      </tr>
      <tr>
        <td id="L13730" data-line-number="13730"></td>
        <td id="LC13730">                        Module * pPrevious = <span>InterlockedCompareExchangeT</span>((Module **)entry, pInfoModule, <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L13731" data-line-number="13731"></td>
        <td id="LC13731">                        <span>if</span> (pPrevious != pInfoModule &amp;&amp; pPrevious != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L13732" data-line-number="13732"></td>
        <td id="LC13732">                            <span>COMPlusThrowHR</span>(COR_E_FILELOAD, IDS_NATIVE_IMAGE_CANNOT_BE_LOADED_MULTIPLE_TIMES, pInfoModule-&gt;<span>GetPath</span>());</td>
      </tr>
      <tr>
        <td id="L13733" data-line-number="13733"></td>
        <td id="LC13733">                        <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L13734" data-line-number="13734"></td>
        <td id="LC13734">                    }</td>
      </tr>
      <tr>
        <td id="L13735" data-line-number="13735"></td>
        <td id="LC13735">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13736" data-line-number="13736"></td>
        <td id="LC13736">
</td>
      </tr>
      <tr>
        <td id="L13737" data-line-number="13737"></td>
        <td id="LC13737">                <span>case</span> READYTORUN_HELPER_GSCookie:</td>
      </tr>
      <tr>
        <td id="L13738" data-line-number="13738"></td>
        <td id="LC13738">                    result = (<span>size_t</span>)<span>GetProcessGSCookie</span>();</td>
      </tr>
      <tr>
        <td id="L13739" data-line-number="13739"></td>
        <td id="LC13739">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13740" data-line-number="13740"></td>
        <td id="LC13740">
</td>
      </tr>
      <tr>
        <td id="L13741" data-line-number="13741"></td>
        <td id="LC13741">                <span>case</span> READYTORUN_HELPER_DelayLoad_MethodCall:</td>
      </tr>
      <tr>
        <td id="L13742" data-line-number="13742"></td>
        <td id="LC13742">                    result = (<span>size_t</span>)<span>GetEEFuncEntryPoint</span>(DelayLoad_MethodCall);</td>
      </tr>
      <tr>
        <td id="L13743" data-line-number="13743"></td>
        <td id="LC13743">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13744" data-line-number="13744"></td>
        <td id="LC13744">
</td>
      </tr>
      <tr>
        <td id="L13745" data-line-number="13745"></td>
        <td id="LC13745">                <span>case</span> READYTORUN_HELPER_DelayLoad_Helper:</td>
      </tr>
      <tr>
        <td id="L13746" data-line-number="13746"></td>
        <td id="LC13746">                    result = (<span>size_t</span>)<span>GetEEFuncEntryPoint</span>(DelayLoad_Helper);</td>
      </tr>
      <tr>
        <td id="L13747" data-line-number="13747"></td>
        <td id="LC13747">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13748" data-line-number="13748"></td>
        <td id="LC13748">
</td>
      </tr>
      <tr>
        <td id="L13749" data-line-number="13749"></td>
        <td id="LC13749">                <span>case</span> READYTORUN_HELPER_DelayLoad_Helper_Obj:</td>
      </tr>
      <tr>
        <td id="L13750" data-line-number="13750"></td>
        <td id="LC13750">                    result = (<span>size_t</span>)<span>GetEEFuncEntryPoint</span>(DelayLoad_Helper_Obj);</td>
      </tr>
      <tr>
        <td id="L13751" data-line-number="13751"></td>
        <td id="LC13751">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13752" data-line-number="13752"></td>
        <td id="LC13752">
</td>
      </tr>
      <tr>
        <td id="L13753" data-line-number="13753"></td>
        <td id="LC13753">                <span>case</span> READYTORUN_HELPER_DelayLoad_Helper_ObjObj:</td>
      </tr>
      <tr>
        <td id="L13754" data-line-number="13754"></td>
        <td id="LC13754">                    result = (<span>size_t</span>)<span>GetEEFuncEntryPoint</span>(DelayLoad_Helper_ObjObj);</td>
      </tr>
      <tr>
        <td id="L13755" data-line-number="13755"></td>
        <td id="LC13755">                    <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13756" data-line-number="13756"></td>
        <td id="LC13756">
</td>
      </tr>
      <tr>
        <td id="L13757" data-line-number="13757"></td>
        <td id="LC13757">                <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L13758" data-line-number="13758"></td>
        <td id="LC13758">                    <span>STRESS_LOG1</span>(LF_ZAP, LL_WARNING, <span><span>"</span>Unknown READYTORUN_HELPER %d<span>\n</span><span>"</span></span>, helperNum);</td>
      </tr>
      <tr>
        <td id="L13759" data-line-number="13759"></td>
        <td id="LC13759">                    <span>_ASSERTE</span>(!<span><span>"</span>Unknown READYTORUN_HELPER<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L13760" data-line-number="13760"></td>
        <td id="LC13760">                    <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13761" data-line-number="13761"></td>
        <td id="LC13761">                }</td>
      </tr>
      <tr>
        <td id="L13762" data-line-number="13762"></td>
        <td id="LC13762">            }</td>
      </tr>
      <tr>
        <td id="L13763" data-line-number="13763"></td>
        <td id="LC13763">        }</td>
      </tr>
      <tr>
        <td id="L13764" data-line-number="13764"></td>
        <td id="LC13764">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13765" data-line-number="13765"></td>
        <td id="LC13765">
</td>
      </tr>
      <tr>
        <td id="L13766" data-line-number="13766"></td>
        <td id="LC13766">    <span>case</span> ENCODE_FIELD_OFFSET:</td>
      </tr>
      <tr>
        <td id="L13767" data-line-number="13767"></td>
        <td id="LC13767">        {</td>
      </tr>
      <tr>
        <td id="L13768" data-line-number="13768"></td>
        <td id="LC13768">            FieldDesc * pFD = <span>ZapSig::DecodeField</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13769" data-line-number="13769"></td>
        <td id="LC13769">            <span>_ASSERTE</span>(!pFD-&gt;<span>IsStatic</span>());</td>
      </tr>
      <tr>
        <td id="L13770" data-line-number="13770"></td>
        <td id="LC13770">            <span>_ASSERTE</span>(!pFD-&gt;<span>IsFieldOfValueType</span>());</td>
      </tr>
      <tr>
        <td id="L13771" data-line-number="13771"></td>
        <td id="LC13771">
</td>
      </tr>
      <tr>
        <td id="L13772" data-line-number="13772"></td>
        <td id="LC13772">            DWORD dwOffset = (DWORD)<span>sizeof</span>(Object) + pFD-&gt;<span>GetOffset</span>();</td>
      </tr>
      <tr>
        <td id="L13773" data-line-number="13773"></td>
        <td id="LC13773">
</td>
      </tr>
      <tr>
        <td id="L13774" data-line-number="13774"></td>
        <td id="LC13774">            <span>if</span> (dwOffset &gt; MAX_UNCHECKED_OFFSET_FOR_NULL_OBJECT)</td>
      </tr>
      <tr>
        <td id="L13775" data-line-number="13775"></td>
        <td id="LC13775">                <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13776" data-line-number="13776"></td>
        <td id="LC13776">            result = dwOffset;</td>
      </tr>
      <tr>
        <td id="L13777" data-line-number="13777"></td>
        <td id="LC13777">        }</td>
      </tr>
      <tr>
        <td id="L13778" data-line-number="13778"></td>
        <td id="LC13778">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13779" data-line-number="13779"></td>
        <td id="LC13779">
</td>
      </tr>
      <tr>
        <td id="L13780" data-line-number="13780"></td>
        <td id="LC13780">    <span>case</span> ENCODE_FIELD_BASE_OFFSET:</td>
      </tr>
      <tr>
        <td id="L13781" data-line-number="13781"></td>
        <td id="LC13781">        {</td>
      </tr>
      <tr>
        <td id="L13782" data-line-number="13782"></td>
        <td id="LC13782">            TypeHandle th = <span>ZapSig::DecodeType</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13783" data-line-number="13783"></td>
        <td id="LC13783">
</td>
      </tr>
      <tr>
        <td id="L13784" data-line-number="13784"></td>
        <td id="LC13784">            MethodTable * pMT = th.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L13785" data-line-number="13785"></td>
        <td id="LC13785">            <span>_ASSERTE</span>(!pMT-&gt;<span>IsValueType</span>());</td>
      </tr>
      <tr>
        <td id="L13786" data-line-number="13786"></td>
        <td id="LC13786">
</td>
      </tr>
      <tr>
        <td id="L13787" data-line-number="13787"></td>
        <td id="LC13787">            DWORD dwOffsetBase = <span>ReadyToRunInfo::GetFieldBaseOffset</span>(pMT);</td>
      </tr>
      <tr>
        <td id="L13788" data-line-number="13788"></td>
        <td id="LC13788">            <span>if</span> (dwOffsetBase &gt; MAX_UNCHECKED_OFFSET_FOR_NULL_OBJECT)</td>
      </tr>
      <tr>
        <td id="L13789" data-line-number="13789"></td>
        <td id="LC13789">                <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13790" data-line-number="13790"></td>
        <td id="LC13790">            result = dwOffsetBase;</td>
      </tr>
      <tr>
        <td id="L13791" data-line-number="13791"></td>
        <td id="LC13791">        }</td>
      </tr>
      <tr>
        <td id="L13792" data-line-number="13792"></td>
        <td id="LC13792">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13793" data-line-number="13793"></td>
        <td id="LC13793">
</td>
      </tr>
      <tr>
        <td id="L13794" data-line-number="13794"></td>
        <td id="LC13794">    <span>case</span> ENCODE_CHECK_TYPE_LAYOUT:</td>
      </tr>
      <tr>
        <td id="L13795" data-line-number="13795"></td>
        <td id="LC13795">        {</td>
      </tr>
      <tr>
        <td id="L13796" data-line-number="13796"></td>
        <td id="LC13796">            TypeHandle th = <span>ZapSig::DecodeType</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13797" data-line-number="13797"></td>
        <td id="LC13797">            MethodTable * pMT = th.<span>AsMethodTable</span>();</td>
      </tr>
      <tr>
        <td id="L13798" data-line-number="13798"></td>
        <td id="LC13798">            <span>_ASSERTE</span>(pMT-&gt;<span>IsValueType</span>());</td>
      </tr>
      <tr>
        <td id="L13799" data-line-number="13799"></td>
        <td id="LC13799">
</td>
      </tr>
      <tr>
        <td id="L13800" data-line-number="13800"></td>
        <td id="LC13800">            <span>if</span> (!<span>TypeLayoutCheck</span>(pMT, pBlob))</td>
      </tr>
      <tr>
        <td id="L13801" data-line-number="13801"></td>
        <td id="LC13801">                <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13802" data-line-number="13802"></td>
        <td id="LC13802">
</td>
      </tr>
      <tr>
        <td id="L13803" data-line-number="13803"></td>
        <td id="LC13803">            result = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L13804" data-line-number="13804"></td>
        <td id="LC13804">        }</td>
      </tr>
      <tr>
        <td id="L13805" data-line-number="13805"></td>
        <td id="LC13805">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13806" data-line-number="13806"></td>
        <td id="LC13806">
</td>
      </tr>
      <tr>
        <td id="L13807" data-line-number="13807"></td>
        <td id="LC13807">    <span>case</span> ENCODE_CHECK_FIELD_OFFSET:</td>
      </tr>
      <tr>
        <td id="L13808" data-line-number="13808"></td>
        <td id="LC13808">        {</td>
      </tr>
      <tr>
        <td id="L13809" data-line-number="13809"></td>
        <td id="LC13809">            DWORD dwExpectedOffset = <span>CorSigUncompressData</span>(pBlob);</td>
      </tr>
      <tr>
        <td id="L13810" data-line-number="13810"></td>
        <td id="LC13810">
</td>
      </tr>
      <tr>
        <td id="L13811" data-line-number="13811"></td>
        <td id="LC13811">            FieldDesc * pFD = <span>ZapSig::DecodeField</span>(currentModule, pInfoModule, pBlob);</td>
      </tr>
      <tr>
        <td id="L13812" data-line-number="13812"></td>
        <td id="LC13812">            <span>_ASSERTE</span>(!pFD-&gt;<span>IsStatic</span>());</td>
      </tr>
      <tr>
        <td id="L13813" data-line-number="13813"></td>
        <td id="LC13813">
</td>
      </tr>
      <tr>
        <td id="L13814" data-line-number="13814"></td>
        <td id="LC13814">            DWORD dwOffset = pFD-&gt;<span>GetOffset</span>();</td>
      </tr>
      <tr>
        <td id="L13815" data-line-number="13815"></td>
        <td id="LC13815">            <span>if</span> (!pFD-&gt;<span>IsFieldOfValueType</span>())</td>
      </tr>
      <tr>
        <td id="L13816" data-line-number="13816"></td>
        <td id="LC13816">                dwOffset += <span>sizeof</span>(Object);</td>
      </tr>
      <tr>
        <td id="L13817" data-line-number="13817"></td>
        <td id="LC13817">
</td>
      </tr>
      <tr>
        <td id="L13818" data-line-number="13818"></td>
        <td id="LC13818">            <span>if</span> (dwExpectedOffset != dwOffset)</td>
      </tr>
      <tr>
        <td id="L13819" data-line-number="13819"></td>
        <td id="LC13819">                <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13820" data-line-number="13820"></td>
        <td id="LC13820">
</td>
      </tr>
      <tr>
        <td id="L13821" data-line-number="13821"></td>
        <td id="LC13821">            result = <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L13822" data-line-number="13822"></td>
        <td id="LC13822">        }</td>
      </tr>
      <tr>
        <td id="L13823" data-line-number="13823"></td>
        <td id="LC13823">        <span>break</span>;</td>
      </tr>
      <tr>
        <td id="L13824" data-line-number="13824"></td>
        <td id="LC13824">#<span>endif</span> <span><span>//</span> FEATURE_READYTORUN</span></td>
      </tr>
      <tr>
        <td id="L13825" data-line-number="13825"></td>
        <td id="LC13825">
</td>
      </tr>
      <tr>
        <td id="L13826" data-line-number="13826"></td>
        <td id="LC13826">#<span>endif</span> <span><span>//</span> CROSSGEN_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L13827" data-line-number="13827"></td>
        <td id="LC13827">
</td>
      </tr>
      <tr>
        <td id="L13828" data-line-number="13828"></td>
        <td id="LC13828">    <span>default</span>:</td>
      </tr>
      <tr>
        <td id="L13829" data-line-number="13829"></td>
        <td id="LC13829">        <span>STRESS_LOG1</span>(LF_ZAP, LL_WARNING, <span><span>"</span>Unknown FIXUP_BLOB_KIND %d<span>\n</span><span>"</span></span>, kind);</td>
      </tr>
      <tr>
        <td id="L13830" data-line-number="13830"></td>
        <td id="LC13830">        <span>_ASSERTE</span>(!<span><span>"</span>Unknown FIXUP_BLOB_KIND<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L13831" data-line-number="13831"></td>
        <td id="LC13831">        <span>return</span> <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L13832" data-line-number="13832"></td>
        <td id="LC13832">    }</td>
      </tr>
      <tr>
        <td id="L13833" data-line-number="13833"></td>
        <td id="LC13833">
</td>
      </tr>
      <tr>
        <td id="L13834" data-line-number="13834"></td>
        <td id="LC13834">    <span>MemoryBarrier</span>();</td>
      </tr>
      <tr>
        <td id="L13835" data-line-number="13835"></td>
        <td id="LC13835">    *entry = result;</td>
      </tr>
      <tr>
        <td id="L13836" data-line-number="13836"></td>
        <td id="LC13836">
</td>
      </tr>
      <tr>
        <td id="L13837" data-line-number="13837"></td>
        <td id="LC13837">    <span>return</span> <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L13838" data-line-number="13838"></td>
        <td id="LC13838">}</td>
      </tr>
      <tr>
        <td id="L13839" data-line-number="13839"></td>
        <td id="LC13839">
</td>
      </tr>
      <tr>
        <td id="L13840" data-line-number="13840"></td>
        <td id="LC13840"><span>void</span>* <span>CEEInfo::getTailCallCopyArgsThunk</span>(CORINFO_SIG_INFO       *pSig,</td>
      </tr>
      <tr>
        <td id="L13841" data-line-number="13841"></td>
        <td id="LC13841">                                        CorInfoHelperTailCallSpecialHandling flags)</td>
      </tr>
      <tr>
        <td id="L13842" data-line-number="13842"></td>
        <td id="LC13842">{</td>
      </tr>
      <tr>
        <td id="L13843" data-line-number="13843"></td>
        <td id="LC13843">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L13844" data-line-number="13844"></td>
        <td id="LC13844">        THROWS;</td>
      </tr>
      <tr>
        <td id="L13845" data-line-number="13845"></td>
        <td id="LC13845">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L13846" data-line-number="13846"></td>
        <td id="LC13846">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L13847" data-line-number="13847"></td>
        <td id="LC13847">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L13848" data-line-number="13848"></td>
        <td id="LC13848">
</td>
      </tr>
      <tr>
        <td id="L13849" data-line-number="13849"></td>
        <td id="LC13849">    <span>void</span> * ftn = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L13850" data-line-number="13850"></td>
        <td id="LC13850">
</td>
      </tr>
      <tr>
        <td id="L13851" data-line-number="13851"></td>
        <td id="LC13851">#<span>if</span> (defined(TARGET_AMD64) || defined(TARGET_ARM)) &amp;&amp; !defined(TARGET_UNIX)</td>
      </tr>
      <tr>
        <td id="L13852" data-line-number="13852"></td>
        <td id="LC13852">
</td>
      </tr>
      <tr>
        <td id="L13853" data-line-number="13853"></td>
        <td id="LC13853">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L13854" data-line-number="13854"></td>
        <td id="LC13854">
</td>
      </tr>
      <tr>
        <td id="L13855" data-line-number="13855"></td>
        <td id="LC13855">    Stub* pStub = <span>CPUSTUBLINKER::CreateTailCallCopyArgsThunk</span>(pSig, m_pMethodBeingCompiled, flags);</td>
      </tr>
      <tr>
        <td id="L13856" data-line-number="13856"></td>
        <td id="LC13856">
</td>
      </tr>
      <tr>
        <td id="L13857" data-line-number="13857"></td>
        <td id="LC13857">    ftn = (<span>void</span>*)pStub-&gt;<span>GetEntryPoint</span>();</td>
      </tr>
      <tr>
        <td id="L13858" data-line-number="13858"></td>
        <td id="LC13858">
</td>
      </tr>
      <tr>
        <td id="L13859" data-line-number="13859"></td>
        <td id="LC13859">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L13860" data-line-number="13860"></td>
        <td id="LC13860">
</td>
      </tr>
      <tr>
        <td id="L13861" data-line-number="13861"></td>
        <td id="LC13861">#<span>endif</span> <span><span>//</span> (TARGET_AMD64 || TARGET_ARM) &amp;&amp; !TARGET_UNIX</span></td>
      </tr>
      <tr>
        <td id="L13862" data-line-number="13862"></td>
        <td id="LC13862">
</td>
      </tr>
      <tr>
        <td id="L13863" data-line-number="13863"></td>
        <td id="LC13863">    <span>return</span> ftn;</td>
      </tr>
      <tr>
        <td id="L13864" data-line-number="13864"></td>
        <td id="LC13864">}</td>
      </tr>
      <tr>
        <td id="L13865" data-line-number="13865"></td>
        <td id="LC13865">
</td>
      </tr>
      <tr>
        <td id="L13866" data-line-number="13866"></td>
        <td id="LC13866"><span>bool</span> <span>CEEInfo::convertPInvokeCalliToCall</span>(CORINFO_RESOLVED_TOKEN * pResolvedToken, <span>bool</span> <span>fMustConvert</span>)</td>
      </tr>
      <tr>
        <td id="L13867" data-line-number="13867"></td>
        <td id="LC13867">{</td>
      </tr>
      <tr>
        <td id="L13868" data-line-number="13868"></td>
        <td id="LC13868">    <span>return</span> <span>false</span>;</td>
      </tr>
      <tr>
        <td id="L13869" data-line-number="13869"></td>
        <td id="LC13869">}</td>
      </tr>
      <tr>
        <td id="L13870" data-line-number="13870"></td>
        <td id="LC13870">
</td>
      </tr>
      <tr>
        <td id="L13871" data-line-number="13871"></td>
        <td id="LC13871"><span>void</span> <span>CEEInfo::allocMem</span> (</td>
      </tr>
      <tr>
        <td id="L13872" data-line-number="13872"></td>
        <td id="LC13872">        ULONG               hotCodeSize,    <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13873" data-line-number="13873"></td>
        <td id="LC13873">        ULONG               coldCodeSize,   <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13874" data-line-number="13874"></td>
        <td id="LC13874">        ULONG               roDataSize,     <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13875" data-line-number="13875"></td>
        <td id="LC13875">        ULONG               xcptnsCount,    <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13876" data-line-number="13876"></td>
        <td id="LC13876">        CorJitAllocMemFlag  flag,           <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13877" data-line-number="13877"></td>
        <td id="LC13877">        <span>void</span> **             hotCodeBlock,   <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13878" data-line-number="13878"></td>
        <td id="LC13878">        <span>void</span> **             coldCodeBlock,  <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13879" data-line-number="13879"></td>
        <td id="LC13879">        <span>void</span> **             roDataBlock     <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13880" data-line-number="13880"></td>
        <td id="LC13880">        )</td>
      </tr>
      <tr>
        <td id="L13881" data-line-number="13881"></td>
        <td id="LC13881">{</td>
      </tr>
      <tr>
        <td id="L13882" data-line-number="13882"></td>
        <td id="LC13882">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13883" data-line-number="13883"></td>
        <td id="LC13883">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13884" data-line-number="13884"></td>
        <td id="LC13884">}</td>
      </tr>
      <tr>
        <td id="L13885" data-line-number="13885"></td>
        <td id="LC13885">
</td>
      </tr>
      <tr>
        <td id="L13886" data-line-number="13886"></td>
        <td id="LC13886"><span>void</span> <span>CEEInfo::reserveUnwindInfo</span> (</td>
      </tr>
      <tr>
        <td id="L13887" data-line-number="13887"></td>
        <td id="LC13887">        BOOL                isFunclet,             <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13888" data-line-number="13888"></td>
        <td id="LC13888">        BOOL                isColdCode,            <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13889" data-line-number="13889"></td>
        <td id="LC13889">        ULONG               unwindSize             <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13890" data-line-number="13890"></td>
        <td id="LC13890">        )</td>
      </tr>
      <tr>
        <td id="L13891" data-line-number="13891"></td>
        <td id="LC13891">{</td>
      </tr>
      <tr>
        <td id="L13892" data-line-number="13892"></td>
        <td id="LC13892">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13893" data-line-number="13893"></td>
        <td id="LC13893">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13894" data-line-number="13894"></td>
        <td id="LC13894">}</td>
      </tr>
      <tr>
        <td id="L13895" data-line-number="13895"></td>
        <td id="LC13895">
</td>
      </tr>
      <tr>
        <td id="L13896" data-line-number="13896"></td>
        <td id="LC13896"><span>void</span> <span>CEEInfo::allocUnwindInfo</span> (</td>
      </tr>
      <tr>
        <td id="L13897" data-line-number="13897"></td>
        <td id="LC13897">        BYTE *              pHotCode,              <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13898" data-line-number="13898"></td>
        <td id="LC13898">        BYTE *              pColdCode,             <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13899" data-line-number="13899"></td>
        <td id="LC13899">        ULONG               startOffset,           <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13900" data-line-number="13900"></td>
        <td id="LC13900">        ULONG               endOffset,             <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13901" data-line-number="13901"></td>
        <td id="LC13901">        ULONG               unwindSize,            <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13902" data-line-number="13902"></td>
        <td id="LC13902">        BYTE *              pUnwindBlock,          <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13903" data-line-number="13903"></td>
        <td id="LC13903">        CorJitFuncKind      funcKind               <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13904" data-line-number="13904"></td>
        <td id="LC13904">        )</td>
      </tr>
      <tr>
        <td id="L13905" data-line-number="13905"></td>
        <td id="LC13905">{</td>
      </tr>
      <tr>
        <td id="L13906" data-line-number="13906"></td>
        <td id="LC13906">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13907" data-line-number="13907"></td>
        <td id="LC13907">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13908" data-line-number="13908"></td>
        <td id="LC13908">}</td>
      </tr>
      <tr>
        <td id="L13909" data-line-number="13909"></td>
        <td id="LC13909">
</td>
      </tr>
      <tr>
        <td id="L13910" data-line-number="13910"></td>
        <td id="LC13910"><span>void</span> * <span>CEEInfo::allocGCInfo</span> (</td>
      </tr>
      <tr>
        <td id="L13911" data-line-number="13911"></td>
        <td id="LC13911">        <span>size_t</span>                  size        <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13912" data-line-number="13912"></td>
        <td id="LC13912">        )</td>
      </tr>
      <tr>
        <td id="L13913" data-line-number="13913"></td>
        <td id="LC13913">{</td>
      </tr>
      <tr>
        <td id="L13914" data-line-number="13914"></td>
        <td id="LC13914">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13915" data-line-number="13915"></td>
        <td id="LC13915">    <span>UNREACHABLE_RET</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13916" data-line-number="13916"></td>
        <td id="LC13916">}</td>
      </tr>
      <tr>
        <td id="L13917" data-line-number="13917"></td>
        <td id="LC13917">
</td>
      </tr>
      <tr>
        <td id="L13918" data-line-number="13918"></td>
        <td id="LC13918"><span>void</span> <span>CEEInfo::setEHcount</span> (</td>
      </tr>
      <tr>
        <td id="L13919" data-line-number="13919"></td>
        <td id="LC13919">        <span>unsigned</span>             cEH    <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13920" data-line-number="13920"></td>
        <td id="LC13920">        )</td>
      </tr>
      <tr>
        <td id="L13921" data-line-number="13921"></td>
        <td id="LC13921">{</td>
      </tr>
      <tr>
        <td id="L13922" data-line-number="13922"></td>
        <td id="LC13922">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13923" data-line-number="13923"></td>
        <td id="LC13923">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13924" data-line-number="13924"></td>
        <td id="LC13924">}</td>
      </tr>
      <tr>
        <td id="L13925" data-line-number="13925"></td>
        <td id="LC13925">
</td>
      </tr>
      <tr>
        <td id="L13926" data-line-number="13926"></td>
        <td id="LC13926"><span>void</span> <span>CEEInfo::setEHinfo</span> (</td>
      </tr>
      <tr>
        <td id="L13927" data-line-number="13927"></td>
        <td id="LC13927">        <span>unsigned</span>             EHnumber,   <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13928" data-line-number="13928"></td>
        <td id="LC13928">        <span>const</span> CORINFO_EH_CLAUSE *clause      <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L13929" data-line-number="13929"></td>
        <td id="LC13929">        )</td>
      </tr>
      <tr>
        <td id="L13930" data-line-number="13930"></td>
        <td id="LC13930">{</td>
      </tr>
      <tr>
        <td id="L13931" data-line-number="13931"></td>
        <td id="LC13931">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13932" data-line-number="13932"></td>
        <td id="LC13932">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13933" data-line-number="13933"></td>
        <td id="LC13933">}</td>
      </tr>
      <tr>
        <td id="L13934" data-line-number="13934"></td>
        <td id="LC13934">
</td>
      </tr>
      <tr>
        <td id="L13935" data-line-number="13935"></td>
        <td id="LC13935">InfoAccessType <span>CEEInfo::constructStringLiteral</span>(CORINFO_MODULE_HANDLE scopeHnd,</td>
      </tr>
      <tr>
        <td id="L13936" data-line-number="13936"></td>
        <td id="LC13936">                                               mdToken metaTok,</td>
      </tr>
      <tr>
        <td id="L13937" data-line-number="13937"></td>
        <td id="LC13937">                                               <span>void</span> **ppValue)</td>
      </tr>
      <tr>
        <td id="L13938" data-line-number="13938"></td>
        <td id="LC13938">{</td>
      </tr>
      <tr>
        <td id="L13939" data-line-number="13939"></td>
        <td id="LC13939">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13940" data-line-number="13940"></td>
        <td id="LC13940">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13941" data-line-number="13941"></td>
        <td id="LC13941">}</td>
      </tr>
      <tr>
        <td id="L13942" data-line-number="13942"></td>
        <td id="LC13942">
</td>
      </tr>
      <tr>
        <td id="L13943" data-line-number="13943"></td>
        <td id="LC13943">InfoAccessType <span>CEEInfo::emptyStringLiteral</span>(<span>void</span> ** ppValue)</td>
      </tr>
      <tr>
        <td id="L13944" data-line-number="13944"></td>
        <td id="LC13944">{</td>
      </tr>
      <tr>
        <td id="L13945" data-line-number="13945"></td>
        <td id="LC13945">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13946" data-line-number="13946"></td>
        <td id="LC13946">    <span>_ASSERTE</span>(<span>isVerifyOnly</span>());</td>
      </tr>
      <tr>
        <td id="L13947" data-line-number="13947"></td>
        <td id="LC13947">    *ppValue = (<span>void</span> *)<span>0x10</span>;</td>
      </tr>
      <tr>
        <td id="L13948" data-line-number="13948"></td>
        <td id="LC13948">    <span>return</span> IAT_PVALUE;</td>
      </tr>
      <tr>
        <td id="L13949" data-line-number="13949"></td>
        <td id="LC13949">}</td>
      </tr>
      <tr>
        <td id="L13950" data-line-number="13950"></td>
        <td id="LC13950">
</td>
      </tr>
      <tr>
        <td id="L13951" data-line-number="13951"></td>
        <td id="LC13951"><span>void</span>* <span>CEEInfo::getFieldAddress</span>(CORINFO_FIELD_HANDLE fieldHnd,</td>
      </tr>
      <tr>
        <td id="L13952" data-line-number="13952"></td>
        <td id="LC13952">                                  <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L13953" data-line-number="13953"></td>
        <td id="LC13953">{</td>
      </tr>
      <tr>
        <td id="L13954" data-line-number="13954"></td>
        <td id="LC13954">    CONTRACTL{</td>
      </tr>
      <tr>
        <td id="L13955" data-line-number="13955"></td>
        <td id="LC13955">        THROWS;</td>
      </tr>
      <tr>
        <td id="L13956" data-line-number="13956"></td>
        <td id="LC13956">        GC_TRIGGERS;</td>
      </tr>
      <tr>
        <td id="L13957" data-line-number="13957"></td>
        <td id="LC13957">        MODE_PREEMPTIVE;</td>
      </tr>
      <tr>
        <td id="L13958" data-line-number="13958"></td>
        <td id="LC13958">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L13959" data-line-number="13959"></td>
        <td id="LC13959">
</td>
      </tr>
      <tr>
        <td id="L13960" data-line-number="13960"></td>
        <td id="LC13960">    <span>void</span> *result = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L13961" data-line-number="13961"></td>
        <td id="LC13961">
</td>
      </tr>
      <tr>
        <td id="L13962" data-line-number="13962"></td>
        <td id="LC13962">    <span>if</span> (ppIndirection != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L13963" data-line-number="13963"></td>
        <td id="LC13963">        *ppIndirection = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L13964" data-line-number="13964"></td>
        <td id="LC13964">
</td>
      </tr>
      <tr>
        <td id="L13965" data-line-number="13965"></td>
        <td id="LC13965">    <span><span>//</span> Do not bother with initialization if we are only verifying the method.</span></td>
      </tr>
      <tr>
        <td id="L13966" data-line-number="13966"></td>
        <td id="LC13966">    <span>if</span> (<span>isVerifyOnly</span>())</td>
      </tr>
      <tr>
        <td id="L13967" data-line-number="13967"></td>
        <td id="LC13967">    {</td>
      </tr>
      <tr>
        <td id="L13968" data-line-number="13968"></td>
        <td id="LC13968">        <span>return</span> (<span>void</span> *)<span>0x10</span>;</td>
      </tr>
      <tr>
        <td id="L13969" data-line-number="13969"></td>
        <td id="LC13969">    }</td>
      </tr>
      <tr>
        <td id="L13970" data-line-number="13970"></td>
        <td id="LC13970">
</td>
      </tr>
      <tr>
        <td id="L13971" data-line-number="13971"></td>
        <td id="LC13971">    <span>JIT_TO_EE_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L13972" data-line-number="13972"></td>
        <td id="LC13972">
</td>
      </tr>
      <tr>
        <td id="L13973" data-line-number="13973"></td>
        <td id="LC13973">    FieldDesc* field = (FieldDesc*)fieldHnd;</td>
      </tr>
      <tr>
        <td id="L13974" data-line-number="13974"></td>
        <td id="LC13974">
</td>
      </tr>
      <tr>
        <td id="L13975" data-line-number="13975"></td>
        <td id="LC13975">    <span>_ASSERTE</span>(field-&gt;<span>IsRVA</span>());</td>
      </tr>
      <tr>
        <td id="L13976" data-line-number="13976"></td>
        <td id="LC13976">
</td>
      </tr>
      <tr>
        <td id="L13977" data-line-number="13977"></td>
        <td id="LC13977">    result = field-&gt;<span>GetStaticAddressHandle</span>(<span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L13978" data-line-number="13978"></td>
        <td id="LC13978">
</td>
      </tr>
      <tr>
        <td id="L13979" data-line-number="13979"></td>
        <td id="LC13979">    <span>EE_TO_JIT_TRANSITION</span>();</td>
      </tr>
      <tr>
        <td id="L13980" data-line-number="13980"></td>
        <td id="LC13980">
</td>
      </tr>
      <tr>
        <td id="L13981" data-line-number="13981"></td>
        <td id="LC13981">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L13982" data-line-number="13982"></td>
        <td id="LC13982">}</td>
      </tr>
      <tr>
        <td id="L13983" data-line-number="13983"></td>
        <td id="LC13983">
</td>
      </tr>
      <tr>
        <td id="L13984" data-line-number="13984"></td>
        <td id="LC13984">CORINFO_CLASS_HANDLE <span>CEEInfo::getStaticFieldCurrentClass</span>(CORINFO_FIELD_HANDLE fieldHnd,</td>
      </tr>
      <tr>
        <td id="L13985" data-line-number="13985"></td>
        <td id="LC13985">                                                         <span>bool</span>* pIsSpeculative)</td>
      </tr>
      <tr>
        <td id="L13986" data-line-number="13986"></td>
        <td id="LC13986">{</td>
      </tr>
      <tr>
        <td id="L13987" data-line-number="13987"></td>
        <td id="LC13987">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13988" data-line-number="13988"></td>
        <td id="LC13988">    <span>_ASSERTE</span>(<span>isVerifyOnly</span>());</td>
      </tr>
      <tr>
        <td id="L13989" data-line-number="13989"></td>
        <td id="LC13989">    <span>if</span> (pIsSpeculative != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L13990" data-line-number="13990"></td>
        <td id="LC13990">        *pIsSpeculative = <span>true</span>;</td>
      </tr>
      <tr>
        <td id="L13991" data-line-number="13991"></td>
        <td id="LC13991">    <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L13992" data-line-number="13992"></td>
        <td id="LC13992">}</td>
      </tr>
      <tr>
        <td id="L13993" data-line-number="13993"></td>
        <td id="LC13993">
</td>
      </tr>
      <tr>
        <td id="L13994" data-line-number="13994"></td>
        <td id="LC13994"><span>void</span>* <span>CEEInfo::getMethodSync</span>(CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L13995" data-line-number="13995"></td>
        <td id="LC13995">                             <span>void</span> **ppIndirection)</td>
      </tr>
      <tr>
        <td id="L13996" data-line-number="13996"></td>
        <td id="LC13996">{</td>
      </tr>
      <tr>
        <td id="L13997" data-line-number="13997"></td>
        <td id="LC13997">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L13998" data-line-number="13998"></td>
        <td id="LC13998">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L13999" data-line-number="13999"></td>
        <td id="LC13999">}</td>
      </tr>
      <tr>
        <td id="L14000" data-line-number="14000"></td>
        <td id="LC14000">
</td>
      </tr>
      <tr>
        <td id="L14001" data-line-number="14001"></td>
        <td id="LC14001">HRESULT <span>CEEInfo::allocMethodBlockCounts</span> (</td>
      </tr>
      <tr>
        <td id="L14002" data-line-number="14002"></td>
        <td id="LC14002">        UINT32                count,           <span><span>//</span> the count of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L14003" data-line-number="14003"></td>
        <td id="LC14003">        BlockCounts **        pBlockCounts     <span><span>//</span> pointer to array of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L14004" data-line-number="14004"></td>
        <td id="LC14004">        )</td>
      </tr>
      <tr>
        <td id="L14005" data-line-number="14005"></td>
        <td id="LC14005">{</td>
      </tr>
      <tr>
        <td id="L14006" data-line-number="14006"></td>
        <td id="LC14006">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14007" data-line-number="14007"></td>
        <td id="LC14007">    <span>UNREACHABLE_RET</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14008" data-line-number="14008"></td>
        <td id="LC14008">}</td>
      </tr>
      <tr>
        <td id="L14009" data-line-number="14009"></td>
        <td id="LC14009">
</td>
      </tr>
      <tr>
        <td id="L14010" data-line-number="14010"></td>
        <td id="LC14010">HRESULT <span>CEEInfo::getMethodBlockCounts</span>(</td>
      </tr>
      <tr>
        <td id="L14011" data-line-number="14011"></td>
        <td id="LC14011">        CORINFO_METHOD_HANDLE ftnHnd,</td>
      </tr>
      <tr>
        <td id="L14012" data-line-number="14012"></td>
        <td id="LC14012">        UINT32 *              pCount,          <span><span>//</span> pointer to the count of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L14013" data-line-number="14013"></td>
        <td id="LC14013">        BlockCounts **        pBlockCounts,    <span><span>//</span> pointer to array of &lt;ILOffset, ExecutionCount&gt; tuples</span></td>
      </tr>
      <tr>
        <td id="L14014" data-line-number="14014"></td>
        <td id="LC14014">        UINT32 *              pNumRuns</td>
      </tr>
      <tr>
        <td id="L14015" data-line-number="14015"></td>
        <td id="LC14015">        )</td>
      </tr>
      <tr>
        <td id="L14016" data-line-number="14016"></td>
        <td id="LC14016">{</td>
      </tr>
      <tr>
        <td id="L14017" data-line-number="14017"></td>
        <td id="LC14017">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14018" data-line-number="14018"></td>
        <td id="LC14018">    <span>UNREACHABLE_RET</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14019" data-line-number="14019"></td>
        <td id="LC14019">}</td>
      </tr>
      <tr>
        <td id="L14020" data-line-number="14020"></td>
        <td id="LC14020">
</td>
      </tr>
      <tr>
        <td id="L14021" data-line-number="14021"></td>
        <td id="LC14021">
</td>
      </tr>
      <tr>
        <td id="L14022" data-line-number="14022"></td>
        <td id="LC14022"><span>void</span> <span>CEEInfo::recordCallSite</span>(</td>
      </tr>
      <tr>
        <td id="L14023" data-line-number="14023"></td>
        <td id="LC14023">        ULONG                 instrOffset,  <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14024" data-line-number="14024"></td>
        <td id="LC14024">        CORINFO_SIG_INFO *    callSig,      <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14025" data-line-number="14025"></td>
        <td id="LC14025">        CORINFO_METHOD_HANDLE methodHandle  <span><span>/*</span> IN <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14026" data-line-number="14026"></td>
        <td id="LC14026">        )</td>
      </tr>
      <tr>
        <td id="L14027" data-line-number="14027"></td>
        <td id="LC14027">{</td>
      </tr>
      <tr>
        <td id="L14028" data-line-number="14028"></td>
        <td id="LC14028">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14029" data-line-number="14029"></td>
        <td id="LC14029">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14030" data-line-number="14030"></td>
        <td id="LC14030">}</td>
      </tr>
      <tr>
        <td id="L14031" data-line-number="14031"></td>
        <td id="LC14031">
</td>
      </tr>
      <tr>
        <td id="L14032" data-line-number="14032"></td>
        <td id="LC14032"><span>void</span> <span>CEEInfo::recordRelocation</span>(</td>
      </tr>
      <tr>
        <td id="L14033" data-line-number="14033"></td>
        <td id="LC14033">        <span>void</span> *                 location,   <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14034" data-line-number="14034"></td>
        <td id="LC14034">        <span>void</span> *                 target,     <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14035" data-line-number="14035"></td>
        <td id="LC14035">        WORD                   <span>fRelocType</span>, <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14036" data-line-number="14036"></td>
        <td id="LC14036">        WORD                   slotNum,  <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14037" data-line-number="14037"></td>
        <td id="LC14037">        INT32                  addlDelta <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14038" data-line-number="14038"></td>
        <td id="LC14038">        )</td>
      </tr>
      <tr>
        <td id="L14039" data-line-number="14039"></td>
        <td id="LC14039">{</td>
      </tr>
      <tr>
        <td id="L14040" data-line-number="14040"></td>
        <td id="LC14040">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14041" data-line-number="14041"></td>
        <td id="LC14041">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14042" data-line-number="14042"></td>
        <td id="LC14042">}</td>
      </tr>
      <tr>
        <td id="L14043" data-line-number="14043"></td>
        <td id="LC14043">
</td>
      </tr>
      <tr>
        <td id="L14044" data-line-number="14044"></td>
        <td id="LC14044">WORD <span>CEEInfo::getRelocTypeHint</span>(<span>void</span> * target)</td>
      </tr>
      <tr>
        <td id="L14045" data-line-number="14045"></td>
        <td id="LC14045">{</td>
      </tr>
      <tr>
        <td id="L14046" data-line-number="14046"></td>
        <td id="LC14046">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14047" data-line-number="14047"></td>
        <td id="LC14047">    <span>UNREACHABLE_RET</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14048" data-line-number="14048"></td>
        <td id="LC14048">}</td>
      </tr>
      <tr>
        <td id="L14049" data-line-number="14049"></td>
        <td id="LC14049">
</td>
      </tr>
      <tr>
        <td id="L14050" data-line-number="14050"></td>
        <td id="LC14050"><span>void</span> <span>CEEInfo::getModuleNativeEntryPointRange</span>(</td>
      </tr>
      <tr>
        <td id="L14051" data-line-number="14051"></td>
        <td id="LC14051">        <span>void</span> ** pStart, <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14052" data-line-number="14052"></td>
        <td id="LC14052">        <span>void</span> ** pEnd    <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14053" data-line-number="14053"></td>
        <td id="LC14053">        )</td>
      </tr>
      <tr>
        <td id="L14054" data-line-number="14054"></td>
        <td id="LC14054">{</td>
      </tr>
      <tr>
        <td id="L14055" data-line-number="14055"></td>
        <td id="LC14055">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14056" data-line-number="14056"></td>
        <td id="LC14056">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14057" data-line-number="14057"></td>
        <td id="LC14057">}</td>
      </tr>
      <tr>
        <td id="L14058" data-line-number="14058"></td>
        <td id="LC14058">
</td>
      </tr>
      <tr>
        <td id="L14059" data-line-number="14059"></td>
        <td id="LC14059">DWORD <span>CEEInfo::getExpectedTargetArchitecture</span>()</td>
      </tr>
      <tr>
        <td id="L14060" data-line-number="14060"></td>
        <td id="LC14060">{</td>
      </tr>
      <tr>
        <td id="L14061" data-line-number="14061"></td>
        <td id="LC14061">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14062" data-line-number="14062"></td>
        <td id="LC14062">
</td>
      </tr>
      <tr>
        <td id="L14063" data-line-number="14063"></td>
        <td id="LC14063">    <span>return</span> IMAGE_FILE_MACHINE_NATIVE;</td>
      </tr>
      <tr>
        <td id="L14064" data-line-number="14064"></td>
        <td id="LC14064">}</td>
      </tr>
      <tr>
        <td id="L14065" data-line-number="14065"></td>
        <td id="LC14065">
</td>
      </tr>
      <tr>
        <td id="L14066" data-line-number="14066"></td>
        <td id="LC14066"><span>void</span> <span>CEEInfo::setBoundaries</span>(CORINFO_METHOD_HANDLE ftn, ULONG32 cMap,</td>
      </tr>
      <tr>
        <td id="L14067" data-line-number="14067"></td>
        <td id="LC14067">                               ICorDebugInfo::OffsetMapping *pMap)</td>
      </tr>
      <tr>
        <td id="L14068" data-line-number="14068"></td>
        <td id="LC14068">{</td>
      </tr>
      <tr>
        <td id="L14069" data-line-number="14069"></td>
        <td id="LC14069">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14070" data-line-number="14070"></td>
        <td id="LC14070">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14071" data-line-number="14071"></td>
        <td id="LC14071">}</td>
      </tr>
      <tr>
        <td id="L14072" data-line-number="14072"></td>
        <td id="LC14072">
</td>
      </tr>
      <tr>
        <td id="L14073" data-line-number="14073"></td>
        <td id="LC14073"><span>void</span> <span>CEEInfo::setVars</span>(CORINFO_METHOD_HANDLE ftn, ULONG32 cVars, ICorDebugInfo::NativeVarInfo *vars)</td>
      </tr>
      <tr>
        <td id="L14074" data-line-number="14074"></td>
        <td id="LC14074">{</td>
      </tr>
      <tr>
        <td id="L14075" data-line-number="14075"></td>
        <td id="LC14075">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14076" data-line-number="14076"></td>
        <td id="LC14076">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14077" data-line-number="14077"></td>
        <td id="LC14077">}</td>
      </tr>
      <tr>
        <td id="L14078" data-line-number="14078"></td>
        <td id="LC14078">
</td>
      </tr>
      <tr>
        <td id="L14079" data-line-number="14079"></td>
        <td id="LC14079"><span>void</span>* <span>CEEInfo::getHelperFtn</span>(CorInfoHelpFunc    ftnNum,         <span><span>/*</span> IN  <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14080" data-line-number="14080"></td>
        <td id="LC14080">                            <span>void</span> **            ppIndirection)  <span><span>/*</span> OUT <span>*/</span></span></td>
      </tr>
      <tr>
        <td id="L14081" data-line-number="14081"></td>
        <td id="LC14081">{</td>
      </tr>
      <tr>
        <td id="L14082" data-line-number="14082"></td>
        <td id="LC14082">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14083" data-line-number="14083"></td>
        <td id="LC14083">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14084" data-line-number="14084"></td>
        <td id="LC14084">}</td>
      </tr>
      <tr>
        <td id="L14085" data-line-number="14085"></td>
        <td id="LC14085">
</td>
      </tr>
      <tr>
        <td id="L14086" data-line-number="14086"></td>
        <td id="LC14086"><span><span>//</span> Active dependency helpers</span></td>
      </tr>
      <tr>
        <td id="L14087" data-line-number="14087"></td>
        <td id="LC14087"><span>void</span> <span>CEEInfo::addActiveDependency</span>(CORINFO_MODULE_HANDLE moduleFrom,CORINFO_MODULE_HANDLE moduleTo)</td>
      </tr>
      <tr>
        <td id="L14088" data-line-number="14088"></td>
        <td id="LC14088">{</td>
      </tr>
      <tr>
        <td id="L14089" data-line-number="14089"></td>
        <td id="LC14089">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14090" data-line-number="14090"></td>
        <td id="LC14090">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14091" data-line-number="14091"></td>
        <td id="LC14091">}</td>
      </tr>
      <tr>
        <td id="L14092" data-line-number="14092"></td>
        <td id="LC14092">
</td>
      </tr>
      <tr>
        <td id="L14093" data-line-number="14093"></td>
        <td id="LC14093"><span>void</span> <span>CEEInfo::GetProfilingHandle</span>(BOOL                      *pbHookFunction,</td>
      </tr>
      <tr>
        <td id="L14094" data-line-number="14094"></td>
        <td id="LC14094">                                 <span>void</span>                     **pProfilerHandle,</td>
      </tr>
      <tr>
        <td id="L14095" data-line-number="14095"></td>
        <td id="LC14095">                                 BOOL                      *pbIndirectedHandles)</td>
      </tr>
      <tr>
        <td id="L14096" data-line-number="14096"></td>
        <td id="LC14096">{</td>
      </tr>
      <tr>
        <td id="L14097" data-line-number="14097"></td>
        <td id="LC14097">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14098" data-line-number="14098"></td>
        <td id="LC14098">    <span>UNREACHABLE</span>();      <span><span>//</span> only called on derived class.</span></td>
      </tr>
      <tr>
        <td id="L14099" data-line-number="14099"></td>
        <td id="LC14099">}</td>
      </tr>
      <tr>
        <td id="L14100" data-line-number="14100"></td>
        <td id="LC14100">
</td>
      </tr>
      <tr>
        <td id="L14101" data-line-number="14101"></td>
        <td id="LC14101">#<span>endif</span> <span><span>//</span> !DACCESS_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L14102" data-line-number="14102"></td>
        <td id="LC14102">
</td>
      </tr>
      <tr>
        <td id="L14103" data-line-number="14103"></td>
        <td id="LC14103"><span>EECodeInfo::EECodeInfo</span>()</td>
      </tr>
      <tr>
        <td id="L14104" data-line-number="14104"></td>
        <td id="LC14104">{</td>
      </tr>
      <tr>
        <td id="L14105" data-line-number="14105"></td>
        <td id="LC14105">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14106" data-line-number="14106"></td>
        <td id="LC14106">
</td>
      </tr>
      <tr>
        <td id="L14107" data-line-number="14107"></td>
        <td id="LC14107">    m_codeAddress = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14108" data-line-number="14108"></td>
        <td id="LC14108">
</td>
      </tr>
      <tr>
        <td id="L14109" data-line-number="14109"></td>
        <td id="LC14109">    m_pJM = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14110" data-line-number="14110"></td>
        <td id="LC14110">    m_pMD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14111" data-line-number="14111"></td>
        <td id="LC14111">    m_relOffset = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L14112" data-line-number="14112"></td>
        <td id="LC14112">
</td>
      </tr>
      <tr>
        <td id="L14113" data-line-number="14113"></td>
        <td id="LC14113">#<span>ifdef</span> FEATURE_EH_FUNCLETS</td>
      </tr>
      <tr>
        <td id="L14114" data-line-number="14114"></td>
        <td id="LC14114">    m_pFunctionEntry = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14115" data-line-number="14115"></td>
        <td id="LC14115">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L14116" data-line-number="14116"></td>
        <td id="LC14116">}</td>
      </tr>
      <tr>
        <td id="L14117" data-line-number="14117"></td>
        <td id="LC14117">
</td>
      </tr>
      <tr>
        <td id="L14118" data-line-number="14118"></td>
        <td id="LC14118"><span>void</span> <span>EECodeInfo::Init</span>(PCODE codeAddress)</td>
      </tr>
      <tr>
        <td id="L14119" data-line-number="14119"></td>
        <td id="LC14119">{</td>
      </tr>
      <tr>
        <td id="L14120" data-line-number="14120"></td>
        <td id="LC14120">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L14121" data-line-number="14121"></td>
        <td id="LC14121">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L14122" data-line-number="14122"></td>
        <td id="LC14122">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L14123" data-line-number="14123"></td>
        <td id="LC14123">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L14124" data-line-number="14124"></td>
        <td id="LC14124">
</td>
      </tr>
      <tr>
        <td id="L14125" data-line-number="14125"></td>
        <td id="LC14125">    <span>Init</span>(codeAddress, <span>ExecutionManager::GetScanFlags</span>());</td>
      </tr>
      <tr>
        <td id="L14126" data-line-number="14126"></td>
        <td id="LC14126">}</td>
      </tr>
      <tr>
        <td id="L14127" data-line-number="14127"></td>
        <td id="LC14127">
</td>
      </tr>
      <tr>
        <td id="L14128" data-line-number="14128"></td>
        <td id="LC14128"><span>void</span> <span>EECodeInfo::Init</span>(PCODE codeAddress, ExecutionManager::ScanFlag scanFlag)</td>
      </tr>
      <tr>
        <td id="L14129" data-line-number="14129"></td>
        <td id="LC14129">{</td>
      </tr>
      <tr>
        <td id="L14130" data-line-number="14130"></td>
        <td id="LC14130">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L14131" data-line-number="14131"></td>
        <td id="LC14131">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L14132" data-line-number="14132"></td>
        <td id="LC14132">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L14133" data-line-number="14133"></td>
        <td id="LC14133">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L14134" data-line-number="14134"></td>
        <td id="LC14134">
</td>
      </tr>
      <tr>
        <td id="L14135" data-line-number="14135"></td>
        <td id="LC14135">    m_codeAddress = codeAddress;</td>
      </tr>
      <tr>
        <td id="L14136" data-line-number="14136"></td>
        <td id="LC14136">
</td>
      </tr>
      <tr>
        <td id="L14137" data-line-number="14137"></td>
        <td id="LC14137">    RangeSection * pRS = <span>ExecutionManager::FindCodeRange</span>(codeAddress, scanFlag);</td>
      </tr>
      <tr>
        <td id="L14138" data-line-number="14138"></td>
        <td id="LC14138">    <span>if</span> (pRS == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L14139" data-line-number="14139"></td>
        <td id="LC14139">        <span>goto</span> Invalid;</td>
      </tr>
      <tr>
        <td id="L14140" data-line-number="14140"></td>
        <td id="LC14140">
</td>
      </tr>
      <tr>
        <td id="L14141" data-line-number="14141"></td>
        <td id="LC14141">    <span>if</span> (!pRS-&gt;<span>pjit</span>-&gt;<span>JitCodeToMethodInfo</span>(pRS, codeAddress, &amp;m_pMD, <span>this</span>))</td>
      </tr>
      <tr>
        <td id="L14142" data-line-number="14142"></td>
        <td id="LC14142">        <span>goto</span> Invalid;</td>
      </tr>
      <tr>
        <td id="L14143" data-line-number="14143"></td>
        <td id="LC14143">
</td>
      </tr>
      <tr>
        <td id="L14144" data-line-number="14144"></td>
        <td id="LC14144">    m_pJM = pRS-&gt;<span>pjit</span>;</td>
      </tr>
      <tr>
        <td id="L14145" data-line-number="14145"></td>
        <td id="LC14145">    <span>return</span>;</td>
      </tr>
      <tr>
        <td id="L14146" data-line-number="14146"></td>
        <td id="LC14146">
</td>
      </tr>
      <tr>
        <td id="L14147" data-line-number="14147"></td>
        <td id="LC14147">Invalid:</td>
      </tr>
      <tr>
        <td id="L14148" data-line-number="14148"></td>
        <td id="LC14148">    m_pJM = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14149" data-line-number="14149"></td>
        <td id="LC14149">    m_pMD = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14150" data-line-number="14150"></td>
        <td id="LC14150">    m_relOffset = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L14151" data-line-number="14151"></td>
        <td id="LC14151">
</td>
      </tr>
      <tr>
        <td id="L14152" data-line-number="14152"></td>
        <td id="LC14152">#<span>ifdef</span> FEATURE_EH_FUNCLETS</td>
      </tr>
      <tr>
        <td id="L14153" data-line-number="14153"></td>
        <td id="LC14153">    m_pFunctionEntry = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14154" data-line-number="14154"></td>
        <td id="LC14154">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L14155" data-line-number="14155"></td>
        <td id="LC14155">}</td>
      </tr>
      <tr>
        <td id="L14156" data-line-number="14156"></td>
        <td id="LC14156">
</td>
      </tr>
      <tr>
        <td id="L14157" data-line-number="14157"></td>
        <td id="LC14157">TADDR <span>EECodeInfo::GetSavedMethodCode</span>()</td>
      </tr>
      <tr>
        <td id="L14158" data-line-number="14158"></td>
        <td id="LC14158">{</td>
      </tr>
      <tr>
        <td id="L14159" data-line-number="14159"></td>
        <td id="LC14159">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L14160" data-line-number="14160"></td>
        <td id="LC14160">        <span><span>//</span> All EECodeInfo methods must be NOTHROW/GC_NOTRIGGER since they can</span></td>
      </tr>
      <tr>
        <td id="L14161" data-line-number="14161"></td>
        <td id="LC14161">        <span><span>//</span> be used during GC.</span></td>
      </tr>
      <tr>
        <td id="L14162" data-line-number="14162"></td>
        <td id="LC14162">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L14163" data-line-number="14163"></td>
        <td id="LC14163">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L14164" data-line-number="14164"></td>
        <td id="LC14164">        HOST_NOCALLS;</td>
      </tr>
      <tr>
        <td id="L14165" data-line-number="14165"></td>
        <td id="LC14165">        SUPPORTS_DAC;</td>
      </tr>
      <tr>
        <td id="L14166" data-line-number="14166"></td>
        <td id="LC14166">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L14167" data-line-number="14167"></td>
        <td id="LC14167">#<span>ifndef</span> HOST_64BIT</td>
      </tr>
      <tr>
        <td id="L14168" data-line-number="14168"></td>
        <td id="LC14168">#<span>if</span> defined(HAVE_GCCOVER)</td>
      </tr>
      <tr>
        <td id="L14169" data-line-number="14169"></td>
        <td id="LC14169">    <span>_ASSERTE</span> (!m_pMD-&gt;<span>m_GcCover</span> || GCStress&lt;cfg_instr&gt;::<span>IsEnabled</span>());</td>
      </tr>
      <tr>
        <td id="L14170" data-line-number="14170"></td>
        <td id="LC14170">    <span>if</span> (GCStress&lt;cfg_instr&gt;::<span>IsEnabled</span>()</td>
      </tr>
      <tr>
        <td id="L14171" data-line-number="14171"></td>
        <td id="LC14171">        &amp;&amp; m_pMD-&gt;<span>m_GcCover</span>)</td>
      </tr>
      <tr>
        <td id="L14172" data-line-number="14172"></td>
        <td id="LC14172">    {</td>
      </tr>
      <tr>
        <td id="L14173" data-line-number="14173"></td>
        <td id="LC14173">        <span>_ASSERTE</span>(m_pMD-&gt;<span>m_GcCover</span>-&gt;<span>savedCode</span>);</td>
      </tr>
      <tr>
        <td id="L14174" data-line-number="14174"></td>
        <td id="LC14174">
</td>
      </tr>
      <tr>
        <td id="L14175" data-line-number="14175"></td>
        <td id="LC14175">        <span><span>//</span> Make sure we return the TADDR of savedCode here.  The byte array is not marshaled automatically.</span></td>
      </tr>
      <tr>
        <td id="L14176" data-line-number="14176"></td>
        <td id="LC14176">        <span><span>//</span> The caller is responsible for any necessary marshaling.</span></td>
      </tr>
      <tr>
        <td id="L14177" data-line-number="14177"></td>
        <td id="LC14177">        <span>return</span> <span>PTR_TO_MEMBER_TADDR</span>(GCCoverageInfo, m_pMD-&gt;<span>m_GcCover</span>, savedCode);</td>
      </tr>
      <tr>
        <td id="L14178" data-line-number="14178"></td>
        <td id="LC14178">    }</td>
      </tr>
      <tr>
        <td id="L14179" data-line-number="14179"></td>
        <td id="LC14179">#<span>endif</span> <span><span>//</span>defined(HAVE_GCCOVER)</span></td>
      </tr>
      <tr>
        <td id="L14180" data-line-number="14180"></td>
        <td id="LC14180">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L14181" data-line-number="14181"></td>
        <td id="LC14181">
</td>
      </tr>
      <tr>
        <td id="L14182" data-line-number="14182"></td>
        <td id="LC14182">    <span>return</span> <span>GetStartAddress</span>();</td>
      </tr>
      <tr>
        <td id="L14183" data-line-number="14183"></td>
        <td id="LC14183">}</td>
      </tr>
      <tr>
        <td id="L14184" data-line-number="14184"></td>
        <td id="LC14184">
</td>
      </tr>
      <tr>
        <td id="L14185" data-line-number="14185"></td>
        <td id="LC14185">TADDR <span>EECodeInfo::GetStartAddress</span>()</td>
      </tr>
      <tr>
        <td id="L14186" data-line-number="14186"></td>
        <td id="LC14186">{</td>
      </tr>
      <tr>
        <td id="L14187" data-line-number="14187"></td>
        <td id="LC14187">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L14188" data-line-number="14188"></td>
        <td id="LC14188">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L14189" data-line-number="14189"></td>
        <td id="LC14189">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L14190" data-line-number="14190"></td>
        <td id="LC14190">        HOST_NOCALLS;</td>
      </tr>
      <tr>
        <td id="L14191" data-line-number="14191"></td>
        <td id="LC14191">        SUPPORTS_DAC;</td>
      </tr>
      <tr>
        <td id="L14192" data-line-number="14192"></td>
        <td id="LC14192">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L14193" data-line-number="14193"></td>
        <td id="LC14193">
</td>
      </tr>
      <tr>
        <td id="L14194" data-line-number="14194"></td>
        <td id="LC14194">    <span>return</span> m_pJM-&gt;<span>JitTokenToStartAddress</span>(m_methodToken);</td>
      </tr>
      <tr>
        <td id="L14195" data-line-number="14195"></td>
        <td id="LC14195">}</td>
      </tr>
      <tr>
        <td id="L14196" data-line-number="14196"></td>
        <td id="LC14196">
</td>
      </tr>
      <tr>
        <td id="L14197" data-line-number="14197"></td>
        <td id="LC14197">NativeCodeVersion <span>EECodeInfo::GetNativeCodeVersion</span>()</td>
      </tr>
      <tr>
        <td id="L14198" data-line-number="14198"></td>
        <td id="LC14198">{</td>
      </tr>
      <tr>
        <td id="L14199" data-line-number="14199"></td>
        <td id="LC14199">    CONTRACTL</td>
      </tr>
      <tr>
        <td id="L14200" data-line-number="14200"></td>
        <td id="LC14200">    {</td>
      </tr>
      <tr>
        <td id="L14201" data-line-number="14201"></td>
        <td id="LC14201">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L14202" data-line-number="14202"></td>
        <td id="LC14202">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L14203" data-line-number="14203"></td>
        <td id="LC14203">    }</td>
      </tr>
      <tr>
        <td id="L14204" data-line-number="14204"></td>
        <td id="LC14204">    CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L14205" data-line-number="14205"></td>
        <td id="LC14205">
</td>
      </tr>
      <tr>
        <td id="L14206" data-line-number="14206"></td>
        <td id="LC14206">    PTR_MethodDesc pMD = <span>PTR_MethodDesc</span>(<span>GetMethodDesc</span>());</td>
      </tr>
      <tr>
        <td id="L14207" data-line-number="14207"></td>
        <td id="LC14207">    <span>if</span> (pMD == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L14208" data-line-number="14208"></td>
        <td id="LC14208">    {</td>
      </tr>
      <tr>
        <td id="L14209" data-line-number="14209"></td>
        <td id="LC14209">        <span>return</span> <span>NativeCodeVersion</span>();</td>
      </tr>
      <tr>
        <td id="L14210" data-line-number="14210"></td>
        <td id="LC14210">    }</td>
      </tr>
      <tr>
        <td id="L14211" data-line-number="14211"></td>
        <td id="LC14211">
</td>
      </tr>
      <tr>
        <td id="L14212" data-line-number="14212"></td>
        <td id="LC14212">#<span>ifdef</span> FEATURE_CODE_VERSIONING</td>
      </tr>
      <tr>
        <td id="L14213" data-line-number="14213"></td>
        <td id="LC14213">    <span>if</span> (pMD-&gt;<span>IsVersionable</span>())</td>
      </tr>
      <tr>
        <td id="L14214" data-line-number="14214"></td>
        <td id="LC14214">    {</td>
      </tr>
      <tr>
        <td id="L14215" data-line-number="14215"></td>
        <td id="LC14215">        CodeVersionManager *pCodeVersionManager = pMD-&gt;<span>GetCodeVersionManager</span>();</td>
      </tr>
      <tr>
        <td id="L14216" data-line-number="14216"></td>
        <td id="LC14216">        CodeVersionManager::LockHolder codeVersioningLockHolder;</td>
      </tr>
      <tr>
        <td id="L14217" data-line-number="14217"></td>
        <td id="LC14217">        <span>return</span> pCodeVersionManager-&gt;<span>GetNativeCodeVersion</span>(pMD, <span>PINSTRToPCODE</span>(<span>GetStartAddress</span>()));</td>
      </tr>
      <tr>
        <td id="L14218" data-line-number="14218"></td>
        <td id="LC14218">    }</td>
      </tr>
      <tr>
        <td id="L14219" data-line-number="14219"></td>
        <td id="LC14219">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L14220" data-line-number="14220"></td>
        <td id="LC14220">    <span>return</span> <span>NativeCodeVersion</span>(pMD);</td>
      </tr>
      <tr>
        <td id="L14221" data-line-number="14221"></td>
        <td id="LC14221">}</td>
      </tr>
      <tr>
        <td id="L14222" data-line-number="14222"></td>
        <td id="LC14222">
</td>
      </tr>
      <tr>
        <td id="L14223" data-line-number="14223"></td>
        <td id="LC14223">#<span>if</span> defined(FEATURE_EH_FUNCLETS)</td>
      </tr>
      <tr>
        <td id="L14224" data-line-number="14224"></td>
        <td id="LC14224">
</td>
      </tr>
      <tr>
        <td id="L14225" data-line-number="14225"></td>
        <td id="LC14225"><span><span>//</span> ----------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L14226" data-line-number="14226"></td>
        <td id="LC14226"><span><span>//</span> EECodeInfo::GetMainFunctionInfo</span></td>
      </tr>
      <tr>
        <td id="L14227" data-line-number="14227"></td>
        <td id="LC14227"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14228" data-line-number="14228"></td>
        <td id="LC14228"><span><span>//</span> Description:</span></td>
      </tr>
      <tr>
        <td id="L14229" data-line-number="14229"></td>
        <td id="LC14229"><span><span>//</span>    Simple helper to transform a funclet's EECodeInfo into a parent function EECodeInfo.</span></td>
      </tr>
      <tr>
        <td id="L14230" data-line-number="14230"></td>
        <td id="LC14230"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14231" data-line-number="14231"></td>
        <td id="LC14231"><span><span>//</span> Return Value:</span></td>
      </tr>
      <tr>
        <td id="L14232" data-line-number="14232"></td>
        <td id="LC14232"><span><span>//</span>    An EECodeInfo for the start of the main function body (offset 0).</span></td>
      </tr>
      <tr>
        <td id="L14233" data-line-number="14233"></td>
        <td id="LC14233"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14234" data-line-number="14234"></td>
        <td id="LC14234">
</td>
      </tr>
      <tr>
        <td id="L14235" data-line-number="14235"></td>
        <td id="LC14235">EECodeInfo <span>EECodeInfo::GetMainFunctionInfo</span>()</td>
      </tr>
      <tr>
        <td id="L14236" data-line-number="14236"></td>
        <td id="LC14236">{</td>
      </tr>
      <tr>
        <td id="L14237" data-line-number="14237"></td>
        <td id="LC14237">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14238" data-line-number="14238"></td>
        <td id="LC14238">    SUPPORTS_DAC;</td>
      </tr>
      <tr>
        <td id="L14239" data-line-number="14239"></td>
        <td id="LC14239">
</td>
      </tr>
      <tr>
        <td id="L14240" data-line-number="14240"></td>
        <td id="LC14240">    EECodeInfo result = *<span>this</span>;</td>
      </tr>
      <tr>
        <td id="L14241" data-line-number="14241"></td>
        <td id="LC14241">    result.<span>m_relOffset</span> = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L14242" data-line-number="14242"></td>
        <td id="LC14242">    result.<span>m_codeAddress</span> = <span>this</span>-&gt;<span>GetStartAddress</span>();</td>
      </tr>
      <tr>
        <td id="L14243" data-line-number="14243"></td>
        <td id="LC14243">    result.<span>m_pFunctionEntry</span> = <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14244" data-line-number="14244"></td>
        <td id="LC14244">
</td>
      </tr>
      <tr>
        <td id="L14245" data-line-number="14245"></td>
        <td id="LC14245">    <span>return</span> result;</td>
      </tr>
      <tr>
        <td id="L14246" data-line-number="14246"></td>
        <td id="LC14246">}</td>
      </tr>
      <tr>
        <td id="L14247" data-line-number="14247"></td>
        <td id="LC14247">
</td>
      </tr>
      <tr>
        <td id="L14248" data-line-number="14248"></td>
        <td id="LC14248">PTR_RUNTIME_FUNCTION <span>EECodeInfo::GetFunctionEntry</span>()</td>
      </tr>
      <tr>
        <td id="L14249" data-line-number="14249"></td>
        <td id="LC14249">{</td>
      </tr>
      <tr>
        <td id="L14250" data-line-number="14250"></td>
        <td id="LC14250">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14251" data-line-number="14251"></td>
        <td id="LC14251">    SUPPORTS_DAC;</td>
      </tr>
      <tr>
        <td id="L14252" data-line-number="14252"></td>
        <td id="LC14252">
</td>
      </tr>
      <tr>
        <td id="L14253" data-line-number="14253"></td>
        <td id="LC14253">    <span>if</span> (m_pFunctionEntry == <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L14254" data-line-number="14254"></td>
        <td id="LC14254">        m_pFunctionEntry = m_pJM-&gt;<span>LazyGetFunctionEntry</span>(<span>this</span>);</td>
      </tr>
      <tr>
        <td id="L14255" data-line-number="14255"></td>
        <td id="LC14255">    <span>return</span> m_pFunctionEntry;</td>
      </tr>
      <tr>
        <td id="L14256" data-line-number="14256"></td>
        <td id="LC14256">}</td>
      </tr>
      <tr>
        <td id="L14257" data-line-number="14257"></td>
        <td id="LC14257">
</td>
      </tr>
      <tr>
        <td id="L14258" data-line-number="14258"></td>
        <td id="LC14258">#<span>if</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L14259" data-line-number="14259"></td>
        <td id="LC14259">
</td>
      </tr>
      <tr>
        <td id="L14260" data-line-number="14260"></td>
        <td id="LC14260">BOOL <span>EECodeInfo::HasFrameRegister</span>()</td>
      </tr>
      <tr>
        <td id="L14261" data-line-number="14261"></td>
        <td id="LC14261">{</td>
      </tr>
      <tr>
        <td id="L14262" data-line-number="14262"></td>
        <td id="LC14262">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14263" data-line-number="14263"></td>
        <td id="LC14263">
</td>
      </tr>
      <tr>
        <td id="L14264" data-line-number="14264"></td>
        <td id="LC14264">    PTR_RUNTIME_FUNCTION pFuncEntry = <span>GetFunctionEntry</span>();</td>
      </tr>
      <tr>
        <td id="L14265" data-line-number="14265"></td>
        <td id="LC14265">    <span>_ASSERTE</span>(pFuncEntry != <span>NULL</span>);</td>
      </tr>
      <tr>
        <td id="L14266" data-line-number="14266"></td>
        <td id="LC14266">
</td>
      </tr>
      <tr>
        <td id="L14267" data-line-number="14267"></td>
        <td id="LC14267">    BOOL <span>fHasFrameRegister</span> = <span>FALSE</span>;</td>
      </tr>
      <tr>
        <td id="L14268" data-line-number="14268"></td>
        <td id="LC14268">    PUNWIND_INFO pUnwindInfo = (PUNWIND_INFO)(<span>GetModuleBase</span>() + pFuncEntry-&gt;<span>UnwindData</span>);</td>
      </tr>
      <tr>
        <td id="L14269" data-line-number="14269"></td>
        <td id="LC14269">    <span>if</span> (pUnwindInfo-&gt;<span>FrameRegister</span> != <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L14270" data-line-number="14270"></td>
        <td id="LC14270">    {</td>
      </tr>
      <tr>
        <td id="L14271" data-line-number="14271"></td>
        <td id="LC14271">        <span>fHasFrameRegister</span> = <span>TRUE</span>;</td>
      </tr>
      <tr>
        <td id="L14272" data-line-number="14272"></td>
        <td id="LC14272">        <span>_ASSERTE</span>(pUnwindInfo-&gt;<span>FrameRegister</span> == <span>kRBP</span>);</td>
      </tr>
      <tr>
        <td id="L14273" data-line-number="14273"></td>
        <td id="LC14273">    }</td>
      </tr>
      <tr>
        <td id="L14274" data-line-number="14274"></td>
        <td id="LC14274">
</td>
      </tr>
      <tr>
        <td id="L14275" data-line-number="14275"></td>
        <td id="LC14275">    <span>return</span> <span>fHasFrameRegister</span>;</td>
      </tr>
      <tr>
        <td id="L14276" data-line-number="14276"></td>
        <td id="LC14276">}</td>
      </tr>
      <tr>
        <td id="L14277" data-line-number="14277"></td>
        <td id="LC14277">#<span>endif</span> <span><span>//</span> defined(TARGET_AMD64)</span></td>
      </tr>
      <tr>
        <td id="L14278" data-line-number="14278"></td>
        <td id="LC14278">
</td>
      </tr>
      <tr>
        <td id="L14279" data-line-number="14279"></td>
        <td id="LC14279">#<span>endif</span> <span><span>//</span> defined(FEATURE_EH_FUNCLETS)</span></td>
      </tr>
      <tr>
        <td id="L14280" data-line-number="14280"></td>
        <td id="LC14280">
</td>
      </tr>
      <tr>
        <td id="L14281" data-line-number="14281"></td>
        <td id="LC14281">
</td>
      </tr>
      <tr>
        <td id="L14282" data-line-number="14282"></td>
        <td id="LC14282">#<span>if</span> defined(TARGET_AMD64)</td>
      </tr>
      <tr>
        <td id="L14283" data-line-number="14283"></td>
        <td id="LC14283"><span><span>//</span> ----------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L14284" data-line-number="14284"></td>
        <td id="LC14284"><span><span>//</span> EECodeInfo::GetUnwindInfoHelper</span></td>
      </tr>
      <tr>
        <td id="L14285" data-line-number="14285"></td>
        <td id="LC14285"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14286" data-line-number="14286"></td>
        <td id="LC14286"><span><span>//</span> Description:</span></td>
      </tr>
      <tr>
        <td id="L14287" data-line-number="14287"></td>
        <td id="LC14287"><span><span>//</span>    Simple helper to return a pointer to the UNWIND_INFO given the offset to the unwind info.</span></td>
      </tr>
      <tr>
        <td id="L14288" data-line-number="14288"></td>
        <td id="LC14288"><span><span>//</span>    On DAC builds, this function will read the memory from the target process and create a host copy.</span></td>
      </tr>
      <tr>
        <td id="L14289" data-line-number="14289"></td>
        <td id="LC14289"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14290" data-line-number="14290"></td>
        <td id="LC14290"><span><span>//</span> Arguments:</span></td>
      </tr>
      <tr>
        <td id="L14291" data-line-number="14291"></td>
        <td id="LC14291"><span><span>//</span>    * unwindInfoOffset - This is the offset to the unwind info, relative to the beginning of the code heap</span></td>
      </tr>
      <tr>
        <td id="L14292" data-line-number="14292"></td>
        <td id="LC14292"><span><span>//</span>        for jitted code or to the module base for ngned code. this-&gt;GetModuleBase() will return the correct</span></td>
      </tr>
      <tr>
        <td id="L14293" data-line-number="14293"></td>
        <td id="LC14293"><span><span>//</span>        module base.</span></td>
      </tr>
      <tr>
        <td id="L14294" data-line-number="14294"></td>
        <td id="LC14294"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14295" data-line-number="14295"></td>
        <td id="LC14295"><span><span>//</span> Return Value:</span></td>
      </tr>
      <tr>
        <td id="L14296" data-line-number="14296"></td>
        <td id="LC14296"><span><span>//</span>    Return a pointer to the UNWIND_INFO.  On DAC builds, this function will create a host copy of the</span></td>
      </tr>
      <tr>
        <td id="L14297" data-line-number="14297"></td>
        <td id="LC14297"><span><span>//</span>    UNWIND_INFO and return a host pointer.  It will correctly read all of the memory for the variable-sized</span></td>
      </tr>
      <tr>
        <td id="L14298" data-line-number="14298"></td>
        <td id="LC14298"><span><span>//</span>    unwind info.</span></td>
      </tr>
      <tr>
        <td id="L14299" data-line-number="14299"></td>
        <td id="LC14299"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14300" data-line-number="14300"></td>
        <td id="LC14300">
</td>
      </tr>
      <tr>
        <td id="L14301" data-line-number="14301"></td>
        <td id="LC14301">UNWIND_INFO * <span>EECodeInfo::GetUnwindInfoHelper</span>(ULONG unwindInfoOffset)</td>
      </tr>
      <tr>
        <td id="L14302" data-line-number="14302"></td>
        <td id="LC14302">{</td>
      </tr>
      <tr>
        <td id="L14303" data-line-number="14303"></td>
        <td id="LC14303">#<span>if</span> defined(DACCESS_COMPILE)</td>
      </tr>
      <tr>
        <td id="L14304" data-line-number="14304"></td>
        <td id="LC14304">    <span>return</span> <span>DacGetUnwindInfo</span>(<span>static_cast</span>&lt;TADDR&gt;(<span>this</span>-&gt;<span>GetModuleBase</span>() + unwindInfoOffset));</td>
      </tr>
      <tr>
        <td id="L14305" data-line-number="14305"></td>
        <td id="LC14305">#<span>else</span>  <span><span>//</span> !DACCESS_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L14306" data-line-number="14306"></td>
        <td id="LC14306">    <span>return</span> <span>reinterpret_cast</span>&lt;UNWIND_INFO *&gt;(<span>this</span>-&gt;<span>GetModuleBase</span>() + unwindInfoOffset);</td>
      </tr>
      <tr>
        <td id="L14307" data-line-number="14307"></td>
        <td id="LC14307">#<span>endif</span> <span><span>//</span> !DACCESS_COMPILE</span></td>
      </tr>
      <tr>
        <td id="L14308" data-line-number="14308"></td>
        <td id="LC14308">}</td>
      </tr>
      <tr>
        <td id="L14309" data-line-number="14309"></td>
        <td id="LC14309">
</td>
      </tr>
      <tr>
        <td id="L14310" data-line-number="14310"></td>
        <td id="LC14310"><span><span>//</span> ----------------------------------------------------------------------------</span></td>
      </tr>
      <tr>
        <td id="L14311" data-line-number="14311"></td>
        <td id="LC14311"><span><span>//</span> EECodeInfo::GetFixedStackSize</span></td>
      </tr>
      <tr>
        <td id="L14312" data-line-number="14312"></td>
        <td id="LC14312"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14313" data-line-number="14313"></td>
        <td id="LC14313"><span><span>//</span> Description:</span></td>
      </tr>
      <tr>
        <td id="L14314" data-line-number="14314"></td>
        <td id="LC14314"><span><span>//</span>    Return the fixed stack size of a specified managed method.  This function DOES NOT take current control</span></td>
      </tr>
      <tr>
        <td id="L14315" data-line-number="14315"></td>
        <td id="LC14315"><span><span>//</span>    PC into account.  So the fixed stack size returned by this function is not valid in the prolog or</span></td>
      </tr>
      <tr>
        <td id="L14316" data-line-number="14316"></td>
        <td id="LC14316"><span><span>//</span>    the epilog.</span></td>
      </tr>
      <tr>
        <td id="L14317" data-line-number="14317"></td>
        <td id="LC14317"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14318" data-line-number="14318"></td>
        <td id="LC14318"><span><span>//</span> Return Value:</span></td>
      </tr>
      <tr>
        <td id="L14319" data-line-number="14319"></td>
        <td id="LC14319"><span><span>//</span>    Return the fixed stack size.</span></td>
      </tr>
      <tr>
        <td id="L14320" data-line-number="14320"></td>
        <td id="LC14320"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14321" data-line-number="14321"></td>
        <td id="LC14321"><span><span>//</span> Notes:</span></td>
      </tr>
      <tr>
        <td id="L14322" data-line-number="14322"></td>
        <td id="LC14322"><span><span>//</span>    * For method with dynamic stack allocations, this function will return the fixed stack size on X64 (the</span></td>
      </tr>
      <tr>
        <td id="L14323" data-line-number="14323"></td>
        <td id="LC14323"><span><span>//</span>        stack size immediately after the prolog), and it will return 0 on IA64. This difference is due to</span></td>
      </tr>
      <tr>
        <td id="L14324" data-line-number="14324"></td>
        <td id="LC14324"><span><span>//</span>        the different unwind info encoding.</span></td>
      </tr>
      <tr>
        <td id="L14325" data-line-number="14325"></td>
        <td id="LC14325"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14326" data-line-number="14326"></td>
        <td id="LC14326">
</td>
      </tr>
      <tr>
        <td id="L14327" data-line-number="14327"></td>
        <td id="LC14327">ULONG <span>EECodeInfo::GetFixedStackSize</span>()</td>
      </tr>
      <tr>
        <td id="L14328" data-line-number="14328"></td>
        <td id="LC14328">{</td>
      </tr>
      <tr>
        <td id="L14329" data-line-number="14329"></td>
        <td id="LC14329">    WRAPPER_NO_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14330" data-line-number="14330"></td>
        <td id="LC14330">    SUPPORTS_DAC;</td>
      </tr>
      <tr>
        <td id="L14331" data-line-number="14331"></td>
        <td id="LC14331">
</td>
      </tr>
      <tr>
        <td id="L14332" data-line-number="14332"></td>
        <td id="LC14332">    ULONG uFixedStackSize = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L14333" data-line-number="14333"></td>
        <td id="LC14333">
</td>
      </tr>
      <tr>
        <td id="L14334" data-line-number="14334"></td>
        <td id="LC14334">    ULONG uDummy = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L14335" data-line-number="14335"></td>
        <td id="LC14335">    <span>GetOffsetsFromUnwindInfo</span>(&amp;uFixedStackSize, &amp;uDummy);</td>
      </tr>
      <tr>
        <td id="L14336" data-line-number="14336"></td>
        <td id="LC14336">
</td>
      </tr>
      <tr>
        <td id="L14337" data-line-number="14337"></td>
        <td id="LC14337">    <span>return</span> uFixedStackSize;</td>
      </tr>
      <tr>
        <td id="L14338" data-line-number="14338"></td>
        <td id="LC14338">}</td>
      </tr>
      <tr>
        <td id="L14339" data-line-number="14339"></td>
        <td id="LC14339">
</td>
      </tr>
      <tr>
        <td id="L14340" data-line-number="14340"></td>
        <td id="LC14340">#<span>define</span> <span>kRBP</span>    <span>5</span></td>
      </tr>
      <tr>
        <td id="L14341" data-line-number="14341"></td>
        <td id="LC14341"><span><span>//</span> The information returned by this method is only valid if we are not in a prolog or an epilog.</span></td>
      </tr>
      <tr>
        <td id="L14342" data-line-number="14342"></td>
        <td id="LC14342"><span><span>//</span> Since this method is only used for the security stackwalk cache, this assumption is valid, since</span></td>
      </tr>
      <tr>
        <td id="L14343" data-line-number="14343"></td>
        <td id="LC14343"><span><span>//</span> we cannot make a call in a prolog or an epilog.</span></td>
      </tr>
      <tr>
        <td id="L14344" data-line-number="14344"></td>
        <td id="LC14344"><span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14345" data-line-number="14345"></td>
        <td id="LC14345"><span><span>//</span> The next assumption is that only rbp is used as a frame register in jitted code.  There is an</span></td>
      </tr>
      <tr>
        <td id="L14346" data-line-number="14346"></td>
        <td id="LC14346"><span><span>//</span> assert below to guard this assumption.</span></td>
      </tr>
      <tr>
        <td id="L14347" data-line-number="14347"></td>
        <td id="LC14347"><span>void</span> <span>EECodeInfo::GetOffsetsFromUnwindInfo</span>(ULONG* pRSPOffset, ULONG* pRBPOffset)</td>
      </tr>
      <tr>
        <td id="L14348" data-line-number="14348"></td>
        <td id="LC14348">{</td>
      </tr>
      <tr>
        <td id="L14349" data-line-number="14349"></td>
        <td id="LC14349">    LIMITED_METHOD_CONTRACT;</td>
      </tr>
      <tr>
        <td id="L14350" data-line-number="14350"></td>
        <td id="LC14350">    SUPPORTS_DAC;</td>
      </tr>
      <tr>
        <td id="L14351" data-line-number="14351"></td>
        <td id="LC14351">
</td>
      </tr>
      <tr>
        <td id="L14352" data-line-number="14352"></td>
        <td id="LC14352">    <span>_ASSERTE</span>((pRSPOffset != <span>NULL</span>) &amp;&amp; (pRBPOffset != <span>NULL</span>));</td>
      </tr>
      <tr>
        <td id="L14353" data-line-number="14353"></td>
        <td id="LC14353">
</td>
      </tr>
      <tr>
        <td id="L14354" data-line-number="14354"></td>
        <td id="LC14354">    <span><span>//</span> moduleBase is a target address.</span></td>
      </tr>
      <tr>
        <td id="L14355" data-line-number="14355"></td>
        <td id="LC14355">    TADDR moduleBase = <span>GetModuleBase</span>();</td>
      </tr>
      <tr>
        <td id="L14356" data-line-number="14356"></td>
        <td id="LC14356">
</td>
      </tr>
      <tr>
        <td id="L14357" data-line-number="14357"></td>
        <td id="LC14357">    DWORD unwindInfo = <span>RUNTIME_FUNCTION__GetUnwindInfoAddress</span>(<span>GetFunctionEntry</span>());</td>
      </tr>
      <tr>
        <td id="L14358" data-line-number="14358"></td>
        <td id="LC14358">
</td>
      </tr>
      <tr>
        <td id="L14359" data-line-number="14359"></td>
        <td id="LC14359">    <span>if</span> ((unwindInfo &amp; RUNTIME_FUNCTION_INDIRECT) != <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L14360" data-line-number="14360"></td>
        <td id="LC14360">    {</td>
      </tr>
      <tr>
        <td id="L14361" data-line-number="14361"></td>
        <td id="LC14361">        unwindInfo = <span>RUNTIME_FUNCTION__GetUnwindInfoAddress</span>(<span>PTR_RUNTIME_FUNCTION</span>(moduleBase + (unwindInfo &amp; ~RUNTIME_FUNCTION_INDIRECT)));</td>
      </tr>
      <tr>
        <td id="L14362" data-line-number="14362"></td>
        <td id="LC14362">    }</td>
      </tr>
      <tr>
        <td id="L14363" data-line-number="14363"></td>
        <td id="LC14363">
</td>
      </tr>
      <tr>
        <td id="L14364" data-line-number="14364"></td>
        <td id="LC14364">    UNWIND_INFO * pInfo = <span>GetUnwindInfoHelper</span>(unwindInfo);</td>
      </tr>
      <tr>
        <td id="L14365" data-line-number="14365"></td>
        <td id="LC14365">    <span>if</span> (pInfo-&gt;<span>Flags</span> &amp; UNW_FLAG_CHAININFO)</td>
      </tr>
      <tr>
        <td id="L14366" data-line-number="14366"></td>
        <td id="LC14366">    {</td>
      </tr>
      <tr>
        <td id="L14367" data-line-number="14367"></td>
        <td id="LC14367">        <span>_ASSERTE</span>(!<span><span>"</span>GetRbpOffset() - chained unwind info used, violating assumptions of the security stackwalk cache<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L14368" data-line-number="14368"></td>
        <td id="LC14368">        <span>DebugBreak</span>();</td>
      </tr>
      <tr>
        <td id="L14369" data-line-number="14369"></td>
        <td id="LC14369">    }</td>
      </tr>
      <tr>
        <td id="L14370" data-line-number="14370"></td>
        <td id="LC14370">
</td>
      </tr>
      <tr>
        <td id="L14371" data-line-number="14371"></td>
        <td id="LC14371">    <span><span>//</span> Either we are not using a frame pointer, or we are using rbp as the frame pointer.</span></td>
      </tr>
      <tr>
        <td id="L14372" data-line-number="14372"></td>
        <td id="LC14372">    <span>if</span> ( (pInfo-&gt;<span>FrameRegister</span> != <span>0</span>) &amp;&amp; (pInfo-&gt;<span>FrameRegister</span> != <span>kRBP</span>) )</td>
      </tr>
      <tr>
        <td id="L14373" data-line-number="14373"></td>
        <td id="LC14373">    {</td>
      </tr>
      <tr>
        <td id="L14374" data-line-number="14374"></td>
        <td id="LC14374">        <span>_ASSERTE</span>(!<span><span>"</span>GetRbpOffset() - non-RBP frame pointer used, violating assumptions of the security stackwalk cache<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="L14375" data-line-number="14375"></td>
        <td id="LC14375">        <span>DebugBreak</span>();</td>
      </tr>
      <tr>
        <td id="L14376" data-line-number="14376"></td>
        <td id="LC14376">    }</td>
      </tr>
      <tr>
        <td id="L14377" data-line-number="14377"></td>
        <td id="LC14377">
</td>
      </tr>
      <tr>
        <td id="L14378" data-line-number="14378"></td>
        <td id="LC14378">    <span><span>//</span> Walk the unwind info.</span></td>
      </tr>
      <tr>
        <td id="L14379" data-line-number="14379"></td>
        <td id="LC14379">    ULONG StackOffset     = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L14380" data-line-number="14380"></td>
        <td id="LC14380">    ULONG StackSize       = <span>0</span>;</td>
      </tr>
      <tr>
        <td id="L14381" data-line-number="14381"></td>
        <td id="LC14381">    <span>for</span> (<span>int</span> i = <span>0</span>; i &lt; pInfo-&gt;<span>CountOfUnwindCodes</span>; i++)</td>
      </tr>
      <tr>
        <td id="L14382" data-line-number="14382"></td>
        <td id="LC14382">    {</td>
      </tr>
      <tr>
        <td id="L14383" data-line-number="14383"></td>
        <td id="LC14383">        ULONG UnwindOp = pInfo-&gt;<span>UnwindCode</span>[i].<span>UnwindOp</span>;</td>
      </tr>
      <tr>
        <td id="L14384" data-line-number="14384"></td>
        <td id="LC14384">        ULONG OpInfo   = pInfo-&gt;<span>UnwindCode</span>[i].<span>OpInfo</span>;</td>
      </tr>
      <tr>
        <td id="L14385" data-line-number="14385"></td>
        <td id="LC14385">
</td>
      </tr>
      <tr>
        <td id="L14386" data-line-number="14386"></td>
        <td id="LC14386">        <span>if</span> (UnwindOp == UWOP_SAVE_NONVOL)</td>
      </tr>
      <tr>
        <td id="L14387" data-line-number="14387"></td>
        <td id="LC14387">        {</td>
      </tr>
      <tr>
        <td id="L14388" data-line-number="14388"></td>
        <td id="LC14388">            <span>if</span> (OpInfo == <span>kRBP</span>)</td>
      </tr>
      <tr>
        <td id="L14389" data-line-number="14389"></td>
        <td id="LC14389">            {</td>
      </tr>
      <tr>
        <td id="L14390" data-line-number="14390"></td>
        <td id="LC14390">                StackOffset = pInfo-&gt;<span>UnwindCode</span>[i+<span>1</span>].<span>FrameOffset</span> * <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L14391" data-line-number="14391"></td>
        <td id="LC14391">            }</td>
      </tr>
      <tr>
        <td id="L14392" data-line-number="14392"></td>
        <td id="LC14392">        }</td>
      </tr>
      <tr>
        <td id="L14393" data-line-number="14393"></td>
        <td id="LC14393">        <span>else</span> <span>if</span> (UnwindOp == UWOP_SAVE_NONVOL_FAR)</td>
      </tr>
      <tr>
        <td id="L14394" data-line-number="14394"></td>
        <td id="LC14394">        {</td>
      </tr>
      <tr>
        <td id="L14395" data-line-number="14395"></td>
        <td id="LC14395">            <span>if</span> (OpInfo == <span>kRBP</span>)</td>
      </tr>
      <tr>
        <td id="L14396" data-line-number="14396"></td>
        <td id="LC14396">            {</td>
      </tr>
      <tr>
        <td id="L14397" data-line-number="14397"></td>
        <td id="LC14397">                StackOffset  =  pInfo-&gt;<span>UnwindCode</span>[i + <span>1</span>].<span>FrameOffset</span>;</td>
      </tr>
      <tr>
        <td id="L14398" data-line-number="14398"></td>
        <td id="LC14398">                StackOffset += (pInfo-&gt;<span>UnwindCode</span>[i + <span>2</span>].<span>FrameOffset</span> &lt;&lt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L14399" data-line-number="14399"></td>
        <td id="LC14399">            }</td>
      </tr>
      <tr>
        <td id="L14400" data-line-number="14400"></td>
        <td id="LC14400">        }</td>
      </tr>
      <tr>
        <td id="L14401" data-line-number="14401"></td>
        <td id="LC14401">        <span>else</span> <span>if</span> (UnwindOp == UWOP_ALLOC_SMALL)</td>
      </tr>
      <tr>
        <td id="L14402" data-line-number="14402"></td>
        <td id="LC14402">        {</td>
      </tr>
      <tr>
        <td id="L14403" data-line-number="14403"></td>
        <td id="LC14403">            StackSize += (OpInfo * <span>8</span>) + <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L14404" data-line-number="14404"></td>
        <td id="LC14404">        }</td>
      </tr>
      <tr>
        <td id="L14405" data-line-number="14405"></td>
        <td id="LC14405">        <span>else</span> <span>if</span> (UnwindOp == UWOP_ALLOC_LARGE)</td>
      </tr>
      <tr>
        <td id="L14406" data-line-number="14406"></td>
        <td id="LC14406">        {</td>
      </tr>
      <tr>
        <td id="L14407" data-line-number="14407"></td>
        <td id="LC14407">            ULONG IncrementalStackSize = pInfo-&gt;<span>UnwindCode</span>[i + <span>1</span>].<span>FrameOffset</span>;</td>
      </tr>
      <tr>
        <td id="L14408" data-line-number="14408"></td>
        <td id="LC14408">            <span>if</span> (OpInfo == <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L14409" data-line-number="14409"></td>
        <td id="LC14409">            {</td>
      </tr>
      <tr>
        <td id="L14410" data-line-number="14410"></td>
        <td id="LC14410">                IncrementalStackSize *= <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L14411" data-line-number="14411"></td>
        <td id="LC14411">            }</td>
      </tr>
      <tr>
        <td id="L14412" data-line-number="14412"></td>
        <td id="LC14412">            <span>else</span></td>
      </tr>
      <tr>
        <td id="L14413" data-line-number="14413"></td>
        <td id="LC14413">            {</td>
      </tr>
      <tr>
        <td id="L14414" data-line-number="14414"></td>
        <td id="LC14414">                IncrementalStackSize += (pInfo-&gt;<span>UnwindCode</span>[i + <span>2</span>].<span>FrameOffset</span> &lt;&lt; <span>16</span>);</td>
      </tr>
      <tr>
        <td id="L14415" data-line-number="14415"></td>
        <td id="LC14415">
</td>
      </tr>
      <tr>
        <td id="L14416" data-line-number="14416"></td>
        <td id="LC14416">                <span><span>//</span> This is a special opcode.  We need to increment the index by 1 in addition to the normal adjustments.</span></td>
      </tr>
      <tr>
        <td id="L14417" data-line-number="14417"></td>
        <td id="LC14417">                i += <span>1</span>;</td>
      </tr>
      <tr>
        <td id="L14418" data-line-number="14418"></td>
        <td id="LC14418">            }</td>
      </tr>
      <tr>
        <td id="L14419" data-line-number="14419"></td>
        <td id="LC14419">            StackSize += IncrementalStackSize;</td>
      </tr>
      <tr>
        <td id="L14420" data-line-number="14420"></td>
        <td id="LC14420">        }</td>
      </tr>
      <tr>
        <td id="L14421" data-line-number="14421"></td>
        <td id="LC14421">        <span>else</span> <span>if</span> (UnwindOp == UWOP_PUSH_NONVOL)</td>
      </tr>
      <tr>
        <td id="L14422" data-line-number="14422"></td>
        <td id="LC14422">        {</td>
      </tr>
      <tr>
        <td id="L14423" data-line-number="14423"></td>
        <td id="LC14423">            <span><span>//</span> Because of constraints on epilogs, this unwind opcode is always last in the unwind code array.</span></td>
      </tr>
      <tr>
        <td id="L14424" data-line-number="14424"></td>
        <td id="LC14424">            <span><span>//</span> This means that StackSize has been initialized already when we first see this unwind opcode.</span></td>
      </tr>
      <tr>
        <td id="L14425" data-line-number="14425"></td>
        <td id="LC14425">            <span><span>//</span> Note that the intial value of StackSize does not include the stack space used for pushes.</span></td>
      </tr>
      <tr>
        <td id="L14426" data-line-number="14426"></td>
        <td id="LC14426">            <span><span>//</span> Thus, here we only need to increment StackSize 8 bytes at a time until we see the unwind code for "push rbp".</span></td>
      </tr>
      <tr>
        <td id="L14427" data-line-number="14427"></td>
        <td id="LC14427">            <span>if</span> (OpInfo == <span>kRBP</span>)</td>
      </tr>
      <tr>
        <td id="L14428" data-line-number="14428"></td>
        <td id="LC14428">            {</td>
      </tr>
      <tr>
        <td id="L14429" data-line-number="14429"></td>
        <td id="LC14429">                StackOffset = StackSize;</td>
      </tr>
      <tr>
        <td id="L14430" data-line-number="14430"></td>
        <td id="LC14430">            }</td>
      </tr>
      <tr>
        <td id="L14431" data-line-number="14431"></td>
        <td id="LC14431">
</td>
      </tr>
      <tr>
        <td id="L14432" data-line-number="14432"></td>
        <td id="LC14432">            StackSize += <span>8</span>;</td>
      </tr>
      <tr>
        <td id="L14433" data-line-number="14433"></td>
        <td id="LC14433">        }</td>
      </tr>
      <tr>
        <td id="L14434" data-line-number="14434"></td>
        <td id="LC14434">
</td>
      </tr>
      <tr>
        <td id="L14435" data-line-number="14435"></td>
        <td id="LC14435">        <span><span>//</span> Adjust the index into the unwind code array.</span></td>
      </tr>
      <tr>
        <td id="L14436" data-line-number="14436"></td>
        <td id="LC14436">        i += UnwindOpExtraSlotTable[UnwindOp];</td>
      </tr>
      <tr>
        <td id="L14437" data-line-number="14437"></td>
        <td id="LC14437">    }</td>
      </tr>
      <tr>
        <td id="L14438" data-line-number="14438"></td>
        <td id="LC14438">
</td>
      </tr>
      <tr>
        <td id="L14439" data-line-number="14439"></td>
        <td id="LC14439">    *pRSPOffset = StackSize + <span>8</span>;        <span><span>//</span> add 8 for the return address</span></td>
      </tr>
      <tr>
        <td id="L14440" data-line-number="14440"></td>
        <td id="LC14440">    *pRBPOffset = StackOffset;</td>
      </tr>
      <tr>
        <td id="L14441" data-line-number="14441"></td>
        <td id="LC14441">}</td>
      </tr>
      <tr>
        <td id="L14442" data-line-number="14442"></td>
        <td id="LC14442">#<span>undef</span> kRBP</td>
      </tr>
      <tr>
        <td id="L14443" data-line-number="14443"></td>
        <td id="LC14443">
</td>
      </tr>
      <tr>
        <td id="L14444" data-line-number="14444"></td>
        <td id="LC14444">
</td>
      </tr>
      <tr>
        <td id="L14445" data-line-number="14445"></td>
        <td id="LC14445">#<span>if</span> defined(_DEBUG) &amp;&amp; defined(HAVE_GCCOVER)</td>
      </tr>
      <tr>
        <td id="L14446" data-line-number="14446"></td>
        <td id="LC14446">
</td>
      </tr>
      <tr>
        <td id="L14447" data-line-number="14447"></td>
        <td id="LC14447">LPVOID                <span>EECodeInfo::findNextFunclet</span> (LPVOID pvFuncletStart, SIZE_T cbCode, LPVOID *ppvFuncletEnd)</td>
      </tr>
      <tr>
        <td id="L14448" data-line-number="14448"></td>
        <td id="LC14448">{</td>
      </tr>
      <tr>
        <td id="L14449" data-line-number="14449"></td>
        <td id="LC14449">    CONTRACTL {</td>
      </tr>
      <tr>
        <td id="L14450" data-line-number="14450"></td>
        <td id="LC14450">        NOTHROW;</td>
      </tr>
      <tr>
        <td id="L14451" data-line-number="14451"></td>
        <td id="LC14451">        GC_NOTRIGGER;</td>
      </tr>
      <tr>
        <td id="L14452" data-line-number="14452"></td>
        <td id="LC14452">    } CONTRACTL_END;</td>
      </tr>
      <tr>
        <td id="L14453" data-line-number="14453"></td>
        <td id="LC14453">
</td>
      </tr>
      <tr>
        <td id="L14454" data-line-number="14454"></td>
        <td id="LC14454">    <span>while</span> (cbCode &gt; <span>0</span>)</td>
      </tr>
      <tr>
        <td id="L14455" data-line-number="14455"></td>
        <td id="LC14455">    {</td>
      </tr>
      <tr>
        <td id="L14456" data-line-number="14456"></td>
        <td id="LC14456">        PT_RUNTIME_FUNCTION   pFunctionEntry;</td>
      </tr>
      <tr>
        <td id="L14457" data-line-number="14457"></td>
        <td id="LC14457">        ULONGLONG           uImageBase;</td>
      </tr>
      <tr>
        <td id="L14458" data-line-number="14458"></td>
        <td id="LC14458">#<span>ifdef</span> TARGET_UNIX</td>
      </tr>
      <tr>
        <td id="L14459" data-line-number="14459"></td>
        <td id="LC14459">        EECodeInfo codeInfo;</td>
      </tr>
      <tr>
        <td id="L14460" data-line-number="14460"></td>
        <td id="LC14460">        codeInfo.<span>Init</span>((PCODE)pvFuncletStart);</td>
      </tr>
      <tr>
        <td id="L14461" data-line-number="14461"></td>
        <td id="LC14461">        pFunctionEntry = codeInfo.<span>GetFunctionEntry</span>();</td>
      </tr>
      <tr>
        <td id="L14462" data-line-number="14462"></td>
        <td id="LC14462">        uImageBase = (ULONGLONG)codeInfo.<span>GetModuleBase</span>();</td>
      </tr>
      <tr>
        <td id="L14463" data-line-number="14463"></td>
        <td id="LC14463">#<span>else</span> <span><span>//</span> !TARGET_UNIX</span></td>
      </tr>
      <tr>
        <td id="L14464" data-line-number="14464"></td>
        <td id="LC14464">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14465" data-line-number="14465"></td>
        <td id="LC14465">        <span><span>//</span> This is GCStress debug only - use the slow OS APIs to enumerate funclets</span></td>
      </tr>
      <tr>
        <td id="L14466" data-line-number="14466"></td>
        <td id="LC14466">        <span><span>//</span></span></td>
      </tr>
      <tr>
        <td id="L14467" data-line-number="14467"></td>
        <td id="LC14467">
</td>
      </tr>
      <tr>
        <td id="L14468" data-line-number="14468"></td>
        <td id="LC14468">        pFunctionEntry = (PT_RUNTIME_FUNCTION) <span>RtlLookupFunctionEntry</span>((ULONGLONG)pvFuncletStart,</td>
      </tr>
      <tr>
        <td id="L14469" data-line-number="14469"></td>
        <td id="LC14469">                              &amp;uImageBase</td>
      </tr>
      <tr>
        <td id="L14470" data-line-number="14470"></td>
        <td id="LC14470">                              <span>AMD64_ARG</span>(<span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L14471" data-line-number="14471"></td>
        <td id="LC14471">                              );</td>
      </tr>
      <tr>
        <td id="L14472" data-line-number="14472"></td>
        <td id="LC14472">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L14473" data-line-number="14473"></td>
        <td id="LC14473">
</td>
      </tr>
      <tr>
        <td id="L14474" data-line-number="14474"></td>
        <td id="LC14474">        <span>if</span> (pFunctionEntry != <span>NULL</span>)</td>
      </tr>
      <tr>
        <td id="L14475" data-line-number="14475"></td>
        <td id="LC14475">        {</td>
      </tr>
      <tr>
        <td id="L14476" data-line-number="14476"></td>
        <td id="LC14476">#<span>ifdef</span> FEATURE_PREJIT</td>
      </tr>
      <tr>
        <td id="L14477" data-line-number="14477"></td>
        <td id="LC14477">            <span><span>//</span> workaround: Check for indirect entry that is generated for cold part of main method body.</span></td>
      </tr>
      <tr>
        <td id="L14478" data-line-number="14478"></td>
        <td id="LC14478">            <span>if</span> ((TADDR)pvFuncletStart &lt; (TADDR)uImageBase + pFunctionEntry-&gt;<span>BeginAddress</span> ||</td>
      </tr>
      <tr>
        <td id="L14479" data-line-number="14479"></td>
        <td id="LC14479">                (TADDR)uImageBase + pFunctionEntry-&gt;<span>EndAddress</span> &lt;= (TADDR)pvFuncletStart)</td>
      </tr>
      <tr>
        <td id="L14480" data-line-number="14480"></td>
        <td id="LC14480">            {</td>
      </tr>
      <tr>
        <td id="L14481" data-line-number="14481"></td>
        <td id="LC14481">                Module * pZapModule = <span>ExecutionManager::FindZapModule</span>((TADDR)pvFuncletStart);</td>
      </tr>
      <tr>
        <td id="L14482" data-line-number="14482"></td>
        <td id="LC14482">                NGenLayoutInfo * pLayoutInfo = pZapModule-&gt;<span>GetNGenLayoutInfo</span>();</td>
      </tr>
      <tr>
        <td id="L14483" data-line-number="14483"></td>
        <td id="LC14483">
</td>
      </tr>
      <tr>
        <td id="L14484" data-line-number="14484"></td>
        <td id="LC14484">                <span>int</span> ColdFunctionIndex = <span>NativeUnwindInfoLookupTable::LookupUnwindInfoForMethod</span>((DWORD)((TADDR)pvFuncletStart - uImageBase),</td>
      </tr>
      <tr>
        <td id="L14485" data-line-number="14485"></td>
        <td id="LC14485">                                                                               pLayoutInfo-&gt;<span>m_pRuntimeFunctions</span>[<span>2</span>],</td>
      </tr>
      <tr>
        <td id="L14486" data-line-number="14486"></td>
        <td id="LC14486">                                                                               <span>0</span>, pLayoutInfo-&gt;<span>m_nRuntimeFunctions</span>[<span>2</span>] - <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L14487" data-line-number="14487"></td>
        <td id="LC14487">
</td>
      </tr>
      <tr>
        <td id="L14488" data-line-number="14488"></td>
        <td id="LC14488">                pFunctionEntry = pLayoutInfo-&gt;<span>m_pRuntimeFunctions</span>[<span>2</span>] + ColdFunctionIndex;</td>
      </tr>
      <tr>
        <td id="L14489" data-line-number="14489"></td>
        <td id="LC14489">            }</td>
      </tr>
      <tr>
        <td id="L14490" data-line-number="14490"></td>
        <td id="LC14490">#<span>endif</span></td>
      </tr>
      <tr>
        <td id="L14491" data-line-number="14491"></td>
        <td id="LC14491">
</td>
      </tr>
      <tr>
        <td id="L14492" data-line-number="14492"></td>
        <td id="LC14492">            <span>_ASSERTE</span>((TADDR)pvFuncletStart == (TADDR)uImageBase + pFunctionEntry-&gt;<span>BeginAddress</span>);</td>
      </tr>
      <tr>
        <td id="L14493" data-line-number="14493"></td>
        <td id="LC14493">            <span>_ASSERTE</span>((TADDR)uImageBase + pFunctionEntry-&gt;<span>EndAddress</span> &lt;= (TADDR)pvFuncletStart + cbCode);</td>
      </tr>
      <tr>
        <td id="L14494" data-line-number="14494"></td>
        <td id="LC14494">            *ppvFuncletEnd = (LPVOID)(uImageBase + pFunctionEntry-&gt;<span>EndAddress</span>);</td>
      </tr>
      <tr>
        <td id="L14495" data-line-number="14495"></td>
        <td id="LC14495">            <span>return</span> (LPVOID)(uImageBase + pFunctionEntry-&gt;<span>BeginAddress</span>);</td>
      </tr>
      <tr>
        <td id="L14496" data-line-number="14496"></td>
        <td id="LC14496">        }</td>
      </tr>
      <tr>
        <td id="L14497" data-line-number="14497"></td>
        <td id="LC14497">
</td>
      </tr>
      <tr>
        <td id="L14498" data-line-number="14498"></td>
        <td id="LC14498">        pvFuncletStart = (LPVOID)((TADDR)pvFuncletStart + <span>1</span>);</td>
      </tr>
      <tr>
        <td id="L14499" data-line-number="14499"></td>
        <td id="LC14499">        cbCode--;</td>
      </tr>
      <tr>
        <td id="L14500" data-line-number="14500"></td>
        <td id="LC14500">    }</td>
      </tr>
      <tr>
        <td id="L14501" data-line-number="14501"></td>
        <td id="LC14501">
</td>
      </tr>
      <tr>
        <td id="L14502" data-line-number="14502"></td>
        <td id="LC14502">    <span>return</span> <span>NULL</span>;</td>
      </tr>
      <tr>
        <td id="L14503" data-line-number="14503"></td>
        <td id="LC14503">}</td>
      </tr>
      <tr>
        <td id="L14504" data-line-number="14504"></td>
        <td id="LC14504">#<span>endif</span> <span><span>//</span> defined(_DEBUG) &amp;&amp; !defined(HAVE_GCCOVER)</span></td>
      </tr>
      <tr>
        <td id="L14505" data-line-number="14505"></td>
        <td id="LC14505">#<span>endif</span> <span><span>//</span> defined(TARGET_AMD64)</span></td>
      </tr>
</tbody></table>

  

  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs" /></noscript>
</body>
</html>