<!DOCTYPE html>
<html lang="en">
<head>
    <title>
BlazorHelp Website &gt; Blog - Implementing Roles In Blazor WebAssembly - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="BlazorHelp Website &gt; Blog - Implementing Roles In Blazor WebAssembly - linksfor.dev(s)"/>
    <meta property="article:author" content="Written by:&#xA;   Michael Washington"/>
    <meta property="og:description" content="Microsoft Visual Studio Blazor"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="http://blazorhelpwebsite.com/Blog/tabid/61/EntryId/4376/Implementing-Roles-In-Blazor-WebAssembly.aspx"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - BlazorHelp Website &gt; Blog - Implementing Roles In Blazor WebAssembly</title>
<div class="readable">
        <h1>BlazorHelp Website &gt; Blog - Implementing Roles In Blazor WebAssembly</h1>
            <div>by Written by:&#xA;   Michael Washington</div>
            <div>Reading time: 11-14 minutes</div>
        <div>Posted here: 16 May 2020</div>
        <p><a href="http://blazorhelpwebsite.com/Blog/tabid/61/EntryId/4376/Implementing-Roles-In-Blazor-WebAssembly.aspx">http://blazorhelpwebsite.com/Blog/tabid/61/EntryId/4376/Implementing-Roles-In-Blazor-WebAssembly.aspx</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
 <!-- Begin Blog Entry Title -->
 
 <!-- End Blog Entry Title -->
 <!-- Begin Blog Sub Head -->
 <acronym title="5/16/2020 11:22 AM"><span>
  <span id="dnn_ctr382_MainView_ViewEntry_lblEntryMonth">May</span>
 </span><span>
  <span id="dnn_ctr382_MainView_ViewEntry_lblEntryDay">16</span>
 </span></acronym>
 <p>
  
  <br>
  <span id="dnn_ctr382_MainView_ViewEntry_lblDateTime">5/16/2020 11:22 AM</span>&nbsp;
  <a id="dnn_ctr382_MainView_ViewEntry_lnkRss" href="http://blazorhelpwebsite.com/Blog/tabid/61/rssid/1/Default.aspx" target="_blank"><img id="dnn_ctr382_MainView_ViewEntry_lnkRssIcon" src="http://blazorhelpwebsite.com/desktopmodules/Blog/Images/feed-icon-12x12.gif" alt="RssIcon"></a>
 </p>
 <!-- End Blog Sub Head -->
 
 <!-- Begin Blog Entry -->
 
   <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_a43c04f6-bfbf-4fb7-9e70-a57ae77e634e.png" width="496" height="322"></p>  <p>You can implement roles in a <strong>Blazor WebAssembly</strong> application.</p>      <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_39813311-9e41-451f-a130-dc76040f722e.png" width="538" height="297"></p>  <p>Blazor has two modes, <a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/?view=aspnetcore-3.1#blazor-server">Blazor Server</a> and <a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/?view=aspnetcore-3.1#blazor-webassembly">Blazor WebAssembly</a>.</p>  <p>For this tutorial, install the latest <strong>Blazor WebAssembly</strong> version. <a href="https://devblogs.microsoft.com/aspnet/blazor-webassembly-3-2-0-release-candidate-now-available/">As of 5/16/2020 the directions are at this link</a>, however, always check <a href="https://blazor.net/">https://blazor.net/</a> for information on the latest release.</p>      <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_02af7a4a-937c-4394-8f59-8137a93e3cac.png" width="86" height="96"></p>  <p>Open <strong>Visual Studio</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_f4dec232-38e0-4c7a-a5e6-4f43c5350aac.png" width="338" height="82"></p>  <p>Create a <strong>New Project</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_4852d92e-a157-4198-8035-5fdc39a52e99.png" width="496" height="105"></p>  <p>Create a <strong>Blazor App</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_eb50971b-a04a-4ec9-aaeb-bd3da26962f8.png" width="448" height="294"></p>  <p>Give the project the name <strong>RoleEnabledWebAssembly</strong> and click <strong>Create</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_c7b075c3-3e1a-4546-9be2-5b40d4804fad.png" width="672" height="431"></p>  <p>Select the <strong>Blazor WebAssembly</strong> template, select <strong>ASP.NET Core hosted</strong> and click the <em>change</em> link under <strong>Authentication</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_33bfefbe-b53f-477b-a849-aa3280e079b4.png" width="574" height="222"></p>  <p>Select <strong>Individual User Accounts</strong> and click <strong>OK</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_b7785609-fef3-4e5b-9391-71ded98fe9d9.png" width="322" height="466"></p>  <p>Click <strong>Create</strong>.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_34c7402b-5f8a-4042-a575-0690973d9964.png" width="468" height="121"></p>  <p>The application will be created.</p>    <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_53a171c5-3e01-495a-9142-b61990748714.png" width="344" height="587"></p>  <p>The application will display in <strong>Visual Studio</strong>.</p>      <p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_2fbbe483-26a6-44ce-a7f9-ac6a9125e4b2.png" width="254" height="225"></p>  <p>Open the <strong>Startup.cs</strong> file in the <strong>Server</strong> project.</p>  <p>Change this code:</p>    <pre><pre><strike>            services.AddDefaultIdentity&lt;ApplicationUser&gt;(options =&gt; 
</strike></pre><pre><strike>            options.SignIn.RequireConfirmedAccount = <span>true</span>)
</strike></pre><pre><strike>                .AddEntityFrameworkStores&lt;ApplicationDbContext&gt;();</strike></pre></pre>



<pre><pre><strike>            services.AddIdentityServer()
</strike></pre><pre><strike>                .AddApiAuthorization&lt;ApplicationUser, ApplicationDbContext&gt;();</strike></pre></pre>



<p>To this:</p>



<pre><pre>            services.AddDefaultIdentity&lt;ApplicationUser&gt;()
</pre><pre>                .AddRoles&lt;IdentityRole&gt;()
</pre><pre>                .AddEntityFrameworkStores&lt;ApplicationDbContext&gt;();</pre></pre>



<pre><pre>            <span>// Configure identity server to put the role claim into the id token </span>
</pre><pre>            <span>// and the access token and prevent the default mapping for roles </span>
</pre><pre>            <span>// in the JwtSecurityTokenHandler.</span>
</pre><pre>            services.AddIdentityServer()
</pre><pre>                .AddApiAuthorization&lt;ApplicationUser, ApplicationDbContext&gt;(options =&gt; {
</pre><pre>                    options.IdentityResources["<span>openid</span>"].UserClaims.Add("<span>role</span>");
</pre><pre>                    options.ApiResources.Single().UserClaims.Add("<span>role</span>");
</pre><pre>                });</pre></pre>



<pre><pre>            <span>// Need to do this as it maps "role" to ClaimTypes.Role and causes issues</span>
</pre><pre>            System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler
</pre><pre>                .DefaultInboundClaimTypeMap.Remove("<span>role</span>");</pre></pre>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_9ba4a4f2-34d4-4137-a2a0-bffe3f98df08.png" width="303" height="227"></p>

<p>Blazor dynamically creates a Register page, but, we need to override it so that we can add code that will:</p>



<ol>
  <li>Create an <em>Administrators</em> role (if one does not already exist) </li>

  <li>Automatically add any user named <a href="mailto:Admin@Email">Admin@Email</a> to the <em>Administrators</em> role </li>
</ol>



<p>Add an <strong>Account</strong> folder to the <strong>Areas/Identity/Pages</strong> folder.</p>

<p>Add the following files:</p>



<h2>_ViewImports.cshtml</h2>



<pre><pre>@<span>using</span> Microsoft.AspNetCore.Identity
</pre><pre>@<span>using</span> RoleEnabledWebAssembly.Server.Areas.Identity
</pre><pre>@<span>using</span> RoleEnabledWebAssembly.Server.Areas.Identity.Pages
</pre><pre>@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers</pre></pre>



<h2>Register.cshtml</h2>



<pre><pre>@page
</pre><pre>@model RegisterModel
</pre><pre>@{
</pre><pre>    ViewData["Title"] = "Register";
</pre><pre>}
</pre><pre></pre><pre><span>&lt;</span><span>h1</span><span>&gt;</span>@ViewData["Title"]<span>&lt;/</span><span>h1</span><span>&gt;</span>
</pre><pre></pre><pre><span>&lt;</span><span>div</span> <span>class</span>=<span>"row"</span><span>&gt;</span>
</pre><pre>    <span>&lt;</span><span>div</span> <span>class</span>=<span>"col-md-4"</span><span>&gt;</span>
</pre><pre>        <span>&lt;</span><span>form</span> <span>asp</span>-<span>route</span>-<span>returnUrl</span>=<span>"@Model.ReturnUrl"</span> <span>method</span>=<span>"post"</span><span>&gt;</span>
</pre><pre>            <span>&lt;</span><span>h4</span><span>&gt;</span>Create a new account.<span>&lt;/</span><span>h4</span><span>&gt;</span>
</pre><pre>            <span>&lt;</span><span>hr</span> <span>/&gt;</span>
</pre><pre>            <span>&lt;</span><span>div</span> <span>asp</span>-<span>validation</span>-<span>summary</span>=<span>"All"</span> <span>class</span>=<span>"text-danger"</span><span>&gt;</span><span>&lt;/</span><span>div</span><span>&gt;</span>
</pre><pre>            <span>&lt;</span><span>div</span> <span>class</span>=<span>"form-group"</span><span>&gt;</span>
</pre><pre>                <span>&lt;</span><span>label</span> <span>asp</span>-<span>for</span>=<span>"Input.Email"</span><span>&gt;</span><span>&lt;/</span><span>label</span><span>&gt;</span>
</pre><pre>                <span>&lt;</span><span>input</span> <span>asp</span>-<span>for</span>=<span>"Input.Email"</span> <span>class</span>=<span>"form-control"</span> <span>/&gt;</span>
</pre><pre>                <span>&lt;</span><span>span</span> <span>asp</span>-<span>validation</span>-<span>for</span>=<span>"Input.Email"</span> <span>class</span>=<span>"text-danger"</span><span>&gt;</span><span>&lt;/</span><span>span</span><span>&gt;</span>
</pre><pre>            <span>&lt;/</span><span>div</span><span>&gt;</span>
</pre><pre>            <span>&lt;</span><span>div</span> <span>class</span>=<span>"form-group"</span><span>&gt;</span>
</pre><pre>                <span>&lt;</span><span>label</span> <span>asp</span>-<span>for</span>=<span>"Input.Password"</span><span>&gt;</span><span>&lt;/</span><span>label</span><span>&gt;</span>
</pre><pre>                <span>&lt;</span><span>input</span> <span>asp</span>-<span>for</span>=<span>"Input.Password"</span> <span>class</span>=<span>"form-control"</span> <span>/&gt;</span>
</pre><pre>                <span>&lt;</span><span>span</span> <span>asp</span>-<span>validation</span>-<span>for</span>=<span>"Input.Password"</span> <span>class</span>=<span>"text-danger"</span><span>&gt;</span><span>&lt;/</span><span>span</span><span>&gt;</span>
</pre><pre>            <span>&lt;/</span><span>div</span><span>&gt;</span>
</pre><pre>            <span>&lt;</span><span>div</span> <span>class</span>=<span>"form-group"</span><span>&gt;</span>
</pre><pre>                <span>&lt;</span><span>label</span> <span>asp</span>-<span>for</span>=<span>"Input.ConfirmPassword"</span><span>&gt;</span><span>&lt;/</span><span>label</span><span>&gt;</span>
</pre><pre>                <span>&lt;</span><span>input</span> <span>asp</span>-<span>for</span>=<span>"Input.ConfirmPassword"</span> <span>class</span>=<span>"form-control"</span> <span>/&gt;</span>
</pre><pre>                <span>&lt;</span><span>span</span> <span>asp</span>-<span>validation</span>-<span>for</span>=<span>"Input.ConfirmPassword"</span> <span>class</span>=<span>"text-danger"</span><span>&gt;</span><span>&lt;/</span><span>span</span><span>&gt;</span>
</pre><pre>            <span>&lt;/</span><span>div</span><span>&gt;</span>
</pre><pre>            <span>&lt;</span><span>button</span> <span>type</span>=<span>"submit"</span> <span>class</span>=<span>"btn btn-primary"</span><span>&gt;</span>Register<span>&lt;/</span><span>button</span><span>&gt;</span>
</pre><pre>        <span>&lt;/</span><span>form</span><span>&gt;</span>
</pre><pre>    <span>&lt;/</span><span>div</span><span>&gt;</span>
</pre><pre>    <span>&lt;</span><span>div</span> <span>class</span>=<span>"col-md-6 col-md-offset-2"</span><span>&gt;</span>
</pre><pre>                                           
</pre><pre>    <span>&lt;/</span><span>div</span><span>&gt;</span>
</pre><pre><span>&lt;/</span><span>div</span><span>&gt;</span>
</pre><pre></pre><pre>@section Scripts {
</pre><pre>    <span>&lt;</span><span>partial</span> <span>name</span>=<span>"_ValidationScriptsPartial"</span> <span>/&gt;</span>
</pre><pre>}</pre></pre>



<h2>Register.cshtml.cs</h2>



<pre><pre><span>using</span> System;
</pre><pre><span>using</span> System.Collections.Generic;
</pre><pre><span>using</span> System.ComponentModel.DataAnnotations;
</pre><pre><span>using</span> System.Linq;
</pre><pre><span>using</span> System.Text;
</pre><pre><span>using</span> System.Text.Encodings.Web;
</pre><pre><span>using</span> System.Threading.Tasks;
</pre><pre><span>using</span> Microsoft.AspNetCore.Authentication;
</pre><pre><span>using</span> Microsoft.AspNetCore.Authorization;
</pre><pre><span>using</span> Microsoft.AspNetCore.Identity;
</pre><pre><span>using</span> Microsoft.AspNetCore.Identity.UI.Services;
</pre><pre><span>using</span> Microsoft.AspNetCore.Mvc;
</pre><pre><span>using</span> Microsoft.AspNetCore.Mvc.RazorPages;
</pre><pre></pre><pre><span>using</span> RoleEnabledWebAssembly.Server.Models;
</pre><pre></pre><pre><span>namespace</span> RoleEnabledWebAssembly.Server.Areas.Identity.Pages
</pre><pre>{
</pre><pre>    [AllowAnonymous]
</pre><pre>    <span>public</span> <span>class</span> RegisterModel : PageModel
</pre><pre>    {
</pre><pre>        <span>// *************************************************</span>
</pre><pre>        <span>// This is the user that will be automatically </span>
</pre><pre>        <span>// made an Administrator</span>
</pre><pre>        <span>// *************************************************</span>
</pre><pre>        <span>const</span> <span>string</span> ADMINISTRATOR_USERNAME = "<span>Admin@email</span>";
</pre><pre></pre><pre>        <span>const</span> <span>string</span> ADMINISTRATION_ROLE = "<span>Administrators</span>";
</pre><pre></pre><pre>        <span>private</span> <span>readonly</span> SignInManager&lt;ApplicationUser&gt; _signInManager;
</pre><pre>        <span>private</span> <span>readonly</span> UserManager&lt;ApplicationUser&gt; _userManager;
</pre><pre>        <span>private</span> <span>readonly</span> RoleManager&lt;IdentityRole&gt; _roleManager;
</pre><pre></pre><pre>        <span>public</span> RegisterModel(
</pre><pre>            SignInManager&lt;ApplicationUser&gt; signInManager,
</pre><pre>            UserManager&lt;ApplicationUser&gt; userManager,
</pre><pre>            RoleManager&lt;IdentityRole&gt; roleManager)
</pre><pre>        {
</pre><pre>            _userManager = userManager;
</pre><pre>            _signInManager = signInManager;
</pre><pre>            _roleManager = roleManager;
</pre><pre>        }
</pre><pre></pre><pre>        [BindProperty]
</pre><pre>        <span>public</span> InputModel Input { <span>get</span>; <span>set</span>; }
</pre><pre></pre><pre>        <span>public</span> <span>string</span> ReturnUrl { <span>get</span>; <span>set</span>; }
</pre><pre></pre><pre>        <span>public</span> IList&lt;AuthenticationScheme&gt; ExternalLogins { <span>get</span>; <span>set</span>; }
</pre><pre></pre><pre>        <span>public</span> <span>class</span> InputModel
</pre><pre>        {
</pre><pre>            [Required]
</pre><pre>            [EmailAddress]
</pre><pre>            [Display(Name = "<span>Email</span>")]
</pre><pre>            <span>public</span> <span>string</span> Email { <span>get</span>; <span>set</span>; }
</pre><pre></pre><pre>            [Required]
</pre><pre>            [StringLength(100, ErrorMessage = 
</pre><pre>                "<span>The {0} must be at least {2} and at max {1} characters long.</span>", 
</pre><pre>                MinimumLength = 6)]
</pre><pre>            [DataType(DataType.Password)]
</pre><pre>            [Display(Name = "<span>Password</span>")]
</pre><pre>            <span>public</span> <span>string</span> Password { <span>get</span>; <span>set</span>; }
</pre><pre></pre><pre>            [DataType(DataType.Password)]
</pre><pre>            [Display(Name = "<span>Confirm password</span>")]
</pre><pre>            [Compare("<span>Password</span>", ErrorMessage = 
</pre><pre>                "<span>The password and confirmation password do not match.</span>")]
</pre><pre>            <span>public</span> <span>string</span> ConfirmPassword { <span>get</span>; <span>set</span>; }
</pre><pre>        }
</pre><pre></pre><pre>        <span>public</span> async Task OnGetAsync(<span>string</span> returnUrl = <span>null</span>)
</pre><pre>        {
</pre><pre>            ReturnUrl = returnUrl;
</pre><pre>            ExternalLogins = 
</pre><pre>                (await _signInManager.GetExternalAuthenticationSchemesAsync())
</pre><pre>                .ToList();
</pre><pre>        }
</pre><pre></pre><pre>        <span>public</span> async Task&lt;IActionResult&gt; OnPostAsync(<span>string</span> returnUrl = <span>null</span>)
</pre><pre>        {
</pre><pre>            returnUrl = returnUrl ?? Url.Content("<span>~/</span>");
</pre><pre>            ExternalLogins = 
</pre><pre>                (await _signInManager.GetExternalAuthenticationSchemesAsync())
</pre><pre>                .ToList();
</pre><pre></pre><pre>            <span>if</span> (ModelState.IsValid)
</pre><pre>            {
</pre><pre>                var user = 
</pre><pre>                    <span>new</span> ApplicationUser { 
</pre><pre>                        UserName = Input.Email, 
</pre><pre>                        Email = Input.Email };
</pre><pre></pre><pre>                var result = 
</pre><pre>                    await _userManager.CreateAsync(user, Input.Password);
</pre><pre></pre><pre>                <span>if</span> (result.Succeeded)
</pre><pre>                {
</pre><pre>                    <span>// Set confirm Email for user</span>
</pre><pre>                    user.EmailConfirmed = <span>true</span>;
</pre><pre>                    await _userManager.UpdateAsync(user);
</pre><pre></pre><pre>                    <span>// ensure there is a ADMINISTRATION_ROLE</span>
</pre><pre>                    var RoleResult = 
</pre><pre>                        await _roleManager.FindByNameAsync(ADMINISTRATION_ROLE);
</pre><pre></pre><pre>                    <span>if</span> (RoleResult == <span>null</span>)
</pre><pre>                    {
</pre><pre>                        <span>// Create ADMINISTRATION_ROLE Role</span>
</pre><pre>                        await _roleManager.CreateAsync(
</pre><pre>                            <span>new</span> IdentityRole(ADMINISTRATION_ROLE));
</pre><pre>                    }
</pre><pre></pre><pre>                    <span>if</span> (user.UserName.ToLower() == ADMINISTRATOR_USERNAME.ToLower())
</pre><pre>                    {
</pre><pre>                        <span>// Put admin in Administrator role</span>
</pre><pre>                        await _userManager.AddToRoleAsync(user, ADMINISTRATION_ROLE);
</pre><pre>                    }
</pre><pre></pre><pre>                    <span>// Log user in</span>
</pre><pre>                    await _signInManager.SignInAsync(user, isPersistent: <span>false</span>);
</pre><pre>                    <span>return</span> LocalRedirect(returnUrl);
</pre><pre>                }
</pre><pre>                <span>foreach</span> (var error <span>in</span> result.Errors)
</pre><pre>                {
</pre><pre>                    ModelState.AddModelError(<span>string</span>.Empty, error.Description);
</pre><pre>                }
</pre><pre>            }
</pre><pre></pre><pre>            <span>// If we got this far, something failed, redisplay form</span>
</pre><pre>            <span>return</span> Page();
</pre><pre>        }
</pre><pre>    }
</pre><pre>}</pre></pre>





<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_4bacf048-9f03-4377-8e85-63aa0587a669.png" width="266" height="162"></p>

<p>Open <strong>WeatherForecastController.cs</strong> and add:</p>



<pre><pre>[Authorize(Roles = "<span>Administrators</span>")]</pre></pre>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_27988603-dc6c-4471-9fcd-60718b2a9da7.png" width="495" height="165"></p>

<p>This will only allow users in the <strong>Administrators</strong> role to call this controller method.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_d99cfcff-5e3c-4ed6-bdb3-f2080c2adaef.png" width="314" height="355"></p>

<p>Open the <strong>Index.razor</strong> page and change all the code to:</p>



<pre><pre>@page "/"
</pre><pre>@using Microsoft.AspNetCore.Components.Authorization;
</pre><pre></pre><pre></pre><pre><span>&lt;</span><span>AuthorizeView</span> <span>Roles</span>=<span>"@ADMINISTRATION_ROLE"</span><span>&gt;</span>
</pre><pre>    <span>&lt;</span><span>p</span><span>&gt;</span>You are an Administrator<span>&lt;/</span><span>p</span><span>&gt;</span>
</pre><pre><span>&lt;/</span><span>AuthorizeView</span><span>&gt;</span>
</pre><pre></pre></pre>

<pre><pre><span>@code</span> {
</pre><pre>    [CascadingParameter]
</pre><pre>    <span>private</span> Task&lt;AuthenticationState&gt; authenticationStateTask { <span>get</span>; <span>set</span>; }
</pre><pre></pre><pre>    <span>string</span> ADMINISTRATION_ROLE = "<span>Administrators</span>";
</pre><pre>}</pre></pre>



<p>This will display “<em>You are an Administrator</em>” only if the logged in user is in the <em>Administrators</em> role.</p>





<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_20b34e72-8841-48b3-9996-802756a4b7b2.png" width="411" height="99"></p>

<p>Hit <strong>F5 </strong>to run the application.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_82a1dbc6-2e86-4505-8a45-ea81d1c197e7.png" width="609" height="200"></p>

<p>Click the button to <strong>Register</strong> a new user.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_1eb6fa10-aa45-4c95-940e-4ea8819b975c.png" width="316" height="458"></p>

<p>Create a user named <a href="mailto:Admin@Email"><strong>Admin@Email</strong></a>.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_d8960817-948a-45cb-95ca-97f7bc1c1076.png" width="507" height="287"></p>

<p>If this is the first time you have created a user it will run <a href="https://docs.microsoft.com/en-us/ef/core/managing-schemas/migrations/?tabs=dotnet-core-cli">migrations</a>.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_74ec8edb-2177-4231-8f8a-c34a0d46b697.png" width="384" height="329"></p>

<p>Complete the migrations by <em>reloading</em> the web browser.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_d37d5b07-89d3-4b60-9bad-8a0b87b99bba.png" width="541" height="209"></p>

<p>You should be <em>logged in</em> (if not, click the <strong>Login</strong> link and log in as <a href="mailto:Admin@Email"><strong>Admin@Email</strong></a>).</p>

<p>The code on the <strong>Index.razor</strong> page will detect that the user is an <strong>Administrator</strong> and indicate that.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_d0c4fc7a-3f38-447c-ab6f-3c4b9a6e367d.png" width="729" height="377"></p>

<p>When we go to the <strong>Fetch data</strong> page, that calls the <strong>WeatherForecastController.cs </strong>controller, it will work. </p>

<p>If you go to that page without logging in, or as another user who is not an <strong>Administrator</strong>, it will throw an error.</p>



<p><img title="image" alt="image" src="http://blazorhelpwebsite.com/Portals/0/Blog/Files/1/4376/Windows-Live-Writer-Implementing-Roles-In-Blazor-WebAssembly_4AF6-image_b7d901f5-088d-4fd0-bb7a-51429d12029d.png" width="700" height="359"></p>

<p>If we go to the <a href="https://docs.microsoft.com/en-us/microsoft-edge/devtools-guide">F12 Dev tools</a> in our web browser and look at the <strong>userinfo</strong> call in the <strong>Network</strong> tab, we see the user is in the <em>Administrators</em> role.</p>





<p><a href="https://github.com/dotnet/AspNetCore.Docs/issues/17649">[Blazor][Wasm] Using roles with ApiAuthorization + Blazor</a></p>

<p><a href="http://blazorhelpwebsite.com/Blog/tabid/61/EntryId/4370/Client-Side-Blazor-Authentication-Using-Azure-AD-and-a-Custom-AuthenticationStateProvider.aspx">Client Side Blazor Authentication Using Azure AD and a Custom AuthenticationStateProvider</a></p>

<p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/blazor/webassembly/standalone-with-authentication-library?view=aspnetcore-3.1">Secure an ASP.NET Core Blazor WebAssembly standalone app with the Authentication library</a></p>

<p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/blazor/webassembly/azure-active-directory-groups-and-roles?view=aspnetcore-3.1">Azure AD Groups, Administrative Roles, and user-defined roles</a></p>

<p><a href="https://devblogs.microsoft.com/aspnet/blazor-webassembly-3-2-0-release-candidate-now-available/">Blazor WebAssembly 3.2.0 Release Candidate now available</a></p>
 
 <!-- End Blog Entry -->
 <!-- Blog Entry Footer Section -->
 
 
 
 <!-- Comments Section -->
 
 
 <div id="dnn_ctr382_MainView_ViewEntry_pnlAddComment">
		
  <table>
   <tbody><tr>
    <td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblAuthor">Your name:</span>
    </td>
    <td id="dnn_ctr382_MainView_ViewEntry_tdAuthor" colspan="1">
     
    </td>
		
    <td id="dnn_ctr382_MainView_ViewEntry_tdGravatarPreview" rowspan="2">
     <p><img id="dnn_ctr382_MainView_ViewEntry_imgGravatarPreview" src="http://www.gravatar.com/avatar/108eeb4a0bc2c8c85cad9dde10e1319e?s=48&amp;r=G&amp;d=http%3a%2f%2fwww.gravatar.com%2favatar%2fb6267c6fe44b457964aed2218e3ef8fe%3fsize%3d48" alt="Gravatar Preview">
     </p>
    </td>
		
   </tr>
   <tr id="dnn_ctr382_MainView_ViewEntry_trGravatarEmail">
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblEmail">Your email:</span>
    </td>
			<td>
     
    </td>
		</tr>
		
   <tr id="dnn_ctr382_MainView_ViewEntry_trUseGravatar">
			<td>
    </td>
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblEmailExplanation">(Optional) Email used only to show <a href="http://www.gravatar.com/" target="_new">Gravatar</a>.</span>
    </td>
			<td>
    </td>
		</tr>
		
   <tr id="dnn_ctr382_MainView_ViewEntry_trCommentWebsite">
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblWebsite">Your website:</span>
    </td>
			<td colspan="2">
     
    </td>
		</tr>
		
   <tr id="dnn_ctr382_MainView_ViewEntry_trCommentTitle">
			<td>
     <span id="dnn_ctr382_MainView_ViewEntry_lblCommentTitle">Title:</span>
    </td>
			<td colspan="2">
     
    </td>
		</tr>
		
   <tr>
    <td colspan="3">
     <span id="dnn_ctr382_MainView_ViewEntry_lblComment">Comment:</span>
    </td>
   </tr>
   <tr>
    <td colspan="3">
     
    </td>
   </tr>
   <tr id="dnn_ctr382_MainView_ViewEntry_rowCaptcha">
			<td colspan="3">
     <span id="dnn_ctr382_MainView_ViewEntry_lblCaptcha">Security Code</span>
     <div>
				<p><img src="http://blazorhelpwebsite.com/DesktopModules/Blog/ImageChallenge.captcha.aspx?captcha=4CEA8F2141FC0D294064CA8DBEBDFD3F11BDABCCC1DE2B696F96C1C8E1E2496E590FFC992E91AF4B42633A72547BD396685DB2EF29BD9913487F76E32BAB7918D3C65910540E18094FCE8EB70290F0CD57CE5609381BEF9F5ABA578B07E5A3B8E002C7AD66219A24B6F8F8779A42B2EF1F0C650D0AEB43705DEDDC90&amp;alias=blazorhelpwebsite.com" alt="CAPTCHA image"></p><p>
					Enter the code shown above in the box below
				</p></div>
    </td>
		</tr>
		
   <tr>
    <td colspan="3">
     Add Comment&nbsp;&nbsp;
     Cancel&nbsp;
     
    </td>
   </tr>
  </tbody></table>
  
 
	</div>
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>