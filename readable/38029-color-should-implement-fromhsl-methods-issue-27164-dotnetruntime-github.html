<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Color should implement FromHsl methods &#xB7; Issue #27164 &#xB7; dotnet/runtime &#xB7; GitHub -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Color should implement FromHsl methods · Issue #27164 · dotnet/runtime · GitHub</h1><div><div id="" class="d-block comment-body markdown-body  js-comment-body"><p><code>System.Drawing.Color</code> currently has <code>FromArgb</code>, <code>FromKnownColor</code>, and <code>FromName</code> but lacks a way to Create a new color with only a changed Hue, Saturation, or Lumosity.</p><h1>Rationale and Usage</h1><p>This is certainly a nice-to-have, but users have made some classes to try to bypass this limitation from <a href="https://richnewman.wordpress.com/about/code-listings-and-diagrams/hslcolor-class/" rel="nofollow">here</a>, <a href="https://stackoverflow.com/questions/2942/how-to-use-hsl-in-asp-net/2504318#2504318" rel="nofollow">here</a>, and possibly lots of other places I currently have not found yet. Most if not all of them containing really bad bugs and possible loss of color from the hsl values being wrong on the input. My implementation for this will ensure this will not happen as I tested it locally myself with satisfaction.</p><p>For example, without these changes, the above would be the only way to do this and can lead to many problems as people can find the wrong implementation design for something like this because it is very buggy. Because of this the Color class should learn this conversion so it would become the better and standard way of converting these values to a <code>Color</code>. Plus it does not require casting that can get people into trouble if not careful.</p><p>With these changes you'd no longer have to do that, just simply do stuff like this to recolor a whole image:</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">targethue</span><span class="pl-k">=</span><span class="pl-smi">System</span>.<span class="pl-smi">Drawing</span>.<span class="pl-smi">Color</span>.<span class="pl-smi">Purple</span>.<span class="pl-en">GetHue</span>();
<span class="pl-c"><span class="pl-c">//</span> original image is a bitmap but keep it unchanged for "undo all" reasons.</span><span class="pl-k">var</span><span class="pl-smi">image</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-k">System</span>.<span class="pl-k">Drawing</span>.<span class="pl-en">Bitmap</span>(<span class="pl-smi">origImage</span>.<span class="pl-smi">Width</span>, <span class="pl-smi">origImage</span>.<span class="pl-smi">Height</span>);
<span class="pl-k">for</span> (<span class="pl-k">var</span><span class="pl-smi">y</span><span class="pl-k">=</span><span class="pl-c1">0</span>; <span class="pl-smi">y</span><span class="pl-k">&lt;</span><span class="pl-smi">image</span>.<span class="pl-smi">Height</span>; <span class="pl-smi">y</span><span class="pl-k">++</span>)
{
    <span class="pl-k">for</span> (<span class="pl-k">var</span><span class="pl-smi">x</span><span class="pl-k">=</span><span class="pl-c1">0</span>; <span class="pl-smi">x</span><span class="pl-k">&lt;</span><span class="pl-smi">image</span>.<span class="pl-smi">Width</span>; <span class="pl-smi">x</span><span class="pl-k">++</span>)
    {
        <span class="pl-k">var</span><span class="pl-smi">pixelCol</span><span class="pl-k">=</span><span class="pl-smi">origImage</span>.<span class="pl-en">GetPixel</span>(<span class="pl-smi">x</span>, <span class="pl-smi">y</span>);
        <span class="pl-c"><span class="pl-c">//</span> keep the alpha component, just recolor everything on the hue.</span><span class="pl-smi">image</span>.<span class="pl-en">SetPixel</span>(<span class="pl-smi">x</span>, <span class="pl-smi">y</span>, <span class="pl-smi">System</span>.<span class="pl-smi">Drawing</span>.<span class="pl-smi">Color</span>.<span class="pl-en">FromHsl</span>(
            <span class="pl-smi">targethue</span>, <span class="pl-smi">pixelCol</span>.<span class="pl-en">GetSaturation</span>(), <span class="pl-smi">pixelCol</span>.<span class="pl-en">GetBrightness</span>(), <span class="pl-smi">pixelCol</span>.<span class="pl-smi">A</span>));
    }
}</pre></div><h1>Proposed API</h1><p><a class="commit-link" data-hovercard-type="commit" data-hovercard-url="https://github.com/AraHaan/corefx/commit/67a6c2c02b2317372c890a0ace8bb6718952f6e9/hovercard" href="https://github.com/AraHaan/corefx/commit/67a6c2c02b2317372c890a0ace8bb6718952f6e9">AraHaan/corefx@<tt>67a6c2c</tt></a><br><a class="commit-link" data-hovercard-type="commit" data-hovercard-url="https://github.com/AraHaan/corefx/commit/b09cc8436b0a1d6e44b6f9eccb7c5390f537bb4d/hovercard" href="https://github.com/AraHaan/corefx/commit/b09cc8436b0a1d6e44b6f9eccb7c5390f537bb4d">AraHaan/corefx@<tt>b09cc84</tt></a></p><p>changes (if above link stops working or changes):</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span><span class="pl-k">readonly</span><span class="pl-k">struct</span><span class="pl-en">Color</span> : <span class="pl-en">IEquatable</span>&lt;<span class="pl-en">Color</span>&gt;
{
        <span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> Creates a new &lt;<span class="pl-ent"><span class="pl-ent">see</span></span><span class="pl-e"><span class="pl-e">cref</span></span>=<span class="pl-s"><span class="pl-pds">"</span>Color<span class="pl-pds">"</span></span>/&gt; from the input HSL values.</span><span class="pl-c"><span class="pl-c">///</span> &lt;/<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span><span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>hue<span class="pl-pds">"</span></span>&gt;The hue to use for the new color.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span><span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>saturation<span class="pl-pds">"</span></span>&gt;The Saturation to use for the new color.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span><span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>lumosity<span class="pl-pds">"</span></span>&gt;The Lumosity to use for the new color.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">returns</span></span>&gt;A new &lt;<span class="pl-ent"><span class="pl-ent">see</span></span><span class="pl-e"><span class="pl-e">cref</span></span>=<span class="pl-s"><span class="pl-pds">"</span>Color<span class="pl-pds">"</span></span>/&gt; with the Color that the HSL values represent.&lt;/<span class="pl-ent"><span class="pl-ent">returns</span></span>&gt;</span><span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">Color</span><span class="pl-en">FromHsl</span>(<span class="pl-k">float</span><span class="pl-smi">hue</span>, <span class="pl-k">float</span><span class="pl-smi">saturation</span>, <span class="pl-k">float</span><span class="pl-smi">lumosity</span>);

        <span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> Creates a new &lt;<span class="pl-ent"><span class="pl-ent">see</span></span><span class="pl-e"><span class="pl-e">cref</span></span>=<span class="pl-s"><span class="pl-pds">"</span>Color<span class="pl-pds">"</span></span>/&gt; from the input HSL values.</span><span class="pl-c"><span class="pl-c">///</span> &lt;/<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span><span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>hue<span class="pl-pds">"</span></span>&gt;The hue to use for the new color.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span><span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>saturation<span class="pl-pds">"</span></span>&gt;The Saturation for the new color.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span><span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>lumosity<span class="pl-pds">"</span></span>&gt;The Lumosity of the new color.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span><span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>alpha<span class="pl-pds">"</span></span>&gt;The alpha  value of the new color between 0 and 255.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">returns</span></span>&gt;A new &lt;<span class="pl-ent"><span class="pl-ent">see</span></span><span class="pl-e"><span class="pl-e">cref</span></span>=<span class="pl-s"><span class="pl-pds">"</span>Color<span class="pl-pds">"</span></span>/&gt; with the Color that the HSL values represent.&lt;/<span class="pl-ent"><span class="pl-ent">returns</span></span>&gt;</span><span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">Color</span><span class="pl-en">FromHsl</span>(<span class="pl-k">float</span><span class="pl-smi">hue</span>, <span class="pl-k">float</span><span class="pl-smi">saturation</span>, <span class="pl-k">float</span><span class="pl-smi">lumosity</span>, <span class="pl-k">int</span><span class="pl-smi">alpha</span>);

}</pre></div><p>Edits:</p><ul><li>Fixed typo of <code>FromArgb</code>.</li><li>Fixed off by one issue in the code from issues in the function's math.</li><li>Remove use of <code>Vector3</code>.</li><li>Add link to commit that fixes the first one.</li><li>Safern: Remove implementation details, keep headers.</li></ul><p>cc: <a class="user-mention" data-hovercard-type="user" data-hovercard-url="/users/tannergooding/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/tannergooding">@tannergooding</a></p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>