<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Totally unsupported hacks - Add Windows Terminal to the Win&#x2B;X Shortcut menu -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Totally unsupported hacks - Add Windows Terminal to the Win+X Shortcut menu</h1><div><div id="" class="containerInner blogBody"><p>You shouldn't do this and if you choose to do this you may hurt yourself or one of your beloved pets.</p><p>You have been warned. </p><p>The Windows+X hotkey has been around for many years as is a simple right-click style context list of Developer/Administrator stuff that your techies might need in the course of human events.</p><p>There's one obscure setting in Settings | Taskbar where you can set the main option for the Command Prompt to be replaced with PowerShell, although that was flipped to "on" by default many years ago.</p><p><img title="Replace Command Prompt with PowerShell" alt="Replace Command Prompt with PowerShell" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/Totally-unsupported-hacks---Add-Windows-_FA2E/image_c6f0ca33-b08e-4866-ac12-52e9d7c6c42a.png" width="500" height="98"></p><p>I want Windows Terminal in that Win+X menu.</p><p>Fast Forward to a world with lots of <a href="https://www.hanselman.com/blog/ConEmuTheWindowsTerminalConsolePromptWeveBeenWaitingFor.aspx">alternative console hosts</a>, <a href="https://www.hanselman.com/blog/RubyOnRailsOnWindowsIsNotJustPossibleItsFabulousUsingWSL2AndVSCode.aspx">Linux running on Windows natively</a>, not to mention cross-platform open source PowerShell Core, AND the new open source <a href="https://www.hanselman.com/blog/YouCanNowDownloadTheNewOpenSourceWindowsTerminal.aspx">Windows Terminal</a> (that you can just <a href="https://www.microsoft.com/en-us/p/windows-terminal-preview/9n0dx20hk701?WT.mc_id=-blog-scottha#&amp;activetab=pivot%3Aoverviewtab">go download right now</a> in the Windows Store) we find ourselves in a middle place. We want to replace the default console with the <a href="https://github.com/microsoft/terminal/issues/492">Windows Terminal everywhere as the default</a> but that's gonna be a while.</p><p>Until then, we can integrate the Windows Terminal into our lives in a few obvious ways.</p><ul><li>Pin Windows Terminal to your taskbar  </li><li>Train yourself to Win+R and run "wt" rather than "cmd.exe" at wt.exe is a shim that launches the store-based Windows Terminal.  </li><li>Add Windows Terminal to the Win+X menu.</li></ul><p>It is that last one that concerns me today.</p><p>The Win+X implementation is a totally bonkers thing that I just don't understand with its origins lost to the mist of forgotten time.</p><p>You can go check out <code>C:\Users\USERNAME\AppData\Local\Microsoft\Windows\WinX</code> and find it full of LNK files. Just drop yours in there, right? Well, I say nay nay! </p><p>They didn't want just anyone dropping stuff in there so to add a new application to Windows+X you need to:</p><ul><li>Make or find a LNK file for your application.  <ul><li>BUT! Your lnk file can't (today?) be a LNK to a Windows Store app - more on that later. They appear to be ignored today.</li></ul></li><li>Store a special hash in <a href="https://withinrafael.com/2014/04/04/the-winx-menu-and-its-hashing-algorithm/">your LNK file per Rafael's excellent writeup here</a> so that they are considered "Approved Links."  </li><li>Make a new Group 4 folder in the \WinX folder above OR update Group 3 and copy your link in there considering the numbering scheme.  <ul><li>Note the ordering in the registry at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellCompatibility\InboxApp</li></ul></li></ul><p>OR</p><p>Here's my WinX\Group3 folder . Note the shortcut at the top there.</p><p><img title="image" alt="image" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/Totally-unsupported-hacks---Add-Windows-_FA2E/image_1f1188ce-352e-4f8a-a0af-ab8fde7ff88f.png" width="487" height="484"></p><p>I wanted to find a link to the Windows Terminal but it's harder than it looks. I can't find a real LNK file anywhere on my system. BUT I was able to find a synthetic one and make a copy by going "Win+R" and running "shell:AppsFolder" which brings you to a magic not-a-folder folder.</p><figure><img title="Not a folder folder" alt="Not a folder folder" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/Totally-unsupported-hacks---Add-Windows-_FA2E/image_79537241-88e3-41a4-a50c-2dc7d2098b2f.png" width="839" height="535"></figure><p>That is a folder of lies. I tried making a copy of this LNK, moving it to my deskop, hashing it with Rafael's util but it's ignored, presumably because it's a Windows Store LNK. Instead, I'll head out to cmd.exe and type "where wt.exe" to find the wt.exe shim and make a link to that!</p><pre>C:\Users\scott&gt;where wt.exe<br>C:\Users\scott\AppData\Local\Microsoft\WindowsApps\wt.exe</pre><p>These files are also lies, but lies of a another type. Zero byte lies.</p><p><img title="Zero Byte Lies" alt="Zero Byte Lies" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/Totally-unsupported-hacks---Add-Windows-_FA2E/image_8911e55c-f33e-45bd-babf-556cac42901c.png" width="596" height="410"></p><p>Right-click wt.exe and Create Shortcut. Then drag that shortcut out of there and into somewhere else like your Desktop. You can then use hashlnk and move it to the WinX folder.</p><p>OR, you can use this scary and totally unsupported utility hosted at a questionable website that you have no business visiting. It's called <a href="https://winaero.com/comment.php?comment.news.30">Win+X Menu Editor</a> and it was a chore to download. So much so that I'm going to hide a copy in my DropBox for the day in the near future when this utility and website disappear.</p><blockquote><p>Be careful when you <a href="https://winaero.com/request.php?21">go download this utility</a>, the site is full of scary links that say Download Now but they are all lies. You want the <a href="https://winaero.com/request.php?21">subtle text link that points to a ZIP file</a>, just above the Donate button that says "Download Win+X Menu Editor."</p></blockquote><p>In this utility you can add an item that points to your new WT.LNK file and it will use Rafael's code and copy the LNK file to the right place and re-number stuff if needed. Again, be careful as you never know. You might mess up your whole life with stuff like this. It worked for me. </p><p><img title="Win+X Menu Editor" alt="Win+X Menu Editor" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/Totally-unsupported-hacks---Add-Windows-_FA2E/image_3818b049-96b4-43cb-a6d6-1e37bb7b5a21.png" width="453" height="514"></p><p>And there you go.</p><p><img title="Windows Terminal in the WIN+X menu" alt="Windows Terminal in the WIN+X menu" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/Totally-unsupported-hacks---Add-Windows-_FA2E/image_7146e8a4-824b-4204-b2f4-889637f93807.png" width="491" height="998"></p><p>Lovely. Now IMHO in some ideal future this should just happen out of the box, but until then it's nice to know I can do it myself.</p><hr><p><strong>Sponsor:</strong> Looking for a tool for performance profiling, unit test coverage, and continuous testing that works cross-platform on Windows, macOS, and Linux? <a href="https://hnsl.mn/2zrPzNN">Check out the latest JetBrains Rider!</a></p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>