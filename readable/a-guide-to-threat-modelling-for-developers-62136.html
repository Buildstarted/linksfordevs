<!DOCTYPE html>
<html lang="en">
<head>
    <title>
A Guide to Threat Modelling for Developers - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="A Guide to Threat Modelling for Developers - linksfor.dev(s)"/>
    <meta property="og:description" content="Threat modelling is a risk based approach to cyber security requirements analysis."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://martinfowler.com/articles/agile-threat-modelling.html#BrainstormThreats"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - A Guide to Threat Modelling for Developers</title>
<div class="readable">
        <h1>A Guide to Threat Modelling for Developers</h1>
            <div>Reading time: 25-32 minutes</div>
        <div>Posted here: 27 May 2020</div>
        <p><a href="https://martinfowler.com/articles/agile-threat-modelling.html#BrainstormThreats">https://martinfowler.com/articles/agile-threat-modelling.html#BrainstormThreats</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
<section id="HowToSimplifyAComplexProblem">
<h2>How to simplify a complex problem</h2>

<p>What are the security requirements for the software you are building?
  Finding a good answer is surprisingly complex. You want to prevent cyber
   losses over the lifetime of the system. 
  But what are the concrete stories, acceptance criteria and technical scope that
  delivers that outcome? That is the puzzle addressed in this guide. 
  </p>



<p>Somewhat unhelpfully, cyber specialists will often ask: 
  <i>'What is your threat model?'</i> This answer is very non-specific and uncertain, 
  much like turning around and saying 'it depends'.  Worse, 'threat model' is obscure 
   technical jargon for most people adding unnecessary mystique. 
  And if you research the topic of threat modelling the information can be overwhelming and hard to action. 
  There is no agreed standard for a 'threat model' or anything like that.</p>

<p>So what are threat models and what is threat modelling? The core of the concept is very simple. It is about understanding
  <b>causes</b> in relation to cyber security losses. It is about using that understanding 
  to protect <b>your system</b> in a risk-based way. It means starting from the 
  potential threats in your particular case, rather than just following a checklist.</p>



<p>Coming to understand the threat model for your system is not simple. There are an unlimited number of threats 
  you can imagine to any system, and many of them could be likely. The reality of threats is that many causes combine. Cyber
  threats chain in unexpected, unpredictable and even chaotic ways. Factors to do with culture, process and technology 
  all contribute. This complexity and uncertainty is at the root
  of the cyber security problem. This is why security requirements are so hard for software development teams to agree
  upon.</p>

<p>The stories behind real breaches show how complex threats and causality can be- often the details are astounding.
  The <a href="https://www.wired.com/story/notpetya-cyberattack-ukraine-russia-code-crashed-the-world/">NotPetya story</a> is a great example. Nation state malware was traded
  by a group called the "ShadowBrokers" and then weaponised. The eventual impact was major losses to organisations
  almost at random. Mearsk, the shipping firm, had to halt the progress of shipping. The confectioner Cadbury's
  had to stop making chocolate. What were their respective threat models? What development team could imagine such 
  a complex chain of causality and collatoral damage? How long would it take your team to model this, and every other 
  dangerous possibility?</p>

<p>Is threat modelling too complex to be of value? Should developers just follow a checklist, 'cross their fingers'
  and hope they get lucky? Skepticism can be healthy, but learning threat modelling is a key 
  skill for developers, I believe. What we need
  is the right approach, and tools to tame the complexity. This guide has been written in that spirit, and begins with
  three ideas which make identifying good, risk-based security requirements much simpler.</p>

<section id="StartFromTheTechnology">
<h3>Start from the technology</h3>

<p>The first recommendation is to <b>focus primarily on technical rather than broad threats</b>, at least at first.</p>

<ul>
<li><b>Broad threats and threat sources</b> include hacker groups, bad actors, disillusioned employees, human error or epidemics of new worm-like malware. These kinds 
  of causes emerge from the world at large and are extremely various, uncertain and unpredictable. They are relative to the value 
  of your system's data and services to your organisation and to others.  These are the kinds of dramatic risks it is easy
  to talk about with non-technical folks.</li>



<li><b>Technical threats and vulnerabilities</b> are much more granular, such as particular weaknesses in software or missing
  security controls such as encryption or authorisation. These kinds of threats emerge from the structure and data-flow inherent in
  the system your team is building. Usually a bunch of technical threats combine together to allow a broad threat to impact your system.</li>
</ul>

<p>By following this guide you will mainly focus on finding technical threats. This helps simplify the elaboration process, because the 
  structure and data-flow of your system is something about which you can be certain. But it also means you can start from your existing strengths as a software
  developer, understanding technical stuff. This is a much stronger ground to start on than high-level risk analysis of threat sources, about which 
  you may know little. 
  </p>

<p>Don't forget about the bigger picture entirely though. A pragmatic and risk-based understanding of what 
  broad threats are possible helps prioritise one technical threat over another. For example simple human error is usually much more likely
  than a nation state attack (see sidebar). That thinking can go into selecting what security scope to start examining first. When you focus on identifying 
  technical threats first, it is then much easier to relate them back to broader threats that justify fixes and additional controls.</p>
</section>

<section id="TakeACollaborativeApproach">
<h3>Take a collaborative approach</h3>

<p>The second recommendation is to <b>adopt a collaborative, team based approach</b>. Identifying security requirements is not easy, and 
  a diversity of perspectives will lead to better decision making. There will always be 
  another vulnerability or technical threat to find, so bringing a wide variety of perspectives to the exercise makes brainstorming more robust. 
  It also increases the likelihood you will identify the most important threats. Threat modelling in a group helps address risk holistically
  and helps the whole team to learn how to think and talk effectively about security.</p>



<p>Getting product owners involved is a great oppotunity from a risk management perspective.
  Product owners have insights into user behaviour and business context that software developers simply lack. They should 
  know about the value of particular services to the business and the impact if that data was exposed or lost. When cyber security losses 
  occur they are business losses. If the worst does happen then the causes will likely be particular to your organisation and the 
  technology you are using. The cyber security problem is not just about ticking technical boxes, its about making good investment 
  decisions to protect the business.</p>
</section>

<section id="ThreatModellinglittleAndOften">
<h3>Threat modelling 'little and often'</h3>

<p>The third recommendation is to <b>start threat modelling 'little and often'</b>. Each threat modelling session
  with the team should be short and focussed 
  enough to be quickly digested into something that can be delivered. Start by analysing the thinnest slice of your 
  system possible; just what you are working on right now. Rather than trying to analyse your entire system upfront, 
  build your team's muscle memory with threat modelling a little bit at a time.</p>

<p>Practises which require a completely specified software design do not match how agile teams work. There is no reason why
  threat modelling needs to be an exhaustive upfront analysis. Too often teams are overwhelmed by 
  comprehensive and highly structured approaches to threat modelling<span><a href="#footnote-structuredTM">[1]</a></span>. I have seen teams try 
  such approaches and run out of time and patience before any real threats were identified- let alone fixes delivered!</p>

<p>Rather than creating and maintaining an exhaustive 'threat model' document, do threat modelling 'little and often'. 
   When you work this way each threat modelling session is tiny, having little impact. Yet the cumulative effect of doing them 
   has a huge impact. When you know you'll be doing this again every iteration, there's less incentive to try to do everything 
   at once and more incentive to prioritize the most important work right now.</p>
</section>
</section>

<section id="PreparingToStart">
<h2>Preparing to start</h2>

<p>This section of the guide starts to make things more detailed and concrete so you can 
        plan to start threat modelling with your team.</p>

<section id="TheThreeKeyQuestions">
<h3>The three key questions</h3>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/planning.jpg"></p><p>Understanding the simple structure of a 
         threat modelling session, and doing a little bit of planning goes a long way to getting a 
         great result.</p>
</div>

<p>The first thing to
         introduce is a simple and flexible structure for threat modelling&nbsp;<span><a href="#footnote-question4">[2]</a></span>.
         This is based on three key questions. It helps to commit this structure to memory. You can use the three
         question structure as a guide whenever you need to assess threats.
         Like riding a bike, once 
        you have mastered the basics you will be able to apply and grow those skills. 
         </p>

<table>
<tbody><tr><th>Activity</th><th>Question</th><th><i>Outcome</i></th></tr>

<tr><td>Explain and explore</td><td>What are you building?</td><td><i>A technical diagram</i></td></tr>

<tr><td>Brainstorm threats</td><td>What can go wrong?</td><td><i>A list of technical threats</i></td></tr>

<tr><td>Prioritise and fix</td><td>What are you going to do?</td><td><i>Priorised fixes added to backlog</i></td></tr>
</tbody></table>

<p>This guide follows the three question structure. In each threat modelling session, you should spend about a third of your
    time answering each question. Then you will come out with a useful result. The rest of the guide will
    break this basic structure into more detailed steps, pointers and explanations to help you run 
    successful threat modelling sessions.</p>
</section>

<section id="PracticalConsiderations">
<h3>Practical considerations</h3>

<p>There are some things you need to get straight before you run a threat modelling session. The following 
    pointers should help you plan.</p>

<section id="WhoShouldBeInvolved">
<h4>Who should be involved?</h4>



<p>Try to involve the whole delivery team in each session, which is to say both technical and non-technical roles. This brings more perspectives and 
    ideas to the table, but also builds shared understanding. Excluding product owners, business analysts and delivery
    managers can mean the work to fix security flaws does not get done, as the value will not be widely 
    understood.</p>

<p>You definitely do not need a security specialist to start threat modelling and discover valuable security scope. 
    However, a threat modelling session is the perfect opportunity to collaborate with specialists,
    security architects or your risk management team. It will all depend on what the roles and expertise 
    are like in your organisation.</p>
</section>

<section id="CadanceAndDuration">
<h4>Cadance and duration</h4>

<p>To start, I recommmend a session length of 90 minutes. You need to give the team the time and space 
    to learn the structure and security concepts involved. Things should get much faster once you get going,
    though. The most impactful threat modelling session I have ever participated in took less than 15 minutes.
    Short and snappy sessions are possible once everyone in the team has built 'muscle memory' with the practise.</p>

<p>I am often asked how frequent threat modelling sessions should be. I do not think there is any right answer,
    it depends on your team. I think of threat modelling just
    like any other team design session. I would not be so rigid as saying it has to be every single week. 
    However, I have worked with many teams with a risk profile that would justify threat modelling every sprint.
    At the other extreme if it has been a few sprints without any threat modelling, the practise is clearly 
    not continuous enough to be considered mature.</p>
</section>

<section id="RunningSessionsFace-to-faceVs.RunningRemotely">
<h4>Running sessions face-to-face vs. running remotely</h4>



<p>A face-to-face threat modelling session could happen in a meeting room, or more informally 
    in the team's normal work area- if you have space. A typical session involves drawing a diagram to explain 
    and explore the scope, brainstorming threats, then prioritising fixes for the backlog. However, a face-to-face 
    session is not always possible.</p>

<p>When you run a session remotely you just need to plan a little differently so everyone can 
    participate virtually. You will need video conferencing and collaboration tools. Agree and setup
    these tools ahead of time. Teams at ThoughtWorks have had success with 
    a variety of tools, including Mural, Miro, Google Jamboard and Google Docs.</p>

<p>Get accustomed to your tools ahead of the session and get participants to test they have access. Whichever 
    tool you choose, ensure you have security approval from your organisation to use the tool. 
    Threat modelling outputs represent sensitive information for a number of reasons and must 
    be protected.</p>

<p>Here are some more pointers to bear in mind when working remotely:</p>

<ul>
<li>It can help to create diagrams asyncronously before the exercise. This is 
      because it can consumes a good amount of time to draw diagrams on virtual boards.</li>

<li>Pay even more attention to creating a common understanding of the concepts and symbols you
    are using to illustrate the system. Explain diagram symbols, data flow arrows and colours of digital stickies.
    </li>

<li>Be more intentional to ensure everyone is engaged in the exercise. 
    Perhaps use some security related brain teasers as an ice-breaker. Refer to broader guides 
    on remote facilitation.</li>

<li>If you have a large group of people, it may make sense to create smaller groups 
     and then consolidate the output. A couple of small sessions is better and more sustainable 
     than one big session. </li>

<li>You will need more breaks than required in a face-to-face session. Remote work is tiring.</li>
</ul>

<p>Regardless if your session is remote or face-to-face, you should aim to finish on time.
      And with some concrete outcomes! This needs discipline - facilitating 
     timings could be a role taken by a delivery manager or someone experienced making sure workshop sessions succeed.
    </p>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/mural-remote.png"></p><p>Mona Fenzl and Sarah Schmid from ThoughtWorks Germany have 
    had some success using a collaboration tool called Mural. They used it to create a
    threat modelling template to help other teams get started with that tool.</p>
</div>
</section>
</section>

<section id="ScopingTheSession">
<h3>Scoping the session</h3>

<p>
        
        Deciding the right focus and level of detail for your session is called 
        'identifying the scope'. Make sure you have decided this ahead of getting people 
        together to perform the activity. Be guided by what has most value right now. Perhaps
        its simply the user stories you are working on this iteration?</p>

<p>Do not try and bite off too much scope at once! If you try threat modelling the entire 
        system at once, either you will make no findings in the time available or 
        you will overrun dramatically and there will be no appetite or budget to do it again.
        It is much better to timebox threat modelling into 
        manageable chunks, performing the activity 'little and often'.</p>

<p>Here are some examples of scopes which have worked well:</p>

<ul>
<li>Scope in current iteration.</li>

<li>An upcoming security sensitive feature, such as a new user registration flow.</li>

<li>The continuous delivery pipeline and delivery infrastructure.</li>

<li>A particular microservice and its collaborating services</li>

<li>A high level overview of a system to identify security tech debt.</li>
</ul>

<p>Whatever scope your team chooses, make sure it is not too big for you to cover in the time available.</p>

<div>
<div>
<div>
<h3>A worked example: scoping</h3>

<p>The rest of the guide uses a real feature to show the 
        concrete steps involved in threat modelling. There is a development team at a retail 
        organisation which is building a platform to sell groceries for home delivery. Here is the 
        epic they have in the upcoming sprint:</p>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/user-story.png"></p><p>
        As a customer,
        I need a page where I can see my customer details,
        So that I can confirm they are correct
        </p>
</div>

<p>If you have ever used an online store, you will be able to imagine a page which is used to update
        address details and perhaps view a loyalty card balance.</p>

<p> From experience, a feature of this size is a
        pretty reasonable scope for threat modelling session.</p>
</div>
</div>
</div>
</section>
</section>

<section id="ExplainAndExplore">
<h2>Explain and explore</h2>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/draw-diagram.jpg"></p><p>
         Do not be tempted to pull a stale image off the Wiki. Talking through how the 
         system is right now- or will be soon, builds shared understanding.</p>
</div>

<p><i>"What are you building?"</i></p>

<p> Diagrams are the perfect tool to explain 
         and explore how software is structured, and designed to communicate. This section of the guide 
        provides detailed pointers on the diagram which will serve as the foundation 
        of your threat modelling session.</p>

<section id="DrawAlo-fiTechnicalDiagram">
<h3>Draw a 'lo-fi' technical diagram</h3>

<p>Drawing a picture gets everyone on the same page. Before you can start thinking of threats, risk
         and mitigations you need a shared technical 
         understanding of the software or infrastructure you are dealing with.</p>

<div>
<section>
<h4><span>i.</span> Show relevant components.</h4>

<p> Luckily, developers will be comfortable drawing diagrams to explore software
            designs. Tap into these established skills by drawing a simple technical diagram of your agreed scope on the whiteboard
            or flipchart.</p>

<p>Nothing needs to be sophisticated or perfect - just draw boxes for the main components and label them.</p>
</section>

<section>
<h4><span>ii.</span> Show users on the diagram.</h4>

<p> Ultimately, systems are designed to allow people to do things. Users matter as they are the ones authorised to things
            in the system. Represent and label them on your diagram.</p>

<ul>
<li>Some users can be more trusted than others. For example end-users usually have less freedom to perform operations 
            in a system than administrators. If multiple groups of users are relevant to the scope of the session, represent and 
            label each group.</li>

<li>Not all systems are user facing. If your system is backend system (perhaps a downstream microservice which only 
            accepts requests from other systems) then represent collaborating systems that are authorised to interact with 
            the system.</li>
</ul>

<p>Trust is essentially about who or what should have the freedom to do a particular thing. Make sure you illustrate those 
             'actors', as they are important for security.</p>
</section>
</div>

<div>
<div>
<div>
<h3>A worked example: Lo-fi diagram</h3>

<p>Returning to the real feature introduced above, lets see how the team chose to illustrate the new 
          'customer details page' functionality. They drew the following diagram.</p>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/building-1.png"></p>
</div>



<p>It illustrates an understanding that the system:</p>

<ul>
<li>is based on a microservice architecture</li>

<li>already has an identity provider in place which allows the customer to authenticate.</li>

<li>has a backend service for customer details (which is written in Java)</li>

<li>has a Backend for Frontend (BFF) service and frontend UI (which are written in Javascript and React)</li>

<li>has users who are customers, and want to edit their profile</li>
</ul>

<p>No detailed knowledge of these technologies is required to follow this guide, but these facts illustrate the level of detail you should discuss while 
        drawing the diagram.</p>
</div>
</div>
</div>
</section>

<section id="ShowHowDataFlows">
<h3>Show how data flows</h3>

<p>It is important to add details to show how data flows around your system.</p>

<div>
<section>
<h4><span>iii.</span> Draw arrows to show data-flow</h4>

<p>Attackers often use the same pathways to pivot around systems that
            legitimate users do. The difference is they abuse them or use them in ways that nobody thought of 
            checking. So it is important to show the trusted paths around your system, to helps see where 
            real threats could happen. 
            </p>

<p>Show data-flows with arrows, starting from the users and collaborating systems. Nowadays, most 
            data-flows are request-response and therefore bi-directional. But I recommend that you draw directional
            arrows from where requests originate. From experience this makes it much easier to brainstorm threats later on.
            </p>
</section>

<section>
<h4><span>iv.</span> Label networks and show boundaries.</h4>

<p>It is more likely threats will originate from certain networks. 
            Networks are configured to restrict the freedom of traffic to flow from one place to another. That restrictiveness (or openness)
            will help determine what threats are possible or likely. The open Internet 
            is more dangerous than a well protected backend network (even if your backend network is a VPC hosted by your cloud provider). </p>

<p>In another colour, draw dotted lines to show the boundaries between different networks in your system. These are often 
            called 'authorisation boundaries'. Sometimes it is 
            worth illustrating gateways devices such as load balancers or firewalls. Other times those devices are not so
            important to your scope in that session, and that is okay too. If you are unsure, it might make sense to invite someone 
            with DevOps or infrastructure knowledge to your next session.</p>
</section>
</div>

<div>
<div>
<div>
<h3>A worked example: Show Data-flow</h3>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/building-2.png"></p>
</div>



<p>In our case arrows are added to illustrate data-flows from the customer who wants to see their
        details, to the UI, then on to the BFF service and onto the customer details resource server to obtain 
        or update the data. There is also a data-flow to the Identity server which issues a token that authorises the session.</p>

<p>There is also an authorisation boundary because the UI is on the Internet, whereas the other components are within 
        the organisation's cloud hosting.</p>
</div>
</div>
</div>

<div>
<section>
<h4><span>v.</span> Show your assets.</h4>

<p>It is helpful to quickly indicate on the diagram where data or services with business value sit. For example, 
            this may be where you store personal data. If your system processes payments, perhaps its the service which does 
            that. The assets in your system are information that needs to be kept confidential or intact, but also services which 
            need to be kept available.</p>

<p>Do not spend too long on this step. The purpose is just to provide a little bit of context to help with 
            brainstorming and prioritisation. If you spend more than 5 minutes on this, then its probably too long.</p>
</section>
</div>

<div>
<div>
<div>
<h3>A worked example: Show your assets</h3>

<p>The team identified the personally identifable information (PII) stored by the Customer Service 
        and the credential store in the Identity provider as the assets with most business value.</p>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/building-3.png"></p>
</div>


</div>
</div>
</div>
</section>
</section>

<section id="BrainstormThreats">
<h2>Brainstorm threats</h2>

<p><i>"What can go wrong?"</i></p>

<p>
       For the second part of your session, simply brainstorm threats to the
       system you have drawn.
      This section provides detailed steps and pointers to help you come up 
      with a good range of relevant security threats.</p>



<section id="UseStrideToHelp">
<h3>Use STRIDE to help</h3>

<p>If your team is beginning with threat modelling, STRIDE is perfect.
        STRIDE is a very light framework that gives you a head-start brainstorming security threats.
        It is a mnemonic, where each letter refers to a security concept. The point is not about
        categorising what you find, but helping you brainstorm effectively.</p>

<p>Invest some time understanding and discussing each of the six security
         concepts with the team before you start. To help learn, ThoughtWorks has created a
         set of STRIDE cue cards. These six cards are linked immediately below. They also include 
         lists of examples on the reverse side.</p>

<div>
<div><p><a href="https://martinfowler.com/articles/agile-threat-modelling/Spoofed_Identity-STRIDE_Threat_Modelling_Card.pdf" target="_blank"><img src="https://martinfowler.com/articles/agile-threat-modelling/Spoofed_Identity-STRIDE_Threat_Modelling_Card.png"></a></p><p>On the Internet, nobody knows you are a dog</p>
</div>

<div><p><a href="https://martinfowler.com/articles/agile-threat-modelling/Tampering_with_Input-STRIDE_Threat_Modelling_Card.pdf" target="_blank"><img src="https://martinfowler.com/articles/agile-threat-modelling/Tampering_with_Input-STRIDE_Threat_Modelling_Card.png"></a></p><p>Can the data overflow and become instructions?</p>
</div>

<div><p><a href="https://martinfowler.com/articles/agile-threat-modelling/Repudiation_Of_Action-STRIDE_Threat_Modelling_Card.pdf" target="_blank"><img src="https://martinfowler.com/articles/agile-threat-modelling/Repudiation_Of_Action-STRIDE_Threat_Modelling_Card.png"></a></p><p>If there's no evidence, its easy to deny it happened</p>
</div>

<div><p><a href="https://martinfowler.com/articles/agile-threat-modelling/Information_Disclosure-STRIDE_Threat_Modelling_Card.pdf" target="_blank"><img src="https://martinfowler.com/articles/agile-threat-modelling/Information_Disclosure-STRIDE_Threat_Modelling_Card.png"></a></p><p>Who else could be looking?</p>
</div>

<div><p><a href="https://martinfowler.com/articles/agile-threat-modelling/Denial_of_Service-STRIDE_Threat_Modelling_Card.pdf" target="_blank"><img src="https://martinfowler.com/articles/agile-threat-modelling/Denial_of_Service-STRIDE_Threat_Modelling_Card.png"></a></p><p>Could the service be taken down?</p>
</div>

<div><p><a href="https://martinfowler.com/articles/agile-threat-modelling/Elevation_Of_Privilege-STRIDE_Threat_Modelling_Card.pdf" target="_blank"><img src="https://martinfowler.com/articles/agile-threat-modelling/Elevation_Of_Privilege-STRIDE_Threat_Modelling_Card.png"></a></p><p>How easy is it to circumvent protections?</p>
</div>
</div>
</section>

<section id="EvilBrainstorming">
<h3>Evil brainstorming</h3>

<p>Coming up with ways to attack, break or frustrate
      a particular bit of software is threat modelling at its essence. It can also be great fun!</p>



<div>
<section>
<h4><span>i.</span> Brainstorm threats!</h4>

<p>Everyone in the group joins in with suggesting threats. Finding the widest diversity of threats is a
       good thing, we are interested in possibilities
      rather than the 'happy path'. A few off-the-wall ideas can help too. 
      Encourage that diversity by making sure everyone is involved and no single voice is allowed to dominate.  
      Make sure everyone has access to pens and stickies and suggests at least one potential threat regardless of 
      background or experience.</p>

<p>Use creative, divergent thinking and leverage the experience and various perspectives 
      present in the group. Later you will prioritise those threats which are most risky or important, so there is no danger 
      in having too many potential threats.</p>
</section>

<section>
<h4><span>ii.</span> Follow the data-flow lines!</h4>

<p>If you need of inspiration, follow data-flow lines on your diagram one by one.
      How might one of the STRIDE concepts apply, for that data-flow? Does that suggest 
      a particular threat which might need to be addressed? Working this 
      way helps identify technical mechanisms and data-flows that 
      attackers might use.</p>

<p>There is a data-flow to any cyber-attack, 
      just like the trusted data-flows you have drawn. Attackers use the same pathways to pivot around system that have been 
      put in place for trusted users. Cyber security losses happen when there are insufficient constraints
      at a technical level to prevent the bad things from happening. 
      </p>
</section>

<section>
<h4><span>iii.</span> Capture threats on stickies</h4>

<p>
      For each threat, spend a moment capturing it. 'SQL injection from Internet',
      'lack of encryption in database', 'no Multi-Factor authentication' are good examples.
      Questions are also good, such as 'do we need to store this data?', 'could there be an authorisation bypass?' 
      and 'who will revoke leavers accounts?'</p>

<p>You will find it is quite natural to then place these stickies 
      in a particular spot on the diagram, alongside a particular user, component or data-flow. Include just enough detail 
      so you know what the sticky means and move on to brainstorming the next threat.</p>
</section>
</div>

<div>
<div>
<div>
<h3>A worked example: Threats identified</h3>

<p>Using the diagram created earlier, the team brainstormed around each 
        data-flow in the system, using STRIDE to help.</p>

<div><p><img src="https://martinfowler.com/articles/agile-threat-modelling/brainstorm.jpg"></p><p>As we discover potential threats in the mechanisms 
        of the software, write them on stickies and annotate the lo-fi diagram.
        </p>
</div>



<p>Here's what they had come up with, at the end of the brainstorming part of the session:</p>

<div>


<div>
<p>Customer→Identity Service</p>

<ul>
<li>authentication is password based, no two-factor authentication</li>
</ul>
</div>

<div>
<p>Customer→UI</p>

<ul>
<li>a DOM based cross-site scripting (XSS) attack</li>
</ul>
</div>

<div>
<p>UI→Bff</p>

<ul>
<li>absence/weakness of identity token validation</li>

<li>injection attack, such as SQL injection, stored XSS</li>

<li>lack of logging of identity of caller</li>

<li>badly configured TLS transport encryption</li>

<li>misconfigured graphQL introspection enabled in production</li>

<li>network layer flood of traffic from a botnet</li>

<li>failure to prevent authenticated user from accessing someone else's details</li>

<li>lack of regular patching could lead to remote code execution</li>
</ul>
</div>

<div>
<p>Bff→Customer Service</p>

<ul>
<li>absence or weakness of 'server to server' authentication</li>

<li>lack of logging of identity of caller</li>

<li>overly permissive security groups allows customer service to be accessed from Internet</li>

<li>failure to prevent authenticated user from accessing someone else's details</li>
</ul>
</div>
</div>

<p>Notice that many of the threats occurred where the data-flow crossed the authorisation boundary from 
      the Internet into the system. However threats were identified in the browser-based UI and within the backend 
      network also.</p>
</div>
</div>
</div>
</section>
</section>

<div>
<p>We're releasing this article in installments. Future installments
        will

        show how we prioritize and fix the issues we've identified.</p>

<p> To find out when we publish the next installment subscribe to the
    site's
    <a href="https://martinfowler.com/feed.atom">RSS feed</a>,
    <a href="https://twitter.com/jgumbley">Jim's twitter stream</a>, or
    <a href="https://twitter.com/martinfowler">Martin's twitter stream</a></p>

</div>

<hr>
</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>