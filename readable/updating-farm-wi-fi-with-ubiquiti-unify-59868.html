<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Updating Farm Wi-Fi with Ubiquiti Unify - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Updating Farm Wi-Fi with Ubiquiti Unify - linksfor.dev(s)"/>
    <meta property="og:description" content="TL;DR: I upgraded part of my Wi-Fi network on my farm with Unify equipment after years of &#x201C;making do&#x201D;."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://larsklint.com/updating-farm-wi-fi-with-ubiquiti-unify/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Updating Farm Wi-Fi with Ubiquiti Unify</title>
<div class="readable">
        <h1>Updating Farm Wi-Fi with Ubiquiti Unify</h1>
            <div>Reading time: 13-16 minutes</div>
        <div>Posted here: 20 Mar 2020</div>
        <p><a href="https://larsklint.com/updating-farm-wi-fi-with-ubiquiti-unify/">https://larsklint.com/updating-farm-wi-fi-with-ubiquiti-unify/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
<p>TL;DR: I upgraded part of my Wi-Fi network on my farm with Unify equipment after years of ‚Äúmaking do‚Äù.</p>
<h2>Let me Explain the Setting</h2>
<p>Roughly 5 years ago I moved, with my family, to a farm in rural Victoria, a state in the South of Australia.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/PANO_20200210_200708.vr_-1024x263.jpg" alt="Farm View" width="1024" height="263" srcset="/wp-content/uploads/2020/03/PANO_20200210_200708.vr_-1024x263.jpg 1024w, /wp-content/uploads/2020/03/PANO_20200210_200708.vr_-300x77.jpg 300w, /wp-content/uploads/2020/03/PANO_20200210_200708.vr_-768x197.jpg 768w, /wp-content/uploads/2020/03/PANO_20200210_200708.vr_-1536x394.jpg 1536w, /wp-content/uploads/2020/03/PANO_20200210_200708.vr_-2048x525.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>While it is beautiful and we absolutely love living here, there are technical challenges. Australia is not known for amazing internet connections and speeds. In fact, we are number 50 on the list of global internet speeds beaten by Kenya, Luxemburg, Qatar and a lot more (46 others actually). If you then move to the middle of nowhere in Australia, you are asking for a world of Internet pain. And of course I work from home in technology and recording lots of videos. We are too far from the phone exchange to get even an ADSL connection, there is no fiber (that is something you eat in these parts), and there is no mobile connection.&nbsp;When we moved in we took over a satellite internet connection which tested as follows.<span id="more-1484"></span></p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/Picture1-1024x683.jpg" alt="Old Satellite Speed" width="1024" height="683" srcset="/wp-content/uploads/2020/03/Picture1-1024x683.jpg 1024w, /wp-content/uploads/2020/03/Picture1-300x200.jpg 300w, /wp-content/uploads/2020/03/Picture1-768x512.jpg 768w, /wp-content/uploads/2020/03/Picture1.jpg 1079w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>I figured out that I could get a mobile connection on top of the hill in the back paddock, which I used to download large files in the first 6 weeks we lived there. I drove my Jeep up the top of the hill, tethered my laptop to my phone, then sucked up all the large files I could, then drove back down. Welcome to the 21st century. Not only was the internet service abysmal, but we also have 3 buildings and 3 acres of garden around the house to cover in WiFi. And it is all on a hill. The challenge was on.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/mittagong_wifi_outline-1024x521.jpg" alt="WiFi Areas" width="1024" height="521" srcset="/wp-content/uploads/2020/03/mittagong_wifi_outline-1024x521.jpg 1024w, /wp-content/uploads/2020/03/mittagong_wifi_outline-300x153.jpg 300w, /wp-content/uploads/2020/03/mittagong_wifi_outline-768x391.jpg 768w, /wp-content/uploads/2020/03/mittagong_wifi_outline-1536x782.jpg 1536w, /wp-content/uploads/2020/03/mittagong_wifi_outline-2048x1043.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<h2>The Patchwork Solution</h2>
<p>I have made my mind up from the start that we wouldn‚Äôt have a fixed line phone. Archaic technology that I couldn‚Äôt even use for any data connections. Instead we installed an approved Telstra repeater and made up a 3G connection that works inside the house. While this isn‚Äôt ideal, as you have to be in a certain part of the house to get connection, it is better than nothing.</p>
<p>I then used some cheap Next-G router to both provide the abysmal satellite connection via WiFi, as well as a backup 3G sim card to give a slightly less abysmal mobile connection. A further two WiFi repeaters were added to the setup to provide slightly better range around the house, the workshop and the second resident. We lived with this system for about 15 months.&nbsp; One WiFi access point and a bunch of repeaters. The bed &amp; breakfast never got coverage.</p>
<p>After 15 months we got a new satellite connection called SkyMuster. Straight out of James Bond. Speeds went to 25Mb/5Mb and a lot more data. Yeah, we don‚Äôt have unlimited data either, so it gets rationed. No Netflix, no YoutTube in 4K or HD, and an increased obsession about minimising data usage. I upgraded to a high-end ASUS router, which increased stability and management options. Still stuck with repeater networks. I used this network setup for another 3.5 years. Until now.</p>
<h2>The Teenager Problem</h2>
<p>I would expect other families are dealing with teenagers on their network too. I do believe I have slightly different criteria for allowing a teenager on my network than most others. The main issue is that our satellite connection currently allows 200GB of peak data usage (7am-1am) and 100 GB of off peak usage (1am-7am). When there are two people working from home, plus all the usual usage, this isn‚Äôt a lot. In fact, as one of my colleagues said, ‚Äúthat is like two nights on Netflix‚Äù. Exactly. My 14-year old will happily use 2GB per hour all day every day.</p>
<p>On top of that he is extremely computer savvy, and knows his way around a network. And I mean ‚Äúaround‚Äù. He can change MAC address on devices, bypass LAN connections, magically conjure up a new phone, and in general find a way. I want him to use the network, but on my terms. I need it for work. No work, no place to stay.</p>
<h2>Criteria</h2>
<p>Obviously there were certain criteria I wanted to fulfill with setting up a whole new network. In no particular order they were:</p>
<ul>
<li>A mesh network with a single SSID (WiFi name) across the entire property.</li>
<li>A way to create a second logically separate network.</li>
<li>The ability to limit certain connections and networks by time, data usage and speed (the data usage limit has been tricky with the patchwork solution).</li>
<li>A way to extend the mesh network easily.</li>
<li>Being able to extend the network with non-LAN devices (we have a large area to cover).</li>
<li>Remote monitoring, management and configuration of the whole network.</li>
<li>High quality hardware that can be upgraded easily. I don‚Äôt want to redo this whole exercise in 5 years.</li>
</ul>
<h2>Approach</h2>
<p>I am not a networking person. I don‚Äôt know much about LAN, WAN, Access Points, Switches, Routers etc. You set it up and then forget about it.</p>
<p>Having had a plethora of various devices and brands to try and create a solution, I was keen to get a pro-sumer level solution. Many friends both within the IT industry and outside of it have gone with <a href="https://www.ui.com/">Ubiquiti</a> hardware, especially <a href="https://unifi-network.ui.com/">Unifi</a>. I briefly considered other solutions and brands, but the extensiblity and ease of use, combined with good hardware reviews made the choice relatively simple.</p>
<p>And here is the conundrum. When you get a standard consumer level WiFi solution, you generally get a single unit that contains a modem/router, a DHCP server, firewall, WiFi access point and a lot more. It is an easy thing to buy and set up for most people, myself included. However, you limit the extensibilty and versatility of the solution. You can‚Äôt just change a single component. With Unifi, everything is separate. You get each component of the network as a standalone hardware unit. And that is great. But I had absolutely no idea where to start and what to get.</p>
<p>In other words, I could not have my cake and eat it too. I couldn‚Äôt buy a single box with everything I needed. I had to do learning and do research. Bugger!</p>
<h2>Solution (version 1)</h2>
<p>After maybe 4 months of reading, buying knowledgeable friends dinner, budgeting, researching various Unifi products and going back and forth on what to buy and how to configure everything, I finally settled on an initial setup.</p>
<p>I got a second hand 1st gen <a href="https://www.ui.com/unifi/unifi-cloud-key/">Cloud Key</a> and <a href="https://www.ui.com/unifi-switching/unifi-switch-2448/">24-port Unifi Switch</a>, as well as two <a href="https://www.ui.com/unifi/unifi-ap-ac-lr/">Long Range Access Points</a>. This appeared to be the minimum starting point I could get away with. A couple of questions you might have</p>
<ul>
<li><strong>Why a 24-port switch</strong>? Two reasons: As stated above I like to future proof this somehow, and I have plans for expansion. Secondly, I got a great deal on a second hand unit.</li>
<li><strong>You have no modem/routing, nor security for external traffic</strong>? I reused my current ASUS unit for this purpose to both save on cost and to test the setup before investing further.</li>
</ul>
<p>According to the specification on the AP-LR units, the range is ‚Äúup to 180 meters‚Äù, which of course never means you get that range. Even if I got half that would work too. Trees, walls, hills and more will affect that range.</p>

<twitter-widget id="twitter-widget-0" data-tweet-id="1235466983073693696"></twitter-widget>

<p>At first I got help setting up the network in my company office. This caused a bunch of weird behaviour, probably because the policies on the network went ‚Äúhang on a minute there‚Äù. I did clear it with our IT team, but it just wouldn‚Äôt play nice. Long story short, I took it all home and set it up there.</p>
<h3>Controller Software</h3>
<p>Setting up the Unifi components require some sequence of steps, the first being setting up the controller software. This can be hosted on a machine of your choosing, or, as I did, you can get a Cloud Key, which is a hardware unit that allows remote access and has the controller software.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/controller_setup_1-1024x392.jpg" alt="Controller Setup" width="1024" height="392" srcset="/wp-content/uploads/2020/03/controller_setup_1-1024x392.jpg 1024w, /wp-content/uploads/2020/03/controller_setup_1-300x115.jpg 300w, /wp-content/uploads/2020/03/controller_setup_1-768x294.jpg 768w, /wp-content/uploads/2020/03/controller_setup_1-1536x588.jpg 1536w, /wp-content/uploads/2020/03/controller_setup_1-2048x784.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>You connect the Cloud Key to your network. I did this via my 24-port Unifi Switch. You then connect to the IP address of the controller in a browser and follow the steps. Once you have set it up with a name, create a Unifi account, whether you want remote access and so on. You should then see something like this.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/unifi_controller_switch-1024x715.jpg" alt="Unifi Switch" width="1024" height="715" srcset="/wp-content/uploads/2020/03/unifi_controller_switch-1024x715.jpg 1024w, /wp-content/uploads/2020/03/unifi_controller_switch-300x210.jpg 300w, /wp-content/uploads/2020/03/unifi_controller_switch-768x536.jpg 768w, /wp-content/uploads/2020/03/unifi_controller_switch.jpg 1287w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<h3>Device Adoption</h3>
<p>As you can tell from the screenshot above, the Switch is pending adoption. That is the term used to use a device on your network. You adopt it. All you do is click the ‚Äúadopt‚Äù button in the controller software for the device, and Unifi does the rest. Once the device is adopted, it will be part of the network, and you can manage it from the controller as well. Easy peacy.</p>
<p>Once I had adopted the switch and the two UAC-AP-LR units, it all showed up in the controller portal.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/unifi_controller_3_units-1024x530.jpg" alt="Adoption complete" width="1024" height="530" srcset="/wp-content/uploads/2020/03/unifi_controller_3_units-1024x530.jpg 1024w, /wp-content/uploads/2020/03/unifi_controller_3_units-300x155.jpg 300w, /wp-content/uploads/2020/03/unifi_controller_3_units-768x398.jpg 768w, /wp-content/uploads/2020/03/unifi_controller_3_units-1536x796.jpg 1536w, /wp-content/uploads/2020/03/unifi_controller_3_units.jpg 1784w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<h3>Access Point Placement</h3>
<p>To show what a noob I am when it comes to networking, I had no idea how to install the APs for best performance. The instructions for the UAP-AC-LR shows that you can mount the unit either horizontally (on the ceiling) or vertically (on the wall). I had a great spot on the wall for one in the main house, and I was going to place the second one in the B&amp;B cottages (refer to earlier map). As the crow flies, that is roughly 50 meters apart. With an optimal range of 180 meters, that should be plenty. It wasn‚Äôt.</p>
<p>I could not get the two APs to connect at all. I had plugged on into the Switch and the other connecting wirelessly. Turned out that the units don‚Äôt work well mounted vertically because of the <a href="https://help.ubnt.com/hc/en-us/articles/115005212927-UniFi-UAP-Antenna-Radiation-Patterns#LR%20overall">antenna radiation profile</a>. And it also turns out that metal roofs, house walls and trees block the signal really well. Perfectly, in fact. Sigh.</p>
<p>I ended up installing one AP at the very top of the ceiling (about 3.5m up) in the part of the house closest to the cottages and the second AP outside under the verandah roof of the B&amp;B cottages. Yes, I realise it isn‚Äôt meant for outside, but meh. That gave me&nbsp;<em>some</em> signal in the cottages (which is also where my office is). Oh, and I found the ‚Äúdark theme‚Äù in the controller üòé</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/unifi_map_3_devices-1024x643.jpg" alt="Topology 3 Units" width="1024" height="643" srcset="/wp-content/uploads/2020/03/unifi_map_3_devices-1024x643.jpg 1024w, /wp-content/uploads/2020/03/unifi_map_3_devices-300x188.jpg 300w, /wp-content/uploads/2020/03/unifi_map_3_devices-768x482.jpg 768w, /wp-content/uploads/2020/03/unifi_map_3_devices-1536x965.jpg 1536w, /wp-content/uploads/2020/03/unifi_map_3_devices-2048x1286.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p><strong>TL;DR</strong> Mount the access points as high up as possible (the range is like an umbrella-ish) and horizontally.</p>
<h3>Yeah, but ‚Ä¶ coverage?</h3>
<p>I started with getting the two UAC-AP-LR units, but deep inside my soul I knew that wouldn‚Äôt be enough. And it wasn‚Äôt. I had great coverage inside the main house and okay coverage for the B&amp;B, but the second house as well as most of the immediate property didn‚Äôt have any at all. The solution was to get two Outdoor Mesh APs. They have the same range as the AP-LR units, but are specifically designed for being outside.</p>
<p>I placed one Outdoor Mesh AP on a ‚Äúhockey stick‚Äù (see below), which was already there for my mobile signal (I did say I live remote), and this could then cover the majority of the space between all the buildings. This AP I connected with a Cat6 cable directly to the switch to make sure it has optimal signal and oomph (technical term).</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/PANO_20200320_160800.vr_-1024x497.jpg" alt="Outdoor Mesh" width="1024" height="497" srcset="/wp-content/uploads/2020/03/PANO_20200320_160800.vr_-1024x497.jpg 1024w, /wp-content/uploads/2020/03/PANO_20200320_160800.vr_-300x146.jpg 300w, /wp-content/uploads/2020/03/PANO_20200320_160800.vr_-768x373.jpg 768w, /wp-content/uploads/2020/03/PANO_20200320_160800.vr_-1536x746.jpg 1536w, /wp-content/uploads/2020/03/PANO_20200320_160800.vr_-2048x995.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>The second Outdoor Mesh AP I put on the second house, and then wirelessly uplinking (connecting) to the first Outdoor Mesh AP. Which finally gave me great coverage to the majority of the buildings and area between them.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/Unifi_4_aps_topology-1024x787.jpg" alt="Topology 4 APs" width="1024" height="787" srcset="/wp-content/uploads/2020/03/Unifi_4_aps_topology-1024x787.jpg 1024w, /wp-content/uploads/2020/03/Unifi_4_aps_topology-300x231.jpg 300w, /wp-content/uploads/2020/03/Unifi_4_aps_topology-768x590.jpg 768w, /wp-content/uploads/2020/03/Unifi_4_aps_topology-1536x1180.jpg 1536w, /wp-content/uploads/2020/03/Unifi_4_aps_topology.jpg 2003w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>And the Unifi controller software also comes with a handy mapping feature that lets you place all the devices on a Google map (or image), which gives a good sense of coverage. It doesn‚Äôt take buildings or other structures into account though, and in fact my actual coverage is about 40% greater than what is shown.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/Unifi_property_map-1024x759.jpg" alt="Coverage Heat Map" width="1024" height="759" srcset="/wp-content/uploads/2020/03/Unifi_property_map-1024x759.jpg 1024w, /wp-content/uploads/2020/03/Unifi_property_map-300x222.jpg 300w, /wp-content/uploads/2020/03/Unifi_property_map-768x569.jpg 768w, /wp-content/uploads/2020/03/Unifi_property_map-1536x1138.jpg 1536w, /wp-content/uploads/2020/03/Unifi_property_map-2048x1518.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>When testing just how far I could get the signal to stretch I walked up the hill. The claimed/nominated range for a UAC-AP-M is 180 meters. I got ~175 meters. I did not expect that.</p>
<p><img src="https://larsklint.com/wp-content/uploads/2020/03/UAC-AP-M_range-1024x702.jpg" alt="UAC-AP-M Range" width="1024" height="702" srcset="/wp-content/uploads/2020/03/UAC-AP-M_range-1024x702.jpg 1024w, /wp-content/uploads/2020/03/UAC-AP-M_range-300x206.jpg 300w, /wp-content/uploads/2020/03/UAC-AP-M_range-768x526.jpg 768w, /wp-content/uploads/2020/03/UAC-AP-M_range-1536x1053.jpg 1536w, /wp-content/uploads/2020/03/UAC-AP-M_range.jpg 1986w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<h2>Issues</h2>
<p>It didn‚Äôt all go without hiccups. I have already described how trying to set up a personal network by using a corporate network was a silly idea. But there were a couple of other things I could have done better, or would have liked to avoid.</p>
<ul>
<li>I had to reset the APs a couple of times, because they got caught up in a provisioning loop it seemed.</li>
<li>Understand how the signal of an access point works. Mounting them in the right location and horizontally has a big impact on your overall WiFi quality.</li>
<li>If you provision an AP over LAN (connected), you can‚Äôt then use it wirelessly. I had to reset the AP-LR to get it to uplink over WiFi.</li>
<li>You will always need more equipment than you think.</li>
<li>I can‚Äôt create a second WiFi network on a second virtual LAN (VLAN). Whenever I try it, the connection to the Internet completely dies. ü§∑‚Äç‚ôÇÔ∏è</li>
</ul>
<p>In general the equipment works extremely well and most issues came from me not understanding how it all works. I learnt a ton.</p>
<h2>Version 2 (and 3)</h2>
<p>While I have very decent WiFi now, I can monitor it remotely and I have coverage on a large part of the property, I am by no means done. The most obvious missing piece is the Unifi Security Gateway. This is the DHCP server, firewall, traffic manager and much more. I am currently using my ASUS router for this purpose, which works just fine, but I am missing a whole bunch of features and functionality.</p>
<p>I will get another Outdoor Mesh AP to put on the outside of the B&amp;B instead of the current AP-Lr (which is for indoor use) and then move the AP-LR to another part of the main house. This will also give me coverage over the tennis court and all the way to the gate (80 meters). Because I have a 24-port switch, I will also install wall-mounted RJ45 plugs for TVs and other devices.</p>
<p>Further down the line, I am installing cameras at the gate, house and garages. This is something I‚Äôd want to do both for insurance purposes and security. Unifi have their own <a href="https://www.ui.com/unifi-video/unifi-video-camera-g3/">range of cameras</a> for this. I will also get one or two more Outdoor Mesh units to cover the rest of the sheds and immediate property. This will be used for IoT systems for garden watering, automatically turning on our bore pump for filling the bore tank, if the tank is low, and other projects.</p>
<h2>Final Words</h2>
<p>Wow, this post turned out a lot longer than I anticipated, but I had a lot of fun with it. Despite a few niggly bits and me not understanding everything to do with networks, WiFi and radio signals, I am extremely happy with the setup. The first version I have created is a base for many future projects that I can do one bit at the time. Unifi has a large range of products, and while I don‚Äôt know half of them, I am confident they can solve most of the network hurdles I come across. The only thing I regret is not doing it sooner to be honest.</p>
 </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>