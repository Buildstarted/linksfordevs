<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Rocket Loader skimmer impersonates CloudFlare library in clever scheme - Malwarebytes Labs - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Rocket Loader skimmer impersonates CloudFlare library in clever scheme - Malwarebytes Labs - linksfor.dev(s)"/>
    <meta property="article:author" content="J&#xE9;r&#xF4;me Segura"/>
    <meta property="og:description" content="URLs can be deceiving, but the one used to mimic CloudFlare&#x27;s Rocket Loader in the latest Magecart attack takes it to a whole new level."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Rocket Loader skimmer impersonates CloudFlare library in clever scheme - Malwarebytes Labs</title>
<div class="readable">
        <h1>Rocket Loader skimmer impersonates CloudFlare library in clever scheme - Malwarebytes Labs</h1>
            <div>by J&#xE9;r&#xF4;me Segura</div>
            <div>Reading time: 5-6 minutes</div>
        <div>Posted here: 10 Mar 2020</div>
        <p><a href="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/">https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="articleBody" itemprop="articleBody"> 
<p>Fraudsters are known for using social engineering tricks to dupe their victims, often times by impersonating authority figures to instill trust.</p>



<p>In a recent <a rel="noreferrer noopener" aria-label="blog post (opens in a new tab)" href="https://blog.malwarebytes.com/threat-analysis/2020/02/fraudsters-cloak-credit-card-skimmer-with-fake-content-delivery-network-ngrok-server/" target="_blank">blog post</a>, we noted how criminals behind Magecart skimmers mimicked content delivery networks in order to hide their payload. This time, we are looking at a far more clever scheme.</p>



<p>This latest skimmer is disguised as a JavaScript file that appears to be CloudFlare’s Rocket Loader, a library used to improve page load time. The attackers created an almost authentic replica by registering a specially crafted domain name.</p>



<p>This campaign has been affecting a number of e-commerce sites and shows threat actors will continue to come up with ingenious ways to deceive security analysts and website administrators alike.</p>



<h3>Decoy Rocket Loader</h3>



<p>On a compromised Magento site, we noticed that attackers had injected a script purporting to be the <a rel="noreferrer noopener" aria-label="Rocket Loader library (opens in a new tab)" href="https://support.cloudflare.com/hc/en-us/articles/200168056-What-does-Rocket-Loader-do-" target="_blank">Rocket Loader library</a>. In fact, we can see two almost identical versions loaded side by side.</p>



<figure><img data-attachment-id="42603" data-permalink="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/attachment/2_cf_/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/2_CF_.png" data-orig-size="692,431" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2_CF_" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/2_CF_-300x187.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/2_CF_-600x374.png" src="https://blog.malwarebytes.com/wp-content/uploads/2020/03/2_CF_.png" alt="rocket loader impersonation" srcset="https://blog.malwarebytes.com/wp-content/uploads/2020/03/2_CF_.png 692w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/2_CF_-300x187.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/2_CF_-600x374.png 600w" sizes="(max-width: 692px) 100vw, 692px"></figure>



<p>If we look at their source code, we find that the two scripts are quite different. One of them is obfuscated, while the other is recognizable as the legitimate CloudFlare Rocket Loader library.</p>



<figure><img data-attachment-id="42607" data-permalink="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/attachment/sourcecode-6/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/sourcecode.png" data-orig-size="737,666" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="sourcecode" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/sourcecode-300x271.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/sourcecode-600x542.png" src="https://blog.malwarebytes.com/wp-content/uploads/2020/03/sourcecode.png" alt="Rocket Loader and skimmer, side by side" srcset="https://blog.malwarebytes.com/wp-content/uploads/2020/03/sourcecode.png 737w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/sourcecode-300x271.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/sourcecode-600x542.png 600w" sizes="(max-width: 737px) 100vw, 737px"></figure>



<p>There is a subtle difference in the URI path loading both scripts. The malicious one uses a clever way to turn the domain name <strong>http.ps</strong> (note the dot ‘.’ , extra ‘p’ and double slash ‘//’) into something that looks like ‘https://’. The threat actors are taking advantage of the fact that <a rel="noreferrer noopener" aria-label="since Google Chrome version 76 (opens in a new tab)" href="https://bugs.chromium.org/p/chromium/issues/detail?id=883038#c114" target="_blank">since Google Chrome version 76</a>, the “https” scheme (and special-case subdomain “www”) is no longer shown to users.</p>



<figure><img data-attachment-id="42596" data-permalink="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/attachment/full_ui/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI.png" data-orig-size="712,373" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="full_UI" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI-300x157.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI-600x314.png" src="https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI.png" alt="https certificate view in URL address bar" srcset="https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI.png 712w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI-300x157.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI-600x314.png 600w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/full_UI-630x330.png 630w" sizes="(max-width: 712px) 100vw, 712px"></figure>



<p>To reveal the full URL with its protocol, you can double click inside the address bar. In other browsers such as Firefox or Edge, the default is to show the entire URL. That makes this attack a little more obvious and therefore less effective if you were a site administrator investigating this library.</p>



<figure><img data-attachment-id="42605" data-permalink="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/attachment/ff-11/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/FF.png" data-orig-size="630,326" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="FF" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/FF-300x155.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/FF-600x310.png" src="https://blog.malwarebytes.com/wp-content/uploads/2020/03/FF.png" alt="" srcset="https://blog.malwarebytes.com/wp-content/uploads/2020/03/FF.png 630w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/FF-300x155.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/FF-600x310.png 600w" sizes="(max-width: 630px) 100vw, 630px"></figure>



<h3>Active skimmer campaign</h3>



<p>The Palestinian National Internet Naming Authority (<strong>PNINA</strong>) is the official domain registry for the <strong>.ps</strong> country code Top-Level-Domain (ccTLD). The decoy domain <strong>http.ps</strong> was registered on 2020-02-07 via the Key-Systems GmbH registrar.</p>



<figure><img data-attachment-id="42598" data-permalink="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/attachment/domain-2/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain.png" data-orig-size="783,785" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="domain" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain-300x300.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain-598x600.png" src="https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain.png" alt="" srcset="https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain.png 783w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain-300x300.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain-598x600.png 598w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/domain-150x150.png 150w" sizes="(max-width: 783px) 100vw, 783px"></figure>



<p>In mid-February, security researcher Willem de Groot <a rel="noreferrer noopener" aria-label="tweet (opens in a new tab)" href="https://twitter.com/gwillem/status/1227936380380119041?s=20" target="_blank">tweeted</a> about how this domain was being used for credit card skimming in an <a rel="noreferrer noopener" aria-label="ongoing campaign (opens in a new tab)" href="https://twitter.com/gwillem/status/1231604432586125313?s=20" target="_blank">ongoing campaign</a> with the additional “e4[.]ms” domain.</p>



<p>The skimmer code as well as its exfiltration gate (autocapital[.]pw), were <a rel="noreferrer noopener" aria-label="described (opens in a new tab)" href="https://twitter.com/unmaskparasites/status/1234917686242619393?s=20" target="_blank">described</a> by Denis Sinegubko, a security researcher at GoDaddy/Sucuri.</p>



<p>There are two ways e-commerce sites are being compromised:</p>



<ul><li>Skimming code that is injected into a self hosted JavaScript library (the jQuery library seems to be the most targeted)</li><li>A script that references an external JavaScript, hosted on a malicious site</li></ul>



<p>The first version of the skimmer used in this campaign is the hex obfuscated type with data exfiltration via autocapital[.]pw as seen in the decoy Rocket Loader library. As Denis mentioned in his tweet, this skimmer contains an English and Portuguese version (urlscan.io archive <a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://urlscan.io/result/587cf7f5-1c2c-4376-b5c0-813cbecdd201/" target="_blank">here</a>).</p>



<figure><img data-attachment-id="42617" data-permalink="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/attachment/eng_port/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/eng_port.png" data-orig-size="641,718" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="eng_port" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/eng_port-268x300.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/eng_port-536x600.png" src="https://blog.malwarebytes.com/wp-content/uploads/2020/03/eng_port.png" alt="" srcset="https://blog.malwarebytes.com/wp-content/uploads/2020/03/eng_port.png 641w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/eng_port-268x300.png 268w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/eng_port-536x600.png 536w" sizes="(max-width: 641px) 100vw, 641px"></figure>



<p>The other version of the skimmer (hosted on e4[.]ms) uses a different obfuscation scheme with data exfiltration via xxx-club[.]pw (this domain is on the same server as the autocapital[.]pw exfiltration gate).</p>



<figure><img data-attachment-id="42618" data-permalink="https://blog.malwarebytes.com/threat-analysis/2020/03/rocket-loader-skimmer-impersonates-cloudflare-library-in-clever-scheme/attachment/e4/" data-orig-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/e4.png" data-orig-size="636,497" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="e4" data-image-description="" data-medium-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/e4-300x234.png" data-large-file="https://blog.malwarebytes.com/wp-content/uploads/2020/03/e4-600x469.png" src="https://blog.malwarebytes.com/wp-content/uploads/2020/03/e4.png" alt="Similar naming convention as faux Rocket Loader " srcset="https://blog.malwarebytes.com/wp-content/uploads/2020/03/e4.png 636w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/e4-300x234.png 300w, https://blog.malwarebytes.com/wp-content/uploads/2020/03/e4-600x469.png 600w" sizes="(max-width: 636px) 100vw, 636px"></figure>



<p>We recognize this obfuscation pattern as ‘Radix’, from a <a rel="noreferrer noopener" aria-label="previous campaign (opens in a new tab)" href="https://blog.sucuri.net/2019/03/more-on-dnsden-biz-swipers-and-radix-obfuscation.html" target="_blank">previous campaign</a> described and tracked by Sucuri since 2016. Given the naming convention used for the domains and skimmers, we believe the same threat actors may be behind this newest wave of attacks.</p>



<h3>Patching and proactive security</h3>



<p>This kind of attack reinforces the importance of good website security. The majority of compromises happen on sites that have not been updated or that use weak login credentials. These days, other forms of defense include web application firewalls and general hardening of the CMS and its server.</p>



<p>The majority of consumers that shop on a compromised site will have no idea that something went wrong until it’s too late. Even though it is the responsibility of the merchant to ensure their platform is secure, it is obvious that additional containment needs to be taken by visitors themselves.</p>



<p>Malwarebytes users are protected against this credit card skimming attack via our web protection layer in Malwarebytes for consumers and businesses.</p>



<p>We have reached out to the registrar and certificate authority but at the time of writing the malicious decoy domain is still active.</p>



<h3>Indicators of compromise</h3>



<p><strong>Skimmers and gates</strong></p>



<pre>http[.]ps
autocapital[.]pw
xxx-club[.]pw
e4m[.]s
y5[.]ms</pre>



<pre>83.166.248[.]67<br>83.166.244[.]189<br></pre>




</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>