<!DOCTYPE html>
<html lang="en">
<head>
    <title>
AspNetCoreCertificates/Documentation.md at master &#xB7; damienbod/AspNetCoreCertificates &#xB7; GitHub -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>AspNetCoreCertificates/Documentation.md at master · damienbod/AspNetCoreCertificates · GitHub</h1><div><div id="" class="markdown-body entry-content p-3 p-md-6"><h1><a id="user-content-certificate-manager-documentation" class="anchor" aria-hidden="true" href="#certificate-manager-documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Certificate Manager Documentation</h1><p>Certificate Manager is a package which makes it easy to create certificates (chained and self signed) which can be used to in client server authentication and IoT Devices like Azure IoT Hub</p><h1><a id="user-content-basic-usage-aspnet-core-net-core" class="anchor" aria-hidden="true" href="#basic-usage-aspnet-core-net-core"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic usage ASP.NET Core, .NET Core</h1><p>Add the NuGet package to the your project file</p><pre><code>&lt;PackageReference Include="CertificateManager" Version="1.0.3" /&gt;
</code></pre><p>The NuGet packages uses dependency injection to setup. In a console application initialize the package as follows:</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();
</pre></div><p>Or in an ASP.NET Core application use the Startup ConfigureServices method to initialize the package.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span><span class="pl-k">void</span><span class="pl-en">ConfigureServices</span>(<span class="pl-en">IServiceCollection</span><span class="pl-smi">services</span>)
{
    <span class="pl-c"><span class="pl-c">//</span> ...</span><span class="pl-smi">services</span>.<span class="pl-en">AddCertificateManager</span>();
}</pre></div><h2><a id="user-content-certificate-configuration" class="anchor" aria-hidden="true" href="#certificate-configuration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Certificate Configuration</h2><h3><a id="user-content-distinguished-name" class="anchor" aria-hidden="true" href="#distinguished-name"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Distinguished Name</h3><p>The distinguished name will be saved to the Issuer and the Subject properties of the certificate.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">distinguishedName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">DistinguishedName</span>
{
    <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>,
    <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span>,
    <span class="pl-smi">Locality</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span>,
    <span class="pl-smi">Organisation</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>damienbod<span class="pl-pds">"</span></span>,
    <span class="pl-smi">OrganisationUnit</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>development<span class="pl-pds">"</span></span>
};</pre></div><p>The CommonName property is required.</p><p>example in certificate:</p><pre><code>C=CH, C=CH, O=damienbod, OU=development, CN=localhost
</code></pre><p>definitions:</p><ul><li>C= Country</li><li>ST= State or province</li><li>L= Locality</li><li>O= organisation</li><li>OU=Organisation Unit</li><li>CN= Common name</li></ul><p>// CN is REQUIRED</p><h3><a id="user-content-validity-period" class="anchor" aria-hidden="true" href="#validity-period"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Validity Period</h3><p>The Validity Period defines when the certificate is valid from and how long.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">validityPeriod</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span>
{
    <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>,
    <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>)
};</pre></div><p>If creating a child certificate from a root or an intermediate certification, the values cannot be outside the range of the parent. If the certificate values are outside the range, the parent values will be used.</p><p>The ValidFrom and the ValidTo values can then be used to validate the certificate. It is recommended the keep this period short. This depends on how you use and deploy the certificates.</p><h2><a id="user-content-creating-self-signed-certificates-for-client-server-authentication" class="anchor" aria-hidden="true" href="#creating-self-signed-certificates-for-client-server-authentication"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Self Signed Certificates for Client Server Authentication</h2><p>The <strong>CreateCertificatesClientServerAuth</strong> service is used to create these certificates.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">dnsName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>;
<span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">createClientServerAuthCerts</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesClientServerAuth</span>&gt;();</pre></div><p>The <strong>NewServerSelfSignedCertificate</strong> method can be used to create a self signed certificate for a certificate which is to be used on the server. The dnsName must match your server deployment. Only the correct enhanced Key usages is set.</p><p>Oid("1.3.6.1.5.5.7.3.1"), // TLS Server auth</p><p>This can then be validated.</p><div class="highlight highlight-source-cs"><pre><span class="pl-c"><span class="pl-c">//</span> Server self signed certificate</span><span class="pl-k">var</span><span class="pl-smi">server</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewServerSelfSignedCertificate</span>(
    <span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>server<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span> },
    <span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
    <span class="pl-smi">dnsName</span>);
<span class="pl-smi">server</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>azure server certificate<span class="pl-pds">"</span></span>;</pre></div><p>The <strong>NewClientSelfSignedCertificate</strong> method can be used to create a self signed certificate for a certificate which is to be used on the server. The dnsName must match your server deployment. Only the correct enhanced Key usages is set.</p><p>Oid("1.3.6.1.5.5.7.3.2"), // TLS Client auth</p><p>This can then be validated.</p><div class="highlight highlight-source-cs"><pre><span class="pl-c"><span class="pl-c">//</span> Client self signed certificate</span><span class="pl-k">var</span><span class="pl-smi">client</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewClientSelfSignedCertificate</span>(
    <span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>client<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span> },
    <span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
    <span class="pl-smi">dnsName</span>);

<span class="pl-smi">client</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>azure client certificate<span class="pl-pds">"</span></span>;</pre></div><h2><a id="user-content-creating-chained-certificates-for-client-server-authentication" class="anchor" aria-hidden="true" href="#creating-chained-certificates-for-client-server-authentication"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Chained Certificates for Client Server Authentication</h2><p>The <strong>CreateCertificatesClientServerAuth</strong> service is used to create these certificates.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">createClientServerAuthCerts</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesClientServerAuth</span>&gt;();</pre></div><p>The <strong>NewRootCertificate</strong> method creates a new root certificate which can be used for chained structures. If you use your own root certificate, it needs to be added to the trusted certificate store on deployment host.</p><p>This is not needed if creting certificates from a public CA certificate. The root certificatge is a self signed certificate.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">rootCaL1</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewRootCertificate</span>(
    <span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>root dev<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>IT<span class="pl-pds">"</span></span> },
    <span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
    <span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>);
<span class="pl-smi">rootCaL1</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement root L1 certificate<span class="pl-pds">"</span></span>;</pre></div><p>The <strong>NewIntermediateChainedCertificate</strong> creates an intermediate certificate from a parent root or another intermediate certificate.</p><div class="highlight highlight-source-cs"><pre><span class="pl-c"><span class="pl-c">//</span> Intermediate L2 chained from root L1</span><span class="pl-k">var</span><span class="pl-smi">intermediateCaL2</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewIntermediateChainedCertificate</span>(
    <span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>intermediate dev<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>FR<span class="pl-pds">"</span></span> },
    <span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
    <span class="pl-c1">2</span>,  <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-smi">rootCaL1</span>);
<span class="pl-smi">intermediateCaL2</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement Intermediate L2 certificate<span class="pl-pds">"</span></span>;</pre></div><p>The <strong>NewServerChainedCertificate</strong> method can be used to create a self signed certificate for a certificate which is to be used on the server. The dnsName must match your server deployment. Only the correct enhanced Key usages is set.</p><p>Oid("1.3.6.1.5.5.7.3.1"), // TLS Server auth</p><p>This can then be validated.</p><div class="highlight highlight-source-cs"><pre><span class="pl-c"><span class="pl-c">//</span> Server, Client L3 chained from Intermediate L2</span><span class="pl-k">var</span><span class="pl-smi">serverL3</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewServerChainedCertificate</span>(
    <span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>server<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>DE<span class="pl-pds">"</span></span> },
    <span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
    <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-smi">intermediateCaL2</span>);
<span class="pl-smi">serverL3</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement server L3 certificate<span class="pl-pds">"</span></span>;</pre></div><p>The <strong>NewClientChainedCertificate</strong> method can be used to create a chained certificate for a certificate which is to be used on the server. The dnsName must match your server deployment. Only the correct enhanced Key usages is set.</p><p>Oid("1.3.6.1.5.5.7.3.2"), // TLS Client auth</p><p>This can then be validated.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">clientL3</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewClientChainedCertificate</span>(
    <span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>client<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>IE<span class="pl-pds">"</span></span> },
    <span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
    <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-smi">intermediateCaL2</span>);
<span class="pl-smi">clientL3</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement client L3 certificate<span class="pl-pds">"</span></span>;
            </pre></div><h2><a id="user-content-creating-chained-certificates-for-azure-iot-hub" class="anchor" aria-hidden="true" href="#creating-chained-certificates-for-azure-iot-hub"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Chained Certificates for Azure IoT Hub</h2><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
	.<span class="pl-en">AddCertificateManager</span>()
	.<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">createClientServerAuthCerts</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesClientServerAuth</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">root</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewRootCertificate</span>(
	<span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>root dev<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>IT<span class="pl-pds">"</span></span> },
	<span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
	<span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>);
<span class="pl-smi">root</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement root certificate<span class="pl-pds">"</span></span>;

<span class="pl-c"><span class="pl-c">//</span> Intermediate L2 chained from root L1</span><span class="pl-k">var</span><span class="pl-smi">intermediate</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewIntermediateChainedCertificate</span>(
	<span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>intermediate dev<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>FR<span class="pl-pds">"</span></span> },
	<span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
	<span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-smi">root</span>);
<span class="pl-smi">intermediate</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement Intermediate certificate<span class="pl-pds">"</span></span>;

<span class="pl-k">string</span><span class="pl-smi">password</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>;
<span class="pl-k">var</span><span class="pl-smi">importExportCertificate</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">rootCertInPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportRootPfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">root</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>root.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">rootCertInPfxBtyes</span>);

<span class="pl-c"><span class="pl-c">//</span> https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-security-x509-get-started</span><span class="pl-k">var</span><span class="pl-smi">rootPublicKey</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportCertificatePublicKey</span>(<span class="pl-smi">root</span>);
<span class="pl-k">var</span><span class="pl-smi">rootPublicKeyBytes</span><span class="pl-k">=</span><span class="pl-smi">rootPublicKey</span>.<span class="pl-en">Export</span>(<span class="pl-smi">X509ContentType</span>.<span class="pl-smi">Cert</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">$"</span>root.cer<span class="pl-pds">"</span></span>, <span class="pl-smi">rootPublicKeyBytes</span>);

<span class="pl-k">var</span><span class="pl-smi">intermediateCertInPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportChainedCertificatePfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">intermediate</span>, <span class="pl-smi">root</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>intermediate.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">intermediateCertInPfxBtyes</span>);</pre></div><h2><a id="user-content-creating-verify-certificate-for-azure-iot-hub" class="anchor" aria-hidden="true" href="#creating-verify-certificate-for-azure-iot-hub"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Verify Certificate for Azure IoT Hub</h2><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
	.<span class="pl-en">AddCertificateManager</span>()
	.<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">createClientServerAuthCerts</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesClientServerAuth</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">importExportCertificate</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">root</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">X509Certificate2</span>(<span class="pl-s"><span class="pl-pds">"</span>root.pfx<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>);

<span class="pl-k">var</span><span class="pl-smi">deviceVerify</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewDeviceVerificationCertificate</span>(
<span class="pl-s"><span class="pl-pds">"</span>&lt;veification code from Azure IoT Hub&gt;<span class="pl-pds">"</span></span>, <span class="pl-smi">root</span>);
<span class="pl-smi">deviceVerify</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>device verify<span class="pl-pds">"</span></span>;

<span class="pl-k">var</span><span class="pl-smi">deviceVerifyPEM</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">PemExportPublicKeyCertificate</span>(<span class="pl-smi">deviceVerify</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllText</span>(<span class="pl-s"><span class="pl-pds">"</span>deviceVerify.pem<span class="pl-pds">"</span></span>, <span class="pl-smi">deviceVerifyPEM</span>);

<span class="pl-k">var</span><span class="pl-smi">deviceVerifyPublicKey</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportCertificatePublicKey</span>(<span class="pl-smi">deviceVerify</span>);
<span class="pl-k">var</span><span class="pl-smi">deviceVerifyPublicKeyBytes</span><span class="pl-k">=</span><span class="pl-smi">deviceVerifyPublicKey</span>.<span class="pl-en">Export</span>(<span class="pl-smi">X509ContentType</span>.<span class="pl-smi">Cert</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">$"</span>deviceVerify.cer<span class="pl-pds">"</span></span>, <span class="pl-smi">deviceVerifyPublicKeyBytes</span>);
</pre></div><h2><a id="user-content-creating-device-leaf-certificates-for-azure-iot-hub" class="anchor" aria-hidden="true" href="#creating-device-leaf-certificates-for-azure-iot-hub"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Device (Leaf) Certificates for Azure IoT Hub</h2><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
	.<span class="pl-en">AddCertificateManager</span>()
	.<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">createClientServerAuthCerts</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesClientServerAuth</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">intermediate</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">X509Certificate2</span>(<span class="pl-s"><span class="pl-pds">"</span>intermediate.pfx<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>);

<span class="pl-k">var</span><span class="pl-smi">testDevice01</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewDeviceChainedCertificate</span>(
	<span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>&lt;Device ID&gt;<span class="pl-pds">"</span></span> },
	<span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
	<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-smi">intermediate</span>);
<span class="pl-smi">testDevice01</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>IoT device testDevice01<span class="pl-pds">"</span></span>;

<span class="pl-k">string</span><span class="pl-smi">password</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>;
<span class="pl-k">var</span><span class="pl-smi">importExportCertificate</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">deviceInPfxBytes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportChainedCertificatePfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">testDevice01</span>, <span class="pl-smi">intermediate</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>testDevice01.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">deviceInPfxBytes</span>);</pre></div><h2><a id="user-content-creating-certificates-for-application-development-angular-vuejs" class="anchor" aria-hidden="true" href="#creating-certificates-for-application-development-angular-vuejs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating certificates for application development Angular, VUE.js</h2><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">_createCertificatesRsa</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesRsa</span>&gt;();

<span class="pl-c"><span class="pl-c">//</span> Create development certificate for localhost</span><span class="pl-k">var</span><span class="pl-smi">devCertificate</span><span class="pl-k">=</span><span class="pl-smi">_createCertificatesRsa</span>
    .<span class="pl-en">CreateDevelopmentCertificate</span>(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">10</span>);

<span class="pl-smi">devCertificate</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>localhost development<span class="pl-pds">"</span></span>;

<span class="pl-k">string</span><span class="pl-smi">password</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>;
<span class="pl-k">var</span><span class="pl-smi">importExportCertificate</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-c"><span class="pl-c">//</span> full pfx with password</span><span class="pl-k">var</span><span class="pl-smi">rootCertInPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportRootPfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">devCertificate</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>dev_localhost.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">rootCertInPfxBtyes</span>);

<span class="pl-c"><span class="pl-c">//</span> private key</span><span class="pl-k">var</span><span class="pl-smi">exportRsaPrivateKeyPem</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">PemExportRsaPrivateKey</span>(<span class="pl-smi">devCertificate</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllText</span>(<span class="pl-s"><span class="pl-pds">$"</span>dev_localhost.key<span class="pl-pds">"</span></span>, <span class="pl-smi">exportRsaPrivateKeyPem</span>);

<span class="pl-c"><span class="pl-c">//</span> public key certificate as pem</span><span class="pl-k">var</span><span class="pl-smi">exportPublicKeyCertificatePem</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">PemExportPublicKeyCertificate</span>(<span class="pl-smi">devCertificate</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllText</span>(<span class="pl-s"><span class="pl-pds">$"</span>dev_localhost.pem<span class="pl-pds">"</span></span>, <span class="pl-smi">exportPublicKeyCertificatePem</span>);</pre></div><h2><a id="user-content-creating-chained-certificates-from-a-trusted-ca-certificate" class="anchor" aria-hidden="true" href="#creating-chained-certificates-from-a-trusted-ca-certificate"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Chained Certificates from a trusted CA Certificate</h2><h2><a id="user-content-exporting-certificates" class="anchor" aria-hidden="true" href="#exporting-certificates"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exporting Certificates</h2><h3><a id="user-content-exporting-self-signed-certificates" class="anchor" aria-hidden="true" href="#exporting-self-signed-certificates"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exporting self signed certificates</h3><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serverCertInPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportSelfSignedCertificatePfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">server</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>server.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">serverCertInPfxBtyes</span>);

<span class="pl-k">var</span><span class="pl-smi">clientCertInPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportSelfSignedCertificatePfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">client</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>client.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">clientCertInPfxBtyes</span>);</pre></div><h3><a id="user-content-exporting-chained-certificates" class="anchor" aria-hidden="true" href="#exporting-chained-certificates"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exporting chained certificates</h3><div class="highlight highlight-source-cs"><pre><span class="pl-k">string</span><span class="pl-smi">password</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>;
<span class="pl-k">var</span><span class="pl-smi">importExportCertificate</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">rootCertInPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportRootPfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">rootCaL1</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>localhost_root_l1.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">rootCertInPfxBtyes</span>);

<span class="pl-k">var</span><span class="pl-smi">rootPublicKey</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportCertificatePublicKey</span>(<span class="pl-smi">rootCaL1</span>);
<span class="pl-k">var</span><span class="pl-smi">rootPublicKeyBytes</span><span class="pl-k">=</span><span class="pl-smi">rootPublicKey</span>.<span class="pl-en">Export</span>(<span class="pl-smi">X509ContentType</span>.<span class="pl-smi">Cert</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">$"</span>localhost_root_l1.cer<span class="pl-pds">"</span></span>, <span class="pl-smi">rootPublicKeyBytes</span>);

<span class="pl-k">var</span><span class="pl-smi">intermediateCertInPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportChainedCertificatePfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">intermediateCaL2</span>, <span class="pl-smi">rootCaL1</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>localhost_intermediate_l2.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">intermediateCertInPfxBtyes</span>);

<span class="pl-k">var</span><span class="pl-smi">serverCertL3InPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportChainedCertificatePfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">serverL3</span>, <span class="pl-smi">intermediateCaL2</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>serverl3.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">serverCertL3InPfxBtyes</span>);

<span class="pl-k">var</span><span class="pl-smi">clientCertL3InPfxBtyes</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportChainedCertificatePfx</span>(<span class="pl-smi">password</span>, <span class="pl-smi">clientL3</span>, <span class="pl-smi">intermediateCaL2</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">"</span>clientl3.pfx<span class="pl-pds">"</span></span>, <span class="pl-smi">clientCertL3InPfxBtyes</span>);</pre></div><h3><a id="user-content-exporting-verify-certificates" class="anchor" aria-hidden="true" href="#exporting-verify-certificates"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exporting verify certificates</h3><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">createClientServerAuthCerts</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesClientServerAuth</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">importExportCertificate</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">root</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">X509Certificate2</span>(<span class="pl-s"><span class="pl-pds">"</span>root.pfx<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>);

<span class="pl-k">var</span><span class="pl-smi">deviceVerify</span><span class="pl-k">=</span><span class="pl-smi">createClientServerAuthCerts</span>.<span class="pl-en">NewDeviceVerificationCertificate</span>(
<span class="pl-s"><span class="pl-pds">"</span>4C8C754C6DA4280DBAB7FC7BB320E7FFFB7F411CBB7EAA7D<span class="pl-pds">"</span></span>, <span class="pl-smi">root</span>);
<span class="pl-smi">deviceVerify</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>device verify<span class="pl-pds">"</span></span>;

<span class="pl-k">var</span><span class="pl-smi">deviceVerifyPEM</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">PemExportPublicKeyCertificate</span>(<span class="pl-smi">deviceVerify</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllText</span>(<span class="pl-s"><span class="pl-pds">"</span>deviceVerify.pem<span class="pl-pds">"</span></span>, <span class="pl-smi">deviceVerifyPEM</span>);

<span class="pl-k">var</span><span class="pl-smi">deviceVerifyPublicKey</span><span class="pl-k">=</span><span class="pl-smi">importExportCertificate</span>.<span class="pl-en">ExportCertificatePublicKey</span>(<span class="pl-smi">deviceVerify</span>);
<span class="pl-k">var</span><span class="pl-smi">deviceVerifyPublicKeyBytes</span><span class="pl-k">=</span><span class="pl-smi">deviceVerifyPublicKey</span>.<span class="pl-en">Export</span>(<span class="pl-smi">X509ContentType</span>.<span class="pl-smi">Cert</span>);
<span class="pl-smi">File</span>.<span class="pl-en">WriteAllBytes</span>(<span class="pl-s"><span class="pl-pds">$"</span>deviceVerify.cer<span class="pl-pds">"</span></span>, <span class="pl-smi">deviceVerifyPublicKeyBytes</span>);</pre></div><h2><a id="user-content-exporting-importing-pem" class="anchor" aria-hidden="true" href="#exporting-importing-pem"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exporting Importing PEM</h2><p>RSA</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">sp</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">ccRsa</span><span class="pl-k">=</span><span class="pl-smi">sp</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesRsa</span>&gt;();
<span class="pl-k">var</span><span class="pl-smi">iec</span><span class="pl-k">=</span><span class="pl-smi">sp</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">rsaCert</span><span class="pl-k">=</span><span class="pl-smi">ccRsa</span>.<span class="pl-en">CreateDevelopmentCertificate</span>(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">2</span>, <span class="pl-c1">2048</span>);

<span class="pl-c"><span class="pl-c">//</span> export</span><span class="pl-k">var</span><span class="pl-smi">publicKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemExportPublicKeyCertificate</span>(<span class="pl-smi">rsaCert</span>);
<span class="pl-k">var</span><span class="pl-smi">rsaPrivateKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemExportRsaPrivateKey</span>(<span class="pl-smi">rsaCert</span>);

<span class="pl-c"><span class="pl-c">//</span> import</span><span class="pl-k">var</span><span class="pl-smi">roundTripPublicKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemImportCertificate</span>(<span class="pl-smi">publicKeyPem</span>);
<span class="pl-k">var</span><span class="pl-smi">roundTripRsaPrivateKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemImportPrivateKey</span>(<span class="pl-smi">rsaPrivateKeyPem</span>);

<span class="pl-k">var</span><span class="pl-smi">roundTripFullCert</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">CreateCertificateWithPrivateKey</span>(
        <span class="pl-smi">roundTripPublicKeyPem</span>, 
        <span class="pl-smi">roundTripRsaPrivateKeyPem</span>, 
        <span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>);
</pre></div><p>ECDsa</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">sp</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">cc</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificatesClientServerAuth</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">root</span><span class="pl-k">=</span><span class="pl-smi">cc</span>.<span class="pl-en">NewRootCertificate</span>(
    <span class="pl-k">new</span><span class="pl-en">DistinguishedName</span> { <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>root dev<span class="pl-pds">"</span></span>, <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>IT<span class="pl-pds">"</span></span> },
    <span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span> { <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>, <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>) },
    <span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>);
<span class="pl-smi">root</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement root L1 certificate<span class="pl-pds">"</span></span>;

<span class="pl-k">var</span><span class="pl-smi">iec</span><span class="pl-k">=</span><span class="pl-smi">sp</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">ImportExportCertificate</span>&gt;();

<span class="pl-c"><span class="pl-c">//</span> export</span><span class="pl-k">var</span><span class="pl-smi">publicKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemExportPublicKeyCertificate</span>(<span class="pl-smi">root</span>);
<span class="pl-k">var</span><span class="pl-smi">eCDsaPrivateKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemExportECPrivateKey</span>(<span class="pl-smi">root</span>);

<span class="pl-c"><span class="pl-c">//</span> import</span><span class="pl-k">var</span><span class="pl-smi">roundTripPublicKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemImportCertificate</span>(<span class="pl-smi">publicKeyPem</span>);
<span class="pl-k">var</span><span class="pl-smi">roundTripECPrivateKeyPem</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">PemImportPrivateKey</span>(<span class="pl-smi">eCDsaPrivateKeyPem</span>);

<span class="pl-k">var</span><span class="pl-smi">roundTripFullCert</span><span class="pl-k">=</span><span class="pl-smi">iec</span>.<span class="pl-en">CreateCertificateWithPrivateKey</span>(
        <span class="pl-smi">roundTripPublicKeyPem</span>, 
        <span class="pl-smi">roundTripECPrivateKeyPem</span>, 
        <span class="pl-s"><span class="pl-pds">"</span>1234<span class="pl-pds">"</span></span>);
</pre></div><h2><a id="user-content-general-certificates-full-apis" class="anchor" aria-hidden="true" href="#general-certificates-full-apis"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>General Certificates, full APIs</h2><h3><a id="user-content-self-signed-certificate" class="anchor" aria-hidden="true" href="#self-signed-certificate"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Self signed certificate</h3><p>Creating a self signed certificate using <strong>NewECDsaSelfSignedCertificate</strong> with ECDsa</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">enhancedKeyUsages</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">OidCollection</span> {
    <span class="pl-k">new</span><span class="pl-en">Oid</span>(<span class="pl-s"><span class="pl-pds">"</span>1.3.6.1.5.5.7.3.2<span class="pl-pds">"</span></span>), <span class="pl-c"><span class="pl-c">//</span> TLS Client auth</span><span class="pl-k">new</span><span class="pl-en">Oid</span>(<span class="pl-s"><span class="pl-pds">"</span>1.3.6.1.5.5.7.3.1<span class="pl-pds">"</span></span>)  <span class="pl-c"><span class="pl-c">//</span> TLS Server auth</span>
};

<span class="pl-k">var</span><span class="pl-smi">createCertificates</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificates</span>&gt;();

<span class="pl-c"><span class="pl-c">//</span> Create the root self signed cert</span><span class="pl-k">var</span><span class="pl-smi">rootCert</span><span class="pl-k">=</span><span class="pl-smi">createCertificates</span>.<span class="pl-en">NewECDsaSelfSignedCertificate</span>(
    <span class="pl-smi">RootCertConfig</span>.<span class="pl-smi">DistinguishedName</span>,
    <span class="pl-smi">RootCertConfig</span>.<span class="pl-smi">BasicConstraints</span>,
    <span class="pl-smi">RootCertConfig</span>.<span class="pl-smi">ValidityPeriod</span>,
    <span class="pl-smi">RootCertConfig</span>.<span class="pl-smi">SubjectAlternativeName</span>,
    <span class="pl-smi">enhancedKeyUsages</span>,
    <span class="pl-smi">RootCertConfig</span>.<span class="pl-smi">X509KeyUsageFlags</span>,
    <span class="pl-k">new</span><span class="pl-en">ECDsaConfiguration</span>());

<span class="pl-smi">rootCert</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>localhost root l1<span class="pl-pds">"</span></span>;</pre></div><p>Certificate configuration for a self signed root</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-k">class</span><span class="pl-en">RootCertConfig</span>
{
    <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">DistinguishedName</span><span class="pl-smi">DistinguishedName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">DistinguishedName</span>
    {
        <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>,
        <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span>,
        <span class="pl-smi">Locality</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span>,
        <span class="pl-smi">Organisation</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>damienbod<span class="pl-pds">"</span></span>,
        <span class="pl-smi">OrganisationUnit</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>developement<span class="pl-pds">"</span></span>
    };

    <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">BasicConstraints</span><span class="pl-smi">BasicConstraints</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">BasicConstraints</span>
    {
        <span class="pl-smi">CertificateAuthority</span><span class="pl-k">=</span><span class="pl-c1">true</span>,
        <span class="pl-smi">HasPathLengthConstraint</span><span class="pl-k">=</span><span class="pl-c1">true</span>,
        <span class="pl-smi">PathLengthConstraint</span><span class="pl-k">=</span><span class="pl-c1">3</span>,
        <span class="pl-smi">Critical</span><span class="pl-k">=</span><span class="pl-c1">true</span>
    };

    <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">ValidityPeriod</span><span class="pl-smi">ValidityPeriod</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span>
    {
        <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>,
        <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>)
    };

    <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">SubjectAlternativeName</span><span class="pl-smi">SubjectAlternativeName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">SubjectAlternativeName</span>
    {
        <span class="pl-smi">Email</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>damienbod@damienbod.ch<span class="pl-pds">"</span></span>,
        <span class="pl-smi">DnsName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">List</span>&lt;<span class="pl-k">string</span>&gt;
        {
            <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>test.damienbod.ch<span class="pl-pds">"</span></span>
        }
    };

    <span class="pl-c"><span class="pl-c">//</span> Only X509KeyUsageFlags.KeyCertSign required for client server auth</span><span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">X509KeyUsageFlags</span><span class="pl-smi">X509KeyUsageFlags</span><span class="pl-k">=</span><span class="pl-smi">X509KeyUsageFlags</span>.<span class="pl-smi">DigitalSignature</span><span class="pl-k">|</span><span class="pl-smi">X509KeyUsageFlags</span>.<span class="pl-smi">KeyEncipherment</span><span class="pl-k">|</span><span class="pl-smi">X509KeyUsageFlags</span>.<span class="pl-smi">KeyCertSign</span>;
    }</pre></div><h3><a id="user-content-chained-certificate" class="anchor" aria-hidden="true" href="#chained-certificate"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Chained certificate</h3><p>Creating a certificate using <strong>NewECDsaChainedCertificate</strong> using ECDsa</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">serviceProvider</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ServiceCollection</span>()
    .<span class="pl-en">AddCertificateManager</span>()
    .<span class="pl-en">BuildServiceProvider</span>();

<span class="pl-k">var</span><span class="pl-smi">enhancedKeyUsages</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">OidCollection</span> {
    <span class="pl-k">new</span><span class="pl-en">Oid</span>(<span class="pl-s"><span class="pl-pds">"</span>1.3.6.1.5.5.7.3.2<span class="pl-pds">"</span></span>), <span class="pl-c"><span class="pl-c">//</span> TLS Client auth</span><span class="pl-k">new</span><span class="pl-en">Oid</span>(<span class="pl-s"><span class="pl-pds">"</span>1.3.6.1.5.5.7.3.1<span class="pl-pds">"</span></span>)  <span class="pl-c"><span class="pl-c">//</span> TLS Server auth</span>
};

<span class="pl-k">var</span><span class="pl-smi">createCertificates</span><span class="pl-k">=</span><span class="pl-smi">serviceProvider</span>.<span class="pl-en">GetService</span>&lt;<span class="pl-en">CreateCertificates</span>&gt;();

<span class="pl-k">var</span><span class="pl-smi">deviceCertificate</span><span class="pl-k">=</span><span class="pl-smi">createCertificates</span>.<span class="pl-en">NewECDsaChainedCertificate</span>(
    <span class="pl-smi">DeviceCertConfig</span>.<span class="pl-smi">DistinguishedName</span>,
    <span class="pl-smi">DeviceCertConfig</span>.<span class="pl-smi">BasicConstraints</span>,
    <span class="pl-smi">DeviceCertConfig</span>.<span class="pl-smi">ValidityPeriod</span>,
    <span class="pl-smi">DeviceCertConfig</span>.<span class="pl-smi">SubjectAlternativeName</span>,
    <span class="pl-smi">intermediateCertificateLevel3</span>,
    <span class="pl-smi">enhancedKeyUsages</span>,
    <span class="pl-smi">DeviceCertConfig</span>.<span class="pl-smi">X509KeyUsageFlags</span>,
    <span class="pl-k">new</span><span class="pl-en">ECDsaConfiguration</span>());

<span class="pl-smi">deviceCertificate</span>.<span class="pl-smi">FriendlyName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>device cert l4<span class="pl-pds">"</span></span>;</pre></div><p>Device certificate chained</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-k">class</span><span class="pl-en">DeviceCertConfig</span>
    {
        <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">DistinguishedName</span><span class="pl-smi">DistinguishedName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">DistinguishedName</span>
        {
            <span class="pl-smi">CommonName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>,
            <span class="pl-smi">Country</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span>,
            <span class="pl-smi">Locality</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span>,
            <span class="pl-smi">Organisation</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>firma x<span class="pl-pds">"</span></span>,
            <span class="pl-smi">OrganisationUnit</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>skills<span class="pl-pds">"</span></span>
        };

        <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">BasicConstraints</span><span class="pl-smi">BasicConstraints</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">BasicConstraints</span>
        {
            <span class="pl-smi">CertificateAuthority</span><span class="pl-k">=</span><span class="pl-c1">false</span>,
            <span class="pl-smi">HasPathLengthConstraint</span><span class="pl-k">=</span><span class="pl-c1">false</span>,
            <span class="pl-smi">PathLengthConstraint</span><span class="pl-k">=</span><span class="pl-c1">0</span>,
            <span class="pl-smi">Critical</span><span class="pl-k">=</span><span class="pl-c1">true</span>
        };

        <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">ValidityPeriod</span><span class="pl-smi">ValidityPeriod</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">ValidityPeriod</span>
        {
            <span class="pl-smi">ValidFrom</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>,
            <span class="pl-smi">ValidTo</span><span class="pl-k">=</span><span class="pl-smi">DateTime</span>.<span class="pl-smi">UtcNow</span>.<span class="pl-en">AddYears</span>(<span class="pl-c1">10</span>)
        };

        <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">SubjectAlternativeName</span><span class="pl-smi">SubjectAlternativeName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">SubjectAlternativeName</span>
        {
            <span class="pl-smi">DnsName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">List</span>&lt;<span class="pl-k">string</span>&gt;
            {
                <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>
            }
        };

        <span class="pl-k">public</span><span class="pl-k">static</span><span class="pl-en">X509KeyUsageFlags</span><span class="pl-smi">X509KeyUsageFlags</span><span class="pl-k">=</span><span class="pl-smi">X509KeyUsageFlags</span>.<span class="pl-smi">DigitalSignature</span><span class="pl-k">|</span><span class="pl-smi">X509KeyUsageFlags</span>.<span class="pl-smi">KeyEncipherment</span>;
    }</pre></div><h2><a id="user-content-certificate-configuration-full-apis" class="anchor" aria-hidden="true" href="#certificate-configuration-full-apis"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Certificate Configuration full APIs</h2><h3><a id="user-content-basic-constraints" class="anchor" aria-hidden="true" href="#basic-constraints"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Constraints</h3><p>basic constraints for intermediate and root certificates. Set the path length to match the chain length.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">basicConstraints</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">BasicConstraints</span>
{
    <span class="pl-smi">CertificateAuthority</span><span class="pl-k">=</span><span class="pl-c1">true</span>,
    <span class="pl-smi">HasPathLengthConstraint</span><span class="pl-k">=</span><span class="pl-c1">true</span>,
    <span class="pl-smi">PathLengthConstraint</span><span class="pl-k">=</span><span class="pl-smi">pathLengthConstraint</span>,
    <span class="pl-smi">Critical</span><span class="pl-k">=</span><span class="pl-c1">true</span>
};</pre></div><p>Or the basic constaints for a device, client or server certificate.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">basicConstraints</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">BasicConstraints</span>
{
    <span class="pl-smi">CertificateAuthority</span><span class="pl-k">=</span><span class="pl-c1">false</span>,
    <span class="pl-smi">HasPathLengthConstraint</span><span class="pl-k">=</span><span class="pl-c1">false</span>,
    <span class="pl-smi">PathLengthConstraint</span><span class="pl-k">=</span><span class="pl-c1">0</span>,
    <span class="pl-smi">Critical</span><span class="pl-k">=</span><span class="pl-c1">true</span>
};</pre></div><h3><a id="user-content-subject-alternative-name" class="anchor" aria-hidden="true" href="#subject-alternative-name"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Subject Alternative Name</h3><p>Add the required or supported DnsName or the Email here.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">subjectAlternativeName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">SubjectAlternativeName</span>
{
    <span class="pl-smi">DnsName</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">List</span>&lt;<span class="pl-k">string</span>&gt;
    {
        <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>
    }
};</pre></div><h3><a id="user-content-enhanced-key-usages" class="anchor" aria-hidden="true" href="#enhanced-key-usages"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enhanced Key Usages</h3><p>Defines how the certificate key can be used.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">enhancedKeyUsages</span><span class="pl-k">=</span><span class="pl-k">new</span><span class="pl-en">OidCollection</span> {
    <span class="pl-k">new</span><span class="pl-en">Oid</span>(<span class="pl-s"><span class="pl-pds">"</span>1.3.6.1.5.5.7.3.2<span class="pl-pds">"</span></span>), <span class="pl-c"><span class="pl-c">//</span> TLS Client auth</span><span class="pl-k">new</span><span class="pl-en">Oid</span>(<span class="pl-s"><span class="pl-pds">"</span>1.3.6.1.5.5.7.3.1<span class="pl-pds">"</span></span>)  <span class="pl-c"><span class="pl-c">//</span> TLS Server auth</span>
};</pre></div><ul><li>new Oid("1.3.6.1.5.5.7.3.1")  // TLS Server auth</li><li>new Oid("1.3.6.1.5.5.7.3.2")  // TLS Client auth</li><li>new Oid("1.3.6.1.5.5.7.3.3")  // Code signing</li><li>new Oid("1.3.6.1.5.5.7.3.4")  // Email</li><li>new Oid("1.3.6.1.5.5.7.3.8")  // Timestamping</li></ul><h3><a id="user-content-x509-key-usage-flags" class="anchor" aria-hidden="true" href="#x509-key-usage-flags"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>X509 Key Usage Flags</h3><p>Defines how the certificate key can be used.</p><div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span><span class="pl-smi">x509KeyUsageFlags</span><span class="pl-k">=</span><span class="pl-smi">X509KeyUsageFlags</span>.<span class="pl-smi">DigitalSignature</span><span class="pl-k">|</span><span class="pl-smi">X509KeyUsageFlags</span>.<span class="pl-smi">KeyEncipherment</span>;</pre></div><ul><li>None             No key usage parameters.</li><li>EncipherOnly     The key can be used for encryption only.</li><li>CrlSign          The key can be used to sign a certificate revocation list (CRL).</li><li>KeyCertSign      The key can be used to sign certificates.</li><li>KeyAgreement     The key can be used to determine key agreement, such as a key created using the Diffie-Hellman key agreement algorithm.</li><li>DataEncipherment The key can be used for data encryption.</li><li>KeyEncipherment  The key can be used for key encryption.</li><li>NonRepudiation   The key can be used for authentication.</li><li>DecipherOnly     The key can be used for decryption only.</li></ul></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>