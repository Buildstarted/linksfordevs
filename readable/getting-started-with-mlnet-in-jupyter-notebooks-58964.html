<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Getting started with ML.NET in Jupyter Notebooks - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Getting started with ML.NET in Jupyter Notebooks - linksfor.dev(s)"/>
    <meta property="article:author" content="by xamlbrewer"/>
    <meta property="og:description" content="For many years .NET developers have been building classic console, desktop or web applications through a stop-modify-recompile-restart cycle. In machine learning and other data-centric tasks this c&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://xamlbrewer.wordpress.com/2020/02/20/getting-started-with-ml-net-in-jupyter-notebooks/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Getting started with ML.NET in Jupyter Notebooks</title>
<div class="readable">
        <h1>Getting started with ML.NET in Jupyter Notebooks</h1>
            <div>by by xamlbrewer</div>
            <div>Reading time: 11-14 minutes</div>
        <div>Posted here: 25 Feb 2020</div>
        <p><a href="https://xamlbrewer.wordpress.com/2020/02/20/getting-started-with-ml-net-in-jupyter-notebooks/">https://xamlbrewer.wordpress.com/2020/02/20/getting-started-with-ml-net-in-jupyter-notebooks/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
			<p data-adtags-visited="true">For many years .NET developers have been building classic console, desktop or web applications through a stop-modify-recompile-restart cycle. In machine learning and other data-centric tasks this cycle creates so much overhead an delay that it simply doesn’t make sense. Data scientists involved in data analysis, data preparation, and model training prefer a fully interactive environment that allows mixing content, live source code, and program output in a single (web) page that gives immediate feedback when the data or the code changes. </p>
<p data-adtags-visited="true">The <a href="https://jupyter.readthedocs.io/en/latest/" target="_blank">Jupyter ecosystem</a> provides such an interactive environment, and there’s good news for .NET developers. The list of language kernels supported by Jupyter -including Python, R, Julia, Matlab and many others- has been extended with .NET Core. </p>
<p data-adtags-visited="true">The Jupyter Notebook app enables us today to run on-premise interactive machine learning scenarios with <span>ML.NET</span> using C# or F# in a web browser, without bringing software or hardware costs. In this article we try to get you started with developing and running C# machine learning scenarios in Jupyter notebooks. We’re going to assume that you already know the basics of <span>ML.NET</span>.</p>
<h2>Installation</h2>
<h3>Download</h3>
<p data-adtags-visited="true">There are many ways to install the environment, but you’ll always need these two ingredients:</p>
<ul>
<li>the <a href="https://jupyter-notebook-beginner-guide.readthedocs.io/" target="_blank">Jupiter Notebook</a> (a Python program), and
</li><li><a href="https://github.com/dotnet/interactive" target="_blank">dotnet interactive</a> (formerly known as dotnet try), an version of the .NET Core runtime that allows you to run C# and F# as a scripting language.</li>
</ul>
<p data-adtags-visited="true">Here’s probably the easiest way get operational – although leaner procedures may exist:</p>
<ol>
<li>Install the latest <a href="https://docs.anaconda.com/anaconda/user-guide/getting-started/" target="_blank">Anaconda</a>:<br><a href="https://xamlbrewer.files.wordpress.com/2020/02/anaconda.png"><img title="Anaconda" alt="Anaconda" src="https://xamlbrewer.files.wordpress.com/2020/02/anaconda_thumb.png?w=625"></a>
</li><li>Install the latest <a href="https://dotnet.microsoft.com/download" target="_blank">.NET Core SDK</a>:<br><a href="https://xamlbrewer.files.wordpress.com/2020/02/netsdk.png"><img title="NetSdk" alt="NetSdk" src="https://xamlbrewer.files.wordpress.com/2020/02/netsdk_thumb.png?w=625"></a></li>
</ol>
<h3>Configure</h3>
<p data-adtags-visited="true">On the command line, type the following to install dotnet interactive as a global tool:</p>
<blockquote>
<p><em>dotnet tool install -g dotnet-try</em></p>
</blockquote>
<p data-adtags-visited="true">Open the Anaconda Prompt and run the following command to register the .NET kernel in Jupyter:</p>
<blockquote>
<p><em>dotnet try jupyter install</em></p>
</blockquote>
<h3>Validate</h3>
<p data-adtags-visited="true">To verify the installation:</p>
<ul>
<li>open the Anaconda3 menu from the start menu,
</li><li>start the Jupyter Notebook app, and
</li><li>press the ‘new’ button in the top right corner to create a new Notebook.</li>
</ul>
<p data-adtags-visited="true">If <em>.NET C#</em> and <em>.NET F#</em> appear in the list of kernels, then you’re ready to go:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/netkernels.png"><img title="NetKernels" alt="NetKernels" src="https://xamlbrewer.files.wordpress.com/2020/02/netkernels_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">You find the most recent installation guide <a href="https://github.com/dotnet/interactive#Install" target="_blank">right here</a>.</p>
<h2>First steps</h2>
<h3>Fire it up</h3>
<p data-adtags-visited="true">Starting a Notebook spawns a language kernel process with two clients</p>
<ul>
<li>a browser with the IDE to edit and run notebooks, and
</li><li>a terminal window displaying the logs of the associated kernel.</li>
</ul>
<p data-adtags-visited="true">Here’ what to expect on your screen:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/notebookandserver.png"><img title="NotebookAndServer" alt="NotebookAndServer" src="https://xamlbrewer.files.wordpress.com/2020/02/notebookandserver_thumb.png?w=625"></a></p>
<h3>Hello World</h3>
<p data-adtags-visited="true">The browser IDE allows you to maintain a list of so-called <em>cells</em>. Each of these that can host documentation (markup or markdown) or source code (in the language of the <em>kernel</em> you selected). </p>
<p data-adtags-visited="true">Jupyter Notebooks code cells accept regular C#. Each cell can be individually ran, while the kernel keeps track of the state. </p>
<p data-adtags-visited="true">It’s safe to assume that the canonical “Hello World” would look like this:<br><a href="https://xamlbrewer.files.wordpress.com/2020/02/helloworld1-1.png"><img title="HelloWorld1" alt="HelloWorld1" src="https://xamlbrewer.files.wordpress.com/2020/02/helloworld1_thumb-1.png?w=625"></a></p>
<p data-adtags-visited="true">The C# kernel hosts extra functions to control the output of cells, such as the ‘display()’ function:<br><a href="https://xamlbrewer.files.wordpress.com/2020/02/helloworld2-1.png"><img title="HelloWorld2" alt="HelloWorld2" src="https://xamlbrewer.files.wordpress.com/2020/02/helloworld2_thumb-1.png?w=625"></a></p>
<p data-adtags-visited="true"><em>Display()</em> is more than just syntactic sugar for <em>Console.WriteLine()</em>. It can also render HTML, SVG, and Charts. There’s more info on this function <a href="https://github.com/dotnet/interactive/blob/master/NotebookExamples/csharp/Docs/Displaying%20output.ipynb" target="_blank">right here</a>.</p>
<p data-adtags-visited="true">Jupyter Notebook runs a <em>Read-Eval-Print Loop</em> (a.k.a. REPL). Instructions are executed, and expressions are evaluated against the current state that is maintained in and by the kernel. So instead of an instruction to print a string, you can simply type “Hello World” in a cell (without a semicolon). It will we treated as an expression:<br><a href="https://xamlbrewer.files.wordpress.com/2020/02/helloworld3-1.png"><img title="HelloWorld3" alt="HelloWorld3" src="https://xamlbrewer.files.wordpress.com/2020/02/helloworld3_thumb-1.png?w=625"></a></p>
<h3>Loading NuGet packages</h3>
<p data-adtags-visited="true">Code cells in Jupyter Notebooks can host instructions, expressions, class definitions and functions, but you can also load dll’s from NuGet packages. The <em>#r</em> instruction loads a NuGet package into the kernel:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/nuget-1.png"><img title="NuGet" alt="NuGet" src="https://xamlbrewer.files.wordpress.com/2020/02/nuget_thumb-1.png?w=625"></a></p>

<p data-adtags-visited="true"><em>#r</em> and <em>using</em> statements do not have to be written at the top of the document – you can just add them whenever you need them in the notebook.</p>
<h2>Doing diagrams</h2>
<p data-adtags-visited="true">One of the NuGet packages that you definitely want to use is <a href="https://github.com/fslaborg/XPlot" target="_blank">XPlot</a>, a data visualization framework written in F#. It allows you create a huge number of chart types delegating the rendering to well-known open source graphing libraries such as <a href="https://plot.ly/graphing-libraries/" target="_blank">Plotly</a> and <a href="https://developers.google.com/chart/" target="_blank">Google Charts</a>. </p>
<p data-adtags-visited="true">Here’s how easy it is to define and render a chart in a C# Jupyter Notebook:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/xplotsample.png"><img title="XPlotSample" alt="XPlotSample" src="https://xamlbrewer.files.wordpress.com/2020/02/xplotsample_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">You’ll find many more examples <a href="https://github.com/dotnet/interactive/blob/master/NotebookExamples/csharp/Docs/Plotting%20with%20Xplot.ipynb" target="_blank">here</a>.</p>
<h2>Running a Canonical Machine Learning Scenario</h2>
<p data-adtags-visited="true">Over the last couple of months we have been busy creating an elaborated set of machine learning scenario’s in a <a href="https://github.com/XamlBrewer/UWP-MachineLearning-Sample" target="_blank">UWP sample app</a>. In the last couple of weeks we managed to migrate most of these to the Jupyter Notebook, and added some new ones. </p>
<p data-adtags-visited="true">Let’s run through one of the new samples. It predicts the quality of white wine based on 11 physicochemical characteristics. The problem is solved as a regression – in our UWP sample app we solved it as a binary and a multiclass classification. </p>
<p data-adtags-visited="true">The sample runs a representative scenario of</p>
<ul>
<li>reading the raw data,
</li><li>preparing the data,
</li><li>training the model,
</li><li>calculating and visualizing the quality metrics,
</li><li>calculating and visualizing the feature contributions, and finally
</li><li>predicting.</li>
</ul>
<p data-adtags-visited="true">In this article we won’t dive into the <span>ML.NET</span> details. Here’s how the full scenario looks like in a Jupyter Notebook. :</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/regression1.png"><img title="Regression1" alt="Regression1" src="https://xamlbrewer.files.wordpress.com/2020/02/regression1_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">(some helpers were omitted here)<a href="https://xamlbrewer.files.wordpress.com/2020/02/regression2.png"><img title="Regression2" alt="Regression2" src="https://xamlbrewer.files.wordpress.com/2020/02/regression2_thumb.png?w=625"></a></p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/regression3.png"><img title="Regression3" alt="Regression3" src="https://xamlbrewer.files.wordpress.com/2020/02/regression3_thumb.png?w=625"></a></p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/regression4.png"><img title="Regression4" alt="Regression4" src="https://xamlbrewer.files.wordpress.com/2020/02/regression4_thumb.png?w=625"></a></p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/regression5.png"><img title="Regression5" alt="Regression5" src="https://xamlbrewer.files.wordpress.com/2020/02/regression5_thumb.png?w=625"></a></p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/regression6.png"><img title="Regression6" alt="Regression6" src="https://xamlbrewer.files.wordpress.com/2020/02/regression6_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">Here’s how the <a href="https://nbviewer.jupyter.org/github/XamlBrewer/ML.NET-Jupyter-Notebooks/blob/master/notebooks/Regression/Regression.ipynb" target="_blank">full web page with source and results rendering</a> looks like.</p>
<p data-adtags-visited="true">The Jupyter Notebook provides a much more productive environment to create such a scenario than classic .NET application development does. Let’s dive into some of the reasons and take a deeper look into some Jupyter features that make the <span>ML.NET-Jupyter</span> combo attractive to data scientists.</p>
<h2>Let’s focus on Data Analysis</h2>
<h3>Interactive Diagrams</h3>
<p data-adtags-visited="true">Data analysis requires many types of diagrams, and Jupyter notebooks makes it easy to define and modify these. </p>
<p data-adtags-visited="true">Here’s how to import the <a href="https://github.com/fslaborg/XPlot" target="_blank">XPlot</a> NuGet package and render a simple interactive boxplot chart. The rendered diagram highlights the details of the element under the mouse:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/interactivediagram-1.png"><img title="InteractiveDiagram" alt="InteractiveDiagram" src="https://xamlbrewer.files.wordpress.com/2020/02/interactivediagram_thumb-1.png?w=625"></a></p>
<p data-adtags-visited="true">We created a more elaborated example of boxplot analysis <a href="https://nbviewer.jupyter.org/github/XamlBrewer/ML.NET-Jupyter-Notebooks/blob/master/notebooks/Box%20Plot/Box%20Plot.ipynb" target="_blank">right here</a>. Here’s how the resulting diagram looks like:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/complexboxplot.png"><img title="ComplexBoxPlot" alt="ComplexBoxPlot" src="https://xamlbrewer.files.wordpress.com/2020/02/complexboxplot_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">As part of Principal Component Analysis data scientists may want to draw a heat map with the correlation between different features. Here’s how easy it is to create such a chart:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/heatmap.png"><img title="HeatMap" alt="HeatMap" src="https://xamlbrewer.files.wordpress.com/2020/02/heatmap_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">We created a more elaborated example on the well-know Titanic data set <a href="https://nbviewer.jupyter.org/github/XamlBrewer/ML.NET-Jupyter-Notebooks/blob/master/notebooks/Data%20Correlation%20Chart/Data%20Correlation%20Chart.ipynb" target="_blank">right here</a>. This is the resulting diagram:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/titanicheatmap.png"><img title="TitanicHeatMap" alt="TitanicHeatMap" src="https://xamlbrewer.files.wordpress.com/2020/02/titanicheatmap_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">These diagrams and many more come out-of-the-box with XPlot.</p>
<h3>Object Formatters</h3>
<p data-adtags-visited="true">Just as developers, data scientists spend most of their time debugging. They continuously need detailed feedback on the work in progress. We already encountered the new <em>display()</em> function that prints the value of an expression. Jupyter notebooks allow you to override the HTML that is printed for a specific class by registering an <a href="https://github.com/dotnet/interactive/blob/master/NotebookExamples/csharp/Docs/Object%20formatters.ipynb" target="_blank">ObjectFormatter</a> – something that sits between decorating a class with the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.debuggerdisplayattribute?view=netframework-4.8" target="_blank">DebuggerDisplay</a> attribute and writing a custom <a href="https://docs.microsoft.com/en-us/visualstudio/debugger/create-custom-visualizers-of-data?view=vs-2019" target="_blank">debugger visualizer</a>. </p>
<p data-adtags-visited="true">Let’s write a small –but very useful- example. Here’s how an instance of a <span>ML.NET</span> <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.ml.data.confusionmatrix?view=ml-dotnet" target="_blank">ConfusionMatrix</a> is displayed by default:<br><a href="https://xamlbrewer.files.wordpress.com/2020/02/confusionmatrix1.png"><img title="ConfusionMatrix1" alt="ConfusionMatrix1" src="https://xamlbrewer.files.wordpress.com/2020/02/confusionmatrix1_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">That’s pretty confusing, right? [Yes: pun intended!] Let’s fix this.</p>
<p data-adtags-visited="true">The few ObjectFormatter examples that we already encountered, were spawning <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.html.ihtmlcontent?view=aspnetcore-3.1" target="_blank">IHtmlContent</a> instances (from <span>ASP.NET</span> Core) that were created and styled through the so-called PocketView API – for which there is no documentation yet. Here’s how to fetch the list of HTML tags that you can create with it, and a small sample on how to apply a style to them:</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:b1b731fc-1016-4012-ad4a-6553bbaa282a">
<pre><div><div id="highlighter_539252"><div><div><p><code>var</code> <code>pocketViewTagMethods = </code><code>typeof</code><code>(PocketViewTags)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>.GetProperties()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>.Select(m =&gt; m.Name);</code></p><p><code>display(pocketViewTagMethods);</code></p><p><code>var</code> <code>pocketView = table[style: </code><code>"width: 100%"</code><code>](tr(td[style:</code><code>"border: 1px solid black"</code><code>](</code><code>"Hello!"</code><code>)));</code></p><p><code>display(pocketView);</code></p></div></div></div></div>
</pre></div>
<p data-adtags-visited="true">Here’s the result:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/pocketview.png"><img title="PocketView" alt="PocketView" src="https://xamlbrewer.files.wordpress.com/2020/02/pocketview_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">Here’s how to register a formatter that nicely displays a table with the look-and-feel that a data analyst expects for a (binary!) confusion matrix:</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:0c4baf6a-9919-4183-bd99-71ef484a287e">
<pre><div><div id="highlighter_867982"><div><div><p><code>Formatter&lt;ConfusionMatrix&gt;.Register((df, writer) =&gt;</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var</code> <code>rows = </code><code>new</code> <code>List&lt;IHtmlContent&gt;();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var</code> <code>cells = </code><code>new</code> <code>List&lt;IHtmlContent&gt;();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var</code> <code>n = df.Counts[0][0] + df.Counts[0][1] + df.Counts[1][0] + df.Counts[1][1];</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[rowspan: 2, colspan: 2, style: </code><code>"text-align: center; background-color: transparent"</code><code>](</code><code>"n = "</code> <code>+ n));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[colspan: 2, style: </code><code>"border: 1px solid black; text-align: center; padding: 24px; background-color: lightsteelblue"</code><code>](b(</code><code>"Predicted"</code><code>)));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>rows.Add(tr[style: </code><code>"background-color: transparent"</code><code>](cells));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells = </code><code>new</code> <code>List&lt;IHtmlContent&gt;();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; padding: 24px; background-color: #E3EAF3"</code><code>](b(</code><code>"True"</code><code>)));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; padding: 24px; background-color: #E3EAF3"</code><code>](b(</code><code>"False"</code><code>)));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>rows.Add(tr[style: </code><code>"background-color: transparent"</code><code>](cells));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells = </code><code>new</code> <code>List&lt;IHtmlContent&gt;();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[rowspan: 2, style:</code><code>"border: 1px solid black; text-align: center; padding: 24px;&nbsp; background-color: lightsteelblue"</code><code>](b(</code><code>"Actual"</code><code>)));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; text-align: center; padding: 24px; background-color: #E3EAF3"</code><code>](b(</code><code>"True"</code><code>)));&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; padding: 24px"</code><code>](df.Counts[0][0]));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; padding: 24px"</code><code>](df.Counts[0][1]));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>rows.Add(tr[style: </code><code>"background-color: transparent"</code><code>](cells));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells = </code><code>new</code> <code>List&lt;IHtmlContent&gt;();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; text-align: center; padding: 24px; background-color: #E3EAF3"</code><code>](b(</code><code>"False"</code><code>)));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; padding: 24px"</code><code>](df.Counts[1][0]));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>cells.Add(td[style:</code><code>"border: 1px solid black; padding: 24px"</code><code>](df.Counts[1][1]));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>rows.Add(tr(cells));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var</code> <code>t = table(</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>tbody(</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>rows));</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>writer.Write(t);</code></p><p><code>}, </code><code>"text/html"</code><code>);</code></p></div></div></div></div>
</pre></div>
<p data-adtags-visited="true">Here’s how a confusion matrix now looks like – much more intuitive:<br><a href="https://xamlbrewer.files.wordpress.com/2020/02/confusionmatrix2.png"><img title="ConfusionMatrix2" alt="ConfusionMatrix2" src="https://xamlbrewer.files.wordpress.com/2020/02/confusionmatrix2_thumb.png?w=625"></a></p>
<h3>DataFrame</h3>
<p data-adtags-visited="true">It’s not always easy to prepare the data for a machine learning pipeline or a diagram, and this is where the new <a href="https://devblogs.microsoft.com/dotnet/an-introduction-to-dataframe/" target="_blank">DataFrame API</a> comes in. DataFrame allows you to manipulate tabular in-memory data in a spreadsheet way: you can select, add, and/or filter rows and columns, apply formulas and so on. Here’s how to pull in the NuGet package, and add a custom formatter for the base class. DataFrame is currently only in version 0.2 so you may expect some changes. You may also expect the object formatters to be embedded in future releases:</p>

<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/dataframe1.png"><img title="DataFrame1" alt="DataFrame1" src="https://xamlbrewer.files.wordpress.com/2020/02/dataframe1_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">The DataFrame class knows how to <a href="https://github.com/dotnet/corefxlab/blob/master/src/Microsoft.Data.Analysis/DataFrame.IO.cs" target="_blank">read input data from a CSV</a>:</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/dataframe2.png"><img title="DataFrame2" alt="DataFrame2" src="https://xamlbrewer.files.wordpress.com/2020/02/dataframe2_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">In our <a href="https://nbviewer.jupyter.org/github/XamlBrewer/ML.NET-Jupyter-Notebooks/blob/master/notebooks/Binary%20Classification/Binary%20Classification.ipynb" target="_blank">binary classification sample</a> we use some of the DataFrame methods to replace the “Quality” column holding the taster’s evaluation score (a number from 1 to 10) by a “Label” column with the Boolean indicating whether the wine is good or not (i.e. the score was 6 or higher). Here’s how amazingly easy this is:</p>
<div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:3761b6d6-b7fb-4d18-8ffc-919ff3af3e28">
<pre><div><div id="highlighter_158491"><div><div><p><code>var</code> <code>labelCol = trainingData[</code><code>"Quality"</code><code>].ElementwiseGreaterThanOrEqual(6);</code></p><p><code>labelCol.SetName(</code><code>"Label"</code><code>);</code></p><p><code>trainingData.Columns.Add(labelCol);</code></p><p><code>trainingData.Columns.Remove(trainingData[</code><code>"Quality"</code><code>]);</code></p></div></div></div></div>
</pre></div>
<p data-adtags-visited="true">Here’s the result (compare the last column with the one in the previous screenshot):</p>
<p data-adtags-visited="true"><a href="https://xamlbrewer.files.wordpress.com/2020/02/dataframe3.png"><img title="DataFrame3" alt="DataFrame3" src="https://xamlbrewer.files.wordpress.com/2020/02/dataframe3_thumb.png?w=625"></a></p>
<p data-adtags-visited="true">Since there’s no documentation available yet, we had to dig into the <a href="https://github.com/dotnet/corefxlab/tree/master/src/Microsoft.Data.Analysis" target="_blank">C# source code</a>. </p>
<p data-adtags-visited="true">DataFrame is a very promising new .NET API for tabular data manipulation, useful in machine learning and other scenarios.</p>
<h2>Sharing is Caring</h2>
<p data-adtags-visited="true">The source code of our Jupyter notebooks lives <a href="https://github.com/XamlBrewer/ML.NET-Jupyter-Notebooks" target="_blank">here on GitHub</a> (if you like it then you should have put a <img alt="Star" src="https://xamlbrewer.files.wordpress.com/2020/02/wlemoticon-star.png?w=625"> on it). The easiest way to explore the code and the rendered results is <a href="https://nbviewer.jupyter.org/github/XamlBrewer/ML.NET-Jupyter-Notebooks/tree/master/notebooks/" target="_blank">via nbViewer</a>.</p>
<p data-adtags-visited="true">We also invite you to take a look at these other <span>ML.NET-Jupyter</span> samples from <a href="https://github.com/dotnet/interactive/tree/master/NotebookExamples/csharp/Docs" target="_blank">Microsoft</a> and from fellow MVP <a href="https://github.com/aslotte/mlnet-jupyter" target="_blank">Alexander Slotte</a>.</p>
<p data-adtags-visited="true">Enjoy!</p>
			
			
								</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs" /></noscript>
</body>
</html>