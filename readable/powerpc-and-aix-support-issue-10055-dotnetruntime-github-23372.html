<!DOCTYPE html>
<html lang="en">
<head>
    <title>
PowerPC and AIX support &#xB7; Issue #10055 &#xB7; dotnet/runtime - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="PowerPC and AIX support &#xB7; Issue #10055 &#xB7; dotnet/runtime - linksfor.dev(s)"/>
    <meta property="article:author" content="msftgits"/>
    <meta property="og:description" content="After some research, I checked that the .net core has no supported for PowerPC or AIX ... Are there plans to implement support for the Power architecture and the AIX operating system?"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/coreclr/issues/17294"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - PowerPC and AIX support &#xB7; Issue #10055 &#xB7; dotnet/runtime</title>
<div class="readable">
        <h1>PowerPC and AIX support &#xB7; Issue #10055 &#xB7; dotnet/runtime</h1>
            <div>by msftgits</div>
            <div>Reading time: 5-7 minutes</div>
        <div>Posted here: 14 May 2019</div>
        <p><a href="https://github.com/dotnet/coreclr/issues/17294">https://github.com/dotnet/coreclr/issues/17294</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Hi <a data-hovercard-type="user" data-hovercard-url="/users/mattwarren/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/mattwarren">@mattwarren</a></p>
<blockquote>
<p>@kasper3 I wrote a post about the interpreter that you might find useful, see <a href="http://mattwarren.org/2017/03/30/The-.NET-IL-Interpreter/" rel="nofollow">The .NET IL Interpreter</a>.</p>
</blockquote>
<p>Thanks for your great blog <a href="http://mattwarren.org/2017/03/30/The-.NET-IL-Interpreter/" rel="nofollow">The .NET IL Interpreter</a>.</p>
<blockquote>
<p>But as <a data-hovercard-type="user" data-hovercard-url="/users/janvorli/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/janvorli">@janvorli</a> mentioned, work was done to make it easier to enable (so you can ignore that part of the post) see <a data-error-text="Failed to load issue title" data-id="223980119" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/coreclr/issues/11188" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/coreclr/pull/11188/hovercard" href="https://github.com/dotnet/coreclr/pull/11188">dotnet/coreclr#11188</a> and <a data-error-text="Failed to load issue title" data-id="224647156" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/coreclr/issues/11252" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/coreclr/pull/11252/hovercard" href="https://github.com/dotnet/coreclr/pull/11252">dotnet/coreclr#11252</a></p>
</blockquote>
<p>But when I migrated to the master  <a data-error-text="Failed to load issue title" data-id="442497295" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/coreclr/issues/24513" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/coreclr/pull/24513/hovercard" href="https://github.com/dotnet/coreclr/pull/24513">dotnet/coreclr#24513</a>   Interpreter seems not work:</p>
<pre><code>Histogram of method executions:
   # of execs   |   # meths (%)    |   cum % | % cum execs
   -------------------------------------------------------
            0   |       0 ( -nan%) |   -nan% |   -nan%
            1   |       0 ( -nan%) |   -nan% |   -nan%
            2   |       0 ( -nan%) |   -nan% |   -nan%
            3   |       0 ( -nan%) |   -nan% |   -nan%
            4   |       0 ( -nan%) |   -nan% |   -nan%
            5   |       0 ( -nan%) |   -nan% |   -nan%
            6   |       0 ( -nan%) |   -nan% |   -nan%
            7   |       0 ( -nan%) |   -nan% |   -nan%
            8   |       0 ( -nan%) |   -nan% |   -nan%
            9   |       0 ( -nan%) |   -nan% |   -nan%
           10   |       0 ( -nan%) |   -nan% |   -nan%

For methods sorted in ascending # of executions order, cumulative % of executions:

Total number of calls from interpreted code: 0.
    Also, 0 are intrinsics; 0 of these are not currently handled intrinsically.
    Of these, 0 to potential property getters (0 of these dead simple), 0 to setters.
    Of the dead simple getter calls, 0 have been short-circuited.

Token resolutions by category:
Category     |  opportunities  |   calls   |      %
---------------------------------------------------
   Undefined |               0 |         0 |   0.00%
 Constrained |               0 |         0 |   0.00%
      NewObj |               0 |         0 |   0.00%
      NewArr |               0 |         0 |   0.00%
     LdToken |               0 |         0 |   0.00%
       LdFtn |               0 |         0 |   0.00%
   LdVirtFtn |               0 |         0 |   0.00%
    SFldAddr |               0 |         0 |   0.00%
      LdElem |               0 |         0 |   0.00%
        Call |               0 |         0 |   0.00%
       LdObj |               0 |         0 |   0.00%
       StObj |               0 |         0 |   0.00%
       CpObj |               0 |         0 |   0.00%
     InitObj |               0 |         0 |   0.00%
      IsInst |               0 |         0 |   0.00%
   CastClass |               0 |         0 |   0.00%
    MkRefAny |               0 |         0 |   0.00%
   RefAnyVal |               0 |         0 |   0.00%
      Sizeof |               0 |         0 |   0.00%
      StElem |               0 |         0 |   0.00%
         Box |               0 |         0 |   0.00%
       Unbox |               0 |         0 |   0.00%
    UnboxAny |               0 |         0 |   0.00%
       LdFld |               0 |         0 |   0.00%
      LdFldA |               0 |         0 |   0.00%
       StFld |               0 |         0 |   0.00%
   FindClass |               0 |         0 |   0.00%
   Exception |               0 |         0 |   0.00%
</code></pre>
<p>No printf in the <code>Interpreter::ExecuteMethod</code> or <code>Interpreter::Terminate</code>:</p>
<pre><code>diff --git a/src/vm/interpreter.cpp b/src/vm/interpreter.cpp
index b4b18cb..53ae5c2 100644
--- a/src/vm/interpreter.cpp
+++ b/src/vm/interpreter.cpp
@@ -1878,6 +1878,7 @@ void Interpreter::DoMonitorExitWork()
 
 void Interpreter::ExecuteMethod(ARG_SLOT* retVal, __out bool* pDoJmpCall, __out unsigned* pJmpCallToken)
 {
+    printf("DEBUG: %s:%d\n", __FILE__, __LINE__);
 #if INTERP_DYNAMIC_CONTRACTS
     CONTRACTL {
         THROWS;
@@ -6511,6 +6512,7 @@ CORINFO_CLASS_HANDLE Interpreter::GetTypedRefClsHnd(CEEInfo* info)
 
 void Interpreter::Initialize()
 {
+    printf("DEBUG: %s:%d\n", __FILE__, __LINE__);
     assert(!s_initialized);
 
     s_InterpretMeths.ensureInit(CLRConfig::INTERNAL_Interpret);
@@ -6553,6 +6555,7 @@ void Interpreter::InitializeCompilerStatics(CEEInfo* info)
 
 void Interpreter::Terminate()
 {
+    printf("DEBUG: %s:%d\n", __FILE__, __LINE__);
     if (s_initialized)
     {
         s_methodCacheLock.Destroy();
</code></pre>
<p>As comment mentioned:</p>
<pre><code>// If we failed to jit, then fall back to the primary Jit.
</code></pre>
<p>AltJIT just fall back to primary JIT, but not Interpreter?<br>
How to force fall back to interpreter?  By hacking set <code>ret</code> to <code>CORJIT_SKIPPED</code>:</p>
<pre><code>diff --git a/src/vm/jitinterface.cpp b/src/vm/jitinterface.cpp
index 502b5ad..0be76f6 100644
--- a/src/vm/jitinterface.cpp
+++ b/src/vm/jitinterface.cpp
@@ -12145,6 +12145,7 @@ CorJitResult invokeCompileMethodHelper(EEJitManager *jitMgr,
 
     bool isInterpreterStub   = false;
     bool interpreterFallback = (s_InterpreterFallback.val(CLRConfig::INTERNAL_InterpreterFallback) != 0);
+    printf("DEBUG: interpreterFallback: %d\n", interpreterFallback);
 
     if (interpreterFallback == false)
     {
@@ -12169,6 +12170,8 @@ CorJitResult invokeCompileMethodHelper(EEJitManager *jitMgr,
                                           nativeSizeOfCode);
     }
 
+    // Force fall back to interpreter
+    //ret = CORJIT_SKIPPED;
     if (interpreterFallback == true)
     {
         // If we're doing an "import_only" compilation, it's for verification, so don't interpret.
</code></pre>
<p>And I found that AArch64 Remove unnecessary interpreter fallback <a data-error-text="Failed to load issue title" data-id="371315801" data-permission-text="Issue title is private" data-url="https://github.com/dotnet/coreclr/issues/20470" data-hovercard-type="pull_request" data-hovercard-url="/dotnet/coreclr/pull/20470/hovercard" href="https://github.com/dotnet/coreclr/pull/20470">dotnet/coreclr#20470</a>   So is it able to enable Interpreter at master now?</p>
<p>Thanks,<br>
Leslie Zhai</p>
      </div>
</task-lists>


        



    </div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>