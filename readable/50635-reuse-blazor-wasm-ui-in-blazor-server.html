<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Reuse Blazor WASM UI in Blazor Server -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Reuse Blazor WASM UI in Blazor Server</h1>
    <article class="entry h-entry hentry author-carl-franklin post-type-text featured has-main-image clear" id="article-5e36cc38a96d977ad2aa0cf0"> <div class="entry-content e-content"> <div class="sqs-layout sqs-grid-12 columns-12" id="item-5e36cc38a96d977ad2aa0cf0"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" id="block-f90f0a4526407bad7358"><div class="sqs-block-content"><p class>So, you&#x2019;ve decided to use Blazor, but you&#x2019;re not sure which hosting model to use: Client (WebAssembly) or Server (SignalR-based). Wouldn&#x2019;t it be great if you could write one version of your app that can run as either a WebAssembly or Server-based Blazor app? With a few tweaks, and by following a few design guidelines, you can.</p><p class>I first learned of this pattern at NDC London 2020 in Steve Sanderson&#x2019;s Blazor talk. The secret sauce is to add a reference from a Server-Side Blazor app to a Client-Side Blazor app, and then register the App component in the Server as a reference to the Client-side App component.</p><p class>Follow these steps and you&#x2019;ll see for yourself how this could be a game-changer. <a href="https://drive.google.com/file/d/1GaNIZW6hcc90ktM5_E7RpkqzvWc5p7d2/view?usp=sharing">The complete solution is available for download here</a>.</p><h2>Prerequisites</h2><p class>Start by following the instructions in the <a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/get-started?tabs=visual-studio&amp;view=aspnetcore-3.1">Microsoft Docs for getting started with Blazor.</a> Install the WebAssembly template as described.</p><h2>Create a new Blazor WebAssembly App named BlazorWasm</h2><p class>Make sure to check off &#x201C;ASP.NET Core hosted&#x201D;</p></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_83728"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="Name your app BlazorWasm" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580650280043-ANIW106H2S1PJE72N9A4/ke17ZwdGBToddI8pDm48kG3zKbvSeiyK83VonJw1vY4UqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcF2EyE_KmpxcZq4Kygad-sBpPsQDaTQWmRT6lsDAeVEGATlP9ZORxAehQBatWHMoU/image-0.jpg"> </div> </div> </div> </div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_59470"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="Select Blazor WebAssembly App and check off &#x201C;ASP.NET Core hosted&#x201D;" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580650169753-7A3TBRAHFTI8EDDEB3GH/ke17ZwdGBToddI8pDm48kFO8JStViOQa9m4RraeZxGcUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcgv8yzSodCvCW2p2TiyFaHkfa-H_QBBUcxSbsy7yzy18rI_zkk7ZQ_65NarJnpLAG/image1.jpg"> </div> <div class="image-caption-wrapper"> <div class="image-caption"><p class>Select Blazor WebAssembly App and check off &#x201C;ASP.NET Core hosted&#x201D;</p></div> </div> </div> </div> </div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_101455"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="Name the project BlazorServer" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580650472905-UFV8YS66QSBM61MSERNN/ke17ZwdGBToddI8pDm48kG3zKbvSeiyK83VonJw1vY4UqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcF2EyE_KmpxcZq4Kygad-sBpPsQDaTQWmRT6lsDAeVEGATlP9ZORxAehQBatWHMoU/image-2.jpg"> </div> <div class="image-caption-wrapper"> <div class="image-caption"><p class>Name the project BlazorServer</p></div> </div> </div> </div> </div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_105458"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="This time, select Blazor Server App" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580650542264-MD8W7GJPWFB6NN20DFUH/ke17ZwdGBToddI8pDm48kFO8JStViOQa9m4RraeZxGcUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcgv8yzSodCvCW2p2TiyFaHkfa-H_QBBUcxSbsy7yzy18rI_zkk7ZQ_65NarJnpLAG/image-asset.jpeg"> </div> <div class="image-caption-wrapper"> <div class="image-caption"><p class>This time, select Blazor Server App</p></div> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_132580"><div class="sqs-block-content"><p class>In the BlazorServer project, right click on the project name.</p></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_133528"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="From the BlazorServer project, select Add -&amp;gt; Reference" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580650807913-Z6MGMIELH3DZWF43BMMM/ke17ZwdGBToddI8pDm48kMmPAsSfqNjlh7KSkNiBX3tZw-zPPgdn4jUwVcJE1ZvWQUxwkmyExglNqGp0IvTJZUJFbgE-7XRK3dMEBRBhUpzXti6rIyeni7lqbN7nB628jcSFcD2IwqL_GJgcYyJYMOtusJpJOoduPiwm9pf5MlY/image-asset.jpeg"> </div> <div class="image-caption-wrapper"> <div class="image-caption"><p class>From the BlazorServer project, select Add -&gt; Reference</p></div> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_137384"><div class="sqs-block-content"><p class>Then select the BlazorWasm.Client and BlazorWasm.Shared projects from the Projects menu.</p></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_182137"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="Select both BlazorWasm.Client and BlazorWasm.Shared" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580651074454-BI4KYPWN120U9QG6KFBP/ke17ZwdGBToddI8pDm48kMfc05UflBu91WAlA8Fbsj9Zw-zPPgdn4jUwVcJE1ZvWQUxwkmyExglNqGp0IvTJZamWLI2zvYWH8K3-s_4yszcp2ryTI0HqTOaaUohrI8PIkViTl3wNRhNszczmWZcgZGi8QpHnn8ojJJb_l6bOwUwKMshLAGzx4R3EDFOm1kBS/image-5.jpg"> </div> <div class="image-caption-wrapper"> <div class="image-caption"><p class>Select both BlazorWasm.Client and BlazorWasm.Shared</p></div> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_186049"><div class="sqs-block-content"><p class>Now the fun begins. Delete Counter.razor, Error.razor, FetchData.razor, and Index.razor from the BlazorServer project.</p></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_186940"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="Delete these four pages" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580651226266-WS143HN9UIGGM2F6CG14/ke17ZwdGBToddI8pDm48kJfVfob4EH4flwiA9jm3lBJZw-zPPgdn4jUwVcJE1ZvWEtT5uBSRWt4vQZAgTJucoTqqXjS3CfNDSuuf31e0tVGNgcijnBYQvFXdptThPSTdBvzRoGTxpwbkWOZ3j__gvfNMfDpHAc0k6rj1f-z_Bjc/image-6.jpg"> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_190865"><div class="sqs-block-content"><p class>In the BlazorServer project, open _Hosts.cshtml, locate the &lt;app&gt; tag, and change the component definition from this:</p><pre><code>    &lt;component type=&quot;typeof(App)&quot; render-mode=&quot;ServerPrerendered&quot; /&gt;</code></pre><p class>to this</p><pre><code>    &lt;component type=&quot;typeof(BlazorWasm.Client.App)&quot; render-mode=&quot;Server&quot; /&gt;</code></pre></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_227707"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="Change &amp;lt;app&amp;gt; component to reference the client" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580651561942-BUOROXQ22GCYC3V0WAPS/ke17ZwdGBToddI8pDm48kDNVvONsL0osOn28HCJTxVxZw-zPPgdn4jUwVcJE1ZvWQUxwkmyExglNqGp0IvTJZamWLI2zvYWH8K3-s_4yszcp2ryTI0HqTOaaUohrI8PIb4Rd8aDaLZQXzuNIphExzWah0Kv7S_jjkHExqmxktawKMshLAGzx4R3EDFOm1kBS/image-7.jpg"> </div> <div class="image-caption-wrapper"> <div class="image-caption"><p class>Change &lt;app&gt; component to reference the client</p></div> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_251521"><div class="sqs-block-content"><p class>In order to test this, we have to run the WASM server, which loads the WebAssembly client, and the BlazorServer Server-side project as well. </p><p class>Right-click on the Solution at the top of the Solution Explorer, and Select Properties. Under Common Properties -&gt; Startup Project select &#x201C;Multiple Startup Projects&#x201D;, then set the Action for BlazorServer and BlazorWasm.Server to &#x201C;Start&#x201D;</p></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_252800"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="image-8.jpg" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580651853905-V1Y7BUTJ3ZRDYEX0U0NS/ke17ZwdGBToddI8pDm48kHUbp9RPgsVqdBvuOtFQLkFZw-zPPgdn4jUwVcJE1ZvWQUxwkmyExglNqGp0IvTJZamWLI2zvYWH8K3-s_4yszcp2ryTI0HqTOaaUohrI8PI9gKFjQ2Yo4gsRv5lSypKiCSvVlmjxon1Sc0ppuNphjwKMshLAGzx4R3EDFOm1kBS/image-8.jpg"> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_295781"><div class="sqs-block-content"><p class>You will see two tabs: BlazorServer and BlazorWasm. Both look exactly the same. Try using the Counter page from both. Try going to the Fetch Data page on both. Uh oh. Exception!</p></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_296857"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="The Server app doesn&#x2019;t know about HttpClient." src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580652171510-6D73N6MZSKOB1FEYA0VI/ke17ZwdGBToddI8pDm48kGeVbhnqyT2W9dqNTaKqQyIUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcnGEmn_XYzmYrlUpxo9LQFn3oh0o-fa9WoqyuwCY4Q4sHheZczEVhGCqj-mlGawA4/image-9.jpg"> </div> <div class="image-caption-wrapper"> <div class="image-caption"><p class>The Server app doesn&#x2019;t know about HttpClient.</p></div> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_300784"><div class="sqs-block-content"><p class>This Exception illustrates how you will need to design your app from now on. The HttpClient class is available in the BlazorWasm.Client project by default, but not in the BlazorServer project. </p><p class>Here&#x2019;s the rule:</p><blockquote><p class>In order to achieve reusability between these two projects, they must each have references to the same external resources: projects, packages, scripts, etc.</p></blockquote><p class>So, we have to add a scoped HttpClient service to the BlazorServer project. Open the startup.cs file and add the following to the ConfigureServices method:</p><pre><code>    services.AddScoped&lt;System.Net.Http.HttpClient&gt;();</code></pre><p class>We&#x2019;re not done yet. Take a look at the FetchData.razor file in BlazorWasm.Client. It&#x2019;s trying to access an API controller that&#x2019;s in the same url scope. In order for this to work in both client and server, we have to be more explicit.</p><p class>In the BlazorWasm.Server project, expand Properties, and then click on launchSettings.json. Copy the SSL port. We&#x2019;re going to need that. </p></div></div><div class="sqs-block image-block sqs-block-image" id="block-yui_3_17_2_1_1580649513122_346809"><div class="sqs-block-content"> <div class="image-block-outer-wrapper layout-caption-below design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none"> <div class="intrinsic"> <div class="image-block-wrapper has-aspect-ratio"> <img class="thumb-image" alt="image-10.jpg" src="https://images.squarespace-cdn.com/content/v1/56056b47e4b043d49b646e7e/1580652748348-0YM18EBGY8KKFPIACOZB/ke17ZwdGBToddI8pDm48kMQbiManAcowcqifkX897yUUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcTFA_VTsNBnXCfYUzED6QLq7oUGp1iA16J5tzLZTYf9bvgDM4-zjEbpA6oZPJEuY5/image-10.jpg"> </div> </div> </div> </div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_374575"><div class="sqs-block-content"><p class>In the BlazorWasm.Client project, open FetchData.razor under the Pages folder, and change the URL from &quot;WeatherForecast&quot; to &#x201C;<a href="https://localhost[port]/WeatherForecast&#x201D;">https://localhost:[port]/WeatherForecast&#x201D;</a> replacing &#x201C;[port]&#x201D; with the SSL port from launchSerttings.json:</p></div></div><div class="sqs-block code-block sqs-block-code" id="block-yui_3_17_2_1_1580649513122_400019"><div class="sqs-block-content"><pre class="source-code">@<span class="cm-variable">code</span>{ <span class="cm-variable">private</span> <span class="cm-variable">WeatherForecast</span>[] <span class="cm-variable">forecasts</span>; <span class="cm-variable">protected</span> <span class="cm-variable">override</span> <span class="cm-keyword">async</span> <span class="cm-variable">Task</span> <span class="cm-variable">OnInitializedAsync</span>() { <span class="cm-variable">string</span> <span class="cm-variable">url</span> <span class="cm-operator">=</span> <span class="cm-string">&quot;https://localhost:44306/WeatherForecast&quot;</span>; <span class="cm-variable">forecasts</span> <span class="cm-operator">=</span> <span class="cm-keyword">await</span> <span class="cm-variable">Http</span>.<span class="cm-property">GetJsonAsync</span><span class="cm-operator">&lt;</span><span class="cm-variable">WeatherForecast</span>[]<span class="cm-operator">&gt;</span>(<span class="cm-variable">url</span>);
    }
} </pre></div></div><div class="sqs-block html-block sqs-block-html" id="block-yui_3_17_2_1_1580649513122_426984"><div class="sqs-block-content"><p class>Now when you run the app, you can access the Weather Data from both the Server-side and Client-side blazor apps. </p><p class>If you use this pattern, your server will use the exact same patterns and code that the client uses. That may not always be appropriate. So, make sure you can commit to an architecture that puts the client design first.</p><h2>Other Resources</h2><p class>Come see me in a city near you on my <a href="http://blazorroadshow.com">Blazor Roadshow</a> world tour</p><p class>Attend my <a href="http://blazor.appvnext.com">one-day online Blazor workshop</a> to dig into Blazor big time.</p><p class>Check out <a href="https://www.devexpress.com/blazor/">DevExpress Blazor Components</a>, which are currently free.</p><p class>Happy coding!</p></div></div></div></div></div> </div> <div class="entry-content clear"> <table> <tr> <td width="70px"> <a href="?author=56057d84e4b0ba7911a46347"> <img src="/global/5758afccba67a84e25ba670f?format=50w"> </a> <br> </td> <td> <p>Carl Franklin has been a key leader in the Microsoft developer community since the very early days when he wrote for Visual Basic Programmers Journal. He authored the Q&amp;A column of that magazine as well as many feature articles for VBPJ and other magazines. He has authored two books for John Wiley &amp; Sons on sockets programming in VB, and in 1994 he helped create the very first web site for VB developers, Carl &amp; Gary&apos;s VB Home Page.</p><p>Carl is a Microsoft MVP for Developer Technologies, and co-host of .NET Rocks!, one of the longest running podcasts ever (2002).</p></td></tr></table></div></article>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>