<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Learning about .NET Core futures by poking around at David Fowler&#x27;s GitHub - Scott Hanselman - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Learning about .NET Core futures by poking around at David Fowler&#x27;s GitHub - Scott Hanselman - linksfor.dev(s)"/>
    <meta property="article:author" content="Scott Hanselman"/>
    <meta property="og:description" content="David Fowler is the ASP.NET Core Architect (and an amazing highly technical public speaker) and I&#x27;ve learned a lot from ..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.hanselman.com/blog/LearningAboutNETCoreFuturesByPokingAroundAtDavidFowlersGitHub.aspx"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Learning about .NET Core futures by poking around at David Fowler&#x27;s GitHub - Scott Hanselman</title>
<div class="readable">
        <h1>Learning about .NET Core futures by poking around at David Fowler&#x27;s GitHub - Scott Hanselman</h1>
            <div>by Scott Hanselman</div>
            <div>Reading time: 7-9 minutes</div>
        <div>Posted here: 27 Feb 2019</div>
        <p><a href="https://www.hanselman.com/blog/LearningAboutNETCoreFuturesByPokingAroundAtDavidFowlersGitHub.aspx">https://www.hanselman.com/blog/LearningAboutNETCoreFuturesByPokingAroundAtDavidFowlersGitHub.aspx</a></p>
        <hr/>
<div id="readability-page-1" class="page"><section>
	<section>
          
		<p><img title="A picture of David silently judging my code, but with love" alt="A picture of David silently judging my code, but with love" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/3627e039e1b0_F508/image_8b6da31e-e498-4f6c-a3fd-90c61a65e02c.png" width="250" height="322"><a href="https://github.com/davidfowl?WT.mc_id=-blog-scottha">David Fowler is the ASP.NET Core Architect</a> (and an <a href="https://www.youtube.com/watch?v=c8AIAEPKM2Q">amazing highly technical public speaker</a>) and I've learned a lot from watching him code. However, what's the best way for YOU to learn from folks like David if you can't sit on their shoulder? Why, look at their GitHub! </p> <p>Since .NET Core (and most of Microsoft) is not only open source but also developed in the open now on GitHub, we can actually watch folks in their day to day work as they commit code to projects like the <a href="https://github.com/dotnet/roslyn?WT.mc_id=-blog-scottha">C# compiler</a>, <a href="http://github.com/dotnet?WT.mc_id=-blog-scottha">.NET Core</a>, and <a href="https://github.com/aspnet/AspNetCore?WT.mc_id=-blog-scottha">ASP.NET Core</a>.</p> <p>Even more interestingly, we can look at David's github here <a title="https://github.com/davidfowl" href="https://github.com/davidfowl?WT.mc_id=-blog-scottha">https://github.com/davidfowl</a> and then under <a href="https://github.com/davidfowl?tab=repositories&amp;WT.mc_id=-blog-scottha">Repositories</a> see what he's up to, filter by language and type, and explore! Sometimes <a href="https://github.com/aspnet/aspnetcore/pulls?WT.mc_id=-blog-scottha">I just explore the Pull Requests on projects like ASP.NET Core</a>.</p> <p>You can have Private repositories on GitHub, as I do, and as I'm sure David does. But GitHub is a social network for code and it's more fun and a better learning experience when we can see each others code and read it. Read with a critical eye, but without judgment as you may not have all the context that the author does. If you went to my GitHub, <a title="https://github.com/shanselman" href="https://github.com/shanselman?WT.mc_id=-blog-scottha">https://github.com/shanselman</a> you might be disappointed but you also may be missing the big picture. Just consider that as you Follow people and explore their code.</p> <p>David is an advanced .NET developer, while, for example, I am comparatively intermediate. So I realize that not all of David's code is FOR me. It's a scratchpad, it's not educational how-to workshops. However, I <em>can</em> get pick up cool idioms, interesting directions the tech may be going, and more importantly - prototypes and spikes. Spikes are folks testing out technical ideas. They may not be complete. In fact, they may never be complete. But some my be harbingers of things to come.</p> <p>Here's a few things I learned today.</p> <h3>gRPC for .NET Core</h3> <p>For example, at <a title="https://github.com/davidfowl/grpc-dotnet" href="https://github.com/davidfowl/grpc-dotnet?WT.mc_id=-blog-scottha">https://github.com/davidfowl/grpc-dotnet</a> I can see David has forked (copied) gRPC for dotnet and his game is working with the gRPC folks to make a fully supported version of gRPC for production workloads with .NET Core! Here are the stated goals:</p> <ul> <li>We plan to implement a fully-managed version of gRPC for .NET that will be built on top of ASP.NET Core HTTP/2 server.  </li><li>Good integration with the rest of ASP.NET Core ecosystem  </li><li>High-performance (we plan to utilize some of the cutting edge performance features from ASP.NET Core and in .NET plaform itself)</li></ul> <p>That sounds cool! I can go learn that gRPC is a modern (google sponsored) Remote Procedure Call framework that can run anywhere. It's used by Netflix and Square and supports basically any languaige and any environment. Nice for this microservice world we are entering and hopefully has learned from the sins of DCOM and CORBA and RMI, because I was there and it sucked.</p> <h3>Nothing to see here but moving to a new JSON serializer</h3> <p>This Web.Framework sounds fun, and I'll be sure to take the description to heart.</p> <p><img title="says &quot;Lame name, just a prototype, nothing to see here (move along)&quot;" alt="says &quot;Lame name, just a prototype, nothing to see here (move along)&quot;" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/3627e039e1b0_F508/image_f91df708-0920-47da-a6be-0cba5109828c.png" width="400" height="130"></p> <p>You can see David and James Newton-King kicking ideas around as <a href="https://github.com/davidfowl/Web.Framework/commits/master?WT.mc_id=-blog-scottha">you explore the commit log</a>. However, the most interesting commit IMHO is when David moves this little spike from using JSON.NET (the ubiquitous 3rd party JSON serializer) to the new emerging official System.Text.Json. Here is <a href="https://github.com/davidfowl/Web.Framework/commit/be5d5cf06a8bd3d41218e7cb01e2c95a164992e4?diff=unified&amp;WT.mc_id=-blog-scottha">the commit with unified differences</a>.</p> <p>It's a small change but it also makes me feel good about the API underneath this new JSON API that's coming. My takeway is that it's not as scary as I'd assumed. Looks like a Good Thing(tm).</p><figure><img title="A diff of code shows that just one line is changed to move JSON serializers" alt="A diff of code shows that just one line is changed to move JSON serializers" src="https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/3627e039e1b0_F508/image_e05feeeb-2032-4841-8916-3c4141224686.png" width="999" height="347"></figure>   <p>Cool!</p> <h3>Multi-Protocol ASP.NET Core</h3> <p>This looks interesting. </p> <blockquote> <p>"The following sample shows how you can host a TCP server and HTTP server in the same ASP.NET Core application. Under the covers, it's the same server (Kestrel) running different protocols on different ports. The <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.connections.connectionhandler?view=aspnetcore-2.1&amp;WT.mc_id=-blog-scottha">ConnectionHandler</a> is a new primitive introduced in ASP.NET Core 2.1 to support non-HTTP protocols."</p></blockquote> <p>I didn't know you could do that! Looks like this sample hasn't changed much since it was conceived of in 2018, but then <a href="https://github.com/davidfowl/MultiProtocolAspNetCore/commits/master?WT.mc_id=-blog-scottha">in the last month it's been updated twice</a> and it appears to be part of a larger, <a href="https://github.com/aspnet/KestrelHttpServer/issues/1980?WT.mc_id=-blog-scottha">slow-moving architectural issue called Bedrock</a> that's moving forward.</p> <p>I learned that Kestral (the ASP.NET Core web server) has <a href="https://github.com/davidfowl/MultiProtocolAspNetCore/blob/73249141dff878bb5937b1895c101da49d4d4b0b/KestrelTcpDemo/Program.cs?WT.mc_id=-blog-scottha#L31">a "ListenLocalhost" option on its options object</a>!</p><div><div id="highlighter_121715"><div><div><p><code>WebHost.CreateDefaultBuilder(args)</code></p><p><code>&nbsp;&nbsp;</code><code>.ConfigureServices(services =&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>services.AddFramework(</code><code>new</code> <code>IPEndPoint(IPAddress.Loopback, 8009));</code></p><p><code>&nbsp;&nbsp;</code><code>})</code></p><p><code>&nbsp;&nbsp;</code><code>.UseKestrel(options =&gt;</code></p><p><code>&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>options.ListenLocalhost(8007, builder =&gt;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>builder.UseConnectionHandler&lt;MyEchoConnectionHandler&gt;();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>});</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>options.ListenLocalhost(5000);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>options.ListenLocalhost(5001, builder =&gt;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>builder.UseHttps();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>});</code></p><p><code>&nbsp;&nbsp;</code><code>})</code></p><p><code>&nbsp;&nbsp;</code><code>.UseStartup&lt;Startup&gt;();</code></p></div></div></div></div>
<p>I can see here that TCP port 8007 is customer and uses a custom <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.kestrel.core.internal.connectionhandler-1?view=aspnetcore-2.0&amp;WT.mc_id=-blog-scottha">ConnectionHandler</a> which I also didn't know existed! I can then look at the implementation of that handler and it's cool how clean the API is. You can get the result cleanly off the Transport buffer. You're doing low-level TCP but it doesn't feel low level.</p><div><div id="highlighter_705740"><div><div><p><code>using</code> <code>System.Threading.Tasks;</code></p><p><code>using</code> <code>Microsoft.AspNetCore.Connections;</code></p><p><code>using</code> <code>Microsoft.Extensions.Logging;</code></p><p><code>namespace</code> <code>KestrelTcpDemo</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>class</code> <code>MyEchoConnectionHandler : ConnectionHandler</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>private</code> <code>readonly</code> <code>ILogger&lt;MyEchoConnectionHandler&gt; _logger;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>MyEchoConnectionHandler(ILogger&lt;MyEchoConnectionHandler&gt; logger)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>_logger = logger;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>override</code> <code>async Task OnConnectedAsync(ConnectionContext connection)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>_logger.LogInformation(connection.ConnectionId + </code><code>" connected"</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>while</code> <code>(</code><code>true</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var result = await connection.Transport.Input.ReadAsync();</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>var buffer = result.Buffer;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>foreach</code> <code>(var segment </code><code>in</code> <code>buffer)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>await connection.Transport.Output.WriteAsync(segment);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(result.IsCompleted)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>connection.Transport.Input.AdvanceTo(buffer.End);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>_logger.LogInformation(connection.ConnectionId + </code><code>" disconnected"</code><code>);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p></div></div></div></div>
<p>Pretty slick. This just echos what is sent to that port but not only has it educated me about a thing I didn't know about, it's something I can mentally file away until I need it! </p>
<p>All of these things I learned in just 30 minutes of exploring someone's public repository.</p>
<p>What kinds of code do you like to read and what have you learned from just poking around?</p>
<hr>

<p><strong>Sponsor:</strong> <a href="https://hnsl.mn/2SlZ5Jk">Get the latest JetBrains Rider</a> for remote debugging via SSH, SQL injections, a new Search Everywhere popup, and improved Unity support. </p>


  
		
<div>
	<div>
	    <h4>About Scott</h4>
        <div>
			<p>Scott Hanselman is a former professor, former Chief Architect in finance, now speaker, consultant, father, diabetic, and Microsoft employee. He is a failed stand-up comic, a cornrower, and a book author.</p>
            <p><a href="https://facebook.com/scott.hanselman"><img src="https://www.hanselman.com/images/icon-fb.png" alt="facebook"></a>
            <a href="https://twitter.com/shanselman"><img src="https://www.hanselman.com/images/icon-twitter.png" alt="twitter"></a>
            <a href="https://plus.google.com/108573066018819777334?rel=author" rel="author"><img src="https://www.hanselman.com/images/icon-gplus.png" alt="g+"></a>
            <a href="http://feeds.hanselman.com/ScottHanselman"><img src="https://www.hanselman.com/images/icon-rss.png" alt="subscribe"></a><br>
            <a href="http://hanselman.com/about">About</a> &nbsp; <a href="http://www.hanselman.com/newsletter">Newsletter</a>
        </p></div>
	</div> 
    
      <div>
          
         <p><strong>Hosting By</strong><br>
                <a rel="nofollow" href="https://sherweb.com/"><img alt="Dedicated Windows Server Hosting by SherWeb" width="125" height="125" src="https://images.sherweb.com/OrcsWeb/SherWebPoweredbyLogo_V-250x250Color.png"></a>
          </p>        

     </div>
</div>
  
  
		



		
		
		
		
		
  </section>
</section></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>