<!DOCTYPE html>
<html lang="en">
<head>
    <title>
CVE-2019-9506 | Encryption Key Negotiation of Bluetooth Vulnerability - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="CVE-2019-9506 | Encryption Key Negotiation of Bluetooth Vulnerability - linksfor.dev(s)"/>
    <meta property="og:description" content="Security Advisory"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-9506"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - CVE-2019-9506 | Encryption Key Negotiation of Bluetooth Vulnerability</title>
<div class="readable">
        <h1>CVE-2019-9506 | Encryption Key Negotiation of Bluetooth Vulnerability</h1>
            <div>Reading time: 5-6 minutes</div>
        <div>Posted here: 31 May 2020</div>
        <p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-9506">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-9506</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div ng-bind-html="vm.cveDetail.description | trustedHtml">
<p>Microsoft is aware of the Bluetooth BR/EDR (basic rate/enhanced data rate, known as "Bluetooth Classic") key negotiation vulnerability that exists at the hardware specification level of any BR/EDR Bluetooth device. An attacker could potentially be able to negotiate the offered key length down to 1 byte of entropy, from a maximum of 16 bytes.</p>
<p>To exploit this vulnerability, an attacker would need specialized hardware and would be limited by the range of the Bluetooth devices in use. Using this specialized equipment, they would need to be close enough to communicate and interfere with the legitimate transmissions being made wirelessly.</p>
<p>CERT/CC has issued <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9506">CVE-2019-9506</a> and <a href="https://www.kb.cert.org/vuls/id/918987">VU#918987</a> for this tampering vulnerability, which has a CVSS score of 9.3.</p>
<p>To address the vulnerability Microsoft has released a software update that enforces a default 7-octet minimum key length to ensure that the key negotiation does not trivialize the encryption. This functionality is disabled by default when the update is installed. Customers must enable this functionality by setting a specific flag in the registry. When the flag is set, Windows software will read the encryption key size and reject the Bluetooth connection if it does not meet the defined minimum key size.</p>
<p>If your particular Bluetooth device or the Bluetooth radio in your Windows device, or the driver for that Bluetooth radio does not support the longer key length, this update could block connections with that device when the registry key <strong>EnableMinimumEncryptionKeySize</strong> is set to a value of 1. Users who have issues connecting their Bluetooth devices after installing and enabling this functionality should check to see if their manufacturer is providing additional guidance on updates and mitigations.</p>
<p><strong>To enable this enforcement feature by using Registry Editor, follow these steps:</strong></p>
<p><strong>Note</strong> Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys and Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.</p>
<ol>
<li>Open a command prompt as Administrator.</li>
<li>Type: <code>reg add HKLM\System\CurrentControlSet\Policies\Hardware\Bluetooth /v EnableMinimumEncryptionKeySize /t REG_DWORD /f /d 1</code></li>
<li>Restart the computer.</li>
</ol>
<p>If you don't want to restart your computer, you will need to reset your Bluetooth device as follows:</p>
<ol>
<li>On the device, go to the Bluetooth Settings.</li>
<li>Turn off Bluetooth.</li>
<li>Open the Device Manager and locate the Bluetooth Controller.</li>
<li>Right-click on the Bluetooth Controller and select <strong>Disable device</strong>.</li>
<li>After the device is disabled, right-click again and select <strong>Enable device</strong>.</li>
<li>Turn on Bluetooth in Bluetooth Settings</li>
</ol>
<p>Computers with incompatible Bluetooth controllers or devices may have to temporarily or permanently set EnableMinimumEncryptionKeySize = 0 until controllers, firmware or drivers can be updated or the device itself updated. Bluetooth connections on computers in this state will not be secure.</p>
<p><strong>To disable this enforcement feature:</strong></p>
<ol>
<li>Open a command prompt as Administrator.</li>
<li>Type: <code>reg add HKLM\System\CurrentControlSet\Policies\Hardware\Bluetooth /v EnableMinimumEncryptionKeySize /t REG_DWORD /f /d 0</code></li>
<li>Restart the computer.</li>
</ol>

<p>The best protection is to keep computers up to date. Please see <a href="https://support.microsoft.com/help/4514157">Microsoft Knowledge Base Article 4514157</a> for guidance on protecting Windows devices.</p>
<p>If your particular device does not support the longer key length, this update could block connections with that device. Users who have issues connecting their Bluetooth devices after installing and enabling this functionality should check to see if their manufacturer is providing additional guidance on updates and mitigations.</p>

<p><strong>1. Why is this enforcement not enabled by default?</strong></p>
<p>A number of devices may not currently be able to support a longer key length and would not function with this fix enabled. Combined with the difficulty to use this attack and the need of specialized equipment and proximity to the target, this was decided to be left disabled initially to avoid any compatibility issues. The choice to enable this functionality would be left up to the user.</p>
<p><strong>2. Where can I find more information about enabling this functionality?</strong></p>
<p>If you determine that you need to enable this functionality to enforce a default 7-octet minimum key length, see <a href="https://support.microsoft.com/help/4514157">Microsoft Knowledge Base Article 4514157</a>.</p>

<ul>
<li>Thank you to <a href="https://www.icasi.org/">ICASI</a> for coordinating multi-vendor response. Also see <a href="https://www.icasi.org/br-edr-encryption-key-bluetooth-vulnerability">Statement from the International Consortium for Advancement of Cybersecurity on the Internet (ICASI) on the Bluetooth Vulnerability</a></li>
<li><a href="https://www.kb.cert.org/vuls/id/918987">CERT/CC VU#918987</a></li>
<li>See Bluetooth SIG advisory: <a href="https://www.bluetooth.com/security/statement-key-negotiation-of-bluetooth">https://www.bluetooth.com/security/statement-key-negotiation-of-bluetooth</a></li>
</ul>
</div><p ng-hide="vm.cveDetail.description">CVE Description missing...</p></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>