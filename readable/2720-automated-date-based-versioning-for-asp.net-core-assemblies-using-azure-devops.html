<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Automated date based versioning for ASP.NET Core assemblies using Azure DevOps -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Automated date based versioning for ASP.NET Core assemblies using Azure DevOps</h1><div><div class="entry-content clearfix"><p>I needed automatic version numbering based on current date when web application is built. It was wish by some customers and in their projects it’s okay with it. As their code is covered with automated tests and other diagnostics I’m using Azure DevOps as build server and this is where I made automated date based versioning work.</p><blockquote><p><strong>Before religious wars about versioning</strong> I mention that this kind of versioning doesn’t expose absolute truth or best practices. It comes with possible consequences and obstacles and one shouldn’t apply it to every project possible. I just happened to have few situations where date based versioning makes sense and is safe to use.</p></blockquote><p>I tried few Azure DevOps tasks by third-parties and I got things running like expeced with <a title="Manifest Versioning Build Tasks by Richard Fennell" href="https://marketplace.visualstudio.com/items?itemName=richardfennellBM.BM-VSTS-Versioning-Task">Manifest Versioning Build Tasks by Richard Fennell</a>. It’s <strong>free</strong> to use, no hidden or additional expenses!</p><p align="center"><a title="Manifest Versioning Build Tasks by Richard Fennell" href="https://marketplace.visualstudio.com/items?itemName=richardfennellBM.BM-VSTS-Versioning-Task"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/manifest-versioning-build-tasks.png.webp" type="image/webp"><img width="598" height="263" title="Manifest Versioning Build Tasks by Richard Fennell" alt="Manifest Versioning Build Tasks by Richard Fennell" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20598%20263%22%3E%3C/svg%3E" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/manifest-versioning-build-tasks.png" border="0" class="lazyload webpexpress-processed"></picture></a></p><h3>Adding and configuring versioning task</h3><p>Installation was easy. I installed it to my Azure DevOps account through adding new task to build pipeline and then added .NET Core version step. Build pipeline for my demo application is here and the name of versioning task is “Version .NET Core assemblies”.</p><p align="center"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-pipeline.png.webp" type="image/webp"><img width="561" height="678" title="Version .NET Core Assemblies build task" alt="Version .NET Core Assemblies build task" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20561%20678%22%3E%3C/svg%3E" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-pipeline.png" border="0" class="lazyload webpexpress-processed"></picture></p><p>To get it work few additional steps are needed. Under build pipeline options I changed the format of version number like shown on the following screenshot.</p><p align="center"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-format.png.webp" type="image/webp"><img width="503" height="483" title="Setting build number format" alt="Setting build number format" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20503%20483%22%3E%3C/svg%3E" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-format.png" border="0" class="lazyload webpexpress-processed"></picture></p><p>For those who want to repeat my steps the number format string is here for copy-paste: <strong>$(Build.DefinitionName)_$(date:yyyy).$(date:MM).$(date:dd)$(Rev:.r)</strong>.</p><p>Next step is to conigure version number task.</p><p align="center"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-settings.png.webp" type="image/webp"><img width="504" height="671" title="Configuring Version .NET Core Assemblies task" alt="Configuring Version .NET Core Assemblies task" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20504%20671%22%3E%3C/svg%3E" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-settings.png" border="0" class="lazyload webpexpress-processed"></picture></p><p>These settings should be enough to get automatic versioning work. No need to change anything in project files.</p><h3>Build output of versioning task</h3><p>Here is the fragment of versioning task output when build happened. I made red rectangles around important parts of versioning task output.</p><p align="center"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-set.png.webp" type="image/webp"><img width="592" height="321" title="Version .NET Core Asseblies task output" alt="Version .NET Core Asseblies task output" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20592%20321%22%3E%3C/svg%3E" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-set.png" border="0" class="lazyload webpexpress-processed"></picture></p><p>As a first thing task detects current build number. This is built based on options I set before. Then regular expression (Version Filter) is applied to build number and as a result date based version number is extracted. This version number is automatically set to all projects I have in repository because I made no more specific rules.</p><h3>Displaying version number in ASP.NET Core application</h3><p>To display version number at footer of web page I use the following code in layout page.</p><pre><span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"col-md-4 col-sm-4"</span><span>&gt;<br></span>&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>p</span>&nbsp;<span>class</span><span>=</span><span>"powered"</span><span>&gt;</span>Version: <span>@</span>System.Reflection.Assembly.GetAssembly(GetType()).GetName().Version.ToString()<span>&lt;/</span><span>p</span><span>&gt;</span><span>&lt;/</span><span>div</span><span>&gt;</span></pre><p>Here is how it looks on web page footer.</p><p align="center"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-footer.png.webp" type="image/webp"><img width="160" height="50" title="Version number on web page" alt="Version number on web page" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20160%2050%22%3E%3C/svg%3E" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/02/azure-devops-date-based-version-footer.png" border="0" class="lazyload webpexpress-processed"></picture></p><h3>Wrapping up</h3><p>With Azure DevOps service it’s possible to move versioning of release assemblies to build pipeline keeping source code and developers machines clean of additional ballast. With right tools it’s easy to play with version numbers and automate versioning in build server. This blog post wen through steps to take to enable date based versioning of .NET Core assemblies. I spent around 15 minutes to get things work with task mentioned above and I think it’s stong enough argument to blog about it.</p><div class="ShariffSC shariff-styling"></div></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>