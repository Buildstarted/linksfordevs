<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Announcing Rust 1.42.0 | Rust Blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Announcing Rust 1.42.0 | Rust Blog - linksfor.dev(s)"/>
    <meta property="article:author" content="Mar. 12, 2020 &#xB7; The Rust Release Team"/>
    <meta property="og:description" content="Empowering everyone to build reliable and efficient software."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://blog.rust-lang.org/2020/03/12/Rust-1.42.html"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Announcing Rust 1.42.0 | Rust Blog</title>
<div class="readable">
        <h1>Announcing Rust 1.42.0 | Rust Blog</h1>
            <div>by Mar. 12, 2020 &#xB7; The Rust Release Team</div>
            <div>Reading time: 7-8 minutes</div>
        <div>Posted here: 12 Mar 2020</div>
        <p><a href="https://blog.rust-lang.org/2020/03/12/Rust-1.42.html">https://blog.rust-lang.org/2020/03/12/Rust-1.42.html</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
      <p>The Rust team is happy to announce a new version of Rust, 1.42.0. Rust is a programming language that is empowering everyone to build reliable and efficient software.</p>
<p>If you have a previous version of Rust installed via rustup, getting Rust 1.42.0 is as easy as:</p>
<pre><code>rustup update stable
</code></pre>
<p>If you don't have it already, you can <a href="https://www.rust-lang.org/install.html">get <code>rustup</code></a> from the appropriate page on our website, and check out the <a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-1420-2020-03-12">detailed release notes for 1.42.0</a> on GitHub.</p>
<h2>What's in 1.42.0 stable</h2>
<p>The highlights of Rust 1.42.0 include: more useful panic messages when <code>unwrap</code>ping, subslice patterns, the deprecation of <code>Error::description</code>, and more. See the <a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-1420-2020-03-12">detailed release notes</a> to learn about other changes not covered by this post.</p>
<h3>Useful line numbers in <code>Option</code> and <code>Result</code> panic messages</h3>
<p>In Rust 1.41.1, calling <code>unwrap()</code> on an <code>Option::None</code> value would produce an error message looking something like this:</p>
<pre><code>thread <span>'main</span>' panicked at <span>'called</span> `<span>Option</span>::unwrap()` on a `<span>None</span>` value', /.../src/libcore/macros/<span>mod</span>.rs:<span>15</span>:<span>40</span>
</code></pre>
<p>Similarly, the line numbers in the panic messages generated by <code>unwrap_err</code>, <code>expect</code>, and <code>expect_err</code>, and the corresponding methods on the <code>Result</code> type, also refer to <code>core</code> internals.</p>
<p>In Rust 1.42.0, all eight of these functions produce panic messages that provide the line number where they were invoked. The new error messages look something like this:</p>
<pre><code>thread <span>'main</span>' panicked at <span>'called</span> `<span>Option</span>::unwrap()` on a `<span>None</span>` value', src/main.rs:<span>2</span>:<span>5</span>
</code></pre>
<p>This means that the invalid call to <code>unwrap</code> was on line 2 of <code>src/main.rs</code>.</p>
<p>This behavior is made possible by an annotation, <code>#[track_caller]</code>. This annotation is not yet available to use in stable Rust; if you are interested in using it in your own code, you can follow its progress by watching <a href="https://github.com/rust-lang/rust/issues/47809">this tracking issue</a>.</p>
<h3>Subslice patterns</h3>
<p>In Rust 1.26, we stabilized "<a href="https://blog.rust-lang.org/2018/05/10/Rust-1.26.html#basic-slice-patterns">slice patterns</a>," which let you <code>match</code> on slices. They looked like this:</p>
<pre><code><span><span>fn</span> <span>foo</span></span>(words: &amp;[&amp;<span>str</span>]) {
    <span>match</span> words {
        [] =&gt; <span>println!</span>(<span>"empty slice!"</span>),
        [one] =&gt; <span>println!</span>(<span>"one element: {:?}"</span>, one),
        [one, two] =&gt; <span>println!</span>(<span>"two elements: {:?} {:?}"</span>, one, two),
        _ =&gt; <span>println!</span>(<span>"I'm not sure how many elements!"</span>),
    }
}
</code></pre>
<p>This allowed you to match on slices, but was fairly limited. You had to choose the exact sizes
you wished to support, and had to have a catch-all arm for size you didn't want to support.</p>
<p>In Rust 1.42, we have <a href="https://github.com/rust-lang/rust/pull/67712/">expanded support for matching on parts of a slice</a>:</p>
<pre><code><span><span>fn</span> <span>foo</span></span>(words: &amp;[&amp;<span>str</span>]) {
    <span>match</span> words {
        [<span>"Hello"</span>, <span>"World"</span>, <span>"!"</span>, ..] =&gt; <span>println!</span>(<span>"Hello World!"</span>),
        [<span>"Foo"</span>, <span>"Bar"</span>, ..] =&gt; <span>println!</span>(<span>"Baz"</span>),
        rest =&gt; <span>println!</span>(<span>"{:?}"</span>, rest),
    }
}
</code></pre>
<p>The <code>..</code> is called a "rest pattern," because it matches the rest of the slice. The above example uses the rest pattern at the end of a slice, but you can also use it in other ways:</p>
<pre><code><span><span>fn</span> <span>foo</span></span>(words: &amp;[&amp;<span>str</span>]) {
    <span>match</span> words {
        
        [.., <span>"!"</span>] =&gt; <span>println!</span>(<span>"!!!"</span>),

        
        [start @ .., <span>"z"</span>] =&gt; <span>println!</span>(<span>"starts with: {:?}"</span>, start),

        
        [<span>"a"</span>, end @ ..] =&gt; <span>println!</span>(<span>"ends with: {:?}"</span>, end),

        rest =&gt; <span>println!</span>(<span>"{:?}"</span>, rest),
    }
}
</code></pre>
<p>If you're interested in learning more, we published <a href="https://blog.rust-lang.org/inside-rust/2020/03/04/recent-future-pattern-matching-improvements.html">a post on the Inside Rust blog</a> discussing these changes as well as more improvements to pattern matching that we may bring to stable in the future! You can also read more about slice patterns in <a href="https://thomashartmann.dev/blog/feature(slice_patterns)/">Thomas Hartmann's post</a>.</p>
<h3><a href="https://doc.rust-lang.org/stable/std/macro.matches.html"><code>matches!</code></a></h3>
<p>This release of Rust stabilizes a new macro, <a href="https://doc.rust-lang.org/nightly/std/macro.matches.html"><code>matches!</code></a>. This macro accepts an expression and a pattern, and returns true if the pattern matches the expression. In other words:</p>
<pre><code>
<span>match</span> <span>self</span>.partial_cmp(other) {
    <span>Some</span>(Less) =&gt; <span>true</span>,
    _ =&gt; <span>false</span>,
}


matches!(<span>self</span>.partial_cmp(other), <span>Some</span>(Less))
</code></pre>
<p>You can also use features like <code>|</code> patterns and <code>if</code> guards:</p>
<pre><code><span>let</span> foo = <span>'f'</span>;
<span>assert!</span>(matches!(foo, <span>'A'</span>..=<span>'Z'</span> | <span>'a'</span>..=<span>'z'</span>));

<span>let</span> bar = <span>Some</span>(<span>4</span>);
<span>assert!</span>(matches!(bar, <span>Some</span>(x) <span>if</span> x &gt; <span>2</span>));
</code></pre>
<h3><code>use proc_macro::TokenStream;</code> now works</h3>
<p>In Rust 2018, we <a href="https://doc.rust-lang.org/stable/edition-guide/rust-2018/module-system/path-clarity.html#no-more-extern-crate">removed the need for <code>extern crate</code></a>. But procedural macros were a bit special, and so when you were writing a procedural macro, you still needed to say <code>extern crate proc_macro;</code>.</p>
<p>In this release, if you are using Cargo, <a href="https://github.com/rust-lang/cargo/pull/7700">you no longer need this line when working with the 2018 edition; you can use <code>use</code> like any other crate</a>. Given that most projects will already have a line similar to <code>use proc_macro::TokenStream;</code>, this change will mean that you can delete the <code>extern crate proc_macro;</code> line and your code will still work. This change is small, but brings procedural macros closer to regular code.</p>
<h3>Libraries</h3>
<ul>
<li><a href="https://github.com/rust-lang/rust/pull/68348/"><code>iter::Empty&lt;T&gt;</code> now implements <code>Send</code> and <code>Sync</code> for any <code>T</code>.</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/67935/"><code>Pin::{map_unchecked, map_unchecked_mut}</code> no longer require the return type
to implement <code>Sized</code>.</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/67233/"><code>io::Cursor</code> now implements <code>PartialEq</code> and <code>Eq</code>.</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/66254/"><code>Layout::new</code> is now <code>const</code>.</a></li>
</ul>
<h3>Stabilized APIs</h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/std/sync/struct.Condvar.html#method.wait_while"><code>CondVar::wait_while</code></a> &amp; <a href="https://doc.rust-lang.org/stable/std/sync/struct.Condvar.html#method.wait_timeout_while"><code>CondVar::wait_timeout_while</code></a></li>
<li><a href="https://doc.rust-lang.org/stable/std/fmt/struct.DebugMap.html#method.key"><code>DebugMap::key</code></a> &amp; <a href="https://doc.rust-lang.org/stable/std/fmt/struct.DebugMap.html#method.value"><code>DebugMap::value</code></a></li>
<li><a href="https://doc.rust-lang.org/stable/std/mem/struct.ManuallyDrop.html#method.take"><code>ManuallyDrop::take</code></a></li>
<li><a href="https://doc.rust-lang.org/stable/std/ptr/fn.slice_from_raw_parts_mut.html"><code>ptr::slice_from_raw_parts_mut</code></a> &amp; <a href="https://doc.rust-lang.org/stable/std/ptr/fn.slice_from_raw_parts.html"><code>ptr::slice_from_raw_parts</code></a></li>
</ul>
<h3>Other changes</h3>
<p>There are other changes in the Rust 1.42.0 release: check out what changed in <a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-1420-2020-03-12">Rust</a> and <a href="https://github.com/rust-lang/cargo/blob/master/CHANGELOG.md#cargo-142-2020-03-12">Cargo</a>.</p>
<h3>Compatibility Notes</h3>
<p>We have two notable compatibility notes this release: a deprecation in the standard library, and a demotion of 32-bit Apple targets to Tier 3.</p>
<h4>Error::Description is deprecated</h4>
<p>Sometimes, mistakes are made. The <code>Error::description</code> method is now considered to be one of those mistakes. The problem is with its type signature:</p>
<pre><code><span><span>fn</span> <span>description</span></span>(&amp;<span>self</span>) -&gt; &amp;<span>str</span>
</code></pre>
<p>Because <code>description</code> returns a <code>&amp;str</code>, it is not nearly as useful as we wished it would be. This means that you basically need to return the contents of an <code>Error</code> verbatim; if you wanted to say, use formatting to produce a nicer description, that is impossible: you'd need to return a <code>String</code>. Instead, error types should implement the <code>Display</code>/<code>Debug</code> traits to provide the description of the error.</p>
<p>This API has existed since Rust 1.0. We've been working towards this goal for a long time: back in Rust 1.27, we <a href="https://github.com/rust-lang/rust/pull/50163">"soft deprecated" this method</a>. What that meant in practice was, we gave the function a default implementation. This means that users were no longer forced to implement this method when implementing the <code>Error</code> trait. In this release, <a href="https://github.com/rust-lang/rust/pull/66919/">we mark it as <em>actually</em> deprecated</a>, and took some steps to de-emphasize the method in <code>Error</code>'s documentation. Due to our stability policy, <code>description</code> will never be removed, and so this is as far as we can go.</p>
<h4>Downgrading 32-bit Apple targets</h4>
<p>Apple is no longer supporting 32-bit targets, and so, neither are we. They have been downgraded to Tier 3 support by the project. For more details on this, check out <a href="https://blog.rust-lang.org/2020/01/03/reducing-support-for-32-bit-apple-targets.html">this post</a> from back in January, which covers everything in detail.</p>
<h2>Contributors to 1.42.0</h2>
<p>Many people came together to create Rust 1.42.0. We couldn't have done it without all of you. <a href="https://thanks.rust-lang.org/rust/1.42.0/">Thanks!</a></p>

    </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>