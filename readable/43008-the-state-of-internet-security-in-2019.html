<!DOCTYPE html>
<html lang="en">
<head>
    <title>
The State of Internet Security in 2019 -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div class="row row-parent style-light double-top-padding double-bottom-padding"> <p>Earlier this year, we saw 2019 start off in one of the worst ways possible; &#x2013; the&#xA0;<a href="https://blog.dehashed.com/town-of-salem-blankmediagames-hacked/"><em>Blank Media Games Data breach</em></a>. 2019 has been one of the most eventful years in data breaches with <a href="https://www.zdnet.com/article/a-hacker-has-dumped-nearly-one-billion-user-records-over-the-past-two-months/"><em>rounds</em></a> (breaches from giants like eVite, Poshmark, and Canva) stemming from GnosticPlayers being made public. We&#x2019;ve decided to just peak into the world of open databases. Specifically, Elasticsearch. Many other database solutions (NoSQL) default to no authentication, and no security. Meaning anyone who knows which I.P. to connect to, can connect. And we&#x2019;ve seen the damage &amp; outcome of when they decide to do so.</p> <h2>Why?</h2> <p>We were initially inspired to release this in light of recent events with security researcher&#xA0;<a href="https://www.nightlionsecurity.com"><em>Vinny Troia</em></a>&#xA0;coming across multiple open Elasticsearch instances containing troves of data on everyday people. Most recent being the&#xA0;<a href="https://www.troyhunt.com/data-enrichment-people-data-labs-and-another-622m-email-addresses/"><em>People Data Labs (PDL)</em></a>&#xA0;exposing 622 million records, information including email addresses, phone numbers, social media profiles, and job history data. This is not the first time Vinny stumbled on open servers, with more notable instances such as&#xA0;<a href="https://www.wired.com/story/exactis-database-leak-340-million-records/"><em>Exactis</em></a>&#xA0;being discovered on June 1st, 2018 exposing 340 million Records and&#xA0;<a href="https://techcrunch.com/2018/10/01/apollo-contacts-data-breach/"><em>Apollo</em></a>&#xA0;on October 5th, 2018 exposing 200 million Records.</p> <p>We also wanted to see what can be done to better secure people&#x2019;s information and figure out which organizations were the biggest offenders. While NoSQL Architectures are released defaulting to no security or authorization, it doesn&#x2019;t mean that they don&#x2019;t come with a slew of warnings and security recommendations. Such as setting up a firewall and allowing whitelisted I.P.&#x2019;s, and auth plugins being made based on the open-source software and released to the public for free usage. </p> <h2>The Process</h2> <p>We&#x2019;ve set up a few scripts that we will not be releasing to the public for obvious reasons, but here&#x2019;s a rundown of the process we took:</p> <ul><li>We scan the entire internet (zmap)</li><li>We parse the results through a custom HTTP Requests script (to ensure validity and get rid servers that have proper authentication protocols)</li><li>And last but not least, running the no-auth required, zero security server list through a custom script to give us some beautiful analytics.</li></ul> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/zmap-30min-1024x866.png" alt class="wp-image-67346" srcset="https://blog.dehashed.com/wp-content/uploads/zmap-30min-1024x866.png 1024w, https://blog.dehashed.com/wp-content/uploads/zmap-30min-300x254.png 300w, https://blog.dehashed.com/wp-content/uploads/zmap-30min-768x650.png 768w, https://blog.dehashed.com/wp-content/uploads/zmap-30min.png 1183w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>(In just 30 minutes, we&#x2019;ve scanned 6% of the internet (~215M IPS), and found ~230,000 Elasticsearch instances.)</figcaption></figure> <p>Scanning was the tricky part, while it is not illegal to scan the internet, it is frowned upon. Many hosts disallow scanning and will ban you if you set off specific triggers. We received clearance as security researches to do scanning on a server given to us by an unnamed host.</p> <h2>Too Easy</h2> <p>We initially expected to be shut down pretty quickly, not by the host (as we had clearance) but by various bugs and hiccups. However, this was not the case. We were very quickly able to begin scanning, and within 9 hours, we found every single open Elasticsearch instance that was open to the public. You may be asking yourself how easy is this to reproduce? Well, it&#x2019;s pretty darn easy. Servers for this kind of activity exist all over the clear and darknet and only cost mere dollars to rent. </p> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/host1-1-1024x564.png" alt class="wp-image-67356" srcset="https://blog.dehashed.com/wp-content/uploads/host1-1-1024x564.png 1024w, https://blog.dehashed.com/wp-content/uploads/host1-1-300x165.png 300w, https://blog.dehashed.com/wp-content/uploads/host1-1-768x423.png 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/host2-1024x563.png" alt class="wp-image-67351" srcset="https://blog.dehashed.com/wp-content/uploads/host2-1024x563.png 1024w, https://blog.dehashed.com/wp-content/uploads/host2-300x165.png 300w, https://blog.dehashed.com/wp-content/uploads/host2-768x422.png 768w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>(A host on a forum advertising servers that allow DDoSing, Spoofing, &amp; Scanning.)</figcaption></figure> <h2>Execution</h2> <p>After running our Scanning server, it took only 8 hours to complete the entire scan of the internet, revealing a total of ~4M Servers with port 9200 in use. This doesn&#x2019;t mean that there are ~4M Elasticsearch instances, as there might be other processes running on this port, and some Elasticsearch clusters have proper security (running on a different port or not being open to the public internet at all).</p> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/zmap-complete2-1024x811.png" alt class="wp-image-67352" srcset="https://blog.dehashed.com/wp-content/uploads/zmap-complete2-1024x811.png 1024w, https://blog.dehashed.com/wp-content/uploads/zmap-complete2-300x238.png 300w, https://blog.dehashed.com/wp-content/uploads/zmap-complete2-768x608.png 768w, https://blog.dehashed.com/wp-content/uploads/zmap-complete2.png 1174w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Scanner revealing a total of ~3.7 billion scanned I.P. Addresses showing ~4 Million Servers user port 9200 (Default Elasticsearch port)</figcaption></figure> <p>The next step was checking which one of these servers was using Elasticsearch, and which one of these was having Zero Authentication. We use a simple script to query the servers via HTTP headers. </p> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/nono1-1024x697.png" alt class="wp-image-67353" srcset="https://blog.dehashed.com/wp-content/uploads/nono1-1024x697.png 1024w, https://blog.dehashed.com/wp-content/uploads/nono1-300x204.png 300w, https://blog.dehashed.com/wp-content/uploads/nono1-768x523.png 768w, https://blog.dehashed.com/wp-content/uploads/nono1.png 1363w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Our script returning ~330 thousand open, unsecured, publicly accessible Elasticsearch instances</figcaption></figure> <p>The final step was to parse the results, which was easiest. Out of ~330 thousand open servers, only 57,296 servers contained over 1MB of data.</p> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/parsed-1024x687.png" alt class="wp-image-67358" srcset="https://blog.dehashed.com/wp-content/uploads/parsed-1024x687.png 1024w, https://blog.dehashed.com/wp-content/uploads/parsed-300x201.png 300w, https://blog.dehashed.com/wp-content/uploads/parsed-768x516.png 768w, https://blog.dehashed.com/wp-content/uploads/parsed.png 1153w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>(What the parsed results look like)</figcaption></figure> <h2>Numbers</h2> <ul><li>Total Elasticsearch Servers Open To Public: 299,540</li><li>Total Open Elasticsearch Servers With Data: 57,296</li><li>Total Size Of Publicly Accessible Data: 462 TB</li><li>Total Document Count Of Publicly Accessible Data: 621,362,063,812</li></ul> <p>Don&#x2019;t fret, too much. A lot of those lines are just logs, but the issue is for those that aren&#x2019;t, for example, this server we found containing 50 million customers for a popular online retailer (Email, I.P., Phone, Name, Address, Order Information):</p> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/1-1024x320.png" alt class="wp-image-67363" srcset="https://blog.dehashed.com/wp-content/uploads/1-1024x320.png 1024w, https://blog.dehashed.com/wp-content/uploads/1-300x94.png 300w, https://blog.dehashed.com/wp-content/uploads/1-768x240.png 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure> <p>Or this Leads server exposing over 3B lines of Emails, I.P., Names, Address, Internet Activity, Interests, Education, Job History, Income, and many more data points:</p> <figure class="wp-block-image"><img src="https://204.236.250.118/wp-content/uploads/3b-1024x443.png" alt class="wp-image-67365" srcset="https://blog.dehashed.com/wp-content/uploads/3b-1024x443.png 1024w, https://blog.dehashed.com/wp-content/uploads/3b-300x130.png 300w, https://blog.dehashed.com/wp-content/uploads/3b-768x333.png 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure> <p>This is just the tip of the iceberg, we found servers with Facebook profile scrapes pushing past 3B records, images, names, emails that are publicly visible on profile, phone numbers, social media, and much more. </p> <h2>What Now?</h2> <p> Our next step is to index all of these servers into a database so we get some analytics. Our founding principles are based on reducing security risk for not only our users but all users of the internet, so to stay consistent with those ideas we&#x2019;re currently working on notifying owners of these servers of the possible security risks. We plan to do this by creating a script to automatically query WHOIS records and send emails to the servers&#x2019; respective owners. This shouldn&#x2019;t be an issue in 2019 though. Hopefully going into 2020 companies and data harvesters will take better care of their back ends moving forward. It&#x2019;s only a matter of time before someone with malicious intent stumbles upon this data.</p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>