<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Autofac 5.0 Released -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Autofac 5.0 Released</h1>
    <div class="entry-content"> <p><a href="https://www.nuget.org/packages/Autofac/5.0.0">Today the Autofac team and I are pleased to announce <strong>the release of Autofac 5.0!</strong></a></p> <p>This is the first major-version release we&#x2019;ve had in about <strong>three years</strong> (Autofac 4.0 was released in August 2016). There are some breaking changes and new features you should know about as you decide your upgrade strategy. Hopefully this will help you navigate those waters.</p> <h2 id="breaking-changes">Breaking Changes</h2> <h3 id="framework-version-targeting-changes">Framework Version Targeting Changes</h3> <p>Starting with Autofac 5.0 there is <strong>no longer support for .NET 4.5.x</strong>. .NET 4.5.2, the last release in that line, <a href="https://support.microsoft.com/en-in/help/17455/lifecycle-faq-net-framework">follows the same support lifecycle as Windows Server 2012 R2</a> which <a href="https://support.microsoft.com/en-in/lifecycle/search/1163">ended mainstream support in September 2018</a>.</p> <p>Autofac 5.0 now targets:</p> <ul> <li><code class="language-plaintext highlighter-rouge">netstandard2.0</code></li> <li><code class="language-plaintext highlighter-rouge">netstandard2.1</code></li> <li><code class="language-plaintext highlighter-rouge">net461</code></li>
</ul> <h3 id="containers-are-immutable">Containers are Immutable</h3> <p>The container registry can no longer be updated after it has been built.</p> <p>The <code class="language-plaintext highlighter-rouge">ContainerBuilder.Update</code> method was marked obsolete <a href="https://github.com/autofac/Autofac/commit/8a89e94ad2ffed0c10ac613b7015c11a56275c99#diff-45e8d52a7772b37f7ac23b1819bb530d">in November 2016</a> and there has been <a href="https://github.com/autofac/Autofac/issues/811">a robust discussion</a> to answer questions about how to get the container contents to adjust as needed at runtime.</p> <p><code class="language-plaintext highlighter-rouge">ContainerBuilder.Update</code> has now been removed entirely.</p> <p>If you need to change registration behavior at runtime, there are several options available to you including the use of lambdas or child lifetime scopes. <a href="https://github.com/autofac/Autofac/issues/811">See this discussion issue for examples and ideas.</a> We will work to <a href="https://github.com/autofac/Documentation/issues/97">add some documentation based on this issue.</a></p> <p>[<a href="https://github.com/autofac/Autofac/pull/981">PR #948</a> - thanks <a href="https://github.com/weelink">@weelink</a>!]</p> <h3 id="lifetime-scope-disposal-hierarchy-enforced">Lifetime Scope Disposal Hierarchy Enforced</h3> <p>Resolving a service from a lifetime scope will now check all parent scopes to make sure none of them have been disposed.</p> <p><strong>If you dispose a lifetime scope, all children of that lifetime scope will stop resolving objects.</strong> In cases like this you&#x2019;ll start getting <code class="language-plaintext highlighter-rouge">ObjectDisposedException</code> instead.</p> <p>If you have a custom application integration that involves creating/destroying lifetime scopes (e.g., <a href="https://autofac.readthedocs.io/en/latest/faq/per-request-scope.html">custom per-request support</a>) this may cause issues where proper disposal ordering is not occurring.</p> <p>[<a href="https://github.com/autofac/Autofac/issues/1020">Fixes #1020</a>; <a href="https://github.com/autofac/Autofac/pull/1061">PR #1061</a> - thanks <a href="https://github.com/alistairjevans">@alistairjevans</a>!]</p> <h3 id="prevent-auto-injecting-onto-static-properties">Prevent Auto-Injecting onto Static Properties</h3> <p>Autofac will no longer do property injection on static properties when auto-wiring of properties is enabled.</p> <p>If your application behavior depends on static property injection you will need to do some additional work like adding a build callback to populate the property.</p> <p>[<a href="https://github.com/autofac/Autofac/issues/1013">Fixes #1013</a>; <a href="https://github.com/autofac/Autofac/pull/1061">PR #1021</a> - thanks <a href="https://github.com/alistairjevans">@alistairjevans</a>!]</p> <h2 id="features-and-fixes">Features and Fixes</h2> <h3 id="asynchronous-disposal-support">Asynchronous Disposal Support</h3> <p>Autofac lifetime scopes now implement the <code class="language-plaintext highlighter-rouge">IAsyncDisposable</code> interface so they can be disposed asynchyronously.</p> <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">scope</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="nf">BeginLifetimeScope</span><span class="p">())</span>
<span class="p">{</span> <span class="kt">var</span> <span class="n">service</span> <span class="p">=</span> <span class="n">scope</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">ServiceThatImplementsIAsyncDisposable</span><span class="p">&gt;();</span> <span class="c1">// When the scope disposes, any services that implement IAsyncDisposable will be</span> <span class="c1">// Disposed of using DisposeAsync rather than Dispose.</span>
<span class="p">}</span>
</code></pre></div></div> <p>[<a href="https://github.com/autofac/Autofac/pull/1037">PR #1037</a> - thanks <a href="https://github.com/alistairjevans">@alistairjevans</a>!]</p> <h3 id="nullable-reference-type-annotations">Nullable Reference Type Annotations</h3> <p>Autofac is now build using <a href="https://docs.microsoft.com/en-us/dotnet/csharp/nullable-references">nullable reference type annotations</a>. This allows developers to get sensible compiler warnings if they opt-in, thus avoiding <code class="language-plaintext highlighter-rouge">NullReferenceException</code> instances where possible.</p> <p><img src="https://user-images.githubusercontent.com/19165743/70164455-1973c600-16b9-11ea-8ef8-bf12f021c664.png" alt="Nullable reference type warnings"></p> <p>[<a href="https://github.com/autofac/Autofac/pull/1037">PR #1037</a> - thanks <a href="https://github.com/alistairjevans">@alistairjevans</a>!]</p> <h3 id="build-callbacks-in-lifetime-scopes">Build Callbacks in Lifetime Scopes</h3> <p>One method of running code at container build time is <a href="https://autofac.readthedocs.io/en/latest/lifetime/startup.html">by registering a build callback</a>. Previously this only worked at the container level, but we&#x2019;ve added the ability to register callbacks that run at lifetime scope creation as well.</p> <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">scope</span> <span class="p">=</span> <span class="n">container</span><span class="p">.</span><span class="nf">BeginLifetimeScope</span><span class="p">(</span><span class="n">cfg</span> <span class="p">=&gt;</span>
<span class="p">{</span> <span class="n">cfg</span><span class="p">.</span><span class="nf">RegisterBuildCallback</span><span class="p">(</span><span class="n">scope</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="cm">/* do something */</span> <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div> <p>The callback will be invoked just prior to <code class="language-plaintext highlighter-rouge">BeginLifetimeScope</code> exiting, after any startable components are instantiated.</p> <p>[<a href="https://github.com/autofac/Autofac/issues/985">Fixes #985</a>; <a href="https://github.com/autofac/Autofac/pull/1054">PR #1054</a> - thanks <a href="https://github.com/alistairjevans">@alistairjevans</a>!]</p> <h3 id="other-fixes">Other Fixes</h3> <h2 id="still-todo">Still TODO</h2> <p>Now that Autofac 5.0 is out, there is still a lot to do. We&#x2019;ll be working on these things as fast as we can:</p> <ul> <li>Updating integration packages we support so they ensure compatibility with Autofac 5.</li> <li>Updating the documentation to reflect the above changes.</li>
</ul> <p>Some of this is sitting in branches ready to go, other things need to be done now that we have this core package out there.</p> <p><strong>If your favorite integration isn&#x2019;t ready yet, we&#x2019;re doing our best.</strong> Rather than filing &#x201C;When will this be ready?&#x201D; issues, consider pull requests with the required updates.</p> <h2 id="thank-you">Thank You!</h2> <p>On a more personal note, I&#x2019;d like to thank <a href="https://github.com/autofac/Autofac/graphs/contributors">all the folks that threw code at Autofac</a> in the past few months. We appreciate the effort and the contributions. NuGet tells me we&#x2019;re at 41,587,203 total downloads as I write this, #27 on <a href="https://www.nuget.org/stats/packages">the list of top package downloads in the last six weeks</a>. We have 25 integration packages we maintain along with documentation, examples, and support.</p> <p>Without your contributions this wouldn&#x2019;t be possible. Thank you so much!</p> <p>Hopefully <code class="language-plaintext highlighter-rouge">git shortlog</code> and the <a href="https://github.com/autofac/Autofac/graphs/contributors">GitHub contributors page</a> didn&#x2019;t fail me - I don&#x2019;t want to miss anyone!</p> <ins class="adsbygoogle"></ins> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>