<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Krebs on Security -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Krebs on Security</h1>
    <div class="entry"> <p>As an&#xA0;early domain name investor, <strong>Mike O&#x2019;Connor</strong> had by 1994 snatched up several choice online destinations, including bar.com, cafes.com, grill.com, place.com, pub.com and television.com. Some he sold over the years, but for the past 26 years O&#x2019;Connor refused to auction perhaps the most sensitive domain in his stable &#x2014; <strong>corp.com</strong>. It is&#xA0;sensitive because years of testing shows whoever wields it would have access to an unending stream of passwords, email and other proprietary data belonging to hundreds of thousands of systems at major companies around the globe.</p>
<p><img class="aligncenter wp-image-50460" src="https://krebsonsecurity.com/wp-content/uploads/2020/02/corpcomtoxic.png" alt width="591"></p>
<p>Now, facing 70 and seeking to simplify his estate, O&#x2019;Connor is finally selling corp.com. The asking price &#x2014; $1.7 million &#x2014; is hardly outlandish for a 4-letter domain with such strong commercial appeal. O&#x2019;Connor said he hopes <strong>Microsoft Corp.</strong> will buy it, but fears they won&#x2019;t and instead it will get snatched up by someone working with organized cybercriminals or state-funded hacking groups bent on undermining the interests of Western corporations.</p>
<p>One reason O&#x2019;Connor hopes Microsoft will buy it is that by virtue of the unique way <strong>Windows</strong> handles resolving domain names on a local network, virtually all of the computers trying to share sensitive data with corp.com are somewhat confused&#xA0;Windows PCs. More importantly, early versions of Windows actually encouraged the adoption of insecure settings that made it more likely Windows computers might try to share sensitive data with corp.com.</p>
<p>At issue is a problem known as &#x201C;<a href="https://www.computerworld.com/article/3480799/icann-seeks-to-tackle-dns-namespace-collision-risks.html">namespace collision</a>,&#x201D; a situation where domain names intended to be used exclusively on an internal company network end up overlapping with domains that can resolve normally on the open Internet.</p>
<p>Windows computers on an internal corporate network validate other things on that network using a Microsoft innovation called <a href="https://en.wikipedia.org/wiki/Active_Directory">Active Directory</a>, which is the umbrella term for a broad range of identity-related services in Windows environments. A core part of the way these things find each other involves a Windows feature called &#x201C;<a href="https://www.itprotoday.com/security/whats-dns-name-devolution">DNS name devolution</a>,&#x201D; which is a kind of network shorthand that makes it easier to find other computers or servers without having to specify a full, legitimate domain name for those resources.</p>
<p>For instance, if a company runs an internal network with the name internalnetwork.example.com, and an employee on that network wishes to access a shared drive called &#x201C;drive1,&#x201D; there&#x2019;s no need to type &#x201C;drive1.internalnetwork.example.com&#x201D; into Windows Explorer; typing &#x201C;\\drive1\&#x201D; alone will suffice, and Windows takes care of the rest.</p>
<p>But things can get far trickier with an internal Windows domain that does not map back to a second-level domain the organization actually owns and controls. And unfortunately, in early versions of Windows that supported Active Directory &#x2014;&#xA0;Windows 2000 Server, for example &#x2014; the default or example Active Directory path was given as &#x201C;corp,&#x201D; and many companies apparently adopted this setting without modifying it to include a domain they controlled.</p>
<p>Compounding things further, some companies then went on to build (and/or assimilate) vast networks of networks on top of this erroneous setting.</p>
<p>Now, none of this was much of a security concern back in the day when it was impractical for employees to lug their bulky desktop computers and monitors outside of the corporate network. But what happens when an employee working at a company with an Active Directory network path called &#x201C;corp&#x201D; takes a company laptop to the local Starbucks?</p>
<p>Chances are good that at least some resources on the employee&#x2019;s laptop will still try to access that internal &#x201C;corp&#x201D; domain. And because of the way DNS name devolution works on Windows, that company laptop online via the Starbucks wireless connection is likely to then seek those same resources at &#x201C;corp.com.&#x201D;</p>
<p>In practical terms, this means that whoever controls corp.com can passively intercept private communications from hundreds of thousands of computers that end up being taken outside of a corporate environment which uses this &#x201C;corp&#x201D; designation for its Active Directory domain.</p>
<h4>INSTANT CORPORATE BOTNET, ANYONE?</h4>
<p>That&#x2019;s according to&#xA0;<strong>Jeff Schmidt</strong>, a security expert who <a href="https://www.icann.org/en/system/files/files/name-collision-mitigation-study-06jun14-en.pdf">conducted a lengthy study on DNS namespace collisions</a> funded in part by grants from the <strong>U.S. Department of Homeland Security</strong>. As part of that analysis, Schmidt convinced O&#x2019;Connor to hold off selling corp.com so he and others could better understand and document the volume and types of traffic flowing to it each day.</p>
<p>During an eight month analysis of wayward internal corporate traffic destined for corp.com in 2019, Schmidt found more than 375,000 Windows PCs were trying to send this domain information it had no business receiving &#x2014; including attempts to log in to internal corporate networks and access specific file shares on those networks.</p>
<p>For a brief period during that testing, Schmidt&#x2019;s company <strong>JAS Global Advisors</strong> accepted connections at corp.com that mimicked the way local Windows networks handle logins and file-sharing attempts.</p>
<p>&#x201C;It was terrifying,&#x201D; Schmidt said. &#x201C;We discontinued the experiment after 15 minutes and destroyed the data. A well-known offensive tester that consulted with JAS on this remarked that during the experiment it was &#x2018;raining credentials&#x2019; and that he&#x2019;d never seen anything like it.&#x201D;</p>
<p>Likewise, JAS temporarily configured corp.com to accept incoming email.</p>
<p>&#x201C;After about an hour we received in excess of 12 million emails and discontinued the experiment,&#x201D; Schmidt said. &#x201C;While the vast majority of the emails were of an automated nature, we found some of the emails to be sensitive and thus destroyed the entire corpus without further analysis.&#x201D;</p>
<p>Schmidt said he and others concluded that whoever ends up controlling corp.com could have an instant botnet of well-connected enterprise machines.</p>
<p>&#x201C;Hundreds of thousands of machines directly exploitable and countless more exploitable via lateral movement once in the enterprise,&#x201D; he said. &#x201C;Want an instant foothold into about 30 of the world&#x2019;s largest companies according to the Forbes Global 2000? Control corp.com.&#x201D;<span id="more-50407"></span></p>
<h4>THE EARLY ADVENTURES OF CORP.COM</h4>
<p>Schmidt&#x2019;s findings closely mirror what O&#x2019;Connor discovered in the few years corp.com was live on the Internet after he initially registered it back in 1994. O&#x2019;Connor said early versions of a now-defunct Web site building tool called Microsoft FrontPage suggested corporation.com (another domain registered early on by O&#x2019;Connor) as an example domain in its setup wizard.</p>
<p>That experience, portions of which are <a href="https://web.archive.org/web/19971016071741/http://www.corp.com/">still indexed by the indispensable Internet Archive</a>, saw O&#x2019;Connor briefly redirecting queries for the domain to the Web site of a local adult sex toy shop as a joke. He soon got angry emails from confused people who&#x2019;d also CC&#x2019;d Microsoft co-founder Bill Gates.</p>
<div id="attachment_50459" class="wp-caption aligncenter"><a class="lightbox" href="https://krebsonsecurity.com/wp-content/uploads/2020/02/corpcomarchive.png"><img class="wp-image-50459" src="https://krebsonsecurity.com/wp-content/uploads/2020/02/corpcomarchive.png" alt width="596"></a><p class="wp-caption-text">Archive.org&#x2019;s index of corp.com from 1997, when its owner Mike O&#x2019;Connor briefly enabled a Web site mainly to shame Microsoft for the default settings of its software.</p></div>
<p>O&#x2019;Connor said he also briefly enabled an email server on corp.com, mainly out of morbid curiosity to see what would happen next.</p>
<p>&#x201C;Right away I started getting sensitive emails, including pre-releases of corporate financial filings with The U.S. Securities and Exchange Commission, human resources reports and all kinds of scary things,&#x201D; O&#x2019;Connor recalled in an interview with KrebsOnSecurity. &#x201C;For a while, I would try to correspond back to corporations that were making these mistakes, but most of them didn&#x2019;t know what to do with that. So I finally just turned it off.&#x201D;</p>
<h4>TOXIC WASTE CLEANUP IS HARD</h4>
<p>Microsoft declined to answer specific questions in response to Schmidt&#x2019;s findings on the wayward corp.com traffic. But a spokesperson for the company shared a written statement acknowledging that &#x201C;we sometimes reference &#x2018;corp&#x2019; as a label in our naming documentation.&#x201D;</p>
<p>&#x201C;We recommend customers own second level domains to prevent being routed to the internet,&#x201D; the statement reads, linking to <a href="https://social.technet.microsoft.com/wiki/contents/articles/34981.active-directory-best-practices-for-internal-domain-and-network-names.aspx">this Microsoft Technet article</a> on best practices for setting up domains in Active Directory.</p>
<p>Over the years, Microsoft has shipped <a href="https://www.security-database.com/detail.php?alert=KB971888">several</a> <a href="https://msrc-blog.microsoft.com/2015/02/10/ms15-011-ms15-014-hardening-group-policy/">software updates</a> to help decrease the likelihood of namespace collisions that <a href="https://www.jasadvisors.com/jasbug-improper-use-of-the-dns-for-authentication-and-over-the-internet-exploitation-scenarios/">could create a security problem</a> for companies that still rely on Active Directory domains that do not map to a domain they control.</p>
<p>But both O&#x2019;Connor and Schmidt say hardly any vulnerable organizations have deployed these fixes for two reasons. First, doing so requires the organization to take down its entire Active Directory network simultaneously for some period of time. Second, according to Microsoft applying the patch(es) will likely break or at least slow down a number of applications that the affected organization relies upon for day-to-day operations.</p>
<p>Faced with either or both of these scenarios, most affected companies probably decided the actual risk of not applying these updates was comparatively low, O&#x2019;Connor said.</p>
<p>&#x201C;The problem is that when you read the instructions for doing the repair, you realize that what they&#x2019;re saying is, &#x2018;Okay Megacorp, in order to apply this patch and for everything to work right, you have to take down all of your Active Directory services network-wide, and when you bring them back up after you applied the patch, a lot of your servers may not work properly&#x2019;,&#x201D; O&#x2019;Connor said.</p>
<p>Curiously, Schmidt shared slides from a report submitted to a working group on namespace collisions suggesting that at least some of the queries corp.com received while he was monitoring it may have come from Microsoft&#x2019;s own internal networks.</p>
<div id="attachment_50457" class="wp-caption aligncenter"><a class="lightbox" href="https://krebsonsecurity.com/wp-content/uploads/2020/02/mscollision.png"><img class="wp-image-50457" src="https://krebsonsecurity.com/wp-content/uploads/2020/02/mscollision.png" alt width="592"></a><p class="wp-caption-text">Image: JAS Global Advisors</p></div>
<p>&#x201C;The reason I believe this is Microsoft&#x2019;s issue to solve is that someone that followed Microsoft&#x2019;s recommendations when establishing an active directory several years back now has a problem,&#x201D; Schmidt said.</p>
<p>&#x201C;Even if all patches are applied and updated to Windows 10,&#x201D; he continued. &#x201C;And the problem will persist while there are active directories named &#x2018;corp&#x2019; &#x2013; which is forever. More practically, if corp.com falls into bad hands, the impact will be on Microsoft enterprise clients &#x2013; and at large scale &#x2013; paying, Microsoft clients they should protect.&#x201D;</p>
<p>O&#x2019;Connor said Microsoft actually offered to buy the domain several years back for $20,000. He turned them down, saying that at the time he thought it was too low and didn&#x2019;t reflect the market value of the domain.</p>
<p>Asked why he didn&#x2019;t just give corp.com to Microsoft as an altruistic gesture, O&#x2019;Connor said he believes the software giant ought to be accountable for its products and mistakes.</p>
<p>&#x201C;It seems to me that Microsoft should stand up and shoulder the burden of the mistake they made,&#x201D; he said. &#x201C;But they&#x2019;ve shown no real interest in doing that, and so I&#x2019;ve shown no interest in giving it to them. I don&#x2019;t really need the money. I&#x2019;m basically auctioning off a chemical waste dump because I don&#x2019;t want to pass it on to my kids and burden them with it. My frustration here is the good guys don&#x2019;t care and the bad guys probably don&#x2019;t know about it. But I expect the bad guys would like it.&#x201D;</p>
<p>Further reading:</p>
<p><a href="https://www.icann.org/en/system/files/files/name-collision-mitigation-study-06jun14-en.pdf">Mitigating the Risk of DNS Namespace Collisions</a> (PDF)</p>
<p><a href="https://www.youtube.com/watch?v=ZPbyDSvGasw">DEFCON 21 &#x2013; DNS May Be Hazardous to your Health (Robert Stucke)</a></p>
<p><a href="https://www.verisign.com/assets/labs/MitM-Attack-by-Name-Collision-Cause-Analysis-and-WPAD-Vulnerability-Assessment-in-the-New-gTLD-Era.pdf">Mitigating the Risk of Name Collision-Based Man-in-the-Middle Attacks</a>&#xA0;(PDF)</p>
<p><strong>Update, 6:22 p.m. ET:</strong> Added the bit at the end about the $20,000 offer a few years back from Microsoft, a detail that I somehow omitted from the original story.</p> <p class="mid-banner"> <a href="https://www.akamai.com/us/en/security.jsp?utm_source=krebsonsecurity&amp;utm_medium=display&amp;utm_id=F-MC-44701&amp;utm_campaign=unifiedsecurity_digital_2019&amp;utm_content=unifiedsecurity_global&amp;utm_term=unifiedsecurity_ros"> <img src="/b-akamai/30.jpg"> </a> </p> <p class="small">Tags: <a href="https://krebsonsecurity.com/tag/active-directory/">Active Directory</a>, <a href="https://krebsonsecurity.com/tag/corp-com/">corp.com</a>, <a href="https://krebsonsecurity.com/tag/dns-name-devolution/">DNS name devolution</a>, <a href="https://krebsonsecurity.com/tag/jas-global-advisors/">JAS Global Advisors</a>, <a href="https://krebsonsecurity.com/tag/jeff-schmidt/">Jeff Schmidt</a>, <a href="https://krebsonsecurity.com/tag/microsoft-corp/">Microsoft Corp.</a>, <a href="https://krebsonsecurity.com/tag/microsoft-windows/">Microsoft Windows</a>, <a href="https://krebsonsecurity.com/tag/mike-oconnor/">Mike O&apos;Connor</a>, <a href="https://krebsonsecurity.com/tag/namespace-collision/">namespace collision</a>, <a href="https://krebsonsecurity.com/tag/u-s-department-of-homeland-security/">U.S. Department of Homeland Security</a></p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>