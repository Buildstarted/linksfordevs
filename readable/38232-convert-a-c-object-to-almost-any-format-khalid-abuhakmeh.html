<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Convert A C# Object To Almost Any Format | Khalid Abuhakmeh -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Convert A C# Object To Almost Any Format  |
      Khalid Abuhakmeh</h1><div><div class="post-content"><p>Data formats are an essential part of any programming toolbox. C# developers must understand how to take plain-old-C#-objects (POCOs) and convert them into standard data formats. The .NET community commonly refers to the conversion of data objects as serialization.</p><p>In this post, I will show you how to take a simple POCO and serialize it into the following formats:</p><ul><li>JavaScript Object Notation (JSON)</li><li>Extensible Markup Language (XML)</li><li>YAML Ain’t Markup Language (YAML)</li><li>Comma Separated Values (CSV)</li><li>Tom’s Obvious, Minimal Language (TOML)</li></ul><p>This post is for beginners starting in C# development to seasoned developers needing a quick refresher on how to serialize data. While this post does not contain all the formats you could convert a POCO to, these are the formats I commonly run into when developing most of my applications.</p><p>A note before we get started, the examples you will see all write our objects to a <code class="highlighter-rouge">string</code> value in memory. Serializing in memory is the most flexible approach I’ve found, as it usually works for console applications, web applications, and most .NET use cases. That said, it may not be right for you. Please consider your use case before copying any of the following code, and be prepared to make modifications to meet your needs.</p><p>Also, all examples are implemented inside a class so that I can iterate over each format. The code you’ll want to pay attention to will be inside the <code class="highlighter-rouge">RunAsync</code> method of the <code class="highlighter-rouge">IRun</code> interface. Additionally, we’ll be serializing a <code class="highlighter-rouge">Friend</code> POCO in each example with varying data types.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span><span class="n">friend</span><span class="p">=</span><span class="k">new</span><span class="n">Friend</span><span class="p">{</span><span class="n">Id</span><span class="p">=</span><span class="m">1</span><span class="p">,</span><span class="n">Debt</span><span class="p">=</span><span class="m">10</span><span class="n">m</span><span class="p">,</span><span class="n">Met</span><span class="p">=</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">,</span><span class="n">Name</span><span class="p">=</span><span class="s">"Khalid Abuhakmeh"</span><span class="p">};</span></code></pre></div></div><p><strong>If you’d like to skip directly to the code, you can <a href="https://github.com/khalidabuhakmeh/conversions">download the sample project</a> at GitHub.</strong></p><h2 id="javascript-object-notation">JavaScript Object Notation</h2><h3 id="what-is-json">What Is JSON?</h3><p>JavaScript object notation is a structure characterized by curly braces (<code class="highlighter-rouge">{</code> and <code class="highlighter-rouge">}</code>), name-value pairs, and arrays. JSON is a format commonly used on the web. The format is primarily used in the frontend of many applications within JavaScript code, served by backend APIs for client consumption, and transmitted between APIs.</p><p>JSON was created with two main goals in mind:</p><p>It is easy for humans to read and write.
It is easy for machines to parse and generate.</p><p>While the format itself is language-agnostic, it is inspired heavily by C based language like C, JavaScript, and C#. If you want to understand the specifications of this format fully, I recommend going to <a href="https://json.org">JSON.org</a>.</p><h3 id="when-should-i-use-json">When Should I Use JSON?</h3><p>JSON is ubiquitous, and I would bet all modern programming languages support it. Here are a few cases where you should consider JSON as an option for data interchange:
You are building a web-based API
You are developing a JavaScript application
You want a human-readable format
As a .NET developer, many of .NET’s frameworks support JSON, and recently in ASP.NET Core 3, .NET developers received a new <code class="highlighter-rouge">JsonSerializer</code> in the <code class="highlighter-rouge">System.Text.Json</code> namespace.</p><p>The similarities between a POCO and JSON make it an ideal match since most JSON results will look very similar to C# definitions as you’ll see in the example below.</p><h3 id="jsonnet-serialization">JSON.NET Serialization</h3><p>So you’re ready to serialize a C# object to JSON. In .NET, you have two distinct choices, which I will show you how to use. The first is <code class="highlighter-rouge">JSON.NET</code> and is your best choice today.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">System</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Threading.Tasks</span><span class="p">;</span><span class="k">using</span><span class="nn">Newtonsoft.Json</span><span class="p">;</span><span class="k">namespace</span><span class="nn">conversions</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">JsonNet</span><span class="p">:</span><span class="n">IRun</span><span class="p">{</span><span class="k">public</span><span class="kt">string</span><span class="n">Name</span><span class="p">=&gt;</span><span class="s">"Json.NET"</span><span class="p">;</span><span class="k">public</span><span class="n">Task</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="n">input</span><span class="p">)</span><span class="p">{</span><span class="kt">var</span><span class="n">result</span><span class="p">=</span><span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="k">return</span><span class="n">Task</span><span class="p">.</span><span class="n">CompletedTask</span><span class="p">;</span><span class="p">}</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p>As you can see, <code class="highlighter-rouge">JSON.NET</code> handles most of the ceremony around serialization for you. You give it a type, and it can convert it directly in a <code class="highlighter-rouge">string</code>. The resulting output of our serialization is as follows.</p><div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">{"Id":1,"Name":"Khalid Abuhakmeh","Met":"2019-10-02T21:45:17.895679-04:00","Debt":10.0}
</span></code></pre></div></div><p>Note, you can alter the output by following the <a href="https://www.newtonsoft.com/json/help/html/Introduction.htm">JSON.NET</a> documentation.</p><h3 id="systemtextjson-serialization">System.Text.Json Serialization</h3><p>With the release of .NET Core 3, the community now has access to a built-in <code class="highlighter-rouge">JsonSerializer</code> developed by the same developer who developed JSON.NET, <a href="https://twitter.com/JamesNK">James Newton King</a>. It has many similarities with JSON.NET and is built from the ground up with performance in mind. It is less configurable than JSON.NET and currently doesn’t handle some of the same edge cases that mature library does.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">System</span><span class="p">;</span><span class="k">using</span><span class="nn">System.IO</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Text.Json</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Threading.Tasks</span><span class="p">;</span><span class="k">namespace</span><span class="nn">conversions</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">Json</span><span class="p">:</span><span class="n">IRun</span><span class="p">{</span><span class="k">public</span><span class="kt">string</span><span class="n">Name</span><span class="p">=&gt;</span><span class="s">"System.Text.Json"</span><span class="p">;</span><span class="k">public</span><span class="k">async</span><span class="n">Task</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="n">input</span><span class="p">)</span><span class="p">{</span><span class="kt">var</span><span class="n">stream</span><span class="p">=</span><span class="k">new</span><span class="nf">MemoryStream</span><span class="p">();</span><span class="k">await</span><span class="n">JsonSerializer</span><span class="p">.</span><span class="nf">SerializeAsync</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">input</span><span class="p">);</span><span class="c1">// reset the stream back to 0</span><span class="n">stream</span><span class="p">.</span><span class="n">Position</span><span class="p">=</span><span class="m">0</span><span class="p">;</span><span class="k">using</span><span class="nn">var</span><span class="n">reader</span><span class="p">=</span><span class="k">new</span><span class="nf">StreamReader</span><span class="p">(</span><span class="n">stream</span><span class="p">);</span><span class="c1">// we reread the stream to a string</span><span class="kt">var</span><span class="n">json</span><span class="p">=</span><span class="k">await</span><span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEndAsync</span><span class="p">();</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">json</span><span class="p">);</span><span class="p">}</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p>Running the code above we get the following result:</p><div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">{"Id":1,"Name":"Khalid Abuhakmeh","Met":"2019-10-02T21:45:17.895679-04:00","Debt":10}
</span></code></pre></div></div><p>The one thing I noticed is that the decimal value for <code class="highlighter-rouge">Debt</code> is handled differently than the default configuration for JSON.NET as it drops the <code class="highlighter-rouge">.0</code> from the decimal value of <code class="highlighter-rouge">10</code>.</p><p>The above example serializes to a memory stream, but you can also just utilize the <code class="highlighter-rouge">Serialize</code> method on <code class="highlighter-rouge">JsonSerializer</code> for a simpler code base.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span><span class="k">class</span><span class="nc">JsonSimple</span><span class="p">:</span><span class="n">IRun</span><span class="p">{</span><span class="k">public</span><span class="kt">string</span><span class="n">Name</span><span class="p">=&gt;</span><span class="s">"System.Text.Json Simple"</span><span class="p">;</span><span class="k">public</span><span class="n">Task</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="n">input</span><span class="p">)</span><span class="p">{</span><span class="kt">var</span><span class="n">result</span><span class="p">=</span><span class="n">JsonSerializer</span><span class="p">.</span><span class="nf">Serialize</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="k">return</span><span class="n">Task</span><span class="p">.</span><span class="n">CompletedTask</span><span class="p">;</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p>Note that the <code class="highlighter-rouge">Serialize</code> is not <code class="highlighter-rouge">async</code> so we have to return <code class="highlighter-rouge">Task.CompletedTask</code> from our method.</p><h2 id="extensible-markup-language-xml">Extensible Markup Language (XML)</h2><h3 id="what-is-xml">What Is XML?</h3><p>The Extensible Markup Language, also known as XML, is the original gangster of data formats (at least when it comes to the web). It is a format that utilizes tags, attributes, and schemas to create highly structured and dense results. Like JSON, XML was designed to be readable by humans and machines.</p><blockquote><p>The design goals of XML emphasize simplicity, generality, and usability across the Internet. <cite>–<a href="https://en.wikipedia.org/wiki/XML">Wikipedia</a></cite></p></blockquote><h3 id="when-should-i-use-xml">When Should I Use XML?</h3><p>XML offers more options for encapsulating data and can be more efficient as a data format. Before JSON took over the web, XML was the defacto way of transferring information between backends and frontends. Like JSON, XML enjoys broad support in the .NET ecosystem with an <code class="highlighter-rouge">XmlSerializer</code> being available in the <code class="highlighter-rouge">using System.Xml.Serialization</code> namespace.</p><h3 id="xml-serialization">XML Serialization</h3><p>This example will look very similar to JSON serialization, but note that we need to create the <code class="highlighter-rouge">XmlSerializer</code> for the specific type we are serializing.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">System</span><span class="p">;</span><span class="k">using</span><span class="nn">System.IO</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Text</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Text.Unicode</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Threading.Tasks</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Xml</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Xml.Serialization</span><span class="p">;</span><span class="k">namespace</span><span class="nn">conversions</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">Xml</span><span class="p">:</span><span class="n">IRun</span><span class="p">{</span><span class="k">public</span><span class="kt">string</span><span class="n">Name</span><span class="p">=&gt;</span><span class="k">nameof</span><span class="p">(</span><span class="n">Xml</span><span class="p">);</span><span class="k">public</span><span class="k">async</span><span class="n">Task</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="n">input</span><span class="p">)</span><span class="p">{</span><span class="c1">// if you can, only create one serializer</span><span class="c1">// creating serializers is an expensive</span><span class="c1">// operation and can be slow</span><span class="kt">var</span><span class="n">serializer</span><span class="p">=</span><span class="k">new</span><span class="nf">XmlSerializer</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">T</span><span class="p">));</span><span class="c1">// we will write the our result to memory</span><span class="k">await</span><span class="k">using</span><span class="nn">var</span><span class="n">stream</span><span class="p">=</span><span class="k">new</span><span class="nf">MemoryStream</span><span class="p">();</span><span class="c1">// the string will be utf8 encoded</span><span class="k">await</span><span class="k">using</span><span class="nn">var</span><span class="n">writer</span><span class="p">=</span><span class="k">new</span><span class="nf">StreamWriter</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">);</span><span class="c1">// here we go!</span><span class="n">serializer</span><span class="p">.</span><span class="nf">Serialize</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span><span class="n">input</span><span class="p">);</span><span class="c1">// flush our write to make sure its all there</span><span class="k">await</span><span class="n">writer</span><span class="p">.</span><span class="nf">FlushAsync</span><span class="p">();</span><span class="c1">// reset the stream back to 0</span><span class="n">stream</span><span class="p">.</span><span class="n">Position</span><span class="p">=</span><span class="m">0</span><span class="p">;</span><span class="k">using</span><span class="nn">var</span><span class="n">reader</span><span class="p">=</span><span class="k">new</span><span class="nf">StreamReader</span><span class="p">(</span><span class="n">stream</span><span class="p">);</span><span class="c1">// we reread the stream to a string</span><span class="kt">var</span><span class="n">xml</span><span class="p">=</span><span class="k">await</span><span class="n">reader</span><span class="p">.</span><span class="nf">ReadToEndAsync</span><span class="p">();</span><span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">xml</span><span class="p">}</span><span class="s">\n"</span><span class="p">);</span><span class="p">}</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p><strong>Creating XML Serializers in a .NET application can be expensive. Cache these serializers when you can. It will give you a significant performance boost.</strong> Here is our result.</p><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="nt">&lt;Friend</span><span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span><span class="nt">&lt;Id&gt;</span>1<span class="nt">&lt;/Id&gt;</span><span class="nt">&lt;Name&gt;</span>Khalid Abuhakmeh<span class="nt">&lt;/Name&gt;</span><span class="nt">&lt;Met&gt;</span>2019-10-02T21:45:17.895679-04:00<span class="nt">&lt;/Met&gt;</span><span class="nt">&lt;Debt&gt;</span>10<span class="nt">&lt;/Debt&gt;</span><span class="nt">&lt;/Friend&gt;</span></code></pre></div></div><p>The example I have above is a simple XML serialization approach, but with .NET, we can decorate are classes to appropriate put values in tags or attributes.</p><h2 id="yaml-aint-markup-language">YAML Ain’t Markup Language</h2><h3 id="what-is-yaml">What Is YAML?</h3><p>YAML is a format defined by key-value pairs and an emphasis on whitespace. Described by the <a href="https://yaml.org">official site</a> as:</p><blockquote><p>YAML is a human-friendly data serialization standard for all programming languages. <cite>–YAML.org</cite></p></blockquote><p>Its simplicity can be refreshing, but it can also be infuriating when spaces and tabs cause subtle errors.</p><h3 id="when-should-i-use-yaml">When Should I Use YAML?</h3><p>I recommend using YAML when generating configuration files for services like Azure DevOps. Otherwise, I usually steer clear of this format.</p><h3 id="yaml-serialization">YAML Serialization</h3><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">System</span><span class="p">;</span><span class="k">using</span><span class="nn">System.IO</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Text</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Threading.Tasks</span><span class="p">;</span><span class="k">using</span><span class="nn">YamlDotNet.Serialization</span><span class="p">;</span><span class="k">namespace</span><span class="nn">conversions</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">Yaml</span><span class="p">:</span><span class="n">IRun</span><span class="p">{</span><span class="k">public</span><span class="kt">string</span><span class="n">Name</span><span class="p">=&gt;</span><span class="k">nameof</span><span class="p">(</span><span class="n">Yaml</span><span class="p">);</span><span class="k">public</span><span class="k">async</span><span class="n">Task</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="n">input</span><span class="p">)</span><span class="p">{</span><span class="kt">var</span><span class="n">serializer</span><span class="p">=</span><span class="k">new</span><span class="nf">Serializer</span><span class="p">();</span><span class="kt">var</span><span class="n">yaml</span><span class="p">=</span><span class="k">new</span><span class="nf">StringBuilder</span><span class="p">();</span><span class="k">await</span><span class="k">using</span><span class="nn">var</span><span class="n">textWriter</span><span class="p">=</span><span class="k">new</span><span class="nf">StringWriter</span><span class="p">(</span><span class="n">yaml</span><span class="p">);</span><span class="n">serializer</span><span class="p">.</span><span class="nf">Serialize</span><span class="p">(</span><span class="n">textWriter</span><span class="p">,</span><span class="n">input</span><span class="p">,</span><span class="k">typeof</span><span class="p">(</span><span class="n">T</span><span class="p">));</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">yaml</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span><span class="p">}</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p>There you have it, converting a C# object to YAML.</p><h2 id="comma-separated-values-csv">Comma Separated Values (CSV)</h2><h3 id="what-is-a-csv">What is a CSV?</h3><p>Comma Separated Values, commonly known as CSV files, are simple text files where a character separates values. In most cases, that separator is a <code class="highlighter-rouge">,</code> but it can be any special character, such as a <code class="highlighter-rouge">|</code> or even a tab.</p><h3 id="when-should-i-use-csv">When Should I Use CSV?</h3><p>Comma Separated Values can be helpful for your end users that need their data exported from the application you are building. It is very human-readable, and many spreadsheet applications support it. Not only is it an excellent format for exporting data, but it can also be even better for importing data into a system.</p><h3 id="csv-serialization">CSV Serialization</h3><p>In my example, I use a great NuGet package called <a href="https://joshclose.github.io/CsvHelper/">CsvHelper</a>. While there are other ways to parse CSV files, I find this particular package battle-hardened and fully featured. Let’s take a look at my example.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">System</span><span class="p">;</span><span class="k">using</span><span class="nn">System.IO</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Text</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Threading.Tasks</span><span class="p">;</span><span class="k">using</span><span class="nn">CsvHelper</span><span class="p">;</span><span class="k">namespace</span><span class="nn">conversions</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">Csv</span><span class="p">:</span><span class="n">IRun</span><span class="p">{</span><span class="k">public</span><span class="kt">string</span><span class="n">Name</span><span class="p">=&gt;</span><span class="s">"Csv"</span><span class="p">;</span><span class="k">public</span><span class="k">async</span><span class="n">Task</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="n">input</span><span class="p">)</span><span class="p">{</span><span class="kt">var</span><span class="n">csv</span><span class="p">=</span><span class="k">new</span><span class="nf">StringBuilder</span><span class="p">();</span><span class="k">await</span><span class="k">using</span><span class="nn">var</span><span class="n">textWriter</span><span class="p">=</span><span class="k">new</span><span class="nf">StringWriter</span><span class="p">(</span><span class="n">csv</span><span class="p">);</span><span class="k">using</span><span class="nn">var</span><span class="n">csvWriter</span><span class="p">=</span><span class="k">new</span><span class="nf">CsvWriter</span><span class="p">(</span><span class="n">textWriter</span><span class="p">);</span><span class="c1">// automatically map the properties of T</span><span class="n">csvWriter</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">AutoMap</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span><span class="c1">// we want to have a header row (optional)</span><span class="n">csvWriter</span><span class="p">.</span><span class="n">WriteHeader</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span><span class="k">await</span><span class="n">csvWriter</span><span class="p">.</span><span class="nf">NextRecordAsync</span><span class="p">();</span><span class="c1">// write our record</span><span class="n">csvWriter</span><span class="p">.</span><span class="nf">WriteRecord</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="c1">// make sure all records are flushed to stream</span><span class="k">await</span><span class="n">csvWriter</span><span class="p">.</span><span class="nf">FlushAsync</span><span class="p">();</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">csv</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span><span class="p">}</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p>We get the following output.</p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Id,Name,Met,Debt
1,Khalid Abuhakmeh,10/05/2019 17:01:04,10
</code></pre></div></div><h2 id="toms-obvious-minimal-language-toml">Tom’s Obvious, Minimal Language (TOML)</h2><h3 id="what-is-toml">What is TOML?</h3><p>TOML is a relatively new file format, that takes inspiration from YAML, but has attempted to fix the issues with whitespace significance.</p><blockquote><p>TOML aims to be a minimal configuration file format that’s easy to read due to obvious semantics. TOML is designed to map unambiguously to a hash table. TOML should be easy to parse into data structures in a wide variety of languages. <cite>–<a href="https://github.com/toml-lang/toml">TOML</a></cite></p></blockquote><h3 id="when-should-i-use-toml">When Should I Use TOML?</h3><p>Frankly, this is an excellent format for reading information, but I wouldn’t suggest using it as a data transfer format. JSON or XML is a better fit for most use-cases, but if you still want to use this format, it is extremely capable of supporting many data types.</p><h3 id="toml-serialization">TOML Serialization</h3><p>I ended up using a library called <a href="https://github.com/paiden/Nett"><code class="highlighter-rouge">Nett</code></a> for my example. It seems fully featured and capable of most TOML serialization.</p><div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span><span class="nn">System</span><span class="p">;</span><span class="k">using</span><span class="nn">System.Threading.Tasks</span><span class="p">;</span><span class="k">using</span><span class="nn">Nett</span><span class="p">;</span><span class="k">namespace</span><span class="nn">conversions</span><span class="p">{</span><span class="k">public</span><span class="k">class</span><span class="nc">Toml</span><span class="p">:</span><span class="n">IRun</span><span class="p">{</span><span class="k">public</span><span class="kt">string</span><span class="n">Name</span><span class="p">=&gt;</span><span class="k">nameof</span><span class="p">(</span><span class="n">Toml</span><span class="p">);</span><span class="k">public</span><span class="n">Task</span><span class="n">RunAsync</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="n">input</span><span class="p">)</span><span class="p">{</span><span class="kt">var</span><span class="n">settings</span><span class="p">=</span><span class="n">TomlSettings</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">cfg</span><span class="p">=&gt;</span><span class="n">cfg</span><span class="p">.</span><span class="n">ConfigureType</span><span class="p">&lt;</span><span class="kt">decimal</span><span class="p">&gt;(</span><span class="n">ct</span><span class="p">=&gt;</span><span class="n">ct</span><span class="p">.</span><span class="n">WithConversionFor</span><span class="p">&lt;</span><span class="n">TomlString</span><span class="p">&gt;(</span><span class="n">conv</span><span class="p">=&gt;</span><span class="n">conv</span><span class="p">.</span><span class="nf">ToToml</span><span class="p">(</span><span class="n">s</span><span class="p">=&gt;</span><span class="n">s</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"C"</span><span class="p">)))));</span><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">Nett</span><span class="p">.</span><span class="n">Toml</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="n">settings</span><span class="p">));</span><span class="k">return</span><span class="n">Task</span><span class="p">.</span><span class="n">CompletedTask</span><span class="p">;</span><span class="p">}</span><span class="p">}</span><span class="p">}</span></code></pre></div></div><p>Note that the previous code had to account for our <code class="highlighter-rouge">decimal</code> property. The <code class="highlighter-rouge">Nett</code> library supports any conversion through the <code class="highlighter-rouge">TomlSettings</code> class. The resulting output of our run is as expected.</p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Id = 1
Name = "Khalid Abuhakmeh"
Met = 2019-10-05 17:01:04.823084-04:00
Debt = "¤10.00"
</code></pre></div></div><h2 id="conclusion">Conclusion</h2><p>After reading this post, you should have a bevy of data format options for your application. Anyone of the examples above should get you a working serialization prototype. Remember that you should consider your specific use case and whether each sample needs to be tweaked.</p><p>As you can tell, looking through the samples, many of the approaches are quite similar. You take a C# object, serialize it into a <code class="highlighter-rouge">Stream</code> or directly into a <code class="highlighter-rouge">String</code> value. Some libraries will do much of the heavy lifting for you, while others give you low-level interfaces you need to put together.</p><p>If you can think of any other formats you use to serialize your data, I would love to hear about it. <a href="https://github.com/khalidabuhakmeh/conversions">This project is on GitHub</a>, so also feel free to submit your serialization examples.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>