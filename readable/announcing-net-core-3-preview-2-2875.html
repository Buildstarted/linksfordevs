<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Announcing .NET Core 3 Preview 2 | .NET Blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Announcing .NET Core 3 Preview 2 | .NET Blog - linksfor.dev(s)"/>
    <meta property="article:author" content="Richard LanderProgram Manager,&#xA0;.NET TeamFollow Richard"/>
    <meta property="og:description" content="Today, we are announcing .NET Core 3 Preview 2. It includes new features in .NET Core 3.0 and C# 8, in addition to the large number of new features in Preview 1. ASP.NET Core 3.0 Preview 2&#xA0; is also&#xA0;released today."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-preview-2/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Announcing .NET Core 3 Preview 2 | .NET Blog</title>
<div class="readable">
        <h1>Announcing .NET Core 3 Preview 2 | .NET Blog</h1>
            <div>by Richard LanderProgram Manager,&#xA0;.NET TeamFollow Richard</div>
            <div>Reading time: 25-31 minutes</div>
        <div>Posted here: 27 Feb 2019</div>
        <p><a href="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-preview-2/">https://devblogs.microsoft.com/dotnet/announcing-net-core-3-preview-2/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured"><div><div><div><div><p><img src="https://secure.gravatar.com/avatar/37f91ebe219df737566a4dc7cdd53b68?s=58&amp;d=mm&amp;r=g" width="58" height="58" alt="Avatar"></p><p>Richard</p></div></div></div><p>January 29th, 2019</p><p>Today, we are announcing .NET Core 3 Preview 2. It includes new features in .NET Core 3.0 and C# 8, in addition to the <a href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-net-core-3-preview-1-and-open-sourcing-windows-desktop-frameworks/" rel="nofollow" target="_blank">large number of new features in Preview 1</a>. <a href="https://blogs.msdn.microsoft.com/webdev/2019/01/29/aspnet-core-3-preview-2/" rel="nofollow" target="_blank">ASP.NET Core 3.0 Preview 2</a>&nbsp; is also&nbsp;released today. C# 8 Preview 2 is part of .NET Core 3 SDK, and was also released last week with <a href="https://blogs.msdn.microsoft.com/visualstudio/2019/01/24/visual-studio-2019-preview-2-is-now-available/" rel="nofollow" target="_blank">Visual Studio 2019 Preview 2</a>.</p><p><a href="https://aka.ms/netcore3download" rel="nofollow" target="_blank">Download and get started with .NET Core 3 Preview 2</a> right now on Windows, macOS and Linux.</p><p>In case you missed it, we made some big announcements with <a href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-net-core-3-preview-1-and-open-sourcing-windows-desktop-frameworks/" rel="nofollow" target="_blank">Preview 1</a>, including adding support for <a href="https://github.com/dotnet/winforms" target="_blank">Windows Forms</a> and <a href="https://github.com/dotnet/wpf" target="_blank">WPF</a> with .NET Core, on Windows, and that both UI frameworks will be open source. We also announced that we would support <a href="https://www.nuget.org/packages/EntityFramework/" rel="nofollow" target="_blank">Entity Framework 6</a> on .NET Core, which will come in a later preview. ASP.NET Core is also adding many features including Razor components.</p><p>Please provide feedback on the release in the comments below or at <a href="https://github.com/dotnet/core/issues/2263" target="_blank">dotnet/core #2263</a>. You can see complete details of the release in the <a href="https://github.com/dotnet/core/blob/master/release-notes/3.0/preview/3.0.0-preview2.md" rel="nofollow" target="_blank">.NET Core 3 Preview 2 release notes</a>.</p><p>.NET Core 3 will be supported in Visual Studio 2019, Visual Studio for Mac and Visual Studio Code. Visual Studio 2019 Preview 2 was released last week and has support for C# 8. The Visual Studio Code C# Extension (in <a href="https://github.com/OmniSharp/omnisharp-vscode/releases/tag/v1.18.0-beta5" target="_blank">pre-release channel</a>) was also just updated to support C# 8.</p><h2><a id="user-content-c-8" href="#c-8"></a>C# 8</h2><p>C# 8 is a major release of the language, as Mads describes in <a href="https://blogs.msdn.microsoft.com/dotnet/2019/01/24/do-more-with-patterns-in-c-8-0/" rel="nofollow" target="_blank">Do more with patterns in C# 8.0</a>, <a href="https://blogs.msdn.microsoft.com/dotnet/2018/12/05/take-c-8-0-for-a-spin/" rel="nofollow" target="_blank">Take C# 8.0 for a spin</a> and <a href="https://blogs.msdn.microsoft.com/dotnet/2018/11/12/building-c-8-0/" rel="nofollow" target="_blank">Building C# 8.0</a>. In this post, I’ll cover a few favorites that are new in Preview 2.</p><h3><a id="user-content-using-declarations" href="#using-declarations"></a>Using Declarations</h3><p>Are you tired of <em>using statements</em> that require indenting your code? No more! You can now write the following code, which attaches a <em>using declaration</em> to the scope of the current statement block and then disposes the object at the end of it.</p><div id="gist94342644">
    <div>
      <div>
        <div>
  <div id="file-using-declaration-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-using-declaration-cs-L1" data-line-number="1"></td>
        <td id="file-using-declaration-cs-LC1"><span>using</span> <span>System</span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L2" data-line-number="2"></td>
        <td id="file-using-declaration-cs-LC2"><span>using</span> <span>System</span>.<span>Linq</span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L3" data-line-number="3"></td>
        <td id="file-using-declaration-cs-LC3"><span>using</span> <span>System</span>.<span>Collections</span>.<span>Generic</span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L4" data-line-number="4"></td>
        <td id="file-using-declaration-cs-LC4"><span>using</span> <span>static</span> <span>System</span>.<span>Console</span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L5" data-line-number="5"></td>
        <td id="file-using-declaration-cs-LC5"><span>using</span> <span>System</span>.<span>IO</span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L6" data-line-number="6"></td>
        <td id="file-using-declaration-cs-LC6">
</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L7" data-line-number="7"></td>
        <td id="file-using-declaration-cs-LC7"><span>namespace</span> <span>usingapp</span></td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L8" data-line-number="8"></td>
        <td id="file-using-declaration-cs-LC8">{</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L9" data-line-number="9"></td>
        <td id="file-using-declaration-cs-LC9">    <span>class</span> <span>Program</span></td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L10" data-line-number="10"></td>
        <td id="file-using-declaration-cs-LC10">    {</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L11" data-line-number="11"></td>
        <td id="file-using-declaration-cs-LC11">        <span>static</span> <span>void</span> <span>Main</span>()</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L12" data-line-number="12"></td>
        <td id="file-using-declaration-cs-LC12">        {</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L13" data-line-number="13"></td>
        <td id="file-using-declaration-cs-LC13">            <span>var</span> <span>filename</span> <span>=</span> <span><span>"</span>Program.cs<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L14" data-line-number="14"></td>
        <td id="file-using-declaration-cs-LC14">            <span>var</span> <span>line</span> <span>=</span> <span>string</span>.<span>Empty</span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L15" data-line-number="15"></td>
        <td id="file-using-declaration-cs-LC15">            <span>var</span> <span>magicString</span> <span>=</span> <span><span>"</span>magicString<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L16" data-line-number="16"></td>
        <td id="file-using-declaration-cs-LC16">
</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L17" data-line-number="17"></td>
        <td id="file-using-declaration-cs-LC17">            <span>var</span> <span>file</span> <span>=</span> <span>new</span> <span>FileInfo</span>(<span>filename</span>);</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L18" data-line-number="18"></td>
        <td id="file-using-declaration-cs-LC18">            <span>using</span> <span>var</span> <span>reader</span> <span>=</span> <span>file</span>.<span>OpenText</span>();</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L19" data-line-number="19"></td>
        <td id="file-using-declaration-cs-LC19">            <span>while</span> ((<span>line</span> <span>=</span> <span>reader</span>.<span>ReadLine</span>())<span>!=</span> <span>null</span>)</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L20" data-line-number="20"></td>
        <td id="file-using-declaration-cs-LC20">            {</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L21" data-line-number="21"></td>
        <td id="file-using-declaration-cs-LC21">                <span>if</span> (<span>line</span>.<span>Contains</span>(<span>magicString</span>))  </td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L22" data-line-number="22"></td>
        <td id="file-using-declaration-cs-LC22">                { </td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L23" data-line-number="23"></td>
        <td id="file-using-declaration-cs-LC23">                    <span>WriteLine</span>(<span><span>"</span>Found string<span>"</span></span>); </td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L24" data-line-number="24"></td>
        <td id="file-using-declaration-cs-LC24">                    <span>return</span>;</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L25" data-line-number="25"></td>
        <td id="file-using-declaration-cs-LC25">                }</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L26" data-line-number="26"></td>
        <td id="file-using-declaration-cs-LC26">            }</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L27" data-line-number="27"></td>
        <td id="file-using-declaration-cs-LC27">
</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L28" data-line-number="28"></td>
        <td id="file-using-declaration-cs-LC28">            <span>WriteLine</span>(<span><span>"</span>String not found<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L29" data-line-number="29"></td>
        <td id="file-using-declaration-cs-LC29">        } <span><span>//</span> reader disposed here</span></td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L30" data-line-number="30"></td>
        <td id="file-using-declaration-cs-LC30">    }</td>
      </tr>
      <tr>
        <td id="file-using-declaration-cs-L31" data-line-number="31"></td>
        <td id="file-using-declaration-cs-LC31">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<h3><a id="user-content-switch-expressions" href="#switch-expressions"></a>Switch Expressions</h3><p>Anyone who uses C# probably loves the idea of a <em>switch statement</em>, but not the syntax. C# 8 introduces <em>switch expressions</em>, which enable the following: terser syntax, returns a value since it is an expression, and fully integrated with pattern matching. The <code>switch</code> keyword is “infix”, meaning the keyword sits between the tested value (here, that’s <code>o</code>) and the list of cases, much like <a href="https://docs.microsoft.com/dotnet/csharp/programming-guide/statements-expressions-operators/lambda-expressions#expression-lambdas" rel="nofollow" target="_blank">expression lambdas</a>. The following examples use the lambda syntax for methods, which integrates well with switch expressions but isn’t required.</p><p>You can see the syntax for <em>switch expressions</em> in the following example:</p><div id="gist94342682">
    <div>
      <div>
        <div>
  <div id="file-switch-expression-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-switch-expression-cs-L1" data-line-number="1"></td>
        <td id="file-switch-expression-cs-LC1"><span>static</span> <span>string</span> <span>Display</span>(<span>object</span> <span>o</span>) <span>=&gt;</span> <span>o</span> <span>switch</span></td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L2" data-line-number="2"></td>
        <td id="file-switch-expression-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L3" data-line-number="3"></td>
        <td id="file-switch-expression-cs-LC3">    <span>Point</span> { <span>X</span>: <span>0</span>, <span>Y</span>: <span>0</span> }         <span>=</span><span>&gt;</span> <span><span>"</span>origin<span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L4" data-line-number="4"></td>
        <td id="file-switch-expression-cs-LC4">    <span>Point</span> { <span>X</span>: <span>var</span> <span>x</span>, <span>Y</span>: <span>var</span> <span>y</span> } <span>=</span><span>&gt;</span> <span><span>$"</span>({<span>x</span>}, {<span>y</span>})<span>"</span></span>,</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L5" data-line-number="5"></td>
        <td id="file-switch-expression-cs-LC5">    <span>_</span>                            <span>=&gt;</span> <span><span>"</span>unknown<span>"</span></span></td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L6" data-line-number="6"></td>
        <td id="file-switch-expression-cs-LC6">};</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<p>There are two patterns at play in this example. <code>o</code> first matches with the <code>Point</code> <em>type pattern</em> and then with the <em>property pattern</em> inside the <em>{curly braces}</em>. The <code>_</code> describes the <code>discard pattern</code>, which is the same as <code>default</code> for <em>switch statements</em>.</p><p>You can go one step further, and rely on tuple deconstruction and parameter position, as you can see in the following example:</p><div id="gist94342710">
    <div>
      <div>
        <div>
  <div id="file-switch-expression-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-switch-expression-cs-L1" data-line-number="1"></td>
        <td id="file-switch-expression-cs-LC1"><span>static</span> <span>State</span> <span>ChangeState</span>(<span>State</span> <span>current</span>, <span>Transition</span> <span>transition</span>, <span>bool</span> <span>hasKey</span>) <span>=&gt;</span></td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L2" data-line-number="2"></td>
        <td id="file-switch-expression-cs-LC2">    (<span>current</span>, <span>transition</span>) <span>switch</span></td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L3" data-line-number="3"></td>
        <td id="file-switch-expression-cs-LC3">    {</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L4" data-line-number="4"></td>
        <td id="file-switch-expression-cs-LC4">        (<span>Opened</span>, <span>Close</span>)              <span>=&gt;</span> <span>Closed</span>,</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L5" data-line-number="5"></td>
        <td id="file-switch-expression-cs-LC5">        (<span>Closed</span>, <span>Open</span>)               <span>=&gt;</span> <span>Opened</span>,</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L6" data-line-number="6"></td>
        <td id="file-switch-expression-cs-LC6">        (<span>Closed</span>, <span>Lock</span>)   <span>when</span> <span>hasKey</span> <span>=&gt;</span> <span>Locked</span>,</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L7" data-line-number="7"></td>
        <td id="file-switch-expression-cs-LC7">        (<span>Locked</span>, <span>Unlock</span>) <span>when</span> <span>hasKey</span> <span>=&gt;</span> <span>Closed</span>,</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L8" data-line-number="8"></td>
        <td id="file-switch-expression-cs-LC8">        <span>_</span> <span>=&gt;</span> <span>throw</span> <span>new</span> <span>InvalidOperationException</span>(<span><span>$"</span>Invalid transition<span>"</span></span>)</td>
      </tr>
      <tr>
        <td id="file-switch-expression-cs-L9" data-line-number="9"></td>
        <td id="file-switch-expression-cs-LC9">    };</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<p>In this example, you can see you do not need to define a variable or explicit type for each of the cases. Instead, the compiler can match the tuple being testing with the tuples defined for each of the cases.</p><p>All of these patterns enable you to write declarative code that captures your intent instead of procedural code that implements tests for it. The compiler becomes responsible for implementing that boring procedural code and is guaranteed to always do it correctly.</p><p>There will still be cases where <em>switch statements</em> will be a better choice than <em>switch expressions</em> and patterns can be used with both syntax styles.</p><h3><a id="user-content-async-streams" href="#async-streams"></a>Async streams</h3><p>Async streams are another major improvement in C# 8. They have been changing with each preview and require that the compiler and the framework libraries match to work correctly. You need .NET Core 3.0 Preview 2 to use async streams if you want to develop with either Visual Studio 2019 Preview 2 or the latest preview of the <a href="https://github.com/OmniSharp/omnisharp-vscode/releases/tag/v1.18.0-beta5" target="_blank">C# extension for Visual Studio Code</a>. If you are using .NET Core 3.0 Preview 2 at the commandline, then everything will work as expected.</p><h2><a id="user-content-ieee-floating-point-improvements" href="#ieee-floating-point-improvements"></a>IEEE Floating-point improvements</h2><p>Floating point APIs are in the process of being updated to comply with <a href="https://en.wikipedia.org/wiki/IEEE_754-2008_revision" rel="nofollow" target="_blank">IEEE 754-2008 revision</a>. The goal of <a href="https://github.com/dotnet/corefx/issues/31901" target="_blank">this floating point project</a> is to expose all “required” operations and ensure that they are behaviorly compliant with the IEEE spec.</p><p>Parsing and formatting fixes:</p><ul><li>Correctly parse and round inputs of any length.</li><li>Correctly parse and format negative zero.</li><li>Correctly parse Infinity and NaN by performing a case-insensitive check and allowing an optional preceding <code>+</code> where applicable.</li></ul><p>New <a href="https://github.com/dotnet/corefx/issues/31903" target="_blank">Math APIs</a>:</p><ul><li><code>BitIncrement/BitDecrement</code> — corresponds to the <code>nextUp</code> and <code>nextDown</code> IEEE operations. They return the smallest floating-point number that compares greater or lesser than the input (respectively). For example, <code>Math.BitIncrement(0.0)</code> would return <code>double.Epsilon</code>.</li><li><code>MaxMagnitude/MinMagnitude</code> — corresponds to the <code>maxNumMag</code> and <code>minNumMag</code> IEEE operations, they return the value that is greater or lesser in magnitude of the two inputs (respectively). For example, <code>Math.MaxMagnitude(2.0, -3.0)</code> would return <code>-3.0</code>.</li><li><code>ILogB</code> — corresponds to the <code>logB</code> IEEE operation which returns an integral value, it returns the integral base-2 log of the input parameter. This is effectively the same as <code>floor(log2(x))</code>, but done with minimal rounding error.</li><li><code>ScaleB</code> — corresponds to the <code>scaleB</code> IEEE operation which takes an integral value, it returns effectively <code>x * pow(2, n)</code>, but is done with minimal rounding error.</li><li><code>Log2</code> — corresponds to the <code>log2</code> IEEE operation, it returns the base-2 logarithm. It minimizes rounding error.</li><li><code>FusedMultiplyAdd</code> — corresponds to the <code>fma</code> IEEE operation, it performs a fused multiply add. That is, it does <code>(x * y) + z</code> as a single operation, there-by minimizing the rounding error. An example would be <code>FusedMultiplyAdd(1e308, 2.0, -1e308)</code> which returns <code>1e308</code>. The regular <code>(1e308 * 2.0) - 1e308</code> returns <code>double.PositiveInfinity</code>.</li><li><code>CopySign</code> — corresponds to the <code>copySign</code> IEEE operation, it returns the value of <code>x</code>, but with the sign of <code>y</code>.</li></ul><h2><a id="user-content-net-platform-dependent-intrinsics" href="#net-platform-dependent-intrinsics"></a>.NET Platform Dependent Intrinsics</h2><p>We’ve added APIs that allow access to certain perf-oriented CPU instructions, such as the SIMD or Bit Manipulation instruction sets. These instructions can help achieve big performance improvements in certain scenarios, such as processing data efficiently in parallel. In addition to exposing the APIs for your programs to use, we have begun using these instructions to accelerate the .NET libraries too.</p><p>The following CoreCLR PRs demonstrate a few of the intrinsics, either via implementation or use:</p><ul><li><a href="https://github.com/dotnet/coreclr/pull/15585" target="_blank">Implement simple SSE2 hardware instrinsics</a></li><li><a href="https://github.com/dotnet/coreclr/pull/15538" target="_blank">Implement the SSE hardware intrinsics</a></li><li><a href="https://github.com/dotnet/coreclr/pull/16822" target="_blank">Arm64 Base HW Intrinsics</a></li><li><a href="https://github.com/dotnet/coreclr/pull/21073" target="_blank">Use TZCNT and LZCNT for Locate{First|Last}Found{Byte|Char}</a></li></ul><p>For more information, take a look at <a href="https://github.com/dotnet/designs/blob/master/accepted/platform-intrinsics.md" target="_blank">.NET Platform Dependent Intrinsics</a>, which defines an approach for defining this hardware infrastructure, allowing Microsoft, chip vendors or any other company or individual to define hardware/chip APIs that should be exposed to .NET code.</p><h2><a id="user-content-introducing-a-fast-in-box-json-writer--json-document" href="#introducing-a-fast-in-box-json-writer--json-document"></a>Introducing a fast in-box JSON Writer &amp; JSON Document</h2><p>Following the introduction of the JSON reader in preview1, we’ve added <code>System.Text.Json.Utf8JsonWriter</code> and <code>System.Text.Json.JsonDocument</code>.</p><p>As described in our <a href="https://github.com/dotnet/corefx/blob/master/src/System.Text.Json/roadmap/README.md" target="_blank">System.Text.Json roadmap</a>, we plan to provide a <a href="https://en.wikipedia.org/wiki/Plain_old_CLR_object" rel="nofollow" target="_blank">POCO</a> serializer and deserializer next.</p><h3><a id="user-content-utf8jsonwriter" href="#utf8jsonwriter"></a>Utf8JsonWriter</h3><p>The <code>Utf8JsonWriter</code> provides a high-performance, non-cached, forward-only way to write UTF-8 encoded JSON text from common .NET types like <code>String</code>, <code>Int32</code>, and <code>DateTime</code>. Like the reader, the writer is a foundational, low-level type, that can be leveraged to build custom serializers. Writing a JSON payload using the new <code>Utf8JsonWriter</code> is 30-80% faster than using the writer from <code>Json.NET</code> and does not allocate.</p><p>Here is a sample usage of the <code>Utf8JsonWriter</code> that can be used as a starting point:</p><div id="gist94342877">
    <div>
      <div>
        <div>
  <div id="file-json-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-json-cs-L1" data-line-number="1"></td>
        <td id="file-json-cs-LC1"><span>static</span> <span>int</span> <span>WriteJson</span>(<span>IBufferWriter</span>&lt;<span>byte</span>&gt; <span>output</span>, <span>long</span>[] <span>extraData</span>)</td>
      </tr>
      <tr>
        <td id="file-json-cs-L2" data-line-number="2"></td>
        <td id="file-json-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-json-cs-L3" data-line-number="3"></td>
        <td id="file-json-cs-LC3">    <span>var</span> <span>json</span> <span>=</span> <span>new</span> <span>Utf8JsonWriter</span>(<span>output</span>, <span>state</span>: <span>default</span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L4" data-line-number="4"></td>
        <td id="file-json-cs-LC4">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L5" data-line-number="5"></td>
        <td id="file-json-cs-LC5">    <span>json</span>.<span>WriteStartObject</span>();</td>
      </tr>
      <tr>
        <td id="file-json-cs-L6" data-line-number="6"></td>
        <td id="file-json-cs-LC6">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L7" data-line-number="7"></td>
        <td id="file-json-cs-LC7">    <span>json</span>.<span>WriteNumber</span>(<span><span>"</span>age<span>"</span></span>, <span>15</span>, <span>escape</span>: <span>false</span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L8" data-line-number="8"></td>
        <td id="file-json-cs-LC8">    <span>json</span>.<span>WriteString</span>(<span><span>"</span>date<span>"</span></span>, <span>DateTime</span>.<span>Now</span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L9" data-line-number="9"></td>
        <td id="file-json-cs-LC9">    <span>json</span>.<span>WriteString</span>(<span><span>"</span>first<span>"</span></span>, <span><span>"</span>John<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L10" data-line-number="10"></td>
        <td id="file-json-cs-LC10">    <span>json</span>.<span>WriteString</span>(<span><span>"</span>last<span>"</span></span>, <span><span>"</span>Smith<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L11" data-line-number="11"></td>
        <td id="file-json-cs-LC11">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L12" data-line-number="12"></td>
        <td id="file-json-cs-LC12">    <span>json</span>.<span>WriteStartArray</span>(<span><span>"</span>phoneNumbers<span>"</span></span>, <span>escape</span>: <span>false</span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L13" data-line-number="13"></td>
        <td id="file-json-cs-LC13">    <span>json</span>.<span>WriteStringValue</span>(<span><span>"</span>425-000-1212<span>"</span></span>, <span>escape</span>: <span>false</span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L14" data-line-number="14"></td>
        <td id="file-json-cs-LC14">    <span>json</span>.<span>WriteStringValue</span>(<span><span>"</span>425-000-1213<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L15" data-line-number="15"></td>
        <td id="file-json-cs-LC15">    <span>json</span>.<span>WriteEndArray</span>();</td>
      </tr>
      <tr>
        <td id="file-json-cs-L16" data-line-number="16"></td>
        <td id="file-json-cs-LC16">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L17" data-line-number="17"></td>
        <td id="file-json-cs-LC17">    <span>json</span>.<span>WriteStartObject</span>(<span><span>"</span>address<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L18" data-line-number="18"></td>
        <td id="file-json-cs-LC18">    <span>json</span>.<span>WriteString</span>(<span><span>"</span>street<span>"</span></span>, <span><span>"</span>1 Microsoft Way<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L19" data-line-number="19"></td>
        <td id="file-json-cs-LC19">    <span>json</span>.<span>WriteString</span>(<span><span>"</span>city<span>"</span></span>, <span><span>"</span>Redmond<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L20" data-line-number="20"></td>
        <td id="file-json-cs-LC20">    <span>json</span>.<span>WriteNumber</span>(<span><span>"</span>zip<span>"</span></span>, <span>98052</span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L21" data-line-number="21"></td>
        <td id="file-json-cs-LC21">    <span>json</span>.<span>WriteEndObject</span>();</td>
      </tr>
      <tr>
        <td id="file-json-cs-L22" data-line-number="22"></td>
        <td id="file-json-cs-LC22">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L23" data-line-number="23"></td>
        <td id="file-json-cs-LC23">    <span>json</span>.<span>WriteStartArray</span>(<span><span>"</span>ExtraArray<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L24" data-line-number="24"></td>
        <td id="file-json-cs-LC24">    <span>for</span> (<span>var</span> <span>i</span> <span>=</span> <span>0</span>; <span>i</span> <span>&lt;</span> <span>extraData</span>.<span>Length</span>; <span>i</span><span>++</span>)</td>
      </tr>
      <tr>
        <td id="file-json-cs-L25" data-line-number="25"></td>
        <td id="file-json-cs-LC25">    {</td>
      </tr>
      <tr>
        <td id="file-json-cs-L26" data-line-number="26"></td>
        <td id="file-json-cs-LC26">        <span>json</span>.<span>WriteNumberValue</span>(<span>extraData</span>[<span>i</span>]);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L27" data-line-number="27"></td>
        <td id="file-json-cs-LC27">    }</td>
      </tr>
      <tr>
        <td id="file-json-cs-L28" data-line-number="28"></td>
        <td id="file-json-cs-LC28">    <span>json</span>.<span>WriteEndArray</span>();</td>
      </tr>
      <tr>
        <td id="file-json-cs-L29" data-line-number="29"></td>
        <td id="file-json-cs-LC29">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L30" data-line-number="30"></td>
        <td id="file-json-cs-LC30">    <span>json</span>.<span>WriteEndObject</span>();</td>
      </tr>
      <tr>
        <td id="file-json-cs-L31" data-line-number="31"></td>
        <td id="file-json-cs-LC31">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L32" data-line-number="32"></td>
        <td id="file-json-cs-LC32">    <span>json</span>.<span>Flush</span>(<span>isFinalBlock</span>: <span>true</span>);</td>
      </tr>
      <tr>
        <td id="file-json-cs-L33" data-line-number="33"></td>
        <td id="file-json-cs-LC33">
</td>
      </tr>
      <tr>
        <td id="file-json-cs-L34" data-line-number="34"></td>
        <td id="file-json-cs-LC34">    <span>return</span> (<span>int</span>)<span>json</span>.<span>BytesWritten</span>;</td>
      </tr>
      <tr>
        <td id="file-json-cs-L35" data-line-number="35"></td>
        <td id="file-json-cs-LC35">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<p>The <code>Utf8JsonWriter</code> accepts <code>IBufferWriter&lt;byte&gt;</code> as the output location to synchronously write the json data into and you, as the caller, need to provide a concrete implementation. The platform does not currently include an implementation of this interface, but we plan to provide one that is backed by a resizable byte array. That implementation would enable synchronous writes, which could then be copied to any stream (either synchronously or asynchronously). If you are writing JSON over the network and include the <code>System.IO.Pipelines</code> package, you can leverage the <code>Pipe</code>-based implementation of the interface called <code>PipeWriter</code> to skip the need to copy the JSON from an intermediary buffer to the actual output.</p><p>You can take inspiration from this <a href="https://gist.github.com/ahsonkhan/c76a1cc4dc7107537c3fdc0079a68b35" target="_blank">sample implementation</a> of <code>IBufferWriter&lt;T&gt;</code>. The following is a skeleton array-backed concrete implementation of the interface:</p><div id="gist94342920">
    <div>
      <div>
        <div>
  <div id="file-skeleton-ibufferwriter-impl-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L1" data-line-number="1"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC1"><span>public</span> <span>class</span> <span>ArrayBufferWriter</span> : <span>IBufferWriter</span>&lt;<span>byte</span>&gt;, <span>IDisposable</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L2" data-line-number="2"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L3" data-line-number="3"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC3">    <span>private</span> <span>byte</span>[] <span>_rentedBuffer</span>;</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L4" data-line-number="4"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC4">    <span>private</span> <span>int</span> <span>_written</span>;</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L5" data-line-number="5"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC5">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L6" data-line-number="6"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC6">    <span>public</span> <span>ArrayBufferWriter</span>(<span>int</span> <span>initialCapacity</span>)</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L7" data-line-number="7"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC7">    {</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L8" data-line-number="8"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC8">        <span><span>//</span> TODO: argument validation</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L9" data-line-number="9"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC9">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L10" data-line-number="10"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC10">        <span>_rentedBuffer</span> <span>=</span> <span>ArrayPool</span>&lt;<span>byte</span>&gt;.<span>Shared</span>.<span>Rent</span>(<span>initialCapacity</span>);</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L11" data-line-number="11"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC11">        <span>_written</span> <span>=</span> <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L12" data-line-number="12"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC12">    }</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L13" data-line-number="13"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC13">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L14" data-line-number="14"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC14">    <span>public</span> <span>void</span> <span>Advance</span>(<span>int</span> <span>count</span>)</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L15" data-line-number="15"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC15">    {</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L16" data-line-number="16"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC16">        <span><span>//</span> TODO: check if disposed</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L17" data-line-number="17"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC17">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L18" data-line-number="18"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC18">        <span><span>//</span> TODO: argument validation</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L19" data-line-number="19"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC19">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L20" data-line-number="20"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC20">        <span>_written</span> <span>+=</span> <span>count</span>;</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L21" data-line-number="21"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC21">    }</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L22" data-line-number="22"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC22">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L23" data-line-number="23"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC23">    <span>public</span> <span>Memory</span>&lt;<span>byte</span>&gt; <span>GetMemory</span>(<span>int</span> <span>sizeHint</span> <span>=</span> <span>0</span>)</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L24" data-line-number="24"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC24">    {</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L25" data-line-number="25"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC25">        <span><span>//</span> TODO: check if disposed</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L26" data-line-number="26"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC26">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L27" data-line-number="27"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC27">        <span><span>//</span> TODO: argument validation</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L28" data-line-number="28"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC28">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L29" data-line-number="29"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC29">        <span><span>//</span> TODO: grow/resize the buffer as needed based on your resizing strategy</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L30" data-line-number="30"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC30">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L31" data-line-number="31"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC31">        <span>return</span> <span>_rentedBuffer</span>.<span>AsMemory</span>(<span>_written</span>);</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L32" data-line-number="32"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC32">    }</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L33" data-line-number="33"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC33">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L34" data-line-number="34"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC34">    <span>public</span> <span>Span</span>&lt;<span>byte</span>&gt; <span>GetSpan</span>(<span>int</span> <span>sizeHint</span> <span>=</span> <span>0</span>)</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L35" data-line-number="35"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC35">    {</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L36" data-line-number="36"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC36">        <span><span>//</span> TODO: check if disposed</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L37" data-line-number="37"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC37">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L38" data-line-number="38"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC38">        <span><span>//</span> TODO: argument validation</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L39" data-line-number="39"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC39">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L40" data-line-number="40"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC40">        <span><span>//</span> TODO: grow/resize the buffer as needed based on your resizing strategy</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L41" data-line-number="41"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC41">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L42" data-line-number="42"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC42">        <span>return</span> <span>_rentedBuffer</span>.<span>AsSpan</span>(<span>_written</span>);</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L43" data-line-number="43"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC43">    }</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L44" data-line-number="44"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC44">
</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L45" data-line-number="45"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC45">    <span>public</span> <span>void</span> <span>Dispose</span>()</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L46" data-line-number="46"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC46">    {</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L47" data-line-number="47"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC47">        <span><span>//</span> return back to the pool</span></td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L48" data-line-number="48"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC48">    }</td>
      </tr>
      <tr>
        <td id="file-skeleton-ibufferwriter-impl-cs-L49" data-line-number="49"></td>
        <td id="file-skeleton-ibufferwriter-impl-cs-LC49">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<h3><a id="user-content-jsondocument" href="#jsondocument"></a>JsonDocument</h3><p>In preview2, we’ve also added <code>System.Text.Json.JsonDocument</code> which was built on top of the <code>Utf8JsonReader</code>. The <code>JsonDocument</code> provides the ability to parse JSON data and build a read-only Document Object Model (DOM) that can be queried to support random access and enumeration. The JSON elements that compose the data can be accessed via the <code>JsonElement</code> type which is exposed by the <code>JsonDocument</code> as a property called <code>RootElement</code>. The <code>JsonElement</code> contains the JSON array and object enumerators along with APIs to convert JSON text to common .NET types. Parsing a typical JSON payload and accessing all its members using the <code>JsonDocument</code> is 2-3x faster than <code>Json.NET</code> with very little allocations for data that is reasonably sized (i.e. &lt; 1 MB).</p><p>Here is a sample usage of the <code>JsonDocument</code> and <code>JsonElement</code> that can be used as a starting point:</p><div id="gist94343069">
    <div>
      <div>
        <div>
  <div id="file-json-document-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8">
      <tbody><tr>
        <td id="file-json-document-cs-L1" data-line-number="1"></td>
        <td id="file-json-document-cs-LC1"><span>static</span> <span>double</span> <span>ParseJson</span>()</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L2" data-line-number="2"></td>
        <td id="file-json-document-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L3" data-line-number="3"></td>
        <td id="file-json-document-cs-LC3">    <span>const</span> <span>string</span> <span>json</span> <span>=</span> <span><span>"</span> [ { <span>\"</span>name<span>\"</span>: <span>\"</span>John<span>\"</span> }, [ <span>\"</span>425-000-1212<span>\"</span>, 15 ], { <span>\"</span>grades<span>\"</span>: [ 90, 80, 100, 75 ] } ]<span>"</span></span>;</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L4" data-line-number="4"></td>
        <td id="file-json-document-cs-LC4">
</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L5" data-line-number="5"></td>
        <td id="file-json-document-cs-LC5">    <span>double</span> <span>average</span> <span>=</span> <span>-</span><span>1</span>;</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L6" data-line-number="6"></td>
        <td id="file-json-document-cs-LC6">
</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L7" data-line-number="7"></td>
        <td id="file-json-document-cs-LC7">    <span>using</span> (<span>JsonDocument</span> <span>doc</span> <span>=</span> <span>JsonDocument</span>.<span>Parse</span>(<span>json</span>))</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L8" data-line-number="8"></td>
        <td id="file-json-document-cs-LC8">    {</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L9" data-line-number="9"></td>
        <td id="file-json-document-cs-LC9">        <span>JsonElement</span> <span>root</span> <span>=</span> <span>doc</span>.<span>RootElement</span>;</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L10" data-line-number="10"></td>
        <td id="file-json-document-cs-LC10">        <span>JsonElement</span> <span>info</span> <span>=</span> <span>root</span>[<span>1</span>];</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L11" data-line-number="11"></td>
        <td id="file-json-document-cs-LC11">
</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L12" data-line-number="12"></td>
        <td id="file-json-document-cs-LC12">        <span>string</span> <span>phoneNumber</span> <span>=</span> <span>info</span>[<span>0</span>].<span>GetString</span>();</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L13" data-line-number="13"></td>
        <td id="file-json-document-cs-LC13">        <span>int</span> <span>age</span> <span>=</span> <span>info</span>[<span>1</span>].<span>GetInt32</span>();</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L14" data-line-number="14"></td>
        <td id="file-json-document-cs-LC14">
</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L15" data-line-number="15"></td>
        <td id="file-json-document-cs-LC15">        <span>JsonElement</span> <span>grades</span> <span>=</span> <span>root</span>[<span>2</span>].<span>GetProperty</span>(<span><span>"</span>grades<span>"</span></span>);</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L16" data-line-number="16"></td>
        <td id="file-json-document-cs-LC16">
</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L17" data-line-number="17"></td>
        <td id="file-json-document-cs-LC17">        <span>double</span> <span>sum</span> <span>=</span> <span>0</span>;</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L18" data-line-number="18"></td>
        <td id="file-json-document-cs-LC18">        <span>foreach</span> (<span>JsonElement</span> <span>grade</span> <span>in</span> <span>grades</span>.<span>EnumerateArray</span>())</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L19" data-line-number="19"></td>
        <td id="file-json-document-cs-LC19">        {</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L20" data-line-number="20"></td>
        <td id="file-json-document-cs-LC20">            <span>sum</span> <span>+=</span> <span>grade</span>.<span>GetInt32</span>();</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L21" data-line-number="21"></td>
        <td id="file-json-document-cs-LC21">        }</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L22" data-line-number="22"></td>
        <td id="file-json-document-cs-LC22">
</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L23" data-line-number="23"></td>
        <td id="file-json-document-cs-LC23">        <span>int</span> <span>numberOfCourses</span> <span>=</span> <span>grades</span>.<span>GetArrayLength</span>();</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L24" data-line-number="24"></td>
        <td id="file-json-document-cs-LC24">        <span>average</span> <span>=</span> <span>sum</span> <span>/</span> <span>numberOfCourses</span>;</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L25" data-line-number="25"></td>
        <td id="file-json-document-cs-LC25">    }</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L26" data-line-number="26"></td>
        <td id="file-json-document-cs-LC26">
</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L27" data-line-number="27"></td>
        <td id="file-json-document-cs-LC27">    <span>return</span> <span>average</span>;</td>
      </tr>
      <tr>
        <td id="file-json-document-cs-L28" data-line-number="28"></td>
        <td id="file-json-document-cs-LC28">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>
<h2><a id="user-content-gpio-support-for-raspberry-pi" href="#gpio-support-for-raspberry-pi"></a>GPIO Support for Raspberry Pi</h2><p>We added initial support for <a href="https://learn.adafruit.com/adafruits-raspberry-pi-lesson-4-gpio-setup/the-gpio-connector" rel="nofollow" target="_blank">GPIO</a> with Preview 1. As part of Preview 2, we have released two NuGet packages that you can use for GPIO programming.</p><ul><li><a href="https://www.nuget.org/packages/System.Device.Gpio/0.1.0-prerelease.19078.2" rel="nofollow" target="_blank">System.Device.Gpio</a></li><li><a href="https://www.nuget.org/packages/Iot.Device.Bindings/0.1.0-prerelease.19078.2" rel="nofollow" target="_blank">Iot.Device.Bindings</a></li></ul><p>The GPIO Packages includes APIs for GPIO, SPI, I2C and PWM devices. The IoT bindings package includes <a href="https://github.com/dotnet/iot/blob/master/src/devices/README.md" target="_blank">device bindings</a> for various chips and sensors, the same ones available at <a href="https://github.com/dotnet/iot/tree/master/src/devices" target="_blank">dotnet/iot – src/devices</a>.</p><p>Updated serial port APIs were announced as part of Preview 1. They are not part of these packages but are available as part of the .NET Core platform.</p><h2><a id="user-content-local-dotnet-tools" href="#local-dotnet-tools"></a>Local dotnet tools</h2><p>Local dotnet tools have been improved in Preview 2. Local tools are similar to dotnet global tools but are associated with a particular location on disk. This enables per-project and per-repository tooling. You can read more about them <a href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-net-core-3-preview-1-and-open-sourcing-windows-desktop-frameworks/" rel="nofollow" target="_blank">in the .NET Core 3.0 Preview 1</a> post.</p><p>In this preview, we have added 2 new commands:</p><ul><li><code>dotnet new tool-manifest</code></li><li><code>dotnet tool list</code></li></ul><p>To add local tools, you need to add a manifest that will define the tools and versions available. The <code>dotnet new tool-manifest</code> command automates creation of the manifest required by local tools. After this file is created, you can add tools to it via <code>dotnet tool install &lt;packageId&gt;</code>.</p><p>The command <code>dotnet tool list</code> lists local tools and their corresponding manifest. The command <code>dotnet tool list -g</code> lists global tools.</p><p>There was a change in .NET Core Local Tools between .NET Core 3.0 Preview 1 and .NET Core 3.0 Preview 2. If you tried out local tools in Preview 1 by running a command like <code>dotnet tool restore</code> or <code>dotnet tool install</code>, you need to delete your local tools cache folder before local tools will work correctly in Preview 2. This folder is located at:</p><p>On mac, Linux: <code>rm -r $HOME/.dotnet/toolResolverCache</code></p><p>On Windows: <code>rmdir /s %USERPROFILE%\.dotnet\toolResolverCache</code></p><p>If you do not delete this folder, you will receive an error.</p><h2><a id="user-content-assembly-unloadability" href="#assembly-unloadability"></a>Assembly Unloadability</h2><p>Assembly unloadability is a new capability of AssemblyLoaderContext. This new feature is largely transparent from an API perspective, exposed with just a few new APIs. It enables a loader context to be unloaded, releasing all memory for instantiated types, static fields and for the assembly itself. An application should be able to load and unload assemblies via this mechanism forever without experiencing a memory leak.</p><p>We expect this new capability to be used for the following scenarios:</p><ul><li>Plugin scenarios where dynamic plugin loading and unloading is required.</li><li>Dynamically compiling, running and then flushing code. Useful for web sites, scripting engines, etc.</li><li>Loading assemblies for introspection (like ReflectionOnlyLoad), although <a href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-net-core-3-preview-1-and-open-sourcing-windows-desktop-frameworks/" rel="nofollow" target="_blank">MetadataLoadContext</a> (released in Preview 1) will be a better choice in many cases.</li></ul><p>More information:</p><ul><li><a href="https://github.com/dotnet/coreclr/pull/22166" target="_blank">Design doc</a></li><li><a href="https://github.com/dotnet/coreclr/pull/22221" target="_blank">Using Unloadability doc</a></li></ul><p>Assembly unloading requires significant care to ensure that all references to managed objects from outside a loader context are understood and managed. When the loader context is requested to be unloaded, any outside references need to have been unreferenced so that the loader context is self-consistent only to itself.</p><p>Assembly unloadability was provided in the .NET Framework by Application Domains (AppDomains), which are not supported with .NET Core. AppDomains had both benefits and limitations compared to this new model. We consider this new loader context-based model to be more flexible and higher performance when compared to AppDomains.</p><h2><a id="user-content-windows-native-interop" href="#windows-native-interop"></a>Windows Native Interop</h2><p>Windows offers a rich native API, in the form of flat C APIs, COM and WinRT. We’ve had support for P/Invoke since .NET Core 1.0, and have been adding the ability to CoCreate COM APIs and Activate WinRT APIs as part of the .NET Core 3.0 release. We have had many requests for these capabilities, so we know that they will get a lot of use.</p><p>Late last year, we announced that we had managed to <a href="https://twitter.com/runfaster2000/status/1053704090671185920" rel="nofollow" target="_blank">automate Excel from .NET Core</a>. That was a fun moment. You can now try this same demo yourself with the <a href="https://github.com/dotnet/samples/tree/master/core/extensions/ExcelDemo" target="_blank">Excel demo</a> sample. Under the covers, this demo is using COM interop features like NOPIA, object equivalence and custom marshallers.</p><p>Managed C++ and WinRT interop are coming in a later preview. We prioritized getting COM interop built first.</p><h2><a id="user-content-wpf-and-windows-forms" href="#wpf-and-windows-forms"></a>WPF and Windows Forms</h2><p>The WPF and Windows Forms teams opened up their repositories, <a href="https://github.com/dotnet/wpf" target="_blank">dotnet/wpf</a> and <a href="https://github.com/dotnet/winforms" target="_blank">dotnet/winforms</a>, respectively, on December 4th, the same day <a href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-net-core-3-preview-1-and-open-sourcing-windows-desktop-frameworks/" rel="nofollow" target="_blank">.NET Core 3.0 Preview 1</a> was released. Much of the last month, beyond holidays, has been spent interacting with the community, merging PRs, and responding to issues. In the background, they’ve been integrating WPF and Windows Forms into the .NET Core build system, including adopting the <a href="https://github.com/dotnet/arcade" target="_blank">Arcade</a> SDK. Arcade is an MSBuild SDK that exposes functionality which is needed to build the .NET Platform. The WPF team will be publishing more of the WPF source code over the coming months.</p><p>The same teams have been making a final set of changes in .NET Framework 4.8. These same changes have also been added to the .NET Core versions of WPF and Windows Forms.</p><h2><a id="user-content-visual-studio-support" href="#visual-studio-support"></a>Visual Studio support</h2><p>Desktop development on .NET Core 3 requires <a href="https://blogs.msdn.microsoft.com/visualstudio/2019/01/24/visual-studio-2019-preview-2-is-now-available/" target="_blank">Visual Studio 2019</a>. We added the WPF and Windows Forms templates to the New Project Dialog to make it easier starting your new applications without using the command line.</p><p>The WPF and Windows Forms designer teams are continuing to work on an updated designer for .NET Core, which will be part of a Visual Studio 2019 Update.</p><h3><a id="user-content-msix-deployment-for-desktop-apps" href="#msix-deployment-for-desktop-apps"></a>MSIX Deployment for Desktop apps</h3><p><a href="https://docs.microsoft.com/windows/msix/" rel="nofollow" target="_blank">MSIX</a> is a new Windows app package format. It can be used to deploy .NET Core 3 desktop applications to Windows 10.</p><p>The <a href="https://docs.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-packaging-dot-net" rel="nofollow" target="_blank">Windows Application Packaging Project</a>, available in Visual Studio 2019 preview 2, allows you to create MSIX packages with <a href="https://docs.microsoft.com/dotnet/core/deploying/#self-contained-deployments-scd" rel="nofollow" target="_blank">self-contained</a> .NET Core applications.</p><blockquote><p>Note: The .NET Core project file must specify the supported runtimes in the <code>&lt;RuntimeIdentifiers&gt;</code> property:</p></blockquote><div><pre><span>&lt;RuntimeIdentifiers&gt;</span><span>win-x86;win-x64</span><span>&lt;/RuntimeIdentifiers&gt;</span></pre></div><h2><a id="user-content-install-net-core-30-previews-on-linux-with-snap" href="#install-net-core-30-previews-on-linux-with-snap"></a>Install .NET Core 3.0 Previews on Linux with Snap</h2><p>Snap is the preferred way to install and try .NET Core previews on <a href="https://docs.snapcraft.io/installing-snapd/6735" rel="nofollow" target="_blank">Linux distributions that support Snap</a>. At present, only X64 builds are supported with Snap. We’ll look at supporting ARM builds, too.</p><p>After configuring Snap on your system, run the following command to install the <a href="https://snapcraft.io/dotnet-sdk" rel="nofollow" target="_blank">.NET Core SDK 3.0 Preview SDK</a>.</p><div><pre><span>sudo snap install dotnet</span><span>-</span><span>sdk </span><span>--</span><span>beta </span><span>--</span><span>classic</span></pre><p><span>When .NET Core in installed using the Snap package, the default .NET Core command is </span><code>dotnet-sdk.dotnet</code><span>, as opposed to just </span><code>dotnet</code><span>. The benefit of the namespaced command is that it will not conflict with a globally installed .NET Core version you may have. This command can be aliased to </span><code>dotnet</code><span> with:</span></p></div><div><pre><span>sudo snap </span><span>alias</span><span> dotnet</span><span>-</span><span>sdk</span><span>.</span><span>dotnet dotnet</span></pre><p><span>Some distros require an additional step to enable access to the SSL certificate. See our </span><a href="https://github.com/dotnet/core/blob/master/Documentation/linux-setup.md" target="_blank">Linux Setup</a><span> for details.</span></p></div><h2><a id="user-content-platform-support" href="#platform-support"></a>Platform Support</h2><p>.NET Core 3 will be supported on the following operating systems:</p><ul><li>Windows Client: 7, 8.1, 10 (1607+)</li><li>Windows Server: 2012 R2 SP1+</li><li>macOS: 10.12+</li><li>RHEL: 6+</li><li>Fedora: 26+</li><li>Ubuntu: 16.04+</li><li>Debian: 9+</li><li>SLES: 12+</li><li>openSUSE: 42.3+</li><li>Alpine: 3.8+</li></ul><p>Chip support follows:</p><ul><li>x64 on Windows, macOS, and Linux</li><li>x86 on Windows</li><li>ARM32 on Windows and Linux</li><li>ARM64 on Linux</li></ul><p>For Linux, ARM32 is supported on Debian 9+ and Ubuntu 16.04+. For ARM64, it is the same as ARM32 with the addition of Alpine 3.8. These are the same versions of those distros as is supported for X64. We made a conscious decision to make supported platforms as similar as possible between X64, ARM32 and ARM64.</p><p>Docker images for .NET Core 3.0 are available at <a href="https://hub.docker.com/r/microsoft/dotnet/" rel="nofollow" target="_blank">microsoft/dotnet on Docker Hub</a>. We are in the process of adopting <a href="https://cloudblogs.microsoft.com/opensource/2019/01/17/improved-discovery-experience-microsoft-containers-docker-hub/" rel="nofollow" target="_blank">Microsoft Container Registry (MCR)</a>. We expect that the final .NET Core 3.0 images will only be published to MCR.</p><h2><a id="user-content-closing" href="#closing"></a>Closing</h2><p>Take a look at the <a href="https://blogs.msdn.microsoft.com/dotnet/2018/12/04/announcing-net-core-3-preview-1-and-open-sourcing-windows-desktop-frameworks/" rel="nofollow" target="_blank">.NET Core 3.0 Preview 1 post </a> if you missed that. It includes a broader description of the overall release including the initial set of features, which are also included and improved on in Preview 2.</p><p>Thanks to everyone that installed .NET Core 3.0 Preview 1. We appreciate you trying out the new version and for your feedback. Please share any feedback you have about Preview 2.</p></div></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>