<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Overview of Azure Cache for Redis - Simple Talk - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Overview of Azure Cache for Redis - Simple Talk - linksfor.dev(s)"/>
    <meta property="article:author" content="Chandra Kudumula"/>
    <meta property="og:description" content="Caching data is one way to improve application performance. In this article, Chandra Kudumla explains a service for caching data found in Azure called Azure Cache for Redis."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.red-gate.com/simple-talk/dotnet/net-development/overview-of-azure-cache-for-redis/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Overview of Azure Cache for Redis - Simple Talk</title>
<div class="readable">
        <h1>Overview of Azure Cache for Redis - Simple Talk</h1>
            <div>by Chandra Kudumula</div>
            <div>Reading time: 15-19 minutes</div>
        <div>Posted here: 28 Feb 2020</div>
        <p><a href="https://www.red-gate.com/simple-talk/dotnet/net-development/overview-of-azure-cache-for-redis/">https://www.red-gate.com/simple-talk/dotnet/net-development/overview-of-azure-cache-for-redis/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><p>Caching data is one way to improve application performance. In this article, Chandra Kudumla explains a service for caching data found in Azure called Azure Cache for Redis. </p><div>
				<p>This article explains the Azure Cache for Redis and its features, the data types supported, and the pricing tiers available. It will demonstrate the steps to create an Azure Redis Cache from the Azure Portal. The article will also explain how to create a simple console app and connect this app with cache and exchange data.</p>
<h2><strong>Prerequisites</strong></h2>
<p>To follow along with this article, you will need:</p>
<ul>
<li>Azure Account. You can create a free account <a href="https://azure.microsoft.com/en-us/features/azure-portal/">here</a></li>
<li>Visual Studio 2017 and above. You can download it from <a href="https://visualstudio.microsoft.com/downloads/">here</a></li>
</ul>
<h2><strong>What is Caching?</strong></h2>
<p>Caching is a mechanism to store frequently accessed data in a data store temporarily and retrieve this data for subsequent requests instead of extracting it from the original data source. This process improves the performance and availability of an application. Reading data from the database may be slower if it needs to execute complex queries.</p>
<h2><strong>Azure Cache for Redis</strong></h2>
<p>The Azure Redis Cache is a high-performance caching service that provides in-memory data store for faster retrieval of data. It is based on the open-source implementation Redis cache. This ensures low latency and high throughput by reducing the need to perform slow I/O operations. It also provides high availability, scalability, and security.</p>
<p>When a user uses an application, the application tries to read data from the cache. If the requested data not available in the cache, the application gets the data from the actual data source. Then the application stores that data in the cache for subsequent requests. When the next request comes to an application, it retrieves data from the cache without going to the actual data source. This process improves the application performance because data lives in memory. Also, it increases the availability of an application in case of unavailability of the database. Figure 1 shows the cache workflow.</p>
<p><img src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-86.png" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-86.png" width="1005" height="239"></p>
<p>Figure 1: Cache Workflow</p>
<h2>Features</h2>
<p>Azure Cache for Redis has many features for management, performance, and high availability. Here are a few of the most important:</p>
<h3>Fully Managed Service</h3>
<p>Azure Redis Cache is a fully managed version of an open-source Redis server. i.e., it monitors, manages, hosting, and secure the service by default.</p>
<h3>High Performance</h3>
<p>Azure Redis cache enables an application to be responsive even the user load increases. It does so by leveraging the low latency, high-throughput capabilities of the Redis engine.</p>
<h3>Geo-replication</h3>
<p>Azure Redis cache allows replicating or syncing the cache in multiple regions in the world. One cache is primary, and other caches act as secondaries. The primary cache has read and write capabilities, but the secondary caches are read-only. If the primary goes down, then one secondary cache becomes primary. The significant advantage of this is high availability and reliability.</p>
<h3>Cache Cluster</h3>
<p>The cluster automatically shards the data in the cache across multiple Azure Cache for Redis nodes. A cluster increases performance and availability. Each shard node is made of two instances. When one instance goes down, the application still works because other instances in the cluster are running.</p>
<h3>Data Persistence</h3>
<p>Azure Redis cache persists the data by taking snapshots and backing up the data.</p>
<h2>Data Types</h2>
<p>Azure Redis Cache supports to store data in various formats. It supports data structures like Strings, Lists, Sets, and Hashes.</p>
<ul>
<li><em><strong>Strings</strong></em>: Redis strings are binary safe and allow them to store any type of data with serialization. The maximum allowed string length is 512MB. It provides some useful commands like Incr, Desr, Append, GetRange, SetRange, and other useful commands.</li>
<li><em><strong>Lists</strong></em>: Lists are lists of Strings, sorted by insertion order. It allows adding elements at the beginning or end of the list. It supports constant time insertion and deletion of elements near the beginning or end of the list, even with many millions of inserted items.</li>
<li><em><strong>Sets</strong></em>: These are also lists of Strings. The unique feature of sets is that they don’t allow duplicate values. There are two types of sets: Ordered and Unordered Sets.</li>
<li><em><strong>Hashes</strong></em>: Hashes are objects, contains multiple fields. The object allows storing as many fields as required.</li>
</ul>
<h2>Pricing Tiers</h2>
<p>Azure Redis Cache has three pricing layers with different features, performance, and budget.</p>
<ul>
<li><em><strong>Basic</strong></em>: Basic cache is a single node cache which is ideal for development/test and non-critical workloads. There’s no SLA (Service Level Agreement is Microsoft’s commitments for uptime and connectivity). The basic tier has different options to choose from C0 to C6. The lowest option is C0, and this is in a shared infrastructure. Everything above C0 provides dedicated service, i.e., this does not share infrastructure with other customers.</li>
<li><em><strong>Standard</strong></em>: This tier offers an SLA and provides a replicated cache. The data is automatically replicated between the two nodes — ideal for production-level applications.</li>
<li><em><strong>Premium</strong></em>: The Premium tier has all the standard features and, also, it provides better performance, bigger workloads, enhanced security, and disaster recovery. Backups and Snapshots and can be created and restored in case of failures. It also offers Redis Persistence, which persists data stored inside the cache. It also provides a Redis Cluster, which automatically shares data across multiple Redis nodes. Hence this allows creating workloads of bigger memory sizes and get better performance. It also offers support for Azure Virtual Networks, which gives the ability to isolate the cache by using subnets, access control policies, and other features.</li>
</ul>
<h2><strong>Cache Invalidation</strong></h2>
<p>Cache Invalidation is the process of replacing or removing the cached items. If the data in the cache is deleted or invalid, then the application gets the latest data from the database and keeps it in the cache, and subsequent requests get the latest data from the cache.</p>
<p>There are different ways to invalidate the cache.</p>
<ul>
<li>An application can remove the data in the cache</li>
<li>Configure the invalidation rule while setting up the cache
<ul>
<li>Set absolute expiration – you can set a specific time period to expire the cache</li>
<li>Set sliding expiration – If the data in the cache not touched for a certain amount of time, then delete the cache</li>
</ul>
</li>
</ul>
<h2><strong>Create an Azure Cache for Redis</strong></h2>
<p>Sign in to the Azure portal, click on the portal menu and select <em>Create a resource</em> menu option as shown in Figure 2.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-87.png" data-lazy-load=""></p>
<p>Figure 2: Microsoft Azure Portal Menu</p>
<p>In the next screen, Figure 3, type <em>Azure Cache for Redis</em> in the search bar and hit enter. This navigates to the <em>Azure Cache for Redis</em> window.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-88.png" data-lazy-load=""></p>
<p>Figure 3: Microsoft Azure Marketplace</p>
<p>In the next screen, Figure 4, <em>Azure Cache for Redi</em>s window, click on the <em>Create</em> button.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-89.png" data-lazy-load="" width="622" height="375"></p>
<p>Figure 4: Azure Cache for Redis window</p>
<p>In the next screen, Figure 5, <em>New Redis Cache</em> window, fill out the unique <em>DNS name</em>, <em>Subscription</em>, <em>Resource</em> <em>group</em>, <em>Location</em>, <em>Pricing</em> <em>tier</em>, and all required information.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-90.png" data-lazy-load=""></p>
<p>Figure 5: New Redis Cache window</p>
<p>Click <em>View</em> <em>full</em> <em>pricing</em> <em>details</em>. It opens a window (Figure 6) with available pricing tiers. Choosing the pricing tier is essential because this determines the performance of the cache, budget, and other features like dedicated or shared cache infrastructure, SLA, Redis cluster, data persistence, and data import and export.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-91.png" data-lazy-load="" width="1043" height="463"></p>
<p>Figure 6: Pricing tier options</p>
<p>If you choose one of the Premium tiers, you can configure the cluster by clicking <em>Redis</em> <em>Cluster</em> (Figure 7). You can enable or disable clustering and select the shard count. Note that each shard is comprised of two instances.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-92.png" data-lazy-load=""></p>
<p>Figure 7: Redis Cluster Configuration</p>
<p><em>Data</em> <em>Persistence</em> also requires the Premium tier. Figure 8 shows the configuration to persist the data stored in the cache. There are a couple of options to persist the data.</p>
<p><strong><em>RDB (Redis database) persistence</em></strong>: This option persists the data by taking a snapshot of the cache. The snapshot is taken based on the frequency configured. In the case of recovery, the most recent snapshot will be used.</p>
<p><strong><em>AOF (Append only file) persistence</em></strong>: This option saves the data for every writes operation. In case of recovery, the cache is reconstruct using stored write operation.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-93.png" data-lazy-load=""></p>
<p>Figure 8: Data Persistence configuration</p>
<p>After filling out the required fields on the <em>New</em> <em>Redis</em> <em>Cache</em> window, click on the <em>Create</em> button. After a few minutes, the Azure Redis cache created and running.</p>
<p>Figure 9 shows the <em>Azure</em> <em>Cache</em> <em>for</em> <em>Redis</em> <em>Overview</em>. By default, it is secure because the Non-SSL port is disabled.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-94.png" data-lazy-load="" width="1018" height="637"></p>
<p>Figure 9: Overview of Azure Redis Cache</p>
<h2><strong>Create a Console App to Use the Cache</strong></h2>
<p>To try out the cache, you will create a Console app. Begin by opening Visual Studio and selecting <em>File New Project.</em></p>
<p>The next screen, Figure 10, is the <em>New</em> <em>Project</em> window. Select the <em>Console</em> <em>App</em> <em>(.Net Framework)</em>, fill out the project name and location, and click on the <em>OK</em> button.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-95.png" data-lazy-load="" width="962" height="586"></p>
<p>Figure 10: Visual Studio New Project</p>
<p>The next screen, Figure 11, shows the new console app.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-96.png" data-lazy-load="" width="960" height="419"></p>
<p>Figure 11: Visual Studio Console App</p>
<p>To connect the Console App to the Azure Redis Cache, you need to install <em>Microsoft.Extensions.Caching.Redis</em> package. To install this package from Visual Studio, go to <em>Tools NuGet Package Manager Manage NuGet Packages for solution… </em></p>
<p>Figure 12 is the <em>NuGet</em> <em>Package</em> <em>Manager</em>. Make sure that <em>Browse</em> is selected. In the search bar type <em>Microsoft.Extensions.Caching.Redis</em> and select the package from the displayed list. Scroll down and click on the <em>Install</em> button.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-97.png" data-lazy-load="" width="970" height="510"></p>
<p>Figure 12: NuGet Package Manager</p>
<p>In the next screen, Figure 13, install <em>Newtonsoft.Json</em> package for serialization and deserialization of objects.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-98.png" data-lazy-load="" width="968" height="464"></p>
<p>Figure 13: Install Newtonsoft.Json package</p>
<p>The console app can be connected to the Azure Redis Cache programmatically by using the Access keys of the Azure Redis Cache created in the Azure portal. In the next screen, Figure 14, go to the <em>Azure</em> <em>Portal</em> <em>Redis</em> <em>Cache</em> and click on the <em>Access</em> <em>Keys</em> tab and copy the <em>Primary</em> <em>connection</em> <em>string</em>.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-99.png" data-lazy-load="" width="964" height="426"></p>
<p>Figure 14: Access Keys from Azure Portal</p>
<p>Figure 15 shows the code after adding Redis cache connection string that you copied from the Azure portal to <em>App.config</em> file in the console app.</p>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e58acf57ba00980122706" data-settings=" minimize scroll-always">
		
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>&lt;</span><span>appSettings</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&lt;</span><span>add </span><span>key</span><span>=</span><span>"CacheConnection"</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>value</span><span>=</span><span>"&lt;YOUR CONNECTION STRING&gt;"</span><span>/</span><span>&gt;</span></p><p><span>&lt;</span><span>/</span><span>appSettings</span><span>&gt;</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->

<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-100.png" data-lazy-load="" width="1172" height="243"></p>
<p>Figure 15: Configure Redis cache connection string in app.config</p>
<p>In real-world scenario applications, this connection string or credentials should be stored and accessed more securely.</p>
<p>In the next screen, Figure 16, get the Redis connection string defined in the <em>app.config</em> file in the <em>program.cs</em> file by using the <code>ConfiguationManager</code> class. Add the code to the Program class. The <code>ConnectionMultiplexer</code> class manages the connection with Azure Redis cache. Be sure to include references to <code>System.Configuration</code> and <code>StackExchange.Redis</code>.</p>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e58acf57ba09100801173" data-settings=" minimize scroll-always">
		
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>private</span><span> </span><span>static</span><span> </span><span>Lazy</span><span>&lt;</span><span>ConnectionMultiplexer</span><span>&gt;</span><span> </span><span>redisConnection</span><span> </span><span>=</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>new</span><span> </span><span>Lazy</span><span>&lt;</span><span>ConnectionMultiplexer</span><span>&gt;</span><span>(</span><span>(</span><span>)</span><span> </span><span>=</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>string</span><span> </span><span>cacheConnection</span><span> </span><span>=</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ConfigurationManager</span><span>.</span><span>AppSettings</span><span>[</span><span>"CacheConnection"</span><span>]</span><span>.</span><span>ToString</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>return</span><span> </span><span>ConnectionMultiplexer</span><span>.</span><span>Connect</span><span>(</span><span>cacheConnection</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>public</span><span> </span><span>static</span><span> </span><span>ConnectionMultiplexer</span><span> </span><span>Connection</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>get</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>return</span><span> </span><span>redisConnection</span><span>.</span><span>Value</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->

<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-101.png" data-lazy-load="" width="1096" height="464"></p>
<p>Figure 16: Managing Redis cache connection</p>

<p>Create a class called <code>Employee</code>; this acts as the data source for the console app.</p>
<p>The code for program.cs can be found below. First, the application gets the reference for the Redis cache database. Using that reference, the app checks whether data available in the cache. If it is available, read the data from the cache; otherwise, read the data from the actual data source and save it into the Azure Redis cache. For subsequent calls, data read from the cache.</p>
<!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e58acf57ba0d279949971" data-settings=" minimize scroll-always">
		
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="hide">
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p><p>53</p><p>54</p><p>55</p><p>56</p><p>57</p><p>58</p><p>59</p><p>60</p><p>61</p><p>62</p><p>63</p><p>64</p><p>65</p><p>66</p><p>67</p><p>68</p><p>69</p><p>70</p></div>
				</td>
						<td><div><p><span>using</span><span> </span><span>System</span><span>;</span></p><p><span>using</span><span> </span><span>System</span><span>.</span><span>Collections</span><span>.</span><span>Generic</span><span>;</span></p><p><span>using</span><span> </span><span>System</span><span>.</span><span>Configuration</span><span>;</span></p><p><span>using</span><span> </span><span>StackExchange</span><span>.</span><span>Redis</span><span>;</span></p><p><span>using</span><span> </span><span>Newtonsoft</span><span>.</span><span>Json</span><span>;</span></p><p><span>namespace</span><span> </span><span>az_redis_cache_demo_app</span></p><p><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>class</span><span> </span><span>Program</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>static</span><span> </span><span>void</span><span> </span><span>Main</span><span>(</span><span>string</span><span>[</span><span>]</span><span> </span><span>args</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>"Azure Redis Cache Demo"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>"----------------------"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Employee </span><span>clsEmp</span><span> </span><span>=</span><span> </span><span>new</span><span> </span><span>Employee</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>List</span><span>&lt;</span><span>Employee</span><span>&gt;</span><span> </span><span>lstEmployees</span><span> </span><span>=</span><span> </span><span>new</span><span> </span><span>List</span><span>&lt;</span><span>Employee</span><span>&gt;</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//Get the redis cache reference </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>IDatabase </span><span>cache</span><span> </span><span>=</span><span> </span><span>redisConnection</span><span>.</span><span>Value</span><span>.</span><span>GetDatabase</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//Get employee data from cache</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>"Get employee data from Cache"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>var</span><span> </span><span>cachedEmployees</span><span> </span><span>=</span><span> </span><span>cache</span><span>.</span><span>StringGet</span><span>(</span><span>"employees"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//Check whether cache contains employee data</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>if</span><span>(</span><span>string</span><span>.</span><span>IsNullOrEmpty</span><span>(</span><span>cachedEmployees</span><span>)</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//Cache doesn't have employee data and gets the </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//data from actual data source</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>"Employee data not available in the </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cache. Get data from actual data source"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>lstEmployees</span><span> </span><span>=</span><span> </span><span>clsEmp</span><span>.</span><span>GetEmployees</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//After getting the employee data from the actual data </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//source, Save that data in cache </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>"Set the employee data to Cache"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>cache</span><span>.</span><span>StringSet</span><span>(</span><span>"employees"</span><span>,</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>JsonConvert</span><span>.</span><span>SerializeObject</span><span>(</span><span>lstEmployees</span><span>)</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>else</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//Cache contains employee data and deserializes the data</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>"Employee data available in the </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cache. Read data from the Cache"</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>lstEmployees</span><span> </span><span>=</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>JsonConvert</span><span>.</span><span>DeserializeObject</span><span>&lt;</span><span>List</span><span>&lt;</span><span>Employee</span><span>&gt;&gt;</span><span>(</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>cachedEmployees</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>//Print the employee data to console</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>foreach</span><span> </span><span>(</span><span>var</span><span> </span><span>emp </span><span>in</span><span> </span><span>lstEmployees</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>WriteLine</span><span>(</span><span>emp</span><span>.</span><span>FirstName</span><span> </span><span>+</span><span> </span><span>" "</span><span> </span><span>+</span><span> </span><span>emp</span><span>.</span><span>LastName</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>+</span><span> </span><span>", "</span><span> </span><span>+</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>emp</span><span>.</span><span>EmployeeId</span><span> </span><span>+</span><span> </span><span>", "</span><span> </span><span>+</span><span> </span><span>emp</span><span>.</span><span>Salary</span><span> </span><span>+</span><span> </span><span>", "</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>+</span><span> </span><span>emp</span><span>.</span><span>Address</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Console</span><span>.</span><span>ReadLine</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>private</span><span> </span><span>static</span><span> </span><span>Lazy</span><span>&lt;</span><span>ConnectionMultiplexer</span><span>&gt;</span><span> </span><span>redisConnection</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>=</span><span> </span><span>new</span><span> </span><span>Lazy</span><span>&lt;</span><span>ConnectionMultiplexer</span><span>&gt;</span><span>(</span><span>(</span><span>)</span><span> </span><span>=</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>string</span><span> </span><span>cacheConnection</span><span> </span><span>=</span><span> </span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>ConfigurationManager</span><span>.</span><span>AppSettings</span><span>[</span><span>"CacheConnection"</span><span>]</span><span>.</span><span>ToString</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>return</span><span> </span><span>ConnectionMultiplexer</span><span>.</span><span>Connect</span><span>(</span><span>cacheConnection</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>public</span><span> </span><span>static</span><span> </span><span>ConnectionMultiplexer</span><span> </span><span>Connection</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>get</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>return</span><span> </span><span>redisConnection</span><span>.</span><span>Value</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->

<p>Figure 17 shows the code for the new Employee class.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-102.png" data-lazy-load="" width="1053" height="861"></p>
<p>Figure 17: Employee class in the Console App</p>
<p>Run the application. The first time, data is not available in Redis cache, and the app gets data from the data source. See below Figure 18 for the console output.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-103.png" data-lazy-load=""></p>
<p>Figure 18: Console output window – first time run the application</p>
<p>In the next screen, Figure 19, is the result of subsequent calls. The application read the data from the Redis cache.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-104.png" data-lazy-load=""></p>
<p>Figure 19: Console output window – Subsequent calls</p>
<p>You can also see the activity in the Azure Portal. Navigate to your Azure Cache for Redis and click <em>Metrics</em>. There you can filter the activity. In Figure 20, the metrics show that data is writing to the cache.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-105.png" data-lazy-load="" width="1114" height="768"></p>
<p>Figure 20: Redis cache write metrics from the Azure portal</p>
<p>In the next screen, Figure 21, Azure portal Redis cache metrics confirm that data is reading from the cache.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAPAAAPLy8v///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="https://www.red-gate.com/simple-talk/wp-content/uploads/2020/02/word-image-106.png" data-lazy-load="" width="1146" height="701"></p>
<p>Figure 21: Redis cache read metrics from the Azure portal</p>
<h2><strong>Conclusion</strong></h2>
<p>This article explained the Azure Cache for Redis basics and demonstrated how to provision the Redis cache in the Azure Portal. It then showed how to connect it with a console app and read the data from the cache. In this way, Azure Cache for Redis allows reading data from the cache without going to the actual data source.</p>
<h2><strong>Reference Links</strong></h2>
<ul>
<li>Click <a href="https://docs.microsoft.com/en-us/azure/azure-cache-for-redis/">here</a> for Azure Cache for Redis documentation</li>
<li>Click <a href="https://redis.io/">here</a> for Redis open source documentation</li>
<li>Click <a href="https://azure.microsoft.com/en-us/services/cache/">here</a> for Azure cache features, pricing and azure portal login</li>
</ul>
			</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>