<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Calling Windows 10 APIs From a Desktop Application just got easier - Windows Developer Blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Calling Windows 10 APIs From a Desktop Application just got easier - Windows Developer Blog - linksfor.dev(s)"/>
    <meta property="og:description" content="Today, we are pleased to announce we posted on nuget.org a preview of the Windows 10 WinRT API Pack. By using these NuGet packages, you can quickly and easily add new Windows functionality to your &#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://blogs.windows.com/buildingapps/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Calling Windows 10 APIs From a Desktop Application just got easier - Windows Developer Blog</title>
<div class="readable">
        <h1>Calling Windows 10 APIs From a Desktop Application just got easier - Windows Developer Blog</h1>
            <div>Reading time: 3-4 minutes</div>
        <div>Posted here: 30 Apr 2019</div>
        <p><a href="https://blogs.windows.com/buildingapps/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/">https://blogs.windows.com/buildingapps/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div role="main" aria-label="Main Content">
			<article role="article">
				
								
				
				<p><span>Today, we are pleased to announce we posted on </span><a title="https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.nuget.org%2Fpackages%2FMicrosoft.Windows.SDK.Contracts%2F&amp;data=01%7C01%7Cclint.rutkas%40microsoft.com%7Cc54cce871c4a4ed3f52708d6ca9fa523%7C72f988bf86f141af91ab2d7cd011db47%7C1&amp;sdata=J%2F7c%2BB0GgHZe2fS%2BDVPvvCOS02yToF47hT%2FBQpiakRw%3D&amp;reserved=0" href="https://www.nuget.org/packages/Microsoft.Windows.SDK.Contracts/" target="_blank" rel="noopener noreferrer"><span>nuget.org</span></a><span> a preview of the </span><a title="https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.nuget.org%2Fpackages%2FMicrosoft.Windows.SDK.Contracts%2F&amp;data=01%7C01%7Cclint.rutkas%40microsoft.com%7Cc54cce871c4a4ed3f52708d6ca9fa523%7C72f988bf86f141af91ab2d7cd011db47%7C1&amp;sdata=J%2F7c%2BB0GgHZe2fS%2BDVPvvCOS02yToF47hT%2FBQpiakRw%3D&amp;reserved=0" href="https://www.nuget.org/packages/Microsoft.Windows.SDK.Contracts/" target="_blank" rel="noopener noreferrer"><span>Windows 10 WinRT API Pack</span></a><span>. By using these NuGet packages, you can quickly and easily add new Windows functionality to your applications like </span><a href="https://docs.microsoft.com/en-us/uwp/api/windows.devices.geolocation" target="_blank" rel="noopener noreferrer"><span>Geolocation</span></a><span>, </span><a title="https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fai&amp;data=01%7C01%7Cclint.rutkas%40microsoft.com%7Cc54cce871c4a4ed3f52708d6ca9fa523%7C72f988bf86f141af91ab2d7cd011db47%7C1&amp;sdata=w0gFVwIio8%2F27czHFdHTt6XEF1DMVLtM6IxqolQUBrA%3D&amp;reserved=0" href="https://docs.microsoft.com/en-us/windows/ai/" target="_blank" rel="noopener noreferrer"><span>Windows AI</span></a><span>, </span><a href="https://docs.microsoft.com/en-us/windows/ai/windows-ml/" target="_blank" rel="noopener noreferrer"><span>Machine Learning</span></a>,<span> and </span><a title="https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fuwp%2Fporting%2Fdesktop-to-uwp-supported-api&amp;data=01%7C01%7Cclint.rutkas%40microsoft.com%7Cc54cce871c4a4ed3f52708d6ca9fa523%7C72f988bf86f141af91ab2d7cd011db47%7C1&amp;sdata=EePScSFB7%2F2EDosa27dR9tQDk3OBbIM1wuF6edPIfsE%3D&amp;reserved=0" href="https://docs.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-supported-api" target="_blank" rel="noopener noreferrer"><span>much more.</span></a><span>&nbsp;</span></p>
<p><span>We have posted 3 packages:</span><span>&nbsp;</span></p>
<ul>
<li><a title="https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.nuget.org%2Fpackages%2FMicrosoft.Windows.SDK.Contracts%2F10.0.17134.1000-preview&amp;data=01%7C01%7Cclint.rutkas%40microsoft.com%7Cc54cce871c4a4ed3f52708d6ca9fa523%7C72f988bf86f141af91ab2d7cd011db47%7C1&amp;sdata=kE4U%2FDT4c6R%2BgNTP3T%2BG339xmnNR934mCR3SyG8dSI0%3D&amp;reserved=0" href="https://www.nuget.org/packages/Microsoft.Windows.SDK.Contracts/10.0.17134.1000-preview" target="_blank" rel="noopener noreferrer"><span>Windows 10 version 1803</span></a><span>&nbsp;</span></li>
<li><a href="https://www.nuget.org/packages/Microsoft.Windows.SDK.Contracts/10.0.17763.1000-preview" target="_blank" rel="noopener noreferrer"><span>Windows 10 version 1809</span></a><span>&nbsp;</span></li>
<li><a href="https://www.nuget.org/packages/Microsoft.Windows.SDK.Contracts/10.0.18362.2002-preview" target="_blank" rel="noopener noreferrer"><span>Windows 10 version 1903</span></a><span>&nbsp;</span></li>
</ul>
<p><span>Each package includes all of the <strong>Windows Runtime (WinRT) APIs </strong>included with each specific Windows release. These are preview packages, so please give us feedback and watch for updates to the known issues on our</span><a href="https://github.com/dotnet/windows-desktop/issues" target="_blank" rel="noopener noreferrer"><span> repository.</span></a><span>&nbsp; </span><span>&nbsp;</span><span>&nbsp;</span></p>

<p><span>Previously, in order to access the Windows API surface from your WPF or </span><span>Winforms</span><span> app, you needed to specifically add contract files and other reference assemblies to your project. With this release, you can simply add a NuGet package and we will do the heavy lifting to add the contracts.</span><span>&nbsp;</span></p>
<p><span>In addition, when using the NuGet packages, updating to the latest </span><a href="https://docs.microsoft.com/en-us/uwp/api/" target="_blank" rel="noopener noreferrer"><span>Windows Runtime (WinRT) APIs</span></a><span> in your project will be as simple as checking for an <u>update</u> to the NuGet package.</span><span>&nbsp;</span><span>&nbsp;</span><span>&nbsp;</span></p>

<h3><span>Step 1: </span><span>Configure your project to support </span><a href="https://docs.microsoft.com/en-us/nuget/consume-packages/package-references-in-project-files" target="_blank" rel="noopener noreferrer"><span>Package Reference</span></a><span>&nbsp;</span><span>&nbsp;</span></h3>
<h3><span>Step 2: Add the </span><span>Microsoft.Windows.SDK.Contracts</span><span> NuGet package</span><span> to your project&nbsp;</span><span>&nbsp;</span></h3>
<ol>
<li><span>Open the </span><a href="https://docs.microsoft.com/en-us/nuget/tools/package-manager-console" target="_blank" rel="noopener noreferrer"><span>NuGet Package Manager Console</span></a><span>&nbsp;</span><span>&nbsp;</span></li>
<li>Install the package that includes the <a href="https://docs.microsoft.com/en-us/windows/whats-new/" target="_blank" rel="noopener noreferrer"><span>Windows 10 Contracts</span></a><span> you want to target. Currently the following are supported:</span> <span>&nbsp;</span></li>
</ol>
<p><span><b>Windows 10 version 1803</b></span><span>&nbsp;</span></p>
<p><span>Install-Package </span><span>Microsoft.Windows.SDK.Contracts</span><span> -Version 10.0.17134.1000-preview&nbsp;</span><span>&nbsp;</span></p>
<p><span><b>Windows 10 version 1809</b></span><span>&nbsp;</span></p>
<p><span>Install-Package </span><span>Microsoft.Windows.SDK.Contracts</span><span> -Version 10.0.17763.1000-preview&nbsp;</span><span>&nbsp;</span></p>
<p><span><b>Windows 10 version 1903</b></span><span>&nbsp;</span></p>
<p><span>Install-Package </span><span>Microsoft.Windows.SDK.Contracts</span><span> -Version 10.0.18362.2002-preview</span><span>&nbsp;</span></p>
<h3><span>Step 3: Get coding</span><span>&nbsp;</span></h3>
<p><span>By adding one of the above NuGet packages, you now have access to </span><span>calling </span><span>the </span><a href="https://docs.microsoft.com/en-us/uwp/api/" target="_blank" rel="noopener noreferrer"><span>Windows Runtime (WinRT) APIs</span></a><span> in your project.&nbsp;&nbsp;</span><span>&nbsp;</span></p>
<p><span>For example, this snippet shows a WPF Message box displaying the latitude and longitude coordinates:</span><span>&nbsp;</span></p>
<p>[code lang=”csharp”]</p>
<p>private async void Button_Click(object sender, RoutedEventArgs e)<br>
{<br>
    var locator = new Windows.Devices.Geolocation.Geolocator();<br>
    var location = await locator.GetGeopositionAsync();<br>
    var position = location.Coordinate.Point.Position;<br>
    var latlong = string.Format("lat:{0}, long:{1}", position.Latitude, position.Longitude);<br>
    var result = MessageBox.Show(latlong);<br>
} </p>
<p>[/code]</p>
<h2><span><b>Adaptive code for previous OS</b></span><span>&nbsp;</span></h2>
<p><span>Each package includes all the supported Windows Runtime APIs up to Windows 10 version of the package.  If you are targeting earlier platforms, consider only offering functionality available on the detected platform version.  For further details, see the following article: </span><a href="https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/version-adaptive-code" target="_blank" rel="noopener noreferrer"><span>Version adaptive code</span></a><span>.</span><span>&nbsp;</span></p>
<p><span>For additional information on calling Windows 10 APIs </span><span>in your desktop application, please see the following article: </span><a href="https://docs.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-enhance" target="_blank" rel="noopener noreferrer"><span>Enhance your desktop application for Windows 10</span></a><span>.</span><span>&nbsp;</span></p>
<p><span>If you want to check out a project that is already using these NuGet packages, see:</span> <a href="https://github.com/windows-toolkit/Microsoft.Toolkit.Win32" target="_blank" rel="noopener noreferrer"><span>https://github.com/windows-toolkit/Microsoft.Toolkit.Win32</span></a><span><u>.</u></span><span>&nbsp;</span></p>

				
			</article>
			<!-- .post -->

					</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>