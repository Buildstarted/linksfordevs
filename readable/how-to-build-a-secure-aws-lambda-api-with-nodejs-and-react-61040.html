<!DOCTYPE html>
<html lang="en">
<head>
    <title>
How to Build a Secure AWS Lambda API with Node.js and React - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="How to Build a Secure AWS Lambda API with Node.js and React - linksfor.dev(s)"/>
    <meta property="og:description" content="Build a secure serverless API using AWS Lambda functions, Node.js, and React."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://developer.okta.com/blog/2020/04/22/build-secure-aws-lambda-nodejs-react"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - How to Build a Secure AWS Lambda API with Node.js and React</title>
<div class="readable">
        <h1>How to Build a Secure AWS Lambda API with Node.js and React</h1>
            <div>Reading time: 34-43 minutes</div>
        <div>Posted here: 24 Apr 2020</div>
        <p><a href="https://developer.okta.com/blog/2020/04/22/build-secure-aws-lambda-nodejs-react">https://developer.okta.com/blog/2020/04/22/build-secure-aws-lambda-nodejs-react</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
		
		






<section>
  
  

<article>

    

    <div>
        
  <p>Serverless architecture with AWS Lambdas is quickly becoming a popular option for companies looking to deploy applications without the overhead of maintaining servers. AWS Lambda functions are event-driven and serverless—triggered to process a piece of code and return a result. AWS Lambdas can be written in most common languages today on a variety of platforms including .NET Core, Java, Go and, in the case of this post, Node.js.</p>

<p>The example in this post uses Node.js 12.x, the latest version available on AWS to date. You’ll be using AWS APIs to access AWS Lambdas from your application. This post will teach you how to write your API documentation in YAML and import it into AWS APIs. Additionally, you’ll learn how to deploy that API and enable CORS so that your application can access it.</p>

<p>For this project, you’ll be using React.js for the front end. React.js is one of the most popular JavaScript front end frameworks. React makes creating interactive UIs simple and intuitive. To authenticate users, you’ll be using Okta’s Single Sign-on Provider as well as Okta’s React libraries, which make handling authentication very simple, allowing you more time to focus on your business code.</p>

<p>This post outlines how to make a simple version of one of my favorite game shows as a kid, Card Sharks. The premise of the game is simple enough: A player is shown six cards, one face-up and five face-down. The player must guess if the first face-down card is higher or lower than the current face-up card. If the player is correct they gain a point and move to the next card. If the card has the same rank, no point is awarded and the game continues. If the player is incorrect, the game is over. If the player gets all the cards correct they are allowed to reshuffle the deck and draw a fresh set of 6 cards. At the end of the game, the player can submit their high score.</p>

<h2 id="get-started-with-okta"><a href="#get-started-with-okta">Get Started with Okta</a></h2>

<p>First thing’s first, create an <a href="https://developer.okta.com/">Okta developer account</a> and register an application. Log in to your Okta admin portal and navigation to <strong>Applications</strong>. Click the button labeled <strong>Add Application</strong>, select <strong>Single-Page App</strong>, then click <strong>Next</strong>. Name your application something that will represent its role for you. In my case, I used “Card Sharks.”  If your application uses port 8080, you can continue to use <code>http://localhost:8080</code> for your URLs. However, if you aren’t planning on specifically designating port 8080 for your application you will most likely use port 3000 for the application and will need to change these URLs to reflect that.</p>

<p><img src="https://d33wubrfki0l68.cloudfront.net/2e94badb82035f38b98aedec1dfd8419d4d1877f/de65e/assets-jekyll/blog/build-secure-aws-lambda-nodejs-react/app-settings-bbe4494bd60523edd2de4f60cd43a1a624b7e2e8d9eb28f038635234769df465.jpg" alt="Okta Application Settings" width="700"></p>

<p>Your completed Okta set up should look similar to this.</p>

<p>Click <strong>Done</strong> to review your application setup. Make sure to grab the <em>Client ID</em> listed under <em>Client Credentials</em> as it will be needed in your React.js application.</p>

<h2 id="configure-aws"><a href="#configure-aws">Configure AWS</a></h2>

<p>Next, set up AWS to handle your serverless operations.</p>

<h3 id="create-lambda-functions"><a href="#create-lambda-functions">Create Lambda Functions</a></h3>

<p>First, navigate to <a href="https://console.aws.amazon.com/lambda/home">AWS Lambda Home</a>. Click on <strong>Functions</strong> to see your functions’ home screen. Here you will see a button labeled <strong>Create Function</strong>. Click that to start setting up your first function.  This function will be responsible for creating a standard deck of 52 cards, shuffling it, and returning 6 cards for the React.js application to use. For the  purposes of this project, select the <strong>Author From Scratch</strong> option. The blueprints and serverless app repository are available for more complex applications, but you won’t need that today. Name your function something relevant to your application. I named mine “cardsharksApi_deck_getNewDeck”. Make sure to select the runtime as <strong>Node.js 12.x</strong>. Once you’ve clicked  <strong>Create Function</strong>, you will be brought to the function configuration screen. This is where you can add code, triggers, and anything else you may need.</p>

<p><img src="https://d33wubrfki0l68.cloudfront.net/437561f95ce24952226621e9f5acd34aadd0291b/07c2e/assets-jekyll/blog/build-secure-aws-lambda-nodejs-react/create-function-a15bea2bb4c1e6d21c4816d66f88b7d7c73d8dcbc560c71a8651a6cae28e837b.jpg" alt="Create Function" width="800"></p>

<p>Add the following to the <em>function code</em> section.</p>

<div><div><pre><code><span>exports</span><span>.</span><span>handler</span> <span>=</span> <span>async</span><span>(</span> <span>event</span> <span>)</span> <span>=&gt;</span> <span>{</span>

  <span>const</span> <span>getSuit</span> <span>=</span> <span>(</span> <span>suitId</span> <span>)</span> <span>=&gt;</span> <span>{</span>
    <span>switch</span> <span>(</span> <span>suitId</span> <span>)</span> <span>{</span>
    <span>case</span> <span>0</span><span>:</span>
      <span>return</span> <span>"</span><span>diams</span><span>"</span><span>;</span>
    <span>case</span> <span>1</span><span>:</span>
      <span>return</span> <span>"</span><span>hearts</span><span>"</span><span>;</span>
    <span>case</span> <span>2</span><span>:</span>
      <span>return</span> <span>"</span><span>spades</span><span>"</span><span>;</span>
    <span>case</span> <span>3</span><span>:</span>
      <span>return</span> <span>"</span><span>clubs</span><span>"</span><span>;</span>
    <span>default</span><span>:</span>
      <span>throw</span> <span>"</span><span>only 4 suits</span><span>"</span><span>;</span>
    <span>}</span>
  <span>};</span>

  <span>const</span> <span>getRank</span> <span>=</span> <span>(</span> <span>rankId</span> <span>)</span> <span>=&gt;</span> <span>{</span>
    <span>if</span> <span>(</span> <span>rankId</span> <span>&gt;</span> <span>13</span> <span>||</span> <span>rankId</span> <span>&lt;</span> <span>1</span> <span>)</span>
      <span>throw</span> <span>"</span><span>invalid rank </span><span>"</span> <span>+</span> <span>rankId</span><span>;</span>
    <span>switch</span> <span>(</span> <span>rankId</span> <span>)</span> <span>{</span>
    <span>case</span> <span>11</span><span>:</span>
      <span>return</span> <span>"</span><span>J</span><span>"</span><span>;</span>
    <span>case</span> <span>12</span><span>:</span>
      <span>return</span> <span>"</span><span>Q</span><span>"</span><span>;</span>
    <span>case</span> <span>13</span><span>:</span>
      <span>return</span> <span>"</span><span>K</span><span>"</span><span>;</span>
    <span>case</span> <span>1</span><span>:</span>
      <span>return</span> <span>"</span><span>A</span><span>"</span><span>;</span>
    <span>default</span><span>:</span>
      <span>return</span> <span>rankId</span><span>.</span><span>toString</span><span>();</span>
    <span>}</span>
  <span>};</span>

  <span>const</span> <span>buildDeck</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>
    <span>let</span> <span>deck</span> <span>=</span> <span>[];</span>

    <span>for</span> <span>(</span> <span>let</span> <span>suit</span> <span>=</span> <span>0</span><span>;</span> <span>suit</span> <span>&lt;</span> <span>3</span><span>;</span> <span>suit</span><span>++</span> <span>)</span> <span>{</span>
      <span>for</span> <span>(</span> <span>let</span> <span>value</span> <span>=</span> <span>1</span><span>;</span> <span>value</span> <span>&lt;=</span> <span>13</span><span>;</span> <span>value</span><span>++</span> <span>)</span> <span>{</span>
        <span>deck</span><span>.</span><span>push</span><span>(</span> <span>{</span>
          <span>suit</span><span>:</span> <span>getSuit</span><span>(</span> <span>suit</span> <span>),</span>
          <span>rank</span><span>:</span> <span>getRank</span><span>(</span> <span>value</span> <span>),</span>
          <span>value</span><span>:</span> <span>value</span><span>,</span>
          <span>visible</span><span>:</span> <span>false</span>
        <span>}</span> <span>);</span>
      <span>}</span>
    <span>}</span>

    <span>return</span> <span>deck</span><span>;</span>
  <span>};</span>

  <span>const</span> <span>getCards</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>

    <span>let</span> <span>deck</span> <span>=</span> <span>buildDeck</span><span>();</span>
    <span>deck</span><span>.</span><span>sort</span><span>(</span> <span>(</span> <span>a</span><span>,</span> <span>b</span> <span>)</span> <span>=&gt;</span> <span>0.5</span> <span>-</span> <span>Math</span><span>.</span><span>random</span><span>()</span> <span>);</span>

    <span>let</span> <span>cards</span> <span>=</span> <span>[];</span>

    <span>for</span> <span>(</span> <span>let</span> <span>i</span> <span>=</span> <span>0</span><span>;</span> <span>i</span> <span>&lt;</span> <span>6</span><span>;</span> <span>i</span><span>++</span> <span>)</span> <span>{</span>
      <span>let</span> <span>card</span> <span>=</span> <span>deck</span><span>[</span><span>i</span><span>];</span>

      <span>if</span> <span>(</span> <span>i</span> <span>==</span> <span>0</span> <span>)</span>
        <span>card</span><span>.</span><span>visible</span> <span>=</span> <span>true</span><span>;</span>

      <span>card</span><span>.</span><span>order</span> <span>=</span> <span>i</span><span>;</span>

      <span>cards</span><span>.</span><span>push</span><span>(</span> <span>card</span> <span>);</span>
    <span>}</span>
    <span>return</span> <span>cards</span><span>;</span>
  <span>};</span>

  <span>const</span> <span>response</span> <span>=</span> <span>{</span>
    <span>statusCode</span><span>:</span> <span>200</span><span>,</span>
    <span>body</span><span>:</span> <span>JSON</span><span>.</span><span>stringify</span><span>(</span> <span>getCards</span><span>()</span> <span>)</span>
  <span>};</span>
  <span>return</span> <span>response</span><span>;</span>
<span>};</span>
</code></pre></div></div>

<p>AWS provides a simple blank, “Hello World,” output with a response code of 200. Keep that code, but replace your body with the <code>getCards()</code> function call. <code>getCards()</code> calls <code>buildDeck()</code> which creates your 52 cards—ace through King of each suit. In this game, aces will be considered low, making their value 1. If you wish to make them high, change the value to 14. For an added challenge, consider how you would handle Aces being low or high.</p>

<p>Next, you need to test your function. This is relatively easy—click the <strong>Test</strong> button on the top of your screen. You should then see  a screen that says “Configure Test Event” with some JSON dummy values in it. These values will be passed to your function in the <code>event</code> object. Since building the deck doesn’t require any input, feel free to leave this as an empty JSON object.</p>

<p>Name your test trigger something that is relevant to you. I named mine “TestTrigger” as I only anticipate needing it this once. After you’ve done this, press <strong>Create</strong>. Now, when you press <strong>Test</strong>, you can select the Trigger from your dropdown box next to the <strong>Test</strong> button. When you press <strong>Test</strong> again, the response will be listed after the code in the <em>Function Code</em> window. Ideally, you should see <code>statusCode: 200</code> along with a JSON array that contains some information about six cards.</p>

<p>At this point, there are still two more functions you need to implement that will allow you to both get and save high scores. For these, you will need to connect your AWS lambda function to the storage system of your choice. For this application, you can stub these two functions out until you are ready to connect to your storage.</p>

<p>Create another function for <code>cardsharksApi_highScores_postHighScore</code>. In the <em>Function Code</em> section of the lambda, screen add the following code.</p>

<div><div><pre><code><span>exports</span><span>.</span><span>handler</span> <span>=</span> <span>async</span> <span>(</span> <span>event</span> <span>)</span> <span>=&gt;</span> <span>{</span>

  <span>const</span> <span>response</span> <span>=</span> <span>{</span>
    <span>statusCode</span><span>:</span> <span>200</span><span>,</span>
    <span>body</span><span>:</span> <span>JSON</span><span>.</span><span>stringify</span><span>(</span> <span>{</span>
      <span>player</span><span>:</span> <span>event</span><span>.</span><span>player</span><span>,</span>
      <span>score</span><span>:</span> <span>event</span><span>.</span><span>score</span>
    <span>}</span> <span>),</span>
  <span>};</span>
  <span>return</span> <span>response</span><span>;</span>
<span>};</span>
</code></pre></div></div>

<p>Feel free to  add whatever error-handling or data validation you need here before sending it to your repository. Next, click on <strong>Test</strong> and add a new test. For this, you will need to add some simple JSON.</p>

<div><div><pre><code><span>{</span><span>
  </span><span>"player"</span><span>:</span><span> </span><span>"player 1"</span><span>,</span><span>
  </span><span>"score"</span><span>:</span><span> </span><span>"1"</span><span>
</span><span>}</span><span>
</span></code></pre></div></div>

<p>Your React app will send your player’s name along with their score to the server. This JSON represents what the function is expecting to receive from the React.js app. These parameters can be accessed in the <code>event</code> property provided by the boilerplate from Amazon. You can add up to 10 cases once you’ve fleshed out your data validation to ensure that your test cases are covered.</p>

<p>Lastly, create a function for <code>cardsharksApi_highScores_getHighScores</code>. Add the following code to it:</p>

<div><div><pre><code><span>exports</span><span>.</span><span>handler</span> <span>=</span> <span>async</span><span>(</span> <span>event</span> <span>)</span> <span>=&gt;</span> <span>{</span>

  <span>const</span> <span>getHighScores</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>

    <span>const</span> <span>scores</span> <span>=</span> <span>[];</span>

    <span>scores</span><span>.</span><span>push</span><span>(</span> <span>{</span>
      <span>player</span><span>:</span> <span>"</span><span>Roger Rabbit</span><span>"</span><span>,</span>
      <span>score</span><span>:</span> <span>100</span>
    <span>}</span> <span>);</span>

    <span>scores</span><span>.</span><span>push</span><span>(</span> <span>{</span>
      <span>player</span><span>:</span> <span>"</span><span>Donald Duck</span><span>"</span><span>,</span>
      <span>score</span><span>:</span> <span>50</span>
    <span>}</span> <span>);</span>

    <span>scores</span><span>.</span><span>push</span><span>(</span> <span>{</span>
      <span>player</span><span>:</span> <span>"</span><span>Goofy</span><span>"</span><span>,</span>
      <span>score</span><span>:</span> <span>40</span>
    <span>}</span> <span>);</span>

    <span>scores</span><span>.</span><span>push</span><span>(</span> <span>{</span>
      <span>player</span><span>:</span> <span>"</span><span>John Daly</span><span>"</span><span>,</span>
      <span>score</span><span>:</span> <span>30</span>
    <span>}</span> <span>);</span>

    <span>scores</span><span>.</span><span>push</span><span>(</span> <span>{</span>
      <span>player</span><span>:</span> <span>"</span><span>Mike Tyson</span><span>"</span><span>,</span>
      <span>score</span><span>:</span> <span>20</span>
    <span>}</span> <span>);</span>

    <span>return</span> <span>scores</span><span>;</span>

  <span>};</span>

  <span>const</span> <span>response</span> <span>=</span> <span>{</span>
    <span>statusCode</span><span>:</span> <span>200</span><span>,</span>
    <span>body</span><span>:</span> <span>JSON</span><span>.</span><span>stringify</span><span>(</span> <span>getHighScores</span><span>()</span> <span>),</span>
  <span>};</span>
  <span>return</span> <span>response</span><span>;</span>
<span>};</span>
</code></pre></div></div>

<p>Again, this is sending back dummy data for the application to use. Once you’ve connected to your repository, you can replace this code with your data access logic.</p>

<h3 id="create-your-yaml-api"><a href="#create-your-yaml-api">Create Your YAML API</a></h3>

<p>With your lambda functions complete, it’s time to set up your API endpoints which will interface with your React.js application and your lambda functions. One great thing about AWS API is that it will take a YAML definition of your API and implement it to your endpoints automatically. If you are comfortable creating the endpoints yourself and don’t wish to write out a YAML definition, you can skip this section. However, in a real-world setting, the advantages of being able to document your API and implement it in one step makes this approach very useful. This is doubly true when you’re dealing with large APIs that many developers will need to access.</p>

<p>You can review my version of the YAML below.</p>

<div><div><pre><code><span>openapi</span><span>:</span> <span>3.0.0</span>
<span># Added by API Auto Mocking Plugin</span>
<span>servers</span><span>:</span>
  <span>-</span> <span>description</span><span>:</span> <span>SwaggerHub API Auto Mocking</span>
    <span>url</span><span>:</span> <span>https://virtserver.swaggerhub.com/FishbowlLLC/CardSharks/1.0.0</span>
<span>info</span><span>:</span>
  <span>description</span><span>:</span> <span>This is the API to backend the card sharks React app using Okta Single Sign on Provider</span>
  <span>version</span><span>:</span> <span>"</span><span>1.0.0"</span>
  <span>title</span><span>:</span> <span>Cardsharks API</span>
  <span>contact</span><span>:</span>
    <span>email</span><span>:</span> <span>nik@fishbowlllc.com</span>
  <span>license</span><span>:</span>
    <span>name</span><span>:</span> <span>Apache </span><span>2.0</span>
    <span>url</span><span>:</span> <span>'</span><span>http://www.apache.org/licenses/LICENSE-2.0.html'</span>
<span>tags</span><span>:</span>
  <span>-</span> <span>name</span><span>:</span> <span>deck</span>
    <span>description</span><span>:</span> <span>Calls for getting a new deck</span>
  <span>-</span> <span>name</span><span>:</span> <span>highscore</span>
    <span>description</span><span>:</span> <span>Calls for getting and saving high scores</span>
<span>paths</span><span>:</span>
  <span>/deck</span><span>:</span>
    <span>get</span><span>:</span>
      <span>tags</span><span>:</span>
        <span>-</span> <span>deck</span>
      <span>summary</span><span>:</span> <span>Gets deck for a new game</span>
      <span>operationId</span><span>:</span> <span>getdeck</span>
      <span>description</span><span>:</span> <span>|</span>
        <span>Gets a 52 card deck and shuffles it and returns 6 cards for the game</span>
      <span>responses</span><span>:</span>
        <span>'</span><span>200'</span><span>:</span>
          <span>description</span><span>:</span> <span>6 cards in an ordered array</span>
          <span>content</span><span>:</span>
            <span>application/json</span><span>:</span>
              <span>schema</span><span>:</span>
                <span>type</span><span>:</span> <span>array</span>
                <span>items</span><span>:</span>
                  <span>$ref</span><span>:</span> <span>'</span><span>#/components/schemas/Card'</span>
  <span>/highscore</span><span>:</span>
    <span>get</span><span>:</span>
      <span>tags</span><span>:</span>
        <span>-</span> <span>highscore</span>
      <span>summary</span><span>:</span> <span>gets the high scores list</span>
      <span>responses</span><span>:</span>
        <span>'</span><span>200'</span><span>:</span>
          <span>description</span><span>:</span> <span>Top 10 high scores</span>
          <span>content</span><span>:</span>
            <span>application/json</span><span>:</span>
              <span>schema</span><span>:</span>
                <span>type</span><span>:</span> <span>array</span>
                <span>items</span><span>:</span>
                  <span>$ref</span><span>:</span> <span>'</span><span>#/components/schemas/HighScore'</span>
    <span>post</span><span>:</span>
      <span>tags</span><span>:</span>
        <span>-</span> <span>highscore</span>
      <span>summary</span><span>:</span> <span>adds a score to the high scores</span>
      <span>responses</span><span>:</span>
       <span>'</span><span>200'</span><span>:</span>
          <span>description</span><span>:</span> <span>Score Accepted</span>
<span>components</span><span>:</span>
  <span>schemas</span><span>:</span>
    <span>Card</span><span>:</span>
      <span>type</span><span>:</span> <span>object</span>
      <span>properties</span><span>:</span>
        <span>suit</span><span>:</span>
          <span>type</span><span>:</span> <span>string</span>
        <span>rank</span><span>:</span>
          <span>type</span><span>:</span> <span>string</span>
          <span>description</span><span>:</span> <span>the face of the card, A, 1, 2, 3, 4, 5, 6, 7, ,8 ,9, 10, J, Q, K</span>
          <span>example</span><span>:</span> <span>K</span>
        <span>value</span><span>:</span>
          <span>type</span><span>:</span> <span>integer</span>
          <span>description</span><span>:</span> <span>the corresponding values of each rank. Ace = 1, J = 11, Q = 12, K = 13, numerical ranks are the same value as rank</span>
          <span>example</span><span>:</span> <span>13</span>
        <span>visible</span><span>:</span>
          <span>type</span><span>:</span> <span>boolean</span>
          <span>description</span><span>:</span> <span>describes if the card is visible to the player</span>
    <span>HighScore</span><span>:</span>
      <span>type</span><span>:</span> <span>object</span>
      <span>properties</span><span>:</span>
        <span>name</span><span>:</span>
          <span>type</span><span>:</span> <span>string</span>
          <span>description</span><span>:</span> <span>username of high score owner</span>
        <span>score</span><span>:</span>
          <span>type</span><span>:</span> <span>integer</span>

</code></pre></div></div>

<h3 id="import-swagger-into-aws-api"><a href="#import-swagger-into-aws-api">Import Swagger into AWS API</a></h3>

<p>Now, navigate to <a href="https://console.aws.amazon.com/apigateway/main">Amazon API Gateway</a> and start setting up your API. Click <strong>Create API</strong>, then select <strong>REST API</strong> using the <strong>Build</strong> button. Name your API something relevant and click <strong>Create API</strong>. You can leave the rest of the fields on the default.</p>

<p>This will direct you to your API Gateway home. Click <strong>Actions</strong> and select <strong>Import API</strong>. From here, copy and paste the YAML into the definition window and click <strong>Import</strong>. Your API is now set up!</p>

<p>If you chose to skip the last section, you can click <strong>Actions</strong> then <strong>Create Resource</strong> and <strong>Create Method</strong> to create your endpoints and manually define them.</p>

<h3 id="connect-aws-lambda-to-apis"><a href="#connect-aws-lambda-to-apis">Connect AWS Lambda to APIs</a></h3>

<p>Next, you’ll want to connect Lambda to your APIs. Open the method integration window by clicking <em>GET</em> under the <code>/deck</code> options   <em>Lambda Function</em> should be preselected by default but, if it isn’t, make sure to select it before continuing. Next, enter the name of your function in the <em>Lambda Function</em> text box. When you click <em>Save,</em> you will see a notification about adding permissions to the Lambda function. Click <em>Ok</em> to be directed to the method execution page. Here, you’ll notice that the method request is passed to the integration request which connects first to your lambda function and then back through the response chain to the client. Repeat the above steps for <code>/highscore/GET</code> by mapping it to your lambda function <code>cardsharksApi_highScores_getHighScores</code> and <code>/highscore/POST</code> to <code>cardsharksApi_highScores_postHighScore</code>.</p>

<h3 id="enable-cors-and-deploy"><a href="#enable-cors-and-deploy">Enable CORS and Deploy</a></h3>

<p>Now that you’ve connected AWS lambdas to the API endpoints, it’s time to deploy your API. First, make sure to enable CORS. Click <code>/deck</code> and select <strong>Actions</strong>, then <strong>Enable CORS</strong>. The default options should be enough for this application, but you’ll likely want to review the full capabilities later. Select <strong>Enable CORS and replace existing CORS headers</strong> in the lower right.</p>

<p>A window with a list of tasks will appear and, as AWS executes them, they will display a green check mark or red X. You’ll need to review any errors that you see. A quick warning—when AWS creates the <code>OPTIONS</code> method it doesn’t set up the responses which usually causes CORS to fail. To fix this, click <strong>Options</strong> under the <code>/deck</code> resource.</p>

<p><img src="https://d33wubrfki0l68.cloudfront.net/d25af5742c4c29b941cc7d40d687b8e605a1d7b6/68865/assets-jekyll/blog/build-secure-aws-lambda-nodejs-react/deck-options-add-response-1-d564c539336814f31eb7dd6cea308d45ce3e7802a737507376b5b3e94e7e4f39.jpg" alt="Options" width="800"></p>

<p>Click <strong>Method Response</strong> —&gt; <strong>Add Response</strong>.</p>

<p><img src="https://d33wubrfki0l68.cloudfront.net/46d8fa880f3376e8b37aa2e68c8e0add00cebed8/3b4ed/assets-jekyll/blog/build-secure-aws-lambda-nodejs-react/deck-options-add-response-2-d90257c9dc7f8e2bbfb9be5e0338c3740fb605933d9deb1f28ebe01f0b52f27f.jpg" alt="Add Response" width="800"></p>

<p>Add status code 200 and save.</p>

<p><img src="https://d33wubrfki0l68.cloudfront.net/08bc3855bcb5718d1a4c16d1300830fd71078b0f/a3e04/assets-jekyll/blog/build-secure-aws-lambda-nodejs-react/deck-options-add-response-3-53b1881640b68a2e72d9b82230205dfa0f0b1265676687f3d6de2f825cc7e2c8.jpg" alt="Status Code 200" width="800"></p>

<p>Next, return to the <code>/deck</code> resource and click <strong>Actions</strong> and <strong>Enable Cors</strong>. Repeat the workflow and the errors should be gone. Repeat this step for the <code>/highscore</code> resource.</p>

<p><img src="https://d33wubrfki0l68.cloudfront.net/0f5aef9ccd9d2247ed6b0031c6dfb51fd3afd68a/f9956/assets-jekyll/blog/build-secure-aws-lambda-nodejs-react/deck-options-add-response-4-801ff63c37e05074389743f851aa42ae15ec21a27487bef790df43aa9be5b426.jpg" alt="Enable CORS" width="800"></p>

<p>Once again, click <strong>Actions</strong> and then <strong>Deploy API</strong>. For Development Stage select <strong>[New Stage]</strong> and give your stage a relevant name. These stages are intended to break the production code away from the testing code. Since you only have one stage, you can name this whatever you like. Click <strong>Deploy</strong> and your API is ready for use. You can verify this with ARC or Postman.</p>

<p>After clicking deploy, you should land on the <strong>Stages</strong> page on your API. You can open any of the stages you have created and select the <code>/deck/get</code> method. There you will see an alert with the text <code>Invoke URL: {some url}</code>. This URL is what your application will need to call.</p>

<h2 id="build-your-frontend-reactjs-application"><a href="#build-your-frontend-reactjs-application">Build Your Frontend React.js Application</a></h2>

<p>With your API set up and ready to go, you can begin to work on the React.js application.</p>

<h3 id="create-your-reactjs-application"><a href="#create-your-reactjs-application">Create Your React.js Application</a></h3>

<p>To set up your app, use the <a href="https://reactjs.org/docs/create-a-new-react-app.html">Create React App tool chain defined here</a>. This provides a quick and handy way to fire up a new React.js application. Navigate to the parent folder where your React.js application will be. Then, use the npx package runner with the command <code>npx create-react-app {folder}</code>. Then, go grab a cup of tea or coffee as this process takes a few minutes.</p>

<p>Once it is complete, you can install the dependencies for the application.</p>

<p>First, get the Okta React libraries.</p>

<div><div><pre><code><span>npm install @okta/okta-auth-js@3.1
npm install @okta/okta-react@3.0 react-router-dom@5.1
npm install @okta/okta-signin-widget@3.9
</span></code></pre></div></div>

<p>Next, use Bootstrap for styling. To do this, install React Bootstrap as well as Bootstrap. React Bootstrap is used to bridge the gap between React.js and Bootstrap, however, it does not ship with the Bootstrap CSS so you will need to install that as well.</p>

<div><div><pre><code><span>npm i react-bootstrap@1.0 bootstrap@4.4
</span></code></pre></div></div>

<p>Finally, you will use dotenv to store your sensitive values.</p>



<p>In your root, create a file named <code>.env</code> and add the following keys.</p>

<div><div><pre><code><span>REACT_APP_OKTA_CLIENTID</span><span>={</span>yourClientId<span>}</span>
<span>REACT_APP_OKTA_URL_BASE</span><span>={</span>yourOktaDomain<span>}</span>
<span>REACT_APP_OKTA_APP_BASE_URL</span><span>=</span>http://localhost:3000
<span>REACT_APP_AMAZON_API_BASE</span><span>=</span>
</code></pre></div></div>

<p>You can get <code>REACT_APP_AMAZON_API_BASE</code> from the base of your invoke URL from Amazon API. You may need to change your <code>REACT_APP_OKTA_APP_BASE_URL</code> to a different port if you are developing against one other than 3000. Note here that all of your keys start with <code>REACT_APP_*</code>. This is required for React.js to read the values.</p>

<p>For the cards styling, you will use <a href="https://github.com/selfthinker/CSS-Playing-Cards">this CSS playing cards library</a> provided by <a href="https://github.com/selfthinker/CSS-Playing-Cards/commits?author=selfthinker">selfthinker</a> on GitHub. Add the <code>cards.css</code> from this repo to your <code>src</code> directory. If required, you can also bring in the IE and IE9 libraries. You will also need to add the <code>faces</code> directory from the repo to your <code>src</code> directory.</p>

<p>To allow React Bootstrap to do its job, add <code>import 'bootstrap/dist/css/bootstrap.min.css';</code> to the top of your <code>App.js</code> file. This will give React Bootstrap access to the CSS libraries from Bootstrap.</p>

<p>Add a file to the <code>src</code> directory called <code>AppWithRouterAccess.jsx</code>. You will implement the code for this shortly.</p>

<p>Finally, add two folders, <code>Components</code> and <code>Pages</code> under your <code>src</code> folder. In <code>Components</code> add the following files: <code>Card.jsx</code>, <code>GameBoard.jsx</code>, <code>GameHome.jsx</code>, <code>GameOver.jsx</code>, <code>Header.jsx</code>, and <code>LoginForm.jsx</code>. These components will be reused or enable you to compartmentalize logically separate screens from each other.</p>

<p>In pages, add the following files: <code>Game.jsx</code>, <code>Home.jsx</code>, <code>Login.jsx</code>. You can now work on implementing each of these pages.</p>

<h3 id="implement-the-reactjs-components"><a href="#implement-the-reactjs-components">Implement the React.js Components</a></h3>

<p>First you can implement the <code>AppWithRouterAccess.jsx</code> file.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Route</span><span>,</span> <span>useHistory</span> <span>}</span> <span>from</span> <span>"</span><span>react-router-dom</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Security</span><span>,</span> <span>SecureRoute</span><span>,</span> <span>LoginCallback</span> <span>}</span> <span>from</span> <span>"</span><span>@okta/okta-react</span><span>"</span><span>;</span>
<span>import</span> <span>Home</span> <span>from</span> <span>"</span><span>./Pages/Home</span><span>"</span><span>;</span>
<span>import</span> <span>Game</span> <span>from</span> <span>"</span><span>./Pages/Game</span><span>"</span><span>;</span>
<span>import</span> <span>Login</span> <span>from</span> <span>"</span><span>./Pages/Login</span><span>"</span><span>;</span>

<span>const</span> <span>AppWithRouterAccess</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>
  <span>const</span> <span>history</span> <span>=</span> <span>useHistory</span><span>();</span>
  <span>const</span> <span>onAuthRequired</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>
    <span>history</span><span>.</span><span>push</span><span>(</span> <span>"</span><span>/login</span><span>"</span> <span>);</span>
  <span>};</span>

  <span>const</span> <span>baseDomain</span> <span>=</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>REACT_APP_OKTA_URL_BASE</span><span>;</span>
  <span>const</span> <span>issuer</span> <span>=</span> <span>baseDomain</span> <span>+</span> <span>"</span><span>/oauth2/default</span><span>"</span><span>;</span>
  <span>const</span> <span>clientId</span> <span>=</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>REACT_APP_OKTA_CLIENTID</span><span>;</span>
  <span>const</span> <span>redirect</span> <span>=</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>REACT_APP_OKTA_APP_BASE_URL</span> <span>+</span> <span>"</span><span>/implicit/callback</span><span>"</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>Security</span> <span>issuer=</span><span>{</span><span>issuer</span><span>}</span>
      <span>clientId=</span><span>{</span><span>clientId</span><span>}</span>
      <span>redirectUri=</span><span>{</span><span>redirect</span><span>}</span>
      <span>onAuthRequired=</span><span>{</span><span>onAuthRequired</span><span>}</span>
      <span>pkce=</span><span>{</span><span>true</span><span>}</span> <span>&gt;</span>
      <span>&lt;</span><span>Route</span> <span>path=</span><span>'/'</span> <span>exact=</span><span>{</span><span>true</span><span>}</span> <span>component=</span><span>{</span><span>Home</span><span>}</span> <span>/&gt;</span>
      <span>&lt;</span><span>SecureRoute</span> <span>path=</span><span>'/Game'</span> <span>component=</span><span>{</span><span>Game</span><span>}</span> <span>/&gt;</span>
      <span>&lt;</span><span>Route</span> <span>path=</span><span>'/login'</span> <span>render=</span><span>{</span><span>()</span> <span>=&gt;</span> <span>&lt;</span><span>Login</span> <span>baseUrl=</span><span>{</span><span>baseDomain</span><span>}</span> <span>issuer=</span><span>{</span><span>issuer</span><span>}</span> <span>/&gt;</span><span>}</span> <span>/&gt;</span>
      <span>&lt;</span><span>Route</span> <span>path=</span><span>'/implicit/callback'</span> <span>component=</span><span>{</span><span>LoginCallback</span><span>}</span> <span>/&gt;</span>
    <span>&lt;/</span><span>Security</span><span>&gt;</span>
  <span>);</span>
<span>};</span>
<span>export</span> <span>default</span> <span>AppWithRouterAccess</span><span>;</span>
</code></pre></div></div>

<p>This component does the major lifting between Okta and your React.js application. Its primary responsibility is to set up your routes for your application. Notice that the <code>/Game</code> route is labeled as a <code>SecureRoute</code>. This enables your application to enforce authentication on that route. Unauthenticated users won’t be able to access that route. Instead, they will be redirected to the <code>Login</code> page. You also want to set up the route for <code>/implicit/callback</code> that Okta uses for its authentication workflow.</p>

<p>Now, shift your focus to the <code>Components</code> folder. Start by setting up your <code>Header</code> component.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>useOktaAuth</span> <span>}</span> <span>from</span> <span>"</span><span>@okta/okta-react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Navbar</span><span>,</span> <span>Nav</span><span>,</span> <span>Form</span><span>,</span> <span>Button</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>

<span>const</span> <span>Header</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>
  <span>const</span> <span>{</span> <span>authState</span><span>,</span> <span>authService</span> <span>}</span> <span>=</span> <span>useOktaAuth</span><span>();</span>

  <span>if</span> <span>(</span> <span>authState</span><span>.</span><span>isPending</span> <span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span>Loading...<span>&lt;/</span><span>div</span><span>&gt;;</span>
  <span>}</span>

  <span>const</span> <span>button</span> <span>=</span> <span>authState</span><span>.</span><span>isAuthenticated</span> <span>?</span>
    <span>&lt;</span><span>Button</span> <span>variant=</span><span>"secondary"</span> <span>onClick=</span><span>{</span><span>()</span> <span>=&gt;</span> <span>{</span> <span>authService</span><span>.</span><span>logout</span><span>();</span> <span>}</span><span>}</span><span>&gt;</span>Logout<span>&lt;/</span><span>Button</span><span>&gt;</span> <span>:</span>
    <span>&lt;</span><span>Button</span> <span>variant=</span><span>"secondary"</span> <span>onClick=</span><span>{</span><span>()</span> <span>=&gt;</span> <span>{</span> <span>authService</span><span>.</span><span>login</span><span>();</span> <span>}</span><span>}</span><span>&gt;</span>Login<span>&lt;/</span><span>Button</span><span>&gt;;</span>

  <span>return</span> <span>(</span>

    <span>&lt;</span><span>Navbar</span> <span>bg=</span><span>"light"</span> <span>expand=</span><span>"lg"</span><span>&gt;</span>
      <span>&lt;</span><span>Navbar</span><span>.</span><span>Brand</span> <span>href=</span><span>"/"</span><span>&gt;</span>Card Sharks<span>&lt;/</span><span>Navbar</span><span>.</span><span>Brand</span><span>&gt;</span>
      <span>&lt;</span><span>Navbar</span><span>.</span><span>Toggle</span> <span>aria</span><span>-</span><span>controls=</span><span>"basic-navbar-nav"</span> <span>/&gt;</span>
      <span>&lt;</span><span>Navbar</span><span>.</span><span>Collapse</span> <span>id=</span><span>"basic-navbar-nav"</span><span>&gt;</span>
        <span>&lt;</span><span>Nav</span> <span>className=</span><span>"mr-auto"</span><span>&gt;</span>
          <span>&lt;</span><span>Nav</span><span>.</span><span>Link</span> <span>href=</span><span>"/"</span><span>&gt;</span>Home<span>&lt;/</span><span>Nav</span><span>.</span><span>Link</span><span>&gt;</span>
          <span>&lt;</span><span>Nav</span><span>.</span><span>Link</span> <span>href=</span><span>"/game"</span><span>&gt;</span>New Game<span>&lt;/</span><span>Nav</span><span>.</span><span>Link</span><span>&gt;</span>
        <span>&lt;/</span><span>Nav</span><span>&gt;</span>
        <span>&lt;</span><span>Form</span> <span>inline</span><span>&gt;</span>
          <span>{</span><span>button</span><span>}</span>
        <span>&lt;/</span><span>Form</span><span>&gt;</span>
      <span>&lt;/</span><span>Navbar</span><span>.</span><span>Collapse</span><span>&gt;</span>
    <span>&lt;/</span><span>Navbar</span><span>&gt;</span>

  <span>);</span>
<span>};</span>
<span>export</span> <span>default</span> <span>Header</span><span>;</span>
</code></pre></div></div>

<p>This simple component gives your users a nav bar that will be used on each page and a button that is changed from a login button to a logout button once the user is authenticated. Again, since <code>/game</code> is a <code>SecureRoute</code> if the user clicks <strong>Game</strong> they will be directed to the login page.</p>

<p>Next, implement the <code>LoginForm</code> component.</p>

<div><div><pre><code><span>import</span> <span>React</span><span>,</span> <span>{</span> <span>useState</span> <span>}</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>OktaAuth</span> <span>from</span> <span>"</span><span>@okta/okta-auth-js</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>useOktaAuth</span> <span>}</span> <span>from</span> <span>"</span><span>@okta/okta-react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Form</span><span>,</span> <span>Button</span><span>,</span> <span>Row</span><span>,</span> <span>Col</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>

<span>const</span> <span>LoginForm</span> <span>=</span> <span>(</span> <span>{</span> <span>baseUrl</span><span>,</span> <span>issuer</span> <span>}</span> <span>)</span> <span>=&gt;</span> <span>{</span>

  <span>const</span> <span>{</span> <span>authService</span> <span>}</span> <span>=</span> <span>useOktaAuth</span><span>();</span>
  <span>const</span> <span>[</span> <span>sessionToken</span><span>,</span> <span>setSessionToken</span> <span>]</span> <span>=</span> <span>useState</span><span>();</span>
  <span>const</span> <span>[</span> <span>username</span><span>,</span> <span>setUsername</span> <span>]</span> <span>=</span> <span>useState</span><span>();</span>
  <span>const</span> <span>[</span> <span>password</span><span>,</span> <span>setPassword</span> <span>]</span> <span>=</span> <span>useState</span><span>();</span>

  <span>const</span> <span>handleSubmit</span> <span>=</span> <span>(</span> <span>e</span> <span>)</span> <span>=&gt;</span> <span>{</span>
    <span>e</span><span>.</span><span>preventDefault</span><span>();</span>
    <span>const</span> <span>oktaAuth</span> <span>=</span> <span>new</span> <span>OktaAuth</span><span>(</span> <span>{</span> <span>url</span><span>:</span> <span>baseUrl</span><span>,</span> <span>issuer</span><span>:</span> <span>issuer</span> <span>}</span> <span>);</span>
    <span>oktaAuth</span><span>.</span><span>signIn</span><span>(</span> <span>{</span> <span>username</span><span>,</span> <span>password</span> <span>}</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span> <span>res</span> <span>=&gt;</span> <span>setSessionToken</span><span>(</span> <span>res</span><span>.</span><span>sessionToken</span> <span>)</span> <span>)</span>
      <span>.</span><span>catch</span><span>(</span> <span>err</span> <span>=&gt;</span> <span>console</span><span>.</span><span>log</span><span>(</span> <span>"</span><span>Found an error</span><span>"</span><span>,</span> <span>err</span> <span>)</span> <span>);</span>
  <span>};</span>

  <span>const</span> <span>handleUsernameChange</span> <span>=</span> <span>(</span> <span>e</span> <span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setUsername</span><span>(</span> <span>e</span><span>.</span><span>target</span><span>.</span><span>value</span> <span>);</span>
  <span>};</span>

  <span>const</span> <span>handlePasswordChange</span> <span>=</span> <span>(</span> <span>e</span> <span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setPassword</span><span>(</span> <span>e</span><span>.</span><span>target</span><span>.</span><span>value</span> <span>);</span>
  <span>};</span>

  <span>if</span> <span>(</span> <span>sessionToken</span> <span>)</span> <span>{</span>
    <span>authService</span><span>.</span><span>redirect</span><span>(</span> <span>{</span> <span>sessionToken</span> <span>}</span> <span>);</span>
    <span>return</span> <span>null</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>

    <span>&lt;</span><span>Row</span><span>&gt;</span>
      <span>&lt;</span><span>Col</span> <span>sm=</span><span>{</span><span>3</span><span>}</span><span>&gt;</span>
        <span>&lt;</span><span>Form</span> <span>onSubmit=</span><span>{</span><span>handleSubmit</span><span>}</span><span>&gt;</span>

          <span>&lt;</span><span>Form</span><span>.</span><span>Group</span> <span>controlId=</span><span>"username"</span><span>&gt;</span>
            <span>&lt;</span><span>Form</span><span>.</span><span>Label</span><span>&gt;</span>Username<span>&lt;/</span><span>Form</span><span>.</span><span>Label</span><span>&gt;</span>
            <span>&lt;</span><span>Form</span><span>.</span><span>Control</span> <span>type=</span><span>"text"</span> <span>placeholder=</span><span>"Enter Username"</span> <span>value=</span><span>{</span><span>username</span><span>}</span> <span>onChange=</span><span>{</span><span>handleUsernameChange</span><span>}</span> <span>/&gt;</span>
          <span>&lt;/</span><span>Form</span><span>.</span><span>Group</span><span>&gt;</span>

          <span>&lt;</span><span>Form</span><span>.</span><span>Group</span> <span>controlId=</span><span>"password"</span><span>&gt;</span>
            <span>&lt;</span><span>Form</span><span>.</span><span>Label</span><span>&gt;</span>Password<span>&lt;/</span><span>Form</span><span>.</span><span>Label</span><span>&gt;</span>
            <span>&lt;</span><span>Form</span><span>.</span><span>Control</span> <span>type=</span><span>"password"</span> <span>placeholder=</span><span>"password"</span> <span>value=</span><span>{</span><span>password</span><span>}</span> <span>onChange=</span><span>{</span><span>handlePasswordChange</span><span>}</span> <span>/&gt;</span>
          <span>&lt;/</span><span>Form</span><span>.</span><span>Group</span><span>&gt;</span>

          <span>&lt;</span><span>Button</span> <span>variant=</span><span>"primary"</span> <span>type=</span><span>"submit"</span><span>&gt;</span>
            Login
          <span>&lt;/</span><span>Button</span><span>&gt;</span>

        <span>&lt;/</span><span>Form</span><span>&gt;</span>
      <span>&lt;/</span><span>Col</span><span>&gt;</span>
    <span>&lt;/</span><span>Row</span><span>&gt;</span>
  <span>);</span>
<span>};</span>

<span>export</span> <span>default</span> <span>LoginForm</span><span>;</span>
</code></pre></div></div>

<p>When the user submits the form, your application will override that action and direct the user into the Okta workflow. This is done with <code>oktaAuth.signIn()</code> which returns a promise that must be handled appropriately. If the user has successfully logged in, set the <code>sessionToken</code> that allows the user to proceed authenticated.</p>

<p>Now, turn your attention to the game components themselves. The <code>Game</code> page will have 3 main stages. When the user lands on the page, they are offered the chance to start a new game. After this, the user enters the “game play” phase. Finally, after the game is over the user is presented with the opportunity to start a new game or submit a high score.</p>

<p>Let’s start with the <code>Card</code> component that will be used in the game.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>"</span><span>../cards.css</span><span>"</span><span>;</span>

<span>const</span> <span>Card</span> <span>=</span> <span>(</span> <span>{</span> <span>card</span> <span>}</span> <span>)</span> <span>=&gt;</span> <span>{</span>

  <span>let</span> <span>content</span><span>;</span>

  <span>if</span> <span>(</span> <span>card</span><span>.</span><span>visible</span> <span>)</span> <span>{</span>
    <span>const</span> <span>cardClass</span> <span>=</span> <span>"</span><span>card rank-</span><span>"</span> <span>+</span> <span>card</span><span>.</span><span>rank</span><span>.</span><span>toLowerCase</span><span>()</span> <span>+</span> <span>"</span><span> </span><span>"</span> <span>+</span> <span>card</span><span>.</span><span>suit</span><span>;</span>
    <span>content</span> <span>=</span>
            <span>&lt;</span><span>div</span> <span>className=</span><span>{</span><span>cardClass</span><span>}</span><span>&gt;</span>
              <span>&lt;</span><span>div</span> <span>className=</span><span>"rank"</span><span>&gt;</span><span>{</span><span>card</span><span>.</span><span>rank</span><span>}</span><span>&lt;/</span><span>div</span><span>&gt;</span>
              <span>&lt;</span><span>div</span> <span>className=</span><span>"suit"</span><span>&gt;&lt;/</span><span>div</span><span>&gt;</span>
            <span>&lt;/</span> <span>div</span><span>&gt;;</span>
  <span>}</span>
  <span>else</span> <span>{</span>
    <span>content</span> <span>=</span> <span>&lt;</span><span>div</span> <span>className=</span><span>"card back"</span><span>&gt;</span>*<span>&lt;/</span><span>div</span><span>&gt;;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span> <span>className=</span><span>"playingCards faceImages"</span><span>&gt;</span>
      <span>{</span><span>content</span><span>}</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>);</span>
<span>};</span>

<span>export</span> <span>default</span> <span>Card</span><span>;</span>
</code></pre></div></div>

<p>If the card is listed as visible, you will display the card rank and suit based on the CSS provided by the <code>CSS-Playing-Cards</code> library. If it is not, show the back of the card.</p>

<p>With that done you can work on the <code>GameHome</code> component.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Row</span><span>,</span> <span>Col</span><span>,</span> <span>Table</span><span>,</span> <span>Button</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>

<span>const</span> <span>GameHome</span> <span>=</span> <span>(</span> <span>{</span> <span>newGameClick</span><span>,</span> <span>highScores</span><span>,</span> <span>submitHighScore</span> <span>}</span> <span>)</span> <span>=&gt;</span> <span>{</span>

  <span>return</span> <span>(</span>

    <span>&lt;</span><span>div</span><span>&gt;</span>
      <span>&lt;</span><span>Row</span><span>&gt;</span>
        <span>&lt;</span><span>Col</span> <span>lg=</span><span>{</span><span>12</span><span>}</span><span>&gt;</span>
          <span>&lt;</span><span>h4</span><span>&gt;</span>Recent High Scores<span>&lt;/</span><span>h4</span><span>&gt;</span>
        <span>&lt;/</span><span>Col</span><span>&gt;</span>
      <span>&lt;/</span><span>Row</span><span>&gt;</span>

      <span>&lt;</span><span>Row</span><span>&gt;</span>
        <span>&lt;</span><span>Col</span> <span>lg=</span><span>{</span><span>12</span><span>}</span><span>&gt;</span>
          <span>&lt;</span><span>Table</span> <span>striped</span> <span>bordered</span> <span>hover</span><span>&gt;</span>
            <span>&lt;</span><span>thead</span><span>&gt;</span>
              <span>&lt;</span><span>tr</span><span>&gt;</span>
                <span>&lt;</span><span>th</span><span>&gt;</span>Player<span>&lt;/</span><span>th</span><span>&gt;</span>
                <span>&lt;</span><span>th</span><span>&gt;</span>Score<span>&lt;/</span><span>th</span><span>&gt;</span>
              <span>&lt;/</span><span>tr</span><span>&gt;</span>
            <span>&lt;/</span><span>thead</span><span>&gt;</span>
            <span>&lt;</span><span>tbody</span><span>&gt;</span>
              <span>{</span>
                <span>highScores</span><span>.</span><span>map</span><span>(</span> <span>(</span> <span>highScore</span><span>,</span> <span>i</span> <span>)</span> <span>=&gt;</span> <span>{</span>
                  <span>return</span> <span>(</span>
                    <span>&lt;</span><span>tr</span> <span>key=</span><span>{</span><span>i</span><span>}</span><span>&gt;</span>
                      <span>&lt;</span><span>td</span><span>&gt;</span><span>{</span><span>highScore</span><span>.</span><span>player</span><span>}</span><span>&lt;/</span><span>td</span><span>&gt;</span>
                      <span>&lt;</span><span>td</span><span>&gt;</span><span>{</span><span>highScore</span><span>.</span><span>score</span><span>}</span><span>&lt;/</span><span>td</span><span>&gt;</span>
                    <span>&lt;/</span><span>tr</span><span>&gt;</span>
                  <span>);</span>
                <span>}</span> <span>)</span><span>}</span>

            <span>&lt;/</span><span>tbody</span><span>&gt;</span>
          <span>&lt;/</span><span>Table</span><span>&gt;</span>

          <span>&lt;</span><span>Button</span> <span>variant=</span><span>"primary"</span> <span>onClick=</span><span>{</span><span>newGameClick</span><span>}</span><span>&gt;</span> Start a new game<span>&lt;/</span><span>Button</span><span>&gt;</span>
        <span>&lt;/</span><span>Col</span><span>&gt;</span>
      <span>&lt;/</span><span>Row</span><span>&gt;</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>);</span>
<span>};</span>

<span>export</span> <span>default</span> <span>GameHome</span><span>;</span>
</code></pre></div></div>

<p>Here, you are displaying a table with the high scores. These high scores will be passed in as a property from the <code>Game</code> page and retrieved from the Amazon API. You also are providing the user with a button to start a new game.</p>

<p>Next, implement the <code>GameOver</code> component. This is the screen that is shown when the player completes the game.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Row</span><span>,</span> <span>Col</span><span>,</span> <span>Button</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>

<span>const</span> <span>GameOver</span> <span>=</span> <span>(</span> <span>{</span> <span>score</span><span>,</span> <span>playAgain</span><span>,</span> <span>submitHighScore</span> <span>}</span> <span>)</span> <span>=&gt;</span> <span>{</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span><span>&gt;</span>
      <span>&lt;</span><span>Row</span><span>&gt;</span>
        <span>&lt;</span><span>Col</span> <span>lg=</span><span>{</span><span>12</span><span>}</span> <span>className=</span><span>"text-center"</span><span>&gt;</span>
          Game over! Your score was <span>&lt;</span><span>strong</span><span>&gt;</span><span>{</span><span>score</span><span>}</span><span>&lt;/</span><span>strong</span><span>&gt;</span>.
        <span>&lt;/</span><span>Col</span><span>&gt;</span>
      <span>&lt;/</span><span>Row</span><span>&gt;</span>
      <span>&lt;</span><span>Row</span><span>&gt;</span>
        <span>&lt;</span><span>Col</span> <span>lg=</span><span>{</span><span>12</span><span>}</span> <span>className=</span><span>"text-center"</span><span>&gt;</span>
          <span>&lt;</span><span>Button</span> <span>onClick=</span><span>{</span><span>submitHighScore</span><span>}</span> <span>variant=</span><span>"secondary"</span><span>&gt;</span>Submit High Score<span>&lt;/</span><span>Button</span><span>&gt;</span>
          <span>&lt;</span><span>Button</span> <span>onClick=</span><span>{</span><span>playAgain</span><span>}</span> <span>variant=</span><span>"primary"</span><span>&gt;</span>Play Again<span>&lt;/</span><span>Button</span><span>&gt;</span>
        <span>&lt;/</span><span>Col</span><span>&gt;</span>
      <span>&lt;/</span><span>Row</span><span>&gt;</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>);</span>
<span>};</span>

<span>export</span> <span>default</span> <span>GameOver</span><span>;</span>
</code></pre></div></div>

<p>This component displays the user score and presents two buttons: one to submit the player’s score and one to play again. Both of the handlers for these functions are passed in as properties to this component from the <code>Game</code> page.</p>

<p>Finally, the <code>GameBoard</code> itself. This is the most complex component.</p>

<div><div><pre><code><span>import</span> <span>React</span><span>,</span> <span>{</span> <span>Component</span> <span>}</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>Card</span> <span>from</span> <span>"</span><span>./Card</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Row</span><span>,</span> <span>Col</span><span>,</span> <span>Button</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>

<span>class</span> <span>GameBoard</span> <span>extends</span> <span>Component</span> <span>{</span>

  <span>constructor</span><span>(</span> <span>props</span><span>,</span> <span>context</span> <span>)</span> <span>{</span>
    <span>super</span><span>(</span> <span>props</span><span>,</span> <span>context</span> <span>);</span>

    <span>this</span><span>.</span><span>state</span> <span>=</span> <span>{</span>
      <span>cards</span><span>:</span> <span>[],</span>
      <span>activeCard</span><span>:</span> <span>{},</span>
      <span>lastResult</span><span>:</span> <span>""</span><span>,</span>
      <span>gameOver</span><span>:</span> <span>false</span><span>,</span>
      <span>needsNewDeck</span><span>:</span> <span>false</span><span>,</span>
      <span>score</span><span>:</span> <span>0</span>
    <span>};</span>
  <span>}</span>

  <span>componentDidMount</span><span>()</span> <span>{</span>
    <span>this</span><span>.</span><span>getNewDeck</span><span>();</span>
  <span>}</span>

  <span>getNewDeck</span><span>()</span> <span>{</span>
    <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span> <span>loading</span><span>:</span> <span>true</span> <span>}</span> <span>);</span>

    <span>fetch</span><span>(</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>REACT_APP_AMAZON_API_BASE</span> <span>+</span> <span>"</span><span>/deck</span><span>"</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span> <span>res</span> <span>=&gt;</span> <span>res</span><span>.</span><span>json</span><span>()</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span>
        <span>(</span> <span>result</span> <span>)</span> <span>=&gt;</span> <span>{</span>

          <span>const</span> <span>cards</span> <span>=</span> <span>JSON</span><span>.</span><span>parse</span><span>(</span> <span>result</span><span>.</span><span>body</span> <span>);</span>

          <span>this</span><span>.</span><span>setState</span><span>(</span>
            <span>{</span>
              <span>cards</span><span>:</span> <span>cards</span><span>,</span>
              <span>activeCard</span><span>:</span> <span>cards</span><span>[</span><span>0</span><span>],</span>
              <span>needsNewDeck</span><span>:</span> <span>false</span><span>,</span>
              <span>loading</span><span>:</span> <span>false</span>
            <span>}</span>
          <span>);</span>
        <span>}</span>
      <span>);</span>

  <span>}</span>

  <span>guess</span><span>(</span> <span>higherOrLower</span> <span>)</span> <span>{</span>

    <span>let</span> <span>correct</span><span>;</span>
    <span>let</span> <span>push</span><span>;</span>
    <span>let</span> <span>activeCard</span> <span>=</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>activeCard</span><span>;</span>

    <span>let</span> <span>nextCardIdx</span> <span>=</span> <span>activeCard</span><span>.</span><span>order</span> <span>+</span> <span>1</span><span>;</span>
    <span>let</span> <span>nextCard</span> <span>=</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>cards</span><span>[</span><span>nextCardIdx</span><span>];</span>

    <span>if</span> <span>(</span> <span>nextCard</span><span>.</span><span>value</span> <span>&gt;</span> <span>activeCard</span><span>.</span><span>value</span> <span>&amp;&amp;</span> <span>higherOrLower</span> <span>===</span> <span>"</span><span>higher</span><span>"</span> <span>)</span> <span>{</span>
      <span>correct</span> <span>=</span> <span>true</span><span>;</span>
    <span>}</span>
    <span>else</span> <span>if</span> <span>(</span> <span>nextCard</span><span>.</span><span>value</span> <span>&lt;</span> <span>activeCard</span><span>.</span><span>value</span> <span>&amp;&amp;</span> <span>higherOrLower</span> <span>===</span> <span>"</span><span>lower</span><span>"</span> <span>)</span> <span>{</span>
      <span>correct</span> <span>=</span> <span>true</span><span>;</span>
    <span>}</span>
    <span>else</span> <span>if</span> <span>(</span> <span>nextCard</span><span>.</span><span>value</span> <span>===</span> <span>activeCard</span><span>.</span><span>value</span> <span>)</span> <span>{</span>
      <span>push</span> <span>=</span> <span>true</span><span>;</span>
    <span>}</span>

    <span>if</span> <span>(</span> <span>correct</span> <span>)</span> <span>{</span>
      <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span>
        <span>score</span><span>:</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>score</span> <span>+</span> <span>1</span><span>,</span>
        <span>lastResult</span><span>:</span> <span>"</span><span>Correct! </span><span>"</span><span>,</span>
        <span>needsNewDeck</span><span>:</span> <span>nextCardIdx</span> <span>===</span> <span>5</span>
      <span>}</span> <span>);</span>
    <span>}</span>
    <span>else</span> <span>if</span> <span>(</span> <span>push</span> <span>)</span> <span>{</span>
      <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span>
        <span>lastResult</span><span>:</span> <span>"</span><span>A push!  Keep playing. </span><span>"</span><span>,</span>
        <span>needsNewDeck</span><span>:</span> <span>nextCardIdx</span> <span>===</span> <span>5</span>
      <span>}</span> <span>);</span>
    <span>}</span>
    <span>else</span> <span>{</span>
      <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span>
        <span>lastResult</span><span>:</span> <span>"</span><span>Aww, that was incorrect</span><span>"</span><span>,</span>
        <span>gameOver</span><span>:</span> <span>true</span>
      <span>}</span> <span>);</span>
    <span>}</span>

    <span>nextCard</span><span>.</span><span>visible</span> <span>=</span> <span>true</span><span>;</span>
    <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span>
      <span>activeCard</span><span>:</span> <span>nextCard</span>
    <span>}</span> <span>);</span>
  <span>}</span>

  <span>render</span><span>()</span> <span>{</span>

    <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>loading</span> <span>)</span> <span>{</span>
      <span>return</span> <span>&lt;</span><span>h4</span><span>&gt;</span>Loading, please wait.<span>&lt;/</span><span>h4</span><span>&gt;;</span>
    <span>}</span>

    <span>let</span> <span>leaveButton</span><span>;</span>
    <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>gameOver</span> <span>||</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>needsNewDeck</span> <span>)</span> <span>{</span>
      <span>leaveButton</span> <span>=</span> <span>&lt;</span><span>Button</span> <span>style=</span><span>{</span><span>{</span> <span>width</span><span>:</span> <span>"</span><span>100%</span><span>"</span> <span>}</span><span>}</span> <span>variant=</span><span>{</span><span>"</span><span>danger</span><span>"</span><span>}</span> <span>onClick=</span><span>{</span><span>()</span> <span>=&gt;</span> <span>this</span><span>.</span><span>props</span><span>.</span><span>endGame</span><span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>score</span> <span>)</span><span>}</span><span>&gt;</span>End Game<span>&lt;/</span><span>Button</span><span>&gt;;</span>
    <span>}</span>

    <span>let</span> <span>newDeckButton</span><span>;</span>
    <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>needsNewDeck</span> <span>)</span> <span>{</span>
      <span>newDeckButton</span> <span>=</span> <span>&lt;</span><span>Button</span> <span>style=</span><span>{</span><span>{</span> <span>width</span><span>:</span> <span>"</span><span>100%</span><span>"</span> <span>}</span><span>}</span> <span>variant=</span><span>{</span><span>"</span><span>primary</span><span>"</span><span>}</span> <span>onClick=</span><span>{</span><span>()</span> <span>=&gt;</span> <span>this</span><span>.</span><span>getNewDeck</span><span>()</span><span>}</span><span>&gt;</span>New Deck<span>&lt;/</span><span>Button</span><span>&gt;;</span>
    <span>}</span>

    <span>let</span> <span>disableButtons</span> <span>=</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>gameOver</span> <span>||</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>needsNewDeck</span><span>;</span>

    <span>return</span> <span>(</span>

      <span>&lt;</span><span>div</span><span>&gt;</span>

        <span>&lt;</span><span>h4</span><span>&gt;</span>Lets Play Card Sharks<span>&lt;/</span><span>h4</span><span>&gt;</span>

        <span>&lt;</span><span>Row</span><span>&gt;</span>
          <span>{</span><span>this</span><span>.</span><span>state</span><span>.</span><span>cards</span><span>.</span><span>map</span><span>(</span> <span>(</span> <span>card</span><span>,</span> <span>i</span> <span>)</span> <span>=&gt;</span> <span>{</span>
            <span>return</span> <span>(</span> <span>&lt;</span><span>Col</span> <span>key=</span><span>{</span><span>i</span><span>}</span> <span>sm=</span><span>{</span><span>2</span><span>}</span><span>&gt;</span>
              <span>&lt;</span><span>Card</span> <span>card=</span><span>{</span><span>card</span><span>}</span> <span>/&gt;</span>
            <span>&lt;/</span><span>Col</span><span>&gt;</span>
            <span>);</span>
          <span>}</span> <span>)</span><span>}</span>
        <span>&lt;/</span><span>Row</span><span>&gt;</span>

        <span>&lt;</span><span>Row</span> <span>className=</span><span>"mt-3"</span><span>&gt;</span>
          <span>&lt;</span><span>Col</span> <span>sm=</span><span>{</span><span>2</span><span>}</span><span>&gt;</span>
            <span>&lt;</span><span>strong</span><span>&gt;</span>Current Card<span>&lt;/</span><span>strong</span><span>&gt;</span>
            <span>&lt;</span><span>Card</span> <span>card=</span><span>{</span><span>this</span><span>.</span><span>state</span><span>.</span><span>activeCard</span><span>}</span> <span>/&gt;</span>
          <span>&lt;/</span><span>Col</span><span>&gt;</span>

          <span>&lt;</span><span>Col</span> <span>sm=</span><span>{</span><span>4</span><span>}</span><span>&gt;</span>

            <span>&lt;</span><span>strong</span><span>&gt;</span>Higher or Lower?<span>&lt;/</span><span>strong</span><span>&gt;</span>
            <span>&lt;</span><span>br</span><span>&gt;&lt;/</span><span>br</span><span>&gt;</span>

            <span>&lt;</span><span>Button</span> <span>style=</span><span>{</span><span>{</span> <span>width</span><span>:</span> <span>"</span><span>50%</span><span>"</span> <span>}</span><span>}</span> <span>variant=</span><span>"primary"</span> <span>disabled=</span><span>{</span><span>disableButtons</span><span>}</span> <span>onClick=</span><span>{</span><span>()</span> <span>=&gt;</span> <span>this</span><span>.</span><span>guess</span><span>(</span> <span>"</span><span>higher</span><span>"</span> <span>)</span><span>}</span><span>&gt;</span>Higher<span>&lt;/</span><span>Button</span><span>&gt;</span> <span>&lt;</span><span>br</span><span>&gt;&lt;/</span><span>br</span><span>&gt;</span>
            <span>&lt;</span><span>Button</span> <span>style=</span><span>{</span><span>{</span> <span>width</span><span>:</span> <span>"</span><span>50%</span><span>"</span> <span>}</span><span>}</span> <span>variant=</span><span>"warning"</span> <span>disabled=</span><span>{</span><span>disableButtons</span><span>}</span> <span>onClick=</span><span>{</span><span>()</span> <span>=&gt;</span> <span>this</span><span>.</span><span>guess</span><span>(</span> <span>"</span><span>lower</span><span>"</span> <span>)</span><span>}</span><span>&gt;</span>Lower<span>&lt;/</span><span>Button</span><span>&gt;</span>

          <span>&lt;/</span><span>Col</span><span>&gt;</span>
          <span>&lt;</span><span>Col</span> <span>sm=</span><span>{</span><span>2</span><span>}</span><span>&gt;</span>
            Current Score: <span>{</span><span>this</span><span>.</span><span>state</span><span>.</span><span>score</span><span>}</span>
          <span>&lt;/</span><span>Col</span><span>&gt;</span>
          <span>&lt;</span><span>Col</span> <span>sm=</span><span>{</span><span>2</span><span>}</span><span>&gt;</span>
            Last Card: <span>{</span><span>this</span><span>.</span><span>state</span><span>.</span><span>lastResult</span><span>}</span>
            <span>{</span><span>leaveButton</span><span>}</span> <span>&lt;</span><span>br</span><span>&gt;&lt;/</span><span>br</span><span>&gt;</span>
            <span>{</span><span>newDeckButton</span><span>}</span>
          <span>&lt;/</span><span>Col</span><span>&gt;</span>
        <span>&lt;/</span><span>Row</span><span>&gt;</span>
      <span>&lt;/</span><span>div</span> <span>&gt;</span>
    <span>);</span>
  <span>}</span>

<span>}</span>

<span>export</span> <span>default</span> <span>GameBoard</span><span>;</span>
</code></pre></div></div>

<p>This component is presented while the player is playing. It shows their board, which displays 6 cards—either face up or face down depending on how far through the game the player is. Additionally, there is a display that shows the player their current card and provides controls for guessing higher or lower.</p>

<p>If the user guesses incorrectly, they are presented with the option to leave this screen, bringing them to the <code>GameOver</code> component. If the user successfully completes all 5 cards, they are presented with the option to continue playing or to end the game. In both options, the guess buttons should be disabled.</p>

<p>This is also the first time you’ll be using the Amazon APIs directly in your application. Use the <code>fetch</code> method to call <code>deck\get</code>. Once the results are returned, you can change the state from <code>loading: true</code> to <code>loading: false</code>.</p>

<h3 id="implement-the-reactjs-pages"><a href="#implement-the-reactjs-pages">Implement the React.js Pages</a></h3>

<p>Let’s focus on the <code>Pages</code> folder now;  we’re going to connect everything together.</p>

<p>First, implement <code>Home.jsx</code>.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Link</span> <span>}</span> <span>from</span> <span>"</span><span>react-router-dom</span><span>"</span><span>;</span>

<span>import</span> <span>Header</span> <span>from</span> <span>"</span><span>../Components/Header</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Container</span><span>,</span> <span>Row</span><span>,</span> <span>Col</span><span>,</span> <span>Card</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>

<span>const</span> <span>Home</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>Container</span><span>&gt;</span>

      <span>&lt;</span><span>Header</span><span>&gt;&lt;/</span><span>Header</span><span>&gt;</span>

      <span>&lt;</span><span>Row</span><span>&gt;</span>
        <span>&lt;</span><span>Col</span> <span>sm=</span><span>{</span><span>12</span><span>}</span> <span>className=</span><span>"text-center"</span><span>&gt;</span>
          <span>&lt;</span><span>h3</span><span>&gt;</span>Card Sharks!<span>&lt;/</span><span>h3</span><span>&gt;</span>
          <span>&lt;</span><span>h4</span><span>&gt;</span>A React Demo using Okta<span>&lt;/</span><span>h4</span><span>&gt;</span>
        <span>&lt;/</span><span>Col</span><span>&gt;</span>
      <span>&lt;/</span><span>Row</span><span>&gt;</span>

      <span>&lt;</span><span>br</span><span>&gt;&lt;/</span><span>br</span><span>&gt;</span>

      <span>&lt;</span><span>Row</span> <span>&gt;</span>
        <span>&lt;</span><span>Col</span> <span>sm=</span><span>{</span><span>12</span><span>}</span> <span>className=</span><span>"text-center"</span><span>&gt;</span>
          <span>&lt;</span><span>Card</span> <span>style=</span><span>{</span><span>{</span> <span>width</span><span>:</span> <span>"</span><span>21.5em</span><span>"</span><span>,</span> <span>margin</span><span>:</span> <span>"</span><span>0 auto</span><span>"</span> <span>}</span><span>}</span><span>&gt;</span>
            <span>&lt;</span><span>Card</span><span>.</span><span>Header</span><span>&gt;</span>
              Already have an Okta Account?
            <span>&lt;/</span><span>Card</span><span>.</span><span>Header</span><span>&gt;</span>
            <span>&lt;</span><span>Card</span><span>.</span><span>Body</span><span>&gt;</span>
              <span>&lt;</span><span>Link</span> <span>to=</span><span>'/Game'</span><span>&gt;</span>Play Now<span>&lt;/</span><span>Link</span><span>&gt;</span>
            <span>&lt;/</span><span>Card</span><span>.</span><span>Body</span><span>&gt;</span>
          <span>&lt;/</span><span>Card</span><span>&gt;</span>
        <span>&lt;/</span><span>Col</span><span>&gt;</span>
      <span>&lt;/</span><span>Row</span><span>&gt;</span>

    <span>&lt;/</span><span>Container</span><span>&gt;</span>
  <span>);</span>
<span>};</span>
<span>export</span> <span>default</span> <span>Home</span><span>;</span>
</code></pre></div></div>

<p>This is a simple introduction page. It uses the <code>Header</code> component you wrote earlier and just tells the user a little about the application.</p>

<p>Next, you can implement the <code>Login</code> page.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Redirect</span> <span>}</span> <span>from</span> <span>"</span><span>react-router-dom</span><span>"</span><span>;</span>
<span>import</span> <span>LoginForm</span> <span>from</span> <span>"</span><span>../Components/LoginForm</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>useOktaAuth</span> <span>}</span> <span>from</span> <span>"</span><span>@okta/okta-react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>Container</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>
<span>import</span> <span>Header</span> <span>from</span> <span>"</span><span>../Components/Header</span><span>"</span><span>;</span>

<span>const</span> <span>Login</span> <span>=</span> <span>(</span> <span>{</span> <span>baseUrl</span><span>,</span> <span>issuer</span> <span>}</span> <span>)</span> <span>=&gt;</span> <span>{</span>
  <span>const</span> <span>{</span> <span>authState</span> <span>}</span> <span>=</span> <span>useOktaAuth</span><span>();</span>

  <span>if</span> <span>(</span> <span>authState</span><span>.</span><span>isPending</span> <span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>div</span><span>&gt;</span>Loading...<span>&lt;/</span><span>div</span><span>&gt;;</span>
  <span>}</span>
  <span>return</span> <span>authState</span><span>.</span><span>isAuthenticated</span> <span>?</span>
    <span>&lt;</span><span>Redirect</span> <span>to=</span><span>{</span><span>{</span> <span>pathname</span><span>:</span> <span>"</span><span>/</span><span>"</span> <span>}</span><span>}</span> <span>/&gt;</span> <span>:</span>

    <span>&lt;</span><span>Container</span><span>&gt;</span>
      <span>&lt;</span><span>Header</span><span>&gt;&lt;/</span><span>Header</span><span>&gt;</span>
      <span>&lt;</span><span>br</span><span>&gt;&lt;/</span><span>br</span><span>&gt;</span>
      <span>&lt;</span><span>h4</span><span>&gt;</span>Please Login with your Okta Account<span>&lt;/</span><span>h4</span><span>&gt;</span>
      <span>&lt;</span><span>LoginForm</span> <span>baseUrl=</span><span>{</span><span>baseUrl</span><span>}</span> <span>issuer=</span><span>{</span><span>issuer</span><span>}</span> <span>/&gt;</span>
    <span>&lt;/</span><span>Container</span><span>&gt;;</span>
<span>};</span>

<span>export</span> <span>default</span> <span>Login</span><span>;</span>
</code></pre></div></div>

<p>Again, this is a straight-forward page that presents the <code>LoginForm</code> to the user and checks the <code>authState</code>. If the user is already logged in you will redirect them to the home page. If they are not, you will allow the user to use the <code>LoginForm</code>.</p>

<p>Lastly, the <code>Game</code> page.</p>

<div><div><pre><code><span>import</span> <span>React</span><span>,</span> <span>{</span> <span>Component</span> <span>}</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>

<span>import</span> <span>GameHome</span> <span>from</span> <span>"</span><span>../Components/GameHome</span><span>"</span><span>;</span>
<span>import</span> <span>GameBoard</span> <span>from</span> <span>"</span><span>../Components/GameBoard</span><span>"</span><span>;</span>
<span>import</span> <span>GameOver</span> <span>from</span> <span>"</span><span>../Components/GameOver</span><span>"</span><span>;</span>

<span>import</span> <span>Header</span> <span>from</span> <span>"</span><span>../Components/Header</span><span>"</span><span>;</span>

<span>import</span> <span>{</span> <span>Container</span> <span>}</span> <span>from</span> <span>"</span><span>react-bootstrap</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>withOktaAuth</span> <span>}</span> <span>from</span> <span>"</span><span>@okta/okta-react</span><span>"</span><span>;</span>

<span>class</span> <span>Game</span> <span>extends</span> <span>Component</span> <span>{</span>

  <span>constructor</span><span>(</span> <span>props</span><span>,</span> <span>context</span> <span>)</span> <span>{</span>
    <span>super</span><span>(</span> <span>props</span><span>,</span> <span>context</span> <span>);</span>

    <span>this</span><span>.</span><span>state</span> <span>=</span> <span>{</span>
      <span>gameState</span><span>:</span> <span>"</span><span>none</span><span>"</span><span>,</span>
      <span>lastScore</span><span>:</span> <span>0</span><span>,</span>
      <span>loading</span><span>:</span> <span>false</span><span>,</span>
      <span>highScores</span><span>:</span> <span>[],</span>
      <span>player</span><span>:</span> <span>""</span>
    <span>};</span>

    <span>this</span><span>.</span><span>submitHighScore</span> <span>=</span> <span>this</span><span>.</span><span>submitHighScore</span><span>.</span><span>bind</span><span>(</span> <span>this</span> <span>);</span>
  <span>}</span>

  <span>componentDidMount</span><span>()</span> <span>{</span>
    <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span> <span>loading</span><span>:</span> <span>true</span> <span>}</span> <span>);</span>
    <span>fetch</span><span>(</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>REACT_APP_AMAZON_API_BASE</span> <span>+</span> <span>"</span><span>/highscore</span><span>"</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span> <span>res</span> <span>=&gt;</span> <span>res</span><span>.</span><span>json</span><span>()</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span>
        <span>(</span> <span>result</span> <span>)</span> <span>=&gt;</span> <span>{</span>
          <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span> <span>highScores</span><span>:</span> <span>JSON</span><span>.</span><span>parse</span><span>(</span> <span>result</span><span>.</span><span>body</span> <span>)</span> <span>}</span> <span>);</span>
        <span>}</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span> <span>()</span> <span>=&gt;</span> <span>this</span><span>.</span><span>props</span><span>.</span><span>authService</span><span>.</span><span>getUser</span><span>()</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span> <span>user</span> <span>=&gt;</span> <span>{</span>
        <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span> <span>loading</span><span>:</span> <span>false</span><span>,</span> <span>player</span><span>:</span> <span>user</span><span>.</span><span>email</span> <span>}</span> <span>);</span>
      <span>}</span> <span>);</span>
  <span>}</span>

  <span>submitHighScore</span><span>()</span> <span>{</span>

    <span>fetch</span><span>(</span> <span>process</span><span>.</span><span>env</span><span>.</span><span>REACT_APP_AMAZON_API_BASE</span> <span>+</span> <span>"</span><span>/highscore</span><span>"</span><span>,</span>
      <span>{</span>
        <span>headers</span><span>:</span> <span>{</span>
          <span>"</span><span>Accept</span><span>"</span><span>:</span> <span>"</span><span>application/json</span><span>"</span><span>,</span>
          <span>"</span><span>Content-Type</span><span>"</span><span>:</span> <span>"</span><span>application/json</span><span>"</span>
        <span>},</span>
        <span>method</span><span>:</span> <span>"</span><span>POST</span><span>"</span><span>,</span>
        <span>body</span><span>:</span> <span>JSON</span><span>.</span><span>stringify</span><span>(</span> <span>{</span> <span>player</span><span>:</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>player</span><span>,</span> <span>score</span><span>:</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>lastScore</span> <span>}</span> <span>)</span>
      <span>}</span> <span>)</span>
      <span>.</span><span>then</span><span>(</span> <span>function</span> <span>(</span> <span>res</span> <span>)</span> <span>{</span>
        <span>//display message however you wish</span>
      <span>}</span> <span>);</span>
  <span>}</span>

  <span>newGameClick</span><span>()</span> <span>{</span>
    <span>this</span><span>.</span><span>gameBoardLoaded</span><span>();</span>
  <span>}</span>

  <span>gameBoardLoaded</span><span>()</span> <span>{</span>
    <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span> <span>gameState</span><span>:</span> <span>"</span><span>playing</span><span>"</span> <span>}</span> <span>);</span>
  <span>}</span>

  <span>endGame</span><span>(</span> <span>score</span> <span>)</span> <span>{</span>
    <span>this</span><span>.</span><span>setState</span><span>(</span> <span>{</span> <span>gameState</span><span>:</span> <span>"</span><span>finished</span><span>"</span><span>,</span> <span>lastScore</span><span>:</span> <span>score</span> <span>}</span> <span>);</span>
  <span>}</span>

  <span>render</span><span>()</span> <span>{</span>

    <span>let</span> <span>content</span><span>;</span>

    <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>loading</span> <span>)</span> <span>{</span>
      <span>content</span> <span>=</span> <span>&lt;</span><span>h3</span><span>&gt;</span>Loading, please wait<span>&lt;/</span><span>h3</span><span>&gt;;</span>
    <span>}</span>
    <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>gameState</span> <span>===</span> <span>"</span><span>none</span><span>"</span> <span>)</span> <span>{</span>
      <span>content</span> <span>=</span> <span>&lt;</span><span>GameHome</span> <span>newGameClick=</span><span>{</span><span>this</span><span>.</span><span>newGameClick</span><span>}</span> <span>highScores=</span><span>{</span><span>this</span><span>.</span><span>state</span><span>.</span><span>highScores</span><span>}</span> <span>&gt;</span>  <span>&lt;/</span><span>GameHome</span><span>&gt;;</span>
    <span>}</span>
    <span>else</span> <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>gameState</span> <span>===</span> <span>"</span><span>loading</span><span>"</span> <span>)</span> <span>{</span>
      <span>content</span> <span>=</span> <span>&lt;</span><span>div</span><span>&gt;</span>Please wait while we load your deck...<span>&lt;/</span><span>div</span><span>&gt;;</span>
    <span>}</span>
    <span>else</span> <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>gameState</span> <span>===</span> <span>"</span><span>playing</span><span>"</span> <span>)</span> <span>{</span>
      <span>content</span> <span>=</span> <span>&lt;</span><span>GameBoard</span> <span>loaded=</span><span>{</span><span>this</span><span>.</span><span>gameBoardLoaded</span><span>}</span> <span>endGame=</span><span>{</span><span>this</span><span>.</span><span>endGame</span><span>}</span><span>&gt;&lt;/</span><span>GameBoard</span><span>&gt;;</span>
    <span>}</span>
    <span>else</span> <span>if</span> <span>(</span> <span>this</span><span>.</span><span>state</span><span>.</span><span>gameState</span> <span>===</span> <span>"</span><span>finished</span><span>"</span> <span>)</span> <span>{</span>
      <span>content</span> <span>=</span> <span>&lt;</span><span>GameOver</span> <span>score=</span><span>{</span><span>this</span><span>.</span><span>state</span><span>.</span><span>lastScore</span><span>}</span> <span>playAgain=</span><span>{</span><span>this</span><span>.</span><span>newGameClick</span><span>}</span> <span>submitHighScore=</span><span>{</span><span>this</span><span>.</span><span>submitHighScore</span><span>}</span><span>&gt;&lt;/</span><span>GameOver</span><span>&gt;;</span>
    <span>}</span>

    <span>return</span> <span>(</span>
      <span>&lt;</span><span>div</span><span>&gt;</span>
        <span>&lt;</span><span>Container</span><span>&gt;</span>
          <span>&lt;</span><span>Header</span><span>&gt;&lt;/</span><span>Header</span><span>&gt;</span>
          <span>&lt;</span><span>br</span><span>&gt;&lt;/</span><span>br</span><span>&gt;</span>
          <span>{</span><span>content</span><span>}</span>
        <span>&lt;/</span><span>Container</span><span>&gt;</span>
      <span>&lt;/</span><span>div</span><span>&gt;</span>
    <span>);</span>
  <span>}</span>
<span>}</span>
<span>export</span> <span>default</span> <span>withOktaAuth</span><span>(</span> <span>Game</span> <span>);</span>
</code></pre></div></div>

<p>This page takes your game components from earlier and manages the state of the player. It will also display the proper components based on the game state and contains functions that receive or post high scores to your Amazon API. These functions can be called by any of your components.</p>

<p>Finally, you need to update your <code>App.js</code> file in the <code>src</code> folder to properly start the application and display the <code>AppWithRouterAccess</code> component.</p>

<div><div><pre><code><span>import</span> <span>React</span> <span>from</span> <span>"</span><span>react</span><span>"</span><span>;</span>
<span>import</span> <span>{</span> <span>BrowserRouter</span> <span>as</span> <span>Router</span> <span>}</span> <span>from</span> <span>"</span><span>react-router-dom</span><span>"</span><span>;</span>
<span>import</span> <span>AppWithRouterAccess</span> <span>from</span> <span>"</span><span>./AppWithRouterAccess</span><span>"</span><span>;</span>
<span>import</span> <span>"</span><span>bootstrap/dist/css/bootstrap.min.css</span><span>"</span><span>;</span>

<span>const</span> <span>App</span> <span>=</span> <span>()</span> <span>=&gt;</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>Router</span><span>&gt;</span>
      <span>&lt;</span><span>AppWithRouterAccess</span><span>/&gt;</span>
    <span>&lt;/</span><span>Router</span><span>&gt;</span>
  <span>);</span>
<span>};</span>

<span>export</span> <span>default</span> <span>App</span><span>;</span>
</code></pre></div></div>

<h2 id="test-your-nodejs-react-application"><a href="#test-your-nodejs-react-application">Test Your Node.js React Application</a></h2>

<p>With all your pages set up, type <code>npm run start</code> in your terminal. You’ll be presented with your home page and the opportunity to start a new game or log in to Okta. Click on <strong>New Game</strong> and you will be asked to log in using your Okta account. Log in and give the game a shot!</p>

<p>If you need to compare any code to the original, you can grab the source code for this example on <a href="https://github.com/oktadeveloper/okta-aws-lambda-node-react-example">GitHub</a>.</p>

<h2 id="more-aws-lambda-nodejs-and-reactjs-resources"><a href="#more-aws-lambda-nodejs-and-reactjs-resources">More AWS Lambda, Node.js, and React.js Resources</a></h2>

<p>If you are interested in learning more about React.js, Node.js, or Serverless, check out some of these other great posts!</p>

<ul>
  <li><a href="https://developer.okta.com/code/react/">Okta’s React Guide</a></li>
  <li><a href="https://developer.okta.com/blog/2018/07/10/build-a-basic-crud-app-with-node-and-react">Build a Basic CRUD App with Node and React</a></li>
  <li><a href="https://developer.okta.com/blog/2020/01/20/build-reusable-react-components">Build Reusable React Components</a></li>
  <li><a href="https://developer.okta.com/blog/2019/05/20/azure-aws-lambda-functions-serverless-csharp">AWS Lambda vs Azure Functions for C# Serverless</a></li>
</ul>

<p>Want to be notified when we publish more of these? Follow <a href="https://twitter.com/oktadev">@oktadev on Twitter</a>, subscribe to our <a href="https://youtube.com/c/oktadev">YouTube channel</a>, or follow us on <a href="https://www.linkedin.com/company/oktadev/">LinkedIn</a>. If you have a question, please leave a comment below!</p>


    </div>

    
    
    
</article>

</section>



		
	</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>