<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Intel, ARM, IBM, AMD Processors Vulnerable to New Side-Channel Attacks - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Intel, ARM, IBM, AMD Processors Vulnerable to New Side-Channel Attacks - linksfor.dev(s)"/>
    <meta property="article:author" content="- Steve Jobs"/>
    <meta property="og:description" content="It turns out that the root cause behind several previously disclosed speculative execution attacks against modern processors, such as Meltdown and Foreshadow, was misattributed to &#x2018;prefetchin&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://modernnetsec.io/intel-arm-ibm-amd-processors-vulnerable-to-new-side-channel-attacks/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Intel, ARM, IBM, AMD Processors Vulnerable to New Side-Channel Attacks</title>
<div class="readable">
        <h1>Intel, ARM, IBM, AMD Processors Vulnerable to New Side-Channel Attacks</h1>
            <div>by - Steve Jobs</div>
            <div>Reading time: 7-8 minutes</div>
        <div>Posted here: 08 Aug 2020</div>
        <p><a href="https://modernnetsec.io/intel-arm-ibm-amd-processors-vulnerable-to-new-side-channel-attacks/">https://modernnetsec.io/intel-arm-ibm-amd-processors-vulnerable-to-new-side-channel-attacks/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div><p><img src="https://1.bp.blogspot.com/-03ZPPE6yyG4/XyzXPc0fsAI/AAAAAAAA3KE/nWQDia-iXisQnZFp1m_lnGkUyigjR3EKQCLcBGAsYHQ/s72-c-e100/cpu.jpg"></p>
<p><a href="https://modernnetsec.io/wp-content/uploads/2020/08/intel-arm-ibm-amd-processors-vulnerable-to-new-side-channel-attacks-1.jpg"><img alt="Side-Channel Attacks" data-original-height="380" data-original-width="728" src="https://modernnetsec.io/wp-content/uploads/2020/08/intel-arm-ibm-amd-processors-vulnerable-to-new-side-channel-attacks-1.jpg" title="Side-Channel Attacks"></a></p>
<p>It turns out that the root cause behind several previously disclosed speculative execution attacks against modern processors, such as <a href="https://thehackernews.com/2018/01/meltdown-spectre-vulnerability.html" target="_blank" rel="noopener noreferrer">Meltdown</a> and <a href="https://thehackernews.com/2018/08/foreshadow-intel-processor-vulnerability.html" target="_blank" rel="noopener noreferrer">Foreshadow</a>, was misattributed to ‘prefetching effect,’ resulting in hardware vendors releasing incomplete mitigations and countermeasures.</p>
<p>Sharing its findings with The Hacker News, a group of academics from the Graz University of Technology and CISPA Helmholtz Center for Information Security finally revealed the exact reason behind why the kernel addresses are cached in the first place, as well as presented several new attacks that exploit the previously unidentified underlying issue, allowing attackers to sniff out sensitive data.</p>
<p>The <a href="https://arxiv.org/pdf/2008.02307.pdf" target="_blank" rel="noopener noreferrer">new research explains</a> microarchitectural attacks were actually caused by speculative dereferencing of user-space registers in the kernel, which not just impacts the most recent Intel CPUs with the latest hardware mitigations, but also several modern processors from ARM, IBM, and AMD — previously believed to be unaffected.</p>
<p><a href="https://go.thn.li/contrast" rel="nofollow noopener sponsored noreferrer" target="_blank" title="cybersecurity"><img alt="cybersecurity" src="https://modernnetsec.io/wp-content/uploads/2020/08/intel-arm-ibm-amd-processors-vulnerable-to-new-side-channel-attacks-2.jpg"></a>
</p>
<p>“We discovered that effects reported in several academic papers over the past 4 years were not correctly understood, leading to incorrect assumptions on countermeasures,” the researchers told The Hacker News.</p>
<p>“This <a href="https://gruss.cc/files/prefetch.pdf" target="_blank" rel="noopener noreferrer">prefetching effect</a> is actually unrelated to software prefetch instructions or hardware prefetching effects due to memory accesses and instead is caused by speculative dereferencing of user-space registers in the kernel.”</p>
<p>Besides analyzing the actual root cause of the prefetching effect, some other key findings from the research are:</p>
<ul>
<li>Discovery of several new attacks exploiting the underlying root cause, including an address-translation attack in more restricted contexts, direct leakage of register values in specific scenarios, and an end-to-end Foreshadow exploit targeting non-L1 data.</li>
<li>A novel cross-core covert channel attack that, in some instances, could let attackers observe caching of the address (or value) stored in a register without relying on shared memory.</li>
<li>Spectre ‘prefetch’ gadgets can directly leak actual data, which not only makes <a href="https://thehackernews.com/2019/11/zombieload-cpu-vulnerability.html" target="_blank" rel="noopener noreferrer">ZombieLoad attack</a> efficient on Intel CPUs to leak sensitive data from internal buffers or memory but also impact non-Intel CPUs.</li>
<li>The speculative dereferencing issue — in certain attacks like <a href="https://thehackernews.com/2020/03/rowhammer-vulnerability-ddr4-dram.html" target="_blank" rel="noopener noreferrer">Rowhammer</a>, cache attacks, and DRAMA — could let attackers recover the physical addresses of JavaScript variables and exfiltrate information via <a href="https://gruss.cc/files/rowhammerjs.pdf" target="_blank" rel="noopener noreferrer">transient execution</a> remotely via a web browser.</li>
</ul>
<p>Additionally, researchers also demonstrated that the Foreshadow vulnerability on Intel CPUs could be exploited even when the recommended mitigations are enabled. This is made possible due to the fact the attack can be mounted on data not residing in L1 cache on kernel versions containing ‘prefetch’ gadgets.</p>
<h2>From Address Translation Attack to Foreshadow</h2>
<p>The idea behind this is straight-forward. System software relies on the CPU’s address translation mechanism to implement isolation among different processes. Each process has its own virtual memory space and cannot access arbitrary physical memory addresses outside of it.</p>
<p>[embedded content]</p>
<p>Address translation, thus, acts as an intermediate layer that maps the virtual address space, which is used by a program, to the physical address to a physical address.</p>
<p>The virtual address space also includes a kernel address space to house Linux kernel threads, thus making it easy for the underlying hardware to handle privileged instructions from user threads in kernel mode.</p>
<p>While operating system kernels can be secured against prefetch side-channel attacks via a technique called kernel page-table isolation (<a href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation" target="_blank" rel="noopener noreferrer">KPTI</a> or <a href="https://gruss.cc/files/kaiser.pdf" target="_blank" rel="noopener noreferrer">KAISER</a>) — which enforces a strict kernel and userspace isolation such that the hardware does not hold any information about kernel addresses while running in user mode — the researchers found that it does not guarantee full protection from address-translation attacks, where an attacker tries to check if two different virtual addresses map to the same physical address.</p>
<p>Put differently, the “address-translation attack allows unprivileged applications to fetch arbitrary kernel addresses into the cache and thus resolve virtual to physical addresses on 64-bit Linux systems.”</p>
<p>While the original line of thought was that such attacks were related to prefetch instructions, the new finding proves otherwise, thereby validating that KAISER isn’t an adequate countermeasure against microarchitectural side-channel attacks on kernel isolation.</p>
<p>Instead, it exploits a Spectre-BTB-SA-IP (Branch Target Buffer, same address, in-place) gadget to cause information leakage, causing speculative execution, and further carry out Meltdown and Foreshadow (L1 Terminal Fault) attacks by bypassing current L1TF mitigations.</p>
<p><a href="https://thehackernews.com/2018/11/meltdown-spectre-vulnerabilities.html" target="_blank" rel="noopener noreferrer">Spectre-BTB-SA-IP</a> is a variant of <a href="https://arxiv.org/pdf/1811.05441.pdf" target="_blank" rel="noopener noreferrer">Spectre vulnerability</a> that exploits the Branch Target Buffer — a cache-like component in CPUs that’s used for branch prediction — to perform attacks within the same address space and the same branch location.</p>
<p>“The same prefetching effect can be used to perform Foreshadow,” the researchers said. “If a secret is present in the L3 cache and the direct-physical map address is derefenced in the hypervisor kernel, data can be fetched into the L1. This reenables Foreshadow even with Foreshadow mitigations enabled if the unrelated Spectre-BTB mitigations are disabled.”</p>
<p>“The consequence is that we are able to mount a Foreshadow attack on older kernels patched against Foreshadow with all mitigations enabled and on a fully patched kernel if only Spectre-v2 mitigations are disabled.”</p>
<h2>Enable Spectre-BTB mitigations such as Retpoline</h2>
<p>To highlight the impact of the side-channel attacks, the researchers established a cache-based covert channel that exfiltrated data from a process running on an Intel Core i7-6500U CPU to another stealthy process, achieving a transmission rate of 10 bit/s to relay a total of 128 bytes from the sender to the receiver process.<br>Furthermore, the researchers disclosed that it’s possible to leak register contents from an SGX enclave of Intel CPUs using a register that’s speculatively dereferenced (called “Dereference Trap”), using it to recover a 32-bit value stored in a 64-bit register within 15 minutes.</p>
<p>Lastly, ‘certain attacks’ can now be mounted remotely using JavaScript in a web browser, and “fill 64-bit registers with an attacker-controlled value in JavaScript by using WebAssembly.”</p>
<p>To mitigate these attacks, it’s recommended that current CPUs enable Spectre-BTB mitigations, including <a href="https://support.google.com/faqs/answer/7625886" target="_blank" rel="noopener noreferrer">retpoline</a> (short for “return trampoline”), which aims to <a href="https://software.intel.com/security-software-guidance/insights/deep-dive-retpoline-branch-target-injection-mitigation" target="_blank" rel="noopener noreferrer">prevent branch-target-injection</a> by isolating <a href="https://en.wikipedia.org/wiki/Branch_predictor#Indirect_branch_predictor" target="_blank" rel="noopener noreferrer">indirect branches</a> from speculative execution.</p>
</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>