<!DOCTYPE html>
<html lang="en">
<head>
    <title>
1650910 - DigiCert: Inconsistent EV audits - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="1650910 - DigiCert: Inconsistent EV audits - linksfor.dev(s)"/>
    <meta property="og:description" content="ASSIGNED (brenda.bernal) in NSS - CA Certificate Root Program. Last updated 2020-07-06."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1650910#c2"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - 1650910 - DigiCert: Inconsistent EV audits</title>
<div class="readable">
        <h1>1650910 - DigiCert: Inconsistent EV audits</h1>
            <div>Reading time: 8-10 minutes</div>
        <div>Posted here: 06 Jul 2020</div>
        <p><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1650910#c2">https://bugzilla.mozilla.org/show_bug.cgi?id=1650910#c2</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="bugzilla-body" tabindex="-1">
<div id="main-inner">










<section>
  <div>
  <div id="summary-container">
    <div id="field-status_summary">


  
    <p><span id="field-value-status_summary">
      <span data-status="open">Open</span>
      <span id="field-value-bug_id">
        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1650910">Bug 1650910</a>
      </span>
      <span>
        <span>Opened <span title="2020-07-06 13:59 PDT" data-time="1594069168">1 hour ago</span></span>
          <span>Updated <span title="2020-07-06 14:42 PDT" data-time="1594071746">21 minutes ago</span></span>
      </span>
        </span>
    </p>

  
</div>


    
  </div>
  </div>
</section>


<section id="module-categories">
    
  <div id="module-categories-content"><div>

    

    <div id="field-component">
    


  
    <div>
        <p><span id="field-value-component">
      <div>
        <p><span id="component-name" tabindex="0" role="button" aria-haspopup="menu" aria-controls="component-info">CA Certificate Root Program
          
        </span></p>
      </div>
        </span>
    </p></div>

  
</div>

    

    
</div>
  </div>
</section>


<section id="module-tracking">
    
  
</section>



<section id="module-people">
    
  
</section>





<section id="module-details">
    
  
</section>
























<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;79.0b4&quot;,&quot;FIREFOX_ESR&quot;:&quot;68.10.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;78.0.1esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;80.0a1&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2020-05-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2020-05-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2020-04-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;79.0b4&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;79.0b4&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;78.0.1&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2020-06-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2020-06-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2020-05-28&quot;}">



<div id="c0"><div id="ct-0" data-comment-id="14921802" data-ismarkdown="true"><ol>
<li>How your CA first became aware of the problem (e.g. via a problem report submitted to your Problem Reporting Mechanism, a discussion in mozilla.dev.security.policy, a Bugzilla bug, or internal self-audit), and the time and date.</li>
</ol>
<p>As part of the Mozilla bug <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1647084">https://bugzilla.mozilla.org/show_bug.cgi?id=1647084</a>, Rob Stradling posted a link to crt.sh listing some CAs with inconsistent audits <a href="https://crt.sh/mozilla-disclosures#disclosedwithinconsistentaudit" rel="nofollow">https://crt.sh/mozilla-disclosures#disclosedwithinconsistentaudit</a>. After reviewing, we confirmed there was an issue and we investigated further.</p>
<ol start="2">
<li>A timeline of the actions your CA took in response. A timeline is a date-and-time-stamped sequence of all relevant events. This may include events before the incident was reported, such as when a particular requirement became applicable, or a document changed, or a bug was introduced, or an audit was done.</li>
</ol>
<p>01-Aug-2013: We issued the first issuing certificate.<br>
09-Feb-2018: Last issuing certificate in scope signed.<br>
02-July-2020, 15:17: Rob Stradling posts <a href="https://crt.sh/mozilla-disclosures#disclosedwithinconsistentaudit" rel="nofollow">https://crt.sh/mozilla-disclosures#disclosedwithinconsistentaudit</a> to Bugzilla.<br>
02-July-2020, 22:00: Internal investigation started.<br>
05-July-2020, 23:00: Investigation and remediation plan was discussed internally; we began building the revocation scope list with a timeline.<br>
06-July-2020: EV issuance blocked for ICAs in scope.<br>
06-July-2020: This bug was posted.</p>
<ol start="3">
<li>Whether your CA has stopped, or has not yet stopped, issuing certificates with the problem. A statement that you have will be considered a pledge to the community; a statement that you have not requires an explanation.</li>
</ol>
<p>DigiCert is in the process of halting all EV issuance across  CAs omitted from an EV audit report. Issuing CAs are properly listed in the WebTrust CA and BR audit reports and are still issuing non-EV certificates. We expect to replace the ICAs for EV issuance today (July 6, and we will revoke active EV certificates issued under these ICAs. We’re still determining the number of EV certs impacted, but we think it’s approximately 50k.</p>
<ol start="4">
<li>A summary of the problematic certificates. For each problem: number of certs, and the date the first and last certs with that problem were issued.</li>
</ol>
<p>This issue impacts a number of ICAs created between 01 Aug 2013 and 09 Feb 2018. Going forward, all ICAs capable of issuing TLS will be listed in both the EV audit and WebTrust audit. Since all TLS issuing CAs are also capable of issuing EV, all ICAs should be included in the EV report.<br>
Here’s the list ICAs that have issued EV certs without being listed in the EV audit report:<br>
DigiCert Global CA G2				<a href="https://crt.sh/?id=8656330" rel="nofollow">https://crt.sh/?id=8656330</a><br>
GeoTrust TLS RSA CA G1			        <a href="https://crt.sh/?id=250864679" rel="nofollow">https://crt.sh/?id=250864679</a><br>
Thawte TLS RSA CA G1				<a href="https://crt.sh/?id=250864680" rel="nofollow">https://crt.sh/?id=250864680</a><br>
Secure Site CA					<a href="https://crt.sh/?id=329144662" rel="nofollow">https://crt.sh/?id=329144662</a><br>
NCC Group Secure Server CA G2		<a href="https://crt.sh/?id=5836038" rel="nofollow">https://crt.sh/?id=5836038</a><br>
TERENA SSL High Assurance CA 3 	<a href="https://crt.sh/?id=5797998" rel="nofollow">https://crt.sh/?id=5797998</a><br>
For clarity, all ICAs listed above were included in CA and BR audits but not the EV audit.</p>
<ol start="5">
<li>The complete certificate data for the problematic certificates. The recommended way to provide this is to ensure each certificate is logged to CT and then list the fingerprints or crt.sh IDs, either in the report or as an attached spreadsheet, with one list per distinct problem.</li>
</ol>
<p>We are working on a list of impacted end-entity certs and will publish them later this week. Note that all EV end-entity certs were covered by the EV audit in scope of the auditor’s sample. The part not in scope was us having the auditor list all of the TLS ICAs. We are revoking the end-entity certs impacted. We think this is a first for the industry but are basing the revocation and plan on previous scenarios where certs are adequately covered by an audit.</p>
<ol start="6">
<li>Explanation about how and why the mistakes were made or bugs introduced, and how they avoided detection until now.</li>
</ol>
<p>In the past, ICAs were listed in audit reports based on planned usage rather than whether they were capable of issuing EV, meaning that not all TLS issuing certs were listed in the audit report. This is separate from how we pull EV data for the auditor sample, where the sample is pulled from all issued certs, regardless of chain. The result is a weird situation where all of the certs were tested against the EV requirements, but the audit report did not list the specific ICA. Because of this, we are revoking all of the end-entity EV certs and moving them to a new chain. We’re also moving up the audit to start in August with an earlier period end than the prior year and listing all ICAs in the next audit report.</p>
<p>All EV certificates issued from these ICA have been included in the sample population extract for our EV audits in previous year’s audit. However, the list of EV ICAs in the report has been based on the previous year’s scope list with any deltas (adds for new signings and removals for revoked or expired within the audit period). The process for including new ICAs in the audit scope lists is changing for our 2019-2020 audit period to cover for all possible usage and TLS cert types.</p>
<ol start="7">
<li>List of steps your CA is taking to resolve the situation and ensure such issuance will not be repeated in the future, accompanied with a timeline of when your CA expects to accomplish these things.</li>
</ol>
<p>DigiCert is disabling EV issuance for these ICA, and is in the process of revoking all valid EV certificates chained to one of the impacted ICAs.  Starting with the 2019-2020 audit period, all TLS-capable issuing CAs will be covered in TLS based audits: BR and EV. The scope list undergoes three levels of review before being finalized, and it’s checked with multiple sources (CCADB and our internal Root/CA database that captures all signings). We expect to be underway with our upcoming period audit shortly.</p>
</div></div><div id="c1"><div id="ct-1" data-comment-id="14921830" data-ismarkdown="true"><blockquote>
<p>We think this is a first for the industry but are basing the revocation and plan on previous scenarios where certs are adequately covered by an audit.</p>
</blockquote>
<p>I think this is as well, and I really want to commend DigiCert for doing this and filing this incident. This is one of the rare times that I've received an incident report and said "Wow, that's a good incident report". As DigiCert used to struggle in this area, I want to say, that's a real marked turn-around and a really positive sign.</p>
<p>The only thing that I think is missing here is understanding the timeline for this transition. It's not clear to me what the actionable update dates are, beyond the updated audit period that sounds like it's shifting in August.</p>
</div><div><p>Assignee: kwilson → brenda.bernal</p><p>Status: UNCONFIRMED → ASSIGNED</p><p>Ever confirmed: true</p><p>Flags: needinfo?(brenda.bernal)</p><p>Whiteboard: [ca-compliance]</p></div></div><div id="c2"><div id="ct-2" data-comment-id="14921844" data-ismarkdown="true"><p>Thanks Ryan.  A couple of thoughts on timing:</p>
<ol>
<li>All ICAs not covered by the EV audit are being turned off for issuance today.</li>
<li>The new audit is scheduled for Aug (the soonest we could get auditors in).</li>
<li>Revocation will commence and hopefully complete on Friday of this week (we're trying to follow five day rule on this one). If, for whatever reason, we don't revoke 100% by Friday, we will file a separate incident report for delayed revocation and give you both the reason for the delay and serial numbers not revoked at that time.</li>
</ol>
</div></div><div id="c3"><div id="ct-3" data-comment-id="14921858" data-ismarkdown="true"><p>Sounds good. I'm setting Next-Update to cycle back at the end of August, although if anything changes in the timeline, please report that sooner.</p>
<p>Your described plan for revocation sounds good, and creating an incident report for anything that misses the window is a suitable update.</p>
</div><div><p>Flags: <span>needinfo?(brenda.bernal)</span></p><p>Whiteboard: [ca-compliance] → [ca-compliance] - Next Update - 31 Aug-2020</p></div></div>



</div> 
</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>