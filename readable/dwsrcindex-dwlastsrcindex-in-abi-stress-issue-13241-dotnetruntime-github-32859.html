<!DOCTYPE html>
<html lang="en">
<head>
    <title>
[arm32/linux] Assert failure: dwSrcIndex &gt; dwLastSrcIndex in ABI stress &#xB7; Issue #13241 &#xB7; dotnet/runtime - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="[arm32/linux] Assert failure: dwSrcIndex &gt; dwLastSrcIndex in ABI stress &#xB7; Issue #13241 &#xB7; dotnet/runtime - linksfor.dev(s)"/>
    <meta property="article:author" content="msftgits"/>
    <meta property="og:description" content="pinvoke stress on arm32 fails with an assert failure: Assert failure(PID 46 [0x0000002e], Thread: 46 [0x002e]): dwSrcIndex &amp;gt; dwLastSrcIndex File: /__w/2/s/src/vm/arm/stubs.cpp Line: 1558 Image: ..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/dotnet/coreclr/issues/26105"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
				<a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - [arm32/linux] Assert failure: dwSrcIndex &gt; dwLastSrcIndex in ABI stress &#xB7; Issue #13241 &#xB7; dotnet/runtime</title>
<div class="readable">
        <h1>[arm32/linux] Assert failure: dwSrcIndex &gt; dwLastSrcIndex in ABI stress &#xB7; Issue #13241 &#xB7; dotnet/runtime</h1>
            <div>by msftgits</div>
            <div>Reading time: 3-4 minutes</div>
        <div>Posted here: 12 Aug 2019</div>
        <p><a href="https://github.com/dotnet/coreclr/issues/26105">https://github.com/dotnet/coreclr/issues/26105</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div data-channel="marked-as-read:issue:557966616">

              
<div data-gid="MDU6SXNzdWU1NTc5NjY2MTY=" data-url="/_render_node/MDU6SXNzdWU1NTc5NjY2MTY=/issues/body" data-channel="issue:557966616">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/jakobbotsch/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/jakobbotsch"><img height="40" width="40" alt="@jakobbotsch" src="https://avatars0.githubusercontent.com/u/7887810?s=88&amp;v=4"></a>

</p>


  
<div id="issue-557966616">
  <div data-body-version="113a3d5494064755f0d9b9493faec0b4" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>pinvoke stress on arm32 fails with an assert failure:</p>
<pre><code>Assert failure(PID 46 [0x0000002e], Thread: 46 [0x002e]): dwSrcIndex &gt; dwLastSrcIndex
    File: /__w/2/s/src/vm/arm/stubs.cpp Line: 1558
    Image: /root/helix/work/correlation/corerun

/root/helix/work/workitem/JIT/Stress/ABI/pinvokes_do/pinvokes_do.sh: line 271:    46 Aborted                 $LAUNCHER $ExePath "${CLRTestExecutionArguments[@]}"

Return code:      1
Raw output file:      /root/helix/work/workitem/JIT/Stress/Reports/JIT.Stress/ABI/pinvokes_do/pinvokes_do.output.txt
Raw output:
BEGIN EXECUTION
/root/helix/work/correlation/corerun pinvokes_do.exe '--pinvokes' '--num-calls' '1000' '--no-ctrlc-summary'
Stressing pinvokes
OSVersion: Unix 4.4.38.0
OSArchitecture: Arm
ProcessArchitecture: Arm
Selecting armhf ABI.
50 callers done
100 callers done
Expected: 100
Actual: 134
END EXECUTION - FAILED
Test Harness Exitcode is : 1
To run the test:
&gt; set CORE_ROOT=/root/helix/work/correlation
&gt; /root/helix/work/workitem/JIT/Stress/ABI/pinvokes_do/pinvokes_do.sh
</code></pre>
<p>category:correctness<br>
theme:pinvoke<br>
skill-level:intermediate<br>
cost:medium</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>

</div>


              

  


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyMDI4NjQzMw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyMDI4NjQzMw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyMDI4NjQzMw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/BruceForstall/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/BruceForstall"><img height="40" width="40" alt="@BruceForstall" src="https://avatars2.githubusercontent.com/u/10901265?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-520286433">
    <div>
      

  

<details data-body-version="08a302debd5134605448e4996117f7de">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyMDI5NDczNw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyMDI5NDczNw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyMDI5NDczNw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/jakobbotsch/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/jakobbotsch"><img height="40" width="40" alt="@jakobbotsch" src="https://avatars0.githubusercontent.com/u/7887810?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-520294737">
    <div>
      

  

<details data-body-version="b95512104fb23f0418da9df44cdfada5">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="b95512104fb23f0418da9df44cdfada5" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>Yes indeed, I opened this to have something to reference when excluding that test for arm32.</p>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyMTMyMzQxMw==">
  
    
<div data-gid="MDEyOklzc3VlQ29tbWVudDUyMTMyMzQxMw==" data-url="/_render_node/MDEyOklzc3VlQ29tbWVudDUyMTMyMzQxMw==/timeline/issue_comment">

  
<p><a data-hovercard-type="user" data-hovercard-url="/users/jakobbotsch/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/jakobbotsch"><img height="40" width="40" alt="@jakobbotsch" src="https://avatars0.githubusercontent.com/u/7887810?s=88&amp;v=4"></a>

</p>


  
<div id="issuecomment-521323413">
    <div>
      

  

<details data-body-version="ddead89f421d6800c7d810f82326b5c5">
    <summary>
      <div>
        <h3>
              This comment has been minimized.

        </h3>
        
      </div>
    </summary>
</details>


    </div>
  <div data-body-version="ddead89f421d6800c7d810f82326b5c5" data-unfurl-hide-url="/content_reference_attachments/hide">
    


    <div>

      
<task-lists disabled="" sortable="">
<div>
          <p>The test that found this is currently disabled on ARM32:<br>
<a href="https://github.com/dotnet/coreclr/blob/fdb2bc4233bf93e44bda4b1ae3b1432e80c9f0da/tests/issues.targets#L232-L234">https://github.com/dotnet/coreclr/blob/fdb2bc4233bf93e44bda4b1ae3b1432e80c9f0da/tests/issues.targets#L232-L234</a></p>
<p>As part of a fix to this issue this test should be enabled.</p>
<p>This test will run through a lot of different callers. To make a smaller test case, you can ask the test to run only a single caller using the arg <code>--caller-index 1234</code>. However since this is an assertion failure the test output does not show exactly which caller it is (only that it is in the 100-150 area). So to find the proper index the following can be done:</p>
<ol>
<li>Run with verbose, i.e. <code>--pinvokes --num-calls 1000 --verbose</code></li>
<li>It will give a lot of output. Once it asserts, scroll up to see the name of the caller that was being tested. It should be something like <code>ABIStress_Pinvoker1234</code></li>
<li>Rerun the test with only this caller, i.e. something like <code>--pinvokes --caller-index 1234</code>. This should reproduce the problem without going through a bunch of other callers first.</li>
</ol>
      </div>
</task-lists>


        



    </div>

  </div>
</div>


</div>


</div>


  
  







<!-- Rendered timeline since 2020-01-30 23:40:40 -->



            </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>