<!DOCTYPE html>
<html lang="en">
<head>
    <title>
PDF text extraction | FilingDB - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="PDF text extraction | FilingDB - linksfor.dev(s)"/>
    <meta property="og:description" content="&#x200B;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.filingdb.com/pdf-text-extraction"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
	<div class="devring" style="background: #222">
		<div class="grid">
			<div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
				<span class="devring-title">devring.club</span>
				<a href="https://devring.club/site/1/previous" class="devring-previous">Previous</a>
				<a href="https://devring.club/random" class="devring-random">Random</a>
				<a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
			</div>
		</div>
	</div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - PDF text extraction | FilingDB</title>
<div class="readable">
        <h1>PDF text extraction | FilingDB</h1>
            <div>Reading time: 11-14 minutes</div>
        <div>Posted here: 03 Mar 2020</div>
        <p><a href="https://www.filingdb.com/pdf-text-extraction">https://www.filingdb.com/pdf-text-extraction</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="SITE_ROOT" aria-hidden="false"><div id="masterPage" data-mesh-layout="grid"><main tabindex="-1" data-is-mobile="false" data-is-mesh="true" data-site-width="980" data-state="" id="PAGES_CONTAINER"><div id="PAGES_CONTAINERcenteredContent"><div id="PAGES_CONTAINERinlineContent"><div><div data-ismobile="false" data-is-mesh-layout="true" id="zq1ap"><div id="zq1apinlineContent"><div id="zq1apinlineContent-gridWrapper" data-mesh-internal="true"><div id="zq1apinlineContent-gridContainer" data-mesh-internal="true"><div data-packed="false" data-min-height="570" id="comp-k765qikn">

<p><span>​</span></p>

<p>There is a common view that extracting text from a PDF document should not be too difficult. After all, the text is right there in front of our eyes and humans consume PDF content all the time with great success. Why would it be difficult to automatically extract the text data?</p>



<p>Turns out, much how <span><a href="https://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/" target="_blank" data-content="https://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/" data-type="external" rel="noopener">working with human names is difficult</a></span> due to numerous edge cases and incorrect assumptions, working with PDFs is difficult due to the extreme flexibility given by the PDF format.</p>



<p>The main problem is that PDF was never really designed as a data input format, but rather, it was designed as an output format giving fine grained control over the resulting document.</p>



<p>At its core, the PDF format consists of a stream of instructions describing how to draw on a page. In particular, text data isn’t stored as paragraphs - or even words - but as characters which are painted at certain locations on the page. As a result, most of the content semantics are lost when a text or word document is converted to PDF - all the implied text structure is converted into an almost amorphous soup of characters floating on pages.</p>



<p>As part of building <span><a href="https://www.filingdb.com/" target="_blank" data-content="https://www.filingdb.com/" data-type="external" rel="noopener">FilingDB</a></span>, we’ve extracted text data from tens of thousands of PDF documents. In the process, we have seen how every single assumption we had about how PDF files are structured was proven incorrect. Our mission was particularly difficult as we had to process PDF documents coming from a variety of sources, with wildly different styling, typesetting and presentation choices.</p>



<p>The list below documents some of the ways PDF files have made it difficult (or even impossible) to extract text contents.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>PDF read protection</span></h5>



<p>You may have come across PDF files which refuse to let you copy their text content. For example, here is what SumatraPDF shows when attempting to copy text from a copy-protected document.</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="167" id="comp-k7ar3xgx"><div id="comp-k7ar3xgxlink"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7ar3xig&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_79a1e440e9634570a032d9f9a8da2aa0~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:975,&quot;height&quot;:271,&quot;alt&quot;:&quot;1.png&quot;,&quot;name&quot;:&quot;1.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7ar3xgx&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7ar3xgximg" data-src="https://static.wixstatic.com/media/81906c_79a1e440e9634570a032d9f9a8da2aa0~mv2.png/v1/fill/w_598,h_165,al_c,q_85,usm_0.66_1.00_0.01/1.webp"><img id="comp-k7ar3xgximgimage" alt="1.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_79a1e440e9634570a032d9f9a8da2aa0~mv2.png/v1/fill/w_598,h_165,al_c,q_85,usm_0.66_1.00_0.01/1.webp"></wix-image></div></div><div data-packed="false" data-min-height="274" id="comp-k7ar7hoc"><p>Interestingly, the text is already visible, yet the PDF viewer is refusing to populate the clipboard with the highlighted text.</p>



<p>The way this is implemented is by having several “access permissions” flags, one of which controls whether copying content is allowed. It’s important to keep in mind that this restriction is not enforced by the PDF file - the actual PDF contents are unaffected and it is up to the pdf renderer to honour this flag.</p>



<p>Needless to say, this offers no real protection against extracting the text out of the PDF, as any reasonably sophisticated PDF handling library will allow the user to either toggle the flags or ignore them.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>Off-page characters</span></h5>

<p><span>​</span></p>

<p>It is not uncommon for PDF files to contain more textual data than is actually displayed on the page. Take this page from the 2010 Nestle annual report.</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="644" id="comp-k7arj7wv"><div id="comp-k7arj7wvlink"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arj7y6&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_d3da4ca8f50c4776a27f2b340ad3b16c~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:516,&quot;height&quot;:644,&quot;alt&quot;:&quot;Picture2.png&quot;,&quot;name&quot;:&quot;Picture2.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arj7wv&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arj7wvimg" data-src="https://static.wixstatic.com/media/81906c_d3da4ca8f50c4776a27f2b340ad3b16c~mv2.png/v1/fill/w_514,h_642,al_c,q_85,usm_0.66_1.00_0.01/Picture2.webp"><img id="comp-k7arj7wvimgimage" alt="Picture2.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_d3da4ca8f50c4776a27f2b340ad3b16c~mv2.png/v1/fill/w_514,h_642,al_c,q_85,usm_0.66_1.00_0.01/Picture2.webp"></wix-image></div></div><div data-packed="false" data-min-height="233" id="comp-k7ar8evl"><p>There is more text associated with this page than meets the eye. In particular, the following can be found in the content data associated with this page:</p>

<p><br>
<span>“KitKat celebrated its 75th anniversary in 2010 but remains young and in touch with trends, having over 2.5 million Facebook fans. It is sold in over 70 countries and enjoys good growth in the developed world and emerging markets, such as the Middle East, India and Russia. Japan is its second biggest market.”</span></p>



<p>This text is actually positioned outside the page’s bounding box, so it is not displayed by most PDF viewers, but the data is there and will appear when programmatically extracting the text.</p>



<p>This occasionally happens due to last minute decisions to remove or replace text during the type setting process.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>Small / invisible characters on page</span></h5>

<p><span>​</span></p>

<p>PDFs occasionally introduce very small or hidden text on the page. For example, here is a page from the Nestle 2012 annual report.</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="316" id="comp-k7ark2br"><div id="comp-k7ark2brlink"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7ark2cp&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_4c44717e024f422188d867b30a2c338e~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:975,&quot;height&quot;:513,&quot;alt&quot;:&quot;Picture3.png&quot;,&quot;name&quot;:&quot;Picture3.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7ark2br&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7ark2brimg" data-src="https://static.wixstatic.com/media/81906c_4c44717e024f422188d867b30a2c338e~mv2.png/v1/fill/w_598,h_314,al_c,q_85,usm_0.66_1.00_0.01/Picture3.webp"><img id="comp-k7ark2brimgimage" alt="Picture3.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_4c44717e024f422188d867b30a2c338e~mv2.png/v1/fill/w_180,h_95,al_c,usm_0.66_1.00_0.01,blur_2/Picture3.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7ar91k5"><p>The page contains small white text on white background with the following contents:</p>

<p><span>​</span></p>

<p><span>“Wyeth Nutrition logo Identity Guidance to markets</span></p>

<p><span>Vevey Octobre 2012 RCC/CI&amp;D”</span></p>



<p>This is sometimes done for the benefit of accessibility, similar to how the alt attribute is used in HTML.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>Too many spaces</span></h5>

<p><span>​</span></p>

<p>Sometimes PDFs include extra spaces between letters in a word. This is most likely done for kerning purposes. (“Kerning” is the process of adjusting distances between characters during the type setting process)</p>



<p><span>Example:</span> the 2013 Hikma Pharma annual report contains the following text:</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="134" id="comp-k7arlchw"><div id="comp-k7arlchwlink"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arlcjl&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_519d88671701440788fb4db54148820f~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:975,&quot;height&quot;:217,&quot;alt&quot;:&quot;Picture4.png&quot;,&quot;name&quot;:&quot;Picture4.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arlchw&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arlchwimg" data-src="https://static.wixstatic.com/media/81906c_519d88671701440788fb4db54148820f~mv2.png/v1/fill/w_598,h_132,al_c,q_85,usm_0.66_1.00_0.01/Picture4.webp"><img id="comp-k7arlchwimgimage" alt="Picture4.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_519d88671701440788fb4db54148820f~mv2.png/v1/fill/w_180,h_40,al_c,usm_0.66_1.00_0.01,blur_2/Picture4.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7ar9c33"><p>Copying the text gives:</p>

<p><span>“ch a i r m a n ' s s tat em en t”</span></p>



<p>Reconstructing the original text is a difficult problem to solve generally. Our most successful approach has been applying OCR techniques.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>Not enough spaces</span></h5>

<p><span>​</span></p>

<p>Sometimes PDFs do not contain spaces or replace them with a different character.</p>



<p><span>Example 1:</span> The following extract from the 2017 SEB annual report.</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="169" id="comp-k7arlchy"><div id="comp-k7arlchylink"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arlcka&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_c39121f329b141599870de1202862794~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:975,&quot;height&quot;:275,&quot;alt&quot;:&quot;Picture5.png&quot;,&quot;name&quot;:&quot;Picture5.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arlchy&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arlchyimg" data-src="https://static.wixstatic.com/media/81906c_c39121f329b141599870de1202862794~mv2.png/v1/fill/w_598,h_167,al_c,q_85,usm_0.66_1.00_0.01/Picture5.webp"><img id="comp-k7arlchyimgimage" alt="Picture5.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_c39121f329b141599870de1202862794~mv2.png/v1/fill/w_180,h_51,al_c,usm_0.66_1.00_0.01,blur_2/Picture5.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7ara1zh"><p>The extracted text shows:</p>

<p><span>“Tenyearsafterthefinancialcrisisstarted”</span></p>



<p><span>Example 2:</span> The 2013 Eurobank annual report shows the following</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="105" id="comp-k7arlci1"><div id="comp-k7arlci1link"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arlclh&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_77ea0a38c52c4bc49d9cf32c5564e5a2~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:975,&quot;height&quot;:171,&quot;alt&quot;:&quot;Picture6.png&quot;,&quot;name&quot;:&quot;Picture6.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arlci1&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arlci1img" data-src="https://static.wixstatic.com/media/81906c_77ea0a38c52c4bc49d9cf32c5564e5a2~mv2.png/v1/fill/w_598,h_103,al_c,q_85,usm_0.66_1.00_0.01/Picture6.webp"><img id="comp-k7arlci1imgimage" alt="Picture6.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_77ea0a38c52c4bc49d9cf32c5564e5a2~mv2.png/v1/fill/w_180,h_32,al_c,usm_0.66_1.00_0.01,blur_2/Picture6.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7ara3en"><p>Extracting the text gives:</p>

<p><span>“On_April_7,_2013,_the_competent_authorities”</span></p>



<p>Again, our most successful solution was to run OCR on these pages.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>Embedded fonts</span></h5>

<p><span>​</span></p>

<p>PDF font handling is complex to say the least. To understand how PDF files store text data we must first know about glyphs, glyph names, fonts.</p>

<ul>
	<li>
	<p>A glyph is a set of instructions describing how to draw a symbol or character.</p>
	</li>
	<li>
	<p>A glyph name is the name associated with that glyph.<br>
	For example “trademark” for the “™” glyph and “a” for the “a” glyph.</p>
	</li>
	<li>
	<p>Fonts are lists of glyphs with associated glyph names.<br>
	For example, most fonts have a glyph that most humans would recognize as the letter “a”, with different fonts showing various ways of drawing that letter.</p>
	</li>
</ul>



<p>In a PDF, the characters are stored as numbers, called “codepoints”. To decide what to draw on the screen, a renderer has to go:</p>

<p>codepoint -&gt; glyph name -&gt; glyph<br>
&nbsp;</p>

<p>For example, a PDF document can contain codepoint 116, which it maps into the glyph name “t” which, in turn, maps into the glyph describing how to draw “t” on the screen.</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="0" data-content-padding-vertical="0" data-exact-height="276" id="comp-k7arlci2"><div id="comp-k7arlci2link"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arlclx&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_96f20d4ef14e4466b9c979ee34ac2f8d~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:729,&quot;height&quot;:335,&quot;alt&quot;:&quot;Picture7.png&quot;,&quot;name&quot;:&quot;Picture7.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arlci2&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arlci2img" data-src="https://static.wixstatic.com/media/81906c_96f20d4ef14e4466b9c979ee34ac2f8d~mv2.png/v1/fill/w_600,h_276,al_c,q_85,usm_0.66_1.00_0.01/Picture7.webp"><img id="comp-k7arlci2imgimage" alt="Picture7.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_96f20d4ef14e4466b9c979ee34ac2f8d~mv2.png/v1/fill/w_180,h_83,al_c,usm_0.66_1.00_0.01,blur_2/Picture7.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7ara57w"><p>Now, most PDF files use a standard codepoint encoding. A codepoint encoding is a set of rules that assign meaning to the codepoints themselves. For example:</p>

<ul>
	<li>
	<p>ASCII and Unicode both use codepoint 116 to represent the letter “t”.</p>
	</li>
	<li>
	<p>Unicode maps codepoint 9786 to “white smiley face”, rendered as ☺, whereas ASCII is not defined at that codepoint.&nbsp;</p>
	</li>
</ul>



<p>However, PDF documents occasionally use their own custom encoding together with custom fonts. It might seem strange, but a document can use codepoint 1 to represent the letter “t”. It will map codepoint 1 into the glyph name “c1”, which will map into a glyph describing how to draw the letter “t”.</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="0" data-content-padding-vertical="0" data-exact-height="276" id="comp-k7arlci3"><div id="comp-k7arlci3link"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arlcmb&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_f10bbca89c5248fc9dfd8f8108eac484~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:729,&quot;height&quot;:335,&quot;alt&quot;:&quot;Picture8.png&quot;,&quot;name&quot;:&quot;Picture8.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arlci3&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arlci3img" data-src="https://static.wixstatic.com/media/81906c_f10bbca89c5248fc9dfd8f8108eac484~mv2.png/v1/fill/w_600,h_276,al_c,q_85,usm_0.66_1.00_0.01/Picture8.webp"><img id="comp-k7arlci3imgimage" alt="Picture8.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_f10bbca89c5248fc9dfd8f8108eac484~mv2.png/v1/fill/w_180,h_83,al_c,usm_0.66_1.00_0.01,blur_2/Picture8.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7arbdbt"><p>While for a human the end result looks the same, a machine will get confused by the codepoints it is seeing. If the codepoints do not follow a standard encoding, then it is virtually impossible to programmatically know what codepoints 1 2 and 3 represent.</p>



<p>Why would a PDF document contain nonstandard fonts and encodings?</p>

<ul>
	<li>
	<p>One reason is to make text extraction more difficult.</p>
	</li>
	<li>
	<p>Another is the use of subfonts. Most fonts contain glyphs for a very large number of codepoints and a pdf might only use a subset of these. To save space, a PDF creator can strip away all unneeded glyphs and create a compact subfont which will most likely use a non-standard encoding.</p>
	</li>
</ul>



<p>One workaround is to extract the font glyphs from the document, run them through OCR software and build the map from font glyph to unicode. This then lets you translate from the font-specific encoding to the unicode encoding e.g: codepoint 1 is mapped to name “c1” which, based on looking at the glyph, should be a “t”, which is unicode codepoint 116.</p>



<p>The encoding map that you’ve just generated, the one going from 1 to 116, is called a ToUnicode map in the PDF standard. PDF documents can provide their own ToUnicode map, but it’s optional and many do not.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>Word and paragraph detection</span></h5>

<p><span>​</span></p>

<p>Reconstructing paragraphs and even words from the amorphous character soup of PDF files is a difficult task.</p>



<p>The PDF document provides a list of characters on a page and it is up to the consumer to identify words and paragraphs. Humans are naturally effective at doing this as reading is a widespread skill.</p>



<p>The common approach is to have a grouping or clustering algorithm which compares letter sizes, positions and alignments in order to determine what is a word/paragraph.<br>
Naive implementations can easily have complexity larger than O(n²), resulting in long processing times on busy pages.</p>

<p><span>​</span></p>

<p><span>​​</span></p>

<h5><span>Text and paragraph order</span></h5>

<p><span>​</span></p>

<p>Deciding on text and paragraph order is difficult on two levels.</p>



<p>First, sometimes there is no correct answer. While documents with conventional, single column typesetting have a natural order of reading, documents with more adventurous layouts are challenging. As an example, it is not clear if the following inset should appear before, after, or during the article it is placed next to:</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="370" id="comp-k7arlci4"><div id="comp-k7arlci4link"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arlcms&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_f308ba1095f04834b7cfc388bf724143~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:975,&quot;height&quot;:602,&quot;alt&quot;:&quot;Picture9.png&quot;,&quot;name&quot;:&quot;Picture9.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arlci4&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arlci4img" data-src="https://static.wixstatic.com/media/81906c_f308ba1095f04834b7cfc388bf724143~mv2.png/v1/fill/w_598,h_368,al_c,q_85,usm_0.66_1.00_0.01/Picture9.webp"><img id="comp-k7arlci4imgimage" alt="Picture9.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_f308ba1095f04834b7cfc388bf724143~mv2.png/v1/fill/w_180,h_111,al_c,usm_0.66_1.00_0.01,blur_2/Picture9.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7arbgz9"><p>Second, even when the answer is clear to a human, determining robust paragraph order is a very difficult problem to solve, perhaps even AI-hard. This might sound like an extreme statement, however there are cases where the correct paragraph order can only be decided by understanding the text content.</p>



<p>Consider the following two-columns layout, describing how to prepare a vegetable salad:</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="0" data-content-padding-vertical="0" data-exact-height="143" id="comp-k7arqhi9"><div id="comp-k7arqhi9link"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arqhlx&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_b6163a284f024c56b59e37d35fefad67~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:975,&quot;height&quot;:233,&quot;alt&quot;:&quot;Picture11.png&quot;,&quot;name&quot;:&quot;Picture11.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arqhi9&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arqhi9img" data-src="https://static.wixstatic.com/media/81906c_b6163a284f024c56b59e37d35fefad67~mv2.png/v1/fill/w_600,h_143,al_c,q_85,usm_0.66_1.00_0.01/Picture11.webp"><img id="comp-k7arqhi9imgimage" alt="Picture11.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_b6163a284f024c56b59e37d35fefad67~mv2.png/v1/fill/w_180,h_43,al_c,usm_0.66_1.00_0.01,blur_2/Picture11.png"></wix-image></div></div><div data-packed="false" data-min-height="24" id="comp-k7arbjeq"><p>In the western world, a reasonable assumption is that reading is done left to right and top to bottom. So the best we can do without looking at the contents is to reduce the answer to 2 options: A B C D and A C B D.</p>

<p><span>​</span></p>

<p>By looking at the content, understanding what it is talking about and knowing that vegetables are washed before chopping, we can determine that A C B D is the correct order. Determining this algorithmically is a difficult problem.</p>



<p>That being said, a “works most times” approach is to rely on the order in which the text is stored inside the PDF document. This usually corresponds to the order the text was inserted at creation time and, for large bodies of text containing multiple paragraphs, they tend to reflect the writer-intended order.</p>

<p><span>​</span></p>

<p><span>​</span></p>

<h5><span>Embedded images</span></h5>

<p><span>​</span></p>

<p>It is not uncommon for some (or all) of the PDF content to actually be a scan. In these cases, there is no text data to extract directly, so we have to resort to OCR techniques.</p>



<p>As an example, the Yell 2011 annual report is only available as a document scan:</p></div><div title="" data-is-responsive="false" data-display-mode="fill" data-content-padding-horizontal="2" data-content-padding-vertical="2" data-exact-height="754" id="comp-k7arlchz"><div id="comp-k7arlchzlink"><wix-image data-has-bg-scroll-effect="" data-image-info="{&quot;imageData&quot;:{&quot;type&quot;:&quot;Image&quot;,&quot;id&quot;:&quot;dataItem-k7arlckw&quot;,&quot;metaData&quot;:{&quot;pageId&quot;:&quot;zq1ap&quot;,&quot;isPreset&quot;:false,&quot;schemaVersion&quot;:&quot;2.0&quot;,&quot;isHidden&quot;:false},&quot;title&quot;:&quot;&quot;,&quot;uri&quot;:&quot;81906c_12d77b102507427e9e0c580e198a490e~mv2.png&quot;,&quot;description&quot;:&quot;&quot;,&quot;width&quot;:535,&quot;height&quot;:754,&quot;alt&quot;:&quot;Picture10.png&quot;,&quot;name&quot;:&quot;Picture10.png&quot;,&quot;displayMode&quot;:&quot;fill&quot;},&quot;containerId&quot;:&quot;comp-k7arlchz&quot;,&quot;displayMode&quot;:&quot;fill&quot;}" data-has-ssr-src="" data-is-svg="false" id="comp-k7arlchzimg" data-src="https://static.wixstatic.com/media/81906c_12d77b102507427e9e0c580e198a490e~mv2.png/v1/fill/w_533,h_752,al_c,q_90,usm_0.66_1.00_0.01/Picture10.webp"><img id="comp-k7arlchzimgimage" alt="Picture10.png" data-type="image" itemprop="image" src="https://static.wixstatic.com/media/81906c_12d77b102507427e9e0c580e198a490e~mv2.png/v1/fill/w_161,h_226,al_c,usm_0.66_1.00_0.01,blur_2/Picture10.png"></wix-image></div></div><div data-packed="false" data-min-height="763" id="comp-k7arcijx"><h5><span>Why not OCR all the time?</span></h5>

<p><span>​</span></p>

<p>While OCR might help with some of the issues shown above, it does come with its own set of drawbacks.</p>



<ol>
	<li>
	<p><span>Long processing time</span><br>
	Running OCR on a PDF scan usually takes at least an order of magnitude longer than extracting the text directly from the PDF.</p>
	</li>
	<li>
	<p><span>Difficulties with non-standard characters and glyphs</span><br>
	OCR algorithms have a hard time dealing with novel characters, such as smiley faces, stars/circles/squares (used in bullet point lists), superscripts, complex mathematical symbols etc.</p>
	</li>
	<li>
	<p><span>No text order hints</span><br>
	Ordering text extracted from a PDF document is easier as the insertion order hints, most of the time, at the correct reading order. Extracting text from images offers no such hints.</p>
	</li>
</ol>

<p><span>​</span><br>
&nbsp;</p>

<h5><span>Testing</span></h5>

<p><span>​</span></p>

<p>One aspect we haven’t mentioned so far is how difficult it is to confirm the extracted text is correct or expected. The approach we found most useful is to have an extensive suite of tests which look both at basic metrics (e.g. text length, page length, spaces to words ratios) and more sophisticated metrics (e.g. percentage of english words vs unrecognized words, percentage of numbers) and check for red flags such as suspicious or unexpected characters.</p>

<p><span>​</span></p>

<p>So what is our advice when it comes to extracting text from a PDF? Before anything else, make sure there are no better alternative data sources available.</p>



<p>If the data you are interested in only comes in the PDF format, then it’s important to be aware that this is a deceptively simple-looking problem and that a 100% accurate solution may be impossible.</p></div></div></div></div></div></div></div></div></main></div></div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>