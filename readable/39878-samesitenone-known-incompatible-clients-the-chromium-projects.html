<!DOCTYPE html>
<html lang="en">
<head>
    <title>
SameSite=None: Known Incompatible Clients - The Chromium Projects -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>SameSite=None: Known Incompatible Clients - The Chromium Projects</h1>
    <td class="sites-layout-tile sites-tile-name-content-1"><div><p>Last updated: October 29, 2019</p> Some user agents are known to be incompatible with the `SameSite=None` attribute.
<div>
<ul><li>Versions of Chrome from Chrome 51 to Chrome 66 (inclusive on both ends). These Chrome versions will reject a cookie with `SameSite=None`. This also affects older versions of <a href="https://en.wikipedia.org/wiki/Chromium_(web_browser)#Browsers_based_on_Chromium">Chromium-derived browsers</a>, as well as Android WebView<span>. This behavior was correct according to the version of the cookie specification at that time, but with the addition of the new &quot;None&quot; value to the specification, this behavior has been updated in Chrome 67 and newer. (Prior to Chrome 51, the SameSite attribute was ignored entirely and all cookies were treated as if they were `SameSite=None`.)</span></li>
<li>Versions of UC Browser on Android prior to version 12.13.2. Older versions will reject a cookie with `SameSite=None`. This behavior was correct according to the version of the cookie specification at that time, but with the addition of the new &quot;None&quot; value to the specification, this behavior has been updated&#xA0;in newer versions of UC Browser.</li>
<li>Versions of Safari on MacOS 10.14 and all browsers on iOS 12. These versions will erroneously treat cookies marked with `SameSite=None` as if they were marked `SameSite=Strict`. This <a href="https://bugs.webkit.org/show_bug.cgi?id=198181">bug</a> has been fixed on newer versions of iOS and MacOS.</li></ul> </div>
<div>
<p><span><font>Here is a potential approach to working around incompatible clients (in pseudocode). If you implement this sample, we highly encourage you to do your own testing to ensure that your implementation is working as intended. Note: The sample regular expression patterns below may not be perfect, as User-Agent strings can vary widely; we encourage you to use a tested User-Agent parsing library if possible.</font></span></p>
<font><br>
</font><br>
</div>
<pre><span>// Copyright 2019 Google LLC.</span>
<span>// SPDX-License-Identifier: Apache-2.0</span> <span>// Don&#x2019;t send `SameSite=None` to known incompatible clients.</span> <span>bool</span> shouldSendSameSiteNone<span>(</span><span>string</span> useragent<span>)</span><span>:</span> <span>return</span> <span>!</span>isSameSiteNoneIncompatible<span>(</span>useragent<span>)</span> <span>// Classes of browsers known to be incompatible.</span> <span>bool</span> isSameSiteNoneIncompatible<span>(</span><span>string</span> useragent<span>)</span><span>:</span> <span>return</span> hasWebKitSameSiteBug<span>(</span>useragent<span>)</span> <span>|</span><span>|</span> dropsUnrecognizedSameSiteCookies<span>(</span>useragent<span>)</span> <span>bool</span> hasWebKitSameSiteBug<span>(</span><span>string</span> useragent<span>)</span><span>:</span> <span>return</span> isIosVersion<span>(</span>major<span>:</span><span>12</span><span>,</span> useragent<span>)</span> <span>|</span><span>|</span> <span>(</span>isMacosxVersion<span>(</span>major<span>:</span><span>10</span><span>,</span> minor<span>:</span><span>14</span><span>,</span> useragent<span>)</span> <span>&amp;</span><span>&amp;</span> isSafari<span>(</span>useragent<span>)</span><span>)</span> <span>bool</span> dropsUnrecognizedSameSiteCookies<span>(</span><span>string</span> useragent<span>)</span><span>:</span> <span>return</span> <span>(</span>isChromiumBased<span>(</span>useragent<span>)</span> <span>&amp;</span><span>&amp;</span> isChromiumVersionAtLeast<span>(</span>major<span>:</span><span>51</span><span>,</span> useragent<span>)</span> <span>&amp;</span><span>&amp;</span> <span>!</span>isChromiumVersionAtLeast<span>(</span>major<span>:</span><span>67</span><span>,</span> useragent<span>)</span><span>)</span> <span>|</span><span>|</span> <span>(</span>isUcBrowser<span>(</span>useragent<span>)</span> <span>&amp;</span><span>&amp;</span> <span>!</span>isUcBrowserVersionAtLeast<span>(</span>major<span>:</span><span>12</span><span>,</span> minor<span>:</span><span>13</span><span>,</span> build<span>:</span><span>2</span><span>,</span> useragent<span>)</span><span>)</span> <span>// Regex parsing of User-Agent string. (See note above!)</span> <span>bool</span> isIosVersion<span>(</span><span>int</span> major<span>,</span> <span>string</span> useragent<span>)</span><span>:</span> <span>string</span> regex <span>=</span> <span>&quot;</span><span>\(</span><span>iP.+; CPU .*OS (</span><span>\d</span><span>+)[_</span><span>\d</span><span>]*.*</span><span>\)</span><span> AppleWebKit</span><span>\/</span><span>&quot;</span> <span>// Extract digits from first capturing group.</span> <span>return</span> useragent<span>.</span>regexMatch<span>(</span>regex<span>)</span><span>[</span><span>0</span><span>]</span> <span>=</span><span>=</span> intToString<span>(</span>major<span>)</span> <span>bool</span> isMacosxVersion<span>(</span><span>int</span> major<span>,</span> <span>int</span> minor<span>,</span> <span>string</span> useragent<span>)</span><span>:</span> <span>string</span> regex <span>=</span> <span>&quot;</span><span>\(</span><span>Macintosh;.*Mac OS X (</span><span>\d</span><span>+)_(</span><span>\d</span><span>+)[_</span><span>\d</span><span>]*.*</span><span>\)</span><span> AppleWebKit</span><span>\/</span><span>&quot;</span> <span>// Extract digits from first and second capturing groups.</span> <span>return</span> <span>(</span>useragent<span>.</span>regexMatch<span>(</span>regex<span>)</span><span>[</span><span>0</span><span>]</span> <span>=</span><span>=</span> intToString<span>(</span>major<span>)</span><span>)</span> <span>&amp;</span><span>&amp;</span> <span>(</span>useragent<span>.</span>regexMatch<span>(</span>regex<span>)</span><span>[</span><span>1</span><span>]</span> <span>=</span><span>=</span> intToString<span>(</span>minor<span>)</span><span>)</span> <span>bool</span> isSafari<span>(</span><span>string</span> useragent<span>)</span><span>:</span> <span>string</span> safari_regex <span>=</span> <span>&quot;</span><span>Version</span><span>\/</span><span>.* Safari</span><span>\/</span><span>&quot;</span> <span>return</span> useragent<span>.</span>regexContains<span>(</span>safari_regex<span>)</span> <span>&amp;</span><span>&amp;</span> <span>!</span>isChromiumBased<span>(</span>useragent<span>)</span> <span>bool</span> isChromiumBased<span>(</span><span>string</span> useragent<span>)</span><span>:</span> <span>string</span> regex <span>=</span> <span>&quot;</span><span>Chrom(e|ium)</span><span>&quot;</span> <span>return</span> useragent<span>.</span>regexContains<span>(</span>regex<span>)</span> <span>bool</span> isChromiumVersionAtLeast<span>(</span><span>int</span> major<span>,</span> <span>string</span> useragent<span>)</span><span>:</span> <span>string</span> regex <span>=</span> <span>&quot;</span><span>Chrom[^ </span><span>\/</span><span>]+</span><span>\/</span><span>(</span><span>\d</span><span>+)[</span><span>\.</span><span>\d</span><span>]* </span><span>&quot;</span> <span>// Extract digits from first capturing group.</span> <span>int</span> version <span>=</span> stringToInt<span>(</span>useragent<span>.</span>regexMatch<span>(</span>regex<span>)</span><span>[</span><span>0</span><span>]</span><span>)</span> <span>return</span> version <span>&gt;</span><span>=</span> major <span>bool</span> isUcBrowser<span>(</span><span>string</span> useragent<span>)</span><span>:</span> <span>string</span> regex <span>=</span> <span>&quot;</span><span>UCBrowser</span><span>\/</span><span>&quot;</span> <span>return</span> useragent<span>.</span>regexContains<span>(</span>regex<span>)</span> <span>bool</span> isUcBrowserVersionAtLeast<span>(</span><span>int</span> major<span>,</span> <span>int</span> minor<span>,</span> <span>int</span> build<span>,</span> <span>string</span> useragent<span>)</span><span>:</span> <span>string</span> regex <span>=</span> <span>&quot;</span><span>UCBrowser</span><span>\/</span><span>(</span><span>\d</span><span>+)</span><span>\.</span><span>(</span><span>\d</span><span>+)</span><span>\.</span><span>(</span><span>\d</span><span>+)[</span><span>\.</span><span>\d</span><span>]* </span><span>&quot;</span> <span>// Extract digits from three capturing groups.</span> <span>int</span> major_version <span>=</span> stringToInt<span>(</span>useragent<span>.</span>regexMatch<span>(</span>regex<span>)</span><span>[</span><span>0</span><span>]</span><span>)</span> <span>int</span> minor_version <span>=</span> stringToInt<span>(</span>useragent<span>.</span>regexMatch<span>(</span>regex<span>)</span><span>[</span><span>1</span><span>]</span><span>)</span> <span>int</span> build_version <span>=</span> stringToInt<span>(</span>useragent<span>.</span>regexMatch<span>(</span>regex<span>)</span><span>[</span><span>2</span><span>]</span><span>)</span> <span>if</span> major_version <span>!</span><span>=</span> major<span>:</span> <span>return</span> major_version <span>&gt;</span> major <span>if</span> minor_version <span>!</span><span>=</span> minor<span>:</span> <span>return</span> minor_version <span>&gt;</span> minor <span>return</span> build_version <span>&gt;</span><span>=</span> build
</pre></div></td>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>