<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Using DataAnnotations and custom form validation in client-side Blazor applications. - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Using DataAnnotations and custom form validation in client-side Blazor applications. - linksfor.dev(s)"/>
    <meta property="article:author" content="Gunnar Peipman"/>
    <meta property="og:description" content="Using DataAnnotations and custom form validation in client-side Blazor applications."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://gunnarpeipman.com/blazor/blazor-form-validation/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Using DataAnnotations and custom form validation in client-side Blazor applications.</title>
<div class="readable">
        <h1>Using DataAnnotations and custom form validation in client-side Blazor applications.</h1>
            <div>by Gunnar Peipman</div>
            <div>Reading time: 10-13 minutes</div>
        <div>Posted here: 12 Aug 2019</div>
        <p><a href="https://gunnarpeipman.com/blazor/blazor-form-validation/">https://gunnarpeipman.com/blazor/blazor-form-validation/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div><p>Client-side Blazor supports DataAnnotations form validation out-of-box. It’s simple and intuitive but also very flexible – if needed we can use the same mechanism to replace DataAnnotations validation with some other validation component. This blog post introduces form validation in Blazor applications and peeks also into engine of validation mechanism.</p><blockquote><p><strong>NB!</strong> Form validation in Blazor is experimental and subject to changes. This blog post is written using .NET Core 3.0 Preview 7.</p></blockquote><h3>Data annotations validation</h3><p>Blazor supports <a title="DataAnnotations validation" href="https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.dataannotations?view=netcore-3.0">DataAnnotations validation</a> out-of-box. To use validation we have to have model with data annotations and edit form defined in Blazor view.</p><p>Let’s create simple model for guestbook. It has properties for poster name and message.</p><pre><span>public</span>&nbsp;<span>class</span>&nbsp;<span>GuestbookEntry</span><br>{<br>&nbsp;&nbsp;&nbsp; [<span>Required</span>]<br>&nbsp;&nbsp;&nbsp; [<span>MaxLength</span>(10)]<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>string</span> Name { <span>get</span>; <span>set</span>; }<p> &nbsp;&nbsp;&nbsp; [<span>Required</span>]<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>string</span> Text { <span>get</span>; <span>set</span>; }<br>}</p></pre><p>Here is Blazor form that uses out-of-box form validation. I followed same pattern with validation messages that should be familiar at least those who know ASP.NET MVC.</p><pre><span>@page</span>&nbsp;<span>"/"</span><br><span>@</span>using&nbsp; BlazorFormValidation.Models<p> <span>&lt;</span><span>h1</span><span>&gt;</span>My guestbook<span>&lt;/</span><span>h1</span><span>&gt;</span></p><p> <span>&lt;</span><span>p</span><span>&gt;</span>Leave me a message if you like my site<span>&lt;/</span><span>p</span><span>&gt;</span></p><p> <span>&lt;</span><span>EditForm</span>&nbsp;<span>Model</span><span>=</span><span>"</span><span>@</span>Model<span>"</span>&nbsp;<span>OnValidSubmit</span><span>=</span><span>"</span><span>@</span><span>HandleValidSubmit</span><span>"</span>&nbsp;<span>OnInvalidSubmit</span><span>=</span><span>"</span><span>@</span><span>HandleInvalidSubmit</span><span>"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"alert </span><span>@</span>StatusClass<span>"</span><span>&gt;</span><span>@</span>StatusMessage<span>&lt;/</span><span>div</span><span>&gt;</span></p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span>&lt;</span><span>DataAnnotationsValidator</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationSummary</span>&nbsp;<span>/&gt;</span></p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"name"</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputText</span>&nbsp;<span>Id</span><span>=</span><span>"name"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Name<span>"</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Name)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"body"</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputTextArea</span>&nbsp;<span>Id</span><span>=</span><span>"body"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Text<span>"</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Text)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>button</span>&nbsp;<span>type</span><span>=</span><span>"submit"</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span></p><p> <span>&lt;/</span><span>EditForm</span><span>&gt;</span></p><p> <span>@code</span>&nbsp;<br><span>{</span><br>&nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>string</span> StatusMessage;<br>&nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>string</span> StatusClass;</p><p> &nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>GuestbookEntry</span> Model = <span>new</span>&nbsp;<span>GuestbookEntry</span>();</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>void</span>&nbsp;<span>HandleValidSubmit</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StatusClass = <span>"alert-info"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StatusMessage = <span>DateTime</span>.Now + <span>" Handle valid submit"</span>;<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>void</span>&nbsp;<span>HandleInvalidSubmit</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StatusClass = <span>"alert-danger"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StatusMessage = <span>DateTime</span>.Now + <span>" Handle invalid submit"</span>;<br>&nbsp;&nbsp;&nbsp; }<br><span>}</span></p></pre><p>EditForm is Blazor container for forms. Validator is added like any other Blazor component. Page above uses DataAnnotationValidator but you can create custom one if you like.</p><p>Here is the screenshot demonstrating form when fields are empty and Ok button is clicked.</p><p><a href="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-failed.png"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-failed_thumb.png.webp" type="image/webp"><img width="1199" height="910" title="Blazor guestbook form is invalid" alt="Blazor guestbook form is invalid" src="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-failed_thumb.png" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-failed_thumb.png"></picture></a></p><p>This is the form with successful validation.</p><p><a href="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-succeeded.png"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-succeeded_thumb.png.webp" type="image/webp"><img width="1196" height="743" title="Blazor guestbook form is valid" alt="Blazor guestbook form is valid" src="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-succeeded_thumb.png" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-succeeded_thumb.png"></picture></a></p><p>I think most of developers will be okay with this solution and I can finish this writing. Or no?</p><h3>Disable button until form is valid</h3><p>We can actually dig deeper and try something fancy. What if we want Ok button to be disabled while form is invalid? I found blog post <a title="Disabling the Submit button in Blazor Validation" href="https://blogs.u2u.be/peter/post/disabling-the-submit-button-in-blazor-with-validation">Disabling the Submit button in Blazor Validation</a> by <a title="Peter Himschoot" href="https://twitter.com/peterhimschoot">Peter Himschoot</a> where he provider solution through custom InputWatcher.</p><p>My solution is smaller. We can assign to EditForm either Model or EditContext but not both at same time. When using EditContext we have way more control over validation. This way I solved the need for additional component.</p><p>I solved button disabled status problem with simple but not so straightforward trick. Instead of boolean true-false value for disabled attribute I went with string. Value is either “disabled” or null. Notice that empty string leaves “disabled” attribute on button. I had to listen to field change event just like Peter did.</p><pre><span>@page</span>&nbsp;<span>"/"</span><br><span>@</span>using&nbsp; BlazorFormValidation.Models<p> <span>&lt;</span><span>h1</span><span>&gt;</span>My guestbook<span>&lt;/</span><span>h1</span><span>&gt;</span></p><p> <span>&lt;</span><span>p</span><span>&gt;</span>Leave me a message if you like my site<span>&lt;/</span><span>p</span><span>&gt;</span></p><p> <span>&lt;</span><span>EditForm</span>&nbsp;<span>EditContext</span><span>=</span><span>"</span><span>@</span>EditContext<span>"</span><span>&gt;</span>&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>DataAnnotationsValidator</span>&nbsp;<span>/&gt;</span></p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"name"</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputText</span>&nbsp;<span>Id</span><span>=</span><span>"name"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Name<span>"</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Name)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"body"</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputTextArea</span>&nbsp;<span>Id</span><span>=</span><span>"body"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Text<span>"</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Text)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>button</span>&nbsp;<span>type</span><span>=</span><span>"submit"</span>&nbsp;<span>disabled</span><span>=</span><span>"</span><span>@</span>OkayDisabled<span>"</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span></p><p> <span>&lt;/</span><span>EditForm</span><span>&gt;</span></p><p> <span>@code</span>&nbsp;<br><span>{</span><br>&nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>EditContext</span> EditContext;<br>&nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>GuestbookEntry</span> Model = <span>new</span>&nbsp;<span>GuestbookEntry</span>();</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>string</span> OkayDisabled { <span>get</span>; <span>set</span>; } = <span>"disabled"</span>;</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>override</span>&nbsp;<span>void</span>&nbsp;<span>OnInit</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EditContext = <span>new</span>&nbsp;<span>EditContext</span>(Model);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EditContext.OnFieldChanged += <span>EditContext_OnFieldChanged</span>;</p><p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>base</span>.<span>OnInit</span>();<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>override</span>&nbsp;<span>void</span>&nbsp;<span>OnAfterRender</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>base</span>.<span>OnAfterRender</span>();</p><p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>SetOkDisabledStatus</span>();<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>void</span>&nbsp;<span>EditContext_OnFieldChanged</span>(<span>object</span>&nbsp;<span>sender</span>, <span>FieldChangedEventArgs</span>&nbsp;<span>e</span>)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>SetOkDisabledStatus</span>();<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>void</span>&nbsp;<span>SetOkDisabledStatus</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>if</span>(EditContext.<span>Validate</span>())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OkayDisabled = <span>null</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OkayDisabled = <span>"disabled"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><span>}</span></p></pre><p>This is how guestbook opens when I run it. Validation messages are shown for fields and Ok button is disabled.</p><p><a href="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-disable-button.png"><picture><source data-srcset="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-disable-button_thumb.png.webp" type="image/webp"><img width="1197" height="886" title="Blazor guestbook: button is disabled if form is invalid" alt="Blazor guestbook: button is disabled if form is invalid" src="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-disable-button_thumb.png" data-src="https://static.gunnarpeipman.com/wp-content/uploads/2019/08/blazor-form-validation-disable-button_thumb.png"></picture></a></p><p>With EditContext class we were able to take form under our control.</p><h3>Inside EditContext class</h3><p>There’s more about EditContext. Take a look at EditContext class definiton.</p><pre><span>public</span>&nbsp;<span>sealed</span>&nbsp;<span>class</span>&nbsp;<span>EditContext</span><br>{<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>EditContext</span>(<span>object</span>&nbsp;<span>model</span>);<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>object</span> Model { <span>get</span>; }<p> &nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>event</span>&nbsp;<span>EventHandler</span>&lt;<span>FieldChangedEventArgs</span>&gt; OnFieldChanged;<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>event</span>&nbsp;<span>EventHandler</span>&lt;<span>ValidationRequestedEventArgs</span>&gt; OnValidationRequested;<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>event</span>&nbsp;<span>EventHandler</span>&lt;<span>ValidationStateChangedEventArgs</span>&gt; OnValidationStateChanged;</p><p> &nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>FieldIdentifier</span>&nbsp;<span>Field</span>(<span>string</span>&nbsp;<span>fieldName</span>);<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>IEnumerable</span>&lt;<span>string</span>&gt; <span>GetValidationMessages</span>();<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>IEnumerable</span>&lt;<span>string</span>&gt; <span>GetValidationMessages</span>(<span>FieldIdentifier</span>&nbsp;<span>fieldIdentifier</span>);<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>bool</span>&nbsp;<span>IsModified</span>();<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>bool</span>&nbsp;<span>IsModified</span>(<span>in</span>&nbsp;<span>FieldIdentifier</span>&nbsp;<span>fieldIdentifier</span>);<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>void</span>&nbsp;<span>MarkAsUnmodified</span>(<span>in</span>&nbsp;<span>FieldIdentifier</span>&nbsp;<span>fieldIdentifier</span>);<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>void</span>&nbsp;<span>MarkAsUnmodified</span>();<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>void</span>&nbsp;<span>NotifyFieldChanged</span>(<span>in</span>&nbsp;<span>FieldIdentifier</span>&nbsp;<span>fieldIdentifier</span>);<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>void</span>&nbsp;<span>NotifyValidationStateChanged</span>();<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>bool</span>&nbsp;<span>Validate</span>();<br>}</p></pre><p>It has events that are triggered for changes. We have methods to mark fields as unmodified, it’s easy to get field ID used bu Blazor and notify EditContext of changes if we need.</p><h3>Check validation status when field changes</h3><p>There’s one more minor thing to solve on our form. When form gets valid I want Ok button to be enabled at same moment and not when I leave the field. This functionality would be great for fields validated by regular expression, by example.</p><p>After some research and hacking I came out with ugly solution using KeyUp event and reflection (I’m sure Blazor guys don’t want you to do it at home). But here my solution is.</p><pre><span>@page</span>&nbsp;<span>"/"</span><br><span>@</span>using&nbsp; BlazorFormValidation.Models<p> <span>&lt;</span><span>h1</span><span>&gt;</span>My guestbook<span>&lt;/</span><span>h1</span><span>&gt;</span></p><p> <span>&lt;</span><span>p</span><span>&gt;</span>Leave me a message if you like my site<span>&lt;/</span><span>p</span><span>&gt;</span></p><p> <span>&lt;</span><span>EditForm</span>&nbsp;<span>EditContext</span><span>=</span><span>"</span><span>@</span>EditContext<span>"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>DataAnnotationsValidator</span>&nbsp;<span>/&gt;</span></p><p> &nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"name"</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputText</span>&nbsp;<span>Id</span><span>=</span><span>"name"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Name<span>"</span>&nbsp;<span>onkeyup</span><span>=</span><span>'</span><span>@(</span><span>e</span> =&gt; KeyUp(<span>e</span>, <span>"Name"</span>)<span>)</span><span>'</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Name)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"body"</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputTextArea</span>&nbsp;<span>Id</span><span>=</span><span>"body"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Text<span>"</span>&nbsp;<span>onkeyup</span><span>=</span><span>'</span><span>@(</span><span>e</span> =&gt; KeyUp(<span>e</span>, <span>"Text"</span>)<span>)</span><span>'</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Text)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>button</span>&nbsp;<span>type</span><span>=</span><span>"submit"</span>&nbsp;<span>disabled</span><span>=</span><span>"</span><span>@</span>OkayDisabled<span>"</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span></p><p> <span>&lt;/</span><span>EditForm</span><span>&gt;</span></p><p> <span>@code</span><br><span>{</span><br>&nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>EditContext</span> EditContext;<br>&nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>GuestbookEntry</span> Model = <span>new</span>&nbsp;<span>GuestbookEntry</span>();</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>string</span> OkayDisabled { <span>get</span>; <span>set</span>; } = <span>"disabled"</span>;</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>override</span>&nbsp;<span>void</span>&nbsp;<span>OnInit</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EditContext = <span>new</span>&nbsp;<span>EditContext</span>(Model);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EditContext.OnFieldChanged += <span>EditContext_OnFieldChanged</span>;</p><p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>base</span>.<span>OnInit</span>();<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>protected</span>&nbsp;<span>override</span>&nbsp;<span>void</span>&nbsp;<span>OnAfterRender</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>base</span>.<span>OnAfterRender</span>();</p><p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>SetOkDisabledStatus</span>();<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>void</span>&nbsp;<span>EditContext_OnFieldChanged</span>(<span>object</span>&nbsp;<span>sender</span>, <span>FieldChangedEventArgs</span>&nbsp;<span>e</span>)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>SetOkDisabledStatus</span>();<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>void</span>&nbsp;<span>KeyUp</span>(<span>UIKeyboardEventArgs</span>&nbsp;<span>e</span>, <span>string</span>&nbsp;<span>memberName</span>)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>var</span>&nbsp;<span>property</span> = Model.<span>GetType</span>().<span>GetProperty</span>(<span>memberName</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>var</span>&nbsp;<span>value</span> = <span>property</span>.<span>GetValue</span>(Model);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>property</span>.<span>SetValue</span>(Model, <span>value</span> + <span>e</span>.Key);</p><p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>var</span>&nbsp;<span>id</span> = EditContext.<span>Field</span>(<span>memberName</span>);</p><p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EditContext.<span>NotifyFieldChanged</span>(<span>id</span>);<br>&nbsp;&nbsp;&nbsp; }</p><p> &nbsp;&nbsp;&nbsp; <span>private</span>&nbsp;<span>void</span>&nbsp;<span>SetOkDisabledStatus</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>if</span> (EditContext.<span>Validate</span>())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OkayDisabled = <span>null</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>else</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OkayDisabled = <span>"disabled"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><span>}</span></p></pre><p>It’s a small thing but users will love it. We just made our form even more responsive.</p><h3>Using other validators</h3><p>I found <a title="Using FluentValidation for Forms Validation in Blazor" href="https://chrissainty.com/using-fluentvalidation-for-forms-validation-in-razor-components/">FluentValidation support for Blazor</a> by <a title="Chris Sainty @ Twitter" href="https://twitter.com/chris_sainty">Chris Sainty</a>. <a title="FluentValidation" href="https://fluentvalidation.net/" rel="nofollow">FluentValidation</a> is popular validation library that supports also advanced validation scenarios.</p><p>With FluentValidation we use validator classes like the one shown here.</p><pre><span>public</span>&nbsp;<span>class</span>&nbsp;<span>GuestbookEntryValidator</span> : <span>AbstractValidator</span>&lt;<span>GuestbookEntry</span>&gt;<br>{<br>&nbsp;&nbsp;&nbsp; <span>public</span>&nbsp;<span>GuestbookEntryValidator</span>()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>RuleFor</span>(<span>e</span> =&gt; <span>e</span>.Name)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<span>NotEmpty</span>().<span>WithMessage</span>(<span>"Name is required"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<span>MaximumLength</span>(10).<span>WithMessage</span>(<span>"10 characters maximum"</span>);<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>RuleFor</span>(<span>e</span> =&gt; <span>e</span>.Text)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<span>NotEmpty</span>().<span>WithMessage</span>(<span>"Text is required"</span>);<br>&nbsp;&nbsp;&nbsp; }<br>}</p></pre><p>Our form doesn’t change much. We just have to change validator component.</p><pre><span>&lt;</span><span>EditForm</span>&nbsp;<span>EditContext</span><span>=</span><span>"</span><span>@</span>EditContext<span>"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>FluentValidationValidator</span>&nbsp;<span>/&gt;</span><p> &nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"name"</span><span>&gt;</span>Name: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputText</span>&nbsp;<span>Id</span><span>=</span><span>"name"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Name<span>"</span><span>&gt;&lt;/</span><span>InputText</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Name)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>div</span>&nbsp;<span>class</span><span>=</span><span>"form-group"</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>label</span>&nbsp;<span>for</span><span>=</span><span>"body"</span><span>&gt;</span>Text: <span>&lt;/</span><span>label</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>InputTextArea</span>&nbsp;<span>Id</span><span>=</span><span>"body"</span>&nbsp;<span>Class</span><span>=</span><span>"form-control"</span>&nbsp;<span>@</span><span>bind-Value</span><span>=</span><span>"</span><span>@</span>Model.Text<span>"</span><span>&gt;&lt;/</span><span>InputTextArea</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>ValidationMessage</span>&nbsp;<span>For</span><span>=</span><span>"</span><span>@</span>(() =&gt; Model.Text)<span>"</span>&nbsp;<span>/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;/</span><span>div</span><span>&gt;</span><br>&nbsp;&nbsp;&nbsp; <span>&lt;</span><span>button</span>&nbsp;<span>type</span><span>=</span><span>"submit"</span>&nbsp;<span>disabled</span><span>=</span><span>"</span><span>@</span>OkayDisabled<span>"</span><span>&gt;</span>Ok<span>&lt;/</span><span>button</span><span>&gt;</span></p><p> <span>&lt;/</span><span>EditForm</span><span>&gt;</span></p></pre><p>Now we can use full power of FluentValidator on our forms. Check out FluentValidationValidator souce code from Github repository <a title="chrissainty/FluentValidationWithRazorComponents" href="https://github.com/chrissainty/FluentValidationWithRazorComponents" rel="nofollow">chrissainty/FluentValidationWithRazorComponents</a>.</p><h3>Wrapping up</h3><p>There’s two ways how to go with validation on Blazor. We can use Model property of EditForm and keep things simple for us. If we need more control over validation and UI then we can provide EditContext to EditForm. Those who want to go deep to internals can see how Christ Sainty integrated FluentValidation to Blazor. Although there can be changes to form validation over coming releases of Blazor we can still start building our own advanced components to use with Blazor applications.</p></div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>