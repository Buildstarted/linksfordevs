<!DOCTYPE html>
<html lang="en">
<head>
    <title>
What Is a Cholesky Factorization? - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="What Is a Cholesky Factorization? - linksfor.dev(s)"/>
    <meta property="article:author" content="Posted on"/>
    <meta property="og:description" content="The Cholesky factorization of a symmetric positive definite matrix $LATEX A$ is the factorization $LATEX A = R^T!R$, where $LATEX R$ is upper triangular with positive diagonal elements. It is a ge&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://nhigham.com/2020/08/11/what-is-a-cholesky-factorization/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - What Is a Cholesky Factorization?</title>
<div class="readable">
        <h1>What Is a Cholesky Factorization?</h1>
            <div>by Posted on</div>
            <div>Reading time: 6-7 minutes</div>
        <div>Posted here: 11 Aug 2020</div>
        <p><a href="https://nhigham.com/2020/08/11/what-is-a-cholesky-factorization/">https://nhigham.com/2020/08/11/what-is-a-cholesky-factorization/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>
						<p>The Cholesky factorization of a symmetric positive definite matrix <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A"> is the factorization <img src="https://s0.wp.com/latex.php?latex=A+%3D+R%5ET%5C%21R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A = R^T\!R" title="A = R^T\!R">, where <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R" title="R"> is upper triangular with positive diagonal elements. It is a generalization of the property that a positive real number has a unique positive square root. The Cholesky factorization always exists and the requirement that the diagonal of <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R" title="R"> be positive ensures that it is unique.</p>
<p>As an example, the Cholesky factorization of the <img src="https://s0.wp.com/latex.php?latex=4%5Ctimes+4&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="4\times 4" title="4\times 4"> matrix with <img src="https://s0.wp.com/latex.php?latex=%28i%2Cj%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="(i,j)" title="(i,j)"> element <img src="https://s0.wp.com/latex.php?latex=%5Cgcd%28i%2Cj%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\gcd(i,j)" title="\gcd(i,j)"> (<code>gallery('gcdmat',4)</code> in MATLAB) is</p>
<p> <img src="https://s0.wp.com/latex.php?latex=G_4+%3D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+1+%26+1+%26+1+%26+1%5C%5C+1+%26+2+%26+1+%26+2%5C%5C+1+%26+1+%26+3+%26+1%5C%5C+1+%26+2+%26+1+%26+4+%5Cend%7Barray%7D%5Cright%5D+%3D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+1+%26+0+%26+0+%26+0%5C%5C+1+%26+1+%26+0+%26+0%5C%5C+1+%26+0+%26+%5Csqrt%7B2%7D+%26+0%5C%5C+1+%26+1+%26+0+%26+%5Csqrt%7B2%7D+%5Cend%7Barray%7D%5Cright%5D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+1+%26+1+%26+1+%26+1%5C%5C+0+%26+1+%26+0+%26+1%5C%5C+0+%26+0+%26+%5Csqrt%7B2%7D+%26+0%5C%5C+0+%26+0+%26+0+%26+%5Csqrt%7B2%7D+%5Cend%7Barray%7D%5Cright%5D.+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="G_4 = \left[\begin{array}{cccc} 1 &amp; 1 &amp; 1 &amp; 1\\ 1 &amp; 2 &amp; 1 &amp; 2\\ 1 &amp; 1 &amp; 3 &amp; 1\\ 1 &amp; 2 &amp; 1 &amp; 4 \end{array}\right] = \left[\begin{array}{cccc} 1 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; 0\\ 1 &amp; 0 &amp; \sqrt{2} &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; \sqrt{2} \end{array}\right] \left[\begin{array}{cccc} 1 &amp; 1 &amp; 1 &amp; 1\\ 0 &amp; 1 &amp; 0 &amp; 1\\ 0 &amp; 0 &amp; \sqrt{2} &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; \sqrt{2} \end{array}\right]. " title="G_4 = \left[\begin{array}{cccc} 1 &amp; 1 &amp; 1 &amp; 1\\ 1 &amp; 2 &amp; 1 &amp; 2\\ 1 &amp; 1 &amp; 3 &amp; 1\\ 1 &amp; 2 &amp; 1 &amp; 4 \end{array}\right] = \left[\begin{array}{cccc} 1 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; 0\\ 1 &amp; 0 &amp; \sqrt{2} &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; \sqrt{2} \end{array}\right] \left[\begin{array}{cccc} 1 &amp; 1 &amp; 1 &amp; 1\\ 0 &amp; 1 &amp; 0 &amp; 1\\ 0 &amp; 0 &amp; \sqrt{2} &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; \sqrt{2} \end{array}\right]. "></p>
<p>The Cholesky factorization of an <img src="https://s0.wp.com/latex.php?latex=n%5Ctimes+n&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="n\times n" title="n\times n"> matrix contains <img src="https://s0.wp.com/latex.php?latex=n-1&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="n-1" title="n-1"> other Cholesky factorizations within it: <img src="https://s0.wp.com/latex.php?latex=A_k+%3D+R_k%5ETR_k&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A_k = R_k^TR_k" title="A_k = R_k^TR_k">, <img src="https://s0.wp.com/latex.php?latex=k%3D1%3An-1&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="k=1:n-1" title="k=1:n-1">, where <img src="https://s0.wp.com/latex.php?latex=A_k+%3D+A%281%5Ccolon+k%2C1%5Ccolon+k%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A_k = A(1\colon k,1\colon k)" title="A_k = A(1\colon k,1\colon k)"> is the leading principal submatrix of order <img src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="k" title="k">. For example, for <img src="https://s0.wp.com/latex.php?latex=G_4&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="G_4" title="G_4"> with <img src="https://s0.wp.com/latex.php?latex=k+%3D+2&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="k = 2" title="k = 2">, <img src="https://s0.wp.com/latex.php?latex=%5Cbigl%5B%5Cbegin%7Bsmallmatrix%7D1+%26+1%5C%5C+1%26+2%5Cend%7Bsmallmatrix%7D%5Cbigr%5D%3D++%5Cbigl%5B%5Cbegin%7Bsmallmatrix%7D1+%26+0%5C%5C+1%26+1%5Cend%7Bsmallmatrix%7D%5Cbigr%5D++%5Cbigl%5B%5Cbegin%7Bsmallmatrix%7D1+%26+1%5C%5C+0%26+1%5Cend%7Bsmallmatrix%7D%5Cbigr%5D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\bigl[\begin{smallmatrix}1 &amp; 1\\ 1&amp; 2\end{smallmatrix}\bigr]=  \bigl[\begin{smallmatrix}1 &amp; 0\\ 1&amp; 1\end{smallmatrix}\bigr]  \bigl[\begin{smallmatrix}1 &amp; 1\\ 0&amp; 1\end{smallmatrix}\bigr]" title="\bigl[\begin{smallmatrix}1 &amp; 1\\ 1&amp; 2\end{smallmatrix}\bigr]=  \bigl[\begin{smallmatrix}1 &amp; 0\\ 1&amp; 1\end{smallmatrix}\bigr]  \bigl[\begin{smallmatrix}1 &amp; 1\\ 0&amp; 1\end{smallmatrix}\bigr]">.</p>
<p>Inverting the Cholesky equation gives <img src="https://s0.wp.com/latex.php?latex=A%5E%7B-1%7D+%3D+R%5E%7B-1%7D+R%5E%7B-T%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A^{-1} = R^{-1} R^{-T}" title="A^{-1} = R^{-1} R^{-T}">, which implies the interesting relation that the <img src="https://s0.wp.com/latex.php?latex=%28n%2Cn%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="(n,n)" title="(n,n)"> element of <img src="https://s0.wp.com/latex.php?latex=A%5E%7B-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A^{-1}" title="A^{-1}"> is <img src="https://s0.wp.com/latex.php?latex=r_%7Bnn%7D%5E%7B-2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="r_{nn}^{-2}" title="r_{nn}^{-2}">. So <img src="https://s0.wp.com/latex.php?latex=G_4%5E%7B-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="G_4^{-1}" title="G_4^{-1}"> has <img src="https://s0.wp.com/latex.php?latex=%284%2C4%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="(4,4)" title="(4,4)"> element <img src="https://s0.wp.com/latex.php?latex=1%2F2&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="1/2" title="1/2">. We also have <img src="https://s0.wp.com/latex.php?latex=%5Cdet%28A%29+%3D+%5Cdet%28R%29%5E2+%3D+%28r_%7B11%7D%5Cdots+r_%7Bnn%7D%29%5E2&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\det(A) = \det(R)^2 = (r_{11}\dots r_{nn})^2" title="\det(A) = \det(R)^2 = (r_{11}\dots r_{nn})^2">, so <img src="https://s0.wp.com/latex.php?latex=%5Cdet%28G_4%29+%3D+4&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\det(G_4) = 4" title="\det(G_4) = 4"> for this matrix.</p>
<p>The Cholesky factorization is named after André-Louis Cholesky (1875–1918), a French military officer involved in geodesy and surveying in Crete and North Africa, who developed it for solving the normal equations arising in least squares problems.</p>
<p>The existence and uniqueness of the factorization can be proved by induction on <img src="https://s0.wp.com/latex.php?latex=n&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="n" title="n">, and the proof also serves as a method for computing it. Partition <img src="https://s0.wp.com/latex.php?latex=A%5Cin%5Cmathbb%7BR%7D%5E%7Bn%5Ctimes+n%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A\in\mathbb{R}^{n\times n}" title="A\in\mathbb{R}^{n\times n}"> as</p>
<p> <img src="https://s0.wp.com/latex.php?latex=A+%3D+%5Cbegin%7Bbmatrix%7D++++++++++++++A_%7Bn-1%7D+%26+c+%5C%5C++++++++++++++c%5ET+%26+%5Calpha++++++++++++++%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A = \begin{bmatrix}              A_{n-1} &amp; c \\              c^T &amp; \alpha              \end{bmatrix}. " title="A = \begin{bmatrix}              A_{n-1} &amp; c \\              c^T &amp; \alpha              \end{bmatrix}. "></p>
<p> We know that <img src="https://s0.wp.com/latex.php?latex=A_%7Bn-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A_{n-1}" title="A_{n-1}"> is positive definite (any principal submatrix of a positive definite matrix is easily shown to be positive definite). Assume that <img src="https://s0.wp.com/latex.php?latex=A_%7Bn-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A_{n-1}" title="A_{n-1}"> has a unique Cholesky factorization <img src="https://s0.wp.com/latex.php?latex=A_%7Bn-1%7D+%3D+R_%7Bn-1%7D%5ETR_%7Bn-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A_{n-1} = R_{n-1}^TR_{n-1}" title="A_{n-1} = R_{n-1}^TR_{n-1}"> and define the upper triangular matrix</p>
<p> <img src="https://s0.wp.com/latex.php?latex=R+%3D+%5Cbegin%7Bbmatrix%7D+++++++++++++R_%7Bn-1%7D+%26+r+%5C%5C+++++++++++++0+%26+%5Cbeta++++++++++++%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R = \begin{bmatrix}             R_{n-1} &amp; r \\             0 &amp; \beta            \end{bmatrix}. " title="R = \begin{bmatrix}             R_{n-1} &amp; r \\             0 &amp; \beta            \end{bmatrix}. "></p>
<p> Then</p>
<p> <img src="https://s0.wp.com/latex.php?latex=R%5ET%5C%21R+%3D+%5Cbegin%7Bbmatrix%7D++++++++++++++++R_%7Bn-1%7D%5ET+R_%7Bn-1%7D+%26+R_%7Bn-1%7D%5ET+r+%5C%5C++++++++++++++++++++r%5ET+R_%7Bn-1%7D+++%26+r%5ETr+%2B+%5Cbeta%5E2++++++++++++++%5Cend%7Bbmatrix%7D%2C+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R^T\!R = \begin{bmatrix}                R_{n-1}^T R_{n-1} &amp; R_{n-1}^T r \\                    r^T R_{n-1}   &amp; r^Tr + \beta^2              \end{bmatrix}, " title="R^T\!R = \begin{bmatrix}                R_{n-1}^T R_{n-1} &amp; R_{n-1}^T r \\                    r^T R_{n-1}   &amp; r^Tr + \beta^2              \end{bmatrix}, "></p>
<p> which equals <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A"> if and only if</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Baligned%7D+++++++++++++++++++R_%7Bn-1%7D%5ET+r++++%26%3D+c%2C++++++++%5C%5C+++++++++++++++++++r%5ETr+%2B+%5Cbeta%5E2+%26%3D+%5Calpha.+++++%5Cend%7Baligned%7D+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\begin{aligned}                   R_{n-1}^T r    &amp;= c,        \\                   r^Tr + \beta^2 &amp;= \alpha.     \end{aligned} " title="\begin{aligned}                   R_{n-1}^T r    &amp;= c,        \\                   r^Tr + \beta^2 &amp;= \alpha.     \end{aligned} "></p>
<p> The first equation  has a unique solution since <img src="https://s0.wp.com/latex.php?latex=R_%7Bn-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R_{n-1}" title="R_{n-1}"> is nonsingular. Then the second equation gives <img src="https://s0.wp.com/latex.php?latex=%5Cbeta%5E2+%3D+%5Calpha+-+r%5ETr&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\beta^2 = \alpha - r^Tr" title="\beta^2 = \alpha - r^Tr">. It remains to check that there is a unique real, positive <img src="https://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\beta" title="\beta"> satisfying this equation. From the inequality</p>
<p> <img src="https://s0.wp.com/latex.php?latex=0+%3C+%5Cdet%28A%29+%3D+%5Cdet%28R%5ET%29+%5Cdet%28R%29+%3D+%5Cdet%28R_%7Bn-1%7D%29%5E2+%5Cbeta%5E2+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="0 < \det(A) = \det(R^T) \det(R) = \det(R_{n-1})^2 \beta^2 " title="0 < \det(A) = \det(R^T) \det(R) = \det(R_{n-1})^2 \beta^2 "></p>
<p> we see that <img src="https://s0.wp.com/latex.php?latex=%5Cbeta%5E2%3E0&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\beta^2>0" title="\beta^2>0">, hence there is a unique <img src="https://s0.wp.com/latex.php?latex=%5Cbeta%3E0&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\beta>0" title="\beta>0">. This completes the inductive step.</p>
<p>The quantity <img src="https://s0.wp.com/latex.php?latex=%5Calpha+-+r%5ETr+%3D+%5Calpha+-+c%5ET+A_%7Bn-1%7D%5E%7B-1%7Dc&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\alpha - r^Tr = \alpha - c^T A_{n-1}^{-1}c" title="\alpha - r^Tr = \alpha - c^T A_{n-1}^{-1}c"> is the Schur complement of <img src="https://s0.wp.com/latex.php?latex=A_%7Bn-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A_{n-1}" title="A_{n-1}"> in <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A">.  The essential reason why Cholesky factorization works is that the Schur complements of a positive definite matrix are themselves positive definite. Indeed we have the congruence</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Bbmatrix%7D+I++++++++++++++++++%26+0+%5C%5C++-c%5ET+A_%7Bn-1%7D%5E%7B-1%7D+%26+1+%5Cend%7Bbmatrix%7D+%5Cbegin%7Bbmatrix%7D+A_%7Bn-1%7D++++++++++%26+c+%5C%5C+c%5ET+++++++++++++++%26+%5Calpha+%5Cend%7Bbmatrix%7D+%5Cbegin%7Bbmatrix%7D+I++%26+-A_%7Bn-1%7D%5E%7B-1%7Dc%5C%5C+0++%26+1+%5Cend%7Bbmatrix%7D++%3D+%5Cbegin%7Bbmatrix%7D+A_%7Bn-1%7D+%26+0+%5C%5C+0++++++%26+%5Calpha+-+c%5ET+A_%7Bn-1%7D%5E%7B-1%7D+c+%5Cend%7Bbmatrix%7D%2C+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\begin{bmatrix} I                  &amp; 0 \\  -c^T A_{n-1}^{-1} &amp; 1 \end{bmatrix} \begin{bmatrix} A_{n-1}          &amp; c \\ c^T               &amp; \alpha \end{bmatrix} \begin{bmatrix} I  &amp; -A_{n-1}^{-1}c\\ 0  &amp; 1 \end{bmatrix}  = \begin{bmatrix} A_{n-1} &amp; 0 \\ 0      &amp; \alpha - c^T A_{n-1}^{-1} c \end{bmatrix}, " title="\begin{bmatrix} I                  &amp; 0 \\  -c^T A_{n-1}^{-1} &amp; 1 \end{bmatrix} \begin{bmatrix} A_{n-1}          &amp; c \\ c^T               &amp; \alpha \end{bmatrix} \begin{bmatrix} I  &amp; -A_{n-1}^{-1}c\\ 0  &amp; 1 \end{bmatrix}  = \begin{bmatrix} A_{n-1} &amp; 0 \\ 0      &amp; \alpha - c^T A_{n-1}^{-1} c \end{bmatrix}, "></p>
<p> and since congruences preserve definiteness it follows that <img src="https://s0.wp.com/latex.php?latex=%5Calpha+-+c%5ET+A_%7Bn-1%7D%5E%7B-1%7D+c+%3E+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\alpha - c^T A_{n-1}^{-1} c > 0" title="\alpha - c^T A_{n-1}^{-1} c > 0">.</p>
<p>In textbooks it is common to see element-level equations for computing the Cholesky factorization, which come from directly solving the matrix equation <img src="https://s0.wp.com/latex.php?latex=A+%3D+R%5ET%5C%21R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A = R^T\!R" title="A = R^T\!R">. If we equate elements on both sides, taking them a column at a time, starting with <img src="https://s0.wp.com/latex.php?latex=a_%7B11%7D+%3D+r_%7B11%7D%5E2&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="a_{11} = r_{11}^2" title="a_{11} = r_{11}^2">, then the following algorithm is obtained:</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Barray%7D%7Bl%7D+1%7E+%5Cmbox%7Bfor%7D%7Ej%3D1%3An++%5C%5C+2%7E++++++%5Cquad+%5Cmbox%7Bfor%7D%7E++i%3D1%3Aj-1+%5C%5C+3%7E+++++%5Cqquad+r_%7Bij%7D+%3D+%5Cbigl%28a_%7Bij%7D+-+%5Csum_%7Bk%3D1%7D%5E%7Bi-1%7D+r_%7Bki%7Dr_%7Bkj%7D+%5Cbigr%29+%2Fr_%7Bii%7D+%5C%5C+4%7E+++++%5Cquad+%5Cmbox%7Bend%7D+%5C%5C+5%7E+++++%5Cquad+r_%7Bjj%7D+%3D+%5Cbigl%28a_%7Bjj%7D+-+%5Csum_%7Bk%3D1%7D%5E%7Bj-1%7D+r_%7Bkj%7D%5E2%5Cbigr%29%5E%7B1%2F2%7D+%5C%5C+6%7E+%5Cmbox%7Bend%7D+%5Cend%7Barray%7D+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\begin{array}{l} 1~ \mbox{for}~j=1:n  \\ 2~      \quad \mbox{for}~  i=1:j-1 \\ 3~     \qquad r_{ij} = \bigl(a_{ij} - \sum_{k=1}^{i-1} r_{ki}r_{kj} \bigr) /r_{ii} \\ 4~     \quad \mbox{end} \\ 5~     \quad r_{jj} = \bigl(a_{jj} - \sum_{k=1}^{j-1} r_{kj}^2\bigr)^{1/2} \\ 6~ \mbox{end} \end{array} " title="\begin{array}{l} 1~ \mbox{for}~j=1:n  \\ 2~      \quad \mbox{for}~  i=1:j-1 \\ 3~     \qquad r_{ij} = \bigl(a_{ij} - \sum_{k=1}^{i-1} r_{ki}r_{kj} \bigr) /r_{ii} \\ 4~     \quad \mbox{end} \\ 5~     \quad r_{jj} = \bigl(a_{jj} - \sum_{k=1}^{j-1} r_{kj}^2\bigr)^{1/2} \\ 6~ \mbox{end} \end{array} "></p>
<p>What happens if this algorithm is executed on a general (indefinite) symmetric matrix that is, one that has both positive and negative eigenvalues? Line 5 will either attempt to take the square root of a negative number for some <img src="https://s0.wp.com/latex.php?latex=j&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="j" title="j"> or it will produce <img src="https://s0.wp.com/latex.php?latex=r_%7Bjj%7D+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="r_{jj} = 0" title="r_{jj} = 0"> and on the next iteration of the loop we will have a division by zero. In floating-point arithmetic it is possible for the algorithm to fail for a positive definite matrix, but only if it is numerically singular: the algorithm is guaranteed to run to completion if the condition number <img src="https://s0.wp.com/latex.php?latex=%5Ckappa_2%28A%29+%3D+%5C%7CA%5C%7C_2+%5C%7CA%5E%7B-1%7D%5C%7C_2&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\kappa_2(A) = \|A\|_2 \|A^{-1}\|_2" title="\kappa_2(A) = \|A\|_2 \|A^{-1}\|_2"> is safely less than <img src="https://s0.wp.com/latex.php?latex=u%5E%7B-1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="u^{-1}" title="u^{-1}">, where <img src="https://s0.wp.com/latex.php?latex=u&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="u" title="u"> is the unit roundoff.</p>
<p>The MATLAB function <code>chol</code> normally returns an error message if the factorization fails. But a second output argument can be requested, which is set to the number of the stage on which the factorization failed, or to zero if the factorization succeeded. In the case of failure, the partially computed <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R" title="R"> factor, returned in the first argument, can be used to compute a direction of negative curvature for <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A">, which is a vector <img src="https://s0.wp.com/latex.php?latex=z&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="z" title="z"> such that <img src="https://s0.wp.com/latex.php?latex=z%5ET%5C%21Az+%3C+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="z^T\!Az < 0" title="z^T\!Az < 0">. Here is an example. The code</p>
<div>

<pre id="nil">n = 8;
A = gallery('lehmer',n) - 0.3*eye(n); % Indefinite matrix.
[R,p] = chol(A)
z = [-R\(R'\A(1:p-1,p)); 1; zeros(n-p,1)];
neg_curve = z'*A*z
</pre>
</div>
<p>produces the output</p>
<div>

<pre id="nil">R =
   8.3666e-01   5.9761e-01   3.9841e-01
            0   5.8554e-01   7.3193e-01
            0            0   7.4536e-02
p =
     4
neg_curve =
  -9.1437e+00
</pre>
</div>
<p>Cholesky factorization has excellent numerical stability. The computed factor <img src="https://s0.wp.com/latex.php?latex=%5Cwidehat%7BR%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\widehat{R}" title="\widehat{R}"> satisfies</p>
<p> <img src="https://s0.wp.com/latex.php?latex=A++%2B+%5CDelta+A+%3D+%5Cwidehat%7BR%7D%5ET%5Cwidehat%7BR%7D%2C+%5Cquad+++++++%5C%7C%5CDelta+A%5C%7C_2+%5Cle+c_nu%5C%7CA%5C%7C_2%2C+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A  + \Delta A = \widehat{R}^T\widehat{R}, \quad       \|\Delta A\|_2 \le c_nu\|A\|_2, " title="A  + \Delta A = \widehat{R}^T\widehat{R}, \quad       \|\Delta A\|_2 \le c_nu\|A\|_2, "></p>
<p> where <img src="https://s0.wp.com/latex.php?latex=c_n&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="c_n" title="c_n"> is a constant. Unlike for LU factorization there is no possibility of element growth; indeed for <img src="https://s0.wp.com/latex.php?latex=i%5Cle+j&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="i\le j" title="i\le j">,</p>
<p> <img src="https://s0.wp.com/latex.php?latex=r_%7Bij%7D%5E2+%5Cle+%5Cdisplaystyle+%5Csum_%7Bk%3D1%7D%5Ej+r_%7Bkj%7D%5E2+%3D+a_%7Bij%7D%2C+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="r_{ij}^2 \le \displaystyle \sum_{k=1}^j r_{kj}^2 = a_{ij}, " title="r_{ij}^2 \le \displaystyle \sum_{k=1}^j r_{kj}^2 = a_{ij}, "></p>
<p> so the elements of <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R" title="R"> are nicely bounded relative to those of <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A">.</p>
<p>Once we have a Cholesky factorization we can use it to solve a linear system <img src="https://s0.wp.com/latex.php?latex=Ax+%3D+b&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="Ax = b" title="Ax = b">, by solving the lower triangular system <img src="https://s0.wp.com/latex.php?latex=R%5ETy+%3D+b&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R^Ty = b" title="R^Ty = b"> and then the upper triangular system <img src="https://s0.wp.com/latex.php?latex=Rx+%3D+y&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="Rx = y" title="Rx = y">. The computed solution <img src="https://s0.wp.com/latex.php?latex=%5Cwidehat%7Bx%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\widehat{x}" title="\widehat{x}"> can be shown to satisfy</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%28A%2B%5CDelta+A%29%5Cwidehat%7Bx%7D+%3D+b%2C+%5Cquad+%5C%7C%5CDelta+A%5C%7C_2+%5Cle+d_nu%5C%7CA%5C%7C_2+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="(A+\Delta A)\widehat{x} = b, \quad \|\Delta A\|_2 \le d_nu\|A\|_2 " title="(A+\Delta A)\widehat{x} = b, \quad \|\Delta A\|_2 \le d_nu\|A\|_2 "></p>
<p> where <img src="https://s0.wp.com/latex.php?latex=d_n&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="d_n" title="d_n"> is another constant. Thus <img src="https://s0.wp.com/latex.php?latex=%5Cwidehat%7Bx%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\widehat{x}" title="\widehat{x}"> has a small backward error.</p>
<p>Finally, what if <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A"> is only symmetric positive semidefinite, that is, <img src="https://s0.wp.com/latex.php?latex=x%5ET%5C%21Ax+%5Cge+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="x^T\!Ax \ge 0" title="x^T\!Ax \ge 0"> for all <img src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="x" title="x">, so that <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A"> is possibly singular? There always exists a Cholesky factorization (we can take the <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R" title="R"> factor in the QR factorization of the positive semidefinite square root of <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A">) but it may not be unique. For example, we have</p>
<p> <img src="https://s0.wp.com/latex.php?latex=A+%3D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D++1+%26+1+%26+1+%26+1%5C%5C++1+%26+1+%26+1+%26+1%5C%5C++1+%26+1+%26+2+%26+2%5C%5C++1+%26+1+%26+2+%26+4%5C%5C+%5Cend%7Barray%7D%5Cright%5D+%3D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+1+%26+0+%26+0+%26+0%5C%5C+1+%26+0+%26+0+%26+0%5C%5C+1+%26+1+%26+0+%26+0%5C%5C+1+%26+1+%26+x+%26+y%5C%5C+%5Cend%7Barray%7D%5Cright%5D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+1+%26+1+%26+1+%26+1%5C%5C+0+%26+0+%26+1+%26+1%5C%5C+0+%26+0+%26+0+%26+x%5C%5C+0+%26+0+%26+0+%26+y%5C%5C+%5Cend%7Barray%7D%5Cright%5D++%3D+R%5ET%5C%21R+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A = \left[\begin{array}{cccc}  1 &amp; 1 &amp; 1 &amp; 1\\  1 &amp; 1 &amp; 1 &amp; 1\\  1 &amp; 1 &amp; 2 &amp; 2\\  1 &amp; 1 &amp; 2 &amp; 4\\ \end{array}\right] = \left[\begin{array}{cccc} 1 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; x &amp; y\\ \end{array}\right] \left[\begin{array}{cccc} 1 &amp; 1 &amp; 1 &amp; 1\\ 0 &amp; 0 &amp; 1 &amp; 1\\ 0 &amp; 0 &amp; 0 &amp; x\\ 0 &amp; 0 &amp; 0 &amp; y\\ \end{array}\right]  = R^T\!R " title="A = \left[\begin{array}{cccc}  1 &amp; 1 &amp; 1 &amp; 1\\  1 &amp; 1 &amp; 1 &amp; 1\\  1 &amp; 1 &amp; 2 &amp; 2\\  1 &amp; 1 &amp; 2 &amp; 4\\ \end{array}\right] = \left[\begin{array}{cccc} 1 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; x &amp; y\\ \end{array}\right] \left[\begin{array}{cccc} 1 &amp; 1 &amp; 1 &amp; 1\\ 0 &amp; 0 &amp; 1 &amp; 1\\ 0 &amp; 0 &amp; 0 &amp; x\\ 0 &amp; 0 &amp; 0 &amp; y\\ \end{array}\right]  = R^T\!R "></p>
<p> for any <img src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="x" title="x"> and <img src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="y" title="y"> such that <img src="https://s0.wp.com/latex.php?latex=x%5E2+%2B+y%5E2+%3D+2&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="x^2 + y^2 = 2" title="x^2 + y^2 = 2">. Note that <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A"> has rank 3 but <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R" title="R"> has two zero diagonal elements. When <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A"> is positive semidefinite of rank <img src="https://s0.wp.com/latex.php?latex=r&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="r" title="r"> what is usually wanted is a Cholesky factorization in which <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="R" title="R"> is zero in its last <img src="https://s0.wp.com/latex.php?latex=n-r&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="n-r" title="n-r"> rows. Such a factorization can be obtained by using complete pivoting, which at each stage permutes the largest remaining diagonal element into the pivot position, which gives a factorization</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5CPi%5ET%5Cmskip-5mu+A%5CPi+%3D+R%5ET%5C%21R%2C++++++%5Cquad++++++R+%3D+%5Cbegin%7Bbmatrix%7D++++++++++R_%7B11%7D+%26+R_%7B12%7D+%5C%5C+++++++++++++++0+%26+0++++++++++%5Cend%7Bbmatrix%7D%2C+%5Cquad+R_%7B11%7D%5Cin%5Cmathbb%7BR%7D%5E%7Br+%5Ctimes+r%7D%2C+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\Pi^T\mskip-5mu A\Pi = R^T\!R,      \quad      R = \begin{bmatrix}          R_{11} &amp; R_{12} \\               0 &amp; 0          \end{bmatrix}, \quad R_{11}\in\mathbb{R}^{r \times r}, " title="\Pi^T\mskip-5mu A\Pi = R^T\!R,      \quad      R = \begin{bmatrix}          R_{11} &amp; R_{12} \\               0 &amp; 0          \end{bmatrix}, \quad R_{11}\in\mathbb{R}^{r \times r}, "></p>
<p> where <img src="https://s0.wp.com/latex.php?latex=%5CPi&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\Pi" title="\Pi"> is a permutation matrix. For example, with <img src="https://s0.wp.com/latex.php?latex=%5CPi&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\Pi" title="\Pi"> the identity matrix with its columns in reverse order,</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5CPi%5ET%5Cmskip-5mu+A%5CPi++%3D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+4+%26+2+%26+1+%26+1%5C%5C+2+%26+2+%26+1+%26+1%5C%5C+1+%26+1+%26+1+%26+1%5C%5C+1+%26+1+%26+1+%26+1+%5Cend%7Barray%7D%5Cright%5D++++%3D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+2+%26+0+%26+0+%26+0%5C%5C+1+%26+1+%26+0+%26+0%5C%5C+%5Cfrac%7B1%7D%7B2%7D+%26+%5Cfrac%7B1%7D%7B2%7D+%26+%5Cfrac%7B%5Csqrt%7B2%7D%7D%7B2%7D+%26+0%5C%5C%5B2pt%5D+%5Cfrac%7B1%7D%7B2%7D+%26+%5Cfrac%7B1%7D%7B2%7D+%26+%5Cfrac%7B%5Csqrt%7B2%7D%7D%7B2%7D+%26+0+%5Cend%7Barray%7D%5Cright%5D+%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D+2+%26+1+%26+%5Cfrac%7B1%7D%7B2%7D+%26+%5Cfrac%7B1%7D%7B2%7D%5C%5C%5B2pt%5D+0+%26+1+%26+%5Cfrac%7B1%7D%7B2%7D+%26+%5Cfrac%7B1%7D%7B2%7D%5C%5C%5B2pt%5D+0+%26+0+%26+%5Cfrac%7B%5Csqrt%7B2%7D%7D%7B2%7D+%26+%5Cfrac%7B%5Csqrt%7B2%7D%7D%7B2%7D%5C%5C+0+%26+0+%26+0+%26+0+%5Cend%7Barray%7D%5Cright%5D%2C+&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="\Pi^T\mskip-5mu A\Pi  = \left[\begin{array}{cccc} 4 &amp; 2 &amp; 1 &amp; 1\\ 2 &amp; 2 &amp; 1 &amp; 1\\ 1 &amp; 1 &amp; 1 &amp; 1\\ 1 &amp; 1 &amp; 1 &amp; 1 \end{array}\right]    = \left[\begin{array}{cccc} 2 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; 0\\ \frac{1}{2} &amp; \frac{1}{2} &amp; \frac{\sqrt{2}}{2} &amp; 0\\[2pt] \frac{1}{2} &amp; \frac{1}{2} &amp; \frac{\sqrt{2}}{2} &amp; 0 \end{array}\right] \left[\begin{array}{cccc} 2 &amp; 1 &amp; \frac{1}{2} &amp; \frac{1}{2}\\[2pt] 0 &amp; 1 &amp; \frac{1}{2} &amp; \frac{1}{2}\\[2pt] 0 &amp; 0 &amp; \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{2}}{2}\\ 0 &amp; 0 &amp; 0 &amp; 0 \end{array}\right], " title="\Pi^T\mskip-5mu A\Pi  = \left[\begin{array}{cccc} 4 &amp; 2 &amp; 1 &amp; 1\\ 2 &amp; 2 &amp; 1 &amp; 1\\ 1 &amp; 1 &amp; 1 &amp; 1\\ 1 &amp; 1 &amp; 1 &amp; 1 \end{array}\right]    = \left[\begin{array}{cccc} 2 &amp; 0 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; 0\\ \frac{1}{2} &amp; \frac{1}{2} &amp; \frac{\sqrt{2}}{2} &amp; 0\\[2pt] \frac{1}{2} &amp; \frac{1}{2} &amp; \frac{\sqrt{2}}{2} &amp; 0 \end{array}\right] \left[\begin{array}{cccc} 2 &amp; 1 &amp; \frac{1}{2} &amp; \frac{1}{2}\\[2pt] 0 &amp; 1 &amp; \frac{1}{2} &amp; \frac{1}{2}\\[2pt] 0 &amp; 0 &amp; \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{2}}{2}\\ 0 &amp; 0 &amp; 0 &amp; 0 \end{array}\right], "></p>
<p> which clearly displays the rank of <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=333333&amp;s=0" alt="A" title="A">.</p>
<div id="outline-container-orgb19b0fe">
<h2 id="orgb19b0fe">References</h2>
<div id="text-orgb19b0fe">
<p> This is a minimal set of references, which contain further useful references within.</p>
<ul>
<li>Claude Brezinski, <a href="https://doi.org/10.1007/s11075-006-9059-x">The Life and Work of André Cholesky</a>, Numer. Algorithms 43, 279–288, 2006.</li>
<li>Nicholas J. Higham, <a href="https://doi.org/10.1002/wics.18">Cholesky factorization</a>, WIREs Comp. Stat. 1(2), 251–254, 2009.</li>
<li>Nicholas J. Higham, <a href="http://www.maths.manchester.ac.uk/~higham/asna/index.php">Accuracy and Stability of Numerical Algorithms</a>, second edition, Society for Industrial and Applied Mathematics, Philadelphia, PA, USA, 2002.   Chapter 10.</li>
</ul>
</div>
</div>

											</div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>