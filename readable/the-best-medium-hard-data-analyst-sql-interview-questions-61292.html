<!DOCTYPE html>
<html lang="en">
<head>
    <title>
The Best Medium-Hard Data Analyst SQL Interview Questions - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="The Best Medium-Hard Data Analyst SQL Interview Questions - linksfor.dev(s)"/>
    <meta property="og:description" content="By Zachary Thomas (zthomas.nc@gmail.com, Twitter,&#xA0;LinkedIn)&#xA0;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://quip.com/2gwZArKuWk7W"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - The Best Medium-Hard Data Analyst SQL Interview Questions</title>
<div class="readable">
        <h1>The Best Medium-Hard Data Analyst SQL Interview Questions</h1>
            <div>Reading time: 10-13 minutes</div>
        <div>Posted here: 02 May 2020</div>
        <p><a href="https://quip.com/2gwZArKuWk7W">https://quip.com/2gwZArKuWk7W</a></p>
        <hr/>
<div id="readability-page-1" class="page"><article tabindex="0" data-gramm="false" contenteditable="false" data-pending-incremental-render-text="Loading…"><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACACXOea" data-section-style="1" data-section-type="0" role="heading" aria-level="1" aria-label="The Best Medium-Hard Data Analyst SQL Interview Questions &nbsp;, in document editor"><p>The Best Medium-Hard Data Analyst SQL Interview Questions &nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAYPfwi" data-section-style="0" data-section-type="0"><p><b>Tip: </b>See the Table of Contents (document outline) by hovering over the vertical line on the right side of the page&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA2g5er" data-section-style="16" data-section-type="0" role="region" aria-label="Blockquote"><p>The first 70% of SQL is pretty straightforward but the remaining 30% can be pretty tricky.</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAKZa0g" data-section-style="0" data-section-type="0"><p>Between the fall of 2015 and the summer of 2019 I interviewed for data analyst and data scientists positions four separate times, getting to onsite interviews at over a dozen companies. After an interview in 2017 went poorly — mostly due to me floundering at the more difficult SQL questions they asked me — I started putting together a study guide of medium and hard SQL questions to better prepare and found it particularly useful during my 2019 interview cycle. Over the past year I have shared that guide with a couple of friends, and with the extra time on my hands due to the coronavirus pandemic, I have polished it up into this doc.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAKR7Vk" data-section-style="0" data-section-type="0"><p>There are plenty of great beginner SQL guides out there. My favorites are Codecademy’s&nbsp;<a href="https://www.codecademy.com/learn/learn-sql" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿interactive SQL courses﻿</a> and Zi Chong Kao’s <a href="https://selectstarsql.com/" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿Select Star SQL﻿</a>. However, like I told a friend, while the first 70% of SQL is pretty straightforward, the remaining 30% can be pretty tricky. Data analyst and data scientist interview questions at technology companies often pull from that 30%. &nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA5gSEb" data-section-style="0" data-section-type="0"><p>Strangely, I have never really found a comprehensive source online for those medium-hard SQL questions, which is why I put together this guide.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAHVf0I" data-section-style="0" data-section-type="0"><p>Working through this guide should improve your performance on data analyst interviews. It should also make you better at your current and future job positions. Personally, I find some of the SQL patterns found in this doc useful for ETLs powering reporting tools featuring trends over time.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACApH5Ob" data-section-style="0" data-section-type="0"><p>To be clear, data analyst and data scientist interviews consist of more than SQL questions. Other common topics include explaining past projects, A/B testing, metric development and open-ended analytical problems. This <a href="https://qr.ae/pNrdGV" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿Quora answer﻿</a>&nbsp;has Facebook’s product analyst interview guide circa 2017, which discusses this topic in more depth. That said, if improving your SQL skills can make your interviews less stressful than they already are, it could very well be worth your time.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAfeJ9p" data-section-style="0" data-section-type="0"><p>In the future, I may transition this doc to a website like&nbsp;<a href="https://selectstarsql.com/" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿Select Star SQL﻿</a>&nbsp;with an embedded SQL editor so that readers can write SQL statements to questions and get real-time feedback on their code. Another option could be adding these questions as problems on Leetcode. For the time being though I just wanted to publish this doc so that people could find it useful now. &nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA3DtQJ" data-section-style="0" data-section-type="0"><p><b>I would love to get your feedback on this doc. Please drop a note if you find this useful, have improvements/corrections, or encounter other good resources for medium/hard difficulty SQL questions.&nbsp;</b></p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAEjWv1" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>Assumptions &amp; How to use this guide&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAK12Qe" data-section-style="0" data-section-type="0"><p><b>Assumptions about SQL proficiency:&nbsp;</b>This guide assumes you have a working knowledge of SQL. You probably use it frequently at work already but want to sharpen your skills on topics like self-joins and window functions.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA6QyaD" data-section-style="0" data-section-type="0"><p><b>How to use this guide:</b> Since interviews usually utilize a whiteboard or a virtual (non-compiling) notepad, my recommendation is to get out a pencil and paper and write out your solutions to each part of the problem, and once complete compare your answers to the answer key. Or, complete these with a friend who can act as the interviewer!</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAheLCp" data-section-style="5" data-section-type="1"><div data-id="WbZACAheLCp"><div data-contextmenu="section-context-menu"><ul role="presentation"><li role="listitem" id="list-item-e-56" data-indent="0" aria-level="1"><editorui contenteditable="false"></editorui><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA88Aw3" data-section-style="0" data-section-type="0"><p>Small SQL syntax errors aren’t a big deal during whiteboard/notepad interviews. However, they can distracting to the interviewer, so ideally practice reducing these so your logic shines through in the interview.&nbsp;</p></div></li><li role="listitem" id="list-item-e-55" data-indent="0" aria-level="1"><editorui contenteditable="false"></editorui><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACArh2wq" data-section-style="0" data-section-type="0"><p>The answers I provide may not be the only way to successfully solve the question. Feel free to message with additional solutions and I can add them to this guide!&nbsp;</p></div></li></ul><editorui contenteditable="false"></editorui></div></div></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA1LBwg" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>Tips on solving difficult SQL interview questions&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAZ1seX" data-section-style="0" data-section-type="0"><p>This advice mirrors typical code interview advice ...&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA5xF3S" data-section-style="6" data-section-type="1"><div data-id="WbZACA5xF3S"><div data-contextmenu="section-context-menu"><ul role="presentation"><li role="listitem" id="list-item-e-51" data-indent="0" aria-level="1"><editorui contenteditable="false"></editorui><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA6ooAW" data-section-style="0" data-section-type="0"><p>Listen carefully to problem description, repeat back the crux of the problem to the interviewer</p></div></li><li role="listitem" id="list-item-e-50" data-indent="0" aria-level="1"><editorui contenteditable="false"></editorui><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAID8Y6" data-section-style="0" data-section-type="0"><p>Spell out an edge case to demonstrate you actually understand problem (i.e. a row that <i>wouldn’t</i> be included in the output of the SQL you are about to sketch out)&nbsp;</p></div></li><li role="listitem" id="list-item-e-49" data-indent="0" aria-level="1"><editorui contenteditable="false"></editorui><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAZ5SNS" data-section-style="0" data-section-type="0"><p>(If the problem involves a self-join) For your own benefit sketch out what the self-join will look like&nbsp;— this will typically be at least three columns: a column of interest from the main table, the column to join from the main table, and the column to join from the secondary table&nbsp;</p></div></li><li role="listitem" id="list-item-e-48" data-indent="1" aria-level="2" data-indent-start="1"><editorui contenteditable="false"></editorui><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAW6TaV" data-section-style="0" data-section-type="0"><p>Or, as you get more used to self-join problems, you can explain this step verbally&nbsp;</p></div></li><li role="listitem" id="list-item-e-47" data-indent="0" aria-level="1"><editorui contenteditable="false"></editorui><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAJ06ww" data-section-style="0" data-section-type="0"><p>Start writing SQL&nbsp;— err towards writing SQL versus trying to perfectly understand the problem. Verbalize your assumptions as you go so your interviewer can correct you if you go astray.&nbsp;</p></div></li></ul><editorui contenteditable="false"></editorui></div></div></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAc1wRf" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>Acknowledgments and Additional Resources&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAi2vbO" data-section-style="0" data-section-type="0"><p>Some of the problems listed here are adapted from old Periscope blog posts (mostly written around 2014 by&nbsp;<a href="https://www.linkedin.com/in/seangcook/" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿Sean Cook﻿</a>, although his authorship seems to have been removed from the posts following SiSense's&nbsp;<a href="https://www.sisense.com/blog/sisense-and-periscope-data-merge-2/" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿merger with﻿</a> Periscope) or discussions from Stack Overflow; I've noted them at the start of questions as appropriate.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA56Wo4" data-section-style="1" data-section-type="0" role="heading" aria-level="1"><p>Self-Join Practice Problems&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAtzLJd" data-section-style="0" data-section-type="0"><p><b>Context:</b>&nbsp;Oftentimes it's useful to know how much a key metric, such as monthly active users, changes between months. Say we have a table&nbsp;<code spellcheck="false">logins</code>&nbsp;in the form:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAvDVwy" data-section-style="0" data-section-type="0"><p><b>Task</b>: Find the MoM percentage change for MAU.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAakdFL" data-section-style="0" data-section-type="0"><p><i>(This solution, like other solution code blocks you will see in this doc, contains comments about SQL syntax that may differ between flavors of SQL or other comments about the solutions as listed)&nbsp;</i></p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAA6gik" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>#2: Tree Structure Labeling &nbsp;&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA3O2J0" data-section-style="0" data-section-type="0"><p><b>Context:</b> Say you have a table&nbsp;<code spellcheck="false">tree</code>&nbsp;with a column of nodes and a column corresponding parent nodes&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAx6ybe" data-section-style="0" data-section-type="0"><p><b>Task:</b> Write SQL such that we label each node as a&nbsp;“leaf”,&nbsp;“inner” or&nbsp;“Root” node, such that for the nodes above we get:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA859Zx" data-section-style="0" data-section-type="0"><p>(Side note: <a href="http://ceadserv1.nku.edu/longa//classes/mat385_resources/docs/trees.html" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿this link﻿</a>&nbsp;has more details on Tree data structure terminology. Not needed to solve the problem though!)</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAv9dgl" data-section-style="0" data-section-type="0"><p>An alternate solution, without explicit joins:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAAd42s" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>#3:&nbsp;Retained Users Per Month (multi-part)</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAPzWAy" data-section-style="0" data-section-type="0"><p><b>Context:</b> Say we have login data in the table&nbsp;<code spellcheck="false">logins</code>:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAGOHB8" data-section-style="0" data-section-type="0"><p><b>Task:</b> Write a query that gets the number of retained users per month.&nbsp;In this case, retention for a given month is defined as the number of users who logged in that month who also logged in the immediately previous month.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAwDPdh" data-section-style="0" data-section-type="0"><p><b>Task:</b> Now we’ll take retention and turn it on its head: Write a query to find many users last month&nbsp;<i>did not</i> come back this month. i.e. the number of churned users. &nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAbkCT2" data-section-style="0" data-section-type="0"><p>Note that there are solutions to this problem that can use <code spellcheck="false">LEFT</code>&nbsp;or <code spellcheck="false">RIGHT</code>&nbsp;joins.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAQ1jfR" data-section-style="0" data-section-type="0"><p><b>Note:</b>&nbsp;this question is probably more complex than the kind you would encounter in an interview. Consider it a challenge problem, or feel free to skip it!</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACArmmto" data-section-style="0" data-section-type="0"><p><b>Context</b>: Good work on the previous two problems! Data engineering has decided to give you a helping hand by creating a table of churned users per month, <code spellcheck="false">user_churns</code>. If a user is active last month but then not active this month, then that user gets an entry for this month. <code spellcheck="false">user_churns</code>&nbsp;has the form:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA3TlrM" data-section-style="0" data-section-type="0"><p><b>Task</b>: You now want to do a cohort analysis of active users this month <i>who have been reactivated users in the past</i>. Create a table that contains these users. You may use the tables&nbsp;<code spellcheck="false">user_churns</code> as well as&nbsp;<code spellcheck="false">logins</code>&nbsp;to create this cohort. In Postgres, the current timestamp is available through&nbsp;<code spellcheck="false">current_timestamp</code>.</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAQdgIy" data-section-style="0" data-section-type="0"><p><b>Context:</b> Say we have a table&nbsp;<code spellcheck="false">transactions</code>&nbsp;in the form:</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAQKnVe" data-section-style="0" data-section-type="0"><p>Where <code spellcheck="false">cash_flow</code>&nbsp;is the revenues minus costs for each day.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAxYnf4" data-section-style="0" data-section-type="0"><p><b>Task: </b>Write a query to get&nbsp;<i>cumulative</i>&nbsp;cash flow for each day such that we end up with a table in the form below:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAFRykT" data-section-style="0" data-section-type="0"><p><b>Note:</b> there are different ways to compute rolling/moving averages. Here we'll use a preceding average which means that the metric for the 7th day of the month would be the average of the preceding 6 days and that day itself.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA7Ywn5" data-section-style="0" data-section-type="0"><p><b>Context</b>: Say we have table&nbsp;<code spellcheck="false">signups</code> in the form:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAHDmEy" data-section-style="0" data-section-type="0"><p><b>Task</b>: Write a query to get 7-day rolling (preceding) average of daily sign ups.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAKDZyA" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>#6: Multiple Join Conditions&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAVbVbs" data-section-style="0" data-section-type="0"><p><b>Context:</b>&nbsp;Say we have a table&nbsp;<code spellcheck="false">emails</code>&nbsp;that includes emails sent to and from <a href="mailto:zach@g.com" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿<code spellcheck="false">zach@g.com</code>﻿</a>:</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAUBDfD" data-section-style="0" data-section-type="0"><p><b>Task:&nbsp;</b>Write a query to get the response time per email (<code spellcheck="false">id</code>) sent to&nbsp;<code spellcheck="false">zach@g.com</code>&nbsp;. Do not include <code spellcheck="false">id</code>s that did not receive a response from <a href="mailto:zach@g.com" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿zach@g.com﻿</a>. Assume each email thread has a unique subject. Keep in mind a thread may have multiple responses back-and-forth between <a href="mailto:zach@g.com" target="_blank" rel="nofollow noreferrer" spellcheck="false">﻿zach@g.com﻿</a>&nbsp;and another email address.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAJfSdu" data-section-style="1" data-section-type="0" role="heading" aria-level="1"><p>Window Function Practice Problems&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAhKm2A" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>#1: Get the ID with the highest value&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAjlA4Z" data-section-style="0" data-section-type="0"><p><b>Context:</b> Say we have a table&nbsp;<code spellcheck="false">salaries</code>&nbsp;with data on employee salary and department in the following format:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAxKPaU" data-section-style="0" data-section-type="0"><p><b>Task</b>:&nbsp;Write a query to get the <code spellcheck="false">empno</code>&nbsp;with the highest salary. Make sure your solution can handle ties!</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAY4cPT" data-section-style="0" data-section-type="0"><p>Alternate solution using <code spellcheck="false">RANK()</code>:</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAk945J" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>#2: Average and rank with a window function (multi-part)</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAbHXUD" data-section-style="0" data-section-type="0"><p><b>Context</b>: Say we have a table&nbsp;<code spellcheck="false">salaries</code> in the format:</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAJ1gkH" data-section-style="0" data-section-type="0"><p><b>Task:</b> Write a query that returns the same table, but with a new column that has average salary per&nbsp;<code spellcheck="false">depname</code>. We would expect a table in the form:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAaqw3U" data-section-style="0" data-section-type="0"><p><b>Task:</b> Write a query that adds a column with the rank of each employee based on their salary within their department, where the employee with the highest salary gets the rank of&nbsp;<code spellcheck="false">1</code>.&nbsp;We would expect a table in the form:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA2jo2x" data-section-style="1" data-section-type="0" role="heading" aria-level="1"><p>Other Medium/Hard SQL Practice Problems&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAWfACW" data-section-style="0" data-section-type="0"><p><b>Context:</b> Say we have a table&nbsp;<code spellcheck="false">sessions</code>&nbsp;where each row is a video streaming session with length in seconds:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAMrakB" data-section-style="0" data-section-type="0"><p><b>Task:</b> Write a query to count the number of sessions that fall into bands of size 5, i.e. for the above snippet, produce something akin to:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAFLowa" data-section-style="0" data-section-type="0"><p>Get complete credit for the proper string labels (“5-10”, etc.) but near complete credit for something that is communicable as the bin.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA0JsbB" data-section-style="2" data-section-type="0" role="heading" aria-level="2"><p>#2: CROSS JOIN (multi-part)</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAxl8X7" data-section-style="0" data-section-type="0"><p><b>Context:</b> Say we have a table&nbsp;<code spellcheck="false">state_streams</code>&nbsp;where each row is a state and the total number of hours of streaming from a video hosting service:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAaXXip" data-section-style="0" data-section-type="0"><p>(In reality these kinds of aggregate tables would normally have a date column, but we’ll exclude that component in this problem)&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAUqV1W" data-section-style="0" data-section-type="0"><p><b>Task:</b> Write a query to get the pairs of states with total streaming amounts within 1000 of each other. For the snippet above, we would want to see something like:</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAFCMoB" data-section-style="0" data-section-type="0"><p>FYI, <code spellcheck="false">CROSS JOIN</code>&nbsp;s can also be written without explicitly specifying a join:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAe56nk" data-section-style="0" data-section-type="0"><p><b>Note:</b> This question is considered more of a bonus problem than an actual SQL pattern. Feel free to skip it!</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAuWGFB" data-section-style="0" data-section-type="0"><p><b>Task:</b>&nbsp;How could you modify the SQL from the solution to Part 1 of this question so that duplicates are removed? For example, if we used the sample table from Part 1, the pair <code spellcheck="false">NC</code>&nbsp;and <code spellcheck="false">SC</code>&nbsp;should only appear in one row instead of two.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAchsMN" data-section-style="0" data-section-type="0"><p><b>Note:</b> this question is probably more complex than the kind you would encounter in an interview. Consider it a challenge problem, or feel free to skip it!&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAfqLND" data-section-style="0" data-section-type="0"><p><b>Context: </b>Say I have a table&nbsp;<code spellcheck="false">table</code>&nbsp;in the following form, where a <code spellcheck="false">user</code> can be mapped to multiple values of&nbsp;<code spellcheck="false">class</code>:</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAQJhCc" data-section-style="0" data-section-type="0"><p><b>Task:</b> Assume there are only two possible values for&nbsp;<code spellcheck="false">class</code>. Write a query to count the number of users in each class such that any user who has label&nbsp;<code spellcheck="false">a</code> and <code spellcheck="false">b</code> gets sorted into <code spellcheck="false">b</code>, any user with just <code spellcheck="false">a</code> gets sorted into <code spellcheck="false">a</code> and any user with just <code spellcheck="false">b</code> gets into <code spellcheck="false">b</code>.&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACAuMGUI" data-section-style="0" data-section-type="0"><p>For <code spellcheck="false">table</code> that would result in the following table:&nbsp;</p></div><div data-click="section" data-clicktrack="0" data-mousedown="section" data-paste="section" data-copy="section" data-cut="section" data-id="WbZACA5sSI9" data-section-style="0" data-section-type="0"><p>Alternate solution: Using <code spellcheck="false">SELECT</code>s in the <code spellcheck="false">SELECT</code>&nbsp;statement and <code spellcheck="false">UNION</code>:&nbsp;</p></div></article></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs" /></noscript>
</body>
</html>