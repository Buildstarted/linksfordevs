<!DOCTYPE html>
<html lang="en">
<head>
    <title>
google/randen: Fast backtracking-resistant random generator: https://arxiv.org/abs/1810.02227 -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>google/randen: Fast backtracking-resistant random generator: https://arxiv.org/abs/1810.02227</h1><div><div id="" class="markdown-body entry-content p-5"><h2><a id="user-content-overview" class="anchor" aria-hidden="true" href="#overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h2><p>What if we could default to attack-resistant random generators without excessive
CPU cost? We introduce 'Randen', a new generator with security guarantees; it
outperforms MT19937, pcg64_c32, Philox, ISAAC and ChaCha8 in real-world
benchmarks. This is made possible by AES hardware acceleration and a large
Feistel permutation.</p><h2><a id="user-content-related-work" class="anchor" aria-hidden="true" href="#related-work"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Related work</h2><p>AES-CTR (encrypting a counter) is a well-known and easy to implement generator.
It has two known weaknesses:</p><ul><li><p>A known-key distinguisher on 10-round, 128-bit AES [<a href="https://goo.gl/3xReB9" rel="nofollow">https://goo.gl/3xReB9</a>].</p></li><li><p>No forward security/backtracking resistance: compromising the current state
lets attackers distinguish prior outputs from random.</p></li></ul><p>NIST 800-90a r1 [<a href="https://goo.gl/68Fwmv" rel="nofollow">https://goo.gl/68Fwmv</a>] is a standardized generator that ensures
backtracking resistance, but is not fast enough for a general-purpose generator
(5-10x slower than AES).</p><h2><a id="user-content-algorithm" class="anchor" aria-hidden="true" href="#algorithm"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Algorithm</h2><p>The Randen generator is based upon three existing components:</p><ol><li><p>Reverie [<a href="https://eprint.iacr.org/2016/886.pdf" rel="nofollow">https://eprint.iacr.org/2016/886.pdf</a>] is a sponge-like generator
that requires a cryptographic permutation. It improves upon "Provably Robust
Sponge-Based PRNGs and KDFs" by achieving backtracking resistance with only
a single permutation per buffer.</p></li><li><p>Simpira v2 [<a href="https://eprint.iacr.org/2016/122.pdf" rel="nofollow">https://eprint.iacr.org/2016/122.pdf</a>] constructs up to 1024-bit
permutations using an improved Generalized Feistel network with 2-round
AES-128 functions. This Feistel block shuffle achieves diffusion sooner and
is less vulnerable to sliced-biclique attacks than a Type-2 cyclic shuffle.</p></li><li><p>"New criterion for diffusion property" [<a href="https://goo.gl/mLXH4f" rel="nofollow">https://goo.gl/mLXH4f</a>] shows that
the same kind of improved Feistel block shuffle can be extended to 16
branches, which enables a more efficient 2048-bit permutation.</p></li></ol><p>We combine these by plugging the larger Simpira-like permutation into Reverie.</p><h2><a id="user-content-performance" class="anchor" aria-hidden="true" href="#performance"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Performance</h2><p>The implementation targets x86 (Westmere), POWER 8 and ARM64.</p><p>x86 microbenchmark: generating random bits in a tight loop
(cpb=cycles per byte, MAD=median absolute deviation):</p><table><thead><tr><th>RNG</th><th>cpb</th><th>MAD</th></tr></thead><tbody><tr><td>Randen</td><td>1.54</td><td>0.002</td></tr><tr><td>pcg64_c32</td><td>0.78</td><td>0.003</td></tr><tr><td>mt19937_64</td><td>1.79</td><td>0.001</td></tr><tr><td>ChaCha8</td><td>3.02</td><td>0.003</td></tr><tr><td>ISAAC</td><td>4.08</td><td>0.006</td></tr><tr><td>Philox</td><td>4.70</td><td>0.003</td></tr><tr><td>/dev/urandom (ChaCha20)</td><td>15.27</td><td>0.018</td></tr><tr><td>BCryptGenRandom (CTR-DRBG)</td><td>16.80</td><td>0.009</td></tr></tbody></table><p>x86 real-world benchmark (reservoir sampling):</p><table><thead><tr><th>RNG</th><th>cpb</th><th>MAD</th></tr></thead><tbody><tr><td>Randen</td><td>2.60</td><td>0.008</td></tr><tr><td>pcg64_c32</td><td>3.03</td><td>0.009</td></tr><tr><td>mt19937_64</td><td>2.82</td><td>0.009</td></tr><tr><td>ChaCha8</td><td>3.75</td><td>0.008</td></tr><tr><td>ISAAC</td><td>4.46</td><td>0.014</td></tr><tr><td>Philox</td><td>4.95</td><td>0.009</td></tr><tr><td>/dev/urandom (ChaCha20)</td><td>13.46</td><td>0.017</td></tr><tr><td>BCryptGenRandom (CTR-DRBG)</td><td>16.41</td><td>0.015</td></tr></tbody></table><h2><a id="user-content-security" class="anchor" aria-hidden="true" href="#security"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Security</h2><p>Randen is indistinguishable from random and backtracking-resistant. For more
details and benchmarks, please see <a href="https://arxiv.org/abs/1810.02227" rel="nofollow">"Randen - fast backtracking-resistant random
generator with AES+Feistel+Reverie"</a>.</p><h2><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage</h2><p><code>make &amp;&amp; bin/randen_benchmark</code></p><p>Note that the code relies on compiler optimizations. Cycles per byte may
increase by factors of 1.6 when compiled with GCC 7.3, and 1.3 with
Clang 4.0.1. This can be mitigated by manually unrolling the loops.</p><h2><a id="user-content-third-party-implementations--bindings" class="anchor" aria-hidden="true" href="#third-party-implementations--bindings"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Third-party implementations / bindings</h2><p>Thanks to Frank Denis for making us aware of these third-party implementations
or bindings. Note that the algorithm is still under review and subject to
change, but please feel free to get in touch or raise an issue and we'll
add yours as well.</p><p>This is not an official Google product.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>