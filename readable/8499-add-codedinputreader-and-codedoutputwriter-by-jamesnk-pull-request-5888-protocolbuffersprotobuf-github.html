<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Add CodedInputReader and CodedOutputWriter by JamesNK &#xB7; Pull Request #5888 &#xB7; protocolbuffers/protobuf &#xB7; GitHub -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Add CodedInputReader and CodedOutputWriter by JamesNK · Pull Request #5888 · protocolbuffers/protobuf · GitHub</h1><div><div id="" class="d-block comment-body markdown-body  js-comment-body"><p>FTR, these are the performance results I got at commit <a class="commit-link" data-hovercard-type="commit" data-hovercard-url="https://github.com/protocolbuffers/protobuf/commit/bdf9f1abf7a085eb2b12e22777c3dc482359db69/hovercard" href="https://github.com/protocolbuffers/protobuf/commit/bdf9f1abf7a085eb2b12e22777c3dc482359db69"><tt>bdf9f1a</tt></a>.<br>As said before, the result, the SerializationBenchmark scenarios are a bit hard to interpret (and it's not clear why there is GoogleMessage1 scenarios vs the google_message1_proto3.pb) aren't  necessarily super representative (odd choice of fields that get serialized), but for now they are good enough to get some idea about how the performance of the buffer vs non-buffer serialization comparison - we can put some more effort into choosing the right set of microbenchmarks in the future.</p><p>BenchmarkDotNet=v0.12.0, OS=debian rodete<br>Intel Xeon CPU 2.30GHz, 1 CPU, 8 logical and 4 physical cores<br>.NET Core SDK=3.0.100<br>[Host]     : .NET Core 3.0.0 (CoreCLR 4.700.19.46205, CoreFX 4.700.19.46214), X64 RyuJIT<br>DefaultJob : .NET Core 3.0.0 (CoreCLR 4.700.19.46205, CoreFX 4.700.19.46214), X64 RyuJIT</p><table><thead><tr><th>Method</th><th align="right">Mean</th><th align="right">Error</th><th align="right">StdDev</th><th align="right">Gen 0</th><th align="right">Gen 1</th><th align="right">Gen 2</th><th align="right">Allocated</th></tr></thead><tbody><tr><td>ParseWrapperFieldsFromByteArray</td><td align="right">824.9 ns</td><td align="right">16.22 ns</td><td align="right">33.86 ns</td><td align="right">0.0792</td><td align="right">-</td><td align="right">-</td><td align="right">1864 B</td></tr><tr><td>ParseWrapperFieldsFromNewByteArray</td><td align="right">958.1 ns</td><td align="right">19.10 ns</td><td align="right">48.95 ns</td><td align="right">0.0839</td><td align="right">-</td><td align="right">-</td><td align="right">1984 B</td></tr><tr><td>ParseWrapperFieldsFromReadOnlySequence</td><td align="right">1,059.5 ns</td><td align="right">21.01 ns</td><td align="right">40.48 ns</td><td align="right">0.0744</td><td align="right">-</td><td align="right">-</td><td align="right">1776 B</td></tr><tr><td>ParsePrimitiveFieldsFromByteArray</td><td align="right">484.2 ns</td><td align="right">9.80 ns</td><td align="right">26.66 ns</td><td align="right">0.0429</td><td align="right">-</td><td align="right">-</td><td align="right">1024 B</td></tr><tr><td>ParsePrimitiveFieldsFromNewByteArray</td><td align="right">607.9 ns</td><td align="right">12.21 ns</td><td align="right">34.03 ns</td><td align="right">0.0477</td><td align="right">-</td><td align="right">-</td><td align="right">1128 B</td></tr><tr><td>ParsePrimitiveFieldsFromReadOnlySequence</td><td align="right">595.3 ns</td><td align="right">11.92 ns</td><td align="right">19.91 ns</td><td align="right">0.0391</td><td align="right">-</td><td align="right">-</td><td align="right">936 B</td></tr></tbody></table><p>BenchmarkDotNet=v0.12.0, OS=debian rodete<br>Intel Xeon CPU 2.30GHz, 1 CPU, 8 logical and 4 physical cores<br>.NET Core SDK=3.0.100<br>[Host]     : .NET Core 3.0.0 (CoreCLR 4.700.19.46205, CoreFX 4.700.19.46214), X64 RyuJIT<br>DefaultJob : .NET Core 3.0.0 (CoreCLR 4.700.19.46205, CoreFX 4.700.19.46214), X64 RyuJIT</p><table><thead><tr><th>Method</th><th>Configuration</th><th align="right">Mean</th><th align="right">Error</th><th align="right">StdDev</th><th align="right">Median</th><th align="right">Gen 0</th><th align="right">Gen 1</th><th align="right">Gen 2</th><th align="right">Allocated</th></tr></thead><tbody><tr><td>WriteToStream</td><td>GoogleMessage1 Empty</td><td align="right">585.96 ns</td><td align="right">17.070 ns</td><td align="right">49.250 ns</td><td align="right">582.43 ns</td><td align="right">0.1764</td><td align="right">0.0019</td><td align="right">-</td><td align="right">4168 B</td></tr><tr><td>WriteToBufferWriter</td><td>GoogleMessage1 Empty</td><td align="right">67.92 ns</td><td align="right">1.343 ns</td><td align="right">1.437 ns</td><td align="right">68.09 ns</td><td align="right">-</td><td align="right">-</td><td align="right">-</td><td align="right">-</td></tr><tr><td>WriteToPipeWriter</td><td>GoogleMessage1 Empty</td><td align="right">564.02 ns</td><td align="right">11.339 ns</td><td align="right">22.115 ns</td><td align="right">574.54 ns</td><td align="right">0.0029</td><td align="right">-</td><td align="right">-</td><td align="right">88 B</td></tr><tr><td>ToByteArray</td><td>GoogleMessage1 Empty</td><td align="right">138.83 ns</td><td align="right">2.734 ns</td><td align="right">5.068 ns</td><td align="right">140.89 ns</td><td align="right">0.0029</td><td align="right">-</td><td align="right">-</td><td align="right">72 B</td></tr><tr><td>ParseFromByteString</td><td>GoogleMessage1 Empty</td><td align="right">177.60 ns</td><td align="right">3.574 ns</td><td align="right">5.458 ns</td><td align="right">178.16 ns</td><td align="right">0.0138</td><td align="right">-</td><td align="right">-</td><td align="right">328 B</td></tr><tr><td>ParseFromNewByteString</td><td>GoogleMessage1 Empty</td><td align="right">263.82 ns</td><td align="right">5.347 ns</td><td align="right">9.642 ns</td><td align="right">264.32 ns</td><td align="right">0.0148</td><td align="right">-</td><td align="right">-</td><td align="right">352 B</td></tr><tr><td>ParseFromStream</td><td>GoogleMessage1 Empty</td><td align="right">738.28 ns</td><td align="right">21.937 ns</td><td align="right">64.338 ns</td><td align="right">727.73 ns</td><td align="right">0.1888</td><td align="right">0.0029</td><td align="right">-</td><td align="right">4448 B</td></tr><tr><td>ParseFromReadOnlySequence</td><td>GoogleMessage1 Empty</td><td align="right">245.81 ns</td><td align="right">4.884 ns</td><td align="right">5.624 ns</td><td align="right">246.15 ns</td><td align="right">0.0100</td><td align="right">-</td><td align="right">-</td><td align="right">240 B</td></tr><tr><td>WriteToStream</td><td>GoogleMessage1 Large</td><td align="right">11,719,441.04 ns</td><td align="right">234,300.441 ns</td><td align="right">230,114.362 ns</td><td align="right">11,629,133.75 ns</td><td align="right">-</td><td align="right">-</td><td align="right">-</td><td align="right">528489 B</td></tr><tr><td>WriteToBufferWriter</td><td>GoogleMessage1 Large</td><td align="right">4,592,758.73 ns</td><td align="right">89,795.642 ns</td><td align="right">106,895.324 ns</td><td align="right">4,583,496.78 ns</td><td align="right">-</td><td align="right">-</td><td align="right">-</td><td align="right">-</td></tr><tr><td>WriteToPipeWriter</td><td>GoogleMessage1 Large</td><td align="right">6,565,327.56 ns</td><td align="right">130,412.649 ns</td><td align="right">251,260.900 ns</td><td align="right">6,519,200.16 ns</td><td align="right">304.6875</td><td align="right">164.0625</td><td align="right">23.4375</td><td align="right">4584278 B</td></tr><tr><td>ToByteArray</td><td>GoogleMessage1 Large</td><td align="right">14,947,347.86 ns</td><td align="right">292,638.836 ns</td><td align="right">480,814.000 ns</td><td align="right">14,972,486.84 ns</td><td align="right">218.7500</td><td align="right">218.7500</td><td align="right">62.5000</td><td align="right">4718946 B</td></tr><tr><td>ParseFromByteString</td><td>GoogleMessage1 Large</td><td align="right">13,140,501.88 ns</td><td align="right">254,355.581 ns</td><td align="right">380,707.457 ns</td><td align="right">12,965,723.47 ns</td><td align="right">375.0000</td><td align="right">343.7500</td><td align="right">187.5000</td><td align="right">9438142 B</td></tr><tr><td>ParseFromNewByteString</td><td>GoogleMessage1 Large</td><td align="right">16,797,887.32 ns</td><td align="right">354,764.314 ns</td><td align="right">1,012,162.551 ns</td><td align="right">16,676,895.09 ns</td><td align="right">687.5000</td><td align="right">562.5000</td><td align="right">406.2500</td><td align="right">14156661 B</td></tr><tr><td>ParseFromStream</td><td>GoogleMessage1 Large</td><td align="right">15,055,567.97 ns</td><td align="right">324,534.238 ns</td><td align="right">956,896.523 ns</td><td align="right">15,133,358.80 ns</td><td align="right">562.5000</td><td align="right">437.5000</td><td align="right">281.2500</td><td align="right">10491921 B</td></tr><tr><td>ParseFromReadOnlySequence</td><td>GoogleMessage1 Large</td><td align="right">19,694,659.68 ns</td><td align="right">391,373.734 ns</td><td align="right">996,171.112 ns</td><td align="right">19,679,444.11 ns</td><td align="right">531.2500</td><td align="right">468.7500</td><td align="right">281.2500</td><td align="right">9438683 B</td></tr><tr><td>WriteToStream</td><td>Googl(...)edium [21]</td><td align="right">23,682.87 ns</td><td align="right">446.180 ns</td><td align="right">458.194 ns</td><td align="right">23,642.08 ns</td><td align="right">0.1526</td><td align="right">-</td><td align="right">-</td><td align="right">4168 B</td></tr><tr><td>WriteToBufferWriter</td><td>Googl(...)edium [21]</td><td align="right">9,107.29 ns</td><td align="right">180.560 ns</td><td align="right">301.675 ns</td><td align="right">9,250.01 ns</td><td align="right">-</td><td align="right">-</td><td align="right">-</td><td align="right">-</td></tr><tr><td>WriteToPipeWriter</td><td>Googl(...)edium [21]</td><td align="right">10,558.40 ns</td><td align="right">100.017 ns</td><td align="right">78.087 ns</td><td align="right">10,557.72 ns</td><td align="right">-</td><td align="right">-</td><td align="right">-</td><td align="right">264 B</td></tr><tr><td>ToByteArray</td><td>Googl(...)edium [21]</td><td align="right">24,258.73 ns</td><td align="right">287.744 ns</td><td align="right">255.078 ns</td><td align="right">24,225.96 ns</td><td align="right">0.3662</td><td align="right">-</td><td align="right">-</td><td align="right">9304 B</td></tr><tr><td>ParseFromByteString</td><td>Googl(...)edium [21]</td><td align="right">22,276.26 ns</td><td align="right">340.168 ns</td><td align="right">318.194 ns</td><td align="right">22,225.52 ns</td><td align="right">0.7935</td><td align="right">0.0305</td><td align="right">-</td><td align="right">19040 B</td></tr><tr><td>ParseFromNewByteString</td><td>Googl(...)edium [21]</td><td align="right">24,795.56 ns</td><td align="right">491.308 ns</td><td align="right">735.366 ns</td><td align="right">24,708.33 ns</td><td align="right">1.1902</td><td align="right">0.0305</td><td align="right">-</td><td align="right">28296 B</td></tr><tr><td>ParseFromStream</td><td>Googl(...)edium [21]</td><td align="right">23,531.90 ns</td><td align="right">546.954 ns</td><td align="right">748.677 ns</td><td align="right">23,280.62 ns</td><td align="right">0.9766</td><td align="right">0.0305</td><td align="right">-</td><td align="right">23160 B</td></tr><tr><td>ParseFromReadOnlySequence</td><td>Googl(...)edium [21]</td><td align="right">20,997.95 ns</td><td align="right">359.921 ns</td><td align="right">319.061 ns</td><td align="right">20,971.58 ns</td><td align="right">0.7935</td><td align="right">0.0305</td><td align="right">-</td><td align="right">18952 B</td></tr><tr><td>WriteToStream</td><td>GoogleMessage1 Small</td><td align="right">987.37 ns</td><td align="right">27.209 ns</td><td align="right">80.227 ns</td><td align="right">986.19 ns</td><td align="right">0.1755</td><td align="right">0.0019</td><td align="right">-</td><td align="right">4168 B</td></tr><tr><td>WriteToBufferWriter</td><td>GoogleMessage1 Small</td><td align="right">204.85 ns</td><td align="right">4.088 ns</td><td align="right">4.708 ns</td><td align="right">202.08 ns</td><td align="right">-</td><td align="right">-</td><td align="right">-</td><td align="right">-</td></tr><tr><td>WriteToPipeWriter</td><td>GoogleMessage1 Small</td><td align="right">757.89 ns</td><td align="right">14.577 ns</td><td align="right">19.953 ns</td><td align="right">753.86 ns</td><td align="right">0.0029</td><td align="right">-</td><td align="right">-</td><td align="right">88 B</td></tr><tr><td>ToByteArray</td><td>GoogleMessage1 Small</td><td align="right">374.36 ns</td><td align="right">3.559 ns</td><td align="right">2.778 ns</td><td align="right">373.72 ns</td><td align="right">0.0038</td><td align="right">-</td><td align="right">-</td><td align="right">96 B</td></tr><tr><td>ParseFromByteString</td><td>GoogleMessage1 Small</td><td align="right">560.42 ns</td><td align="right">11.545 ns</td><td align="right">10.234 ns</td><td align="right">559.49 ns</td><td align="right">0.0238</td><td align="right">-</td><td align="right">-</td><td align="right">568 B</td></tr><tr><td>ParseFromNewByteString</td><td>GoogleMessage1 Small</td><td align="right">605.40 ns</td><td align="right">12.066 ns</td><td align="right">25.451 ns</td><td align="right">611.67 ns</td><td align="right">0.0257</td><td align="right">-</td><td align="right">-</td><td align="right">616 B</td></tr><tr><td>ParseFromStream</td><td>GoogleMessage1 Small</td><td align="right">1,299.70 ns</td><td align="right">36.213 ns</td><td align="right">106.776 ns</td><td align="right">1,306.19 ns</td><td align="right">0.1984</td><td align="right">0.0019</td><td align="right">-</td><td align="right">4688 B</td></tr><tr><td>ParseFromReadOnlySequence</td><td>GoogleMessage1 Small</td><td align="right">611.78 ns</td><td align="right">12.147 ns</td><td align="right">19.959 ns</td><td align="right">618.58 ns</td><td align="right">0.0200</td><td align="right">-</td><td align="right">-</td><td align="right">480 B</td></tr><tr><td>WriteToStream</td><td>googl(...)roto3 [22]</td><td align="right">1,447.22 ns</td><td align="right">28.820 ns</td><td align="right">79.378 ns</td><td align="right">1,440.36 ns</td><td align="right">0.1755</td><td align="right">0.0019</td><td align="right">-</td><td align="right">4168 B</td></tr><tr><td>WriteToBufferWriter</td><td>googl(...)roto3 [22]</td><td align="right">621.40 ns</td><td align="right">12.268 ns</td><td align="right">25.336 ns</td><td align="right">627.89 ns</td><td align="right">-</td><td align="right">-</td><td align="right">-</td><td align="right">-</td></tr><tr><td>WriteToPipeWriter</td><td>googl(...)roto3 [22]</td><td align="right">1,173.86 ns</td><td align="right">23.198 ns</td><td align="right">26.715 ns</td><td align="right">1,182.99 ns</td><td align="right">0.0019</td><td align="right">-</td><td align="right">-</td><td align="right">88 B</td></tr><tr><td>ToByteArray</td><td>googl(...)roto3 [22]</td><td align="right">996.30 ns</td><td align="right">19.914 ns</td><td align="right">42.867 ns</td><td align="right">1,009.79 ns</td><td align="right">0.0114</td><td align="right">-</td><td align="right">-</td><td align="right">296 B</td></tr><tr><td>ParseFromByteString</td><td>googl(...)roto3 [22]</td><td align="right">1,105.30 ns</td><td align="right">21.938 ns</td><td align="right">26.115 ns</td><td align="right">1,104.02 ns</td><td align="right">0.0362</td><td align="right">-</td><td align="right">-</td><td align="right">896 B</td></tr><tr><td>ParseFromNewByteString</td><td>googl(...)roto3 [22]</td><td align="right">1,219.48 ns</td><td align="right">24.263 ns</td><td align="right">48.455 ns</td><td align="right">1,226.64 ns</td><td align="right">0.0477</td><td align="right">-</td><td align="right">-</td><td align="right">1152 B</td></tr><tr><td>ParseFromStream</td><td>googl(...)roto3 [22]</td><td align="right">1,919.07 ns</td><td align="right">41.945 ns</td><td align="right">123.019 ns</td><td align="right">1,934.25 ns</td><td align="right">0.2098</td><td align="right">-</td><td align="right">-</td><td align="right">5016 B</td></tr><tr><td>ParseFromReadOnlySequence</td><td>googl(...)roto3 [22]</td><td align="right">1,244.52 ns</td><td align="right">21.112 ns</td><td align="right">18.715 ns</td><td align="right">1,245.06 ns</td><td align="right">0.0343</td><td align="right">-</td><td align="right">-</td><td align="right">808 B</td></tr></tbody></table></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>