<!DOCTYPE html>
<html lang="en">
<head>
    <title>
mfreeborn/heliocron - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="mfreeborn/heliocron - linksfor.dev(s)"/>
    <meta property="og:description" content="A command line application written in Rust capable of delaying execution of other programs for time periods relative to sunrise and sunset. - mfreeborn/heliocron"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/mfreeborn/heliocron"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - mfreeborn/heliocron</title>
<div class="readable">
        <h1>mfreeborn/heliocron</h1>
            <div>Reading time: 8-10 minutes</div>
        <div>Posted here: 06 Jul 2020</div>
        <p><a href="https://github.com/mfreeborn/heliocron">https://github.com/mfreeborn/heliocron</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="readme">
    
      <div>
        <article itemprop="text">
<p><a href="https://crates.io/crates/heliocron" rel="nofollow"><img src="https://camo.githubusercontent.com/822f62392933103780dda9e71d19e5c484357034/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f68656c696f63726f6e2e737667" alt="crates.io" data-canonical-src="https://img.shields.io/crates/v/heliocron.svg"></a>
<a href="https://crates.io/crates/heliocron" rel="nofollow"><img src="https://camo.githubusercontent.com/442706e419624739b0aba037f090d561e1bbf4ff/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f642f68656c696f63726f6e2e737667" alt="crates.io" data-canonical-src="https://img.shields.io/crates/d/heliocron.svg"></a>
<a href="https://github.com/mfreeborn/heliocron/actions"><img src="https://github.com/mfreeborn/heliocron/workflows/ci/badge.svg" alt="Build Status"></a></p>
<p>A command line application that integrates with cron to execute tasks relative to sunset, sunrise and other such solar events.</p>
<h2>Table of Contents</h2>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage-examples">Usage Examples</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#edge-cases">Edge Cases</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
<h2>Installation</h2>
<h3>1. Pre-compiled binaries</h3>
<p>Simply download a pre-compiled binary from the <a href="https://github.com/mfreeborn/heliocron/releases">releases</a> page.</p>
<p>Here's a quick compatibility table to help choose the correct binary to download:</p>
<table>
<thead>
<tr>
<th>Platform</th>
<th>Binary</th>
</tr>
</thead>
<tbody>
<tr>
<td>Raspberry Pi 0/1</td>
<td><a href="https://github.com/mfreeborn/heliocron/releases/download/v0.4.0/heliocron-v0.4.0-arm-unknown-linux-gnueabihf.tar.gz">heliocron-v0.4.0-arm-unknown-linux-gnueabihf.tar.gz</a></td>
</tr>
<tr>
<td>Raspberry Pi 2/3/4</td>
<td><a href="https://github.com/mfreeborn/heliocron/releases/download/v0.4.0/heliocron-v0.4.0-armv7-unknown-linux-gnueabihf.tar.gz">heliocron-v0.4.0-armv7-unknown-linux-gnueabihf.tar.gz</a></td>
</tr>
<tr>
<td>Linux with a 64bit CPU</td>
<td><a href="https://github.com/mfreeborn/heliocron/releases/download/v0.4.0/heliocron-v0.4.0-x86_64-unknown-linux-gnu.tar.gz">heliocron-v0.4.0-x86_64-unknown-linux-gnu.tar.gz</a></td>
</tr>
</tbody>
</table>
<h3>2. Install with cargo</h3>
<div><pre>$ cargo install heliocron
<span>.</span>
<span>.</span>
<span>.</span>
$ heliocron --version
heliocron 0.4.0</pre></div>
<h3>3. Build from source</h3>
<div><pre>$ git clone https://github.com/mfreeborn/heliocron
$ <span>cd</span> heliocron
$ cargo build --release
$ ./target/release/heliocron --version
heliocron 0.4.0</pre></div>
<h2>Usage Examples</h2>
<h3>Delay execution of a command relative to sunrise or sunset</h3>
<p>The following code snippet entered into the terminal will wait until sunset on 25th Feb 2020 at the Royal Greenwich Observatory (17:32:17 +00:00)  before listing the files and folders contained within the user's home directory.</p>
<div><pre>$ heliocron --date 2020-02-25 --date-format %Y-%m-%d --latitude 51.4769N --longitude 0.0005W 
<span>wait</span> --event sunset <span>&amp;&amp;</span> ls <span>~</span>
Thread going to sleep <span>for</span> _ seconds <span>until</span> 2020-02-25 17:32:17 +00:00. Press ctrl+C to cancel.</pre></div>
<p>Integration with Cron for recurring tasks is easy. The following snippet shows a Crontab entry which will run every morning at 2am. Heliocron will wait until 30 minutes before sunrise, before allowing the execution of the <code>turn-on-lights.sh</code> script.</p>
<div><pre>0 2 <span>*</span> <span>*</span> <span>*</span> heliocron --latitude 51.4769N --longitude 0.0005W <span>wait</span> --event sunrise --offset -00:30 
<span>&amp;&amp;</span> turn-on-lights.sh</pre></div>
<h3>Show a report of sunrise and sunset times for a given location and date</h3>
<p>Ever wondered what time sunrise is in Edinburgh on 7th May 2065?</p>
<div><pre>$ heliocron -d <span><span>"</span>7 May 2065<span>"</span></span> -f <span><span>"</span>%e %B %Y<span>"</span></span> -l 55.9533N -o 3.1883W report
LOCATION
--------
Latitude:  55.9533N
Longitude: 3.1883W

DATE
----
2065-05-07 12:00:00 +01:00

Solar noon is at:         2065-05-07 13:09:19 +01:00
The day length is:        15h 49m 51s

Sunrise is at:            2065-05-07 05:14:24 +01:00
Sunset is at:             2065-05-07 21:04:15 +01:00

Civil dawn is at:         2065-05-07 04:27:31 +01:00
Civil dusk is at:         2065-05-07 21:51:08 +01:00

Nautical dawn is at:      2065-05-07 03:19:56 +01:00
Nautical dusk is at:      2065-05-07 22:58:43 +01:00

Astronomical dawn is at:  Never
Astronomical dusk is at:  Never</pre></div>
<h2>Configuration</h2>
<p>Heliocron supports reading some configuration options from a file located at ~/.config/helicron.toml. Note that this file is not created by default, it is up to the user to create the file correctly, otherwise Heliocron will simply pass over it. In particular, you can set a default latitude and longitude (must provide both, otherwise it will fall back to the default location of the Royal Greenwich Observatory).</p>
<div><pre><span><span>#</span> ~/.config/heliocron.toml</span>
<span><span>#</span> set the default location to Buckingham Palace</span>
<span>latitude</span> = <span><span>"</span>51.5014N<span>"</span></span>
<span>longitude</span> = <span><span>"</span>0.1419W<span>"</span></span></pre></div>
<p>Now, using Heliocron without providing specific coordinates will yield the following output:</p>
<div><pre>$ heliocron -d 2020-03-08 report
LOCATION
--------
Latitude: 51.5014N
Longitude: 0.1419W

DATE
----
2020-03-08 12:00:00 +00:00

Solar noon is at:         2020-03-08 12:11:12 +00:00
The day length is:        11h 24m 22s

Sunrise is at:            2020-03-08 06:29:01 +00:00
Sunset is at:             2020-03-08 17:53:23 +00:00

Civil dawn is at:         2020-03-08 05:55:45 +00:00
Civil dusk is at:         2020-03-08 18:26:39 +00:00

Nautical dawn is at:      2020-03-08 05:17:04 +00:00
Nautical dusk is at:      2020-03-08 19:05:20 +00:00

Astronomical dawn is at:  2020-03-08 04:37:39 +00:00
Astronomical dusk is at:  2020-03-08 19:44:45 +00:00</pre></div>
<p>Observe that the location is set according to the contents of the configuration file.</p>
<p>Arguments passed in via the command line will override those set in the configuration file. Perhaps we want to check what is happening over at Windsor Castle without changing the configuration file:</p>
<div><pre>$ heliocron -d 2020-03-08 -l 51.4839N -o 0.6044W report
LOCATION
--------
Latitude: 51.4839N
Longitude: 0.6044W

DATE
----
2020-03-08 12:00:00 +00:00

Solar noon is at:         2020-03-08 12:13:03 +00:00
The day length is:        11h 24m 24s

Sunrise is at:            2020-03-08 06:30:51 +00:00
Sunset is at:             2020-03-08 17:55:15 +00:00

Civil dawn is at:         2020-03-08 05:57:36 +00:00
Civil dusk is at:         2020-03-08 18:28:30 +00:00

Nautical dawn is at:      2020-03-08 05:18:56 +00:00
Nautical dusk is at:      2020-03-08 19:07:10 +00:00

Astronomical dawn is at:  2020-03-08 04:39:32 +00:00
Astronomical dusk is at:  2020-03-08 19:46:34 +00:00</pre></div>
<h2>Edge Cases</h2>
<h3>The chosen event does not occur on the given day</h3>
<p>Sometimes, a particular event will never happen on a certain day at a certain location. For example, the Sun never drops below 18Â° below the horizon in England during the height of summer; astronomical dawn and dusk never occur.</p>
<p>When using the <code>report</code> subcommand, this is identified like so:</p>
<div><pre>$ heliocron -d 2020-06-21 -l 52.8300N -o 0.5135E report
<span>&lt;</span>-- snip --<span>&gt;</span>
Astronomical dawn is at:  Never
Astronomical dusk is at:  Never</pre></div>
<p>When using the <code>wait</code> subcommand, an error is raised and the program terminates immediately:</p>
<div><pre>$ heliocron -d 2020-06-21 -l 52.8300N -o 0.5135E <span>wait</span> -e astronomical_dusk
Runtime error: The chosen event does not occur on this day.</pre></div>
<h3>The chosen event occurred some time in the past</h3>
<p>If you try and <code>wait</code> for an event which happened in the past, an error will be raised and the program will terminate immediately:</p>
<div><pre>$ heliocron -d 2020-06-21 -l 52.8300N -o 0.5135E <span>wait</span> -e sunrise
Runtime error: The chosen event occurred <span>in</span> the past<span>;</span> cannot <span>wait</span> a negative amount of time.</pre></div>
<p>No such error arises if you just want a <code>report</code> from that date.</p>
<h2>Reference</h2>
<h3>Usage</h3>
<div><pre>heliocron [Options] <span>&lt;</span>Subcommand<span>&gt;</span> [Subcommand Options]</pre></div>
<h3>Options</h3>
<ul>
<li>
<p><code>-d, --date</code> [default: today]</p>
<p>Specify the date, by default in ISO 8601 format (YYYY-MM-DD).</p>
</li>
<li>
<p><code>f, --format</code> [default: %Y-%m-%d]</p>
<p>Specifiy the format of the date string passed to <code>--date</code>, using the syntax described <a href="https://docs.rs/chrono/0.4.12/chrono/format/strftime/index.html" rel="nofollow">here</a> by the <code>chrono</code> crate.</p>
</li>
<li>
<p><code>-l, --latitude</code> [default: 51.4769N]</p>
<p>Specify the north/south coordinate of the location. If <code>--latitude</code> is passed as a command line option, <code>--longitude</code> must also be provided. Can be specified in a file located at ~/.config/heliocron.toml (see <a href="#configuration">Configuration</a>).</p>
</li>
<li>
<p><code>-o, --longitude</code> [default: 0.0005W]</p>
<p>Specify the east/west coordinate of the location. If <code>--longitude</code> is passed as a command line option, <code>--latitude</code> must also be provided. Can be specified in a file located at ~/.config/heliocron.toml (see <a href="#configuration">Configuration</a>).</p>
</li>
<li>
<p><code>-t, --time-zone</code> [default: here and now]</p>
<p>Specify the time zone, in [+/-]HH:MM format, at which to calculate and display times.</p>
</li>
</ul>
<h3>Subcommands</h3>
<ul>
<li>
<h4>report</h4>
<p>Output the dates and times of sunrise, sunset, etc to stdout on the specified date at the specified location.</p>
<p>No further options are available.</p>
</li>
<li>
<h4>wait</h4>
<p>Put the thread to sleep until the chosen event [+ offset] occurs on the specified date at the specified location.</p>
<ul>
<li>
<p><code>-e, --event</code> [required]</p>
<p>Must be one of:</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sunrise</code></td>
<td>The moment when the upper edge of the solar disk becomes visible above the horizon</td>
</tr>
<tr>
<td><code>sunset</code></td>
<td>The moment when the upper edge of the solar disk disappears below the horizon</td>
</tr>
<tr>
<td><code>civil_dawn</code></td>
<td>The moment when the geometric centre of the Sun reaches 6Â° below the horizon as it is rising</td>
</tr>
<tr>
<td><code>civil_dusk</code></td>
<td>The moment when the geometric centre of the Sun reaches 6Â° below the horizon as it is setting</td>
</tr>
<tr>
<td><code>nautical_dawn</code></td>
<td>The moment when the geometric centre of the Sun reaches 12Â° below the horizon as it is rising</td>
</tr>
<tr>
<td><code>nautical_dusk</code></td>
<td>The moment when the geometric centre of the Sun reaches 12Â° below the horizon as it is settting</td>
</tr>
<tr>
<td><code>astronomical_dawn</code></td>
<td>The moment when the geometric centre of the Sun reaches 18Â° below the horizon as it is rising</td>
</tr>
<tr>
<td><code>astronomical_dusk</code></td>
<td>The moment when the geometric centre of the Sun reaches 18Â° below the horizon as it is setting</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><code>-o, --offset</code> [default: 00:00:00]</p>
<p>Specify an offset, either in [-]HH:MM or [-]HH:MM:SS format, from the chosen event. Negative offsets (those which are prepended with a <code>-</code> e.g. <code>-01:00</code>) will set the delay to be before the event, whilst positive offsets will shift the delay after the event.</p>
</li>
</ul>
</li>
</ul>
</article>
      </div>
  </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs" /></noscript>
</body>
</html>