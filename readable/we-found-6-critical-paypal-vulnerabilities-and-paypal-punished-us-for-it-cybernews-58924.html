<!DOCTYPE html>
<html lang="en">
<head>
    <title>
We found 6 critical PayPal vulnerabilities - and PayPal punished us for it | CyberNews - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="We found 6 critical PayPal vulnerabilities - and PayPal punished us for it | CyberNews - linksfor.dev(s)"/>
    <meta property="article:author" content="Bernard Meyer"/>
    <meta property="og:description" content="CyberNews research analysts discovered 6 serious PayPal vulnerabilities and reported them. But instead of a bounty or thanks, we got punished by PayPal."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://cybernews.com/security/we-found-6-critical-paypal-vulnerabilities-and-paypal-punished-us/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - We found 6 critical PayPal vulnerabilities - and PayPal punished us for it | CyberNews</title>
<div class="readable">
        <h1>We found 6 critical PayPal vulnerabilities - and PayPal punished us for it | CyberNews</h1>
            <div>by Bernard Meyer</div>
            <div>Reading time: 14-18 minutes</div>
        <div>Posted here: 24 Feb 2020</div>
        <p><a href="https://cybernews.com/security/we-found-6-critical-paypal-vulnerabilities-and-paypal-punished-us/">https://cybernews.com/security/we-found-6-critical-paypal-vulnerabilities-and-paypal-punished-us/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div><p>In the news, it seems that PayPal gives a lot of money to ethical hackers that find bugs in their tools and services. In March 2018, PayPal announced that they’re increasing their maximum bug bounty payment to <a href="https://portswigger.net/daily-swig/paypal-bug-bounty-increases-to-30k" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">$30,000</a> – a pretty nice sum for hackers.&nbsp;<br></p><p>On the other hand, ever since PayPal moved its bug bounty program to HackerOne, its entire system for supporting bug bounty hunters who identify and report bugs has become more opaque, mired in illogical delays, vague responses, and suspicious behavior.<br></p><p>When our analysts discovered six vulnerabilities in PayPal – ranging from dangerous exploits that can allow anyone to bypass their two-factor authentication (2FA), to being able to send malicious code through their SmartChat system – we were met with non-stop delays, unresponsive staff, and lack of appreciation. Below, we go over each vulnerability in detail and why we believe they’re so dangerous.&nbsp;<br></p><p>When we pushed the HackerOne staff for clarification on these issues, they removed points from our Reputation scores, relegating our profiles to a suspicious, spammy level. This happened even when the issue was eventually patched, although we received no bounty, credit, or even a thanks. Instead, we got our <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.hackerone.com/blog/introducing-reputation" target="_blank">Reputation scores</a> (which start out at 100) negatively impacted, leaving us worse off than if we’d reported nothing at all.<br></p><p>It’s unclear where the majority of the problem lies. Before going through HackerOne, we attempted to communicate directly with PayPal, but we received only copy-paste Customer Support responses and humdrum, say-nothing responses from human representatives.<br></p><p>There also seems to be a larger issue of HackerOne’s triage system, in which they employ Security Analysts to check the submitted issues before passing them onto PayPal. The only problem – these Security Analysts are hackers themselves, and they have clear motivation for delaying an issue in order to collect the bounty themselves.<br></p><p>Since there is a lot more money to be made from using or selling these exploits on the black market, we believe the PayPal/HackerOne system is flawed and will lead to fewer ethical hackers providing the necessary help in finding and patching PayPal’s tools.<br></p><h2>Vulnerabilities we discovered</h2><p>In our analysis of PayPal’s mobile apps and website UI, we were able to uncover a series of significant issues. We’ll explain these vulnerabilities from the most severe to least severe, as well as how each vulnerability can lead to serious issues for the end user.</p><h3>#1 Bypassing PayPal’s two-factor authentication (2FA)</h3><p>Using the current version of PayPal for Android (v. 7.16.1), the CyberNews research team was able to bypass PayPal’s phone or email verification, which for ease of terminology we can call two-factor authentication (2FA). Their 2FA, which is called “Authflow” on PayPal, is normally triggered when a user logs into their account from a new device, location or IP address.</p><div><figure><img src="https://cybernews.com/wp-content/uploads/2020/02/security-check.png" alt="PayPal's &quot;2FA&quot; security check, which is easily bypassable" width="300" height="453" srcset="https://cybernews.com/wp-content/uploads/2020/02/security-check.png 400w, https://cybernews.com/wp-content/uploads/2020/02/security-check-199x300.png 199w" sizes="(max-width: 300px) 100vw, 300px" data-pin-no-hover="true"></figure></div><h4>How we did it</h4><p>In order to bypass PayPal’s 2FA, our researcher used the PayPal mobile app and a MITM proxy, like Charles proxy. Then, through a series of steps, the researcher was able to get an elevated token to enter the account. (Since the vulnerability hasn’t been patched yet, we can’t go into detail of how it was done.)</p><div><figure><img src="https://cybernews.com/wp-content/uploads/2020/02/paypal-2fa-bypass2.png" alt="token values with permisions" width="713" height="346" srcset="https://cybernews.com/wp-content/uploads/2020/02/paypal-2fa-bypass2.png 951w, https://cybernews.com/wp-content/uploads/2020/02/paypal-2fa-bypass2-300x145.png 300w, https://cybernews.com/wp-content/uploads/2020/02/paypal-2fa-bypass2-768x372.png 768w, https://cybernews.com/wp-content/uploads/2020/02/paypal-2fa-bypass2-750x364.png 750w" sizes="(max-width: 713px) 100vw, 713px" data-pin-no-hover="true"></figure></div><p>The process is very simple, and only takes seconds or minutes. This means that attackers can gain easy access to accounts, rendering PayPal’s lauded security system useless.</p><h4>What’s the worst case scenario here?</h4><p>Stolen PayPal credentials can go for <a href="https://www.cnbc.com/2016/07/22/hacked-spotify-hulu-accounts-fetch-millions-for-data-thieves.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">just $1.50 on the black market</a>. Essentially, it’s exactly because it’s so difficult to get into people’s PayPal accounts with stolen credentials that these stolen credentials are so cheap. PayPal’s authflow is set up to detect and block suspicious login attempts, usually related to a new device or IP, besides other suspicious actions.<br></p><p>But with our 2FA bypass, that security measure is null and void. Hackers can buy stolen credentials in bulk, log in with those credentials, bypass 2FA in minutes, and have complete access to those accounts. With many known and unknown stolen credentials on the market, this is potentially a huge loss for many PayPal customers.</p><h4>PayPal’s response</h4><p>We’ll assume that HackerOne’s response is representative of PayPal’s response. For this issue, PayPal decided that, since the user’s account must already be compromised for this attack to work, “there does not appear to be any security implications as a direct result of this behavior.”<br></p><div><figure><img src="https://cybernews.com/wp-content/uploads/2020/01/2fa-hackerone.png" alt="HackerOne's muted response to the PayPal 2FA bypass" srcset="https://cybernews.com/wp-content/uploads/2020/01/2fa-hackerone.png 746w, https://cybernews.com/wp-content/uploads/2020/01/2fa-hackerone-300x66.png 300w" sizes="(max-width: 746px) 100vw, 746px" data-pin-no-hover="true"></figure></div><p>Based on that, they closed the issue as <strong>Not Applicable</strong>, costing us 5 reputation points in the process.</p><h3> #2 Phone verification without OTP <br></h3><p>Our analysts discovered that it’s pretty easy to confirm a new phone without an OTP (One-Time Pin). PayPal recently introduced a new system where it checks whether a phone number is registered under the same name as the account holder. If not, it rejects the phone number.&nbsp;<br></p><h4>How we did it</h4><p>When a user registers a new phone number, an onboard call is made to api-m.paypal.com, which sends the status of the phone confirmation. We can easily change this call, and PayPal will then register the phone as confirmed.</p><figure><img src="https://cybernews.com/wp-content/uploads/2020/02/editing-phone-number-on-paypal-account-1.png" alt="editing phone number on paypal account" srcset="https://cybernews.com/wp-content/uploads/2020/02/editing-phone-number-on-paypal-account-1.png 1015w, https://cybernews.com/wp-content/uploads/2020/02/editing-phone-number-on-paypal-account-1-300x140.png 300w, https://cybernews.com/wp-content/uploads/2020/02/editing-phone-number-on-paypal-account-1-768x357.png 768w, https://cybernews.com/wp-content/uploads/2020/02/editing-phone-number-on-paypal-account-1-750x349.png 750w" sizes="(max-width: 1015px) 100vw, 1015px" data-pin-no-hover="true"></figure><p>The call can be repeated on already registered accounts to verify the phone.</p><h4>What’s the worst case scenario here?</h4><p>Scammers can find lots of uses for this vulnerability, but the major implication is unmissable. By bypassing this phone verification, it will make it much easier for scammers to create fraudulent accounts, especially since there’s no need to receive an SMS verification code.</p><h4>PayPal’s response</h4><p>Initially, the PayPal team via HackerOne took this issue more seriously. However, after a few exchanges, they stopped responding to our queries, and recently PayPal itself (not the HackerOne staff) locked this report, meaning that we aren’t able to comment any longer.</p><div><figure><img src="https://cybernews.com/wp-content/uploads/2020/02/paypal-locked-phone-disclosure.png" alt="" width="599" height="429" srcset="https://cybernews.com/wp-content/uploads/2020/02/paypal-locked-phone-disclosure.png 798w, https://cybernews.com/wp-content/uploads/2020/02/paypal-locked-phone-disclosure-300x215.png 300w, https://cybernews.com/wp-content/uploads/2020/02/paypal-locked-phone-disclosure-768x550.png 768w, https://cybernews.com/wp-content/uploads/2020/02/paypal-locked-phone-disclosure-120x86.png 120w, https://cybernews.com/wp-content/uploads/2020/02/paypal-locked-phone-disclosure-350x250.png 350w, https://cybernews.com/wp-content/uploads/2020/02/paypal-locked-phone-disclosure-750x538.png 750w" sizes="(max-width: 599px) 100vw, 599px" data-pin-no-hover="true"></figure></div><h3>#3 Sending money security bypass</h3><p>PayPal has set up certain security measures in order to help avoid fraud and other malicious actions on the tool. One of these is a security measure that’s triggered when one of the following conditions, or a combination of these, is met:<br></p><ul><li>You’re using a new device</li><li>You’re trying to send payments from a different location or IP address</li><li>There’s a change in your usual sending pattern</li><li>The owning account is not “aged” well (meaning that it’s pretty new)</li></ul><p>When these conditions are met, PayPal may throw up a few types of errors to the users, including:<br></p><ul><li>“You’ll need to link a new payment method to send the money”&nbsp;</li><li>“Your payment was denied, please try again later”</li></ul><h4>How we did it</h4><p>Our analysts found that PayPal’s sending money security block is vulnerable to brute force attacks.</p><h4>What’s the worst case scenario here?</h4><p>This is similar in impact to Vulnerability #1 mentioned above. An attacker with access to stolen PayPal credentials can access these accounts after easily bypassing PayPal’s security measure.</p><h4>PayPal’s response</h4><p>When we submitted this to HackerOne, they responded that this is an “out-of-scope” issue since it requires stolen PayPal accounts. As such, they closed the issue as <strong>Not Applicable</strong>, costing us 5 reputation points in the process.</p><h3>#4 Full name change</h3><p>By default, PayPal allows users to only change 1-2 letters of their name once (usually because of typos). After that, the option to update your name disappears.&nbsp;</p><p>However, using the current version of PayPal.com, the CyberNews research team was able to change a test account’s name from “Tester IAmTester” to “christin christina”.</p><div><figure><img src="https://cybernews.com/wp-content/uploads/2020/02/name-change.png" alt="It was pretty easy to change our test account's name, bypassing PayPal's name change security" width="845" height="183" srcset="https://cybernews.com/wp-content/uploads/2020/02/name-change.png 1127w, https://cybernews.com/wp-content/uploads/2020/02/name-change-300x65.png 300w, https://cybernews.com/wp-content/uploads/2020/02/name-change-1024x222.png 1024w, https://cybernews.com/wp-content/uploads/2020/02/name-change-768x166.png 768w, https://cybernews.com/wp-content/uploads/2020/02/name-change-750x162.png 750w" sizes="(max-width: 845px) 100vw, 845px" data-pin-no-hover="true"></figure></div><h4>How we did it</h4><p>We discovered that if we capture the requests and repeat it every time by changing 1-2 letters at a time, we are able to fully change account names to something completely different, without any verification.<br></p><p>We also discovered that we can use any unicode symbols, including emojis, in the name field.</p><h4>What’s the worst case scenario here?</h4><p>An attacker, armed with stolen PayPal credentials, can change the account holder’s name. Once they’ve completely taken over an account, the real account holder wouldn’t be able to claim that account, since the name has been changed and their official documents would be of no assistance.</p><h4>PayPal’s response</h4><p>This issue was deemed a <strong>Duplicate</strong> by PayPal, since it had been apparently discovered by another researcher.</p><h3>#5 The self-help SmartChat stored XSS vulnerability</h3><p>PayPal’s self-help chat, which it calls SmartChat, lets users find answers to the most common questions. Our research discovered that this SmartChat integration is missing crucial form validation that checks the text that a person writes.</p><div><figure><img src="https://cybernews.com/wp-content/uploads/2020/02/image3-1024x576.png" alt="PayPal's SmartChat stored XSS vulnerability " width="768" height="432" srcset="https://cybernews.com/wp-content/uploads/2020/02/image3-1024x576.png 1024w, https://cybernews.com/wp-content/uploads/2020/02/image3-300x169.png 300w, https://cybernews.com/wp-content/uploads/2020/02/image3-768x432.png 768w, https://cybernews.com/wp-content/uploads/2020/02/image3-1536x864.png 1536w, https://cybernews.com/wp-content/uploads/2020/02/image3-750x422.png 750w, https://cybernews.com/wp-content/uploads/2020/02/image3-1140x641.png 1140w, https://cybernews.com/wp-content/uploads/2020/02/image3.png 1920w" sizes="(max-width: 768px) 100vw, 768px" data-pin-no-hover="true"></figure></div><h4>How we did it</h4><p>Because the validation is done at the front end, we were able to use a man in the middle (MITM) proxy to capture the traffic that was going to Paypal servers and attach our malicious payload.</p><h4> What’s the worst case scenario here?</h4><p>Anyone can write malicious code into the chatbox and PayPal’s system would execute it. Using the right payload, a scammer can capture customer support agent session cookies and access their account.&nbsp;<br></p><p>With that, the scammer can log into their account, pretend to be a customer support agent, and get sensitive information from PayPal users.</p><h4>PayPal’s response</h4><p>The same day that we informed PayPal of this issue, they replied that since it isn’t “exploitable externally,” it is a non-issue. However, while we planned to send them a full POC (proof of concept), PayPal seems to have removed the file on which the exploit was based. This indicates that they were not honest with us and patched the problem quietly themselves, providing us with no credit, thanks, or bounty. Instead, they closed this as <strong>Not Applicable</strong>, costing us another 5 points in the process.</p><h3>#6 Security questions persistent XSS</h3><p>This vulnerability is similar to the one above (#5), since PayPal does not sanitize its Security Questions input.&nbsp;</p><h4>How we did it</h4><p>Because PayPal’s Security Questions input box is not validated properly, we were able to use the MITM method described above.<br></p><p>Here is a screenshot that shows our test code being injected to the account after refresh, resulting in a massive clickable link:</p><figure><img src="https://cybernews.com/wp-content/uploads/2020/02/persistent-xss.png" alt="PayPal's security questions persistent XSS" srcset="https://cybernews.com/wp-content/uploads/2020/02/persistent-xss.png 940w, https://cybernews.com/wp-content/uploads/2020/02/persistent-xss-300x169.png 300w, https://cybernews.com/wp-content/uploads/2020/02/persistent-xss-768x432.png 768w, https://cybernews.com/wp-content/uploads/2020/02/persistent-xss-750x422.png 750w" sizes="(max-width: 940px) 100vw, 940px" data-pin-no-hover="true"></figure><h4>What’s the worst case scenario here?</h4><p>Attackers can inject scripts to other people’s accounts to grab sensitive data. By using Vulnerability #1 and logging in to a user’s account, a scammer can inject code that can later run on any computer once a victim logs into their account.</p><p>This includes:</p><ul><li>Showing a fake pop up that could say “Download the new PayPal app” which could actually be malware.</li><li>Changing the text user is adding. For example, the scammer can alter the email where the money is being sent.</li><li>Keylogging credit card information when the user inputs it.&nbsp;&nbsp;</li></ul><p>There are many more ways to use this vulnerability and, like all of these exploits, it’s only limited by the scammer’s imagination.</p><h4>PayPal’s response</h4><p>The same day we reported this issue, PayPal responded that it had already been reported. Also on the same day, the vulnerability seems to have been patched on PayPal’s side. They deemed this issue a <strong>Duplicate</strong>, and we lost another 5 points.</p><h2>PayPal’s reputation for dishonesty</h2><p>PayPal has been on the receiving end of criticism for not honoring its own bug bounty program.&nbsp;<br></p><p>Most ethical hackers will remember the 2013 case of <a href="https://nakedsecurity.sophos.com/2013/05/29/paypal-refuses-to-pay-bug-finding-teen/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Robert Kugler</a>, the 17-year old German student who was shafted out of a huge bounty after he discovered a critical bug on PayPal’s site. Kugler notified PayPal of the vulnerability on May 19, but apparently PayPal told him that because he was under 18, he was ineligible for the Bug Bounty Program.<br></p><p>But according to PayPal, the bug had already been discovered by someone else, but they also admitted that the young hacker was just too young.&nbsp;<br></p><p><a href="https://web.archive.org/web/20121021222451/http://l8security.com/post/33876600904/paypal-bug-bounty-a-lesson-in-not-being-a-fuckup" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Another researcher</a> earlier discovered that attempting to communicate serious vulnerabilities in PayPal’s software led to long delays. At the end, and frustrated, the researcher promises to never waste his time with PayPal again.<br></p><p>There’s also the case of another teenager, <a href="https://arstechnica.com/information-technology/2014/08/paypal-2fa-is-easily-bypassed-teenage-white-hat-hacker-says/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">Joshua Rogers</a>, also 17 at the time, who said that he was able to easily bypass PayPal’s 2FA. He went on to state, however, that PayPal didn’t respond after multiple attempts at communicating the issue with them.&nbsp;<br></p><p>PayPal acknowledged and downplayed the vulnerability, later patching it, without offering any thanks to Rogers.</p><h2>The big problem with HackerOne</h2><p>HackerOne is often hailed as a godsend for ethical hackers, allowing companies to get novel ways to patch up their tools, and allowing hackers to get paid for finding those vulnerabilities.<br></p><p>It’s certainly the most popular, especially since big names like PayPal work exclusively with the platform. There have been issues with HackerOne’s response, including the huge scandal involving Valve, when a researcher was <a href="https://www.zdnet.com/article/researcher-publishes-second-steam-zero-day-after-getting-banned-on-valves-bug-bounty-program/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">banned from HackerOne</a> after trying to report a Steam zero-day.<br></p><p>However, its Triage system, which is often seen as an innovation, actually has a serious problem. The way that HackerOne’s triage system works is simple: instead of bothering the vendor (HackerOne’s customer) with each reported vulnerability, they’ve set up a system where HackerOne Security Analysts will quickly check and categorize each reported issue and escalate or close the issues as needed. This is similar to the triage system in hospitals.<br></p><p>These Security Analysts are able to identify the problem, try to replicate it, and communicate with the vendor to work on a fix. However, there’s one big flaw here: these Security Analysts are also active Bug Bounty Hackers.<br></p><p>Essentially, these Security Analysts get first dibs on reported vulnerabilities. They have full discretion on the type of severity of the issue, and they have the power to escalate, delay or close the issue.<br></p><p>That presents a huge opportunity for them, if they act in bad faith. Other criticisms have pointed out that Security Analysts can first delay the reported vulnerability, report it themselves on a different bug bounty platform, collect the bounty (without disclosing it of course), and then closing the reported issue as <strong>Not Applicable</strong>, or perhaps <strong>Duplicate</strong>.<br></p><p>As such, the system is ripe for abuse, especially since Security Analysts on HackerOne use generic usernames, meaning that there’s no real way of knowing what they are doing on other bug bounty platforms.</p><h2>What it all means</h2><p>All in all, the exact “Who is to blame” question is left unanswered at this point, because it is overshadowed by another bigger question: why are these services so irresponsible?<br></p><p>Let’s point out a simple combination of vulnerabilities that any malicious actor can use:<br></p><ol><li>Buy PayPal accounts on the black market for pennies on the dollar. (On this <a href="http://blackpasqk3nqfuc.onion/paypal" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">.onion website</a>, you can buy a $5,000 PayPal account for just $150, giving you a 3,333% ROI.)</li><li>Use <strong>Vulnerability #1</strong> to bypass the two-factor authentication easily.&nbsp;</li><li>Use <strong>Vulnerability #3</strong> to bypass the sending money security and easily send money from the linked bank accounts and cards.</li></ol><p>Alternatively, the scammer can use <strong>Vulnerability #1</strong> to bypass 2FA and then use <strong>Vulnerability #4</strong> to change the account holder’s name. That way, the scammer can lock the original owner out of their own account.<br></p><p>While these are just two simple ways to use our discovered vulnerabilities, scammers – who have much more motivation and creativity for maliciousness (as well as a penchant for scalable attacks) – will most likely have many more ways to use these exploits.<br></p><p>And yet, to PayPal and HackerOne, these are non-issues. Even worse, it seems that you’ll just get punished for reporting it.<br></p></div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>