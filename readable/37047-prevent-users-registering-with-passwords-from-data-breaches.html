<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Prevent users registering with passwords from data breaches -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Prevent users registering with passwords from data breaches</h1>
    <div class="page-container"> <p class="text-muted"> Posted on 15th December 2018 - Takes 4 minutes to read </p> <p class="text-center"> <img class="img-fluid border" src="/storage/KTWBuTZmJHzDzCA56PtL0B0z9Pi2SORR5ygAoA3I.jpeg"> </p> <p>It is generally recommended that developers of web applications ensure their users pick decent passwords. This often means ensuring a minimum length, preventing common passwords, or words from the dictionary. Sometimes users need to mix and match various numbers, letters, and symbols too.</p>
<p>But we can do better.</p>
<h2>Checking passwords against previous breach corpuses</h2>
<p>Several of my open source packages focus around password security. The most popular of which let developers check their users&apos; passwords, to ensure they have not been exposed in 3rd party data breaches. This is a very important protection to have in place considering one of the primary ways online accounts are compromised is via password reuse.</p>
<p>Checking passwords against previous data breaches is also recommended by the National Institute of Standards and Technology. See the quote below, from <a href="https://pages.nist.gov/800-63-3/sp800-63b.html#sec5">NIST Special Publication 800-63B section 5</a>.</p>
<blockquote>
<p>When processing requests to establish and change memorized secrets, verifiers SHALL compare the prospective secrets against a list that contains values known to be commonly-used, expected, or compromised. For example, the list MAY include, but is not limited to:</p>
<ul>
<li>Passwords obtained from previous breach corpuses.</li>
</ul>
</blockquote>
<h2>Packages</h2>
<p>Here are a few open source PHP &amp; Laravel packages that implement secure password exposure checking functionality.</p>
<h3>Password Exposed Helper Function</h3>
<p>If you&apos;re developing a pure PHP web application, you&apos;ll want to use the <a href="https://github.com/DivineOmega/password_exposed">Password Exposed Helper Function</a> package. This package provides a simple <code>password_exposed</code> method which you can pass a password in order to determine whether it was previously exposed in a data breach.</p>
<p>Here&apos;s an example of how you can use it in your web application:</p>
<pre><code class="language-php">switch(password_exposed(&apos;hunter2&apos;)) {

    case PasswordStatus::EXPOSED:
        // Password has been exposed in a data breach.
        break;

    case PasswordStatus::NOT_EXPOSED:
        // Password has not been exposed in a known data breach.
        break;

    case PasswordStatus::UNKNOWN:
        // Unable to check password due to an API error.
        break;
}</code></pre>
<h3>Laravel Password Exposed Validation Rule</h3>
<p>If you&apos;re using the Laravel framework, this is the package for you. This package ties into to the built-in Laravel validator, providing a custom rule. This custom rule will check if the provided password field contains an exposed password, and if so, returns a customisable validation message.</p>
<p>Using this validation rule is quite simple, as shown below. It can be used within a controller, or request object, in the same way as any other Laravel validation rule.</p>
<pre><code class="language-php">use DivineOmega\LaravelPasswordExposedValidationRule\PasswordExposed;

$request-&gt;validate([
    &apos;password&apos; =&gt; [&apos;required&apos;, new PasswordExposed()],
]);</code></pre>
<p>Check out the <a href="https://github.com/DivineOmega/laravel-password-exposed-validation-rule">Laravel Password Exposed Validation Rule</a> readme on GitHub for additional documentation.</p>
<h3>Laravel NIST Password Rules</h3>
<p>I wrote the <a href="https://github.com/langleyfoxall/laravel-nist-password-rules">Laravel NIST Password Rules</a> package for <a href="https://langleyfoxall.co.uk/">Langley Foxall</a>, who specialise in bespoke enterprise software solutions. This package is now included by default in all of their new Laravel powered projects, ensuring a high security by default policy is in place.</p>
<p>This package provides Laravel validation rules that follow the password related recommendations found in <a href="https://pages.nist.gov/800-63-3/sp800-63b.html#sec5">NIST Special Publication 800-63B section 5</a>. Currently, it provides validation rules for the NIST following recommendations.</p>
<table>
<thead>
<tr>
<th>Recommendation</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>[...] at least 8 characters in length</td>
<td>A standard validation rule in all rule sets to validate against this minimum length of 8 characters.</td>
</tr>
<tr>
<td>Passwords obtained from previous breach corpuses</td>
<td>The <code>BreachedPasswords</code> rule securely checks the password against previous 3rd party data breaches.</td>
</tr>
<tr>
<td>Dictionary words</td>
<td>The <code>DictionaryWords</code> rule checks the password against a list of over 102k dictionary words.</td>
</tr>
<tr>
<td>Context-specific words, such as the name of the service, the username</td>
<td>The <code>ContextSpecificWords</code> rule checks the password does not contain the provided username, and any words defined the configured app name or app URL.</td>
</tr>
<tr>
<td>Context-specific words, [...] and derivatives thereof</td>
<td>The <code>DerivativesOfContextSpecificWords</code> rule checks the password is not too similar to the provided username, and any words defined the configured app name or app URL.</td>
</tr>
</tbody>
</table>
<h2>How does checking for password exposure work?</h2>
<p>All these packages make use of the <a href="https://haveibeenpwned.com/Passwords">Have I Been Pwned - Pwned Passwords</a> API, created and ran the security expert, <a href="https://twitter.com/troyhunt">Troy Hunt</a>.</p>
<p>This API allows you to securely check for password exposure, without exposed the password. It works by sending the first few characters of the password&apos;s SHA1 hash to the API endpoint. The response contains a large list of all exposed SHA1 hashes that start with that prefix, allowing these package to locally check whether the password has been exposed.</p>
<p>This type of implementation, which allows for searching by partial hashes, is known as a <a href="https://en.wikipedia.org/wiki/K-anonymity">k-anonymity model</a>.</p>
<p>If you have any questions regarding these packages, feel free to contact me on <a href="https://twitter.com/DivineOmega">Twitter</a>.</p> <a class="btn btn-link" href="/tag/open-source">open source</a> <a class="btn btn-link" href="/tag/security">security</a> <a class="btn btn-link" href="/tag/php">PHP</a> <a class="btn btn-link" href="/tag/password-exposed">password_exposed</a> <a class="btn btn-link" href="/tag/laravel-password-exposed-validation-rule">laravel-password-exposed-validation-rule</a> <a class="btn btn-link" href="/tag/passwords">passwords</a> <a class="btn btn-link" href="/tag/data-breaches">data breaches</a> <a class="btn btn-link" href="/tag/nist">NIST</a> <a class="btn btn-link" href="/tag/laravel-nist-password-rules">laravel-nist-password-rules</a> <a></a> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>