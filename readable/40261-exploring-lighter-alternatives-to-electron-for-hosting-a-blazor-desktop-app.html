<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Exploring lighter alternatives to Electron for hosting a Blazor desktop app -
linksfor.dev(s)
    </title>
	<link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <h1>Exploring lighter alternatives to Electron for hosting a Blazor desktop app</h1>
    <div class="body"> <p><a href="https://electronjs.org/">Electron</a> was first open-sourced in 2014, and gained immediate popularity as a way to build desktop apps using web technologies (HTML+CSS+JS). At the core of its design is the idea of bundling a predictable environment:</p> <ul> <li><strong>It bundles its own copy of Chromium</strong>, so you know for sure how your HTML/CSS will be rendered and don&#x2019;t have to worry about random old versions of IE (etc.)</li> <li><strong>It bundles its own copy of Node.js</strong>, so you have a known version of a portable programming platform that goes beyond the browser sandbox and can interact with the host OS directly</li>
</ul> <p>These choices offered a lot of value five years ago, but in late 2019 you might choose differently. And these choices are also key to why Electron has a reputation for being unusually resource-hungry. A default blank Electron 8.0.0 application is 164MB to download (66MB compressed), and runs as 4 separate processes consuming 150MB RAM in total.</p> <p>It&#x2019;s completely possible that these numbers look fine to you and are satisfactory for your scenario. If that&#x2019;s the case, good for you! This post is not an attempt to bash Electron, which is a well-run project that people are clearly using successfully. In this post, I simply want to consider what other options we might have.</p> <h2 id="how-light-could-it-get">How light could it get?</h2> <p>What if&#x2026;</p> <ul> <li> <p><strong>&#x2026;we didn&#x2019;t bundle Chromium</strong>, but instead used whatever webview already exists in the OS? In 2019, just about any desktop OS is going to have a sufficiently modern, usually Chromium-based browser, ready to go. For your app, it likely doesn&#x2019;t matter whether it&#x2019;s Chromium from last week or last year.</p> </li> <li> <p><strong>&#x2026;we didn&#x2019;t bundle Node</strong>, but instead made use of the programming environment already in the OS, or optionally brought a different one? A framework-dependent .NET Core app can easily be under 1MB, and a standalone one (i.e., bundling its own copy of .NET Core) can get down to ~20MB linked and compressed.</p> </li>
</ul> <p>Various Electron-lite alternative projects have already sprung up <a href="#footnote-existing-electron-alternatives">[1]</a>. Of course, there are also PWAs, but that&#x2019;s not what this post is about, since PWAs don&#x2019;t have native access to the underlying OS.</p> <h2 id="blazor-on-electron">Blazor on Electron</h2> <p>We&#x2019;ve had a lot of interest in using Blazor to build cross-platform desktop apps. It&#x2019;s not surprising: combining the performance and productivity of C#/.NET with the familiarity of HTML/CSS UI rendering is powerful and appealing.</p> <p>So, we published a <a href="https://github.com/aspnet/AspLabs/tree/master/src/ComponentsElectron">sample and an experimental package for hosting Blazor on Electron</a>. The key innovation here is that it&#x2019;s <em>not</em> running on WebAssembly, but rather uses the normal cross-platform .NET Core runtime to achieve full native .NET performance and enable full access to the host OS without any browser sandbox limitations.</p> <p>You can try this out today. Just note that it&#x2019;s only an &#x201C;asplabs&#x201D; project, as we haven&#x2019;t yet made any commitment to ship and support this technology.</p> <h2 id="blazor-on-pure-webview">Blazor on pure webview</h2> <p>It&#x2019;s not hard to imagine how a Blazor hybrid desktop app could be slimmed down <em>dramatically</em> further. We could swap out Electron for a pure OS-native web view, reasoning that in 2019, there&#x2019;s virtually always a good enough one available on your target machine. Plus we don&#x2019;t really need Node as a cross-platform programming environment, since .NET Core already plays that role for us.</p> <p>To verify this, I built <a href="https://github.com/steveSandersonMS/BlazorDesktop">an experiment called BlazorDesktop</a>. This is very similar to <a href="https://github.com/aspnet/AspLabs/tree/master/src/ComponentsElectron">BlazorElectron</a>, and in fact most of the code is a copy-paste from it. Again, it runs on native .NET Core (so <em>not</em> on WebAssembly), but now it&#x2019;s running on a much smaller rendering stack, without any bundled Chromium or Node.js.</p> <p><img src="/wp-content/uploads/2019/11/01/blazor-desktop.png" alt="Blazor Desktop"></p> <p>It&#x2019;s a fully-functional Blazor application into which you can add any native .NET Core-based functionality, and runs as an extremely lightweight desktop app - see below for numbers. Unlike a PWA, it&#x2019;s <em>not</em> limited to the browser sandbox.</p> <p>If you&#x2019;re interested in <a href="https://github.com/steveSandersonMS/BlazorDesktop">trying this out</a>, please note that it&#x2019;s purely a quick proof-of-concept, and currently is Windows only. Expanding it to be cross-platform wouldn&#x2019;t be too hard (I&#x2019;d use something like <a href="https://github.com/zserge/webview">webview</a> to add Mac+Linux support) but is not something I&#x2019;m actively doing right now. Send a PR if you&#x2019;re interested.</p> <h2 id="the-stats">The stats</h2> <p>Not surprisingly, this minimal Blazor + webview application is significantly smaller and less memory-hungry than one built on the whole Chromium + Node stack:</p> <p><img src="/wp-content/uploads/2019/11/01/download-size-chart.png" alt="Download size comparison"></p> <p><img src="/wp-content/uploads/2019/11/01/memory-use-chart.png" alt="Memory use comparison"></p> <p>One of the neat things about .NET Core apps is that, with a simple switch, you can control whether the publish output bundles its own copy of the .NET Core runtime (a.k.a. <em>standalone</em>), or whether it assumes the runtime will already be installed on the target OS (a.k.a. <em>framework-dependent</em>). This is captured in the first graph above, and you can see it makes a huge difference to the output size, since the Blazor libraries themselves are very compact.</p> <p>In corporate environments where you know that certain software is already installed, you can safely distribute tiny &lt; 1MB framework-dependent apps, where the same binaries run on any supported OS. But for public distribution, you&#x2019;d most likely publish a standalone app - generating different binaries for each of Windows, Mac, and Linux users.</p> <p>Note that about 200KB of the compressed Blazor webview app above consists of Bootstrap styling, so you could drop that if you&#x2019;re using something else.</p> <h2 id="what-would-have-to-be-built-to-make-this-viable">What would have to be built to make this viable</h2> <p>As I&#x2019;ve said, Blazor Desktop is currently just a quick proof-of-concept, built entirely during the waking part of my return journey from <a href="https://ndcsydney.com/">NDC Sydney</a>. It would have a long way to go to turn into a viable product.</p> <p>It would need:</p> <ul> <li><strong>Cross-platform support</strong>, e.g., using <a href="https://github.com/zserge/webview">webview</a></li> <li><strong>Edge (Chromium) support</strong>, so that on Windows 10 we&#x2019;re using the OS&#x2019;s own Chromium-based browser instead of the Edge-based webview used in my prototype. This would also enable access to Chrome-style browser dev tools automatically.</li> <li><strong>Handling the scenario where a suitable webview can&#x2019;t be found</strong>. In the rare case where a user&#x2019;s OS doesn&#x2019;t supply an acceptable webview technology, we could prompt the user and download a standalone Chromium distribution (likely via <a href="https://bitbucket.org/chromiumembedded/cef/src">CEF</a>).</li> <li><strong>Desktop APIs</strong> - this is the big one that would be expensive to achieve from scratch. Electron doesn&#x2019;t just use Node as a general-purpose programming environment; it also ships a set of cross-platform APIs for interacting with the desktop OS for tasks like copying to clipboard, changing the taskbar/dock icon, displaying native dropdown menus, showing native prompts/dialogs, and many more such things. .NET Core itself supplies a huge proportion of the APIs that applications need, but today it doesn&#x2019;t address many of the desktop-focused ones, since there isn&#x2019;t today any standard cross-platform .NET Core-based UI technology. Any realistic app needs these capabilities. Conceivably it might be worth bundling Node just to get cross-platform implementations for these APIs (though still without bundling Chromium).</li> <li><strong>Publishing and downloading updates automatically</strong></li>
</ul> <h2 id="feedback-requested">Feedback requested</h2> <p>My reason for writing this is mainly to learn more about how the developer community feels about these technologies. Do you have scenarios for building hybrid desktop apps with .NET+HTML+CSS? Would you be happy to use Blazor with Electron, or do you feel it&#x2019;s necessary to have something more bare-metal?</p> <p>Many people have thought about building lighter alternatives to Electron over the years. Various open-source projects now exist, though it&#x2019;s not clear that any really have the critical momentum for mass adoption. Some of them, like <a href="https://github.com/chromelyapps/Chromely">Chromely</a>, eliminate Node and only bundle Chromium. Others, like <a href="https://github.com/neutralinojs/neutralinojs">Neutralino</a>, eliminate Chromium and only bundle a Node-based programming model combined with the host OS&#x2019;s browser technology. At the ultra-minimal end, <a href="https://github.com/zserge/webview">webview</a> is simply an abstraction over the idea of a webview: it shows your HTML/CSS in whatever browser technology is built into the host OS, and doesn&#x2019;t provide any cross-platform programming model of its own.</p> </div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2019 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
    </footer>
    
    <script>
        (function() {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function() {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) {}
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>