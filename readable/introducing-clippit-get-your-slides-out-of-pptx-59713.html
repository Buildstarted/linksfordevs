<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Introducing Clippit, get your slides out of PPTX. - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Introducing Clippit, get your slides out of PPTX. - linksfor.dev(s)"/>
    <meta property="og:description" content="Clippit is .NETStandard 2.0 library that allow you easily and efficiently extract all slides from PPTX presentation into one-slide presentations or compose slides back together into one presentatio&#x2026;"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://sergeytihon.com/2020/03/15/introducing-clippit/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Introducing Clippit, get your slides out of PPTX.</title>
<div class="readable">
        <h1>Introducing Clippit, get your slides out of PPTX.</h1>
            <div>Reading time: 7-9 minutes</div>
        <div>Posted here: 16 Mar 2020</div>
        <p><a href="https://sergeytihon.com/2020/03/15/introducing-clippit/">https://sergeytihon.com/2020/03/15/introducing-clippit/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><article id="post-6187">
	<!-- .entry-header -->

	<div>
		
<p><a href="https://sergey-tihon.github.io/Clippit/#/" target="_blank" rel="noopener">Clippit</a> is .NETStandard 2.0 library that allows you to easily and efficiently extract all slides from PPTX presentation into one-slide presentations or compose slides back together into one presentation.</p>

<p>PowerPoint is still the most popular way to present information. Sales and marketing people regularly produce new presentations. But when they work on new presentation they often reuse slides from previous ones. Here is the gap: when you compose presentation you need slides that can be reused, but result of your work is the presentation and you are not generally interested in “slide management”.</p>
<p>One of my projects is enterprise search solution, that help people find Office documents across different enterprise storage systems. One of cool features is that we let our users find particular relevant slide from presentation rather than huge pptx with something relevant on slide 57.</p>

<p>Back in the day, Microsoft PowerPoint allowed us to “Publish slides” (save each individual slide into separate file). I am absolutely sure that this button was in PowerPoint 2013 and as far as I know was removed from PowerPoint 365 and 2019 versions.</p>
<p><a href="https://answers.microsoft.com/en-us/msoffice/forum/all/how-to-publish-slides-in-powerpoint-365/278bdf99-d25c-4602-8e95-0d6919197501" target="_blank" rel="noopener"><img data-attachment-id="6193" data-permalink="https://sergeytihon.com/2020/03/15/introducing-clippit/d596b287-af31-4ecb-a8e0-092b4dbbed2b/" data-orig-file="https://sergeytihon.files.wordpress.com/2020/03/d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg" data-orig-size="658,376" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="d596b287-af31-4ecb-a8e0-092b4dbbed2b" data-image-description="" data-medium-file="https://sergeytihon.files.wordpress.com/2020/03/d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg?w=300" data-large-file="https://sergeytihon.files.wordpress.com/2020/03/d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg?w=658" src="https://sergeytihon.files.wordpress.com/2020/03/d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg?w=702" alt="d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg" srcset="https://sergeytihon.files.wordpress.com/2020/03/d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg 658w, https://sergeytihon.files.wordpress.com/2020/03/d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg?w=150 150w, https://sergeytihon.files.wordpress.com/2020/03/d596b287-af31-4ecb-a8e0-092b4dbbed2b.jpeg?w=300 300w" sizes="(max-width: 658px) 100vw, 658px"></a></p>
<p>When this feature was in the box, you could use <span>Microsoft.Office.Interop.PowerPoint.dll</span> to start instance of PowerPoint and communicate with it using COM Interop.</p>

<div id="gist101814862">
    <div>
      <div>
        <div>
  <div id="file-pp-interop-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-pp-interop-cs-L1" data-line-number="1"></td>
        <td id="file-pp-interop-cs-LC1"><span>public</span> <span>void</span> <span>PublishSlides</span>(<span>string</span> <span>sourceFileName</span>, <span>string</span> <span>resultDirectory</span>)</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L2" data-line-number="2"></td>
        <td id="file-pp-interop-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L3" data-line-number="3"></td>
        <td id="file-pp-interop-cs-LC3">    <span>Application</span> <span>ppApp</span> <span>=</span> <span>null</span>;</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L4" data-line-number="4"></td>
        <td id="file-pp-interop-cs-LC4">    <span>try</span></td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L5" data-line-number="5"></td>
        <td id="file-pp-interop-cs-LC5">    {</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L6" data-line-number="6"></td>
        <td id="file-pp-interop-cs-LC6">        <span>ppApp</span> <span>=</span> <span>new</span> <span>Application</span></td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L7" data-line-number="7"></td>
        <td id="file-pp-interop-cs-LC7">        {</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L8" data-line-number="8"></td>
        <td id="file-pp-interop-cs-LC8">            <span>DisplayAlerts</span> <span>=</span> <span>PpAlertLevel</span>.<span>ppAlertsNone</span></td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L9" data-line-number="9"></td>
        <td id="file-pp-interop-cs-LC9">        };</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L10" data-line-number="10"></td>
        <td id="file-pp-interop-cs-LC10">
</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L11" data-line-number="11"></td>
        <td id="file-pp-interop-cs-LC11">        <span>const</span> <span>MsoTriState</span> <span>msoFalse</span> <span>=</span> <span>MsoTriState</span>.<span>msoFalse</span>;</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L12" data-line-number="12"></td>
        <td id="file-pp-interop-cs-LC12">        <span>var</span> <span>presentation</span> <span>=</span> <span>ppApp</span>.<span>Presentations</span>.<span>Open</span>(<span>sourceFileName</span>,</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L13" data-line-number="13"></td>
        <td id="file-pp-interop-cs-LC13">            <span>msoFalse</span>, <span>msoFalse</span>, <span>msoFalse</span>);</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L14" data-line-number="14"></td>
        <td id="file-pp-interop-cs-LC14">
</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L15" data-line-number="15"></td>
        <td id="file-pp-interop-cs-LC15">        <span>presentation</span>.<span>PublishSlides</span>(<span>resultDirectory</span>, <span>true</span>, <span>true</span>);</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L16" data-line-number="16"></td>
        <td id="file-pp-interop-cs-LC16">        <span>presentation</span>.<span>Close</span>();</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L17" data-line-number="17"></td>
        <td id="file-pp-interop-cs-LC17">    }</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L18" data-line-number="18"></td>
        <td id="file-pp-interop-cs-LC18">    <span>finally</span></td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L19" data-line-number="19"></td>
        <td id="file-pp-interop-cs-LC19">    {</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L20" data-line-number="20"></td>
        <td id="file-pp-interop-cs-LC20">        <span>ppApp</span><span>?</span>.<span>Quit</span>();</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L21" data-line-number="21"></td>
        <td id="file-pp-interop-cs-LC21">    }</td>
      </tr>
      <tr>
        <td id="file-pp-interop-cs-L22" data-line-number="22"></td>
        <td id="file-pp-interop-cs-LC22">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>

<p><a href="https://support.microsoft.com/en-au/help/257757/considerations-for-server-side-automation-of-office">But server-side Automation of Office has never been recommended by Microsoft</a>. You were never able to reliably scale your automation, like start multiple instances to work with different document (because you need to think about active window and any on them may stop responding to your command). There is no guarantee that File-&gt;Open command will return control to you program, because for example if file is password-protected Office will show popup and ask for password and so on.</p>
<p>That was hard, but doable. PowerPoint guarantees that published slides will be valid PowerPoint documents that user will be able to open and preview. So it is worth playing the ceremony of single-thread automation with retries, timeouts and process kills (when you do not receive control back).</p>
<p>Over the time it became clear that it is the dead end. We need to keep the old version of PowerPoint on some VM and never touch it or find a better way to do it.</p>

<p>Windows only solution that requires MS Office installed on the machine and COM interop is not something that you expect from modern .NET solution.</p>
<p>Ideally it should be .NETStandard library on NuGet that platform-agnostic and able to solve you task anywhere and as fast as possible. But there was nothing on Nuget few months ago.</p>
<p>If you ever work with Office documents from C# you know that there is an <a href="https://www.nuget.org/packages/DocumentFormat.OpenXml/">OpenXml</a> library that opens office document, deserialize it internals to an object model, let you modify it and then save it back. But OpenXml API is low-level and you need to know a lot about OpenXml internals to be able to extract slides with images, embedding, layouts, masters and cross-references into new presentation correctly.</p>
<p>If you google more you will find that there is a project “<a href="https://github.com/OfficeDev/Open-Xml-PowerTools">Open-Xml-PowerTools</a>” developed by Microsoft since 2015 that have never been officially released on NuGet. Currently this project is archived by OfficeDev team and most actively maintained fork belongs to <a href="https://github.com/EricWhiteDev/Open-Xml-PowerTools">EricWhiteDev</a>&nbsp;(No NuGet.org feed at this time).</p>
<p>Open-Xml-PowerTools has a feature called <a href="http://www.ericwhite.com/blog/presentationbuilder-developer-center/">PresentationBuilder</a> that was created for similar purpose – compose slide ranges from multiple presentations into one presentation.&nbsp;After <a href="https://github.com/sergey-tihon/Clippit/pull/2">playing with this library</a>, I realized that it does a great job but does not fully satisfy my requirements:</p>
<ul>
<li>Resource usage are not efficient, same streams are opened multiple times and not always properly disposed.</li>
<li>Library is much slower than it could be with proper resource management and less GC pressure.</li>
<li>It generates slides with total size much larger than original presentation, because it copies all layouts when only one is needed.</li>
<li>It does not properly name image parts inside slide, corrupt file extensions and does not support SVG.</li>
</ul>
<p>It was a great starting point, but I realized that I can improve it. Not only fix all mentioned issues and improve performance 6x times but also add support for new image types, properly extract slide titles and convert then into presentation titles, propagate modification date and erase metadata that does not belong to slide.</p>

<p>So today, I am ready to present the new library <a href="https://sergey-tihon.github.io/Clippit/#/" target="_blank" rel="noopener">Clippit</a>&nbsp;that is technically a fork of most recent version of EricWhiteDev/Open-Xml-PowerTools that is extended and improved for one particular use case: extracting slides from presentation and composing them back efficiently.</p>
<p>All classes were moved to <span>Clippit</span> namespace, so you can load it side-by-side with any version of Open-Xml-PowerTools if you already use it.</p>
<p>The library is already available on <a href="https://www.nuget.org/packages/Clippit/1.2.0">NuGet</a>, it is written using C# 8.0 (nullable reference types), compiled for .NET Standard 2.0, tested with .NET Core 3.1. It works perfectly&nbsp;on macOS/Linux and battle-tested on hundreds of real world PowerPoint presentations.</p>
<p>New API is quite simple and easy to use</p>

<div id="gist101815363">
    <div>
      <div>
        <div>
  <div id="file-clippit-101-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-clippit-101-cs-L1" data-line-number="1"></td>
        <td id="file-clippit-101-cs-LC1"><span>var</span> <span>presentation</span> <span>=</span> <span>new</span> <span>PmlDocument</span>(<span>sourceFile</span>);</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L2" data-line-number="2"></td>
        <td id="file-clippit-101-cs-LC2">
</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L3" data-line-number="3"></td>
        <td id="file-clippit-101-cs-LC3"><span><span>//</span> Pubslish slides</span></td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L4" data-line-number="4"></td>
        <td id="file-clippit-101-cs-LC4"><span>var</span> <span>slides</span> <span>=</span> <span>PresentationBuilder</span>.<span>PublishSlides</span>(<span>presentation</span>).<span>ToList</span>();</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L5" data-line-number="5"></td>
        <td id="file-clippit-101-cs-LC5">
</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L6" data-line-number="6"></td>
        <td id="file-clippit-101-cs-LC6"><span><span>//</span> Save slides into files</span></td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L7" data-line-number="7"></td>
        <td id="file-clippit-101-cs-LC7"><span>foreach</span> (<span>var</span> <span>slide</span> <span>in</span> <span>slides</span>)</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L8" data-line-number="8"></td>
        <td id="file-clippit-101-cs-LC8">{</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L9" data-line-number="9"></td>
        <td id="file-clippit-101-cs-LC9">    <span>var</span> <span>targetPath</span> <span>=</span> <span>Path</span>.<span>Combine</span>(<span>targetDir</span>, <span>Path</span>.<span>GetFileName</span>(<span>slide</span>.<span>FileName</span>))</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L10" data-line-number="10"></td>
        <td id="file-clippit-101-cs-LC10">    <span>slide</span>.<span>SaveAs</span>(<span>targetPath</span>);</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L11" data-line-number="11"></td>
        <td id="file-clippit-101-cs-LC11">}</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L12" data-line-number="12"></td>
        <td id="file-clippit-101-cs-LC12">
</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L13" data-line-number="13"></td>
        <td id="file-clippit-101-cs-LC13"><span><span>//</span> Compose slides back into one presentation</span></td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L14" data-line-number="14"></td>
        <td id="file-clippit-101-cs-LC14"><span>var</span> <span>sources</span> <span>=</span> <span>slides</span>.<span>Select</span>(<span>x</span> <span>=&gt;</span> <span>new</span> <span>SlideSource</span>(<span>x</span>, <span>keepMaster</span>:<span>true</span>)).<span>ToList</span>();</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L15" data-line-number="15"></td>
        <td id="file-clippit-101-cs-LC15"><span>PresentationBuilder</span>.<span>BuildPresentation</span>(<span>sources</span>)</td>
      </tr>
      <tr>
        <td id="file-clippit-101-cs-L16" data-line-number="16"></td>
        <td id="file-clippit-101-cs-LC16">    .<span>SaveAs</span>(<span>newFileName</span>);</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>

<p><em>P.S. Stay tuned, there will be more OpenXml goodness.</em></p>
			</div><!-- .entry-content -->

	<!-- .entry-footer -->
</article></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>