<!DOCTYPE html>
<html lang="en">
<head>
    <title>
How I&#x27;m able to take notes in mathematics lectures using LaTeX and Vim -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>How I'm able to take notes in mathematics lectures using LaTeX and Vim</h1><div><div><p>I start­ed using LaTeX to write lec­ture notes in the sec­ond se­mes­ter of my bach­e­lor in math­e­mat­ics, and I’ve been using it ever since,
which makes for a total of more than 1700 pages of notes.
To give you an idea of what those notes look like, here are some ex­am­ples:</p><p><a class="gatsby-resp-image-link" href="/static/ba66c52b01c8fe6b31c97af52b5eb7f7/359dd/ca1.png" target="_blank" rel="noopener"><span class="gatsby-resp-image-wrapper"><span class="gatsby-resp-image-background-image"><img class="gatsby-resp-image-image" alt="ca1" title="" src="/static/ba66c52b01c8fe6b31c97af52b5eb7f7/f9fff/ca1.png" srcset="/static/ba66c52b01c8fe6b31c97af52b5eb7f7/00fd1/ca1.png 170w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/4982e/ca1.png 340w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/f9fff/ca1.png 680w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/90acf/ca1.png 1020w,
/static/ba66c52b01c8fe6b31c97af52b5eb7f7/359dd/ca1.png 1173w" sizes="(max-width: 680px) 100vw, 680px"></span></span></a><a class="gatsby-resp-image-link" href="/static/1a393ac73dbb96f6fbd98b258e8a325a/1d982/ca2.png" target="_blank" rel="noopener"><span class="gatsby-resp-image-wrapper"><span class="gatsby-resp-image-background-image"><img class="gatsby-resp-image-image" alt="ca2" title="" src="/static/1a393ac73dbb96f6fbd98b258e8a325a/f9fff/ca2.png" srcset="/static/1a393ac73dbb96f6fbd98b258e8a325a/00fd1/ca2.png 170w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/4982e/ca2.png 340w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/f9fff/ca2.png 680w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/90acf/ca2.png 1020w,
/static/1a393ac73dbb96f6fbd98b258e8a325a/1d982/ca2.png 1163w" sizes="(max-width: 680px) 100vw, 680px"></span></span></a><a class="gatsby-resp-image-link" href="/static/cb323a2ec665d98f93f78e13d3972e0e/41b08/ca3.png" target="_blank" rel="noopener"><span class="gatsby-resp-image-wrapper"><span class="gatsby-resp-image-background-image"><img class="gatsby-resp-image-image" alt="ca3" title="" src="/static/cb323a2ec665d98f93f78e13d3972e0e/f9fff/ca3.png" srcset="/static/cb323a2ec665d98f93f78e13d3972e0e/00fd1/ca3.png 170w,
/static/cb323a2ec665d98f93f78e13d3972e0e/4982e/ca3.png 340w,
/static/cb323a2ec665d98f93f78e13d3972e0e/f9fff/ca3.png 680w,
/static/cb323a2ec665d98f93f78e13d3972e0e/90acf/ca3.png 1020w,
/static/cb323a2ec665d98f93f78e13d3972e0e/41b08/ca3.png 1155w" sizes="(max-width: 680px) 100vw, 680px"></span></span></a></p><p>These lec­ture notes — in­clud­ing fig­ures — are made while at­tend­ing the lec­ture and have not been edit­ed af­ter­wards.
To make note tak­ing using LaTeX vi­able, I had four goals in mind:</p><ul><li>Writ­ing text and math­e­mat­i­cal for­mu­las in LaTeX should be as fast as the lec­tur­er writ­ing on a black­board: no delay is ac­cept­able.</li><li>Draw­ing fig­ures should be al­most as fast as the lec­tur­er.</li><li>Man­ag­ing notes, i.e. adding a note, com­pil­ing all my notes, com­pil­ing the last two lec­tures, search­ing in notes, etc. should be easy and quick.</li><li>An­no­tat­ing pdf doc­u­ments using LaTeX should be pos­si­ble for when I want to write notes along­side a pdf doc­u­ment.</li></ul><p>This blog post will focus on the first item: writ­ing LaTeX.</p><h2 id="vim-and-latex">Vim and LaTeX</h2><p>For writ­ing text and math­e­mat­i­cal for­mu­las in LaTeX, I use Vim.
Vim is a pow­er­ful gen­er­al pur­pose text ed­i­tor that’s very ex­ten­si­ble.
I use it for writ­ing code, LaTeX, mark­down, … ba­si­cal­ly every­thing that’s text-​based.
It has a fair­ly steep learn­ing curve, but once you’ve got the ba­sics down, it’s hard to get back to an ed­i­tor with­out Vim key­bind­ings.
Here’s what my screen looks like when I’m edit­ing LaTeX:</p><p><a class="gatsby-resp-image-link" href="/static/4282d15d03150c89182ab56634d2b4b0/97817/vimzathura.png" target="_blank" rel="noopener"><span class="gatsby-resp-image-wrapper"><span class="gatsby-resp-image-background-image"><img class="gatsby-resp-image-image" alt="Vim and Zathura" title="" src="/static/4282d15d03150c89182ab56634d2b4b0/f9fff/vimzathura.png" srcset="/static/4282d15d03150c89182ab56634d2b4b0/00fd1/vimzathura.png 170w,
/static/4282d15d03150c89182ab56634d2b4b0/4982e/vimzathura.png 340w,
/static/4282d15d03150c89182ab56634d2b4b0/f9fff/vimzathura.png 680w,
/static/4282d15d03150c89182ab56634d2b4b0/90acf/vimzathura.png 1020w,
/static/4282d15d03150c89182ab56634d2b4b0/f8275/vimzathura.png 1360w,
/static/4282d15d03150c89182ab56634d2b4b0/97817/vimzathura.png 1919w" sizes="(max-width: 680px) 100vw, 680px"></span></span></a></p><p>On the left you see Vim and on the right my pdf view­er, <a href="https://en.wikipedia.org/wiki/Zathura_(document_viewer)" target="_blank" rel="nofollow noopener noreferrer">Za­thu­ra</a>, which also has Vim-​like key­bind­ings.
I’m using Ubun­tu with <a href="https://github.com/baskerville/bspwm" target="_blank" rel="nofollow noopener noreferrer">bspwm</a> as my win­dow man­ag­er.
The LaTeX plu­g­in I’m using in Vim is <a href="https://github.com/lervag/vimtex" target="_blank" rel="nofollow noopener noreferrer">vim­tex</a>.
It pro­vides syn­tax high­light­ing, table of con­tents view, sync­tex, etc.
Using <a href="https://github.com/junegunn/vim-plug" target="_blank" rel="nofollow noopener noreferrer">vim-​plug</a>, I con­fig­ured it as fol­lows:</p><div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim">Plug <span class="token string">'lervag/vimtex'</span><span class="token keyword">let</span> g<span class="token punctuation">:</span>tex_flavor<span class="token operator">=</span><span class="token string">'latex'</span><span class="token keyword">let</span> g<span class="token punctuation">:</span>vimtex_view_method<span class="token operator">=</span><span class="token string">'zathura'</span><span class="token keyword">let</span> g<span class="token punctuation">:</span>vimtex_quickfix_mode<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">set</span> conceallevel<span class="token operator">=</span><span class="token number">1</span><span class="token keyword">let</span> g<span class="token punctuation">:</span>tex_conceal<span class="token operator">=</span><span class="token string">'abdmg'</span></code></pre></div><p>The last two lines con­fig­ure the con­ceal­ment.
This is a fea­ture where LaTeX code is re­placed or made in­vis­i­ble when your cur­sor is not on that line.
By mak­ing <code class="language-text">\[</code>, <code class="language-text">\]</code>, <code class="language-text">$</code> in­vis­i­ble, they’re less ob­tru­sive which gives you a bet­ter overview of the doc­u­ment. This fea­ture also re­places <code class="language-text">\bigcap</code> by by <code class="language-text">∩</code>, <code class="language-text">\in</code> by <code class="language-text">∈</code> etc.
The fol­low­ing an­i­ma­tion should make that clear.</p><p><img src="/d362e0b837be308b0f8897482a331ec6/conceal.gif" alt="conceal"></p><p>With this set up, I come to the crux of this blog post: writ­ing LaTeX as fast as the lec­tur­er can write on the black­board.
This is where snip­pets come into play.</p><h2 id="snippets">Snippets</h2><h3 id="whats-a-snippet">What’s a snippet?</h3><p>A snip­pet is a short reusable piece of text that can be trig­gered by some other text.
For ex­am­ple, when I type <code class="language-text">sign</code> and press <kbd>Tab</kbd>, the word <code class="language-text">sign</code> will be ex­pand­ed to a sig­na­ture:</p><p><img src="/5ab28b1ad6114b68f4ce459d4f89eeae/sign.gif" alt="sign"></p><p>Snip­pets can also be dy­nam­ic: when I type <code class="language-text">today</code> and press <kbd>Tab</kbd>, the word <code class="language-text">today</code> will be re­placed by the cur­rent date, and <code class="language-text">box</code><kbd>Tab</kbd> be­comes a box that au­to­mat­i­cal­ly grows in size.</p><p><img src="/1b6301a6561d104b4bc79654cb75470d/today.gif" alt="today"></p><p><img src="/8b7caefc472eae0941f41365d16e8d2d/box.gif" alt="box"></p><p>You can even use one snip­pet in­side an­oth­er:</p><p><img src="/cdd1fded48947d163c2e5e6b974cfec0/todaybox.gif" alt="todaybox"></p><h3 id="using-ultisnips-to-create-snippets">Using UltiSnips to create snippets</h3><p>I use the plu­g­in <a href="https://github.com/SirVer/ultisnips" target="_blank" rel="nofollow noopener noreferrer">Ul­tiSnips</a> to man­age my snip­pets. My con­fig­u­ra­tion is</p><div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim">Plug <span class="token string">'sirver/ultisnips'</span><span class="token keyword">let</span> g<span class="token punctuation">:</span>UltiSnipsExpandTrigger <span class="token operator">=</span><span class="token string">'&lt;tab&gt;'</span><span class="token keyword">let</span> g<span class="token punctuation">:</span>UltiSnipsJumpForwardTrigger <span class="token operator">=</span><span class="token string">'&lt;tab&gt;'</span><span class="token keyword">let</span> g<span class="token punctuation">:</span>UltiSnipsJumpBackwardTrigger <span class="token operator">=</span><span class="token string">'&lt;s-tab&gt;'</span></code></pre></div><p>The code for the <code class="language-text">sign</code> snip­pet is the fol­low­ing:</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">sign </span><span class="token name">"Signature"</span></span>
Yours sincerely,

Gilles Castel
<span class="token keyword">endsnippet</span></code></pre></div><p>For dy­nam­ic snip­pets, you can put code be­tween back­ticks <code class="language-text">``</code> which will be run when the snip­pet is ex­pand­ed.
Here, I’ve used bash to for­mat the cur­rent date: <code class="language-text">date + %F</code>.</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">today </span><span class="token name">"Date"</span></span>
`date +%F`
<span class="token keyword">endsnippet</span></code></pre></div><p>You can also use Python in­side a <code class="language-text">`!p ... `</code> block.
Have a look at the code for the <code class="language-text">box</code> snip­pet:</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">box </span><span class="token name">"Box"</span></span>
`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span><span class="token string">'┌'</span><span class="token operator">+</span><span class="token string">'─'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'┐'</span>`</span>
│ <span class="token tabstop">$1</span> │
`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span><span class="token string">'└'</span><span class="token operator">+</span><span class="token string">'─'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'┘'</span>`</span><span class="token tabstop">$0</span><span class="token keyword">endsnippet</span></code></pre></div><p>These Python code blocks will be re­placed by the value of the vari­able <code class="language-text">snip.rv</code>.
In­side these blocks, you have ac­cess to the cur­rent state of the snip­pet, e.g. <code class="language-text">t[1]</code> con­tains the first tab stop, <code class="language-text">fn</code> the cur­rent file­name, …</p><h2 id="latex-snippets">LaTeX snippets</h2><p>Using snip­pets, writ­ing LaTeX is a lot faster than writ­ing it by hand.
Es­pe­cial­ly some of the more com­plex snip­pets can save you a lot of time and frus­tra­tion.  Let’s begin with some sim­ple snip­pets.</p><h3 id="environments">Environments</h3><p>To in­sert an en­vi­ron­ment, all I have to do is type <code class="language-text">beg</code> at the be­gin­ning of a line.
Then I type the name of the en­vi­ron­ment, which is mir­rored in the <code class="language-text">\end{}</code> com­mand. Press­ing <kbd>Tab</kbd> places the cur­sor in­side the newly cre­at­ed en­vi­ron­ment.</p><p><img src="/d5ed641a9cb568d13dd56d98fec6376b/beginend.gif" alt="beginend"></p><p>The code for this snip­pet is the fol­low­ing.</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">beg </span><span class="token name">"begin{} / end{}"</span><span class="token flags">bA</span></span>
\begin{<span class="token tabstop">$1</span>}
	<span class="token tabstop">$0</span>
\end{<span class="token tabstop">$1</span>}
<span class="token keyword">endsnippet</span></code></pre></div><p>The <code class="language-text">b</code> means that this snip­pet will only be ex­pand­ed at the be­gin­ning of a line and <code class="language-text">A</code> stands for auto ex­pand, which means I do not have to press <kbd>Tab</kbd> to ex­pand the snip­pet. Tab stops — i.e. places you can jump to by press­ing <kbd>Tab</kbd> and <kbd>Shift</kbd>+<kbd>Tab</kbd> — are rep­re­sent­ed by <code class="language-text">$1</code>, <code class="language-text">$2</code>, … and the last one with <code class="language-text">$0</code>.</p><h3 id="inline-and-display-math">Inline and display math</h3><p>Two of my most fre­quent­ly used snip­pets are <code class="language-text">mk</code> and <code class="language-text">dm</code>.
They’re the snip­pets re­spon­si­ble for start­ing math mode.
The first one is a snip­pet for in­line math, the sec­ond one for dis­played math.</p><p><img src="/12a16b6a90c4d85a887c7cde0f18bb8c/mkdm.gif" alt="mkdm"></p><p>The snip­pet for in­line math is ‘smart’: it knows when to in­sert a space after the dol­lar sign.
When I start typ­ing a word di­rect­ly be­hind the clos­ing <code class="language-text">$</code>, it adds a space.
How­ev­er, when I type a non-​word char­ac­ter, it does not add a space, which would be pre­ferred for ex­am­ple in the case of <code class="language-text">$p$-value</code>.</p><p><img src="/1172a1f556fd36b42f7c3642b3952e2c/mk_space.gif" alt="mk_space"></p><p>The code for this snip­pet is the fol­low­ing.</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">mk </span><span class="token name">"Math"</span><span class="token flags">wA</span></span>
$<span class="token tabstop">${1}</span>$`<span class="token inline">!p</span><span class="token python"><span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">and</span> t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">not</span><span class="token keyword">in</span><span class="token punctuation">[</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">'.'</span><span class="token punctuation">,</span><span class="token string">'?'</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    snip<span class="token punctuation">.</span>rv <span class="token operator">=</span><span class="token string">' '</span><span class="token keyword">else</span><span class="token punctuation">:</span>
    snip<span class="token punctuation">.</span>rv <span class="token operator">=</span><span class="token string">''</span>
`</span><span class="token tabstop">$2</span><span class="token keyword">endsnippet</span></code></pre></div><p>The <code class="language-text">w</code> at the end of the first line means that this snip­pet will ex­pand at word bound­aries, so e.g. <code class="language-text">hellomk</code> won’t ex­pand, but <code class="language-text">hello mk</code> will.</p><p>The snip­pet for dis­played math is more sim­ple, but it also is quite handy; it makes me never for­get end­ing equa­tions with a pe­ri­od.</p><p><img src="/a682e97365ecfe19fe0c5bc08bacfec6/dm.gif" alt="dm"></p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">dm </span><span class="token name">"Math"</span><span class="token flags">wA</span></span>
\[
<span class="token tabstop">$1</span>
.\] <span class="token tabstop">$0</span><span class="token keyword">endsnippet</span></code></pre></div><h3 id="sub--and-superscripts">Sub- and superscripts</h3><p>An­oth­er use­ful snip­pet is one for sub­scripts.
It changes changes <code class="language-text">a1</code> to <code class="language-text">a_1</code> and <code class="language-text">a_12</code> to <code class="language-text">a_{12}</code>.</p><p><img src="/f26633cb822c6b52d346dfbba6e1a1bd/subscripts.gif" alt="subscripts"></p><p>The code for this snip­pet uses a reg­u­lar ex­pres­sion for its trig­ger.
It ex­pands the snip­pet when you type a char­ac­ter fol­lowed by a digit, which en­cod­ed by <code class="language-text">[A-Za-z]\d</code>, or a char­ac­ter fol­lowed by <code class="language-text">_</code> and two dig­its: <code class="language-text">[A-Za-z]_\d\d</code>.</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">'([A-Za-z])(\d)' </span><span class="token name">"auto subscript"</span><span class="token flags">wrA</span></span>
`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>`_`!p snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>`</span><span class="token keyword">endsnippet</span><span class="token snippet">snippet <span class="token trigger">'([A-Za-z])_(\d\d)' </span><span class="token name">"auto subscript2"</span><span class="token flags">wrA</span></span>
`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>`_<span class="token punctuation">{</span>`!p snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>`</span>}
<span class="token keyword">endsnippet</span></code></pre></div><p>When you wrap parts of a reg­u­lar ex­pres­sion in a group using paren­the­sis, e.g. <code class="language-text">(\d\d)</code>, you can use them in the ex­pan­sion of the snip­pet via <code class="language-text">match.group(i)</code> in Python.</p><p>As for su­per­scripts, I use <code class="language-text">td</code>, which be­comes <code class="language-text">^{}</code>.  How­ev­er, for squared, cubed, com­ple­ment and a hand­ful of other com­mon ones, I use ded­i­cat­ed snip­pets such as <code class="language-text">sr</code>, <code class="language-text">cb</code> and <code class="language-text">comp</code>.</p><p><img src="/da855cd9e67c48f508fab5ddc8c877fe/superscripts.gif" alt="superscripts"></p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">sr </span><span class="token name">"^2"</span><span class="token flags">iA</span></span>
^2
<span class="token keyword">endsnippet</span><span class="token snippet">snippet <span class="token trigger">cb </span><span class="token name">"^3"</span><span class="token flags">iA</span></span>
^3
<span class="token keyword">endsnippet</span><span class="token snippet">snippet <span class="token trigger">compl </span><span class="token name">"complement"</span><span class="token flags">iA</span></span>
^{c}
<span class="token keyword">endsnippet</span><span class="token snippet">snippet <span class="token trigger">td </span><span class="token name">"superscript"</span><span class="token flags">iA</span></span>
^{<span class="token tabstop">$1</span>}<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span></code></pre></div><h3 id="fractions">Fractions</h3><p>One of my most con­ve­nient snip­pets is one for frac­tions. This makes the fol­low­ing ex­pan­sions:</p><table><thead><tr><th align="right"></th><th></th><th align="left"></th></tr></thead><tbody><tr><td align="right"><code class="language-text">//</code></td><td>→</td><td align="left"><code class="language-text">\frac{}{}</code></td></tr><tr><td align="right"><code class="language-text">3/</code></td><td>→</td><td align="left"><code class="language-text">\frac{3}{}</code></td></tr><tr><td align="right"><code class="language-text">4\pi^2/</code></td><td>→</td><td align="left"><code class="language-text">\frac{4\pi^2}{}</code></td></tr><tr><td align="right"><code class="language-text">(1 + 2 + 3)/</code></td><td>→</td><td align="left"><code class="language-text">\frac{1 + 2 + 3}{}</code></td></tr><tr><td align="right"><code class="language-text">(1+(2+3)/)</code></td><td>→</td><td align="left"><code class="language-text">(1 + \frac{2+3}{})</code></td></tr><tr><td align="right"><code class="language-text">(1 + (2+3))/</code></td><td>→</td><td align="left"><code class="language-text">\frac{1 + (2+3)}{}</code></td></tr></tbody></table><p><img src="/3f83f1bdc3078aa16382e80a276f199f/frac.gif" alt="frac"></p><p>The code for the first one is easy:</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">// </span><span class="token name">"Fraction"</span><span class="token flags">iA</span></span>
\\frac{<span class="token tabstop">$1</span>}{<span class="token tabstop">$2</span>}<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span></code></pre></div><p>The sec­ond and third ex­am­ples are made pos­si­ble using reg­u­lar ex­pres­sions to match for ex­pres­sions like <code class="language-text">3/</code>, <code class="language-text">4ac/</code>, <code class="language-text">6\pi^2/</code>, <code class="language-text">a_2/</code>, etc.</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">'((\d+)|(\d*)(\\)?([A-Za-z]+)((\^|_)(\{\d+\}|\d))*)/' </span><span class="token name">"Fraction"</span><span class="token flags">wrA</span></span>
\\frac{`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>`</span>}{<span class="token tabstop">$1</span>}<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span></code></pre></div><p>As you can see, reg­u­lar ex­pres­sions can be­come quite over­whelm­ing, but here’s a di­a­gram that should ex­plain it:</p><p><img src="/908df5ec254f9cd5b08b99b8a54318d0/regex.svg" alt="Diagram of the regular expression"></p><p>In the fourth and fifth cases, it tries to find the match­ing paren­the­sis. As this isn’t pos­si­ble using the reg­u­lar ex­pres­sion en­gine of Ul­tiSnips, I re­sort­ed to using Python:</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token keyword">priority</span> 1000
<span class="token snippet">snippet <span class="token trigger">'^.*\)/' </span><span class="token name">"() Fraction"</span><span class="token flags">wrA</span></span>
`<span class="token inline">!p</span><span class="token python">
stripped <span class="token operator">=</span> match<span class="token punctuation">.</span>string<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
depth <span class="token operator">=</span><span class="token number">0</span>
i <span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>stripped<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token keyword">while</span><span class="token boolean">True</span><span class="token punctuation">:</span><span class="token keyword">if</span> stripped<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">')'</span><span class="token punctuation">:</span> depth <span class="token operator">+=</span><span class="token number">1</span><span class="token keyword">if</span> stripped<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'('</span><span class="token punctuation">:</span> depth <span class="token operator">-=</span><span class="token number">1</span><span class="token keyword">if</span> depth <span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token keyword">break</span><span class="token punctuation">;</span>
	i <span class="token operator">-=</span><span class="token number">1</span>
snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> stripped<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"\\frac{"</span><span class="token operator">+</span> stripped<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"}"</span>
`</span>{<span class="token tabstop">$1</span>}<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span></code></pre></div><p>The last snip­pet con­cern­ing frac­tions I’d like to share is one that uses your se­lec­tion to make a frac­tion.  You can use it by first se­lect­ing some text, then press­ing <kbd>Tab</kbd>, typ­ing <code class="language-text">/</code> and press­ing <kbd>Tab</kbd> again.</p><p><img src="/0da01b9566dc437fabf0c563ed14941f/visualfrac.gif" alt="visualfrac"></p><p>The code makes use of the <code class="language-text">${VISUAL}</code> vari­able that rep­re­sents your se­lec­tion.</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">/ </span><span class="token name">"Fraction"</span><span class="token flags">iA</span></span>
\\frac{<span class="token tabstop">${VISUAL}</span>}{<span class="token tabstop">$1</span>}<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span></code></pre></div><h3 id="sympy-and-mathematica">Sympy and Mathematica</h3><p>An­oth­er cool — but less used — snip­pet is one that uses <a href="https://www.sympy.org/" target="_blank" rel="nofollow noopener noreferrer">sympy</a> to eval­u­ate math­e­mat­i­cal ex­pres­sions. For ex­am­ple: <code class="language-text">sympy</code><kbd>Tab</kbd> ex­pands to <code class="language-text">sympy | sympy</code>, and <code class="language-text">sympy 1 + 1 sympy</code><kbd>Tab</kbd> ex­pands to <code class="language-text">2</code>.</p><p><img src="/8c8f143fdcdc2f3e6de9853cf7ea3def/sympy.gif" alt="sympy"></p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">sympy </span><span class="token name">"sympy block "</span><span class="token flags">w</span></span>
sympy <span class="token tabstop">$1</span> sympy<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span><span class="token keyword">priority</span> 10000
<span class="token snippet">snippet <span class="token trigger">'sympy(.*)sympy' </span><span class="token name">"evaluate sympy"</span><span class="token flags">wr</span></span>
`<span class="token inline">!p</span><span class="token python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span><span class="token operator">*</span>
x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> t <span class="token operator">=</span> symbols<span class="token punctuation">(</span><span class="token string">'x y z t'</span><span class="token punctuation">)</span>
k<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n <span class="token operator">=</span> symbols<span class="token punctuation">(</span><span class="token string">'k m n'</span><span class="token punctuation">,</span> integer<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> h <span class="token operator">=</span> symbols<span class="token punctuation">(</span><span class="token string">'f g h'</span><span class="token punctuation">,</span> cls<span class="token operator">=</span>Function<span class="token punctuation">)</span>
init_printing<span class="token punctuation">(</span><span class="token punctuation">)</span>
snip<span class="token punctuation">.</span>rv <span class="token operator">=</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">'latex('</span><span class="token operator">+</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span> \
    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'^'</span><span class="token punctuation">,</span><span class="token string">'**'</span><span class="token punctuation">)</span> \
    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'{'</span><span class="token punctuation">,</span><span class="token string">'('</span><span class="token punctuation">)</span> \
    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">,</span><span class="token string">')'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">')'</span><span class="token punctuation">)</span>
`</span><span class="token keyword">endsnippet</span></code></pre></div><p>For the Math­e­mat­i­ca users out there, you can do some­thing sim­i­lar:</p><p><img src="/82f7f187a685a52ed7665fded563f936/mathematica.gif" alt="mathematica"></p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token keyword">priority</span> 1000
<span class="token snippet">snippet <span class="token trigger">math </span><span class="token name">"mathematica block"</span><span class="token flags">w</span></span>
math <span class="token tabstop">$1</span> math<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span><span class="token keyword">priority</span> 10000
<span class="token snippet">snippet <span class="token trigger">'math(.*)math' </span><span class="token name">"evaluate mathematica"</span><span class="token flags">wr</span></span>
`<span class="token inline">!p</span><span class="token python"><span class="token keyword">import</span> subprocess
code <span class="token operator">=</span><span class="token string">'ToString['</span><span class="token operator">+</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">', TeXForm]'</span>
snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'wolframscript'</span><span class="token punctuation">,</span><span class="token string">'-code'</span><span class="token punctuation">,</span> code<span class="token punctuation">]</span><span class="token punctuation">)</span>
`</span><span class="token keyword">endsnippet</span></code></pre></div><h3 id="postfix-snippets">Postfix snippets</h3><p>Some other snip­pets I find worth shar­ing are post­fix snip­pets.
Ex­am­ples of such snip­pets are <code class="language-text">phat</code> → <code class="language-text">\hat{p}</code> and <code class="language-text">zbar</code> → <code class="language-text">\overline{z}</code>.
A sim­i­lar snip­pet is a post­fix vec­tor, for ex­am­ple <code class="language-text">v,.</code> → <code class="language-text">\vec{v}</code> and <code class="language-text">v.,</code> → <code class="language-text">\vec{v}</code>.
The order of <code class="language-text">,</code> and <code class="language-text">.</code> doesn’t mat­ter, so I can press them both at the same time.
These snip­pets are a real time-​saver, be­cause you can type in the same order the lec­tur­er writes on the black­board.</p><p><img src="/7c2e62aae292bc4d65eae363c816e206/barhatvec.gif" alt="barhatvec"></p><p>Note that I can still use <code class="language-text">bar</code> and <code class="language-text">hat</code> pre­fix too, as I’ve added them with a lower pri­or­i­ty.
The code for those snip­pets is:</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token keyword">priority</span> 10
<span class="token snippet">snippet <span class="token trigger">"bar" </span><span class="token name">"bar"</span><span class="token flags">riA</span></span>
\overline{<span class="token tabstop">$1</span>}<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span><span class="token keyword">priority</span> 100
<span class="token snippet">snippet <span class="token trigger">"([a-zA-Z])bar" </span><span class="token name">"bar"</span><span class="token flags">riA</span></span>
\overline{`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv<span class="token operator">=</span>match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>`</span>}
<span class="token keyword">endsnippet</span></code></pre></div><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token keyword">priority</span> 10
<span class="token snippet">snippet <span class="token trigger">"hat" </span><span class="token name">"hat"</span><span class="token flags">riA</span></span>
\hat{<span class="token tabstop">$1</span>}<span class="token tabstop">$0</span><span class="token keyword">endsnippet</span><span class="token keyword">priority</span> 100
<span class="token snippet">snippet <span class="token trigger">"([a-zA-Z])hat" </span><span class="token name">"hat"</span><span class="token flags">riA</span></span>
\hat{`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv<span class="token operator">=</span>match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>`</span>}
<span class="token keyword">endsnippet</span></code></pre></div><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">"(\\?\w+)(,\.|\.,)" </span><span class="token name">"Vector postfix"</span><span class="token flags">riA</span></span>
\vec{`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv<span class="token operator">=</span>match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>`</span>}
<span class="token keyword">endsnippet</span></code></pre></div><h3 id="other-snippets">Other snippets</h3><p>I have about 100 other com­mon­ly used snip­pets.
They are avail­able <a href="https://github.com/gillescastel/latex-snippets" target="_blank" rel="nofollow noopener noreferrer">here</a>.
Most of them are quite sim­ple.
For ex­am­ple, <code class="language-text">!&gt;</code> be­comes <code class="language-text">\mapsto</code>, <code class="language-text">-&gt;</code> be­comes <code class="language-text">\to</code>, etc.</p><p><img src="/4ee36ef41c17f1ded1fffe13ba32b60d/complex5.gif" alt="complex5"></p><p><code class="language-text">fun</code> be­comes <code class="language-text">f: \R \to \R :</code>, <code class="language-text">!&gt;</code> → <code class="language-text">\mapsto</code>, <code class="language-text">-&gt;</code> → <code class="language-text">\to</code>, <code class="language-text">cc</code> → <code class="language-text">\subset</code>.</p><p><img src="/a45092c95d91059b779f74cedda840e1/fun3.gif" alt="fun3"></p><p><code class="language-text">lim</code> be­comes <code class="language-text">\lim_{n \to \infty}</code>, <code class="language-text">sum</code> → <code class="language-text">\sum_{n = 1}^{\infty}</code>, <code class="language-text">ooo</code> → <code class="language-text">\infty</code></p><p><img src="/2be9c99e6ab5787fc5196bbf4ce525a7/sum4.gif" alt="sum4"></p><p><img src="/3be522f5e6e5ca7f871138732ba1b14d/bazel2.gif" alt="bazel2"></p><h3 id="course-specific-snippets">Course specific snippets</h3><p>Be­side my com­mon­ly used snip­pets, I also have course spe­cif­ic snip­pets.
These are loaded by adding the fol­low­ing to my <code class="language-text">.vimrc</code>:</p><p>where <code class="language-text">current_course</code> is a <a href="https://en.wikipedia.org/wiki/Symbolic_link" target="_blank" rel="nofollow noopener noreferrer">sym­link</a> to my cur­rent­ly ac­ti­vat­ed course (more about that in an­oth­er blog post).
In that fold­er, I have a file <code class="language-text">~/current_course/UltiSnips/tex.snippets</code> in which I in­clude course spe­cif­ic snip­pets. For ex­am­ple, for quan­tum me­chan­ics, I have snip­pets for bra/ket no­ta­tion.</p><table><thead><tr><th align="right"></th><th></th><th align="left"></th></tr></thead><tbody><tr><td align="right"><code class="language-text">&lt;a|</code></td><td>→</td><td align="left"><code class="language-text">\bra{a}</code></td></tr><tr><td align="right"><code class="language-text">&lt;q|</code></td><td>→</td><td align="left"><code class="language-text">\bra{\psi}</code></td></tr><tr><td align="right"><code class="language-text">|a&gt;</code></td><td>→</td><td align="left"><code class="language-text">\ket{a}</code></td></tr><tr><td align="right"><code class="language-text">|q&gt;</code></td><td>→</td><td align="left"><code class="language-text">\ket{\psi}</code></td></tr><tr><td align="right"><code class="language-text">&lt;a|b&gt;</code></td><td>→</td><td align="left"><code class="language-text">\braket{a}{b}</code></td></tr></tbody></table><p>As <code class="language-text">\psi</code> is used a lot in quan­tum me­chan­ics, I re­place all in­stances of <code class="language-text">q</code> in a braket with <code class="language-text">\psi</code> when ex­pand­ed.</p><p><img src="/268d331fdb83b6fa3563b6f2b0baac66/braket.gif" alt="braket"></p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token snippet">snippet <span class="token trigger">"\&lt;(.*?)\|" </span><span class="token name">"bra"</span><span class="token flags">riA</span></span>
\bra{`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">,</span> f<span class="token string">'\psi'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">,</span> f<span class="token string">'\phi'</span><span class="token punctuation">)</span>`</span>}
<span class="token keyword">endsnippet</span><span class="token snippet">snippet <span class="token trigger">"\|(.*?)\&gt;" </span><span class="token name">"ket"</span><span class="token flags">riA</span></span>
\ket{`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">,</span> f<span class="token string">'\psi'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">,</span> f<span class="token string">'\phi'</span><span class="token punctuation">)</span>`</span>}
<span class="token keyword">endsnippet</span><span class="token snippet">snippet <span class="token trigger">"(.*)\\bra{(.*?)}([^\|]*?)\&gt;" </span><span class="token name">"braket"</span><span class="token flags">riA</span></span>
`<span class="token inline">!p</span><span class="token python"> snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>`\braket<span class="token punctuation">{</span>`!p snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>`<span class="token punctuation">}</span><span class="token punctuation">{</span>`!p snip<span class="token punctuation">.</span>rv <span class="token operator">=</span> match<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">,</span> f<span class="token string">'\psi'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">,</span> f<span class="token string">'\phi'</span><span class="token punctuation">)</span>`</span>}
<span class="token keyword">endsnippet</span></code></pre></div><h3 id="context">Context</h3><p>One thing to con­sid­er when writ­ing these snip­pets is, ‘will these snip­pets col­lide with usual text?’
For ex­am­ple, ac­cord­ing to my dic­tio­nary, there are about 72 words in Eng­lish and 2000 words in Dutch that con­tain <code class="language-text">sr</code>, which means that while I’m typ­ing the word <code class="language-text">disregard</code>, the <code class="language-text">sr</code> would ex­pand to <code class="language-text">^2</code>, giv­ing me <code class="language-text">di^2egard</code>.</p><p>The so­lu­tion to this prob­lem is adding a <em>con­text</em> to snip­pets. Using the syn­tax high­light­ing of Vim, it can be de­ter­mined whether or not Ul­tiSnips should ex­pand the snip­pet de­pend­ing if you’re in math or text.  I came up with the fol­low­ing:</p><div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">global</span> !p
texMathZones <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'texMathZone'</span><span class="token operator">+</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'AS'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'BS'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'CS'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">'DS'</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">,</span><span class="token string">'ES'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">,</span><span class="token string">'FS'</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">,</span><span class="token string">'GS'</span><span class="token punctuation">,</span><span class="token string">'H'</span><span class="token punctuation">,</span><span class="token string">'HS'</span><span class="token punctuation">,</span><span class="token string">'I'</span><span class="token punctuation">,</span><span class="token string">'IS'</span><span class="token punctuation">,</span><span class="token string">'J'</span><span class="token punctuation">,</span><span class="token string">'JS'</span><span class="token punctuation">,</span><span class="token string">'K'</span><span class="token punctuation">,</span><span class="token string">'KS'</span><span class="token punctuation">,</span><span class="token string">'L'</span><span class="token punctuation">,</span><span class="token string">'LS'</span><span class="token punctuation">,</span><span class="token string">'DS'</span><span class="token punctuation">,</span><span class="token string">'V'</span><span class="token punctuation">,</span><span class="token string">'W'</span><span class="token punctuation">,</span><span class="token string">'X'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token string">'Z'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

texIgnoreMathZones <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'texMathText'</span><span class="token punctuation">]</span>

texMathZoneIds <span class="token operator">=</span> vim<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">'map('</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>texMathZones<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">", 'hlID(v:val)')"</span><span class="token punctuation">)</span>
texIgnoreMathZoneIds <span class="token operator">=</span> vim<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">'map('</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>texIgnoreMathZones<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">", 'hlID(v:val)')"</span><span class="token punctuation">)</span>

ignore <span class="token operator">=</span> texIgnoreMathZoneIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">def</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	synstackids <span class="token operator">=</span> vim<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"synstack(line('.'), col('.') - (col('.')&gt;=2 ? 1 : 0))"</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>
		first <span class="token operator">=</span><span class="token builtin">next</span><span class="token punctuation">(</span>
            i <span class="token keyword">for</span> i <span class="token keyword">in</span><span class="token builtin">reversed</span><span class="token punctuation">(</span>synstackids<span class="token punctuation">)</span><span class="token keyword">if</span> i <span class="token keyword">in</span> texIgnoreMathZoneIds <span class="token operator">or</span> i <span class="token keyword">in</span> texMathZoneIds
        <span class="token punctuation">)</span><span class="token keyword">return</span> first <span class="token operator">!=</span> ignore
	<span class="token keyword">except</span> StopIteration<span class="token punctuation">:</span><span class="token keyword">return</span><span class="token boolean">False</span>
endglobal</code></pre></div><p>Now you can add <code class="language-text">context "math()"</code> to the snip­pets you’d only want to ex­pand in a math­e­mat­i­cal con­text.</p><div class="gatsby-highlight" data-language="snip"><pre class="language-snip"><code class="language-snip"><span class="token keyword">context</span> "math()"
<span class="token snippet">snippet <span class="token trigger">sr </span><span class="token name">"^2"</span><span class="token flags">iA</span></span>
^2
<span class="token keyword">endsnippet</span></code></pre></div><p>Note that a ‘math­e­mat­i­cal con­text’ is a sub­tle thing.
Some­times you add some text in­side a math en­vi­ron­ment by using <code class="language-text">\text{...}</code>.
In that case, you do not want snip­pets to ex­pand.
How­ev­er, in the fol­low­ing case: <code class="language-text">\[ \text{$...$} \]</code>, they <em>should</em> ex­pand.
This is why the code for the <code class="language-text">math</code> con­text is a bit com­pli­cat­ed.
The fol­low­ing an­i­ma­tion il­lus­trates these sub­tleties.</p><p><img src="/e1b3ca2dd4fc1f5fe39679fb6ba38aad/syntaxtree.gif" alt="syntaxtree"></p><h2 id="correcting-spelling-mistakes-on-the-fly">Correcting spelling mistakes on the fly</h2><p>While in­sert­ing math­e­mat­ics is an im­por­tant part of my note-​taking setup, most of the time I’m typ­ing Eng­lish. At about 80 words per minute, my typ­ing skills are not bad, but I still make a lot of typos.
This is why I added a key­bind­ing to Vim that cor­rects the spelling mis­takes, with­out in­ter­rupt­ing my flow. When I press <kbd>Ctrl+L</kbd> while I’m typ­ing, the pre­vi­ous spelling mis­take is cor­rect­ed. It looks like this:</p><p><img src="/0add705683b79cb94498104251a6d5b8/spellcheck.gif" alt="spellcheck"></p><p>My con­fig­u­ra­tion for spell check is the fol­low­ing:</p><div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim"><span class="token keyword">setlocal</span><span class="token builtin">spell</span><span class="token keyword">set</span><span class="token builtin">spelllang</span><span class="token operator">=</span>nl<span class="token punctuation">,</span>en_gb
inoremap <span class="token operator">&lt;</span>C<span class="token operator">-</span><span class="token keyword">l</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token keyword">c</span><span class="token operator">-</span>g<span class="token operator">&gt;</span><span class="token keyword">u</span><span class="token operator">&lt;</span>Esc<span class="token operator">&gt;</span><span class="token punctuation">[</span>s1z<span class="token operator">=</span>`<span class="token punctuation">]</span>a<span class="token operator">&lt;</span><span class="token keyword">c</span><span class="token operator">-</span>g<span class="token operator">&gt;</span><span class="token keyword">u</span></code></pre></div><p>It ba­si­cal­ly jumps to the pre­vi­ous spelling mis­take <code class="language-text">[s</code>, then picks the first sug­ges­tion <code class="language-text">1z=</code>, and then jumps back <code class="language-text">`]a</code>. The <code class="language-text">&lt;c-g&gt;u</code> in the mid­dle make it pos­si­ble to undo the spelling cor­rec­tion quick­ly.</p><h2 id="in-conclusion">In conclusion</h2><p>Using snip­pets in Vim, writ­ing LaTeX is no longer an an­noy­ance, but rather a plea­sure.
In com­bi­na­tion with spell check on the fly, it al­lows for a com­fort­able math­e­mat­i­cal note-​taking setup.
A few pieces are miss­ing though, for ex­am­ple draw­ing fig­ures dig­i­tal­ly and em­bed­ding them in a LaTeX doc­u­ment. This is a topic I’d like to tack­le in a fu­ture blog post.</p><p>Liked this blog post? Con­sid­er <a href="/coffee">buy­ing me a cof­fee</a>!</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>