<!DOCTYPE html>
<html lang="en">
<head>
    <title>
EF Core In depth &#x2013; Tips and techniques for configuring EF Core &#x2013; The Reformed Programmer - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="EF Core In depth &#x2013; Tips and techniques for configuring EF Core &#x2013; The Reformed Programmer - linksfor.dev(s)"/>
    <meta property="og:description" content="Created: July 17, 2020"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.thereformedprogrammer.net/ef-core-in-depth-tips-and-techniques-for-configuring-ef-core/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - EF Core In depth &#x2013; Tips and techniques for configuring EF Core &#x2013; The Reformed Programmer</title>
<div class="readable">
        <h1>EF Core In depth &#x2013; Tips and techniques for configuring EF Core &#x2013; The Reformed Programmer</h1>
            <div>Reading time: 21-26 minutes</div>
        <div>Posted here: 17 Jul 2020</div>
        <p><a href="https://www.thereformedprogrammer.net/ef-core-in-depth-tips-and-techniques-for-configuring-ef-core/">https://www.thereformedprogrammer.net/ef-core-in-depth-tips-and-techniques-for-configuring-ef-core/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div>

		<p><span>Created: July 17, 2020</span>
					</p>

		
<p>This article is being more efficient at configuring your EF Core DbContext that runs fast and safe. As a working freelance developer, I’m always looking for ways to make me a more efficient/faster developer. While configuring a DbContext is really important there can be a lot of configuration code, but over the years I have found ways to minimise or automate much of the EF Core configurations. This article pulls together lots of configuration approaches I have learnt working with EF Core, and EF6 before that.</p>



<p>I do assume you know EF Core, but I start with a look at EF Core’s configuration of your application’s DbContext to make sure we have the basics before I dig into the various tips and techniques to make you faster and safer.</p>



<p>This article is part of a “EF Core In depth” series. Here is the current list of articles in this series:</p>



<ul><li><a href="https://www.thereformedprogrammer.net/ef-core-in-depth-what-happens-when-ef-core-reads-from-the-database/">EF Core In depth – what happens when EF Core reads from the database?</a></li><li><a href="https://www.thereformedprogrammer.net/ef-core-in-depth-what-happens-when-ef-core-writes-to-the-database/">EF Core In depth – what happens when EF Core writes to the database?</a></li><li><a href="https://www.thereformedprogrammer.net/ef-core-in-depth-soft-deleting-data-with-global-query-filters/">EF Core In depth – Soft deleting data with Global Query Filters</a></li><li>EF Core In depth – Tips and techniques for configuring EF Core<strong> (this article)</strong></li></ul><p>Other older articles in this series are</p>



<ul><li><a href="https://www.thereformedprogrammer.net/handling-entity-framework-core-database-migrations-in-production-part-1/">Handling Entity Framework Core migrations: creating a migration – Part 1</a></li><li><a href="https://www.thereformedprogrammer.net/handling-entity-framework-core-database-migrations-in-production-part-2/">Handling Entity Framework Core migrations: applying a migration – Part 2</a></li></ul><p>This “EF Core In depth” series is inspired by what I found while updating my book “<a href="https://bit.ly/EfCoreBook2">Entity Framework Core in Action</a>” to cover EF Core 5. I am also added a LOT of new content from my experiences of working with EF Core on client applications over the last 2½ years.</p>



<blockquote><p>NOTE: There is a GitHub repo at <a href="https://github.com/JonPSmith/EfCoreinAction-SecondEdition/tree/Part2">https://github.com/JonPSmith/EfCoreinAction-SecondEdition/tree/Part2</a> that contains all the code used in this article.</p></blockquote>



<h2 id="tldr-summary">TL;DR – summary<a href="#tldr-summary"></a></h2>



<ul><li>EF Core builds a Model of the database based on the DbSet&lt;T&gt; classes and various configuration methods. It does NOT look at the actual database.</li><li>EF Core uses three approaches to configure your application’s DbContext<ul><li>By Convention, which applied a set of rules to the properties types/names to work out a default configuration.</li></ul><ul><li>Attributes: It will look for certain annotations, like [MaxLength(123)] to add more configurations.</li></ul><ul><li>Fluent API: Finally, it runs OnModelCreating method in the application’s DbContext where you can place Fluent API commands.</li></ul></li><li>Learning/following EF Core’s By Convention rules will save you a LOT of time and code. It is especially good at configuring one-to-many relationships.</li><li>If you want your database to be quick it is worth defining the SQL type a bit more tightly for certain NET types, like string, DateTime, decimal.</li><li>These are some more advanced entity types that are useful. I talk about owned types, Table-per-Hierarchy and table splitting.</li><li>When your application gets big your configuration can be split into per-class configurations, which makes it easier to find/refactor.</li><li>There is a really helpful technique that can automate some of the configuring. It allows you to define you own By Convention and have it applied to all classes/properties you have defined.</li></ul><h2 id="setting-the-scene-what-is-happening-when-you-configure-your-dbcontext">Setting the scene – what is happening when you<a> </a>configure your DbContext<a href="#setting-the-scene-what-is-happening-when-you-configure-your-dbcontext"></a></h2>



<p>To use EF Core you must create a class that inherits EF Core’s DbContext (I refer to this as your <em>application’s DbContext</em>). In this class you add DbSet&lt;T&gt; properties that set up the mapping between your classes (I refer to these as <em>entity classes</em>) and the database. The following listing is a very basic application’s DbContext without any extra configuration.</p>


<div><div id="highlighter_151451"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p></td><td><div><p><code>public</code> <code>class</code> <code>EfCoreContext : DbContext </code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>EfCoreContext(DbContextOptions&lt;EfCoreContext&gt; options)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>: </code><code>base</code><code>(options) {}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>DbSet&lt;Book&gt; Books { </code><code>get</code><code>; </code><code>set</code><code>; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>DbSet&lt;Author&gt; Authors { </code><code>get</code><code>; </code><code>set</code><code>; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>DbSet&lt;PriceOffer&gt; PriceOffers { </code><code>get</code><code>; </code><code>set</code><code>; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p></div></td></tr></tbody></table></div></div>


<p>When I talk about “configuring EF Core”, or “configure your DbContext” I’m talking about a process the EF Core does on the first use of your application’s DbContext. At that point is creates a Model of the database you plan to access based on your entity classes mapped to the database and any EF Core configuration commands you have provided.</p>



<p>Just to be clear, it never looks at the actual database to build this Model; it only uses the entity classes and any EF Core configuration commands you have added. How EF Core’s Model of the database and the actual database need to match otherwise your application will fail when it tried to access the database.</p>



<blockquote><p>NOTE: I cover the whole area of how to make changes to a database in the two articles <a href="https://www.thereformedprogrammer.net/handling-entity-framework-core-database-migrations-in-production-part-1/">Handling Entity Framework Core migrations: creating a migration – Part 1</a> and <a href="https://www.thereformedprogrammer.net/handling-entity-framework-core-database-migrations-in-production-part-2/">Handling Entity Framework Core migrations: applying a migration – Part 2</a></p></blockquote>



<p>The following figure shows the process that EF Core goes through the first time you use your application’s DbContext (later instances of your DbContext use a cached version of the created Model).</p>







<figure><img src="https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/EF-Core-modelling-the-database-1024x697.png" alt="" srcset="https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/EF-Core-modelling-the-database-1024x697.png 1024w, https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/EF-Core-modelling-the-database-300x204.png 300w, https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/EF-Core-modelling-the-database-768x523.png 768w, https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/EF-Core-modelling-the-database.png 1090w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>EF Core uses three ways to pick up configure information</p>



<ol type="1"><li><strong>By Convention:</strong> When you follow simple rules on property types and names, EF Core will autoconfigure many of the software and database features. For instance<ol><li>A property of NET type <em>string</em> will, by default, map to SQL <em>NVARCHAR(max)</em> <em>NULL</em></li></ol><ol><li>A property with the name <em>Id </em>or <em>&lt;ClassName&gt;Id</em> (e.g. BookId) will be the primary key for this entity class.</li></ol></li><li><strong>Data Annotations:</strong> A range of .NET attributes, known as Data Annotations, can be added to entity classes and/or properties to provide extra configuration information. For instance<ol><li>Adding the attribute <em>[MaxLength(100)]</em> on string property will change the SQL to &nbsp;<em>NVARCHAR(<strong>100</strong>) NULL</em></li></ol><ol><li>Adding the attribute <em>[Required]</em> on string property will change the SQL to <em>NVARCHAR(max)</em> <strong>NOT</strong> <em>NULL.</em></li></ol></li><li>Fluent API: EF Core has a method called OnModelCreating that’s run when the EF context is first used. You can override this method and add commands, known as the Fluent API. For instance<ol><li>The command <em>modelBuilder.Entity&lt;Book&gt;().Property(p =&gt; p.Price).HasIndex()</em> would add a non-unique index to the Price column in the table mapped to the Book entity class.</li></ol><ol><li>The command <em>modelBuilder.Entity&lt;Book&gt;().Property(p =&gt; p.PublishedDate).HasColumnType(“date”) </em>would change the SQL type from DATETIME2, which has a resolution of 100ns, to the much smaller SQL DATE type that is accurate to the one day.</li></ol></li></ol><p>Read on for tips on how to use these three approaches to a) write the minimum of configuration code and b) get a good database design.</p>



<h2 id="tip-let-ef-core-do-most-of-the-configuring-using-by-convention-rules">Tip: Let EF Core do most of the configuring using By Convention rules<a href="#tip-let-ef-core-do-most-of-the-configuring-using-by-convention-rules"></a></h2>



<p>Most of you will already using the By Convention rules to set up the column names and types. If you are control over the database design, known as its <em>schema</em>, i.e. you can use whatever column names that suit you, which will save you from writing a lot of boring configuration code.</p>



<p>By when it comes to relationships some developers seem to what to define every relationship. When I first started using EF6 I did just that, but ended up with a lot of code! Once I understood EF Core’s By Convention rules (writing the <a href="https://bit.ly/EfCoreBook2">EF Core In Action book</a> taught me the rules!), then I rarely defined a relationship unless I want to change the delete behaviour (I talk about delete behaviour later). The relationships rules are pretty simple</p>



<ol type="1"><li>Name your primary key as <em>Id </em>or <em>&lt;ClassName&gt;Id</em> (e.g. BookId).</li><li>Use the <em>&lt;ClassName&gt;Id</em> name on your foreign key, because that works with both primary key formats, i.e. <em>Id </em>or <em>&lt;ClassName&gt;Id</em></li><li>Set up the property that links the two entity classes (known as navigational property) using the entity class type (the name doesn’t matter), e.g. <em>ICollection&lt;Review&gt; Reviews { get; set; }</em></li></ol><p>Here is a figure showing a relationship that EF Core’s By Convention will define automatically.</p>



<figure><img src="https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/One-to-many-class-relationship.png" alt="" srcset="https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/One-to-many-class-relationship.png 738w, https://www.thereformedprogrammer.net/wp-content/uploads/2020/07/One-to-many-class-relationship-300x78.png 300w" sizes="(max-width: 738px) 100vw, 738px"></figure><p>Of course, there are some exceptions where you would need Fluent API commands.</p>



<ul><li>EF Core can only configure a one-to-one relationship By Convention if both ends of the have navigational properties, otherwise it will think it’s a one-to-many relationship. But one-to-one relationships are a lot less used than one-to-many and many-to-many relationships.</li><li>If you want to change the delete rules from the By Convention value; for instance, what happens to the Reviews when the Book is deleted – in this case the Reviews would be deleted too. If you didn’t want that to happen then you would have to define the relationship using Fluent API commands and add the OnDelete command.</li><li>If you have two navigational properties going to the same class, for instance BillingAddress and DeliveryAddress both pointing to the Address entity class, then you do need to configure that manually (but an <a href="https://docs.microsoft.com/en-us/ef/core/modeling/owned-entities">Owned type</a> would be better for that).</li><li>Some very advanced things like setting the constraint name need Fluent API</li></ul><p>Overall you want to let EF Core configure as much as you can as its quick and easy. So, learn the rules and trust in EF Core (but unit tests are also good!)</p>



<h2 id="making-your-database-more-efficient">Making your database more efficient<a href="#making-your-database-more-efficient"></a></h2>



<p>Its easy to create classes, but entity classes need a little more attention to make sure the database is as fast as it can be. This requires a bit more work on your part. Here are some things to consider</p>



<h3 id="1-string-type-properties">1. string type properties<a href="#1-string-type-properties"></a></h3>



<p>By default, will set the SQL type to NVARCHAR(MAX) NULL works OK, but do you need space for a 1Gbyte Unicode character string? Here are some suggestions:</p>



<ul><li>Set the size of the string using [MaxLength(123)] attribute. NVARCHAR(NNN) is slightly quicker than NVARCHAR(MAX) and NVARCHAR(NNN) . NOTE The [MaxLength(123)] is also useful for front-end checking that the input isn’t too long.</li><li>If you filter or sort on a string, then adding an SQL index is useful. Use Fluent API command HasIndex() or the new EF Core 5 (preview 6) [Index(nameof(Title)] attribute. NOTE an index has a limit of 900 bytes, so your NVARCHAR must be 450 or lower.</li><li>Some strings are 8-bit ASCII, like URLs, so why send/return the other bytes. Use Fluent API command IsUnicode(false), which will turn the SQL type from NVARCHAR to VARCHAR.</li><li>Try adding the [Required(AllowEmptyStrings = false)] attribute on strings you expect to contain a string. The [Required] part will change the SQL type from NVARCHAR(MAX) NULL to NVARCHAR(MAX) NOT NULL (the AllowEmptyStrings = false part doesn’t affect the database; it is only used in any NET validations).</li></ul><h3 id="2-datetime-type-properties">2. DateTime type properties<a href="#2-datetime-type-properties"></a></h3>



<p>By default, NET’s DateTime type is saved as SQL DATETIME2, which has a resolution of 100ns and take up 7 bytes. In some cases that is great, but SQL DATE type is only 3 bytes. As well as saving bytes a sort or filter of a DATE type is going to be much quicker sort/filter than on a DATETIME2 type.</p>



<p>NOTE: If you save a DateTime that is using DateTimeKind.Utc, then you should know that the DateTimeKind of a DateTime is not preserved in the database. That matters if your front-end is going to send the data using JSON, as the JSON datatime string won’t end with a “Z” and your front-end might get the date offset right. You can fix this using EF Core’s <a href="https://docs.microsoft.com/en-us/ef/core/modeling/value-conversions">ValueConverters</a> – (<em>add a comment to this article if you want to know how to do that</em>).</p>



<h3 id="3-decimal-type-properties">3. decimal type properties<a href="#3-decimal-type-properties"></a></h3>



<p>By default, a NET decimal type is saved as DECIMAL(18,2), which is SQL Servers default, which means it has 16 digits before the decimal point and 2 after the decimal point and takes up 9 bytes. If your dealing with money that might be too big, and DECIMAL(9,2) would work and that’s only 5 bytes.</p>



<p>On the other hand, if you’re dealing with percent, then having a precision of 2 decimal places might not be enough, and 16 digits before the decimal point is too much.</p>



<p>In both cases its worth changing the default precision (i.e. number of digits stored) and scale (i.e. number of digits after the decimal point). You can do that via the [Column(Datatype=”decimal(9,2)”)] or the Fluent API command HasColumnType(”decimal(9,2)”) command. But in EF Core 5 there is a really nice Fluent API called HasPrecision(9,2), which is easier.</p>



<h3 id="4-avoid-lambda-properties">4. Avoid lambda properties<a href="#4-avoid-lambda-properties"></a></h3>



<p>In a normal class having a lambda property as shown below is the right thing to do.</p>


<div><div id="highlighter_418609"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p></td><td><div><p><code>public</code> <code>class</code> <code>MyClass</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>FirstName { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>LastName { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>FullName =&gt; $</code><code>"{FirstName} {LastName}"</code><code>;</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<p>The problem comes when you want to sort/filter on the FullName – EF Core will throw an exception because there is no FullName column to sort/filter on. So you need to add an actual FullName property that will be mapped to the database, and you either set the properties via a constructor, or use EF Core’s <a href="https://docs.microsoft.com/en-us/ef/core/modeling/backing-field">backing fields</a> to capture a software change to the FirstName/LastName and set the FullName</p>


<div><div id="highlighter_834431"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p></td><td><div><p><code>public</code> <code>class</code> <code>MyClassImproved</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>private</code> <code>string</code> <code>_firstName;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>private</code> <code>string</code> <code>_lastName;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>FirstName</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>get</code> <code>=&gt; _firstName;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>set</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>_firstName = value;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>FullName = $</code><code>"{FirstName} {LastName}"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>LastName</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>get</code> <code>=&gt; _lastName;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>set</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>_lastName = value;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>FullName = $</code><code>"{FirstName} {LastName}"</code><code>;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>FullName { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<blockquote><p>NOTE: Another option in EF Core 5 (preview 5) is <a href="https://docs.microsoft.com/en-us/ef/core/what-is-new/ef-core-5.0/whatsnew#stored-persisted-computed-columns">stored (persisted) computed columns</a> which allow you to have a FullName column that runs the SQL command FirstName + ‘ ‘ + LastName whenever the row is created or updates. Its efficient and SQL Server allows indexes on persisted computed columns too.</p></blockquote>



<h2 id="lets-take-about-some-more-advanced-entity-types">Let’s take about some more advanced entity types<a href="#lets-take-about-some-more-advanced-entity-types"></a></h2>



<p>Using normal entity classes with links other entity classes works, but there are some variants of classes that can make your life easier and can improve performance. Here are some specific EF Core class types</p>



<ul><li><a href="https://docs.microsoft.com/en-us/ef/core/modeling/owned-entities">Owned types</a> – useful for common data that used in lots of places, e.g. Address</li><li><a href="https://docs.microsoft.com/en-us/ef/core/modeling/inheritance">Table per hierarchy (TPH)</a>—This maps a series of inherited classes to one table; for instance, classes called Dog, Cat, and Rabbit that inherit from the Animal class</li><li><a href="https://docs.microsoft.com/en-us/ef/core/modeling/table-splitting">Table splitting</a> – Lets you map multiple classes to a table. Useful if you want a Summary part and a Detailed part.</li></ul><p>I have used Owned types a lot and its great for keeping a specific group of data together. I have also used TPH quite a bit on client systems where there is common data with a few differences – really worth looking at. I haven’t used table spitting much because I normally use Select queries to pick the exact properties/columns I want anyway.</p>



<p>I’m only going to cover the Owned types because this article is pretty long already, and I still want to show more things.</p>



<h3 id="owned-entity-types">Owned entity types<a href="#owned-entity-types"></a></h3>



<p>Owned entity types are classes that you can add to an entity class and the data in owned types will be combined into the entity class’s table. To make this more concrete, think about an address. An address is a group of Street, City, State etc. properties that, on their own, aren’t that useful as they need to link to a company, a user, a delivery location and so on. &nbsp;</p>



<p>The owned type class doesn’t have its own primary key, so doesn’t have an identity of its own but relies on the entity class that “owns” it for its identity. In DDD terms, owned types are known as value objects. This also means you can use owned type multiple times in an entity class – see the example OrderInfo class with two addresses in it.</p>


<div><div id="highlighter_516052"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p></td><td><div><p><code>public</code> <code>class</code> <code>OrderInfo</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>int</code> <code>OrderInfoId { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>OrderNumber { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>Address BillingAddress { </code><code>get</code><code>; </code><code>set</code><code>; } </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>Address DeliveryAddress { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<p>The address class must be marked as an Owned type either by the [Owned] attribute or via Fluent API. The code below uses the [Owned] attribute (highlighed)</p>


<div><div id="highlighter_269026"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p></td><td><div><p><code>[Owned]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>public</code> <code>class</code> <code>Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>NumberAndStreet { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>City { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>ZipPostCode { </code><code>get</code><code>; </code><code>set</code><code>; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>string</code> <code>CountryCodeIso2 { </code><code>get</code><code>; </code><code>set</code><code>; }</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<p>Now when you look at the SQL table generated by ED Core it looks like this</p>


<div><div id="highlighter_378651"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p></td><td><div><p><code>CREATE</code> <code>TABLE</code> <code>[Orders] (</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[OrderInfoId] </code><code>int</code> <code>NOT</code> <code>NULL</code> <code>IDENTITY,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[OrderNumber] nvarchar(</code><code>max</code><code>) </code><code>NULL</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[BillingAddress_City] nvarchar(</code><code>max</code><code>) </code><code>NULL</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[BillingAddress_NumberAndStreet] nvarchar(</code><code>max</code><code>) </code><code>NULL</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[BillingAddress_ZipPostCode] nvarchar(</code><code>max</code><code>) </code><code>NULL</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[BillingAddress_CountryCodeIso2] [nvarchar](2) </code><code>NULL</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[DeliveryAddress_City] nvarchar(</code><code>max</code><code>) </code><code>NULL</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[DeliveryAddress_CountryCodeIso2] nvarchar(</code><code>max</code><code>) </code><code>NULL</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[DeliveryAddress_NumberAndStreet] nvarchar(</code><code>max</code><code>) </code><code>NULL</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[DeliveryAddress_CountryCodeIso2] [nvarchar](2) </code><code>NULL</code><code>, </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>CONSTRAINT</code> <code>[PK_Orders] </code><code>PRIMARY</code> <code>KEY</code> <code>([OrderInfoId])</code></p><p><code>);</code></p></div></td></tr></tbody></table></div></div>


<p>As you can see the two Address class data, BillingAddress and DeliveryAddress,is added to the Orders table.</p>



<p>Few things to know about owned types:</p>



<ul><li>A property with a type that is Owned Type in an entity can be null, in which case all the columns in the table are null.</li><li>If an Owned Type contains a non-nullable property it is still stored in a nullable column in the database. That’s done to handle an Owned Type property being null</li><li>Nullable Owned Type properties were added in EF Core 3, but the SQL command wasn’t ideal. This is fixed in EF Core 5.</li><li>You can map an Owned Type for a separate table – I haven’t described that.</li></ul><h2 id="tip-how-to-organise-your-configuration-code">Tip: How to organise your configuration code<a href="#tip-how-to-organise-your-configuration-code"></a></h2>



<p>The Fluent API go in the OnModelCreating method in your application’s DbContext. For small projects that works fine, but once you start to get more and more Fluent API configrations it can get messy and hard to find. One solution is using the IEntityTypeConfiguration&lt;TEntity&gt; type. This allows you to have configurations for each entity class that needs it – see code below</p>


<div><div id="highlighter_833241"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p></td><td><div><p><code>internal</code> <code>class</code> <code>BookConfig : IEntityTypeConfiguration&lt;Book&gt;</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>public</code> <code>void</code> <code>Configure</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(EntityTypeBuilder&lt;Book&gt; entity)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entity.Property(p =&gt; p.PublishedOn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>.HasColumnType(</code><code>"date"</code><code>);&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entity.HasIndex(x =&gt; x.PublishedOn);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entity.Property(p =&gt; p.Price).HasPrecision(9,2);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entity.Property(x =&gt; x.ImageUrl).IsUnicode(</code><code>false</code><code>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entity.HasQueryFilter(p =&gt; !p.SoftDeleted);&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entity.HasOne(p =&gt; p.Promotion)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>.WithOne()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>.HasForeignKey&lt;PriceOffer&gt;(p =&gt; p.BookId);</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<p>You have a few options how to run these. You can call them inside your OnModelCreating method using the code below</p>


<div><div id="highlighter_152185"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p></td><td><div><p><code>protected</code> <code>override</code> <code>void</code> <code>OnModelCreating(ModelBuilder modelBuilder)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>modelBuilder.ApplyConfiguration(</code><code>new</code> <code>BookConfig());</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>modelBuilder.ApplyConfiguration(</code><code>new</code> <code>BookAuthorConfig());</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<p>Or you can use the ApplyConfigurationsFromAssembly command to find and run all your IEntityTypeConfiguration&lt;TEntity&gt; classes. The code below assumes those classes are in the same project as your application’s DbContext</p>


<div><div id="highlighter_667475"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p></td><td><div><p><code>protected</code> <code>override</code> <code>void</code> <code>OnModelCreating(ModelBuilder modelBuilder)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>modelBuilder.ApplyConfigurationsFromAssembly(</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Assembly.GetExecutingAssembly());</code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<h2 id="adding-your-configuration-rules-automatically">Adding your configuration rules automatically<a href="#adding-your-configuration-rules-automatically"></a></h2>



<p>One of the big things I learnt is how to automatically apply Fluent API commands to certain classes/properties. For example I will show you is how to define your own By Convention rules, for instance any entity class property of type decimal and the parameter’s name contains the string “Price” sets the SQL type set to DECIMAL(9,2).</p>



<p>This relies on the modelBuilder.Model.GetEntityTypes() method available in the OnModelCreating method. This provides a collection of all the entity classes that EF Core has found at this stage, and within that you can gain access to the properties in each entity class.</p>



<p>The piece of code taken from an application’s DbContext contains two rules</p>



<ul><li>Properties of type decimal, with “Price” in the parameter name is set to DECIMAL(9,2).</li><li>Properties of type string and the parameter name ends with “Url”, is set to VARCHAR</li></ul><div><div id="highlighter_432672"><table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p></td><td><div><p><code>protected</code> <code>override</code> <code>void</code> <code>OnModelCreating(ModelBuilder modelBuilder)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>foreach</code> <code>(</code><code>var</code> <code>entityType </code><code>in</code> <code>modelBuilder.Model.GetEntityTypes()) </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>foreach</code> <code>(</code><code>var</code> <code>entityProperty </code><code>in</code> <code>entityType.GetProperties())&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(entityProperty.ClrType == </code><code>typeof</code><code>(</code><code>decimal</code><code>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>&amp;&amp; entityProperty.Name.Contains(</code><code>"Price"</code><code>))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entityProperty.SetPrecision(9);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entityProperty.SetScale(2);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(entityProperty.ClrType == </code><code>typeof</code><code>(</code><code>string</code><code>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>&amp;&amp; entityProperty.Name.EndsWith(</code><code>"Url"</code><code>))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>entityProperty.SetIsUnicode(</code><code>false</code><code>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>} </code></p><p><code>}</code></p></div></td></tr></tbody></table></div></div>


<p>Those are just two that I use, plus one to sort out DateTimeKind on DateTime properties whose parameter name ends in “Utc”. I also use Query Filter setup <a href="https://www.thereformedprogrammer.net/ef-core-in-depth-soft-deleting-data-with-global-query-filters/#1-automating-the-configuring-of-the-soft-delete-query-filters">shown in the last article </a>to set up all my Query Filters; that way I can’t forget to set up a Query Filter.</p>



<h2 id="conclusion">Conclusion<a href="#conclusion"></a></h2>



<p>I have gone from explain how EF Core builds a Model of the database you want to access a using three different configuration approaches. Learning EF Core’s By Convention rules can cut down a LOT of configuration code, which saves you time and makes your configuration easier to understand.</p>



<p>I then talked about some of the NET types that might need to add some configuration code to make your database more efficient. I also touched on some of different types of class arrangement that EF Core can do, especially the Owned Type.</p>



<p>Finally, I cover different ways to configure your application’s DbContext, including a very helpful way to automate some of your configurations. I really like the automating configuration approach as it makes sure I haven’t missed anything, and it reduces the amount of configuration code I need to write.</p>



<p>Happy coding.</p>
	</div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>