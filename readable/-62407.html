<!DOCTYPE html>
<html lang="en">
<head>
    <title>
 - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content=" - linksfor.dev(s)"/>
    <meta property="og:description" content="The NanoVM is a java virtual machine for the &#xA;Atmel AVR ATmega8 CPU, the member of the AVR CPU family used&#xA;e.g. in the &#xA;DLR Asuro robot, manufactured by AREXX&#xA;engineering. With the NanoVM, the Asuro can be programmed in the&#xA;popular Java language using the standard Sun JDK. The NanoVM and&#xA;its tools are distributed under the GPL and can be used on other AVR&#xA;based systems as well."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="http://www.harbaum.org/till/nanovm/index.shtml"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - </title>
<div class="readable">
        <h1></h1>
            <div>Reading time: 11-13 minutes</div>
        <div>Posted here: 03 Jun 2020</div>
        <p><a href="http://www.harbaum.org/till/nanovm/index.shtml">http://www.harbaum.org/till/nanovm/index.shtml</a></p>
        <hr/>
<div id="readability-page-1" class="page">
<!-- begin of header -->



<center>Support this project:

or send me something from my <a href="http://www.amazon.de/registry/wishlist/QO3JUU50I0TL">Amazon wishlist</a>.
</center>


<!-- end of header -->

<h2>The NanoVM - Java for the AVR</h2>

<p>The NanoVM is a java virtual machine for the <a href="http://www.atmel.com/dyn/products/product_card.asp?part_id=2004">
Atmel AVR ATmega8 CPU</a>, the member of the <a href="http://en.wikipedia.org/wiki/AVR">AVR CPU family</a> used
e.g. in the <a href="http://www.dlr.de/st_op/aktuelles/pressemitteilungen/2003-006-ASURO">
DLR Asuro robot</a>, manufactured by <a href="http://www.arexx.com/arexx.php?cmd=goto&amp;cparam=p_asuro.dat">AREXX
engineering</a>. With the NanoVM, the Asuro can be programmed in the
popular Java language using the <a href="http://java.sun.com/j2se/">standard Sun JDK</a>. The NanoVM and
its tools are distributed under the GPL and can be used on other AVR
based systems as well.</p>

<p>The NanoVM for Asuro replaces the original firmware of the Asuro
with a <a href="http://en.wikipedia.org/wiki/Java_virtual_machine">
Java virtual machine</a> capable of running a subset of the virtual
machine command set. This enables e.g. the Asuro to interpret java
bytecode and to run simple java programs like e.g. <a href="http://www.harbaum.org/till/nanovm/AsuroLine.java">this one</a>.</p>

<p>The NanoVM is a very resource aware implementation of the java
vm. The Asuro version including a boot loader and several native
classes fit into the 8kBytes flash rom of the Asuros AVR ATmega8
CPU. The complete 512 Byte EEPROM space of the CPU are available as
Java program space and 75% of the 1 kByte RAM space are available to
the running Java program.</p>

<p>The current version of the NanoVM for Asuro includes:

</p><ul>
<li>Support for standard java bytecode</li>
<li>Tested on AVR Mega8 and Mega32</li>
<li>Configurable 15/31 bit integer arithmetic</li>
<li>Optional float support</li>
<li>Garbage collection</li>
<li>Bootloader for simple application upload</li>
<li>Tested with Suns JDK and IBMs jikes</li>
<li>Supports inheritance</li>
<li>Unified stack and heap architecture</li>
<li>Requires less than 8kBytes of code memory</li>
<li>at least 512 Bytes code storage for java byte code 
    (e.g. the complete 512 eeprom bytes available on the AVR ATmega8 CPU)</li>
<li>at least 768 Bytes application RAM available
    (of 1k total RAM available on the AVR ATmega8 CPU)</li>
<li>About 20k Java opcodes per second on 8 Mhz AVR</li>
<li>Native classes include:</li>
  <ul>
  <li>java/lang/Object (object handling)</li>
  <li>java/lang/System (IO handling)</li>
  <li>java/io/PrintStream (console output)</li>
  <li>java/lang/StringBuffer (string processing)</li>
  <li>asuro (asuro control)</li>
  <li>Native support for LCDs, AVR io etc</li>
</ul>
</ul>


<h2>What the NanoVM is and what it isn't</h2>

<p>There seems to be some confusion about what the NanoVM is and can do
and what it can't and isn't.</p>

<p>It is not a full featured Java VM and it will never be. It will
always be limited to a small subset of the java language and the
standard java libraries and a few application specific
methods. Furthermore, it is not meant to replace C as the standard way
of programming microcontrollers. It is less flexible and has a lower
performance than C or assembler programs.</p>

<p>The NanoVM is a way to provide a limited but controllable
programming interface to a microcontroller based device. With most of
the most hardware specific code being part of the NanoVM itself, the
user can focus on the application itself. If a user is given a device
equipped with the NanoVM he is not required to think about the
hardware itself. Furthermore, he doesn't need any target specific
compilers or the like. All he needs is a standard java compiler and
the NanoVMTool which itself is written in java. Thus, the whole
development chain works on any device that has a java compiler and can
run java code. With the hardware abstraction the NanoVM provides, the
user doesn't even have to care about the microcontroller type the
target is based on. The same java compiler and the same NanoVMTool can
be used with any NanoVM based system running on any type of
microontroller.</p>

<h2>Supported devices</h2>

<p>Although the NanoVM can be used for various purposes, it somehow
became especially popular with robotic development kits. The latest
NanoVM supports:</p>

<ul>
<li>The <a href="http://www.arexx.com/arexx.php?cmd=goto&amp;cparam=p_asuro">Asuro</a> was the first robot supported by the NanoVM,</li>
<li>it was then ported to the <a href="http://www.ctbot.de/">c't-Bot</a>,</li>
<li>and the <a href="http://www.nicai-systems.de/nibo.html">Nibo</a> was even designed for NanoVM support.</li>
</ul>

<h2>Files</h2>

<p>The NanoVM is distributed in three parts: The NanoVM itself to be installed on
the target (the Asuro), a Converter and Upload tool to convert java class
files into NanoVM format and to upload them onto the target and finally some
demo projects for the Asuro.</p>

<h2>Installing and using the NanoVM</h2>

<p>The NanoVM is a complete replacement of the 8kBytes program code available
inside the AVR CPU (see figure). Unlike the original Asuros bootloader, which
loads the applicaton into flash memory, the NanoVM uses the EEPROM to store
the program code. The usual C development chain translates any application
source code directly into native AVR specific code. Unlike this, the NanoVM
works with portable 
<a href="http://en.wikipedia.org/wiki/Java_programming_language">Java</a> 
<a href="http://en.wikipedia.org/wiki/Byte-code">byte code</a> which is
interpreted by the NanoVM during runtime.</p>

<center><img src="http://www.harbaum.org/till/nanovm/nanovm.gif"></center>

<p>Some AVRs like e.g. the ATmega8 that comes with the Asuro are
delivered preprogrammed to the user. The pre-installed bootloader
allows the user to upload further code onto the CPU. The Asuro
e.g. comes with a bootloader that allows to upload code via the IR
transmitter delivered with the Asuro. The NanoVM cannot be installed
using this mechanism, since the bootloader itself has to be replaced
as well. Instead the complete contents of the AVR CPU including the
bootloader have to be replaced. This requires the CPU to be placed in
some programming board like e.g. the <a href="http://www.atmel.com/dyn/products/tools_card.asp?tool_id=2735">
STK-500</a>. Alternally, <a href="http://www.harbaum.org/till/nanovm/iap.gif">a simple interface</a> (<a href="http://www.harbaum.org/till/nanovm/iap.jpg">photo of installed interface</a>) allows you to
reprogram the entire chip while its still placed in the Asuro. In both
cases the connection to the PC is done via a special <a href="http://www.harbaum.org/till/lcd2usb/avrisp.gif">AVR ISP programming cable</a> (see
e.g. these <a href="http://rumil.de/hardware/avrisp.html">DIY
instructions</a> if you want to build one yourself) connected to a PCs
printerport. The NanoVM itself is then being uploaded onto the chip
using a software like <a href="http://www.lancos.com/prog.html">Ponyprog</a> or <a href="http://savannah.nongnu.org/projects/uisp/">UISP</a>.</p>

<p>Since there's currently no way of making a backup of or to restore the
original bootloader in the ATmega8 shipped with the Asuro it is strongly
recommended to use a seperate ATmega8 CPU for the NanoVM. New
unprogrammed AVR ATmega8 CPUs are cheap!</p>

<p>The NanoVM itself contains its own bootloader. Once it is installed in the
target system like e.g. the Asuro it can use the IR interface to install Java
client programs. A special NanoVM tool (formerly Convert tool) is available
for the NanoVM to uplaod Java programs to the Asuro.</p>

<h2>Download</h2>

<p>As of 9/15/2005, the complete NanoVM incl. the source code and the binaries
for the asuro and other officially supported plattforms is distributed in one
archive. The rxtx installation script is meant to simplify the
installation of the gnu/rxtx java extension on linux PCs. This extension is
required to allow the NanoVMTool to access the PCs serial port to directly
upload applications to a NanoVM equipped device.</p>

<p>Find the latest version at the <a href="http://sourceforge.net/project/showfiles.php?group_id=181239&amp;package_id=209853">NanoVM download page at sourceforge</a>.</p>

<p>Old versions:
</p><ul>
<li><a href="http://www.harbaum.org/till/nanovm/nanovm-20060613.tgz">nanovm-20060613.tgz</a></li>
<li><a href="http://www.harbaum.org/till/nanovm/nanovm-20051217.tgz">nanovm-20051217.tgz</a></li>
<li><a href="http://www.harbaum.org/till/nanovm/nanovm-20051204.tgz">nanovm-20051204.tgz</a></li>
<li><a href="http://www.harbaum.org/till/nanovm/nanovm-20051201.tgz">nanovm-20051201.tgz</a></li>
<li><a href="http://www.harbaum.org/till/nanovm/nanovm-20050926.tgz">nanovm-20050926.tgz</a></li>
<li><a href="http://www.harbaum.org/till/nanovm/nanovm-20050915.tgz">nanovm-20050915.tgz</a></li>
<li><a href="http://www.harbaum.org/till/nanovm/install_rxtx.sh">Linux rxtx installation script</a></li>
</ul>

<p>If you are interested in the latest changes and are interested in
contributing to the NanoVM development, you can take a look at the
<a href="http://sourceforge.net/cvs/?group_id=181239">NanoVM CVS repository</a>.
</p>

<h2>Your contribution</h2>

<p>You want to contribute? Great! Here are some of the things that would
be a great contribution to NanoVM:

</p><ul>
<li>A NanoVM emulator that emulates the AVR, asuro, or other native
  methods on the PC would allow to e.g. test programs with a virtual
  asuro before uploading them to the real thing.</li>

<li>A simple graphical programming layer above java would allow even
  complete beginners to work with nanovm equipped devices. A simple
  drag 'n drop gui allowing to build simple flow control diagrams and
  then translating these into java would be all that's needed to
  accomplish this.</li>

<li>You have a better idea? You are welcome ...</li>

</ul>


<h2>History</h2>

<p>

Version 2006/06/13:
</p><ul>
<li>NanoVM 1.4, NanoVMTool 1.4</li>
<li>A new and more reliable upload protocol by Oliver Schulz</li>
<li>Code cleanups by Oliver Schulz</li>
<li>Float and 31 bit integer support by Nils Springob</li>
<li>Various small bug fixes</li>
</ul>

Version 2005/12/17:
<ul>
<li>NanoVM 1.3, NanoVMTool 1.3</li>
<li>Switched to <a href="http://www.rxtx.org/">rxtx</a> for java rs232
support (thanks to Oliver Schulz for this hint)</li>
<li>NanoVMTool now runs under Linux, Windows and MacOS</li>
</ul>

Version 2005/12/04:
<ul>
<li>NanoVM 1.3, NanoVMTool 1.2</li>
<li>Generic native LCD methods </li>
<li>Example configuration  for Atmega32</li>
<li>Schematics for test boards for Atmega8 and Atmega32</li>
<li>Expanded documentation (see <a href="http://www.mikrocontroller.net/articles/NanoVM">wiki (german)</a>)</li>
</ul>

Version 2005/12/01:
<ul>
<li>NanoVM 1.3, NanoVMTool 1.2</li>
<li>Generic ATmega8 classes for PWM and ADC </li>
<li>Simple InputStream support (serial input)</li>
<li>Added dup2 instruction and typecast instructions</li>
<li>GPL licensing verified</li>
</ul>

Version 2005/09/26:
<ul>
<li>NanoVM 1.2, NanoVMTool 1.1</li>
<li>seperate stack management</li>
<li>fixed Asuro compile</li>
</ul>

Version 2005/09/15:
<ul>
<li>NanoVM 1.1, NanoVMTool 1.1</li>
<li>initial source release</li>
<li>complete VM under GPL</li>
</ul>



<h2>TODO</h2>

<p>What's left? The VM itself is finished. It is not a full Java VM,
since it does not support exceptions, threads, floating point
arithmetic and various other things like e.g. inheritance from native
classes. Due to memory limitations, these things will probably never
be implemented for the Asuro and its ATmega8 CPU (keep in mind, that
everything has to fit into 8kBytes of code memory). The generic
version lacks a complete set of native classes in order to be really
useful to the end user.</p>

<p>The complete NanoVM is open source. Due to that, a plugin for
Eclipse might be possible to write. Furthermore, the NanoVM may easily
be ported to various other AVR based systems.</p>

<h2>A generic NanoVM for the Atmel AVR family</h2>

<p>It is possible to use the NanoVM for other projects than the
Asuro. The NanoVM for Asuro includes Asuro specific native classes
only. The NanoVM distribution includes several more generic native
classes for the AVR which can e.g. be used to directly work with the
AVRs IO ports, the AD converters, the PWM unit and the serial
interface. These native classes are now included in the source
archive. Several simple examples are included which show how to use
these generic native classes to build your own java controlled
AVR application.</p>

<p>The ATmega8 will very likely be the smallest AVR capable of running
the NanoVM. There's not much memory left in its 8kBytes flash (about
700 bytes are still free), so there isn't space for plenty of generic
native classes. With the bigger CPUs (there are AVRs with up to 32
times the code memory of the ATmega8), even the most complex native
classes should be possible incl. e.g. networking and wireless
support.</p>

<h2>External documentation and discussion</h2>
<ul>
<li><a href="http://www.mikrocontroller.net/articles/NanoVM">German Wiki
    entry with plenty of NanoVM details.</a></li>
<li><a href="http://www.ericengler.com/nanovm.aspx">User contributed page
   incl. english translation of the document above</a></li>
<li><a href="http://www.mikrocontroller.net/forum/read-1-230597.html">
    German thread on mikrocontroller.net about the NanoVM</a></li>
<li><a href="http://www.mikrocontroller.net/forum/read-1-233746.html">
    Another german thread on mikrocontroller.net about the NanoVM</a></li>
</ul>


<h2>Links</h2>

<ul>
<li><a href="http://sourceforge.net/projects/nanovm/">
    NanoVM at Sourceforge</a></li>
<li><a href="http://www.mikrocontroller.net/articles/NanoVM_Eclipse-Plugin">
    Eclipse plugin for nanovm</a></li>
<li><a href="http://www.mikrocontroller.net/">
    German web site focussed on microcontroller development.</a></li>
<li><a href="http://java.sun.com/products/javacomm/">The java.comm package 
    required for upload via the serial port</a></li>
<li><a href="http://www.rxtx.org/">RXTX: serial I/O libraries for Java</a></li>
<li><a href="http://www.jcontrol.org/download/readme_rxtx_en.html">Howto
    for installing rxtx/gnu.io under Linux</a></li>
<li><a href="http://java.sun.com/docs/books/vmspec/">Java virtual 
    machine specification</a></li>
<li><a href="http://www.qsl.net/zl1bpu/micro/ENV/PGM.htm">AVR ISP 
    programming cable</a></li>
<li><a href="http://www.atmel.com/dyn/products/tools_card.asp?tool_id=2735">
    Atmel STK500 AVR developer kit</a></li>
<li><a href="http://www.lancos.com/prog.html">Ponyprog AVR programming
    software for Windows</a> </li>
<li><a href="http://savannah.nongnu.org/projects/uisp/">UISP AVR
    programming software for Linux</a></li>
<li><a href="http://www.nicai-systems.de/nibo.html">
    robot construction kit Nibo</a></li>
<li><a href="http://swe.uni-duisburg-essen.de/en/members/schmidt/ctbot/index.php">The university of Duisburg-Essen is running the NanoVM on the c't-bot</a></li>
</ul>


<!-- the footer -->
<hr>

<!-- end of footer -->



</div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>