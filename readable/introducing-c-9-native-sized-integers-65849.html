<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Introducing C# 9: Native-sized integers - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Introducing C# 9: Native-sized integers - linksfor.dev(s)"/>
    <meta property="article:author" content="by anthonygiretti"/>
    <meta property="og:description" content="Introduction First what are native-sized integers ? They are designed to be a integer whose..."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://anthonygiretti.com/2020/08/19/introducing-c-9-native-sized-integers/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Introducing C# 9: Native-sized integers</title>
<div class="readable">
        <h1>Introducing C# 9: Native-sized integers</h1>
            <div>by by anthonygiretti</div>
            <div>Reading time: 5-6 minutes</div>
        <div>Posted here: 19 Aug 2020</div>
        <p><a href="https://anthonygiretti.com/2020/08/19/introducing-c-9-native-sized-integers/">https://anthonygiretti.com/2020/08/19/introducing-c-9-native-sized-integers/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><article id="post-19233">
			<!-- .entry-header -->
	
	<div>
						<div>
					<div>
											<!-- .entry-meta -->
				
				
<h2><strong>Introduction</strong></h2>



<p>First what are <strong>native-sized integers</strong> ? They are designed to be a integer whose size is specific to the platform. In other words, an instance of this type must be 32 bits on 32-bit and 64-bit hardware and operating systems on 64-bit hardware and operating systems.</p>



<p>The <strong>CLR / JIT / MSIL</strong> supports the definition and usage of native integers / unsigned integers. Since <strong>.NET 4.0’s CLR</strong>, it is possible to add / substract an integer from a <strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.</a></strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.intptr?view=netcore-3.1"><strong>IntPtr</strong> </a>/ <strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.UIntPtr</a></strong>, and it is possible to do&nbsp;<code>==</code>&nbsp;/&nbsp;<code>!=</code>&nbsp;comparisons with other <strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.</a></strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.intptr?view=netcore-3.1"><strong>IntPtr</strong> </a>/ <strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.UIntPtr</a></strong>, but any other comparison operation is prohibited…, i.e. they cannot be compared with&nbsp;<code>&gt;</code>,&nbsp;<code>&gt;=</code>&nbsp;etc. to each other, so <strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1"></a><strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.</a></strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.intptr?view=netcore-3.1"><strong>IntPtr</strong> </a>/ <strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.UIntPtr</a></strong></strong> remain very basic in the amount of pointer arithmetic.</p>



<p><a href="https://devblogs.microsoft.com/dotnet/welcome-to-c-9-0/">C# 9</a> brings what <a href="https://www.mono-project.com/">mono </a>has brought before: language support for a <strong>native-sized signed</strong> and <strong>unsigned integer types</strong> with <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nint </a></strong>and <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nuint</a></strong> keyword. The motivation here is for interop scenarios and for low-level libraries, so might not use them often.</p>



<p>Types <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nint</a></strong>&nbsp;and <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nuint</a></strong>&nbsp;are represented by the underlying types <strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.</a></strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.intptr?view=netcore-3.1"><strong>IntPtr</strong></a>&nbsp;and <strong><strong><a href="https://docs.microsoft.com/fr-fr/dotnet/api/system.uintptr?view=netcore-3.1">System.UIntPtr</a></strong></strong>&nbsp;with compiler surfacing additional conversions and operations for those types as native ints.</p>



<p>Sources: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">Microsoft </a>and <a href="https://github.com/dotnet/roslyn/issues/2788">Github</a></p>



<h2><strong>C# 9 syntax, constants and usage</strong></h2>



<p><strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nint</a></strong> constants are in the range [&nbsp;<code>int.MinValue</code>,&nbsp;<code>int.MaxValue</code>&nbsp;].</p>



<p><strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nuint</a></strong> constants are in the range [&nbsp;<code>uint.MinValue</code>,&nbsp;<code>uint.MaxValue</code>&nbsp;].</p>



<p>There are no <strong>MinValue</strong> or <strong>MaxValue</strong> o <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nint</a></strong>&nbsp;or <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nuint</a></strong> because, other than&nbsp;<strong>nuint.MinValue</strong>, those values cannot be emitted as constants.</p>



<p>Usage samples:</p>



<div id="gist104933950">
    <div>
      <div>
        <div>
  <div id="file-program-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-program-cs-L1" data-line-number="1"></td>
        <td id="file-program-cs-LC1"><span>public</span> <span>class</span> <span>Program</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L2" data-line-number="2"></td>
        <td id="file-program-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-program-cs-L3" data-line-number="3"></td>
        <td id="file-program-cs-LC3">    <span>public</span> <span>static</span> <span>void</span> <span>Main</span>(<span>string</span>[] <span>args</span>)</td>
      </tr>
      <tr>
        <td id="file-program-cs-L4" data-line-number="4"></td>
        <td id="file-program-cs-LC4">    {</td>
      </tr>
      <tr>
        <td id="file-program-cs-L5" data-line-number="5"></td>
        <td id="file-program-cs-LC5">        <span>nint</span> <span>x</span> <span>=</span> <span>3</span>;</td>
      </tr>
      <tr>
        <td id="file-program-cs-L6" data-line-number="6"></td>
        <td id="file-program-cs-LC6">        <span>int</span> <span>y</span> <span>=</span> <span>3</span>;</td>
      </tr>
      <tr>
        <td id="file-program-cs-L7" data-line-number="7"></td>
        <td id="file-program-cs-LC7">        <span>long</span> <span>v</span> <span>=</span> <span>10</span>;</td>
      </tr>
      <tr>
        <td id="file-program-cs-L8" data-line-number="8"></td>
        <td id="file-program-cs-LC8">
</td>
      </tr>
      <tr>
        <td id="file-program-cs-L9" data-line-number="9"></td>
        <td id="file-program-cs-LC9">        <span>nint</span>.<span>Equals</span>(<span>x</span>, <span>y</span>); <span><span>//</span> False</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L10" data-line-number="10"></td>
        <td id="file-program-cs-LC10">        <span>nint</span>.<span>Equals</span>(<span>x</span>, (<span>nint</span>)<span>y</span>); <span><span>//</span> True</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L11" data-line-number="11"></td>
        <td id="file-program-cs-LC11">
</td>
      </tr>
      <tr>
        <td id="file-program-cs-L12" data-line-number="12"></td>
        <td id="file-program-cs-LC12">        <span>var</span> <span>test1</span> <span>=</span> <span>y</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>x</span>; <span><span>//</span> True;</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L13" data-line-number="13"></td>
        <td id="file-program-cs-LC13">        <span>var</span> <span>test2</span> <span>=</span> <span>y</span> <span>-</span> <span>1</span> <span>==</span> <span>x</span>; <span><span>//</span> False</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L14" data-line-number="14"></td>
        <td id="file-program-cs-LC14">
</td>
      </tr>
      <tr>
        <td id="file-program-cs-L15" data-line-number="15"></td>
        <td id="file-program-cs-LC15">        <span>var</span> <span>test3</span> <span>=</span> <span>typeof</span>(<span>nint</span>); <span><span>//</span> System.IntPtr</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L16" data-line-number="16"></td>
        <td id="file-program-cs-LC16">        <span>var</span> <span>test4</span> <span>=</span> <span>typeof</span>(<span>nuint</span>); <span><span>//</span> System.UIntPtr</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L17" data-line-number="17"></td>
        <td id="file-program-cs-LC17">        <span>var</span> <span>test5</span> <span>=</span> (<span>x</span> <span>+</span> <span>1</span>).<span>GetType</span>(); <span><span>//</span> System.IntPtr</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L18" data-line-number="18"></td>
        <td id="file-program-cs-LC18">        <span>var</span> <span>test6</span> <span>=</span> (<span>x</span> <span>+</span> <span>y</span>).<span>GetType</span>(); <span><span>//</span> System.IntPtr</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L19" data-line-number="19"></td>
        <td id="file-program-cs-LC19">        <span>var</span> <span>test7</span> <span>=</span> (<span>x</span> <span>+</span> <span>v</span>).<span>GetType</span>(); <span><span>//</span> System.Int64</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L20" data-line-number="20"></td>
        <td id="file-program-cs-LC20">
</td>
      </tr>
      <tr>
        <td id="file-program-cs-L21" data-line-number="21"></td>
        <td id="file-program-cs-LC21">        <span>dynamic</span> <span>z</span> <span>=</span> <span>1</span>;</td>
      </tr>
      <tr>
        <td id="file-program-cs-L22" data-line-number="22"></td>
        <td id="file-program-cs-LC22">        <span>var</span> <span>test8</span> <span>=</span> <span>z</span> <span>+</span> <span>x</span>; <span><span>//</span> RuntimeBinderException: '+' cannot be applied 'System.IntPtr' and 'System.IntPtr'</span></td>
      </tr>
      <tr>
        <td id="file-program-cs-L23" data-line-number="23"></td>
        <td id="file-program-cs-LC23">    }</td>
      </tr>
      <tr>
        <td id="file-program-cs-L24" data-line-number="24"></td>
        <td id="file-program-cs-LC24">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>




<p>You can notice that when you add an <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/integral-numeric-types">int</a></strong> to a <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/integral-numeric-types">nint</a></strong> the result is a <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nint</a></strong>, but if you add a <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/integral-numeric-types"><strong>long </strong></a>to an <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/integral-numeric-types"><strong>nint </strong></a>the result will be a <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/integral-numeric-types">long</a></strong>. This is because the native depending on the platform could be a<strong> 32-bit integer </strong>or a <strong>64-bits integer</strong>.</p>



<p>Not that <strong>arrays </strong>supports <strong>native-sized signed</strong> type as index, but not <strong>lists </strong>for example:</p>



<div id="gist104934072">
    <div>
      <div>
        <div>
  <div id="file-countryservice-cs">
    

  <div itemprop="text">
      
<table data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-countryservice-cs-L1" data-line-number="1"></td>
        <td id="file-countryservice-cs-LC1"><span>public</span> <span>class</span> <span>CountryService</span></td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L2" data-line-number="2"></td>
        <td id="file-countryservice-cs-LC2">{</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L3" data-line-number="3"></td>
        <td id="file-countryservice-cs-LC3">    <span>public</span> <span>Country</span> <span>GetByIndex</span>(<span>Country</span>[] <span>countries</span>, <span>nint</span> <span>index</span>)</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L4" data-line-number="4"></td>
        <td id="file-countryservice-cs-LC4">    {</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L5" data-line-number="5"></td>
        <td id="file-countryservice-cs-LC5">        <span>return</span> <span>countries</span>[<span>index</span>]; <span><span>//</span> legal</span></td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L6" data-line-number="6"></td>
        <td id="file-countryservice-cs-LC6">    }</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L7" data-line-number="7"></td>
        <td id="file-countryservice-cs-LC7">
</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L8" data-line-number="8"></td>
        <td id="file-countryservice-cs-LC8">    <span>public</span> <span>Country</span> <span>GetByIndex</span>(<span>List</span>&lt;<span>Country</span>&gt; <span>countries</span>, <span>nint</span> <span>index</span>)</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L9" data-line-number="9"></td>
        <td id="file-countryservice-cs-LC9">    {</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L10" data-line-number="10"></td>
        <td id="file-countryservice-cs-LC10">        <span>return</span> <span>countries</span>[<span>index</span>]; <span><span>//</span> CS1503: cannot convert from 'nint' to int</span></td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L11" data-line-number="11"></td>
        <td id="file-countryservice-cs-LC11">    }</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L12" data-line-number="12"></td>
        <td id="file-countryservice-cs-LC12">}</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L13" data-line-number="13"></td>
        <td id="file-countryservice-cs-LC13">
</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L14" data-line-number="14"></td>
        <td id="file-countryservice-cs-LC14"><span>public</span> <span>class</span> <span>Country</span> </td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L15" data-line-number="15"></td>
        <td id="file-countryservice-cs-LC15">{</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L16" data-line-number="16"></td>
        <td id="file-countryservice-cs-LC16">    <span>public</span> <span>string</span> <span>Name</span> { <span>get</span>; <span>set</span>; }</td>
      </tr>
      <tr>
        <td id="file-countryservice-cs-L17" data-line-number="17"></td>
        <td id="file-countryservice-cs-LC17">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      
    </div>
</div>




<p><strong>Microsoft </strong>docs says enum support <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nint</a></strong>&nbsp;and <strong><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers">nuint</a></strong> as base type: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers#miscellaneous">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/native-integers#miscellaneous</a></p>



<p>Unfortunately I’m not able to test it, I have a compiler error for now with the latest release of <a href="https://docs.microsoft.com/en-us/dotnet/csharp/roslyn-sdk/">Roslyn </a>I’am currently using (3.8.0-1.20330.5)</p>



<p>A soon as an update is available for <span><strong>enum and native-integers</strong></span>, I’ll update this post. </p>



<p>Thanks for reading 🙂</p>

			</div> <!-- col md end -->
		</div> <!-- row end -->
			</div><!-- end row -->

</article></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>