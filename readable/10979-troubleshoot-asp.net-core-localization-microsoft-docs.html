<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Troubleshoot ASP.NET Core Localization | Microsoft Docs -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Troubleshoot ASP.NET Core Localization | Microsoft Docs</h1><div><div id="main" class="content "><p>By <a href="https://github.com/hishamco" data-linktype="external">Hisham Bin Ateya</a></p><p>This article provides instructions on how to diagnose ASP.NET Core app localization issues.</p><h2 id="localization-configuration-issues">Localization configuration issues</h2><p><strong>Localization middleware order</strong><br>The app may not localize because the localization middleware isn't ordered as expected.</p><p>To resolve this issue, ensure that localization middleware is registered before MVC middleware. Otherwise, the localization middleware isn't applied.</p><pre><code class="lang-csharp">public void ConfigureServices(IServiceCollection services)
{
    services.AddLocalization(options =&gt; options.ResourcesPath = "Resources");

    services.AddMvc();
}
</code></pre><p><strong>Localization resources path not found</strong></p><p><strong>Supported Cultures in RequestCultureProvider don't match with registered once</strong></p><h2 id="resource-file-naming-issues">Resource file naming issues</h2><p>ASP.NET Core has predefined rules and guidelines for localization resources file naming, which are described in detail <a href="localization?view=aspnetcore-2.2#resource-file-naming" data-linktype="relative-path">here</a>.</p><h2 id="missing-resources">Missing resources</h2><p>Common causes of resources not being found include:</p><ul><li>Resource names are misspelled in either the <code>resx</code> file or the localizer request.</li><li>The resource is missing from the <code>resx</code> for some languages, but exists in others.</li><li>If you're still having trouble, check the localization log messages (which are at <code>Debug</code> log level) for more details about the missing resources.</li></ul><p><em><strong>Hint:</strong> When using <code>CookieRequestCultureProvider</code>, verify single quotes are not used with the cultures inside the localization cookie value. For example, <code>c='en-UK'|uic='en-US'</code> is an invalid cookie value, while <code>c=en-UK|uic=en-US</code> is a valid.</em></p><h2 id="resources--class-libraries-issues">Resources &amp; Class Libraries issues</h2><p>ASP.NET Core by default provides a way to allow the class libraries to find their resource files via <a href="/en-us/dotnet/api/microsoft.extensions.localization.resourcelocationattribute?view=aspnetcore-2.1" data-linktype="absolute-path">ResourceLocationAttribute</a>.</p><p>Common issues with class libraries include:</p><ul><li>Missing the <code>ResourceLocationAttribute</code> in a class library will prevent <code>ResourceManagerStringLocalizerFactory</code> from discovering the resources.</li><li>Resource file naming. For more information, see <a href="#resource-file-naming-issues" data-linktype="self-bookmark">Resource file naming issues</a> section.</li><li>Changing the root namespace of the class library. For more information, see <a href="#root-namespace-issues" data-linktype="self-bookmark">Root Namespace issues</a> section.</li></ul><h2 id="customrequestcultureprovider-doesnt-work-as-expected">CustomRequestCultureProvider doesn't work as expected</h2><p>The <code>RequestLocalizationOptions</code> class has three default providers:</p><ol><li><code>QueryStringRequestCultureProvider</code></li><li><code>CookieRequestCultureProvider</code></li><li><code>AcceptLanguageHeaderRequestCultureProvider</code></li></ol><p>The <a href="/en-us/dotnet/api/microsoft.aspnetcore.localization.customrequestcultureprovider?view=aspnetcore-2.1" data-linktype="absolute-path">CustomRequestCultureProvider</a> allows you to customize how the localization culture is provided in your app. The <code>CustomRequestCultureProvider</code> is used when the default providers don't meet your requirements.</p><ul><li><p>A common reason custom provider don't work properly is that it isn't the first provider in the <code>RequestCultureProviders</code> list. To resolve this issue:</p></li><li><p>Insert the custom provider at the position 0 in the <code>RequestCultureProviders</code> list as the following:</p></li></ul><div data-moniker="aspnetcore-1.0 aspnetcore-1.1 aspnetcore-2.0 aspnetcore-2.1 aspnetcore-2.2"><pre><code class="lang-csharp">options.RequestCultureProviders.Insert(0, new CustomRequestCultureProvider(async context =&gt;
    {
        // My custom request culture logic
        return new ProviderCultureResult("en");
    }));
</code></pre></div><div data-moniker="aspnetcore-3.0 aspnetcore-3.1"><pre><code class="lang-csharp">options.AddInitialRequestCultureProvider(new CustomRequestCultureProvider(async context =&gt;
    {
        // My custom request culture logic
        return new ProviderCultureResult("en");
    }));
</code></pre></div><ul><li>Use <code>AddInitialRequestCultureProvider</code> extension method to set the custom provider as initial provider.</li></ul><h2 id="root-namespace-issues">Root Namespace issues</h2><p>When the root namespace of an assembly is different than the assembly name, localization doesn't work by default. To avoid this issue use <a href="/en-us/dotnet/api/microsoft.extensions.localization.rootnamespaceattribute?view=aspnetcore-2.1" data-linktype="absolute-path">RootNamespace</a>, which is described in detail <a href="localization?view=aspnetcore-2.2#resource-file-naming" data-linktype="relative-path">here</a></p><div class="WARNING"><p>Warning</p><p>This can occur when a project's name is not a valid .NET identifier. For instance <code>my-project-name.csproj</code> will use the root namespace <code>my_project_name</code> and the assembly name <code>my-project-name</code> leading to this error.</p></div><h2 id="resources--build-action">Resources &amp; Build Action</h2><p>If you use resource files for localization, it's important that they have an appropriate build action. They should be <strong>Embedded Resource</strong>, otherwise the <code>ResourceStringLocalizer</code> is not able to find these resources.</p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>