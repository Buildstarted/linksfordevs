<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Have I Been Pwned breach report email pwned entire firm&#x27;s helldesk ticket system - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Have I Been Pwned breach report email pwned entire firm&#x27;s helldesk ticket system - linksfor.dev(s)"/>
    <meta property="article:author" content="Thu&#xA0;4&#xA0;Jun&#xA0;2020 // 17:45&#xA0;UTC"/>
    <meta property="og:description" content="That&#x27;s one way of making people check for updates"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.theregister.com/2020/06/04/hibp_pwned_helpdesk_ticket_system_glpi/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Have I Been Pwned breach report email pwned entire firm&#x27;s helldesk ticket system</title>
<div class="readable">
        <h1>Have I Been Pwned breach report email pwned entire firm&#x27;s helldesk ticket system</h1>
            <div>by Thu&#xA0;4&#xA0;Jun&#xA0;2020 // 17:45&#xA0;UTC</div>
            <div>Reading time: 4-5 minutes</div>
        <div>Posted here: 08 Jun 2020</div>
        <p><a href="https://www.theregister.com/2020/06/04/hibp_pwned_helpdesk_ticket_system_glpi/">https://www.theregister.com/2020/06/04/hibp_pwned_helpdesk_ticket_system_glpi/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="body">
                    <p>A hapless IT bod found the Have I Been Pwned service (HIBP) answering its own question in a way he really didn’t want – after a breach report including a SQL string KO’d his company’s helpdesk ticket system.</p>
                    <p>A pseudonymous blogger <a target="_blank" rel="nofollow" href="https://fyr.io/2020/05/30/haveibeenpwned-com-pwned-our-helpdesk-glpi-9-4-5-sql-injection/">posting</a> under the name Matt published a tortured account of what happened when a breach notification email from HIBP was ingested into his firm’s helpdesk ticket system and was automatically assigned a ticket ID.</p>
                    <p>The company used version 9.4.5 of the GLPi open source helpdesk system, a rather old product but quite functional. As Matt put it: “All was well until we received an email from haveibeenpwned to our helpdesk support address, which automatically got logged as a support ticket.”</p>
                    <p>When one of your email addresses is included in a breach picked up by HIBP, you can generate a report that tells you where your details were found. Included in the email with the link to the report is the HIBP header logo graphic, partly formed from ASCII text which reads as so:</p>
                    
                    <p>Problems arose when Matt received that email. While he looked at it and took the relevant actions, GLPi had encountered an issue. “I and the other techs quickly noticed that every single ticket description had been deleted and replaced with partial header data from the HIBP email,” wrote Matt.</p>
                    <p>This caused some headaches, requiring a restore from the previous day’s backups. Not ideal and quite disruptive.</p>
                    <p>That evening Matt started fault-finding, eventually narrowing down the ticket-wiping problem to one of either assigning the HIBP email to yourself in GLPi or adding yourself as a “watcher” of it. In both cases, Matt suspected, some kind of SQL injection was happening.</p>
                    <p>“I managed to shrink the exploit down to six characters (';-- " – the space and double-quote at the end appear to be required though this could do with more testing) to achieve the same kind of malicious behaviour, in this case deleting all content of the descriptions for every ticket in the database,” he wrote.</p>
                    <p>Eventually he figured it out. GLPi 9.4.5 is vulnerable to a SQL injection flaw which just happened to be triggered by the formatting of HIBP’s breach report email. As Matt put it, “GLPI supports HTML emails, which get rendered (almost) normally within the interface. Simply hiding the text in an attribute or the &lt;head&gt; or something will keep it invisible to the tech. You’ve just gotta wait for them to assign it to themselves.”</p>
                    <p>Buoyed by his success, Matt zoomed off to GLPi’s Github page to find contact details for its maintainers to warn them of the flaw. There he made an equally important discovery: <a target="_blank" href="https://glpi-project.org/glpi-version-9-4-6-is-available/">GLPi had since been updated</a> to version 9.4.6. Not only that, but the latest version fixed the SQLi vuln.</p>
                    <p>“If you’re running GLPI, make sure you’re on the latest release. Or look for alternative software,” he concluded, apparently rather crestfallen from all those excellent but ultimately needless efforts.</p>
                    <p>Troy Hunt, the man behind HIBP, took it all in good faith.</p>
                    <twitter-widget id="twitter-widget-0" data-tweet-id="1268309629437526018"></twitter-widget>
                    <p>The age-old exhortation rises to the fore once again: make sure you’re running the latest version of whatever software suite you’re relying on. ®</p>
                    
                <p><span>Sponsored: </span><a href="https://go.theregister.com/tl/1945/-8720/how-to-simplify-data-protection-on-amazon-web-services?td=wptl1945bt">Webcast: Simplify data protection on AWS</a></p>
                
                </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
		<div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>