<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Introducing Project Tye | ASP.NET Blog - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Introducing Project Tye | ASP.NET Blog - linksfor.dev(s)"/>
    <meta property="article:author" content="Amiee LoProgram Manager, ASP.NETFollow"/>
    <meta property="og:description" content="Project Tye is an experimental developer tool that makes developing, testing, and deploying microservices and distributed applications easier."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://devblogs.microsoft.com/aspnet/introducing-project-tye/"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="grid">
        <h1>
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - Introducing Project Tye | ASP.NET Blog</title>
<div class="readable">
        <h1>Introducing Project Tye | ASP.NET Blog</h1>
            <div>by Amiee LoProgram Manager, ASP.NETFollow</div>
            <div>Reading time: 19-24 minutes</div>
        <div>Posted here: 21 May 2020</div>
        <p><a href="https://devblogs.microsoft.com/aspnet/introducing-project-tye/">https://devblogs.microsoft.com/aspnet/introducing-project-tye/</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="featured">

	<div>
                
         <div><div><div><p><img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/M5_VX3XL_400x400-150x150.jpg" width="58" height="58" alt="Amiee Lo"></p><p>Amiee</p></div></div></div>     
        <p>May 21st, 2020</p><!-- .entry-meta -->

		
<p><a href="https://github.com/dotnet/tye" target="_blank">Project Tye</a> is an experimental developer tool that makes developing, testing, and deploying microservices and distributed applications easier.</p>
<p>When building an app made up of multiple projects, you often want to run more than one at a time, such as a website that communicates with a backend API or several services all communicating with each other. Today, this can be difficult to setup and not as smooth as it could be, and it’s only the very first step in trying to get started with something like building out a distributed application. Once you have an inner-loop experience there is then a, sometimes steep, learning curve to get your distributed app onto a platform such as Kubernetes.</p>
<p>The project has two main goals:</p>
<ol>
<li>Making development of microservices easier by:
<ul>
<li>Running many services with one command</li>
<li>Using dependencies in containers</li>
<li>Discovering addresses of other services using simple conventions</li>
</ul>
</li>
<li>Automating deployment of .NET applications to Kubernetes by:
<ul>
<li>Automatically containerizing .NET applications</li>
<li>Generating Kubernetes manifests with minimal knowledge or configuration</li>
<li>Using a single configuration file</li>
</ul>
</li>
</ol>
<p>If you have an app that talks to a database, or an app that is made up of a couple of different processes that communicate with each other, then we think Tye will help ease some of the common pain points you’ve experienced.</p>
<p>We have recently demonstrated Tye in a few Build sessions that we encourage you to watch, <a href="https://aka.ms/Build2020AppDev-CloudNativeApps" target="_blank">Cloud Native Apps with .NET and AKS</a> and <a href="https://aka.ms/dotnetjourney" target="_blank">Journey to one .NET</a></p>

<h3>Installation</h3>
<p>To get started with Tye, you will first need to have .<a href="https://dotnet.microsoft.com/download" target="_blank">NET Core 3.1</a> installed on your machine.</p>
<p>Tye can then be installed as a global tool using the following command:</p>
<pre><code><span><span>dotnet tool install </span></span><span><span>-</span></span><span><span>g </span></span><span><span>Microsoft</span></span><span><span>.</span></span><span><span>Tye</span></span><span><span> </span></span><span><span>--</span></span><span><span>version </span></span><span><span>"0.2.0-alpha.20258.3"</span></span></code></pre>
<h3>Running a single service</h3>
<p>Tye makes it very easy to run single applications. To demonstrate this:</p>
<p>1. Make a new folder called microservices and navigate to it:</p>
<pre><code><span><span>mkdir microservices
cd microservices</span></span></code></pre>
<p>2. Then create a frontend project:</p>
<pre><code><span><span>dotnet </span></span><span><span>new</span></span><span><span> razor </span></span><span><span>-</span></span><span><span>n frontend</span></span></code></pre>
<p>3. Now run this project using <code><span>tye run</span></code>:</p>
<pre><code><span><span>tye run frontend</span></span></code></pre>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-run-output.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-run-output.png" alt="Image tye run output" width="1995" height="431" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-run-output.png 1995w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-run-output-300x65.png 300w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-run-output-1024x221.png 1024w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-run-output-768x166.png 768w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-run-output-1536x332.png 1536w" sizes="(max-width: 1995px) 100vw, 1995px">  </a> The above displays how Tye is building, running, and monitoring the frontend application.</p>
<p>One key feature from <code><span>tye run</span></code> is a dashboard to view the state of your application. Navigate to <a href="http://localhost:8000/" target="_blank">http://localhost:8000</a> to see the dashboard running.</p>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard.png" alt="Image tye dashboard" width="3239" height="1058" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard.png 3239w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard-300x98.png 300w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard-1024x334.png 1024w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard-768x251.png 768w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard-1536x502.png 1536w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-dashboard-2048x669.png 2048w" sizes="(max-width: 3239px) 100vw, 3239px">  </a></p>
<p>The dashboard is the UI for Tye that displays a list of all of your services. The <code><span>Bindings</span></code> column has links to the listening URLs of the service. The <code><span>Logs</span></code> column allows you to view the streaming logs for the service.</p>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs.png" alt="Image tye logs" width="3240" height="967" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs.png 3240w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs-300x90.png 300w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs-1024x306.png 1024w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs-768x229.png 768w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs-1536x458.png 1536w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-logs-2048x611.png 2048w" sizes="(max-width: 3240px) 100vw, 3240px">  </a></p>
<p>Services written using ASP.NET Core will have their listening ports assigned randomly if not explicitly configured. This is useful to avoid common issues like port conflicts.</p>
<h3>Running multiple services</h3>
<p>Instead of just a single application, suppose we have a multi-application scenario where our frontend project now needs to communicate with a backend project. If you haven’t already, stop the existing <code><span>tye run</span></code> command using <code><span>Ctrl</span><span> </span><span>+</span><span> C</span></code>.</p>
<p>1. Create a backend API that the frontend will call inside of the <code><span>microservices</span><span>/</span></code> folder.</p>
<pre><code><span><span>dotnet </span></span><span><span>new</span></span><span><span> webapi </span></span><span><span>-</span></span><span><span>n backend</span></span></code></pre>
<p>2. Then create a solution file and add both projects:</p>
<pre><code><span><span>dotnet </span></span><span><span>new</span></span><span><span> sln
dotnet sln </span></span><span><span>add</span></span><span><span> frontend backend</span></span></code></pre>
<p>You should now have a solution called <code><span>microservices</span><span>.</span><span>sln</span></code> that references the frontend and backend projects.</p>
<p>3. Run <code><span>tye</span></code> in the folder with the solution.</p>
<pre><code><span><span>tye run</span></span></code></pre>
<p>The dashboard should show both the frontend and backend services. You can navigate to both of them through either the dashboard of the url outputted by tye run.</p>
<blockquote>
<p><em>The backend service in this example was created using the webapi project template and will return an HTTP 404 for its root URL.</em></p>
</blockquote>
<h3>Getting the frontend to communicate with the backend</h3>
<p>Now that we have two applications running, let’s make them communicate.</p>
<p>To get both of these applications communicating with each other, Tye utilizes service discovery. In general terms, service discovery describes the process by which one service figures out the address of another service. Tye uses environment variables for specifying connection strings and URIs of services.</p>
<p>The simplest way to use Tye’s service discovery is through the <code><span>Microsoft</span><span>.</span><span>Extensions</span><span>.</span><span>Configuration</span></code> system – available by default in ASP.NET Core or .NET Core Worker projects. In addition to this, we provide the <code><span>Microsoft</span><span>.</span><span>Tye</span><span>.</span><span>Extensions</span><span>.</span><span>Configuration</span></code> package with some Tye-specific extensions layered on top of the configuration system.</p>
<p>If you want to learn more about Tye’s philosophy on service discovery and see detailed usage examples, check out this <a href="https://github.com/dotnet/tye/blob/master/docs/reference/service_discovery.md" target="_blank">reference document</a>.</p>
<p>1. If you haven’t already, stop the existing <code><span>tye run</span></code> command using <code><span>Ctrl</span><span> </span><span>+</span><span> C</span></code>. Open the solution in your editor of choice.</p>
<p>2. Add a file <code><span>WeatherForecast</span><span>.</span><span>cs</span></code> to the <code><span>frontend</span></code> project.</p>
<pre><code><span><span>using</span></span><span><span> </span></span><span><span>System</span></span><span><span>;</span></span><span><span>

</span></span><span><span>namespace</span></span><span><span> frontend
 </span></span><span><span>{</span></span><span><span>
   </span></span><span><span>public</span></span><span><span> </span></span><span><span>class</span></span><span><span> </span></span><span><span>WeatherForecast</span></span><span><span>
   </span></span><span><span>{</span></span><span><span>
     </span></span><span><span>public</span></span><span><span> </span></span><span><span>DateTime</span></span><span><span> </span></span><span><span>Date</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>get</span></span><span><span>;</span></span><span><span> </span></span><span><span>set</span></span><span><span>;</span></span><span><span> </span></span><span><span>}</span></span><span><span>

     </span></span><span><span>public</span></span><span><span> </span></span><span><span>int</span></span><span><span> </span></span><span><span>TemperatureC</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>get</span></span><span><span>;</span></span><span><span> </span></span><span><span>set</span></span><span><span>;</span></span><span><span> </span></span><span><span>}</span></span><span><span>

     </span></span><span><span>public</span></span><span><span> </span></span><span><span>int</span></span><span><span> </span></span><span><span>TemperatureF</span></span><span><span> </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>32</span></span><span><span> </span></span><span><span>+</span></span><span><span> </span></span><span><span>(</span></span><span><span>int</span></span><span><span>)(</span></span><span><span>TemperatureC</span></span><span><span> </span></span><span><span>/</span></span><span><span> </span></span><span><span>0.5556</span></span><span><span>);</span></span><span><span>

     </span></span><span><span>public</span></span><span><span> </span></span><span><span>string</span></span><span><span> </span></span><span><span>Summary</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>get</span></span><span><span>;</span></span><span><span> </span></span><span><span>set</span></span><span><span>;</span></span><span><span> </span></span><span><span>}</span></span><span><span>
   </span></span><span><span>}</span></span><span><span>
 </span></span><span><span>}</span></span></code></pre>
<p>This will match the backend <code><span>WeatherForecast</span><span>.</span><span>cs</span></code>.</p>
<p>3. Add a file <code><span>WeatherClient</span><span>.</span><span>cs</span></code> to the <code><span>frontend</span></code> project with the following contents:</p>
<pre><code><span><span>using</span></span><span><span> </span></span><span><span>System</span></span><span><span>.</span></span><span><span>Net</span></span><span><span>.</span></span><span><span>Http</span></span><span><span>;</span></span><span><span>
</span></span><span><span>using</span></span><span><span> </span></span><span><span>System</span></span><span><span>.</span></span><span><span>Text</span></span><span><span>.</span></span><span><span>Json</span></span><span><span>;</span></span><span><span>
</span></span><span><span>using</span></span><span><span> </span></span><span><span>System</span></span><span><span>.</span></span><span><span>Threading</span></span><span><span>.</span></span><span><span>Tasks</span></span><span><span>;</span></span><span><span>

</span></span><span><span>namespace</span></span><span><span> frontend
</span></span><span><span>{</span></span><span><span>
   </span></span><span><span>public</span></span><span><span> </span></span><span><span>class</span></span><span><span> </span></span><span><span>WeatherClient</span></span><span><span>
   </span></span><span><span>{</span></span><span><span>
      </span></span><span><span>private</span></span><span><span> </span></span><span><span>readonly</span></span><span><span> </span></span><span><span>JsonSerializerOptions</span></span><span><span> options </span></span><span><span>=</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>JsonSerializerOptions</span></span><span><span>()</span></span><span><span>
      </span></span><span><span>{</span></span><span><span>
         </span></span><span><span>PropertyNameCaseInsensitive</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>true</span></span><span><span>,</span></span><span><span>
         </span></span><span><span>PropertyNamingPolicy</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>JsonNamingPolicy</span></span><span><span>.</span></span><span><span>CamelCase</span></span><span><span>,</span></span><span><span>
      </span></span><span><span>};</span></span><span><span>

      </span></span><span><span>private</span></span><span><span> </span></span><span><span>readonly</span></span><span><span> </span></span><span><span>HttpClient</span></span><span><span> client</span></span><span><span>;</span></span><span><span>

      </span></span><span><span>public</span></span><span><span> </span></span><span><span>WeatherClient</span></span><span><span>(</span></span><span><span>HttpClient</span></span><span><span> client</span></span><span><span>)</span></span><span><span>
      </span></span><span><span>{</span></span><span><span>
         </span></span><span><span>this</span></span><span><span>.</span></span><span><span>client </span></span><span><span>=</span></span><span><span> client</span></span><span><span>;</span></span><span><span>
      </span></span><span><span>}</span></span><span><span>

      </span></span><span><span>public</span></span><span><span> </span></span><span><span>async</span></span><span><span> </span></span><span><span>Task</span></span><span><span>&lt;</span></span><span><span>WeatherForecast</span></span><span><span>[]&gt;</span></span><span><span> </span></span><span><span>GetWeatherAsync</span></span><span><span>()</span></span><span><span>
      </span></span><span><span>{</span></span><span><span>
         </span></span><span><span>var</span></span><span><span> responseMessage </span></span><span><span>=</span></span><span><span> </span></span><span><span>await</span></span><span><span> </span></span><span><span>this</span></span><span><span>.</span></span><span><span>client</span></span><span><span>.</span></span><span><span>GetAsync</span></span><span><span>(</span></span><span><span>"/weatherforecast"</span></span><span><span>);</span></span><span><span>
         </span></span><span><span>var</span></span><span><span> stream </span></span><span><span>=</span></span><span><span> </span></span><span><span>await</span></span><span><span> responseMessage</span></span><span><span>.</span></span><span><span>Content</span></span><span><span>.</span></span><span><span>ReadAsStreamAsync</span></span><span><span>();</span></span><span><span>
         </span></span><span><span>return</span></span><span><span> </span></span><span><span>await</span></span><span><span> </span></span><span><span>JsonSerializer</span></span><span><span>.</span></span><span><span>DeserializeAsync</span></span><span><span>&lt;</span></span><span><span>WeatherForecast</span></span><span><span>[]&gt;(</span></span><span><span>stream</span></span><span><span>,</span></span><span><span> options</span></span><span><span>);</span></span><span><span>
      </span></span><span><span>}</span></span><span><span>
   </span></span><span><span>}</span></span><span><span>
</span></span><span><span>}</span></span></code></pre>
<p>4. Add a reference to the <code><span>Microsoft</span><span>.</span><span>Tye</span><span>.</span><span>Extensions</span><span>.</span><span>Configuration</span></code> package to the frontend project</p>
<pre><code><span><span>dotnet </span></span><span><span>add</span></span><span><span> frontend</span></span><span><span>/</span></span><span><span>frontend</span></span><span><span>.</span></span><span><span>csproj </span></span><span><span>package</span></span><span><span> </span></span><span><span>Microsoft</span></span><span><span>.</span></span><span><span>Tye</span></span><span><span>.</span></span><span><span>Extensions</span></span><span><span>.</span></span><span><span>Configuration</span></span><span><span>  </span></span><span><span>--</span></span><span><span>version </span></span><span><span>"0.2.0-*"</span></span></code></pre>
<p>5. Now register this client in <code><span>frontend</span></code> by adding the following to the existing <code><span>ConfigureServices</span></code> method to the existing <code><span>Startup</span><span>.</span><span>cs</span></code> file:</p>
<pre><code><span><span>...</span></span><span><span>
</span></span><span><span>public</span></span><span><span> </span></span><span><span>void</span></span><span><span> </span></span><span><span>ConfigureServices</span></span><span><span>(</span></span><span><span>IServiceCollection</span></span><span><span> services</span></span><span><span>)</span></span><span><span>
</span></span><span><span>{</span></span><span><span>
   services</span></span><span><span>.</span></span><span><span>AddRazorPages</span></span><span><span>();</span></span><span><span>
   </span></span><span><span>/** Add the following to wire the client to the backend **/</span></span><span><span>
   services</span></span><span><span>.</span></span><span><span>AddHttpClient</span></span><span><span>&lt;</span></span><span><span>WeatherClient</span></span><span><span>&gt;(</span></span><span><span>client </span></span><span><span>=&gt;</span></span><span><span>
   </span></span><span><span>{</span></span><span><span>
      client</span></span><span><span>.</span></span><span><span>BaseAddress</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Configuration</span></span><span><span>.</span></span><span><span>GetServiceUri</span></span><span><span>(</span></span><span><span>"backend"</span></span><span><span>);</span></span><span><span>
   </span></span><span><span>});</span></span><span><span>
   </span></span><span><span>/** End added code **/</span></span><span><span>
</span></span><span><span>}</span></span><span><span>
</span></span><span><span>...</span></span></code></pre>
<p>This will wire up the <code><span>WeatherClient</span></code> to use the correct URL for the <code><span>backend</span></code> service.</p>
<p>6. Add a <code><span>Forecasts</span></code> property to the <code><span>Index</span></code> page model under <code><span>Pages</span><span>\Index</span><span>.</span><span>cshtml</span><span>.</span><span>cs</span></code> in the <code><span>frontend</span></code> project.</p>
<pre><code><span><span>...</span></span><span><span>
  </span></span><span><span>public</span></span><span><span> </span></span><span><span>WeatherForecast</span></span><span><span>[]</span></span><span><span> </span></span><span><span>Forecasts</span></span><span><span> </span></span><span><span>{</span></span><span><span> </span></span><span><span>get</span></span><span><span>;</span></span><span><span> </span></span><span><span>set</span></span><span><span>;</span></span><span><span> </span></span><span><span>}</span></span><span><span>
</span></span><span><span>...</span></span></code></pre>
<p>7. Change the <code><span>OnGet</span></code> method to take the <code><span>WeatherClient</span></code> to call the <code><span>backend</span></code> service and store the result in the <code><span>Forecasts</span></code> property:</p>
<pre><code><span><span>...</span></span><span><span>
 </span></span><span><span>public</span></span><span><span> </span></span><span><span>async</span></span><span><span> </span></span><span><span>Task</span></span><span><span> </span></span><span><span>OnGet</span></span><span><span>([</span></span><span><span>FromServices</span></span><span><span>]</span></span><span><span>WeatherClient</span></span><span><span> client</span></span><span><span>)</span></span><span><span>
 </span></span><span><span>{</span></span><span><span>
   </span></span><span><span>Forecasts</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>await</span></span><span><span> client</span></span><span><span>.</span></span><span><span>GetWeatherAsync</span></span><span><span>();</span></span><span><span>
 </span></span><span><span>}</span></span><span><span>
</span></span><span><span>...</span></span></code></pre>
<p>8. Change the <code><span>Index</span><span>.</span><span>cshtml</span></code> razor view to render the <code><span>Forecasts</span></code> property in the razor page:</p>
<pre><code><span><span>@page</span></span><span><span>
</span></span><span><span>@model</span></span><span><span> </span></span><span><span>IndexModel</span></span><span><span>
</span></span><span><span>@{</span></span><span><span>
   </span></span><span><span>ViewData</span></span><span><span>[</span></span><span><span>"Title"</span></span><span><span>]</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>"Home page"</span></span><span><span>;</span></span><span><span>
</span></span><span><span>}</span></span><span><span>

</span></span><span><span>&lt;</span></span><span><span>div </span></span><span><span>class</span></span><span><span>=</span></span><span><span>"text-center"</span></span><span><span>&gt;</span></span><span><span>
   </span></span><span><span>&lt;</span></span><span><span>h1 </span></span><span><span>class</span></span><span><span>=</span></span><span><span>"display-4"</span></span><span><span>&gt;</span></span><span><span>Welcome</span></span><span><span>&lt;/</span></span><span><span>h1</span></span><span><span>&gt;</span></span><span><span>
   </span></span><span><span>&lt;p&gt;</span></span><span><span>Learn</span></span><span><span> about </span></span><span><span>&lt;</span></span><span><span>a href</span></span><span><span>=</span></span><span><span>"https://docs.microsoft.com/aspnet/core"</span></span><span><span>&gt;</span></span><span><span>building </span></span><span><span>Web</span></span><span><span> apps </span></span><span><span>with</span></span><span><span> ASP</span></span><span><span>.</span></span><span><span>NET </span></span><span><span>Core</span></span><span><span>&lt;</span></span><span><span>/a&gt;.&lt;/</span></span><span><span>p</span></span><span><span>&gt;</span></span><span><span>
</span></span><span><span>&lt;/</span></span><span><span>div</span></span><span><span>&gt;</span></span><span><span>

</span></span><span><span>Weather</span></span><span><span> </span></span><span><span>Forecast</span></span><span><span>:</span></span><span><span>

</span></span><span><span>&lt;</span></span><span><span>table </span></span><span><span>class</span></span><span><span>=</span></span><span><span>"table"</span></span><span><span>&gt;</span></span><span><span>
   </span></span><span><span>&lt;thead&gt;</span></span><span><span>
      </span></span><span><span>&lt;tr&gt;</span></span><span><span>
         </span></span><span><span>&lt;th&gt;</span></span><span><span>Date</span></span><span><span>&lt;/</span></span><span><span>th</span></span><span><span>&gt;</span></span><span><span>
         </span></span><span><span>&lt;th&gt;</span></span><span><span>Temp</span></span><span><span>.</span></span><span><span> </span></span><span><span>(</span></span><span><span>C</span></span><span><span>)&lt;/</span></span><span><span>th</span></span><span><span>&gt;</span></span><span><span>
         </span></span><span><span>&lt;th&gt;</span></span><span><span>Temp</span></span><span><span>.</span></span><span><span> </span></span><span><span>(</span></span><span><span>F</span></span><span><span>)&lt;/</span></span><span><span>th</span></span><span><span>&gt;</span></span><span><span>
         </span></span><span><span>&lt;th&gt;</span></span><span><span>Summary</span></span><span><span>&lt;/</span></span><span><span>th</span></span><span><span>&gt;</span></span><span><span>
      </span></span><span><span>&lt;/</span></span><span><span>tr</span></span><span><span>&gt;</span></span><span><span>
   </span></span><span><span>&lt;/</span></span><span><span>thead</span></span><span><span>&gt;</span></span><span><span>
   </span></span><span><span>&lt;tbody&gt;</span></span><span><span>
      </span></span><span><span>@foreach</span></span><span><span> </span></span><span><span>(</span></span><span><span>var</span></span><span><span> forecast </span></span><span><span>in</span></span><span><span> </span></span><span><span>@Model</span></span><span><span>.</span></span><span><span>Forecasts</span></span><span><span>)</span></span><span><span>
      </span></span><span><span>{</span></span><span><span>
         </span></span><span><span>&lt;tr&gt;</span></span><span><span>
            </span></span><span><span>&lt;td&gt;</span></span><span><span>@forecast</span></span><span><span>.</span></span><span><span>Date</span></span><span><span>.</span></span><span><span>ToShortDateString</span></span><span><span>()&lt;/</span></span><span><span>td</span></span><span><span>&gt;</span></span><span><span>
            </span></span><span><span>&lt;td&gt;</span></span><span><span>@forecast</span></span><span><span>.</span></span><span><span>TemperatureC</span></span><span><span>&lt;/</span></span><span><span>td</span></span><span><span>&gt;</span></span><span><span>
            </span></span><span><span>&lt;td&gt;</span></span><span><span>@forecast</span></span><span><span>.</span></span><span><span>TemperatureF</span></span><span><span>&lt;/</span></span><span><span>td</span></span><span><span>&gt;</span></span><span><span>
            </span></span><span><span>&lt;td&gt;</span></span><span><span>@forecast</span></span><span><span>.</span></span><span><span>Summary</span></span><span><span>&lt;/</span></span><span><span>td</span></span><span><span>&gt;</span></span><span><span>
         </span></span><span><span>&lt;/</span></span><span><span>tr</span></span><span><span>&gt;</span></span><span><span>
      </span></span><span><span>}</span></span><span><span>
   </span></span><span><span>&lt;/</span></span><span><span>tbody</span></span><span><span>&gt;</span></span><span><span>
</span></span><span><span>&lt;/</span></span><span><span>table</span></span><span><span>&gt;</span></span></code></pre>
<p>9. Run the project with <code><span>tye run</span></code> and the <code><span>frontend</span></code> service should be able to successfully call the <code><span>backend</span></code> service!</p>
<p>When you visit the <code><span>frontend</span></code> service you should see a table of weather data. This data was produced randomly in the <code><span>backend</span></code> service. The fact that you’re seeing it in a web UI in the <code><span>frontend</span></code> means that the services are able to communicate. Unfortunately, this doesn’t work out of the box on Linux right now due to how self-signed certificates are handled, please see the workaround <a href="https://github.com/dotnet/tye/blob/master/docs/tutorials/hello-tye/00_run_locally.md#troubleshooting" target="_blank">here</a></p>
<h3>Tye’s configuration schema</h3>
<p>Tye has a optional configuration file (<code><span>tye</span><span>.</span><span>yaml</span></code>) to enable customizing settings. This file contains all of your projects and external dependencies. If you have an existing solution, Tye will automatically populate this with all of your current projects.</p>
<p>To initalize this file, you will need to run the following command in the <code><span>microservices</span></code> directory to generate a default <code><span>tye</span><span>.</span><span>yaml</span></code> file:</p>
<pre><code><span><span>tye init</span></span></code></pre>
<p>The contents of the <code><span>tye</span><span>.</span><span>yaml</span></code> should look like this:</p>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-yaml.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-yaml.png" alt="Image tye yaml" width="1025" height="393" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-yaml.png 1025w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-yaml-300x115.png 300w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-yaml-768x294.png 768w" sizes="(max-width: 1025px) 100vw, 1025px">  </a></p>
<p>The top level scope (like the name node) is where global settings are applied.</p>
<p><code><span>tye</span><span>.</span><span>yaml</span></code> lists all of the application’s services under the services node. This is the place for per-service configuration.</p>
<p>To learn more about Tye’s yaml specifications and schema, you can check it out <a href="https://github.com/dotnet/tye/blob/master/docs/reference/schema.md" target="_blank">here</a> in Tye’s repository on Github.</p>
<blockquote>
<p><em>We provide a json-schema for <code><span>tye</span><span>.</span><span>yaml</span></code> and some editors support json-schema for completion and validation of yaml files. See <a href="https://github.com/dotnet/tye/blob/master/src/schema/README.md" target="_blank">json-schema</a> for instructions.</em></p>
</blockquote>
<h3>Adding external dependencies (Redis)</h3>
<p>Not only does Tye make it easy to run and deploy your applications to Kubernetes, it’s also fairly simple to add external dependencies to your applications as well. We will now add redis to the frontend and backend application to store data.</p>
<p>Tye can use Docker to run images that run as part of your application. Make sure that <a href="https://docs.docker.com/get-docker/" target="_blank">Docker</a> is installed on your machine.</p>
<p>1. Change the <code><span>WeatherForecastController</span><span>.</span><span>Get</span><span>()</span></code> method in the <code><span>backend</span></code> project to cache the weather information in redis using an <code><span>IDistributedCache</span></code>.</p>
<p>2. Add the following <code><span>using</span></code>‘s to the top of the file:</p>
<pre><code><span><span>using</span></span><span><span> </span></span><span><span>Microsoft</span></span><span><span>.</span></span><span><span>Extensions</span></span><span><span>.</span></span><span><span>Caching</span></span><span><span>.</span></span><span><span>Distributed</span></span><span><span>;</span></span><span><span>
</span></span><span><span>using</span></span><span><span> </span></span><span><span>System</span></span><span><span>.</span></span><span><span>Text</span></span><span><span>.</span></span><span><span>Json</span></span><span><span>;</span></span></code></pre>
<p>3. Update <code><span>Get</span><span>()</span></code>:</p>
<pre><code><span><span>[</span></span><span><span>HttpGet</span></span><span><span>]</span></span><span><span>
</span></span><span><span>public</span></span><span><span> </span></span><span><span>async</span></span><span><span> </span></span><span><span>Task</span></span><span><span>&lt;string&gt;</span></span><span><span> </span></span><span><span>Get</span></span><span><span>([</span></span><span><span>FromServices</span></span><span><span>]</span></span><span><span>IDistributedCache</span></span><span><span> cache</span></span><span><span>)</span></span><span><span>
</span></span><span><span>{</span></span><span><span>
   </span></span><span><span>var</span></span><span><span> weather </span></span><span><span>=</span></span><span><span> </span></span><span><span>await</span></span><span><span> cache</span></span><span><span>.</span></span><span><span>GetStringAsync</span></span><span><span>(</span></span><span><span>"weather"</span></span><span><span>);</span></span><span><span>

   </span></span><span><span>if</span></span><span><span> </span></span><span><span>(</span></span><span><span>weather </span></span><span><span>==</span></span><span><span> </span></span><span><span>null</span></span><span><span>)</span></span><span><span>
   </span></span><span><span>{</span></span><span><span>
      </span></span><span><span>var</span></span><span><span> rng </span></span><span><span>=</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>Random</span></span><span><span>();</span></span><span><span>
      </span></span><span><span>var</span></span><span><span> forecasts </span></span><span><span>=</span></span><span><span> </span></span><span><span>Enumerable</span></span><span><span>.</span></span><span><span>Range</span></span><span><span>(</span></span><span><span>1</span></span><span><span>,</span></span><span><span> </span></span><span><span>5</span></span><span><span>).</span></span><span><span>Select</span></span><span><span>(</span></span><span><span>index </span></span><span><span>=&gt;</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>WeatherForecast</span></span><span><span>
      </span></span><span><span>{</span></span><span><span>
         </span></span><span><span>Date</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>DateTime</span></span><span><span>.</span></span><span><span>Now</span></span><span><span>.</span></span><span><span>AddDays</span></span><span><span>(</span></span><span><span>index</span></span><span><span>),</span></span><span><span>
         </span></span><span><span>TemperatureC</span></span><span><span> </span></span><span><span>=</span></span><span><span> rng</span></span><span><span>.</span></span><span><span>Next</span></span><span><span>(-</span></span><span><span>20</span></span><span><span>,</span></span><span><span> </span></span><span><span>55</span></span><span><span>),</span></span><span><span>
         </span></span><span><span>Summary</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Summaries</span></span><span><span>[</span></span><span><span>rng</span></span><span><span>.</span></span><span><span>Next</span></span><span><span>(</span></span><span><span>Summaries</span></span><span><span>.</span></span><span><span>Length</span></span><span><span>)]</span></span><span><span>
      </span></span><span><span>})</span></span><span><span>
      </span></span><span><span>.</span></span><span><span>ToArray</span></span><span><span>();</span></span><span><span>

      weather </span></span><span><span>=</span></span><span><span> </span></span><span><span>JsonSerializer</span></span><span><span>.</span></span><span><span>Serialize</span></span><span><span>(</span></span><span><span>forecasts</span></span><span><span>);</span></span><span><span>

      </span></span><span><span>await</span></span><span><span> cache</span></span><span><span>.</span></span><span><span>SetStringAsync</span></span><span><span>(</span></span><span><span>"weather"</span></span><span><span>,</span></span><span><span> weather</span></span><span><span>,</span></span><span><span> </span></span><span><span>new</span></span><span><span> </span></span><span><span>DistributedCacheEntryOptions</span></span><span><span>
      </span></span><span><span>{</span></span><span><span>
         </span></span><span><span>AbsoluteExpirationRelativeToNow</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>TimeSpan</span></span><span><span>.</span></span><span><span>FromSeconds</span></span><span><span>(</span></span><span><span>5</span></span><span><span>)</span></span><span><span>
      </span></span><span><span>});</span></span><span><span>
   </span></span><span><span>}</span></span><span><span>
   </span></span><span><span>return</span></span><span><span> weather</span></span><span><span>;</span></span><span><span>
</span></span><span><span>}</span></span></code></pre>
<p>This will store the weather data in Redis with an expiration time of 5 seconds.</p>
<p>4. Add a package reference to <code><span>Microsoft</span><span>.</span><span>Extensions</span><span>.</span><span>Caching</span><span>.</span><span>StackExchangeRedis</span></code> in the backend project:</p>
<pre><code><span><span>cd backend</span></span><span><span>/</span></span><span><span>
dotnet </span></span><span><span>add</span></span><span><span> </span></span><span><span>package</span></span><span><span> </span></span><span><span>Microsoft</span></span><span><span>.</span></span><span><span>Extensions</span></span><span><span>.</span></span><span><span>Caching</span></span><span><span>.</span></span><span><span>StackExchangeRedis</span></span><span><span>
cd </span></span><span><span>..</span></span></code></pre>
<p>5. Modify <code><span>Startup</span><span>.</span><span>ConfigureServices</span></code> in the <code><span>backend</span></code> project to add the redis <code><span>IDistributedCache</span></code> implementation.</p>
<pre><code><span><span>  </span></span><span><span>public</span></span><span><span> </span></span><span><span>void</span></span><span><span> </span></span><span><span>ConfigureServices</span></span><span><span>(</span></span><span><span>IServiceCollection</span></span><span><span> services</span></span><span><span>)</span></span><span><span>
  </span></span><span><span>{</span></span><span><span>
    services</span></span><span><span>.</span></span><span><span>AddControllers</span></span><span><span>();</span></span><span><span>

    services</span></span><span><span>.</span></span><span><span>AddStackExchangeRedisCache</span></span><span><span>(</span></span><span><span>o </span></span><span><span>=&gt;</span></span><span><span>
    </span></span><span><span>{</span></span><span><span>
      o</span></span><span><span>.</span></span><span><span>Configuration</span></span><span><span> </span></span><span><span>=</span></span><span><span> </span></span><span><span>Configuration</span></span><span><span>.</span></span><span><span>GetConnectionString</span></span><span><span>(</span></span><span><span>"redis"</span></span><span><span>);</span></span><span><span>
     </span></span><span><span>});</span></span><span><span>
   </span></span><span><span>}</span></span></code></pre>
<p>The above configures redis to the configuration string for the <code><span>redis</span></code> service injected by the <code><span>tye</span></code> host.</p>
<p>6. Modify <code><span>tye</span><span>.</span><span>yaml</span></code> to include redis as a dependency.</p>
<pre><code><span><span>name</span></span><span><span>:</span></span><span><span> microservice
services</span></span><span><span>:</span></span><span><span>
</span></span><span><span>-</span></span><span><span> name</span></span><span><span>:</span></span><span><span> backend
  project</span></span><span><span>:</span></span><span><span> backend\backend</span></span><span><span>.</span></span><span><span>csproj
</span></span><span><span>-</span></span><span><span> name</span></span><span><span>:</span></span><span><span> frontend
  project</span></span><span><span>:</span></span><span><span> frontend\frontend</span></span><span><span>.</span></span><span><span>csproj
</span></span><span><span>-</span></span><span><span> name</span></span><span><span>:</span></span><span><span> redis
  image</span></span><span><span>:</span></span><span><span> redis
  bindings</span></span><span><span>:</span></span><span><span>
  </span></span><span><span>-</span></span><span><span> port</span></span><span><span>:</span></span><span><span> </span></span><span><span>6379</span></span><span><span>
    connectionString</span></span><span><span>:</span></span><span><span> </span></span><span><span>"${host}:${port}"</span></span><span><span>
</span></span><span><span>-</span></span><span><span> name</span></span><span><span>:</span></span><span><span> redis</span></span><span><span>-</span></span><span><span>cli
  image</span></span><span><span>:</span></span><span><span> redis
  args</span></span><span><span>:</span></span><span><span> </span></span><span><span>"redis-cli -h redis MONITOR"</span></span></code></pre>
<p>We’ve added 2 services to the <code><span>tye</span><span>.</span><span>yaml</span></code> file. The <code><span>redis</span></code> service itself and a <code><span>redis</span><span>-</span><span>cli</span></code> service that we will use to watch the data being sent to and retrieved from redis.</p>
<blockquote>
<p><em>The <code><span>"${host}:${port}"</span></code> format in the <code><span>connectionString</span></code> property will substitute the values of the host and port number to produce a connection string that can be used with StackExchange.Redis</em>.</p>
</blockquote>
<p>7. Run the <code><span>tye</span></code> command line in the solution root</p>
<blockquote>
<p><em>Make sure your command-line is in the <code><span>microservices</span><span>/</span></code> directory. One of the previous steps had you change directories to edit a specific project</em>.</p>
</blockquote>
<pre><code><span><span>tye run</span></span></code></pre>
<p>Navigate to <a href="http://localhost:8000/" target="_blank">http://localhost:8000</a> to see the dashboard running. Now you will see both <code><span>redis</span></code> and the <code><span>redis</span><span>-</span><span>cli</span></code> running listed in the dashboard.</p>
<p>Navigate to the <code><span>frontend</span></code> application and verify that the data returned is the same after refreshing the page multiple times. New content will be loaded every 5 seconds, so if you wait that long and refresh again, you should see new data. You can also look at the <code><span>redis</span><span>-</span><span>cli</span></code> logs using the dashboard and see what data is being cached in redis.</p>
<blockquote>
<p><em>The <code><span>"${host}:${port}"</span></code> format in the <code><span>connectionString</span></code> property will substitute the values of the host and port number to produce a connection string that can be used with StackExchange.Redis</em>.</p>
</blockquote>
<h3>Deploying to Kubernetes</h3>
<p>Tye makes the process of deploying your application to Kubernetes very simple with minimal knowlege or configuration required.</p>
<blockquote>
<p><em>Tye will use your current credentials for pushing Docker images and accessing Kubernetes clusters. If you have configured kubectl with a context already, that’s what <a href="https://devblogs.microsoft.com/docs/reference/commandline/tye-deploy.md"><code><span>tye deploy</span></code></a> is going to use!</em></p>
</blockquote>
<p>Prior to deploying your application, make sure to have the following:</p>
<ol>
<li><a href="https://www.docker.com/products/docker-desktop" target="_blank">Docker</a> installed based off on your operating system</li>
<li>A container registry. Docker by default will create a container registry on <a href="https://hub.docker.com/" target="_blank">DockerHub</a>. You could also use <a href="https://azure.microsoft.com/en-us/services/container-registry/" target="_blank">Azure Container Registry</a> (ACR) or another container registry of your choice.</li>
<li>A Kubernetes Cluster. There are many different options here, including:
<ul>
<li><a href="https://www.docker.com/blog/docker-windows-desktop-now-kubernetes/" target="_blank">Kubernetes in Docker Desktop</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/aks/tutorial-kubernetes-deploy-cluster" target="_blank">Azure Kubernetes Service</a></li>
<li><a href="https://kubernetes.io/docs/tasks/tools/install-minikube/" target="_blank">Minikube</a></li>
<li><a href="https://k3s.io/" target="_blank">K3s</a> – <em>a lightweight single-binary certified Kubernetes distribution from Rancher</em>.</li>
<li>Another Kubernetes provider of your choice.</li>
</ul>
</li>
</ol>
<blockquote>
<p><em>If you choose a container registry provided by a cloud provider (other than Dockerhub), you will likely have to take some steps to configure your kubernetes cluster to allow access. Follow the instructions provided by your cloud provider.</em></p>
</blockquote>
<h3>Deploying Redis</h3>
<p><code><span>tye deploy</span></code> will not deploy the redis configuration, so you need to deploy it first by running:</p>
<pre><code><span><span>kubectl apply </span></span><span><span>-</span></span><span><span>f https</span></span><span><span>:</span></span><span><span>//raw.githubusercontent.com/dotnet/tye/master/docs/tutorials/hello-tye/redis.yaml</span></span></code></pre>
<p>This will create a deployment and service for redis.</p>
<h3>Tye deploy</h3>
<p>You can deploy your application by running the follow command:</p>
<pre><code><span><span>tye deploy </span></span><span><span>--</span></span><span><span>interactive</span></span></code></pre>
<blockquote>
<p><em>Enter the Container Registry (ex: <code><span>example</span><span>.</span><span>azurecr</span><span>.</span><span>io</span></code> for Azure or <code><span>example</span></code> for dockerhub):</em></p>
</blockquote>
<p>You will be prompted to enter your container registry. This is needed to tag images, and to push them to a location accessible by kubernetes.</p>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-output.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-output.png" alt="Image tye deploy output" width="1761" height="111" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-output.png 1761w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-output-300x19.png 300w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-output-1024x65.png 1024w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-output-768x48.png 768w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-output-1536x97.png 1536w" sizes="(max-width: 1761px) 100vw, 1761px">  </a></p>
<p>If you are using dockerhub, the registry name will be your dockerhub username. If you are using a standalone container registry (for instance from your cloud provider), the registry name will look like a hostname, eg: <code><span>example</span><span>.</span><span>azurecr</span><span>.</span><span>io</span></code>.</p>
<p>You’ll also be prompted for the connection string for redis.</p>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/redis-connection-string.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/redis-connection-string.png" alt="Image redis connection string" width="1214" height="95" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/redis-connection-string.png 1214w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/redis-connection-string-300x23.png 300w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/redis-connection-string-1024x80.png 1024w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/redis-connection-string-768x60.png 768w" sizes="(max-width: 1214px) 100vw, 1214px">  </a></p>
<p>Enter the following to use the instance that you just deployed:</p>
<pre><code><span><span>redis</span></span><span><span>:</span></span><span><span>6379</span></span></code></pre>
<p><code><span>tye deploy</span></code> will create Kubernetes secret to store the connection string.</p>
<blockquote>
<p><em>–interactive is needed here to create the secret. This is a one-time configuration step. In a CI/CD scenario you would not want to have to specify connection strings over and over, deployment would rely on the existing configuration in the cluster.</em></p>
</blockquote>
<p>Tye uses Kubernetes secrets to store connection information about dependencies like redis that might live outside the cluster. Tye will automatically generate mappings between service names, binding names, and secret names.</p>
<p><code><span>tye deploy</span></code> does many different things to deploy an application to Kubernetes. It will:</p>
<ul>
<li>Create a docker image for each project in your application.</li>
<li>Push each docker image to your container registry.</li>
<li>Generate a Kubernetes <code><span>Deployment</span></code> and <code><span>Service</span></code> for each project.</li>
<li>Apply the generated <code><span>Deployment</span></code> and <code><span>Service</span></code> to your current Kubernetes context.</li>
</ul>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-building-images-1024x519.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-building-images-1024x519.png" alt="Image tye deploy building images" width="640" height="324" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-building-images-1024x519.png 1024w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-building-images-300x152.png 300w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-building-images-768x389.png 768w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/tye-deploy-building-images.png 1125w" sizes="(max-width: 640px) 100vw, 640px">  </a></p>
<p>You should now see three pods running after deploying.</p>
<pre><code><span><span>kubectl </span></span><span><span>get</span></span><span><span> pods


NAME                                             READY   STATUS    RESTARTS   AGE
backend</span></span><span><span>-</span></span><span><span>ccfcd756f</span></span><span><span>-</span></span><span><span>xk2q9                          </span></span><span><span>1</span></span><span><span>/</span></span><span><span>1</span></span><span><span>     </span></span><span><span>Running</span></span><span><span>   </span></span><span><span>0</span></span><span><span>          </span></span><span><span>85m</span></span><span><span>
frontend</span></span><span><span>-</span></span><span><span>84bbdf4f7d</span></span><span><span>-</span></span><span><span>6r5zp</span></span><span><span>                        </span></span><span><span>1</span></span><span><span>/</span></span><span><span>1</span></span><span><span>     </span></span><span><span>Running</span></span><span><span>   </span></span><span><span>0</span></span><span><span>          </span></span><span><span>85m</span></span><span><span>
redis</span></span><span><span>-</span></span><span><span>5f554bd8bd</span></span><span><span>-</span></span><span><span>rv26p                           </span></span><span><span>1</span></span><span><span>/</span></span><span><span>1</span></span><span><span>     </span></span><span><span>Running</span></span><span><span>   </span></span><span><span>0</span></span><span><span>          </span></span><span><span>98m</span></span></code></pre>
<p>You can visit the frontend application, you will need to port-forward to access the frontend from outside the cluster.</p>
<pre><code><span><span>kubectl port</span></span><span><span>-</span></span><span><span>forward svc</span></span><span><span>/</span></span><span><span>frontend </span></span><span><span>5000</span></span><span><span>:</span></span><span><span>80</span></span></code></pre>
<p>Now navigate to http://localhost:5000 to view the frontend application working on Kubernetes.</p>
<p><a href="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/kubernetes-portforward.png" data-featherlight="image"> <img src="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/kubernetes-portforward.png" alt="Image kubernetes portforward" width="665" height="227" srcset="https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/kubernetes-portforward.png 665w, https://devblogs.microsoft.com/aspnet/wp-content/uploads/sites/16/2020/05/kubernetes-portforward-300x102.png 300w" sizes="(max-width: 665px) 100vw, 665px">  </a></p>
<blockquote>
<p><em>Currently tye does not automatically enable TLS within the cluster, and so communication takes place over HTTP instead of HTTPS. This is typical way to deploy services in kubernetes – we may look to enable TLS as an option or by default in the future.</em></p>
</blockquote>
<h3>Adding a registry to tye.yaml</h3>
<p>If you want to use <code><span>tye deploy</span></code> as part of a CI/CD system, it’s expected that you’ll have a <code><span>tye</span><span>.</span><span>yaml</span></code> file initialized. You will then need to add a container registry to <code><span>tye</span><span>.</span><span>yaml</span></code>. Based on what container registry you configured, add the following line in the <code><span>tye</span><span>.</span><span>yaml</span></code> file:</p>
<pre><code><span><span>registry</span></span><span><span>:</span></span><span><span> </span></span><span><span>&lt;registry_name&gt;</span></span></code></pre>
<p>Now it’s possible to use <code><span>tye deploy</span></code> without <code><span>--</span><span>interactive</span></code> since the registry is stored as part of configuration.</p>
<blockquote>
<p><em>This step may not make much sense if you’re using tye.yaml to store a personal Dockerhub username. A more typical use case would storing the name of a private registry for use in a CI/CD system</em>.</p>
</blockquote>
<p>For a conceptual overview of how Tye behaves when using <code><span>tye deploy</span></code> for deployment, check out this <a href="https://github.com/dotnet/tye/blob/master/docs/reference/deployment.md" target="_blank">document</a>.</p>
<h3>Undeploying your application</h3>
<p>After deploying and playing around with the application, you may want to remove all resources associated from the Kubernetes cluster. You can remove resources by running:</p>
<pre><code><span><span>tye undeploy</span></span></code></pre>
<p>This will remove all deployed resources. If you’d like to see what resources would be deleted, you can run:</p>
<pre><code><span><span>tye undeploy </span></span><span><span>--</span></span><span><span>what</span></span><span><span>-</span></span><span><span>if</span></span></code></pre>

<p>If you want to experiment more with using Tye, we have a variety of different sample applications and tutorials that you can walk through, check them out down below:</p>
<ul>
<li><a href="https://github.com/dotnet/tye/tree/master/samples" target="_blank">Tye samples</a></li>
<li><a href="https://github.com/dotnet/tye/tree/master/docs/recipes" target="_blank">Recipes</a></li>
</ul>

<p>We have been diligently working on adding new capabilities and integrations to continuously improve Tye. Here are some integrations below that we have recently released. There is also information provided on how to get started for each of these:</p>
<ul>
<li><a href="https://github.com/dotnet/tye/blob/master/docs/recipes/ingress.md" target="_blank">Ingress</a> – <em>to expose pods/services created to the public internet</em>.</li>
<li><a href="https://github.com/dotnet/tye/blob/master/docs/tutorials/hello-tye/02_add_redis.md" target="_blank">Redis</a> – <em>to store data, cache, or as a message broker</em>.</li>
<li><a href="https://github.com/dotnet/tye/blob/master/docs/recipes/dapr.md" target="_blank">Dapr</a> – <em>for integrating a Dapr application with Tye</em>.</li>
<li><a href="https://github.com/dotnet/tye/blob/master/docs/recipes/distributed_tracing.md" target="_blank">Zipkin</a> – <em>using Zipkin for distributed tracing</em>. </li>
<li><a href="https://github.com/dotnet/tye/blob/master/docs/recipes/logging.md" target="_blank">Elastic Stack</a> – <em>using Elastic Stack for logging</em>.</li>
</ul>
<p>While we are excited about the promise Tye holds, it’s an experimental project and not a committed product. During this experimental phase we expect to engage deeply with anyone trying out Tye to hear feedback and suggestions. The point of doing experiments in the open is to help us explore the space as much as we can and use what we learn to determine what we should be building and shipping in the future.</p>
<p>Project Tye is currently commited as an experiment until .NET 5 ships. At which point we will be evaluating what we have and all that we’ve learnt to decide what we should do in the future.</p>
<p>Our goal is to <a href="https://github.com/dotnet/tye/releases" target="_blank">ship every month</a>, and some new capabilities that we are looking into for Tye include:</p>
<ul>
<li>More deployment targets</li>
<li>Sidecar support</li>
<li>Connected development</li>
<li>Database migrations</li>
</ul>

<p>We are excited by the potential Tye has to make developing distributed applications easier and we need your feedback to make sure it reaches that potential. We’d really love for you to try it out and tell us what you think, there is a link to a survey on the Tye dashboard that you can fill out or you can create issues and talk to us on <a href="https://github.com/dotnet/tye" target="_blank">GitHub</a>. Either way we’d love to hear what you think.</p>
        
        
        
        

		        
        
        
	</div><!-- .entry-content -->
    
    </div></div></div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function () {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>