<!DOCTYPE html>
<html lang="en">
<head>
    <title>
Burrows - Wheeler Data Transform Algorithm -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>Burrows - Wheeler Data Transform Algorithm</h1><div><div class="container"><p class="line number4 index3 alt1"><code class="preprocessor">#include &lt;stdio.h&gt; </code></p><p class="line number5 index4 alt2"><code class="preprocessor">#include &lt;stdlib.h&gt; </code></p><p class="line number6 index5 alt1"><code class="preprocessor">#include &lt;string.h&gt; </code></p><p class="line number9 index8 alt2"><code class="keyword bold">struct</code><code class="plain">rotation { </code></p><p class="line number10 index9 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code><code class="plain">index; </code></p><p class="line number11 index10 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code><code class="plain">* suffix; </code></p><p class="line number12 index11 alt1"><code class="plain">}; </code></p><p class="line number16 index15 alt1"><code class="color1 bold">int</code><code class="plain">cmpfunc(</code><code class="keyword bold">const</code><code class="keyword bold">void</code><code class="plain">* x, </code><code class="keyword bold">const</code><code class="keyword bold">void</code><code class="plain">* y) </code></p><p class="line number17 index16 alt2"><code class="plain">{ </code></p><p class="line number18 index17 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code><code class="plain">rotation* rx = (</code><code class="keyword bold">struct</code><code class="plain">rotation*)x; </code></p><p class="line number19 index18 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code><code class="plain">rotation* ry = (</code><code class="keyword bold">struct</code><code class="plain">rotation*)y; </code></p><p class="line number20 index19 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code><code class="functions bold">strcmp</code><code class="plain">(rx-&gt;suffix, ry-&gt;suffix); </code></p><p class="line number21 index20 alt2"><code class="plain">} </code></p><p class="line number25 index24 alt2"><code class="color1 bold">int</code><code class="plain">* computeSuffixArray(</code><code class="color1 bold">char</code><code class="plain">* input_text, </code><code class="color1 bold">int</code><code class="plain">len_text) </code></p><p class="line number26 index25 alt1"><code class="plain">{ </code></p><p class="line number29 index28 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code><code class="plain">rotation suff[len_text]; </code></p><p class="line number33 index32 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">for</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">i = 0; i &lt; len_text; i++) { </code></p><p class="line number34 index33 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">suff[i].index = i; </code></p><p class="line number35 index34 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">suff[i].suffix = (input_text + i); </code></p><p class="line number36 index35 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">} </code></p><p class="line number40 index39 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">qsort</code><code class="plain">(suff, len_text, </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="keyword bold">struct</code><code class="plain">rotation), </code></p><p class="line number41 index40 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cmpfunc); </code></p><p class="line number44 index43 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code><code class="plain">* suffix_arr </code></p><p class="line number45 index44 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">= (</code><code class="color1 bold">int</code><code class="plain">*)</code><code class="functions bold">malloc</code><code class="plain">(len_text * </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">)); </code></p><p class="line number46 index45 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">for</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">i = 0; i &lt; len_text; i++) </code></p><p class="line number47 index46 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">suffix_arr[i] = suff[i].index; </code></p><p class="line number50 index49 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code><code class="plain">suffix_arr; </code></p><p class="line number51 index50 alt2"><code class="plain">} </code></p><p class="line number56 index55 alt1"><code class="color1 bold">char</code><code class="plain">* findLastChar(</code><code class="color1 bold">char</code><code class="plain">* input_text, </code></p><p class="line number57 index56 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code><code class="plain">* suffix_arr, </code><code class="color1 bold">int</code><code class="plain">n) </code></p><p class="line number58 index57 alt1"><code class="plain">{ </code></p><p class="line number61 index60 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code><code class="plain">* bwt_arr = (</code><code class="color1 bold">char</code><code class="plain">*)</code><code class="functions bold">malloc</code><code class="plain">(n * </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">char</code><code class="plain">)); </code></p><p class="line number62 index61 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code><code class="plain">i; </code></p><p class="line number63 index62 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">for</code><code class="plain">(i = 0; i &lt; n; i++) { </code></p><p class="line number66 index65 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code><code class="plain">j = suffix_arr[i] - 1; </code></p><p class="line number67 index66 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">(j &lt; 0) </code></p><p class="line number68 index67 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">j = j + n; </code></p><p class="line number70 index69 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">bwt_arr[i] = input_text[j]; </code></p><p class="line number71 index70 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">} </code></p><p class="line number73 index72 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">bwt_arr[i] = </code><code class="string">'\0'</code><code class="plain">; </code></p><p class="line number76 index75 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code><code class="plain">bwt_arr; </code></p><p class="line number77 index76 alt2"><code class="plain">} </code></p><p class="line number80 index79 alt1"><code class="color1 bold">int</code><code class="plain">main() </code></p><p class="line number81 index80 alt2"><code class="plain">{ </code></p><p class="line number82 index81 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code><code class="plain">input_text[] = </code><code class="string">"banana$"</code><code class="plain">; </code></p><p class="line number83 index82 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code><code class="plain">len_text = </code><code class="functions bold">strlen</code><code class="plain">(input_text); </code></p><p class="line number86 index85 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code><code class="plain">* suffix_arr </code></p><p class="line number87 index86 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">= computeSuffixArray(input_text, len_text); </code></p><p class="line number91 index90 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code><code class="plain">* bwt_arr </code></p><p class="line number92 index91 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">= findLastChar(input_text, suffix_arr, len_text); </code></p><p class="line number94 index93 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Input text : %s\n"</code><code class="plain">, input_text); </code></p><p class="line number95 index94 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Burrows - Wheeler Transform : %s\n"</code><code class="plain">, </code></p><p class="line number96 index95 alt1"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">bwt_arr); </code></p><p class="line number97 index96 alt2"><code class="undefined spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code><code class="plain">0; </code></p><p class="line number98 index97 alt1"><code class="plain">} </code></p></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>