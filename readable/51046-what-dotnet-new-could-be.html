<!DOCTYPE html>
<html lang="en">
<head>
    <title>
What dotnet new Could Be -
linksfor.dev(s)
    </title>
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta charset="utf-8">
    <meta name="Description" content="A curated source of links that devs might find interesting. Updated around the clock." />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="grid">
        
<div class="readable">
    <div id="readOverlay" class="style-ebook"><div id="readInner" class="margin-medium size-medium"><h1>What dotnet new Could Be</h1><div><div class="entry-content"><p>The ‘<a href="https://docs.microsoft.com/en-us/dotnet/core/tools/custom-templates">dotnet new</a>‘ CLI command is a great way to create projects from templates in dotnet. However, I think it could provide a much better experience than it currently does. I also suspect it isn’t used much, mostly because templates authored for the ‘dotnet new’ experience are not included in the Visual Studio File -&gt; New Project experience. For template authors, the experience of developing templates could do with some improvements. I tweeted about it this morning and got asked to write a short gist about what could be improved, so this is that list.</p><h2> Why do I Care?</h2><p>I author a Swagger API, GraphQL API and Microsoft Orleans project templates in my <a href="https://github.com/Dotnet-Boxed/Templates">Dotnet Boxed</a> project. The project currently has 1,900 stars on GitHub and the <a href="https://www.nuget.org/packages/Boxed.Templates/">Boxed.Templates</a> NuGet package has around 12,149 downloads at the time of writing. The Dotnet Boxed templates are also some of the more complex templates using ‘dotnet new’. They all have a dozen or more optional features.</p><h2>Visual Studio Integration</h2><p>In the past, I also authored the <a href="https://marketplace.visualstudio.com/items?itemName=RehanSaeed.ASPNETMVCBoilerplate">ASP.NET Core Boilerplate</a> project templates which are published as a Visual Studio extension. This extension currently has 159,307 installs which is an order of magnitude more than the 12,149 installs of my ‘dotnet new’ based Boxed.Templates NuGet package.</p><p>I’ve read in the dotnet/templating GitHub issues that there is eventually going to be Visual Studio integration in which you’d be able to search and install ‘dotnet new’ based templates on NuGet, and then create projects from those templates much as you would with Visual Studio today. Given the download counts of my two projects, this would be the number one feature I’d like to see implemented.</p><p>You could create a Visual Studio extension that wraps your ‘dotnet new’ templates but having messed around with them in the past, it’s a lot of effort. I’m in the template making business, not in the extension making business. Also, given the above rumour, I’ve held off going this route.</p><h2>NuGet/Visual Studio Marketplace Integration</h2><p>Currently there is no way to search for a list of all ‘dotnet new’ based project templates on NuGet or on the Visual Studio marketplace. There is <a href="https://github.com/dotnet/templating/wiki/Available-templates-for-dotnet-new">this list</a> buried in the <a href="https://github.com/dotnet/templating">dotnet/templating</a> GitHub project but the only people who are going to find that are template authors. It would be great if there was some kind of marketplace or store to find templates, rate them, provide feedback etc.</p><h2>dotnet new ui</h2><p>If you’ve seen the Vue CLI, it has a magical UI for creating projects from it’s template. This is the benchmark by which I now measure all project creation experiences. Just take a look at it’s majesty:</p><figure class="wp-block-image size-large"><img src="https://media.rehansaeed.com/rehansaeed/sites/2/2019/12/Vue-CLI-Create-a-New-Project-1024x828.png" alt="Vue CLI Create a New Project" class="wp-image-17190 jetpack-lazy-image" data-lazy-srcset="https://media.rehansaeed.com/rehansaeed/sites/2/2019/12/Vue-CLI-Create-a-New-Project-1024x828.png 1024w, https://media.rehansaeed.com/rehansaeed/sites/2/2019/12/Vue-CLI-Create-a-New-Project-300x243.png 300w, https://media.rehansaeed.com/rehansaeed/sites/2/2019/12/Vue-CLI-Create-a-New-Project-768x621.png 768w, https://media.rehansaeed.com/rehansaeed/sites/2/2019/12/Vue-CLI-Create-a-New-Project-1536x1242.png 1536w, https://media.rehansaeed.com/rehansaeed/sites/2/2019/12/Vue-CLI-Create-a-New-Project.png 1984w" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://media.rehansaeed.com/rehansaeed/sites/2/2019/12/Vue-CLI-Create-a-New-Project-1024x828.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"></figure><p>Imagine executing ‘dotnet new ui’, then seeing a nice browser dialogue popup like the one above where you could find, install and even create projects from templates. Creating a project would involve entering the name of your project, the directory where you want it to be saved and then toggling any custom options that the project template might offer.</p><p>That last bit is where having a UI shines. There aren’t many ‘dotnet new’ templates that use the templating engine to it’s full potential and have additional optional features. When you use the current command line experience it’s unweildy and slow to set custom options. Having a custom UI with some check boxes and drop downs would be a far quicker and more delightful experience.</p><h2>Missing Features</h2><p>There are a bunch of cool missing or half implemented features in the ‘dotnet new’ templating engine that could use finishing. Chief among these are called post actions. These are a set of custom actions that can be performed once your project has been created.</p><p>As far as I can work out, the only post action that works is the one that restores all NuGet packages in your project. This was implemented because the basic Microsoft project templates wanted to use them but I understand that they no longer do for reasons unknown to me. Happily I still use this one and it works nicely.</p><p>Other post actions that are half implemented (They exist and you can use them but they just print content to the console) are for opening files in the editor, opening files or links in the web browser or even running arbitrary scripts. The last one has the potential for being a security risk however, so it would be better to have a health list of post actions for specific tasks. I’d love to be able to open the ReadMe.md file that ships with my project template.</p><p>In terms of new post actions, I’d really like to see one that removes and sorts using statements. I have a lot of optional pieces of code in my project templates, so I have to have a lot of #if #endif code to tell the templating engine which lines of code to remove. It’s particularly easy to get this wrong with using statements, leaving you with a fresh project that doesn’t compile because you’ve removed one too many using statements by accident. To avoid this, I created my own unit testing framework for dotnet new projects called <a href="https://github.com/Dotnet-Boxed/Framework#boxeddotnetnewtest">Boxed.DotnetNewTest</a>.</p><h2>Docs, Docs &amp; Docs</h2><p>There is <a href="https://docs.microsoft.com/en-us/dotnet/core/tools/custom-templates">one page of documentation</a> on how to create project templates in the official docs page. There is a bunch more in the <a href="https://github.com/dotnet/templating/wiki">dotnet/templating wiki</a> and some crucial bits of information in comments of GitHub issues. In particular, there is precious little information about how to conditionally remove code or files based on options the user selects. There is also very little about post actions. It would be great if this could be tidied up.</p><p>Secondary to the docs is the <a href="https://github.com/dotnet/templating/issues">GitHub issues</a> . There are currently 168 open issues with a large number having only one comment from the original author. Given the lack of documentation, having questions answered is really important.</p><h2>Fixing Bugs</h2><p>The latest version of the dotnet CLI has fixed some bugs but there are still a few that really get in the way of a great experience:</p><ul><li><a href="https://github.com/dotnet/templating/issues/1544">#1544</a>/<a href="https://github.com/dotnet/templating/issues/348">#348</a> – Running dotnet new foo –help outputs some pretty terrible looking text if you have any custom options.</li><li><a href="https://github.com/dotnet/templating/issues/2208">#2208</a> – You cannot conditionally remove text from a file if it has no file extension, so that means Dockerfile, .gitignore, .editorconfig files.</li><li><a href="https://github.com/dotnet/templating/issues/2209">#2209</a> – Complex conditionals fail if not wrapped in parentheses. I always forget to do this. There is no warnings, your template won’t work.</li><li><a href="https://github.com/dotnet/templating/issues/1438">#1438</a> – Using conditional code in csproj files requires some workarounds to work.</li></ul><h2>Conclusions</h2><p>The Vue CLI has really shown how great a new project creation experience can be. With a bit of work, the ‘dotnet new’ experience could be just as great.</p><h3 class="jp-relatedposts-headline"><em>Related</em></h3></div></div></div></div>
</div>
    </div>
    <footer>
        <div>created by buildstarted &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
    </footer>
    
    <script>
        (function () {
            var COLLECT_URL = "https://dna.buildstarted.com/t";
            var SITE_ID = "linksfor.devs";
            var GLOBAL_VAR_NAME = "__DNA__";

            window[GLOBAL_VAR_NAME] = {};

            window[GLOBAL_VAR_NAME].sendPageView = function () {
                var path = location.pathname;
                var referrer = document.referrer;

                var url = COLLECT_URL + "?siteid=" + SITE_ID + "&p=" + encodeURIComponent(path) + "&r=" + encodeURIComponent(referrer);

                try { fetch(url, { method: "GET" }); } catch (e) { }
            };

            window[GLOBAL_VAR_NAME].sendPageView();
        })();
    </script>
</body>
</html>