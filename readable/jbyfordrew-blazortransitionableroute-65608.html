<!DOCTYPE html>
<html lang="en">
<head>
    <title>
JByfordRew/BlazorTransitionableRoute - linksfor.dev(s)    </title>
    <meta charset="utf-8">
    <link rel="alternate" type="application/rss+xml" title="Linksfor.dev(s) feed" href="https://linksfor.dev/feed.rss" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" value="notranslate">
    <link rel="stylesheet" type="text/css" href="/style.min.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="JByfordRew/BlazorTransitionableRoute - linksfor.dev(s)"/>
    <meta property="article:author" content="JByfordRew"/>
    <meta property="og:description" content="Allows current and previous route to exist enabling transition animations of UI/UX design systems. - JByfordRew/BlazorTransitionableRoute"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://github.com/JByfordRew/BlazorTransitionableRoute"/>

<meta property="og:site_name" content="linksfor.dev(s)" />
</head>
<body>
    <div class="devring" style="background: #222">
        <div style="text-align:center">Explore other dev related sites in this ring. If you would like to join this ring <a href="https://devring.club">click here</a>.</div>
        <div class="grid">
            <div style="display: grid; grid-template-columns: .5fr 1fr 1fr 1fr; text-align: center;">
                <span class="devring-title"><a href="https://devring.club/">devring.club</a></span>
                <a href="https://devring.club/sites/1/prev" class="devring-previous">Previous</a>
                <a href="https://devring.club/random" class="devring-random">Random</a>
                <a href="https://devring.club/sites/1/next" class="devring-next">Next</a>
            </div>
        </div>
    </div>
    <div class="grid">
        <h1 style="margin: unset">
<a href="/" style="color:inherit">linksfor.dev(s)</a>
        </h1>
        <title>linksfor.dev(s) - JByfordRew/BlazorTransitionableRoute</title>
<div class="readable">
        <h1>JByfordRew/BlazorTransitionableRoute</h1>
            <div>by JByfordRew</div>
            <div>Reading time: 6-8 minutes</div>
        <div>Posted here: 13 Aug 2020</div>
        <p><a href="https://github.com/JByfordRew/BlazorTransitionableRoute">https://github.com/JByfordRew/BlazorTransitionableRoute</a></p>
        <hr/>
<div id="readability-page-1" class="page"><div id="readme">
    
        

      <div>
        <article itemprop="text">
<p>Allows current and previous route to exist enabling transition animations of UI/UX design systems.</p>
<h2>What it does?</h2>
<p>Sometimes you need to show transitions between route but Blazor by default only allows one.  This provides an ability to remember the last route and allow you to perform transitions out and in on the old and new route views rendered.</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/JByfordRew/BlazorTransitionableRoute/blob/master/demo/BlazorTransitionableRouteDemo.gif"><img src="https://github.com/JByfordRew/BlazorTransitionableRoute/raw/master/demo/BlazorTransitionableRouteDemo.gif" alt="Demo"></a></p>
<h2>How it works?</h2>
<p>Having two view layouts means we can remember the previous route but we cannot simply overwrite them, they must be preserved so we do not lose browser state like scroll position etc. This solution handles the route views and knows when to call the transition implementation you provide to it.  It also works with the browser navigation buttons.
If you need to had in app back buttons then use the jsInterop to call the native back i.e. <code>window.history.back();</code>
This is as simple a solution I could arrive at.  If there is another simpler one please let me know.</p>
<p>See the demos for how to implement.</p>
<h2>Installation</h2>
<p>Latest version in here:  <a href="https://www.nuget.org/packages/BlazorTransitionableRoute/" rel="nofollow"><img src="https://camo.githubusercontent.com/baa57d6e0fa4e0c7dea6e5de049ae48339401dd3/68747470733a2f2f696d672e736869656c64732e696f2f6e756765742f762f426c617a6f725472616e736974696f6e61626c65526f7574652e737667" alt="NuGet" data-canonical-src="https://img.shields.io/nuget/v/BlazorTransitionableRoute.svg"></a></p>
<pre><code>Install-Package BlazorTransitionableRoute
</code></pre>
<p>or</p>
<pre><code>dotnet add package BlazorTransitionableRoute
</code></pre>
<h2>Usage</h2>
<h3>Common component steps</h3>
<p>For client-side and server-side Blazor - add script section to index.html or _Host.cshtml (head section)</p>
<div><pre><span>&lt;</span><span>script</span> <span>src</span>="<span>_content/BlazorTransitionableRoute/jsInterop.js</span>"<span>&gt;</span><span>&lt;/</span><span>script</span><span>&gt;</span></pre></div>
<p>Add reference to _Imports.razor file</p>
<div><pre><span>@using</span> <span>BlazorTransitionableRoute</span></pre></div>
<p>For client-side and server-side Blazor - add registrations for the dependency injection framework in <code>Program.cs</code> or <code>Startup.cs</code>, for example</p>
<div><pre><span>builder</span>.<span>Services</span>.<span>AddScoped</span>&lt;<span>BlazorTransitionableRoute</span>.<span>NavigationState</span>&gt;();
<span>builder</span>.<span>Services</span>.<span>AddScoped</span>&lt;<span>BlazorTransitionableRoute</span>.<span>NavigationStateHandler</span>&gt;();
<span>builder</span>.<span>Services</span>.<span>AddScoped</span>&lt;<span>BlazorTransitionableRoute</span>.<span>IRouteTransitionInvoker</span>, <span>RouteTransitionInvoker</span>&gt;();</pre></div>
<h3>A change to routing approach</h3>
<p>Modify the App.razor file to take advantage of the transitionable route layouts and view.  This means moving the <code>MainLayout</code> to be more explicit in the app router and providing a more container like <code>MyViewLayout</code> as the default layouts. You can see below the simple use of primary and secondary route views. The <code>TransitionableRoutePrimary / Secondary</code> modify the <code>RouteData</code> passed to each inner <code>TransitionableRouteView</code> based on the active state, which is swapped after each navigation to preserve component instances.</p>
<div><pre><span>&lt;</span><span>Router</span> <span>AppAssembly</span>="<span>@typeof(Program).Assembly</span>"<span>&gt;</span>
    <span>&lt;</span><span>Found</span> <span>Context</span>="<span>routeData</span>"<span>&gt;</span>
        <span>&lt;</span><span>LayoutView</span> <span>Layout</span>="<span>@typeof(MainLayout)</span>"<span>&gt;</span>
            <span>&lt;</span><span>TransitionableRoutePrimary</span> <span>RouteData</span>="<span>@routeData</span>"<span>&gt;</span>
                <span>&lt;</span><span>TransitionableRouteView</span> <span>DefaultLayout</span>="<span>@typeof(MyViewLayout)</span>" /&gt;
            <span>&lt;/</span><span>TransitionableRoutePrimary</span><span>&gt;</span>
            <span>&lt;</span><span>TransitionableRouteSecondary</span> <span>RouteData</span>="<span>@routeData</span>"<span>&gt;</span>
                <span>&lt;</span><span>TransitionableRouteView</span> <span>DefaultLayout</span>="<span>@typeof(MyViewLayout)</span>" /&gt;
            <span>&lt;/</span><span>TransitionableRouteSecondary</span><span>&gt;</span>
        <span>&lt;/</span><span>LayoutView</span><span>&gt;</span>
    <span>&lt;/</span><span>Found</span><span>&gt;</span>
    <span>&lt;</span><span>NotFound</span><span>&gt;</span>
        <span>&lt;</span><span>LayoutView</span> <span>Layout</span>="<span>@typeof(MainLayout)</span>"<span>&gt;</span>
            <span>&lt;</span><span>p</span><span>&gt;</span>Sorry, there's nothing at this address.<span>&lt;/</span><span>p</span><span>&gt;</span>
        <span>&lt;/</span><span>LayoutView</span><span>&gt;</span>
    <span>&lt;/</span><span>NotFound</span><span>&gt;</span>
<span>&lt;/</span><span>Router</span><span>&gt;</span></pre></div>
<h3>Example usage</h3>
<p>You will need to create your own transitiong view, for example (<code>TransitioningIn</code> is provided by the inherited <code>TransitionableLayoutComponent</code>)</p>
<div><pre>@inherits TransitionableLayoutComponent

<span>&lt;</span><span>div</span> <span>class</span>="<span>transition @transitioningClass</span>"<span>&gt;</span>
    @Body
<span>&lt;/</span><span>div</span><span>&gt;</span>

<span>&lt;</span><span>style</span><span>&gt;</span>
    .<span>transition</span> {
        <span>position</span>: absolute;
    }

    .<span>transition-in</span> {
        <span>opacity</span>: <span>0</span>;
    }
<span>&lt;/</span><span>style</span><span>&gt;</span>

@code {
    private string transitioningClass =<span>&gt;</span> TransitioningIn ? "transition-in" : "transition-out";
}</pre></div>
<p>(alternatively you can use the default one provided by the component called <code>TransitionableLayoutComponent</code> but you will need to handle the `TransitioningIn' cascading parameter and probably wrap each page in it's own containing component.  You are free to implement how you like but the cascading parameter is your starting point to prepare for transitioning.)</p>
<p>You will need to create an implementation of <code>IRouteTransitionInvoker</code> and save it where you like, perhaps in <code>Shared</code> folder.</p>
<div><pre><span>using</span> <span>BlazorTransitionableRoute</span>;
<span>using</span> <span>Microsoft</span>.<span>JSInterop</span>;
<span>using</span> <span>System</span>.<span>Threading</span>.<span>Tasks</span>;

<span>namespace</span> <span>BlazorTransitionableRouteDemoWasm</span>.<span>Client</span>.<span>Shared</span>
{
    <span>public</span> <span>class</span> <span>RouteTransitionInvoker</span> : <span>IRouteTransitionInvoker</span>
    {
        <span>private</span> <span>readonly</span> <span>IJSRuntime</span> <span>jsRuntime</span>;

        <span>public</span> <span>RouteTransitionInvoker</span>(<span>IJSRuntime</span> <span>jsRuntime</span>)
        {
            <span>this</span>.<span>jsRuntime</span> <span>=</span> <span>jsRuntime</span>;
        }

        <span>public</span> <span>async</span> <span>Task</span> <span>InvokeRouteTransitionAsync</span>(<span>BrowserNavigationDirection</span> <span>navigationDirection</span>)
        {
            <span>var</span> <span>isNavigatingBack</span> <span>=</span> <span>navigationDirection</span> <span>==</span> <span>BrowserNavigationDirection</span>.<span>Backward</span>;
            <span>await</span> <span>jsRuntime</span>.<span>InvokeVoidAsync</span>(<span><span>"</span>window.yourJsInterop.transitionFunction<span>"</span></span>, <span>isNavigatingBack</span>);
        }
    }
}</pre></div>
<p>For client-side and server-side Blazor - add script section to index.html or _Host.cshtml (head section), for example</p>
<div><pre><span>&lt;</span><span>script</span> <span>src</span>="<span>yourJsInteropForAnimatedTransitions.js</span>"<span>&gt;</span><span>&lt;/</span><span>script</span><span>&gt;</span>
... any other supporting animation library scripts you are using, for example using animate.css
<span>&lt;</span><span>link</span> <span>rel</span>="<span>stylesheet</span>" <span>href</span>="<span>https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css</span>" /&gt;</pre></div>
<p>Add your js interop implementation, for example (this is from the demos using animate.css)</p>
<div><pre><span>window</span><span>.</span><span>yourJsInterop</span> <span>=</span> <span>{</span>
    <span>transitionFunction</span>: <span>function</span> <span>(</span><span>back</span><span>)</span> <span>{</span>

        <span>let</span> <span>transitionIn</span> <span>=</span> <span>document</span><span>.</span><span>getElementsByClassName</span><span>(</span><span>'transition-in'</span><span>)</span><span>[</span><span>0</span><span>]</span><span>;</span>
        <span>let</span> <span>transitionOut</span> <span>=</span> <span>document</span><span>.</span><span>getElementsByClassName</span><span>(</span><span>'transition-out'</span><span>)</span><span>[</span><span>0</span><span>]</span><span>;</span>

        <span>let</span> <span>direction</span> <span>=</span> <span>back</span> ? <span>"Up"</span> : <span>"Down"</span><span>;</span>

        <span>if</span> <span>(</span><span>transitionIn</span> <span>&amp;&amp;</span> <span>transitionOut</span><span>)</span> <span>{</span>

            <span>transitionOut</span><span>.</span><span>classList</span><span>.</span><span>remove</span><span>(</span><span>'transition-out'</span><span>)</span><span>;</span>
            <span>transitionOut</span><span>.</span><span>classList</span><span>.</span><span>add</span><span>(</span>
                <span>"animate__fadeOut"</span> <span>+</span> <span>direction</span><span>,</span>
                <span>"animate__faster"</span><span>,</span>
                <span>"animate__animated"</span>
            <span>)</span><span>;</span>

            <span>transitionIn</span><span>.</span><span>classList</span><span>.</span><span>remove</span><span>(</span><span>'transition-in'</span><span>)</span><span>;</span>
            <span>transitionIn</span><span>.</span><span>classList</span><span>.</span><span>add</span><span>(</span>
                <span>"animate__fadeIn"</span> <span>+</span> <span>direction</span><span>,</span>
                <span>"animate__faster"</span><span>,</span>
                <span>"animate__animated"</span>
            <span>)</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span></pre></div>
<p>If you experience timing issues when transition animations are not performing you may need to wrap you inner function code in a zero timeout, for example</p>
<div><pre><span>window</span><span>.</span><span>yourJsInterop</span> <span>=</span> <span>{</span>
    <span>transitionFunction</span>: <span>function</span> <span>(</span><span>back</span><span>)</span> <span>{</span>
        <span>setTimout</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
           ...
        <span>}</span><span>,</span> <span>0</span><span>)</span><span>;</span>
    <span>}</span>
<span>}</span></pre></div>
</article>
      </div>
  </div></div></div>
    </div>
    <footer>
        <div>created by <a href="https://buildstarted.com">buildstarted</a> &copy; 2020 <a href="/about">about</a></div>
        <div>Share this page on social media: copy and paste this url https://linksfor.dev/</div>
        <div>If you prefer RSS: <a href="https://linksfor.dev/feed.xml">https://linksfor.dev/feed.xml</a></div>
        <div>Customer satisfaction guaranteed to be optional.</div>
    </footer>
    
    <script async defer>
        _dna = window._dna || {};
        _dna.siteId = "linksfor.devs";
        _dna.outlink = true;

        (function() {
            let dna = document.createElement('script');
            dna.type = 'text/javascript';
            dna.async = true;
            dna.src = '//dna.buildstarted.com/t.js';
            let s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(dna, s);
        })();
    </script>
    <noscript><img src="//dna.buildstarted.com/g?siteId=linksfor.devs"/></noscript>
</body>
</html>